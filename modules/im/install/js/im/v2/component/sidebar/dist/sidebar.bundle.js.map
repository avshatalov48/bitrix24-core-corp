{"version":3,"file":"sidebar.bundle.js","sources":["../src/classes/blocks/base.js","../src/classes/blocks/base-file.js","../src/classes/blocks/media.js","../src/classes/blocks/audio.js","../src/classes/blocks/document.js","../src/classes/blocks/other.js","../src/classes/blocks/favorite.js","../src/classes/blocks/link.js","../src/classes/blocks/task.js","../src/classes/blocks/main.js","../src/classes/blocks/brief.js","../src/classes/blocks/meeting.js","../src/classes/blocks/file-unsorted.js","../src/classes/blocks/message-search.js","../src/classes/blocks/chats-with-user.js","../src/classes/settings-manager.js","../src/classes/availability-manager.js","../src/classes/sidebar-service.js","../src/components/detail-empty-state.js","../src/components/chats-with-user/chat-item.js","../src/components/chats-with-user/detail.js","../src/components/main/detail-user.js","../src/components/detail.js","../src/classes/context-menu/sidebar-base-menu.js","../src/classes/context-menu/main/members-menu.js","../src/components/main/detail.js","../src/components/main/settings.js","../src/components/main/preview-personal-chat.js","../src/components/main/preview-group-chat.js","../src/components/main/preview.js","../src/components/info/preview.js","../src/classes/sidebar-collection-formatter.js","../src/classes/context-menu/link/link-manager.js","../src/classes/context-menu/link/link-menu.js","../src/components/info/link-item.js","../src/components/date-group.js","../src/components/info/link-detail.js","../src/classes/context-menu/favorite/favorite-menu.js","../src/components/info/favorite-item.js","../src/components/info/favorite-detail.js","../src/classes/context-menu/file/file-manager.js","../src/classes/context-menu/file/file-menu.js","../src/components/file/item/media-detail-item.js","../src/components/file/media-detail.js","../src/components/file/item/audio-detail-item.js","../src/components/file/audio-detail.js","../src/components/file/item/document-detail-item.js","../src/components/file/document-detail.js","../src/components/file/other-detail.js","../src/components/file/item/file-preview-item.js","../src/components/file/preview.js","../src/components/file-unsorted/detail.js","../src/components/message-search/empty-state.js","../src/components/message-search/search-item.js","../src/components/message-search/detail.js","../src/classes/context-menu/task/task-manager.js","../src/classes/context-menu/task/task-menu.js","../src/components/task/task-item.js","../src/components/task/preview.js","../src/components/task/detail.js","../src/components/brief/brief-item.js","../src/components/brief/detail.js","../src/components/brief/preview.js","../src/classes/context-menu/meeting/meeting-manager.js","../src/classes/context-menu/meeting/meeting-menu.js","../src/components/meeting/meeting-item.js","../src/components/meeting/preview.js","../src/components/meeting/detail.js","../src/components/sign/preview.js","../src/components/sign/detail.js","../src/components/market/market-preview-item.js","../src/components/market/preview.js","../src/components/market/detail.js","../src/classes/context-menu/main/main-menu.js","../src/components/header.js","../src/components/detail-header.js","../src/components/detail-tabs.js","../src/components/message-search/search-header.js","../src/sidebar.js"],"sourcesContent":["import {Type} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {UserManager} from 'im.v2.lib.user';\n\nconst NOT_IMPLEMENTED_ERROR = 'Not implemented';\n\nexport class Base\n{\n\tstore: Object = null;\n\tdialogId: string = '';\n\tchatId: number = 0;\n\tuserManager: UserManager = null;\n\n\tconstructor(chatId: number, dialogId: string)\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.chatId = chatId;\n\t\tthis.dialogId = dialogId;\n\t\tthis.userManager = new UserManager();\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetInitialRequest()\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn Core.getUserId();\n\t}\n\n\tgetLastElementId(collection): ?number\n\t{\n\t\tconst lastId = collection[collection.length - 1]?.id;\n\n\t\tif (Type.isNumber(lastId))\n\t\t{\n\t\t\treturn lastId;\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class BaseFile extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatFileCollectionGet]: [RestMethod.imChatFileCollectionGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadFileError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst fileResult = response[RestMethod.imChatFileCollectionGet].data();\n\n\t\t\treturn this.updateModels(fileResult);\n\t\t};\n\t}\n\n\textractLoadFileError(response): ?string\n\t{\n\t\tconst fileGetResponse = response[RestMethod.imChatFileCollectionGet];\n\t\tif (fileGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatFileCollectionGet}: ${fileGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst fileResult = response.data();\n\t\tif (fileResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.lastId = this.getLastElementId(fileResult.list);\n\n\t\treturn this.updateModels(fileResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users, files} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setFilesPromise = this.store.dispatch('files/set', files);\n\t\tconst setSidebarFilesPromise = this.store.dispatch('sidebar/files/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfiles: list\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, setSidebarFilesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tloadFirstPageBySubType(subType: string): Promise\n\t{\n\t\tconst filesCount = this.getFilesCountFromModel(subType);\n\t\tif (filesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams(subType);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPageBySubType(subType: string): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams(subType);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(subType: string): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'SUBTYPE': subType,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatFileGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: imChatFileGet: page request error', error);\n\t\t});\n\t}\n\n\tgetFilesCountFromModel(subType): number\n\t{\n\t\treturn this.store.getters['sidebar/files/getSize'](this.chatId, subType);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Media extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.media);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.media);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Audio extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.audio);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.audio);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Document extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.document);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.document);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Other extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.other);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.other);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\nexport class Favorite extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatFavoriteCounterGet]: [RestMethod.imChatFavoriteCounterGet, {chat_id: this.chatId}],\n\t\t\t[RestMethod.imChatFavoriteGet]: [RestMethod.imChatFavoriteGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadCountersError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst favoriteCounterGetResponse = response[RestMethod.imChatFavoriteCounterGet].data();\n\t\t\tconst setCounterResult = this.store.dispatch('sidebar/favorites/setCounter', {\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tcounter: favoriteCounterGetResponse.counter\n\t\t\t});\n\n\t\t\tconst setFavoriteResult = this.handleResponse(response[RestMethod.imChatFavoriteGet]);\n\n\t\t\treturn Promise.all([setCounterResult, setFavoriteResult]);\n\t\t};\n\t}\n\n\textractLoadCountersError(response): ?string\n\t{\n\t\tconst favoriteCounterGetResult = response[RestMethod.imChatFavoriteCounterGet];\n\t\tif (favoriteCounterGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatFavoriteCounterGet}: ${favoriteCounterGetResult?.error()}`;\n\t\t}\n\n\t\tconst favoriteGetResult = response[RestMethod.imChatFavoriteGet];\n\t\tif (favoriteGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatFavoriteGet}: ${favoriteGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst favoritesCount = this.getFavoritesCountFromModel();\n\t\tif (favoritesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams.LAST_ID = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatFavoriteGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatFavoriteGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst favoriteMessagesResult = response.data();\n\n\t\tif (favoriteMessagesResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(favoriteMessagesResult.list);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(favoriteMessagesResult);\n\t}\n\n\tupdateModels(resultData: {list: [], users: [], files: []}): Promise\n\t{\n\t\tconst {list = [], users = [], files = []} = resultData;\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\n\t\tconst rawMessages = list.map(favorite => favorite.message);\n\n\t\tconst setFilesPromise = this.store.dispatch('files/set', files);\n\t\tconst storeMessagesPromise = this.store.dispatch('messages/store', rawMessages);\n\t\tconst setFavoritesPromise = this.store.dispatch('sidebar/favorites/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfavorites: list\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, storeMessagesPromise, setFavoritesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tgetFavoritesCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/favorites/getSize'](this.chatId);\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\nimport {Type} from 'main.core';\n\nconst REQUEST_ITEMS_LIMIT = 50;\nexport class Link extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatUrlCounterGet]: [RestMethod.imChatUrlCounterGet, {chat_id: this.chatId}],\n\t\t\t[RestMethod.imChatUrlGet]: [RestMethod.imChatUrlGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}],\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadCountersError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst linkCounterGetResponse = response[RestMethod.imChatUrlCounterGet].data();\n\t\t\tconst setCounterResult = this.store.dispatch('sidebar/links/setCounter', {\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tcounter: linkCounterGetResponse.counter\n\t\t\t});\n\n\t\t\tconst setLinksResult = this.handleResponse(response[RestMethod.imChatUrlGet]);\n\n\t\t\treturn Promise.all([setCounterResult, setLinksResult]);\n\t\t};\n\t}\n\n\textractLoadCountersError(response): string\n\t{\n\t\tconst linkCounterGetResult = response[RestMethod.imChatUrlCounterGet];\n\t\tif (linkCounterGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatUrlCounterGet}: ${linkCounterGetResult?.error()}`;\n\t\t}\n\n\t\tconst linkGetResult = response[RestMethod.imChatUrlGet];\n\t\tif (linkGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatUrlGet}: ${linkGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst linksCount = this.getLinksCountFromModel();\n\t\tif (linksCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams(linksCount);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst linksCount = this.getLinksCountFromModel();\n\t\tconst queryParams = this.getQueryParams(linksCount);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(offset: number = 0): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (Type.isNumber(offset) && offset > 0)\n\t\t{\n\t\t\tqueryParams.OFFSET = offset;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatUrlGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.chatUrlList: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst resultData = response.data();\n\t\tif (resultData.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\treturn this.updateModels(resultData);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setLinksPromise = this.store.dispatch('sidebar/links/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tlinks: list\n\t\t});\n\n\t\treturn Promise.all([setLinksPromise, addUsersPromise]);\n\t}\n\n\tgetLinksCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/links/getSize'](this.chatId);\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Task extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatTaskGet]: [RestMethod.imChatTaskGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadTaskError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\treturn this.handleResponse(response[RestMethod.imChatTaskGet]);\n\t\t};\n\t}\n\n\textractLoadTaskError(response): ?string\n\t{\n\t\tconst taskGetResponse = response[RestMethod.imChatTaskGet];\n\t\tif (taskGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatTaskGet}: ${taskGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst tasksCount = this.getTasksCountFromModel();\n\t\tif (tasksCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatTaskGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatFavoriteGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst tasksResult = response.data();\n\t\tif (tasksResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.firstPageReceived = true;\n\t\tthis.lastId = this.getLastElementId(tasksResult.list);\n\n\t\treturn this.updateModels(tasksResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setTasksPromise = this.store.dispatch('sidebar/tasks/set', {\n\t\t\tchatId: this.chatId,\n\t\t\ttasks: list\n\t\t});\n\n\t\treturn Promise.all([setTasksPromise, addUsersPromise]);\n\t}\n\n\tgetTasksCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/tasks/getSize'](this.chatId);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Main extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imDialogUsersList]: [RestMethod.imDialogUsersList, {\n\t\t\t\tdialog_id: this.dialogId,\n\t\t\t\tlimit: REQUEST_ITEMS_LIMIT\n\t\t\t}]\n\t\t};\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst membersCount = this.getMembersCountFromModel();\n\t\tif (membersCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\treturn {\n\t\t\t'DIALOG_ID': this.dialogId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t\t'LAST_ID': this.lastId,\n\t\t};\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imDialogUsersList, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarMain: Im.DialogUsersList: page request error', error);\n\t\t});\n\t}\n\n\tgetResponseHandler(): Function\n\t{\n\t\treturn (response) => {\n\t\t\treturn this.handleResponse(response[RestMethod.imDialogUsersList]);\n\t\t};\n\t}\n\n\tupdateModels(users: Array): Promise\n\t{\n\t\tconst userIds = [];\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tusers.forEach(user => {\n\t\t\tuserIds.push(user.id);\n\t\t});\n\n\t\tconst setMembersPromise = this.store.dispatch('sidebar/members/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tusers: userIds\n\t\t});\n\n\t\treturn Promise.all([addUsersPromise, setMembersPromise]);\n\t}\n\n\tgetMembersCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/members/getSize'](this.chatId);\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst users = response.data();\n\t\tif (users.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(users);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(users);\n\t}\n}\n","import {SidebarFileTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Brief extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTypes.brief);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTypes.brief);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Meeting extends Base\n{\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatCalendarGet]: [RestMethod.imChatCalendarGet, {\n\t\t\t\tchat_id: this.chatId,\n\t\t\t\tlimit: REQUEST_ITEMS_LIMIT\n\t\t\t}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadTaskError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\treturn this.handleResponse(response[RestMethod.imChatCalendarGet]);\n\t\t};\n\t}\n\n\textractLoadTaskError(response): ?string\n\t{\n\t\tconst calendarGetResponse = response[RestMethod.imChatCalendarGet];\n\t\tif (calendarGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatCalendarGet}: ${calendarGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst meetingsCount = this.getMeetingsCountFromState();\n\t\tif (meetingsCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatCalendarGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatCalendarGet: page request error', error);\n\t\t});\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setMeetingsPromise = this.store.dispatch('sidebar/meetings/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tmeetings: list\n\t\t});\n\n\t\treturn Promise.all([setMeetingsPromise, addUsersPromise]);\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst meetingsResult = response.data();\n\t\tif (meetingsResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.lastId = this.getLastElementId(meetingsResult.list);\n\n\t\treturn this.updateModels(meetingsResult);\n\t}\n\n\tgetMeetingsCountFromState(): number\n\t{\n\t\treturn this.store.getters['sidebar/meetings/getSize'](this.chatId);\n\t}\n}","import {RestMethod, SidebarDetailBlock} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50; // temporary value. Should be 50\n\nexport class FileUnsorted extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imDiskFolderListGet]: [RestMethod.imDiskFolderListGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}],\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadFileError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst fileResult = response[RestMethod.imDiskFolderListGet].data();\n\n\t\t\treturn this.updateModels(fileResult);\n\t\t};\n\t}\n\n\textractLoadFileError(response): ?string\n\t{\n\t\tconst diskFolderListGetResult = response[RestMethod.imDiskFolderListGet];\n\t\tif (diskFolderListGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imDiskFolderListGet}: ${diskFolderListGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst filesCount = this.getFilesCountFromModel(SidebarDetailBlock.fileUnsorted);\n\t\tif (filesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams.LAST_ID = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imDiskFolderListGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imDiskFolderListGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst diskFolderListGetResult = response.data();\n\t\tif (diskFolderListGetResult.files.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(diskFolderListGetResult.files);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(diskFolderListGetResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {users, files} = resultData;\n\n\t\tconst preparedFiles = files.map(file => {\n\t\t\treturn {...file, subType: SidebarDetailBlock.fileUnsorted};\n\t\t});\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setFilesPromise = this.store.dispatch('files/set', preparedFiles);\n\t\tconst setSidebarFilesPromise = this.store.dispatch('sidebar/files/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfiles: preparedFiles\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, setSidebarFilesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tgetFilesCountFromModel(subType): number\n\t{\n\t\treturn this.store.getters['sidebar/files/getSize'](this.chatId, subType);\n\t}\n}","import { RestMethod } from 'im.v2.const';\n\nimport { Base } from './base';\n\ntype RestResponse = {\n\tadditionalMessages: [],\n\tfiles: [],\n\tmessages: [],\n\treactions: [],\n\treminders: [],\n\tusers: [],\n\tusersShort: []\n};\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class MessageSearch extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\t#lastMessageId: number = 0;\n\t#query: string = '';\n\n\tsearchOnServer(query: string): Promise<string[]>\n\t{\n\t\tif (this.#query !== query)\n\t\t{\n\t\t\tthis.#query = query;\n\t\t\tthis.hasMoreItemsToLoad = true;\n\t\t\tthis.#lastMessageId = 0;\n\t\t}\n\n\t\treturn this.#request();\n\t}\n\n\tloadNextPage(): Promise<string[]>\n\t{\n\t\treturn this.#request();\n\t}\n\n\t#request(): Promise<string[]>\n\t{\n\t\tconst config = {\n\t\t\tSEARCH_MESSAGE: this.#query,\n\t\t\tCHAT_ID: this.chatId,\n\t\t};\n\n\t\tif (this.#lastMessageId > 0)\n\t\t{\n\t\t\tconfig.LAST_ID = this.#lastMessageId;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callMethod(RestMethod.imDialogMessagesSearch, config).then((response) => {\n\t\t\t\tconst responseData: RestResponse = response.data();\n\t\t\t\tresolve(this.#processSearchResponse(responseData));\n\t\t\t}).catch((error) => reject(error));\n\t\t});\n\t}\n\n\tgetInitialRequest(): {}\n\t{\n\t\treturn {};\n\t}\n\n\tgetResponseHandler(): Function\n\t{\n\t\treturn () => {};\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tresetSearchState()\n\t{\n\t\tthis.#lastMessageId = 0;\n\t\tthis.#query = '';\n\t\tthis.hasMoreItemsToLoad = true;\n\t}\n\n\t#processSearchResponse(response: RestResponse): Promise<string[]>\n\t{\n\t\tthis.#lastMessageId = this.#getLastMessageId(response);\n\t\tif (response.messages.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\treturn this.#updateModels(response).then(() => {\n\t\t\treturn response.messages.map((message) => message.id);\n\t\t});\n\t}\n\n\t#updateModels(rawData: RestResponse): Promise\n\t{\n\t\tconst {\n\t\t\tfiles,\n\t\t\tusers,\n\t\t\tusersShort,\n\t\t\treactions,\n\t\t\tadditionalMessages,\n\t\t\tmessages,\n\t\t} = rawData;\n\n\t\tconst usersPromise = Promise.all([\n\t\t\tthis.userManager.setUsersToModel(users),\n\t\t\tthis.userManager.addUsersToModel(usersShort),\n\t\t]);\n\t\tconst filesPromise = this.store.dispatch('files/set', files);\n\t\tconst reactionsPromise = this.store.dispatch('messages/reactions/set', reactions);\n\t\tconst additionalMessagesPromise = this.store.dispatch('messages/store', additionalMessages);\n\t\tconst messagesPromise = this.store.dispatch('messages/store', messages);\n\n\t\treturn Promise.all([\n\t\t\tfilesPromise, usersPromise, reactionsPromise, additionalMessagesPromise, messagesPromise,\n\t\t]);\n\t}\n\n\t#getLastMessageId(response: RestResponse): number\n\t{\n\t\tif (response.messages.length === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tresponse.messages.sort((a, b) => {\n\t\t\treturn a.id - b.id;\n\t\t});\n\n\t\tconst [oldestMessage] = response.messages;\n\n\t\treturn oldestMessage.id;\n\t}\n}\n","import { RestMethod } from 'im.v2.const';\nimport { Base } from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\ntype RequestParams = {\n\tfilter: {\n\t\tuserId: number,\n\t},\n\tlimit: number,\n\toffset?: number,\n};\n\ntype RawChatItem = {\n\tavatar: string,\n\tcolor: string,\n\tdescription: string,\n\tdialogId: string,\n\tdiskFolderId: number,\n\tentityData1: string,\n\tentityData2: string,\n\tentityData3: string,\n\tentityId: string,\n\tentityType: string,\n\textranet: boolean,\n\tid: number,\n\tname: string,\n\towner: number,\n\tmessageType: string,\n\trole: string,\n\ttype: string,\n\tmanageUsers: string,\n\tmanageUi: string,\n\tmanageSettings: string,\n\tcanPost: string,\n\tdateUpdate: string,\n}\n\nexport class ChatsWithUser extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\t#chatsCount: number = 0;\n\n\tloadFirstPage(): Promise<string[]>\n\t{\n\t\treturn this.#requestPage();\n\t}\n\n\tloadNextPage(): Promise<string[]>\n\t{\n\t\treturn this.#requestPage();\n\t}\n\n\t#getRequestParams(): RequestParams\n\t{\n\t\tconst userId = Number.parseInt(this.dialogId, 10);\n\n\t\tconst requestParams = {\n\t\t\tfilter: { userId },\n\t\t\tlimit: REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.#chatsCount > 0)\n\t\t{\n\t\t\trequestParams.offset = this.#chatsCount;\n\t\t}\n\n\t\treturn requestParams;\n\t}\n\n\tasync #requestPage(): Promise<string[]>\n\t{\n\t\tconst requestParams = this.#getRequestParams();\n\t\tconst response = await this.restClient.callMethod(RestMethod.imV2ChatListShared, requestParams);\n\n\t\treturn this.#handleResponse(response);\n\t}\n\n\tasync #handleResponse(response): Promise<string[]>\n\t{\n\t\tconst { chats }: { chats: RawChatItem[] } = response.data();\n\t\tthis.#chatsCount += chats.length;\n\t\tif (chats.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tawait this.#updateModels(chats);\n\n\t\treturn chats.map((chat: RawChatItem) => chat.dialogId);\n\t}\n\n\t#updateModels(chats: RawChatItem[]): Promise\n\t{\n\t\treturn Promise.all([\n\t\t\tthis.#setDialoguesPromise(chats),\n\t\t\tthis.#setRecentItems(chats),\n\t\t]);\n\t}\n\n\tgetInitialRequest(): Object\n\t{\n\t\treturn {};\n\t}\n\n\tgetResponseHandler(): Function\n\t{\n\t\treturn () => {};\n\t}\n\n\t#setDialoguesPromise(chats: RawChatItem[]): Promise\n\t{\n\t\treturn this.store.dispatch('chats/set', chats);\n\t}\n\n\t#setRecentItems(chats: RawChatItem[]): Promise\n\t{\n\t\tconst recentItems = [];\n\n\t\tchats.forEach((chat) => {\n\t\t\trecentItems.push({\n\t\t\t\tdialogId: chat.dialogId,\n\t\t\t\tdate_update: chat.dateUpdate,\n\t\t\t});\n\t\t});\n\n\t\treturn this.store.dispatch('recent/store', recentItems);\n\t}\n}\n","import {Extension} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\n\nexport class SettingsManager\n{\n\tstore: Object = null;\n\tsettings: Object = null;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.settings = Extension.getSettings('im.v2.component.sidebar');\n\t\tthis.saveSettings();\n\t}\n\n\tsaveSettings()\n\t{\n\t\tthis.store.dispatch('sidebar/setFilesMigrated', this.settings.get('filesMigrated', false));\n\t\tthis.store.dispatch('sidebar/setLinksMigrated', this.settings.get('linksAvailable', false));\n\t}\n\n\tgetBlocks(): string[]\n\t{\n\t\treturn this.settings.get('blocks', []);\n\t}\n\n\tisLinksMigrationFinished(): boolean\n\t{\n\t\treturn this.store.state.sidebar.isLinksMigrated;\n\t}\n\n\tcanShowBriefs(): boolean\n\t{\n\t\treturn this.settings.get('canShowBriefs', false);\n\t}\n\n\tisFileMigrationFinished(): boolean\n\t{\n\t\treturn this.store.state.sidebar.isFilesMigrated;\n\t}\n}","import {Core} from 'im.v2.application.core';\nimport {PlacementType, SidebarBlock} from 'im.v2.const';\nimport {MarketManager} from 'im.v2.lib.market';\n\nimport {SettingsManager} from './settings-manager';\n\nconst BLOCKS_ORDER = {\n\t[SidebarBlock.main]: 10,\n\t[SidebarBlock.info]: 20,\n\t[SidebarBlock.file]: 30,\n\t[SidebarBlock.brief]: 40,\n\t[SidebarBlock.sign]: 50,\n\t[SidebarBlock.task]: 60,\n\t[SidebarBlock.meeting]: 70,\n};\n\nexport class AvailabilityManager\n{\n\t#settingsManager: SettingsManager = null;\n\t#dialogId: string;\n\n\tconstructor(settingsManager: SettingsManager, dialogId: string)\n\t{\n\t\tthis.#settingsManager = settingsManager;\n\t\tthis.#dialogId = dialogId;\n\t}\n\n\tgetBlocks(): string[]\n\t{\n\t\tconst blocksFromSetting = this.#settingsManager.getBlocks();\n\t\tconst availableBlocks = this.#filterUnavailableBlocks(blocksFromSetting);\n\n\t\treturn this.#sortBlocks(availableBlocks);\n\t}\n\n\t#filterUnavailableBlocks(blocks: string[]): string[]\n\t{\n\t\tconst blocksSet = new Set(blocks);\n\n\t\tif (this.#isFileMigrationFinished())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.fileUnsorted);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.brief);\n\t\t\tblocksSet.delete(SidebarBlock.file);\n\t\t}\n\n\t\tif (!this.#canShowBriefs())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.brief);\n\t\t}\n\n\t\tif (!this.#hasMarketApps())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.market);\n\t\t}\n\n\t\tif (this.#isBot())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.task);\n\t\t\tblocksSet.delete(SidebarBlock.meeting);\n\t\t}\n\n\t\treturn [...blocksSet];\n\t}\n\n\t#isFileMigrationFinished(): boolean\n\t{\n\t\treturn this.#settingsManager.isFileMigrationFinished();\n\t}\n\n\t#canShowBriefs(): boolean\n\t{\n\t\treturn this.#settingsManager.canShowBriefs();\n\t}\n\n\t#hasMarketApps(): boolean\n\t{\n\t\treturn MarketManager.getInstance().getAvailablePlacementsByType(PlacementType.sidebar, this.#dialogId).length > 0;\n\t}\n\n\t#sortBlocks(availableBlocks: string[]): string[]\n\t{\n\t\treturn [...availableBlocks].sort((block1, block2) => {\n\t\t\treturn BLOCKS_ORDER[block1] - BLOCKS_ORDER[block2];\n\t\t});\n\t}\n\n\t#isBot(): boolean\n\t{\n\t\tconst user = Core.getStore().getters['users/get'](this.#dialogId);\n\n\t\treturn user?.bot === true;\n\t}\n}","import { Text, Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { SidebarDetailBlock, SidebarBlock } from 'im.v2.const';\n\nimport { Media } from './blocks/media';\nimport { Audio } from './blocks/audio';\nimport { Document } from './blocks/document';\nimport { Other } from './blocks/other';\nimport { Favorite } from './blocks/favorite';\nimport { Link } from './blocks/link';\nimport { Task } from './blocks/task';\nimport { Main } from './blocks/main';\nimport { Brief } from './blocks/brief';\nimport { Meeting } from './blocks/meeting';\nimport { FileUnsorted } from './blocks/file-unsorted';\nimport { MessageSearch } from './blocks/message-search';\nimport { ChatsWithUser } from './blocks/chats-with-user';\nimport { AvailabilityManager } from './availability-manager';\n\nconst BlockClasses = {\n\tMain,\n\tFavorite,\n\tLink,\n\tTask,\n\tMedia,\n\tAudio,\n\tDocument,\n\tOther,\n\tBrief,\n\tMeeting,\n\tFileUnsorted,\n\tMessageSearch,\n\tChatsWithUser,\n};\n\nconst BlockToServices = Object.freeze({\n\t[SidebarBlock.main]: [SidebarDetailBlock.main],\n\t[SidebarBlock.info]: [SidebarDetailBlock.favorite, SidebarDetailBlock.link],\n\t[SidebarBlock.task]: [SidebarDetailBlock.task],\n\t[SidebarBlock.meeting]: [SidebarDetailBlock.meeting],\n\t[SidebarBlock.file]: [\n\t\tSidebarDetailBlock.media,\n\t\tSidebarDetailBlock.audio,\n\t\tSidebarDetailBlock.document,\n\t\tSidebarDetailBlock.brief,\n\t\tSidebarDetailBlock.other,\n\t],\n\t[SidebarBlock.fileUnsorted]: [SidebarDetailBlock.fileUnsorted],\n\t[SidebarBlock.messageSearch]: [SidebarDetailBlock.messageSearch],\n\t[SidebarBlock.chatsWithUser]: [SidebarDetailBlock.chatsWithUser],\n});\n\ntype BlockService = {\n\ttype: string;\n\tblockManager: Object;\n\tinitialRequest: Object;\n\tresponseHandler: Function;\n};\n\nexport class SidebarService\n{\n\tblockServices: BlockService[] = [];\n\tdialogId: string = '';\n\tchatId: number = 0;\n\tstore: Object = null;\n\trestClient: Object = null;\n\tavailabilityManager: AvailabilityManager = null;\n\n\tconstructor(availabilityManager: AvailabilityManager)\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.availabilityManager = availabilityManager;\n\t}\n\n\t// region public methods\n\trequestInitialData(): Promise\n\t{\n\t\tif (!Type.isArrayFilled(this.blockServices))\n\t\t{\n\t\t\tthis.buildBlocks();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callBatch(\n\t\t\t\tthis.getInitialRequestQuery(),\n\t\t\t\t(result) => resolve(this.handleBatchRequestResult(result)),\n\t\t\t\t(error) => reject(error),\n\t\t\t);\n\t\t});\n\t}\n\n\tgetBlockInstance(blockName: string)\n\t{\n\t\tif (!Type.isArrayFilled(this.blockServices))\n\t\t{\n\t\t\tthis.buildBlocks();\n\t\t}\n\n\t\treturn this.blockServices.find((block: BlockService) => block.type === blockName.toLowerCase())?.blockManager;\n\t}\n\n\tsetChatId(chatId: number)\n\t{\n\t\tthis.chatId = chatId;\n\t}\n\n\tsetDialogId(dialogId: string)\n\t{\n\t\tthis.dialogId = dialogId;\n\t}\n\t// endregion\n\n\tbuildBlocks(): void\n\t{\n\t\tconst classNames = this.getServiceClassesForBlocks();\n\n\t\tthis.blockServices = classNames.map((className: string): BlockService => {\n\t\t\tconst blockManager = new BlockClasses[className](this.chatId, this.dialogId);\n\n\t\t\treturn {\n\t\t\t\ttype: className.toLowerCase(),\n\t\t\t\tblockManager,\n\t\t\t\tinitialRequest: blockManager.getInitialRequest(),\n\t\t\t\tresponseHandler: blockManager.getResponseHandler(),\n\t\t\t};\n\t\t});\n\t}\n\n\tgetServiceClassesForBlocks(): string[]\n\t{\n\t\tconst services = [];\n\n\t\tconst blockList = this.availabilityManager.getBlocks();\n\t\tblockList.forEach((block: string) => {\n\t\t\tconst blockServices = BlockToServices[block];\n\t\t\tif (blockServices)\n\t\t\t{\n\t\t\t\tservices.push(...blockServices);\n\t\t\t}\n\t\t});\n\n\t\treturn services.map((service) => Text.capitalize(service));\n\t}\n\n\tgetInitialRequestQuery(): Object\n\t{\n\t\tlet query = {};\n\t\tthis.blockServices.forEach((block) => {\n\t\t\tquery = Object.assign(query, block.initialRequest);\n\t\t});\n\n\t\treturn query;\n\t}\n\n\thandleBatchRequestResult(response): Promise\n\t{\n\t\tconst responseHandlersResult = [];\n\t\tthis.blockServices.forEach((block) => {\n\t\t\tresponseHandlersResult.push(block.responseHandler(response));\n\t\t});\n\n\t\treturn Promise.all(responseHandlersResult).then(() => {\n\t\t\treturn this.setInited();\n\t\t}).catch((error) => console.error(error));\n\t}\n\n\tsetInited(): Promise\n\t{\n\t\treturn this.store.dispatch('sidebar/setInited', this.chatId);\n\t}\n}\n","import { Text } from 'main.core';\n\nimport '../css/detail-empty-state.css';\n\n// @vue/component\nexport const DetailEmptyState = {\n\tname: 'DetailEmptyState',\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ticonType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn `--${Text.toKebabCase(this.iconType)}`;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-empty-state__container bx-im-sidebar-detail-empty-state__scope\">\n\t\t\t<span class=\"bx-im-sidebar-detail-empty-state__icon\" :class=\"[iconClass]\"></span>\n\t\t\t<span class=\"bx-im-sidebar-detail-empty-state__text\">{{ title }}</span>\n\t\t</div>\n\t`,\n};\n","import { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\nimport '../../css/chat-with-user/chat-item.css';\n\nimport type { ImModelRecentItem } from 'im.v2.model';\n\n// @vue/component\nexport const ChatItem = {\n\tname: 'ChatItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['clickItem', 'rightClickItem'],\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.$store.getters['recent/get'](this.dialogId);\n\t\t},\n\t\tchatItemText(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_GROUP_V2');\n\t\t},\n\t\tformattedDate(): string\n\t\t{\n\t\t\tif (!this.recentItem.dateUpdate)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.formatDate(this.recentItem.dateUpdate);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonClick(event)\n\t\t{\n\t\t\tthis.$emit('clickItem', {\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\tnativeEvent: event,\n\t\t\t});\n\t\t},\n\t\tformatDate(date: Date): string\n\t\t{\n\t\t\treturn DateFormatter.formatByTemplate(date, DateTemplate.recent);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\t@click=\"onClick\"\n\t\t\tclass=\"bx-im-chat-with-user-item__container bx-im-chat-with-user-item__scope\"\n\t\t>\n\t\t\t<div class=\"bx-im-chat-with-user-item__avatar-container\">\n\t\t\t\t<Avatar :dialogId=\"dialogId\" :size=\"AvatarSize.XL\" />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-chat-with-user-item__content-container\">\n\t\t\t\t<div class=\"bx-im-chat-with-user-item__content_header\">\n\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" />\n\t\t\t\t\t<div v-if=\"formattedDate.length > 0\" class=\"bx-im-chat-with-user-item__date\">\n\t\t\t\t\t\t<span>{{ formattedDate }}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-chat-with-user-item__item-text\" :title=\"chatItemText\">\n\t\t\t\t\t{{ chatItemText }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Messenger } from 'im.public';\nimport { SidebarDetailBlock } from 'im.v2.const';\nimport { Loader } from 'im.v2.component.elements';\n\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { ChatItem } from './chat-item';\n\nimport '../../css/chat-with-user/detail.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const ChatsWithUserDetail = {\n\tname: 'ChatsWithUserDetail',\n\tcomponents: { ChatItem, DetailEmptyState, Loader },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tchats: [],\n\t\t\tcurrentServerQueries: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn !this.isLoading && this.chats.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.loadFirstPage();\n\t},\n\tmethods:\n\t{\n\t\tonClick(event)\n\t\t{\n\t\t\tconst { dialogId } = event;\n\n\t\t\tvoid Messenger.openChat(dialogId);\n\t\t},\n\t\tasync loadFirstPage()\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tthis.chats = await this.service.loadFirstPage();\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tneedToLoadNextPage(event): boolean\n\t\t{\n\t\t\tconst target = event.target;\n\n\t\t\treturn target.scrollTop + target.clientHeight >= target.scrollHeight - target.clientHeight;\n\t\t},\n\t\tasync onScroll(event)\n\t\t{\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.needToLoadNextPage(event) || !this.service.hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tconst nextPageChats = await this.service.loadNextPage();\n\t\t\tthis.chats = [...this.chats, ...nextPageChats];\n\t\t\tthis.isLoading = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-chats-with-user-detail__container bx-im-sidebar-chats-with-user-detail__scope\" @scroll=\"onScroll\">\n\t\t\t<ChatItem\n\t\t\t\tv-for=\"chat in chats\"\n\t\t\t\t:dialog-id=\"chat\"\n\t\t\t\t@clickItem=\"onClick\"\n\t\t\t/>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_CHATS_WITH_USER_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.messageSearch\"\n\t\t\t/>\n\t\t\t<Loader v-if=\"isLoading\" class=\"bx-im-sidebar-chats-with-user-detail__loader-container\" />\n\t\t</div>\n\t`,\n};\n","import { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { ImModelUser } from 'im.v2.model';\n\n// @vue/component\nexport const DetailUser = {\n\tname: 'DetailUser',\n\tcomponents: { Avatar, ChatTitle },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisModerator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): {showContextButton: boolean}\n\t{\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tposition(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.dialogId, true);\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonClickContextMenu(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tuserDialogId: this.dialogId,\n\t\t\t\ttarget: event.currentTarget,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bx-im-sidebar-main-detail__user\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__avatar-container\">\n\t\t\t\t<Avatar :size=\"AvatarSize.L\" :dialogId=\"dialogId\" />\n\t\t\t\t<span v-if=\"isModerator\" class=\"bx-im-sidebar-main-detail__avatar-moderator-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__user-info-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-detail__user-title-container\">\n\t\t\t\t\t<a :href=\"userLink\" target=\"_blank\" class=\"bx-im-sidebar-main-detail__user-title-link\">\n\t\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" />\n\t\t\t\t\t</a>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\t\tclass=\"bx-im-sidebar-main-detail__context-menu-icon bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t\t@click=\"onClickContextMenu\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-main-detail__position-text\" :title=\"position\">\n\t\t\t\t\t{{ position }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\t\n\t`,\n};\n","import {Loader} from 'im.v2.component.elements';\nimport '../css/detail.css';\n\n// @vue/component\nexport const SidebarDetail = {\n\tname: 'SidebarDetail',\n\tcomponents: {Loader},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['onScroll'],\n\tdata() {\n\t\treturn {\n\t\t\tisLoading: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\thasInitialData(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/isInited'](this.chatId);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.loadFirstPage();\n\t},\n\tmethods:\n\t{\n\t\tloadFirstPage()\n\t\t{\n\t\t\tif (this.hasInitialData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadFirstPage().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\t\tneedToLoadNextPage(event)\n\t\t{\n\t\t\treturn event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight - event.target.clientHeight;\n\t\t},\n\t\tonScroll(event)\n\t\t{\n\t\t\tthis.$emit('onScroll');\n\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.needToLoadNextPage(event) || !this.service.hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadNextPage().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail__container bx-im-sidebar-detail__scope\" @scroll=\"onScroll\">\n\t\t\t<slot :isLoading=\"isLoading\" :chatId=\"chatId\" :dialogId=\"dialogId\"></slot>\n\t\t\t<Loader v-if=\"isLoading\" class=\"bx-im-sidebar-detail__loader-container\" />\n\t\t</div>\n\t`\n};","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {BaseMenu} from 'im.v2.lib.menu';\nimport {EventType} from 'im.v2.const';\nimport type {MenuItem} from 'im.v2.lib.menu';\n\nexport class SidebarMenu extends BaseMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.id = 'im-sidebar-context-menu';\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t};\n\t}\n\n\tgetOpenContextMessageItem(): ?MenuItem\n\t{\n\t\tif (!this.context.messageId || this.context.messageId === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_GO_TO_CONTEXT_MESSAGE'),\n\t\t\tonclick: () => {\n\t\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\t\tmessageId: this.context.messageId,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetCopyLinkItem(title: string): ?MenuItem\n\t{\n\t\tif (!BX.clipboard.isCopySupported())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: title,\n\t\t\tonclick: () => {\n\t\t\t\tif (BX.clipboard.copy(this.context.source))\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_SIDEBAR_COPIED_SUCCESS')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n}","import { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { CallManager } from 'im.v2.lib.call';\nimport { showKickUserConfirm, showLeaveFromChatConfirm } from 'im.v2.lib.confirm';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ChatActionType, EventType } from 'im.v2.const';\nimport { ChatService } from 'im.v2.provider.service';\nimport { Messenger } from 'im.public';\n\nimport { SidebarMenu } from '../sidebar-base-menu';\n\nimport type { ImModelUser } from 'im.v2.model';\nimport type { MenuItem } from 'im.v2.lib.menu';\n\ntype MembersMenuContext = {\n\tdialogId: string,\n\tcontextDialogId: string,\n\tcontextChatId: string,\n};\n\nexport class MembersMenu extends SidebarMenu\n{\n\tcontext: MembersMenuContext;\n\tchatService: ChatService;\n\tcallManager: CallManager;\n\tpermissionManager: PermissionManager;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.chatService = new ChatService();\n\t\tthis.callManager = CallManager.getInstance();\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getInsertNameItem(),\n\t\t\tthis.getSendMessageItem(),\n\t\t\tthis.getCallItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getOpenUserCalendarItem(),\n\t\t\tthis.getKickItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetInsertNameItem(): MenuItem\n\t{\n\t\tconst user: ImModelUser = this.store.getters['users/get'](this.context.dialogId, true);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_INSERT_NAME'),\n\t\t\tonclick: () => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertMention, {\n\t\t\t\t\tmentionText: user.name,\n\t\t\t\t\tmentionReplacement: Utils.text.getMentionBbCode(this.context.dialogId, user.name),\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetSendMessageItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_WRITE'),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCallItem(): ?MenuItem\n\t{\n\t\tconst chatCanBeCalled = this.callManager.chatCanBeCalled(this.context.dialogId);\n\t\tconst chatIsAllowedToCall = this.permissionManager.canPerformAction(ChatActionType.call, this.context.dialogId);\n\t\tif (!chatCanBeCalled || !chatIsAllowedToCall)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_CALL_2'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.callManager.startCall(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenProfileItem(): ?MenuItem\n\t{\n\t\tif (!this.isUser() || this.isBot())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE'),\n\t\t\thref: profileUri,\n\t\t\tonclick: () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenUserCalendarItem(): ?MenuItem\n\t{\n\t\tif (!this.isUser() || this.isBot())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getCalendarLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_CALENDAR'),\n\t\t\tonclick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetKickItem(): ?MenuItem\n\t{\n\t\tconst userIdToKick = Number.parseInt(this.context.dialogId, 10);\n\t\tconst isSelfKick = userIdToKick === this.getCurrentUserId();\n\t\tconst canKick = this.permissionManager.canPerformAction(ChatActionType.kick, this.context.contextDialogId);\n\t\tif (isSelfKick || !canKick)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_KICK_FROM_CHAT'),\n\t\t\tonclick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showKickUserConfirm();\n\t\t\t\tif (userChoice === true)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.kickUserFromChat(this.context.contextDialogId, this.context.dialogId);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\tgetLeaveItem(): ?MenuItem\n\t{\n\t\tconst userIdToKick = Number.parseInt(this.context.dialogId, 10);\n\t\tconst isSelfKick = userIdToKick === this.getCurrentUserId();\n\n\t\tconst canLeaveChat = this.permissionManager.canPerformAction(ChatActionType.leave, this.context.contextDialogId);\n\t\tif (!isSelfKick || !canLeaveChat)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_LEAVE'),\n\t\t\tonclick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showLeaveFromChatConfirm();\n\t\t\t\tif (userChoice === true)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.leaveChat(this.context.contextDialogId);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\tisUser(): boolean\n\t{\n\t\treturn this.store.getters['chats/isUser'](this.context.dialogId);\n\t}\n\n\tisBot(): boolean\n\t{\n\t\tif (!this.isUser())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst user: ImModelUser = this.store.getters['users/get'](this.context.dialogId);\n\n\t\treturn user.bot === true;\n\t}\n}\n","import {Core} from 'im.v2.application.core';\nimport {ImModelChat} from 'im.v2.model';\nimport {Button, ButtonColor, ButtonSize} from 'im.v2.component.elements';\n\nimport {DetailUser} from './detail-user';\nimport {SidebarDetail} from '../detail';\nimport {MembersMenu} from '../../classes/context-menu/main/members-menu';\n\nimport '../../css/main/detail.css';\n\n// @vue/component\nexport const MainDetail = {\n\tname: 'MainDetail',\n\tcomponents: {DetailUser, SidebarDetail, Button},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tdialogManagers(): number[]\n\t\t{\n\t\t\treturn this.dialog.managerList;\n\t\t},\n\t\tdialogIds(): string[]\n\t\t{\n\t\t\tconst users = this.$store.getters['sidebar/members/get'](this.chatId);\n\n\t\t\treturn users.map(userId => userId.toString());\n\t\t},\n\t\tshowCopyInviteButton(): boolean\n\t\t{\n\t\t\t// todo\n\t\t\treturn true;\n\t\t},\n\t\tchatLink(): string\n\t\t{\n\t\t\treturn `${Core.getHost()}/online/?IM_DIALOG=${this.dialogId}`;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MembersMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tisModerator(userDialogId: string): boolean\n\t\t{\n\t\t\tconst userId = Number.parseInt(userDialogId, 10);\n\n\t\t\treturn this.dialogManagers.includes(userId);\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tdialogId: event.userDialogId,\n\t\t\t\tcontextDialogId: this.dialogId,\n\t\t\t\tcontextChatId: this.chatId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonCopyInviteClick()\n\t\t{\n\t\t\tif (BX.clipboard.copy(this.chatLink))\n\t\t\t{\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_COPIED_SUCCESS')\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-main-detail__scope\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__invitation-button-container\">\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"showCopyInviteButton\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_COPY_INVITE_LINK')\"\n\t\t\t\t\t:size=\"ButtonSize.M\"\n\t\t\t\t\t:color=\"ButtonColor.PrimaryBorder\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\ticon=\"link\"\n\t\t\t\t\t@click=\"onCopyInviteClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailUser \n\t\t\t\tv-for=\"dialogId in dialogIds\" \n\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t:isModerator=\"isModerator(dialogId)\"\n\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import { hint } from 'ui.vue3.directives.hint';\n\nimport { Core } from 'im.v2.application.core';\nimport { Toggle, ToggleSize } from 'im.v2.component.elements';\nimport { ImModelChat } from 'im.v2.model';\nimport { ChatActionType } from 'im.v2.const';\nimport { ChatService } from 'im.v2.provider.service';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport '../../css/main/settings.css';\n\n// @vue/component\nexport const Settings = {\n\tname: 'MainPreviewSettings',\n\tdirectives: { hint },\n\tcomponents: { Toggle },\n\tprops:\n\t{\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisModerator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tautoDeleteEnabled: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tToggleSize: () => ToggleSize,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisGroupChat(): boolean\n\t\t{\n\t\t\treturn this.dialogId.startsWith('chat');\n\t\t},\n\t\tcanBeMuted(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.mute, this.dialogId);\n\t\t},\n\t\tisChatMuted(): boolean\n\t\t{\n\t\t\tconst isMuted = this.dialog.muteList.find((element) => {\n\t\t\t\treturn element === Core.getUserId();\n\t\t\t});\n\n\t\t\treturn Boolean(isMuted);\n\t\t},\n\t\thintMuteNotAvailable(): ?Object\n\t\t{\n\t\t\tif (this.canBeMuted)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MUTE_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 141,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\thintAutoDeleteNotAvailable()\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_MESSENGER_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 125,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tchatTypeClass(): string\n\t\t{\n\t\t\treturn this.isGroupChat ? '--group-chat' : '--personal';\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tmuteActionHandler()\n\t\t{\n\t\t\tif (!this.canBeMuted)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isChatMuted)\n\t\t\t{\n\t\t\t\tthis.getChatService().unmuteChat(this.dialogId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getChatService().muteChat(this.dialogId);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-settings__skeleton\" :class=\"chatTypeClass\"></div>\n\t\t<div v-else class=\"bx-im-sidebar-main-settings__container bx-im-sidebar-main-settings__scope\" :class=\"chatTypeClass\">\n\t\t\t<div\n\t\t\t\tv-if=\"isGroupChat\"\n\t\t\t\tclass=\"bx-im-sidebar-main-settings__notification-container\"\n\t\t\t\t:class=\"[canBeMuted ? '' : '--not-active']\"\n\t\t\t\tv-hint=\"hintMuteNotAvailable\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__notification-title\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-settings__title-text bx-im-sidebar-main-settings__title-icon --notification\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_ENABLE_NOTIFICATION_TITLE_2') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Toggle :size=\"ToggleSize.M\" :isEnabled=\"!isChatMuted\" @change=\"muteActionHandler\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-container --not-active\" v-hint=\"hintAutoDeleteNotAvailable\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-title\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-settings__title-text bx-im-sidebar-main-settings__title-icon --autodelete\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_ENABLE_AUTODELETE_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Toggle :size=\"ToggleSize.M\" :isEnabled=\"autoDeleteEnabled\" />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-status\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_AUTODELETE_STATUS_OFF') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { hint } from 'ui.vue3.directives.hint';\n\nimport { Avatar, AvatarSize, ChatTitle, Button as MessengerButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { ChatActionType } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport { Settings } from './settings';\n\nimport '../../css/main/preview-personal-chat.css';\n\nimport type { ImModelChat, ImModelUser } from 'im.v2.model';\n\n// @vue/component\nexport const PersonalChatPreview = {\n\tname: 'PersonalChatPreview',\n\tdirectives: { hint },\n\tcomponents: { Avatar, ChatTitle, MessengerButton, AddToChat, Settings },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tuserPosition(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tcanInviteMembers(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t},\n\t\tshowInviteButton(): boolean\n\t\t{\n\t\t\tif (this.isBot)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.canInviteMembers;\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t\tisBot(): boolean\n\t\t{\n\t\t\treturn this.user.bot === true;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-main-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-personal-chat__avatar-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-personal-chat__avatar-container\">\n\t\t\t\t<Avatar\n\t\t\t\t\t:size=\"AvatarSize.XXXL\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\tclass=\"bx-im-sidebar-main-preview-personal-chat__avatar\"\n\t\t\t\t/>\n\t\t\t\t<a :href=\"userLink\" target=\"_blank\">\n\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" class=\"bx-im-sidebar-main-preview-personal-chat__user-name\" />\n\t\t\t\t</a>\n\t\t\t\t<div class=\"bx-im-sidebar-main-preview-personal-chat__user-position\" :title=\"userPosition\">\n\t\t\t\t\t{{ userPosition }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-personal-chat__invite-button-skeleton\"></div>\n\t\t\t<div v-else-if=\"showInviteButton\" class=\"bx-im-sidebar-main-preview-personal-chat__invite-button-container\" ref=\"add-members\">\n\t\t\t\t<MessengerButton\n\t\t\t\t\tv-if=\"canInviteMembers\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_CREATE_GROUP_CHAT')\"\n\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<Settings :isLoading=\"isLoading\" :dialogId=\"dialogId\" />\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: -220, offsetLeft: -320}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ImModelChat } from 'im.v2.model';\nimport { ChatActionType } from 'im.v2.const';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { Avatar, AvatarSize, ChatTitle, Button as MessengerButton, ButtonSize, ButtonColor } from 'im.v2.component.elements';\n\nimport { Settings } from './settings';\n\nimport '../../css/main/preview-group-chat.css';\n\n// @vue/component\nexport const GroupChatPreview = {\n\tname: 'GroupChatPreview',\n\tcomponents: { Avatar, ChatTitle, MessengerButton, AddToChat, Settings },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tdialogIds(): string[]\n\t\t{\n\t\t\tconst PREVIEW_USERS_COUNT = 4;\n\t\t\tconst userIds = this.$store.getters['sidebar/members/get'](this.chatId);\n\n\t\t\treturn userIds.map((id) => id.toString()).slice(0, PREVIEW_USERS_COUNT);\n\t\t},\n\t\tusersInChatCount(): number\n\t\t{\n\t\t\treturn this.dialog.userCounter;\n\t\t},\n\t\tmoreUsersCount(): number\n\t\t{\n\t\t\treturn Math.max(this.usersInChatCount - this.dialogIds.length, 0);\n\t\t},\n\t\tcanSeeMembers(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.userList, this.dialogId);\n\t\t},\n\t\tcanInviteMembers(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenUsers()\n\t\t{\n\t\t\tthis.$emit('openDetail');\n\t\t},\n\t\tonOpenInvitePopup()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-main-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-group-chat__avatar-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-group-chat__avatar-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-preview-group-chat__avatar\">\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XXXL\" :dialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t\t<ChatTitle :dialogId=\"dialogId\" :twoLine=\"true\" class=\"bx-im-sidebar-main-preview-group-chat__title\" />\n\t\t\t</div>\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-group-chat__members-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-group-chat__members-container\">\n\t\t\t\t<div v-if=\"canSeeMembers\" class=\"bx-im-sidebar-main-preview-group-chat__members\" @click=\"onOpenUsers\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-preview-group-chat__members-avatars\" >\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-main-preview-group-chat__chat-user-avatar\"\n\t\t\t\t\t\t\tv-for=\"id in dialogIds\"\n\t\t\t\t\t\t\t:size=\"AvatarSize.S\"\n\t\t\t\t\t\t\t:dialogId=\"id\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"moreUsersCount > 0\" class=\"bx-im-sidebar-main-preview-group-chat__more-users-count-text\">\n\t\t\t\t\t\t+{{ moreUsersCount }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div ref=\"add-members\">\n\t\t\t\t\t<MessengerButton\n\t\t\t\t\t\tv-if=\"canInviteMembers\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t@click=\"onOpenInvitePopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Settings :isLoading=\"isLoading\" :dialogId=\"dialogId\" />\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: -220, offsetLeft: -420}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {PersonalChatPreview} from './preview-personal-chat';\nimport {GroupChatPreview} from './preview-group-chat';\n\n// @vue/component\nexport const MainPreview = {\n\tname: 'MainPreview',\n\tcomponents: {GroupChatPreview, PersonalChatPreview},\n\tinheritAttrs: false,\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tisGroupChat(): boolean\n\t\t{\n\t\t\treturn this.dialogId.startsWith('chat');\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.main, detailBlock: SidebarDetailBlock.main});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<GroupChatPreview \n\t\t\tv-if=\"isGroupChat\" \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:isLoading=\"isLoading\" \n\t\t\t@openDetail=\"onOpenDetail\"\n\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t/>\n\t\t<PersonalChatPreview \n\t\t\tv-else \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:isLoading=\"isLoading\"\n\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t/>\n\t`\n};","import {ImModelChat} from 'im.v2.model';\nimport {ChatType, SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {Parser} from 'im.v2.lib.parser';\nimport {hint} from 'ui.vue3.directives.hint';\nimport '../../css/info/preview.css';\n\nimport type { ImModelUser } from 'im.v2.model';\n\nconst MAX_DESCRIPTION_SYMBOLS = 25;\n\n// @vue/component\nexport const InfoPreview = {\n\tname: 'InfoPreview',\n\tdirectives: {hint},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\texpanded: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.user;\n\t\t},\n\t\tisBot(): boolean\n\t\t{\n\t\t\tconst user: ImModelUser = this.$store.getters['users/get'](this.dialogId);\n\n\t\t\treturn user?.bot === true;\n\t\t},\n\t\tpreviewDescription(): string\n\t\t{\n\t\t\tif (this.dialog.description.length === 0)\n\t\t\t{\n\t\t\t\treturn this.chatTypeText;\n\t\t\t}\n\n\t\t\tif (this.dialog.description.length > MAX_DESCRIPTION_SYMBOLS)\n\t\t\t{\n\t\t\t\treturn `${this.dialog.description.slice(0, MAX_DESCRIPTION_SYMBOLS)}...`;\n\t\t\t}\n\n\t\t\treturn this.dialog.description;\n\t\t},\n\t\tdescriptionToShow(): string\n\t\t{\n\t\t\tconst rawText = this.expanded ? this.dialog.description : this.previewDescription;\n\n\t\t\treturn Parser.purifyText(rawText);\n\t\t},\n\t\tchatTypeText(): string\n\t\t{\n\t\t\tif (this.isBot)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_BOT');\n\t\t\t}\n\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_USER');\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_GROUP_V2');\n\t\t},\n\t\tshowExpandButton(): boolean\n\t\t{\n\t\t\tif (this.expanded)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.dialog.description.length >= MAX_DESCRIPTION_SYMBOLS;\n\t\t},\n\t\tfavoriteCounter(): string\n\t\t{\n\t\t\tconst counter = this.$store.getters['sidebar/favorites/getCounter'](this.chatId);\n\n\t\t\treturn this.getCounterString(counter);\n\t\t},\n\t\turlCounter(): string\n\t\t{\n\t\t\tconst counter = this.$store.getters['sidebar/links/getCounter'](this.chatId);\n\n\t\t\treturn this.getCounterString(counter);\n\t\t},\n\t\tisLinksAvailable(): boolean\n\t\t{\n\t\t\treturn this.$store.state.sidebar.isLinksMigrated;\n\t\t},\n\t\thintDirectiveContent(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_LINKS_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 141,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetCounterString(counter: number): string\n\t\t{\n\t\t\tconst MAX_COUNTER = 100;\n\t\t\tif (counter >= MAX_COUNTER)\n\t\t\t{\n\t\t\t\treturn '99+';\n\t\t\t}\n\n\t\t\treturn counter.toString();\n\t\t},\n\t\tonFavouriteClick()\n\t\t{\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.info, detailBlock: SidebarDetailBlock.favorite});\n\t\t},\n\t\tonLinkClick()\n\t\t{\n\t\t\tif (!this.isLinksAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.info, detailBlock: SidebarDetailBlock.link});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-info-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-info-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-info-preview__container\" :class=\"[expanded ? '--expanded' : '']\">\n\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-container\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-text-container\" :class=\"[expanded ? '--expanded' : '']\">\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-text\">\n\t\t\t\t\t\t\t{{descriptionToShow}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tv-if=\"showExpandButton\"\n\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__show-description-button\"\n\t\t\t\t\t\t@click=\"expanded = !expanded\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_DESCRIPTION_SHOW') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-info-preview__items-container\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__item-container\" @click=\"onFavouriteClick\">\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-container\">\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__favorite-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_FAVORITE_DETAIL_TITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__counter-container\">\n\t\t\t\t\t\t\t<span class=\"bx-im-sidebar-info-preview__counter\">{{favoriteCounter}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__item-container\" \n\t\t\t\t\t\t:class=\"[isLinksAvailable ? '' : '--links-not-active']\"\n\t\t\t\t\t\t@click=\"onLinkClick\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tv-if=\"!isLinksAvailable\" \n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__hint-not-active\" \n\t\t\t\t\t\t\tv-hint=\"hintDirectiveContent\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-container\">\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__link-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_LINK_DETAIL_TITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__counter-container\">\n\t\t\t\t\t\t\t<span class=\"bx-im-sidebar-info-preview__counter\">{{urlCounter}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\ntype FormattableCollection = {\n\tdate: Date,\n};\n\ntype DateGroup = {\n\tid: number,\n\ttitle: string\n};\n\nexport class SidebarCollectionFormatter\n{\n\tcachedDateGroups: Object = {};\n\n\tformat(collection: FormattableCollection[]): Object[]\n\t{\n\t\tconst dateGroups = {};\n\n\t\tcollection.forEach((item) => {\n\t\t\tconst dateGroup = this.getDateGroup(item.date);\n\t\t\tif (!dateGroups[dateGroup.title])\n\t\t\t{\n\t\t\t\tdateGroups[dateGroup.title] = {\n\t\t\t\t\tdateGroupTitle: dateGroup.title,\n\t\t\t\t\titems: [],\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tdateGroups[dateGroup.title].items.push(item);\n\t\t});\n\n\t\treturn Object.values(dateGroups);\n\t}\n\n\tgetDateGroup(date: Date): DateGroup\n\t{\n\t\tconst INDEX_BETWEEN_DATE_AND_TIME = 10;\n\t\t// 2022-10-25T14:58:44.000Z => 2022-10-25\n\t\tconst shortDate = date.toJSON().slice(0, INDEX_BETWEEN_DATE_AND_TIME);\n\t\tif (this.cachedDateGroups[shortDate])\n\t\t{\n\t\t\treturn this.cachedDateGroups[shortDate];\n\t\t}\n\n\t\tthis.cachedDateGroups[shortDate] = {\n\t\t\tid: shortDate,\n\t\t\ttitle: DateFormatter.formatByTemplate(date, DateTemplate.dateGroup),\n\t\t};\n\n\t\treturn this.cachedDateGroups[shortDate];\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.cachedDateGroups = {};\n\t}\n}\n","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class LinkManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete(link: Object)\n\t{\n\t\tthis.store.dispatch('sidebar/links/delete', {\n\t\t\tchatId: link.chatId,\n\t\t\tid: link.id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': link.id};\n\t\tthis.restClient.callMethod(RestMethod.imChatUrlDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting link', error);\n\t\t});\n\t}\n}","import {Loc} from 'main.core';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {LinkManager} from './link-manager';\nimport 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\n\nexport class LinkMenu extends SidebarMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.linkManager = new LinkManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_LINK')),\n\t\t\tthis.getDeleteLinkItem(),\n\t\t];\n\t}\n\n\tgetDeleteLinkItem(): ?MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_FROM_LINKS'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.linkManager.delete(this.context);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport '../../css/info/link-item.css';\n\nimport type { ImModelSidebarLinkItem } from 'im.v2.model';\n\n// @vue/component\nexport const LinkItem = {\n\tname: 'LinkItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops:\n\t{\n\t\tlink: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tlinkItem(): ImModelSidebarLinkItem\n\t\t{\n\t\t\treturn this.link;\n\t\t},\n\t\tsource(): string\n\t\t{\n\t\t\treturn this.linkItem.source;\n\t\t},\n\t\tshortDescription(): string\n\t\t{\n\t\t\tlet hostName = '';\n\t\t\ttry\n\t\t\t{\n\t\t\t\thostName = new URL(this.source).hostname;\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\thostName = this.source;\n\t\t\t\tconsole.error(error);\n\t\t\t}\n\n\t\t\treturn hostName;\n\t\t},\n\t\tdescription(): string\n\t\t{\n\t\t\tconst { name, description } = this.linkItem.richData;\n\t\t\tconst descriptionToShow = description || name || this.source;\n\n\t\t\treturn Utils.text.convertHtmlEntities(descriptionToShow);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.linkItem.authorId.toString();\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn Boolean(this.linkItem.richData?.previewUrl);\n\t\t},\n\t\tpreviewStyles(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.linkItem.richData?.previewUrl}')`,\n\t\t\t\tbackgroundSize: 'cover',\n\t\t\t\tbackgroundRepeat: 'no-repeat',\n\t\t\t};\n\t\t},\n\t\ticonTypeClass(): string\n\t\t{\n\t\t\tswitch (this.linkItem.richData?.type)\n\t\t\t{\n\t\t\t\tcase 'TASKS':\n\t\t\t\t\treturn '--task';\n\t\t\t\tcase 'LANDING':\n\t\t\t\t\treturn '--landing';\n\t\t\t\tcase 'POST':\n\t\t\t\t\treturn '--post';\n\t\t\t\tcase 'CALENDAR':\n\t\t\t\t\treturn '--calendar';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '--common';\n\t\t\t}\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tid: this.linkItem.id,\n\t\t\t\tmessageId: this.linkItem.messageId,\n\t\t\t\tsource: this.source,\n\t\t\t\ttarget: event.currentTarget,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-link-item__container bx-im-link-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<template v-if=\"hasPreview\">\n\t\t\t\t<div class=\"bx-im-link-item__icon-container\" :style=\"previewStyles\"></div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-im-link-item__icon-container\" :class=\"iconTypeClass\">\n\t\t\t\t\t<div class=\"bx-im-link-item__icon\" :class=\"iconTypeClass\" ></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div class=\"bx-im-link-item__content\">\n\t\t\t\t<div class=\"bx-im-link-item__short-description-text\">{{ shortDescription }}</div>\n\t\t\t\t<a :href=\"source\" :title=\"description\" target=\"_blank\" class=\"bx-im-link-item__description-text\">\n\t\t\t\t\t{{ description }}\n\t\t\t\t</a>\n\t\t\t\t<div class=\"bx-im-link-item__author-container\">\n\t\t\t\t\t<Avatar \n\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t:dialogId=\"authorDialogId\" \n\t\t\t\t\t\tclass=\"bx-im-link-item__author-avatar\" \n\t\t\t\t\t/>\n\t\t\t\t\t<ChatTitle :dialogId=\"authorDialogId\" :showItsYou=\"false\" class=\"bx-im-link-item__author-text\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"showContextButton\" class=\"bx-im-link-item__context-menu\">\n\t\t\t\t<button class=\"bx-im-messenger__context-menu-icon\" @click=\"onContextMenuClick\"></button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/date-group.css';\n\n// @vue/component\nexport const DateGroup = {\n\tname: 'DateGroup',\n\tprops: {\n\t\tdateText: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-date-group__container bx-im-sidebar-date-group__scope\">\n\t\t\t<div class=\"bx-im-sidebar-date-group__text\">\n\t\t\t\t{{ dateText }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { LinkMenu } from '../../classes/context-menu/link/link-menu';\nimport { SidebarDetail } from '../detail';\nimport { LinkItem } from './link-item';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/info/link-detail.css';\n\nimport type { ImModelSidebarLinkItem } from 'im.v2.model';\n\n// @vue/component\nexport const LinkDetail = {\n\tname: 'LinkDetail',\n\tcomponents: { LinkItem, SidebarDetail, DateGroup, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tlinks(): ImModelSidebarLinkItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/links/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.links);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new LinkMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tid: event.id,\n\t\t\t\tmessageId: event.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tsource: event.source,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-link-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-link-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<template v-for=\"link in dateGroup.items\">\n\t\t\t\t\t<LinkItem :link=\"link\" @contextMenuClick=\"onContextMenuClick\" />\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_LINKS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.link\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import {Loc} from 'main.core';\n\nimport {SidebarMenu} from '../sidebar-base-menu';\n\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {MessageService} from 'im.v2.provider.service';\n\nexport class FavoriteMenu extends SidebarMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getDeleteFromFavoriteItem(),\n\t\t];\n\t}\n\n\tgetDeleteFromFavoriteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_REMOVE_FROM_SAVED_V2'),\n\t\t\tonclick: function() {\n\t\t\t\tconst messageService = new MessageService({chatId: this.context.chatId});\n\t\t\t\tmessageService.removeMessageFromFavorite(this.context.messageId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import {Avatar, AvatarSize, ChatTitle} from 'im.v2.component.elements';\nimport type {ImModelSidebarFavoriteItem, ImModelMessage} from 'im.v2.model';\nimport {Parser} from 'im.v2.lib.parser';\nimport '../../css/info/favorite-item.css';\nimport {EventEmitter} from 'main.core.events';\nimport {EventType} from 'im.v2.const';\n\n// @vue/component\nexport const FavoriteItem = {\n\tname: 'FavoriteItem',\n\tcomponents: {Avatar, ChatTitle},\n\tprops:\n\t{\n\t\tfavorite: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tfavoriteItem(): ImModelSidebarFavoriteItem\n\t\t{\n\t\t\treturn this.favorite;\n\t\t},\n\t\tfavoriteMessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.favoriteItem.messageId);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.favoriteMessage.authorId.toString();\n\t\t},\n\t\tmessageText(): string\n\t\t{\n\t\t\treturn Parser.purifyMessage(this.favoriteMessage);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tid: this.favoriteItem.id,\n\t\t\t\tmessageId: this.favorite.messageId,\n\t\t\t\ttarget: event.currentTarget\n\t\t\t});\n\t\t},\n\t\tonItemClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\tmessageId: this.favorite.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonMessageBodyClick(event)\n\t\t{\n\t\t\tif (event.target.tagName === 'A')\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-favorite-item__container bx-im-favorite-item__scope\" \n\t\t\t@click.stop=\"onItemClick\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-favorite-item__header-container\">\n\t\t\t\t<div class=\"bx-im-favorite-item__author-container\">\n\t\t\t\t\t<Avatar\n\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t:dialogId=\"authorDialogId\"\n\t\t\t\t\t\tclass=\"bx-im-favorite-item__author-avatar\"\n\t\t\t\t\t/>\n\t\t\t\t\t<ChatTitle :dialogId=\"authorDialogId\" :showItsYou=\"false\" class=\"bx-im-favorite-item__author-text\" />\n\t\t\t\t</div>\n\t\t\t\t<button \n\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t@click.stop=\"onContextMenuClick\"\n\t\t\t\t></button>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-favorite-item__message-text\" v-html=\"messageText\" @click=\"onMessageBodyClick\"></div>\n\t\t</div>\n\t`\n};","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { FavoriteMenu } from '../../classes/context-menu/favorite/favorite-menu';\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { SidebarDetail } from '../detail';\nimport { FavoriteItem } from './favorite-item';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/info/favorite-detail.css';\n\nimport type { ImModelSidebarFavoriteItem } from 'im.v2.model';\n\n// @vue/component\nexport const FavoriteDetail = {\n\tname: 'FavoriteDetail',\n\tcomponents: { FavoriteItem, DateGroup, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfavorites(): ImModelSidebarFavoriteItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/favorites/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.favorites);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FavoriteMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tid: event.id,\n\t\t\t\tmessageId: event.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\tchatId: this.chatId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-favorite-detail__scope bx-im-sidebar-favorite-detail__container\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-favorite-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<FavoriteItem \n\t\t\t\t\tv-for=\"favorite in dateGroup.items\" \n\t\t\t\t\t:favorite=\"favorite\"\n\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FAVORITES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.favorite\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {DiskService} from 'im.v2.provider.service';\n\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\n\nexport class FileManager\n{\n\tstore: Store;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.diskService = new DiskService();\n\t}\n\n\tdelete(sidebarFile: ImModelSidebarFileItem)\n\t{\n\t\tthis.store.dispatch('sidebar/files/delete', {\n\t\t\tchatId: sidebarFile.chatId,\n\t\t\tid: sidebarFile.id\n\t\t});\n\n\t\tthis.diskService.delete({chatId: sidebarFile.chatId, fileId: sidebarFile.fileId});\n\t}\n\n\tsaveOnDisk(fileId: number): Promise\n\t{\n\t\treturn this.diskService.save(fileId);\n\t}\n}","import 'ui.viewer';\nimport 'ui.notification';\nimport {Loc, Dom} from 'main.core';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {Utils} from 'im.v2.lib.utils';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {FileManager} from './file-manager';\nimport type {ImModelFile, ImModelSidebarFileItem} from 'im.v2.model';\n\ntype MediaMenuContext = {\n\tsidebarFile: ImModelSidebarFileItem,\n\tfile: ImModelFile,\n\tmessageId: number,\n\tdialogId: string,\n}\n\nexport class FileMenu extends SidebarMenu\n{\n\tcontext: MediaMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.mediaManager = new FileManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveFileOnDiskItem(),\n\t\t\tthis.getDeleteFileItem(),\n\t\t];\n\t}\n\n\tgetViewFileItem(): ?MenuItem\n\t{\n\t\tconst viewerAttributes = Utils.file.getViewerDataAttributes(this.context.file.viewerAttrs);\n\t\tif (!viewerAttributes || this.context.file.type === 'audio')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getViewHtml(viewerAttributes),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetDownloadFileItem(): ?MenuItem\n\t{\n\t\tif (!this.context.file.urlDownload)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getDownloadHtml(this.context.file.urlDownload, this.context.file.name),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetSaveFileOnDiskItem(): ?MenuItem\n\t{\n\t\tif (!this.context.sidebarFile.fileId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_SAVE_FILE_ON_DISK_MSGVER_1'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.mediaManager.saveOnDisk(this.context.sidebarFile.fileId).then(() => {\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_SIDEBAR_FILE_SAVE_ON_DISK_SUCCESS')\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetDeleteFileItem(): MenuItem\n\t{\n\t\tif (this.getCurrentUserId() !== this.context.sidebarFile.authorId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_FILE'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.mediaManager.delete(this.context.sidebarFile);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetViewHtml(viewerAttributes: { [key: string]: string }): HTMLDivElement\n\t{\n\t\tconst div = Dom.create('div', {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_VIEW_FILE')\n\t\t});\n\n\t\tObject.entries(viewerAttributes).forEach(attribute => {\n\t\t\tconst [attributeName, attributeValue] = attribute;\n\t\t\tdiv.setAttribute(attributeName, attributeValue);\n\t\t});\n\n\t\treturn div;\n\t}\n\n\tgetDownloadHtml(urlDownload: string, fileName: string): HTMLAnchorElement\n\t{\n\t\tconst a = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DOWNLOAD_FILE')\n\t\t});\n\n\t\tDom.style(a, 'display', 'block');\n\t\tDom.style(a, 'color', 'inherit');\n\t\tDom.style(a, 'text-decoration', 'inherit');\n\n\t\ta.setAttribute('href', urlDownload);\n\t\ta.setAttribute('download', fileName);\n\n\t\treturn a;\n\t}\n}","import 'ui.viewer';\nimport { SocialVideo } from 'ui.vue3.components.socialvideo';\n\nimport { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Avatar, AvatarSize } from 'im.v2.component.elements';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport '../../../css/file/media-detail-item.css';\n\n// @vue/component\nexport const MediaDetailItem = {\n\tname: 'MediaDetailItem',\n\tcomponents: { SocialVideo, Avatar },\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t\tvideoDuration: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tpreviewPicture(): Object\n\t\t{\n\t\t\tif (!this.hasPreview)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.file.urlPreview}')`,\n\t\t\t};\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn this.file.urlPreview !== '';\n\t\t},\n\t\tisImage(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'image';\n\t\t},\n\t\tisVideo(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'video';\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tvideoDurationText(): string\n\t\t{\n\t\t\tif (this.videoDuration === 0)\n\t\t\t{\n\t\t\t\treturn '--:--';\n\t\t\t}\n\n\t\t\treturn this.formatTime(this.videoDuration);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tformatTime(rawSeconds: number): string\n\t\t{\n\t\t\trawSeconds = Math.floor(rawSeconds);\n\t\t\tconst durationHours = Math.floor(rawSeconds / 60 / 60);\n\t\t\tif (durationHours > 0)\n\t\t\t{\n\t\t\t\trawSeconds -= durationHours * 60 * 60;\n\t\t\t}\n\n\t\t\tconst durationMinutes = Math.floor(rawSeconds / 60);\n\t\t\tif (durationMinutes > 0)\n\t\t\t{\n\t\t\t\trawSeconds -= durationMinutes * 60;\n\t\t\t}\n\n\t\t\tconst hours = durationHours > 0 ? `${durationHours}:` : '';\n\t\t\tconst minutes = hours > 0 ? `${durationMinutes.toString().padStart(2, '0')}:` : `${durationMinutes}:`;\n\t\t\tconst seconds = rawSeconds.toString().padStart(2, '0');\n\n\t\t\treturn hours + minutes + seconds;\n\t\t},\n\t\thandleVideoEvent()\n\t\t{\n\t\t\tif (!this.$refs.video)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.videoDuration = this.$refs.video.duration;\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__container bx-im-sidebar-file-media-detail-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-file-media-detail-item__header-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-media-detail-item__avatar-container\">\n\t\t\t\t\t<Avatar :dialogId=\"sidebarFileItem.authorId\" :size=\"AvatarSize.S\"></Avatar>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__context-menu bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t\t></button>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tv-if=\"isImage\"\n\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__content --image\" \n\t\t\t\t:style=\"previewPicture\"\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t\t:title=\"file.name\"\n\t\t\t>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"isVideo\"\n\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__content --video\"\n\t\t\t\t:style=\"previewPicture\"\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t\t:title=\"file.name\"\n\t\t\t>\n\t\t\t\t<video \n\t\t\t\t\tv-show=\"!hasPreview\"\n\t\t\t\t\tref=\"video\"\n\t\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__video\" \n\t\t\t\t\tpreload=\"metadata\" :src=\"file.urlDownload\"\n\t\t\t\t\t@durationchange=\"handleVideoEvent\"\n\t\t\t\t\t@loadeddata=\"handleVideoEvent\"\n\t\t\t\t\t@loadedmetadata=\"handleVideoEvent\"\n\t\t\t\t></video>\n\t\t\t</div>\n\t\t\t<div v-if=\"isVideo\" class=\"bx-im-sidebar-file-media-detail-item__video-controls\">\n\t\t\t\t<span class=\"bx-im-sidebar-file-media-detail-item__video-controls-icon\"></span>\n\t\t\t\t<span class=\"bx-im-sidebar-file-media-detail-item__video-controls-time\">{{ videoDurationText }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { MediaDetailItem } from './item/media-detail-item';\n\nimport { SidebarDetail } from '../detail';\nimport '../../css/file/media-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const MediaDetail = {\n\tname: 'MediaDetail',\n\tcomponents: { DateGroup, MediaDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.media);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-media-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-media-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<div class=\"bx-im-sidebar-file-media-detail__items-group\">\n\t\t\t\t\t<MediaDetailItem\n\t\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.media\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Avatar, AvatarSize, AudioPlayer } from 'im.v2.component.elements';\n\nimport '../../../css/file/audio-detail-item.css';\n\n// @vue/component\nexport const AudioDetailItem = {\n\tname: 'AudioDetailItem',\n\tcomponents: { AudioPlayer, Avatar },\n\tprops: {\n\t\tid: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\ttimelineType: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\taudioUrl(): string\n\t\t{\n\t\t\treturn this.file.urlDownload;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.timelineType = Math.floor(Math.random() * 5);\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-file-audio-detail-item__container bx-im-sidebar-file-audio-detail-item__scope\">\n\t\t\t<AudioPlayer \n\t\t\t\t:id=\"id\"\n\t\t\t\t:src=\"audioUrl\" \n\t\t\t\t:file=\"file\" \n\t\t\t\t:timelineType=\"timelineType\" \n\t\t\t\t:authorId=\"sidebarFileItem.authorId\" \n\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { AudioDetailItem } from './item/audio-detail-item';\n\nimport '../../css/file/audio-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const AudioDetail = {\n\tname: 'AudioDetail',\n\tcomponents: { DetailEmptyState, AudioDetailItem, DateGroup, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.audio);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-audio-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-audio-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<AudioDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:id=\"file.id\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.audio\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import 'ui.icons';\nimport { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\n\nimport '../../../css/file/document-detail-item.css';\n\n// @vue/component\nexport const DocumentDetailItem = {\n\tname: 'DocumentDetailItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tfileIconClass(): string\n\t\t{\n\t\t\treturn `ui-icon ui-icon-file-${this.file.icon}`;\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 15;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t},\n\t\tauthorId(): number\n\t\t{\n\t\t\treturn this.sidebarFileItem.authorId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-document-detail-item__container bx-im-sidebar-file-document-detail-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\t\t\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__icon-container\">\n\t\t\t\t<div :class=\"fileIconClass\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__content-container\" v-bind=\"viewerAttributes\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__document-title\" @click=\"download\" :title=\"file.name\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-file-document-detail-item__document-title-text\">{{fileShortName}}</span>\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-file-document-detail-item__document-size\">{{fileSize}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__author-container\">\n\t\t\t\t\t\t<template v-if=\"authorId > 0\">\n\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t:dialogId=\"authorId\"\n\t\t\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t\t\tclass=\"bx-im-sidebar-file-document-detail-item__author-avatar\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ChatTitle :dialogId=\"authorId\" :showItsYou=\"false\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<span v-else class=\"bx-im-sidebar-file-document-detail-item__system-author-text\">\n\t\t\t\t\t\t\t{{$Bitrix.Loc.getMessage('IM_SIDEBAR_SYSTEM_USER')}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DocumentDetailItem } from './item/document-detail-item';\n\nimport '../../css/file/document-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const DocumentDetail = {\n\tname: 'DocumentDetail',\n\tcomponents: { DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.document);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-document-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-document-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.document\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { DateGroup } from '../date-group';\nimport { SidebarDetail } from '../detail';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DocumentDetailItem } from './item/document-detail-item';\n\nimport '../../css/file/other-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const OtherDetail = {\n\tname: 'OtherDetail',\n\tcomponents: { DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.other);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-other-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-other-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.other\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import 'ui.icons';\nimport 'ui.viewer';\n\nimport { ImModelFile, ImModelSidebarFileItem } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { lazyload } from 'ui.vue3.directives.lazyload';\n\nimport '../../../css/file/file-preview-item.css';\n\n// @vue/component\nexport const FilePreviewItem = {\n\tname: 'FilePreviewItem',\n\tdirectives: { lazyload },\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tpreviewImageStyles(): Object\n\t\t{\n\t\t\tif (!this.hasPreview)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.file.urlPreview}')`,\n\t\t\t};\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn this.file.urlPreview !== '';\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 22;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisImage(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'image';\n\t\t},\n\t\tisVideo(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'video';\n\t\t},\n\t\tisAudio(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'audio';\n\t\t},\n\t\tfileIconClass(): string\n\t\t{\n\t\t\treturn `ui-icon ui-icon-file-${this.file.icon}`;\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-preview-item__container bx-im-sidebar-file-preview-item__scope\" \n\t\t\tv-bind=\"viewerAttributes\" \n\t\t\t@click=\"download\" \n\t\t\t:title=\"file.name\"\n\t\t>\n\t\t\t<img\n\t\t\t\tv-if=\"isImage\"\n\t\t\t\tv-lazyload\n\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t:data-lazyload-src=\"file.urlShow\"\n\t\t\t\t:title=\"file.name\"\n\t\t\t\t:alt=\"file.name\"\n\t\t\t\tclass=\"bx-im-sidebar-file-preview-item__preview-box\"\n\t\t\t/>\n\t\t\t<div \n\t\t\t\tv-else-if=\"isVideo\" \n\t\t\t\tclass=\"bx-im-sidebar-file-preview-item__preview-box bx-im-sidebar-file-preview-item__preview-video-box\"\n\t\t\t\t:style=\"previewImageStyles\"\n\t\t\t>\n\t\t\t\t<video v-if=\"!hasPreview\" class=\"bx-im-sidebar-file-preview-item__preview-video\" preload=\"metadata\" :src=\"file.urlDownload\"></video>\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-video-play-button\"></div>\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-video-play-icon\"></div>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"isAudio\" class=\"bx-im-sidebar-file-preview-item__preview-box\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-audio-play-button\"></div>\n\t\t\t</div>\n\t\t\t<div v-else class=\"bx-im-sidebar-file-preview-item__preview-box\">\n\t\t\t\t<div :class=\"fileIconClass\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-file-preview-item__text\">{{ fileShortName }}</div>\n\t\t</div>\n\t`,\n};\n","import {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {FilePreviewItem} from './item/file-preview-item';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport '../../css/file/preview.css';\n\nimport type {ImModelChat, ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const FilePreview = {\n\tname: 'FilePreview',\n\tcomponents: {DetailEmptyState, FilePreviewItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\tif (this.isMigrationFinished)\n\t\t\t{\n\t\t\t\treturn this.$store.getters['sidebar/files/getLatest'](this.chatId);\n\t\t\t}\n\n\t\t\treturn this.$store.getters['sidebar/files/getLatestUnsorted'](this.chatId);\n\t\t},\n\t\thasFiles(): boolean\n\t\t{\n\t\t\treturn this.files.length > 0;\n\t\t},\n\t\tisMigrationFinished(): boolean\n\t\t{\n\t\t\treturn this.$store.state.sidebar.isFilesMigrated;\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.hasFiles)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst block = this.isMigrationFinished ? SidebarBlock.file : SidebarBlock.fileUnsorted;\n\t\t\tconst detailBlock = this.isMigrationFinished ? SidebarDetailBlock.media : SidebarDetailBlock.fileUnsorted;\n\n\t\t\tthis.$emit('openDetail', {block, detailBlock});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-file-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-file-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-file-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-file-preview__header_container\" \n\t\t\t\t\t:class=\"[hasFiles ? '--active': '']\" \n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bx-im-sidebar-file-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"hasFiles\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"hasFiles\" class=\"bx-im-sidebar-file-preview__files-container\">\n\t\t\t\t\t<FilePreviewItem v-for=\"file in files\" :fileItem=\"file\" />\n\t\t\t\t</div>\n\t\t\t\t<DetailEmptyState\n\t\t\t\t\tv-else\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_AND_FILES_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.media\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DocumentDetailItem } from '../file/item/document-detail-item';\n\nimport '../../css/file-unsorted/detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const FileUnsortedDetail = {\n\tname: 'FileUnsortedDetail',\n\tcomponents: { DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.fileUnsorted);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-unsorted-detail__container bx-im-sidebar-file-unsorted-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-unsorted-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.document\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import '../../css/message-search/empty-state.css';\n\n// @vue/component\nexport const EmptyState = {\n\tname: 'EmptyState',\n\tcomputed:\n\t{\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MESSAGE_SEARCH_NOT_FOUND');\n\t\t},\n\t\tsubTitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MESSAGE_SEARCH_NOT_FOUND_DESCRIPTION');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-message-search-empty-state__container bx-im-message-search-empty-state__scope\">\n\t\t\t<div class=\"bx-im-message-search-empty-state__icon\"></div>\n\t\t\t<div class=\"bx-im-message-search-empty-state__title\">\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-search-empty-state__subtitle\">\n\t\t\t\t{{ subTitle }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { EventType } from 'im.v2.const';\nimport { Parser } from 'im.v2.lib.parser';\nimport { highlightText } from 'im.v2.lib.text-highlighter';\n\nimport '../../css/message-search/search-item.css';\n\nimport type { ImModelMessage } from 'im.v2.model';\n\n// @vue/component\nexport const SearchItem = {\n\tname: 'SearchItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops:\n\t{\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tquery: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.messageId);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.message.authorId.toString();\n\t\t},\n\t\tisSystem(): boolean\n\t\t{\n\t\t\treturn this.message.authorId === 0;\n\t\t},\n\t\tmessageText(): string\n\t\t{\n\t\t\tconst purifiedMessage = Parser.purifyMessage(this.message);\n\n\t\t\treturn highlightText(Text.encode(purifiedMessage), this.query);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonItemClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\tmessageId: this.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonMessageBodyClick(event)\n\t\t{\n\t\t\tif (event.target.tagName === 'A')\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-message-search-item__container bx-im-message-search-item__scope\" \n\t\t\t@click.stop=\"onItemClick\"\n\t\t>\n\t\t\t<div class=\"bx-im-message-search-item__header-container\">\n\t\t\t\t<div class=\"bx-im-message-search-item__author-container\">\n\t\t\t\t\t<template v-if=\"!isSystem\">\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t\t:dialogId=\"authorDialogId\"\n\t\t\t\t\t\t\tclass=\"bx-im-message-search-item__author-avatar\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ChatTitle \n\t\t\t\t\t\t\t:dialogId=\"authorDialogId\" \n\t\t\t\t\t\t\t:showItsYou=\"false\" \n\t\t\t\t\t\t\tclass=\"bx-im-message-search-item__author-text\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<span class=\"bx-im-message-search-item__system-author\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_SYSTEM_MESSAGE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-search-item__message-text\" v-html=\"messageText\" @click=\"onMessageBodyClick\"></div>\n\t\t</div>\n\t`,\n};\n","import { Runtime } from 'main.core';\n\nimport { SidebarDetailBlock } from 'im.v2.const';\nimport { Loader } from 'im.v2.component.elements';\nimport { Logger } from 'im.v2.lib.logger';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { EmptyState } from './empty-state';\nimport { DetailEmptyState as StartState } from '../detail-empty-state';\nimport { DateGroup } from '../date-group';\nimport { SearchItem } from './search-item';\n\nimport '../../css/message-search/detail.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const MessageSearchDetail = {\n\tname: 'MessageSearchDetail',\n\tcomponents: { DateGroup, EmptyState, SearchItem, Loader, StartState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tsearchQuery: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tsearchResult: [],\n\t\t\tcurrentServerQueries: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\tconst messages = this.searchResult.map((messageId) => {\n\t\t\t\treturn this.$store.getters['messages/getById'](messageId);\n\t\t\t}).filter((item) => Boolean(item));\n\n\t\t\treturn this.collectionFormatter.format(messages);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.preparedQuery.length > 0 && this.formattedCollection.length === 0;\n\t\t},\n\t\tpreparedQuery(): string\n\t\t{\n\t\t\treturn this.searchQuery.trim().toLowerCase();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tpreparedQuery(newQuery: string, previousQuery: string)\n\t\t{\n\t\t\tif (newQuery === previousQuery)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.service.resetSearchState();\n\t\t\tthis.searchResult = [];\n\t\t\tthis.startSearch(newQuery);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.searchOnServerDelayed = Runtime.debounce(this.searchOnServer, 500, this);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tsearchOnServer(query: string)\n\t\t{\n\t\t\tthis.currentServerQueries++;\n\n\t\t\tthis.service.searchOnServer(query).then((messageIds: string[]) => {\n\t\t\t\tif (query !== this.preparedQuery)\n\t\t\t\t{\n\t\t\t\t\tthis.isLoading = false;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.searchResult = this.mergeResult(messageIds);\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t}).finally(() => {\n\t\t\t\tthis.currentServerQueries--;\n\t\t\t\tthis.stopLoader();\n\t\t\t});\n\t\t},\n\t\tstartSearch(query: string)\n\t\t{\n\t\t\tif (query.length < 3)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (query.length >= 3)\n\t\t\t{\n\t\t\t\tthis.isLoading = true;\n\t\t\t\tthis.searchOnServerDelayed(query);\n\t\t\t}\n\n\t\t\tif (query.length === 0)\n\t\t\t{\n\t\t\t\tthis.cleanSearchResult();\n\t\t\t}\n\t\t},\n\t\tstopLoader()\n\t\t{\n\t\t\tif (this.currentServerQueries > 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tcleanSearchResult()\n\t\t{\n\t\t\tthis.searchResult = [];\n\t\t},\n\t\tneedToLoadNextPage(event)\n\t\t{\n\t\t\tconst target = event.target;\n\n\t\t\treturn target.scrollTop + target.clientHeight >= target.scrollHeight - target.clientHeight;\n\t\t},\n\t\tonScroll(event)\n\t\t{\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.needToLoadNextPage(event) || !this.service.hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadNextPage().then((messageIds) => {\n\t\t\t\tthis.searchResult = this.mergeResult(messageIds);\n\t\t\t\tthis.isLoading = false;\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.warn('Message Search: loadNextPage error', error);\n\t\t\t});\n\t\t},\n\t\tmergeResult(messageIds: string[]): string[]\n\t\t{\n\t\t\treturn [...this.searchResult, ...messageIds].sort((a, z) => z - a);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-message-search-detail__container bx-im-message-search-detail__scope\" @scroll=\"onScroll\">\n\t\t\t<StartState \n\t\t\t\tv-if=\"!isLoading && preparedQuery.length === 0\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_SEARCH_MESSAGE_START_TITLE')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.messageSearch\"\n\t\t\t/>\n\t\t\t<EmptyState v-if=\"!isLoading && isEmptyState\"/>\n\t\t\t<Loader v-if=\"isLoading && isEmptyState\" class=\"bx-im-message-search-detail__loader\" />\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-message-search-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<SearchItem\n\t\t\t\t\tv-for=\"item in dateGroup.items\"\n\t\t\t\t\t:messageId=\"item.id\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:query=\"preparedQuery\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class TaskManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete({id, chatId})\n\t{\n\t\tthis.store.dispatch('sidebar/tasks/delete', {\n\t\t\tchatId: chatId,\n\t\t\tid: id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': id};\n\t\tthis.restClient.callMethod(RestMethod.imChatTaskDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting task', error);\n\t\t});\n\t}\n}","import 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {TaskManager} from './task-manager';\nimport type {ImModelSidebarTaskItem} from 'im.v2.model';\nimport {Loc} from 'main.core';\n\ntype TaskMenuContext = {\n\ttask: ImModelSidebarTaskItem,\n\tmessageId: number,\n\tdialogId: string,\n\tsource: string,\n}\n\nexport class TaskMenu extends SidebarMenu\n{\n\tcontext: TaskMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.taskManager = new TaskManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_TASK_LINK')),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetDeleteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_TASK_CONNECTION'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.taskManager.delete(this.context.task);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { ImModelSidebarTaskItem } from 'im.v2.model';\nimport { Avatar, AvatarSize } from 'im.v2.component.elements';\nimport { Type } from 'main.core';\nimport { LabelColor } from 'ui.label';\nimport '../../css/task/task-item.css';\nimport { Utils } from 'im.v2.lib.utils';\n\n// @vue/component\nexport const TaskItem = {\n\tname: 'TaskItem',\n\tcomponents: { Avatar, AvatarSize },\n\tprops: {\n\t\ttask: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\ttaskItem(): ImModelSidebarTaskItem\n\t\t{\n\t\t\treturn this.task;\n\t\t},\n\t\ttaskTitle(): string\n\t\t{\n\t\t\treturn this.taskItem.task.title;\n\t\t},\n\t\ttaskAuthorDialogId(): string\n\t\t{\n\t\t\treturn this.taskItem.task.creatorId.toString();\n\t\t},\n\t\ttaskResponsibleDialogId(): string\n\t\t{\n\t\t\treturn this.taskItem.task.responsibleId.toString();\n\t\t},\n\t\ttaskDeadlineText(): string\n\t\t{\n\t\t\tconst statusToShow = Type.isStringFilled(this.taskItem.task.state)\n\t\t\t\t? this.taskItem.task.state\n\t\t\t\t: this.taskItem.task.statusTitle\n\t\t\t;\n\n\t\t\treturn Utils.text.convertHtmlEntities(statusToShow);\n\t\t},\n\t\ttaskBackgroundColorClass(): string\n\t\t{\n\t\t\tif (this.taskItem.task.status === 5)\n\t\t\t{\n\t\t\t\treturn '--completed';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tstatusColorClass(): string\n\t\t{\n\t\t\tif (!this.taskItem.task.color || !LabelColor[this.taskItem.task.color.toUpperCase()])\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn `ui-label-${this.taskItem.task.color.toLowerCase()}`;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonTaskClick()\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.taskItem.task.source, { cacheable: false });\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\ttask: this.taskItem,\n\t\t\t\tsource: this.taskItem.task.source,\n\t\t\t\tmessageId: this.taskItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-task-item__container bx-im-sidebar-task-item__scope\" \n\t\t\t:class=\"taskBackgroundColorClass\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-task-item__content\" @click=\"onTaskClick\">\n\t\t\t\t<div class=\"bx-im-sidebar-task-item__header-text\" :title=\"taskTitle\">\n\t\t\t\t\t{{ taskTitle }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-task-item__detail-container\">\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XS\" :dialogId=\"taskAuthorDialogId\" />\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-item__forward-small-icon bx-im-sidebar__forward-small-icon\"></div>\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XS\" :dialogId=\"taskResponsibleDialogId\" />\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-item__status-text\" :class=\"statusColorClass\">\n\t\t\t\t\t\t{{taskDeadlineText}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button \n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { ImModelSidebarTaskItem, ImModelChat } from 'im.v2.model';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\nimport { Button as MessengerButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { SidebarBlock, SidebarDetailBlock } from 'im.v2.const';\n\nimport { TaskMenu } from '../../classes/context-menu/task/task-menu';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { TaskItem } from './task-item';\n\nimport '../../css/task/preview.css';\n\n// @vue/component\nexport const TaskPreview = {\n\tname: 'TaskPreview',\n\tcomponents: { DetailEmptyState, TaskItem, MessengerButton },\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['openDetail'],\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tfirstTask(): ?ImModelSidebarTaskItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/tasks/get'](this.chatId)[0];\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new TaskMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tgetEntityCreator(): EntityCreator\n\t\t{\n\t\t\tif (!this.entityCreator)\n\t\t\t{\n\t\t\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t\t\t}\n\n\t\t\treturn this.entityCreator;\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.getEntityCreator().createTaskForChat();\n\t\t},\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstTask)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', { block: SidebarBlock.task, detailBlock: SidebarDetailBlock.task });\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-task-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-task-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-task-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-task-preview__header_container\"\n\t\t\t\t\t:class=\"[firstTask ? '--active': '']\"\n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-preview__title\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-task-preview__title-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_TASK_DETAIL_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div v-if=\"firstTask\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<transition name=\"add-button\">\n\t\t\t\t\t\t<MessengerButton\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-task-preview__title-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</transition>\n\t\t\t\t</div>\n\t\t\t\t<TaskItem v-if=\"firstTask\" :task=\"firstTask\" @contextMenuClick=\"onContextMenuClick\"/>\n\t\t\t\t<DetailEmptyState \n\t\t\t\t\tv-else \n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_TASKS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.task\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { TaskMenu } from '../../classes/context-menu/task/task-menu';\nimport { SidebarDetail } from '../detail';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DateGroup } from '../date-group';\nimport { TaskItem } from './task-item';\n\nimport '../../css/task/detail.css';\n\nimport type { ImModelSidebarTaskItem } from 'im.v2.model';\n\n// @vue/component\nexport const TaskDetail = {\n\tname: 'TaskDetail',\n\tcomponents: { TaskItem, DateGroup, SidebarDetail, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\ttasks(): ImModelSidebarTaskItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/tasks/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.tasks);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new TaskMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-task-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-task-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<TaskItem\n\t\t\t\t\tv-for=\"task in dateGroup.items\"\n\t\t\t\t\t:task=\"task\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_TASKS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.task\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import 'ui.icons';\n\nimport { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\n\nimport '../../css/brief/brief-item.css';\n\n// @vue/component\nexport const BriefItem = {\n\tname: 'BriefItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops: {\n\t\tbrief: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.brief;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 15;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-brief-item__container bx-im-sidebar-brief-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-brief-item__icon-container\"></div>\n\t\t\t<div class=\"bx-im-sidebar-brief-item__content-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-brief-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-brief-item__title\" @click=\"download\" v-bind=\"viewerAttributes\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-brief-item__title-text\" :title=\"file.name\">{{fileShortName}}</span>\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-brief-item__size-text\">{{fileSize}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-brief-item__author-container\">\n\t\t\t\t\t\t<Avatar \n\t\t\t\t\t\t\t:dialogId=\"sidebarFileItem.authorId\" \n\t\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-brief-item__author-avatar\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ChatTitle :dialogId=\"sidebarFileItem.authorId\" :showItsYou=\"false\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon bx-im-sidebar-brief-item__context-menu-button\"\n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { SidebarFileTypes, SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { DateGroup } from '../date-group';\nimport { BriefItem } from './brief-item';\nimport { SidebarDetail } from '../detail';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/brief/detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const BriefDetail = {\n\tname: 'BriefDetail',\n\tcomponents: { DateGroup, BriefItem, SidebarDetail, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.brief);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format([...this.files, ...this.files, ...this.files, ...this.files, ...this.files, ...this.files, ...this.files]);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-brief-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-brief-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\"/>\n\t\t\t\t<BriefItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:brief=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEFS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.brief\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import {SidebarBlock, SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {BriefItem} from './brief-item';\nimport '../../css/brief/preview.css';\n\nimport type {ImModelChat, ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const BriefPreview = {\n\tname: 'BriefPreview',\n\tcomponents: {DetailEmptyState, BriefItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddButton: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tfirstBrief(): ?ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.brief)[0];\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstBrief)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.brief, detailBlock: SidebarDetailBlock.brief});\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-brief-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-brief-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-brief-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-brief-preview__header_container\" \n\t\t\t\t\t:class=\"[firstBrief ? '--active': '']\" \n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bx-im-sidebar-brief-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEF_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"firstBrief\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<BriefItem \n\t\t\t\t\tv-if=\"firstBrief\" \n\t\t\t\t\t:brief=\"firstBrief\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t\t<DetailEmptyState \n\t\t\t\t\tv-else \n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEFS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.brief\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class MeetingManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete({id, chatId})\n\t{\n\t\tthis.store.dispatch('sidebar/meetings/delete', {\n\t\t\tchatId: chatId,\n\t\t\tid: id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': id};\n\t\tthis.restClient.callMethod(RestMethod.imChatCalendarDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting meeting', error);\n\t\t});\n\t}\n}","import 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {MeetingManager} from './meeting-manager';\nimport type {ImModelSidebarMeetingItem} from 'im.v2.model';\nimport {Loc} from 'main.core';\n\ntype MeetingMenuContext = {\n\tmeeting: ImModelSidebarMeetingItem,\n\tmessageId: number,\n\tdialogId: string,\n\tsource: string,\n}\n\nexport class MeetingMenu extends SidebarMenu\n{\n\tcontext: MeetingMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.meetingManager = new MeetingManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_MEETING_LINK')),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetDeleteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_MEETING_CONNECTION'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.meetingManager.delete(this.context.meeting);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { DateTimeFormat } from 'main.date';\n\nimport { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\nimport '../../css/meeting/meeting-item.css';\n\nimport type { ImModelSidebarMeetingItem } from 'im.v2.model';\n\n// @vue/component\nexport const MeetingItem = {\n\tname: 'MeetingItem',\n\tprops: {\n\t\tmeeting: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tmeetingItem(): ImModelSidebarMeetingItem\n\t\t{\n\t\t\treturn this.meeting;\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.meetingItem.meeting.title;\n\t\t},\n\t\tdate(): string\n\t\t{\n\t\t\tconst meetingDate = this.meetingItem.meeting.dateFrom;\n\n\t\t\treturn DateFormatter.formatByTemplate(meetingDate, DateTemplate.meeting);\n\t\t},\n\t\tday(): string\n\t\t{\n\t\t\treturn this.meetingItem.meeting.dateFrom.getDate().toString();\n\t\t},\n\t\tmonthShort(): string\n\t\t{\n\t\t\treturn DateTimeFormat.format('M', this.meetingItem.meeting.dateFrom);\n\t\t},\n\t\tisActive(): boolean\n\t\t{\n\t\t\treturn this.meetingItem.meeting.dateFrom.getTime() > Date.now();\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonMeetingClick()\n\t\t{\n\t\t\t// todo replace this call to something\n\t\t\tnew (window.top.BX || window.BX).Calendar.SliderLoader(this.meetingItem.meeting.id).show();\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tmeeting: this.meetingItem,\n\t\t\t\tsource: this.meetingItem.meeting.source,\n\t\t\t\tmessageId: this.meetingItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-meeting-item__container bx-im-sidebar-meeting-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-sidebar-meeting-item__icon-container\"\n\t\t\t\t:class=\"[isActive ? '--active' : '--inactive']\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__day-text\">{{ day }}</div>\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__month-text\">{{ monthShort }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-meeting-item__content-container\" @click=\"onMeetingClick\">\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__title\" :title=\"title\">{{ title }}</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__date\">{{ date }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button \n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { ImModelSidebarMeetingItem, ImModelChat } from 'im.v2.model';\nimport { Button as MessengerButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { SidebarBlock, SidebarDetailBlock } from 'im.v2.const';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\n\nimport { MeetingMenu } from '../../classes/context-menu/meeting/meeting-menu';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { MeetingItem } from './meeting-item';\n\nimport '../../css/meeting/preview.css';\n\n// @vue/component\nexport const MeetingPreview = {\n\tname: 'MeetingPreview',\n\tcomponents: { MeetingItem, DetailEmptyState, MessengerButton },\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tfirstMeeting(): ?ImModelSidebarMeetingItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/meetings/get'](this.chatId)[0];\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MeetingMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tgetEntityCreator(): EntityCreator\n\t\t{\n\t\t\tif (!this.entityCreator)\n\t\t\t{\n\t\t\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t\t\t}\n\n\t\t\treturn this.entityCreator;\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.getEntityCreator().createMeetingForChat();\n\t\t},\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstMeeting)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', { block: SidebarBlock.meeting, detailBlock: SidebarDetailBlock.meeting });\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-meeting-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-meeting-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-meeting-preview__container\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"bx-im-sidebar-meeting-preview__header_container\"\n\t\t\t\t\t:class=\"[firstMeeting ? '--active': '']\"\n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-preview__title\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-meeting-preview__title-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MEETING_DETAIL_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div v-if=\"firstMeeting\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<transition name=\"add-button\">\n\t\t\t\t\t\t<MessengerButton\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-meeting-preview__title-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</transition>\n\t\t\t\t</div>\n\t\t\t\t<MeetingItem v-if=\"firstMeeting\" :meeting=\"firstMeeting\" @contextMenuClick=\"onContextMenuClick\"/>\n\t\t\t\t<DetailEmptyState\n\t\t\t\t\tv-else\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEETINGS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.meeting\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { MeetingMenu } from '../../classes/context-menu/meeting/meeting-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { MeetingItem } from './meeting-item';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/meeting/detail.css';\n\nimport type { ImModelSidebarTaskItem } from 'im.v2.model';\n\n// @vue/component\nexport const MeetingDetail = {\n\tname: 'MeetingDetail',\n\tcomponents: { MeetingItem, DateGroup, SidebarDetail, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tmeetings(): ImModelSidebarTaskItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/meetings/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.meetings);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new MeetingMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-meeting-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-meeting-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<MeetingItem\n\t\t\t\t\tv-for=\"meeting in dateGroup.items\"\n\t\t\t\t\t:meeting=\"meeting\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEETINGS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.meeting\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import '../../css/sign/preview.css';\n\n// @vue/component\nexport const SignPreview = {\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-sign-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-sign-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-sign-preview__container\" >\n\t\t\t\tSigned documents. Work in progress\n\t\t\t</div>\n\t\t</div>\n\t`\n};","// @vue/component\nexport const SignDetail = {\n\temits: ['back'],\n\tdata() {\n\t\treturn {};\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t<div @click=\"$emit('back')\" style=\"margin-bottom: 20px; cursor: pointer\">&lt;- Back</div>\n\t\t\t<div v-for=\"i in 50\">Sign {{ i }}</div>\n\t\t</div>\n\t`\n};","import '../../css/market/market-preview-item.css';\n\nimport type {ImModelMarketApplication} from 'im.v2.model';\n\n// @vue/component\nexport const MarketPreviewItem = {\n\tname: 'MarketPreviewItem',\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmarketItem(): ImModelMarketApplication\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn `fa ${this.marketItem.options.iconName}`;\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\treturn this.marketItem.options.color;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-market-preview-item__container bx-im-sidebar-market-preview-item__scope\">\n\t\t\t<div class=\"bx-im-sidebar-market-preview-item__icon-container\" :style=\"{backgroundColor: iconColor}\">\n\t\t\t\t<i :class=\"iconClass\" aria-hidden=\"true\"></i>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-market-preview-item__title-container\" :title=\"marketItem.title\">\n\t\t\t\t{{ marketItem.title }}\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {PlacementType, SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\n\nimport {MarketPreviewItem} from './market-preview-item';\n\nimport '../../css/market/market-preview.css';\n\nimport type {ImModelMarketApplication} from 'im.v2.model';\nimport {MarketManager} from 'im.v2.lib.market';\n\n// @vue/component\nexport const MarketPreview = {\n\tname: 'MarketPreview',\n\tcomponents: {MarketPreviewItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tcomputed:\n\t{\n\t\tmarketMenuItems(): ImModelMarketApplication[]\n\t\t{\n\t\t\treturn MarketManager.getInstance().getAvailablePlacementsByType(PlacementType.sidebar, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonMarketItemClick(entityId)\n\t\t{\n\t\t\tthis.$emit('openDetail', {\n\t\t\t\tblock: SidebarBlock.meeting,\n\t\t\t\tdetailBlock: SidebarDetailBlock.market,\n\t\t\t\tentityId: entityId,\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div v-if=\"!isLoading\" class=\"bx-im-sidebar-market-preview__scope bx-im-sidebar-market-preview__container\">\n\t\t\t<div class=\"bx-im-sidebar-market-preview__header_container\">\n\t\t\t\t<div class=\"bx-im-sidebar-market-preview__title\">\n\t\t\t\t\t<span class=\"bx-im-sidebar-market-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MARKET_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<MarketPreviewItem \n\t\t\t\tv-for=\"item in marketMenuItems\" \n\t\t\t\t:key=\"item.id\"\n\t\t\t\t:item=\"item\"\n\t\t\t\t@click=\"onMarketItemClick(item.id)\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import { Runtime } from 'main.core';\n\nimport { MarketManager } from 'im.v2.lib.market';\nimport { Spinner, SpinnerSize } from 'im.v2.component.elements';\n\nimport '../../css/market/detail.css';\n\n// @vue/component\nexport const MarketDetail = {\n\tname: 'MarketDetail',\n\tcomponents: { Spinner },\n\tprops: {\n\t\tdetailBlockEntityId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisLoading: true,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSpinnerSize: () => SpinnerSize,\n\t},\n\tcreated()\n\t{\n\t\tthis.marketManager = MarketManager.getInstance();\n\t},\n\tmounted()\n\t{\n\t\tconst context = { dialogId: this.dialogId };\n\t\tthis.marketManager.loadPlacement(this.detailBlockEntityId, context).then((response) => {\n\t\t\tthis.isLoading = false;\n\t\t\tRuntime.html(this.$refs['im-messenger-sidebar-placement'], response);\n\t\t});\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-market-detail__container\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-market-detail__loader-container\">\n\t\t\t\t<Spinner :size=\"SpinnerSize.S\" />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-market-detail__placement-container\" ref=\"im-messenger-sidebar-placement\"></div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { RecentMenu } from 'im.v2.lib.menu';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ChatType, ChatActionType } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { ImModelRecentItem, ImModelUser } from 'im.v2.model';\n\nexport class MainMenu extends RecentMenu\n{\n\tpermissionManager: PermissionManager;\n\n\tstatic events = {\n\t\tonAddToChatShow: 'onAddToChatShow',\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: false,\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getUnreadMessageItem(),\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getCallItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getOpenUserCalendarItem(),\n\t\t\tthis.getChatsWithUserItem(),\n\t\t\tthis.getAddMembersToChatItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetOpenUserCalendarItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['chats/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst user = this.store.getters['users/get'](this.context.dialogId, true);\n\t\tif (user.bot)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getCalendarLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_CALENDAR'),\n\t\t\tonclick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddMembersToChatItem(): MenuItem\n\t{\n\t\tconst user: ImModelUser = this.store.getters['users/get'](this.context.dialogId);\n\t\tif (user?.bot === true)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst canExtend = this.permissionManager.canPerformAction(ChatActionType.extend, this.context.dialogId);\n\t\tif (!canExtend)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_INVITE_MEMBERS'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit(MainMenu.events.onAddToChatShow);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetJoinChatItem(): ?MenuItem\n\t{\n\t\tconst dialog = this.store.getters['chats/get'](this.context.dialogId);\n\t\tconst isUser = dialog.type === ChatType.user;\n\t\tif (isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t// todo: check if user is in chat already\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_JOIN_CHAT'),\n\t\t\tonclick: () => {\n\t\t\t\tconsole.warn('sidebar menu: join chat is not implemented');\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tcanShowFullMenu(dialogId: string): boolean\n\t{\n\t\tconst recentItem: ImModelRecentItem = this.store.getters['recent/get'](dialogId);\n\n\t\treturn Boolean(recentItem);\n\t}\n}\n","import {EventEmitter} from 'main.core.events';\nimport {EventType} from 'im.v2.const';\nimport {AddToChat} from 'im.v2.component.entity-selector';\nimport {MainMenu} from '../classes/context-menu/main/main-menu';\nimport '../css/header.css';\n\nimport type {ImModelRecentItem} from 'im.v2.model';\n\n// @vue/component\nexport const SidebarHeader = {\n\tname: 'SidebarHeader',\n\tcomponents: {AddToChat},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.$store.getters['recent/get'](this.dialogId, true);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MainMenu();\n\t\tthis.contextMenu.subscribe(MainMenu.events.onAddToChatShow, this.onAddChatShow);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.contextMenu.unsubscribe(MainMenu.events.onAddToChatShow, this.onAddChatShow);\n\t},\n\tmethods:\n\t{\n\t\tonAddChatShow()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\t...this.recentItem\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonSidebarCloseClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.sidebar.close);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-header__container bx-im-sidebar-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-header__title-container\">\n\t\t\t\t<button \n\t\t\t\t\tclass=\"bx-im-sidebar-header__cross-icon bx-im-messenger__cross-icon\" \n\t\t\t\t\t@click=\"onSidebarCloseClick\"\n\t\t\t\t></button>\n\t\t\t\t<div class=\"bx-im-sidebar-header__title\">{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_HEADER_TITLE') }}</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"bx-im-sidebar-header__context-menu-icon bx-im-messenger__context-menu-icon\"\n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t\tref=\"context-menu\"\n\t\t\t></button>\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['context-menu'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 0, offsetLeft: -420}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import { Button as ChatButton, ButtonSize, ButtonColor } from 'im.v2.component.elements';\nimport { SidebarDetailBlock, SidebarFileTabTypes, ChatActionType } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\nimport { AddToChat } from 'im.v2.component.entity-selector';\n\nimport '../css/detail-header.css';\n\nimport type { ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const DetailHeader = {\n\tname: 'DetailHeader',\n\tcomponents: { ChatButton, AddToChat },\n\tprops: {\n\t\tdetailBlock: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['back'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tneedAddButton(): boolean\n\t\t{\n\t\t\tconst detailsWithAddButton = [\n\t\t\t\tSidebarDetailBlock.main,\n\t\t\t\tSidebarDetailBlock.task,\n\t\t\t\tSidebarDetailBlock.meeting,\n\t\t\t];\n\n\t\t\tif (this.detailBlock === SidebarDetailBlock.main)\n\t\t\t{\n\t\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t\t}\n\n\t\t\treturn detailsWithAddButton.includes(this.detailBlock);\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\tif (this.detailBlock === SidebarDetailBlock.main)\n\t\t\t{\n\t\t\t\tlet usersInChatCount = this.dialog.userCounter;\n\t\t\t\tif (usersInChatCount >= 1000)\n\t\t\t\t{\n\t\t\t\t\tusersInChatCount = `${Math.floor(usersInChatCount / 1000)}k`;\n\t\t\t\t}\n\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MAIN_DETAIL_TITLE').replace('#NUMBER#', usersInChatCount);\n\t\t\t}\n\n\t\t\tif (Object.values(SidebarFileTabTypes).includes(this.detailBlock))\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_DETAIL_TITLE');\n\t\t\t}\n\n\t\t\tconst phrase = `IM_SIDEBAR_${this.detailBlock.toUpperCase()}_DETAIL_TITLE`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(phrase);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t},\n\tmethods:\n\t{\n\t\tonSearchClick()\n\t\t{\n\t\t\tconsole.warn('onSearchClick');\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tif (!this.needAddButton)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch (this.detailBlock)\n\t\t\t{\n\t\t\t\tcase SidebarDetailBlock.meeting:\n\t\t\t\t{\n\t\t\t\t\tthis.entityCreator.createMeetingForChat();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase SidebarDetailBlock.task:\n\t\t\t\t{\n\t\t\t\t\tthis.entityCreator.createTaskForChat();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase SidebarDetailBlock.main:\n\t\t\t\t{\n\t\t\t\t\tthis.showAddToChatPopup = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-header__container bx-im-sidebar-detail-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-detail-header__title-container\">\n\t\t\t\t<button class=\"bx-im-sidebar__back-icon\" @click=\"$emit('back')\"></button>\n\t\t\t\t<div class=\"bx-im-sidebar-detail-header__title-text\">{{ title }}</div>\n\t\t\t\t<div class=\"bx-im-sidebar-detail-header__add-button\" ref=\"add-members\">\n\t\t\t\t\t<ChatButton\n\t\t\t\t\t\tv-if=\"needAddButton\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n<!--\t\t\t<button-->\n<!--\t\t\t\tclass=\"bx-im-sidebar-detail-header__search-button bx-im-sidebar__search-icon\"-->\n<!--\t\t\t\t@click=\"onSearchClick\"-->\n<!--\t\t\t>-->\n<!--\t\t\t</button>-->\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 15, offsetLeft: -300}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import {Dom} from 'main.core';\n\nimport '../css/detail-tabs.css';\n\nconst ARROW_CONTROL_SIZE = 50;\n\n// @vue/component\nexport const DetailTabs = {\n\tname: 'DetailTabs',\n\tprops: {\n\t\ttabs: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => []\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\thasLeftControl: false,\n\t\t\thasRightControl: false,\n\t\t\tcurrentElementIndex: 0,\n\t\t\thighlightOffsetLeft: 0,\n\t\t\thighlightWidth: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\thighlightStyle()\n\t\t{\n\t\t\treturn {\n\t\t\t\tleft: `${this.highlightOffsetLeft}px`,\n\t\t\t\twidth: `${this.highlightWidth}px`\n\t\t\t};\n\t\t},\n\n\t},\n\twatch:\n\t{\n\t\tcurrentElementIndex(newIndex: number)\n\t\t{\n\t\t\tthis.updateHighlightPosition(newIndex);\n\t\t\tthis.$emit('tabSelect', this.tabs[newIndex]);\n\t\t\tthis.scrollToElement(newIndex);\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tif (this.$refs.tabs.scrollWidth > this.$refs.tabs.offsetWidth)\n\t\t{\n\t\t\tthis.hasRightControl = true;\n\t\t}\n\n\t\tthis.updateHighlightPosition(this.currentElementIndex);\n\t},\n\tmethods:\n\t{\n\t\tgetElementNodeByIndex(index: number): HTMLElement\n\t\t{\n\t\t\treturn [...this.$refs.tabs.children].filter(node => !Dom.hasClass(node, 'bx-sidebar-tabs-highlight'))[index];\n\t\t},\n\t\tupdateHighlightPosition(index: number)\n\t\t{\n\t\t\tconst element = this.getElementNodeByIndex(index);\n\t\t\tthis.highlightOffsetLeft = element.offsetLeft;\n\t\t\tthis.highlightWidth = element.offsetWidth;\n\t\t},\n\t\tscrollToElement(elementIndex: number)\n\t\t{\n\t\t\tconst element = this.getElementNodeByIndex(elementIndex);\n\t\t\tthis.$refs.tabs.scroll({left: element.offsetLeft - ARROW_CONTROL_SIZE, behavior: 'smooth'});\n\t\t},\n\t\tonTabClick(event)\n\t\t{\n\t\t\tthis.currentElementIndex = event.index;\n\t\t},\n\t\tgetTabTitle(tab: string): string\n\t\t{\n\t\t\tconst langPhraseCode = `IM_SIDEBAR_FILES_${tab.toUpperCase()}_TAB`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(langPhraseCode);\n\t\t},\n\t\tisSelectedTab(index: number): boolean\n\t\t{\n\t\t\treturn index === this.currentElementIndex;\n\t\t},\n\t\tonLeftClick()\n\t\t{\n\t\t\tif (this.currentElementIndex <= 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentElementIndex--;\n\t\t},\n\t\tonRightClick()\n\t\t{\n\t\t\tif (this.currentElementIndex >= this.tabs.length - 1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentElementIndex++;\n\t\t},\n\t\tupdateControlsVisibility()\n\t\t{\n\t\t\tthis.hasRightControl = this.$refs.tabs.scrollWidth > this.$refs.tabs.scrollLeft + this.$refs.tabs.clientWidth;\n\t\t\tthis.hasLeftControl = this.$refs.tabs.scrollLeft > 0;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-tabs__container bx-im-sidebar-detail-tabs__scope\">\n\t\t\t<div v-if=\"hasLeftControl\" @click.stop=\"onLeftClick\" class=\"bx-im-sidebar-ears__control --left\">\n\t\t\t\t<div class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t</div>\n\t\t\t<div v-if=\"hasRightControl\" @click.stop=\"onRightClick\" class=\"bx-im-sidebar-ears__control --right\">\n\t\t\t\t<div class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-ears__elements\" ref=\"tabs\" @scroll.passive=\"updateControlsVisibility\">\n\t\t\t\t<div class=\"bx-sidebar-tabs-highlight\" :style=\"highlightStyle\"></div>\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(tab, index) in tabs\"\n\t\t\t\t\t:key=\"tab\"\n\t\t\t\t\tclass=\"bx-im-sidebar-detail-tabs__item\"\n\t\t\t\t\t:class=\"[isSelectedTab(index) ? '--selected' : '']\"\n\t\t\t\t\t@click=\"onTabClick({index: index})\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-detail-tabs__item-title\">{{ getTabTitle(tab) }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { SearchInput } from 'im.v2.component.elements';\n\nimport '../../css/message-search/search-header.css';\n\n// @vue/component\nexport const SearchHeader = {\n\tname: 'SearchHeader',\n\tcomponents: { SearchInput },\n\temits: ['back', 'changeQuery'],\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-search-header__container bx-im-sidebar-search-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-search-header__title-container\">\n\t\t\t\t<button class=\"bx-im-sidebar__back-icon\" @click=\"$emit('back')\"></button>\n\t\t\t\t<SearchInput\n\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_SEARCH_MESSAGE_PLACEHOLDER')\"\n\t\t\t\t\t:withIcon=\"false\"\n\t\t\t\t\t:delayForFocusOnStart=\"300\"\n\t\t\t\t\t@queryChange=\"$emit('changeQuery', $event)\"\n\t\t\t\t\tclass=\"bx-im-sidebar-search-header__input\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Logger } from 'im.v2.lib.logger';\nimport { ImModelChat } from 'im.v2.model';\nimport { SidebarDetailBlock, SidebarFileTabTypes } from 'im.v2.const';\nimport { SidebarService } from './classes/sidebar-service';\nimport { ChatsWithUserDetail } from './components/chats-with-user/detail';\nimport { MainDetail } from './components/main/detail';\nimport { MainPreview } from './components/main/preview';\nimport { InfoPreview } from './components/info/preview';\nimport { LinkDetail } from './components/info/link-detail';\nimport { FavoriteDetail } from './components/info/favorite-detail';\nimport { MediaDetail } from './components/file/media-detail';\nimport { AudioDetail } from './components/file/audio-detail';\nimport { DocumentDetail } from './components/file/document-detail';\nimport { OtherDetail } from './components/file/other-detail';\nimport { FileUnsortedPreview } from './components/file-unsorted/preview';\nimport { FileUnsortedDetail } from './components/file-unsorted/detail';\nimport { FilePreview } from './components/file/preview';\nimport { MessageSearchDetail } from './components/message-search/detail';\nimport { TaskPreview } from './components/task/preview';\nimport { TaskDetail } from './components/task/detail';\nimport { BriefDetail } from './components/brief/detail';\nimport { BriefPreview } from './components/brief/preview';\nimport { MeetingPreview } from './components/meeting/preview';\nimport { MeetingDetail } from './components/meeting/detail';\nimport { SignPreview } from './components/sign/preview';\nimport { SignDetail } from './components/sign/detail';\nimport { MarketPreview } from './components/market/preview';\nimport { MarketDetail } from './components/market/detail';\nimport { SidebarHeader } from './components/header';\nimport { DetailHeader } from './components/detail-header';\nimport { DetailTabs } from './components/detail-tabs';\nimport { SearchHeader } from './components/message-search/search-header';\nimport { AvailabilityManager } from './classes/availability-manager';\nimport { SettingsManager } from './classes/settings-manager';\nimport './css/sidebar.css';\nimport './css/icons.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const ChatSidebar = {\n\tname: 'ChatSidebar',\n\tcomponents: {\n\t\tDetailHeader,\n\t\tDetailTabs,\n\t\tSidebarHeader,\n\t\tMainDetail,\n\t\tMainPreview,\n\t\tInfoPreview,\n\t\tLinkDetail,\n\t\tFavoriteDetail,\n\t\tMediaDetail,\n\t\tAudioDetail,\n\t\tDocumentDetail,\n\t\tOtherDetail,\n\t\tFilePreview,\n\t\tTaskPreview,\n\t\tTaskDetail,\n\t\tBriefDetail,\n\t\tBriefPreview,\n\t\tMeetingPreview,\n\t\tMeetingDetail,\n\t\tSignPreview,\n\t\tSignDetail,\n\t\tFileUnsortedDetail,\n\t\tFileUnsortedPreview,\n\t\tMarketPreview,\n\t\tMarketDetail,\n\t\tMessageSearchDetail,\n\t\tChatsWithUserDetail,\n\t\tSearchHeader,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tsidebarDetailBlock: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['back'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tdetailBlock: null,\n\t\t\tdetailBlockEntityId: null,\n\t\t\tdetailTransition: 'right-panel-detail-transition',\n\t\t\tquery: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tblocks(): string[]\n\t\t{\n\t\t\treturn this.availabilityManager.getBlocks();\n\t\t},\n\t\thasInitialData(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/isInited'](this.chatId);\n\t\t},\n\t\tdetailComponent(): ?string\n\t\t{\n\t\t\tif (!this.detailBlock)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn `${this.detailBlock}Detail`;\n\t\t},\n\t\tgetBlockServiceInstance(): Object\n\t\t{\n\t\t\treturn this.sidebarService.getBlockInstance(this.detailBlock);\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tdialogInited(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited;\n\t\t},\n\t\ttabs(): string[]\n\t\t{\n\t\t\tif (SidebarFileTabTypes[this.detailBlock])\n\t\t\t{\n\t\t\t\treturn Object.values(SidebarFileTabTypes);\n\t\t\t}\n\n\t\t\treturn [];\n\t\t},\n\t\tneedShowDefaultDetailHeader(): boolean\n\t\t{\n\t\t\treturn this.detailBlock !== SidebarDetailBlock.messageSearch;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tsidebarDetailBlock(newValue: string)\n\t\t{\n\t\t\tthis.detailBlock = newValue;\n\t\t},\n\t\tdialogInited(newValue: boolean, oldValue: boolean)\n\t\t{\n\t\t\tif (newValue === true && oldValue === false)\n\t\t\t{\n\t\t\t\tthis.isLoading = false;\n\t\t\t\tthis.initializeSidebar();\n\t\t\t}\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('Sidebar: Chat Sidebar created');\n\t\tthis.settingsManager = new SettingsManager();\n\t\tthis.availabilityManager = new AvailabilityManager(this.settingsManager, this.dialogId);\n\t\tthis.sidebarService = new SidebarService(this.availabilityManager);\n\t\tthis.initializeSidebar();\n\t},\n\tmounted()\n\t{\n\t\tif (this.sidebarDetailBlock)\n\t\t{\n\t\t\tthis.detailBlock = this.sidebarDetailBlock;\n\t\t\tthis.detailTransition = '';\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tinitializeSidebar()\n\t\t{\n\t\t\tif (!this.dialogInited)\n\t\t\t{\n\t\t\t\tthis.isLoading = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sidebarService.setChatId(this.chatId);\n\t\t\tthis.sidebarService.setDialogId(this.dialogId);\n\n\t\t\tif (this.hasInitialData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.sidebarService.requestInitialData().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.warn('Sidebar: request initial data error:', error);\n\t\t\t});\n\t\t},\n\t\tonOpenDetail(data: Object)\n\t\t{\n\t\t\tconst { detailBlock, entityId = '' } = data;\n\t\t\tthis.detailBlock = detailBlock;\n\t\t\tthis.detailBlockEntityId = entityId.toString();\n\t\t},\n\t\tgetPreviewComponentName(block: string): string\n\t\t{\n\t\t\treturn `${block}Preview`;\n\t\t},\n\t\tonClickBack()\n\t\t{\n\t\t\tthis.detailBlock = null;\n\t\t\tthis.detailTransition = 'right-panel-detail-transition';\n\t\t\tthis.$emit('back');\n\t\t\tthis.query = '';\n\t\t},\n\t\tonTabSelect(tab: string)\n\t\t{\n\t\t\tthis.detailBlock = tab;\n\t\t},\n\t\tonChangeQuery(query)\n\t\t{\n\t\t\tthis.query = query;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarHeader :isLoading=\"isLoading\" :dialogId=\"dialogId\" :chatId=\"chatId\" />\n\t\t<div class=\"bx-im-sidebar__container bx-im-sidebar__scope\">\n\t\t\t<component\n\t\t\t\tv-for=\"block in blocks\"\n\t\t\t\t:key=\"block\"\n\t\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t\t\t:is=\"getPreviewComponentName(block)\"\n\t\t\t\t:isLoading=\"isLoading\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t@openDetail=\"onOpenDetail\"\n\t\t\t/>\n\t\t</div>\n\t\t<transition :name=\"detailTransition\">\n\t\t\t<div v-if=\"detailComponent && dialogInited\" class=\"bx-im-sidebar__detail_container bx-im-sidebar__scope\">\n\t\t\t\t<DetailHeader \n\t\t\t\t\tv-if=\"needShowDefaultDetailHeader\" \n\t\t\t\t\t:detailBlock=\"detailBlock\" \n\t\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t\t:chatId=\"chatId\" \n\t\t\t\t\t@back=\"onClickBack\" \n\t\t\t\t/>\n\t\t\t\t<SearchHeader v-else @changeQuery=\"onChangeQuery\" @back=\"onClickBack\" />\n\t\t\t\t<DetailTabs v-if=\"tabs.length > 0\" :tabs=\"tabs\" @tabSelect=\"onTabSelect\" />\n\t\t\t\t<component\n\t\t\t\t\t:is=\"detailComponent\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t:detailBlock=\"detailBlock\"\n\t\t\t\t\t:detailBlockEntityId=\"detailBlockEntityId\"\n\t\t\t\t\t:service=\"getBlockServiceInstance\"\n\t\t\t\t\t:searchQuery=\"query\"\n\t\t\t\t\t@back=\"onClickBack\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</transition> \n\t`,\n};\n"],"names":["NOT_IMPLEMENTED_ERROR","Base","constructor","chatId","dialogId","store","userManager","Core","getStore","restClient","getRestClient","UserManager","loadFirstPage","Error","loadNextPage","getInitialRequest","getResponseHandler","getCurrentUserId","getUserId","getLastElementId","collection","lastId","length","id","Type","isNumber","REQUEST_ITEMS_LIMIT","BaseFile","hasMoreItemsToLoad","RestMethod","imChatFileCollectionGet","chat_id","limit","response","Promise","reject","requestError","extractLoadFileError","fileResult","data","updateModels","fileGetResponse","error","handleResponse","list","resultData","users","files","addUsersPromise","setUsersToModel","setFilesPromise","dispatch","setSidebarFilesPromise","all","loadFirstPageBySubType","subType","filesCount","getFilesCountFromModel","resolve","queryParams","getQueryParams","requestPage","loadNextPageBySubType","callMethod","imChatFileGet","then","catch","console","getters","Media","SidebarFileTabTypes","media","Audio","audio","Document","document","Other","other","Favorite","imChatFavoriteCounterGet","imChatFavoriteGet","extractLoadCountersError","favoriteCounterGetResponse","setCounterResult","counter","setFavoriteResult","favoriteCounterGetResult","favoriteGetResult","favoritesCount","getFavoritesCountFromModel","LAST_ID","favoriteMessagesResult","rawMessages","map","favorite","message","storeMessagesPromise","setFavoritesPromise","favorites","Link","imChatUrlCounterGet","imChatUrlGet","linkCounterGetResponse","setLinksResult","linkCounterGetResult","linkGetResult","linksCount","getLinksCountFromModel","offset","OFFSET","setLinksPromise","links","Task","imChatTaskGet","extractLoadTaskError","taskGetResponse","tasksCount","getTasksCountFromModel","tasksResult","firstPageReceived","setTasksPromise","tasks","Main","imDialogUsersList","dialog_id","membersCount","getMembersCountFromModel","userIds","forEach","user","push","setMembersPromise","Brief","SidebarFileTypes","brief","Meeting","imChatCalendarGet","calendarGetResponse","meetingsCount","getMeetingsCountFromState","setMeetingsPromise","meetings","meetingsResult","FileUnsorted","imDiskFolderListGet","diskFolderListGetResult","SidebarDetailBlock","fileUnsorted","preparedFiles","file","MessageSearch","searchOnServer","query","resetSearchState","config","SEARCH_MESSAGE","CHAT_ID","imDialogMessagesSearch","responseData","messages","rawData","usersShort","reactions","additionalMessages","usersPromise","addUsersToModel","filesPromise","reactionsPromise","additionalMessagesPromise","messagesPromise","sort","a","b","oldestMessage","ChatsWithUser","userId","Number","parseInt","requestParams","filter","imV2ChatListShared","chats","chat","recentItems","date_update","dateUpdate","SettingsManager","settings","Extension","getSettings","saveSettings","get","getBlocks","isLinksMigrationFinished","state","sidebar","isLinksMigrated","canShowBriefs","isFileMigrationFinished","isFilesMigrated","BLOCKS_ORDER","SidebarBlock","main","info","sign","task","meeting","AvailabilityManager","settingsManager","blocksFromSetting","availableBlocks","blocks","blocksSet","Set","delete","market","MarketManager","getInstance","getAvailablePlacementsByType","PlacementType","block1","block2","bot","BlockClasses","BlockToServices","Object","freeze","link","messageSearch","chatsWithUser","SidebarService","availabilityManager","blockServices","requestInitialData","isArrayFilled","buildBlocks","callBatch","getInitialRequestQuery","result","handleBatchRequestResult","getBlockInstance","blockName","find","block","type","toLowerCase","blockManager","setChatId","setDialogId","classNames","getServiceClassesForBlocks","className","initialRequest","responseHandler","services","blockList","service","Text","capitalize","assign","responseHandlersResult","setInited","DetailEmptyState","name","props","title","String","required","iconType","computed","iconClass","toKebabCase","template","ChatItem","components","Avatar","ChatTitle","emits","AvatarSize","recentItem","$store","chatItemText","$Bitrix","Loc","getMessage","formattedDate","formatDate","methods","onClick","event","$emit","nativeEvent","date","DateFormatter","formatByTemplate","DateTemplate","recent","ChatsWithUserDetail","Loader","isLoading","currentServerQueries","isEmptyState","created","Messenger","openChat","needToLoadNextPage","target","scrollTop","clientHeight","scrollHeight","onScroll","nextPageChats","DetailUser","isModerator","Boolean","default","showContextButton","position","userLink","Utils","getProfileLink","onClickContextMenu","userDialogId","currentTarget","SidebarDetail","hasInitialData","SidebarMenu","BaseMenu","getMenuOptions","getMenuClassName","getOpenContextMessageItem","context","messageId","text","onclick","EventEmitter","emit","EventType","dialog","goToMessageContext","menuInstance","close","getCopyLinkItem","BX","clipboard","isCopySupported","copy","source","UI","Notification","Center","notify","content","MembersMenu","chatService","ChatService","callManager","CallManager","permissionManager","PermissionManager","getMenuItems","getInsertNameItem","getSendMessageItem","getCallItem","getOpenProfileItem","getOpenUserCalendarItem","getKickItem","getLeaveItem","textarea","insertMention","mentionText","mentionReplacement","getMentionBbCode","chatCanBeCalled","chatIsAllowedToCall","canPerformAction","ChatActionType","call","startCall","isUser","isBot","profileUri","href","getCalendarLink","SidePanel","Instance","open","userIdToKick","isSelfKick","canKick","kick","contextDialogId","userChoice","showKickUserConfirm","kickUserFromChat","canLeaveChat","leave","showLeaveFromChatConfirm","leaveChat","MainDetail","Button","ButtonSize","ButtonColor","dialogManagers","managerList","dialogIds","toString","showCopyInviteButton","chatLink","getHost","contextMenu","beforeUnmount","destroy","includes","onContextMenuClick","item","contextChatId","openMenu","onCopyInviteClick","Settings","directives","hint","Toggle","autoDeleteEnabled","ToggleSize","isGroupChat","startsWith","canBeMuted","mute","isChatMuted","isMuted","muteList","element","hintMuteNotAvailable","popupOptions","angle","targetContainer","body","offsetLeft","offsetTop","bindOptions","hintAutoDeleteNotAvailable","chatTypeClass","getChatService","muteActionHandler","unmuteChat","muteChat","PersonalChatPreview","MessengerButton","AddToChat","showAddToChatPopup","userPosition","canInviteMembers","extend","showInviteButton","onAddClick","GroupChatPreview","PREVIEW_USERS_COUNT","slice","usersInChatCount","userCounter","moreUsersCount","Math","max","canSeeMembers","userList","onOpenUsers","onOpenInvitePopup","MainPreview","inheritAttrs","onOpenDetail","detailBlock","MAX_DESCRIPTION_SYMBOLS","InfoPreview","expanded","ChatType","previewDescription","description","chatTypeText","descriptionToShow","rawText","Parser","purifyText","showExpandButton","favoriteCounter","getCounterString","urlCounter","isLinksAvailable","hintDirectiveContent","MAX_COUNTER","onFavouriteClick","onLinkClick","SidebarCollectionFormatter","cachedDateGroups","format","dateGroups","dateGroup","getDateGroup","dateGroupTitle","items","values","INDEX_BETWEEN_DATE_AND_TIME","shortDate","toJSON","LinkManager","imChatUrlDelete","LinkMenu","linkManager","getDeleteLinkItem","bind","LinkItem","linkItem","shortDescription","hostName","URL","hostname","richData","convertHtmlEntities","authorDialogId","authorId","hasPreview","previewUrl","previewStyles","backgroundImage","backgroundSize","backgroundRepeat","iconTypeClass","DateGroup","dateText","LinkDetail","formattedCollection","collectionFormatter","FavoriteMenu","getDeleteFromFavoriteItem","messageService","MessageService","removeMessageFromFavorite","FavoriteItem","favoriteItem","favoriteMessage","messageText","purifyMessage","onItemClick","onMessageBodyClick","tagName","stopPropagation","FavoriteDetail","FileManager","diskService","DiskService","sidebarFile","fileId","saveOnDisk","save","FileMenu","mediaManager","getDownloadFileItem","getSaveFileOnDiskItem","getDeleteFileItem","getViewFileItem","viewerAttributes","getViewerDataAttributes","viewerAttrs","html","getViewHtml","urlDownload","getDownloadHtml","div","Dom","create","entries","attribute","attributeName","attributeValue","setAttribute","fileName","style","MediaDetailItem","SocialVideo","fileItem","videoDuration","sidebarFileItem","previewPicture","urlPreview","isImage","isVideo","videoDurationText","formatTime","rawSeconds","floor","durationHours","durationMinutes","hours","minutes","padStart","seconds","handleVideoEvent","$refs","video","duration","MediaDetail","AudioDetailItem","AudioPlayer","timelineType","audioUrl","random","AudioDetail","DocumentDetailItem","fileIconClass","icon","fileShortName","NAME_MAX_LENGTH","getShortFileName","fileSize","formatFileSize","size","isViewerAvailable","keys","download","urlToOpen","urlShow","window","DocumentDetail","OtherDetail","FilePreviewItem","lazyload","previewImageStyles","isAudio","FilePreview","isMigrationFinished","hasFiles","FileUnsortedDetail","EmptyState","subTitle","SearchItem","isSystem","purifiedMessage","highlightText","encode","MessageSearchDetail","StartState","searchQuery","searchResult","preparedQuery","trim","watch","newQuery","previousQuery","startSearch","searchOnServerDelayed","Runtime","debounce","messageIds","mergeResult","finally","stopLoader","cleanSearchResult","Logger","warn","z","TaskManager","imChatTaskDelete","TaskMenu","taskManager","getDeleteItem","TaskItem","taskItem","taskTitle","taskAuthorDialogId","creatorId","taskResponsibleDialogId","responsibleId","taskDeadlineText","statusToShow","isStringFilled","statusTitle","taskBackgroundColorClass","status","statusColorClass","color","LabelColor","toUpperCase","onTaskClick","cacheable","TaskPreview","firstTask","getEntityCreator","entityCreator","EntityCreator","createTaskForChat","TaskDetail","BriefItem","BriefDetail","BriefPreview","showAddButton","firstBrief","MeetingManager","imChatCalendarDelete","MeetingMenu","meetingManager","MeetingItem","meetingItem","meetingDate","dateFrom","day","getDate","monthShort","DateTimeFormat","isActive","getTime","Date","now","onMeetingClick","top","Calendar","SliderLoader","show","MeetingPreview","firstMeeting","createMeetingForChat","MeetingDetail","SignPreview","SignDetail","MarketPreviewItem","marketItem","options","iconName","iconColor","MarketPreview","marketMenuItems","onMarketItemClick","entityId","MarketDetail","Spinner","detailBlockEntityId","SpinnerSize","marketManager","mounted","loadPlacement","MainMenu","RecentMenu","getUnreadMessageItem","getPinMessageItem","getChatsWithUserItem","getAddMembersToChatItem","getHideItem","canExtend","events","onAddToChatShow","getJoinChatItem","canShowFullMenu","SidebarHeader","subscribe","onAddChatShow","unsubscribe","onSidebarCloseClick","DetailHeader","ChatButton","needAddButton","detailsWithAddButton","replace","phrase","onSearchClick","ARROW_CONTROL_SIZE","DetailTabs","tabs","Array","hasLeftControl","hasRightControl","currentElementIndex","highlightOffsetLeft","highlightWidth","highlightStyle","left","width","newIndex","updateHighlightPosition","scrollToElement","scrollWidth","offsetWidth","getElementNodeByIndex","index","children","node","hasClass","elementIndex","scroll","behavior","onTabClick","getTabTitle","tab","langPhraseCode","isSelectedTab","onLeftClick","onRightClick","updateControlsVisibility","scrollLeft","clientWidth","SearchHeader","SearchInput","ChatSidebar","FileUnsortedPreview","sidebarDetailBlock","detailTransition","detailComponent","getBlockServiceInstance","sidebarService","dialogInited","inited","needShowDefaultDetailHeader","newValue","oldValue","initializeSidebar","getPreviewComponentName","onClickBack","onTabSelect","onChangeQuery"],"mappings":"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"}