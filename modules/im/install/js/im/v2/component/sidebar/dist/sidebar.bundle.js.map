{"version":3,"file":"sidebar.bundle.js","sources":["../src/classes/blocks/base.js","../src/classes/blocks/base-file.js","../src/classes/blocks/media.js","../src/classes/blocks/audio.js","../src/classes/blocks/document.js","../src/classes/blocks/other.js","../src/classes/blocks/favorite.js","../src/classes/blocks/link.js","../src/classes/blocks/task.js","../src/classes/blocks/main.js","../src/classes/blocks/brief.js","../src/classes/blocks/meeting.js","../src/classes/blocks/file-unsorted.js","../src/classes/blocks/message-search.js","../src/classes/settings-manager.js","../src/classes/availability-manager.js","../src/classes/sidebar-service.js","../src/components/main/detail-user.js","../src/components/detail.js","../src/classes/context-menu/sidebar-base-menu.js","../src/classes/context-menu/main/members-menu.js","../src/components/main/detail.js","../src/components/main/settings.js","../src/components/main/preview-personal-chat.js","../src/components/main/preview-group-chat.js","../src/components/main/preview.js","../src/components/info/preview.js","../src/classes/sidebar-collection-formatter.js","../src/classes/context-menu/link/link-manager.js","../src/classes/context-menu/link/link-menu.js","../src/components/info/link-item.js","../src/components/date-group.js","../src/components/detail-empty-state.js","../src/components/info/link-detail.js","../src/classes/context-menu/favorite/favorite-menu.js","../src/components/info/favorite-item.js","../src/components/info/favorite-detail.js","../src/classes/context-menu/file/file-manager.js","../src/classes/context-menu/file/file-menu.js","../src/components/file/item/media-detail-item.js","../src/components/file/media-detail.js","../src/components/file/item/audio-detail-item.js","../src/components/file/audio-detail.js","../src/components/file/item/document-detail-item.js","../src/components/file/document-detail.js","../src/components/file/other-detail.js","../src/components/file/item/file-preview-item.js","../src/components/file/preview.js","../src/components/file-unsorted/detail.js","../src/components/message-search/empty-state.js","../src/components/message-search/search-item.js","../src/components/message-search/detail.js","../src/classes/context-menu/task/task-manager.js","../src/classes/context-menu/task/task-menu.js","../src/components/task/task-item.js","../src/components/task/preview.js","../src/components/task/detail.js","../src/components/brief/brief-item.js","../src/components/brief/detail.js","../src/components/brief/preview.js","../src/classes/context-menu/meeting/meeting-manager.js","../src/classes/context-menu/meeting/meeting-menu.js","../src/components/meeting/meeting-item.js","../src/components/meeting/preview.js","../src/components/meeting/detail.js","../src/components/sign/preview.js","../src/components/sign/detail.js","../src/components/market/market-preview-item.js","../src/components/market/preview.js","../src/components/market/detail.js","../src/classes/context-menu/main/main-menu.js","../src/components/header.js","../src/components/detail-header.js","../src/components/detail-tabs.js","../src/components/message-search/search-header.js","../src/sidebar.js"],"sourcesContent":["import {Type} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {UserManager} from 'im.v2.lib.user';\n\nconst NOT_IMPLEMENTED_ERROR = 'Not implemented';\n\nexport class Base\n{\n\tstore: Object = null;\n\tdialogId: string = '';\n\tchatId: number = 0;\n\tuserManager: UserManager = null;\n\n\tconstructor(chatId: number, dialogId: string)\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.chatId = chatId;\n\t\tthis.dialogId = dialogId;\n\t\tthis.userManager = new UserManager();\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetInitialRequest()\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn Core.getUserId();\n\t}\n\n\tgetLastElementId(collection): ?number\n\t{\n\t\tconst lastId = collection[collection.length - 1]?.id;\n\n\t\tif (Type.isNumber(lastId))\n\t\t{\n\t\t\treturn lastId;\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class BaseFile extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatFileCollectionGet]: [RestMethod.imChatFileCollectionGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadFileError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst fileResult = response[RestMethod.imChatFileCollectionGet].data();\n\n\t\t\treturn this.updateModels(fileResult);\n\t\t};\n\t}\n\n\textractLoadFileError(response): ?string\n\t{\n\t\tconst fileGetResponse = response[RestMethod.imChatFileCollectionGet];\n\t\tif (fileGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatFileCollectionGet}: ${fileGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst fileResult = response.data();\n\t\tif (fileResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.lastId = this.getLastElementId(fileResult.list);\n\n\t\treturn this.updateModels(fileResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users, files} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setFilesPromise = this.store.dispatch('files/set', files);\n\t\tconst setSidebarFilesPromise = this.store.dispatch('sidebar/files/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfiles: list\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, setSidebarFilesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tloadFirstPageBySubType(subType: string): Promise\n\t{\n\t\tconst filesCount = this.getFilesCountFromModel(subType);\n\t\tif (filesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams(subType);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPageBySubType(subType: string): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams(subType);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(subType: string): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'SUBTYPE': subType,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatFileGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: imChatFileGet: page request error', error);\n\t\t});\n\t}\n\n\tgetFilesCountFromModel(subType): number\n\t{\n\t\treturn this.store.getters['sidebar/files/getSize'](this.chatId, subType);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Media extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.media);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.media);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Audio extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.audio);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.audio);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Document extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.document);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.document);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Other extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.other);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.other);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\nexport class Favorite extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatFavoriteCounterGet]: [RestMethod.imChatFavoriteCounterGet, {chat_id: this.chatId}],\n\t\t\t[RestMethod.imChatFavoriteGet]: [RestMethod.imChatFavoriteGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadCountersError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst favoriteCounterGetResponse = response[RestMethod.imChatFavoriteCounterGet].data();\n\t\t\tconst setCounterResult = this.store.dispatch('sidebar/favorites/setCounter', {\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tcounter: favoriteCounterGetResponse.counter\n\t\t\t});\n\n\t\t\tconst setFavoriteResult = this.handleResponse(response[RestMethod.imChatFavoriteGet]);\n\n\t\t\treturn Promise.all([setCounterResult, setFavoriteResult]);\n\t\t};\n\t}\n\n\textractLoadCountersError(response): ?string\n\t{\n\t\tconst favoriteCounterGetResult = response[RestMethod.imChatFavoriteCounterGet];\n\t\tif (favoriteCounterGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatFavoriteCounterGet}: ${favoriteCounterGetResult?.error()}`;\n\t\t}\n\n\t\tconst favoriteGetResult = response[RestMethod.imChatFavoriteGet];\n\t\tif (favoriteGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatFavoriteGet}: ${favoriteGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst favoritesCount = this.getFavoritesCountFromModel();\n\t\tif (favoritesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams.LAST_ID = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatFavoriteGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatFavoriteGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst favoriteMessagesResult = response.data();\n\n\t\tif (favoriteMessagesResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(favoriteMessagesResult.list);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(favoriteMessagesResult);\n\t}\n\n\tupdateModels(resultData: {list: [], users: [], files: []}): Promise\n\t{\n\t\tconst {list = [], users = [], files = []} = resultData;\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\n\t\tconst rawMessages = list.map(favorite => favorite.message);\n\n\t\tconst setFilesPromise = this.store.dispatch('files/set', files);\n\t\tconst storeMessagesPromise = this.store.dispatch('messages/store', rawMessages);\n\t\tconst setFavoritesPromise = this.store.dispatch('sidebar/favorites/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfavorites: list\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, storeMessagesPromise, setFavoritesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tgetFavoritesCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/favorites/getSize'](this.chatId);\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\nimport {Type} from 'main.core';\n\nconst REQUEST_ITEMS_LIMIT = 50;\nexport class Link extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatUrlCounterGet]: [RestMethod.imChatUrlCounterGet, {chat_id: this.chatId}],\n\t\t\t[RestMethod.imChatUrlGet]: [RestMethod.imChatUrlGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}],\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadCountersError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst linkCounterGetResponse = response[RestMethod.imChatUrlCounterGet].data();\n\t\t\tconst setCounterResult = this.store.dispatch('sidebar/links/setCounter', {\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tcounter: linkCounterGetResponse.counter\n\t\t\t});\n\n\t\t\tconst setLinksResult = this.handleResponse(response[RestMethod.imChatUrlGet]);\n\n\t\t\treturn Promise.all([setCounterResult, setLinksResult]);\n\t\t};\n\t}\n\n\textractLoadCountersError(response): string\n\t{\n\t\tconst linkCounterGetResult = response[RestMethod.imChatUrlCounterGet];\n\t\tif (linkCounterGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatUrlCounterGet}: ${linkCounterGetResult?.error()}`;\n\t\t}\n\n\t\tconst linkGetResult = response[RestMethod.imChatUrlGet];\n\t\tif (linkGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatUrlGet}: ${linkGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst linksCount = this.getLinksCountFromModel();\n\t\tif (linksCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams(linksCount);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst linksCount = this.getLinksCountFromModel();\n\t\tconst queryParams = this.getQueryParams(linksCount);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(offset: number = 0): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (Type.isNumber(offset) && offset > 0)\n\t\t{\n\t\t\tqueryParams.OFFSET = offset;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatUrlGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.chatUrlList: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst resultData = response.data();\n\t\tif (resultData.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\treturn this.updateModels(resultData);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setLinksPromise = this.store.dispatch('sidebar/links/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tlinks: list\n\t\t});\n\n\t\treturn Promise.all([setLinksPromise, addUsersPromise]);\n\t}\n\n\tgetLinksCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/links/getSize'](this.chatId);\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Task extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatTaskGet]: [RestMethod.imChatTaskGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadTaskError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\treturn this.handleResponse(response[RestMethod.imChatTaskGet]);\n\t\t};\n\t}\n\n\textractLoadTaskError(response): ?string\n\t{\n\t\tconst taskGetResponse = response[RestMethod.imChatTaskGet];\n\t\tif (taskGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatTaskGet}: ${taskGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst tasksCount = this.getTasksCountFromModel();\n\t\tif (tasksCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatTaskGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatFavoriteGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst tasksResult = response.data();\n\t\tif (tasksResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.firstPageReceived = true;\n\t\tthis.lastId = this.getLastElementId(tasksResult.list);\n\n\t\treturn this.updateModels(tasksResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setTasksPromise = this.store.dispatch('sidebar/tasks/set', {\n\t\t\tchatId: this.chatId,\n\t\t\ttasks: list\n\t\t});\n\n\t\treturn Promise.all([setTasksPromise, addUsersPromise]);\n\t}\n\n\tgetTasksCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/tasks/getSize'](this.chatId);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Main extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imDialogUsersList]: [RestMethod.imDialogUsersList, {\n\t\t\t\tdialog_id: this.dialogId,\n\t\t\t\tlimit: REQUEST_ITEMS_LIMIT\n\t\t\t}]\n\t\t};\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst membersCount = this.getMembersCountFromModel();\n\t\tif (membersCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\treturn {\n\t\t\t'DIALOG_ID': this.dialogId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t\t'LAST_ID': this.lastId,\n\t\t};\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imDialogUsersList, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarMain: Im.DialogUsersList: page request error', error);\n\t\t});\n\t}\n\n\tgetResponseHandler(): Function\n\t{\n\t\treturn (response) => {\n\t\t\treturn this.handleResponse(response[RestMethod.imDialogUsersList]);\n\t\t};\n\t}\n\n\tupdateModels(users: Array): Promise\n\t{\n\t\tconst userIds = [];\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tusers.forEach(user => {\n\t\t\tuserIds.push(user.id);\n\t\t});\n\n\t\tconst setMembersPromise = this.store.dispatch('sidebar/members/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tusers: userIds\n\t\t});\n\n\t\treturn Promise.all([addUsersPromise, setMembersPromise]);\n\t}\n\n\tgetMembersCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/members/getSize'](this.chatId);\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst users = response.data();\n\t\tif (users.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(users);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(users);\n\t}\n}\n","import {SidebarFileTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Brief extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTypes.brief);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTypes.brief);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Meeting extends Base\n{\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatCalendarGet]: [RestMethod.imChatCalendarGet, {\n\t\t\t\tchat_id: this.chatId,\n\t\t\t\tlimit: REQUEST_ITEMS_LIMIT\n\t\t\t}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadTaskError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\treturn this.handleResponse(response[RestMethod.imChatCalendarGet]);\n\t\t};\n\t}\n\n\textractLoadTaskError(response): ?string\n\t{\n\t\tconst calendarGetResponse = response[RestMethod.imChatCalendarGet];\n\t\tif (calendarGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatCalendarGet}: ${calendarGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst meetingsCount = this.getMeetingsCountFromState();\n\t\tif (meetingsCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatCalendarGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatCalendarGet: page request error', error);\n\t\t});\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setMeetingsPromise = this.store.dispatch('sidebar/meetings/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tmeetings: list\n\t\t});\n\n\t\treturn Promise.all([setMeetingsPromise, addUsersPromise]);\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst meetingsResult = response.data();\n\t\tif (meetingsResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.lastId = this.getLastElementId(meetingsResult.list);\n\n\t\treturn this.updateModels(meetingsResult);\n\t}\n\n\tgetMeetingsCountFromState(): number\n\t{\n\t\treturn this.store.getters['sidebar/meetings/getSize'](this.chatId);\n\t}\n}","import {RestMethod, SidebarDetailBlock} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50; // temporary value. Should be 50\n\nexport class FileUnsorted extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imDiskFolderListGet]: [RestMethod.imDiskFolderListGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}],\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadFileError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst fileResult = response[RestMethod.imDiskFolderListGet].data();\n\n\t\t\treturn this.updateModels(fileResult);\n\t\t};\n\t}\n\n\textractLoadFileError(response): ?string\n\t{\n\t\tconst diskFolderListGetResult = response[RestMethod.imDiskFolderListGet];\n\t\tif (diskFolderListGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imDiskFolderListGet}: ${diskFolderListGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst filesCount = this.getFilesCountFromModel(SidebarDetailBlock.fileUnsorted);\n\t\tif (filesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams.LAST_ID = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imDiskFolderListGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imDiskFolderListGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst diskFolderListGetResult = response.data();\n\t\tif (diskFolderListGetResult.files.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(diskFolderListGetResult.files);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(diskFolderListGetResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {users, files} = resultData;\n\n\t\tconst preparedFiles = files.map(file => {\n\t\t\treturn {...file, subType: SidebarDetailBlock.fileUnsorted};\n\t\t});\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setFilesPromise = this.store.dispatch('files/set', preparedFiles);\n\t\tconst setSidebarFilesPromise = this.store.dispatch('sidebar/files/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfiles: preparedFiles\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, setSidebarFilesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tgetFilesCountFromModel(subType): number\n\t{\n\t\treturn this.store.getters['sidebar/files/getSize'](this.chatId, subType);\n\t}\n}","import { RestMethod } from 'im.v2.const';\n\nimport { Base } from './base';\n\ntype RestResponse = {\n\tadditionalMessages: [],\n\tfiles: [],\n\tmessages: [],\n\treactions: [],\n\treminders: [],\n\tusers: [],\n\tusersShort: []\n};\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class MessageSearch extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\t#lastMessageId: number = 0;\n\t#query: string = '';\n\n\tsearchOnServer(query: string): Promise<string[]>\n\t{\n\t\tif (this.#query !== query)\n\t\t{\n\t\t\tthis.#query = query;\n\t\t\tthis.hasMoreItemsToLoad = true;\n\t\t\tthis.#lastMessageId = 0;\n\t\t}\n\n\t\treturn this.#request();\n\t}\n\n\tloadNextPage(): Promise<string[]>\n\t{\n\t\treturn this.#request();\n\t}\n\n\t#request(): Promise<string[]>\n\t{\n\t\tconst config = {\n\t\t\tSEARCH_MESSAGE: this.#query,\n\t\t\tCHAT_ID: this.chatId,\n\t\t};\n\n\t\tif (this.#lastMessageId > 0)\n\t\t{\n\t\t\tconfig.LAST_ID = this.#lastMessageId;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callMethod(RestMethod.imDialogMessagesSearch, config).then((response) => {\n\t\t\t\tconst responseData: RestResponse = response.data();\n\t\t\t\tresolve(this.#processSearchResponse(responseData));\n\t\t\t}).catch((error) => reject(error));\n\t\t});\n\t}\n\n\tgetInitialRequest(): {}\n\t{\n\t\treturn {};\n\t}\n\n\tgetResponseHandler(): Function\n\t{\n\t\treturn () => {};\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tresetSearchState()\n\t{\n\t\tthis.#lastMessageId = 0;\n\t\tthis.#query = '';\n\t\tthis.hasMoreItemsToLoad = true;\n\t}\n\n\t#processSearchResponse(response: RestResponse): Promise<string[]>\n\t{\n\t\tthis.#lastMessageId = this.#getLastMessageId(response);\n\t\tif (response.messages.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\treturn this.#updateModels(response).then(() => {\n\t\t\treturn response.messages.map((message) => message.id);\n\t\t});\n\t}\n\n\t#updateModels(rawData: RestResponse): Promise\n\t{\n\t\tconst {\n\t\t\tfiles,\n\t\t\tusers,\n\t\t\tusersShort,\n\t\t\treactions,\n\t\t\tadditionalMessages,\n\t\t\tmessages,\n\t\t} = rawData;\n\n\t\tconst usersPromise = Promise.all([\n\t\t\tthis.userManager.setUsersToModel(users),\n\t\t\tthis.userManager.addUsersToModel(usersShort),\n\t\t]);\n\t\tconst filesPromise = this.store.dispatch('files/set', files);\n\t\tconst reactionsPromise = this.store.dispatch('messages/reactions/set', reactions);\n\t\tconst additionalMessagesPromise = this.store.dispatch('messages/store', additionalMessages);\n\t\tconst messagesPromise = this.store.dispatch('messages/store', messages);\n\n\t\treturn Promise.all([\n\t\t\tfilesPromise, usersPromise, reactionsPromise, additionalMessagesPromise, messagesPromise,\n\t\t]);\n\t}\n\n\t#getLastMessageId(response: RestResponse): number\n\t{\n\t\tif (response.messages.length === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst [oldestMessage] = response.messages;\n\n\t\treturn oldestMessage.id;\n\t}\n}\n","import {Extension} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\n\nexport class SettingsManager\n{\n\tstore: Object = null;\n\tsettings: Object = null;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.settings = Extension.getSettings('im.v2.component.sidebar');\n\t\tthis.saveSettings();\n\t}\n\n\tsaveSettings()\n\t{\n\t\tthis.store.dispatch('sidebar/setFilesMigrated', this.settings.get('filesMigrated', false));\n\t\tthis.store.dispatch('sidebar/setLinksMigrated', this.settings.get('linksAvailable', false));\n\t}\n\n\tgetBlocks(): string[]\n\t{\n\t\treturn this.settings.get('blocks', []);\n\t}\n\n\tisLinksMigrationFinished(): boolean\n\t{\n\t\treturn this.store.state.sidebar.isLinksMigrated;\n\t}\n\n\tcanShowBriefs(): boolean\n\t{\n\t\treturn this.settings.get('canShowBriefs', false);\n\t}\n\n\tisFileMigrationFinished(): boolean\n\t{\n\t\treturn this.store.state.sidebar.isFilesMigrated;\n\t}\n}","import {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {PlacementType, SidebarBlock} from 'im.v2.const';\nimport {MarketManager} from 'im.v2.lib.market';\n\nimport {SettingsManager} from './settings-manager';\n\nconst BLOCKS_ORDER = {\n\t[SidebarBlock.main]: 10,\n\t[SidebarBlock.info]: 20,\n\t[SidebarBlock.file]: 30,\n\t[SidebarBlock.brief]: 40,\n\t[SidebarBlock.sign]: 50,\n\t[SidebarBlock.task]: 60,\n\t[SidebarBlock.meeting]: 70,\n};\n\nexport class AvailabilityManager\n{\n\t#settingsManager: SettingsManager = null;\n\t#store: Store;\n\t#dialogId: string;\n\n\tconstructor(settingsManager: SettingsManager, dialogId: string)\n\t{\n\t\tthis.#settingsManager = settingsManager;\n\t\tthis.#store = Core.getStore();\n\t\tthis.#dialogId = dialogId;\n\t}\n\n\tgetBlocks(): string[]\n\t{\n\t\tconst blocksFromSetting = this.#settingsManager.getBlocks();\n\t\tconst availableBlocks = this.#filterUnavailableBlocks(blocksFromSetting);\n\n\t\treturn this.#sortBlocks(availableBlocks);\n\t}\n\n\t#filterUnavailableBlocks(blocks: string[]): string[]\n\t{\n\t\tconst blocksSet = new Set(blocks);\n\n\t\tif (this.#isFileMigrationFinished())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.fileUnsorted);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.brief);\n\t\t\tblocksSet.delete(SidebarBlock.file);\n\t\t}\n\n\t\tif (!this.#canShowBriefs())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.brief);\n\t\t}\n\n\t\tif (!this.#hasMarketApps())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.market);\n\t\t}\n\n\t\treturn [...blocksSet];\n\t}\n\n\t#isFileMigrationFinished(): boolean\n\t{\n\t\treturn this.#settingsManager.isFileMigrationFinished();\n\t}\n\n\t#canShowBriefs(): boolean\n\t{\n\t\treturn this.#settingsManager.canShowBriefs();\n\t}\n\n\t#hasMarketApps(): boolean\n\t{\n\t\treturn MarketManager.getInstance().getAvailablePlacementsByType(PlacementType.sidebar, this.#dialogId).length > 0;\n\t}\n\n\t#sortBlocks(availableBlocks: string[]): string[]\n\t{\n\t\treturn [...availableBlocks].sort((block1, block2) => {\n\t\t\treturn BLOCKS_ORDER[block1] - BLOCKS_ORDER[block2];\n\t\t});\n\t}\n}","import { Text, Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { SidebarDetailBlock, SidebarBlock } from 'im.v2.const';\n\nimport { Media } from './blocks/media';\nimport { Audio } from './blocks/audio';\nimport { Document } from './blocks/document';\nimport { Other } from './blocks/other';\nimport { Favorite } from './blocks/favorite';\nimport { Link } from './blocks/link';\nimport { Task } from './blocks/task';\nimport { Main } from './blocks/main';\nimport { Brief } from './blocks/brief';\nimport { Meeting } from './blocks/meeting';\nimport { FileUnsorted } from './blocks/file-unsorted';\nimport { MessageSearch } from './blocks/message-search';\nimport { AvailabilityManager } from './availability-manager';\n\nconst BlockClasses = {\n\tMain, Favorite, Link, Task, Media, Audio, Document, Other, Brief, Meeting, FileUnsorted, MessageSearch,\n};\n\nconst BlockToServices = Object.freeze({\n\t[SidebarBlock.main]: [SidebarDetailBlock.main],\n\t[SidebarBlock.info]: [SidebarDetailBlock.favorite, SidebarDetailBlock.link],\n\t[SidebarBlock.task]: [SidebarDetailBlock.task],\n\t[SidebarBlock.meeting]: [SidebarDetailBlock.meeting],\n\t[SidebarBlock.file]: [\n\t\tSidebarDetailBlock.media,\n\t\tSidebarDetailBlock.audio,\n\t\tSidebarDetailBlock.document,\n\t\tSidebarDetailBlock.brief,\n\t\tSidebarDetailBlock.other,\n\t],\n\t[SidebarBlock.fileUnsorted]: [SidebarDetailBlock.fileUnsorted],\n\t[SidebarBlock.messageSearch]: [SidebarDetailBlock.messageSearch],\n});\n\ntype BlockService = {\n\ttype: string;\n\tblockManager: Object;\n\tinitialRequest: Object;\n\tresponseHandler: Function;\n};\n\nexport class SidebarService\n{\n\tblockServices: BlockService[] = [];\n\tdialogId: string = '';\n\tchatId: number = 0;\n\tstore: Object = null;\n\trestClient: Object = null;\n\tavailabilityManager: AvailabilityManager = null;\n\n\tconstructor(availabilityManager: AvailabilityManager)\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.availabilityManager = availabilityManager;\n\t}\n\n\t// region public methods\n\trequestInitialData(): Promise\n\t{\n\t\tif (!Type.isArrayFilled(this.blockServices))\n\t\t{\n\t\t\tthis.buildBlocks();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callBatch(\n\t\t\t\tthis.getInitialRequestQuery(),\n\t\t\t\t(result) => resolve(this.handleBatchRequestResult(result)),\n\t\t\t\t(error) => reject(error),\n\t\t\t);\n\t\t});\n\t}\n\n\tgetBlockInstance(blockName: string)\n\t{\n\t\tif (!Type.isArrayFilled(this.blockServices))\n\t\t{\n\t\t\tthis.buildBlocks();\n\t\t}\n\n\t\treturn this.blockServices.find((block: BlockService) => block.type === blockName.toLowerCase())?.blockManager;\n\t}\n\n\tsetChatId(chatId: number)\n\t{\n\t\tthis.chatId = chatId;\n\t}\n\n\tsetDialogId(dialogId: string)\n\t{\n\t\tthis.dialogId = dialogId;\n\t}\n\t// endregion\n\n\tbuildBlocks(): void\n\t{\n\t\tconst classNames = this.getServiceClassesForBlocks();\n\n\t\tthis.blockServices = classNames.map((className: string): BlockService => {\n\t\t\tconst blockManager = new BlockClasses[className](this.chatId, this.dialogId);\n\n\t\t\treturn {\n\t\t\t\ttype: className.toLowerCase(),\n\t\t\t\tblockManager,\n\t\t\t\tinitialRequest: blockManager.getInitialRequest(),\n\t\t\t\tresponseHandler: blockManager.getResponseHandler(),\n\t\t\t};\n\t\t});\n\t}\n\n\tgetServiceClassesForBlocks(): string[]\n\t{\n\t\tconst services = [];\n\n\t\tconst blockList = this.availabilityManager.getBlocks();\n\t\tblockList.forEach((block: string) => {\n\t\t\tconst blockServices = BlockToServices[block];\n\t\t\tif (blockServices)\n\t\t\t{\n\t\t\t\tservices.push(...blockServices);\n\t\t\t}\n\t\t});\n\n\t\treturn services.map((service) => Text.capitalize(service));\n\t}\n\n\tgetInitialRequestQuery(): Object\n\t{\n\t\tlet query = {};\n\t\tthis.blockServices.forEach((block) => {\n\t\t\tquery = Object.assign(query, block.initialRequest);\n\t\t});\n\n\t\treturn query;\n\t}\n\n\thandleBatchRequestResult(response): Promise\n\t{\n\t\tconst responseHandlersResult = [];\n\t\tthis.blockServices.forEach((block) => {\n\t\t\tresponseHandlersResult.push(block.responseHandler(response));\n\t\t});\n\n\t\treturn Promise.all(responseHandlersResult).then(() => {\n\t\t\treturn this.setInited();\n\t\t}).catch((error) => console.error(error));\n\t}\n\n\tsetInited(): Promise\n\t{\n\t\treturn this.store.dispatch('sidebar/setInited', this.chatId);\n\t}\n}\n","import { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { ImModelUser } from 'im.v2.model';\n\n// @vue/component\nexport const DetailUser = {\n\tname: 'DetailUser',\n\tcomponents: { Avatar, ChatTitle },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisModerator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): {showContextButton: boolean}\n\t{\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tposition(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.dialogId, true);\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonClickContextMenu(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tuserDialogId: this.dialogId,\n\t\t\t\ttarget: event.currentTarget,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bx-im-sidebar-main-detail__user\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__avatar-container\">\n\t\t\t\t<Avatar :size=\"AvatarSize.L\" :dialogId=\"dialogId\" />\n\t\t\t\t<span v-if=\"isModerator\" class=\"bx-im-sidebar-main-detail__avatar-moderator-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__user-info-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-detail__user-title-container\">\n\t\t\t\t\t<a :href=\"userLink\" target=\"_blank\" class=\"bx-im-sidebar-main-detail__user-title-link\">\n\t\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" />\n\t\t\t\t\t</a>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\t\tclass=\"bx-im-sidebar-main-detail__context-menu-icon bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t\t@click=\"onClickContextMenu\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-main-detail__position-text\" :title=\"position\">\n\t\t\t\t\t{{ position }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\t\n\t`,\n};\n","import {Loader} from 'im.v2.component.elements';\nimport '../css/detail.css';\n\n// @vue/component\nexport const SidebarDetail = {\n\tname: 'SidebarDetail',\n\tcomponents: {Loader},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['onScroll'],\n\tdata() {\n\t\treturn {\n\t\t\tisLoading: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\thasInitialData(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/isInited'](this.chatId);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.loadFirstPage();\n\t},\n\tmethods:\n\t{\n\t\tloadFirstPage()\n\t\t{\n\t\t\tif (this.hasInitialData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadFirstPage().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\t\tneedToLoadNextPage(event)\n\t\t{\n\t\t\treturn event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight - event.target.clientHeight;\n\t\t},\n\t\tonScroll(event)\n\t\t{\n\t\t\tthis.$emit('onScroll');\n\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.needToLoadNextPage(event) || !this.service.hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadNextPage().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail__container bx-im-sidebar-detail__scope\" @scroll=\"onScroll\">\n\t\t\t<slot :isLoading=\"isLoading\" :chatId=\"chatId\" :dialogId=\"dialogId\"></slot>\n\t\t\t<Loader v-if=\"isLoading\" class=\"bx-im-sidebar-detail__loader-container\" />\n\t\t</div>\n\t`\n};","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {BaseMenu} from 'im.v2.lib.menu';\nimport {EventType} from 'im.v2.const';\nimport type {MenuItem} from 'im.v2.lib.menu';\n\nexport class SidebarMenu extends BaseMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.id = 'im-sidebar-context-menu';\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t};\n\t}\n\n\tgetOpenContextMessageItem(): ?MenuItem\n\t{\n\t\tif (!this.context.messageId || this.context.messageId === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_GO_TO_CONTEXT_MESSAGE'),\n\t\t\tonclick: () => {\n\t\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\t\tmessageId: this.context.messageId,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetCopyLinkItem(title: string): ?MenuItem\n\t{\n\t\tif (!BX.clipboard.isCopySupported())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: title,\n\t\t\tonclick: () => {\n\t\t\t\tif (BX.clipboard.copy(this.context.source))\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_SIDEBAR_COPIED_SUCCESS')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n}","import { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { CallManager } from 'im.v2.lib.call';\nimport { showKickUserConfirm, showLeaveFromChatConfirm } from 'im.v2.lib.confirm';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ChatActionType, EventType } from 'im.v2.const';\nimport { ChatService } from 'im.v2.provider.service';\nimport { Messenger } from 'im.public';\n\nimport { SidebarMenu } from '../sidebar-base-menu';\n\nimport type { ImModelUser } from 'im.v2.model';\nimport type { MenuItem } from 'im.v2.lib.menu';\n\ntype MembersMenuContext = {\n\tdialogId: string,\n\tcontextDialogId: string,\n\tcontextChatId: string,\n};\n\nexport class MembersMenu extends SidebarMenu\n{\n\tcontext: MembersMenuContext;\n\tchatService: ChatService;\n\tcallManager: CallManager;\n\tpermissionManager: PermissionManager;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.chatService = new ChatService();\n\t\tthis.callManager = CallManager.getInstance();\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getInsertNameItem(),\n\t\t\tthis.getSendMessageItem(),\n\t\t\tthis.getCallItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getOpenUserCalendarItem(),\n\t\t\tthis.getKickItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetInsertNameItem(): MenuItem\n\t{\n\t\tconst user: ImModelUser = this.store.getters['users/get'](this.context.dialogId, true);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_INSERT_NAME'),\n\t\t\tonclick: () => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertMention, {\n\t\t\t\t\tmentionText: user.name,\n\t\t\t\t\tmentionReplacement: Utils.text.getMentionBbCode(this.context.dialogId, user.name),\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetSendMessageItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_WRITE'),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCallItem(): ?MenuItem\n\t{\n\t\tconst chatCanBeCalled = this.callManager.chatCanBeCalled(this.context.dialogId);\n\t\tconst chatIsAllowedToCall = this.permissionManager.canPerformAction(ChatActionType.call, this.context.dialogId);\n\t\tif (!chatCanBeCalled || !chatIsAllowedToCall)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_CALL_2'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.callManager.startCall(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenProfileItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['dialogues/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE'),\n\t\t\thref: profileUri,\n\t\t\tonclick: () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenUserCalendarItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['dialogues/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst user = this.store.getters['users/get'](this.context.dialogId, true);\n\t\tif (user.bot)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getCalendarLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_CALENDAR'),\n\t\t\tonclick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetKickItem(): ?MenuItem\n\t{\n\t\tconst userIdToKick = Number.parseInt(this.context.dialogId, 10);\n\t\tconst isSelfKick = userIdToKick === this.getCurrentUserId();\n\t\tconst canKick = this.permissionManager.canPerformKick(this.context.contextDialogId, this.context.dialogId);\n\t\tif (isSelfKick || !canKick)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_KICK_FROM_CHAT'),\n\t\t\tonclick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showKickUserConfirm();\n\t\t\t\tif (userChoice === true)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.kickUserFromChat(this.context.contextDialogId, this.context.dialogId);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\tgetLeaveItem(): ?MenuItem\n\t{\n\t\tconst userIdToKick = Number.parseInt(this.context.dialogId, 10);\n\t\tconst isSelfKick = userIdToKick === this.getCurrentUserId();\n\n\t\tconst canLeaveChat = this.permissionManager.canPerformAction(ChatActionType.leave, this.context.contextDialogId);\n\t\tif (!isSelfKick || !canLeaveChat)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_LEAVE'),\n\t\t\tonclick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showLeaveFromChatConfirm();\n\t\t\t\tif (userChoice === true)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.leaveChat(this.context.contextDialogId);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n}\n","import {Core} from 'im.v2.application.core';\nimport {ImModelDialog} from 'im.v2.model';\nimport {Button, ButtonColor, ButtonSize} from 'im.v2.component.elements';\n\nimport {DetailUser} from './detail-user';\nimport {SidebarDetail} from '../detail';\nimport {MembersMenu} from '../../classes/context-menu/main/members-menu';\n\nimport '../../css/main/detail.css';\n\n// @vue/component\nexport const MainDetail = {\n\tname: 'MainDetail',\n\tcomponents: {DetailUser, SidebarDetail, Button},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tdialogManagers(): number[]\n\t\t{\n\t\t\treturn this.dialog.managerList;\n\t\t},\n\t\tdialogIds(): string[]\n\t\t{\n\t\t\tconst users = this.$store.getters['sidebar/members/get'](this.chatId);\n\n\t\t\treturn users.map(userId => userId.toString());\n\t\t},\n\t\tshowCopyInviteButton(): boolean\n\t\t{\n\t\t\t// todo\n\t\t\treturn true;\n\t\t},\n\t\tchatLink(): string\n\t\t{\n\t\t\treturn `${Core.getHost()}/online/?IM_DIALOG=${this.dialogId}`;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MembersMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tisModerator(userDialogId: string): boolean\n\t\t{\n\t\t\tconst userId = Number.parseInt(userDialogId, 10);\n\n\t\t\treturn this.dialogManagers.includes(userId);\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tdialogId: event.userDialogId,\n\t\t\t\tcontextDialogId: this.dialogId,\n\t\t\t\tcontextChatId: this.chatId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonCopyInviteClick()\n\t\t{\n\t\t\tif (BX.clipboard.copy(this.chatLink))\n\t\t\t{\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_COPIED_SUCCESS')\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-main-detail__scope\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__invitation-button-container\">\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"showCopyInviteButton\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_COPY_INVITE_LINK')\"\n\t\t\t\t\t:size=\"ButtonSize.M\"\n\t\t\t\t\t:color=\"ButtonColor.PrimaryBorder\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\ticon=\"link\"\n\t\t\t\t\t@click=\"onCopyInviteClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailUser \n\t\t\t\tv-for=\"dialogId in dialogIds\" \n\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t:isModerator=\"isModerator(dialogId)\"\n\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import { hint } from 'ui.vue3.directives.hint';\n\nimport { Core } from 'im.v2.application.core';\nimport { Toggle, ToggleSize } from 'im.v2.component.elements';\nimport { ImModelDialog } from 'im.v2.model';\nimport { ChatActionType } from 'im.v2.const';\nimport { ChatService } from 'im.v2.provider.service';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport '../../css/main/settings.css';\n\n// @vue/component\nexport const Settings = {\n\tname: 'MainPreviewSettings',\n\tdirectives: { hint },\n\tcomponents: { Toggle },\n\tprops:\n\t{\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisModerator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tautoDeleteEnabled: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tToggleSize: () => ToggleSize,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tisGroupChat(): boolean\n\t\t{\n\t\t\treturn this.dialogId.startsWith('chat');\n\t\t},\n\t\tcanBeMuted(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.mute, this.dialogId);\n\t\t},\n\t\tisChatMuted(): boolean\n\t\t{\n\t\t\tconst isMuted = this.dialog.muteList.find((element) => {\n\t\t\t\treturn element === Core.getUserId();\n\t\t\t});\n\n\t\t\treturn Boolean(isMuted);\n\t\t},\n\t\thintMuteNotAvailable(): ?Object\n\t\t{\n\t\t\tif (this.canBeMuted)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MUTE_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 141,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\thintAutoDeleteNotAvailable()\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_MESSENGER_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 125,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tchatTypeClass(): string\n\t\t{\n\t\t\treturn this.isGroupChat ? '--group-chat' : '--personal';\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tmuteActionHandler()\n\t\t{\n\t\t\tif (!this.canBeMuted)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isChatMuted)\n\t\t\t{\n\t\t\t\tthis.getChatService().unmuteChat(this.dialogId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getChatService().muteChat(this.dialogId);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-settings__skeleton\" :class=\"chatTypeClass\"></div>\n\t\t<div v-else class=\"bx-im-sidebar-main-settings__container bx-im-sidebar-main-settings__scope\" :class=\"chatTypeClass\">\n\t\t\t<div\n\t\t\t\tv-if=\"isGroupChat\"\n\t\t\t\tclass=\"bx-im-sidebar-main-settings__notification-container\"\n\t\t\t\t:class=\"[canBeMuted ? '' : '--not-active']\"\n\t\t\t\tv-hint=\"hintMuteNotAvailable\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__notification-title\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-settings__title-text bx-im-sidebar-main-settings__title-icon --notification\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_ENABLE_NOTIFICATION_TITLE_2') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Toggle :size=\"ToggleSize.M\" :isEnabled=\"!isChatMuted\" @change=\"muteActionHandler\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-container --not-active\" v-hint=\"hintAutoDeleteNotAvailable\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-title\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-settings__title-text bx-im-sidebar-main-settings__title-icon --autodelete\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_ENABLE_AUTODELETE_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Toggle :size=\"ToggleSize.M\" :isEnabled=\"autoDeleteEnabled\" />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-status\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_AUTODELETE_STATUS_OFF') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { hint } from 'ui.vue3.directives.hint';\n\nimport { Avatar, AvatarSize, ChatTitle, Button as MessengerButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { ChatActionType } from 'im.v2.const';\nimport { ImModelDialog } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport { Settings } from './settings';\n\nimport '../../css/main/preview-personal-chat.css';\n\n// @vue/component\nexport const PersonalChatPreview = {\n\tname: 'PersonalChatPreview',\n\tdirectives: { hint },\n\tcomponents: { Avatar, ChatTitle, MessengerButton, AddToChat, Settings },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tuserPosition(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tcanInviteMembers(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-main-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-personal-chat__avatar-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-personal-chat__avatar-container\">\n\t\t\t\t<Avatar\n\t\t\t\t\t:size=\"AvatarSize.XXXL\"\n\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\tclass=\"bx-im-sidebar-main-preview-personal-chat__avatar\"\n\t\t\t\t/>\n\t\t\t\t<a :href=\"userLink\" target=\"_blank\">\n\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" class=\"bx-im-sidebar-main-preview-personal-chat__user-name\" />\n\t\t\t\t</a>\n\t\t\t\t<div class=\"bx-im-sidebar-main-preview-personal-chat__user-position\" :title=\"userPosition\">\n\t\t\t\t\t{{ userPosition }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-personal-chat__invite-button-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-personal-chat__invite-button-container\" ref=\"add-members\">\n\t\t\t\t<MessengerButton\n\t\t\t\t\tv-if=\"canInviteMembers\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_INVITE_BUTTON_TEXT')\"\n\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<Settings :isLoading=\"isLoading\" :dialogId=\"dialogId\" />\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: -220, offsetLeft: -320}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ImModelDialog } from 'im.v2.model';\nimport { ChatActionType } from 'im.v2.const';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { Avatar, AvatarSize, ChatTitle, Button as MessengerButton, ButtonSize, ButtonColor } from 'im.v2.component.elements';\n\nimport { Settings } from './settings';\n\nimport '../../css/main/preview-group-chat.css';\n\n// @vue/component\nexport const GroupChatPreview = {\n\tname: 'GroupChatPreview',\n\tcomponents: { Avatar, ChatTitle, MessengerButton, AddToChat, Settings },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tdialogIds(): string[]\n\t\t{\n\t\t\tconst PREVIEW_USERS_COUNT = 4;\n\t\t\tconst userIds = this.$store.getters['sidebar/members/get'](this.chatId);\n\n\t\t\treturn userIds.map((id) => id.toString()).slice(0, PREVIEW_USERS_COUNT);\n\t\t},\n\t\tusersInChatCount(): number\n\t\t{\n\t\t\treturn this.dialog.userCounter;\n\t\t},\n\t\tmoreUsersCount(): number\n\t\t{\n\t\t\treturn Math.max(this.usersInChatCount - this.dialogIds.length, 0);\n\t\t},\n\t\tcanSeeMembers(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.userList, this.dialogId);\n\t\t},\n\t\tcanInviteMembers(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenUsers()\n\t\t{\n\t\t\tthis.$emit('openDetail');\n\t\t},\n\t\tonOpenInvitePopup()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-main-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-group-chat__avatar-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-group-chat__avatar-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-preview-group-chat__avatar\">\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XXXL\" :withStatus=\"false\" :dialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t\t<ChatTitle :dialogId=\"dialogId\" :twoLine=\"true\" class=\"bx-im-sidebar-main-preview-group-chat__title\" />\n\t\t\t</div>\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-group-chat__members-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-group-chat__members-container\">\n\t\t\t\t<div v-if=\"canSeeMembers\" class=\"bx-im-sidebar-main-preview-group-chat__members\" @click=\"onOpenUsers\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-preview-group-chat__members-avatars\" >\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-main-preview-group-chat__chat-user-avatar\"\n\t\t\t\t\t\t\tv-for=\"id in dialogIds\"\n\t\t\t\t\t\t\t:size=\"AvatarSize.S\"\n\t\t\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t\t\t:dialogId=\"id\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"moreUsersCount > 0\" class=\"bx-im-sidebar-main-preview-group-chat__more-users-count-text\">\n\t\t\t\t\t\t+{{ moreUsersCount }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div ref=\"add-members\">\n\t\t\t\t\t<MessengerButton\n\t\t\t\t\t\tv-if=\"canInviteMembers\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_INVITE_BUTTON_TEXT')\"\n\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t@click=\"onOpenInvitePopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Settings :isLoading=\"isLoading\" :dialogId=\"dialogId\" />\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: -220, offsetLeft: -420}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {PersonalChatPreview} from './preview-personal-chat';\nimport {GroupChatPreview} from './preview-group-chat';\n\n// @vue/component\nexport const MainPreview = {\n\tname: 'MainPreview',\n\tcomponents: {GroupChatPreview, PersonalChatPreview},\n\tinheritAttrs: false,\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tisGroupChat(): boolean\n\t\t{\n\t\t\treturn this.dialogId.startsWith('chat');\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.main, detailBlock: SidebarDetailBlock.main});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<GroupChatPreview \n\t\t\tv-if=\"isGroupChat\" \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:isLoading=\"isLoading\" \n\t\t\t@openDetail=\"onOpenDetail\"\n\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t/>\n\t\t<PersonalChatPreview \n\t\t\tv-else \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:isLoading=\"isLoading\"\n\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t/>\n\t`\n};","import {ImModelDialog} from 'im.v2.model';\nimport {DialogType, SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {Parser} from 'im.v2.lib.parser';\nimport {hint} from 'ui.vue3.directives.hint';\nimport '../../css/info/preview.css';\n\nconst MAX_DESCRIPTION_SYMBOLS = 25;\n\n// @vue/component\nexport const InfoPreview = {\n\tname: 'InfoPreview',\n\tdirectives: {hint},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\texpanded: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === DialogType.user;\n\t\t},\n\t\tpreviewDescription(): string\n\t\t{\n\t\t\tif (this.dialog.description.length === 0)\n\t\t\t{\n\t\t\t\treturn this.chatTypeText;\n\t\t\t}\n\n\t\t\tif (this.dialog.description.length > MAX_DESCRIPTION_SYMBOLS)\n\t\t\t{\n\t\t\t\treturn `${this.dialog.description.slice(0, MAX_DESCRIPTION_SYMBOLS)}...`;\n\t\t\t}\n\n\t\t\treturn this.dialog.description;\n\t\t},\n\t\tdescriptionToShow(): string\n\t\t{\n\t\t\tconst rawText = this.expanded ? this.dialog.description : this.previewDescription;\n\n\t\t\treturn Parser.purifyText(rawText);\n\t\t},\n\t\tchatTypeText(): string\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_USER');\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_GROUP_V2');\n\t\t},\n\t\tshowExpandButton(): boolean\n\t\t{\n\t\t\tif (this.expanded)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.dialog.description.length >= MAX_DESCRIPTION_SYMBOLS;\n\t\t},\n\t\tfavoriteCounter(): string\n\t\t{\n\t\t\tconst counter = this.$store.getters['sidebar/favorites/getCounter'](this.chatId);\n\n\t\t\treturn this.getCounterString(counter);\n\t\t},\n\t\turlCounter(): string\n\t\t{\n\t\t\tconst counter = this.$store.getters['sidebar/links/getCounter'](this.chatId);\n\n\t\t\treturn this.getCounterString(counter);\n\t\t},\n\t\tisLinksAvailable(): boolean\n\t\t{\n\t\t\treturn this.$store.state.sidebar.isLinksMigrated;\n\t\t},\n\t\thintDirectiveContent(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_LINKS_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 141,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetCounterString(counter: number): string\n\t\t{\n\t\t\tconst MAX_COUNTER = 100;\n\t\t\tif (counter >= MAX_COUNTER)\n\t\t\t{\n\t\t\t\treturn '99+';\n\t\t\t}\n\n\t\t\treturn counter.toString();\n\t\t},\n\t\tonFavouriteClick()\n\t\t{\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.info, detailBlock: SidebarDetailBlock.favorite});\n\t\t},\n\t\tonLinkClick()\n\t\t{\n\t\t\tif (!this.isLinksAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.info, detailBlock: SidebarDetailBlock.link});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-info-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-info-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-info-preview__container\" :class=\"[expanded ? '--expanded' : '']\">\n\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-container\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-text-container\" :class=\"[expanded ? '--expanded' : '']\">\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-text\">\n\t\t\t\t\t\t\t{{descriptionToShow}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tv-if=\"showExpandButton\"\n\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__show-description-button\"\n\t\t\t\t\t\t@click=\"expanded = !expanded\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_DESCRIPTION_SHOW') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-info-preview__items-container\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__item-container\" @click=\"onFavouriteClick\">\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-container\">\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__favorite-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_FAVORITE_DETAIL_TITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__counter-container\">\n\t\t\t\t\t\t\t<span class=\"bx-im-sidebar-info-preview__counter\">{{favoriteCounter}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__item-container\" \n\t\t\t\t\t\t:class=\"[isLinksAvailable ? '' : '--links-not-active']\"\n\t\t\t\t\t\t@click=\"onLinkClick\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tv-if=\"!isLinksAvailable\" \n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__hint-not-active\" \n\t\t\t\t\t\t\tv-hint=\"hintDirectiveContent\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-container\">\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__link-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_LINK_DETAIL_TITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__counter-container\">\n\t\t\t\t\t\t\t<span class=\"bx-im-sidebar-info-preview__counter\">{{urlCounter}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\ntype FormattableCollection = {\n\tdate: Date,\n};\n\ntype DateGroup = {\n\tid: number,\n\ttitle: string\n};\n\nexport class SidebarCollectionFormatter\n{\n\tcachedDateGroups: Object = {};\n\n\tformat(collection: FormattableCollection[]): Object[]\n\t{\n\t\tconst dateGroups = {};\n\n\t\tcollection.forEach((item) => {\n\t\t\tconst dateGroup = this.getDateGroup(item.date);\n\t\t\tif (!dateGroups[dateGroup.title])\n\t\t\t{\n\t\t\t\tdateGroups[dateGroup.title] = {\n\t\t\t\t\tdateGroupTitle: dateGroup.title,\n\t\t\t\t\titems: [],\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tdateGroups[dateGroup.title].items.push(item);\n\t\t});\n\n\t\treturn Object.values(dateGroups);\n\t}\n\n\tgetDateGroup(date: Date): DateGroup\n\t{\n\t\tconst INDEX_BETWEEN_DATE_AND_TIME = 10;\n\t\t// 2022-10-25T14:58:44.000Z => 2022-10-25\n\t\tconst shortDate = date.toJSON().slice(0, INDEX_BETWEEN_DATE_AND_TIME);\n\t\tif (this.cachedDateGroups[shortDate])\n\t\t{\n\t\t\treturn this.cachedDateGroups[shortDate];\n\t\t}\n\n\t\tthis.cachedDateGroups[shortDate] = {\n\t\t\tid: shortDate,\n\t\t\ttitle: DateFormatter.formatByTemplate(date, DateTemplate.dateGroup),\n\t\t};\n\n\t\treturn this.cachedDateGroups[shortDate];\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.cachedDateGroups = {};\n\t}\n}\n","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class LinkManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete(link: Object)\n\t{\n\t\tthis.store.dispatch('sidebar/links/delete', {\n\t\t\tchatId: link.chatId,\n\t\t\tid: link.id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': link.id};\n\t\tthis.restClient.callMethod(RestMethod.imChatUrlDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting link', error);\n\t\t});\n\t}\n}","import {Loc} from 'main.core';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {LinkManager} from './link-manager';\nimport 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\n\nexport class LinkMenu extends SidebarMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.linkManager = new LinkManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_LINK')),\n\t\t\tthis.getDeleteLinkItem(),\n\t\t];\n\t}\n\n\tgetDeleteLinkItem(): ?MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_FROM_LINKS'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.linkManager.delete(this.context);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport '../../css/info/link-item.css';\n\nimport type { ImModelSidebarLinkItem } from 'im.v2.model';\n\n// @vue/component\nexport const LinkItem = {\n\tname: 'LinkItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops:\n\t{\n\t\tlink: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tlinkItem(): ImModelSidebarLinkItem\n\t\t{\n\t\t\treturn this.link;\n\t\t},\n\t\tsource(): string\n\t\t{\n\t\t\treturn this.linkItem.source;\n\t\t},\n\t\tshortDescription(): string\n\t\t{\n\t\t\tlet hostName = '';\n\t\t\ttry\n\t\t\t{\n\t\t\t\thostName = new URL(this.source).hostname;\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\thostName = this.source;\n\t\t\t\tconsole.error(error);\n\t\t\t}\n\n\t\t\treturn hostName;\n\t\t},\n\t\tdescription(): string\n\t\t{\n\t\t\tconst { name, description } = this.linkItem.richData;\n\t\t\tconst descriptionToShow = description || name || this.source;\n\n\t\t\treturn Utils.text.convertHtmlEntities(descriptionToShow);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.linkItem.authorId.toString();\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn Boolean(this.linkItem.richData?.previewUrl);\n\t\t},\n\t\tpreviewStyles(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.linkItem.richData?.previewUrl}')`,\n\t\t\t\tbackgroundSize: 'cover',\n\t\t\t\tbackgroundRepeat: 'no-repeat',\n\t\t\t};\n\t\t},\n\t\ticonTypeClass(): string\n\t\t{\n\t\t\tswitch (this.linkItem.richData?.type)\n\t\t\t{\n\t\t\t\tcase 'TASKS':\n\t\t\t\t\treturn '--task';\n\t\t\t\tcase 'LANDING':\n\t\t\t\t\treturn '--landing';\n\t\t\t\tcase 'POST':\n\t\t\t\t\treturn '--post';\n\t\t\t\tcase 'CALENDAR':\n\t\t\t\t\treturn '--calendar';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '--common';\n\t\t\t}\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tid: this.linkItem.id,\n\t\t\t\tmessageId: this.linkItem.messageId,\n\t\t\t\tsource: this.source,\n\t\t\t\ttarget: event.currentTarget,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-link-item__container bx-im-link-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<template v-if=\"hasPreview\">\n\t\t\t\t<div class=\"bx-im-link-item__icon-container\" :style=\"previewStyles\"></div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-im-link-item__icon-container\" :class=\"iconTypeClass\">\n\t\t\t\t\t<div class=\"bx-im-link-item__icon\" :class=\"iconTypeClass\" ></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div class=\"bx-im-link-item__content\">\n\t\t\t\t<div class=\"bx-im-link-item__short-description-text\">{{ shortDescription }}</div>\n\t\t\t\t<a :href=\"source\" :title=\"description\" target=\"_blank\" class=\"bx-im-link-item__description-text\">\n\t\t\t\t\t{{ description }}\n\t\t\t\t</a>\n\t\t\t\t<div class=\"bx-im-link-item__author-container\">\n\t\t\t\t\t<Avatar \n\t\t\t\t\t\t:size=\"AvatarSize.XS\" \n\t\t\t\t\t\t:withStatus=\"false\" \n\t\t\t\t\t\t:dialogId=\"authorDialogId\" \n\t\t\t\t\t\tclass=\"bx-im-link-item__author-avatar\" \n\t\t\t\t\t/>\n\t\t\t\t\t<ChatTitle :dialogId=\"authorDialogId\" :showItsYou=\"false\" class=\"bx-im-link-item__author-text\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"showContextButton\" class=\"bx-im-link-item__context-menu\">\n\t\t\t\t<button class=\"bx-im-messenger__context-menu-icon\" @click=\"onContextMenuClick\"></button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/date-group.css';\n\n// @vue/component\nexport const DateGroup = {\n\tname: 'DateGroup',\n\tprops: {\n\t\tdateText: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-date-group__container bx-im-sidebar-date-group__scope\">\n\t\t\t<div class=\"bx-im-sidebar-date-group__text\">\n\t\t\t\t{{ dateText }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\n\nimport '../css/detail-empty-state.css';\n\n// @vue/component\nexport const DetailEmptyState = {\n\tname: 'DetailEmptyState',\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ticonType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn `--${Text.toKebabCase(this.iconType)}`;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-empty-state__container bx-im-sidebar-detail-empty-state__scope\">\n\t\t\t<span class=\"bx-im-sidebar-detail-empty-state__icon\" :class=\"[iconClass]\"></span>\n\t\t\t<span class=\"bx-im-sidebar-detail-empty-state__text\">{{ title }}</span>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { LinkMenu } from '../../classes/context-menu/link/link-menu';\nimport { SidebarDetail } from '../detail';\nimport { LinkItem } from './link-item';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/info/link-detail.css';\n\nimport type { ImModelSidebarLinkItem } from 'im.v2.model';\n\n// @vue/component\nexport const LinkDetail = {\n\tname: 'LinkDetail',\n\tcomponents: { LinkItem, SidebarDetail, DateGroup, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tlinks(): ImModelSidebarLinkItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/links/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.links);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new LinkMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tid: event.id,\n\t\t\t\tmessageId: event.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tsource: event.source,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-link-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-link-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<template v-for=\"link in dateGroup.items\">\n\t\t\t\t\t<LinkItem :link=\"link\" @contextMenuClick=\"onContextMenuClick\" />\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_LINKS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.link\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import {Loc} from 'main.core';\n\nimport {SidebarMenu} from '../sidebar-base-menu';\n\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {MessageService} from 'im.v2.provider.service';\n\nexport class FavoriteMenu extends SidebarMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getDeleteFromFavoriteItem(),\n\t\t];\n\t}\n\n\tgetDeleteFromFavoriteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_REMOVE_FROM_SAVED_V2'),\n\t\t\tonclick: function() {\n\t\t\t\tconst messageService = new MessageService({chatId: this.context.chatId});\n\t\t\t\tmessageService.removeMessageFromFavorite(this.context.messageId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import {Avatar, AvatarSize, ChatTitle} from 'im.v2.component.elements';\nimport type {ImModelSidebarFavoriteItem, ImModelMessage} from 'im.v2.model';\nimport {Parser} from 'im.v2.lib.parser';\nimport '../../css/info/favorite-item.css';\nimport {EventEmitter} from 'main.core.events';\nimport {EventType} from 'im.v2.const';\n\n// @vue/component\nexport const FavoriteItem = {\n\tname: 'FavoriteItem',\n\tcomponents: {Avatar, ChatTitle},\n\tprops:\n\t{\n\t\tfavorite: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tfavoriteItem(): ImModelSidebarFavoriteItem\n\t\t{\n\t\t\treturn this.favorite;\n\t\t},\n\t\tfavoriteMessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.favoriteItem.messageId);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.favoriteMessage.authorId.toString();\n\t\t},\n\t\tmessageText(): string\n\t\t{\n\t\t\treturn Parser.purifyMessage(this.favoriteMessage);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tid: this.favoriteItem.id,\n\t\t\t\tmessageId: this.favorite.messageId,\n\t\t\t\ttarget: event.currentTarget\n\t\t\t});\n\t\t},\n\t\tonItemClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\tmessageId: this.favorite.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonMessageBodyClick(event)\n\t\t{\n\t\t\tif (event.target.tagName === 'A')\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-favorite-item__container bx-im-favorite-item__scope\" \n\t\t\t@click.stop=\"onItemClick\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-favorite-item__header-container\">\n\t\t\t\t<div class=\"bx-im-favorite-item__author-container\">\n\t\t\t\t\t<Avatar\n\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t\t:dialogId=\"authorDialogId\"\n\t\t\t\t\t\tclass=\"bx-im-favorite-item__author-avatar\"\n\t\t\t\t\t/>\n\t\t\t\t\t<ChatTitle :dialogId=\"authorDialogId\" :showItsYou=\"false\" class=\"bx-im-favorite-item__author-text\" />\n\t\t\t\t</div>\n\t\t\t\t<button \n\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t@click.stop=\"onContextMenuClick\"\n\t\t\t\t></button>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-favorite-item__message-text\" v-html=\"messageText\" @click=\"onMessageBodyClick\"></div>\n\t\t</div>\n\t`\n};","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { FavoriteMenu } from '../../classes/context-menu/favorite/favorite-menu';\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { SidebarDetail } from '../detail';\nimport { FavoriteItem } from './favorite-item';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/info/favorite-detail.css';\n\nimport type { ImModelSidebarFavoriteItem } from 'im.v2.model';\n\n// @vue/component\nexport const FavoriteDetail = {\n\tname: 'FavoriteDetail',\n\tcomponents: { FavoriteItem, DateGroup, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfavorites(): ImModelSidebarFavoriteItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/favorites/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.favorites);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FavoriteMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tid: event.id,\n\t\t\t\tmessageId: event.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\tchatId: this.chatId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-favorite-detail__scope bx-im-sidebar-favorite-detail__container\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-favorite-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<FavoriteItem \n\t\t\t\t\tv-for=\"favorite in dateGroup.items\" \n\t\t\t\t\t:favorite=\"favorite\"\n\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FAVORITES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.favorite\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {DiskService} from 'im.v2.provider.service';\n\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\n\nexport class FileManager\n{\n\tstore: Store;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.diskService = new DiskService();\n\t}\n\n\tdelete(sidebarFile: ImModelSidebarFileItem)\n\t{\n\t\tthis.store.dispatch('sidebar/files/delete', {\n\t\t\tchatId: sidebarFile.chatId,\n\t\t\tid: sidebarFile.id\n\t\t});\n\n\t\tthis.diskService.delete({chatId: sidebarFile.chatId, fileId: sidebarFile.fileId});\n\t}\n\n\tsaveOnDisk(fileId: number): Promise\n\t{\n\t\treturn this.diskService.save(fileId);\n\t}\n}","import 'ui.viewer';\nimport 'ui.notification';\nimport {Loc, Dom} from 'main.core';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {Utils} from 'im.v2.lib.utils';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {FileManager} from './file-manager';\nimport type {ImModelFile, ImModelSidebarFileItem} from 'im.v2.model';\n\ntype MediaMenuContext = {\n\tsidebarFile: ImModelSidebarFileItem,\n\tfile: ImModelFile,\n\tmessageId: number,\n\tdialogId: string,\n}\n\nexport class FileMenu extends SidebarMenu\n{\n\tcontext: MediaMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.mediaManager = new FileManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveFileOnDiskItem(),\n\t\t\tthis.getDeleteFileItem(),\n\t\t];\n\t}\n\n\tgetViewFileItem(): ?MenuItem\n\t{\n\t\tconst viewerAttributes = Utils.file.getViewerDataAttributes(this.context.file.viewerAttrs);\n\t\tif (!viewerAttributes || this.context.file.type === 'audio')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getViewHtml(viewerAttributes),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetDownloadFileItem(): ?MenuItem\n\t{\n\t\tif (!this.context.file.urlDownload)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getDownloadHtml(this.context.file.urlDownload, this.context.file.name),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetSaveFileOnDiskItem(): ?MenuItem\n\t{\n\t\tif (!this.context.sidebarFile.fileId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_SAVE_FILE_ON_DISK'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.mediaManager.saveOnDisk(this.context.sidebarFile.fileId).then(() => {\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_SIDEBAR_FILE_SAVE_ON_DISK_SUCCESS')\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetDeleteFileItem(): MenuItem\n\t{\n\t\tif (this.getCurrentUserId() !== this.context.sidebarFile.authorId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_FILE'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.mediaManager.delete(this.context.sidebarFile);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetViewHtml(viewerAttributes: { [key: string]: string }): HTMLDivElement\n\t{\n\t\tconst div = Dom.create('div', {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_VIEW_FILE')\n\t\t});\n\n\t\tObject.entries(viewerAttributes).forEach(attribute => {\n\t\t\tconst [attributeName, attributeValue] = attribute;\n\t\t\tdiv.setAttribute(attributeName, attributeValue);\n\t\t});\n\n\t\treturn div;\n\t}\n\n\tgetDownloadHtml(urlDownload: string, fileName: string): HTMLAnchorElement\n\t{\n\t\tconst a = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DOWNLOAD_FILE')\n\t\t});\n\n\t\tDom.style(a, 'display', 'block');\n\t\tDom.style(a, 'color', 'inherit');\n\t\tDom.style(a, 'text-decoration', 'inherit');\n\n\t\ta.setAttribute('href', urlDownload);\n\t\ta.setAttribute('download', fileName);\n\n\t\treturn a;\n\t}\n}","import 'ui.viewer';\nimport { SocialVideo } from 'ui.vue3.components.socialvideo';\n\nimport { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Avatar, AvatarSize } from 'im.v2.component.elements';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport '../../../css/file/media-detail-item.css';\n\n// @vue/component\nexport const MediaDetailItem = {\n\tname: 'MediaDetailItem',\n\tcomponents: { SocialVideo, Avatar },\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t\tvideoDuration: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tpreviewPicture(): Object\n\t\t{\n\t\t\tif (!this.hasPreview)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.file.urlPreview}')`,\n\t\t\t};\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn this.file.urlPreview !== '';\n\t\t},\n\t\tisImage(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'image';\n\t\t},\n\t\tisVideo(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'video';\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tvideoDurationText(): string\n\t\t{\n\t\t\tif (this.videoDuration === 0)\n\t\t\t{\n\t\t\t\treturn '--:--';\n\t\t\t}\n\n\t\t\treturn this.formatTime(this.videoDuration);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tformatTime(rawSeconds: number): string\n\t\t{\n\t\t\trawSeconds = Math.floor(rawSeconds);\n\t\t\tconst durationHours = Math.floor(rawSeconds / 60 / 60);\n\t\t\tif (durationHours > 0)\n\t\t\t{\n\t\t\t\trawSeconds -= durationHours * 60 * 60;\n\t\t\t}\n\n\t\t\tconst durationMinutes = Math.floor(rawSeconds / 60);\n\t\t\tif (durationMinutes > 0)\n\t\t\t{\n\t\t\t\trawSeconds -= durationMinutes * 60;\n\t\t\t}\n\n\t\t\tconst hours = durationHours > 0 ? `${durationHours}:` : '';\n\t\t\tconst minutes = hours > 0 ? `${durationMinutes.toString().padStart(2, '0')}:` : `${durationMinutes}:`;\n\t\t\tconst seconds = rawSeconds.toString().padStart(2, '0');\n\n\t\t\treturn hours + minutes + seconds;\n\t\t},\n\t\thandleVideoEvent()\n\t\t{\n\t\t\tif (!this.$refs.video)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.videoDuration = this.$refs.video.duration;\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__container bx-im-sidebar-file-media-detail-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-file-media-detail-item__header-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-media-detail-item__avatar-container\">\n\t\t\t\t\t<Avatar :dialogId=\"sidebarFileItem.authorId\" :withStatus=\"false\" :size=\"AvatarSize.S\"></Avatar>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__context-menu bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t\t></button>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tv-if=\"isImage\"\n\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__content --image\" \n\t\t\t\t:style=\"previewPicture\"\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"isVideo\"\n\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__content --video\"\n\t\t\t\t:style=\"previewPicture\"\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t>\n\t\t\t\t<video \n\t\t\t\t\tv-show=\"!hasPreview\"\n\t\t\t\t\tref=\"video\"\n\t\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__video\" \n\t\t\t\t\tpreload=\"metadata\" :src=\"file.urlDownload\"\n\t\t\t\t\t@durationchange=\"handleVideoEvent\"\n\t\t\t\t\t@loadeddata=\"handleVideoEvent\"\n\t\t\t\t\t@loadedmetadata=\"handleVideoEvent\"\n\t\t\t\t></video>\n\t\t\t</div>\n\t\t\t<div v-if=\"isVideo\" class=\"bx-im-sidebar-file-media-detail-item__video-controls\">\n\t\t\t\t<span class=\"bx-im-sidebar-file-media-detail-item__video-controls-icon\"></span>\n\t\t\t\t<span class=\"bx-im-sidebar-file-media-detail-item__video-controls-time\">{{ videoDurationText }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { MediaDetailItem } from './item/media-detail-item';\n\nimport { SidebarDetail } from '../detail';\nimport '../../css/file/media-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const MediaDetail = {\n\tname: 'MediaDetail',\n\tcomponents: { DateGroup, MediaDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.media);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-media-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-media-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<div class=\"bx-im-sidebar-file-media-detail__items-group\">\n\t\t\t\t\t<MediaDetailItem\n\t\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.media\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Avatar, AvatarSize, AudioPlayer } from 'im.v2.component.elements';\n\nimport '../../../css/file/audio-detail-item.css';\n\n// @vue/component\nexport const AudioDetailItem = {\n\tname: 'AudioDetailItem',\n\tcomponents: { AudioPlayer, Avatar },\n\tprops: {\n\t\tid: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\ttimelineType: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\taudioUrl(): string\n\t\t{\n\t\t\treturn this.file.urlDownload;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.timelineType = Math.floor(Math.random() * 5);\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-file-audio-detail-item__container bx-im-sidebar-file-audio-detail-item__scope\">\n\t\t\t<AudioPlayer \n\t\t\t\t:id=\"id\"\n\t\t\t\t:src=\"audioUrl\" \n\t\t\t\t:file=\"file\" \n\t\t\t\t:timelineType=\"timelineType\" \n\t\t\t\t:authorId=\"sidebarFileItem.authorId\" \n\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { AudioDetailItem } from './item/audio-detail-item';\n\nimport '../../css/file/audio-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const AudioDetail = {\n\tname: 'AudioDetail',\n\tcomponents: { DetailEmptyState, AudioDetailItem, DateGroup, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.audio);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-audio-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-audio-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<AudioDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:id=\"file.id\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.audio\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import 'ui.icons';\nimport { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\n\nimport '../../../css/file/document-detail-item.css';\n\n// @vue/component\nexport const DocumentDetailItem = {\n\tname: 'DocumentDetailItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tfileIconClass(): string\n\t\t{\n\t\t\treturn `ui-icon ui-icon-file-${this.file.icon}`;\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 15;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t},\n\t\tauthorId(): number\n\t\t{\n\t\t\treturn this.sidebarFileItem.authorId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-document-detail-item__container bx-im-sidebar-file-document-detail-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\t\t\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__icon-container\">\n\t\t\t\t<div :class=\"fileIconClass\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__content-container\" v-bind=\"viewerAttributes\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__document-title\" @click=\"download\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-file-document-detail-item__document-title-text\">{{fileShortName}}</span>\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-file-document-detail-item__document-size\">{{fileSize}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__author-container\">\n\t\t\t\t\t\t<template v-if=\"authorId > 0\">\n\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t:dialogId=\"authorId\"\n\t\t\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t\t\t\tclass=\"bx-im-sidebar-file-document-detail-item__author-avatar\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ChatTitle :dialogId=\"authorId\" :showItsYou=\"false\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<span v-else class=\"bx-im-sidebar-file-document-detail-item__system-author-text\">\n\t\t\t\t\t\t\t{{$Bitrix.Loc.getMessage('IM_SIDEBAR_SYSTEM_USER')}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DocumentDetailItem } from './item/document-detail-item';\n\nimport '../../css/file/document-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const DocumentDetail = {\n\tname: 'DocumentDetail',\n\tcomponents: { DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.document);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-document-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-document-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.document\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { DateGroup } from '../date-group';\nimport { SidebarDetail } from '../detail';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DocumentDetailItem } from './item/document-detail-item';\n\nimport '../../css/file/other-detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const OtherDetail = {\n\tname: 'OtherDetail',\n\tcomponents: { DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.other);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-other-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-other-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.other\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import 'ui.icons';\nimport 'ui.viewer';\n\nimport { ImModelFile, ImModelSidebarFileItem } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { lazyload } from 'ui.vue3.directives.lazyload';\n\nimport '../../../css/file/file-preview-item.css';\n\n// @vue/component\nexport const FilePreviewItem = {\n\tname: 'FilePreviewItem',\n\tdirectives: { lazyload },\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tpreviewImageStyles(): Object\n\t\t{\n\t\t\tif (!this.hasPreview)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.file.urlPreview}')`,\n\t\t\t};\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn this.file.urlPreview !== '';\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 22;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisImage(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'image';\n\t\t},\n\t\tisVideo(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'video';\n\t\t},\n\t\tisAudio(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'audio';\n\t\t},\n\t\tfileIconClass(): string\n\t\t{\n\t\t\treturn `ui-icon ui-icon-file-${this.file.icon}`;\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-preview-item__container bx-im-sidebar-file-preview-item__scope\" \n\t\t\tv-bind=\"viewerAttributes\" \n\t\t\t@click=\"download\" \n\t\t\t:title=\"file.name\"\n\t\t>\n\t\t\t<img\n\t\t\t\tv-if=\"isImage\"\n\t\t\t\tv-lazyload\n\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t:data-lazyload-src=\"file.urlShow\"\n\t\t\t\t:title=\"file.name\"\n\t\t\t\t:alt=\"file.name\"\n\t\t\t\tclass=\"bx-im-sidebar-file-preview-item__preview-box\"\n\t\t\t/>\n\t\t\t<div \n\t\t\t\tv-else-if=\"isVideo\" \n\t\t\t\tclass=\"bx-im-sidebar-file-preview-item__preview-box bx-im-sidebar-file-preview-item__preview-video-box\"\n\t\t\t\t:style=\"previewImageStyles\"\n\t\t\t>\n\t\t\t\t<video v-if=\"!hasPreview\" class=\"bx-im-sidebar-file-preview-item__preview-video\" preload=\"metadata\" :src=\"file.urlDownload\"></video>\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-video-play-button\"></div>\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-video-play-icon\"></div>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"isAudio\" class=\"bx-im-sidebar-file-preview-item__preview-box\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-audio-play-button\"></div>\n\t\t\t</div>\n\t\t\t<div v-else class=\"bx-im-sidebar-file-preview-item__preview-box\">\n\t\t\t\t<div :class=\"fileIconClass\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-file-preview-item__text\">{{ fileShortName }}</div>\n\t\t</div>\n\t`,\n};\n","import {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {FilePreviewItem} from './item/file-preview-item';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport '../../css/file/preview.css';\n\nimport type {ImModelDialog, ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const FilePreview = {\n\tname: 'FilePreview',\n\tcomponents: {DetailEmptyState, FilePreviewItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\tif (this.isMigrationFinished)\n\t\t\t{\n\t\t\t\treturn this.$store.getters['sidebar/files/getLatest'](this.chatId);\n\t\t\t}\n\n\t\t\treturn this.$store.getters['sidebar/files/getLatestUnsorted'](this.chatId);\n\t\t},\n\t\thasFiles(): boolean\n\t\t{\n\t\t\treturn this.files.length > 0;\n\t\t},\n\t\tisMigrationFinished(): boolean\n\t\t{\n\t\t\treturn this.$store.state.sidebar.isFilesMigrated;\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.hasFiles)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst block = this.isMigrationFinished ? SidebarBlock.file : SidebarBlock.fileUnsorted;\n\t\t\tconst detailBlock = this.isMigrationFinished ? SidebarDetailBlock.media : SidebarDetailBlock.fileUnsorted;\n\n\t\t\tthis.$emit('openDetail', {block, detailBlock});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-file-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-file-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-file-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-file-preview__header_container\" \n\t\t\t\t\t:class=\"[hasFiles ? '--active': '']\" \n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bx-im-sidebar-file-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"hasFiles\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"hasFiles\" class=\"bx-im-sidebar-file-preview__files-container\">\n\t\t\t\t\t<FilePreviewItem v-for=\"file in files\" :fileItem=\"file\" />\n\t\t\t\t</div>\n\t\t\t\t<DetailEmptyState\n\t\t\t\t\tv-else\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_AND_FILES_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.media\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { SidebarDetailBlock, SidebarFileTypes } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DocumentDetailItem } from '../file/item/document-detail-item';\n\nimport '../../css/file-unsorted/detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const FileUnsortedDetail = {\n\tname: 'FileUnsortedDetail',\n\tcomponents: { DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.fileUnsorted);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-unsorted-detail__container bx-im-sidebar-file-unsorted-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-file-unsorted-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.document\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import '../../css/message-search/empty-state.css';\n\n// @vue/component\nexport const EmptyState = {\n\tname: 'EmptyState',\n\tcomputed:\n\t{\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MESSAGE_SEARCH_NOT_FOUND');\n\t\t},\n\t\tsubTitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MESSAGE_SEARCH_NOT_FOUND_DESCRIPTION');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-message-search-empty-state__container bx-im-message-search-empty-state__scope\">\n\t\t\t<div class=\"bx-im-message-search-empty-state__icon\"></div>\n\t\t\t<div class=\"bx-im-message-search-empty-state__title\">\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-search-empty-state__subtitle\">\n\t\t\t\t{{ subTitle }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { EventType } from 'im.v2.const';\nimport { Parser } from 'im.v2.lib.parser';\nimport { highlightText } from 'im.v2.lib.text-highlighter';\n\nimport '../../css/message-search/search-item.css';\n\nimport type { ImModelMessage } from 'im.v2.model';\n\n// @vue/component\nexport const SearchItem = {\n\tname: 'SearchItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops:\n\t{\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tquery: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.messageId);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.message.authorId.toString();\n\t\t},\n\t\tisSystem(): boolean\n\t\t{\n\t\t\treturn this.message.authorId === 0;\n\t\t},\n\t\tmessageText(): string\n\t\t{\n\t\t\tconst purifiedMessage = Parser.purifyMessage(this.message);\n\n\t\t\treturn highlightText(Text.encode(purifiedMessage), this.query);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonItemClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\tmessageId: this.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonMessageBodyClick(event)\n\t\t{\n\t\t\tif (event.target.tagName === 'A')\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-message-search-item__container bx-im-message-search-item__scope\" \n\t\t\t@click.stop=\"onItemClick\"\n\t\t>\n\t\t\t<div class=\"bx-im-message-search-item__header-container\">\n\t\t\t\t<div class=\"bx-im-message-search-item__author-container\">\n\t\t\t\t\t<template v-if=\"!isSystem\">\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t\t\t:dialogId=\"authorDialogId\"\n\t\t\t\t\t\t\tclass=\"bx-im-message-search-item__author-avatar\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ChatTitle \n\t\t\t\t\t\t\t:dialogId=\"authorDialogId\" \n\t\t\t\t\t\t\t:showItsYou=\"false\" \n\t\t\t\t\t\t\tclass=\"bx-im-message-search-item__author-text\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<span class=\"bx-im-message-search-item__system-author\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_SYSTEM_MESSAGE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-search-item__message-text\" v-html=\"messageText\" @click=\"onMessageBodyClick\"></div>\n\t\t</div>\n\t`,\n};\n","import { Runtime } from 'main.core';\n\nimport { SidebarDetailBlock } from 'im.v2.const';\nimport { Loader } from 'im.v2.component.elements';\nimport { Logger } from 'im.v2.lib.logger';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { EmptyState } from './empty-state';\nimport { DetailEmptyState as StartState } from '../detail-empty-state';\nimport { DateGroup } from '../date-group';\nimport { SearchItem } from './search-item';\n\nimport '../../css/message-search/detail.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const MessageSearchDetail = {\n\tname: 'MessageSearchDetail',\n\tcomponents: { DateGroup, EmptyState, SearchItem, Loader, StartState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tsearchQuery: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tsearchResult: [],\n\t\t\tcurrentServerQueries: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\tconst messages = this.searchResult.map((messageId) => {\n\t\t\t\treturn this.$store.getters['messages/getById'](messageId);\n\t\t\t}).filter((item) => Boolean(item));\n\n\t\t\treturn this.collectionFormatter.format(messages);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.preparedQuery.length > 0 && this.formattedCollection.length === 0;\n\t\t},\n\t\tpreparedQuery(): string\n\t\t{\n\t\t\treturn this.searchQuery.trim().toLowerCase();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tpreparedQuery(newQuery: string, previousQuery: string)\n\t\t{\n\t\t\tif (newQuery === previousQuery)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.service.resetSearchState();\n\t\t\tthis.searchResult = [];\n\t\t\tthis.startSearch(newQuery);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.searchOnServerDelayed = Runtime.debounce(this.searchOnServer, 500, this);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tsearchOnServer(query: string)\n\t\t{\n\t\t\tthis.currentServerQueries++;\n\n\t\t\tthis.service.searchOnServer(query).then((messageIds: string[]) => {\n\t\t\t\tif (query !== this.preparedQuery)\n\t\t\t\t{\n\t\t\t\t\tthis.isLoading = false;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.searchResult = this.mergeResult(messageIds);\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t}).finally(() => {\n\t\t\t\tthis.currentServerQueries--;\n\t\t\t\tthis.stopLoader();\n\t\t\t});\n\t\t},\n\t\tstartSearch(query: string)\n\t\t{\n\t\t\tif (query.length < 3)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (query.length >= 3)\n\t\t\t{\n\t\t\t\tthis.isLoading = true;\n\t\t\t\tthis.searchOnServerDelayed(query);\n\t\t\t}\n\n\t\t\tif (query.length === 0)\n\t\t\t{\n\t\t\t\tthis.cleanSearchResult();\n\t\t\t}\n\t\t},\n\t\tstopLoader()\n\t\t{\n\t\t\tif (this.currentServerQueries > 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tcleanSearchResult()\n\t\t{\n\t\t\tthis.searchResult = [];\n\t\t},\n\t\tneedToLoadNextPage(event)\n\t\t{\n\t\t\tconst target = event.target;\n\n\t\t\treturn target.scrollTop + target.clientHeight >= target.scrollHeight - target.clientHeight;\n\t\t},\n\t\tonScroll(event)\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.needToLoadNextPage(event) || !this.service.hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadNextPage().then((messageIds) => {\n\t\t\t\tthis.searchResult = this.mergeResult(messageIds);\n\t\t\t\tthis.isLoading = false;\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.warn('Message Search: loadNextPage error', error);\n\t\t\t});\n\t\t},\n\t\tmergeResult(messageIds: string[]): string[]\n\t\t{\n\t\t\treturn [...this.searchResult, ...messageIds].sort((a, z) => z - a);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-message-search-detail__container bx-im-message-search-detail__scope\" @scroll=\"onScroll\">\n\t\t\t<StartState \n\t\t\t\tv-if=\"!isLoading && preparedQuery.length === 0\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_SEARCH_MESSAGE_START_TITLE')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.messageSearch\"\n\t\t\t/>\n\t\t\t<EmptyState v-if=\"!isLoading && isEmptyState\"/>\n\t\t\t<Loader v-if=\"isLoading && isEmptyState\" class=\"bx-im-message-search-detail__loader\" />\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-message-search-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<SearchItem\n\t\t\t\t\tv-for=\"item in dateGroup.items\"\n\t\t\t\t\t:messageId=\"item.id\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:query=\"preparedQuery\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class TaskManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete({id, chatId})\n\t{\n\t\tthis.store.dispatch('sidebar/tasks/delete', {\n\t\t\tchatId: chatId,\n\t\t\tid: id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': id};\n\t\tthis.restClient.callMethod(RestMethod.imChatTaskDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting task', error);\n\t\t});\n\t}\n}","import 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {TaskManager} from './task-manager';\nimport type {ImModelSidebarTaskItem} from 'im.v2.model';\nimport {Loc} from 'main.core';\n\ntype TaskMenuContext = {\n\ttask: ImModelSidebarTaskItem,\n\tmessageId: number,\n\tdialogId: string,\n\tsource: string,\n}\n\nexport class TaskMenu extends SidebarMenu\n{\n\tcontext: TaskMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.taskManager = new TaskManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_TASK_LINK')),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetDeleteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_TASK_CONNECTION'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.taskManager.delete(this.context.task);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { ImModelSidebarTaskItem } from 'im.v2.model';\nimport { Avatar, AvatarSize } from 'im.v2.component.elements';\nimport { Type } from 'main.core';\nimport { LabelColor } from 'ui.label';\nimport '../../css/task/task-item.css';\nimport { Utils } from 'im.v2.lib.utils';\n\n// @vue/component\nexport const TaskItem = {\n\tname: 'TaskItem',\n\tcomponents: { Avatar, AvatarSize },\n\tprops: {\n\t\ttask: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\ttaskItem(): ImModelSidebarTaskItem\n\t\t{\n\t\t\treturn this.task;\n\t\t},\n\t\ttaskTitle(): string\n\t\t{\n\t\t\treturn this.taskItem.task.title;\n\t\t},\n\t\ttaskAuthorDialogId(): string\n\t\t{\n\t\t\treturn this.taskItem.task.creatorId.toString();\n\t\t},\n\t\ttaskResponsibleDialogId(): string\n\t\t{\n\t\t\treturn this.taskItem.task.responsibleId.toString();\n\t\t},\n\t\ttaskDeadlineText(): string\n\t\t{\n\t\t\tconst statusToShow = Type.isStringFilled(this.taskItem.task.state)\n\t\t\t\t? this.taskItem.task.state\n\t\t\t\t: this.taskItem.task.statusTitle\n\t\t\t;\n\n\t\t\treturn Utils.text.convertHtmlEntities(statusToShow);\n\t\t},\n\t\ttaskBackgroundColorClass(): string\n\t\t{\n\t\t\tif (this.taskItem.task.status === 5)\n\t\t\t{\n\t\t\t\treturn '--completed';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tstatusColorClass(): string\n\t\t{\n\t\t\tif (!this.taskItem.task.color || !LabelColor[this.taskItem.task.color.toUpperCase()])\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn `ui-label-${this.taskItem.task.color.toLowerCase()}`;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonTaskClick()\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.taskItem.task.source, { cacheable: false });\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\ttask: this.taskItem,\n\t\t\t\tsource: this.taskItem.task.source,\n\t\t\t\tmessageId: this.taskItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-task-item__container bx-im-sidebar-task-item__scope\" \n\t\t\t:class=\"taskBackgroundColorClass\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-task-item__content\" @click=\"onTaskClick\">\n\t\t\t\t<div class=\"bx-im-sidebar-task-item__header-text\" :title=\"taskTitle\">\n\t\t\t\t\t{{ taskTitle }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-task-item__detail-container\">\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XS\" :dialogId=\"taskAuthorDialogId\" />\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-item__forward-small-icon bx-im-sidebar__forward-small-icon\"></div>\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XS\" :dialogId=\"taskResponsibleDialogId\" />\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-item__status-text\" :class=\"statusColorClass\">\n\t\t\t\t\t\t{{taskDeadlineText}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button \n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { ImModelSidebarTaskItem, ImModelDialog } from 'im.v2.model';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\nimport { Button as MessengerButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { SidebarBlock, SidebarDetailBlock } from 'im.v2.const';\n\nimport { TaskMenu } from '../../classes/context-menu/task/task-menu';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { TaskItem } from './task-item';\n\nimport '../../css/task/preview.css';\n\n// @vue/component\nexport const TaskPreview = {\n\tname: 'TaskPreview',\n\tcomponents: { DetailEmptyState, TaskItem, MessengerButton },\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['openDetail'],\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tfirstTask(): ?ImModelSidebarTaskItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/tasks/get'](this.chatId)[0];\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new TaskMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tgetEntityCreator(): EntityCreator\n\t\t{\n\t\t\tif (!this.entityCreator)\n\t\t\t{\n\t\t\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t\t\t}\n\n\t\t\treturn this.entityCreator;\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.getEntityCreator().createTaskForChat();\n\t\t},\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstTask)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', { block: SidebarBlock.task, detailBlock: SidebarDetailBlock.task });\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-task-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-task-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-task-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-task-preview__header_container\"\n\t\t\t\t\t:class=\"[firstTask ? '--active': '']\"\n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-preview__title\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-task-preview__title-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_TASK_DETAIL_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div v-if=\"firstTask\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<transition name=\"add-button\">\n\t\t\t\t\t\t<MessengerButton\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-task-preview__title-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</transition>\n\t\t\t\t</div>\n\t\t\t\t<TaskItem v-if=\"firstTask\" :task=\"firstTask\" @contextMenuClick=\"onContextMenuClick\"/>\n\t\t\t\t<DetailEmptyState \n\t\t\t\t\tv-else \n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_TASKS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.task\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { TaskMenu } from '../../classes/context-menu/task/task-menu';\nimport { SidebarDetail } from '../detail';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { DateGroup } from '../date-group';\nimport { TaskItem } from './task-item';\n\nimport '../../css/task/detail.css';\n\nimport type { ImModelSidebarTaskItem } from 'im.v2.model';\n\n// @vue/component\nexport const TaskDetail = {\n\tname: 'TaskDetail',\n\tcomponents: { TaskItem, DateGroup, SidebarDetail, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\ttasks(): ImModelSidebarTaskItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/tasks/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.tasks);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new TaskMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-task-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-task-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<TaskItem\n\t\t\t\t\tv-for=\"task in dateGroup.items\"\n\t\t\t\t\t:task=\"task\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_TASKS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.task\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import 'ui.icons';\n\nimport { ImModelSidebarFileItem, ImModelFile } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\n\nimport '../../css/brief/brief-item.css';\n\n// @vue/component\nexport const BriefItem = {\n\tname: 'BriefItem',\n\tcomponents: { Avatar, ChatTitle },\n\tprops: {\n\t\tbrief: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.brief;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 15;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-brief-item__container bx-im-sidebar-brief-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-brief-item__icon-container\"></div>\n\t\t\t<div class=\"bx-im-sidebar-brief-item__content-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-brief-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-brief-item__title\" @click=\"download\" v-bind=\"viewerAttributes\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-brief-item__title-text\" :title=\"file.name\">{{fileShortName}}</span>\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-brief-item__size-text\">{{fileSize}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-brief-item__author-container\">\n\t\t\t\t\t\t<Avatar \n\t\t\t\t\t\t\t:dialogId=\"sidebarFileItem.authorId\" \n\t\t\t\t\t\t\t:size=\"AvatarSize.XS\" \n\t\t\t\t\t\t\t:withStatus=\"false\" \n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-brief-item__author-avatar\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ChatTitle :dialogId=\"sidebarFileItem.authorId\" :showItsYou=\"false\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon bx-im-sidebar-brief-item__context-menu-button\"\n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { SidebarFileTypes, SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { FileMenu } from '../../classes/context-menu/file/file-menu';\nimport { DateGroup } from '../date-group';\nimport { BriefItem } from './brief-item';\nimport { SidebarDetail } from '../detail';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/brief/detail.css';\n\nimport type { ImModelSidebarFileItem } from 'im.v2.model';\n\n// @vue/component\nexport const BriefDetail = {\n\tname: 'BriefDetail',\n\tcomponents: { DateGroup, BriefItem, SidebarDetail, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.brief);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format([...this.files, ...this.files, ...this.files, ...this.files, ...this.files, ...this.files, ...this.files]);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-brief-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-brief-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\"/>\n\t\t\t\t<BriefItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:brief=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEFS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.brief\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import {SidebarBlock, SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {BriefItem} from './brief-item';\nimport '../../css/brief/preview.css';\n\nimport type {ImModelDialog, ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const BriefPreview = {\n\tname: 'BriefPreview',\n\tcomponents: {DetailEmptyState, BriefItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddButton: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tfirstBrief(): ?ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.brief)[0];\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstBrief)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.brief, detailBlock: SidebarDetailBlock.brief});\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-brief-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-brief-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-brief-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-brief-preview__header_container\" \n\t\t\t\t\t:class=\"[firstBrief ? '--active': '']\" \n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bx-im-sidebar-brief-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEF_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"firstBrief\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<BriefItem \n\t\t\t\t\tv-if=\"firstBrief\" \n\t\t\t\t\t:brief=\"firstBrief\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t\t<DetailEmptyState \n\t\t\t\t\tv-else \n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEFS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.brief\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class MeetingManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete({id, chatId})\n\t{\n\t\tthis.store.dispatch('sidebar/meetings/delete', {\n\t\t\tchatId: chatId,\n\t\t\tid: id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': id};\n\t\tthis.restClient.callMethod(RestMethod.imChatCalendarDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting meeting', error);\n\t\t});\n\t}\n}","import 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {MeetingManager} from './meeting-manager';\nimport type {ImModelSidebarMeetingItem} from 'im.v2.model';\nimport {Loc} from 'main.core';\n\ntype MeetingMenuContext = {\n\tmeeting: ImModelSidebarMeetingItem,\n\tmessageId: number,\n\tdialogId: string,\n\tsource: string,\n}\n\nexport class MeetingMenu extends SidebarMenu\n{\n\tcontext: MeetingMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.meetingManager = new MeetingManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_MEETING_LINK')),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetDeleteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_MEETING_CONNECTION'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.meetingManager.delete(this.context.meeting);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { DateTimeFormat } from 'main.date';\n\nimport { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\nimport '../../css/meeting/meeting-item.css';\n\nimport type { ImModelSidebarMeetingItem } from 'im.v2.model';\n\n// @vue/component\nexport const MeetingItem = {\n\tname: 'MeetingItem',\n\tprops: {\n\t\tmeeting: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tmeetingItem(): ImModelSidebarMeetingItem\n\t\t{\n\t\t\treturn this.meeting;\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.meetingItem.meeting.title;\n\t\t},\n\t\tdate(): string\n\t\t{\n\t\t\tconst meetingDate = this.meetingItem.meeting.dateFrom;\n\n\t\t\treturn DateFormatter.formatByTemplate(meetingDate, DateTemplate.meeting);\n\t\t},\n\t\tday(): string\n\t\t{\n\t\t\treturn this.meetingItem.meeting.dateFrom.getDate().toString();\n\t\t},\n\t\tmonthShort(): string\n\t\t{\n\t\t\treturn DateTimeFormat.format('M', this.meetingItem.meeting.dateFrom);\n\t\t},\n\t\tisActive(): boolean\n\t\t{\n\t\t\treturn this.meetingItem.meeting.dateFrom.getTime() > Date.now();\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonMeetingClick()\n\t\t{\n\t\t\t// todo replace this call to something\n\t\t\tnew (window.top.BX || window.BX).Calendar.SliderLoader(this.meetingItem.meeting.id).show();\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tmeeting: this.meetingItem,\n\t\t\t\tsource: this.meetingItem.meeting.source,\n\t\t\t\tmessageId: this.meetingItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-meeting-item__container bx-im-sidebar-meeting-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-sidebar-meeting-item__icon-container\"\n\t\t\t\t:class=\"[isActive ? '--active' : '--inactive']\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__day-text\">{{ day }}</div>\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__month-text\">{{ monthShort }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-meeting-item__content-container\" @click=\"onMeetingClick\">\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__title\" :title=\"title\">{{ title }}</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__date\">{{ date }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button \n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import { ImModelSidebarMeetingItem, ImModelDialog } from 'im.v2.model';\nimport { Button as MessengerButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { SidebarBlock, SidebarDetailBlock } from 'im.v2.const';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\n\nimport { MeetingMenu } from '../../classes/context-menu/meeting/meeting-menu';\nimport { DetailEmptyState } from '../detail-empty-state';\nimport { MeetingItem } from './meeting-item';\n\nimport '../../css/meeting/preview.css';\n\n// @vue/component\nexport const MeetingPreview = {\n\tname: 'MeetingPreview',\n\tcomponents: { MeetingItem, DetailEmptyState, MessengerButton },\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tfirstMeeting(): ?ImModelSidebarMeetingItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/meetings/get'](this.chatId)[0];\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MeetingMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tgetEntityCreator(): EntityCreator\n\t\t{\n\t\t\tif (!this.entityCreator)\n\t\t\t{\n\t\t\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t\t\t}\n\n\t\t\treturn this.entityCreator;\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.getEntityCreator().createMeetingForChat();\n\t\t},\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstMeeting)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', { block: SidebarBlock.meeting, detailBlock: SidebarDetailBlock.meeting });\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-meeting-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-meeting-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-meeting-preview__container\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"bx-im-sidebar-meeting-preview__header_container\"\n\t\t\t\t\t:class=\"[firstMeeting ? '--active': '']\"\n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-preview__title\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-meeting-preview__title-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MEETING_DETAIL_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div v-if=\"firstMeeting\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<transition name=\"add-button\">\n\t\t\t\t\t\t<MessengerButton\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-meeting-preview__title-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</transition>\n\t\t\t\t</div>\n\t\t\t\t<MeetingItem v-if=\"firstMeeting\" :meeting=\"firstMeeting\" @contextMenuClick=\"onContextMenuClick\"/>\n\t\t\t\t<DetailEmptyState\n\t\t\t\t\tv-else\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEETINGS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.meeting\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SidebarDetailBlock } from 'im.v2.const';\n\nimport { SidebarCollectionFormatter } from '../../classes/sidebar-collection-formatter';\nimport { MeetingMenu } from '../../classes/context-menu/meeting/meeting-menu';\nimport { SidebarDetail } from '../detail';\nimport { DateGroup } from '../date-group';\nimport { MeetingItem } from './meeting-item';\nimport { DetailEmptyState } from '../detail-empty-state';\n\nimport '../../css/meeting/detail.css';\n\nimport type { ImModelSidebarTaskItem } from 'im.v2.model';\n\n// @vue/component\nexport const MeetingDetail = {\n\tname: 'MeetingDetail',\n\tcomponents: { MeetingItem, DateGroup, SidebarDetail, DetailEmptyState },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tmeetings(): ImModelSidebarTaskItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/meetings/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.meetings);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new MeetingMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-meeting-detail__scope\"\n\t\t>\n\t\t\t<div v-for=\"dateGroup in formattedCollection\" class=\"bx-im-sidebar-meeting-detail__date-group_container\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<MeetingItem\n\t\t\t\t\tv-for=\"meeting in dateGroup.items\"\n\t\t\t\t\t:meeting=\"meeting\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEETINGS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.meeting\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`,\n};\n","import '../../css/sign/preview.css';\n\n// @vue/component\nexport const SignPreview = {\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-sign-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-sign-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-sign-preview__container\" >\n\t\t\t\tSigned documents. Work in progress\n\t\t\t</div>\n\t\t</div>\n\t`\n};","// @vue/component\nexport const SignDetail = {\n\temits: ['back'],\n\tdata() {\n\t\treturn {};\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t<div @click=\"$emit('back')\" style=\"margin-bottom: 20px; cursor: pointer\">&lt;- Back</div>\n\t\t\t<div v-for=\"i in 50\">Sign {{ i }}</div>\n\t\t</div>\n\t`\n};","import '../../css/market/market-preview-item.css';\n\nimport type {ImModelMarketApplication} from 'im.v2.model';\n\n// @vue/component\nexport const MarketPreviewItem = {\n\tname: 'MarketPreviewItem',\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmarketItem(): ImModelMarketApplication\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn `fa ${this.marketItem.options.iconName}`;\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\treturn this.marketItem.options.color;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-market-preview-item__container bx-im-sidebar-market-preview-item__scope\">\n\t\t\t<div class=\"bx-im-sidebar-market-preview-item__icon-container\" :style=\"{backgroundColor: iconColor}\">\n\t\t\t\t<i :class=\"iconClass\" aria-hidden=\"true\"></i>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-market-preview-item__title-container\" :title=\"marketItem.title\">\n\t\t\t\t{{ marketItem.title }}\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {PlacementType, SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\n\nimport {MarketPreviewItem} from './market-preview-item';\n\nimport '../../css/market/market-preview.css';\n\nimport type {ImModelMarketApplication} from 'im.v2.model';\nimport {MarketManager} from 'im.v2.lib.market';\n\n// @vue/component\nexport const MarketPreview = {\n\tname: 'MarketPreview',\n\tcomponents: {MarketPreviewItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tcomputed:\n\t{\n\t\tmarketMenuItems(): ImModelMarketApplication[]\n\t\t{\n\t\t\treturn MarketManager.getInstance().getAvailablePlacementsByType(PlacementType.sidebar, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonMarketItemClick(entityId)\n\t\t{\n\t\t\tthis.$emit('openDetail', {\n\t\t\t\tblock: SidebarBlock.meeting,\n\t\t\t\tdetailBlock: SidebarDetailBlock.market,\n\t\t\t\tentityId: entityId,\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div v-if=\"!isLoading\" class=\"bx-im-sidebar-market-preview__scope bx-im-sidebar-market-preview__container\">\n\t\t\t<div class=\"bx-im-sidebar-market-preview__header_container\">\n\t\t\t\t<div class=\"bx-im-sidebar-market-preview__title\">\n\t\t\t\t\t<span class=\"bx-im-sidebar-market-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MARKET_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<MarketPreviewItem \n\t\t\t\tv-for=\"item in marketMenuItems\" \n\t\t\t\t:key=\"item.id\"\n\t\t\t\t:item=\"item\"\n\t\t\t\t@click=\"onMarketItemClick(item.id)\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import {Runtime} from 'main.core';\n\nimport {MarketManager} from 'im.v2.lib.market';\nimport {Spinner, SpinnerSize} from 'im.v2.component.elements';\n\nimport '../../css/market/detail.css';\n\n// @vue/component\nexport const MarketDetail = {\n\tname: 'MarketDetail',\n\tcomponents: {Spinner},\n\tprops: {\n\t\tdetailBlockEntityId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisLoading: true\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSpinnerSize: () => SpinnerSize\n\t},\n\tcreated()\n\t{\n\t\tthis.marketManager = MarketManager.getInstance();\n\t},\n\tmounted()\n\t{\n\t\tconst context = {dialogId: this.dialogId};\n\t\tthis.marketManager.loadPlacement(this.detailBlockEntityId, context).then(response => {\n\t\t\tthis.isLoading = false;\n\t\t\tRuntime.html(this.$refs['im-messenger-sidebar-placement'], response);\n\t\t});\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-market-detail__container\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-market-detail__loader-container\">\n\t\t\t\t<Spinner :size=\"SpinnerSize.S\" />\n\t\t\t</div>\n\t\t\t<div ref=\"im-messenger-sidebar-placement\"></div>\n\t\t</div>\n\t\t\n\t`\n};","import { Loc } from 'main.core';\nimport { RecentMenu } from 'im.v2.lib.menu';\nimport { Utils } from 'im.v2.lib.utils';\nimport { DialogType, ChatActionType } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { ImModelRecentItem } from 'im.v2.model';\n\nexport class MainMenu extends RecentMenu\n{\n\tpermissionManager: PermissionManager;\n\n\tstatic events = {\n\t\tonAddToChatShow: 'onAddToChatShow',\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: false,\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getUnreadMessageItem(),\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getCallItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getOpenUserCalendarItem(),\n\t\t\tthis.getAddMembersToChatItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetOpenUserCalendarItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['dialogues/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst user = this.store.getters['users/get'](this.context.dialogId, true);\n\t\tif (user.bot)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getCalendarLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_CALENDAR'),\n\t\t\tonclick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddMembersToChatItem(): MenuItem\n\t{\n\t\tconst canExtend = this.permissionManager.canPerformAction(ChatActionType.extend, this.context.dialogId);\n\t\tif (!canExtend)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_INVITE_MEMBERS'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit(MainMenu.events.onAddToChatShow);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetJoinChatItem(): ?MenuItem\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId);\n\t\tconst isUser = dialog.type === DialogType.user;\n\t\tif (isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t// todo: check if user is in chat already\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_JOIN_CHAT'),\n\t\t\tonclick: () => {\n\t\t\t\tconsole.warn('sidebar menu: join chat is not implemented');\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tcanShowFullMenu(dialogId: string): boolean\n\t{\n\t\tconst recentItem: ImModelRecentItem = this.store.getters['recent/get'](dialogId);\n\n\t\treturn Boolean(recentItem);\n\t}\n}\n","import {EventEmitter} from 'main.core.events';\nimport {EventType} from 'im.v2.const';\nimport {AddToChat} from 'im.v2.component.entity-selector';\nimport {MainMenu} from '../classes/context-menu/main/main-menu';\nimport '../css/header.css';\n\nimport type {ImModelRecentItem} from 'im.v2.model';\n\n// @vue/component\nexport const SidebarHeader = {\n\tname: 'SidebarHeader',\n\tcomponents: {AddToChat},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.$store.getters['recent/get'](this.dialogId, true);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MainMenu();\n\t\tthis.contextMenu.subscribe(MainMenu.events.onAddToChatShow, this.onAddChatShow);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.contextMenu.unsubscribe(MainMenu.events.onAddToChatShow, this.onAddChatShow);\n\t},\n\tmethods:\n\t{\n\t\tonAddChatShow()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\t...this.recentItem\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonSidebarCloseClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.sidebar.close);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-header__container bx-im-sidebar-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-header__title-container\">\n\t\t\t\t<button \n\t\t\t\t\tclass=\"bx-im-sidebar-header__cross-icon bx-im-messenger__cross-icon\" \n\t\t\t\t\t@click=\"onSidebarCloseClick\"\n\t\t\t\t></button>\n\t\t\t\t<div class=\"bx-im-sidebar-header__title\">{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_HEADER_TITLE') }}</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"bx-im-sidebar-header__context-menu-icon bx-im-messenger__context-menu-icon\"\n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t\tref=\"context-menu\"\n\t\t\t></button>\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['context-menu'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 0, offsetLeft: -420}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import { Button as ChatButton, ButtonSize, ButtonColor } from 'im.v2.component.elements';\nimport { SidebarDetailBlock, SidebarFileTabTypes, ChatActionType } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\nimport { AddToChat } from 'im.v2.component.entity-selector';\n\nimport '../css/detail-header.css';\n\nimport type { ImModelDialog } from 'im.v2.model';\n\n// @vue/component\nexport const DetailHeader = {\n\tname: 'DetailHeader',\n\tcomponents: { ChatButton, AddToChat },\n\tprops: {\n\t\tdetailBlock: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['back'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tneedAddButton(): boolean\n\t\t{\n\t\t\tconst detailsWithAddButton = [\n\t\t\t\tSidebarDetailBlock.main,\n\t\t\t\tSidebarDetailBlock.task,\n\t\t\t\tSidebarDetailBlock.meeting,\n\t\t\t];\n\n\t\t\tif (this.detailBlock === SidebarDetailBlock.main)\n\t\t\t{\n\t\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t\t}\n\n\t\t\treturn detailsWithAddButton.includes(this.detailBlock);\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\tif (this.detailBlock === SidebarDetailBlock.main)\n\t\t\t{\n\t\t\t\tlet usersInChatCount = this.dialog.userCounter;\n\t\t\t\tif (usersInChatCount >= 1000)\n\t\t\t\t{\n\t\t\t\t\tusersInChatCount = `${Math.floor(usersInChatCount / 1000)}k`;\n\t\t\t\t}\n\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MAIN_DETAIL_TITLE').replace('#NUMBER#', usersInChatCount);\n\t\t\t}\n\n\t\t\tif (Object.values(SidebarFileTabTypes).includes(this.detailBlock))\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_DETAIL_TITLE');\n\t\t\t}\n\n\t\t\tconst phrase = `IM_SIDEBAR_${this.detailBlock.toUpperCase()}_DETAIL_TITLE`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(phrase);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t},\n\tmethods:\n\t{\n\t\tonSearchClick()\n\t\t{\n\t\t\tconsole.warn('onSearchClick');\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tif (!this.needAddButton)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch (this.detailBlock)\n\t\t\t{\n\t\t\t\tcase SidebarDetailBlock.meeting:\n\t\t\t\t{\n\t\t\t\t\tthis.entityCreator.createMeetingForChat();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase SidebarDetailBlock.task:\n\t\t\t\t{\n\t\t\t\t\tthis.entityCreator.createTaskForChat();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase SidebarDetailBlock.main:\n\t\t\t\t{\n\t\t\t\t\tthis.showAddToChatPopup = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-header__container bx-im-sidebar-detail-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-detail-header__title-container\">\n\t\t\t\t<button class=\"bx-im-sidebar__back-icon\" @click=\"$emit('back')\"></button>\n\t\t\t\t<div class=\"bx-im-sidebar-detail-header__title-text\">{{ title }}</div>\n\t\t\t\t<div class=\"bx-im-sidebar-detail-header__add-button\" ref=\"add-members\">\n\t\t\t\t\t<ChatButton\n\t\t\t\t\t\tv-if=\"needAddButton\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n<!--\t\t\t<button-->\n<!--\t\t\t\tclass=\"bx-im-sidebar-detail-header__search-button bx-im-sidebar__search-icon\"-->\n<!--\t\t\t\t@click=\"onSearchClick\"-->\n<!--\t\t\t>-->\n<!--\t\t\t</button>-->\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 15, offsetLeft: -300}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import {Dom} from 'main.core';\n\nimport '../css/detail-tabs.css';\n\nconst ARROW_CONTROL_SIZE = 50;\n\n// @vue/component\nexport const DetailTabs = {\n\tname: 'DetailTabs',\n\tprops: {\n\t\ttabs: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => []\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\thasLeftControl: false,\n\t\t\thasRightControl: false,\n\t\t\tcurrentElementIndex: 0,\n\t\t\thighlightOffsetLeft: 0,\n\t\t\thighlightWidth: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\thighlightStyle()\n\t\t{\n\t\t\treturn {\n\t\t\t\tleft: `${this.highlightOffsetLeft}px`,\n\t\t\t\twidth: `${this.highlightWidth}px`\n\t\t\t};\n\t\t},\n\n\t},\n\twatch:\n\t{\n\t\tcurrentElementIndex(newIndex: number)\n\t\t{\n\t\t\tthis.updateHighlightPosition(newIndex);\n\t\t\tthis.$emit('tabSelect', this.tabs[newIndex]);\n\t\t\tthis.scrollToElement(newIndex);\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tif (this.$refs.tabs.scrollWidth > this.$refs.tabs.offsetWidth)\n\t\t{\n\t\t\tthis.hasRightControl = true;\n\t\t}\n\n\t\tthis.updateHighlightPosition(this.currentElementIndex);\n\t},\n\tmethods:\n\t{\n\t\tgetElementNodeByIndex(index: number): HTMLElement\n\t\t{\n\t\t\treturn [...this.$refs.tabs.children].filter(node => !Dom.hasClass(node, 'bx-sidebar-tabs-highlight'))[index];\n\t\t},\n\t\tupdateHighlightPosition(index: number)\n\t\t{\n\t\t\tconst element = this.getElementNodeByIndex(index);\n\t\t\tthis.highlightOffsetLeft = element.offsetLeft;\n\t\t\tthis.highlightWidth = element.offsetWidth;\n\t\t},\n\t\tscrollToElement(elementIndex: number)\n\t\t{\n\t\t\tconst element = this.getElementNodeByIndex(elementIndex);\n\t\t\tthis.$refs.tabs.scroll({left: element.offsetLeft - ARROW_CONTROL_SIZE, behavior: 'smooth'});\n\t\t},\n\t\tonTabClick(event)\n\t\t{\n\t\t\tthis.currentElementIndex = event.index;\n\t\t},\n\t\tgetTabTitle(tab: string): string\n\t\t{\n\t\t\tconst langPhraseCode = `IM_SIDEBAR_FILES_${tab.toUpperCase()}_TAB`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(langPhraseCode);\n\t\t},\n\t\tisSelectedTab(index: number): boolean\n\t\t{\n\t\t\treturn index === this.currentElementIndex;\n\t\t},\n\t\tonLeftClick()\n\t\t{\n\t\t\tif (this.currentElementIndex <= 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentElementIndex--;\n\t\t},\n\t\tonRightClick()\n\t\t{\n\t\t\tif (this.currentElementIndex >= this.tabs.length - 1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentElementIndex++;\n\t\t},\n\t\tupdateControlsVisibility()\n\t\t{\n\t\t\tthis.hasRightControl = this.$refs.tabs.scrollWidth > this.$refs.tabs.scrollLeft + this.$refs.tabs.clientWidth;\n\t\t\tthis.hasLeftControl = this.$refs.tabs.scrollLeft > 0;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-tabs__container bx-im-sidebar-detail-tabs__scope\">\n\t\t\t<div v-if=\"hasLeftControl\" @click.stop=\"onLeftClick\" class=\"bx-im-sidebar-ears__control --left\">\n\t\t\t\t<div class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t</div>\n\t\t\t<div v-if=\"hasRightControl\" @click.stop=\"onRightClick\" class=\"bx-im-sidebar-ears__control --right\">\n\t\t\t\t<div class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-ears__elements\" ref=\"tabs\" @scroll.passive=\"updateControlsVisibility\">\n\t\t\t\t<div class=\"bx-sidebar-tabs-highlight\" :style=\"highlightStyle\"></div>\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(tab, index) in tabs\"\n\t\t\t\t\t:key=\"tab\"\n\t\t\t\t\tclass=\"bx-im-sidebar-detail-tabs__item\"\n\t\t\t\t\t:class=\"[isSelectedTab(index) ? '--selected' : '']\"\n\t\t\t\t\t@click=\"onTabClick({index: index})\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-detail-tabs__item-title\">{{ getTabTitle(tab) }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { SearchInput } from 'im.v2.component.elements';\n\nimport '../../css/message-search/search-header.css';\n\n// @vue/component\nexport const SearchHeader = {\n\tname: 'SearchHeader',\n\tcomponents: { SearchInput },\n\temits: ['back', 'changeQuery'],\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-search-header__container bx-im-sidebar-search-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-search-header__title-container\">\n\t\t\t\t<button class=\"bx-im-sidebar__back-icon\" @click=\"$emit('back')\"></button>\n\t\t\t\t<SearchInput\n\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_SEARCH_MESSAGE_PLACEHOLDER')\"\n\t\t\t\t\t:withIcon=\"false\"\n\t\t\t\t\t:delayForFocusOnStart=\"300\"\n\t\t\t\t\t@queryChange=\"$emit('changeQuery', $event)\"\n\t\t\t\t\tclass=\"bx-im-sidebar-search-header__input\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Logger } from 'im.v2.lib.logger';\nimport { ImModelDialog } from 'im.v2.model';\nimport { SidebarDetailBlock, SidebarFileTabTypes } from 'im.v2.const';\nimport { SidebarService } from './classes/sidebar-service';\nimport { MainDetail } from './components/main/detail';\nimport { MainPreview } from './components/main/preview';\nimport { InfoPreview } from './components/info/preview';\nimport { LinkDetail } from './components/info/link-detail';\nimport { FavoriteDetail } from './components/info/favorite-detail';\nimport { MediaDetail } from './components/file/media-detail';\nimport { AudioDetail } from './components/file/audio-detail';\nimport { DocumentDetail } from './components/file/document-detail';\nimport { OtherDetail } from './components/file/other-detail';\nimport { FileUnsortedPreview } from './components/file-unsorted/preview';\nimport { FileUnsortedDetail } from './components/file-unsorted/detail';\nimport { FilePreview } from './components/file/preview';\nimport { MessageSearchDetail } from './components/message-search/detail';\nimport { TaskPreview } from './components/task/preview';\nimport { TaskDetail } from './components/task/detail';\nimport { BriefDetail } from './components/brief/detail';\nimport { BriefPreview } from './components/brief/preview';\nimport { MeetingPreview } from './components/meeting/preview';\nimport { MeetingDetail } from './components/meeting/detail';\nimport { SignPreview } from './components/sign/preview';\nimport { SignDetail } from './components/sign/detail';\nimport { MarketPreview } from './components/market/preview';\nimport { MarketDetail } from './components/market/detail';\nimport { SidebarHeader } from './components/header';\nimport { DetailHeader } from './components/detail-header';\nimport { DetailTabs } from './components/detail-tabs';\nimport { SearchHeader } from './components/message-search/search-header';\nimport { AvailabilityManager } from './classes/availability-manager';\nimport { SettingsManager } from './classes/settings-manager';\nimport './css/sidebar.css';\nimport './css/icons.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const ChatSidebar = {\n\tname: 'ChatSidebar',\n\tcomponents: {\n\t\tDetailHeader,\n\t\tDetailTabs,\n\t\tSidebarHeader,\n\t\tMainDetail,\n\t\tMainPreview,\n\t\tInfoPreview,\n\t\tLinkDetail,\n\t\tFavoriteDetail,\n\t\tMediaDetail,\n\t\tAudioDetail,\n\t\tDocumentDetail,\n\t\tOtherDetail,\n\t\tFilePreview,\n\t\tTaskPreview,\n\t\tTaskDetail,\n\t\tBriefDetail,\n\t\tBriefPreview,\n\t\tMeetingPreview,\n\t\tMeetingDetail,\n\t\tSignPreview,\n\t\tSignDetail,\n\t\tFileUnsortedDetail,\n\t\tFileUnsortedPreview,\n\t\tMarketPreview,\n\t\tMarketDetail,\n\t\tMessageSearchDetail,\n\t\tSearchHeader,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tsidebarDetailBlock: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['back'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tdetailBlock: null,\n\t\t\tdetailBlockEntityId: null,\n\t\t\tdetailTransition: 'right-panel-detail-transition',\n\t\t\tquery: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tblocks(): string[]\n\t\t{\n\t\t\treturn this.availabilityManager.getBlocks();\n\t\t},\n\t\thasInitialData(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/isInited'](this.chatId);\n\t\t},\n\t\tdetailComponent(): ?string\n\t\t{\n\t\t\tif (!this.detailBlock)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn `${this.detailBlock}Detail`;\n\t\t},\n\t\tgetBlockServiceInstance(): Object\n\t\t{\n\t\t\treturn this.sidebarService.getBlockInstance(this.detailBlock);\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tdialogInited(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited;\n\t\t},\n\t\ttabs(): string[]\n\t\t{\n\t\t\tif (SidebarFileTabTypes[this.detailBlock])\n\t\t\t{\n\t\t\t\treturn Object.values(SidebarFileTabTypes);\n\t\t\t}\n\n\t\t\treturn [];\n\t\t},\n\t\tneedShowDefaultDetailHeader(): boolean\n\t\t{\n\t\t\treturn this.detailBlock !== SidebarDetailBlock.messageSearch;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tsidebarDetailBlock(newValue: string)\n\t\t{\n\t\t\tthis.detailBlock = newValue;\n\t\t},\n\t\tdialogInited(newValue: boolean, oldValue: boolean)\n\t\t{\n\t\t\tif (newValue === true && oldValue === false)\n\t\t\t{\n\t\t\t\tthis.initializeSidebar();\n\t\t\t}\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('Sidebar: Chat Sidebar created');\n\t\tthis.settingsManager = new SettingsManager();\n\t\tthis.availabilityManager = new AvailabilityManager(this.settingsManager, this.dialogId);\n\t\tthis.sidebarService = new SidebarService(this.availabilityManager);\n\t\tthis.initializeSidebar();\n\t},\n\tmounted()\n\t{\n\t\tif (this.sidebarDetailBlock)\n\t\t{\n\t\t\tthis.detailBlock = this.sidebarDetailBlock;\n\t\t\tthis.detailTransition = '';\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tinitializeSidebar()\n\t\t{\n\t\t\tif (!this.dialogInited)\n\t\t\t{\n\t\t\t\tthis.isLoading = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sidebarService.setChatId(this.chatId);\n\t\t\tthis.sidebarService.setDialogId(this.dialogId);\n\n\t\t\tif (this.hasInitialData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.sidebarService.requestInitialData().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.warn('Sidebar: request initial data error:', error);\n\t\t\t});\n\t\t},\n\t\tonOpenDetail(data: Object)\n\t\t{\n\t\t\tconst { detailBlock, entityId = '' } = data;\n\t\t\tthis.detailBlock = detailBlock;\n\t\t\tthis.detailBlockEntityId = entityId.toString();\n\t\t},\n\t\tgetPreviewComponentName(block: string): string\n\t\t{\n\t\t\treturn `${block}Preview`;\n\t\t},\n\t\tonClickBack()\n\t\t{\n\t\t\tthis.detailBlock = null;\n\t\t\tthis.detailTransition = 'right-panel-detail-transition';\n\t\t\tthis.$emit('back');\n\t\t\tthis.query = '';\n\t\t},\n\t\tonTabSelect(tab: string)\n\t\t{\n\t\t\tthis.detailBlock = tab;\n\t\t},\n\t\tonChangeQuery(query)\n\t\t{\n\t\t\tthis.query = query;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarHeader :isLoading=\"isLoading\" :dialogId=\"dialogId\" :chatId=\"chatId\" />\n\t\t<div class=\"bx-im-sidebar__container bx-im-sidebar__scope\">\n\t\t\t<component\n\t\t\t\tv-for=\"block in blocks\"\n\t\t\t\t:key=\"block\"\n\t\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t\t\t:is=\"getPreviewComponentName(block)\"\n\t\t\t\t:isLoading=\"isLoading\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t@openDetail=\"onOpenDetail\"\n\t\t\t/>\n\t\t</div>\n\t\t<transition :name=\"detailTransition\">\n\t\t\t<div v-if=\"detailComponent && dialogInited\" class=\"bx-im-sidebar__detail_container bx-im-sidebar__scope\">\n\t\t\t\t<DetailHeader \n\t\t\t\t\tv-if=\"needShowDefaultDetailHeader\" \n\t\t\t\t\t:detailBlock=\"detailBlock\" \n\t\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t\t:chatId=\"chatId\" \n\t\t\t\t\t@back=\"onClickBack\" \n\t\t\t\t/>\n\t\t\t\t<SearchHeader v-else @changeQuery=\"onChangeQuery\" @back=\"onClickBack\" />\n\t\t\t\t<DetailTabs v-if=\"tabs.length > 0\" :tabs=\"tabs\" @tabSelect=\"onTabSelect\" />\n\t\t\t\t<component\n\t\t\t\t\t:is=\"detailComponent\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t:detailBlock=\"detailBlock\"\n\t\t\t\t\t:detailBlockEntityId=\"detailBlockEntityId\"\n\t\t\t\t\t:service=\"getBlockServiceInstance\"\n\t\t\t\t\t:searchQuery=\"query\"\n\t\t\t\t\t@back=\"onClickBack\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</transition> \n\t`,\n};\n"],"names":["NOT_IMPLEMENTED_ERROR","Base","constructor","chatId","dialogId","store","userManager","Core","getStore","restClient","getRestClient","UserManager","loadFirstPage","Error","loadNextPage","getInitialRequest","getResponseHandler","getCurrentUserId","getUserId","getLastElementId","collection","lastId","length","id","Type","isNumber","REQUEST_ITEMS_LIMIT","BaseFile","hasMoreItemsToLoad","RestMethod","imChatFileCollectionGet","chat_id","limit","response","Promise","reject","requestError","extractLoadFileError","fileResult","data","updateModels","fileGetResponse","error","handleResponse","list","resultData","users","files","addUsersPromise","setUsersToModel","setFilesPromise","dispatch","setSidebarFilesPromise","all","loadFirstPageBySubType","subType","filesCount","getFilesCountFromModel","resolve","queryParams","getQueryParams","requestPage","loadNextPageBySubType","callMethod","imChatFileGet","then","catch","console","getters","Media","SidebarFileTabTypes","media","Audio","audio","Document","document","Other","other","Favorite","imChatFavoriteCounterGet","imChatFavoriteGet","extractLoadCountersError","favoriteCounterGetResponse","setCounterResult","counter","setFavoriteResult","favoriteCounterGetResult","favoriteGetResult","favoritesCount","getFavoritesCountFromModel","LAST_ID","favoriteMessagesResult","rawMessages","map","favorite","message","storeMessagesPromise","setFavoritesPromise","favorites","Link","imChatUrlCounterGet","imChatUrlGet","linkCounterGetResponse","setLinksResult","linkCounterGetResult","linkGetResult","linksCount","getLinksCountFromModel","offset","OFFSET","setLinksPromise","links","Task","imChatTaskGet","extractLoadTaskError","taskGetResponse","tasksCount","getTasksCountFromModel","tasksResult","firstPageReceived","setTasksPromise","tasks","Main","imDialogUsersList","dialog_id","membersCount","getMembersCountFromModel","userIds","forEach","user","push","setMembersPromise","Brief","SidebarFileTypes","brief","Meeting","imChatCalendarGet","calendarGetResponse","meetingsCount","getMeetingsCountFromState","setMeetingsPromise","meetings","meetingsResult","FileUnsorted","imDiskFolderListGet","diskFolderListGetResult","SidebarDetailBlock","fileUnsorted","preparedFiles","file","MessageSearch","searchOnServer","query","resetSearchState","config","SEARCH_MESSAGE","CHAT_ID","imDialogMessagesSearch","responseData","messages","rawData","usersShort","reactions","additionalMessages","usersPromise","addUsersToModel","filesPromise","reactionsPromise","additionalMessagesPromise","messagesPromise","oldestMessage","SettingsManager","settings","Extension","getSettings","saveSettings","get","getBlocks","isLinksMigrationFinished","state","sidebar","isLinksMigrated","canShowBriefs","isFileMigrationFinished","isFilesMigrated","BLOCKS_ORDER","SidebarBlock","main","info","sign","task","meeting","AvailabilityManager","settingsManager","blocksFromSetting","availableBlocks","blocks","blocksSet","Set","delete","market","MarketManager","getInstance","getAvailablePlacementsByType","PlacementType","sort","block1","block2","BlockClasses","BlockToServices","Object","freeze","link","messageSearch","SidebarService","availabilityManager","blockServices","requestInitialData","isArrayFilled","buildBlocks","callBatch","getInitialRequestQuery","result","handleBatchRequestResult","getBlockInstance","blockName","find","block","type","toLowerCase","blockManager","setChatId","setDialogId","classNames","getServiceClassesForBlocks","className","initialRequest","responseHandler","services","blockList","service","Text","capitalize","assign","responseHandlersResult","setInited","DetailUser","name","components","Avatar","ChatTitle","props","String","required","isModerator","Boolean","default","showContextButton","computed","AvatarSize","position","$store","userLink","Utils","getProfileLink","methods","onClickContextMenu","event","$emit","userDialogId","target","currentTarget","template","SidebarDetail","Loader","Number","emits","isLoading","hasInitialData","created","needToLoadNextPage","scrollTop","clientHeight","scrollHeight","onScroll","SidebarMenu","BaseMenu","getMenuOptions","getMenuClassName","getOpenContextMessageItem","context","messageId","text","Loc","getMessage","onclick","EventEmitter","emit","EventType","dialog","goToMessageContext","menuInstance","close","getCopyLinkItem","title","BX","clipboard","isCopySupported","copy","source","UI","Notification","Center","notify","content","MembersMenu","chatService","ChatService","callManager","CallManager","permissionManager","PermissionManager","getMenuItems","getInsertNameItem","getSendMessageItem","getCallItem","getOpenProfileItem","getOpenUserCalendarItem","getKickItem","getLeaveItem","textarea","insertMention","mentionText","mentionReplacement","getMentionBbCode","Messenger","openChat","chatCanBeCalled","chatIsAllowedToCall","canPerformAction","ChatActionType","call","startCall","isUser","profileUri","href","bot","getCalendarLink","SidePanel","Instance","open","userIdToKick","parseInt","isSelfKick","canKick","canPerformKick","contextDialogId","userChoice","showKickUserConfirm","kickUserFromChat","canLeaveChat","leave","showLeaveFromChatConfirm","leaveChat","MainDetail","Button","ButtonSize","ButtonColor","dialogManagers","managerList","dialogIds","userId","toString","showCopyInviteButton","chatLink","getHost","contextMenu","beforeUnmount","destroy","includes","onContextMenuClick","item","contextChatId","openMenu","onCopyInviteClick","$Bitrix","Settings","directives","hint","Toggle","autoDeleteEnabled","ToggleSize","isGroupChat","startsWith","canBeMuted","mute","isChatMuted","isMuted","muteList","element","hintMuteNotAvailable","popupOptions","angle","targetContainer","body","offsetLeft","offsetTop","bindOptions","hintAutoDeleteNotAvailable","chatTypeClass","getChatService","muteActionHandler","unmuteChat","muteChat","PersonalChatPreview","MessengerButton","AddToChat","showAddToChatPopup","userPosition","canInviteMembers","extend","onAddClick","GroupChatPreview","PREVIEW_USERS_COUNT","slice","usersInChatCount","userCounter","moreUsersCount","Math","max","canSeeMembers","userList","onOpenUsers","onOpenInvitePopup","MainPreview","inheritAttrs","onOpenDetail","detailBlock","MAX_DESCRIPTION_SYMBOLS","InfoPreview","expanded","DialogType","previewDescription","description","chatTypeText","descriptionToShow","rawText","Parser","purifyText","showExpandButton","favoriteCounter","getCounterString","urlCounter","isLinksAvailable","hintDirectiveContent","MAX_COUNTER","onFavouriteClick","onLinkClick","SidebarCollectionFormatter","cachedDateGroups","format","dateGroups","dateGroup","getDateGroup","date","dateGroupTitle","items","values","INDEX_BETWEEN_DATE_AND_TIME","shortDate","toJSON","DateFormatter","formatByTemplate","DateTemplate","LinkManager","imChatUrlDelete","LinkMenu","linkManager","getDeleteLinkItem","bind","LinkItem","linkItem","shortDescription","hostName","URL","hostname","richData","convertHtmlEntities","authorDialogId","authorId","hasPreview","previewUrl","previewStyles","backgroundImage","backgroundSize","backgroundRepeat","iconTypeClass","DateGroup","dateText","DetailEmptyState","iconType","iconClass","toKebabCase","LinkDetail","formattedCollection","collectionFormatter","isEmptyState","FavoriteMenu","getDeleteFromFavoriteItem","messageService","MessageService","removeMessageFromFavorite","FavoriteItem","favoriteItem","favoriteMessage","messageText","purifyMessage","onItemClick","onMessageBodyClick","tagName","stopPropagation","FavoriteDetail","FileManager","diskService","DiskService","sidebarFile","fileId","saveOnDisk","save","FileMenu","mediaManager","getDownloadFileItem","getSaveFileOnDiskItem","getDeleteFileItem","getViewFileItem","viewerAttributes","getViewerDataAttributes","viewerAttrs","html","getViewHtml","urlDownload","getDownloadHtml","div","Dom","create","entries","attribute","attributeName","attributeValue","setAttribute","fileName","a","style","MediaDetailItem","SocialVideo","fileItem","videoDuration","sidebarFileItem","previewPicture","urlPreview","isImage","isVideo","videoDurationText","formatTime","rawSeconds","floor","durationHours","durationMinutes","hours","minutes","padStart","seconds","handleVideoEvent","$refs","video","duration","MediaDetail","AudioDetailItem","AudioPlayer","timelineType","audioUrl","random","AudioDetail","DocumentDetailItem","fileIconClass","icon","fileShortName","NAME_MAX_LENGTH","getShortFileName","fileSize","formatFileSize","size","isViewerAvailable","keys","download","urlToOpen","urlShow","window","DocumentDetail","OtherDetail","FilePreviewItem","lazyload","previewImageStyles","isAudio","FilePreview","isMigrationFinished","hasFiles","FileUnsortedDetail","EmptyState","subTitle","SearchItem","isSystem","purifiedMessage","highlightText","encode","MessageSearchDetail","StartState","searchQuery","searchResult","currentServerQueries","filter","preparedQuery","trim","watch","newQuery","previousQuery","startSearch","searchOnServerDelayed","Runtime","debounce","messageIds","mergeResult","finally","stopLoader","cleanSearchResult","Logger","warn","z","TaskManager","imChatTaskDelete","TaskMenu","taskManager","getDeleteItem","TaskItem","taskItem","taskTitle","taskAuthorDialogId","creatorId","taskResponsibleDialogId","responsibleId","taskDeadlineText","statusToShow","isStringFilled","statusTitle","taskBackgroundColorClass","status","statusColorClass","color","LabelColor","toUpperCase","onTaskClick","cacheable","TaskPreview","firstTask","getEntityCreator","entityCreator","EntityCreator","createTaskForChat","TaskDetail","BriefItem","BriefDetail","BriefPreview","showAddButton","firstBrief","MeetingManager","imChatCalendarDelete","MeetingMenu","meetingManager","MeetingItem","meetingItem","meetingDate","dateFrom","day","getDate","monthShort","DateTimeFormat","isActive","getTime","Date","now","onMeetingClick","top","Calendar","SliderLoader","show","MeetingPreview","firstMeeting","createMeetingForChat","MeetingDetail","SignPreview","SignDetail","MarketPreviewItem","marketItem","options","iconName","iconColor","MarketPreview","marketMenuItems","onMarketItemClick","entityId","MarketDetail","Spinner","detailBlockEntityId","SpinnerSize","marketManager","mounted","loadPlacement","MainMenu","RecentMenu","getUnreadMessageItem","getPinMessageItem","getAddMembersToChatItem","getHideItem","canExtend","events","onAddToChatShow","getJoinChatItem","canShowFullMenu","recentItem","SidebarHeader","subscribe","onAddChatShow","unsubscribe","onSidebarCloseClick","DetailHeader","ChatButton","needAddButton","detailsWithAddButton","replace","phrase","onSearchClick","ARROW_CONTROL_SIZE","DetailTabs","tabs","Array","hasLeftControl","hasRightControl","currentElementIndex","highlightOffsetLeft","highlightWidth","highlightStyle","left","width","newIndex","updateHighlightPosition","scrollToElement","scrollWidth","offsetWidth","getElementNodeByIndex","index","children","node","hasClass","elementIndex","scroll","behavior","onTabClick","getTabTitle","tab","langPhraseCode","isSelectedTab","onLeftClick","onRightClick","updateControlsVisibility","scrollLeft","clientWidth","SearchHeader","SearchInput","ChatSidebar","FileUnsortedPreview","sidebarDetailBlock","detailTransition","detailComponent","getBlockServiceInstance","sidebarService","dialogInited","inited","needShowDefaultDetailHeader","newValue","oldValue","initializeSidebar","getPreviewComponentName","onClickBack","onTabSelect","onChangeQuery"],"mappings":"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"}