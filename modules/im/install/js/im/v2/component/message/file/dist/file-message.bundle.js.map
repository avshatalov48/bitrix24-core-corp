{"version":3,"file":"file-message.bundle.js","sources":["../src/components/items/progress-bar.js","../src/components/items/image.js","../src/components/image-message.js","../src/classes/base-file-context-menu.js","../src/components/items/base-file.js","../src/components/base-file-message.js","../src/components/items/video.js","../src/components/video-message.js","../src/components/items/audio.js","../src/components/audio-message.js","../src/file-message.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\n\nimport { EventType } from 'im.v2.const';\nimport { ProgressBarManager } from 'im.v2.lib.progressbar';\n\nimport '../../css/items/progress-bar.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const ProgressBar = {\n\tname: 'ProgressBar',\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\t'file.status': function()\n\t\t{\n\t\t\tthis.getProgressBarManager().update();\n\t\t},\n\t\t'file.progress': function()\n\t\t{\n\t\t\tthis.getProgressBarManager().update();\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.initProgressBar();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.removeProgressBar();\n\t},\n\tmethods:\n\t{\n\t\tinitProgressBar()\n\t\t{\n\t\t\tif (this.file.progress === 100)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet blurElement;\n\t\t\tif (this.file.progress < 0 || (!this.isImage && !this.isVideo))\n\t\t\t{\n\t\t\t\tblurElement = false;\n\t\t\t}\n\n\t\t\tthis.progressBarManager = new ProgressBarManager({\n\t\t\t\tcontainer: this.$refs['progress-bar'],\n\t\t\t\tuploadState: this.file,\n\t\t\t\tcustomConfig: { blurElement, hasTitle: false },\n\t\t\t});\n\n\t\t\tthis.progressBarManager.subscribe(ProgressBarManager.event.cancel, () => {\n\t\t\t\tconsole.warn('test');\n\t\t\t\tEventEmitter.emit(EventType.uploader.cancel, {\n\t\t\t\t\ttempFileId: this.file.id,\n\t\t\t\t\ttempMessageId: this.messageId,\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.progressBarManager.subscribe(ProgressBarManager.event.destroy, () => {\n\t\t\t\tif (this.progressBar)\n\t\t\t\t{\n\t\t\t\t\tthis.progressBar = null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.progressBarManager.start();\n\t\t},\n\t\tremoveProgressBar()\n\t\t{\n\t\t\tif (!this.getProgressBarManager())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.getProgressBarManager().destroy();\n\t\t},\n\t\tgetProgressBarManager(): ProgressBarManager\n\t\t{\n\t\t\treturn this.progressBarManager;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-progress-bar__container\" ref=\"progress-bar\"></div>\n\t`,\n};\n","import { Utils } from 'im.v2.lib.utils';\nimport type { ImModelFile } from 'im.v2.model';\nimport { lazyload } from 'ui.vue3.directives.lazyload';\n\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/image.css';\n\nconst MAX_WIDTH = 420;\nconst MAX_HEIGHT = 340;\nconst MIN_WIDTH = 200;\nconst MIN_HEIGHT = 100;\n\n// @vue/component\nexport const ImageItem = {\n\tname: 'ImageItem',\n\tdirectives: { lazyload },\n\tcomponents: { ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\timageSize(): {width: string, height: string, backgroundSize: string}\n\t\t{\n\t\t\tlet newWidth = this.file.image.width;\n\t\t\tlet newHeight = this.file.image.height;\n\n\t\t\tif (this.file.image.width > MAX_WIDTH || this.file.image.height > MAX_HEIGHT)\n\t\t\t{\n\t\t\t\tconst aspectRatio = this.file.image.width / this.file.image.height;\n\n\t\t\t\tif (this.file.image.width > MAX_WIDTH)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = MAX_WIDTH;\n\t\t\t\t\tnewHeight = Math.round(MAX_WIDTH / aspectRatio);\n\t\t\t\t}\n\n\t\t\t\tif (newHeight > MAX_HEIGHT)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = Math.round(MAX_HEIGHT * aspectRatio);\n\t\t\t\t\tnewHeight = MAX_HEIGHT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sizes = {\n\t\t\t\twidth: Math.max(newWidth, MIN_WIDTH),\n\t\t\t\theight: Math.max(newHeight, MIN_HEIGHT),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\twidth: `${sizes.width}px`,\n\t\t\t\theight: `${sizes.height}px`,\n\t\t\t\t'object-fit': (sizes.width < 100 || sizes.height < 100) ? 'cover' : 'contain',\n\t\t\t};\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\timageTitle(): string\n\t\t{\n\t\t\tconst size = Utils.file.formatFileSize(this.file.size);\n\n\t\t\treturn this.loc(\n\t\t\t\t'IM_ELEMENTS_MEDIA_IMAGE_TITLE',\n\t\t\t\t{\n\t\t\t\t\t'#NAME#': this.file.name,\n\t\t\t\t\t'#SIZE#': size,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tv-bind=\"viewerAttributes\" \n\t\t\tclass=\"bx-im-media-image__container\" \n\t\t\t@click=\"download\"\n\t\t\t:style=\"imageSize\"\n\t\t>\n\t\t\t<img\n\t\t\t\tv-lazyload\n\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t:data-lazyload-src=\"file.urlShow\"\n\t\t\t\t:title=\"imageTitle\"\n\t\t\t\t:alt=\"file.name\"\n\t\t\t\tclass=\"bx-im-media-image__source\"\n\t\t\t/>\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageId\" />\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { MessageStatus, ReactionList, DefaultMessageContent, ReactionSelector, ContextMenu } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { ImageItem } from './items/image';\n\nimport '../css/image-messsage.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const ImageMessage = {\n\tname: 'ImageMessage',\n\tcomponents: {\n\t\tReactionList,\n\t\tBaseMessage,\n\t\tMessageStatus,\n\t\tDefaultMessageContent,\n\t\tImageItem,\n\t\tReactionSelector,\n\t\tContextMenu,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tonlyImage(): boolean\n\t\t{\n\t\t\treturn this.message.text.length === 0 && this.message.attach.length === 0;\n\t\t},\n\t\tonlyImageOrVideo(): boolean\n\t\t{\n\t\t\treturn this.messageFile.type === FileType.image || this.messageFile.type === FileType.video;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tneedBackground(): boolean\n\t\t{\n\t\t\tif (this.message.text.length > 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn !this.onlyImageOrVideo;\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage \n\t\t\t:item=\"item\" \n\t\t\t:dialogId=\"dialogId\" \n\t\t\t:withBackground=\"needBackground\" \n\t\t\t:withDefaultContextMenu=\"!onlyImage\"\n\t\t>\n\t\t\t<div class=\"bx-im-message-image__container\">\n\t\t\t\t<div class=\"bx-im-message-image__content-with-menu\">\n\t\t\t\t\t<div class=\"bx-im-message-image__content\">\n\t\t\t\t\t\t<ImageItem\n\t\t\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<template v-if=\"onlyImage\">\n\t\t\t\t\t\t\t<div class=\"bx-im-message-image__message-status-container\">\n\t\t\t\t\t\t\t\t<MessageStatus :item=\"message\" :isOverlay=\"onlyImage\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<ReactionSelector :messageId=\"message.id\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ContextMenu v-if=\"onlyImage\" :message=\"message\" :menuIsActiveForId=\"menuIsActiveForId\" />\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"onlyImage\" class=\"bx-im-message-image__reaction-list-container\">\n\t\t\t\t\t<ReactionList :messageId=\"message.id\" />\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"!onlyImage\" class=\"bx-im-message-image__default-message-container\">\n\t\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t\t<ReactionSelector :messageId=\"message.id\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</BaseMessage>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nimport { DiskService } from 'im.v2.provider.service';\nimport { BaseMenu } from 'im.v2.lib.menu';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PopupType } from 'im.v2.const';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { ImModelFile } from 'im.v2.model';\n\nexport class BaseFileContextMenu extends BaseMenu\n{\n\tid: String = PopupType.messageBaseFileMenu;\n\tdiskService: DiskService;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-message-file-context-menu';\n\t\tthis.diskService = new DiskService();\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\treturn [\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveToDisk(),\n\t\t];\n\t}\n\n\tgetDownloadFileItem(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: Utils.file.createDownloadLink(\n\t\t\t\tLoc.getMessage('IM_MESSAGE_FILE_MENU_DOWNLOAD_FILE'),\n\t\t\t\tfile.urlDownload,\n\t\t\t\tfile.name,\n\t\t\t),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\tgetSaveToDisk(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_MESSAGE_FILE_MENU_SAVE_ON_DISK'),\n\t\t\tonclick: function() {\n\t\t\t\tvoid this.diskService.save(file.id).then(() => {\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_MESSAGE_FILE_MENU_SAVE_ON_DISK_SUCCESS'),\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\t#getMessageFile(): ?ImModelFile\n\t{\n\t\tif (this.context.files.length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t// for now, we have only one file in one message. In the future we need to change this logic.\n\t\treturn this.store.getters['files/get'](this.context.files[0]);\n\t}\n}\n","import 'ui.icons.disk';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { ProgressBar } from './progress-bar';\nimport { BaseFileContextMenu } from '../../classes/base-file-context-menu';\n\nimport '../../css/items/base-file.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileItem = {\n\tname: 'BaseFileItem',\n\tcomponents: { ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 40;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tconst iconType = Utils.file.getIconTypeByFilename(this.file.name);\n\n\t\t\treturn `ui-icon-file-${iconType}`;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\topenContextMenu(event: PointerEvent)\n\t\t{\n\t\t\tthis.$emit('openContextMenu', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-base-file-item__container bx-im-base-file-item__scope\">\n\t\t\t<div class=\"bx-im-base-file-item__icon-container\" ref=\"loader-icon\" v-bind=\"viewerAttributes\" @click=\"download\">\n\t\t\t\t<div v-if=\"isLoaded\" :class=\"iconClass\" class=\"bx-im-base-file-item__type-icon ui-icon\"><i></i></div>\n\t\t\t\t<ProgressBar v-else :item=\"file\" :messageId=\"messageId\" />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-base-file-item__content\" v-bind=\"viewerAttributes\" @click=\"download\">\n\t\t\t\t<span :title=\"file.name\" class=\"bx-im-base-file-item__title\">\n\t\t\t\t\t{{ fileShortName }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"bx-im-base-file-item__size\">{{ fileSize }}</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-base-file-item__download-icon\"\n\t\t\t\t:class=\"{'--not-active': !isLoaded}\"\n\t\t\t\t@click=\"openContextMenu\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { DefaultMessageContent, ReactionSelector, AuthorTitle } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { BaseFileContextMenu } from '../classes/base-file-context-menu';\nimport { BaseFileItem } from './items/base-file';\n\nimport '../css/base-file-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileMessage = {\n\tname: 'BaseFileMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tDefaultMessageContent,\n\t\tBaseFileItem,\n\t\tReactionSelector,\n\t\tAuthorTitle,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenContextMenu(event: PointerEvent)\n\t\t{\n\t\t\tconst context = { dialogId: this.dialogId, ...this.message };\n\t\t\tthis.contextMenu.openMenu(context, event.target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-base-file__container\">\n\t\t\t\t<AuthorTitle v-if=\"withTitle\" :item=\"item\" class=\"bx-im-message-base-file__author-title\" />\n\t\t\t\t<BaseFileItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t@openContextMenu=\"onOpenContextMenu\"\n\t\t\t\t/>\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t<ReactionSelector :messageId=\"message.id\" />\n\t\t\t</div>\n\t\t</BaseMessage>\n\t`,\n};\n","import { SocialVideo } from 'ui.vue3.components.socialvideo';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/video.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\nconst VIDEO_SIZE_TO_AUTOPLAY = 5_000_000;\nconst MAX_WIDTH = 420;\nconst MAX_HEIGHT = 340;\nconst MIN_WIDTH = 200;\nconst MIN_HEIGHT = 100;\nconst DEFAULT_WIDTH = 320;\nconst DEFAULT_HEIGHT = 180;\n\n// @vue/component\nexport const VideoItem = {\n\tname: 'VideoItem',\n\tcomponents: { SocialVideo, ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tautoplay(): boolean\n\t\t{\n\t\t\treturn this.file.size < VIDEO_SIZE_TO_AUTOPLAY;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\timageSize(): {width: string, height: string, backgroundSize: string}\n\t\t{\n\t\t\tlet newWidth = this.file.image.width;\n\t\t\tlet newHeight = this.file.image.height;\n\n\t\t\tif (!newHeight || !newWidth)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\twidth: `${DEFAULT_WIDTH}px`,\n\t\t\t\t\theight: `${DEFAULT_HEIGHT}px`,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.file.image.width > MAX_WIDTH || this.file.image.height > MAX_HEIGHT)\n\t\t\t{\n\t\t\t\tconst aspectRatio = this.file.image.width / this.file.image.height;\n\n\t\t\t\tif (this.file.image.width > MAX_WIDTH)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = MAX_WIDTH;\n\t\t\t\t\tnewHeight = Math.round(MAX_WIDTH / aspectRatio);\n\t\t\t\t}\n\n\t\t\t\tif (newHeight > MAX_HEIGHT)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = Math.round(MAX_HEIGHT * aspectRatio);\n\t\t\t\t\tnewHeight = MAX_HEIGHT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sizes = {\n\t\t\t\twidth: Math.max(newWidth, MIN_WIDTH),\n\t\t\t\theight: Math.max(newHeight, MIN_HEIGHT),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\twidth: `${sizes.width}px`,\n\t\t\t\theight: `${sizes.height}px`,\n\t\t\t\t'object-fit': (sizes.width < 100 || sizes.height < 100) ? 'cover' : 'contain',\n\t\t\t};\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tgetPlayCallback()\n\t\t{\n\t\t\tif (this.autoplay)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn () => {};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div @click=\"download\" class=\"bx-im-video-item__container bx-im-video-item__scope\">\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageId\" />\n\t\t\t<SocialVideo\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t\t:id=\"file.id\"\n\t\t\t\t:src=\"file.urlShow\"\n\t\t\t\t:preview=\"file.urlPreview\"\n\t\t\t\t:elementStyle=\"imageSize\"\n\t\t\t\t:autoplay=\"autoplay\"\n\t\t\t\t:showControls=\"isLoaded\"\n\t\t\t\t:playCallback=\"getPlayCallback()\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport {\n\tMessageStatus,\n\tReactionList,\n\tDefaultMessageContent,\n\tReactionSelector,\n\tContextMenu,\n} from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { VideoItem } from './items/video';\n\nimport '../css/video-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const VideoMessage = {\n\tname: 'VideoMessage',\n\tcomponents: {\n\t\tReactionList,\n\t\tBaseMessage,\n\t\tMessageStatus,\n\t\tDefaultMessageContent,\n\t\tVideoItem,\n\t\tReactionSelector,\n\t\tContextMenu,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tonlyVideo(): boolean\n\t\t{\n\t\t\treturn this.message.text.length === 0 && this.message.attach.length === 0;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage \n\t\t\t:item=\"item\" \n\t\t\t:dialogId=\"dialogId\" \n\t\t\t:withBackground=\"!onlyVideo\"\n\t\t\t:withDefaultContextMenu=\"!onlyVideo\"\n\t\t>\n\t\t\t<div class=\"bx-im-message-video__container bx-im-message-video__scope\">\n\t\t\t\t<div class=\"bx-im-message-video__content-with-menu\">\n\t\t\t\t\t<div class=\"bx-im-message-video__content\">\n\t\t\t\t\t\t<VideoItem\n\t\t\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<template v-if=\"onlyVideo\">\n\t\t\t\t\t\t\t<div class=\"bx-im-message-video__message-status-container\">\n\t\t\t\t\t\t\t\t<MessageStatus :item=\"message\" :isOverlay=\"onlyVideo\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<ReactionSelector :messageId=\"message.id\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ContextMenu v-if=\"onlyVideo\" :message=\"message\" :menuIsActiveForId=\"menuIsActiveForId\" />\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"onlyVideo\" class=\"bx-im-message-video__reaction-list-container\">\n\t\t\t\t\t<ReactionList :messageId=\"message.id\" />\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"!onlyVideo\" class=\"bx-im-message-video__default-message-container\">\n\t\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t\t<ReactionSelector :messageId=\"message.id\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</BaseMessage>\n\t`,\n};\n","import { AudioPlayer } from 'im.v2.component.elements';\n\nimport { MessageType } from 'im.v2.const';\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/audio.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioItem = {\n\tname: 'AudioItem',\n\tcomponents: { AudioPlayer, ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tplayerBackgroundType(): string\n\t\t{\n\t\t\treturn this.messageType === MessageType.self ? 'dark' : 'light';\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-media-audio__container\">\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageId\" />\n\t\t\t<AudioPlayer\n\t\t\t\t:id=\"file.id\"\n\t\t\t\t:src=\"file.urlShow\"\n\t\t\t\t:file=\"file\"\n\t\t\t\t:timelineType=\"Math.floor(Math.random() * 5)\"\n\t\t\t\t:authorId=\"file.authorId\"\n\t\t\t\t:withContextMenu=\"false\"\n\t\t\t\t:withAvatar=\"false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { MessageStatus, ReactionList, DefaultMessageContent, ReactionSelector } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType, MessageType } from 'im.v2.const';\n\nimport { AudioItem } from './items/audio';\n\nimport '../css/audio-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioMessage = {\n\tname: 'AudioMessage',\n\tcomponents: {\n\t\tReactionList,\n\t\tBaseMessage,\n\t\tMessageStatus,\n\t\tDefaultMessageContent,\n\t\tAudioItem,\n\t\tReactionSelector,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t\tmessageType(): $Values<typeof MessageType>\n\t\t{\n\t\t\treturn this.$store.getters['messages/getMessageType'](this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-audio__container\">\n\t\t\t\t<AudioItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t:messageType=\"messageType\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-audio__default-message-container\">\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t<ReactionSelector :messageId=\"message.id\" />\n\t\t\t</div>\n\t\t</BaseMessage>\n\t`,\n};\n","import { FileType } from 'im.v2.const';\nimport { UnsupportedMessage } from 'im.v2.component.message.unsupported';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { ImageMessage } from './components/image-message';\nimport { BaseFileMessage } from './components/base-file-message';\nimport { VideoMessage } from './components/video-message';\nimport { AudioMessage } from './components/audio-message';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\nconst FileMessageType = Object.freeze({\n\timage: 'ImageMessage',\n\taudio: 'AudioMessage',\n\tvideo: 'VideoMessage',\n\tbase: 'BaseFileMessage',\n\tcollection: 'CollectionFileMessage',\n});\n\n// @vue/component\nexport const FileMessage = {\n\tname: 'FileMessage',\n\tcomponents: {\n\t\tBaseFileMessage,\n\t\tImageMessage,\n\t\tVideoMessage,\n\t\tAudioMessage,\n\t\tUnsupportedMessage,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFiles(): ImModelFile[]\n\t\t{\n\t\t\tconst files = [];\n\n\t\t\tif (this.message.files.length === 0)\n\t\t\t{\n\t\t\t\treturn files;\n\t\t\t}\n\n\t\t\tthis.message.files.forEach((fileId: number) => {\n\t\t\t\tconst file: ImModelFile = this.$store.getters['files/get'](fileId, true);\n\t\t\t\tfiles.push(file);\n\t\t\t});\n\n\t\t\treturn files;\n\t\t},\n\t\tcomponentName(): string\n\t\t{\n\t\t\tconst file = this.messageFiles[0];\n\t\t\tconst hasPreview = Boolean(file.image);\n\n\t\t\tif (file.type === FileType.image && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.image;\n\t\t\t}\n\n\t\t\tif (file.type === FileType.audio)\n\t\t\t{\n\t\t\t\treturn FileMessageType.audio;\n\t\t\t}\n\n\t\t\t// file.type value is empty for mkv files\n\t\t\tconst isVideo = file.type === FileType.video || Utils.file.getFileExtension(file.name) === 'mkv';\n\t\t\tif (isVideo && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.video;\n\t\t\t}\n\n\t\t\treturn FileMessageType.base;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component \n\t\t\t:is=\"componentName\" \n\t\t\t:item=\"message\" \n\t\t\t:dialogId=\"dialogId\" \n\t\t\t:withTitle=\"withTitle\" \n\t\t\t:menuIsActiveForId=\"menuIsActiveForId\"\n\t\t/>\n\t`,\n};\n"],"names":["ProgressBar","name","props","item","type","Object","required","messageId","String","Number","computed","file","watch","getProgressBarManager","update","mounted","initProgressBar","beforeUnmount","removeProgressBar","methods","progress","blurElement","isImage","isVideo","progressBarManager","ProgressBarManager","container","$refs","uploadState","customConfig","hasTitle","subscribe","event","cancel","console","warn","EventEmitter","emit","EventType","uploader","tempFileId","id","tempMessageId","destroy","progressBar","start","template","MAX_WIDTH","MAX_HEIGHT","MIN_WIDTH","MIN_HEIGHT","ImageItem","directives","lazyload","components","imageSize","newWidth","image","width","newHeight","height","aspectRatio","Math","round","sizes","max","viewerAttributes","Utils","getViewerDataAttributes","viewerAttrs","canBeOpenedWithViewer","BX","UI","Viewer","imageTitle","size","formatFileSize","loc","isLoaded","download","url","urlDownload","urlShow","window","open","phraseCode","replacements","$Bitrix","Loc","getMessage","ImageMessage","ReactionList","BaseMessage","MessageStatus","DefaultMessageContent","ReactionSelector","ContextMenu","dialogId","withTitle","Boolean","default","menuIsActiveForId","FileType","message","onlyImage","text","length","attach","onlyImageOrVideo","messageFile","video","firstFileId","files","$store","getters","needBackground","canSetReactions","Type","isNumber","BaseFileContextMenu","BaseMenu","constructor","PopupType","messageBaseFileMenu","diskService","DiskService","getMenuItems","getDownloadFileItem","getSaveToDisk","html","createDownloadLink","onclick","menuInstance","close","bind","save","then","Notification","Center","notify","content","context","store","BaseFileItem","fileShortName","NAME_MAX_LENGTH","getShortFileName","fileSize","iconClass","iconType","getIconTypeByFilename","created","contextMenu","openContextMenu","$emit","BaseFileMessage","AuthorTitle","onOpenContextMenu","openMenu","target","VIDEO_SIZE_TO_AUTOPLAY","DEFAULT_WIDTH","DEFAULT_HEIGHT","VideoItem","SocialVideo","autoplay","getPlayCallback","VideoMessage","onlyVideo","AudioItem","AudioPlayer","messageType","playerBackgroundType","MessageType","self","AudioMessage","FileMessageType","freeze","audio","base","collection","FileMessage","UnsupportedMessage","messageFiles","forEach","fileId","push","componentName","hasPreview","getFileExtension"],"mappings":"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"}