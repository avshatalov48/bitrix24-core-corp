{"version":3,"file":"chat-content.bundle.js","sources":["../src/components/chat-header/editable-chat-title.js","../src/components/chat-header/call-button/call-types.js","../src/components/chat-header/classes/call-menu.js","../src/components/chat-header/call-button/call-button.js","../src/components/chat-header/chat-header.js","../src/components/chat-sidebar-wrapper.js","../src/classes/resize-manager.js","../src/components/drop-area.js","../src/components/empty-state.js","../src/components/mute-panel.js","../src/components/join-panel.js","../src/chat-content.js"],"sourcesContent":["import { ChatTitle } from 'im.v2.component.elements';\nimport { ChatActionType } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport type { ImModelDialog } from 'im.v2.model';\n\nconst INPUT_PADDING = 5;\n\n// @vue/component\nexport const EditableChatTitle = {\n\tname: 'EditableChatTitle',\n\tcomponents: { ChatTitle },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['newTitleSubmit'],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisEditing: false,\n\t\t\tinputWidth: 0,\n\t\t\tshowEditIcon: false,\n\t\t\tchatTitle: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tcanBeRenamed(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.rename, this.dialogId);\n\t\t},\n\t\tinputStyle(): { width: string }\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: `calc(${this.inputWidth}ch + ${INPUT_PADDING}px)`,\n\t\t\t};\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tchatTitle()\n\t\t{\n\t\t\tthis.inputWidth = this.chatTitle.length;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.chatTitle = this.dialog.name;\n\t},\n\tmethods:\n\t{\n\t\tonTitleClick()\n\t\t{\n\t\t\tif (!this.canBeRenamed)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.chatTitle)\n\t\t\t{\n\t\t\t\tthis.chatTitle = this.dialog.name;\n\t\t\t}\n\n\t\t\tthis.isEditing = true;\n\t\t\tthis.$nextTick().then(() => {\n\t\t\t\tthis.$refs.titleInput.focus();\n\t\t\t});\n\t\t},\n\t\tonNewTitleSubmit()\n\t\t{\n\t\t\tif (!this.isEditing)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isEditing = false;\n\n\t\t\tconst nameNotChanged = this.chatTitle === this.dialog.name;\n\t\t\tif (nameNotChanged || this.chatTitle === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('newTitleSubmit', this.chatTitle);\n\t\t},\n\t\tonEditCancel()\n\t\t{\n\t\t\tthis.isEditing = false;\n\t\t\tthis.chatTitle = this.dialog.name;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"!isEditing\"\n\t\t\t@click=\"onTitleClick\"\n\t\t\t@mouseover=\"showEditIcon = true\"\n\t\t\t@mouseleave=\"showEditIcon = false\"\n\t\t\tclass=\"bx-im-chat-header__title --chat\"\n\t\t\t:class=\"{'--can-rename': canBeRenamed}\"\n\t\t>\n\t\t\t<div class=\"bx-im-chat-header__title_container\">\n\t\t\t\t<ChatTitle :dialogId=\"dialogId\" :withMute=\"true\" />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-chat-header__edit-icon_container\">\n\t\t\t\t<div v-if=\"showEditIcon && canBeRenamed\" class=\"bx-im-chat-header__edit-icon\"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-else class=\"bx-im-chat-header__title-input_container\">\n\t\t\t<input\n\t\t\t\tv-model=\"chatTitle\"\n\t\t\t\t:style=\"inputStyle\"\n\t\t\t\t@focus=\"$event.target.select()\"\n\t\t\t\t@blur=\"onNewTitleSubmit\"\n\t\t\t\t@keyup.enter=\"onNewTitleSubmit\"\n\t\t\t\t@keyup.esc=\"onEditCancel\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"bx-im-chat-header__title-input\"\n\t\t\t\tref=\"titleInput\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\nimport { Messenger } from 'im.public';\nimport { CallManager } from 'im.v2.lib.call';\n\nimport type { ImModelDialog } from 'im.v2.model';\n\nexport const CallTypes = {\n\tvideo: {\n\t\tid: 'video',\n\t\tlocCode: 'IM_CONTENT_CHAT_HEADER_VIDEOCALL',\n\t\tstart: (dialogId: string) => {\n\t\t\tMessenger.startVideoCall(dialogId);\n\t\t},\n\t},\n\taudio: {\n\t\tid: 'audio',\n\t\tlocCode: 'IM_CONTENT_CHAT_HEADER_CALL_MENU_AUDIO',\n\t\tstart: (dialogId: string) => {\n\t\t\tMessenger.startVideoCall(dialogId, false);\n\t\t},\n\t},\n\tbeta: {\n\t\tid: 'beta',\n\t\tlocCode: 'IM_CONTENT_CHAT_HEADER_CALL_MENU_BETA_2',\n\t\tstart: (dialogId: string) => {\n\t\t\tconst dialog: ImModelDialog = Core.getStore().getters['dialogues/get'](dialogId);\n\t\t\tCallManager.getInstance().createBetaCallRoom(dialog.chatId);\n\t\t},\n\t},\n};\n","import { Extension, Loc } from 'main.core';\n\nimport { BaseMenu } from 'im.v2.lib.menu';\nimport { CallManager } from 'im.v2.lib.call';\n\nimport { CallTypes } from '../call-button/call-types';\n\nimport type { ImModelDialog } from 'im.v2.model';\nimport type { MenuItem } from 'im.v2.lib.menu';\n\nimport type { PopupOptions } from 'main.popup';\n\nexport class CallMenu extends BaseMenu\n{\n\tcontext: ImModelDialog;\n\n\tstatic events = {\n\t\tonMenuItemClick: 'onMenuItemClick',\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-chat-header-call-menu';\n\t}\n\n\tgetMenuOptions(): PopupOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 4,\n\t\t\toffsetTop: 5,\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.#getVideoCallItem(),\n\t\t\tthis.#getAudioCallItem(),\n\t\t\tthis.#getBetaCallItem(),\n\t\t];\n\t}\n\n\t#getVideoCallItem(): MenuItem\n\t{\n\t\tconst isAvailable = CallManager.getInstance().chatCanBeCalled(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_CONTENT_CHAT_HEADER_VIDEOCALL'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tCallTypes.video.start(this.context.dialogId);\n\t\t\t\tthis.emit(CallMenu.events.onMenuItemClick, CallTypes.video);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\tdisabled: !isAvailable,\n\t\t};\n\t}\n\n\t#getAudioCallItem(): MenuItem\n\t{\n\t\tconst isAvailable = CallManager.getInstance().chatCanBeCalled(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_AUDIO'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tCallTypes.audio.start(this.context.dialogId);\n\n\t\t\t\tthis.emit(CallMenu.events.onMenuItemClick, CallTypes.audio);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\tdisabled: !isAvailable,\n\t\t};\n\t}\n\n\t#getBetaCallItem(): ?MenuItem\n\t{\n\t\tif (!this.#isCallBetaAvailable())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_BETA_2'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!this.#isCallBetaAvailable())\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tCallTypes.beta.start(this.context.dialogId);\n\n\t\t\t\tthis.emit(CallMenu.events.onMenuItemClick, CallTypes.beta);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#isCallBetaAvailable(): boolean\n\t{\n\t\tconst settings = Extension.getSettings('im.v2.component.content.chat');\n\n\t\treturn settings.get('isCallBetaAvailable');\n\t}\n}\n","import { Extension } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport { Messenger } from 'im.public';\nimport { ChatActionType, LocalStorageKey, DialogType } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { LocalStorageManager } from 'im.v2.lib.local-storage';\n\nimport { CallMenu } from '../classes/call-menu';\nimport { CallTypes } from './call-types';\n\nimport '../../../css/call-button.css';\n\nimport type { ImModelDialog } from 'im.v2.model';\n\n// @vue/component\nexport const CallButton = {\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tlastCallType: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tisActive(): boolean\n\t\t{\n\t\t\tconst chatCanBeCalled = CallManager.getInstance().chatCanBeCalled(this.dialogId);\n\t\t\tconst chatIsAllowedToCall = PermissionManager.getInstance().canPerformAction(ChatActionType.call, this.dialogId);\n\n\t\t\treturn chatCanBeCalled && chatIsAllowedToCall;\n\t\t},\n\t\tisConference(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === DialogType.videoconf;\n\t\t},\n\t\tcallButtonText(): string\n\t\t{\n\t\t\tconst locCode = CallTypes[this.lastCallType].locCode;\n\n\t\t\treturn this.loc(locCode);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.lastCallType = this.getLastCallChoice();\n\t\tthis.subscribeToMenuItemClick();\n\t},\n\tmethods:\n\t{\n\t\tstartVideoCall()\n\t\t{\n\t\t\tif (!this.isActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tMessenger.startVideoCall(this.dialogId);\n\t\t},\n\t\tsubscribeToMenuItemClick()\n\t\t{\n\t\t\tthis.getCallMenu().subscribe(\n\t\t\t\tCallMenu.events.onMenuItemClick,\n\t\t\t\t(event: BaseEvent<{id: string}>) => {\n\t\t\t\t\tconst { id: callTypeId } = event.getData();\n\t\t\t\t\tthis.saveLastCallChoice(callTypeId);\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tgetCallMenu(): CallMenu\n\t\t{\n\t\t\tif (!this.callMenu)\n\t\t\t{\n\t\t\t\tthis.callMenu = new CallMenu();\n\t\t\t}\n\n\t\t\treturn this.callMenu;\n\t\t},\n\t\tonButtonClick()\n\t\t{\n\t\t\tif (!this.isActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tCallTypes[this.lastCallType].start(this.dialogId);\n\t\t},\n\t\tonMenuClick()\n\t\t{\n\t\t\tif (!this.shouldShowMenu())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.getCallMenu().openMenu(this.dialog, this.$refs.menu);\n\t\t},\n\t\tonStartConferenceClick()\n\t\t{\n\t\t\tMessenger.openConference({ code: this.dialog.public.code });\n\t\t},\n\t\tgetLastCallChoice(): string\n\t\t{\n\t\t\treturn LocalStorageManager.getInstance().get(LocalStorageKey.lastCallType, CallTypes.video.id);\n\t\t},\n\t\tsaveLastCallChoice(callTypeId: string)\n\t\t{\n\t\t\tthis.lastCallType = callTypeId;\n\t\t\tLocalStorageManager.getInstance().set(LocalStorageKey.lastCallType, callTypeId);\n\t\t},\n\t\tshouldShowMenu(): boolean\n\t\t{\n\t\t\treturn this.isActive || this.isCallBetaAvailable();\n\t\t},\n\t\tisCallBetaAvailable(): boolean\n\t\t{\n\t\t\tconst settings = Extension.getSettings('im.v2.component.content.chat');\n\n\t\t\treturn settings.get('isCallBetaAvailable');\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isConference\" class=\"bx-im-chat-header-call-button__container --conference\" @click=\"onStartConferenceClick\">\n\t\t\t<div class=\"bx-im-chat-header-call-button__text\">\n\t\t\t\t{{ loc('IM_CONTENT_CHAT_HEADER_START_CONFERENCE') }}\n\t\t\t</div>\n\t\t</div>\n\t\t<div\n\t\t\tv-else\n\t\t\tclass=\"bx-im-chat-header-call-button__container\"\n\t\t\t:class=\"{'--disabled': !isActive}\"\n\t\t\t@click=\"onButtonClick\"\n\t\t>\n\t\t\t<div class=\"bx-im-chat-header-call-button__text\">\n\t\t\t\t{{ callButtonText }}\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-chat-header-call-button__separator\"></div>\n\t\t\t<div class=\"bx-im-chat-header-call-button__chevron_container\" @click.stop=\"onMenuClick\">\n\t\t\t\t<div class=\"bx-im-chat-header-call-button__chevron\" ref=\"menu\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import 'ui.notification';\nimport { Loc, type JsonObject } from 'main.core';\n\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\nimport { ChatService } from 'im.v2.provider.service';\nimport { DialogType, ChatActionType, UserRole } from 'im.v2.const';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport { EditableChatTitle } from './editable-chat-title';\nimport { CallButton } from './call-button/call-button';\n\nimport '../../css/chat-header.css';\n\nimport type { ImModelUser, ImModelDialog } from 'im.v2.model';\n\n// @vue/component\nexport const ChatHeader = {\n\tname: 'ChatHeader',\n\tcomponents: { Avatar, ChatTitle, EditableChatTitle, AddToChat, CallButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tsidebarOpened: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tsidebarSearchOpened: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['toggleRightPanel', 'toggleSearchPanel', 'toggleMembersPanel'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.dialogId, true);\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tisInited(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited;\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === DialogType.user;\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn !this.isUser;\n\t\t},\n\t\tisGuest(): boolean\n\t\t{\n\t\t\treturn this.dialog.role === UserRole.guest;\n\t\t},\n\t\tavatarStyle(): {backgroundImage: string}\n\t\t{\n\t\t\treturn { backgroundImage: `url('${this.dialog.avatar}')` };\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tdialogDescription(): string\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t\t}\n\n\t\t\treturn Loc.getMessagePlural('IM_CONTENT_CHAT_HEADER_USER_COUNT', this.dialog.userCounter, {\n\t\t\t\t'#COUNT#': this.dialog.userCounter,\n\t\t\t});\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t\tuserLastOnline(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getLastOnline'](this.dialogId);\n\t\t},\n\t\tshowInviteButton(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t},\n\t\tcanChangeAvatar(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.avatar, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\ttoggleRightPanel()\n\t\t{\n\t\t\tthis.$emit('toggleRightPanel');\n\t\t},\n\t\ttoggleSearchPanel()\n\t\t{\n\t\t\tthis.$emit('toggleSearchPanel');\n\t\t},\n\t\tonMembersClick()\n\t\t{\n\t\t\tif (this.isUser || !this.isInited)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('toggleMembersPanel');\n\t\t},\n\t\tonNewTitleSubmit(newTitle: string)\n\t\t{\n\t\t\tthis.getChatService().renameChat(this.dialogId, newTitle).catch(() => {\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_CONTENT_CHAT_HEADER_RENAME_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\topenInvitePopup()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t\tonAvatarClick()\n\t\t{\n\t\t\tif (!this.isChat || !this.canChangeAvatar)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$refs.avatarInput.click();\n\t\t},\n\t\tasync onAvatarSelect(event: Event)\n\t\t{\n\t\t\tconst input: HTMLInputElement = event.target;\n\t\t\tconst file: File = input.files[0];\n\t\t\tif (!file)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst preparedAvatar = await this.getChatService().prepareAvatar(file);\n\t\t\tif (!preparedAvatar)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvoid this.getChatService().changeAvatar(this.dialog.chatId, preparedAvatar);\n\t\t},\n\t\tonContainerClick(event: PointerEvent)\n\t\t{\n\t\t\tif (this.isGuest)\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div @click.capture=\"onContainerClick\" class=\"bx-im-chat-header__scope bx-im-chat-header__container\">\n\t\t\t<div class=\"bx-im-chat-header__left\">\n\t\t\t\t<div class=\"bx-im-chat-header__avatar\" :class=\"{'--can-change': canChangeAvatar}\" @click=\"onAvatarClick\">\n\t\t\t\t\t<Avatar v-if=\"isChat\" :dialogId=\"dialogId\" :size=\"AvatarSize.L\" :withStatus=\"true\" />\n\t\t\t\t\t<a v-else :href=\"userLink\" target=\"_blank\">\n\t\t\t\t\t\t<Avatar :dialogId=\"dialogId\" :size=\"AvatarSize.L\" :withStatus=\"true\" />\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t<input \n\t\t\t\t\ttype=\"file\" \n\t\t\t\t\t@change=\"onAvatarSelect\" \n\t\t\t\t\taccept=\"image/*\" \n\t\t\t\t\tclass=\"bx-im-chat-header__avatar_input\" \n\t\t\t\t\tref=\"avatarInput\"\n\t\t\t\t>\n\t\t\t\t<div v-if=\"isChat\" class=\"bx-im-chat-header__info\">\n\t\t\t\t\t<EditableChatTitle :dialogId=\"dialogId\" @newTitleSubmit=\"onNewTitleSubmit\" />\n\t\t\t\t\t<div \n\t\t\t\t\t\t:title=\"loc('IM_CONTENT_CHAT_HEADER_OPEN_MEMBERS')\" \n\t\t\t\t\t\t@click=\"onMembersClick\" \n\t\t\t\t\t\tclass=\"bx-im-chat-header__subtitle --click\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ dialogDescription }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"bx-im-chat-header__info\">\n\t\t\t\t\t<div class=\"bx-im-chat-header__title --user\">\n\t\t\t\t\t\t<a :href=\"userLink\" target=\"_blank\" class=\"bx-im-chat-header__title_container\">\n\t\t\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" />\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span class=\"bx-im-chat-header__user-status\">{{ userLastOnline }}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-chat-header__subtitle\">{{ dialogDescription }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-chat-header__right\">\n\t\t\t\t<CallButton :dialogId=\"dialogId\" />\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"showInviteButton\"\n\t\t\t\t\tclass=\"bx-im-chat-header__icon --add-people\"\n\t\t\t\t\t:class=\"{'--active': showAddToChatPopup}\"\n\t\t\t\t\t@click=\"openInvitePopup\" \n\t\t\t\t\tref=\"add-members\"\n\t\t\t\t></div>\n\t\t\t\t<div \n\t\t\t\t\t@click=\"toggleSearchPanel\" \n\t\t\t\t\tclass=\"bx-im-chat-header__icon --search\" \n\t\t\t\t\t:class=\"{'--active': sidebarSearchOpened}\"\n\t\t\t\t></div>\n\t\t\t\t<div \n\t\t\t\t\t@click=\"toggleRightPanel\" \n\t\t\t\t\tclass=\"bx-im-chat-header__icon --panel\" \n\t\t\t\t\t:class=\"{'--active': sidebarOpened}\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 15, offsetLeft: -300}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ChatSidebar } from 'im.v2.component.sidebar';\n\nimport '../css/chat-sidebar-wrapper.css';\n\n// @vue/component\nexport const SidebarWrapper = {\n\tname: 'SidebarWrapper',\n\tcomponents: { ChatSidebar },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tsidebarDetailBlock: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['back'],\n\tmethods:\n\t{\n\t\tonClickBack()\n\t\t{\n\t\t\tthis.$emit('back');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-wrapper__scope bx-im-sidebar-wrapper__container\">\n\t\t\t<ChatSidebar\n\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t:key=\"dialogId\" \n\t\t\t\t:sidebarDetailBlock=\"sidebarDetailBlock\"\n\t\t\t\t@back=\"onClickBack\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nconst EVENT_NAMESPACE = 'BX.Messenger.v2.Content.Chat.ResizeManager';\n\nexport class ResizeManager extends EventEmitter\n{\n\t#observer: ResizeObserver;\n\t#textareaHeight: number;\n\n\tstatic events = {\n\t\tonHeightChange: 'onHeightChange'\n\t};\n\n\tconstructor(): ResizeManager\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(EVENT_NAMESPACE);\n\n\t\tthis.#initObserver();\n\t}\n\n\tobserveTextarea(element: HTMLElement)\n\t{\n\t\tthis.#observer.observe(element);\n\t\tthis.#textareaHeight = element.clientHeight;\n\t}\n\n\tunobserveTextarea(element: HTMLElement)\n\t{\n\t\tthis.#observer.unobserve(element);\n\t\tthis.#textareaHeight = 0;\n\t}\n\n\t#initObserver()\n\t{\n\t\tthis.#observer = new ResizeObserver(((entries: ResizeObserverEntry[]) => {\n\t\t\tentries.forEach((entry: ResizeObserverEntry) => {\n\t\t\t\tconst height = entry.borderBoxSize?.[0].blockSize;\n\t\t\t\tif (Type.isNumber(height) && height !== this.#textareaHeight)\n\t\t\t\t{\n\t\t\t\t\tthis.emit(ResizeManager.events.onHeightChange, {newHeight: height});\n\t\t\t\t\tthis.#textareaHeight = height;\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t}\n}","import '../css/drop-area.css';\n\n// @vue/component\nexport const DropArea = {\n\tprops:\n\t{\n\t\tshow: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Transition name=\"drop-area-fade\">\n\t\t\t<div v-if=\"show\" class=\"bx-im-content-chat-drop-area__container bx-im-content-chat-drop-area__scope\">\n\t\t\t\t<div class=\"bx-im-content-chat-drop-area__box\">\n\t\t\t\t\t<span class=\"bx-im-content-chat-drop-area__icon\"></span>\n\t\t\t\t\t<label class=\"bx-im-content-chat-drop-area__label-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_CONTENT_DROP_AREA') }}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Transition>\n\t`,\n};\n","// @vue/component\nexport const EmptyState = {\n\tdata()\n\t{\n\t\treturn {};\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__start_message\">\n\t\t\t<div class=\"bx-im-content-chat__start_message_icon\"></div>\n\t\t\t<div class=\"bx-im-content-chat__start_message_text\">\n\t\t\t\t{{ loc('IM_CONTENT_CHAT_START_MESSAGE') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\nimport { Button as ChatButton, ButtonSize } from 'im.v2.component.elements';\nimport { Color } from 'im.v2.const';\nimport { ChatService } from 'im.v2.provider.service';\n\nimport type { CustomColorScheme } from 'im.v2.component.elements';\nimport type { ImModelDialog } from 'im.v2.model';\n\nconst BUTTON_BACKGROUND_COLOR = 'rgba(0, 0, 0, 0.1)';\nconst BUTTON_HOVER_COLOR = 'rgba(0, 0, 0, 0.2)';\nconst BUTTON_TEXT_COLOR = '#fff';\n\n// @vue/component\nexport const MutePanel = {\n\tcomponents: { ChatButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tisMuted(): boolean\n\t\t{\n\t\t\treturn this.dialog.muteList.includes(Core.getUserId());\n\t\t},\n\t\tbuttonText(): string\n\t\t{\n\t\t\tconst mutedCode = this.loc('IM_CONTENT_BLOCKED_TEXTAREA_ENABLE_NOTIFICATIONS');\n\t\t\tconst unmutedCode = this.loc('IM_CONTENT_BLOCKED_TEXTAREA_DISABLE_NOTIFICATIONS');\n\n\t\t\treturn this.isMuted ? mutedCode : unmutedCode;\n\t\t},\n\t\tbuttonColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tborderColor: Color.transparent,\n\t\t\t\tbackgroundColor: BUTTON_BACKGROUND_COLOR,\n\t\t\t\ticonColor: BUTTON_TEXT_COLOR,\n\t\t\t\ttextColor: BUTTON_TEXT_COLOR,\n\t\t\t\thoverColor: BUTTON_HOVER_COLOR,\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonButtonClick()\n\t\t{\n\t\t\tif (this.isMuted)\n\t\t\t{\n\t\t\t\tthis.getChatService().unmuteChat(this.dialogId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.getChatService().muteChat(this.dialogId);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__textarea_placeholder\">\n\t\t\t<ChatButton\n\t\t\t\t:size=\"ButtonSize.XL\"\n\t\t\t\t:customColorScheme=\"buttonColorScheme\"\n\t\t\t\t:text=\"buttonText\"\n\t\t\t\t:isRounded=\"true\"\n\t\t\t\t@click=\"onButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Button as ChatButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { ChatService } from 'im.v2.provider.service';\n\n// @vue/component\nexport const JoinPanel = {\n\tcomponents: { ChatButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): {}\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t},\n\tmethods:\n\t{\n\t\tonButtonClick()\n\t\t{\n\t\t\tthis.getChatService().joinChat(this.dialogId);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__textarea_placeholder\">\n\t\t\t<ChatButton\n\t\t\t\t:size=\"ButtonSize.XL\"\n\t\t\t\t:color=\"ButtonColor.Primary\"\n\t\t\t\t:text=\"loc('IM_CONTENT_BLOCKED_TEXTAREA_JOIN_CHAT')\"\n\t\t\t\t:isRounded=\"true\"\n\t\t\t\t@click=\"onButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { getFilesFromDataTransfer, hasDataTransferOnlyFiles } from 'ui.uploader.core';\n\nimport { Messenger } from 'im.public';\nimport { ChatDialog } from 'im.v2.component.dialog.chat';\nimport { ChatTextarea } from 'im.v2.component.textarea';\nimport { ChatService, UploadingService } from 'im.v2.provider.service';\nimport { Logger } from 'im.v2.lib.logger';\nimport { LocalStorageManager } from 'im.v2.lib.local-storage';\nimport { ThemeManager } from 'im.v2.lib.theme';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { EventType, Layout, LocalStorageKey, SidebarDetailBlock, ChatActionType, Settings, UserRole } from 'im.v2.const';\n\nimport { ChatHeader } from './components/chat-header/chat-header';\nimport { SidebarWrapper } from './components/chat-sidebar-wrapper';\nimport { ResizeManager } from './classes/resize-manager';\nimport { DropArea } from './components/drop-area';\nimport { EmptyState } from './components/empty-state';\nimport { MutePanel } from './components/mute-panel';\nimport { JoinPanel } from './components/join-panel';\n\nimport './css/chat-content.css';\n\nimport 'ui.notification';\n\nimport type { ImModelDialog, ImModelLayout } from 'im.v2.model';\nimport type { BackgroundStyle } from 'im.v2.lib.theme';\n\nconst CHAT_HEADER_HEIGHT = 64;\n\n// @vue/component\nexport const ChatContent = {\n\tname: 'ChatContent',\n\tcomponents:\n\t{\n\t\tChatHeader,\n\t\tChatDialog,\n\t\tChatTextarea,\n\t\tSidebarWrapper,\n\t\tDropArea,\n\t\tEmptyState,\n\t\tMutePanel,\n\t\tJoinPanel,\n\t},\n\tdirectives: {\n\t\t'textarea-observer': {\n\t\t\tmounted(element, binding)\n\t\t\t{\n\t\t\t\tbinding.instance.textareaResizeManager.observeTextarea(element);\n\t\t\t},\n\t\t\tbeforeUnmount(element, binding)\n\t\t\t{\n\t\t\t\tbinding.instance.textareaResizeManager.unobserveTextarea(element);\n\t\t\t},\n\t\t},\n\t},\n\tprops: {\n\t\tentityId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcontextMessageId: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tneedSidebarTransition: false,\n\t\t\tsidebarOpened: false,\n\t\t\tsearchSidebarOpened: false,\n\t\t\tsidebarDetailBlock: null,\n\t\t\ttextareaHeight: 0,\n\n\t\t\tshowDropArea: false,\n\t\t\tlastDropAreaEnterTarget: null,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tlayout(): ImModelLayout\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.entityId, true);\n\t\t},\n\t\thasPinnedMessages(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['messages/pin/getPinned'](this.dialog.chatId).length > 0;\n\t\t},\n\t\tcanPost(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.send, this.dialog.dialogId);\n\t\t},\n\t\tisGuest(): boolean\n\t\t{\n\t\t\treturn this.dialog.role === UserRole.guest;\n\t\t},\n\t\tsidebarTransitionName(): string\n\t\t{\n\t\t\treturn this.needSidebarTransition ? 'sidebar-transition' : '';\n\t\t},\n\t\tcontainerClasses(): string[]\n\t\t{\n\t\t\tconst alignment = this.$store.getters['application/settings/get'](Settings.appearance.alignment);\n\n\t\t\treturn [`--${alignment}-align`];\n\t\t},\n\t\tbackgroundStyle(): BackgroundStyle\n\t\t{\n\t\t\treturn ThemeManager.getCurrentBackgroundStyle();\n\t\t},\n\t\tdialogContainerStyle(): Object\n\t\t{\n\t\t\tconst TEXTAREA_PLACEHOLDER_HEIGHT = 50;\n\n\t\t\tlet textareaHeight = this.textareaHeight;\n\t\t\tif (!this.canPost)\n\t\t\t{\n\t\t\t\ttextareaHeight = TEXTAREA_PLACEHOLDER_HEIGHT;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: `calc(100% - ${CHAT_HEADER_HEIGHT}px - ${textareaHeight}px)`,\n\t\t\t};\n\t\t},\n\t\tdropAreaStyles(): {[top: string]: string}\n\t\t{\n\t\t\tconst PINNED_MESSAGES_HEIGHT = 53;\n\t\t\tconst DROP_AREA_OFFSET = 16 + CHAT_HEADER_HEIGHT;\n\n\t\t\tconst dropAreaTopOffset = this.hasPinnedMessages\n\t\t\t\t? PINNED_MESSAGES_HEIGHT + DROP_AREA_OFFSET\n\t\t\t\t: DROP_AREA_OFFSET\n\t\t\t;\n\n\t\t\treturn {\n\t\t\t\ttop: `${dropAreaTopOffset}px`,\n\t\t\t};\n\t\t},\n\t\tisSearchSidebarOpened(): boolean\n\t\t{\n\t\t\treturn this.sidebarDetailBlock === SidebarDetailBlock.messageSearch;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tentityId(newValue, oldValue)\n\t\t{\n\t\t\tLogger.warn(`ChatContent: switching from ${oldValue || 'empty'} to ${newValue}`);\n\t\t\tif (newValue === '')\n\t\t\t{\n\t\t\t\tthis.sidebarOpened = false;\n\t\t\t}\n\t\t\tthis.onChatChange();\n\t\t\tthis.resetSidebarDetailState();\n\t\t},\n\t\tsidebarOpened(newValue: boolean)\n\t\t{\n\t\t\tthis.saveSidebarOpenedState(newValue);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.restoreSidebarOpenState();\n\n\t\tif (this.entityId)\n\t\t{\n\t\t\tthis.onChatChange();\n\t\t}\n\n\t\tthis.initTextareaResizeManager();\n\t},\n\tmounted()\n\t{\n\t\tEventEmitter.subscribe(EventType.sidebar.open, this.onSidebarOpen);\n\t\tEventEmitter.subscribe(EventType.sidebar.close, this.onSidebarClose);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.sidebar.open, this.onSidebarOpen);\n\t\tEventEmitter.unsubscribe(EventType.sidebar.close, this.onSidebarClose);\n\t},\n\tmethods:\n\t{\n\t\tasync onChatChange()\n\t\t{\n\t\t\tif (this.entityId === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Utils.dialog.isExternalId(this.entityId))\n\t\t\t{\n\t\t\t\tconst realDialogId = await this.getChatService().prepareDialogId(this.entityId);\n\t\t\t\tthis.$store.dispatch('application/setLayout', {\n\t\t\t\t\tlayoutName: Layout.chat.name,\n\t\t\t\t\tentityId: realDialogId,\n\t\t\t\t\tcontextId: this.layout.contextId,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dialog.inited)\n\t\t\t{\n\t\t\t\tLogger.warn(`ChatContent: chat ${this.entityId} is already loaded`);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dialog.loading)\n\t\t\t{\n\t\t\t\tLogger.warn(`ChatContent: chat ${this.entityId} is loading`);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.layout.contextId)\n\t\t\t{\n\t\t\t\tawait this.loadChatWithContext();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.loadChat();\n\t\t\tthis.needSidebarTransition = true;\n\t\t},\n\t\tloadChatWithContext(): Promise\n\t\t{\n\t\t\tLogger.warn(`ChatContent: loading chat ${this.entityId} with context - ${this.layout.contextId}`);\n\n\t\t\treturn this.getChatService().loadChatWithContext(this.entityId, this.layout.contextId).then(() => {\n\t\t\t\tLogger.warn(`ChatContent: chat ${this.entityId} is loaded with context of ${this.layout.contextId}`);\n\t\t\t}).catch((error) => {\n\t\t\t\tif (error.code === 'ACCESS_ERROR')\n\t\t\t\t{\n\t\t\t\t\tthis.showNotification(this.loc('IM_CONTENT_CHAT_ACCESS_ERROR'));\n\t\t\t\t}\n\t\t\t\tLogger.error(error);\n\t\t\t\tMessenger.openChat();\n\t\t\t});\n\t\t},\n\t\tloadChat(): Promise\n\t\t{\n\t\t\tLogger.warn(`ChatContent: loading chat ${this.entityId}`);\n\n\t\t\treturn this.getChatService().loadChatWithMessages(this.entityId).then(() => {\n\t\t\t\tLogger.warn(`ChatContent: chat ${this.entityId} is loaded`);\n\t\t\t}).catch(() => {\n\t\t\t\tMessenger.openChat();\n\t\t\t});\n\t\t},\n\t\ttoggleSidebar()\n\t\t{\n\t\t\tthis.needSidebarTransition = true;\n\t\t\tthis.sidebarOpened = !this.sidebarOpened;\n\t\t\tthis.resetSidebarDetailState();\n\t\t},\n\t\ttoggleSearchPanel()\n\t\t{\n\t\t\tthis.needSidebarTransition = true;\n\t\t\tif (this.sidebarDetailBlock === SidebarDetailBlock.messageSearch)\n\t\t\t{\n\t\t\t\tthis.sidebarDetailBlock = null;\n\t\t\t\tthis.sidebarOpened = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sidebarOpened = true;\n\t\t\t\tEventEmitter.emit(EventType.sidebar.open, { detailBlock: SidebarDetailBlock.messageSearch });\n\t\t\t}\n\t\t},\n\t\ttoggleMembersPanel()\n\t\t{\n\t\t\tthis.needSidebarTransition = true;\n\t\t\tif (this.sidebarDetailBlock === SidebarDetailBlock.main)\n\t\t\t{\n\t\t\t\tthis.sidebarDetailBlock = null;\n\t\t\t\tthis.sidebarOpened = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sidebarOpened = true;\n\t\t\t\tEventEmitter.emit(EventType.sidebar.open, { detailBlock: SidebarDetailBlock.main });\n\t\t\t}\n\t\t},\n\t\tonClickBack()\n\t\t{\n\t\t\tthis.resetSidebarDetailState();\n\t\t},\n\t\tonSidebarOpen({ data: eventData }: BaseEvent)\n\t\t{\n\t\t\tthis.sidebarOpened = true;\n\t\t\tif (eventData.detailBlock && SidebarDetailBlock[eventData.detailBlock])\n\t\t\t{\n\t\t\t\tthis.sidebarDetailBlock = eventData.detailBlock;\n\t\t\t}\n\t\t},\n\t\tonSidebarClose()\n\t\t{\n\t\t\tthis.sidebarOpened = false;\n\t\t},\n\t\tresetSidebarDetailState()\n\t\t{\n\t\t\tthis.sidebarDetailBlock = null;\n\t\t},\n\t\trestoreSidebarOpenState()\n\t\t{\n\t\t\tconst sidebarOpenState = LocalStorageManager.getInstance().get(LocalStorageKey.sidebarOpened);\n\t\t\tthis.sidebarOpened = Boolean(sidebarOpenState);\n\t\t},\n\t\tsaveSidebarOpenedState(sidebarOpened: boolean)\n\t\t{\n\t\t\tconst WRITE_TO_STORAGE_TIMEOUT = 200;\n\t\t\tclearTimeout(this.saveSidebarStateTimeout);\n\t\t\tthis.saveSidebarStateTimeout = setTimeout(() => {\n\t\t\t\tLocalStorageManager.getInstance().set(LocalStorageKey.sidebarOpened, sidebarOpened);\n\t\t\t}, WRITE_TO_STORAGE_TIMEOUT);\n\t\t},\n\t\tinitTextareaResizeManager()\n\t\t{\n\t\t\tthis.textareaResizeManager = new ResizeManager();\n\t\t\tthis.textareaResizeManager.subscribe(\n\t\t\t\tResizeManager.events.onHeightChange,\n\t\t\t\t(event: BaseEvent<{newHeight: number}>) => {\n\t\t\t\t\tconst { newHeight } = event.getData();\n\t\t\t\t\tthis.textareaHeight = newHeight;\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tshowNotification(text: string)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({ content: text });\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t\tonDragEnter(event: DragEvent)\n\t\t{\n\t\t\tvoid hasDataTransferOnlyFiles(event.dataTransfer, false).then((success: boolean): void => {\n\t\t\t\tif (!success)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.lastDropAreaEnterTarget = event.target;\n\t\t\t\tthis.showDropArea = true;\n\t\t\t});\n\t\t},\n\t\tonDragLeave(event: DragEvent)\n\t\t{\n\t\t\tif (this.lastDropAreaEnterTarget === event.target)\n\t\t\t{\n\t\t\t\tthis.showDropArea = false;\n\t\t\t}\n\t\t},\n\t\tonDrop(event: DragEvent)\n\t\t{\n\t\t\tvoid getFilesFromDataTransfer(event.dataTransfer).then((files: File[]): void => {\n\t\t\t\tthis.getUploadingService().addFilesFromInput(files, this.entityId);\n\t\t\t});\n\t\t\tthis.showDropArea = false;\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tgetUploadingService(): UploadingService\n\t\t{\n\t\t\tif (!this.uploadingService)\n\t\t\t{\n\t\t\t\tthis.uploadingService = UploadingService.getInstance();\n\t\t\t}\n\n\t\t\treturn this.uploadingService;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__scope bx-im-content-chat__container\" :class=\"containerClasses\" :style=\"backgroundStyle\">\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-content-chat__content\"\n\t\t\t\t@drop.prevent=\"onDrop\"\n\t\t\t\t@dragleave.stop.prevent=\"onDragLeave\"\n\t\t\t\t@dragenter.stop.prevent=\"onDragEnter\"\n\t\t\t\t@dragover.prevent\n\t\t\t>\n\t\t\t\t<template v-if=\"entityId\">\n\t\t\t\t\t<ChatHeader \n\t\t\t\t\t\t:dialogId=\"entityId\" \n\t\t\t\t\t\t:key=\"entityId\" \n\t\t\t\t\t\t:sidebarOpened=\"sidebarOpened\"\n\t\t\t\t\t\t:sidebarSearchOpened=\"isSearchSidebarOpened\"\n\t\t\t\t\t\t@toggleRightPanel=\"toggleSidebar\" \n\t\t\t\t\t\t@toggleSearchPanel=\"toggleSearchPanel\" \n\t\t\t\t\t\t@toggleMembersPanel=\"toggleMembersPanel\" \n\t\t\t\t\t/>\n\t\t\t\t\t<div :style=\"dialogContainerStyle\" class=\"bx-im-content-chat__dialog_container\">\n\t\t\t\t\t\t<div class=\"bx-im-content-chat__dialog_content\">\n\t\t\t\t\t\t\t<ChatDialog :dialogId=\"entityId\" :key=\"entityId\" :textareaHeight=\"textareaHeight\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- Textarea -->\n\t\t\t\t\t<div v-if=\"canPost\" v-textarea-observer class=\"bx-im-content-chat__textarea_container\">\n\t\t\t\t\t\t<ChatTextarea :dialogId=\"entityId\" :key=\"entityId\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<JoinPanel v-else-if=\"isGuest\" :dialogId=\"entityId\" />\n\t\t\t\t\t<MutePanel v-else :dialogId=\"entityId\" />\n\t\t\t\t\t<!-- End textarea -->\n\t\t\t\t\t<DropArea :show=\"showDropArea\" :style=\"dropAreaStyles\" />\n\t\t\t\t</template>\n\t\t\t\t<EmptyState v-else />\n\t\t\t</div>\n\t\t\t<transition :name=\"sidebarTransitionName\">\n\t\t\t\t<SidebarWrapper \n\t\t\t\t\tv-if=\"entityId && sidebarOpened\"\n\t\t\t\t\t:dialogId=\"entityId\" \n\t\t\t\t\t:sidebarDetailBlock=\"sidebarDetailBlock\"\n\t\t\t\t\t@back=\"onClickBack\"\n\t\t\t\t/>\n\t\t\t</transition>\n\t\t</div>\n\t`,\n};\n"],"names":["INPUT_PADDING","EditableChatTitle","name","components","ChatTitle","props","dialogId","type","String","required","emits","data","isEditing","inputWidth","showEditIcon","chatTitle","computed","dialog","$store","getters","canBeRenamed","PermissionManager","getInstance","canPerformAction","ChatActionType","rename","inputStyle","width","watch","length","mounted","methods","onTitleClick","$nextTick","then","$refs","titleInput","focus","onNewTitleSubmit","nameNotChanged","$emit","onEditCancel","template","CallTypes","video","id","locCode","start","Messenger","startVideoCall","audio","beta","Core","getStore","CallManager","createBetaCallRoom","chatId","CallMenu","BaseMenu","constructor","getMenuOptions","className","getMenuClassName","angle","offsetLeft","offsetTop","getMenuItems","isAvailable","chatCanBeCalled","context","text","Loc","getMessage","onclick","emit","events","onMenuItemClick","menuInstance","close","disabled","settings","Extension","getSettings","get","CallButton","lastCallType","isActive","chatIsAllowedToCall","call","isConference","DialogType","videoconf","callButtonText","loc","created","getLastCallChoice","subscribeToMenuItemClick","getCallMenu","subscribe","event","callTypeId","getData","saveLastCallChoice","callMenu","onButtonClick","onMenuClick","shouldShowMenu","openMenu","menu","onStartConferenceClick","openConference","code","public","LocalStorageManager","LocalStorageKey","set","isCallBetaAvailable","phraseCode","$Bitrix","ChatHeader","Avatar","AddToChat","default","sidebarOpened","Boolean","sidebarSearchOpened","showAddToChatPopup","AvatarSize","user","isInited","inited","isUser","isChat","isGuest","role","UserRole","guest","avatarStyle","backgroundImage","avatar","dialogDescription","getMessagePlural","userCounter","userLink","Utils","getProfileLink","userLastOnline","showInviteButton","extend","canChangeAvatar","toggleRightPanel","toggleSearchPanel","onMembersClick","newTitle","getChatService","renameChat","catch","BX","UI","Notification","Center","notify","content","chatService","ChatService","openInvitePopup","onAvatarClick","avatarInput","click","onAvatarSelect","input","target","file","files","preparedAvatar","prepareAvatar","changeAvatar","onContainerClick","stopPropagation","replacements","SidebarWrapper","ChatSidebar","sidebarDetailBlock","onClickBack","EVENT_NAMESPACE","ResizeManager","EventEmitter","setEventNamespace","observeTextarea","element","observe","clientHeight","unobserveTextarea","unobserve","ResizeObserver","entries","forEach","entry","height","borderBoxSize","blockSize","Type","isNumber","onHeightChange","newHeight","DropArea","show","EmptyState","BUTTON_BACKGROUND_COLOR","BUTTON_HOVER_COLOR","BUTTON_TEXT_COLOR","MutePanel","ChatButton","ButtonSize","isMuted","muteList","includes","getUserId","buttonText","mutedCode","unmutedCode","buttonColorScheme","borderColor","Color","transparent","backgroundColor","iconColor","textColor","hoverColor","unmuteChat","muteChat","JoinPanel","ButtonColor","joinChat","CHAT_HEADER_HEIGHT","ChatContent","ChatDialog","ChatTextarea","directives","binding","instance","textareaResizeManager","beforeUnmount","entityId","contextMessageId","Number","needSidebarTransition","searchSidebarOpened","textareaHeight","showDropArea","lastDropAreaEnterTarget","layout","hasPinnedMessages","canPost","send","sidebarTransitionName","containerClasses","alignment","Settings","appearance","backgroundStyle","ThemeManager","getCurrentBackgroundStyle","dialogContainerStyle","TEXTAREA_PLACEHOLDER_HEIGHT","dropAreaStyles","PINNED_MESSAGES_HEIGHT","DROP_AREA_OFFSET","dropAreaTopOffset","top","isSearchSidebarOpened","SidebarDetailBlock","messageSearch","newValue","oldValue","Logger","warn","onChatChange","resetSidebarDetailState","saveSidebarOpenedState","restoreSidebarOpenState","initTextareaResizeManager","EventType","sidebar","open","onSidebarOpen","onSidebarClose","unsubscribe","isExternalId","realDialogId","prepareDialogId","dispatch","layoutName","Layout","chat","contextId","loading","loadChatWithContext","loadChat","error","showNotification","openChat","loadChatWithMessages","toggleSidebar","detailBlock","toggleMembersPanel","main","eventData","sidebarOpenState","WRITE_TO_STORAGE_TIMEOUT","clearTimeout","saveSidebarStateTimeout","setTimeout","onDragEnter","hasDataTransferOnlyFiles","dataTransfer","success","onDragLeave","onDrop","getFilesFromDataTransfer","getUploadingService","addFilesFromInput","uploadingService","UploadingService"],"mappings":"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"}