this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(t,e,n,i,s,a,c,o,r,l){"use strict";const d={emits:["membersChange"],data(){return{}},computed:{currentUserId(){return a.Core.getUserId()}},created(){this.membersSelector=new l.TagSelector({maxHeight:99,placeholder:"",addButtonCaption:this.loc("IM_CREATE_CHAT_USER_SELECTOR_ADD_MEMBERS"),addButtonCaptionMore:this.loc("IM_CREATE_CHAT_USER_SELECTOR_ADD_MEMBERS"),showCreateButton:false,dialogOptions:{enableSearch:false,context:"IM_CHAT_CREATE",entities:[{id:"user"},{id:"department"}],preselectedItems:[["user",this.currentUserId]],undeselectedItems:[["user",this.currentUserId]]},events:{onAfterTagAdd:t=>{const e=t.getTarget();this.$emit("membersChange",e.getTags().map((t=>t.id)))},onAfterTagRemove:t=>{const e=t.getTarget();this.$emit("membersChange",e.getTags().map((t=>t.id)))}}})},mounted(){this.membersSelector.renderTo(this.$refs["members"])},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-content-create-chat__members" ref="members"></div>\n\t`};const h={components:{ExpandAnimation:r.ExpandAnimation},props:{name:{type:String,required:true},title:{type:String,required:true}},data(){return{isFolded:true}},computed:{containerClasses(){return[`--${this.name}`,{"--active":!this.isFolded}]}},methods:{onContainerClick(){if(this.isFolded){this.isFolded=false}},onHeaderClick(){if(!this.isFolded){this.isFolded=true}}},template:`\n\t\t<div :class="containerClasses" class="bx-im-content-create-chat__section bx-im-content-create-chat__section_scope">\n\t\t\t<div @click="isFolded = !isFolded" class="bx-im-content-create-chat__section_header">\n\t\t\t\t<div class="bx-im-content-create-chat__section_left">\n\t\t\t\t\t<div class="bx-im-content-create-chat__section_icon"></div>\n\t\t\t\t\t<div class="bx-im-content-create-chat__section_text">{{ title }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-content-create-chat__section_right"></div>\t\n\t\t\t</div>\n\t\t\t<ExpandAnimation>\n\t\t\t\t<div v-if="!isFolded" class="bx-im-content-create-chat__section_content_container">\n\t\t\t\t\t<div class="bx-im-content-create-chat__section_content">\n\t\t\t\t\t\t<slot></slot>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ExpandAnimation>\n\t\t</div>\n\t`};const g={name:"OwnerSelector",props:{ownerId:{type:Number,required:true}},emits:["ownerChange"],data(){return{}},created(){this.membersSelector=new l.TagSelector({multiple:false,maxHeight:33,placeholder:"",addButtonCaption:this.loc("IM_CREATE_CHAT_USER_SELECTOR_CHANGE_OWNER"),addButtonCaptionMore:this.loc("IM_CREATE_CHAT_USER_SELECTOR_CHANGE_OWNER"),showCreateButton:false,dialogOptions:{enableSearch:false,context:"IM_CHAT_CREATE",entities:[{id:"user"},{id:"department"}],preselectedItems:[["user",this.ownerId]]},events:{onBeforeTagAdd:t=>{const{tag:e}=t.getData();e.setDeselectable(false)},onAfterTagAdd:t=>{const{tag:e}=t.getData();this.$emit("ownerChange",e.id)}}})},mounted(){this.membersSelector.renderTo(this.$refs["owner"])},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-content-create-chat__owner" ref="owner"></div>\n\t`};const _=[{value:"ALL",text:"All members",default:true},{value:"OWNERS",text:"Owners only"},{value:"ADMINS_AND_OWNERS",text:"Admins and owners"}];const C={components:{Section:h,Dropdown:o.Dropdown,Toggle:o.Toggle,OwnerSelector:g},props:{isAvailableInSearch:{type:Boolean,required:true},ownerId:{type:Number,required:true},description:{type:String,required:true}},emits:["ownerChange","manageTypeChange","chatTypeChange","descriptionChange"],data(){return{manageType:""}},computed:{ToggleSize:()=>o.ToggleSize,MANAGE_TYPES:()=>_,descriptionPlaceholderText(){return this.loc("IM_CREATE_CHAT_SETTINGS_SECTION_DESCRIPTION_PLACEHOLDER",{"#BR#":"\n","#QUOTE_START#":'"',"#QUOTE_END#":'"'})}},methods:{onManageTypeChange(t){this.$emit("manageTypeChange",t)},onOwnerChange(t){this.$emit("ownerChange",t)},onTypeChange(t){this.$emit("chatTypeChange",t)},onDescriptionChange(t){this.$emit("descriptionChange",t.target.value)},onToggleLabelClick(){this.$refs["toggle"].toggle()},loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)}},template:`\n\t\t<Section name="settings" :title="loc('IM_CREATE_CHAT_SETTINGS_SECTION')">\n\t\t\t<div class="bx-im-content-create-chat__section_block">\n\t\t\t\t<div class="bx-im-content-create-chat__heading">\n\t\t\t\t\t{{ loc('IM_CREATE_CHAT_SETTINGS_SECTION_OWNER') }}\n\t\t\t\t</div>\n\t\t\t\t<OwnerSelector :ownerId="ownerId" @ownerChange="onOwnerChange" />\n\t\t\t\t\x3c!--<div class="bx-im-content-create-chat__heading">Who can manage the participants</div>--\x3e\n\t\t\t\t\x3c!--<div class="bx-im-content-create-chat-settings__manage-select">--\x3e\n\t\t\t\t\x3c!--<Dropdown :items="MANAGE_TYPES" id="im-content-create-chat-manage-menu" @itemChange="onManageTypeChange" />--\x3e\n\t\t\t\t\x3c!--</div>--\x3e\n\t\t\t</div>\n\t\t\t<div class="bx-im-content-create-chat__section_block">\n\t\t\t\t<div class="bx-im-content-create-chat__heading">\n\t\t\t\t\t{{ loc('IM_CREATE_CHAT_SETTINGS_SECTION_PRIVACY') }}\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-content-create-chat-settings__type-select">\n\t\t\t\t\t<Toggle :size="ToggleSize.S" :isEnabled="isAvailableInSearch" @change="onTypeChange" ref="toggle" />\n\t\t\t\t\t<div @click="onToggleLabelClick" class="bx-im-content-create-chat-settings__type-select_label">\n\t\t\t\t\t\t{{ loc('IM_CREATE_CHAT_SETTINGS_SECTION_AVAILABLE_FOR_SEARCH') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t<div class="bx-im-content-create-chat__section_block">\n\t\t\t\t<div class="bx-im-content-create-chat__heading">{{ loc('IM_CREATE_CHAT_SETTINGS_SECTION_DESCRIPTION') }}</div>\n\t\t\t\t<div class="bx-im-content-create-chat-settings__description_container">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-textarea ui-ctl-w100 ui-ctl-no-resize">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t@input="onDescriptionChange"\n\t\t\t\t\t\t\t:value="description"\n\t\t\t\t\t\t\t:placeholder="descriptionPlaceholderText"\n\t\t\t\t\t\t\tplaceholder="1&#10;2&#10;3&#10;4&#10;5"\n\t\t\t\t\t\t\tclass="bx-im-content-create-chat-settings__description ui-ctl-element"\n\t\t\t\t\t\t></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Section>\n\t`};const m={components:{Section:h},data(){return{}},template:`\n\t\t<Section name="appearance" title="Appearance" />\n\t`};const p={name:"CreateChatContent",components:{ChatMembersSelector:d,SettingsSection:C,AppearanceSection:m,Button:o.Button},data(){return{isCreating:false,chatTitle:"",chatMembers:[],settings:{ownerId:0,manageType:"",isAvailableInSearch:false,description:""}}},computed:{ButtonSize:()=>o.ButtonSize,ButtonColor:()=>o.ButtonColor},created(){n.Logger.warn("Content: CreateChat created");this.chatService=new s.ChatService;this.settings.ownerId=a.Core.getUserId()},mounted(){this.$refs["titleInput"].focus()},methods:{onMembersChange(t){this.chatMembers=t},onOwnerChange(t){this.settings.ownerId=t},onManageTypeChange(t){this.settings.manageType=t},onChatTypeChange(t){this.settings.isAvailableInSearch=t},onDescriptionChange(t){this.settings.description=t},onCreateClick(){this.isCreating=true;this.chatService.createChat({title:this.chatTitle,members:this.chatMembers,ownerId:this.settings.ownerId,manageType:this.settings.manageType,isAvailableInSearch:this.settings.isAvailableInSearch,description:this.settings.description}).then((t=>{this.isCreating=false;e.Messenger.openChat(t)})).catch((()=>{this.isCreating=false;BX.UI.Notification.Center.notify({content:this.loc("IM_CREATE_CHAT_ERROR")})}))},onCancelClick(){e.Messenger.openChat()},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-content-create-chat__container bx-im-content-create-chat__scope">\n\t\t\t<div class="bx-im-content-create-chat__content">\n\t\t\t\t<div class="bx-im-content-create-chat__header">\n\t\t\t\t\t\x3c!--<div class="bx-im-content-create-chat__avatar"></div>--\x3e\n\t\t\t\t\t<div class="bx-im-content-create-chat__title_container">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tv-model="chatTitle"\n\t\t\t\t\t\t\t:placeholder="loc('IM_CREATE_CHAT_TITLE_PLACEHOLDER')"\n\t\t\t\t\t\t\tclass="bx-im-content-create-chat__title_input"\n\t\t\t\t\t\t\tref="titleInput"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ChatMembersSelector @membersChange="onMembersChange" />\n\t\t\t\t<SettingsSection\n\t\t\t\t\t:isAvailableInSearch="settings.isAvailableInSearch"\n\t\t\t\t\t:ownerId="settings.ownerId"\n\t\t\t\t\t:description="settings.description"\n\t\t\t\t\t@ownerChange="onOwnerChange"\n\t\t\t\t\t@manageTypeChange="onManageTypeChange"\n\t\t\t\t\t@chatTypeChange="onChatTypeChange"\n\t\t\t\t\t@descriptionChange="onDescriptionChange"\n\t\t\t\t/>\n\t\t\t\t\x3c!--<AppearanceSection />--\x3e\n\t\t\t</div>\n\t\t\t<div class="bx-im-content-create-chat__buttons">\n\t\t\t\t<div class="bx-im-content-create-chat__buttons_create">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:size="ButtonSize.XL"\n\t\t\t\t\t\t:color="ButtonColor.Success"\n\t\t\t\t\t\t:text="loc('IM_CREATE_CHAT_CONFIRM')"\n\t\t\t\t\t\t:isLoading="isCreating"\n\t\t\t\t\t\t:isDisabled="isCreating"\n\t\t\t\t\t\t@click="onCreateClick"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-content-create-chat__buttons_cancel">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:size="ButtonSize.XL"\n\t\t\t\t\t\t:color="ButtonColor.Link"\n\t\t\t\t\t\t:text="loc('IM_CREATE_CHAT_CANCEL')"\n\t\t\t\t\t\t:isDisabled="isCreating"\n\t\t\t\t\t\t@click="onCancelClick"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};t.CreateChatContent=p})(this.BX.Messenger.v2.Component.Content=this.BX.Messenger.v2.Component.Content||{},BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Const,BX.Messenger.v2.Provider.Service,BX.Messenger.v2.Application,BX,BX.Messenger.v2.Component.Elements,BX.Messenger.v2.Component.Animation,BX.UI.EntitySelector);
//# sourceMappingURL=create-chat-content.bundle.map.js