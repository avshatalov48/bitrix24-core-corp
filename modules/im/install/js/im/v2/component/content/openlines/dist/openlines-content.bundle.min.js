this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(e,n,t,i,s,r){"use strict";const o={data(){return{}},template:`\n\t\t<div class="bx-im-content-openlines__loader">\n\t\t\t<div class="bx-im-content-openlines__loader_spinner"></div>\n\t\t</div>\n\t`};const a="/desktop_app/";const d={IFRAME:"Y",IM_BACKGROUND:"light",IM_LINES:"Y",IM_MENU:"N",IM_STATUS:"N",IM_V2_LAYOUT:"Y"};const c={name:"OpenlinesContent",components:{OpenlinesLoader:o},props:{entityId:{type:String,default:""}},data(){return{isLoading:true}},computed:{iframeLink(){const e=new URLSearchParams(d);return`${a}?${e.toString()}`},layout(){return this.$store.getters["application/getLayout"]}},watch:{layout:{handler(e,n){if(e.name!==r.Layout.openlines.name){return}if(this.dialogIdChangedFromFrame){this.dialogIdChangedFromFrame=false;return}if(!e.entityId||e.entityId===n.entityId){return}this.sendOpenEvent()},flush:"post"}},created(){i.Logger.warn("Content: Openlines created");this.subscribeToEvents()},beforeUnmount(){this.unsubscribeEvents()},methods:{subscribeToEvents(){n.Event.bind(window,r.EventType.lines.onInit,this.onLinesInit);n.Event.bind(window,r.EventType.lines.onChatOpen,this.onLinesChatOpen);t.EventEmitter.subscribe(r.EventType.slider.onClose,this.unregisterSliderBindings)},unsubscribeEvents(){n.Event.unbind(window,r.EventType.lines.onInit,this.onLinesInit);n.Event.unbind(window,r.EventType.lines.onChatOpen,this.onLinesChatOpen);t.EventEmitter.unsubscribe(r.EventType.slider.onClose,this.unregisterSliderBindings)},async onLinesInit(){if(!this.isLoading){return}await this.$nextTick();this.isLoading=false;this.sendOpenEvent();this.registerSliderBindings()},onLinesChatOpen(e){if(this.entityId===e.detail){return}this.dialogIdChangedFromFrame=true;void s.LayoutManager.getInstance().setLayout({name:r.Layout.openlines.name,entityId:e.detail})},sendOpenEvent(){if(!this.entityId){return}const e=new CustomEvent(r.EventType.lines.openChat,{detail:this.entityId});this.$refs.frame.contentWindow.dispatchEvent(e)},registerSliderBindings(){var e;this.frameDocument=this.$refs.frame.contentDocument;if((e=BX.SidePanel.Instance)!=null&&e.registerAnchorListener){BX.SidePanel.Instance.registerAnchorListener(this.frameDocument);return}n.Event.bind(this.frameDocument,"click",BX.SidePanel.Instance.handleAnchorClick,{capture:true})},unregisterSliderBindings(){var e;if(!this.frameDocument){return}if((e=BX.SidePanel.Instance)!=null&&e.unregisterAnchorListener){BX.SidePanel.Instance.unregisterAnchorListener(this.frameDocument);return}n.Event.unbind(this.frameDocument,"click",BX.SidePanel.Instance.handleAnchorClick,{capture:true})}},template:`\n\t\t<div class="bx-im-content-openlines__container">\n\t\t\t<iframe class="bx-im-content-openlines__iframe" :src="iframeLink" ref="frame" />\n\t\t\t<OpenlinesLoader v-if="isLoading" />\n\t\t</div>\n\t`};e.OpenlinesContent=c})(this.BX.Messenger.v2.Component.Content=this.BX.Messenger.v2.Component.Content||{},BX,BX.Event,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Const);
//# sourceMappingURL=openlines-content.bundle.map.js