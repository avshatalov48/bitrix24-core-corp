{"version":3,"file":"left-panel.bundle.js","sources":["../src/left-panel.js"],"sourcesContent":["import {Core} from 'im.v2.application.core';\nimport {LeftPanel as LeftPanelComponent} from 'im.v2.component.old-chat-embedding.left-panel';\nimport {RecentPullHandler} from 'im.v2.provider.pull';\nimport {PullHandlers} from 'im.v2.const';\n\ntype LeftPanelApplicationParams = {\n\tnode?: string | HTMLElement,\n\tpreloadedList?: Object\n}\n\nexport class LeftPanelApplication\n{\n\tparams: LeftPanelApplicationParams;\n\tinited: boolean = false;\n\tinitPromise: Promise = null;\n\tinitPromiseResolver: Function = null;\n\trootNode: string | HTMLElement = null;\n\tvueInstance: Object = null;\n\tcontroller: Object = null;\n\tbitrixVue: Object = null;\n\n\t#applicationName = 'LeftPanel';\n\n\tconstructor(params: LeftPanelApplicationParams = {})\n\t{\n\t\tthis.initPromise = new Promise((resolve) => {\n\t\t\tthis.initPromiseResolver = resolve;\n\t\t});\n\n\t\tthis.params = params;\n\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.initCore()\n\t\t\t.then(() => this.initPullHandler())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitPullHandler()\n\t{\n\t\tif (this.controller.pullHandlers.includes(PullHandlers.recent))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.controller.pullClient.subscribe(\n\t\t\tnew RecentPullHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\tapplication: this\n\t\t\t})\n\t\t);\n\t\tthis.controller.pullHandlers.push(PullHandlers.recent);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tinitCore()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tCore.ready().then(controller => {\n\t\t\t\tthis.controller = controller;\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tinitComponent(node)\n\t{\n\t\tif (this.vueInstance)\n\t\t{\n\t\t\tthis.bitrixVue.unmount();\n\t\t\tthis.vueInstance = null;\n\t\t}\n\n\t\treturn this.controller.createVue(this, {\n\t\t\tname: this.#applicationName,\n\t\t\tel: node,\n\t\t\tcomponents: {LeftPanelComponent},\n\t\t\ttemplate: `<LeftPanelComponent />`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.vueInstance = vue;\n\n\t\t\treturn Promise.resolve();\n\t\t});\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.inited = true;\n\t\tthis.initPromiseResolver(this);\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\treturn Promise.resolve(this);\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n}"],"names":["LeftPanelApplication","constructor","params","inited","initPromise","initPromiseResolver","rootNode","vueInstance","controller","bitrixVue","Promise","resolve","node","document","createElement","initCore","then","initPullHandler","initComplete","pullHandlers","includes","PullHandlers","recent","pullClient","subscribe","RecentPullHandler","store","getStore","application","push","Core","ready","initComponent","unmount","createVue","name","el","components","LeftPanelComponent","template","vue"],"mappings":";;;;;;;;AAUA,CAAO,MAAMA,oBAAN,CACP;CAYCC,EAAAA,WAAW,CAACC,MAAkC,GAAG,EAAtC,EACX;CAAA,SAXAC,MAWA,GAXkB,KAWlB;CAAA,SAVAC,WAUA,GAVuB,IAUvB;CAAA,SATAC,mBASA,GATgC,IAShC;CAAA,SARAC,QAQA,GARiC,IAQjC;CAAA,SAPAC,WAOA,GAPsB,IAOtB;CAAA,SANAC,UAMA,GANqB,IAMrB;CAAA,SALAC,SAKA,GALoB,IAKpB;CAAA;CAAA;CAAA,aAHmB;CAGnB;CACC,SAAKL,WAAL,GAAmB,IAAIM,OAAJ,CAAaC,OAAD,IAAa;CAC3C,WAAKN,mBAAL,GAA2BM,OAA3B;CACA,KAFkB,CAAnB;CAIA,SAAKT,MAAL,GAAcA,MAAd;CAEA,SAAKI,QAAL,GAAgB,KAAKJ,MAAL,CAAYU,IAAZ,IAAoBC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAApC;CAEA,SAAKC,QAAL,GACEC,IADF,CACO,MAAM,KAAKC,eAAL,EADb,EAEED,IAFF,CAEO,MAAM,KAAKE,YAAL,EAFb;CAIA;;CAEDD,EAAAA,eAAe,GACf;CACC,QAAI,KAAKT,UAAL,CAAgBW,YAAhB,CAA6BC,QAA7B,CAAsCC,wBAAY,CAACC,MAAnD,CAAJ,EACA;CACC,aAAOZ,OAAO,CAACC,OAAR,EAAP;CACA;;CACD,SAAKH,UAAL,CAAgBe,UAAhB,CAA2BC,SAA3B,CACC,IAAIC,qCAAJ,CAAsB;CACrBC,MAAAA,KAAK,EAAE,KAAKlB,UAAL,CAAgBmB,QAAhB,EADc;CAErBnB,MAAAA,UAAU,EAAE,KAAKA,UAFI;CAGrBoB,MAAAA,WAAW,EAAE;CAHQ,KAAtB,CADD;CAOA,SAAKpB,UAAL,CAAgBW,YAAhB,CAA6BU,IAA7B,CAAkCR,wBAAY,CAACC,MAA/C;CAEA,WAAOZ,OAAO,CAACC,OAAR,EAAP;CACA;;CAEDI,EAAAA,QAAQ,GACR;CACC,WAAO,IAAIL,OAAJ,CAAaC,OAAD,IAAa;CAC/BmB,MAAAA,2BAAI,CAACC,KAAL,GAAaf,IAAb,CAAkBR,UAAU,IAAI;CAC/B,aAAKA,UAAL,GAAkBA,UAAlB;CACAG,QAAAA,OAAO;CACP,OAHD;CAIA,KALM,CAAP;CAMA;;CAEDqB,EAAAA,aAAa,CAACpB,IAAD,EACb;CACC,QAAI,KAAKL,WAAT,EACA;CACC,WAAKE,SAAL,CAAewB,OAAf;CACA,WAAK1B,WAAL,GAAmB,IAAnB;CACA;;CAED,WAAO,KAAKC,UAAL,CAAgB0B,SAAhB,CAA0B,IAA1B,EAAgC;CACtCC,MAAAA,IAAI,0CAAE,IAAF,qCADkC;CAEtCC,MAAAA,EAAE,EAAExB,IAFkC;CAGtCyB,MAAAA,UAAU,EAAE;CAACC,4BAAAA;CAAD,OAH0B;CAItCC,MAAAA,QAAQ,EAAG;CAJ2B,KAAhC,EAMNvB,IANM,CAMDwB,GAAG,IAAI;CACZ,WAAKjC,WAAL,GAAmBiC,GAAnB;CAEA,aAAO9B,OAAO,CAACC,OAAR,EAAP;CACA,KAVM,CAAP;CAWA;;CAEDO,EAAAA,YAAY,GACZ;CACC,SAAKf,MAAL,GAAc,IAAd;CACA,SAAKE,mBAAL,CAAyB,IAAzB;CACA;;CAED0B,EAAAA,KAAK,GACL;CACC,QAAI,KAAK5B,MAAT,EACA;CACC,aAAOO,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;CACA;;CAED,WAAO,KAAKP,WAAZ;CACA;;CA3FF;;;;;;;;"}