{"version":3,"file":"sidebar.bundle.js","sources":["../src/sidebar.js"],"sourcesContent":["import {Core} from 'im.v2.application.core';\nimport {RecentList as RecentListComponent} from 'im.v2.component.old-chat-embedding.recent-list';\nimport {RecentPullHandler} from 'im.v2.provider.pull';\nimport {PullHandlers} from 'im.v2.const';\n\ntype SidebarApplicationParams = {\n\tnode?: string | HTMLElement,\n\tpreloadedList?: Object\n}\n\nexport class SidebarApplication\n{\n\tparams: SidebarApplicationParams;\n\tinited: boolean = false;\n\tinitPromise: Promise = null;\n\tinitPromiseResolver: Function = null;\n\trootNode: string | HTMLElement = null;\n\tvueInstance: Object = null;\n\tcontroller: Object = null;\n\n\t#applicationName = 'Sidebar';\n\n\tconstructor(params: SidebarApplicationParams = {})\n\t{\n\t\tthis.initPromise = new Promise((resolve) => {\n\t\t\tthis.initPromiseResolver = resolve;\n\t\t});\n\n\t\tthis.params = params;\n\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.initCore()\n\t\t\t.then(() => this.initPullHandler())\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitCore()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tCore.ready().then(controller => {\n\t\t\t\tthis.controller = controller;\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tinitPullHandler()\n\t{\n\t\tif (this.controller.pullHandlers.includes(PullHandlers.recent))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.controller.pullClient.subscribe(\n\t\t\tnew RecentPullHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\tapplication: this\n\t\t\t})\n\t\t);\n\t\tthis.controller.pullHandlers.push(PullHandlers.recent);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tinitComponent()\n\t{\n\t\treturn this.controller.createVue(this, {\n\t\t\tname: this.#applicationName,\n\t\t\tel: this.rootNode,\n\t\t\tcomponents: {RecentListComponent},\n\t\t\ttemplate: `<RecentListComponent :compactMode=\"true\"/>`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.vueInstance = vue;\n\n\t\t\treturn Promise.resolve();\n\t\t});\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.inited = true;\n\t\tthis.initPromiseResolver(this);\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\treturn Promise.resolve(this);\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n}"],"names":["SidebarApplication","constructor","params","inited","initPromise","initPromiseResolver","rootNode","vueInstance","controller","Promise","resolve","node","document","createElement","initCore","then","initPullHandler","initComponent","initComplete","Core","ready","pullHandlers","includes","PullHandlers","recent","pullClient","subscribe","RecentPullHandler","store","getStore","application","push","createVue","name","el","components","RecentListComponent","template","vue"],"mappings":";;;;;;CAGyC;AAOzC,CAAO,MAAMA,kBAAkB,CAC/B;GAWCC,WAAW,CAACC,MAAgC,GAAG,EAAE,EACjD;KAAA,KAVAC,MAAM,GAAY,KAAK;KAAA,KACvBC,WAAW,GAAY,IAAI;KAAA,KAC3BC,mBAAmB,GAAa,IAAI;KAAA,KACpCC,QAAQ,GAAyB,IAAI;KAAA,KACrCC,WAAW,GAAW,IAAI;KAAA,KAC1BC,UAAU,GAAW,IAAI;KAAA;OAAA;OAAA,OAEN;;KAIlB,IAAI,CAACJ,WAAW,GAAG,IAAIK,OAAO,CAAEC,OAAO,IAAK;OAC3C,IAAI,CAACL,mBAAmB,GAAGK,OAAO;MAClC,CAAC;KAEF,IAAI,CAACR,MAAM,GAAGA,MAAM;KAEpB,IAAI,CAACI,QAAQ,GAAG,IAAI,CAACJ,MAAM,CAACS,IAAI,IAAIC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;KAEjE,IAAI,CAACC,QAAQ,EAAE,CACbC,IAAI,CAAC,MAAM,IAAI,CAACC,eAAe,EAAE,CAAC,CAClCD,IAAI,CAAC,MAAM,IAAI,CAACE,aAAa,EAAE,CAAC,CAChCF,IAAI,CAAC,MAAM,IAAI,CAACG,YAAY,EAAE,CAAC;;GAIlCJ,QAAQ,GACR;KACC,OAAO,IAAIL,OAAO,CAAEC,OAAO,IAAK;OAC/BS,2BAAI,CAACC,KAAK,EAAE,CAACL,IAAI,CAACP,UAAU,IAAI;SAC/B,IAAI,CAACA,UAAU,GAAGA,UAAU;SAC5BE,OAAO,EAAE;QACT,CAAC;MACF,CAAC;;GAGHM,eAAe,GACf;KACC,IAAI,IAAI,CAACR,UAAU,CAACa,YAAY,CAACC,QAAQ,CAACC,wBAAY,CAACC,MAAM,CAAC,EAC9D;OACC,OAAOf,OAAO,CAACC,OAAO,EAAE;;KAEzB,IAAI,CAACF,UAAU,CAACiB,UAAU,CAACC,SAAS,CACnC,IAAIC,qCAAiB,CAAC;OACrBC,KAAK,EAAE,IAAI,CAACpB,UAAU,CAACqB,QAAQ,EAAE;OACjCrB,UAAU,EAAE,IAAI,CAACA,UAAU;OAC3BsB,WAAW,EAAE;MACb,CAAC,CACF;KACD,IAAI,CAACtB,UAAU,CAACa,YAAY,CAACU,IAAI,CAACR,wBAAY,CAACC,MAAM,CAAC;KAEtD,OAAOf,OAAO,CAACC,OAAO,EAAE;;GAGzBO,aAAa,GACb;KACC,OAAO,IAAI,CAACT,UAAU,CAACwB,SAAS,CAAC,IAAI,EAAE;OACtCC,IAAI,0CAAE,IAAI,qCAAiB;OAC3BC,EAAE,EAAE,IAAI,CAAC5B,QAAQ;OACjB6B,UAAU,EAAE;8BAACC;QAAoB;OACjCC,QAAQ,EAAG;MACX,CAAC,CACDtB,IAAI,CAACuB,GAAG,IAAI;OACZ,IAAI,CAAC/B,WAAW,GAAG+B,GAAG;OAEtB,OAAO7B,OAAO,CAACC,OAAO,EAAE;MACxB,CAAC;;GAGHQ,YAAY,GACZ;KACC,IAAI,CAACf,MAAM,GAAG,IAAI;KAClB,IAAI,CAACE,mBAAmB,CAAC,IAAI,CAAC;;GAG/Be,KAAK,GACL;KACC,IAAI,IAAI,CAACjB,MAAM,EACf;OACC,OAAOM,OAAO,CAACC,OAAO,CAAC,IAAI,CAAC;;KAG7B,OAAO,IAAI,CAACN,WAAW;;CAEzB;;;;;;;;"}