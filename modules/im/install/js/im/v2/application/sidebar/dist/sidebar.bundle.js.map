{"version":3,"file":"sidebar.bundle.js","sources":["../src/sidebar.js"],"sourcesContent":["import {Core} from 'im.v2.application.core';\nimport {RecentList as RecentListComponent} from 'im.v2.component.old-chat-embedding.recent-list';\nimport {RecentPullHandler} from 'im.v2.provider.pull';\nimport {PullHandlers} from 'im.v2.const';\n\ntype SidebarApplicationParams = {\n\tnode?: string | HTMLElement,\n\tpreloadedList?: Object\n}\n\nexport class SidebarApplication\n{\n\tparams: SidebarApplicationParams;\n\tinited: boolean = false;\n\tinitPromise: Promise = null;\n\tinitPromiseResolver: Function = null;\n\trootNode: string | HTMLElement = null;\n\tvueInstance: Object = null;\n\tcontroller: Object = null;\n\n\t#applicationName = 'Sidebar';\n\n\tconstructor(params: SidebarApplicationParams = {})\n\t{\n\t\tthis.initPromise = new Promise((resolve) => {\n\t\t\tthis.initPromiseResolver = resolve;\n\t\t});\n\n\t\tthis.params = params;\n\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.initCore()\n\t\t\t.then(() => this.initPullHandler())\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitCore()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tCore.ready().then(controller => {\n\t\t\t\tthis.controller = controller;\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tinitPullHandler()\n\t{\n\t\tif (this.controller.pullHandlers.includes(PullHandlers.recent))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.controller.pullClient.subscribe(\n\t\t\tnew RecentPullHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\tapplication: this\n\t\t\t})\n\t\t);\n\t\tthis.controller.pullHandlers.push(PullHandlers.recent);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tinitComponent()\n\t{\n\t\treturn this.controller.createVue(this, {\n\t\t\tname: this.#applicationName,\n\t\t\tel: this.rootNode,\n\t\t\tcomponents: {RecentListComponent},\n\t\t\ttemplate: `<RecentListComponent :compactMode=\"true\"/>`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.vueInstance = vue;\n\n\t\t\treturn Promise.resolve();\n\t\t});\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.inited = true;\n\t\tthis.initPromiseResolver(this);\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\treturn Promise.resolve(this);\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n}"],"names":["SidebarApplication","constructor","params","inited","initPromise","initPromiseResolver","rootNode","vueInstance","controller","Promise","resolve","node","document","createElement","initCore","then","initPullHandler","initComponent","initComplete","Core","ready","pullHandlers","includes","PullHandlers","recent","pullClient","subscribe","RecentPullHandler","store","getStore","application","push","createVue","name","el","components","RecentListComponent","template","vue"],"mappings":";;;;;;;;AAUA,CAAO,MAAMA,kBAAN,CACP;CAWCC,EAAAA,WAAW,CAACC,MAAgC,GAAG,EAApC,EACX;CAAA,SAVAC,MAUA,GAVkB,KAUlB;CAAA,SATAC,WASA,GATuB,IASvB;CAAA,SARAC,mBAQA,GARgC,IAQhC;CAAA,SAPAC,QAOA,GAPiC,IAOjC;CAAA,SANAC,WAMA,GANsB,IAMtB;CAAA,SALAC,UAKA,GALqB,IAKrB;CAAA;CAAA;CAAA,aAHmB;CAGnB;CACC,SAAKJ,WAAL,GAAmB,IAAIK,OAAJ,CAAaC,OAAD,IAAa;CAC3C,WAAKL,mBAAL,GAA2BK,OAA3B;CACA,KAFkB,CAAnB;CAIA,SAAKR,MAAL,GAAcA,MAAd;CAEA,SAAKI,QAAL,GAAgB,KAAKJ,MAAL,CAAYS,IAAZ,IAAoBC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAApC;CAEA,SAAKC,QAAL,GACEC,IADF,CACO,MAAM,KAAKC,eAAL,EADb,EAEED,IAFF,CAEO,MAAM,KAAKE,aAAL,EAFb,EAGEF,IAHF,CAGO,MAAM,KAAKG,YAAL,EAHb;CAKA;;CAEDJ,EAAAA,QAAQ,GACR;CACC,WAAO,IAAIL,OAAJ,CAAaC,OAAD,IAAa;CAC/BS,MAAAA,2BAAI,CAACC,KAAL,GAAaL,IAAb,CAAkBP,UAAU,IAAI;CAC/B,aAAKA,UAAL,GAAkBA,UAAlB;CACAE,QAAAA,OAAO;CACP,OAHD;CAIA,KALM,CAAP;CAMA;;CAEDM,EAAAA,eAAe,GACf;CACC,QAAI,KAAKR,UAAL,CAAgBa,YAAhB,CAA6BC,QAA7B,CAAsCC,wBAAY,CAACC,MAAnD,CAAJ,EACA;CACC,aAAOf,OAAO,CAACC,OAAR,EAAP;CACA;;CACD,SAAKF,UAAL,CAAgBiB,UAAhB,CAA2BC,SAA3B,CACC,IAAIC,qCAAJ,CAAsB;CACrBC,MAAAA,KAAK,EAAE,KAAKpB,UAAL,CAAgBqB,QAAhB,EADc;CAErBrB,MAAAA,UAAU,EAAE,KAAKA,UAFI;CAGrBsB,MAAAA,WAAW,EAAE;CAHQ,KAAtB,CADD;CAOA,SAAKtB,UAAL,CAAgBa,YAAhB,CAA6BU,IAA7B,CAAkCR,wBAAY,CAACC,MAA/C;CAEA,WAAOf,OAAO,CAACC,OAAR,EAAP;CACA;;CAEDO,EAAAA,aAAa,GACb;CACC,WAAO,KAAKT,UAAL,CAAgBwB,SAAhB,CAA0B,IAA1B,EAAgC;CACtCC,MAAAA,IAAI,0CAAE,IAAF,qCADkC;CAEtCC,MAAAA,EAAE,EAAE,KAAK5B,QAF6B;CAGtC6B,MAAAA,UAAU,EAAE;CAACC,6BAAAA;CAAD,OAH0B;CAItCC,MAAAA,QAAQ,EAAG;CAJ2B,KAAhC,EAMNtB,IANM,CAMDuB,GAAG,IAAI;CACZ,WAAK/B,WAAL,GAAmB+B,GAAnB;CAEA,aAAO7B,OAAO,CAACC,OAAR,EAAP;CACA,KAVM,CAAP;CAWA;;CAEDQ,EAAAA,YAAY,GACZ;CACC,SAAKf,MAAL,GAAc,IAAd;CACA,SAAKE,mBAAL,CAAyB,IAAzB;CACA;;CAEDe,EAAAA,KAAK,GACL;CACC,QAAI,KAAKjB,MAAT,EACA;CACC,aAAOM,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;CACA;;CAED,WAAO,KAAKN,WAAZ;CACA;;CArFF;;;;;;;;"}