this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,s,t){"use strict";const i={[t.ChatType.copilot]:18e4,default:35e3};var a=babelHelpers.classPrivateFieldLooseKey("instance");var r=babelHelpers.classPrivateFieldLooseKey("writingTimers");var l=babelHelpers.classPrivateFieldLooseKey("alreadyWriting");var o=babelHelpers.classPrivateFieldLooseKey("buildTimerId");var n=babelHelpers.classPrivateFieldLooseKey("setTimer");var b=babelHelpers.classPrivateFieldLooseKey("clearTimer");var c=babelHelpers.classPrivateFieldLooseKey("updateChatWritingList");var d=babelHelpers.classPrivateFieldLooseKey("getWritingTime");var v=babelHelpers.classPrivateFieldLooseKey("getChat");class p{constructor(){Object.defineProperty(this,v,{value:F});Object.defineProperty(this,d,{value:B});Object.defineProperty(this,c,{value:g});Object.defineProperty(this,b,{value:L});Object.defineProperty(this,n,{value:P});Object.defineProperty(this,o,{value:h});Object.defineProperty(this,l,{value:u});Object.defineProperty(this,r,{writable:true,value:{}})}static getInstance(){if(!babelHelpers.classPrivateFieldLooseBase(this,a)[a]){babelHelpers.classPrivateFieldLooseBase(this,a)[a]=new this}return babelHelpers.classPrivateFieldLooseBase(this,a)[a]}startWriting(e){const{dialogId:s,userId:t,userName:i}=e;const a=babelHelpers.classPrivateFieldLooseBase(this,v)[v](s);if(!a){return}const d=babelHelpers.classPrivateFieldLooseBase(this,o)[o](s,t);if(babelHelpers.classPrivateFieldLooseBase(this,l)[l](a,t)){babelHelpers.classPrivateFieldLooseBase(this,b)[b](d);babelHelpers.classPrivateFieldLooseBase(this,r)[r][d]=babelHelpers.classPrivateFieldLooseBase(this,n)[n](s,t);return}const p=[{userId:t,userName:i},...a.writingList];babelHelpers.classPrivateFieldLooseBase(this,c)[c](s,p);babelHelpers.classPrivateFieldLooseBase(this,r)[r][d]=babelHelpers.classPrivateFieldLooseBase(this,n)[n](s,t)}stopWriting(e){const{dialogId:s,userId:t}=e;const i=babelHelpers.classPrivateFieldLooseBase(this,v)[v](s);if(!i){return}const a=babelHelpers.classPrivateFieldLooseBase(this,o)[o](s,t);if(!babelHelpers.classPrivateFieldLooseBase(this,l)[l](i,t)){return}const r=i.writingList.filter((e=>e.userId!==t));babelHelpers.classPrivateFieldLooseBase(this,c)[c](s,r);babelHelpers.classPrivateFieldLooseBase(this,b)[b](a)}}function u(e,s){return e.writingList.some((e=>e.userId===s))}function h(e,s){return`${e}|${s}`}function P(e,s){const t=babelHelpers.classPrivateFieldLooseBase(this,d)[d](e);return setTimeout((()=>{this.stopWriting({dialogId:e,userId:s})}),t)}function L(e){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,r)[r][e]);delete babelHelpers.classPrivateFieldLooseBase(this,r)[r][e]}function g(e,t){s.Core.getStore().dispatch("chats/update",{dialogId:e,fields:{writingList:t}})}function B(e){var s;const t=babelHelpers.classPrivateFieldLooseBase(this,v)[v](e);return(s=i[t.type])!=null?s:i.default}function F(e){return s.Core.getStore().getters["chats/get"](e)}Object.defineProperty(p,a,{writable:true,value:void 0});e.WritingManager=p})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX.Messenger.v2.Application,BX.Messenger.v2.Const);
//# sourceMappingURL=writing.bundle.map.js