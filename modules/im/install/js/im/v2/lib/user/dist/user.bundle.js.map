{"version":3,"file":"user.bundle.js","sources":["../src/user.js"],"sourcesContent":["import { Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { DialogType, UserRole } from 'im.v2.const';\n\nexport class UserManager\n{\n\tstore: Object = null;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t}\n\n\tstatic getDialogForUser(user: Object): Object\n\t{\n\t\treturn {\n\t\t\tdialogId: user.id,\n\t\t\tavatar: user.avatar,\n\t\t\tcolor: user.color,\n\t\t\tname: user.name,\n\t\t\ttype: DialogType.user,\n\t\t\trole: UserRole.member,\n\t\t};\n\t}\n\n\tsetUsersToModel(rawUsers: Object[]): Promise\n\t{\n\t\tconst { users, dialogues } = this.#prepareUsersForStore(rawUsers);\n\n\t\tconst usersPromise = this.store.dispatch('users/set', users);\n\t\tconst dialoguesPromise = this.store.dispatch('dialogues/set', dialogues);\n\n\t\treturn Promise.all([usersPromise, dialoguesPromise]);\n\t}\n\n\taddUsersToModel(rawUsers: Object[]): Promise\n\t{\n\t\tconst { users, dialogues } = this.#prepareUsersForStore(rawUsers);\n\n\t\tconst usersPromise = this.store.dispatch('users/add', users);\n\t\tconst dialoguesPromise = this.store.dispatch('dialogues/add', dialogues);\n\n\t\treturn Promise.all([usersPromise, dialoguesPromise]);\n\t}\n\n\t#prepareUsersForStore(users: Object[])\n\t{\n\t\tif (Type.isPlainObject(users))\n\t\t{\n\t\t\tusers = [users];\n\t\t}\n\n\t\tconst dialogues = [];\n\t\tusers.forEach((user) => {\n\t\t\tdialogues.push(UserManager.getDialogForUser(user));\n\t\t});\n\n\t\treturn { users, dialogues };\n\t}\n}\n"],"names":["UserManager","constructor","store","Core","getStore","getDialogForUser","user","dialogId","id","avatar","color","name","type","DialogType","role","UserRole","member","setUsersToModel","rawUsers","users","dialogues","usersPromise","dispatch","dialoguesPromise","Promise","all","addUsersToModel","Type","isPlainObject","forEach","push"],"mappings":";;;;;;;CAGmD;AAEnD,CAAO,MAAMA,WAAW,CACxB;GAGCC,WAAW,GACX;KAAA;OAAA;;KAAA,KAHAC,KAAK,GAAW,IAAI;KAInB,IAAI,CAACA,KAAK,GAAGC,2BAAI,CAACC,QAAQ,EAAE;;GAG7B,OAAOC,gBAAgB,CAACC,IAAY,EACpC;KACC,OAAO;OACNC,QAAQ,EAAED,IAAI,CAACE,EAAE;OACjBC,MAAM,EAAEH,IAAI,CAACG,MAAM;OACnBC,KAAK,EAAEJ,IAAI,CAACI,KAAK;OACjBC,IAAI,EAAEL,IAAI,CAACK,IAAI;OACfC,IAAI,EAAEC,sBAAU,CAACP,IAAI;OACrBQ,IAAI,EAAEC,oBAAQ,CAACC;MACf;;GAGFC,eAAe,CAACC,QAAkB,EAClC;KACC,MAAM;OAAEC,KAAK;OAAEC;MAAW,2CAAG,IAAI,gDAAuBF,QAAQ,CAAC;KAEjE,MAAMG,YAAY,GAAG,IAAI,CAACnB,KAAK,CAACoB,QAAQ,CAAC,WAAW,EAAEH,KAAK,CAAC;KAC5D,MAAMI,gBAAgB,GAAG,IAAI,CAACrB,KAAK,CAACoB,QAAQ,CAAC,eAAe,EAAEF,SAAS,CAAC;KAExE,OAAOI,OAAO,CAACC,GAAG,CAAC,CAACJ,YAAY,EAAEE,gBAAgB,CAAC,CAAC;;GAGrDG,eAAe,CAACR,QAAkB,EAClC;KACC,MAAM;OAAEC,KAAK;OAAEC;MAAW,2CAAG,IAAI,gDAAuBF,QAAQ,CAAC;KAEjE,MAAMG,YAAY,GAAG,IAAI,CAACnB,KAAK,CAACoB,QAAQ,CAAC,WAAW,EAAEH,KAAK,CAAC;KAC5D,MAAMI,gBAAgB,GAAG,IAAI,CAACrB,KAAK,CAACoB,QAAQ,CAAC,eAAe,EAAEF,SAAS,CAAC;KAExE,OAAOI,OAAO,CAACC,GAAG,CAAC,CAACJ,YAAY,EAAEE,gBAAgB,CAAC,CAAC;;CAiBtD;CAAC,gCAdsBJ,KAAe,EACrC;GACC,IAAIQ,cAAI,CAACC,aAAa,CAACT,KAAK,CAAC,EAC7B;KACCA,KAAK,GAAG,CAACA,KAAK,CAAC;;GAGhB,MAAMC,SAAS,GAAG,EAAE;GACpBD,KAAK,CAACU,OAAO,CAAEvB,IAAI,IAAK;KACvBc,SAAS,CAACU,IAAI,CAAC9B,WAAW,CAACK,gBAAgB,CAACC,IAAI,CAAC,CAAC;IAClD,CAAC;GAEF,OAAO;KAAEa,KAAK;KAAEC;IAAW;CAC5B;;;;;;;;"}