{"version":3,"file":"phone.bundle.js","sources":["../src/phone.js"],"sourcesContent":["import 'voximplant';\nimport { PhoneCallsController } from 'voximplant.phone-calls';\nimport 'applayout'; // should not be here\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { ImModelUser } from 'im.v2.model';\n\ntype PhoneSettings = {\n\tphoneEnabled: boolean,\n\tdeviceActive: boolean,\n\tcanInterceptCall: boolean,\n\tcanPerformCalls: boolean,\n\tcanCallUserNumber: boolean,\n\tdefaultLineId: string,\n\tavailableLines: string[],\n\trestApps: Array<{id: number, name: string}>\n};\n\ntype KeyPadParams = {\n\tbindElement: HTMLElement,\n\toffsetTop: number,\n\toffsetLeft: number,\n\tanglePosition: 'left' | 'top',\n\tangleOffset: number\n};\n\nexport class PhoneManager\n{\n\tstatic instance: PhoneManager;\n\n\t#controller: PhoneCallsController;\n\n\tstatic getInstance(): PhoneManager\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tstatic init(phoneSettings: PhoneSettings)\n\t{\n\t\tPhoneManager.getInstance().#init(phoneSettings);\n\t}\n\n\topenKeyPad(params: KeyPadParams)\n\t{\n\t\tif (!this.#controller)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#controller.openKeyPad(params);\n\t}\n\n\tcloseKeyPad()\n\t{\n\t\tif (!this.#controller)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#controller.closeKeyPad();\n\t}\n\n\t#init(phoneSettings: PhoneSettings)\n\t{\n\t\treturn;\n\t\tthis.#controller = this.#getController(phoneSettings);\n\t}\n\n\t#getController(phoneSettings: PhoneSettings): PhoneCallsController\n\t{\n\t\treturn new PhoneCallsController({\n\t\t\tphoneEnabled: phoneSettings.phoneEnabled,\n\n\t\t\tuserId: Core.getUserId(),\n\t\t\tisAdmin: this.#getCurrentUser().isAdmin,\n\n\t\t\trestApps: phoneSettings.restApps,\n\t\t\tcanInterceptCall: phoneSettings.canInterceptCall,\n\t\t\tdeviceActive: phoneSettings.deviceActive,\n\t\t\tdefaultLineId: phoneSettings.defaultLineId,\n\t\t\tavailableLines: phoneSettings.availableLines,\n\t\t});\n\t}\n\n\t#getCurrentUser(): ImModelUser\n\t{\n\t\tconst userId = Core.getUserId();\n\n\t\treturn Core.getStore().getters['users/get'](userId);\n\t}\n}\n"],"names":["PhoneManager","getInstance","instance","init","phoneSettings","openKeyPad","params","closeKeyPad","PhoneCallsController","phoneEnabled","userId","Core","getUserId","isAdmin","restApps","canInterceptCall","deviceActive","defaultLineId","availableLines","getStore","getters"],"mappings":";;;;;;;CAI8C;CAAA;CAAA;CAAA;AAuB9C,CAAO,MAAMA,YAAY,CACzB;GAAA;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;;GAKC,OAAOC,WAAW,GAClB;KACC,IAAI,CAAC,IAAI,CAACC,QAAQ,EAClB;OACC,IAAI,CAACA,QAAQ,GAAG,IAAI,IAAI,EAAE;;KAG3B,OAAO,IAAI,CAACA,QAAQ;;GAGrB,OAAOC,IAAI,CAACC,aAA4B,EACxC;KACC,wCAAAJ,YAAY,CAACC,WAAW,EAAE,gBAAOG,aAAa;;GAG/CC,UAAU,CAACC,MAAoB,EAC/B;KACC,IAAI,yCAAC,IAAI,2BAAY,EACrB;OACC;;KAGD,4CAAI,4BAAaD,UAAU,CAACC,MAAM,CAAC;;GAGpCC,WAAW,GACX;KACC,IAAI,yCAAC,IAAI,2BAAY,EACrB;OACC;;KAGD,4CAAI,4BAAaA,WAAW,EAAE;;CA+BhC;CAAC,gBA5BMH,aAA4B,EAClC;GACC;GACA,4CAAI,sEAAe,IAAI,kCAAgBA,aAAa,CAAC;CACtD;CAAC,yBAEcA,aAA4B,EAC3C;GACC,OAAO,IAAII,0CAAoB,CAAC;KAC/BC,YAAY,EAAEL,aAAa,CAACK,YAAY;KAExCC,MAAM,EAAEC,2BAAI,CAACC,SAAS,EAAE;KACxBC,OAAO,EAAE,4CAAI,sCAAmBA,OAAO;KAEvCC,QAAQ,EAAEV,aAAa,CAACU,QAAQ;KAChCC,gBAAgB,EAAEX,aAAa,CAACW,gBAAgB;KAChDC,YAAY,EAAEZ,aAAa,CAACY,YAAY;KACxCC,aAAa,EAAEb,aAAa,CAACa,aAAa;KAC1CC,cAAc,EAAEd,aAAa,CAACc;IAC9B,CAAC;CACH;CAAC,4BAGD;GACC,MAAMR,MAAM,GAAGC,2BAAI,CAACC,SAAS,EAAE;GAE/B,OAAOD,2BAAI,CAACQ,QAAQ,EAAE,CAACC,OAAO,CAAC,WAAW,CAAC,CAACV,MAAM,CAAC;CACpD;;;;;;;;"}