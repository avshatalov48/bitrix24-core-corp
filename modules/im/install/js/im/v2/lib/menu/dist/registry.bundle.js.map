{"version":3,"file":"registry.bundle.js","sources":["../src/base/base.js","../src/recent/invite-manager.js","../src/recent/recent.js"],"sourcesContent":["import {MenuManager, Menu} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\nimport {Store} from 'ui.vue3.vuex';\nimport {RestClient} from 'rest.client';\n\nimport {Core} from 'im.v2.application.core';\nimport {EventType} from 'im.v2.const';\n\nimport type {MenuItem} from '../type/menu';\n\nconst EVENT_NAMESPACE = 'BX.Messenger.v2.Lib.Menu';\n\nexport class BaseMenu extends EventEmitter\n{\n\tmenuInstance: Menu;\n\tcontext: Object;\n\ttarget: HTMLElement;\n\tstore: Store;\n\trestClient: RestClient;\n\tid: String = 'im-base-context-menu';\n\n\tstatic events = {\n\t\tonCloseMenu: 'onCloseMenu'\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(EVENT_NAMESPACE);\n\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\n\t\tthis.onClosePopupHandler = this.onClosePopup.bind(this);\n\t}\n\n\t// public\n\topenMenu(context: Object, target: HTMLElement)\n\t{\n\t\tif (this.menuInstance)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\tthis.context = context;\n\t\tthis.target = target;\n\t\tthis.menuInstance = this.getMenuInstance();\n\t\tthis.menuInstance.show();\n\n\t\tEventEmitter.subscribe(EventType.dialog.closePopup, this.onClosePopupHandler);\n\t}\n\n\tgetMenuInstance(): Menu\n\t{\n\t\treturn MenuManager.create(this.getMenuOptions());\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\tid: this.id,\n\t\t\tbindOptions: {forceBindPosition: true, position: 'bottom'},\n\t\t\ttargetContainer: document.body,\n\t\t\tbindElement: this.target,\n\t\t\tcacheable: false,\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\titems: this.getMenuItems(),\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tthis.emit(BaseMenu.events.onCloseMenu);\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [];\n\t}\n\n\tgetMenuClassName(): string\n\t{\n\t\treturn '';\n\t}\n\n\tonClosePopup()\n\t{\n\t\tthis.close();\n\t}\n\n\tclose()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.dialog.closePopup, this.onClosePopupHandler);\n\t\tif (!this.menuInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menuInstance.destroy();\n\t\tthis.menuInstance = null;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.close();\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn Core.getUserId();\n\t}\n}","import {ajax as Ajax, Loc} from 'main.core';\n\nconst resendAction = 'intranet.controller.invite.reinvite';\nconst cancelAction = 'intranet.controller.invite.deleteinvitation';\n\nexport const InviteManager = {\n\tresendInvite(userId: number)\n\t{\n\t\tconst data = {\n\t\t\tparams: {userId}\n\t\t};\n\t\tAjax.runAction(resendAction, {data}).then(() => {\n\t\t\tthis.showNotification(Loc.getMessage('IM_LIB_MENU_INVITE_RESEND_DONE'), 2000);\n\t\t}, (error) => {\n\t\t\tthis.handleActionError(error);\n\t\t});\n\t},\n\n\tcancelInvite(userId: number)\n\t{\n\t\tconst data = {\n\t\t\tparams: {userId}\n\t\t};\n\t\tAjax.runAction(cancelAction, {data}).then(() => {\n\t\t\tthis.showNotification(Loc.getMessage('IM_LIB_MENU_INVITE_CANCEL_DONE'), 2000);\n\t\t}, (error) => {\n\t\t\tthis.handleActionError(error);\n\t\t});\n\t},\n\n\tshowNotification(text: string, autoHideDelay: number = 4000)\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: text,\n\t\t\tautoHideDelay\n\t\t});\n\t},\n\n\thandleActionError(error: Object)\n\t{\n\t\tif (error.status === 'error' && error.errors.length > 0)\n\t\t{\n\t\t\tconst errorContent = error.errors.map((element) => {\n\t\t\t\treturn element.message;\n\t\t\t}).join('. ');\n\t\t\tthis.showNotification(errorContent);\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.showNotification(Loc.getMessage('IM_LIST_RECENT_CONNECT_ERROR'));\n\t}\n};","import {Loc, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\n\nimport {Core} from 'im.v2.application.core';\nimport {DialogType, EventType, OpenTarget} from 'im.v2.const';\nimport {CallManager} from 'im.v2.lib.call';\nimport {ChatService, RecentService} from 'im.v2.provider.service';\nimport {Utils} from 'im.v2.lib.utils';\nimport {Messenger} from 'im.public';\n\nimport {BaseMenu} from '../base/base';\nimport {InviteManager} from './invite-manager';\n\nimport type {MenuItem} from 'im.v2.lib.menu';\n\nexport class RecentMenu extends BaseMenu\n{\n\tcallManager: CallManager;\n\tchatService: ChatService;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-recent-context-menu';\n\t\tthis.callManager = CallManager.getInstance();\n\t\tthis.chatService = new ChatService();\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 32\n\t\t};\n\t}\n\n\tgetMenuClassName(): string\n\t{\n\t\treturn this.context.compactMode ? '' : super.getMenuClassName();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\tif (this.context.invitation.isActive)\n\t\t{\n\t\t\treturn this.getInviteItems();\n\t\t}\n\n\t\treturn [\n\t\t\tthis.getSendMessageItem(),\n\t\t\tthis.getUnreadMessageItem(),\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getMuteItem(),\n\t\t\tthis.getCallItem(),\n\t\t\t// this.getHistoryItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem()\n\t\t];\n\t}\n\n\tgetSendMessageItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_WRITE'),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetUnreadMessageItem(): MenuItem\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId, true);\n\t\tconst showReadOption = this.context.unread || dialog.counter > 0;\n\n\t\treturn {\n\t\t\ttext: showReadOption ? Loc.getMessage('IM_LIB_MENU_READ') : Loc.getMessage('IM_LIB_MENU_UNREAD'),\n\t\t\tonclick: () => {\n\t\t\t\tif (showReadOption)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.readDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unreadDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetPinMessageItem(): MenuItem\n\t{\n\t\tconst isPinned = this.context.pinned;\n\n\t\treturn {\n\t\t\ttext: isPinned ? Loc.getMessage('IM_LIB_MENU_UNPIN') : Loc.getMessage('IM_LIB_MENU_PIN'),\n\t\t\tonclick: () => {\n\t\t\t\tif (isPinned)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unpinChat(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.pinChat(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMuteItem(): ?MenuItem\n\t{\n\t\tconst canMute = this.store.getters['dialogues/canMute'](this.context.dialogId);\n\t\tif (!canMute)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId, true);\n\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\t\treturn {\n\t\t\ttext: isMuted? Loc.getMessage('IM_LIB_MENU_UNMUTE') : Loc.getMessage('IM_LIB_MENU_MUTE'),\n\t\t\tonclick: () => {\n\t\t\t\tif (isMuted)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unmuteChat(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.muteChat(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetCallItem(): ?MenuItem\n\t{\n\t\tconst chatCanBeCalled = this.callManager.chatCanBeCalled(this.context.dialogId);\n\t\tif (!chatCanBeCalled)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_CALL'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.callManager.startCall(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetHistoryItem(): ?MenuItem\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId, true);\n\t\tconst isUser = dialog.type === DialogType.user;\n\t\tif (isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_HISTORY'),\n\t\t\tonclick: () => {\n\t\t\t\tconst target = this.context.target === OpenTarget.current? OpenTarget.current: OpenTarget.auto;\n\n\t\t\t\tEventEmitter.emit(EventType.dialog.openHistory, {\n\t\t\t\t\t...this.context,\n\t\t\t\t\tchat: this.store.getters['dialogues/get'](this.context.dialogId, true),\n\t\t\t\t\tuser: this.store.getters['users/get'](this.context.dialogId, true),\n\t\t\t\t\ttarget\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetOpenProfileItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['dialogues/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE'),\n\t\t\thref: profileUri,\n\t\t\tonclick: () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetHideItem(): ?MenuItem\n\t{\n\t\tif (this.context.invitation?.isActive || this.context.options?.default_user_record)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_HIDE'),\n\t\t\tonclick: () => {\n\t\t\t\tRecentService.getInstance().hideChat(this.context.dialogId);\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetLeaveItem(): ?MenuItem\n\t{\n\t\tconst canLeaveChat = this.store.getters['dialogues/canLeave'](this.context.dialogId);\n\t\tif (!canLeaveChat)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_LEAVE'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.chatService.leaveChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\t// invitation\n\tgetInviteItems(): Array\n\t{\n\t\tconst items = [\n\t\t\tthis.getSendMessageItem(),\n\t\t\tthis.getOpenProfileItem()\n\t\t];\n\n\t\tlet canInvite; // TODO change to APPLICATION variable\n\t\tif (Type.isUndefined(BX.MessengerProxy))\n\t\t{\n\t\t\tcanInvite = true;\n\t\t\tconsole.error('BX.MessengerProxy.canInvite() method not found in v2 version!');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcanInvite = BX.MessengerProxy.canInvite();\n\t\t}\n\n\t\tconst canManageInvite = canInvite && Core.getUserId() === this.context.invitation.originator;\n\t\tif (canManageInvite)\n\t\t{\n\t\t\titems.push(\n\t\t\t\tthis.getDelimiter(),\n\t\t\t\tthis.context.invitation.canResend? this.getResendInviteItem(): null,\n\t\t\t\tthis.getCancelInviteItem()\n\t\t\t);\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tgetResendInviteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_INVITE_RESEND'),\n\t\t\tonclick: () => {\n\t\t\t\tInviteManager.resendInvite(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetCancelInviteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_INVITE_CANCEL'),\n\t\t\tonclick: () => {\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: Loc.getMessage('IM_LIB_MENU_INVITE_CANCEL_CONFIRM'),\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\t\tonOk: (messageBox) => {\n\t\t\t\t\t\tInviteManager.cancelInvite(this.context.dialogId);\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tonCancel: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\t// invitation end\n\n\tgetDelimiter(): Object\n\t{\n\t\treturn {delimiter: true};\n\t}\n}"],"names":["EVENT_NAMESPACE","BaseMenu","EventEmitter","constructor","id","setEventNamespace","store","Core","getStore","restClient","getRestClient","onClosePopupHandler","onClosePopup","bind","openMenu","context","target","menuInstance","close","getMenuInstance","show","subscribe","EventType","dialog","closePopup","MenuManager","create","getMenuOptions","bindOptions","forceBindPosition","position","targetContainer","document","body","bindElement","cacheable","className","getMenuClassName","items","getMenuItems","events","onClose","emit","onCloseMenu","unsubscribe","destroy","getCurrentUserId","getUserId","resendAction","cancelAction","InviteManager","resendInvite","userId","data","params","Ajax","runAction","then","showNotification","Loc","getMessage","error","handleActionError","cancelInvite","text","autoHideDelay","BX","UI","Notification","Center","notify","content","status","errors","length","errorContent","map","element","message","join","RecentMenu","callManager","CallManager","getInstance","chatService","ChatService","angle","offsetLeft","compactMode","invitation","isActive","getInviteItems","getSendMessageItem","getUnreadMessageItem","getPinMessageItem","getMuteItem","getCallItem","getOpenProfileItem","getHideItem","getLeaveItem","onclick","Messenger","openChat","dialogId","getters","showReadOption","unread","counter","readDialog","unreadDialog","isPinned","pinned","unpinChat","pinChat","canMute","isMuted","muteList","includes","unmuteChat","muteChat","chatCanBeCalled","startCall","getHistoryItem","isUser","type","DialogType","user","OpenTarget","current","auto","openHistory","chat","profileUri","Utils","getProfileLink","href","options","default_user_record","RecentService","hideChat","canLeaveChat","leaveChat","canInvite","Type","isUndefined","MessengerProxy","console","canManageInvite","originator","push","getDelimiter","canResend","getResendInviteItem","getCancelInviteItem","MessageBox","modal","buttons","MessageBoxButtons","OK_CANCEL","onOk","messageBox","onCancel","delimiter"],"mappings":"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"}