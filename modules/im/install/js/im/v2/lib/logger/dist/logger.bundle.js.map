{"version":3,"file":"logger.bundle.js","sources":["../src/logger.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Logger class\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Type} from \"main.core\";\n\nclass Logger\n{\n\t#types = {};\n\t#config = {};\n\t#custom = {};\n\t#localStorageKey = 'bx-messenger-logger';\n\n\tconstructor()\n\t{\n\t\tthis.#types = {\n\t\t\tdesktop: true,\n\t\t\tlog: false,\n\t\t\tinfo: false,\n\t\t\twarn: false,\n\t\t\terror: true,\n\t\t\ttrace: true,\n\t\t};\n\n\t\tthis.#config = this.#types;\n\n\t\tthis.#load();\n\t}\n\n\tsetConfig(types: Object)\n\t{\n\t\tObject.entries(types).forEach(([type, value]) => {\n\t\t\tif (!Type.isUndefined(this.#types[type]))\n\t\t\t{\n\t\t\t\tthis.#types[type] = !!value;\n\t\t\t\tthis.#config[type] = !!value;\n\t\t\t}\n\t\t});\n\n\t\tthis.#load();\n\t}\n\n\tenable(type: string)\n\t{\n\t\tif (Type.isUndefined(this.#types[type]))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.#types[type] = true;\n\t\tthis.#custom[type] = true;\n\n\t\tthis.#save();\n\n\t\treturn true;\n\t}\n\n\tdisable(type: string)\n\t{\n\t\tif (Type.isUndefined(this.#types[type]))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.#types[type] = false;\n\t\tthis.#custom[type] = false;\n\n\t\tthis.#save();\n\n\t\treturn true;\n\t}\n\n\tisEnabled(type: string): boolean\n\t{\n\t\treturn this.#types[type] === true;\n\t}\n\n\tdesktop(...params)\n\t{\n\t\tif (!this.isEnabled('desktop'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.log(...Logger.#getStyles('desktop'), ...params);\n\t}\n\n\tlog(...params)\n\t{\n\t\tif (!this.isEnabled('log'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.log(...Logger.#getStyles('log'), ...params);\n\t}\n\n\tinfo(...params)\n\t{\n\t\tif (!this.isEnabled('info'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.info(...Logger.#getStyles('info'), ...params);\n\t}\n\n\twarn(...params)\n\t{\n\t\tif (!this.isEnabled('warn'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.warn(...Logger.#getStyles('warn'), ...params);\n\t}\n\n\terror(...params)\n\t{\n\t\tif (!this.isEnabled('error'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.error(...Logger.#getStyles('error'), ...params);\n\t}\n\n\ttrace(...params)\n\t{\n\t\tif (!this.isEnabled('trace'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.trace(...params);\n\t}\n\n\t#save()\n\t{\n\t\tif (Type.isUndefined(window.localStorage))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst custom = {};\n\t\t\tObject.entries(this.#custom).forEach(([type, value]) => {\n\t\t\t\tif (this.#config[type] !== this.#custom[type])\n\t\t\t\t{\n\t\t\t\t\tcustom[type] = !!value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconsole.warn('Logger: saving custom types', JSON.stringify(custom));\n\n\t\t\twindow.localStorage.setItem(this.#localStorageKey, JSON.stringify(custom));\n\t\t}\n\t\tcatch (error) {\n\t\t\tconsole.error('Logger: save error', error);\n\t\t}\n\t}\n\n\t#load()\n\t{\n\t\tif (Type.isUndefined(window.localStorage))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst custom = window.localStorage.getItem(this.#localStorageKey);\n\t\t\tif (Type.isString(custom))\n\t\t\t{\n\t\t\t\tthis.#custom = JSON.parse(custom);\n\t\t\t\tthis.#types = {...this.#types, ...this.#custom};\n\t\t\t}\n\t\t}\n\t\tcatch (error) {\n\t\t\tconsole.error('Logger: load error', error);\n\t\t}\n\t}\n\n\tstatic #getStyles(type: string = 'all'): Object | Array\n\t{\n\t\tconst styles = {\n\t\t\t'desktop': [\"%cDESKTOP\", \"color: white; font-style: italic; background-color: #29619b; padding: 0 6px\"],\n\t\t\t'log': [\"%cLOG\", \"color: #2a323b; font-style: italic; background-color: #ccc; padding: 0 6px\"],\n\t\t\t'info': [\"%cINFO\", \"color: #fff; font-style: italic; background-color: #6b7f96; padding: 0 6px\"],\n\t\t\t'warn': [\"%cWARNING\", \"color: white; font-style: italic; padding: 0 6px; border: 1px solid #f0a74f\"],\n\t\t\t'error': [\"%cERROR\", \"color: white; font-style: italic; padding: 0 6px; border: 1px solid #8a3232\"],\n\t\t};\n\n\t\tif (type === 'all')\n\t\t{\n\t\t\treturn styles;\n\t\t}\n\n\t\tif (styles[type])\n\t\t{\n\t\t\treturn styles[type];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tstatic #getRemoveString()\n\t{\n\t\tconst styles = Logger.#getStyles();\n\t\tconst result = [];\n\n\t\tObject.entries(styles).forEach(([, style]) => {\n\t\t\tresult.push(style[1]);\n\t\t});\n\n\t\treturn result;\n\t}\n}\n\nconst logger = new Logger();\n\nexport {logger as Logger};"],"names":["Logger","constructor","desktop","log","info","warn","error","trace","setConfig","types","Object","entries","forEach","type","value","Type","isUndefined","enable","disable","isEnabled","params","console","window","localStorage","custom","JSON","stringify","setItem","getItem","isString","parse","styles","result","style","push","logger"],"mappings":"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"}