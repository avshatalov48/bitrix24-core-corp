{"version":3,"file":"init.bundle.js","sources":["../src/init.js"],"sourcesContent":["import { Core } from 'im.v2.application.core';\nimport { CallManager } from 'im.v2.lib.call';\nimport { PhoneManager } from 'im.v2.lib.phone';\nimport { SmileManager } from 'im.v2.lib.smile-manager';\nimport { UserManager } from 'im.v2.lib.user';\nimport { CounterManager } from 'im.v2.lib.counter';\nimport { Logger } from 'im.v2.lib.logger';\nimport { NotifierManager } from 'im.v2.lib.notifier';\nimport { MarketManager } from 'im.v2.lib.market';\nimport { DesktopManager } from 'im.v2.lib.desktop';\n\nexport class InitManager\n{\n\tstatic #started: boolean = false;\n\n\tstatic start()\n\t{\n\t\tif (this.#started)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#initLogger();\n\t\tLogger.warn('InitManager: start');\n\t\tthis.#initCurrentUser();\n\t\tthis.#initChatRestrictions();\n\t\tthis.#initCounters();\n\t\tthis.#initMarket();\n\t\tthis.#initSettings();\n\t\tthis.#initPhoneManager();\n\n\t\tCallManager.init();\n\t\tSmileManager.init();\n\t\tNotifierManager.init();\n\t\tDesktopManager.init();\n\n\t\tthis.#started = true;\n\t}\n\n\tstatic #initCurrentUser()\n\t{\n\t\tconst { currentUser } = Core.getApplicationData();\n\t\tif (!currentUser)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnew UserManager().setUsersToModel([currentUser]);\n\t}\n\n\tstatic #initLogger()\n\t{\n\t\tconst { loggerConfig } = Core.getApplicationData();\n\t\tif (!loggerConfig)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.setConfig(loggerConfig);\n\t}\n\n\tstatic #initChatRestrictions()\n\t{\n\t\tconst { chatOptions } = Core.getApplicationData();\n\t\tif (!chatOptions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tCore.getStore().dispatch('dialogues/setChatOptions', chatOptions);\n\t}\n\n\tstatic #initCounters()\n\t{\n\t\tconst { counters } = Core.getApplicationData();\n\t\tif (!counters)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('InitManager: counters', counters);\n\t\tCounterManager.init(counters);\n\t}\n\n\tstatic #initMarket()\n\t{\n\t\tconst { marketApps } = Core.getApplicationData();\n\t\tif (!marketApps)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('InitManager: marketApps', marketApps);\n\t\tMarketManager.init(marketApps);\n\t}\n\n\tstatic #initSettings()\n\t{\n\t\tconst { settings } = Core.getApplicationData();\n\t\tif (!settings)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('InitManager: settings', settings);\n\t\tCore.getStore().dispatch('application/settings/set', settings);\n\t}\n\n\tstatic #initPhoneManager()\n\t{\n\t\tconst { phoneSettings } = Core.getApplicationData();\n\t\tif (!phoneSettings)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('InitManager: phone', phoneSettings);\n\t\tPhoneManager.init(phoneSettings);\n\t}\n}\n"],"names":["InitManager","start","Logger","warn","CallManager","init","SmileManager","NotifierManager","DesktopManager","currentUser","Core","getApplicationData","UserManager","setUsersToModel","loggerConfig","setConfig","chatOptions","getStore","dispatch","counters","CounterManager","marketApps","MarketManager","settings","phoneSettings","PhoneManager"],"mappings":";;;;;;;CASmD;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAEnD,CAAO,MAAMA,WAAW,CACxB;GAGC,OAAOC,KAAK,GACZ;KACC,4CAAI,IAAI,uBACR;OACC;;KAGD,4CAAI;KACJC,uBAAM,CAACC,IAAI,CAAC,oBAAoB,CAAC;KACjC,4CAAI;KACJ,4CAAI;KACJ,4CAAI;KACJ,4CAAI;KACJ,4CAAI;KACJ,4CAAI;KAEJC,0BAAW,CAACC,IAAI,EAAE;KAClBC,mCAAY,CAACD,IAAI,EAAE;KACnBE,kCAAe,CAACF,IAAI,EAAE;KACtBG,gCAAc,CAACH,IAAI,EAAE;KAErB,4CAAI,wBAAY,IAAI;;CAmFtB;CAAC,6BA/EA;GACC,MAAM;KAAEI;IAAa,GAAGC,2BAAI,CAACC,kBAAkB,EAAE;GACjD,IAAI,CAACF,WAAW,EAChB;KACC;;GAGD,IAAIG,0BAAW,EAAE,CAACC,eAAe,CAAC,CAACJ,WAAW,CAAC,CAAC;CACjD;CAAC,wBAGD;GACC,MAAM;KAAEK;IAAc,GAAGJ,2BAAI,CAACC,kBAAkB,EAAE;GAClD,IAAI,CAACG,YAAY,EACjB;KACC;;GAGDZ,uBAAM,CAACa,SAAS,CAACD,YAAY,CAAC;CAC/B;CAAC,kCAGD;GACC,MAAM;KAAEE;IAAa,GAAGN,2BAAI,CAACC,kBAAkB,EAAE;GACjD,IAAI,CAACK,WAAW,EAChB;KACC;;GAGDN,2BAAI,CAACO,QAAQ,EAAE,CAACC,QAAQ,CAAC,0BAA0B,EAAEF,WAAW,CAAC;CAClE;CAAC,0BAGD;GACC,MAAM;KAAEG;IAAU,GAAGT,2BAAI,CAACC,kBAAkB,EAAE;GAC9C,IAAI,CAACQ,QAAQ,EACb;KACC;;GAGDjB,uBAAM,CAACC,IAAI,CAAC,uBAAuB,EAAEgB,QAAQ,CAAC;GAC9CC,gCAAc,CAACf,IAAI,CAACc,QAAQ,CAAC;CAC9B;CAAC,wBAGD;GACC,MAAM;KAAEE;IAAY,GAAGX,2BAAI,CAACC,kBAAkB,EAAE;GAChD,IAAI,CAACU,UAAU,EACf;KACC;;GAGDnB,uBAAM,CAACC,IAAI,CAAC,yBAAyB,EAAEkB,UAAU,CAAC;GAClDC,8BAAa,CAACjB,IAAI,CAACgB,UAAU,CAAC;CAC/B;CAAC,0BAGD;GACC,MAAM;KAAEE;IAAU,GAAGb,2BAAI,CAACC,kBAAkB,EAAE;GAC9C,IAAI,CAACY,QAAQ,EACb;KACC;;GAGDrB,uBAAM,CAACC,IAAI,CAAC,uBAAuB,EAAEoB,QAAQ,CAAC;GAC9Cb,2BAAI,CAACO,QAAQ,EAAE,CAACC,QAAQ,CAAC,0BAA0B,EAAEK,QAAQ,CAAC;CAC/D;CAAC,8BAGD;GACC,MAAM;KAAEC;IAAe,GAAGd,2BAAI,CAACC,kBAAkB,EAAE;GACnD,IAAI,CAACa,aAAa,EAClB;KACC;;GAGDtB,uBAAM,CAACC,IAAI,CAAC,oBAAoB,EAAEqB,aAAa,CAAC;GAChDC,4BAAY,CAACpB,IAAI,CAACmB,aAAa,CAAC;CACjC;CAAC,sBA3GWxB,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;GAAA,OAEI;CAAK;;;;;;;;"}