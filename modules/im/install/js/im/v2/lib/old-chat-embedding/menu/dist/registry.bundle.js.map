{"version":3,"file":"registry.bundle.js","sources":["../src/base/base.js","../src/recent/pin-manager.js","../src/recent/unread-manager.js","../src/recent/mute-manager.js","../src/recent/invite-manager.js","../src/recent/call-helper.js","../src/recent/recent.js"],"sourcesContent":["import {MenuManager} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\nimport {EventType} from 'im.v2.const';\n\nexport class BaseMenu\n{\n\tmenuInstance: Object = null;\n\tcontext: Object = null;\n\ttarget: HTMLElement = null;\n\tstore: Object = null;\n\trestClient: Object = null;\n\tid: String = 'im-base-context-menu';\n\n\tconstructor($Bitrix: Object)\n\t{\n\t\tthis.$Bitrix = $Bitrix;\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.restClient = $Bitrix.RestClient.get();\n\n\t\tthis.onClosePopupHandler = this.onClosePopup.bind(this);\n\t\tEventEmitter.subscribe(EventType.dialog.closePopup, this.onClosePopupHandler);\n\t}\n\n\t// public\n\topenMenu(context: Object, target: HTMLElement)\n\t{\n\t\tif (this.menuInstance)\n\t\t{\n\t\t\tthis.menuInstance.destroy();\n\t\t\tthis.menuInstance = null;\n\t\t}\n\t\tthis.context = context;\n\t\tthis.target = target;\n\t\tthis.menuInstance = this.getMenuInstance();\n\t\tthis.menuInstance.show();\n\t}\n\n\tgetMenuInstance()\n\t{\n\t\treturn MenuManager.create(this.getMenuOptions());\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\tid: this.id,\n\t\t\tbindOptions: {forceBindPosition: true, position: 'bottom'},\n\t\t\ttargetContainer: document.body,\n\t\t\tbindElement: this.target,\n\t\t\tcacheable: false,\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\titems: this.getMenuItems()\n\t\t};\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\treturn [];\n\t}\n\n\tgetMenuClassName(): string\n\t{\n\t\treturn this.isDarkMode() ? 'im-context-menu-dark' : '';\n\t}\n\n\tisDarkMode(): boolean\n\t{\n\t\treturn this.store.state.application.options.darkTheme;\n\t}\n\n\tonClosePopup()\n\t{\n\t\tthis.destroy();\n\t}\n\n\tclose()\n\t{\n\t\tif (!this.menuInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menuInstance.destroy();\n\t\tthis.menuInstance = null;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.close();\n\t\tEventEmitter.unsubscribe(EventType.dialog.closePopup, this.onClosePopupHandler);\n\t}\n}","import {RestMethod} from 'im.v2.const';\n\nexport class PinManager\n{\n\tstore: Object = null;\n\trestClient: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.restClient = $Bitrix.RestClient.get();\n\t}\n\n\tpinDialog(dialogId: string)\n\t{\n\t\tthis.store.dispatch('recent/pin', {id: dialogId, action: true});\n\t\tconst queryParams = {'DIALOG_ID': dialogId, 'ACTION': 'Y'};\n\t\tthis.restClient.callMethod(RestMethod.imRecentPin, queryParams).catch(error => {\n\t\t\tconsole.error('Im.RecentList: error pinning chat', error);\n\t\t\tthis.store.dispatch('recent/pin', {id: dialogId, action: false});\n\t\t});\n\t}\n\n\tunpinDialog(dialogId: string)\n\t{\n\t\tthis.store.dispatch('recent/pin', {id: dialogId, action: false});\n\t\tconst queryParams = {'DIALOG_ID': dialogId, 'ACTION': 'N'};\n\t\tthis.restClient.callMethod(RestMethod.imRecentPin, queryParams).catch(error => {\n\t\t\tconsole.error('Im.RecentList: error unpinning chat', error);\n\t\t\tthis.store.dispatch('recent/pin', {id: dialogId, action: true});\n\t\t});\n\t}\n}","import {RestMethod} from 'im.v2.const';\n\nexport class UnreadManager\n{\n\tstore: Object = null;\n\trestClient: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.restClient = $Bitrix.RestClient.get();\n\t}\n\n\treadDialog(dialogId: string)\n\t{\n\t\tlet queryParams;\n\n\t\tconst dialog = this.store.getters['dialogues/get'](dialogId, true);\n\t\tif (dialog.counter > 0)\n\t\t{\n\t\t\tqueryParams = {'DIALOG_ID': dialogId};\n\t\t\tthis.restClient.callMethod(RestMethod.imDialogRead, queryParams).catch(error => {\n\t\t\t\tconsole.error('Im.RecentList: error reading chat', error);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/unread', {id: dialogId, action: false});\n\t\tqueryParams = {'DIALOG_ID': dialogId, 'ACTION': 'N'};\n\t\tthis.restClient.callMethod(RestMethod.imRecentUnread, queryParams).catch(error => {\n\t\t\tconsole.error('Im.RecentList: error reading chat', error);\n\t\t\tthis.store.dispatch('recent/unread', {id: dialogId, action: true});\n\t\t});\n\t}\n\n\tunreadDialog(dialogId: string)\n\t{\n\t\tthis.store.dispatch('recent/unread', {id: dialogId, action: true});\n\t\tconst queryParams = {'DIALOG_ID': dialogId, 'ACTION': 'Y'};\n\t\tthis.restClient.callMethod(RestMethod.imRecentUnread, queryParams).catch(error => {\n\t\t\tconsole.error('Im.RecentList: error unreading chat', error);\n\t\t\tthis.store.dispatch('recent/unread', {id: dialogId, action: false});\n\t\t});\n\t}\n}","import {RestMethod} from 'im.v2.const';\n\nexport class MuteManager\n{\n\tstore: Object = null;\n\trestClient: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.restClient = $Bitrix.RestClient.get();\n\t}\n\n\tmuteDialog(dialogId: string)\n\t{\n\t\tthis.store.dispatch('dialogues/mute', {dialogId});\n\t\tconst queryParams = {'DIALOG_ID': dialogId, 'ACTION': 'Y'};\n\t\tthis.restClient.callMethod(RestMethod.imChatMute, queryParams).catch(error => {\n\t\t\tconsole.error('Im.RecentList: error muting chat', error);\n\t\t\tthis.store.dispatch('dialogues/unmute', {dialogId});\n\t\t});\n\t}\n\n\tunmuteDialog(dialogId: string)\n\t{\n\t\tthis.store.dispatch('dialogues/unmute', {dialogId});\n\t\tconst queryParams = {'DIALOG_ID': dialogId, 'ACTION': 'N'};\n\t\tthis.restClient.callMethod(RestMethod.imChatMute, queryParams).catch(error => {\n\t\t\tconsole.error('Im.RecentList: error unmuting chat', error);\n\t\t\tthis.store.dispatch('dialogues/mute', {dialogId});\n\t\t});\n\t}\n}","import {ajax as Ajax, Loc} from 'main.core';\n\nconst resendAction = 'intranet.controller.invite.reinvite';\nconst cancelAction = 'intranet.controller.invite.deleteinvitation';\n\nexport const InviteManager = {\n\tresendInvite(userId: number)\n\t{\n\t\tconst data = {\n\t\t\tparams: {userId}\n\t\t};\n\t\tAjax.runAction(resendAction, {data}).then(() => {\n\t\t\tthis.showNotification(Loc.getMessage('IM_RECENT_CONTEXT_MENU_INVITE_RESEND_DONE'), 2000);\n\t\t}, (error) => {\n\t\t\tthis.handleActionError(error);\n\t\t});\n\t},\n\n\tcancelInvite(userId: number)\n\t{\n\t\tconst data = {\n\t\t\tparams: {userId}\n\t\t};\n\t\tAjax.runAction(cancelAction, {data}).then(() => {\n\t\t\tthis.showNotification(Loc.getMessage('IM_RECENT_CONTEXT_MENU_INVITE_CANCEL_DONE'), 2000);\n\t\t}, (error) => {\n\t\t\tthis.handleActionError(error);\n\t\t});\n\t},\n\n\tshowNotification(text: string, autoHideDelay: number = 4000)\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: text,\n\t\t\tautoHideDelay\n\t\t});\n\t},\n\n\thandleActionError(error: Object)\n\t{\n\t\tif (error.status === 'error' && error.errors.length > 0)\n\t\t{\n\t\t\tconst errorContent = error.errors.map((element) => {\n\t\t\t\treturn element.message;\n\t\t\t}).join('. ');\n\t\t\tthis.showNotification(errorContent);\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.showNotification(Loc.getMessage('IM_RECENT_CONNECT_ERROR'));\n\t}\n};","export class CallHelper\n{\n\tstore: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t}\n\n\tcheckCallSupport(dialogId: string): boolean\n\t{\n\t\tif (!BX.MessengerProxy.getPushServerStatus() || !BX.Call.Util.isWebRTCSupported())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst userId = Number.parseInt(dialogId, 10);\n\n\t\treturn userId > 0 ? this.checkUserCallSupport(userId) : this.checkChatCallSupport(dialogId);\n\t}\n\n\tcheckUserCallSupport(userId: number): boolean\n\t{\n\t\tconst user = this.store.getters['users/get'](userId);\n\t\treturn (\n\t\t\tuser\n\t\t\t&& user.status !== 'guest'\n\t\t\t&& !user.bot\n\t\t\t&& !user.network\n\t\t\t&& user.id !== this.getCurrentUserId()\n\t\t\t&& !!user.lastActivityDate\n\t\t);\n\t}\n\n\tcheckChatCallSupport(dialogId: string): boolean\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst {userCounter} = dialog;\n\n\t\treturn userCounter > 1 && userCounter <= BX.Call.Util.getUserLimit();\n\t}\n\n\thasActiveCall(): boolean\n\t{\n\t\treturn BX.MessengerProxy.getCallController().hasActiveCall();\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.store.state.application.common.userId;\n\t}\n}","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\n\nimport {DialogType, EventType, OpenTarget, ChatOption} from 'im.v2.const';\n\nimport {BaseMenu} from '../base/base';\nimport {PinManager} from './pin-manager';\nimport {UnreadManager} from './unread-manager';\nimport {MuteManager} from './mute-manager';\nimport {InviteManager} from './invite-manager';\nimport {CallHelper} from './call-helper';\n\nexport class RecentMenu extends BaseMenu\n{\n\tpinManager: Object = null;\n\tunreadManager: Object = null;\n\tmuteManager: Object = null;\n\tcallHelper: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tsuper($Bitrix);\n\n\t\tthis.id = 'im-recent-context-menu';\n\t\tthis.pinManager = new PinManager($Bitrix);\n\t\tthis.unreadManager = new UnreadManager($Bitrix);\n\t\tthis.muteManager = new MuteManager($Bitrix);\n\t\tthis.callHelper = new CallHelper($Bitrix);\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 32\n\t\t};\n\t}\n\n\tgetMenuClassName(): String\n\t{\n\t\treturn this.context.compactMode ? '' : super.getMenuClassName();\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\tif (this.context.invitation.isActive)\n\t\t{\n\t\t\treturn this.getInviteItems();\n\t\t}\n\n\t\treturn [\n\t\t\tthis.getSendMessageItem(),\n\t\t\tthis.getUnreadMessageItem(),\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getMuteItem(),\n\t\t\tthis.getCallItem(),\n\t\t\tthis.getHistoryItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem()\n\t\t];\n\t}\n\n\tgetSendMessageItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_WRITE'),\n\t\t\tonclick: function() {\n\t\t\t\tconst target = this.context.target === OpenTarget.current? OpenTarget.current: OpenTarget.auto;\n\n\t\t\t\tEventEmitter.emit(EventType.dialog.open, {\n\t\t\t\t\t...this.context,\n\t\t\t\t\tchat: this.store.getters['dialogues/get'](this.context.dialogId, true),\n\t\t\t\t\tuser: this.store.getters['users/get'](this.context.dialogId, true),\n\t\t\t\t\ttarget\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetUnreadMessageItem(): Object\n\t{\n\t\tlet isUnreaded = this.context.unread;\n\t\tif (!isUnreaded)\n\t\t{\n\t\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId, true);\n\t\t\tisUnreaded = dialog.counter > 0;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: isUnreaded ? Loc.getMessage('IM_RECENT_CONTEXT_MENU_READ') : Loc.getMessage('IM_RECENT_CONTEXT_MENU_UNREAD'),\n\t\t\tonclick: function() {\n\t\t\t\tif (isUnreaded)\n\t\t\t\t{\n\t\t\t\t\tthis.unreadManager.readDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unreadManager.unreadDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetPinMessageItem(): Object\n\t{\n\t\tconst isPinned = this.context.pinned;\n\n\t\treturn {\n\t\t\ttext: isPinned ? Loc.getMessage('IM_RECENT_CONTEXT_MENU_UNPIN') : Loc.getMessage('IM_RECENT_CONTEXT_MENU_PIN'),\n\t\t\tonclick: function() {\n\t\t\t\tif (isPinned)\n\t\t\t\t{\n\t\t\t\t\tthis.pinManager.unpinDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.pinManager.pinDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetMuteItem(): ?Object\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId);\n\t\tconst isUser = dialog.type === DialogType.user;\n\t\tconst isAnnouncement = dialog.type === DialogType.announcement;\n\t\tif (!dialog || isUser || isAnnouncement)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst muteAllowed = this.store.getters['dialogues/getChatOption'](dialog.type, ChatOption.mute);\n\t\tif (!muteAllowed)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isMuted = dialog.muteList.includes(this.getCurrentUserId());\n\t\treturn {\n\t\t\ttext: isMuted? Loc.getMessage('IM_RECENT_CONTEXT_MENU_UNMUTE') : Loc.getMessage('IM_RECENT_CONTEXT_MENU_MUTE'),\n\t\t\tonclick: function() {\n\t\t\t\tif (isMuted)\n\t\t\t\t{\n\t\t\t\t\tthis.muteManager.unmuteDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.muteManager.muteDialog(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetCallItem(): ?Object\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId);\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isChat = dialog.type !== DialogType.user;\n\t\tconst callAllowed = this.store.getters['dialogues/getChatOption'](dialog.type, ChatOption.call);\n\t\tif (isChat && !callAllowed)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst callSupport = this.callHelper.checkCallSupport(this.context.dialogId);\n\t\tconst isAnnouncement = dialog.type === DialogType.announcement;\n\t\tconst isExternalTelephonyCall = dialog.type === DialogType.call;\n\t\tconst hasActiveCall = this.callHelper.hasActiveCall();\n\t\tif (!callSupport || isAnnouncement || isExternalTelephonyCall || hasActiveCall)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_CALL'),\n\t\t\tonclick: function() {\n\t\t\t\tEventEmitter.emit(EventType.dialog.call, this.context);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetHistoryItem(): ?Object\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId, true);\n\t\tconst isUser = dialog.type === DialogType.user;\n\t\tif (isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_HISTORY'),\n\t\t\tonclick: function() {\n\t\t\t\tconst target = this.context.target === OpenTarget.current? OpenTarget.current: OpenTarget.auto;\n\n\t\t\t\tEventEmitter.emit(EventType.dialog.openHistory, {\n\t\t\t\t\t...this.context,\n\t\t\t\t\tchat: this.store.getters['dialogues/get'](this.context.dialogId, true),\n\t\t\t\t\tuser: this.store.getters['users/get'](this.context.dialogId, true),\n\t\t\t\t\ttarget\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetOpenProfileItem(): ?Object\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId, true);\n\t\tconst isUser = dialog.type === DialogType.user;\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = `/company/personal/user/${this.context.dialogId}/`;\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_PROFILE'),\n\t\t\thref: profileUri,\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetHideItem(): ?Object\n\t{\n\t\tif (this.context.invitation.isActive || this.context.options.default_user_record)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_HIDE'),\n\t\t\tonclick: function() {\n\t\t\t\tEventEmitter.emit(EventType.dialog.hide, {\n\t\t\t\t\t...this.context,\n\t\t\t\t\tchat: this.store.getters['dialogues/get'](this.context.dialogId, true),\n\t\t\t\t\tuser: this.store.getters['users/get'](this.context.dialogId, true)\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetLeaveItem(): ?Object\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId);\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isUser = dialog.type === DialogType.user;\n\t\tif (isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet optionToCheck = ChatOption.leave;\n\t\tif (dialog.owner === this.getCurrentUserId())\n\t\t{\n\t\t\toptionToCheck = ChatOption.leaveOwner;\n\t\t}\n\t\tconst leaveAllowed = this.store.getters['dialogues/getChatOption'](dialog.type, optionToCheck);\n\n\t\tconst isExternalTelephonyCall = dialog.type === DialogType.call;\n\t\tif (isExternalTelephonyCall || !leaveAllowed)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_LEAVE'),\n\t\t\tonclick: function() {\n\t\t\t\tEventEmitter.emit(EventType.dialog.leave, {\n\t\t\t\t\t...this.context,\n\t\t\t\t\tchat: this.store.getters['dialogues/get'](this.context.dialogId, true),\n\t\t\t\t\tuser: this.store.getters['users/get'](this.context.dialogId, true)\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\t// invitation\n\tgetInviteItems(): Array\n\t{\n\t\tconst items = [\n\t\t\tthis.getSendMessageItem(),\n\t\t\tthis.getOpenProfileItem()\n\t\t];\n\n\t\tconst canManageInvite = BX.MessengerProxy.canInvite() && this.getCurrentUserId() === this.context.invitation.originator;\n\t\tif (canManageInvite)\n\t\t{\n\t\t\titems.push(\n\t\t\t\tthis.getDelimiter(),\n\t\t\t\tthis.context.invitation.canResend? this.getResendInviteItem(): null,\n\t\t\t\tthis.getCancelInviteItem()\n\t\t\t);\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tgetResendInviteItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_INVITE_RESEND'),\n\t\t\tonclick: function() {\n\t\t\t\tInviteManager.resendInvite(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetCancelInviteItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_RECENT_CONTEXT_MENU_INVITE_CANCEL'),\n\t\t\tonclick: function() {\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: Loc.getMessage('IM_RECENT_CONTEXT_MENU_INVITE_CANCEL_CONFIRM'),\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\t\tonOk: (messageBox) => {\n\t\t\t\t\t\tInviteManager.cancelInvite(this.context.dialogId);\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tonCancel: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\t// invitation end\n\n\tgetDelimiter(): Object\n\t{\n\t\treturn {delimiter: true};\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.store.state.application.common.userId;\n\t}\n}"],"names":["BaseMenu","constructor","$Bitrix","menuInstance","context","target","store","restClient","id","Data","get","RestClient","onClosePopupHandler","onClosePopup","bind","EventEmitter","subscribe","EventType","dialog","closePopup","openMenu","destroy","getMenuInstance","show","MenuManager","create","getMenuOptions","bindOptions","forceBindPosition","position","targetContainer","document","body","bindElement","cacheable","className","getMenuClassName","items","getMenuItems","isDarkMode","state","application","options","darkTheme","close","unsubscribe","PinManager","pinDialog","dialogId","dispatch","action","queryParams","callMethod","RestMethod","imRecentPin","catch","error","console","unpinDialog","UnreadManager","readDialog","getters","counter","imDialogRead","imRecentUnread","unreadDialog","MuteManager","muteDialog","imChatMute","unmuteDialog","resendAction","cancelAction","InviteManager","resendInvite","userId","data","params","Ajax","runAction","then","showNotification","Loc","getMessage","handleActionError","cancelInvite","text","autoHideDelay","BX","UI","Notification","Center","notify","content","status","errors","length","errorContent","map","element","message","join","CallHelper","checkCallSupport","MessengerProxy","getPushServerStatus","Call","Util","isWebRTCSupported","Number","parseInt","checkUserCallSupport","checkChatCallSupport","user","bot","network","getCurrentUserId","lastActivityDate","userCounter","getUserLimit","hasActiveCall","getCallController","common","RecentMenu","pinManager","unreadManager","muteManager","callHelper","angle","offsetLeft","compactMode","invitation","isActive","getInviteItems","getSendMessageItem","getUnreadMessageItem","getPinMessageItem","getMuteItem","getCallItem","getHistoryItem","getOpenProfileItem","getHideItem","getLeaveItem","onclick","OpenTarget","current","auto","emit","open","chat","isUnreaded","unread","isPinned","pinned","isUser","type","DialogType","isAnnouncement","announcement","muteAllowed","ChatOption","mute","isMuted","muteList","includes","isChat","callAllowed","call","callSupport","isExternalTelephonyCall","openHistory","profileUri","href","default_user_record","hide","optionToCheck","leave","owner","leaveOwner","leaveAllowed","canManageInvite","canInvite","originator","push","getDelimiter","canResend","getResendInviteItem","getCancelInviteItem","MessageBox","modal","buttons","MessageBoxButtons","OK_CANCEL","onOk","messageBox","onCancel","delimiter"],"mappings":"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"}