{"version":3,"file":"promo.bundle.js","sources":["../src/classes/promo-service.js","../src/promo.js"],"sourcesContent":["import { Core } from 'im.v2.application.core';\nimport { PromoId, RestMethod } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\n\nexport class PromoService\n{\n\tstatic markAsWatched(promoId: $Values<typeof PromoId>): Promise\n\t{\n\t\tLogger.warn('PromoService: markAsWatched:', promoId);\n\n\t\treturn Core.getRestClient().callMethod(RestMethod.imPromotionRead, {\n\t\t\tid: promoId,\n\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('PromoService: markAsWatched error:', error);\n\t\t\t});\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { Logger } from 'im.v2.lib.logger';\nimport { PromoId } from 'im.v2.const';\n\nimport { PromoService } from './classes/promo-service';\n\nexport class PromoManager\n{\n\tstatic #instance: PromoManager;\n\n\t#promoList: Set<string>;\n\n\tstatic getInstance(): PromoManager\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new this();\n\t\t}\n\n\t\treturn this.#instance;\n\t}\n\n\tstatic init()\n\t{\n\t\tPromoManager.getInstance();\n\t}\n\n\tconstructor()\n\t{\n\t\tconst { promoList } = Core.getApplicationData();\n\t\tLogger.warn('PromoManager: promoList', promoList);\n\t\tthis.#init(promoList);\n\t}\n\n\tneedToShow(promoId: $Values<typeof PromoId>): boolean\n\t{\n\t\treturn this.#promoList.has(promoId);\n\t}\n\n\tasync markAsWatched(promoId: $Values<typeof PromoId>)\n\t{\n\t\tif (!this.#promoList.has(promoId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tawait PromoService.markAsWatched(promoId);\n\t\tthis.#promoList.delete(promoId);\n\t}\n\n\t#init(rawPromoList: string[])\n\t{\n\t\tthis.#promoList = new Set(rawPromoList);\n\t}\n}\n"],"names":["PromoService","markAsWatched","promoId","Logger","warn","Core","getRestClient","callMethod","RestMethod","imPromotionRead","id","catch","error","console","PromoManager","getInstance","init","constructor","promoList","getApplicationData","needToShow","has","delete","rawPromoList","Set"],"mappings":";;;;;;;CAIO,MAAMA,YAAY,CACzB;GACC,OAAOC,aAAa,CAACC,OAAgC,EACrD;KACCC,uBAAM,CAACC,IAAI,CAAC,8BAA8B,EAAEF,OAAO,CAAC;KAEpD,OAAOG,2BAAI,CAACC,aAAa,EAAE,CAACC,UAAU,CAACC,sBAAU,CAACC,eAAe,EAAE;OAClEC,EAAE,EAAER;MACJ,CAAC,CACAS,KAAK,CAAEC,KAAK,IAAK;OACjBC,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;MAC1D,CAAC;;CAEL;;CCbuD;CAAA;CAAA;AAEvD,CAAO,MAAME,YAAY,CACzB;GAKC,OAAOC,WAAW,GAClB;KACC,IAAI,yCAAC,IAAI,uBAAU,EACnB;OACC,4CAAI,0BAAa,IAAI,IAAI,EAAE;;KAG5B,+CAAO,IAAI;;GAGZ,OAAOC,IAAI,GACX;KACCF,YAAY,CAACC,WAAW,EAAE;;GAG3BE,WAAW,GACX;KAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,MAAM;OAAEC;MAAW,GAAGb,2BAAI,CAACc,kBAAkB,EAAE;KAC/ChB,uBAAM,CAACC,IAAI,CAAC,yBAAyB,EAAEc,SAAS,CAAC;KACjD,4CAAI,gBAAOA,SAAS;;GAGrBE,UAAU,CAAClB,OAAgC,EAC3C;KACC,OAAO,4CAAI,0BAAYmB,GAAG,CAACnB,OAAO,CAAC;;GAGpC,MAAMD,aAAa,CAACC,OAAgC,EACpD;KACC,IAAI,CAAC,4CAAI,0BAAYmB,GAAG,CAACnB,OAAO,CAAC,EACjC;OACC;;KAGD,MAAMF,YAAY,CAACC,aAAa,CAACC,OAAO,CAAC;KACzC,4CAAI,0BAAYoB,MAAM,CAACpB,OAAO,CAAC;;CAOjC;CAAC,gBAJMqB,YAAsB,EAC5B;GACC,4CAAI,4BAAc,IAAIC,GAAG,CAACD,YAAY,CAAC;CACxC;CAAC,sBA/CWT,YAAY;GAAA;GAAA;CAAA;;;;;;;;"}