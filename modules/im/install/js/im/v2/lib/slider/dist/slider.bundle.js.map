{"version":3,"file":"slider.bundle.js","sources":["../src/slider.js"],"sourcesContent":["import { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { Event, ZIndexManager, Runtime, Extension } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Core } from 'im.v2.application.core';\nimport { EventType, Layout, GetParameter } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { Launch } from 'im.v2.application.launch';\nimport { CallManager } from 'im.v2.lib.call';\nimport { PhoneManager } from 'im.v2.lib.phone';\nimport { Utils } from 'im.v2.lib.utils';\nimport { DesktopManager } from 'im.v2.lib.desktop';\nimport { LayoutManager } from 'im.v2.lib.layout';\nimport { LinesService } from 'im.v2.provider.service';\n\nimport 'ui.notification';\n\nimport type { Store } from 'ui.vue3.vuex';\n\nconst SLIDER_PREFIX = 'im:slider';\nconst BASE_STACK_INDEX = 1200;\nconst SLIDER_CONTAINER_CLASS = 'bx-im-messenger__slider';\nconst LOADER_CHATS_PATH = '/bitrix/js/im/v2/lib/slider/src/images/loader-chats.svg?v2';\n\nexport class MessengerSlider\n{\n\tstatic instance = null;\n\n\tinstances: Object = {};\n\tsidePanelManager: Object = BX.SidePanel.Instance;\n\tv2enabled: boolean = false;\n\tstore: Store;\n\n\tstatic init()\n\t{\n\t\tif (this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.instance = new this();\n\t}\n\n\tstatic getInstance(): MessengerSlider\n\t{\n\t\tthis.init();\n\n\t\treturn this.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tLogger.warn('Slider: class created');\n\t\tthis.initSettings();\n\t\tthis.bindEvents();\n\t\tthis.store = Core.getStore();\n\t}\n\n\tasync openChat(dialogId: string | number = ''): Promise\n\t{\n\t\tconst preparedDialogId = dialogId.toString();\n\t\tif (Utils.dialog.isLinesExternalId(preparedDialogId))\n\t\t{\n\t\t\treturn this.openLines(preparedDialogId);\n\t\t}\n\n\t\tawait this.openSlider();\n\n\t\tawait LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.chat.name,\n\t\t\tentityId: preparedDialogId,\n\t\t});\n\t\tEventEmitter.emit(EventType.layout.onOpenChat, { dialogId: preparedDialogId });\n\n\t\treturn Promise.resolve();\n\t}\n\n\tasync openLines(dialogId: string = ''): Promise\n\t{\n\t\tlet preparedDialogId = dialogId.toString();\n\t\tif (Utils.dialog.isLinesExternalId(preparedDialogId))\n\t\t{\n\t\t\tconst linesService = new LinesService();\n\t\t\tpreparedDialogId = await linesService.getDialogIdByUserCode(preparedDialogId);\n\t\t}\n\n\t\tawait this.openSlider();\n\n\t\treturn LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.openlines.name,\n\t\t\tentityId: preparedDialogId,\n\t\t});\n\t}\n\n\tasync openCopilot(dialogId: string = ''): Promise\n\t{\n\t\tconst preparedDialogId = dialogId.toString();\n\t\tawait this.openSlider();\n\n\t\treturn LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.copilot.name,\n\t\t\tentityId: preparedDialogId,\n\t\t});\n\t}\n\n\topenHistory(dialogId: string | number = ''): Promise\n\t{\n\t\tif (Utils.dialog.isDialogId(dialogId))\n\t\t{\n\t\t\treturn this.openChat(dialogId);\n\t\t}\n\n\t\tif (!this.#checkHistoryDialogId(dialogId))\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\tconst sliderLink = this.#prepareHistorySliderLink(dialogId);\n\t\tBX.SidePanel.Instance.open(sliderLink, {\n\t\t\twidth: Utils.dialog.isLinesExternalId(dialogId) ? 700 : 1000,\n\t\t\tallowChangeHistory: false,\n\t\t\tallowChangeTitle: false,\n\t\t\tcacheable: false,\n\t\t});\n\n\t\treturn Promise.resolve();\n\t}\n\n\tasync openNotifications(): Promise\n\t{\n\t\tawait this.openSlider();\n\t\tawait LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.notification.name,\n\t\t});\n\n\t\tEventEmitter.emit(EventType.layout.onOpenNotifications);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tasync openRecentSearch(): Promise\n\t{\n\t\tawait this.openSlider();\n\t\tawait LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.chat.name,\n\t\t});\n\n\t\tEventEmitter.emit(EventType.recent.openSearch);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tasync openSettings(sectionName: string): Promise\n\t{\n\t\tLogger.warn('Slider: openSettings', sectionName);\n\t\tawait this.openSlider();\n\n\t\tawait LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.settings.name,\n\t\t\tentityId: sectionName,\n\t\t});\n\n\t\treturn Promise.resolve();\n\t}\n\n\topenConference(code: string = ''): Promise\n\t{\n\t\tLogger.warn('Slider: openConference', code);\n\n\t\tif (!Utils.conference.isValidCode(code))\n\t\t{\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\treject();\n\t\t\t});\n\t\t}\n\n\t\tconst url = Utils.conference.getUrlByCode(code);\n\t\tUtils.browser.openLink(url, Utils.conference.getWindowNameByCode(code));\n\n\t\treturn new Promise((resolve) => {\n\t\t\tresolve();\n\t\t});\n\t}\n\n\tstartVideoCall(dialogId: string = '', withVideo: boolean = true): Promise\n\t{\n\t\tLogger.warn('Slider: onStartVideoCall', dialogId, withVideo);\n\t\tif (!Utils.dialog.isDialogId(dialogId))\n\t\t{\n\t\t\tLogger.error('Slider: onStartVideoCall - dialogId is not correct', dialogId);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tCallManager.getInstance().startCall(dialogId, withVideo);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tstartPhoneCall(number: string, params: Object<any, string>): Promise\n\t{\n\t\tLogger.warn('Slider: startPhoneCall', number, params);\n\t\tvoid PhoneManager.getInstance().startCall(number, params);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tstartCallList(callListId: number, params: Object<string, any>): Promise\n\t{\n\t\tLogger.warn('Slider: startCallList', callListId, params);\n\t\tPhoneManager.getInstance().startCallList(callListId, params);\n\n\t\treturn Promise.resolve();\n\t}\n\n\topenNewTab(path)\n\t{\n\t\tif (DesktopApi.getApiVersion() >= 75 && DesktopApi.isChatTab())\n\t\t{\n\t\t\tDesktopApi.createImTab(`${path}&${GetParameter.desktopChatTabMode}=Y`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tUtils.browser.openLink(path);\n\t\t}\n\t}\n\n\tbindEvents(): boolean\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\tLogger.warn('Slider: v2 is not enabled');\n\n\t\t\treturn false;\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseByEsc', this.onCloseByEsc.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', this.onClose.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onDestroy', this.onDestroy.bind(this));\n\n\t\tEvent.ready(this.initZIndex.bind(this));\n\n\t\treturn true;\n\t}\n\n\tinitSettings()\n\t{\n\t\tconst settings = Extension.getSettings('im.v2.lib.slider');\n\t\tthis.v2enabled = settings.get('v2enabled', false);\n\t}\n\n\topenSlider(): Promise\n\t{\n\t\tif (DesktopManager.isChatWindow())\n\t\t{\n\t\t\tthis.sidePanelManager.closeAll(true);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tif (this.isOpened())\n\t\t{\n\t\t\tZIndexManager.bringToFront(this.getCurrent().getOverlay());\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tvoid this.launchMessengerApplication();\n\n\t\treturn new Promise((resolve) => {\n\t\t\tif (this.isFocused())\n\t\t\t{\n\t\t\t\tresolve();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst nextId = this.getNextId();\n\n\t\t\tthis.sidePanelManager.open(`${SLIDER_PREFIX}:${nextId}`, {\n\t\t\t\tdata: { rightBoundary: 0 },\n\t\t\t\tcacheable: false,\n\t\t\t\tanimationDuration: 100,\n\t\t\t\thideControls: true,\n\t\t\t\tcustomLeftBoundary: 0,\n\t\t\t\tcustomRightBoundary: 0,\n\t\t\t\tloader: LOADER_CHATS_PATH,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn `<div class=\"${SLIDER_CONTAINER_CLASS}\"></div>`;\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: (event) => {\n\t\t\t\t\t\tevent.slider.showLoader();\n\t\t\t\t\t},\n\t\t\t\t\tonOpenComplete: async (event) => {\n\t\t\t\t\t\tawait this.initMessengerComponent();\n\t\t\t\t\t\tevent.slider.closeLoader();\n\n\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.instances[nextId] = this.sidePanelManager.getSlider(`${SLIDER_PREFIX}:${nextId}`);\n\t\t});\n\t}\n\n\tlaunchMessengerApplication(): Promise\n\t{\n\t\tif (this.applicationPromise)\n\t\t{\n\t\t\treturn this.applicationPromise;\n\t\t}\n\n\t\tthis.applicationPromise = Runtime.loadExtension('im.v2.application.messenger').then(() => {\n\t\t\treturn Launch('messenger');\n\t\t}).then((application) => {\n\t\t\tLogger.warn('Slider: Messenger application launched', application);\n\n\t\t\treturn application;\n\t\t});\n\n\t\treturn this.applicationPromise;\n\t}\n\n\tasync initMessengerComponent(): Promise\n\t{\n\t\tconst application = await this.applicationPromise;\n\n\t\treturn application.initComponent(`.${SLIDER_CONTAINER_CLASS}`);\n\t}\n\n\tonDialogOpen(event)\n\t{\n\t\tLogger.warn('Slider: onDialogOpen', event.data.dialogId);\n\t}\n\n\tonClose({ data: event })\n\t{\n\t\t[event] = event;\n\t\tconst sliderId = event.getSlider().getUrl().toString();\n\t\tif (!sliderId.startsWith(SLIDER_PREFIX))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.canClose())\n\t\t{\n\t\t\tevent.denyAction();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// TODO: emit event to close all popups\n\n\t\tconst id = this.getIdFromSliderId(sliderId);\n\t\tdelete this.instances[id];\n\n\t\tEventEmitter.emit(EventType.slider.onClose);\n\n\t\tLayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.chat.name,\n\t\t});\n\t}\n\n\tonCloseByEsc({ data: event })\n\t{\n\t\t[event] = event;\n\t\tconst sliderId = event.getSlider().getUrl().toString();\n\t\tif (!sliderId.startsWith(SLIDER_PREFIX))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.canCloseByEsc())\n\t\t{\n\t\t\tevent.denyAction();\n\t\t}\n\t}\n\n\tonDestroy({ data: event })\n\t{\n\t\t[event] = event;\n\t\tconst sliderId = event.getSlider().getUrl().toString();\n\t\tif (!sliderId.startsWith(SLIDER_PREFIX))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = this.getIdFromSliderId(sliderId);\n\t\tdelete this.instances[id];\n\t}\n\n\tinitZIndex()\n\t{\n\t\tif (!ZIndexManager)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\tstack.baseIndex = BASE_STACK_INDEX;\n\t\tstack.sort();\n\t}\n\n\tgetZIndex(): number\n\t{\n\t\treturn BASE_STACK_INDEX;\n\t}\n\n\tisOpened(): boolean\n\t{\n\t\treturn Object.keys(this.instances).length > 0;\n\t}\n\n\tisFocused(): boolean\n\t{\n\t\tif (!this.isOpened())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst slider = this.sidePanelManager.getTopSlider();\n\t\tif (!slider)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn slider.getUrl().toString().startsWith(SLIDER_PREFIX);\n\t}\n\n\tcanClose(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tcanCloseByEsc(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tgetCurrent(): Object\n\t{\n\t\treturn this.instances[this.getCurrentId()];\n\t}\n\n\tgetCurrentId(): number\n\t{\n\t\treturn Object.keys(this.instances).length;\n\t}\n\n\tgetNextId(): number\n\t{\n\t\treturn this.getCurrentId() + 1;\n\t}\n\n\tgetIdFromSliderId(sliderId: string): number\n\t{\n\t\treturn Number.parseInt(sliderId.slice(SLIDER_PREFIX.length + 1), 10);\n\t}\n\n\t#checkHistoryDialogId(dialogId: string): boolean\n\t{\n\t\treturn (\n\t\t\tUtils.dialog.isLinesHistoryId(dialogId)\n\t\t\t|| Utils.dialog.isLinesExternalId(dialogId)\n\t\t);\n\t}\n\n\t#prepareHistorySliderLink(dialogId: string): string\n\t{\n\t\tconst getParams = new URLSearchParams({\n\t\t\t[GetParameter.openHistory]: dialogId,\n\t\t\t[GetParameter.backgroundType]: 'light',\n\t\t});\n\n\t\treturn `/desktop_app/history.php?${getParams.toString()}`;\n\t}\n}\n"],"names":["SLIDER_PREFIX","BASE_STACK_INDEX","SLIDER_CONTAINER_CLASS","LOADER_CHATS_PATH","MessengerSlider","init","instance","getInstance","constructor","instances","sidePanelManager","BX","SidePanel","Instance","v2enabled","Logger","warn","initSettings","bindEvents","store","Core","getStore","openChat","dialogId","preparedDialogId","toString","Utils","dialog","isLinesExternalId","openLines","openSlider","LayoutManager","setLayout","name","Layout","chat","entityId","EventEmitter","emit","EventType","layout","onOpenChat","Promise","resolve","linesService","LinesService","getDialogIdByUserCode","openlines","openCopilot","copilot","openHistory","isDialogId","reject","sliderLink","open","width","allowChangeHistory","allowChangeTitle","cacheable","openNotifications","notification","onOpenNotifications","openRecentSearch","recent","openSearch","openSettings","sectionName","settings","openConference","code","conference","isValidCode","url","getUrlByCode","browser","openLink","getWindowNameByCode","startVideoCall","withVideo","error","CallManager","startCall","startPhoneCall","number","params","PhoneManager","startCallList","callListId","openNewTab","path","DesktopApi","getApiVersion","isChatTab","createImTab","GetParameter","desktopChatTabMode","subscribe","onCloseByEsc","bind","onClose","onDestroy","Event","ready","initZIndex","Extension","getSettings","get","DesktopManager","isChatWindow","closeAll","isOpened","ZIndexManager","bringToFront","getCurrent","getOverlay","launchMessengerApplication","isFocused","nextId","getNextId","data","rightBoundary","animationDuration","hideControls","customLeftBoundary","customRightBoundary","loader","contentCallback","events","onLoad","event","slider","showLoader","onOpenComplete","initMessengerComponent","closeLoader","getSlider","applicationPromise","Runtime","loadExtension","then","Launch","application","initComponent","onDialogOpen","sliderId","getUrl","startsWith","canClose","denyAction","id","getIdFromSliderId","canCloseByEsc","stack","getOrAddStack","document","body","baseIndex","sort","getZIndex","Object","keys","length","getTopSlider","getCurrentId","Number","parseInt","slice","isLinesHistoryId","getParams","URLSearchParams","backgroundType"],"mappings":"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"}