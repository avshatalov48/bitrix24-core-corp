{"version":3,"file":"slider.bundle.js","sources":["../src/slider.js"],"sourcesContent":["import {Event, ZIndexManager, Runtime, Extension, Loc, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {EventType, Layout} from 'im.v2.const';\nimport {Logger} from 'im.v2.lib.logger';\nimport {Launch} from 'im.v2.application.launch';\nimport {CallManager} from 'im.v2.lib.call';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport 'ui.notification';\n\nconst SLIDER_PREFIX = 'im:slider';\nconst BASE_STACK_INDEX = 1200;\nconst SLIDER_CONTAINER_CLASS = 'bx-im-messenger__slider';\nconst LOADER_CHATS_PATH = '/bitrix/js/im/v2/lib/slider/src/images/loader-chats.svg?v2';\nconst LOADER_NOTIFICATIONS_PATH = '/bitrix/js/im/v2/lib/slider/src/images/loader-notifications.svg';\n\nexport class MessengerSlider\n{\n\tstatic instance = null;\n\n\tinstances: Object = {};\n\tsidePanelManager: Object = BX.SidePanel.Instance;\n\tv2enabled: boolean = false;\n\n\tstatic init()\n\t{\n\t\tif (this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.instance = new this();\n\t}\n\n\tstatic getInstance(): MessengerSlider\n\t{\n\t\tthis.init();\n\n\t\treturn this.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tLogger.warn('Slider: class created');\n\t\tthis.initSettings();\n\t\tthis.bindEvents();\n\t}\n\n\topenChat(dialogId: string | number = '', text: string = ''): Promise\n\t{\n\t\tif (Type.isNumber(dialogId))\n\t\t{\n\t\t\tdialogId = dialogId.toString();\n\t\t}\n\n\t\treturn this.openSlider().then(() => {\n\t\t\tthis.store.dispatch('application/setLayout', {\n\t\t\t\tlayoutName: Layout.chat.name,\n\t\t\t\tentityId: dialogId\n\t\t\t}).then(() => {\n\t\t\t\tEventEmitter.emit(EventType.layout.onOpenChat, {dialogId});\n\t\t\t});\n\t\t});\n\t}\n\n\topenLines(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('IM_LIB_SLIDER_LINES_NOT_IMPLEMENTED'),\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tautoHideDelay: 10000,\n\t\t\t});\n\t\t\treject('Messenger: lines is not implemented yet');\n\t\t});\n\t}\n\n\topenNotifications(): Promise\n\t{\n\t\treturn this.openSlider().then(() => {\n\t\t\tthis.store.dispatch('application/setLayout', {\n\t\t\t\tlayoutName: Layout.notification.name\n\t\t\t}).then(() => {\n\t\t\t\tEventEmitter.emit(EventType.layout.onOpenNotifications);\n\t\t\t});\n\t\t});\n\t}\n\n\topenRecentSearch(): Promise\n\t{\n\t\treturn this.openSlider().then(() => {\n\t\t\tthis.store.dispatch('application/setLayout', {\n\t\t\t\tlayoutName: Layout.chat.name\n\t\t\t});\n\t\t}).then(() => {\n\t\t\tEventEmitter.emit(EventType.recent.openSearch);\n\t\t});\n\t}\n\n\topenSettings(selected: ?string = '', section: ?string = ''): Promise\n\t{\n\t\tLogger.warn('Slider: onOpenSettings', selected, section);\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('IM_LIB_SLIDER_SETTINGS_NOT_IMPLEMENTED'),\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tautoHideDelay: 10000,\n\t\t\t});\n\t\t\treject('Messenger: settings is not implemented yet');\n\t\t});\n\t}\n\n\tstartVideoCall(dialogId: string = '', withVideo: boolean = true): Promise\n\t{\n\t\tLogger.warn('Slider: onStartVideoCall', dialogId, withVideo);\n\t\tif (!Utils.dialog.isDialogId(dialogId))\n\t\t{\n\t\t\tLogger.error('Slider: onStartVideoCall - dialogId is not correct', dialogId);\n\t\t\treturn false;\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tCallManager.getInstance().startCall(dialogId, withVideo);\n\t\t\tresolve();\n\t\t});\n\t}\n\n\tbindEvents(): boolean\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\tLogger.warn('Slider: v2 is not enabled');\n\t\t\treturn false;\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseByEsc', this.onCloseByEsc.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', this.onClose.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onDestroy', this.onDestroy.bind(this));\n\n\t\tEvent.ready(this.initZIndex.bind(this));\n\n\t\treturn true;\n\t}\n\n\tinitSettings()\n\t{\n\t\tconst settings = Extension.getSettings('im.v2.lib.slider');\n\t\tthis.v2enabled = settings.get('v2enabled', false);\n\t}\n\n\topenSlider(): Promise\n\t{\n\t\tthis.launchMessengerApplication();\n\n\t\treturn new Promise((resolve) => {\n\t\t\tif (this.isFocused())\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst nextId = this.getNextId();\n\n\t\t\tthis.sidePanelManager.open(`${SLIDER_PREFIX}:${nextId}`, {\n\t\t\t\tdata: {rightBoundary: 0},\n\t\t\t\tcacheable: false,\n\t\t\t\tanimationDuration: 100,\n\t\t\t\thideControls: true,\n\t\t\t\tcustomLeftBoundary: 0,\n\t\t\t\tcustomRightBoundary: 0,\n\t\t\t\tloader: LOADER_CHATS_PATH,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn `<div class=\"${SLIDER_CONTAINER_CLASS}\"></div>`;\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: (event) => {\n\t\t\t\t\t\tevent.slider.showLoader();\n\t\t\t\t\t},\n\t\t\t\t\tonOpenComplete: (event) => {\n\t\t\t\t\t\tthis.initMessengerComponent().then(() => {\n\t\t\t\t\t\t\tevent.slider.closeLoader();\n\t\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.instances[nextId] = this.sidePanelManager.getSlider(`${SLIDER_PREFIX}:${nextId}`);\n\t\t});\n\t}\n\n\tlaunchMessengerApplication(): Promise\n\t{\n\t\tif (this.applicationPromise)\n\t\t{\n\t\t\treturn this.applicationPromise;\n\t\t}\n\n\t\tthis.applicationPromise = Runtime.loadExtension('im.v2.application.messenger').then(() => {\n\t\t\treturn Launch('messenger');\n\t\t}).then((application) => {\n\t\t\tLogger.warn('Slider: Messenger application launched', application);\n\t\t\treturn application;\n\t\t});\n\n\t\treturn this.applicationPromise;\n\t}\n\n\tinitMessengerComponent(): Promise\n\t{\n\t\treturn this.applicationPromise.then((application) => {\n\t\t\tthis.application = application;\n\t\t\tthis.store = this.application.controller.store;\n\t\t\tthis.store.dispatch('application/setLayout', {layoutName: Layout.chat.name, entityId: ''});\n\n\t\t\treturn application.initComponent(`.${SLIDER_CONTAINER_CLASS}`);\n\t\t});\n\t}\n\n\tonDialogOpen(event)\n\t{\n\t\tLogger.warn('Slider: onDialogOpen', event.data.dialogId);\n\t}\n\n\tonClose({data: event})\n\t{\n\t\t[event] = event;\n\t\tconst sliderId = event.getSlider().getUrl().toString();\n\t\tif (!sliderId.startsWith(SLIDER_PREFIX))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.canClose())\n\t\t{\n\t\t\tevent.denyAction();\n\t\t\treturn;\n\t\t}\n\n\t\t// TODO: emit event to close all popups\n\n\t\tconst id = this.getIdFromSliderId(sliderId);\n\t\tdelete this.instances[id];\n\n\t\tthis.openChat();\n\t}\n\n\tonCloseByEsc({data: event})\n\t{\n\t\t[event] = event;\n\t\tconst sliderId = event.getSlider().getUrl().toString();\n\t\tif (!sliderId.startsWith(SLIDER_PREFIX))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.canCloseByEsc())\n\t\t{\n\t\t\tevent.denyAction();\n\t\t}\n\t}\n\n\tonDestroy({data: event})\n\t{\n\t\t[event] = event;\n\t\tconst sliderId = event.getSlider().getUrl().toString();\n\t\tif (!sliderId.startsWith(SLIDER_PREFIX))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst id = this.getIdFromSliderId(sliderId);\n\t\tdelete this.instances[id];\n\t}\n\n\tinitZIndex()\n\t{\n\t\tif (!ZIndexManager)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\tstack.baseIndex = BASE_STACK_INDEX;\n\t\tstack.sort();\n\t}\n\n\tgetZIndex(): number\n\t{\n\t\treturn BASE_STACK_INDEX;\n\t}\n\n\tisOpened(): boolean\n\t{\n\t\treturn Object.keys(this.instances).length > 0;\n\t}\n\n\tisFocused(): boolean\n\t{\n\t\tif (!this.isOpened())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst slider = this.sidePanelManager.getTopSlider();\n\t\tif (!slider)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !!slider.getUrl().toString().startsWith(SLIDER_PREFIX);\n\t}\n\n\tcanClose(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tcanCloseByEsc(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tgetCurrent(): Object\n\t{\n\t\treturn this.instances[this.getCurrentId()];\n\t}\n\n\tgetCurrentId(): number\n\t{\n\t\treturn Object.keys(this.instances).length;\n\t}\n\n\tgetNextId(): number\n\t{\n\t\treturn this.getCurrentId() + 1;\n\t}\n\n\tgetIdFromSliderId(sliderId: string): number\n\t{\n\t\treturn Number.parseInt(sliderId.slice(SLIDER_PREFIX.length + 1), 10);\n\t}\n}"],"names":["SLIDER_PREFIX","BASE_STACK_INDEX","SLIDER_CONTAINER_CLASS","LOADER_CHATS_PATH","MessengerSlider","init","instance","getInstance","constructor","instances","sidePanelManager","BX","SidePanel","Instance","v2enabled","Logger","warn","initSettings","bindEvents","openChat","dialogId","text","Type","isNumber","toString","openSlider","then","store","dispatch","layoutName","Layout","chat","name","entityId","EventEmitter","emit","EventType","layout","onOpenChat","openLines","Promise","resolve","reject","UI","Notification","Center","notify","content","Loc","getMessage","position","autoHideDelay","openNotifications","notification","onOpenNotifications","openRecentSearch","recent","openSearch","openSettings","selected","section","startVideoCall","withVideo","Utils","dialog","isDialogId","error","CallManager","startCall","subscribe","onCloseByEsc","bind","onClose","onDestroy","Event","ready","initZIndex","settings","Extension","getSettings","get","launchMessengerApplication","isFocused","nextId","getNextId","open","data","rightBoundary","cacheable","animationDuration","hideControls","customLeftBoundary","customRightBoundary","loader","contentCallback","events","onLoad","event","slider","showLoader","onOpenComplete","initMessengerComponent","closeLoader","getSlider","applicationPromise","Runtime","loadExtension","Launch","application","controller","initComponent","onDialogOpen","sliderId","getUrl","startsWith","canClose","denyAction","id","getIdFromSliderId","canCloseByEsc","ZIndexManager","stack","getOrAddStack","document","body","baseIndex","sort","getZIndex","isOpened","Object","keys","length","getTopSlider","getCurrent","getCurrentId","Number","parseInt","slice"],"mappings":"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"}