(function(){BX.namespace("BX.Call");if(BX.Call.View){return}var e={Grid:1,Centered:2};var t={Initializing:1,Calling:2,Connected:3,Error:4};var s=1e3;var i=1001;BX.Call.View=function(i){this.title=i.title;this.container=i.container;this.cameraId=i.cameraId;this.microphoneId=i.microphoneId;this.speakerId=BX.Call.Hardware.defaultSpeaker;this.speakerMuted=false;this.showChatButtons=i.showChatButtons===true;this.language=i.language||"";this.lastPosition=1;this.userLimit=i.userLimit||1;this.userId=BX.message("USER_ID");this.localUser=new l({id:this.userId,state:BX.Call.UserState.Connected,localUser:true,order:s});this.mediaSelectionBlocked=false;this.visible=false;this.elements={root:null,container:null,overlay:null,panel:null,audioContainer:null,audio:{},center:null,userBlock:null,ear:{left:null,right:null},userList:{container:null,addButton:null}};this.buttons={title:null,grid:null,add:null,link:null,microphone:null,camera:null,speaker:null,screen:null,chat:null,history:null,hangup:null,fullscreen:null,overlay:null,status:null};this.size=BX.Call.View.Size.Full;this.isMuted=false;this.isCameraOn=false;this.isFullScreen=false;this.disabledButtons={};this.uiState=t.Calling;this.layout=i.layout||e.Centered;this.users={};if(BX.type.isPlainObject(i.userStates)){this.appendUsers(i.userStates)}this.callbacks={onClose:BX.type.isFunction(i.onClose)?i.onClose:BX.DoNothing,onDestroy:BX.type.isFunction(i.onDestroy)?i.onDestroy:BX.DoNothing,onButtonClick:BX.type.isFunction(i.onButtonClick)?i.onButtonClick:BX.DoNothing,onBodyClick:BX.type.isFunction(i.onBodyClick)?i.onBodyClick:BX.DoNothing,onReplaceCamera:BX.type.isFunction(i.onReplaceCamera)?i.onReplaceCamera:BX.DoNothing,onReplaceMicrophone:BX.type.isFunction(i.onReplaceMicrophone)?i.onReplaceMicrophone:BX.DoNothing,onSetCentralUser:BX.type.isFunction(i.onSetCentralUser)?i.onSetCentralUser:BX.DoNothing};this.scrollInterval=0;this._onFullScreenChangeHandler=this._onFullScreenChange.bind(this);this._onResizeHandler=this._onResize.bind(this);this.init()};BX.Call.View.prototype.init=function(){if(this.isFullScreenSupported()){if(BX.browser.IsChrome()||BX.browser.IsSafari()){window.addEventListener("webkitfullscreenchange",this._onFullScreenChangeHandler)}else if(BX.browser.IsFirefox()){window.addEventListener("mozfullscreenchange",this._onFullScreenChangeHandler)}}window.addEventListener("resize",this._onResizeHandler);this.elements.audioContainer=BX.create("div",{props:{className:"bx-messenger-videocall-audio-container"}});this.container.appendChild(this.elements.audioContainer)};BX.Call.View.prototype.setCallback=function(e,t){if(BX.type.isFunction(t)&&this.callbacks.hasOwnProperty(e)){this.callbacks[e]=t}};BX.Call.View.prototype.getNextPosition=function(){return this.lastPosition++};BX.Call.View.prototype.appendUsers=function(e){if(!BX.type.isPlainObject(e)){return}var t=Object.keys(e);for(var s=0;s<t.length;s++){this.users[t[s]]=new l({id:t[s],state:e[t[s]]?e[t[s]]:BX.Call.UserState.Idle,order:this.getNextPosition(),onClick:this._onUserClick.bind(this)})}BX.Call.Util.updateUserData(t)};BX.Call.View.prototype.setCentralUser=function(t){if(this.centralUser.userId==t){return}if(t==this.userId&&this.getUsersWithVideo().length>0){return}if(!this.users[t]&&t!=this.userId){return}this.centralUser.setUserId(t);if(this.layout==e.Centered){this.updateUserList()}this.callbacks.onSetCentralUser({userId:t,stream:t==this.userId?this.localUser.stream:this.users[t].stream})};BX.Call.View.prototype.getUserCount=function(){return Object.keys(this.users).length};BX.Call.View.prototype.getConnectedUserCount=function(){return this.getConnectedUsers().length};BX.Call.View.prototype.getUsersWithVideo=function(){var e=[];for(var t in this.users){if(this.users[t].hasVideo()){e.push(t)}}return e};BX.Call.View.prototype.getConnectedUsers=function(){var e=[];for(var t in this.users){if(this.users[t].state==BX.Call.UserState.Connected){e.push(t)}}return e};BX.Call.View.prototype.setUiState=function(e){if(this.uiState==e){return}this.uiState=e;if(this.uiState==t.Error&&this.elements.container){this.elements.container.textContent=""}if(this.elements.root){this.updateButtons()}};BX.Call.View.prototype.setLayout=function(t){if(t==this.layout){return}this.layout=t;if(this.layout==e.Centered){this.elements.root.className="bx-messenger-videocall bx-messenger-videocall-centered";this.elements.userBlock.appendChild(this.elements.userList.container);this.elements.container.appendChild(this.elements.center);this.elements.container.appendChild(this.elements.userBlock);this.centralUser.playVideo()}else if(this.layout==e.Grid){this.elements.root.className="bx-messenger-videocall bx-messenger-videocall-grid";this.elements.container.removeChild(this.elements.center);this.elements.container.removeChild(this.elements.userBlock);this.elements.container.appendChild(this.elements.userList.container)}this.renderUserList();this.toggleEars()};BX.Call.View.prototype.setCameraState=function(e){e=!!e;if(this.isCameraOn==e){return}this.isCameraOn=e;if(this.buttons.camera){if(this.isCameraOn){this.buttons.camera.enable()}else{this.buttons.camera.disable()}}};BX.Call.View.prototype.setMuted=function(e){e=!!e;if(this.isMuted==e){return}this.isMuted=e;if(this.buttons.microphone){if(this.isMuted){this.buttons.microphone.disable()}else{this.buttons.microphone.enable()}}this.localUser.setMicrophoneState(!e)};BX.Call.View.prototype.addUser=function(e,t){if(this.users[e]){return}this.users[e]=new l({id:e,state:t||BX.Call.UserState.Idle,order:this.getNextPosition(),onClick:this._onUserClick.bind(this)});this.updateUserList();this.updateButtons()};BX.Call.View.prototype.setUserState=function(e,t){var s=this.users[e];if(!s){return}s.setState(t);if(this.centralUser.userId==this.userId&&t==BX.Call.UserState.Connected){this.setCentralUser(e)}else if(e==this.centralUser.userId){if(t==BX.Call.UserState.Connecting||t==BX.Call.UserState.Failed){this.centralUser.blurVideo()}else if(t==BX.Call.UserState.Connected){this.centralUser.blurVideo(false)}else if(t==BX.Call.UserState.Idle){var i=this.getUsersWithVideo();var n=this.getConnectedUsers();if(i.length>0){this.setCentralUser(i[0])}else if(n.length>0){this.setCentralUser(n[0])}else{this.centralUser.blurVideo()}}}this.updateUserList();this.updateButtons()};BX.Call.View.prototype.setTitle=function(e){this.title=e};BX.Call.View.prototype.setUserTalking=function(e,t){var s=this.users[e];if(!s){return}s.setTalking(t)};BX.Call.View.prototype.setUserMicrophoneState=function(e,t){var s=this.users[e];if(!s){return}s.setMicrophoneState(t)};BX.Call.View.prototype.setLocalStream=function(t,s){this.localUser.stream=t;this.localUser.flipVideo=!!s;this.setCameraState(this.localUser.hasVideo());var i=t.getVideoTracks();if(i.length>0){var n=i[0].getSettings();this.cameraId=n.deviceId||""}else{this.cameraId=""}var l=t.getAudioTracks();if(l.length>0){var r=l[0].getSettings();this.microphoneId=r.deviceId||""}if(this.layout==e.Centered&&this.centralUser.userId==this.userId){if(this.localUser.hasVideo()){this.centralUser.setStream(t)}else{this.setCentralUser(Object.keys(this.users)[0])}}else{this.updateUserList()}};BX.Call.View.prototype.setSpeakerId=function(e){if(!("setSinkId"in HTMLMediaElement.prototype)){console.error("Speaker selection is not supported")}this.speakerId=e;for(var t in this.elements.audio){this.elements.audio[t].setSinkId(this.speakerId)}};BX.Call.View.prototype.muteSpeaker=function(e){this.speakerMuted=!!e;for(var t in this.elements.audio){this.elements.audio[t].volume=this.speakerMuted?0:1}if(this.speakerMuted){this.buttons.speaker.disable();this.buttons.speaker.hideArrow()}else{this.buttons.speaker.enable();if(BX.Call.Hardware.canSelectSpeaker()){this.buttons.speaker.showArrow()}}};BX.Call.View.prototype.setStream=function(e,s){if(this.uiState==t.Calling){this.setUiState(t.Connected)}if(!this.users[e]){throw Error("User "+e+" is not a part of this call")}if(!this.elements.audio[e]){this.elements.audio[e]=BX.create("audio");this.elements.audioContainer.appendChild(this.elements.audio[e])}this.elements.audio[e].volume=this.speakerMuted?0:1;if(s.getAudioTracks().length>0&&s!=this.elements.audio[e].srcObject){if(this.speakerId&&this.elements.audio[e].setSinkId){this.elements.audio[e].setSinkId(this.speakerId).then(function(){this.elements.audio[e].srcObject=s;this.elements.audio[e].play().catch(BX.DoNothing)}.bind(this)).catch(console.error)}else{this.elements.audio[e].srcObject=s;this.elements.audio[e].play().catch(BX.DoNothing)}}this.users[e].stream=s;if(this.users[e].hasVideo()){if(this.centralUser.userId==this.userId){this.setCentralUser(e)}}else{if(this.centralUser.userId==e){var i=this.getUsersWithVideo();if(i.length>0){this.setCentralUser(i[0])}}}if(this.centralUser.userId==e){this.centralUser.setStream(s)}this.updateUserList()};BX.Call.View.prototype.show=function(){if(!this.elements.root){this.render()}this.container.appendChild(this.elements.root);this.updateButtons();this.updateUserList();this.resumeVideo();this.toggleEars();this.visible=true};BX.Call.View.prototype.hide=function(){BX.remove(this.elements.root);this.visible=false};BX.Call.View.prototype.showMessage=function(e){if(!this.elements.root){this.render();this.container.appendChild(this.elements.root)}var t=BX.create("div",{props:{className:"bx-messenger-videocall-user-status bx-messenger-videocall-user-status-wide"}});if(BX.type.isNotEmptyString(e.text)){var s=BX.create("div",{props:{className:"bx-messenger-videocall-status-text"},text:e.text});t.appendChild(s)}if(this.elements.overlay.childElementCount){BX.cleanNode(this.elements.overlay)}this.elements.overlay.appendChild(t)};BX.Call.View.prototype.hideMessage=function(){this.elements.overlay.textContent=""};BX.Call.View.prototype.showFatalError=function(e){this.showMessage(e);this.setUiState(t.Error)};BX.Call.View.prototype.close=function(){BX.cleanNode(this.container);this.visible=false;this.callbacks.onClose()};BX.Call.View.prototype.setSize=function(e){if(this.size==e){return}this.size=e;if(this.size==BX.Call.View.Size.Folded){this.elements.panel.classList.add("bx-messenger-videocall-panel-folded");BX.remove(this.elements.container);this.updateButtons()}else{this.elements.panel.classList.remove("bx-messenger-videocall-panel-folded");this.elements.wrap.appendChild(this.elements.container);this.updateButtons();this.updateUserList();this.resumeVideo()}};BX.Call.View.prototype.toggleFullScreen=function(){if(this.isFullScreen){this.exitFullScreen()}else{this.enterFullScreen()}};BX.Call.View.prototype.isButtonDisabled=function(e){return this.disabledButtons.hasOwnProperty(e)};BX.Call.View.prototype.disableAddUser=function(){this.disabledButtons["add"]=true;if(this.elements.userList.addButton){BX.remove(this.elements.userList.addButton);this.elements.userList.addButton=null}};BX.Call.View.prototype.disableSwitchCamera=function(){this.disabledButtons["camera"]=true};BX.Call.View.prototype.enableSwitchCamera=function(){delete this.disabledButtons["camera"]};BX.Call.View.prototype.disableScreenSharing=function(){this.disabledButtons["screen"]=true};BX.Call.View.prototype.disableMediaSelection=function(){this.mediaSelectionBlocked=true};BX.Call.View.prototype.isMediaSelectionAllowed=function(){return this.uiState==t.Connected&&!this.mediaSelectionBlocked&&!this.isFullScreen};BX.Call.View.prototype.getButtonList=function(){if(this.uiState==t.Error){return["close"]}if(this.uiState==t.Initializing){return["hangup"]}if(this.size==BX.Call.View.Size.Folded){return["title","hangup","fullscreen"]}var e=[];if(this.uiState===t.Connected){e.push("grid")}if(this.getConnectedUserCount()<this.userLimit-1&&!this.isFullScreen&&this.uiState===t.Connected){e.push("add")}if(false&&!this.isFullScreen){e.push("link")}e.push("microphone");if(this.uiState===t.Connected){e.push("camera")}e.push("speaker");if(this.isScreenSharingSupported()&&!this.isFullScreen&&this.uiState===t.Connected){e.push("screen")}if(this.showChatButtons&&!this.isFullScreen){e.push("chat","history")}e.push("hangup");if(this.isFullScreenSupported()){e.push("fullscreen")}e=e.filter(function(e){return!this.isButtonDisabled(e)},this);return e};BX.Call.View.prototype.render=function(){this.elements.root=BX.create("div",{props:{className:"bx-messenger-videocall bx-messenger-videocall-centered"},children:[this.elements.wrap=BX.create("div",{props:{className:"bx-messenger-videocall-wrap"},children:[this.elements.container=BX.create("div",{props:{className:"bx-messenger-videocall-inner"}}),this.elements.overlay=BX.create("div",{props:{className:"bx-messenger-videocall-overlay"}}),this.elements.panel=BX.create("div",{props:{className:"bx-messenger-videocall-panel"}})]})],events:{click:this._onBodyClick.bind(this)}});this.centralUser=new n({parent:this,video:false,stream:false,userId:this.userId,language:this.language});this.elements.center=this.centralUser.render();this.elements.userBlock=BX.create("div",{props:{className:"bx-messenger-videocall-user-block"},children:[this.elements.ear.left=BX.create("div",{props:{className:"bx-messenger-videocall-ear bx-messenger-videocall-ear-left"},events:{mouseenter:this.scrollUserBlockLeft.bind(this),mouseleave:this.stopScroll.bind(this)}}),this.elements.ear.right=BX.create("div",{props:{className:"bx-messenger-videocall-ear bx-messenger-videocall-ear-right"},events:{mouseenter:this.scrollUseBlockRight.bind(this),mouseleave:this.stopScroll.bind(this)}})]});this.elements.userList.container=BX.create("div",{props:{className:"bx-messenger-videocall-user-list"},children:[BX.create("div",{props:{className:"bx-messenger-videocall-user-extra"}})],events:{scroll:this.toggleEars.bind(this)}});this.elements.userList.addButton=BX.create("div",{props:{className:"bx-messenger-videocall-user-add"},children:[BX.create("div",{props:{className:"bx-messenger-videocall-user-add-inner"}})],style:{order:i},events:{click:this._onAddButtonClick.bind(this)}});if(this.layout==e.Centered){this.elements.container.appendChild(this.elements.center);this.elements.container.appendChild(this.elements.userBlock)}return this.elements.root};BX.Call.View.prototype.renderUserList=function(){var s=this.elements.userList.container.getBoundingClientRect();var i=this.localUser.hasVideo()&&(this.layout==e.Grid||this.centralUser.userId!=this.userId);var n=0;for(var l in this.users){var r=this.users[l];if(this.layout==e.Centered&&l==this.centralUser.userId){r.dismount();continue}if(r.state==BX.Call.UserState.Idle||r.state==BX.Call.UserState.Declined||r.state==BX.Call.UserState.Unavailable||r.state==BX.Call.UserState.Busy){r.dismount();continue}r.mount(this.elements.userList.container);n++}if(i){this.localUser.mount(this.elements.userList.container,true);n++}else{this.localUser.dismount()}if(this.layout==e.Grid){var a=BX.Call.Util.findBestElementSize(s.width,s.height,n);this.elements.userList.container.style.setProperty("--grid-user-width",a.width+"px");this.elements.userList.container.style.setProperty("--grid-user-height",a.height+"px")}var o=this.layout==e.Centered&&n>0&&!this.isFullScreen&&this.uiState===t.Connected&&!this.isButtonDisabled("add")&&this.getConnectedUserCount()<this.userLimit-1;if(o&&!this.isFullScreen){this.elements.userList.container.appendChild(this.elements.userList.addButton)}else{BX.remove(this.elements.userList.addButton)}};BX.Call.View.prototype.renderButtons=function(e){var s;var i;var n;var l;s=BX.create("div",{props:{className:"bx-messenger-videocall-panel-inner"},children:[i=BX.create("div",{props:{className:"bx-messenger-videocall-panel-block"}}),n=BX.create("div",{props:{className:"bx-messenger-videocall-panel-block"}}),l=BX.create("div",{props:{className:"bx-messenger-videocall-panel-block"}})]});for(var h=0;h<e.length;h++){switch(e[h]){case"title":this.buttons.title=new r({text:this.title,isGroupCall:Object.keys(this.users).length>1});i.appendChild(this.buttons.title.render());break;case"grid":this.buttons.grid=new a({class:"grid",text:BX.message("IM_M_CALL_BTN_GRID"),onClick:this._onGridButtonClick.bind(this)});i.appendChild(this.buttons.grid.render());break;case"add":this.buttons.add=new a({class:"add",text:BX.message("IM_M_CALL_BTN_ADD"),onClick:this._onAddButtonClick.bind(this)});i.appendChild(this.buttons.add.render());break;case"link":this.buttons.link=new a({class:"link",text:BX.message("IM_M_CALL_BTN_LINK"),onClick:this._onLinkButtonClick.bind(this)});i.appendChild(this.buttons.link.render());break;case"microphone":this.buttons.microphone=new c({class:"microphone",text:BX.message("IM_M_CALL_BTN_MIC"),enabled:!this.isMuted,arrowEnabled:this.isMediaSelectionAllowed(),onClick:this._onMicrophoneButtonClick.bind(this),onArrowClick:this._onMicrophoneArrowClick.bind(this)});n.appendChild(this.buttons.microphone.render());break;case"camera":this.buttons.camera=new c({class:"camera",text:BX.message("IM_M_CALL_BTN_CAMERA"),enabled:this.isCameraOn,arrowEnabled:this.isMediaSelectionAllowed(),onClick:this._onCameraButtonClick.bind(this),onArrowClick:this._onCameraArrowClick.bind(this)});n.appendChild(this.buttons.camera.render());break;case"speaker":this.buttons.speaker=new c({class:"speaker",text:BX.message("IM_M_CALL_BTN_SPEAKER"),enabled:!this.speakerMuted,arrowEnabled:BX.Call.Hardware.canSelectSpeaker(),onClick:this._onSpeakerButtonClick.bind(this),onArrowClick:this._onSpeakerArrowClick.bind(this)});n.appendChild(this.buttons.speaker.render());case"screen":if(!this.buttons.screen){this.buttons.screen=new a({class:"screen",text:BX.message("IM_M_CALL_BTN_SCREEN"),onClick:this._onScreenButtonClick.bind(this)})}n.appendChild(this.buttons.screen.render());break;case"chat":this.buttons.chat=new a({class:"chat",text:BX.message("IM_M_CALL_BTN_CHAT"),onClick:this._onChatButtonClick.bind(this)});n.appendChild(this.buttons.chat.render());break;case"history":this.buttons.history=new a({class:"history",text:BX.message("IM_M_CALL_BTN_HISTORY"),onClick:this._onHistoryButtonClick.bind(this)});n.appendChild(this.buttons.history.render());break;case"hangup":this.buttons.hangup=new o({text:Object.keys(this.users).length>1?BX.message("IM_M_CALL_BTN_DISCONNECT"):BX.message("IM_M_CALL_BTN_HANGUP"),onClick:this._onHangupButtonClick.bind(this)});if(this.uiState==t.Initializing){n.appendChild(this.buttons.hangup.render())}else{l.appendChild(this.buttons.hangup.render())}break;case"close":this.buttons.close=new o({text:BX.message("IM_M_CALL_BTN_CLOSE"),onClick:this._onCloseButtonClick.bind(this)});n.appendChild(this.buttons.close.render());break;case"fullscreen":this.buttons.fullscreen=new a({class:"resize",text:"",onClick:this._onFullScreenButtonClick.bind(this)});l.appendChild(this.buttons.fullscreen.render());break}}return s};BX.Call.View.prototype.setButtonActive=function(e,t){if(!this.buttons[e]){return}this.buttons[e].setActive(t)};BX.Call.View.prototype.setButtonCounter=function(e,t){if(!this.buttons[e]){return}this.buttons[e].setCounter(t)};BX.Call.View.prototype.updateUserList=function(){this.renderUserList();if(this.layout==e.Centered){if(!this.elements.userList.container.parentElement){this.elements.userBlock.appendChild(this.elements.userList.container)}this.centralUser.setFullSize(this.elements.userList.container.childElementCount===0)}else if(this.layout==e.Grid){if(!this.elements.userList.container.parentElement){this.elements.container.appendChild(this.elements.userList.container)}this.elements.root.className="bx-messenger-videocall bx-messenger-videocall-grid"}this.toggleEars()};BX.Call.View.prototype.resumeVideo=function(){for(var t in this.users){var s=this.users[t];s.playVideo()}this.localUser.playVideo(true);if(this.layout==e.Centered){this.centralUser.playVideo()}};BX.Call.View.prototype.updateButtons=function(){var e=this.getButtonList();BX.cleanNode(this.elements.panel);this.elements.panel.appendChild(this.renderButtons(e))};BX.Call.View.prototype.isScreenSharingSupported=function(){return navigator.mediaDevices&&typeof navigator.mediaDevices.getDisplayMedia==="function"||typeof BXDesktopSystem!=="undefined"};BX.Call.View.prototype.isFullScreenSupported=function(){if(BX.browser.IsChrome()||BX.browser.IsSafari()){return document.webkitFullscreenEnabled===true}else if(BX.browser.IsFirefox()){return document.fullscreenEnabled===true}else{return false}};BX.Call.View.prototype.enterFullScreen=function(){if(BX.browser.IsChrome()||BX.browser.IsSafari()){this.elements.root.webkitRequestFullScreen()}else if(BX.browser.IsFirefox()){this.elements.root.requestFullscreen()}};BX.Call.View.prototype.exitFullScreen=function(){if(document.cancelFullScreen){document.cancelFullScreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.document.exitFullscreen()){document.exitFullscreen()}};BX.Call.View.prototype.toggleEars=function(){this.toggleRightEar();this.toggleLeftEar()};BX.Call.View.prototype.toggleRightEar=function(){if(this.layout==e.Centered&&this.elements.userList.container.scrollWidth>this.elements.userList.container.offsetWidth&&this.elements.userList.container.offsetWidth+this.elements.userList.container.scrollLeft<this.elements.userList.container.scrollWidth){this.elements.ear.right.classList.add("bx-messenger-videocall-ear-show")}else{this.elements.ear.right.classList.remove("bx-messenger-videocall-ear-show")}};BX.Call.View.prototype.toggleLeftEar=function(){if(this.layout==e.Centered&&this.elements.userList.container.scrollLeft>0){this.elements.ear.left.classList.add("bx-messenger-videocall-ear-show")}else{this.elements.ear.left.classList.remove("bx-messenger-videocall-ear-show")}};BX.Call.View.prototype.scrollUserBlockLeft=function(){this.stopScroll();this.scrollInterval=setInterval(function(){this.elements.userList.container.scrollLeft-=10}.bind(this),20)};BX.Call.View.prototype.scrollUseBlockRight=function(){this.stopScroll();this.scrollInterval=setInterval(function(){this.elements.userList.container.scrollLeft+=10}.bind(this),20)};BX.Call.View.prototype.stopScroll=function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=0}};BX.Call.View.prototype._onBodyClick=function(e){this.callbacks.onBodyClick()};BX.Call.View.prototype._onFullScreenChange=function(e){if(BX.browser.IsChrome()||BX.browser.IsSafari()){this.isFullScreen=document.webkitFullscreenElement==this.elements.root}else if(BX.browser.IsFirefox()){this.isFullScreen=document.fullscreenElement==this.elements.root}this.updateUserList();this.updateButtons()};BX.Call.View.prototype._onResize=function(){if(this.centralUser){this.centralUser.updateAvatarWidth()}this.toggleEars();if(this.layout==e.Grid){this.updateUserList()}};BX.Call.View.prototype._onUserClick=function(t){var s=t.userId;if(s==this.userId){return}this.setCentralUser(s);if(this.layout==e.Grid){this.setLayout(e.Centered)}};BX.Call.View.prototype._onGridButtonClick=function(t){this.setLayout(this.layout==e.Centered?e.Grid:e.Centered)};BX.Call.View.prototype._onAddButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"inviteUser",node:e.currentTarget})};BX.Call.View.prototype._onLinkButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"settings",node:e.currentTarget})};BX.Call.View.prototype._onMicrophoneButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"toggleMute",muted:!this.isMuted})};BX.Call.View.prototype._onMicrophoneArrowClick=function(e){e.stopPropagation();h.create({parentElement:e.currentTarget,deviceList:BX.Call.Hardware.getMicrophoneList(),current:this.microphoneId,onSelect:this._onMicrophoneSelected.bind(this)}).show()};BX.Call.View.prototype._onMicrophoneSelected=function(e){if(e.deviceId===this.microphoneId){return}this.callbacks.onReplaceMicrophone(e)};BX.Call.View.prototype._onCameraButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"toggleVideo",video:!this.isCameraOn})};BX.Call.View.prototype._onCameraArrowClick=function(e){e.stopPropagation();if(!BX.Call.Hardware.hasCamera()){return false}h.create({parentElement:e.currentTarget,deviceList:BX.Call.Hardware.getCameraList(),current:this.cameraId,onSelect:this._onCameraSelected.bind(this)}).show()};BX.Call.View.prototype._onCameraSelected=function(e){if(e.deviceId===this.cameraId){return}this.callbacks.onReplaceCamera(e)};BX.Call.View.prototype._onSpeakerButtonClick=function(e){this.muteSpeaker(!this.speakerMuted)};BX.Call.View.prototype._onSpeakerArrowClick=function(e){e.stopPropagation();h.create({parentElement:e.currentTarget,deviceList:BX.Call.Hardware.getSpeakerList(),current:this.speakerId,onSelect:this._onSpeakerSelected.bind(this)}).show()};BX.Call.View.prototype._onSpeakerSelected=function(e){this.setSpeakerId(e.deviceId)};BX.Call.View.prototype._onScreenButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"toggleScreenSharing",node:e.target})};BX.Call.View.prototype._onChatButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"showChat",node:e.target})};BX.Call.View.prototype._onHistoryButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"showHistory",node:e.target})};BX.Call.View.prototype._onHangupButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"hangup",node:e.target})};BX.Call.View.prototype._onCloseButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"close",node:e.target})};BX.Call.View.prototype._onFullScreenButtonClick=function(e){e.stopPropagation();this.callbacks.onButtonClick({buttonName:"fullscreen",node:e.target})};BX.Call.View.prototype.releaseLocalMedia=function(){this.localUser.releaseStream();if(this.centralUser.userId==this.userId){this.centralUser.releaseStream()}};BX.Call.View.prototype.destroy=function(){if(this.elements.root){BX.cleanNode(this.elements.root,true);this.elements.root=null}this.visible=false;window.removeEventListener("webkitfullscreenchange",this._onFullScreenChangeHandler);window.removeEventListener("mozfullscreenchange",this._onFullScreenChangeHandler);window.removeEventListener("resize",this._onResizeHandler);for(var e in this.users){if(this.users.hasOwnProperty(e)){this.users[e].destroy()}}this.centralUser.destroy();this.callbacks.onDestroy()};var n=function(e){this.parent=e.parent;this.stream=e.stream||null;this.userId=e.userId;this.language=e.language;this.hasVideo=false;this.elements={container:null,inner:null,watermark:null,video:null,user:null,userBlock:null,avatar:null,nameBlock:null,name:null};this.loader=null;this.checkAspectInterval=setInterval(this.checkVideoAspect.bind(this),500)};n.prototype.getWatermarkUrl=function(e){switch(e){case"ua":return"/bitrix/js/im/images/watermark-white-ua.svg";case"ru":case"kz":case"by":return"/bitrix/js/im/images/watermark-white-ru.svg";default:return"/bitrix/js/im/images/watermark-white-en.svg"}};n.prototype.render=function(){this.elements.container=BX.create("div",{props:{className:"bx-messenger-videocall-video-block"},children:[this.elements.watermark=BX.create("div",{props:{className:"bx-messenger-videocall-watermark"},children:[BX.create("img",{props:{className:"bx-messenger-videocall-watermark-img",src:this.getWatermarkUrl(this.language)}})]})]});this.elements.video=BX.create("video",{props:{className:"bx-messenger-videocall-video",autoplay:true,volume:0}});this.elements.user=BX.create("div",{props:{className:"bx-messenger-audiocall"},children:[BX.create("div",{props:{className:"bx-messenger-audiocall-wrap"},children:[this.elements.inner=BX.create("div",{props:{className:"bx-messenger-audiocall-inner"},children:[this.elements.userBlock=BX.create("div",{props:{className:"bx-messenger-audiocall-user-block"},children:[BX.create("div",{props:{className:"bx-messenger-audiocall-user-block-inner"},children:[BX.create("div",{props:{className:"bx-messenger-audiocall-user"},children:[this.elements.avatar=BX.create("div",{props:{className:"bx-messenger-audiocall-user-item"}})]})]})]}),this.elements.nameBlock=BX.create("div",{props:{className:"bx-messenger-audiocall-user-name"},children:[this.elements.name=BX.create("span",{props:{className:"bx-messenger-audiocall-user-link"}})]})]})]})]});if(this.stream&&BX.Call.Util.containsVideoTrack(this.stream)){this.elements.container.appendChild(this.elements.video);this.elements.container.classList.remove("bx-messenger-videocall-audio");if(this.userId==this.parent.userId&&this.parent.localUser.flipVideo){this.elements.video.classList.add("bx-messenger-videocall-video-flipped")}else{this.elements.video.classList.remove("bx-messenger-videocall-video-flipped")}}else{this.elements.container.classList.add("bx-messenger-videocall-audio")}this.loader=new BX.Loader({target:this.elements.container});this.updateUserInfo();return this.elements.container};n.prototype.blurVideo=function(e){e=e!==false;if(e){this.elements.video.pause();this.elements.video.classList.add("bx-messenger-videocall-video-blurred");this.loader.show()}else{this.elements.video.play().catch(BX.DoNothing);this.elements.video.classList.remove("bx-messenger-videocall-video-blurred");this.loader.hide()}};n.prototype.updateUserInfo=function(){var e=this;var t=this.userId;BX.Call.Util.getUserName(t).then(function(s){if(e.userId==t){e.elements.name.innerText=s}return BX.Call.Util.getUserAvatar(e.userId)}).then(function(t){if(t!=""){e.elements.avatar.style.backgroundImage="url('"+t+"')"}else{e.elements.avatar.style.removeProperty("background-image")}e.updateAvatarWidth()})};n.prototype.updateAvatarWidth=function(){this.elements.userBlock.style.maxWidth=this.elements.inner.offsetHeight-this.elements.nameBlock.offsetHeight+"px"};n.prototype.setUserId=function(e){if(this.userId==e){return}if(e==this.parent.userId&&this.parent.localUser.flipVideo){this.setStream(this.parent.localUser.stream);this.elements.video.classList.add("bx-messenger-videocall-video-flipped")}else{this.setStream(this.parent.users[e].stream);this.elements.video.classList.remove("bx-messenger-videocall-video-flipped")}this.userId=e;this.updateUserInfo()};n.prototype.setStream=function(e){this.stream=e;var t=BX.Call.Util.containsVideoTrack(e);if(this.stream){if(this.hasVideo&&!t){BX.remove(this.elements.video);this.elements.container.appendChild(this.elements.user);this.elements.container.classList.add("bx-messenger-videocall-audio");this.updateAvatarWidth()}else if(!this.hasVideo&&t){BX.remove(this.elements.user);this.elements.container.appendChild(this.elements.video);this.elements.container.classList.remove("bx-messenger-videocall-audio")}}else{BX.remove(this.elements.video);this.elements.container.appendChild(this.elements.user);this.elements.container.classList.add("bx-messenger-videocall-audio");this.updateAvatarWidth()}this.hasVideo=t;if(this.hasVideo){if(this.elements.video.srcObject!=e){this.elements.video.srcObject=e}this.blurVideo(false);if(this.userId==this.parent.userId&&this.parent.localUser.flipVideo){this.elements.video.classList.add("bx-messenger-videocall-video-flipped")}else{this.elements.video.classList.remove("bx-messenger-videocall-video-flipped")}}};n.prototype.playVideo=function(){if(this.elements.video){this.elements.video.play().catch(BX.DoNothing)}};n.prototype.releaseStream=function(){this.elements.video.srcObject=null;this.stream=null};n.prototype.setFullSize=function(e){if(e){this.elements.container.classList.add("bx-messenger-videocall-video-block-full")}else{this.elements.container.classList.remove("bx-messenger-videocall-video-block-full")}this.updateAvatarWidth()};n.prototype.isVideo=function(){};n.prototype.checkVideoAspect=function(){if(!this.elements.video){return}if(this.elements.video.videoHeight>this.elements.video.videoWidth){this.elements.video.classList.add("bx-messenger-videocall-video-vertical")}else{this.elements.video.classList.remove("bx-messenger-videocall-video-vertical")}};n.prototype.destroy=function(){this.stream=null;if(this.loader){this.loader.destroy();this.loader=null}clearInterval(this.checkAspectInterval)};var l=function(e){this.id=e.id;this.name="";this.avatar="";this.state=e.state;this.order=e.order;this._stream=e.stream;Object.defineProperty(this,"stream",{get:function(){return this._stream},set:function(e){this._stream=e;this.update()}});this._flipVideo=false;Object.defineProperty(this,"flipVideo",{get:function(){return this._flipVideo},set:function(e){this._flipVideo=e;this.update()}});this.talking=false;this.isMicrophoneOn=e.isMicrophoneOn!==false;this.localUser=e.localUser===true;this.hidden=false;this.elements={root:null,container:null,videoContainer:null,video:null,videoBorder:null,avatar:null,nameContainer:null,name:null,overlay:null,state:null,removeButton:null,micState:null};this.callBacks={onClick:BX.type.isFunction(e.onClick)?e.onClick:BX.DoNothing};this.checkAspectInterval=setInterval(this.checkVideoAspect.bind(this),500)};l.prototype.render=function(){var e=this;this.elements.root=BX.create("div",{props:{className:"bx-messenger-videocall-user"},dataset:{userId:this.id,order:this.order},children:[this.elements.container=BX.create("div",{props:{className:"bx-messenger-videocall-user-inner"}})],style:{order:this.order},events:{click:function(e){e.stopPropagation();this.callBacks.onClick({userId:this.id})}.bind(this)}});if(this.talking){this.elements.root.classList.add("bx-messenger-videocall-user-talking")}if(this.localUser){this.elements.root.classList.add("bx-messenger-videocall-user-self")}this.elements.avatar=BX.create("div",{props:{className:"bx-message-videocall-user-avatar"}});BX.Call.Util.getUserAvatar(this.id).then(function(t){if(t!=""){e.elements.avatar.style.backgroundImage="url('"+t+"')"}else{e.elements.avatar.style.removeProperty("background-image")}});if(!this.hasVideo()){this.elements.container.appendChild(this.elements.avatar)}this.elements.videoContainer=BX.create("div",{props:{className:"bx-messenger-videocall-video-container"},children:[this.elements.video=BX.create("video",{props:{className:"bx-messenger-videocall-video",volume:0,autoplay:true}}),this.elements.videoBorder=BX.create("div",{props:{className:"bx-messenger-videocall-video-border"}})]});this.elements.container.appendChild(this.elements.videoContainer);if(this.stream&&this.stream.active){this.elements.video.srcObject=this.stream}if(this.flipVideo){this.elements.video.classList.add("bx-messenger-videocall-video-flipped")}this.elements.overlay=BX.create("div",{props:{className:"bx-messenger-videocall-overlay"}});this.elements.root.appendChild(this.elements.overlay);this.elements.state=this.renderState();if(this.elements.state){this.elements.overlay.appendChild(this.elements.state)}this.elements.nameContainer=BX.create("div",{props:{className:"bx-messenger-videocall-user-name"},children:[this.elements.name=BX.create("span",{props:{className:"bx-messenger-videocall-user-text"},text:name}),BX.create("div",{props:{className:"bx-messenger-videocall-user-shadow"}})]});this.elements.videoContainer.appendChild(this.elements.nameContainer);this.elements.micState=BX.create("div",{props:{className:"bx-messenger-videocall-user-mic-state"+(this.isMicrophoneOn?" hidden":"")},children:[BX.create("div",{props:{className:"bx-messenger-videocall-user-mic-state-icon"}})]});this.elements.nameContainer.insertBefore(this.elements.micState,this.elements.name);BX.Call.Util.getUserName(this.id).then(function(t){if(t!=""){e.elements.name.innerText=t}});return this.elements.root};l.prototype.update=function(){if(!this.elements.root){return}if(this.hasVideo()){if(this.elements.video.srcObject!=this.stream){this.elements.video.srcObject=this.stream}BX.remove(this.elements.avatar);if(this.flipVideo){this.elements.video.classList.add("bx-messenger-videocall-video-flipped")}else{this.elements.video.classList.remove("bx-messenger-videocall-video-flipped")}}else{this.elements.video.srcObject=null;this.elements.container.appendChild(this.elements.avatar)}};l.prototype.playVideo=function(){if(this.elements.video){this.elements.video.play().catch(BX.DoNothing)}};l.prototype.renderState=function(){var e;switch(this.state){case BX.Call.UserState.Idle:break;case BX.Call.UserState.Calling:e=BX.create("div",{props:{className:"bx-messenger-videocall-user-status"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-pic"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-dot"}}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-dot"}}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-dot"}})]}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-text"},text:BX.message("IM_M_CALL_STATUS_WAIT_ANSWER")})]});break;case BX.Call.UserState.Declined:e=BX.create("div",{props:{className:"bx-messenger-videocall-user-status bx-messenger-videocall-user-status-wide"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-pic"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-cross"}})]}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-text"},text:BX.message("IM_M_CALL_STATUS_DECLINED")})]});break;case BX.Call.UserState.Ready:case BX.Call.UserState.Connecting:e=BX.create("div",{props:{className:"bx-messenger-videocall-user-status"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-pic"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-dot"}}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-dot"}}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-dot"}})]}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-text"},text:BX.message("IM_M_CALL_STATUS_WAIT_CONNECT")})]});break;case BX.Call.UserState.Connected:break;case BX.Call.UserState.Failed:case BX.Call.UserState.Unavailable:e=BX.create("div",{props:{className:"bx-messenger-videocall-user-status bx-messenger-videocall-user-status-wide"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-pic"},children:[BX.create("span",{props:{className:"bx-messenger-videocall-user-status-cross"}})]}),BX.create("span",{props:{className:"bx-messenger-videocall-user-status-text"},text:this.state==BX.Call.UserState.Failed?BX.message("IM_M_CALL_STATUS_CONNECTION_ERROR"):BX.message("IM_M_CALL_STATUS_UNAVAILABLE")})]});break}return e?e:null};l.prototype.mount=function(e,t){t=t===true;if(!this.elements.root){this.render()}if(this.isMounted()&&!t){return false}e.appendChild(this.elements.root);this.update()};l.prototype.dismount=function(){if(!this.isMounted()){return false}this.elements.video.srcObject=null;BX.remove(this.elements.root)};l.prototype.isMounted=function(){return!!(this.elements.root&&this.elements.root.parentElement)};l.prototype.setState=function(e){if(this.state==e){return}this.state=e;if(!this.elements.root){return}if(this.elements.state){BX.cleanNode(this.elements.overlay);this.elements.state=null}this.elements.state=this.renderState();if(this.elements.state){this.elements.overlay.appendChild(this.elements.state)}};l.prototype.setTalking=function(e){if(this.talking==e){return}this.talking=e;if(!this.elements.root){return}if(this.talking){this.elements.root.classList.add("bx-messenger-videocall-user-talking")}else{this.elements.root.classList.remove("bx-messenger-videocall-user-talking")}};l.prototype.setMicrophoneState=function(e){if(this.isMicrophoneOn==e){return}this.isMicrophoneOn=e;if(!this.elements.root){return}if(this.isMicrophoneOn){this.elements.micState.classList.add("hidden")}else{this.elements.micState.classList.remove("hidden")}};l.prototype.hide=function(){if(!this.elements.root){return}this.elements.root.dataset.hidden=1};l.prototype.show=function(){if(!this.elements.root){return}delete this.elements.root.dataset.hidden};l.prototype.hasVideo=function(){return this.state==BX.Call.UserState.Connected&&BX.Call.Util.containsVideoTrack(this.stream)};l.prototype.checkVideoAspect=function(){if(!this.elements.video){return}if(this.elements.video.videoHeight>this.elements.video.videoWidth){this.elements.video.classList.add("bx-messenger-videocall-video-vertical")}else{this.elements.video.classList.remove("bx-messenger-videocall-video-vertical")}};l.prototype.releaseStream=function(){if(this.elements.video){this.elements.video.srcObject=null}this.stream=null};l.prototype.destroy=function(){this.releaseStream();clearInterval(this.checkAspectInterval)};var r=function(e){this.elements={root:null};this.text=BX.type.isNotEmptyString(e.text)?e.text:"";this.isGroupCall=e.isGroupCall};r.prototype.render=function(){this.elements.root=BX.create("div",{props:{className:"bx-messenger-videocall-panel-title"},html:this.getTitle(this.text)});return this.elements.root};r.prototype.getTitle=function(e){var t='<span class="bx-messenger-videocall-panel-title-name">'+this.text+"</span>";if(this.isGroupCall){return BX.message("IM_M_GROUP_CALL_WITH").replace("#CHAT_NAME#",t)}else{return BX.message("IM_M_CALL_WITH").replace("#USER_NAME#",t)}};var a=function(e){this.class=e.class;this.text=BX.type.isNotEmptyString(e.text)?e.text:"";this.isActive=false;this.counter=e.counter||0;this.elements={root:null,counter:null,counterValue:null};this.callbacks={onClick:BX.type.isFunction(e.onClick)?e.onClick:BX.DoNothing}};a.prototype.render=function(){if(this.elements.root){return this.elements.root}var e;if(this.text!==""){e=BX.create("div",{props:{className:"bx-messenger-videocall-panel-text"},text:this.text})}else{e=null}this.elements.root=BX.create("div",{props:{className:"bx-messenger-videocall-panel-item"},children:[BX.create("div",{props:{className:"bx-messenger-videocall-panel-icon bx-messenger-videocall-panel-icon-"+this.class},children:[this.elements.counter=BX.create("span",{props:{className:"bx-messenger-cl-count"},style:{display:this.counter>0?"inline-block":"none",position:"absolute",right:"-19px",top:"-13px"},children:[this.elements.counterValue=BX.create("span",{props:{className:"bx-messenger-cl-count-digit"},text:this.counter})]})]}),e],events:{click:this.callbacks.onClick}});if(this.isActive){this.elements.root.classList.add("active")}return this.elements.root};a.prototype.setActive=function(e){if(this.isActive==e){return}this.isActive=e;if(!this.elements.root){return}if(this.isActive){this.elements.root.classList.add("active")}else{this.elements.root.classList.remove("active")}};a.prototype.setCounter=function(e){this.counter=e;if(this.counter==0){this.elements.counter.style.display="none"}else{this.elements.counter.style.removeProperty("display")}this.elements.counterValue.innerText=e};var o=function(e){this.text=e.text;this.elements={root:null};this.callbacks={onClick:BX.type.isFunction(e.onClick)?e.onClick:BX.DoNothing}};o.prototype.render=function(){if(this.elements.root){return this.elements.root}this.elements.root=BX.create("div",{props:{className:"bx-messenger-videocall-panel-item bx-messenger-videocall-panel-item-btn"},children:[BX.create("button",{props:{className:"ui-btn ui-btn-round bx-messenger-videocall-panel-btn ui-btn-icon-phone-down"},text:this.text})],events:{click:this.callbacks.onClick}});return this.elements.root};var c=function(e){this.class=e.class;this.text=e.text;this.enabled=e.enabled==true;this.arrowEnabled=e.arrowEnabled==true;this.elements={root:null,icon:null,arrow:null};this.callbacks={onClick:BX.type.isFunction(e.onClick)?e.onClick:BX.DoNothing,onArrowClick:BX.type.isFunction(e.onArrowClick)?e.onArrowClick:BX.DoNothing}};c.prototype.render=function(){if(this.elements.root){return this.elements.root}this.elements.root=BX.create("div",{props:{className:"bx-messenger-videocall-panel-item"},children:[this.elements.icon=BX.create("div",{props:{className:this.getIconClass()}}),BX.create("div",{props:{className:"bx-messenger-videocall-panel-text"},text:this.text})],events:{click:this.callbacks.onClick}});this.elements.arrow=BX.create("div",{props:{className:"bx-messenger-videocall-panel-arrow"},events:{click:function(e){this.callbacks.onArrowClick.apply(this,arguments);e.stopPropagation()}.bind(this)}});if(this.arrowEnabled){this.elements.icon.appendChild(this.elements.arrow)}return this.elements.root};c.prototype.getIconClass=function(){return"bx-messenger-videocall-panel-icon bx-messenger-videocall-panel-icon-"+this.class+(this.enabled?"":"-off")};c.prototype.enable=function(){if(this.enabled){return}this.enabled=true;this.elements.icon.className=this.getIconClass()};c.prototype.disable=function(){if(!this.enabled){return}this.enabled=false;this.elements.icon.className=this.getIconClass()};c.prototype.showArrow=function(){if(this.arrowEnabled){return}this.arrowEnabled=true;this.elements.icon.appendChild(this.elements.arrow)};c.prototype.hideArrow=function(){if(!this.arrowEnabled){return}this.arrowEnabled=false;this.elements.icon.removeChild(this.elements.arrow)};var h=function(e){this.deviceList=e.deviceList;this.current=e.current;this.parentElement=e.parentElement;this.menu=null;this.callbacks={onSelect:BX.type.isFunction(e.onSelect)?e.onSelect:BX.DoNothing}};h.create=function(e){return new h(e)};h.prototype.show=function(){var e=this;var t=[];this.deviceList.forEach(function(s){t.push({id:s.deviceId,text:s.label||"("+BX.message("IM_M_CALL_DEVICE_NO_NAME")+")",className:e.current==s.deviceId?"menu-popup-item-accept":"device-selector-empty",onclick:function(){e.menu.close();e.callbacks.onSelect(s)}})});this.menu=BX.PopupMenu.create("call-view-select-device",this.parentElement,t,{autoHide:true,zIndex:BX.MessengerCommon.getDefaultZIndex()+500,closeByEsc:true,offsetTop:0,offsetLeft:0,bindOptions:{position:"top"},angle:{position:"bottom"},overlay:{backgroundColor:"white",opacity:0},events:{onPopupClose:function(){e.menu.popupWindow.destroy();BX.PopupMenu.destroy("call-view-select-device")},onPopupDestroy:function(){e.menu=null}}});this.menu.popupWindow.show()};BX.Call.View.Layout=e;BX.Call.View.Size={Folded:"folded",Full:"full"};BX.Call.View.UiState=t})();
//# sourceMappingURL=view.map.js