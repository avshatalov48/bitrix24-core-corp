{"version":3,"file":"animation.bundle.js","sources":["../src/animation.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Animation manager\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nclass Animation\n{\n\tstatic start(params)\n\t{\n\t\tlet {\n\t\t\tstart = 0,\n\t\t\tend = 0,\n\t\t\tincrement = 20,\n\t\t\tcallback = () => {},\n\t\t\tduration = 500,\n\n\t\t\telement,\n\t\t\telementProperty\n\t\t} = params;\n\n\t\tlet diff = end - start;\n\t\tlet currentPosition = 0;\n\n\t\tconst easeInOutQuad = function (current, start, diff, duration)\n\t\t{\n\t\t\tcurrent /= duration/2;\n\n\t\t\tif (current < 1)\n\t\t\t{\n\t\t\t\treturn diff / 2 * current * current + start;\n\t\t\t}\n\n\t\t\tcurrent--;\n\n\t\t\treturn -diff/2 * (current*(current-2) - 1) + start;\n\t\t};\n\n\t\tconst requestFrame = (\n\t\t\twindow.requestAnimationFrame\n\t\t\t|| window.webkitRequestAnimationFrame\n\t\t\t|| window.mozRequestAnimationFrame\n\t\t\t|| function(callback){return window.setTimeout(callback, 1000 / 60);}\n\t\t);\n\n\t\tlet frameId = null;\n\t\tlet animateScroll = () =>\n\t\t{\n\t\t\tcurrentPosition += increment;\n\n\t\t\telement[elementProperty] = easeInOutQuad(currentPosition, start, diff, duration);\n\t\t\tif (currentPosition < duration)\n\t\t\t{\n\t\t\t\tframeId = requestFrame(animateScroll);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (callback && typeof callback === 'function')\n\t\t\t\t{\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn frameId;\n\t\t};\n\n\t\treturn animateScroll();\n\t}\n\n\tstatic cancel(id)\n\t{\n\t\tconst cancelFrame = (\n\t\t\twindow.cancelAnimationFrame\n\t\t\t|| window.webkitCancelAnimationFrame\n\t\t\t|| window.mozCancelAnimationFrame\n\t\t\t|| function(id){clearTimeout(id)}\n\t\t);\n\n\t\tcancelFrame(id);\n\t}\n}\n\nAnimation.frameIds = {};\n\nexport {Animation};\n\n"],"names":["Animation","params","start","end","increment","callback","duration","element","elementProperty","diff","currentPosition","easeInOutQuad","current","requestFrame","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","setTimeout","frameId","animateScroll","id","cancelFrame","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","clearTimeout","frameIds"],"mappings":";;;;;;CAAA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;AAPA,KASMA,SAAS;GAAA;KAAA;;GAAA;KAAA;KAAA,sBAEDC,MAAM,EACnB;OACC,oBASIA,MAAM,CARTC,KAAK;SAALA,KAAK,8BAAG,CAAC;SAAA,cAQND,MAAM,CAPTE,GAAG;SAAHA,GAAG,4BAAG,CAAC;SAAA,oBAOJF,MAAM,CANTG,SAAS;SAATA,SAAS,kCAAG,EAAE;SAAA,mBAMXH,MAAM,CALTI,QAAQ;SAARA,QAAQ,iCAAG,YAAM,EAAE;SAAA,mBAKhBJ,MAAM,CAJTK,QAAQ;SAARA,QAAQ,iCAAG,GAAG;SAEdC,OAAO,GAEJN,MAAM,CAFTM,OAAO;SACPC,eAAe,GACZP,MAAM,CADTO,eAAe;OAGhB,IAAIC,IAAI,GAAGN,GAAG,GAAGD,KAAK;OACtB,IAAIQ,eAAe,GAAG,CAAC;OAEvB,IAAMC,aAAa,GAAG,SAAhBA,aAAa,CAAaC,OAAO,EAAEV,KAAK,EAAEO,IAAI,EAAEH,QAAQ,EAC9D;SACCM,OAAO,IAAIN,QAAQ,GAAC,CAAC;SAErB,IAAIM,OAAO,GAAG,CAAC,EACf;WACC,OAAOH,IAAI,GAAG,CAAC,GAAGG,OAAO,GAAGA,OAAO,GAAGV,KAAK;;SAG5CU,OAAO,EAAE;SAET,OAAO,CAACH,IAAI,GAAC,CAAC,IAAIG,OAAO,IAAEA,OAAO,GAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAGV,KAAK;QAClD;OAED,IAAMW,YAAY,GACjBC,MAAM,CAACC,qBAAqB,IACzBD,MAAM,CAACE,2BAA2B,IAClCF,MAAM,CAACG,wBAAwB,IAC/B,UAASZ,QAAQ,EAAC;SAAC,OAAOS,MAAM,CAACI,UAAU,CAACb,QAAQ,EAAE,IAAI,GAAG,EAAE,CAAC;QACnE;OAED,IAAIc,OAAO,GAAG,IAAI;OAClB,IAAIC,aAAa,GAAG,SAAhBA,aAAa,GACjB;SACCV,eAAe,IAAIN,SAAS;SAE5BG,OAAO,CAACC,eAAe,CAAC,GAAGG,aAAa,CAACD,eAAe,EAAER,KAAK,EAAEO,IAAI,EAAEH,QAAQ,CAAC;SAChF,IAAII,eAAe,GAAGJ,QAAQ,EAC9B;WACCa,OAAO,GAAGN,YAAY,CAACO,aAAa,CAAC;UACrC,MAED;WACC,IAAIf,QAAQ,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAC9C;aACCA,QAAQ,EAAE;;;SAIZ,OAAOc,OAAO;QACd;OAED,OAAOC,aAAa,EAAE;;;KACtB;KAAA,uBAEaC,EAAE,EAChB;OACC,IAAMC,WAAW,GAChBR,MAAM,CAACS,oBAAoB,IACxBT,MAAM,CAACU,0BAA0B,IACjCV,MAAM,CAACW,uBAAuB,IAC9B,UAASJ,EAAE,EAAC;SAACK,YAAY,CAACL,EAAE,CAAC;QAChC;OAEDC,WAAW,CAACD,EAAE,CAAC;;;GACf;CAAA;CAGFrB,SAAS,CAAC2B,QAAQ,GAAG,EAAE;;;;;;;;"}