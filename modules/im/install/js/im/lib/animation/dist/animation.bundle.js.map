{"version":3,"file":"animation.bundle.js","sources":["../src/animation.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Animation manager\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nclass Animation\n{\n\tstatic start(params)\n\t{\n\t\tlet {\n\t\t\tstart = 0,\n\t\t\tend = 0,\n\t\t\tincrement = 20,\n\t\t\tcallback = () => {},\n\t\t\tduration = 500,\n\n\t\t\telement,\n\t\t\telementProperty\n\t\t} = params;\n\n\t\tlet diff = end - start;\n\t\tlet currentPosition = 0;\n\n\t\tconst easeInOutQuad = function (current, start, diff, duration)\n\t\t{\n\t\t\tcurrent /= duration/2;\n\n\t\t\tif (current < 1)\n\t\t\t{\n\t\t\t\treturn diff / 2 * current * current + start;\n\t\t\t}\n\n\t\t\tcurrent--;\n\n\t\t\treturn -diff/2 * (current*(current-2) - 1) + start;\n\t\t};\n\n\t\tconst requestFrame = (\n\t\t\twindow.requestAnimationFrame\n\t\t\t|| window.webkitRequestAnimationFrame\n\t\t\t|| window.mozRequestAnimationFrame\n\t\t\t|| function(callback){return window.setTimeout(callback, 1000 / 60);}\n\t\t);\n\n\t\tlet frameId = null;\n\t\tlet animateScroll = () =>\n\t\t{\n\t\t\tcurrentPosition += increment;\n\n\t\t\telement[elementProperty] = easeInOutQuad(currentPosition, start, diff, duration);\n\t\t\tif (currentPosition < duration)\n\t\t\t{\n\t\t\t\tframeId = requestFrame(animateScroll);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (callback && typeof callback === 'function')\n\t\t\t\t{\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn frameId;\n\t\t};\n\n\t\treturn animateScroll();\n\t}\n\n\tstatic cancel(id)\n\t{\n\t\tconst cancelFrame = (\n\t\t\twindow.cancelAnimationFrame\n\t\t\t|| window.webkitCancelAnimationFrame\n\t\t\t|| window.mozCancelAnimationFrame\n\t\t\t|| function(id){clearTimeout(id)}\n\t\t);\n\n\t\tcancelFrame(id);\n\t}\n}\n\nAnimation.frameIds = {};\n\nexport {Animation};\n\n"],"names":["Animation","params","start","end","increment","callback","duration","element","elementProperty","diff","currentPosition","easeInOutQuad","current","requestFrame","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","setTimeout","frameId","animateScroll","id","cancelFrame","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","clearTimeout","frameIds"],"mappings":";;;;;CAAA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;KAEMA;;;;;;;2BAEQC,QACb;CACC,0BASIA,MATJ,CACCC,KADD;CAAA,UACCA,KADD,8BACS,CADT;CAAA,wBASID,MATJ,CAECE,GAFD;CAAA,UAECA,GAFD,4BAEO,CAFP;CAAA,8BASIF,MATJ,CAGCG,SAHD;CAAA,UAGCA,SAHD,kCAGa,EAHb;CAAA,6BASIH,MATJ,CAICI,QAJD;CAAA,UAICA,QAJD,iCAIY,YAAM,EAJlB;CAAA,6BASIJ,MATJ,CAKCK,QALD;CAAA,UAKCA,QALD,iCAKY,GALZ;CAAA,UAOCC,OAPD,GASIN,MATJ,CAOCM,OAPD;CAAA,UAQCC,eARD,GASIP,MATJ,CAQCO,eARD;CAWA,UAAIC,IAAI,GAAGN,GAAG,GAAGD,KAAjB;CACA,UAAIQ,eAAe,GAAG,CAAtB;;CAEA,UAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAUC,OAAV,EAAmBV,KAAnB,EAA0BO,IAA1B,EAAgCH,QAAhC,EACtB;CACCM,QAAAA,OAAO,IAAIN,QAAQ,GAAC,CAApB;;CAEA,YAAIM,OAAO,GAAG,CAAd,EACA;CACC,iBAAOH,IAAI,GAAG,CAAP,GAAWG,OAAX,GAAqBA,OAArB,GAA+BV,KAAtC;CACA;;CAEDU,QAAAA,OAAO;CAEP,eAAO,CAACH,IAAD,GAAM,CAAN,IAAWG,OAAO,IAAEA,OAAO,GAAC,CAAV,CAAP,GAAsB,CAAjC,IAAsCV,KAA7C;CACA,OAZD;;CAcA,UAAMW,YAAY,GACjBC,MAAM,CAACC,qBAAP,IACGD,MAAM,CAACE,2BADV,IAEGF,MAAM,CAACG,wBAFV,IAGG,UAASZ,QAAT,EAAkB;CAAC,eAAOS,MAAM,CAACI,UAAP,CAAkBb,QAAlB,EAA4B,OAAO,EAAnC,CAAP;CAA+C,OAJtE;;CAOA,UAAIc,OAAO,GAAG,IAAd;;CACA,UAAIC,aAAa,GAAG,SAAhBA,aAAgB,GACpB;CACCV,QAAAA,eAAe,IAAIN,SAAnB;CAEAG,QAAAA,OAAO,CAACC,eAAD,CAAP,GAA2BG,aAAa,CAACD,eAAD,EAAkBR,KAAlB,EAAyBO,IAAzB,EAA+BH,QAA/B,CAAxC;;CACA,YAAII,eAAe,GAAGJ,QAAtB,EACA;CACCa,UAAAA,OAAO,GAAGN,YAAY,CAACO,aAAD,CAAtB;CACA,SAHD,MAKA;CACC,cAAIf,QAAQ,IAAI,OAAOA,QAAP,KAAoB,UAApC,EACA;CACCA,YAAAA,QAAQ;CACR;CACD;;CAED,eAAOc,OAAP;CACA,OAlBD;;CAoBA,aAAOC,aAAa,EAApB;CACA;;;4BAEaC,IACd;CACC,UAAMC,WAAW,GAChBR,MAAM,CAACS,oBAAP,IACGT,MAAM,CAACU,0BADV,IAEGV,MAAM,CAACW,uBAFV,IAGG,UAASJ,EAAT,EAAY;CAACK,QAAAA,YAAY,CAACL,EAAD,CAAZ;CAAiB,OAJlC;;CAOAC,MAAAA,WAAW,CAACD,EAAD,CAAX;CACA;;;;;CAGFrB,SAAS,CAAC2B,QAAV,GAAqB,EAArB;;;;;;;;"}