{"version":3,"file":"cookie.bundle.js","sources":["../src/cookie.js"],"sourcesContent":["/**\n * Bitrix Im\n * Cookie manager\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {LocalStorage} from \"im.lib.localstorage\";\n\nexport const Cookie =\n{\n\tget(siteId, name)\n\t{\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\n\t\tif (navigator.cookieEnabled)\n\t\t{\n\t\t\tlet result = document.cookie.match(new RegExp(\n\t\t\t\t\"(?:^|; )\" + cookieName.replace(/([.$?*|{}()\\[\\]\\\\\\/+^])/g, '\\\\$1') + \"=([^;]*)\"\n\t\t\t));\n\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\treturn decodeURIComponent(result[1]);\n\t\t\t}\n\t\t}\n\n\t\tif (LocalStorage.isEnabled())\n\t\t{\n\t\t\tlet result = LocalStorage.get(siteId, 0, name, undefined);\n\t\t\tif (typeof result !== 'undefined')\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof window.BX.GuestUserCookie === 'undefined')\n\t\t{\n\t\t\twindow.BX.GuestUserCookie = {};\n\t\t}\n\n\t\treturn window.BX.GuestUserCookie[cookieName];\n\t},\n\tset(siteId, name, value, options)\n\t{\n\t\toptions = options || {};\n\n\t\tlet expires = options.expires;\n\t\tif (typeof(expires) == \"number\" && expires)\n\t\t{\n\t\t\tlet currentDate = new Date();\n\t\t\tcurrentDate.setTime(currentDate.getTime() + expires * 1000);\n\t\t\texpires = options.expires = currentDate;\n\t\t}\n\n\t\tif (expires && expires.toUTCString)\n\t\t{\n\t\t\toptions.expires = expires.toUTCString();\n\t\t}\n\n\t\tvalue = encodeURIComponent(value);\n\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\t\tlet updatedCookie = cookieName + \"=\" + value;\n\n\t\tfor (let propertyName in options)\n\t\t{\n\t\t\tif (!options.hasOwnProperty(propertyName))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tupdatedCookie += \"; \" + propertyName;\n\n\t\t\tlet propertyValue = options[propertyName];\n\t\t\tif (propertyValue !== true)\n\t\t\t{\n\t\t\t\tupdatedCookie += \"=\" + propertyValue;\n\t\t\t}\n\t\t}\n\n\t\tdocument.cookie = updatedCookie;\n\n\t\tif (typeof window.BX.GuestUserCookie === 'undefined')\n\t\t{\n\t\t\tBX.GuestUserCookie = {};\n\t\t}\n\n\t\twindow.BX.GuestUserCookie[cookieName] = value;\n\t\tLocalStorage.set(siteId, 0, name, value);\n\n\t\treturn true;\n\t}\n};"],"names":["Cookie","get","siteId","name","cookieName","navigator","cookieEnabled","result","document","cookie","match","RegExp","replace","decodeURIComponent","LocalStorage","isEnabled","undefined","window","BX","GuestUserCookie","set","value","options","expires","currentDate","Date","setTime","getTime","toUTCString","encodeURIComponent","updatedCookie","propertyName","hasOwnProperty","propertyValue"],"mappings":";;;;;;CAAA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;KAIaA,MAAM,GACnB;GACCC,GAAG,eAACC,MAAM,EAAEC,IAAI,EAChB;KACC,IAAIC,UAAU,GAAGF,MAAM,GAAEA,MAAM,GAAC,GAAG,GAACC,IAAI,GAAEA,IAAI;KAE9C,IAAIE,SAAS,CAACC,aAAa,EAC3B;OACC,IAAIC,MAAM,GAAGC,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAC,IAAIC,MAAM,CAC5C,UAAU,GAAGP,UAAU,CAACQ,OAAO,CAAC,0BAA0B,EAAE,MAAM,CAAC,GAAG,UAAU,CAChF,CAAC;OAEF,IAAIL,MAAM,EACV;SACC,OAAOM,kBAAkB,CAACN,MAAM,CAAC,CAAC,CAAC,CAAC;;;KAItC,IAAIO,gCAAY,CAACC,SAAS,EAAE,EAC5B;OACC,IAAIR,OAAM,GAAGO,gCAAY,CAACb,GAAG,CAACC,MAAM,EAAE,CAAC,EAAEC,IAAI,EAAEa,SAAS,CAAC;OACzD,IAAI,OAAOT,OAAM,KAAK,WAAW,EACjC;SACC,OAAOA,OAAM;;;KAIf,IAAI,OAAOU,MAAM,CAACC,EAAE,CAACC,eAAe,KAAK,WAAW,EACpD;OACCF,MAAM,CAACC,EAAE,CAACC,eAAe,GAAG,EAAE;;KAG/B,OAAOF,MAAM,CAACC,EAAE,CAACC,eAAe,CAACf,UAAU,CAAC;IAC5C;GACDgB,GAAG,eAAClB,MAAM,EAAEC,IAAI,EAAEkB,KAAK,EAAEC,OAAO,EAChC;KACCA,OAAO,GAAGA,OAAO,IAAI,EAAE;KAEvB,IAAIC,OAAO,GAAGD,OAAO,CAACC,OAAO;KAC7B,IAAI,OAAOA,OAAQ,IAAI,QAAQ,IAAIA,OAAO,EAC1C;OACC,IAAIC,WAAW,GAAG,IAAIC,IAAI,EAAE;OAC5BD,WAAW,CAACE,OAAO,CAACF,WAAW,CAACG,OAAO,EAAE,GAAGJ,OAAO,GAAG,IAAI,CAAC;OAC3DA,OAAO,GAAGD,OAAO,CAACC,OAAO,GAAGC,WAAW;;KAGxC,IAAID,OAAO,IAAIA,OAAO,CAACK,WAAW,EAClC;OACCN,OAAO,CAACC,OAAO,GAAGA,OAAO,CAACK,WAAW,EAAE;;KAGxCP,KAAK,GAAGQ,kBAAkB,CAACR,KAAK,CAAC;KAEjC,IAAIjB,UAAU,GAAGF,MAAM,GAAEA,MAAM,GAAC,GAAG,GAACC,IAAI,GAAEA,IAAI;KAC9C,IAAI2B,aAAa,GAAG1B,UAAU,GAAG,GAAG,GAAGiB,KAAK;KAE5C,KAAK,IAAIU,YAAY,IAAIT,OAAO,EAChC;OACC,IAAI,CAACA,OAAO,CAACU,cAAc,CAACD,YAAY,CAAC,EACzC;SACC;;OAEDD,aAAa,IAAI,IAAI,GAAGC,YAAY;OAEpC,IAAIE,aAAa,GAAGX,OAAO,CAACS,YAAY,CAAC;OACzC,IAAIE,aAAa,KAAK,IAAI,EAC1B;SACCH,aAAa,IAAI,GAAG,GAAGG,aAAa;;;KAItCzB,QAAQ,CAACC,MAAM,GAAGqB,aAAa;KAE/B,IAAI,OAAOb,MAAM,CAACC,EAAE,CAACC,eAAe,KAAK,WAAW,EACpD;OACCD,EAAE,CAACC,eAAe,GAAG,EAAE;;KAGxBF,MAAM,CAACC,EAAE,CAACC,eAAe,CAACf,UAAU,CAAC,GAAGiB,KAAK;KAC7CP,gCAAY,CAACM,GAAG,CAAClB,MAAM,EAAE,CAAC,EAAEC,IAAI,EAAEkB,KAAK,CAAC;KAExC,OAAO,IAAI;;CAEb,CAAC;;;;;;;;"}