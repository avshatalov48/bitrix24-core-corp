{"version":3,"file":"logger.bundle.js","sources":["../src/logger.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Logger class\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Type} from \"main.core\";\n\nclass Logger\n{\n\t#types = {};\n\t#config = {};\n\t#custom = {};\n\t#localStorageKey = 'bx-messenger-logger';\n\n\tconstructor()\n\t{\n\t\tthis.#types = {\n\t\t\tdesktop: true,\n\t\t\tlog: false,\n\t\t\tinfo: false,\n\t\t\twarn: false,\n\t\t\terror: true,\n\t\t\ttrace: true,\n\t\t};\n\n\t\tthis.#config = this.#types;\n\n\t\tthis.#load();\n\t}\n\n\tsetConfig(types: Object)\n\t{\n\t\tObject.entries(types).forEach(([type, value]) => {\n\t\t\tif (!Type.isUndefined(this.#types[type]))\n\t\t\t{\n\t\t\t\tthis.#types[type] = !!value;\n\t\t\t\tthis.#config[type] = !!value;\n\t\t\t}\n\t\t});\n\n\t\tthis.#load();\n\t}\n\n\tenable(type: string)\n\t{\n\t\tif (Type.isUndefined(this.#types[type]))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.#types[type] = true;\n\t\tthis.#custom[type] = true;\n\n\t\tthis.#save();\n\n\t\treturn true;\n\t}\n\n\tdisable(type: string)\n\t{\n\t\tif (Type.isUndefined(this.#types[type]))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.#types[type] = false;\n\t\tthis.#custom[type] = false;\n\n\t\tthis.#save();\n\n\t\treturn true;\n\t}\n\n\tisEnabled(type: string): boolean\n\t{\n\t\treturn this.#types[type] === true;\n\t}\n\n\tdesktop(...params)\n\t{\n\t\tif (!this.isEnabled('desktop'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.log(...Logger.#getStyles('desktop'), ...params);\n\t}\n\n\tlog(...params)\n\t{\n\t\tif (!this.isEnabled('log'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.log(...Logger.#getStyles('log'), ...params);\n\t}\n\n\tinfo(...params)\n\t{\n\t\tif (!this.isEnabled('info'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.info(...Logger.#getStyles('info'), ...params);\n\t}\n\n\twarn(...params)\n\t{\n\t\tif (!this.isEnabled('warn'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.warn(...Logger.#getStyles('warn'), ...params);\n\t}\n\n\terror(...params)\n\t{\n\t\tif (!this.isEnabled('error'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.error(...Logger.#getStyles('error'), ...params);\n\t}\n\n\ttrace(...params)\n\t{\n\t\tif (!this.isEnabled('trace'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.trace(...params);\n\t}\n\n\t#save()\n\t{\n\t\tif (Type.isUndefined(window.localStorage))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst custom = {};\n\t\t\tObject.entries(this.#custom).forEach(([type, value]) => {\n\t\t\t\tif (this.#config[type] !== this.#custom[type])\n\t\t\t\t{\n\t\t\t\t\tcustom[type] = !!value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconsole.warn('Logger: saving custom types', JSON.stringify(custom));\n\n\t\t\twindow.localStorage.setItem(this.#localStorageKey, JSON.stringify(custom));\n\t\t}\n\t\tcatch (error) {\n\t\t\tconsole.error('Logger: save error', error);\n\t\t}\n\t}\n\n\t#load()\n\t{\n\t\tif (Type.isUndefined(window.localStorage))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst custom = window.localStorage.getItem(this.#localStorageKey);\n\t\t\tif (Type.isString(custom))\n\t\t\t{\n\t\t\t\tthis.#custom = JSON.parse(custom);\n\t\t\t\tthis.#types = {...this.#types, ...this.#custom};\n\t\t\t}\n\t\t}\n\t\tcatch (error) {\n\t\t\tconsole.error('Logger: load error', error);\n\t\t}\n\t}\n\n\tstatic #getStyles(type: string = 'all'): Object | Array\n\t{\n\t\tconst styles = {\n\t\t\t'desktop': [\"%cDESKTOP\", \"color: white; font-style: italic; background-color: #29619b; padding: 0 6px\"],\n\t\t\t'log': [\"%cLOG\", \"color: #2a323b; font-style: italic; background-color: #ccc; padding: 0 6px\"],\n\t\t\t'info': [\"%cINFO\", \"color: #fff; font-style: italic; background-color: #6b7f96; padding: 0 6px\"],\n\t\t\t'warn': [\"%cWARNING\", \"color: white; font-style: italic; padding: 0 6px; border: 1px solid #f0a74f\"],\n\t\t\t'error': [\"%cERROR\", \"color: white; font-style: italic; padding: 0 6px; border: 1px solid #8a3232\"],\n\t\t};\n\n\t\tif (type === 'all')\n\t\t{\n\t\t\treturn styles;\n\t\t}\n\n\t\tif (styles[type])\n\t\t{\n\t\t\treturn styles[type];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tstatic #getRemoveString()\n\t{\n\t\tconst styles = Logger.#getStyles();\n\t\tconst result = [];\n\n\t\tObject.entries(styles).forEach(([, style]) => {\n\t\t\tresult.push(style[1]);\n\t\t});\n\n\t\treturn result;\n\t}\n}\n\nconst logger = new Logger();\n\nexport {logger as Logger};"],"names":["Logger","constructor","desktop","log","info","warn","error","trace","setConfig","types","Object","entries","forEach","type","value","Type","isUndefined","enable","disable","isEnabled","params","console","window","localStorage","custom","JSON","stringify","setItem","getItem","isString","parse","styles","result","style","push","logger"],"mappings":"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"}