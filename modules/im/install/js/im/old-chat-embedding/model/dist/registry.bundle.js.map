{"version":3,"file":"registry.bundle.js","sources":["../src/application.js","../src/dialogues.js","../src/users.js","../src/recent.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {DeviceType, DeviceOrientation, Settings} from 'im.old-chat-embedding.const';\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\thost: this.getVariable('common.host', `${location.protocol}//${location.host}`),\n\t\t\t\tsiteId: this.getVariable('common.siteId', 'default'),\n\t\t\t\tuserId: this.getVariable('common.userId', 0),\n\t\t\t\tlanguageId: this.getVariable('common.languageId', 'en'),\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tdialogId: this.getVariable('dialog.dialogId', '0'),\n\t\t\t\tchatId: this.getVariable('dialog.chatId', 0),\n\t\t\t\tdiskFolderId: this.getVariable('dialog.diskFolderId', 0),\n\t\t\t\tmessageLimit: this.getVariable('dialog.messageLimit', 20),\n\t\t\t\tenableReadMessages: this.getVariable('dialog.enableReadMessages', true),\n\t\t\t},\n\t\t\tdisk:\n\t\t\t{\n\t\t\t\tenabled: false,\n\t\t\t\tmaxFileSize: 5242880,\n\t\t\t},\n\t\t\tcall:\n\t\t\t{\n\t\t\t\tserverEnabled: false,\n\t\t\t\tmaxParticipants: 24,\n\t\t\t},\n\t\t\tmobile:\n\t\t\t{\n\t\t\t\tkeyboardShow: false,\n\t\t\t},\n\t\t\tdevice:\n\t\t\t{\n\t\t\t\ttype: this.getVariable('device.type', DeviceType.desktop),\n\t\t\t\torientation: this.getVariable('device.orientation', DeviceOrientation.portrait),\n\t\t\t},\n\t\t\toptions:\n\t\t\t{\n\t\t\t\tquoteEnable: this.getVariable('options.quoteEnable', true),\n\t\t\t\tquoteFromRight: this.getVariable('options.quoteFromRight', true),\n\t\t\t\tautoplayVideo: this.getVariable('options.autoplayVideo', true),\n\t\t\t\tdarkTheme: this.getVariable('options.darkTheme', false),\n\t\t\t\tbigSmileEnable: this.getVariable('options.bigSmileEnable', true),\n\t\t\t},\n\t\t\terror:\n\t\t\t{\n\t\t\t\tactive: false,\n\t\t\t\tcode: '',\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetOption: state => (optionName: string) =>\n\t\t\t{\n\t\t\t\tif (!Settings[optionName])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.options[optionName];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetOptions: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tpayload = this.validateOptions(payload);\n\t\t\t\tObject.entries(payload).forEach(([option, value]) => {\n\t\t\t\t\tstore.commit('setOptions', {\n\t\t\t\t\t\toption,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tupdate: (state, payload) => {\n\t\t\t\tObject.keys(payload).forEach((group) => {\n\t\t\t\t\tObject.entries(payload[group]).forEach(([key, value]) => {\n\t\t\t\t\t\tstate[group][key] = value;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetOptions: (state, payload) => {\n\t\t\t\tstate.options[payload.option] = payload.value;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.common === 'object' && fields.common)\n\t\t{\n\t\t\tresult.common = {};\n\n\t\t\tif (typeof fields.common.userId === 'number')\n\t\t\t{\n\t\t\t\tresult.common.userId = fields.common.userId;\n\t\t\t}\n\n\t\t\tif (typeof fields.common.languageId === 'string')\n\t\t\t{\n\t\t\t\tresult.common.languageId = fields.common.languageId;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.dialog === 'object' && fields.dialog)\n\t\t{\n\t\t\tresult.dialog = {};\n\n\t\t\tif (typeof fields.dialog.dialogId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId.toString();\n\t\t\t\tresult.dialog.chatId = 0;\n\t\t\t}\n\t\t\telse if (typeof fields.dialog.dialogId === 'string')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId;\n\n\t\t\t\tif (typeof fields.dialog.chatId !== 'number')\n\t\t\t\t{\n\t\t\t\t\tlet chatId = fields.dialog.dialogId;\n\t\t\t\t\tif (chatId.startsWith('chat'))\n\t\t\t\t\t{\n\t\t\t\t\t\tchatId = fields.dialog.dialogId.substr(4);\n\t\t\t\t\t}\n\n\t\t\t\t\tchatId = parseInt(chatId);\n\n\t\t\t\t\tresult.dialog.chatId = !isNaN(chatId)? chatId: 0;\n\t\t\t\t\tfields.dialog.chatId = result.dialog.chatId;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.chatId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.chatId = fields.dialog.chatId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.diskFolderId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.diskFolderId = fields.dialog.diskFolderId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.messageLimit === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.messageLimit = fields.dialog.messageLimit;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.enableReadMessages === 'boolean')\n\t\t\t{\n\t\t\t\tresult.dialog.enableReadMessages = fields.dialog.enableReadMessages;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.disk === 'object' && fields.disk)\n\t\t{\n\t\t\tresult.disk = {};\n\n\t\t\tif (typeof fields.disk.enabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.disk.enabled = fields.disk.enabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.disk.maxFileSize === 'number')\n\t\t\t{\n\t\t\t\tresult.disk.maxFileSize = fields.disk.maxFileSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.call === 'object' && fields.call)\n\t\t{\n\t\t\tresult.call = {};\n\n\t\t\tif (typeof fields.call.serverEnabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.call.serverEnabled = fields.call.serverEnabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.call.maxParticipants === 'number')\n\t\t\t{\n\t\t\t\tresult.call.maxParticipants = fields.call.maxParticipants;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.mobile === 'object' && fields.mobile)\n\t\t{\n\t\t\tresult.mobile = {};\n\n\t\t\tif (typeof fields.mobile.keyboardShow === 'boolean')\n\t\t\t{\n\t\t\t\tresult.mobile.keyboardShow = fields.mobile.keyboardShow;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.device === 'object' && fields.device)\n\t\t{\n\t\t\tresult.device = {};\n\n\t\t\tif (typeof fields.device.type === 'string' && typeof DeviceType[fields.device.type] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.type = fields.device.type;\n\t\t\t}\n\n\t\t\tif (typeof fields.device.orientation === 'string' && typeof DeviceOrientation[fields.device.orientation] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.orientation = fields.device.orientation;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.error === 'object' && fields.error)\n\t\t{\n\t\t\tif (typeof fields.error.active === 'boolean')\n\t\t\t{\n\t\t\t\tresult.error = {\n\t\t\t\t\tactive: fields.error.active,\n\t\t\t\t\tcode: fields.error.code.toString() || '',\n\t\t\t\t\tdescription: fields.error.description.toString() || '',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateOptions(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(fields.darkTheme) && Type.isStringFilled(fields.darkTheme))\n\t\t{\n\t\t\tif (fields.darkTheme === 'auto' && BX.MessengerProxy)\n\t\t\t{\n\t\t\t\tresult.darkTheme = BX.MessengerProxy.isDarkTheme();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.darkTheme = fields.darkTheme === 'dark';\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Text, Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.old-chat-embedding.application.core';\nimport {ChatOption, Color, DialogType} from 'im.old-chat-embedding.const';\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\n\nimport type {Dialog as ImModelDialog} from './type/dialog';\n\nconst WRITING_STATUS_TIME = 35000;\n\ntype DialogState = {\n\tcollection: {[dialogId: string]: ImModelDialog},\n\twritingStatusTimers: {[timerId: string]: number},\n\tchatOptions: {[chatType: string]: {[option: string]: boolean}}\n};\n\nexport class DialoguesModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'dialogues';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\twritingStatusTimers: {},\n\t\t\tchatOptions: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: DialogType.chat,\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\textranet: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tlastReadId: 0,\n\t\t\tmarkedId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tlastMessageViews: {\n\t\t\t\tcountOfViewers: 0,\n\t\t\t\tfirstViewer: null,\n\t\t\t\tmessageId: 0\n\t\t\t},\n\t\t\tsavedPositionMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\ttextareaMessage: '',\n\t\t\tquoteId: 0,\n\t\t\towner: 0,\n\t\t\tentityType: '',\n\t\t\tentityId: '',\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: ''\n\t\t\t},\n\t\t\tinited: false,\n\t\t\tloading: false,\n\t\t\thasPrevPage: false,\n\t\t\thasNextPage: false,\n\t\t\tdiskFolderId: 0,\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state: DialogState) => (dialogId: string, getBlank: boolean = false) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\t\t\t\telse if (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\tgetByChatId: (state: DialogState) => (chatId: number | string) =>\n\t\t\t{\n\t\t\t\tchatId = Number.parseInt(chatId, 10);\n\t\t\t\treturn Object.values(state.collection).find(item => {\n\t\t\t\t\treturn item.chatId === chatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetBlank: () =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetChatOption: (state: DialogState) => (chatType: string, option: string) =>\n\t\t\t{\n\t\t\t\tif (!state.chatOptions[chatType])\n\t\t\t\t{\n\t\t\t\t\tchatType = 'default';\n\t\t\t\t}\n\n\t\t\t\treturn state.chatOptions[chatType][option];\n\t\t\t},\n\t\t\tgetQuoteId: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\tisUser: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === DialogType.user;\n\t\t\t},\n\t\t\tcanLeave: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = state.collection[dialogId];\n\n\t\t\t\tconst isExternalTelephonyCall = dialog.type === DialogType.call;\n\t\t\t\tconst isUser = dialog.type === DialogType.user;\n\t\t\t\tif (isExternalTelephonyCall || isUser)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst optionToCheck = dialog.owner === currentUserId ? ChatOption.leaveOwner : ChatOption.leave;\n\n\t\t\t\treturn this.store.getters['dialogues/getChatOption'](dialog.type, optionToCheck);\n\t\t\t},\n\t\t\tcanMute: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = state.collection[dialogId];\n\n\t\t\t\tconst isUser = dialog.type === DialogType.user;\n\t\t\t\tconst isAnnouncement = dialog.type === DialogType.announcement;\n\t\t\t\tif (isUser || isAnnouncement)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn this.store.getters['dialogues/getChatOption'](dialog.type, ChatOption.mute);\n\t\t\t},\n\t\t\tgetLastReadId: (state: DialogState) => (dialogId: string): number =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst {lastReadId, lastMessageId} = state.collection[dialogId];\n\n\t\t\t\treturn lastReadId === lastMessageId ? 0 : lastReadId;\n\t\t\t},\n\t\t\tgetInitialMessageId: (state: DialogState) => (dialogId: string): number =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst {lastReadId, markedId} = state.collection[dialogId];\n\t\t\t\tif (markedId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn lastReadId;\n\t\t\t\t}\n\n\t\t\t\treturn Math.min(lastReadId, markedId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tadd: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {dialogId: payload.dialogId});\n\t\t\t},\n\n\t\t\tstartWriting: (store, payload: {dialogId: string, userId: number, userName: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tconst alreadyWriting = existingItem.writingList.some(el => el.userId === payload.userId);\n\t\t\t\tif (alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst newItem = {userId: payload.userId, userName: payload.userName};\n\t\t\t\tconst newWritingList = [newItem, ...existingItem.writingList];\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'startWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.writingStatusTimers[timerId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tstopWriting: (store, payload: {dialogId: string, userId: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst alreadyWriting = existingItem.writingList.find(el => el.userId === payload.userId);\n\t\t\t\tif (!alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newWritingList = existingItem.writingList.filter(item => item.userId !== payload.userId);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'stopWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\tdelete store.state.writingStatusTimers[timerId];\n\t\t\t},\n\n\t\t\tincreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet increasedCounter = existingItem.counter + payload.count;\n\t\t\t\tif (increasedCounter > 100)\n\t\t\t\t{\n\t\t\t\t\tincreasedCounter = 100;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: increasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdecreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet decreasedCounter = existingItem.counter - payload.count;\n\t\t\t\tif (decreasedCounter < 0)\n\t\t\t\t{\n\t\t\t\t\tdecreasedCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'decreaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: decreasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearCounters: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearCounters');\n\t\t\t},\n\n\t\t\tmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst muteList = existingItem.muteList.filter(item => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetChatOptions: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tstore.commit('setChatOptions', this.validateChatOptions(payload));\n\t\t\t},\n\n\t\t\tsetLastMessageViews: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tfields: {userId: number, userName: string, date: string, messageId: number}\n\t\t\t}) =>\n\t\t\t{\n\t\t\t\tconst {dialogId, fields: {userId, userName, date, messageId}} = payload;\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newLastMessageViews = {\n\t\t\t\t\tcountOfViewers: 1,\n\t\t\t\t\tmessageId,\n\t\t\t\t\tfirstViewer: {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdate: Utils.date.cast(date)\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'setLastMessageViews',\n\t\t\t\t\tdialogId: dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: newLastMessageViews\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearLastMessageViews: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst {lastMessageViews: defaultLastMessageViews} = this.getElementState();\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'clearLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: defaultLastMessageViews\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tincrementLastMessageViews: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newCounter = existingItem.lastMessageViews.countOfViewers + 1;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'incrementLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: {...existingItem.lastMessageViews, countOfViewers: newCounter}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = {...state.collection[payload.dialogId], ...payload.fields};\n\t\t\t},\n\t\t\tdelete: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tsetChatOptions: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.chatOptions = payload;\n\t\t\t},\n\t\t\tclearCounters: (state: DialogState) =>\n\t\t\t{\n\t\t\t\tObject.keys(state.collection).forEach(key => {\n\t\t\t\t\tstate.collection[key].counter = 0;\n\t\t\t\t\tstate.collection[key].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tsetWritingStatusTimeout(payload: {dialogId: string, userId: number})\n\t{\n\t\treturn setTimeout(() => {\n\t\t\tthis.store.dispatch('dialogues/stopWriting', {\n\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\tuserId: payload.userId\n\t\t\t});\n\t\t}, WRITING_STATUS_TIME);\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(fields.dialog_id))\n\t\t{\n\t\t\tfields.dialogId = fields.dialog_id;\n\t\t}\n\t\tif (Type.isNumber(fields.dialogId) || Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.id))\n\t\t{\n\t\t\tfields.chatId = fields.id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.type))\n\t\t{\n\t\t\tresult.type = fields.type.toString();\n\t\t}\n\n\t\tif (Type.isNumber(fields.quoteId))\n\t\t{\n\t\t\tresult.quoteId = Number.parseInt(fields.quoteId, 10);\n\t\t}\n\n\t\tif (Type.isNumber(fields.counter) || Type.isStringFilled(fields.counter))\n\t\t{\n\t\t\tresult.counter = Number.parseInt(fields.counter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.user_counter))\n\t\t{\n\t\t\tresult.userCounter = fields.user_counter;\n\t\t}\n\t\tif (Type.isNumber(fields.userCounter) || Type.isStringFilled(fields.userCounter))\n\t\t{\n\t\t\tresult.userCounter = Number.parseInt(fields.userCounter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_id))\n\t\t{\n\t\t\tfields.lastId = fields.last_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastId))\n\t\t{\n\t\t\tresult.lastReadId = fields.lastId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.marked_id))\n\t\t{\n\t\t\tfields.markedId = fields.marked_id;\n\t\t}\n\t\tif (Type.isNumber(fields.markedId))\n\t\t{\n\t\t\tresult.markedId = fields.markedId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_message_id))\n\t\t{\n\t\t\tfields.lastMessageId = fields.last_message_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastMessageId) || Type.isStringFilled(fields.lastMessageId))\n\t\t{\n\t\t\tresult.lastMessageId = Number.parseInt(fields.lastMessageId, 10);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.last_message_views))\n\t\t{\n\t\t\tfields.lastMessageViews = fields.last_message_views;\n\t\t}\n\t\tif (Type.isPlainObject(fields.lastMessageViews))\n\t\t{\n\t\t\tresult.lastMessageViews = this.prepareLastMessageViews(fields.lastMessageViews);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasPrevPage))\n\t\t{\n\t\t\tresult.hasPrevPage = fields.hasPrevPage;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasNextPage))\n\t\t{\n\t\t\tresult.hasNextPage = fields.hasNextPage;\n\t\t}\n\n\t\tif (Type.isNumber(fields.savedPositionMessageId))\n\t\t{\n\t\t\tresult.savedPositionMessageId = fields.savedPositionMessageId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.textareaMessage))\n\t\t{\n\t\t\tresult.textareaMessage = fields.textareaMessage.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.title))\n\t\t{\n\t\t\tfields.name = fields.title;\n\t\t}\n\t\tif (Type.isNumber(fields.name) || Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = Text.decode(fields.name.toString());\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.owner))\n\t\t{\n\t\t\tfields.ownerId = fields.owner;\n\t\t}\n\t\tif (Type.isNumber(fields.ownerId) || Type.isStringFilled(fields.ownerId))\n\t\t{\n\t\t\tresult.owner = Number.parseInt(fields.ownerId, 10);\n\t\t}\n\n\t\tif (Type.isString(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.entity_type))\n\t\t{\n\t\t\tfields.entityType = fields.entity_type;\n\t\t}\n\t\tif (Type.isStringFilled(fields.entityType))\n\t\t{\n\t\t\tresult.entityType = fields.entityType;\n\t\t}\n\t\tif (!Type.isUndefined(fields.entity_id))\n\t\t{\n\t\t\tfields.entityId = fields.entity_id;\n\t\t}\n\t\tif (Type.isNumber(fields.entityId) || Type.isStringFilled(fields.entityId))\n\t\t{\n\t\t\tresult.entityId = fields.entityId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.date_create))\n\t\t{\n\t\t\tfields.dateCreate = fields.date_create;\n\t\t}\n\t\tif (!Type.isUndefined(fields.dateCreate))\n\t\t{\n\t\t\tresult.dateCreate = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.public))\n\t\t{\n\t\t\tresult.public = {};\n\n\t\t\tif (Type.isStringFilled(fields.public.code))\n\t\t\t{\n\t\t\t\tresult.public.code = fields.public.code;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(fields.public.link))\n\t\t\t{\n\t\t\t\tresult.public.link = fields.public.link;\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.writing_list))\n\t\t{\n\t\t\tfields.writingList = fields.writing_list;\n\t\t}\n\t\tif (Type.isArray(fields.writingList))\n\t\t{\n\t\t\tresult.writingList = this.prepareWritingList(fields.writingList);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.manager_list))\n\t\t{\n\t\t\tfields.managerList = fields.manager_list;\n\t\t}\n\t\tif (Type.isArray(fields.managerList))\n\t\t{\n\t\t\tresult.managerList = [];\n\n\t\t\tfields.managerList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.managerList.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.mute_list))\n\t\t{\n\t\t\tfields.muteList = fields.mute_list;\n\t\t}\n\t\tif (Type.isArray(fields.muteList) || Type.isPlainObject(fields.muteList))\n\t\t{\n\t\t\tresult.muteList = this.prepareMuteList(fields.muteList);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.inited))\n\t\t{\n\t\t\tresult.inited = fields.inited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.loading))\n\t\t{\n\t\t\tresult.loading = fields.loading;\n\t\t}\n\n\t\tif (Type.isString(fields.description))\n\t\t{\n\t\t\tresult.description = fields.description;\n\t\t}\n\n\t\tif (Type.isNumber(fields.disk_folder_id))\n\t\t{\n\t\t\tresult.diskFolderId = fields.disk_folder_id;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = this.store.state.application.common.host + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareWritingList(writingList: Object[]): Array<{userId: number, userName: string}>\n\t{\n\t\tconst result = [];\n\n\t\twritingList.forEach(element =>\n\t\t{\n\t\t\tconst item = {};\n\n\t\t\tif (!element.userId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\t\titem.userName = Utils.text.htmlspecialcharsback(element.userName);\n\n\t\t\tresult.push(item);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprepareMuteList(muteList: Object[] | Object): Object[]\n\t{\n\t\tconst result = [];\n\n\t\tif (Type.isArray(muteList))\n\t\t{\n\t\t\tmuteList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isPlainObject(muteList))\n\t\t{\n\t\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\t\tif (!value)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareLastMessageViews(rawLastMessageViews): {countOfViewers: number, firstViewers: Object[], messageId: number}\n\t{\n\t\tconst {\n\t\t\tcount_of_viewers: countOfViewers,\n\t\t\tfirst_viewers: rawFirstViewers,\n\t\t\tmessage_id: messageId\n\t\t} = rawLastMessageViews;\n\n\t\tlet firstViewer;\n\t\trawFirstViewers.forEach(rawFirstViewer => {\n\t\t\tif (rawFirstViewer.user_id === Core.getUserId())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfirstViewer = {\n\t\t\t\tuserId: rawFirstViewer.user_id,\n\t\t\t\tuserName: rawFirstViewer.user_name,\n\t\t\t\tdate: Utils.date.cast(rawFirstViewer.date)\n\t\t\t};\n\t\t});\n\n\t\tif (countOfViewers > 0 && !firstViewer)\n\t\t{\n\t\t\tthrow new Error('Dialogues model: no first viewer for message');\n\t\t}\n\n\t\treturn {\n\t\t\tcountOfViewers,\n\t\t\tfirstViewer,\n\t\t\tmessageId\n\t\t};\n\t}\n\n\tvalidateChatOptions(options: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tObject.entries(options).forEach(([type, typeOptions]) => {\n\t\t\tconst newType = Utils.text.convertSnakeToCamelCase(type.toLowerCase());\n\t\t\tresult[newType] = {};\n\t\t\tObject.entries(typeOptions).forEach(([key, value]) => {\n\t\t\t\tconst newKey = Utils.text.convertSnakeToCamelCase(key.toLowerCase());\n\t\t\t\tresult[newType][newKey] = value;\n\t\t\t});\n\t\t});\n\n\t\treturn result;\n\t}\n}","import {Type, Loc} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\nimport {UserStatus, BotType, Color} from 'im.old-chat-embedding.const';\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: [],\n\t\t\tbotList: {}\n\t\t};\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tconst {id = 0} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (userId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tif (userId <= 0)\n\t\t\t\t{\n\t\t\t\t\tif (getTemporary)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserId = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\telse if (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\tgetBlank: () => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\tgetList: state => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({id}));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\thasBirthday: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\thasVacation: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isAbsent;\n\t\t\t},\n\t\t\tgetStatus: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!user.isOnline)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.isMobileOnline)\n\t\t\t\t{\n\t\t\t\t\treturn UserStatus.mobileOnline;\n\t\t\t\t}\n\t\t\t\telse if (user.idle)\n\t\t\t\t{\n\t\t\t\t\t// away by time\n\t\t\t\t\treturn UserStatus.idle;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// manually selected status (online, away, dnd, break)\n\t\t\t\t\treturn user.status;\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetLastOnline: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\tgetPosition: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\treturn Loc.getMessage('IM_EMBED_MODEL_USERS_DEFAULT_NAME');\n\t\t\t},\n\t\t\tgetBotType: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user || !user.bot || !state.botList[userId])\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tconst botType = state.botList[userId].type;\n\n\t\t\t\tif (!BotType[botType])\n\t\t\t\t{\n\t\t\t\t\treturn BotType.bot;\n\t\t\t\t}\n\n\t\t\t\treturn botType;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\tsetBotList: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setBotList', payload);\n\t\t\t},\n\t\t\tsetStatus: (store, payload: {status: string}) =>\n\t\t\t{\n\t\t\t\tconst currentUserId = this.store.state.application.common.userId;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: currentUserId,\n\t\t\t\t\tfields: this.validate(payload)\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\t\t\t\tconst user = state.collection[payload.id];\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t\tthis.addToOnlineList(user.id);\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t\tthis.addToMobileOnlineList(user.id);\n\t\t\t\t}\n\n\t\t\t\tif (user.birthday && Utils.user.isBirthdayToday(user.birthday))\n\t\t\t\t{\n\t\t\t\t\tuser.isBirthday = true;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuser.isBirthday = false;\n\t\t\t\t\t}, Utils.date.getTimeToNextMidnight());\n\t\t\t\t}\n\n\t\t\t\tif (user.absent)\n\t\t\t\t{\n\t\t\t\t\tuser.isAbsent = true;\n\t\t\t\t\tthis.addToAbsentList(user.id);\n\t\t\t\t}\n\n\t\t\t\tthis.startOnlineCheckInterval();\n\t\t\t\tthis.startAbsentCheckInterval();\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst user = state.collection[payload.id];\n\t\t\t\tif (Utils.user.isOnline(payload.fields.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t\tthis.addToOnlineList(payload.fields.id);\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(payload.fields.lastActivityDate, payload.fields.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t\tthis.addToMobileOnlineList(payload.fields.id);\n\t\t\t\t}\n\n\t\t\t\tif (payload.fields.absent === false)\n\t\t\t\t{\n\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\treturn element !== payload.id;\n\t\t\t\t\t});\n\t\t\t\t\tstate.collection[payload.id].isAbsent = false;\n\t\t\t\t}\n\t\t\t\telse if (Type.isDate(payload.fields.absent))\n\t\t\t\t{\n\t\t\t\t\tstate.collection[payload.id].isAbsent = true;\n\t\t\t\t\tthis.addToAbsentList(payload.id);\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.id] = {...state.collection[payload.id], ...payload.fields};\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t\tsetBotList: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.botList = payload;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id) || Type.isString(fields.id))\n\t\t{\n\t\t\tresult.id = Number.parseInt(fields.id, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.first_name))\n\t\t{\n\t\t\tfields.firstName = fields.first_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.last_name))\n\t\t{\n\t\t\tfields.lastName = fields.last_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.firstName))\n\t\t{\n\t\t\tresult.firstName = Utils.text.htmlspecialcharsback(fields.firstName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.lastName))\n\t\t{\n\t\t\tresult.lastName = Utils.text.htmlspecialcharsback(fields.lastName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tfields.name = Utils.text.htmlspecialcharsback(fields.name);\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.work_position))\n\t\t{\n\t\t\tfields.workPosition = fields.work_position;\n\t\t}\n\t\tif (Type.isStringFilled(fields.workPosition))\n\t\t{\n\t\t\tresult.workPosition = Utils.text.htmlspecialcharsback(fields.workPosition);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.gender))\n\t\t{\n\t\t\tresult.gender = fields.gender === 'F'? 'F': 'M';\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.birthday))\n\t\t{\n\t\t\tresult.birthday = fields.birthday;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.network))\n\t\t{\n\t\t\tresult.network = fields.network;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.bot))\n\t\t{\n\t\t\tresult.bot = fields.bot;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.connector))\n\t\t{\n\t\t\tresult.connector = fields.connector;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.external_auth_id))\n\t\t{\n\t\t\tfields.externalAuthId = fields.external_auth_id;\n\t\t}\n\t\tif (Type.isStringFilled(fields.externalAuthId))\n\t\t{\n\t\t\tresult.externalAuthId = fields.externalAuthId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.status))\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.idle))\n\t\t{\n\t\t\tresult.idle = Utils.date.cast(fields.idle, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.last_activity_date))\n\t\t{\n\t\t\tfields.lastActivityDate = fields.last_activity_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.lastActivityDate))\n\t\t{\n\t\t\tresult.lastActivityDate = Utils.date.cast(fields.lastActivityDate, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobile_last_date))\n\t\t{\n\t\t\tfields.mobileLastDate = fields.mobile_last_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobileLastDate))\n\t\t{\n\t\t\tresult.mobileLastDate = Utils.date.cast(fields.mobileLastDate, false);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.absent))\n\t\t{\n\t\t\tresult.absent = Utils.date.cast(fields.absent, false);\n\t\t}\n\n\t\tif (Array.isArray(fields.departments))\n\t\t{\n\t\t\tresult.departments = [];\n\t\t\tfields.departments.forEach(departmentId =>\n\t\t\t{\n\t\t\t\tdepartmentId = Number.parseInt(departmentId, 10);\n\t\t\t\tif (departmentId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.departments.push(departmentId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.phones))\n\t\t{\n\t\t\tresult.phones = this.preparePhones(fields.phones);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = this.store.state.application.common.host + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpreparePhones(phones): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(phones.work_phone))\n\t\t{\n\t\t\tphones.workPhone = phones.work_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t\t{\n\t\t\tresult.workPhone =phones.workPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_mobile))\n\t\t{\n\t\t\tphones.personalMobile = phones.personal_mobile;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t\t{\n\t\t\tresult.personalMobile = phones.personalMobile.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_phone))\n\t\t{\n\t\t\tphones.personalPhone = phones.personal_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t\t{\n\t\t\tresult.personalPhone = phones.personalPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.inner_phone))\n\t\t{\n\t\t\tphones.innerPhone = phones.inner_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t\t{\n\t\t\tresult.innerPhone = phones.innerPhone.toString();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\taddToOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tif (this.absentCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000*60*60*24;\n\t\tthis.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tconst state = this.store.state.users;\n\t\t\t\tstate.absentList.forEach(userId => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tif (this.onlineCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst ONE_MINUTE = 60000;\n\t\tthis.onlineCheckInterval = setInterval(() => {\n\t\t\tconst state = this.store.state.users;\n\n\t\t\tstate.onlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tstate.onlineList = state.onlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstate.mobileOnlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tstate.mobileOnlineList = state.mobileOnlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, ONE_MINUTE);\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.old-chat-embedding.application.core';\nimport {DialogType, MessageStatus, RecentCallStatus, RecentSettings} from 'im.old-chat-embedding.const';\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\n\nimport type {RecentItem as ImModelRecentItem} from './type/recent-item';\nimport type {Dialog as ImModelDialog} from './type/dialog';\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\trecentCollection: new Set(),\n\t\t\tunreadCollection: new Set(),\n\t\t\tunloadedChatCounters: {},\n\t\t\tactiveCalls: [],\n\t\t\toptions: {\n\t\t\t\tshowBirthday: true,\n\t\t\t\tshowInvited: true,\n\t\t\t\tshowLastMessage: true\n\t\t\t}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\tsenderId: 0,\n\t\t\t\tdate: new Date(),\n\t\t\t\tstatus: MessageStatus.received,\n\t\t\t\tsending: false,\n\t\t\t\ttext: '',\n\t\t\t\tparams: {\n\t\t\t\t\twithFile: false,\n\t\t\t\t\twithAttach: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t},\n\t\t\toptions: {}\n\t\t};\n\t}\n\n\tgetActiveCallDefaultState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetRecentCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\treturn [...state.recentCollection].map(id => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetUnreadCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\treturn [...state.unreadCollection].map(id => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetSortedCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\tconst collectionAsArray = Object.values(state.collection).filter(item => {\n\t\t\t\t\tconst isBirthdayPlaceholder = item.options.birthdayPlaceholder;\n\t\t\t\t\tconst isInvitedUser = item.options.defaultUserRecord;\n\n\t\t\t\t\treturn !isBirthdayPlaceholder && !isInvitedUser && item.message.id;\n\t\t\t\t});\n\n\t\t\t\treturn [...collectionAsArray].sort((a, b) => {\n\t\t\t\t\treturn b.message.date - a.message.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\tget: (state: RecentState) => (dialogId: string): ImModelRecentItem | null =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tneedsBirthdayPlaceholder: (state: RecentState) => (dialogId): boolean =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\treturn state.options.showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\n\t\t\tneedsVacationPlaceholder: (state: RecentState) => (dialogId): boolean =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasVacation = this.store.getters['users/hasVacation'](dialogId);\n\t\t\t\tif (!hasVacation)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\treturn !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\n\t\t\tgetMessageDate: (state: RecentState) => (dialogId): Date | null =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > currentItem.message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\treturn currentItem.message.date;\n\t\t\t},\n\n\t\t\thasActiveCall: (state: RecentState): boolean =>\n\t\t\t{\n\t\t\t\treturn state.activeCalls.some(item => item.state === RecentCallStatus.joined);\n\t\t\t},\n\n\t\t\tgetOption: (state: RecentState) => (optionName: string): boolean =>\n\t\t\t{\n\t\t\t\tif (!RecentSettings[optionName])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.options[optionName];\n\t\t\t},\n\n\t\t\tgetTotalCounter: (state: RecentState): number =>\n\t\t\t{\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\t[...state.recentCollection].forEach(dialogId => {\n\t\t\t\t\tconst dialog: ImModelDialog = this.store.getters['dialogues/get'](dialogId, true);\n\t\t\t\t\tconst recentItem: ImModelRecentItem = state.collection[dialogId];\n\n\t\t\t\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\t\t\t\t\tif (isMuted)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isMarked = recentItem.unread;\n\t\t\t\t\tif (dialog.counter === 0 && isMarked)\n\t\t\t\t\t{\n\t\t\t\t\t\tloadedChatsCounter++;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tloadedChatsCounter += dialog.counter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedChatCounters).forEach(counter => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetRecent: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tthis.store.dispatch('recent/set', payload).then(itemIds => {\n\t\t\t\t\tstore.commit('setRecentCollection', itemIds);\n\t\t\t\t});\n\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tconst zeroedCountersForNewItems = {};\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tzeroedCountersForNewItems[item.chat_id] = 0;\n\t\t\t\t});\n\t\t\t\tthis.store.dispatch('recent/setUnloadedChatCounters', zeroedCountersForNewItems);\n\t\t\t},\n\t\t\tsetUnread: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tthis.store.dispatch('recent/set', payload).then(itemIds => {\n\t\t\t\t\tstore.commit('setUnreadCollection', itemIds);\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({dialogId: existingItem.dialogId, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\n\t\t\t\treturn [...itemsToAdd, ...itemsToUpdate].map(item => item.dialogId);\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (fields.message)\n\t\t\t\t{\n\t\t\t\t\tfields.message = {...existingItem.message, ...fields.message};\n\t\t\t\t}\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunread: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {unread: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tpin: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {pinned: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tlike: (store, payload: {id: string | number, messageId: number, liked: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.message.id === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {liked: payload.liked === true}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdraft: (store, payload: {id: string | number, text: string}) =>\n\t\t\t{\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](payload.id);\n\t\t\t\tif (!dialog)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\tdialogId: payload.id.toString(),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', {...this.getElementState(), ...newItem});\n\t\t\t\t\tstore.commit('setRecentCollection', [newItem.dialogId]);\n\t\t\t\t\texistingItem = store.state.collection[payload.id];\n\t\t\t\t}\n\n\t\t\t\tconst fields = this.validate({draft: {text: payload.text.toString()}});\n\t\t\t\tif (fields.draft.text === existingItem.draft.text)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId\n\t\t\t\t});\n\t\t\t\tstore.commit('deleteFromRecentCollection', existingItem.dialogId);\n\t\t\t},\n\n\t\t\taddActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingIndex = store.state.activeCalls.findIndex(item => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.id === payload.call.id;\n\t\t\t\t});\n\n\t\t\t\tif (existingIndex > -1)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tindex: existingIndex,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingIndex = store.state.activeCalls.findIndex(item => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tindex: existingIndex,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingIndex = store.state.activeCalls.findIndex(item => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId;\n\t\t\t\t});\n\n\t\t\t\tif (existingIndex === -1)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tindex: existingIndex\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetOptions: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tpayload = this.validateOptions(payload);\n\t\t\t\tObject.entries(payload).forEach(([option, value]) => {\n\t\t\t\t\tstore.commit('setOptions', {\n\t\t\t\t\t\toption,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearUnread: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearUnread');\n\t\t\t},\n\n\t\t\tsetUnloadedChatCounters: (store, payload: {[chatId: string]: number}) =>\n\t\t\t{\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedChatCounters', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetRecentCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach(dialogId => {\n\t\t\t\t\tstate.recentCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromRecentCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.recentCollection.delete(payload);\n\t\t\t},\n\t\t\tsetUnreadCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach(dialogId => {\n\t\t\t\t\tstate.unreadCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({dialogId, fields}) => {\n\t\t\t\t\t// if we already got chat - we should not update it with default user chat (unless it's an accepted invitation)\n\t\t\t\t\tconst defaultUserElement = fields.options && fields.options.defaultUserRecord && !fields.invitation;\n\t\t\t\t\tif (defaultUserElement)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[dialogId];\n\t\t\t\t\tfields.message = {...currentElement.message, ...fields.message};\n\t\t\t\t\tfields.options = {...currentElement.options, ...fields.options};\n\t\t\t\t\tstate.collection[dialogId] = {\n\t\t\t\t\t\t...currentElement,\n\t\t\t\t\t\t...fields\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (state: RecentState, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\n\t\t\taddActiveCall: (state: RecentState, payload) => {\n\t\t\t\tstate.activeCalls.push(payload);\n\t\t\t},\n\n\t\t\tupdateActiveCall: (state: RecentState, payload) => {\n\t\t\t\tstate.activeCalls[payload.index] = {\n\t\t\t\t\t...state.activeCalls[payload.index],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tdeleteActiveCall: (state: RecentState, payload) => {\n\t\t\t\tstate.activeCalls.splice(payload.index, 1);\n\t\t\t},\n\n\t\t\tsetOptions: (state: RecentState, payload) => {\n\t\t\t\tstate.options[payload.option] = payload.value;\n\t\t\t},\n\n\t\t\tclearUnread: (state: RecentState) => {\n\t\t\t\tObject.keys(state.collection).forEach(key => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetUnloadedChatCounters: (state: RecentState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedChatCounters[chatId];\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedChatCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object)\n\t{\n\t\tconst result = {\n\t\t\toptions: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tresult.message = this.prepareMessage(fields);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.draft))\n\t\t{\n\t\t\tresult.draft = this.prepareDraft(fields);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.liked))\n\t\t{\n\t\t\tresult.liked = fields.liked;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.invited))\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: true,\n\t\t\t\toriginator: fields.invited.originator_id,\n\t\t\t\tcanResend: fields.invited.can_resend\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\t\telse if (fields.invited === false)\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.options))\n\t\t{\n\t\t\tif (!result.options)\n\t\t\t{\n\t\t\t\tresult.options = {};\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.default_user_record))\n\t\t\t{\n\t\t\t\tfields.options.defaultUserRecord = fields.options.default_user_record;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.defaultUserRecord))\n\t\t\t{\n\t\t\t\tresult.options.defaultUserRecord = fields.options.defaultUserRecord;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.birthdayPlaceholder))\n\t\t\t{\n\t\t\t\tresult.options.birthdayPlaceholder = fields.options.birthdayPlaceholder;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareMessage(fields: Object): Object\n\t{\n\t\tconst {message} = this.getElementState();\n\t\tif (Type.isNumber(fields.message.id) || Utils.text.isUuidV4(fields.message.id) || Type.isStringFilled(fields.message.id))\n\t\t{\n\t\t\tmessage.id = fields.message.id;\n\t\t}\n\t\tif (Type.isString(fields.message.text))\n\t\t{\n\t\t\tmessage.text = fields.message.text;\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(fields.message.attach)\n\t\t\t|| Type.isBoolean(fields.message.attach)\n\t\t\t|| Type.isArray(fields.message.attach)\n\t\t)\n\t\t{\n\t\t\tmessage.params.withAttach = fields.message.attach;\n\t\t}\n\t\telse if (\n\t\t\tType.isStringFilled(fields.message.params?.withAttach)\n\t\t\t|| Type.isBoolean(fields.message.params?.withAttach)\n\t\t\t|| Type.isArray(fields.message.params?.withAttach)\n\t\t)\n\t\t{\n\t\t\tmessage.params.withAttach = fields.message.params.withAttach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.message.file) || Type.isPlainObject(fields.message.file))\n\t\t{\n\t\t\tmessage.params.withFile = fields.message.file;\n\t\t}\n\t\telse if (Type.isBoolean(fields.message.params?.withFile) || Type.isPlainObject(fields.message.params?.withFile))\n\t\t{\n\t\t\tmessage.params.withFile = fields.message.params.withFile;\n\t\t}\n\n\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t{\n\t\t\tmessage.date = Utils.date.cast(fields.message.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.message.author_id))\n\t\t{\n\t\t\tmessage.senderId = fields.message.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.authorId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.authorId;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.senderId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.senderId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.message.status))\n\t\t{\n\t\t\tmessage.status = fields.message.status;\n\t\t}\n\t\tif (Type.isBoolean(fields.message.sending))\n\t\t{\n\t\t\tmessage.sending = fields.message.sending;\n\t\t}\n\n\t\treturn message;\n\t}\n\n\tprepareDraft(fields: Object): Object\n\t{\n\t\tconst {draft} = this.getElementState();\n\n\t\tif (Type.isString(fields.draft.text))\n\t\t{\n\t\t\tdraft.text = fields.draft.text;\n\t\t}\n\n\t\tif (Type.isStringFilled(draft.text))\n\t\t{\n\t\t\tdraft.date = new Date();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdraft.date = null;\n\t\t}\n\n\t\treturn draft;\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getActiveCallDefaultState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateOptions(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isBoolean(fields.showBirthday))\n\t\t{\n\t\t\tresult.showBirthday = fields.showBirthday;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.showInvited))\n\t\t{\n\t\t\tresult.showInvited = fields.showInvited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.showLastMessage))\n\t\t{\n\t\t\tresult.showLastMessage = fields.showLastMessage;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\ntype RecentState = {\n\tcollection: {[dialogId: string]: ImModelRecentItem},\n\trecentCollection: Set<string>,\n\tunreadCollection: Set<string>,\n\tmarkedCollection: Set<number>,\n\tunloadedChatCounters: {[chatId: string]: number},\n\tactiveCalls: ActiveCall[],\n\toptions: {\n\t\tshowBirthday: boolean,\n\t\tshowInvited: boolean,\n\t\tshowLastMessage: boolean\n\t}\n};\n\ntype ActiveCall = {\n\tdialogId: string,\n\tname: string,\n\tcall: Object,\n\tstate: $Values<typeof RecentCallStatus>\n};"],"names":["ApplicationModel","BuilderModel","getName","getState","common","host","getVariable","location","protocol","siteId","userId","languageId","dialog","dialogId","chatId","diskFolderId","messageLimit","enableReadMessages","disk","enabled","maxFileSize","call","serverEnabled","maxParticipants","mobile","keyboardShow","device","type","DeviceType","desktop","orientation","DeviceOrientation","portrait","options","quoteEnable","quoteFromRight","autoplayVideo","darkTheme","bigSmileEnable","error","active","code","description","getGetters","getOption","state","optionName","Settings","getActions","setOptions","store","payload","Type","isPlainObject","validateOptions","Object","entries","forEach","option","value","commit","getMutations","update","keys","group","key","validate","fields","result","toString","startsWith","substr","parseInt","isNaN","isUndefined","isStringFilled","BX","MessengerProxy","isDarkTheme","WRITING_STATUS_TIME","DialoguesModel","collection","writingStatusTimers","chatOptions","getElementState","DialogType","chat","name","avatar","color","Color","base","extranet","counter","userCounter","lastReadId","markedId","lastMessageId","lastMessageViews","countOfViewers","firstViewer","messageId","savedPositionMessageId","managerList","writingList","muteList","textareaMessage","quoteId","owner","entityType","entityId","dateCreate","public","link","inited","loading","hasPrevPage","hasNextPage","get","getBlank","getByChatId","Number","values","find","item","getChatOption","chatType","getQuoteId","isUser","user","canLeave","isExternalTelephonyCall","currentUserId","Core","getUserId","optionToCheck","ChatOption","leaveOwner","leave","getters","canMute","isAnnouncement","announcement","mute","getLastReadId","getInitialMessageId","Math","min","set","Array","isArray","map","element","existingItem","add","delete","startWriting","timerId","alreadyWriting","some","el","clearTimeout","setWritingStatusTimeout","newItem","userName","newWritingList","actionName","stopWriting","filter","increaseCounter","increasedCounter","count","previousCounter","decreaseCounter","decreasedCounter","clearCounters","includes","unmute","setChatOptions","validateChatOptions","setLastMessageViews","date","newLastMessageViews","Utils","cast","clearLastMessageViews","defaultLastMessageViews","incrementLastMessageViews","newCounter","setTimeout","dispatch","dialog_id","isNumber","chat_id","id","user_counter","last_id","lastId","marked_id","last_message_id","last_message_views","prepareLastMessageViews","isBoolean","title","Text","decode","ownerId","isString","prepareAvatar","entity_type","entity_id","date_create","writing_list","prepareWritingList","manager_list","push","mute_list","prepareMuteList","disk_folder_id","endsWith","application","encodeURI","text","htmlspecialcharsback","rawLastMessageViews","count_of_viewers","first_viewers","rawFirstViewers","message_id","rawFirstViewer","user_id","user_name","Error","typeOptions","newType","convertSnakeToCamelCase","toLowerCase","newKey","UsersModel","onlineList","mobileOnlineList","absentList","botList","params","firstName","lastName","workPosition","gender","network","bot","connector","externalAuthId","status","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","birthday","isBirthday","absent","isAbsent","departments","phones","workPhone","personalMobile","personalPhone","innerPhone","getTemporary","getList","userList","hasBirthday","hasVacation","getStatus","UserStatus","mobileOnline","getLastOnline","getLastDateText","getPosition","Loc","getMessage","getBotType","botType","BotType","existingUser","setBotList","setStatus","addToOnlineList","addToMobileOnlineList","isBirthdayToday","getTimeToNextMidnight","addToAbsentList","startOnlineCheckInterval","startAbsentCheckInterval","isDate","first_name","last_name","work_position","external_auth_id","last_activity_date","mobile_last_date","departmentId","preparePhones","work_phone","personal_mobile","personal_phone","inner_phone","users","absentCheckInterval","TIME_TO_NEXT_DAY","setInterval","currentTime","Date","now","absentEnd","getTime","onlineCheckInterval","ONE_MINUTE","RecentModel","recentCollection","Set","unreadCollection","unloadedChatCounters","activeCalls","showBirthday","showInvited","showLastMessage","message","senderId","MessageStatus","received","sending","withFile","withAttach","draft","unread","pinned","liked","invitation","isActive","originator","canResend","getActiveCallDefaultState","RecentCallStatus","waiting","getRecentCollection","getUnreadCollection","getSortedCollection","collectionAsArray","isBirthdayPlaceholder","birthdayPlaceholder","isInvitedUser","defaultUserRecord","sort","a","b","needsBirthdayPlaceholder","currentItem","hasMessage","isTempMessage","hasTodayMessage","isToday","needsVacationPlaceholder","getMessageDate","getStartOfTheDay","hasActiveCall","joined","RecentSettings","getTotalCounter","loadedChatsCounter","recentItem","isMuted","isMarked","unloadedChatsCounter","setRecent","then","itemIds","zeroedCountersForNewItems","setUnread","itemsToUpdate","itemsToAdd","length","action","pin","like","isLastMessage","isExactMessageLiked","addActiveCall","existingIndex","findIndex","index","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","clearUnread","setUnloadedChatCounters","setRecentCollection","deleteFromRecentCollection","setUnreadCollection","defaultUserElement","currentElement","splice","prepareMessage","prepareDraft","invited","originator_id","can_resend","default_user_record","isUuidV4","attach","file","author_id","authorId","isObjectLike","associatedEntity"],"mappings":"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"}