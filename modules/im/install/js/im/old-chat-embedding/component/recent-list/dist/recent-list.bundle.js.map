{"version":3,"file":"recent-list.bundle.js","sources":["../src/components/new-user-popup.js","../src/components/recent-item.js","../src/components/active-call.js","../src/settings-manager.js","../src/broadcast-manager.js","../src/call-manager.js","../src/draft-manager.js","../src/event-handler.js","../src/recent-list.js"],"sourcesContent":["import {EventEmitter} from 'main.core.events';\n\nimport {EventType} from 'im.old-chat-embedding.const';\n\n// @vue/component\nexport const NewUserPopup = {\n\tname: 'NewUserPopup',\n\tprops: {\n\t\ttitle: {type: String, required: true},\n\t\ttext: {type: String, required: true}\n\t},\n\temits: ['click', 'close'],\n\tmounted()\n\t{\n\t\tBX.MessengerProxy.playNewUserSound();\n\t\tthis.setCloseTimer(5000);\n\n\t\tthis.onClosePopupHandler = this.onClosePopup.bind(this);\n\t\tEventEmitter.subscribe(EventType.dialog.closePopup, this.onClosePopupHandler);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.dialog.closePopup, this.onClosePopupHandler);\n\t},\n\tmethods:\n\t{\n\t\tonClick()\n\t\t{\n\t\t\tthis.$emit('click');\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tonMouseOver()\n\t\t{\n\t\t\tclearTimeout(this.closeTimeout);\n\t\t},\n\t\tonMouseLeave()\n\t\t{\n\t\t\tthis.setCloseTimer(2000);\n\t\t},\n\t\tsetCloseTimer(time: number)\n\t\t{\n\t\t\tthis.closeTimeout = setTimeout(() => {\n\t\t\t\tthis.$emit('close');\n\t\t\t}, time);\n\t\t},\n\t\tonClosePopup()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Transition name=\"bx-im-recent-new-user-popup\">\n\t\t\t<div @click=\"onClick\" @mouseover=\"onMouseOver\" @mouseleave=\"onMouseLeave\" class=\"bx-im-recent-new-user-popup\">\n\t\t\t\t<div class=\"bx-im-recent-new-user-popup-title\">{{ title }}</div>\n\t\t\t\t<div class=\"bx-im-recent-new-user-popup-text\">{{ text }}</div>\n\t\t\t</div>\n\t\t</Transition>\n\t`\n};","import 'main.date';\nimport {PopupManager} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport {MessageStatus, DialogType, RecentSettings, EventType, OpenTarget} from 'im.old-chat-embedding.const';\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\nimport {Avatar, AvatarSize, ChatTitle} from 'im.old-chat-embedding.component.elements';\n\nimport {Parser} from 'im.v2.lib.parser';\n\nimport {NewUserPopup} from './new-user-popup';\n\ntype RecentListItem = {\n\tdialogId: number,\n\tmessage: {\n\t\tid: number,\n\t\ttext: string,\n\t\tdate: string,\n\t\tsenderId: number,\n\t\tstatus: MessageStatus.received | MessageStatus.delivered | MessageStatus.error\n\t},\n\tdraft: {\n\t\ttext: string,\n\t\tdate: Date | null,\n\t},\n\tunread: boolean,\n\tpinned: boolean,\n\tliked: boolean,\n\tinvitation: {\n\t\tisActive: boolean,\n\t\toriginator: number,\n\t\tcanResend: boolean\n\t}\n}\n\n// @vue/component\nexport const RecentItem = {\n\tname: 'RecentItem',\n\tcomponents: {Avatar, ChatTitle, NewUserPopup},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tisVisibleOnScreen: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tshowNewUserPopup: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tformattedDate(): string\n\t\t{\n\t\t\tif (this.needsBirthdayPlaceholder)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_RECENT_BIRTHDAY_DATE');\n\t\t\t}\n\n\t\t\treturn this.formatDate(this.item.message.date);\n\t\t},\n\n\t\tmessageText(): string\n\t\t{\n\t\t\tconst formattedText = Parser.purifyRecent(this.item);\n\t\t\tif (!formattedText)\n\t\t\t{\n\t\t\t\treturn this.isUser ? this.$store.getters['users/getPosition'](this.item.dialogId) : this.hiddenMessageText;\n\t\t\t}\n\n\t\t\treturn formattedText;\n\t\t},\n\n\t\tformattedMessageText(): string\n\t\t{\n\t\t\tconst SPLIT_INDEX = 24;\n\t\t\treturn Utils.text.insertUnseenWhitespace(this.messageText, SPLIT_INDEX);\n\t\t},\n\n\t\thiddenMessageText(): string\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.$store.getters['users/getPosition'](this.item.dialogId);\n\t\t\t}\n\n\t\t\tif (this.dialog.type === DialogType.open)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_RECENT_CHAT_TYPE_OPEN');\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_RECENT_CHAT_TYPE_GROUP');\n\t\t},\n\n\t\tstatusIcon(): string\n\t\t{\n\t\t\tif (!this.isLastMessageAuthor || this.isBot || this.needsBirthdayPlaceholder || !this.item.message)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif (this.isSelfChat)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif (this.item.message.status === MessageStatus.error)\n\t\t\t{\n\t\t\t\treturn 'error';\n\t\t\t}\n\n\t\t\tif (this.item.liked)\n\t\t\t{\n\t\t\t\treturn 'like';\n\t\t\t}\n\n\t\t\tif (this.item.message.status === MessageStatus.delivered)\n\t\t\t{\n\t\t\t\treturn 'read';\n\t\t\t}\n\n\t\t\treturn 'unread';\n\t\t},\n\n\t\tformattedCounter()\n\t\t{\n\t\t\treturn this.dialog.counter > 99 ? '99+' : this.dialog.counter;\n\t\t},\n\n\t\tuser()\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.item.dialogId, true);\n\t\t},\n\n\t\tdialog()\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.item.dialogId, true);\n\t\t},\n\n\t\tcurrentUserId()\n\t\t{\n\t\t\treturn this.$store.state.application.common.userId;\n\t\t},\n\n\t\tisUser()\n\t\t{\n\t\t\treturn this.dialog.type === DialogType.user;\n\t\t},\n\n\t\tisChat()\n\t\t{\n\t\t\treturn !this.isUser;\n\t\t},\n\n\t\tisSelfChat()\n\t\t{\n\t\t\treturn this.isUser && this.user.id === this.currentUserId;\n\t\t},\n\n\t\tisBot()\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.user.bot;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\tisLastMessageAuthor()\n\t\t{\n\t\t\tif (!this.item.message)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.currentUserId === this.item.message.senderId;\n\t\t},\n\n\t\tlastMessageAuthorAvatar()\n\t\t{\n\t\t\tconst authorDialog = this.$store.getters['dialogues/get'](this.item.message.senderId);\n\n\t\t\tif (!authorDialog)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn authorDialog.avatar;\n\t\t},\n\n\t\tlastMessageAuthorAvatarStyle()\n\t\t{\n\t\t\treturn {backgroundImage: `url('${this.lastMessageAuthorAvatar}')`};\n\t\t},\n\n\t\tisChatMuted()\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst isMuted = this.dialog.muteList.find(element => {\n\t\t\t\treturn element === this.currentUserId;\n\t\t\t});\n\n\t\t\treturn !!isMuted;\n\t\t},\n\n\t\tneedsBirthdayPlaceholder()\n\t\t{\n\t\t\tif (!this.isUser)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.$store.getters['recent/needsBirthdayPlaceholder'](this.item.dialogId);\n\t\t},\n\n\t\tshowBirthdays()\n\t\t{\n\t\t\treturn this.$store.getters['recent/getOption'](RecentSettings.showBirthday);\n\t\t},\n\n\t\tshowLastMessage()\n\t\t{\n\t\t\treturn this.$store.getters['recent/getOption'](RecentSettings.showLastMessage);\n\t\t},\n\n\t\tinvitation()\n\t\t{\n\t\t\treturn this.item.invitation;\n\t\t},\n\n\t\tnewUserPopupContainer()\n\t\t{\n\t\t\treturn `#popup-window-content-bx-im-recent-welcome-${this.item.dialogId}`;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tinvitation(newValue, oldValue)\n\t\t{\n\t\t\tif (!this.compactMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// invitation accepted, user logged in\n\t\t\tif (oldValue.isActive === true && newValue.isActive === false)\n\t\t\t{\n\t\t\t\tthis.openNewUserPopup();\n\t\t\t}\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\topenNewUserPopup()\n\t\t{\n\t\t\tif (!this.isVisibleOnScreen || BX.MessengerProxy.isSliderOpened())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.newUserPopup = this.getNewUserPopup();\n\t\t\tthis.newUserPopup.show();\n\t\t\tthis.showNewUserPopup = true;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.newUserPopup.setOffset({\n\t\t\t\t\toffsetTop: -this.newUserPopup.popupContainer.offsetHeight + 1,\n\t\t\t\t\toffsetLeft: -this.newUserPopup.popupContainer.offsetWidth + 13\n\t\t\t\t});\n\t\t\t\tthis.newUserPopup.adjustPosition();\n\t\t\t});\n\t\t},\n\t\tgetNewUserPopup()\n\t\t{\n\t\t\treturn PopupManager.create({\n\t\t\t\tid: `bx-im-recent-welcome-${this.item.dialogId}`,\n\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\tclassName: 'bx-im-recent-welcome',\n\t\t\t\tcacheable: false,\n\t\t\t\tanimation: {\n\t\t\t\t\tshowClassName: 'bx-im-recent-new-user-popup-show',\n\t\t\t\t\tcloseClassName: 'bx-im-recent-new-user-popup-hide',\n\t\t\t\t\tcloseAnimationType: 'animation'\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonNewUserPopupClick(event)\n\t\t{\n\t\t\tconst target = !this.compactMode || event.altKey? OpenTarget.current: OpenTarget.auto;\n\n\t\t\tEventEmitter.emit(EventType.dialog.open, {\n\t\t\t\t...this.item,\n\t\t\t\ttarget\n\t\t\t});\n\t\t},\n\t\tonNewUserPopupClose()\n\t\t{\n\t\t\tthis.newUserPopup.close();\n\t\t\tthis.newUserPopup = null;\n\t\t\tthis.showNewUserPopup = false;\n\t\t},\n\t\tformatDate(date)\n\t\t{\n\t\t\tconst format = [\n\t\t\t\t['today', 'H:i'],\n\t\t\t\t['d7', 'D'],\n\t\t\t\t['', 'd.m.Y']\n\t\t\t];\n\n\t\t\treturn BX.date.format(format, date);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :data-id=\"item.dialogId\" class=\"bx-im-recent-item-wrap\">\n\t\t<div v-if=\"!compactMode\" :class=\"{'bx-im-recent-item-no-text': !showLastMessage, 'bx-im-recent-item-pinned': item.pinned}\" class=\"bx-im-recent-item\">\n\t\t\t<div class=\"bx-im-recent-avatar-wrap\">\n\t\t\t\t<Avatar :dialogId=\"item.dialogId\" :size=\"AvatarSize.L\" :withTyping=\"true\"/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-recent-item-content\">\n\t\t\t\t<div class=\"bx-im-recent-item-content-header\">\n\t\t\t\t\t<ChatTitle :dialogId=\"item.dialogId\" :withMute=\"true\" />\n\t\t\t\t\t<div class=\"bx-im-recent-date\">\n\t\t\t\t\t\t<div v-if=\"statusIcon\" :class=\"'bx-im-recent-status-icon bx-im-recent-status-icon-' + statusIcon\"></div>\n\t\t\t\t\t\t{{ formattedDate }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-recent-item-content-bottom\">\n\t\t\t\t\t<div class=\"bx-im-recent-message-text-wrap\">\n\t\t\t\t\t\t<!-- Message text -->\n\t\t\t\t\t\t<span class=\"bx-im-recent-message-text\">\n\t\t\t\t\t\t\t<template v-if=\"item.draft.text && dialog.counter === 0\">\n\t\t\t\t\t\t\t\t<span class=\"bx-im-recent-draft-prefix\">{{ $Bitrix.Loc.getMessage('IM_RECENT_MESSAGE_DRAFT_2', {'#TEXT#': ''}) }}</span>\n\t\t\t\t\t\t\t\t<span>{{ item.draft.text }}</span>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else-if=\"item.invitation.isActive\">\n\t\t\t\t\t\t\t\t<span class=\"bx-im-recent-message-text-invitation\">{{ $Bitrix.Loc.getMessage('IM_RECENT_INVITATION_NOT_ACCEPTED') }}</span>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else-if=\"needsBirthdayPlaceholder\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_RECENT_BIRTHDAY') }}\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else-if=\"!showLastMessage\">\n\t\t\t\t\t\t\t\t{{ hiddenMessageText }}\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<span v-if=\"isLastMessageAuthor\" class=\"bx-im-recent-last-message-author-icon-self\"></span>\n\t\t\t\t\t\t\t\t<template v-else-if=\"isChat && item.message.senderId\">\n\t\t\t\t\t\t\t\t\t<span v-if=\"lastMessageAuthorAvatar\" :style=\"lastMessageAuthorAvatarStyle\" class=\"bx-im-recent-last-message-author-icon-user\"></span>\n\t\t\t\t\t\t\t\t\t<span v-else class=\"bx-im-recent-last-message-author-icon-user bx-im-recent-last-message-author-icon-user-default\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span>{{ formattedMessageText }}</span>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<!-- End message text -->\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"{'bx-im-recent-counter-static-wrap-extended': dialog.counter > 99}\" class=\"bx-im-recent-counter-static-wrap\">\n\t\t\t\t\t\t<div v-if=\"item.unread || item.pinned || dialog.counter > 0\" class=\"bx-im-recent-counter-wrap\">\n\t\t\t\t\t\t\t<div v-if=\"item.pinned && dialog.counter === 0 && !item.unread\" class=\"bx-im-recent-pinned-icon\"></div>\n\t\t\t\t\t\t\t<div v-if=\"dialog.counter > 0 && !isSelfChat\" :class=\"{'bx-im-recent-counter-muted': isChatMuted}\" class=\"bx-im-recent-counter\">\n\t\t\t\t\t\t\t\t{{ formattedCounter }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-else-if=\"item.unread\" :class=\"{'bx-im-recent-counter-muted': isChatMuted}\"  class=\"bx-im-recent-counter bx-im-recent-counter-unread\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"compactMode\" class=\"bx-im-recent-item\" :class=\"{'bx-im-recent-item-pinned': item.pinned, 'bx-im-recent-item-no-counter': dialog.counter === 0}\" ref=\"container\">\n\t\t\t<div class=\"bx-im-recent-avatar-wrap\">\n\t\t\t\t<Avatar\n\t\t\t\t\t:dialogId=\"item.dialogId\"\n\t\t\t\t\t:size=\"AvatarSize.M\"\n\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t:withCounter=\"true\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<template v-if=\"showNewUserPopup\">\n\t\t\t\t<Teleport :to=\"newUserPopupContainer\">\n\t\t\t\t\t<NewUserPopup :title=\"dialog.name\" :text=\"$Bitrix.Loc.getMessage('IM_RECENT_NEW_USER_POPUP_TEXT')\" @click=\"onNewUserPopupClick\" @close=\"onNewUserPopupClose\"/>\n\t\t\t\t</Teleport>\n\t\t\t</template>\n\t\t</div>\n\t\t</div>\n\t`\n};","import {mapState} from 'ui.vue3.vuex';\nimport {MenuManager} from 'main.popup';\nimport {Loc} from 'main.core';\n\nimport {RecentCallStatus, DialogType} from 'im.old-chat-embedding.const';\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\nimport {Avatar, AvatarSize} from 'im.old-chat-embedding.component.elements';\n\n// @vue/component\nexport const ActiveCall = {\n\tname: 'ActiveCall',\n\tcomponents: {Avatar},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\temits: ['click', 'contextmenu'],\n\tcomputed: {\n\t\tRecentCallStatus: () => RecentCallStatus,\n\t\tAvatarSize: () => AvatarSize,\n\t\tchatData()\n\t\t{\n\t\t\treturn this.item.call.associatedEntity;\n\t\t},\n\t\tisUser()\n\t\t{\n\t\t\treturn this.chatData.advanced.chatType === DialogType.private;\n\t\t},\n\t\tisTabWithActiveCall()\n\t\t{\n\t\t\treturn this.getCallController().hasActiveCall();\n\t\t},\n\t\tavatarStyle()\n\t\t{\n\t\t\treturn {backgroundImage: `url(${this.chatData.avatar})`};\n\t\t},\n\t\tavatarText()\n\t\t{\n\t\t\treturn Utils.text.getFirstLetters(this.item.name);\n\t\t},\n\t\tisDarkTheme()\n\t\t{\n\t\t\treturn this.application.options.darkTheme;\n\t\t},\n\t\tformattedName()\n\t\t{\n\t\t\treturn Utils.text.htmlspecialcharsback(this.item.name);\n\t\t},\n\t\t...mapState({\n\t\t\tapplication: state => state.application\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonJoinClick(event)\n\t\t{\n\t\t\tif (this.joinMenu)\n\t\t\t{\n\t\t\t\tthis.joinMenu.destroy();\n\t\t\t}\n\t\t\tthis.joinMenu = this.getJoinMenu(event);\n\t\t\tthis.joinMenu.show();\n\t\t},\n\t\tonHangupClick()\n\t\t{\n\t\t\tthis.getCallController().leaveCurrentCall();\n\t\t},\n\t\tonClick(event)\n\t\t{\n\t\t\tif (this.item.state === RecentCallStatus.joined)\n\t\t\t{\n\t\t\t\tthis.getCallController().unfold();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = this.$store.getters['recent/get'](this.item.dialogId);\n\t\t\tif (!item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$emit('click', {item, $event: event});\n\t\t},\n\t\tonRightClick()\n\t\t{\n\t\t\tconst item = this.$store.getters['recent/get'](this.item.dialogId);\n\t\t\tif (!item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$emit('contextmenu', {item, $event: event});\n\t\t},\n\t\tgetJoinMenu(event)\n\t\t{\n\t\t\treturn MenuManager.create({\n\t\t\t\tid: 'im-recent-active-call-join-menu',\n\t\t\t\tbindElement: event.target,\n\t\t\t\tdarkMode: this.isDarkTheme,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('IM_RECENT_ACTIVE_CALL_JOIN_VIDEO'),\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tthis.getCallController().joinCall(this.item.call.id, true);\n\t\t\t\t\t\t\tthis.joinMenu.close();\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('IM_RECENT_ACTIVE_CALL_JOIN_AUDIO'),\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tthis.getCallController().joinCall(this.item.call.id, false);\n\t\t\t\t\t\t\tthis.joinMenu.close();\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t},\n\t\tgetCallController()\n\t\t{\n\t\t\treturn BX.MessengerProxy.getCallController();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div :data-id=\"item.dialogId\" class=\"bx-im-recent-item-wrap\">\n\t\t<div v-if=\"!compactMode\" @click=\"onClick\" @click.right.prevent=\"onRightClick\" class=\"bx-im-recent-item bx-im-recent-active-call-item\">\n\t\t\t<div class=\"bx-im-recent-avatar-wrap\">\n\t\t\t\t<Avatar :dialogId=\"item.dialogId\" :size=\"AvatarSize.L\" />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-recent-item-content\">\n\t\t\t\t<!-- Waiting status -->\n\t\t\t\t<template v-if=\"item.state === RecentCallStatus.waiting\">\n\t\t\t\t\t<!-- 1-on-1 -->\n\t\t\t\t\t<div v-if=\"isUser\"  class=\"bx-im-recent-active-call-waiting-content\">\n\t\t\t\t\t\t<div class=\"bx-im-recent-active-call-icon bx-im-recent-active-call-waiting-icon\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-recent-active-call-waiting-title\">\n\t\t\t\t\t\t\t{{ formattedName }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- Chat -->\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<div class=\"bx-im-recent-item-content-header\">\n\t\t\t\t\t\t\t<div class=\"bx-im-recent-active-call-icon bx-im-recent-active-call-waiting-icon\"></div>\n\t\t\t\t\t\t\t<span class=\"bx-im-recent-active-call-waiting-title\" :title=\"formattedName\">\n\t\t\t\t\t\t\t\t{{ formattedName }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-recent-item-content-bottom\">\n\t\t\t\t\t\t\t<div @click.stop=\"onJoinClick\" class=\"bx-im-recent-active-call-button bx-im-recent-active-call-join-button\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_RECENT_ACTIVE_CALL_JOIN') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<!-- Joined status -->\n\t\t\t\t<template v-else-if=\"item.state === RecentCallStatus.joined\">\n\t\t\t\t\t<!-- 1-on-1 -->\n\t\t\t\t\t<div v-if=\"isUser || !isTabWithActiveCall\" class=\"bx-im-recent-active-call-joined-content\">\n\t\t\t\t\t\t<div class=\"bx-im-recent-active-call-icon bx-im-recent-active-call-joined-icon\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-recent-active-call-joined-title\">\n\t\t\t\t\t\t\t{{ formattedName }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- Chat -->\n\t\t\t\t\t<div v-else-if=\"!isUser && isTabWithActiveCall\">\n\t\t\t\t\t\t<div class=\"bx-im-recent-item-content-header\">\n\t\t\t\t\t\t\t<div class=\"bx-im-recent-active-call-icon bx-im-recent-active-call-joined-icon\"></div>\n\t\t\t\t\t\t\t<span class=\"bx-im-recent-active-call-joined-title\" :title=\"formattedName\">\n\t\t\t\t\t\t\t\t{{ formattedName }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-recent-item-content-bottom\">\n\t\t\t\t\t\t\t<div @click.stop=\"onHangupClick\" class=\"bx-im-recent-active-call-button bx-im-recent-active-call-hangup-button\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_RECENT_ACTIVE_CALL_HANGUP') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"compactMode\" @click=\"onClick\" @click.right.prevent=\"onRightClick\" class=\"bx-im-recent-item bx-im-recent-active-call-item\">\n\t\t\t<div class=\"bx-im-recent-avatar-wrap\">\n\t\t\t\t<Avatar :dialogId=\"item.dialogId\" :size=\"AvatarSize.M\" />\n\t\t\t\t<div class=\"bx-im-recent-active-call-compact-icon-container\">\n\t\t\t\t\t<div v-if=\"item.state === RecentCallStatus.waiting\" class=\"bx-im-recent-active-call-icon bx-im-recent-active-call-waiting-icon\"></div>\n\t\t\t\t\t<div v-else-if=\"item.state === RecentCallStatus.joined\" class=\"bx-im-recent-active-call-icon bx-im-recent-active-call-joined-icon\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t</div>\n\t`\n};","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {EventType, SettingsMap, RecentSettingsMap} from 'im.old-chat-embedding.const';\nimport {Logger} from 'im.old-chat-embedding.lib.logger';\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\n\nexport class SettingsManager\n{\n\tstatic instance = null;\n\tstore: Object = null;\n\n\tstatic init($Bitrix): void\n\t{\n\t\tif (this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.instance = new this($Bitrix);\n\t}\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.initSettings();\n\n\t\tthis.onSettingsChangeHandler = this.onSettingsChange.bind(this);\n\t\tEventEmitter.subscribe(EventType.dialog.settingsChange, this.onSettingsChangeHandler);\n\n\t\tif (Utils.platform.isBitrixDesktop() && !Type.isUndefined(BX.desktop))\n\t\t{\n\t\t\tBX.desktop.addCustomEvent('bxSaveSettings', (settings) => {\n\t\t\t\tthis.onSettingsChangeHandler({data: settings});\n\t\t\t});\n\t\t}\n\t}\n\n\tinitSettings()\n\t{\n\t\tif (!BX.MessengerProxy)\n\t\t{\n\t\t\tconsole.error('Im.RecentList: SettingsManager: BX.MessengerProxy is not available');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initGeneralSettings();\n\t\tthis.initRecentSettings();\n\t}\n\n\tinitGeneralSettings()\n\t{\n\t\tconst initialSettings = {};\n\t\tObject.entries(SettingsMap).forEach(([oldName, name]) => {\n\t\t\tinitialSettings[name] = BX.MessengerProxy.getOption(oldName);\n\t\t});\n\n\t\tthis.store.dispatch('application/setOptions', initialSettings);\n\t}\n\n\tinitRecentSettings()\n\t{\n\t\tconst initialSettings = {};\n\t\tObject.entries(RecentSettingsMap).forEach(([oldName, name]) => {\n\t\t\tinitialSettings[name] = BX.MessengerProxy.getOption(oldName);\n\t\t});\n\n\t\tthis.store.dispatch('recent/setOptions', initialSettings);\n\t}\n\n\tonSettingsChange({data: event})\n\t{\n\t\tLogger.warn('Im.RecentList: SettingsChange', event);\n\t\tconst generalSettings = {};\n\t\tconst recentSettings = {};\n\t\tObject.entries(event).forEach(([name, value]) => {\n\t\t\tif (Object.keys(RecentSettingsMap).includes(name))\n\t\t\t{\n\t\t\t\trecentSettings[RecentSettingsMap[name]] = value;\n\t\t\t}\n\n\t\t\tif (Object.keys(SettingsMap).includes(name))\n\t\t\t{\n\t\t\t\tgeneralSettings[SettingsMap[name]] = value;\n\t\t\t}\n\t\t});\n\n\t\tthis.store.dispatch('application/setOptions', generalSettings);\n\t\tthis.store.dispatch('recent/setOptions', recentSettings);\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.dialog.settingsChange, this.onSettingsChangeHandler);\n\t}\n}","import {EventEmitter} from 'main.core.events';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\n\nexport class BroadcastManager extends EventEmitter\n{\n\tstatic instance = null;\n\tstatic channelName = 'im-recent';\n\tstatic eventNamespace = 'BX.Messenger.Embedding.Recent.BroadcastManager';\n\tstatic events = {\n\t\trecentListUpdate: 'recentListUpdate'\n\t};\n\n\tstatic getInstance()\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(BroadcastManager.eventNamespace);\n\t\tthis.init();\n\t}\n\n\tisSupported()\n\t{\n\t\treturn !Type.isUndefined(window.BroadcastChannel) && !Utils.platform.isBitrixDesktop();\n\t}\n\n\tinit()\n\t{\n\t\tif (!this.isSupported())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.channel = new BroadcastChannel(BroadcastManager.channelName);\n\t\tthis.channel.addEventListener('message', ({data: {type, data}}) => {\n\t\t\tthis.emit(type, data);\n\t\t});\n\t}\n\n\tsendRecentList(recentData: Object)\n\t{\n\t\tif (!this.isSupported())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.channel.postMessage({\n\t\t\ttype: BroadcastManager.events.recentListUpdate,\n\t\t\tdata: recentData\n\t\t});\n\t}\n}","import {EventEmitter} from 'main.core.events';\n\nimport {RecentCallStatus} from 'im.old-chat-embedding.const';\n\nexport class CallManager\n{\n\tstatic instance = null;\n\tstore: Object = null;\n\n\tstatic init($Bitrix): void\n\t{\n\t\tif (this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.instance = new this($Bitrix);\n\t}\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\n\t\tthis.onCallCreatedHandler = this.onCallCreated.bind(this);\n\t\tEventEmitter.subscribe('CallEvents::callCreated', this.onCallCreatedHandler);\n\t}\n\n\tonCallCreated(event)\n\t{\n\t\tconst {call} = event.getData()[0];\n\t\tcall.addEventListener(BX.Call.Event.onJoin, this.onCallJoin.bind(this));\n\t\tcall.addEventListener(BX.Call.Event.onLeave, this.onCallLeave.bind(this));\n\t\tcall.addEventListener(BX.Call.Event.onDestroy, this.onCallDestroy.bind(this));\n\n\t\tthis.store.dispatch('recent/addActiveCall', {\n\t\t\tdialogId: call.associatedEntity.id,\n\t\t\tname: call.associatedEntity.name,\n\t\t\tcall: call,\n\t\t\tstate: RecentCallStatus.waiting\n\t\t});\n\t}\n\n\tonCallJoin(event)\n\t{\n\t\tthis.store.dispatch('recent/updateActiveCall', {\n\t\t\tdialogId: event.call.associatedEntity.id,\n\t\t\tfields: {\n\t\t\t\tstate: RecentCallStatus.joined\n\t\t\t}\n\t\t});\n\t}\n\n\tonCallLeave(event)\n\t{\n\t\tthis.store.dispatch('recent/updateActiveCall', {\n\t\t\tdialogId: event.call.associatedEntity.id,\n\t\t\tfields: {\n\t\t\t\tstate: RecentCallStatus.waiting\n\t\t\t}\n\t\t});\n\t}\n\n\tonCallDestroy(event)\n\t{\n\t\tthis.store.dispatch('recent/deleteActiveCall', {\n\t\t\tdialogId: event.call.associatedEntity.id\n\t\t});\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(window, 'CallEvents::callCreated', this.onCallCreatedHandler);\n\t}\n}","import {EventEmitter} from 'main.core.events';\n\nimport {EventType} from 'im.old-chat-embedding.const';\n\nexport class DraftManager\n{\n\tstatic instance = null;\n\tstore: Object = null;\n\n\tstatic init($Bitrix): void\n\t{\n\t\tif (this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.instance = new this($Bitrix);\n\t}\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\n\t\tthis.initDraftHistory();\n\n\t\tthis.onSetDraftHandler = this.onSetDraft.bind(this);\n\t\tEventEmitter.subscribe(EventType.recent.setDraftMessage, this.onSetDraftHandler);\n\t}\n\n\tinitDraftHistory()\n\t{\n\t\tif (!BX.MessengerProxy)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst history = BX.MessengerProxy.getTextareaHistory();\n\t\tObject.entries(history).forEach(([dialogId, text]) => {\n\t\t\tthis.setDraftMessage(dialogId, text);\n\t\t});\n\t}\n\n\tonSetDraft({data: {dialogId, text}})\n\t{\n\t\tthis.setDraftMessage(dialogId, text);\n\t}\n\n\tsetDraftMessage(dialogId, text)\n\t{\n\t\tthis.store.dispatch('recent/draft', {\n\t\t\tid: dialogId,\n\t\t\ttext\n\t\t});\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.recent.setDraftMessage, this.onSetDraftHandler);\n\t}\n}","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {EventType} from 'im.old-chat-embedding.const';\n\nexport class EventHandler\n{\n\tstatic instance = null;\n\tstore: Object = null;\n\n\tstatic init($Bitrix): void\n\t{\n\t\tif (this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.instance = new this($Bitrix);\n\t}\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\n\t\tthis.subscribeToEvents();\n\t}\n\n\tsubscribeToEvents()\n\t{\n\t\tthis.onSetCounterHandler = this.onSetCounter.bind(this);\n\t\tthis.onSetMessageHandler = this.onSetMessage.bind(this);\n\t\tthis.onHideChatHandler = this.onHideChat.bind(this);\n\t\tthis.onLeaveChatHandler = this.onLeaveChat.bind(this);\n\t\tthis.onClearLikeHandler = this.onClearLike.bind(this);\n\t\tthis.onClearHistoryHandler = this.onClearHistory.bind(this);\n\n\t\tEventEmitter.subscribe(EventType.recent.setCounter, this.onSetCounterHandler);\n\t\tEventEmitter.subscribe(EventType.recent.setMessage, this.onSetMessageHandler);\n\t\tEventEmitter.subscribe(EventType.recent.hideChat, this.onHideChatHandler);\n\t\tEventEmitter.subscribe(EventType.recent.leaveChat, this.onLeaveChatHandler);\n\t\tEventEmitter.subscribe(EventType.recent.clearLike, this.onClearLikeHandler);\n\t\tEventEmitter.subscribe(EventType.dialog.clearHistory, this.onClearHistoryHandler);\n\t}\n\n\tonSetCounter({data: {dialogId, counter}})\n\t{\n\t\tconst recentItem = this.store.getters['recent/get'](dialogId);\n\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\tif (!recentItem || !dialog)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: dialogId,\n\t\t\tfields: {\n\t\t\t\tcounter: counter\n\t\t\t}\n\t\t});\n\t}\n\n\tonSetMessage({data: {id, dialogId, text, date}})\n\t{\n\t\tconst recentItem = this.store.getters['recent/get'](dialogId);\n\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\tif (!recentItem || !dialog)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (id && !id.toString().startsWith('temp') && id !== recentItem.message.id)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: dialogId,\n\t\t\tfields: {\n\t\t\t\tmessage: {\n\t\t\t\t\tid: id || 0,\n\t\t\t\t\ttext: text,\n\t\t\t\t\tsenderId: this.getCurrentUserId(),\n\t\t\t\t\tstatus: recentItem.message.status,\n\t\t\t\t\tdate: date || recentItem.message.date,\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tonHideChat({data: {dialogId}})\n\t{\n\t\tconst recentItem = this.store.getters['recent/get'](dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('recent/delete', {\n\t\t\tid: dialogId\n\t\t});\n\t}\n\n\tonLeaveChat({data: {dialogId}})\n\t{\n\t\tthis.onHideChat({data: {dialogId}});\n\t}\n\n\tonClearLike({data: {dialogId}})\n\t{\n\t\tconst recentItem = this.store.getters['recent/get'](dialogId);\n\t\tif (!recentItem || !recentItem.liked)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('recent/like', {\n\t\t\tid: dialogId,\n\t\t\tliked: false\n\t\t});\n\t}\n\n\tonClearHistory({data: {dialogId}})\n\t{\n\t\tconst recentItem = this.store.getters['recent/get'](dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: dialogId,\n\t\t\tfields: {\n\t\t\t\tmessage: {\n\t\t\t\t\t...recentItem.message,\n\t\t\t\t\ttext: Loc.getMessage('IM_RECENT_DELETED_MESSAGE'),\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.store.state.application.common.userId;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.unsubscribeEvents();\n\t}\n\n\tunsubscribeEvents()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.recent.setCounter, this.onSetCounterHandler);\n\t\tEventEmitter.unsubscribe(EventType.recent.setMessage, this.onSetMessageHandler);\n\t\tEventEmitter.unsubscribe(EventType.recent.hideChat, this.onHideChatHandler);\n\t\tEventEmitter.unsubscribe(EventType.recent.leaveChat, this.onLeaveChatHandler);\n\t\tEventEmitter.unsubscribe(EventType.recent.clearLike, this.onClearLikeHandler);\n\t}\n}","import 'ui.design-tokens';\n\nimport {EventEmitter} from 'main.core.events';\nimport {mapState} from 'ui.vue3.vuex';\n\nimport {DialogType, EventType, RecentSettings, OpenTarget} from 'im.old-chat-embedding.const';\nimport {Utils} from 'im.old-chat-embedding.lib.utils';\nimport {RecentService} from 'im.old-chat-embedding.provider.service';\nimport {RecentLoadingState} from 'im.old-chat-embedding.component.elements';\nimport {RecentMenu} from 'im.old-chat-embedding.lib.menu';\n\nimport {RecentItem} from './components/recent-item';\nimport {ActiveCall} from './components/active-call';\n\nimport {SettingsManager} from './settings-manager';\nimport {BroadcastManager} from './broadcast-manager';\nimport {CallManager} from './call-manager';\nimport {DraftManager} from './draft-manager';\nimport {EventHandler} from './event-handler';\n\nimport './css/recent-list.css';\n\n// @vue/component\nexport const RecentList = {\n\tname: 'RecentList',\n\tcomponents: {LoadingState: RecentLoadingState, RecentItem, ActiveCall},\n\tdirectives:\n\t{\n\t\t'recent-list-observer':\n\t\t{\n\t\t\tmounted(element, binding)\n\t\t\t{\n\t\t\t\tbinding.instance.observer.observe(element);\n\t\t\t}\n\t\t}\n\t},\n\tprops: {\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tvisibleElements: new Set()\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tcollection()\n\t\t{\n\t\t\treturn this.$store.getters['recent/getRecentCollection'];\n\t\t},\n\t\tsections()\n\t\t{\n\t\t\treturn [this.pinnedItems, this.generalItems];\n\t\t},\n\t\tpreparedItems()\n\t\t{\n\t\t\tconst filteredCollection = this.collection.filter(item => {\n\t\t\t\tif (!this.showBirthdays && item.options.birthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.$store.getters['dialogues/get'](item.dialogId, true);\n\t\t\t\tconst isUser = dialog.type === DialogType.user;\n\t\t\t\tconst hasBirthday = isUser && this.showBirthdays && this.$store.getters['users/hasBirthday'](item.dialogId);\n\t\t\t\tif (!this.showInvited && item.options.defaultUserRecord && !hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\treturn [...filteredCollection].sort((a, b) => {\n\t\t\t\tconst firstDate = this.$store.getters['recent/getMessageDate'](a.dialogId);\n\t\t\t\tconst secondDate = this.$store.getters['recent/getMessageDate'](b.dialogId);\n\n\t\t\t\treturn secondDate - firstDate;\n\t\t\t});\n\t\t},\n\t\tpinnedItems()\n\t\t{\n\t\t\treturn this.preparedItems.filter(item => {\n\t\t\t\treturn item.pinned === true;\n\t\t\t});\n\t\t},\n\t\tgeneralItems()\n\t\t{\n\t\t\treturn this.preparedItems.filter(item => {\n\t\t\t\treturn item.pinned === false;\n\t\t\t});\n\t\t},\n\t\tisDarkTheme()\n\t\t{\n\t\t\treturn this.application.options.darkTheme;\n\t\t},\n\t\tshowBirthdays()\n\t\t{\n\t\t\treturn this.$store.getters['recent/getOption'](RecentSettings.showBirthday);\n\t\t},\n\t\tshowInvited()\n\t\t{\n\t\t\treturn this.$store.getters['recent/getOption'](RecentSettings.showInvited);\n\t\t},\n\t\ttransitionType()\n\t\t{\n\t\t\tif (this.compactMode)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn 'bx-messenger-recent-transition';\n\t\t},\n\t\t...mapState({\n\t\t\tactiveCalls: state => state.recent.activeCalls,\n\t\t\tapplication: state => state.application\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.recentService = RecentService.getInstance();\n\t\tthis.contextMenuManager = new RecentMenu(this.$Bitrix);\n\n\t\tCallManager.init(this.$Bitrix);\n\t\tEventHandler.init(this.$Bitrix);\n\t\tSettingsManager.init(this.$Bitrix);\n\n\t\tthis.initBroadcastManager();\n\t\tthis.initObserver();\n\t\tthis.initBirthdayCheck();\n\t\tthis.manageChatOptions();\n\t\tthis.managePreloadedList();\n\n\t\tthis.isLoading = true;\n\t\tconst ignorePreloadedItems = !this.compactMode;\n\t\tthis.recentService.loadFirstPage({ignorePreloadedItems}).then(() => {\n\t\t\tthis.isLoading = false;\n\t\t\tDraftManager.init(this.$Bitrix);\n\t\t});\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenuManager.destroy();\n\t\tthis.clearBirthdayCheck();\n\t\tthis.destroyBroadcastManager();\n\t},\n\tmethods:\n\t{\n\t\tonScroll(event)\n\t\t{\n\t\t\tthis.contextMenuManager.close();\n\t\t\tif (!this.oneScreenRemaining(event) || !this.recentService.hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.recentService.loadNextPage().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\n\t\tonClick(item, event)\n\t\t{\n\t\t\tconst target = !this.compactMode || event.altKey? OpenTarget.current: OpenTarget.auto;\n\n\t\t\tEventEmitter.emit(EventType.dialog.open, {\n\t\t\t\t...item,\n\t\t\t\tchat: this.$store.getters['dialogues/get'](item.dialogId, true),\n\t\t\t\tuser: this.$store.getters['users/get'](item.dialogId, true),\n\t\t\t\ttarget\n\t\t\t});\n\t\t},\n\n\t\tonRightClick(item, event)\n\t\t{\n\t\t\tif (event.altKey && event.shiftKey)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst target = !this.compactMode || event.altKey? OpenTarget.current: OpenTarget.auto;\n\t\t\tconst context = {\n\t\t\t\t...item,\n\t\t\t\tcompactMode: this.compactMode,\n\t\t\t\ttarget\n\t\t\t};\n\n\t\t\tthis.contextMenuManager.openMenu(context, event.currentTarget);\n\n\t\t\tevent.preventDefault();\n\t\t},\n\n\t\tonCallClick({item, $event})\n\t\t{\n\t\t\tthis.onClick(item, $event);\n\t\t},\n\n\t\tonCallRightClick({item, $event})\n\t\t{\n\t\t\tthis.onRightClick(item, $event);\n\t\t},\n\n\t\toneScreenRemaining(event)\n\t\t{\n\t\t\treturn event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight - event.target.clientHeight;\n\t\t},\n\n\t\tinitObserver()\n\t\t{\n\t\t\tthis.observer = new IntersectionObserver(((entries) => {\n\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\tif (entry.isIntersecting && entry.intersectionRatio === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.visibleElements.add(entry.target.dataset.id);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!entry.isIntersecting)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.visibleElements.delete(entry.target.dataset.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}), {threshold: [0, 1]});\n\t\t},\n\n\t\tinitBroadcastManager()\n\t\t{\n\t\t\tthis.onRecentListUpdate = (event) => {\n\t\t\t\tthis.recentService.setPreloadedData(event.data);\n\t\t\t};\n\t\t\tthis.broadcastManager = BroadcastManager.getInstance();\n\t\t\tthis.broadcastManager.subscribe(BroadcastManager.events.recentListUpdate, this.onRecentListUpdate);\n\t\t},\n\n\t\tdestroyBroadcastManager()\n\t\t{\n\t\t\tthis.broadcastManager = BroadcastManager.getInstance();\n\t\t\tthis.broadcastManager.unsubscribe(BroadcastManager.events.recentListUpdate, this.onRecentListUpdate);\n\t\t},\n\n\t\tinitBirthdayCheck()\n\t\t{\n\t\t\tconst fourHours = 60000*60*4;\n\t\t\tconst day = 60000*60*24;\n\t\t\tthis.birthdayCheckTimeout = setTimeout(() => {\n\t\t\t\tthis.recentService.loadFirstPage({ignorePreloadedItems: true});\n\t\t\t\tthis.birthdayCheckInterval = setInterval(() => {\n\t\t\t\t\tthis.recentService.loadFirstPage({ignorePreloadedItems: true});\n\t\t\t\t}, day);\n\t\t\t}, Utils.date.getTimeToNextMidnight() + fourHours);\n\t\t},\n\n\t\tclearBirthdayCheck()\n\t\t{\n\t\t\tclearTimeout(this.birthdayCheckTimeout);\n\t\t\tclearInterval(this.birthdayCheckInterval);\n\t\t},\n\n\t\tmanagePreloadedList()\n\t\t{\n\t\t\tconst {preloadedList} = this.$Bitrix.Application.get().params;\n\t\t\tif (!preloadedList)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.recentService.setPreloadedData(preloadedList);\n\t\t\tthis.broadcastManager.sendRecentList(preloadedList);\n\t\t},\n\n\t\tmanageChatOptions()\n\t\t{\n\t\t\tconst {chatOptions} = this.$Bitrix.Application.get().params;\n\t\t\tif (!chatOptions)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$store.dispatch('dialogues/setChatOptions', chatOptions);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div @scroll=\"onScroll\" class=\"bx-messenger-recent-list\" :class=\"{'bx-messenger-recent-compact': compactMode}\" >\n\t\t\t<transition-group :name=\"transitionType\">\n\t\t\t\t<ActiveCall\n\t\t\t\t\tv-for=\"activeCall in activeCalls\"\n\t\t\t\t\t:key=\"'call-' + activeCall.dialogId\"\n\t\t\t\t\t:item=\"activeCall\"\n\t\t\t\t\t:compactMode=\"compactMode\"\n\t\t\t\t\t@click=\"onCallClick\"\n\t\t\t\t\t@click.right=\"onCallRightClick\"\n\t\t\t\t/>\n\t\t\t\t<template v-for=\"section in sections\">\n\t\t\t\t\t<RecentItem\n\t\t\t\t\t\tv-for=\"item in section\"\n\t\t\t\t\t\t:key=\"item.dialogId\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t:compactMode=\"compactMode\"\n\t\t\t\t\t\t:isVisibleOnScreen=\"visibleElements.has(item.dialogId)\"\n\t\t\t\t\t\tv-recent-list-observer\n\t\t\t\t\t\t@click=\"onClick(item, $event)\"\n\t\t\t\t\t\t@click.right=\"onRightClick(item, $event)\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</transition-group>\n\t\t\t<LoadingState v-if=\"isLoading\" :compactMode=\"compactMode\" />\n\t\t\t<template v-if=\"collection.length === 0\">\n\t\t\t\t<div class=\"bx-im-recent-empty\">{{ $Bitrix.Loc.getMessage('IM_RECENT_EMPTY') }}</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n};"],"names":["NewUserPopup","name","props","title","type","String","required","text","emits","mounted","BX","MessengerProxy","playNewUserSound","setCloseTimer","onClosePopupHandler","onClosePopup","bind","EventEmitter","subscribe","EventType","dialog","closePopup","beforeUnmount","unsubscribe","methods","onClick","$emit","onMouseOver","clearTimeout","closeTimeout","onMouseLeave","time","setTimeout","template","RecentItem","components","Avatar","ChatTitle","item","Object","compactMode","Boolean","default","isVisibleOnScreen","data","showNewUserPopup","computed","AvatarSize","formattedDate","needsBirthdayPlaceholder","$Bitrix","Loc","getMessage","formatDate","message","date","messageText","formattedText","Parser","purifyRecent","isUser","$store","getters","dialogId","hiddenMessageText","formattedMessageText","SPLIT_INDEX","Utils","insertUnseenWhitespace","DialogType","open","statusIcon","isLastMessageAuthor","isBot","isSelfChat","status","MessageStatus","error","liked","delivered","formattedCounter","counter","user","currentUserId","state","application","common","userId","isChat","id","bot","senderId","lastMessageAuthorAvatar","authorDialog","avatar","lastMessageAuthorAvatarStyle","backgroundImage","isChatMuted","isMuted","muteList","find","element","showBirthdays","RecentSettings","showBirthday","showLastMessage","invitation","newUserPopupContainer","watch","newValue","oldValue","isActive","openNewUserPopup","isSliderOpened","newUserPopup","getNewUserPopup","show","$nextTick","setOffset","offsetTop","popupContainer","offsetHeight","offsetLeft","offsetWidth","adjustPosition","PopupManager","create","bindElement","$refs","container","bindOptions","forceBindPosition","className","cacheable","animation","showClassName","closeClassName","closeAnimationType","onNewUserPopupClick","event","target","altKey","OpenTarget","current","auto","emit","onNewUserPopupClose","close","format","ActiveCall","RecentCallStatus","chatData","call","associatedEntity","advanced","chatType","private","isTabWithActiveCall","getCallController","hasActiveCall","avatarStyle","avatarText","getFirstLetters","isDarkTheme","options","darkTheme","formattedName","htmlspecialcharsback","mapState","onJoinClick","joinMenu","destroy","getJoinMenu","onHangupClick","leaveCurrentCall","joined","unfold","$event","onRightClick","MenuManager","darkMode","items","onclick","joinCall","SettingsManager","init","instance","constructor","store","Data","get","initSettings","onSettingsChangeHandler","onSettingsChange","settingsChange","platform","isBitrixDesktop","Type","isUndefined","desktop","addCustomEvent","settings","console","initGeneralSettings","initRecentSettings","initialSettings","entries","SettingsMap","forEach","oldName","getOption","dispatch","RecentSettingsMap","Logger","warn","generalSettings","recentSettings","value","keys","includes","BroadcastManager","getInstance","setEventNamespace","eventNamespace","isSupported","window","BroadcastChannel","channel","channelName","addEventListener","sendRecentList","recentData","postMessage","events","recentListUpdate","CallManager","onCallCreatedHandler","onCallCreated","getData","Call","Event","onJoin","onCallJoin","onLeave","onCallLeave","onDestroy","onCallDestroy","waiting","fields","DraftManager","initDraftHistory","onSetDraftHandler","onSetDraft","recent","setDraftMessage","history","getTextareaHistory","EventHandler","subscribeToEvents","onSetCounterHandler","onSetCounter","onSetMessageHandler","onSetMessage","onHideChatHandler","onHideChat","onLeaveChatHandler","onLeaveChat","onClearLikeHandler","onClearLike","onClearHistoryHandler","onClearHistory","setCounter","setMessage","hideChat","leaveChat","clearLike","clearHistory","recentItem","toString","startsWith","getCurrentUserId","unsubscribeEvents","RecentList","LoadingState","RecentLoadingState","directives","binding","observer","observe","isLoading","visibleElements","Set","collection","sections","pinnedItems","generalItems","preparedItems","filteredCollection","filter","birthdayPlaceholder","hasBirthday","showInvited","defaultUserRecord","sort","a","b","firstDate","secondDate","pinned","transitionType","activeCalls","created","recentService","RecentService","contextMenuManager","RecentMenu","initBroadcastManager","initObserver","initBirthdayCheck","manageChatOptions","managePreloadedList","ignorePreloadedItems","loadFirstPage","then","clearBirthdayCheck","destroyBroadcastManager","onScroll","oneScreenRemaining","hasMoreItemsToLoad","loadNextPage","chat","shiftKey","context","openMenu","currentTarget","preventDefault","onCallClick","onCallRightClick","scrollTop","clientHeight","scrollHeight","IntersectionObserver","entry","isIntersecting","intersectionRatio","add","dataset","delete","threshold","onRecentListUpdate","setPreloadedData","broadcastManager","fourHours","day","birthdayCheckTimeout","birthdayCheckInterval","setInterval","getTimeToNextMidnight","clearInterval","preloadedList","Application","params","chatOptions"],"mappings":"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"}