{"version":3,"file":"recent.bundle.js","sources":["../src/recent.js"],"sourcesContent":["import { Vue } from \"ui.vue\";\nimport { Utils } from \"im.lib.utils\";\n\nimport \"./recent.css\";\n\nVue.cloneComponent('bx-im-view-list-item-recent', 'bx-list-element',\n{\n\tprops: [\n\t\t'rawListItem',\n\t\t'itemTypes'\n\t],\n\n\tmethods:\n\t{\n\t\tformatDate(date)\n\t\t{\n\t\t\tlet weekDays = ['pn', 'vt', 'sr', 'ch', 'py', 'sb', 'vs'];\n\n\t\t\tdate = new Date(date);\n\t\t\tlet currentDate = new Date();\n\n\t\t\tlet dateWeekDay = date.getDay() - (date.getDay() === 0 ? -6 : 1);\n\t\t\tlet currentDayOfWeek = currentDate.getDay() - (currentDate.getDay() === 0 ? -6 : 1);\n\n\t\t\tlet weekStartDate = currentDate.getDate() - currentDayOfWeek;\n\t\t\tlet weekStartTime = new Date(new Date(new Date().setDate(weekStartDate)).setHours(0, 0, 0)).getTime();\n\n\t\t\tif (\n\t\t\t\tdate.getFullYear() === currentDate.getFullYear()\n\t\t\t\t&& date.getMonth() === currentDate.getMonth()\n\t\t\t\t&& date.getDate() === currentDate.getDate()\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn Utils.date.format(date, 'H:i');\n\t\t\t}\n\t\t\telse if (date.getTime() > weekStartTime)\n\t\t\t{\n\t\t\t\treturn weekDays[dateWeekDay];\n\t\t\t}\n\t\t\telse if (date.getFullYear() === currentDate.getFullYear())\n\t\t\t{\n\t\t\t\treturn Utils.date.format(date, 'd.m');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Utils.date.format(date, 'd.m.Y');\n\t\t\t}\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlistItem()\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: this.rawListItem.id,\n\t\t\t\ttemplate: this.rawListItem.template,\n\t\t\t\ttype: this.rawListItem.chatType,\n\t\t\t\tsectionCode: this.rawListItem.sectionCode,\n\t\t\t\ttitle: {\n\t\t\t\t\tleftIcon: this.titleLeftIcon,\n\t\t\t\t\tvalue: this.titleValue\n\t\t\t\t},\n\t\t\t\tsubtitle: {\n\t\t\t\t\tvalue: this.rawListItem.message.text\n\t\t\t\t},\n\t\t\t\tavatar: {\n\t\t\t\t\turl: this.avatarUrl,\n\t\t\t\t\tbottomRightIcon: this.avatarBottomRightIcon\n\t\t\t\t},\n\t\t\t\tmessage: this.rawListItem.message,\n\t\t\t\tdate: {\n\t\t\t\t\tvalue: this.formatDate(this.rawListItem.message.date)\n\t\t\t\t},\n\t\t\t\tcounter: {\n\t\t\t\t\tvalue: this.rawListItem.counter,\n\t\t\t\t\tleftIcon: this.rawListItem.pinned ? 'pinned' : ''\n\t\t\t\t},\n\t\t\t\tnotification: false,\n\t\t\t}\n\t\t},\n\n\t\tlistItemStyle()\n\t\t{\n\t\t\tif (this.rawListItem.sectionCode === 'pinned')\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tbackgroundColor: '#f7f7f7'\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\n\t\timageStyle()\n\t\t{\n\t\t\tlet backgroundColor = '';\n\t\t\tif (!this.listItem.avatar.url)\n\t\t\t{\n\t\t\t\tbackgroundColor = this.imageColor;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundColor\n\t\t\t};\n\t\t},\n\n\t\timageClass()\n\t\t{\n\t\t\tlet classes = 'bx-vue-list-item-image ';\n\n\t\t\tif (this.isGeneralChat)\n\t\t\t{\n\t\t\t\tclasses += 'bx-vue-list-item-image-general';\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\n\t\timageColor()\n\t\t{\n\t\t\tif (this.isUser && this.userData)\n\t\t\t{\n\t\t\t\treturn this.userData.color;\n\t\t\t}\n\n\t\t\tif (this.isChat && this.dialogData)\n\t\t\t{\n\t\t\t\treturn this.dialogData.color;\n\t\t\t}\n\n\t\t\tif (this.isNotificationChat)\n\t\t\t{\n\t\t\t\treturn this.rawListItem.color;\n\t\t\t}\n\t\t},\n\n\t\tavatarUrl()\n\t\t{\n\t\t\tif (this.isGeneralChat)\n\t\t\t{\n\t\t\t\treturn '/bitrix/js/im/images/blank.gif';\n\t\t\t}\n\n\t\t\tif (this.isUser && this.userData)\n\t\t\t{\n\t\t\t\treturn this.userData.avatar;\n\t\t\t}\n\n\t\t\tif (this.isChat && this.dialogData)\n\t\t\t{\n\t\t\t\treturn this.dialogData.avatar;\n\t\t\t}\n\t\t},\n\n\t\tavatarBottomRightIcon()\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\tif (this.userData.isMobileOnline)\n\t\t\t\t{\n\t\t\t\t\treturn 'mobile-online';\n\t\t\t\t}\n\t\t\t\telse if (this.userData.isOnline && (this.userData.status === 'away' || this.userData.status === 'dnd'))\n\t\t\t\t{\n\t\t\t\t\treturn this.userData.status;\n\t\t\t\t}\n\t\t\t\telse if (this.userData.isOnline)\n\t\t\t\t{\n\t\t\t\t\treturn 'online';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn 'offline';\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\ttitleLeftIcon()\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\tif (this.userData.isAbsent)\n\t\t\t\t{\n\t\t\t\t\treturn 'absent';\n\t\t\t\t}\n\t\t\t\telse if (this.userData.isBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn 'birthday';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.isChat)\n\t\t\t{\n\t\t\t\treturn this.rawListItem.chatType;\n\t\t\t}\n\t\t},\n\n\t\ttitleValue()\n\t\t{\n\t\t\tif (this.isUser && this.userData)\n\t\t\t{\n\t\t\t\treturn this.userData.name;\n\t\t\t}\n\n\t\t\tif (this.isChat && this.dialogData)\n\t\t\t{\n\t\t\t\treturn this.dialogData.name;\n\t\t\t}\n\n\t\t\tif (this.isNotificationChat)\n\t\t\t{\n\t\t\t\treturn this.rawListItem.title;\n\t\t\t}\n\t\t},\n\n\t\tuserData()\n\t\t{\n\t\t\treturn this.$root.$store.getters['users/get'](this.rawListItem.userId);\n\t\t},\n\n\t\tdialogData()\n\t\t{\n\t\t\treturn this.$root.$store.getters['dialogues/getByChatId'](this.rawListItem.chatId);\n\t\t},\n\n\t\tisChat()\n\t\t{\n\t\t\treturn ['chat', 'open'].includes(this.rawListItem.chatType)\n\t\t},\n\n\t\tisUser()\n\t\t{\n\t\t\treturn this.rawListItem.chatType === 'user';\n\t\t},\n\n\t\tisNotificationChat()\n\t\t{\n\t\t\treturn this.rawListItem.id === 'notify';\n\t\t},\n\n\t\tisGeneralChat()\n\t\t{\n\t\t\treturn this.rawListItem.id === 'chat1';\n\t\t}\n\t}\n});"],"names":["Vue","cloneComponent","props","methods","formatDate","date","weekDays","Date","currentDate","dateWeekDay","getDay","currentDayOfWeek","weekStartDate","getDate","weekStartTime","setDate","setHours","getTime","getFullYear","getMonth","Utils","format","computed","listItem","id","rawListItem","template","type","chatType","sectionCode","title","leftIcon","titleLeftIcon","value","titleValue","subtitle","message","text","avatar","url","avatarUrl","bottomRightIcon","avatarBottomRightIcon","counter","pinned","notification","listItemStyle","backgroundColor","imageStyle","imageColor","imageClass","classes","isGeneralChat","isUser","userData","color","isChat","dialogData","isNotificationChat","isMobileOnline","isOnline","status","isAbsent","isBirthday","name","$root","$store","getters","userId","chatId","includes"],"mappings":";;;AAKAA,WAAG,CAACC,cAAJ,CAAmB,6BAAnB,EAAkD,iBAAlD,EACA;CACCC,EAAAA,KAAK,EAAE,CACN,aADM,EAEN,WAFM,CADR;CAMCC,EAAAA,OAAO,EACP;CACCC,IAAAA,UADD,sBACYC,IADZ,EAEC;CACC,UAAIC,QAAQ,GAAG,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B,IAA/B,EAAqC,IAArC,CAAf;CAEAD,MAAAA,IAAI,GAAG,IAAIE,IAAJ,CAASF,IAAT,CAAP;CACA,UAAIG,WAAW,GAAG,IAAID,IAAJ,EAAlB;CAEA,UAAIE,WAAW,GAAGJ,IAAI,CAACK,MAAL,MAAiBL,IAAI,CAACK,MAAL,OAAkB,CAAlB,GAAsB,CAAC,CAAvB,GAA2B,CAA5C,CAAlB;CACA,UAAIC,gBAAgB,GAAGH,WAAW,CAACE,MAAZ,MAAwBF,WAAW,CAACE,MAAZ,OAAyB,CAAzB,GAA6B,CAAC,CAA9B,GAAkC,CAA1D,CAAvB;CAEA,UAAIE,aAAa,GAAGJ,WAAW,CAACK,OAAZ,KAAwBF,gBAA5C;CACA,UAAIG,aAAa,GAAG,IAAIP,IAAJ,CAAS,IAAIA,IAAJ,CAAS,IAAIA,IAAJ,GAAWQ,OAAX,CAAmBH,aAAnB,CAAT,EAA4CI,QAA5C,CAAqD,CAArD,EAAwD,CAAxD,EAA2D,CAA3D,CAAT,EAAwEC,OAAxE,EAApB;;CAEA,UACCZ,IAAI,CAACa,WAAL,OAAuBV,WAAW,CAACU,WAAZ,EAAvB,IACGb,IAAI,CAACc,QAAL,OAAoBX,WAAW,CAACW,QAAZ,EADvB,IAEGd,IAAI,CAACQ,OAAL,OAAmBL,WAAW,CAACK,OAAZ,EAHvB,EAKA;CACC,eAAOO,kBAAK,CAACf,IAAN,CAAWgB,MAAX,CAAkBhB,IAAlB,EAAwB,KAAxB,CAAP;CACA,OAPD,MAQK,IAAIA,IAAI,CAACY,OAAL,KAAiBH,aAArB,EACL;CACC,eAAOR,QAAQ,CAACG,WAAD,CAAf;CACA,OAHI,MAIA,IAAIJ,IAAI,CAACa,WAAL,OAAuBV,WAAW,CAACU,WAAZ,EAA3B,EACL;CACC,eAAOE,kBAAK,CAACf,IAAN,CAAWgB,MAAX,CAAkBhB,IAAlB,EAAwB,KAAxB,CAAP;CACA,OAHI,MAKL;CACC,eAAOe,kBAAK,CAACf,IAAN,CAAWgB,MAAX,CAAkBhB,IAAlB,EAAwB,OAAxB,CAAP;CACA;CACD;CAlCF,GAPD;CA2CCiB,EAAAA,QAAQ,EACR;CACCC,IAAAA,QADD,sBAEC;CACC,aAAO;CACNC,QAAAA,EAAE,EAAE,KAAKC,WAAL,CAAiBD,EADf;CAENE,QAAAA,QAAQ,EAAE,KAAKD,WAAL,CAAiBC,QAFrB;CAGNC,QAAAA,IAAI,EAAE,KAAKF,WAAL,CAAiBG,QAHjB;CAINC,QAAAA,WAAW,EAAE,KAAKJ,WAAL,CAAiBI,WAJxB;CAKNC,QAAAA,KAAK,EAAE;CACNC,UAAAA,QAAQ,EAAE,KAAKC,aADT;CAENC,UAAAA,KAAK,EAAE,KAAKC;CAFN,SALD;CASNC,QAAAA,QAAQ,EAAE;CACTF,UAAAA,KAAK,EAAE,KAAKR,WAAL,CAAiBW,OAAjB,CAAyBC;CADvB,SATJ;CAYNC,QAAAA,MAAM,EAAE;CACPC,UAAAA,GAAG,EAAE,KAAKC,SADH;CAEPC,UAAAA,eAAe,EAAE,KAAKC;CAFf,SAZF;CAgBNN,QAAAA,OAAO,EAAE,KAAKX,WAAL,CAAiBW,OAhBpB;CAiBN/B,QAAAA,IAAI,EAAE;CACL4B,UAAAA,KAAK,EAAE,KAAK7B,UAAL,CAAgB,KAAKqB,WAAL,CAAiBW,OAAjB,CAAyB/B,IAAzC;CADF,SAjBA;CAoBNsC,QAAAA,OAAO,EAAE;CACRV,UAAAA,KAAK,EAAE,KAAKR,WAAL,CAAiBkB,OADhB;CAERZ,UAAAA,QAAQ,EAAE,KAAKN,WAAL,CAAiBmB,MAAjB,GAA0B,QAA1B,GAAqC;CAFvC,SApBH;CAwBNC,QAAAA,YAAY,EAAE;CAxBR,OAAP;CA0BA,KA7BF;CA+BCC,IAAAA,aA/BD,2BAgCC;CACC,UAAI,KAAKrB,WAAL,CAAiBI,WAAjB,KAAiC,QAArC,EACA;CACC,eAAO;CACNkB,UAAAA,eAAe,EAAE;CADX,SAAP;CAGA;;CAED,aAAO,EAAP;CACA,KAzCF;CA2CCC,IAAAA,UA3CD,wBA4CC;CACC,UAAID,eAAe,GAAG,EAAtB;;CACA,UAAI,CAAC,KAAKxB,QAAL,CAAce,MAAd,CAAqBC,GAA1B,EACA;CACCQ,QAAAA,eAAe,GAAG,KAAKE,UAAvB;CACA;;CAED,aAAO;CACNF,QAAAA,eAAe,EAAfA;CADM,OAAP;CAGA,KAtDF;CAwDCG,IAAAA,UAxDD,wBAyDC;CACC,UAAIC,OAAO,GAAG,yBAAd;;CAEA,UAAI,KAAKC,aAAT,EACA;CACCD,QAAAA,OAAO,IAAI,gCAAX;CACA;;CAED,aAAOA,OAAP;CACA,KAlEF;CAoECF,IAAAA,UApED,wBAqEC;CACC,UAAI,KAAKI,MAAL,IAAe,KAAKC,QAAxB,EACA;CACC,eAAO,KAAKA,QAAL,CAAcC,KAArB;CACA;;CAED,UAAI,KAAKC,MAAL,IAAe,KAAKC,UAAxB,EACA;CACC,eAAO,KAAKA,UAAL,CAAgBF,KAAvB;CACA;;CAED,UAAI,KAAKG,kBAAT,EACA;CACC,eAAO,KAAKjC,WAAL,CAAiB8B,KAAxB;CACA;CACD,KApFF;CAsFCf,IAAAA,SAtFD,uBAuFC;CACC,UAAI,KAAKY,aAAT,EACA;CACC,eAAO,gCAAP;CACA;;CAED,UAAI,KAAKC,MAAL,IAAe,KAAKC,QAAxB,EACA;CACC,eAAO,KAAKA,QAAL,CAAchB,MAArB;CACA;;CAED,UAAI,KAAKkB,MAAL,IAAe,KAAKC,UAAxB,EACA;CACC,eAAO,KAAKA,UAAL,CAAgBnB,MAAvB;CACA;CACD,KAtGF;CAwGCI,IAAAA,qBAxGD,mCAyGC;CACC,UAAI,KAAKW,MAAT,EACA;CACC,YAAI,KAAKC,QAAL,CAAcK,cAAlB,EACA;CACC,iBAAO,eAAP;CACA,SAHD,MAIK,IAAI,KAAKL,QAAL,CAAcM,QAAd,KAA2B,KAAKN,QAAL,CAAcO,MAAd,KAAyB,MAAzB,IAAmC,KAAKP,QAAL,CAAcO,MAAd,KAAyB,KAAvF,CAAJ,EACL;CACC,iBAAO,KAAKP,QAAL,CAAcO,MAArB;CACA,SAHI,MAIA,IAAI,KAAKP,QAAL,CAAcM,QAAlB,EACL;CACC,iBAAO,QAAP;CACA,SAHI,MAKL;CACC,iBAAO,SAAP;CACA;CACD;CACD,KA7HF;CA+HC5B,IAAAA,aA/HD,2BAgIC;CACC,UAAI,KAAKqB,MAAT,EACA;CACC,YAAI,KAAKC,QAAL,CAAcQ,QAAlB,EACA;CACC,iBAAO,QAAP;CACA,SAHD,MAIK,IAAI,KAAKR,QAAL,CAAcS,UAAlB,EACL;CACC,iBAAO,UAAP;CACA,SAHI,MAKL;CACC,iBAAO,EAAP;CACA;CACD;;CAED,UAAI,KAAKP,MAAT,EACA;CACC,eAAO,KAAK/B,WAAL,CAAiBG,QAAxB;CACA;CACD,KArJF;CAuJCM,IAAAA,UAvJD,wBAwJC;CACC,UAAI,KAAKmB,MAAL,IAAe,KAAKC,QAAxB,EACA;CACC,eAAO,KAAKA,QAAL,CAAcU,IAArB;CACA;;CAED,UAAI,KAAKR,MAAL,IAAe,KAAKC,UAAxB,EACA;CACC,eAAO,KAAKA,UAAL,CAAgBO,IAAvB;CACA;;CAED,UAAI,KAAKN,kBAAT,EACA;CACC,eAAO,KAAKjC,WAAL,CAAiBK,KAAxB;CACA;CACD,KAvKF;CAyKCwB,IAAAA,QAzKD,sBA0KC;CACC,aAAO,KAAKW,KAAL,CAAWC,MAAX,CAAkBC,OAAlB,CAA0B,WAA1B,EAAuC,KAAK1C,WAAL,CAAiB2C,MAAxD,CAAP;CACA,KA5KF;CA8KCX,IAAAA,UA9KD,wBA+KC;CACC,aAAO,KAAKQ,KAAL,CAAWC,MAAX,CAAkBC,OAAlB,CAA0B,uBAA1B,EAAmD,KAAK1C,WAAL,CAAiB4C,MAApE,CAAP;CACA,KAjLF;CAmLCb,IAAAA,MAnLD,oBAoLC;CACC,aAAO,CAAC,MAAD,EAAS,MAAT,EAAiBc,QAAjB,CAA0B,KAAK7C,WAAL,CAAiBG,QAA3C,CAAP;CACA,KAtLF;CAwLCyB,IAAAA,MAxLD,oBAyLC;CACC,aAAO,KAAK5B,WAAL,CAAiBG,QAAjB,KAA8B,MAArC;CACA,KA3LF;CA6LC8B,IAAAA,kBA7LD,gCA8LC;CACC,aAAO,KAAKjC,WAAL,CAAiBD,EAAjB,KAAwB,QAA/B;CACA,KAhMF;CAkMC4B,IAAAA,aAlMD,2BAmMC;CACC,aAAO,KAAK3B,WAAL,CAAiBD,EAAjB,KAAwB,OAA/B;CACA;CArMF;CA5CD,CADA;;;;"}