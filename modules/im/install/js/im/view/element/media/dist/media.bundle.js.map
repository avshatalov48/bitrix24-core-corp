{"version":3,"file":"media.bundle.js","sources":["../src/file.js","../src/audio.js","../src/image.js","../src/video.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './file.css';\nimport 'ui.icons';\n\nimport {Uploader} from \"ui.progressbarjs.uploader\";\n\nimport {BitrixVue} from 'ui.vue';\nimport {Vuex} from \"ui.vue.vuex\";\nimport {FilesModel} from 'im.model';\nimport { FileType, FileStatus, MessageType, EventType } from 'im.const';\nimport {Utils} from \"im.lib.utils\";\nimport { EventEmitter } from \"main.core.events\";\n\nBitrixVue.component('bx-im-view-element-file',\n{\n\t/*\n\t * @emits EventType.dialog.clickOnUploadCancel {file: object, event: MouseEvent}\n\t */\n\n\tmounted()\n\t{\n\t\tthis.createProgressbar();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.removeProgressbar();\n\t},\n\tprops:\n\t{\n\t\tuserId: { default: 0 },\n\t\tmessageType: { default: MessageType.self },\n\t\tfile: {\n\t\t\ttype: Object,\n\t\t\tdefault: FilesModel.create().getElementState\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload(file)\n\t\t{\n\t\t\tif (file.progress !== 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (BX.UI && BX.UI.Viewer && Object.keys(file.viewerAttrs).length > 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (file.type === FileType.image && file.urlShow)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tBXMobileApp.UI.Photo.show({\n\t\t\t\t\t\tphotos: this.files.collection[this.application.dialog.chatId].filter(file => file.type === 'image').map(file => {return {url: file.urlShow.replace('bxhttp', 'http')}}).reverse(),\n\t\t\t\t\t\tdefault_photo: file.urlShow.replace('bxhttp', 'http')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (file.type === FileType.video && file.urlShow)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlShow, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (file.urlDownload)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlDownload, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlDownload, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlShow, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcreateProgressbar()\n\t\t{\n\t\t\tif (this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.file.progress === 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet blurElement = undefined;\n\n\t\t\tif (\n\t\t\t\tthis.file.progress < 0\n\t\t\t\t|| this.file.type !== FileType.image && this.file.type !== FileType.video\n\t\t\t)\n\t\t\t{\n\t\t\t\tblurElement = false;\n\t\t\t}\n\n\t\t\tthis.uploader = new Uploader({\n\t\t\t\tcontainer: this.$refs.container,\n\t\t\t\tblurElement,\n\t\t\t\tdirection: this.$refs.container.offsetHeight > 54? Uploader.direction.vertical: Uploader.direction.horizontal,\n\t\t\t\ticon: this.file.progress < 0? Uploader.icon.cloud: Uploader.icon.cancel,\n\t\t\t\tsizes: {\n\t\t\t\t\tcircle: this.$refs.container.offsetHeight > 54? 54: 38,\n\t\t\t\t\tprogress: this.$refs.container.offsetHeight > 54? 4: 8,\n\t\t\t\t},\n\t\t\t\tlabels: {\n\t\t\t\t\tloading: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING'],\n\t\t\t\t\tcompleted: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_COMPLETED'],\n\t\t\t\t\tcanceled: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCELED'],\n\t\t\t\t\tcancelTitle: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCEL_TITLE'],\n\t\t\t\t\tmegabyte: this.localize['IM_MESSENGER_ELEMENT_FILE_SIZE_MB'],\n\t\t\t\t},\n\t\t\t\tcancelCallback: this.file.progress < 0? null: (event) => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.clickOnUploadCancel, {file: this.file, event});\n\t\t\t\t},\n\t\t\t\tdestroyCallback: () => {\n\t\t\t\t\tif (this.uploader)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.uploader = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.uploader.start();\n\n\t\t\tif(\n\t\t\t\tthis.file.size && (this.file.size/1024/1024) <= 2\n\t\t\t\t|| this.$refs.container.offsetHeight <= 54 && this.$refs.container.offsetWidth < 240\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgressTitleVisibility(false)\n\t\t\t}\n\n\t\t\tthis.updateProgressbar();\n\n\t\t\treturn true;\n\t\t},\n\t\tupdateProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\tlet result = this.createProgressbar();\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.file.status === FileStatus.error)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(0);\n\t\t\t\tthis.uploader.setCancelDisable(false);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.error);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_ERROR']);\n\t\t\t}\n\t\t\telse if (this.file.status === FileStatus.wait)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(this.file.progress > 5? this.file.progress: 5);\n\t\t\t\tthis.uploader.setCancelDisable(true);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.cloud);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_SAVING']);\n\t\t\t}\n\t\t\telse if (this.file.progress === 100)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(100);\n\t\t\t}\n\t\t\telse if (this.file.progress === -1)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(10);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_WAITING']);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.file.progress === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setIcon(Uploader.icon.cancel);\n\t\t\t\t}\n\t\t\t\tlet progress = this.file.progress > 5? this.file.progress: 5;\n\n\t\t\t\tthis.uploader.setProgress(progress);\n\n\t\t\t\tif((this.file.size/1024/1024) <= 2)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setByteSent(this.file.size/100*this.file.progress, this.file.size);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.uploader.destroy(false);\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tFileStatus: () => FileStatus,\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('IM_MESSENGER_ELEMENT_FILE_', this);\n\t\t},\n\t\tfileName()\n\t\t{\n\t\t\tlet maxLength = 70;\n\n\t\t\tif (this.file.name.length < maxLength)\n\t\t\t{\n\t\t\t\treturn this.file.name;\n\t\t\t}\n\n\t\t\tlet endWordLength = 10;\n\n\t\t\tlet secondPart = this.file.name.substring(this.file.name.length-1 - (this.file.extension.length+1+endWordLength));\n\t\t\tlet firstPart = this.file.name.substring(0, maxLength-secondPart.length-3);\n\n\t\t\treturn firstPart.trim()+'...'+secondPart.trim();\n\t\t},\n\t\tfileSize()\n\t\t{\n\t\t\tlet size = this.file.size;\n\n\t\t\tif (size <= 0)\n\t\t\t{\n\t\t\t\treturn '&nbsp;';\n\t\t\t}\n\n\t\t\tlet sizes = [\"BYTE\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\t\tlet position = 0;\n\n\t\t\twhile (size >= 1024 && position < 4)\n\t\t\t{\n\t\t\t\tsize /= 1024;\n\t\t\t\tposition++;\n\t\t\t}\n\n\t\t\treturn Math.round(size) + \" \" + this.localize['IM_MESSENGER_ELEMENT_FILE_SIZE_'+sizes[position]];\n\t\t},\n\t\tuploadProgress()\n\t\t{\n\t\t\treturn this.file.status+' '+this.file.progress;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t\tfiles: state => state.files,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tthis.updateProgressbar();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-element-file\" @click=\"download(file, $event)\" ref=\"container\">\n\t\t\t<div class=\"bx-im-element-file-icon\">\n\t\t\t\t<div :class=\"['ui-icon', 'ui-icon-file-'+file.icon]\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-element-file-block\">\n\t\t\t\t<div class=\"bx-im-element-file-name\" :title=\"file.name\">\n\t\t\t\t\t{{fileName}}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-element-file-size\" v-html=\"fileSize\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.design-tokens';\nimport './audio.css';\nimport \"ui.vue.components.audioplayer\";\n\nimport {Vue} from 'ui.vue';\nimport {MessageType} from 'im.const';\n\nVue.cloneComponent('bx-im-view-element-file-audio', 'bx-im-view-element-file',\n{\n\tcomputed:\n\t{\n\t\tbackground()\n\t\t{\n\t\t\treturn this.messageType === MessageType.self? 'dark': 'light';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['bx-im-element-file-audio', 'bx-im-element-file-audio-'+messageType]\" ref=\"container\">\n\t\t\t<bx-audioplayer :id=\"file.id\" :src=\"file.urlShow\" :background=\"background\"/>\n\t\t</div>\t\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './image.css';\nimport 'ui.vue.directives.lazyload';\nimport 'ui.icons';\nimport 'ui.vue.components.socialvideo';\n\nimport \"ui.vue.components.audioplayer\";\n\nimport {Vue} from 'ui.vue';\n\nVue.cloneComponent('bx-im-view-element-file-image', 'bx-im-view-element-file',\n{\n\tmethods:\n\t{\n\t\tgetImageSize(width, height, maxWidth)\n\t\t{\n\t\t\tlet aspectRatio;\n\n\t\t\tif (width > maxWidth)\n\t\t\t{\n\t\t\t\taspectRatio = maxWidth / width;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\taspectRatio = 1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: width * aspectRatio,\n\t\t\t\theight: height * aspectRatio\n\t\t\t};\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tstyleFileSizes()\n\t\t{\n\t\t\tlet sizes = this.getImageSize(this.file.image.width, this.file.image.height, 280);\n\n\t\t\treturn {\n\t\t\t\twidth: sizes.width+'px',\n\t\t\t\theight: sizes.height+'px',\n\t\t\t\tbackgroundSize: sizes.width < 100 || sizes.height < 100? 'contain': 'initial'\n\t\t\t}\n\t\t},\n\t\tstyleBoxSizes()\n\t\t{\n\t\t\tif (parseInt(this.styleFileSizes.height) <= 280)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: '280px'\n\t\t\t}\n\t\t},\n\t\tfileSource()\n\t\t{\n\t\t\treturn this.file.urlPreview;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-element-file-image\" @click=\"download(file, $event)\" :style=\"styleBoxSizes\" ref=\"container\">\n\t\t\t<img v-bx-lazyload\n\t\t\t\tclass=\"bx-im-element-file-image-source\"\n\t\t\t\t:data-lazyload-src=\"fileSource\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_MESSENGER_ELEMENT_FILE_SHOW_TITLE').replace('#NAME#', file.name).replace('#SIZE#', fileSize)\"\n\t\t\t\t:style=\"styleFileSizes\"\n\t\t\t\t:data-viewer=\"file.viewerAttrs.viewer === null\"\n\t\t\t\t:data-viewer-type=\"file.viewerAttrs.viewerType? file.viewerAttrs.viewerType: false\"\n\t\t\t\t:data-src=\"file.viewerAttrs.src? file.viewerAttrs.src: false\"\n\t\t\t\t:data-viewer-group-by=\"file.viewerAttrs.viewerGroupBy? file.viewerAttrs.viewerGroupBy: false\"\n\t\t\t\t:data-title=\"file.viewerAttrs.title? file.viewerAttrs.title: false\"\n\t\t\t\t:data-actions=\"file.viewerAttrs.actions? file.viewerAttrs.actions: false\"\n\t\t\t/>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.design-tokens';\nimport './video.css';\nimport 'ui.vue.directives.lazyload';\nimport 'ui.icons';\nimport \"ui.vue.components.socialvideo\";\nimport {Utils} from \"im.lib.utils\";\n\nimport {Vue} from 'ui.vue';\n\nVue.cloneComponent('bx-im-view-element-file-video', 'bx-im-view-element-file',\n{\n\tmethods:\n\t{\n\t\tgetImageSize(width, height, maxWidth)\n\t\t{\n\t\t\tlet aspectRatio;\n\n\t\t\tif (width > maxWidth)\n\t\t\t{\n\t\t\t\taspectRatio = maxWidth / width;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\taspectRatio = 1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: width * aspectRatio,\n\t\t\t\theight: height * aspectRatio\n\t\t\t};\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tisSafari()\n\t\t{\n\t\t\treturn Utils.browser.isSafari() || Utils.platform.isBitrixMobile();\n\t\t},\n\n\t\tstyleBoxSizes()\n\t\t{\n\t\t\tif (parseInt(this.styleVideoSizes.height) <= 280)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: '280px'\n\t\t\t}\n\t\t},\n\t\tstyleVideoSizes()\n\t\t{\n\t\t\tif (!this.file.image)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tlet sizes = this.getImageSize(this.file.image.width, this.file.image.height, 280);\n\n\t\t\treturn {\n\t\t\t\twidth: sizes.width+'px',\n\t\t\t\theight: sizes.height+'px',\n\t\t\t\tbackgroundSize: sizes.width < 100 || sizes.height < 100? 'contain': 'initial'\n\t\t\t}\n\t\t},\n\t\tautoplay()\n\t\t{\n\t\t\treturn this.file.size < 5000000 && this.application.options.autoplayVideo;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div :class=\"['bx-im-element-file-video', {'bx-im-element-file-video-safari': isSafari}]\" :style=\"styleBoxSizes\" ref=\"container\">\n\t\t\t<bx-socialvideo \n\t\t\t\t:id=\"file.id\" \n\t\t\t\t:src=\"file.urlShow\" \n\t\t\t\t:preview=\"file.urlPreview\" \n\t\t\t\t:containerStyle=\"styleBoxSizes\"\n\t\t\t\t:elementStyle=\"styleVideoSizes\"\n\t\t\t\t:autoplay=\"autoplay\"\n\t\t\t\t:showControls=\"!file.viewerAttrs.viewerType\"\n\t\t\t\t:data-viewer=\"file.viewerAttrs.viewer === null\"\n\t\t\t\t:data-viewer-type=\"file.viewerAttrs.viewerType? file.viewerAttrs.viewerType: false\"\n\t\t\t\t:data-src=\"file.viewerAttrs.src? file.viewerAttrs.src: false\"\n\t\t\t\t:data-viewer-group-by=\"file.viewerAttrs.viewerGroupBy? file.viewerAttrs.viewerGroupBy: false\"\n\t\t\t\t:data-title=\"file.viewerAttrs.title? file.viewerAttrs.title: false\"\n\t\t\t\t:data-actions=\"file.viewerAttrs.action? file.viewerAttrs.actions: false\"\n\t\t\t\t@click=\"download(file, $event)\"\n\t\t\t/>\n\t\t</div>\n\t`\n});"],"names":["BitrixVue","component","mounted","createProgressbar","beforeDestroy","removeProgressbar","props","userId","messageType","MessageType","self","file","type","Object","FilesModel","create","getElementState","methods","download","progress","BX","UI","Viewer","keys","viewerAttrs","length","FileType","image","urlShow","Utils","platform","isBitrixMobile","BXMobileApp","Photo","show","photos","files","collection","application","dialog","chatId","filter","map","url","replace","reverse","default_photo","window","open","video","app","openDocument","name","urlDownload","uploader","blurElement","undefined","Uploader","container","$refs","direction","offsetHeight","vertical","horizontal","icon","cloud","cancel","sizes","circle","labels","loading","localize","completed","canceled","cancelTitle","megabyte","cancelCallback","event","EventEmitter","emit","EventType","clickOnUploadCancel","destroyCallback","start","size","offsetWidth","setProgressTitleVisibility","updateProgressbar","result","status","FileStatus","error","setProgress","setCancelDisable","setIcon","setProgressTitle","wait","setByteSent","destroy","computed","getFilteredPhrases","fileName","maxLength","endWordLength","secondPart","substring","extension","firstPart","trim","fileSize","position","Math","round","uploadProgress","Vuex","mapState","state","watch","template","Vue","cloneComponent","background","getImageSize","width","height","maxWidth","aspectRatio","styleFileSizes","backgroundSize","styleBoxSizes","parseInt","fileSource","urlPreview","isSafari","browser","styleVideoSizes","autoplay","options","autoplayVideo"],"mappings":"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"}