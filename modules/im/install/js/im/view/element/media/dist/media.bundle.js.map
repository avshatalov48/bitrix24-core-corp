{"version":3,"file":"media.bundle.js","sources":["../src/file.js","../src/audio.js","../src/image.js","../src/video.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './file.css';\nimport 'ui.icons';\n\nimport {Uploader} from \"ui.progressbarjs.uploader\";\n\nimport {BitrixVue} from 'ui.vue';\nimport {Vuex} from \"ui.vue.vuex\";\nimport {FilesModel} from 'im.model';\nimport { FileType, FileStatus, MessageType, EventType } from 'im.const';\nimport {Utils} from \"im.lib.utils\";\nimport { EventEmitter } from \"main.core.events\";\n\nBitrixVue.component('bx-im-view-element-file',\n{\n\t/*\n\t * @emits EventType.dialog.clickOnUploadCancel {file: object, event: MouseEvent}\n\t */\n\n\tmounted()\n\t{\n\t\tthis.createProgressbar();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.removeProgressbar();\n\t},\n\tprops:\n\t{\n\t\tuserId: { default: 0 },\n\t\tmessageType: { default: MessageType.self },\n\t\tfile: {\n\t\t\ttype: Object,\n\t\t\tdefault: FilesModel.create().getElementState\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload(file)\n\t\t{\n\t\t\tif (file.progress !== 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (BX.UI && BX.UI.Viewer && Object.keys(file.viewerAttrs).length > 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (file.type === FileType.image && file.urlShow)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tBXMobileApp.UI.Photo.show({\n\t\t\t\t\t\tphotos: this.files.collection[this.application.dialog.chatId].filter(file => file.type === 'image').map(file => {return {url: file.urlShow.replace('bxhttp', 'http')}}).reverse(),\n\t\t\t\t\t\tdefault_photo: file.urlShow.replace('bxhttp', 'http')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (file.type === FileType.video && file.urlShow)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlShow, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (file.urlDownload)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlDownload, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlDownload, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlShow, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcreateProgressbar()\n\t\t{\n\t\t\tif (this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.file.progress === 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet blurElement = undefined;\n\n\t\t\tif (\n\t\t\t\tthis.file.progress < 0\n\t\t\t\t|| this.file.type !== FileType.image && this.file.type !== FileType.video\n\t\t\t)\n\t\t\t{\n\t\t\t\tblurElement = false;\n\t\t\t}\n\n\t\t\tthis.uploader = new Uploader({\n\t\t\t\tcontainer: this.$refs.container,\n\t\t\t\tblurElement,\n\t\t\t\tdirection: this.$refs.container.offsetHeight > 54? Uploader.direction.vertical: Uploader.direction.horizontal,\n\t\t\t\ticon: this.file.progress < 0? Uploader.icon.cloud: Uploader.icon.cancel,\n\t\t\t\tsizes: {\n\t\t\t\t\tcircle: this.$refs.container.offsetHeight > 54? 54: 38,\n\t\t\t\t\tprogress: this.$refs.container.offsetHeight > 54? 4: 8,\n\t\t\t\t},\n\t\t\t\tlabels: {\n\t\t\t\t\tloading: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING'],\n\t\t\t\t\tcompleted: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_COMPLETED'],\n\t\t\t\t\tcanceled: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCELED'],\n\t\t\t\t\tcancelTitle: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCEL_TITLE'],\n\t\t\t\t\tmegabyte: this.localize['IM_MESSENGER_ELEMENT_FILE_SIZE_MB'],\n\t\t\t\t},\n\t\t\t\tcancelCallback: this.file.progress < 0? null: (event) => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.clickOnUploadCancel, {file: this.file, event});\n\t\t\t\t},\n\t\t\t\tdestroyCallback: () => {\n\t\t\t\t\tif (this.uploader)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.uploader = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.uploader.start();\n\n\t\t\tif(\n\t\t\t\tthis.file.size && (this.file.size/1024/1024) <= 2\n\t\t\t\t|| this.$refs.container.offsetHeight <= 54 && this.$refs.container.offsetWidth < 240\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgressTitleVisibility(false)\n\t\t\t}\n\n\t\t\tthis.updateProgressbar();\n\n\t\t\treturn true;\n\t\t},\n\t\tupdateProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\tlet result = this.createProgressbar();\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.file.status === FileStatus.error)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(0);\n\t\t\t\tthis.uploader.setCancelDisable(false);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.error);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_ERROR']);\n\t\t\t}\n\t\t\telse if (this.file.status === FileStatus.wait)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(this.file.progress > 5? this.file.progress: 5);\n\t\t\t\tthis.uploader.setCancelDisable(true);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.cloud);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_SAVING']);\n\t\t\t}\n\t\t\telse if (this.file.progress === 100)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(100);\n\t\t\t}\n\t\t\telse if (this.file.progress === -1)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(10);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_WAITING']);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.file.progress === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setIcon(Uploader.icon.cancel);\n\t\t\t\t}\n\t\t\t\tlet progress = this.file.progress > 5? this.file.progress: 5;\n\n\t\t\t\tthis.uploader.setProgress(progress);\n\n\t\t\t\tif((this.file.size/1024/1024) <= 2)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setByteSent(this.file.size/100*this.file.progress, this.file.size);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.uploader.destroy(false);\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tFileStatus: () => FileStatus,\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('IM_MESSENGER_ELEMENT_FILE_', this);\n\t\t},\n\t\tfileName()\n\t\t{\n\t\t\tlet maxLength = 70;\n\n\t\t\tif (this.file.name.length < maxLength)\n\t\t\t{\n\t\t\t\treturn this.file.name;\n\t\t\t}\n\n\t\t\tlet endWordLength = 10;\n\n\t\t\tlet secondPart = this.file.name.substring(this.file.name.length-1 - (this.file.extension.length+1+endWordLength));\n\t\t\tlet firstPart = this.file.name.substring(0, maxLength-secondPart.length-3);\n\n\t\t\treturn firstPart.trim()+'...'+secondPart.trim();\n\t\t},\n\t\tfileSize()\n\t\t{\n\t\t\tlet size = this.file.size;\n\n\t\t\tif (size <= 0)\n\t\t\t{\n\t\t\t\treturn '&nbsp;';\n\t\t\t}\n\n\t\t\tlet sizes = [\"BYTE\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\t\tlet position = 0;\n\n\t\t\twhile (size >= 1024 && position < 4)\n\t\t\t{\n\t\t\t\tsize /= 1024;\n\t\t\t\tposition++;\n\t\t\t}\n\n\t\t\treturn Math.round(size) + \" \" + this.localize['IM_MESSENGER_ELEMENT_FILE_SIZE_'+sizes[position]];\n\t\t},\n\t\tuploadProgress()\n\t\t{\n\t\t\treturn this.file.status+' '+this.file.progress;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t\tfiles: state => state.files,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tthis.updateProgressbar();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-element-file\" @click=\"download(file, $event)\" ref=\"container\">\n\t\t\t<div class=\"bx-im-element-file-icon\">\n\t\t\t\t<div :class=\"['ui-icon', 'ui-icon-file-'+file.icon]\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-element-file-block\">\n\t\t\t\t<div class=\"bx-im-element-file-name\" :title=\"file.name\">\n\t\t\t\t\t{{fileName}}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-element-file-size\" v-html=\"fileSize\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.design-tokens';\nimport './audio.css';\nimport \"ui.vue.components.audioplayer\";\n\nimport {Vue} from 'ui.vue';\nimport {MessageType} from 'im.const';\n\nVue.cloneComponent('bx-im-view-element-file-audio', 'bx-im-view-element-file',\n{\n\tcomputed:\n\t{\n\t\tbackground()\n\t\t{\n\t\t\treturn this.messageType === MessageType.self? 'dark': 'light';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['bx-im-element-file-audio', 'bx-im-element-file-audio-'+messageType]\" ref=\"container\">\n\t\t\t<bx-audioplayer :id=\"file.id\" :src=\"file.urlShow\" :background=\"background\"/>\n\t\t</div>\t\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './image.css';\nimport 'ui.vue.directives.lazyload';\nimport 'ui.icons';\nimport 'ui.vue.components.socialvideo';\n\nimport \"ui.vue.components.audioplayer\";\n\nimport {Vue} from 'ui.vue';\n\nVue.cloneComponent('bx-im-view-element-file-image', 'bx-im-view-element-file',\n{\n\tmethods:\n\t{\n\t\tgetImageSize(width, height, maxWidth)\n\t\t{\n\t\t\tlet aspectRatio;\n\n\t\t\tif (width > maxWidth)\n\t\t\t{\n\t\t\t\taspectRatio = maxWidth / width;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\taspectRatio = 1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: width * aspectRatio,\n\t\t\t\theight: height * aspectRatio\n\t\t\t};\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tstyleFileSizes()\n\t\t{\n\t\t\tlet sizes = this.getImageSize(this.file.image.width, this.file.image.height, 280);\n\n\t\t\treturn {\n\t\t\t\twidth: sizes.width+'px',\n\t\t\t\theight: sizes.height+'px',\n\t\t\t\tbackgroundSize: sizes.width < 100 || sizes.height < 100? 'contain': 'initial'\n\t\t\t}\n\t\t},\n\t\tstyleBoxSizes()\n\t\t{\n\t\t\tif (parseInt(this.styleFileSizes.height) <= 280)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: '280px'\n\t\t\t}\n\t\t},\n\t\tfileSource()\n\t\t{\n\t\t\treturn this.file.urlPreview;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-element-file-image\" @click=\"download(file, $event)\" :style=\"styleBoxSizes\" ref=\"container\">\n\t\t\t<img v-bx-lazyload\n\t\t\t\tclass=\"bx-im-element-file-image-source\"\n\t\t\t\t:data-lazyload-src=\"fileSource\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_MESSENGER_ELEMENT_FILE_SHOW_TITLE').replace('#NAME#', file.name).replace('#SIZE#', fileSize)\"\n\t\t\t\t:style=\"styleFileSizes\"\n\t\t\t\t:data-viewer=\"file.viewerAttrs.viewer === null\"\n\t\t\t\t:data-viewer-type=\"file.viewerAttrs.viewerType? file.viewerAttrs.viewerType: false\"\n\t\t\t\t:data-src=\"file.viewerAttrs.src? file.viewerAttrs.src: false\"\n\t\t\t\t:data-viewer-group-by=\"file.viewerAttrs.viewerGroupBy? file.viewerAttrs.viewerGroupBy: false\"\n\t\t\t\t:data-title=\"file.viewerAttrs.title? file.viewerAttrs.title: false\"\n\t\t\t\t:data-actions=\"file.viewerAttrs.actions? file.viewerAttrs.actions: false\"\n\t\t\t/>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.design-tokens';\nimport './video.css';\nimport 'ui.vue.directives.lazyload';\nimport 'ui.icons';\nimport \"ui.vue.components.socialvideo\";\nimport {Utils} from \"im.lib.utils\";\n\nimport {Vue} from 'ui.vue';\n\nVue.cloneComponent('bx-im-view-element-file-video', 'bx-im-view-element-file',\n{\n\tmethods:\n\t{\n\t\tgetImageSize(width, height, maxWidth)\n\t\t{\n\t\t\tlet aspectRatio;\n\n\t\t\tif (width > maxWidth)\n\t\t\t{\n\t\t\t\taspectRatio = maxWidth / width;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\taspectRatio = 1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: width * aspectRatio,\n\t\t\t\theight: height * aspectRatio\n\t\t\t};\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tisSafari()\n\t\t{\n\t\t\treturn Utils.browser.isSafari() || Utils.platform.isBitrixMobile();\n\t\t},\n\n\t\tstyleBoxSizes()\n\t\t{\n\t\t\tif (parseInt(this.styleVideoSizes.height) <= 280)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: '280px'\n\t\t\t}\n\t\t},\n\t\tstyleVideoSizes()\n\t\t{\n\t\t\tif (!this.file.image)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tlet sizes = this.getImageSize(this.file.image.width, this.file.image.height, 280);\n\n\t\t\treturn {\n\t\t\t\twidth: sizes.width+'px',\n\t\t\t\theight: sizes.height+'px',\n\t\t\t\tbackgroundSize: sizes.width < 100 || sizes.height < 100? 'contain': 'initial'\n\t\t\t}\n\t\t},\n\t\tautoplay()\n\t\t{\n\t\t\treturn this.file.size < 5000000 && this.application.options.autoplayVideo;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div :class=\"['bx-im-element-file-video', {'bx-im-element-file-video-safari': isSafari}]\" :style=\"styleBoxSizes\" ref=\"container\">\n\t\t\t<bx-socialvideo \n\t\t\t\t:id=\"file.id\" \n\t\t\t\t:src=\"file.urlShow\" \n\t\t\t\t:preview=\"file.urlPreview\" \n\t\t\t\t:containerStyle=\"styleBoxSizes\"\n\t\t\t\t:elementStyle=\"styleVideoSizes\"\n\t\t\t\t:autoplay=\"autoplay\"\n\t\t\t\t:showControls=\"!file.viewerAttrs.viewerType\"\n\t\t\t\t:data-viewer=\"file.viewerAttrs.viewer === null\"\n\t\t\t\t:data-viewer-type=\"file.viewerAttrs.viewerType? file.viewerAttrs.viewerType: false\"\n\t\t\t\t:data-src=\"file.viewerAttrs.src? file.viewerAttrs.src: false\"\n\t\t\t\t:data-viewer-group-by=\"file.viewerAttrs.viewerGroupBy? file.viewerAttrs.viewerGroupBy: false\"\n\t\t\t\t:data-title=\"file.viewerAttrs.title? file.viewerAttrs.title: false\"\n\t\t\t\t:data-actions=\"file.viewerAttrs.action? file.viewerAttrs.actions: false\"\n\t\t\t\t@click=\"download(file, $event)\"\n\t\t\t/>\n\t\t</div>\n\t`\n});"],"names":["BitrixVue","component","mounted","createProgressbar","beforeDestroy","removeProgressbar","props","userId","messageType","MessageType","self","file","type","Object","FilesModel","create","getElementState","methods","download","progress","BX","UI","Viewer","keys","viewerAttrs","length","FileType","image","urlShow","Utils","platform","isBitrixMobile","BXMobileApp","Photo","show","photos","files","collection","application","dialog","chatId","filter","map","url","replace","reverse","default_photo","window","open","video","app","openDocument","name","urlDownload","uploader","blurElement","undefined","Uploader","container","$refs","direction","offsetHeight","vertical","horizontal","icon","cloud","cancel","sizes","circle","labels","loading","localize","completed","canceled","cancelTitle","megabyte","cancelCallback","event","EventEmitter","emit","EventType","clickOnUploadCancel","destroyCallback","start","size","offsetWidth","setProgressTitleVisibility","updateProgressbar","result","status","FileStatus","error","setProgress","setCancelDisable","setIcon","setProgressTitle","wait","setByteSent","destroy","computed","getFilteredPhrases","fileName","maxLength","endWordLength","secondPart","substring","extension","firstPart","trim","fileSize","position","Math","round","uploadProgress","Vuex","mapState","state","watch","template","Vue","cloneComponent","background","getImageSize","width","height","maxWidth","aspectRatio","styleFileSizes","backgroundSize","styleBoxSizes","parseInt","fileSource","urlPreview","isSafari","browser","styleVideoSizes","autoplay","options","autoplayVideo"],"mappings":"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"}