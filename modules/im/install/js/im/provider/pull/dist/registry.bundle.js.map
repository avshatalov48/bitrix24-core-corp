{"version":3,"file":"registry.bundle.js","sources":["../src/base.js","../src/call.js","../src/notifications.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Im base pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {EventType} from \"im.const\";\nimport {Logger} from \"im.lib.logger\";\nimport {EventEmitter} from 'main.core.events';\n\nexport class ImBasePullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\n\t\tif (\n\t\t\t!(\n\t\t\t\ttypeof this.option.handlingDialog === 'object'\n\t\t\t\t&& this.option.handlingDialog\n\t\t\t\t&& this.option.handlingDialog.chatId\n\t\t\t\t&& this.option.handlingDialog.dialogId\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.option.handlingDialog = false;\n\t\t}\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\tskipExecute(params, extra = {})\n\t{\n\t\tif (!extra.optionImportant)\n\t\t{\n\t\t\tif (this.option.skip)\n\t\t\t{\n\t\t\t\tLogger.info('Pull: command skipped while loading messages', params);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.option.handlingDialog)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof params.chatId !== 'undefined' || typeof params.dialogId !== 'undefined' )\n\t\t{\n\t\t\tif (\n\t\t\t\ttypeof params.chatId !== 'undefined'\n\t\t\t\t&& parseInt(params.chatId) === parseInt(this.option.handlingDialog.chatId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof params.dialogId !== 'undefined'\n\t\t\t\t&& params.dialogId.toString() === this.option.handlingDialog.dialogId.toString()\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thandleMessage(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageChat(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageAdd(params, extra)\n\t{\n\t\tLogger.warn('handleMessageAdd', params);\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet collection = this.store.state.messages.collection[params.chatId];\n\t\tif (!collection)\n\t\t{\n\t\t\tcollection = [];\n\t\t}\n\n\t\t//search for message with message id from params\n\t\tconst message = collection.find(element => {\n\t\t\tif (params.message.templateId && element.id === params.message.templateId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn element.id === params.message.id;\n\t\t});\n\n\t\t//stop if it's message with 'push' (pseudo push message in mobile)\n\t\tif (message && params.message.push)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.chat && params.chat[params.chatId])\n\t\t{\n\t\t\tconst existingChat = this.store.getters['dialogues/getByChatId'](params.chatId);\n\t\t\t//add new chat if there is no one\n\t\t\tif (!existingChat)\n\t\t\t{\n\t\t\t\tconst chatToAdd = Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tparams.chat[params.chatId],\n\t\t\t\t\t{dialogId: params.dialogId}\n\t\t\t\t);\n\t\t\t\tthis.store.dispatch('dialogues/set', chatToAdd);\n\t\t\t}\n\t\t\t//otherwise - update it\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\t\tdialogId: params.dialogId,\n\t\t\t\t\tfields: params.chat[params.chatId]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\t//add recent item if there is no one\n\t\tif (!recentItem)\n\t\t{\n\t\t\tconst newRecentItem = this.prepareRecentItem(params);\n\t\t\tthis.store.dispatch('recent/set', [newRecentItem]);\n\t\t}\n\t\t//otherwise - update it\n\t\telse\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tlines: params.lines || {id: 0},message: {\n\t\t\t\t\t\tid: params.message.id,\n\t\t\t\t\t\ttext: params.message.textOriginal,\n\t\t\t\t\t\tdate: params.message.date,\n\t\t\t\t\t\tsenderId: params.message.senderId,\n\t\t\t\t\t\twithFile: typeof params.message.params['FILE_ID'] !== 'undefined',\n\t\t\t\t\t\twithAttach: typeof params.message.params['ATTACH'] !== 'undefined',\n\t\t\t\t\t},\n\t\t\t\t\tcounter: params.counter\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//set users\n\t\tif (params.users)\n\t\t{\n\t\t\tthis.store.dispatch('users/set', VuexBuilderModel.convertToArray(params.users));\n\t\t}\n\n\t\t//set files\n\t\tif (params.files)\n\t\t{\n\t\t\tlet files = this.controller.application.prepareFilesBeforeSave(\n\t\t\t\tVuexBuilderModel.convertToArray(params.files)\n\t\t\t);\n\t\t\tfiles.forEach(file =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tfiles.length === 1\n\t\t\t\t\t&& params.message.templateFileId\n\t\t\t\t\t&& this.store.state.files.index[params.chatId]\n\t\t\t\t\t&& this.store.state.files.index[params.chatId][params.message.templateFileId]\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/update', {\n\t\t\t\t\t\tid: params.message.templateFileId,\n\t\t\t\t\t\tchatId: params.chatId,\n\t\t\t\t\t\tfields: file\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/set', file);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//if we already have message - update it and scrollToBottom\n\t\tif (message)\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we already have this message', params.message);\n\t\t\tthis.store.dispatch('messages/update', {\n\t\t\t\tid: message.id,\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tfields: {\n\t\t\t\t\t...params.message,\n\t\t\t\t\tsending: false,\n\t\t\t\t\terror: false,\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tif (!params.message.push)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {\n\t\t\t\t\t\tchatId: message.chatId,\n\t\t\t\t\t\tcancelIfScrollChange: params.message.senderId !== this.controller.application.getUserId()\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//if we dont have message and we have all pages - add new message and send newMessage event (handles scroll stuff)\n\t\t//we dont do anything if we dont have message and there are unloaded messages\n\t\telse if (this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we dont have this message', params.message);\n\t\t\tthis.store.dispatch('messages/setAfter', {\n\t\t\t\t...params.message,\n\t\t\t\tunread: true\n\t\t\t}).then(() => {\n\t\t\t\tif (!params.message.push)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.newMessage, {\n\t\t\t\t\t\tchatId: params.message.chatId,\n\t\t\t\t\t\tmessageId: params.message.id\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//stop writing event\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.message.senderId\n\t\t});\n\n\t\t//if we sent message and there are no unloaded unread pages - read all messages on server and client, set counter to 0\n\t\t//TODO: to think about it during new chat development\n\t\tif (\n\t\t\tparams.message.senderId === this.controller.application.getUserId()\n\t\t\t&& this.controller.application.isUnreadMessagesLoaded()\n\t\t)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.store.state.dialogues.collection[params.dialogId]\n\t\t\t\t&& this.store.state.dialogues.collection[params.dialogId].counter !== 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.controller.restClient.callMethod('im.dialog.read', {\n\t\t\t\t\tdialog_id: params.dialogId\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\t\t\t\tchatId: params.chatId\n\t\t\t\t\t}).then(result => {\n\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: false});\n\t\t\t\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\t\t\t\tdialogId: params.dialogId,\n\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\tcounter: 0,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t//increase the counter if message is not ours\n\t\telse if (params.message.senderId !== this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/increaseCounter', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tcount: 1,\n\t\t\t});\n\t\t}\n\n\t\t//set new lastMessageId (used for pagination)\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tlastMessageId: params.message.id\n\t\t\t}\n\t\t});\n\n\t\t//increase total message count\n\t\tthis.store.dispatch('dialogues/increaseMessageCounter', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tcount: 1,\n\t\t});\n\t}\n\n\thandleMessageUpdate(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\thandleMessageDelete(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\texecMessageUpdateOrDelete(params, extra, command)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId\n\t\t});\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {\n\t\t\t\ttext: command === \"messageUpdate\"? params.text: '',\n\t\t\t\ttextOriginal: command === \"messageUpdate\"? params.textOriginal: '',\n\t\t\t\tparams: params.params,\n\t\t\t\tblink: true\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t});\n\n\t\tlet recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (\n\t\t\tcommand === 'messageUpdate' &&\n\t\t\trecentItem.element &&\n\t\t\trecentItem.element.message.id === params.id\n\t\t)\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\ttext: params.text,\n\t\t\t\t\t\tdate: recentItem.element.message.date\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\tcommand === 'messageDelete' &&\n\t\t\trecentItem.element &&\n\t\t\trecentItem.element.message.id === params.id\n\t\t)\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\ttext: 'Message deleted',\n\t\t\t\t\t\tdate: recentItem.element.message.date\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\thandleMessageDeleteComplete(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/delete', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t});\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleMessageLike(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: {LIKE: params.users}}\n\t\t});\n\t}\n\n\thandleChatOwner(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\townerId: params.userId,\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChatManagers(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmanagerList: params.list,\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChatUpdateParams(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: params.params\n\t\t});\n\t}\n\n\thandleChatUserAdd(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {userCounter: params.userCount}\n\t\t});\n\t}\n\n\thandleChatUserLeave(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {userCounter: params.userCount}\n\t\t});\n\t}\n\n\thandleMessageParamsUpdate(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: params.params}\n\t\t}).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleStartWriting(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.startOpponentWriting(params);\n\t}\n\n\thandleReadMessage(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\tchatId: params.chatId,\n\t\t\treadId: params.lastId\n\t\t}).then(result => {\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tcounter: params.counter,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleReadMessageChat(params, extra)\n\t{\n\t\tthis.handleReadMessage(params, extra);\n\t}\n\n\thandleReadMessageOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\thandleReadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\texecReadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\tuserName: params.userName,\n\t\t\tmessageId: params.lastId,\n\t\t\tdate: params.date,\n\t\t\taction: true\n\t\t});\n\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (recentItem)\n\t\t{\n\t\t\tconst message = recentItem.element.message;\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tcounter: params.counter,\n\t\t\t\t\tmessage: {...message, status: 'delivered'}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\thandleUnreadMessageOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\thandleUnreadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\texecUnreadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleFileUpload(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('files/set', this.controller.application.prepareFilesBeforeSave(\n\t\t\t VuexBuilderModel.convertToArray({file: params.fileParams})\n\t\t)).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleChatPin(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/pin', {\n\t\t\tid: params.dialogId,\n\t\t\taction: params.active\n\t\t});\n\t}\n\n\thandleChatHide(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/delete', {\n\t\t\tid: params.dialogId\n\t\t});\n\t}\n\n\thandleChatMuteNotify(params, extra)\n\t{\n\t\tconst existingChat = this.store.getters['dialogues/get'](params.dialogId);\n\t\tif (!existingChat)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst existingMuteList = existingChat.muteList;\n\t\tlet newMuteList = [];\n\t\tconst currentUser = this.store.state.application.common.userId;\n\t\tif (params.mute)\n\t\t{\n\t\t\tnewMuteList = [...existingMuteList, currentUser];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewMuteList = existingMuteList.filter(element => {\n\t\t\t\treturn element !== currentUser;\n\t\t\t});\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmuteList: newMuteList\n\t\t\t}\n\t\t});\n\t}\n\n\thandleReadNotifyList(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: 'notify',\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleUserInvite(params, extra)\n\t{\n\t\tif (!params.invited)\n\t\t{\n\t\t\tthis.store.dispatch('users/update', {\n\t\t\t\tid: params.userId,\n\t\t\t\tfields: params.user\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareRecentItem(params)\n\t{\n\t\tlet type = 'user';\n\t\tif (params.dialogId.toString().startsWith('chat'))\n\t\t{\n\t\t\ttype = 'chat';\n\t\t}\n\t\tparams.dialogId.toString().startsWith('chat');\n\t\tconst title = type === 'chat'? params.chat[params.chatId].name: params.users[params.dialogId].name;\n\t\tconst chat = params.chat[params.chatId]? params.chat[params.chatId]: {};\n\t\tif (!params.users)\n\t\t{\n\t\t\tparams.users = {};\n\t\t}\n\t\tconst user = params.users[params.dialogId]? params.users[params.dialogId]: {};\n\t\tconst userId = type === 'user'? params.dialogId: 0;\n\n\t\treturn {\n\t\t\tid: params.dialogId,\n\t\t\ttype: type,\n\t\t\ttitle: title,\n\t\t\tcounter: params.counter,\n\t\t\tchatId: params.chatId,\n\t\t\tchat: chat,\n\t\t\tuser: user,\n\t\t\tuserId: userId,\n\t\t\tmessage: {\n\t\t\t\tid: params.message.id,\n\t\t\t\ttext: params.message.textOriginal,\n\t\t\t\tdate: params.message.date,\n\t\t\t\tsenderId: params.message.senderId,\n\t\t\t\twithFile: typeof params.message.params['FILE_ID'] !== 'undefined',\n\t\t\t\twithAttach: typeof params.message.params['ATTACH'] !== 'undefined',\n\t\t\t}\n\t\t};\n\t}\n}","/**\n * Bitrix Messenger\n * Im call pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\n\nexport class ImCallPullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.application === 'object' && params.application)\n\t\t{\n\t\t\tthis.application = params.application;\n\t\t}\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\thandleChatUserAdd(params)\n\t{\n\t\tif (params.dialogId !== this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst users = Object.values(params.users).map(user => {\n\t\t\treturn {...user, lastActivityDate: new Date()};\n\t\t});\n\t\tthis.store.commit('conference/common', {userCount: params.userCount});\n\t\tthis.store.dispatch('users/set', users);\n\t\tthis.store.dispatch('conference/setUsers', {users: users.map(user => user.id)});\n\t}\n\n\thandleChatUserLeave(params)\n\t{\n\t\tif (params.dialogId !== this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.userId === this.controller.getUserId())\n\t\t{\n\t\t\tthis.application.kickFromCall();\n\t\t}\n\n\t\tthis.store.commit('conference/common', {userCount: params.userCount});\n\t\tthis.store.dispatch('conference/removeUsers', {users: [params.userId]});\n\t}\n\n\thandleCallUserNameUpdate(params)\n\t{\n\t\tconst currentUser = this.store.getters['users/get'](params.userId);\n\t\tif (!currentUser)\n\t\t{\n\t\t\tthis.store.dispatch('users/set', {\n\t\t\t\tid: params.userId,\n\t\t\t\tlastActivityDate: new Date()\n\t\t\t});\n\t\t}\n\t\tthis.store.dispatch('users/update', {\n\t\t\tid: params.userId,\n\t\t\tfields: {name: params.name, lastActivityDate: new Date()}\n\t\t});\n\t}\n\n\thandleVideoconfShareUpdate(params)\n\t{\n\t\tif (params.dialogId === this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tpublic: {\n\t\t\t\t\t\tcode: params.newCode,\n\t\t\t\t\t\tlink:  params.newLink\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.application.changeVideoconfUrl(params.newLink);\n\t\t}\n\t}\n\n\thandleMessageChat(params)\n\t{\n\t\tthis.application.sendNewMessageNotify(params);\n\t}\n\n\thandleChatRename(params)\n\t{\n\t\tif (params.chatId !== this.application.getChatId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('conference/setConferenceTitle', {conferenceTitle: params.name});\n\t}\n\n\thandleConferenceUpdate(params)\n\t{\n\t\tif (params.chatId !== this.application.getChatId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.isBroadcast !== '')\n\t\t{\n\t\t\tthis.store.dispatch('conference/setBroadcastMode', {broadcastMode: params.isBroadcast});\n\t\t}\n\n\t\tif (params.presenters.length > 0)\n\t\t{\n\t\t\tthis.store.dispatch('conference/setPresenters', {presenters: params.presenters, replace: true});\n\t\t}\n\t}\n}\n","import {PullClient} from \"pull.client\";\n\nexport class ImNotificationsPullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.application === 'object' && params.application)\n\t\t{\n\t\t\tthis.application = params.application;\n\t\t}\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store ? params.store : {};\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\thandleNotifyAdd(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30 || params.onlyFlash === true)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst user = this.store.getters['users/get'](params.userId);\n\t\tif (!user)\n\t\t{\n\t\t\tconst users = [];\n\t\t\tusers.push({\n\t\t\t\tid: params.userId,\n\t\t\t\tavatar: params.userAvatar,\n\t\t\t\tcolor: params.userColor,\n\t\t\t\tname: params.userName\n\t\t\t});\n\n\t\t\tthis.store.dispatch('users/set', users);\n\t\t}\n\n\t\tthis.store.dispatch('notifications/add', { data: params });\n\t\tthis.store.dispatch('notifications/setCounter', { unreadTotal: params.counter });\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tmessage: {\n\t\t\t\t\tid: params.id,\n\t\t\t\t\ttext: params.text,\n\t\t\t\t\tdate: params.date\n\t\t\t\t},\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleNotifyConfirm(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('notifications/delete', {\n\t\t\tid: params.id,\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\t\tthis.updateRecentListOnDelete(params.counter);\n\t}\n\n\thandleNotifyRead(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', { ids: [id], action: true });\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\n\t}\n\n\thandleNotifyUnread(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', { ids: [id], action: false });\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleNotifyDelete(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst idsToDelete = Object.keys(params.id).map(id => parseInt(id, 10));\n\n\t\tidsToDelete.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/delete', { id: id });\n\t\t});\n\n\t\tthis.updateRecentListOnDelete(params.counter)\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\t}\n\n\tupdateRecentListOnDelete(counterValue)\n\t{\n\t\tlet message;\n\t\tconst latestNotification = this.getLatest();\n\t\tif (latestNotification !== null)\n\t\t{\n\t\t\tmessage = {\n\t\t\t\tid: latestNotification.id,\n\t\t\t\ttext: latestNotification.text,\n\t\t\t\tdate: latestNotification.date\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst notificationChat = this.store.getters['recent/get']('notify');\n\t\t\tif (notificationChat === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmessage = notificationChat.element.message;\n\t\t\tmessage.text = this.controller.localize['IM_NOTIFICATIONS_DELETED_ITEM_STUB'];\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tmessage: message,\n\t\t\t\tcounter: counterValue\n\t\t\t}\n\t\t});\n\t}\n\n\tgetLatest()\n\t{\n\t\tlet latestNotification = {\n\t\t\tid: 0\n\t\t};\n\n\t\tfor (const notification of this.store.state.notifications.collection)\n\t\t{\n\t\t\tif (notification.id > latestNotification.id)\n\t\t\t{\n\t\t\t\tlatestNotification = notification;\n\t\t\t}\n\t\t}\n\n\t\tif (latestNotification.id === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn latestNotification;\n\t}\n}\n","/**\n * Bitrix Messenger\n * Bundle pull command handlers\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {ImBasePullHandler} from \"./base\";\nimport {ImCallPullHandler} from \"./call\";\nimport {ImNotificationsPullHandler} from \"./notifications\";\n\nexport {\n\tImBasePullHandler,\n\tImCallPullHandler,\n\tImNotificationsPullHandler\n}"],"names":["ImBasePullHandler","params","controller","store","option","handlingDialog","chatId","dialogId","PullClient","SubscriptionType","Server","extra","optionImportant","skip","Logger","info","parseInt","toString","handleMessageAdd","warn","skipExecute","collection","state","messages","message","find","element","templateId","id","push","chat","existingChat","getters","chatToAdd","Object","assign","dispatch","fields","recentItem","newRecentItem","prepareRecentItem","lines","text","textOriginal","date","senderId","withFile","withAttach","counter","users","VuexBuilderModel","convertToArray","files","application","prepareFilesBeforeSave","forEach","file","length","templateFileId","index","then","EventEmitter","emit","EventType","dialog","scrollToBottom","cancelIfScrollChange","sending","error","getUserId","isUnreadMessagesLoaded","unread","newMessage","messageId","stopOpponentWriting","userId","dialogues","restClient","callMethod","dialog_id","result","count","lastMessageId","command","execMessageUpdateOrDelete","blink","action","LIKE","ownerId","managerList","list","userCounter","userCount","startOpponentWriting","readId","lastId","handleReadMessage","execReadMessageOpponent","userName","status","execUnreadMessageOpponent","fileParams","active","existingMuteList","muteList","newMuteList","currentUser","common","mute","filter","invited","user","type","startsWith","title","name","ImCallPullHandler","values","map","lastActivityDate","Date","commit","kickFromCall","code","newCode","link","newLink","changeVideoconfUrl","sendNewMessageNotify","getChatId","conferenceTitle","isBroadcast","broadcastMode","presenters","replace","ImNotificationsPullHandler","server_time_ago","onlyFlash","avatar","userAvatar","color","userColor","data","unreadTotal","updateRecentListOnDelete","ids","idsToDelete","keys","counterValue","latestNotification","getLatest","notificationChat","localize","notifications","notification"],"mappings":"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"}