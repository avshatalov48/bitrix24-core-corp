{"version":3,"file":"registry.bundle.js","sources":["../src/base.js","../src/call.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Im base pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {EventType} from \"im.const\";\nimport {Logger} from \"im.lib.logger\";\n\nexport class ImBasePullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\n\t\tif (\n\t\t\t!(\n\t\t\t\ttypeof this.option.handlingDialog === 'object'\n\t\t\t\t&& this.option.handlingDialog\n\t\t\t\t&& this.option.handlingDialog.chatId\n\t\t\t\t&& this.option.handlingDialog.dialogId\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.option.handlingDialog = false;\n\t\t}\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\tskipExecute(params, extra = {})\n\t{\n\t\tif (!extra.optionImportant)\n\t\t{\n\t\t\tif (this.option.skip)\n\t\t\t{\n\t\t\t\tLogger.info('Pull: command skipped while loading messages', params);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.option.handlingDialog)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof params.chatId !== 'undefined' || typeof params.dialogId !== 'undefined' )\n\t\t{\n\t\t\tif (\n\t\t\t\ttypeof params.chatId !== 'undefined'\n\t\t\t\t&& parseInt(params.chatId) === parseInt(this.option.handlingDialog.chatId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof params.dialogId !== 'undefined'\n\t\t\t\t&& params.dialogId.toString() === this.option.handlingDialog.dialogId.toString()\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thandleMessage(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageChat(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageAdd(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.chat && params.chat[params.chatId])\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: params.chat[params.chatId]\n\t\t\t});\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmessage: {\n\t\t\t\t\tid: params.message.id,\n\t\t\t\t\ttext: params.message.text,\n\t\t\t\t\tdate: params.message.date\n\t\t\t\t},\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\n\t\tif (params.users)\n\t\t{\n\t\t\tthis.store.dispatch('users/set', VuexBuilderModel.convertToArray(params.users));\n\t\t}\n\n\t\tif (params.files)\n\t\t{\n\t\t\tlet files = VuexBuilderModel.convertToArray(params.files);\n\t\t\tfiles.forEach(file =>\n\t\t\t{\n\t\t\t\tfile = this.controller.application.prepareFilesBeforeSave(file);\n\t\t\t\tif (\n\t\t\t\t\tfiles.length === 1\n\t\t\t\t\t&& params.message.templateFileId\n\t\t\t\t\t&& this.store.state.files.index[params.chatId]\n\t\t\t\t\t&& this.store.state.files.index[params.chatId][params.message.templateFileId]\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/update', {\n\t\t\t\t\t\tid: params.message.templateFileId,\n\t\t\t\t\t\tchatId: params.chatId,\n\t\t\t\t\t\tfields: file\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.controller.application.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/set', file);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tlet collection = this.store.state.messages.collection[params.chatId];\n\t\tif (!collection)\n\t\t{\n\t\t\tcollection = [];\n\t\t}\n\n\t\tlet update = false;\n\t\tif (params.message.templateId && collection.length > 0)\n\t\t{\n\t\t\tfor (let index = collection.length-1; index >= 0; index--)\n\t\t\t{\n\t\t\t\tif (collection[index].id === params.message.templateId)\n\t\t\t\t{\n\t\t\t\t\tupdate = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (update)\n\t\t{\n\t\t\tthis.store.dispatch('messages/update', {\n\t\t\t\tid: params.message.templateId,\n\t\t\t\tchatId: params.chatId,\n\t\t\t\tfields: {\n\t\t\t\t\tpush: false,\n\t\t\t\t\t...params.message,\n\t\t\t\t\tsending: false,\n\t\t\t\t\terror: false,\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.application.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: params.message.senderId !== this.controller.application.getUserId()});\n\t\t\t});\n\t\t}\n\t\telse if (this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tif (this.controller.application.getChatId() === params.chatId)\n\t\t\t{\n\t\t\t\tthis.store.commit('application/increaseDialogExtraCount');\n\t\t\t}\n\n\t\t\tthis.store.dispatch('messages/setAfter', {\n\t\t\t\tpush: false,\n\t\t\t\t...params.message,\n\t\t\t\tunread: true\n\t\t\t});\n\t\t}\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.message.senderId\n\t\t});\n\n\t\tif (params.message.senderId === this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\t\tchatId: params.chatId\n\t\t\t}).then(result => {\n\t\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\t\tdialogId: params.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: 0,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/increaseCounter', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tcount: 1,\n\t\t\t});\n\t\t}\n\t}\n\n\thandleMessageUpdate(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\thandleMessageDelete(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\texecMessageUpdateOrDelete(params, extra, command)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId\n\t\t});\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {\n\t\t\t\ttext: command === \"messageUpdate\"? params.text: '',\n\t\t\t\ttextOriginal: command === \"messageUpdate\"? params.textOriginal: '',\n\t\t\t\tparams: params.params,\n\t\t\t\tblink: true\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tthis.controller.application.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: true});\n\t\t});\n\n\t\tlet recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (\n\t\t\tcommand === 'messageUpdate' &&\n\t\t\trecentItem.element &&\n\t\t\trecentItem.element.message.id === params.id\n\t\t)\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\ttext: params.text,\n\t\t\t\t\t\tdate: recentItem.element.message.date\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\tcommand === 'messageDelete' &&\n\t\t\trecentItem.element &&\n\t\t\trecentItem.element.message.id === params.id\n\t\t)\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\ttext: 'Message deleted',\n\t\t\t\t\t\tdate: recentItem.element.message.date\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\thandleMessageDeleteComplete(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/delete', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t});\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleMessageLike(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: {LIKE: params.users}}\n\t\t});\n\t}\n\n\thandleChatOwner(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\townerId: params.userId,\n\t\t\t}\n\t\t});\n\t}\n\n\thandleMessageParamsUpdate(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: params.params}\n\t\t}).then(() => {\n\t\t\tthis.controller.application.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleStartWriting(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.startOpponentWriting(params);\n\t}\n\n\thandleReadMessage(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\tchatId: params.chatId,\n\t\t\treadId: params.lastId\n\t\t}).then(result => {\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tcounter: params.counter,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleReadMessageChat(params, extra)\n\t{\n\t\tthis.handleReadMessage(params, extra);\n\t}\n\n\thandleReadMessageOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\thandleReadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\texecReadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\tuserName: params.userName,\n\t\t\tmessageId: params.lastId,\n\t\t\tdate: params.date,\n\t\t\taction: true\n\t\t});\n\t}\n\n\thandleUnreadMessageOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\thandleUnreadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\texecUnreadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleFileUpload(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('files/set', this.controller.application.prepareFilesBeforeSave(\n\t\t\t VuexBuilderModel.convertToArray({file: params.fileParams})\n\t\t)).then(() => {\n\t\t\tthis.controller.application.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleChatPin(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/pin', {\n\t\t\tid: params.dialogId,\n\t\t\taction: params.active\n\t\t});\n\t}\n\n\thandleChatHide(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/delete', {\n\t\t\tid: params.dialogId\n\t\t});\n\t}\n\n\thandleReadNotifyList(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: 'notify',\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleUserInvite(params, extra)\n\t{\n\t\tif (!params.invited)\n\t\t{\n\t\t\tthis.store.dispatch('users/update', {\n\t\t\t\tid: params.userId,\n\t\t\t\tfields: params.user\n\t\t\t});\n\t\t}\n\t}\n}","/**\n * Bitrix Messenger\n * Im call pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\nimport {CallErrorCode} from \"im.const\";\n\nexport class ImCallPullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.application === 'object' && params.application)\n\t\t{\n\t\t\tthis.application = params.application;\n\t\t}\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\thandleChatUserAdd(params)\n\t{\n\t\tconst users = Object.values(params.users).map(user => {\n\t\t\treturn {...user, lastActivityDate: new Date()};\n\t\t});\n\t\tthis.store.commit('callApplication/common', {userCount: params.userCount});\n\t\tthis.store.commit('users/set', users);\n\t}\n\n\thandleChatUserLeave(params)\n\t{\n\t\tif (params.userId === this.controller.getUserId() && params.dialogId === this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\tthis.application.kickFromCall();\n\t\t}\n\n\t\tthis.store.commit('callApplication/common', {userCount: params.userCount});\n\t}\n\n\thandleCallUserNameUpdate(params)\n\t{\n\t\tthis.store.dispatch('users/update', {\n\t\t\tid: params.userId,\n\t\t\tfields: {name: params.name, lastActivityDate: new Date()}\n\t\t});\n\t}\n\n\thandleVideoconfShareUpdate(params)\n\t{\n\t\tif (params.dialogId === this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\tthis.application.changeVideoconfUrl(params.newLink);\n\t\t}\n\t}\n\n\thandleMessageChat(params)\n\t{\n\t\tif (\n\t\t\tparams.chatId === this.application.getChatId() &&\n\t\t\t!this.store.state.callApplication.common.showChat &&\n\t\t\tparams.message.senderId !== this.controller.getUserId()\n\t\t)\n\t\t{\n\t\t\tlet text = '';\n\n\t\t\tif (params.message.senderId === 0 || params.message.system === 'Y')\n\t\t\t{\n\t\t\t\ttext = params.message.text;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst userName = params.users[params.message.senderId].name;\n\n\t\t\t\tif (params.message.text === '' && Object.keys(params.files).length > 0)\n\t\t\t\t{\n\t\t\t\t\ttext = `${userName}: ${this.controller.localize['BX_IM_COMPONENT_CALL_FILE']}`;\n\t\t\t\t}\n\t\t\t\telse if (params.message.text !== '')\n\t\t\t\t{\n\t\t\t\t\ttext = `${userName}: ${params.message.text}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.application.sendNewMessageNotify(text);\n\t\t}\n\t}\n}","/**\n * Bitrix Messenger\n * Bundle pull command handlers\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {ImBasePullHandler} from \"./base\";\nimport {ImCallPullHandler} from \"./call\";\n\nexport {\n\tImBasePullHandler,\n\tImCallPullHandler,\n}"],"names":["ImBasePullHandler","params","controller","store","option","handlingDialog","chatId","dialogId","PullClient","SubscriptionType","Server","extra","optionImportant","skip","Logger","info","parseInt","toString","handleMessageAdd","skipExecute","chat","dispatch","fields","id","message","text","date","counter","users","VuexBuilderModel","convertToArray","files","forEach","file","application","prepareFilesBeforeSave","length","templateFileId","state","index","then","emit","EventType","dialog","scrollToBottom","cancelIfScrollChange","collection","messages","update","templateId","push","sending","error","senderId","getUserId","isUnreadMessagesLoaded","getChatId","commit","unread","stopOpponentWriting","userId","result","count","command","execMessageUpdateOrDelete","textOriginal","blink","recentItem","getters","element","action","LIKE","ownerId","startOpponentWriting","readId","lastId","handleReadMessage","execReadMessageOpponent","userName","messageId","execUnreadMessageOpponent","fileParams","active","invited","user","ImCallPullHandler","Object","values","map","lastActivityDate","Date","userCount","kickFromCall","name","changeVideoconfUrl","newLink","callApplication","common","showChat","system","keys","localize","sendNewMessageNotify"],"mappings":"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"}