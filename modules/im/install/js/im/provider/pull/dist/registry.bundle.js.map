{"version":3,"file":"registry.bundle.js","sources":["../src/base.js","../src/call.js","../src/notifications.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Im base pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {EventType} from \"im.const\";\nimport {Logger} from \"im.lib.logger\";\nimport {EventEmitter} from 'main.core.events';\n\nexport class ImBasePullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\n\t\tif (\n\t\t\t!(\n\t\t\t\ttypeof this.option.handlingDialog === 'object'\n\t\t\t\t&& this.option.handlingDialog\n\t\t\t\t&& this.option.handlingDialog.chatId\n\t\t\t\t&& this.option.handlingDialog.dialogId\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.option.handlingDialog = false;\n\t\t}\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\tskipExecute(params, extra = {})\n\t{\n\t\tif (!extra.optionImportant)\n\t\t{\n\t\t\tif (this.option.skip)\n\t\t\t{\n\t\t\t\tLogger.info('Pull: command skipped while loading messages', params);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.option.handlingDialog)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof params.chatId !== 'undefined' || typeof params.dialogId !== 'undefined' )\n\t\t{\n\t\t\tif (\n\t\t\t\ttypeof params.chatId !== 'undefined'\n\t\t\t\t&& parseInt(params.chatId) === parseInt(this.option.handlingDialog.chatId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof params.dialogId !== 'undefined'\n\t\t\t\t&& params.dialogId.toString() === this.option.handlingDialog.dialogId.toString()\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thandleMessage(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageChat(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageAdd(params, extra)\n\t{\n\t\tLogger.warn('handleMessageAdd', params);\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet collection = this.store.state.messages.collection[params.chatId];\n\t\tif (!collection)\n\t\t{\n\t\t\tcollection = [];\n\t\t}\n\n\t\t//search for message with message id from params\n\t\tconst message = collection.find(element => {\n\t\t\tif (params.message.templateId && element.id === params.message.templateId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn element.id === params.message.id;\n\t\t});\n\n\t\t//stop if it's message with 'push' (pseudo push message in mobile)\n\t\tif (message && params.message.push)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.chat && params.chat[params.chatId])\n\t\t{\n\t\t\tconst existingChat = this.store.getters['dialogues/getByChatId'](params.chatId);\n\t\t\t//add new chat if there is no one\n\t\t\tif (!existingChat)\n\t\t\t{\n\t\t\t\tconst chatToAdd = Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tparams.chat[params.chatId],\n\t\t\t\t\t{dialogId: params.dialogId}\n\t\t\t\t);\n\t\t\t\tthis.store.dispatch('dialogues/set', chatToAdd);\n\t\t\t}\n\t\t\t//otherwise - update it\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\t\tdialogId: params.dialogId,\n\t\t\t\t\tfields: params.chat[params.chatId]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//set users\n\t\tif (params.users)\n\t\t{\n\t\t\tthis.store.dispatch('users/set', VuexBuilderModel.convertToArray(params.users));\n\t\t}\n\n\t\t//set files\n\t\tif (params.files)\n\t\t{\n\t\t\tlet files = this.controller.application.prepareFilesBeforeSave(\n\t\t\t\tVuexBuilderModel.convertToArray(params.files)\n\t\t\t);\n\t\t\tfiles.forEach(file =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tfiles.length === 1\n\t\t\t\t\t&& params.message.templateFileId\n\t\t\t\t\t&& this.store.state.files.index[params.chatId]\n\t\t\t\t\t&& this.store.state.files.index[params.chatId][params.message.templateFileId]\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/update', {\n\t\t\t\t\t\tid: params.message.templateFileId,\n\t\t\t\t\t\tchatId: params.chatId,\n\t\t\t\t\t\tfields: file\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/set', file);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//if we already have message - update it and scrollToBottom\n\t\tif (message)\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we already have this message', params.message);\n\t\t\tthis.store.dispatch('messages/update', {\n\t\t\t\tid: message.id,\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tfields: {\n\t\t\t\t\t...params.message,\n\t\t\t\t\tsending: false,\n\t\t\t\t\terror: false,\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tif (!params.message.push)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {\n\t\t\t\t\t\tchatId: message.chatId,\n\t\t\t\t\t\tcancelIfScrollChange: params.message.senderId !== this.controller.application.getUserId()\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//if we dont have message and we have all pages - add new message and send newMessage event (handles scroll stuff)\n\t\t//we dont do anything if we dont have message and there are unloaded messages\n\t\telse if (this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we dont have this message', params.message);\n\t\t\tthis.store.dispatch('messages/setAfter', {\n\t\t\t\t...params.message,\n\t\t\t\tunread: true\n\t\t\t}).then(() => {\n\t\t\t\tif (!params.message.push)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.newMessage, {\n\t\t\t\t\t\tchatId: params.message.chatId,\n\t\t\t\t\t\tmessageId: params.message.id\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//stop writing event\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.message.senderId\n\t\t});\n\n\t\t// if we sent message - read all messages on server and client, set counter to 0\n\t\tif (params.message.senderId === this.controller.application.getUserId())\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.store.state.dialogues.collection[params.dialogId]\n\t\t\t\t&& this.store.state.dialogues.collection[params.dialogId].counter !== 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.controller.restClient.callMethod('im.dialog.read', {\n\t\t\t\t\tdialog_id: params.dialogId\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\t\t\t\tchatId: params.chatId\n\t\t\t\t\t}).then(result => {\n\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: false});\n\t\t\t\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\t\t\t\tdialogId: params.dialogId,\n\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\tcounter: 0,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t//increase the counter if message is not ours\n\t\telse if (params.message.senderId !== this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/increaseCounter', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tcount: 1,\n\t\t\t});\n\t\t}\n\n\t\t//set new lastMessageId (used for pagination)\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tlastMessageId: params.message.id\n\t\t\t}\n\t\t});\n\n\t\t//increase total message count\n\t\tthis.store.dispatch('dialogues/increaseMessageCounter', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tcount: 1,\n\t\t});\n\t}\n\n\thandleMessageUpdate(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\thandleMessageDelete(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\texecMessageUpdateOrDelete(params, extra, command)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId\n\t\t});\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {\n\t\t\t\ttext: command === \"messageUpdate\"? params.text: '',\n\t\t\t\ttextOriginal: command === \"messageUpdate\"? params.textOriginal: '',\n\t\t\t\tparams: params.params,\n\t\t\t\tblink: true\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleMessageDeleteComplete(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/delete', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t});\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleMessageLike(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: {LIKE: params.users}}\n\t\t});\n\t}\n\n\thandleChatOwner(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\townerId: params.userId,\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChatManagers(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmanagerList: params.list,\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChatUpdateParams(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: params.params\n\t\t});\n\t}\n\n\thandleChatUserAdd(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {userCounter: params.userCount}\n\t\t});\n\t}\n\n\thandleChatUserLeave(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {userCounter: params.userCount}\n\t\t});\n\t}\n\n\thandleMessageParamsUpdate(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: params.params}\n\t\t}).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleStartWriting(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.startOpponentWriting(params);\n\t}\n\n\thandleReadMessage(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\tchatId: params.chatId,\n\t\t\treadId: params.lastId\n\t\t}).then(result => {\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tcounter: params.counter,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\thandleReadMessageChat(params, extra)\n\t{\n\t\tthis.handleReadMessage(params, extra);\n\t}\n\n\thandleReadMessageOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\thandleReadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\texecReadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\tuserName: params.userName,\n\t\t\tmessageId: params.lastId,\n\t\t\tdate: params.date,\n\t\t\taction: true\n\t\t});\n\t}\n\n\thandleUnreadMessageOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\thandleUnreadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\texecUnreadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleFileUpload(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('files/set', this.controller.application.prepareFilesBeforeSave(\n\t\t\t VuexBuilderModel.convertToArray({file: params.fileParams})\n\t\t)).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleChatMuteNotify(params, extra)\n\t{\n\t\tconst existingChat = this.store.getters['dialogues/get'](params.dialogId);\n\t\tif (!existingChat)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst existingMuteList = existingChat.muteList;\n\t\tlet newMuteList = [];\n\t\tconst currentUser = this.store.state.application.common.userId;\n\t\tif (params.mute)\n\t\t{\n\t\t\tnewMuteList = [...existingMuteList, currentUser];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewMuteList = existingMuteList.filter(element => {\n\t\t\t\treturn element !== currentUser;\n\t\t\t});\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmuteList: newMuteList\n\t\t\t}\n\t\t});\n\t}\n\n\thandleUserInvite(params, extra)\n\t{\n\t\tif (!params.invited)\n\t\t{\n\t\t\tthis.store.dispatch('users/update', {\n\t\t\t\tid: params.userId,\n\t\t\t\tfields: params.user\n\t\t\t});\n\t\t}\n\t}\n}","/**\n * Bitrix Messenger\n * Im call pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\n\nexport class ImCallPullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.application === 'object' && params.application)\n\t\t{\n\t\t\tthis.application = params.application;\n\t\t}\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\thandleChatUserAdd(params)\n\t{\n\t\tif (params.dialogId !== this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst users = Object.values(params.users).map(user => {\n\t\t\treturn {...user, lastActivityDate: new Date()};\n\t\t});\n\t\tthis.store.commit('conference/common', {userCount: params.userCount});\n\t\tthis.store.dispatch('users/set', users);\n\t\tthis.store.dispatch('conference/setUsers', {users: users.map(user => user.id)});\n\t}\n\n\thandleChatUserLeave(params)\n\t{\n\t\tif (params.dialogId !== this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.userId === this.controller.getUserId())\n\t\t{\n\t\t\tthis.application.kickFromCall();\n\t\t}\n\n\t\tthis.store.commit('conference/common', {userCount: params.userCount});\n\t\tthis.store.dispatch('conference/removeUsers', {users: [params.userId]});\n\t}\n\n\thandleCallUserNameUpdate(params)\n\t{\n\t\tconst currentUser = this.store.getters['users/get'](params.userId);\n\t\tif (!currentUser)\n\t\t{\n\t\t\tthis.store.dispatch('users/set', {\n\t\t\t\tid: params.userId,\n\t\t\t\tlastActivityDate: new Date()\n\t\t\t});\n\t\t}\n\t\tthis.store.dispatch('users/update', {\n\t\t\tid: params.userId,\n\t\t\tfields: {name: params.name, lastActivityDate: new Date()}\n\t\t});\n\t}\n\n\thandleVideoconfShareUpdate(params)\n\t{\n\t\tif (params.dialogId === this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tpublic: {\n\t\t\t\t\t\tcode: params.newCode,\n\t\t\t\t\t\tlink:  params.newLink\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.application.changeVideoconfUrl(params.newLink);\n\t\t}\n\t}\n\n\thandleMessageChat(params)\n\t{\n\t\tthis.application.sendNewMessageNotify(params);\n\t}\n\n\thandleChatRename(params)\n\t{\n\t\tif (params.chatId !== this.application.getChatId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('conference/setConferenceTitle', {conferenceTitle: params.name});\n\t}\n\n\thandleConferenceUpdate(params)\n\t{\n\t\tif (params.chatId !== this.application.getChatId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.isBroadcast !== '')\n\t\t{\n\t\t\tthis.store.dispatch('conference/setBroadcastMode', {broadcastMode: params.isBroadcast});\n\t\t}\n\n\t\tif (params.presenters.length > 0)\n\t\t{\n\t\t\tthis.store.dispatch('conference/setPresenters', {presenters: params.presenters, replace: true});\n\t\t}\n\t}\n}\n","import {PullClient} from \"pull.client\";\n\nexport class ImNotificationsPullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.application === 'object' && params.application)\n\t\t{\n\t\t\tthis.application = params.application;\n\t\t}\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store ? params.store : {};\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\thandleNotifyAdd(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30 || params.onlyFlash === true)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst user = this.store.getters['users/get'](params.userId);\n\t\tif (!user)\n\t\t{\n\t\t\tconst users = [];\n\t\t\tusers.push({\n\t\t\t\tid: params.userId,\n\t\t\t\tavatar: params.userAvatar,\n\t\t\t\tcolor: params.userColor,\n\t\t\t\tname: params.userName\n\t\t\t});\n\n\t\t\tthis.store.dispatch('users/set', users);\n\t\t}\n\n\t\tthis.store.dispatch('notifications/add', { data: params });\n\t\tthis.store.dispatch('notifications/setCounter', { unreadTotal: params.counter });\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tmessage: {\n\t\t\t\t\tid: params.id,\n\t\t\t\t\ttext: params.text,\n\t\t\t\t\tdate: params.date\n\t\t\t\t},\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleNotifyConfirm(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('notifications/delete', {\n\t\t\tid: params.id,\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\t\tthis.updateRecentListOnDelete(params.counter);\n\t}\n\n\thandleNotifyRead(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', { ids: [id], action: true });\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\n\t}\n\n\thandleNotifyUnread(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', { ids: [id], action: false });\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleNotifyDelete(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst idsToDelete = Object.keys(params.id).map(id => parseInt(id, 10));\n\n\t\tidsToDelete.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/delete', { id: id });\n\t\t});\n\n\t\tthis.updateRecentListOnDelete(params.counter)\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\t}\n\n\tupdateRecentListOnDelete(counterValue)\n\t{\n\t\tlet message;\n\t\tconst latestNotification = this.getLatest();\n\t\tif (latestNotification !== null)\n\t\t{\n\t\t\tmessage = {\n\t\t\t\tid: latestNotification.id,\n\t\t\t\ttext: latestNotification.text,\n\t\t\t\tdate: latestNotification.date\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst notificationChat = this.store.getters['recent/get']('notify');\n\t\t\tif (notificationChat === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmessage = notificationChat.element.message;\n\t\t\tmessage.text = this.controller.localize['IM_NOTIFICATIONS_DELETED_ITEM_STUB'];\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tmessage: message,\n\t\t\t\tcounter: counterValue\n\t\t\t}\n\t\t});\n\t}\n\n\tgetLatest()\n\t{\n\t\tlet latestNotification = {\n\t\t\tid: 0\n\t\t};\n\n\t\tfor (const notification of this.store.state.notifications.collection)\n\t\t{\n\t\t\tif (notification.id > latestNotification.id)\n\t\t\t{\n\t\t\t\tlatestNotification = notification;\n\t\t\t}\n\t\t}\n\n\t\tif (latestNotification.id === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn latestNotification;\n\t}\n}\n","/**\n * Bitrix Messenger\n * Bundle pull command handlers\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {ImBasePullHandler} from \"./base\";\nimport {ImCallPullHandler} from \"./call\";\nimport {ImNotificationsPullHandler} from \"./notifications\";\n\nexport {\n\tImBasePullHandler,\n\tImCallPullHandler,\n\tImNotificationsPullHandler\n}"],"names":["ImBasePullHandler","params","controller","store","option","handlingDialog","chatId","dialogId","PullClient","SubscriptionType","Server","extra","optionImportant","skip","Logger","info","parseInt","toString","handleMessageAdd","warn","skipExecute","collection","state","messages","message","find","element","templateId","id","push","chat","existingChat","getters","chatToAdd","Object","assign","dispatch","fields","users","VuexBuilderModel","convertToArray","files","application","prepareFilesBeforeSave","forEach","file","length","templateFileId","index","then","EventEmitter","emit","EventType","dialog","scrollToBottom","cancelIfScrollChange","sending","error","senderId","getUserId","isUnreadMessagesLoaded","unread","newMessage","messageId","stopOpponentWriting","userId","dialogues","counter","restClient","callMethod","dialog_id","result","count","lastMessageId","command","execMessageUpdateOrDelete","text","textOriginal","blink","action","LIKE","ownerId","managerList","list","userCounter","userCount","startOpponentWriting","readId","lastId","handleReadMessage","execReadMessageOpponent","userName","date","execUnreadMessageOpponent","fileParams","existingMuteList","muteList","newMuteList","currentUser","common","mute","filter","invited","user","ImCallPullHandler","values","map","lastActivityDate","Date","commit","kickFromCall","name","code","newCode","link","newLink","changeVideoconfUrl","sendNewMessageNotify","getChatId","conferenceTitle","isBroadcast","broadcastMode","presenters","replace","ImNotificationsPullHandler","server_time_ago","onlyFlash","avatar","userAvatar","color","userColor","data","unreadTotal","updateRecentListOnDelete","ids","idsToDelete","keys","counterValue","latestNotification","getLatest","notificationChat","localize","notifications","notification"],"mappings":"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"}