{"version":3,"file":"registry.bundle.js","sources":["../src/base.answer.js","../src/im.rest.handler.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Base Rest Answer Handler\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nclass BaseRestAnswerHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\t}\n\n\texecute(command, result, extra = {})\n\t{\n\t\tcommand = 'handle'+command.split('.').map(element => {\n\t\t\treturn element.charAt(0).toUpperCase() + element.slice(1);\n\t\t}).join('');\n\n\t\tif (result.error())\n\t\t{\n\t\t\tif (typeof this[command+'Error'] === 'function')\n\t\t\t{\n\t\t\t\treturn this[command+'Error'](result.error(), extra);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (typeof this[command+'Success'] === 'function')\n\t\t\t{\n\t\t\t\treturn this[command+'Success'](result.data(), extra);\n\t\t\t}\n\t\t}\n\n\t\treturn typeof this[command] === 'function'? this[command](result, extra): null;\n\t}\n}\n\nexport {BaseRestAnswerHandler};","/**\n * Bitrix Messenger\n * Im rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestAnswerHandler} from \"./base.answer\";\n\nclass ImRestAnswerHandler extends BaseRestAnswerHandler\n{\n\thandleImChatGetSuccess(data)\n\t{\n\t\tthis.store.dispatch('dialogues/set', data);\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tthis.store.dispatch('messages/setBefore', data.messages);\n\t\tthis.store.dispatch('users/set', data.users);\n\t\tthis.store.dispatch('files/setBefore', this.controller.prepareFilesBeforeSave(data.files));\n\t}\n\n\thandleImDialogMessagesUnreadSuccess(data)\n\t{\n\t\tthis.store.dispatch('messages/set', data.messages);\n\t\tthis.store.dispatch('users/set', data.users);\n\t\tthis.store.dispatch('files/set', this.controller.prepareFilesBeforeSave(data.files));\n\t}\n\n\thandleImDiskFolderGetSuccess(data)\n\t{\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tdiskFolderId: data.ID,\n\t\t}});\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tif (typeof messageId === \"number\")\n\t\t{\n\t\t\tthis.store.dispatch('messages/update', {\n\t\t\t\tid:  message.id,\n\t\t\t\tchatId: this.controller.getChatId(),\n\t\t\t\tfields: {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tsending: false,\n\t\t\t\t\terror: false,\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.store.dispatch('messages/actionFinish', {\n\t\t\t\tid: messageId,\n\t\t\t\tchatId: this.controller.getChatId()\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.store.dispatch('messages/actionError', {\n\t\t\t\tid: message.id,\n\t\t\t\tchatId: this.controller.getChatId()\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.store.dispatch('messages/actionError', {\n\t\t\tid: message.id,\n\t\t\tchatId: this.controller.getChatId()\n\t\t});\n\t}\n}\n\nexport {ImRestAnswerHandler};","/**\n * Bitrix Messenger\n * Bundle rest answer handlers\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestAnswerHandler} from \"./base.answer\";\nimport {ImRestAnswerHandler} from \"./im.rest.handler.js\";\n\nexport {\n\tImRestAnswerHandler,\n\tBaseRestAnswerHandler\n}"],"names":["BaseRestAnswerHandler","params","controller","store","command","result","extra","split","map","element","charAt","toUpperCase","slice","join","error","data","ImRestAnswerHandler","dispatch","messages","users","prepareFilesBeforeSave","files","commit","dialog","diskFolderId","ID","messageId","message","id","chatId","getChatId","fields","sending"],"mappings":"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"}