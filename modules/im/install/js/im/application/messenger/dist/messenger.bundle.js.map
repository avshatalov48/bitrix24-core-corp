{"version":3,"file":"messenger.bundle.js","sources":["../src/view.js","../src/controller.js"],"sourcesContent":["/**\n * Bitrix Im\n * Application Messenger view\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Logger} from \"im.lib.logger\";\nimport {Utils} from \"im.lib.utils\";\nimport \"im.component.recent\";\nimport \"im.component.dialog\";\nimport \"im.component.textarea\";\nimport \"pull.component.status\";\nimport \"./view.css\";\n\nimport {DeviceType, EventType} from 'im.const';\nimport {\n\tDialogCore, DialogReadMessages, DialogQuoteMessage, DialogClickOnCommand, DialogClickOnMention, DialogClickOnUserName,\n\tDialogClickOnMessageMenu, DialogClickOnMessageRetry, DialogClickOnUploadCancel, DialogClickOnReadList,\n\tDialogSetMessageReaction, DialogOpenMessageReactionList, DialogClickOnKeyboardButton, DialogClickOnChatTeaser,\n\tDialogClickOnDialog, TextareaCore, TextareaUploadFile\n} from 'im.mixin';\nimport { EventEmitter } from \"main.core.events\";\nimport {Loc} from \"main.core\";\n\nBitrixVue.component('bx-im-application-messenger',\n{\n\tprops:\n\t{\n\t\tuserId: { default: 0 },\n\t\tinitialDialogId: { default: '0' }\n\t},\n\n\tmixins: [\n\t\tDialogCore, DialogReadMessages, DialogQuoteMessage, DialogClickOnCommand, DialogClickOnMention, DialogClickOnUserName,\n\t\tDialogClickOnMessageMenu, DialogClickOnMessageRetry, DialogClickOnUploadCancel, DialogClickOnReadList,\n\t\tDialogSetMessageReaction, DialogOpenMessageReactionList, DialogClickOnKeyboardButton, DialogClickOnChatTeaser,\n\t\tDialogClickOnDialog, TextareaCore, TextareaUploadFile\n\t],\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tnotify: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 120,\n\t\t\ttextareaMinimumHeight: 120,\n\t\t\ttextareaMaximumHeight: Utils.device.isMobile()? 200: 400,\n\t\t}\n\t},\n\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe('openMessenger', this.onOpenMessenger);\n\t},\n\n\tbeforeDestroy()\n\t{\n\t\tEventEmitter.unsubscribe('openMessenger', this.onOpenMessenger);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\n\tcomputed:\n\t{\n\t\tDeviceType: () => DeviceType,\n\n\t\ttextareaHeightStyle(state)\n\t\t{\n\t\t\treturn {flex: '0 0 '+this.textareaHeight+'px'};\n\t\t},\n\n\t\tisDialog()\n\t\t{\n\t\t\treturn Utils.dialog.isChatId(this.dialogId);\n\t\t},\n\n\t\tisEnableGesture()\n\t\t{\n\t\t\treturn false;\n\t\t},\n\n\t\tisEnableGestureQuoteFromRight()\n\t\t{\n\t\t\treturn this.isEnableGesture && true;\n\t\t},\n\n\t\tlocalizeEmptyChat()\n\t\t{\n\t\t\treturn Loc.getMessage('IM_M_EMPTY');\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonOpenMessenger({data: event})\n\t\t{\n\t\t\tif (event.id === 'notify')\n\t\t\t{\n\t\t\t\tthis.dialogId = 0;\n\t\t\t\tthis.notify = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.notify = false;\n\t\t\t\tthis.dialogId = event.id;\n\t\t\t}\n\t\t},\n\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tLogger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight !== textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t  \t<div class=\"bx-im-next-layout\">\n\t\t\t<div class=\"bx-im-next-layout-recent\">\n\t\t\t\t<bx-im-component-recent/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-next-layout-dialog\" v-if=\"dialogId\">\n\t\t\t\t<div class=\"bx-im-next-layout-dialog-header\">\n\t\t\t\t\t<div class=\"bx-im-header-title\">Dialog: {{dialogId}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-next-layout-dialog-messages\">\n\t\t\t\t  \t<bx-pull-component-status/>\n\t\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t\t:userId=\"userId\" \n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:enableGestureMenu=\"isEnableGesture\"\n\t\t\t\t\t\t:enableGestureQuote=\"isEnableGesture\"\n\t\t\t\t\t\t:enableGestureQuoteFromRight=\"isEnableGestureQuoteFromRight\"\n\t\t\t\t\t\t:showMessageUserName=\"isDialog\"\n\t\t\t\t\t\t:showMessageAvatar=\"isDialog\"\n\t\t\t\t\t />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-next-layout-dialog-textarea\" :style=\"textareaHeightStyle\" ref=\"textarea\">\n\t\t\t\t  \t<div class=\"bx-im-next-layout-dialog-textarea-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t:userId=\"userId\"\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t:enableFile=\"true\"\n\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-next-layout-notify\" v-else-if=\"notify\">\n\t\t\t\t<bx-im-component-notifications :darkTheme=\"false\"/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-next-layout-notify\" v-else>\n\t\t\t\t<div class=\"bx-messenger-box-hello-wrap\">\n\t\t\t\t  <div class=\"bx-messenger-box-hello\">{{localizeEmptyChat}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\n\t\t</div>\n\t`\n});","/**\n * Bitrix Im\n * Messenger application\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\n// vue\nimport {VueVendorV2} from \"ui.vue\";\n\n// im\nimport {Core} from \"im.application.core\";\nimport {DialogRestHandler} from \"im.provider.rest\";\n\n// core\nimport \"promise\";\n\n// component\nimport \"./view\";\n\nexport class MessengerApplication\n{\n\t/* region 01. Initialize */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.inited = false;\n\t\tthis.initPromise = new BX.Promise;\n\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.event = new VueVendorV2;\n\n\t\tthis.initCore()\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitCore()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tCore.ready().then(controller => {\n\t\t\t\tthis.controller = controller;\n\t\t\t\tresolve();\n\t\t\t})\n\t\t});\n\t}\n\n\tinitComponent()\n\t{\n\t\tconsole.log('2. initComponent');\n\n\t\tthis.controller.getStore().commit('application/set', {\n\t\t\tdialog: {\n\t\t\t\tdialogId: this.getDialogId()\n\t\t\t},\n\t\t\toptions: {\n\t\t\t\tquoteEnable: true,\n\t\t\t\tautoplayVideo: true,\n\t\t\t\tdarkBackground: false\n\t\t\t}\n\t\t});\n\n\t\tthis.controller.addRestAnswerHandler(\n\t\t\tDialogRestHandler.create({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\tcontext: this,\n\t\t\t})\n\t\t);\n\n\t\tlet dialog = this.controller.getStore().getters['dialogues/get'](this.controller.application.getDialogId());\n\t\tif (dialog)\n\t\t{\n\t\t\tthis.controller.getStore().commit('application/set', {dialog: {\n\t\t\t\tchatId: dialog.chatId,\n\t\t\t\tdiskFolderId: dialog.diskFolderId || 0\n\t\t\t}});\n\t\t}\n\n\t\treturn this.controller.createVue(this, {\n\t\t\tel: this.rootNode,\n\t\t\tdata: () =>\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tuserId: this.getUserId(),\n\t\t\t\t\tdialogId: this.getDialogId()\n\t\t\t\t};\n\t\t\t},\n\t\t\t// language=Vue\n\t\t\ttemplate: `<bx-im-application-messenger :userId=\"userId\" :initialDialogId=\"dialogId\"/>`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.template = vue;\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.inited = true;\n\t\tthis.initPromise.resolve(this);\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\tlet promise = new BX.Promise;\n\t\t\tpromise.resolve(this);\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n\n/* endregion 01. Initialize */\n\n/* region 02. Methods */\n\n\tgetUserId()\n\t{\n\t\tlet userId = this.params.userId || this.getLocalize('USER_ID');\n\t\treturn userId? parseInt(userId): 0;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.params.dialogId? this.params.dialogId.toString(): \"0\";\n\t}\n\n\tgetHost()\n\t{\n\t\treturn location.origin || '';\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn 's1';\n\t}\n\n/* endregion 02. Methods */\n\n/* region 03. Utils */\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.controller.addLocalize(phrases);\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\treturn this.controller.getLocalize(name);\n\t}\n\n/* endregion 03. Utils */\n}"],"names":["BitrixVue","component","props","userId","default","initialDialogId","mixins","DialogCore","DialogReadMessages","DialogQuoteMessage","DialogClickOnCommand","DialogClickOnMention","DialogClickOnUserName","DialogClickOnMessageMenu","DialogClickOnMessageRetry","DialogClickOnUploadCancel","DialogClickOnReadList","DialogSetMessageReaction","DialogOpenMessageReactionList","DialogClickOnKeyboardButton","DialogClickOnChatTeaser","DialogClickOnDialog","TextareaCore","TextareaUploadFile","data","dialogId","notify","textareaDrag","textareaHeight","textareaMinimumHeight","textareaMaximumHeight","Utils","device","isMobile","created","EventEmitter","subscribe","onOpenMessenger","beforeDestroy","unsubscribe","onTextareaDragEventRemove","computed","DeviceType","textareaHeightStyle","state","flex","isDialog","dialog","isChatId","isEnableGesture","isEnableGestureQuoteFromRight","localizeEmptyChat","Loc","getMessage","methods","event","id","onTextareaStartDrag","Logger","log","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","emit","EventType","textarea","setBlur","onTextareaContinueDrag","textareaDragCursorControlPoint","Math","max","min","onTextareaStopDrag","$store","commit","scrollToBottom","chatId","force","document","addEventListener","removeEventListener","logEvent","name","params","info","template","MessengerApplication","inited","initPromise","BX","Promise","rootNode","node","createElement","VueVendorV2","initCore","then","initComponent","initComplete","resolve","reject","Core","ready","controller","console","getStore","getDialogId","options","quoteEnable","autoplayVideo","darkBackground","addRestAnswerHandler","DialogRestHandler","create","store","context","getters","application","diskFolderId","createVue","el","getUserId","vue","promise","getLocalize","parseInt","toString","location","origin","phrases","addLocalize"],"mappings":"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"}