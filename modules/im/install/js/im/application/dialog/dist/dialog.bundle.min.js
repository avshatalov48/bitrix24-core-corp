this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(t,e,i,n,o,a,s,r,l,d,u,g,c,h,p){"use strict";a.BitrixVue.component("bx-im-application-dialog",{props:{userId:{default:0},initialDialogId:{default:"0"}},mixins:[h.DialogCore,h.DialogReadMessages,h.DialogQuoteMessage,h.DialogClickOnCommand,h.DialogClickOnMention,h.DialogClickOnUserName,h.DialogClickOnMessageMenu,h.DialogClickOnMessageRetry,h.DialogClickOnUploadCancel,h.DialogClickOnReadList,h.DialogSetMessageReaction,h.DialogOpenMessageReactionList,h.DialogClickOnKeyboardButton,h.DialogClickOnChatTeaser,h.DialogClickOnDialog,h.TextareaCore,h.TextareaUploadFile],data:function t(){return{dialogId:0}},created:function t(){this.dialogId=this.initialDialogId;p.EventEmitter.subscribe("openMessenger",this.onOpenMessenger)},beforeDestroy:function t(){p.EventEmitter.unsubscribe("openMessenger",this.onOpenMessenger)},computed:{DeviceType:function t(){return c.DeviceType},isDialog:function t(){return r.Utils.dialog.isChatId(this.dialogId)},isEnableGesture:function t(){return false},isEnableGestureQuoteFromRight:function t(){return this.isEnableGesture&&true}},methods:{onOpenMessenger:function t(e){var i=e.data;this.dialogId=i.id},logEvent:function t(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++){n[o-1]=arguments[o]}s.Logger.info.apply(s.Logger,[e].concat(n))}},template:'\n\t  \t<div style="display: flex;">\n\t\t\t<div class="bx-mobilechat">\n\t\t\t\t<div class="bx-mobilechat-dialog-title">Dialog: {{dialogId}}</div>\n\t\t\t\t<bx-pull-component-status/>\n\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t:userId="userId" \n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t:enableGestureMenu="isEnableGesture"\n\t\t\t\t\t:enableGestureQuote="isEnableGesture"\n\t\t\t\t\t:enableGestureQuoteFromRight="isEnableGestureQuoteFromRight"\n\t\t\t\t\t:showMessageUserName="isDialog"\n\t\t\t\t\t:showMessageAvatar="isDialog"\n\t\t\t\t />\n\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t:siteId="application.common.siteId"\n\t\t\t\t\t:userId="userId"\n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t:writesEventLetter="3"\n\t\t\t\t\t:enableEdit="true"\n\t\t\t\t\t:enableCommand="false"\n\t\t\t\t\t:enableMention="false"\n\t\t\t\t\t:enableFile="true"\n\t\t\t\t\t:autoFocus="application.device.type !== DeviceType.mobile"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t'});var m=function(){function t(){var e=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);this.inited=false;this.initPromise=new BX.Promise;this.params=i;this.template=null;this.rootNode=this.params.node||document.createElement("div");this.event=new a.VueVendorV2;this.initCore().then((function(){return e.initComponent()})).then((function(){return e.initComplete()}))}babelHelpers.createClass(t,[{key:"initCore",value:function t(){var i=this;return new Promise((function(t,n){e.Core.ready().then((function(e){i.controller=e;t()}))}))}},{key:"initComponent",value:function t(){var e=this;console.log("2. initComponent");this.controller.getStore().commit("application/set",{dialog:{dialogId:this.getDialogId()},options:{quoteEnable:true,autoplayVideo:true,darkBackground:false}});this.controller.addRestAnswerHandler(i.DialogRestHandler.create({store:this.controller.getStore(),controller:this.controller,context:this}));var n=this.controller.getStore().getters["dialogues/get"](this.controller.application.getDialogId());if(n){this.controller.getStore().commit("application/set",{dialog:{chatId:n.chatId,diskFolderId:n.diskFolderId||0}})}return this.controller.createVue(this,{el:this.rootNode,data:function t(){return{userId:e.getUserId(),dialogId:e.getDialogId()}},template:'<bx-im-application-dialog :userId="userId" :initialDialogId="dialogId"/>'}).then((function(t){e.template=t;return new Promise((function(t,e){return t()}))}))}},{key:"initComplete",value:function t(){this.inited=true;this.initPromise.resolve(this)}},{key:"ready",value:function t(){if(this.inited){var e=new BX.Promise;e.resolve(this);return e}return this.initPromise}},{key:"getUserId",value:function t(){var e=this.params.userId||this.getLocalize("USER_ID");return e?parseInt(e):0}},{key:"getDialogId",value:function t(){return this.params.dialogId?this.params.dialogId.toString():"0"}},{key:"getHost",value:function t(){return location.origin||""}},{key:"getSiteId",value:function t(){return"s1"}},{key:"addLocalize",value:function t(e){return this.controller.addLocalize(e)}},{key:"getLocalize",value:function t(e){return this.controller.getLocalize(e)}}]);return t}();t.DialogApplication=m})(this.BX.Messenger.Application=this.BX.Messenger.Application||{},BX.Messenger.Application,BX.Messenger.Provider.Rest,BX,BX,BX,BX.Messenger.Lib,BX.Messenger.Lib,BX.Messenger,BX.Messenger,window,window,BX.Messenger.Const,BX.Messenger.Mixin,BX.Event);
//# sourceMappingURL=dialog.bundle.map.js