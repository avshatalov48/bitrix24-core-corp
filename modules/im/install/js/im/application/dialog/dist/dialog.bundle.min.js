this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(t,e,n,i,o,a,l,r){"use strict";a.Vue.component("bx-im-application-dialog",{props:{userId:{default:0},dialogId:{default:"0"}},data:function t(){return{realDialogId:0}},created:function t(){var e=this;this.realDialogId=this.dialogId;a.Vue.event.$on("openMessenger",function(t){var n=t.$event.ctrlKey||t.$event.metaKey;if(e.$root.$bitrixApplication.params.place===2){if(n){e.realDialogId=t.id}}else{if(!n){e.realDialogId=t.id}}})},computed:{isDialog:function t(){return r.Utils.dialog.isChatId(this.realDialogId)},isEnableGesture:function t(){return false},isEnableGestureQuoteFromRight:function t(){return this.isEnableGesture&&true}},methods:{logEvent:function t(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++){i[o-1]=arguments[o]}l.Logger.info.apply(l.Logger,[e].concat(i))}},template:'\n\t\t<div class="bx-mobilechat">\n\t\t\t<div class="bx-mobilechat-dialog-title">Dialog: {{realDialogId}}</div>\n\t\t\t<bx-pull-component-status/>\n\t\t\t<bx-im-component-dialog\n\t\t\t\t:userId="userId" \n\t\t\t\t:dialogId="realDialogId"\n\t\t\t\t:enableGestureMenu="isEnableGesture"\n\t\t\t\t:enableGestureQuote="isEnableGesture"\n\t\t\t\t:enableGestureQuoteFromRight="isEnableGestureQuoteFromRight"\n\t\t\t\t:showMessageUserName="isDialog"\n\t\t\t\t:showMessageAvatar="isDialog"\n\t\t\t\t@clickByCommand="logEvent(\'clickByCommand\', $event)"\n\t\t\t\t@clickByMention="logEvent(\'clickByMention\', $event)"\n\t\t\t\t@clickByUserName="logEvent(\'clickByUserName\', $event)"\n\t\t\t\t@clickByMessageMenu="logEvent(\'clickByMessageMenu\', $event)"\n\t\t\t\t@clickByMessageRetry="logEvent(\'clickByMessageRetry\', $event)"\n\t\t\t\t@clickByUploadCancel="logEvent(\'clickByUploadCancel\', $event)"\n\t\t\t\t@clickByReadedList="logEvent(\'clickByReadedList\', $event)"\n\t\t\t\t@setMessageReaction="logEvent(\'setMessageReaction\', $event)"\n\t\t\t\t@openMessageReactionList="logEvent(\'openMessageReactionList\', $event)"\n\t\t\t\t@clickByKeyboardButton="logEvent(\'clickByKeyboardButton\', $event)"\n\t\t\t\t@clickByChatTeaser="logEvent(\'clickByChatTeaser\', $event)"\n\t\t\t\t@click="logEvent(\'click\', $event)"\n\t\t\t />\n\t\t</div>\n\t'});var s=function(){function t(){var e=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);this.inited=false;this.initPromise=new BX.Promise;this.params=n;this.template=null;this.rootNode=this.params.node||document.createElement("div");this.event=new a.VueVendorV2;this.initCore().then(function(){return e.initComponent()}).then(function(){return e.initComplete()})}babelHelpers.createClass(t,[{key:"initCore",value:function t(){var n=this;return new Promise(function(t,i){e.Core.ready().then(function(e){n.controller=e;t()})})}},{key:"initComponent",value:function t(){var e=this;console.log("2. initComponent");this.controller.getStore().commit("application/set",{dialog:{dialogId:this.getDialogId()},options:{quoteEnable:true,autoplayVideo:true,darkBackground:false}});this.controller.addRestAnswerHandler(n.DialogRestHandler.create({store:this.controller.getStore(),controller:this.controller,context:this}));var i=this.controller.getStore().getters["dialogues/get"](this.controller.application.getDialogId());if(i){this.controller.getStore().commit("application/set",{dialog:{chatId:i.chatId,diskFolderId:i.diskFolderId||0}})}return this.controller.createVue(this,{el:this.rootNode,data:function t(){return{userId:e.getUserId(),dialogId:e.getDialogId()}},template:'<bx-im-application-dialog :userId="userId" :dialogId="dialogId"/>'}).then(function(t){e.template=t;return new Promise(function(t,e){return t()})})}},{key:"initComplete",value:function t(){this.inited=true;this.initPromise.resolve(this)}},{key:"ready",value:function t(){if(this.inited){var e=new BX.Promise;e.resolve(this);return e}return this.initPromise}},{key:"getUserId",value:function t(){var e=this.params.userId||this.getLocalize("USER_ID");return e?parseInt(e):0}},{key:"getDialogId",value:function t(){return this.params.dialogId?this.params.dialogId.toString():"0"}},{key:"getHost",value:function t(){return location.origin||""}},{key:"getSiteId",value:function t(){return"s1"}},{key:"addLocalize",value:function t(e){return this.controller.addLocalize(e)}},{key:"getLocalize",value:function t(e){return this.controller.getLocalize(e)}}]);return t}();t.DialogApplication=s})(this.BX.Messenger.Application=this.BX.Messenger.Application||{},BX.Messenger.Application,BX.Messenger.Provider.Rest,BX,BX,BX,BX.Messenger.Lib,BX.Messenger.Lib);
//# sourceMappingURL=dialog.bundle.map.js