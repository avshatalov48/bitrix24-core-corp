{"version":3,"file":"call.bundle.js","sources":["../src/utils/restclient.js","../src/view.js","../src/controller.js"],"sourcesContent":["import { RestClient } from \"rest.client\";\nimport { Utils } from \"im.lib.utils\";\n\nconst RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport class CallRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.call_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%CallRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.call_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetChatId(chatId)\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tthis.queryParams.call_chat_id = chatId;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) => {\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix Im\n * Application External Call\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nimport \"im.component.dialog\";\nimport \"im.component.call\";\nimport \"pull.component.status\";\nimport \"./view.css\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {CallApplicationErrorCode} from \"im.const\";\nimport {Cookie} from 'im.lib.cookie';\n\nVue.component('bx-im-application-call',\n{\n\tdata(){\n\t\treturn {\n\t\t\tdownloadAppArticleCode: 11387752\n\t\t}\n\t},\n\tprops:\n\t{\n\t\tchatId: { default: 0 },\n\t\tdialogId: { default: '0' },\n\t\tstartupErrorCode: { default: '' }\n\t},\n\tmethods:\n\t{\n\t\tredirectToAuthorize()\n\t\t{\n\t\t\tlocation.href = location.origin + '/auth/?backurl=' + location.pathname;\n\t\t},\n\t\tcontinueAsGuest()\n\t\t{\n\t\t\tCookie.set(null, 'VIDEOCONF_GUEST', '', {path: '/'});\n\t\t\tlocation.reload(true);\n\t\t},\n\t\tgetBxLink()\n\t\t{\n\t\t\treturn `bx://videoconf/code/${this.$root.$bitrixApplication.getAlias()}`;\n\t\t},\n\t\tgetErrorFromCode()\n\t\t{\n\t\t\tif (this.startupErrorCode)\n\t\t\t{\n\t\t\t\tif (this.startupErrorCode === CallApplicationErrorCode.bitrix24only)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_B24_ONLY'];\n\t\t\t\t}\n\t\t\t\telse if (this.startupErrorCode === CallApplicationErrorCode.detectIntranetUser)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_PLEASE_LOG_IN'];\n\t\t\t\t}\n\t\t\t\telse if (this.startupErrorCode === CallApplicationErrorCode.userLimitReached)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_USER_LIMIT'];\n\t\t\t\t}\n\t\t\t\telse if (this.startupErrorCode === CallApplicationErrorCode.kickedFromCall)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_KICKED'];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.callApplication.common.componentError)\n\t\t\t{\n\t\t\t\tif (this.callApplication.common.componentError === CallApplicationErrorCode.kickedFromCall)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_KICKED'];\n\t\t\t\t}\n\t\t\t\telse if (this.callApplication.common.componentError === CallApplicationErrorCode.unsupportedBrowser)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_UNSUPPORTED_BROWSER'];\n\t\t\t\t}\n\t\t\t\telse if (this.callApplication.common.componentError === CallApplicationErrorCode.missingMicrophone)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_NO_MIC'];\n\t\t\t\t}\n\t\t\t\telse if (this.callApplication.common.componentError === CallApplicationErrorCode.unsafeConnection)\n\t\t\t\t{\n\t\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_ERROR_NO_HTTPS'];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\topenHelpArticle()\n\t\t{\n\t\t\tif (BX.Helper)\n\t\t\t{\n\t\t\t\tBX.Helper.show(\"redirect=detail&code=\" + this.downloadAppArticleCode);\n\t\t\t}\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tauthorizeButtonClasses()\n\t\t{\n\t\t\treturn ['ui-btn', 'ui-btn-sm', 'ui-btn-success-dark', 'ui-btn-no-caps', 'bx-im-application-call-button-authorize'];\n\t\t},\n\t\tcontinueAsGuestButtonClasses()\n\t\t{\n\t\t\treturn ['ui-btn', 'ui-btn-sm', 'ui-btn-no-caps', 'bx-im-application-call-button-as-guest'];\n\t\t},\n\t\tisIntranetUserError()\n\t\t{\n\t\t\treturn this.startupErrorCode === CallApplicationErrorCode.detectIntranetUser;\n\t\t},\n\t\tisUnsupportedBrowserError()\n\t\t{\n\t\t\treturn this.callApplication.common.componentError === CallApplicationErrorCode.unsupportedBrowser;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_IM_COMPONENT_CALL_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tcallApplication: state => state.callApplication,\n\t\t\tapplication: state => state.application\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-application-call\">\n\t\t\t<template v-if=\"startupErrorCode || callApplication.common.componentError\">\n\t\t\t\t<template v-if=\"isIntranetUserError\">\n\t\t\t\t\t<div class=\"bx-im-application-call-error-message\">\n\t\t\t\t\t\t<div>{{ getErrorFromCode() }}</div>\n\t\t\t\t\t\t<div class=\"bx-im-application-call-error-message-buttons\">\n\t\t\t\t\t\t\t<button @click=\"redirectToAuthorize\" :class=\"authorizeButtonClasses\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_AUTHORIZE'] }}</button>\n\t\t\t\t\t\t\t<button @click=\"continueAsGuest\" :class=\"continueAsGuestButtonClasses\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_AS_GUEST'] }}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if=\"isUnsupportedBrowserError\">\n\t\t\t\t\t<div class=\"bx-im-application-call-error-message\">\n\t\t\t\t\t\t<div>{{ getErrorFromCode() }}</div>\n\t\t\t\t\t\t<div class=\"bx-im-application-call-error-message-links\">\n\t\t\t\t\t\t\t<div class=\"bx-im-application-call-error-message-links-link\">\n\t\t\t\t\t\t\t\t{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_OPEN_APP'] }} \n\t\t\t\t\t\t\t\t<a :href=\"getBxLink()\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_OPEN_APP_LINK'] }}</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"bx-im-application-call-error-message-links-link\">\n\t\t\t\t\t\t\t\t{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_DOWNLOAD_APP'] }} -\n\t\t\t\t\t\t\t\t<a href=\"\" @click.prevent=\"openHelpArticle\" target=\"_blank\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_DOWNLOAD_APP_LINK'] }}</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-im-application-call-error-message\">{{ getErrorFromCode() }}</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<bx-pull-component-status/>\n\t\t\t\t<bx-im-component-call :chatId=\"chatId\" dialogId=\"dialogId\" />\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Im mobile\n * Dialog application\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2020 Bitrix\n */\n\n// vue\nimport {VueVendorV2} from \"ui.vue\";\n\n// im\nimport { Utils } from \"im.lib.utils\";\nimport { Cookie } from \"im.lib.cookie\";\nimport { LocalStorage } from \"im.lib.localstorage\";\nimport 'im_call';\nimport 'im.debug';\nimport {Clipboard} from 'im.lib.clipboard';\nimport 'ui.notification';\nimport 'ui.buttons';\nimport {ImCallPullHandler} from \"im.provider.pull\";\nimport {CallApplicationErrorCode, CallErrorCode, EventType} from \"im.const\";\n\n// core\nimport {Loc} from \"main.core\";\nimport \"promise\";\n\n// pull and rest\nimport { PullClient } from \"pull.client\";\nimport { CallRestClient } from \"./utils/restclient\"\n\n// component\nimport \"./view\";\nimport { CallApplicationModel } from \"im.model\";\nimport { VuexBuilder } from \"ui.vue.vuex\";\nimport { Controller } from 'im.controller';\nimport 'im.application.launch';\nimport {\n\tCallLimit,\n\tFileStatus,\n\tRestMethod as ImRestMethod,\n\tRestMethodHandler as ImRestMethodHandler\n} from \"im.const\";\n\nexport class CallApplication\n{\n\t/* region 01. Initialize */\n\tconstructor(params = {})\n\t{\n\t\tthis.inited = false;\n\t\tthis.dialogInited = false;\n\t\tthis.initPromise = new BX.Promise;\n\n\t\tthis.params = params;\n\t\tthis.params.userId = this.params.userId? parseInt(this.params.userId): 0;\n\t\tthis.params.siteId = this.params.siteId || '';\n\t\tthis.params.chatId = this.params.chatId? parseInt(this.params.chatId): 0;\n\t\tthis.params.dialogId = this.params.chatId? 'chat'+this.params.chatId.toString(): '0';\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.event = new VueVendorV2;\n\n\t\tthis.callContainer = null;\n\t\tthis.callView = null;\n\t\tthis.preCall = null;\n\t\tthis.currentCall = null;\n\n\t\tthis.useVideo = true;\n\t\tthis.localVideoStream = null;\n\t\tthis.selectedCameraId = \"\";\n\t\tthis.selectedMicrophoneId = \"\";\n\n\t\tthis.localVideoTimeout = null;\n\n\t\tthis.conferencePageTagInterval = null;\n\n\t\tthis.onCallUserInvitedHandler = this.onCallUserInvited.bind(this);\n\t\tthis.onCallUserStateChangedHandler = this.onCallUserStateChanged.bind(this);\n\t\tthis.onCallUserMicrophoneStateHandler = this.onCallUserMicrophoneState.bind(this);\n\t\tthis.onCallLocalMediaReceivedHandler = this.onCallLocalMediaReceived.bind(this);\n\t\tthis.onCallUserStreamReceivedHandler = this.onCallUserStreamReceived.bind(this);\n\t\tthis.onCallUserVoiceStartedHandler = this.onCallUserVoiceStarted.bind(this);\n\t\tthis.onCallUserVoiceStoppedHandler = this.onCallUserVoiceStopped.bind(this);\n\t\tthis.onCallLeaveHandler = this.onCallLeave.bind(this);\n\t\tthis.onCallDestroyHandler = this.onCallDestroy.bind(this);\n\n\t\tthis.onPreCallDestroyHandler = this.onPreCallDestroy.bind(this);\n\t\tthis.onPreCallUserStateChangedHandler = this.onPreCallUserStateChanged.bind(this);\n\n\t\tthis.initRestClient()\n\t\t\t.then(() => this.subscribePreCallChanges())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initCore())\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initUser())\n\t\t\t.then(() => this.startPageTagInterval())\n\t\t\t.then(() => this.tryJoinExistingCall())\n\t\t\t.then(() => this.initCall())\n\t\t\t.then(() => this.initPullHandlers())\n\t\t\t.then(() => this.subscribeToStoreChanges())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitRestClient()\n\t{\n\t\tconsole.log('1. initRestClient');\n\t\tthis.restClient = new CallRestClient({endpoint: this.getHost()+'/rest'});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitPullClient()\n\t{\n\t\tconsole.log('2. initPullClient');\n\t\tif (!this.params.isIntranetOrExtranet)\n\t\t{\n\t\t\tthis.pullClient = new PullClient({\n\t\t\t\tserverEnabled: true,\n\t\t\t\tuserId: this.params.userId,\n\t\t\t\tsiteId: this.params.siteId,\n\t\t\t\trestClient: this.restClient,\n\t\t\t\tskipStorageInit: true,\n\t\t\t\tconfigTimestamp: 0,\n\t\t\t\tskipCheckRevision: true,\n\t\t\t\tgetPublicListMethod: 'im.call.channel.public.list'\n\t\t\t});\n\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pullClient = BX.PULL;\n\n\t\t\treturn this.pullClient.start().then(() => {\n\t\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t\t});\n\t\t}\n\t}\n\n\tinitPullHandlers()\n\t{\n\t\tthis.pullClient.subscribe(\n\t\t\tnew ImCallPullHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tapplication: this,\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitCore()\n\t{\n\t\tconsole.log('3. initCore');\n\n\t\tthis.controller = new Controller({\n\t\t\thost: this.getHost(),\n\t\t\tsiteId: this.params.siteId,\n\t\t\tuserId: this.params.userId,\n\t\t\tlanguageId: this.params.language,\n\t\t\tpull: {client: this.pullClient},\n\t\t\trest: {client: this.restClient},\n\t\t\t//localize: this.localize,\n\t\t\tvuexBuilder: {\n\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\tdatabaseName: 'imol/call',\n\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tmodels: [\n\t\t\t\t\tCallApplicationModel.create()\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.controller.ready().then(() => resolve());\n\t\t});\n\t}\n\n\tinitComponent()\n\t{\n\t\tconsole.log('4. initComponent');\n\n\t\tthis.controller.getStore().commit('application/set', {\n\t\t\tdialog: {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tdialogId: this.getDialogId()\n\t\t\t},\n\t\t});\n\n\t\treturn this.controller.createVue(this, {\n\t\t\tel: this.rootNode,\n\t\t\tdata: () =>\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tdialogId: this.getDialogId(),\n\t\t\t\t\tstartupErrorCode: this.getStartupErrorCode()\n\t\t\t\t};\n\t\t\t},\n\t\t\ttemplate: `<bx-im-application-call :chatId=\"chatId\" :dialogId=\"dialogId\" :startupErrorCode=\"startupErrorCode\"/>`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.template = vue;\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tinitUser()\n\t{\n\t\tconst userWasKicked = LocalStorage.get(this.controller.getSiteId(), 0, `conf${this.params.alias}`);\n\n\t\tif (userWasKicked)\n\t\t{\n\t\t\tthis.params.startupErrorCode = CallApplicationErrorCode.kickedFromCall;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (this.getStartupErrorCode())\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconsole.log('5. initUser');\n\t\t\tif (this.params.userId > 0)\n\t\t\t{\n\t\t\t\tthis.controller.setUserId(this.params.userId);\n\n\t\t\t\tif (this.params.isIntranetOrExtranet)\n\t\t\t\t{\n\t\t\t\t\tthis.switchToSessAuth();\n\n\t\t\t\t\tthis.controller.getStore().commit('callApplication/user', {\n\t\t\t\t\t\tid: this.params.userId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet hashFromCookie = this.getUserHashCookie();\n\t\t\t\t\tif (hashFromCookie)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.restClient.setAuthId(hashFromCookie);\n\t\t\t\t\t\tthis.restClient.setChatId(this.getChatId());\n\t\t\t\t\t\tthis.controller.getStore().commit('callApplication/user', {\n\t\t\t\t\t\t\tid: this.params.userId,\n\t\t\t\t\t\t\thash: hashFromCookie\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.pullClient.start();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\t\t\tinited: true\n\t\t\t\t});\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.restClient.setAuthId('guest');\n\t\t\t\tthis.restClient.setChatId(this.getChatId());\n\n\t\t\t\tif (typeof BX.SidePanel !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.disableAnchorBinding();\n\t\t\t\t}\n\n\t\t\t\treturn this.restClient.callMethod('im.call.user.register', {\n\t\t\t\t\talias: this.params.alias,\n\t\t\t\t\tuser_hash: this.getUserHashCookie() || '',\n\t\t\t\t}).then(result =>\n\t\t\t\t{\n\t\t\t\t\tthis.controller.getStore().commit('callApplication/user', {\n\t\t\t\t\t\tid: result.data().id,\n\t\t\t\t\t\thash: result.data().hash\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.controller.setUserId(result.data().id);\n\n\t\t\t\t\tif (result.data().created)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.params.userCount++;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\t\t\t\tinited: true\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.restClient.setAuthId(result.data().hash);\n\t\t\t\t\tthis.pullClient.start();\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tstartPageTagInterval()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tclearInterval(this.conferencePageTagInterval);\n\t\t\tthis.conferencePageTagInterval = setInterval(() => {\n\t\t\t\tLocalStorage.set(this.params.siteId, this.params.userId, BX.CallEngine.getConferencePageTag(this.params.dialogId), \"Y\", 2);\n\t\t\t}, 1000);\n\t\t\tresolve();\n\t\t})\n\t}\n\n\ttryJoinExistingCall()\n\t{\n\t\tthis.restClient.callMethod(\"im.call.tryJoinCall\", {\n\t\t\tentityType: 'chat',\n\t\t\tentityId: this.params.dialogId,\n\t\t\tprovider: BX.Call.Provider.Voximplant,\n\t\t\ttype: BX.Call.Type.Permanent\n\t\t});\n\t}\n\n\tsubscribePreCallChanges()\n\t{\n\t\tBX.addCustomEvent(window, 'CallEvents::callCreated', this.onCallCreated.bind(this));\n\t}\n\n\tonCallCreated(e)\n\t{\n\t\tif(this.preCall || this.currentCall)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet call = e.call;\n\t\tif (call.associatedEntity.type === 'chat' && call.associatedEntity.id === this.params.dialogId)\n\t\t{\n\t\t\tthis.preCall = e.call;\n\t\t\tthis.updatePreCallCounter();\n\t\t\tthis.preCall.addEventListener(BX.Call.Event.onUserStateChanged, this.onPreCallUserStateChangedHandler);\n\t\t\tthis.preCall.addEventListener(BX.Call.Event.onDestroy, this.onPreCallDestroyHandler);\n\t\t}\n\t}\n\n\treleasePreCall()\n\t{\n\t\tif(this.preCall)\n\t\t{\n\t\t\tthis.preCall.removeEventListener(BX.Call.Event.onUserStateChanged, this.onPreCallUserStateChangedHandler);\n\t\t\tthis.preCall.removeEventListener(BX.Call.Event.onDestroy, this.onPreCallDestroyHandler);\n\t\t\tthis.preCall = null;\n\t\t}\n\t}\n\n\tonPreCallDestroy(e)\n\t{\n\t\tthis.releasePreCall();\n\t}\n\n\tonPreCallUserStateChanged(e)\n\t{\n\t\tthis.updatePreCallCounter();\n\t}\n\n\tupdatePreCallCounter()\n\t{\n\t\tif(this.preCall)\n\t\t{\n\t\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\t\tuserInCallCount: this.preCall.getParticipatingUsers().length\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\t\tuserInCallCount: 0\n\t\t\t});\n\t\t}\n\t}\n\n\tinitCall()\n\t{\n\t\tBX.CallEngine.setRestClient(this.restClient);\n\t\tBX.CallEngine.setPullClient(this.pullClient);\n\t\tBX.CallEngine.setCurrentUserId(this.controller.getUserId());\n\n\t\tthis.callContainer = document.getElementById('bx-im-component-call-container');\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tBX.Call.Hardware.init().then(() =>\n\t\t\t{\n\t\t\t\tif (Object.values(BX.Call.Hardware.microphoneList).length === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.setComponentError(CallApplicationErrorCode.missingMicrophone);\n\t\t\t\t}\n\n\t\t\t\tthis.callView = new BX.Call.View({\n\t\t\t\t\tcontainer: this.callContainer,\n\t\t\t\t\tshowChatButtons: true,\n\t\t\t\t\tshowShareButton: true,\n\t\t\t\t\tuserLimit: BX.Call.Util.getUserLimit(),\n\t\t\t\t\tlanguage: this.params.language,\n\t\t\t\t\t//layout: BX.Call.View.Layout.Grid,\n\t\t\t\t\tuiState: BX.Call.View.UiState.Preparing,\n\t\t\t\t});\n\t\t\t\tthis.callView.setCallback('onButtonClick', this.onCallButtonClick.bind(this));\n\t\t\t\tthis.callView.disableAddUser();\n\t\t\t\tthis.callView.disableHistoryButton();\n\t\t\t\tthis.callView.show();\n\n\t\t\t\treturn this.getLocalVideo();\n\t\t\t})\n\t\t\t.catch(error =>\n\t\t\t{\n\t\t\t\tif (error === 'NO_WEBRTC' && this.isHttps())\n\t\t\t\t{\n\t\t\t\t\tthis.setComponentError(CallApplicationErrorCode.unsupportedBrowser);\n\t\t\t\t}\n\t\t\t\telse if (error === 'NO_WEBRTC' && !this.isHttps())\n\t\t\t\t{\n\t\t\t\t\tthis.setComponentError(CallApplicationErrorCode.unsafeConnection);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(stream =>\n\t\t\t{\n\t\t\t\tif (stream)\n\t\t\t\t{\n\t\t\t\t\tthis.callView.setLocalStream(stream, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//todo: show text \"you don't have connected camera, nobody gonna see you\"\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\t\t\t})\n\t\t})\n\t}\n\n\tsubscribeToStoreChanges()\n\t{\n\t\tthis.controller.getStore().subscribe((mutation, state) => {\n\t\t\tconst { payload, type } = mutation;\n\t\t\tif (type === 'users/update' && payload.fields.name)\n\t\t\t{\n\t\t\t\tif(this.callView)\n\t\t\t\t{\n\t\t\t\t\tthis.callView.updateUserData(\n\t\t\t\t\t\t{[payload.id]: {name: payload.fields.name}}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'dialogues/update' && typeof payload.fields.counter === 'number')\n\t\t\t{\n\t\t\t\tif(this.callView)\n\t\t\t\t{\n\t\t\t\t\tthis.callView.setButtonCounter('chat', payload.fields.counter);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'dialogues/update' && payload.fields.name)\n\t\t\t{\n\t\t\t\tdocument.title = payload.fields.name;\n\t\t\t}\n\t\t});\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\tuserCount: this.params.userCount\n\t\t});\n\n\t\tthis.inited = true;\n\t\tthis.initPromise.resolve(this);\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\tlet promise = new BX.Promise;\n\t\t\tpromise.resolve(this);\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n\n\tgetLocalVideo()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(this.localVideoStream)\n\t\t\t{\n\t\t\t\treturn resolve(this.localVideoStream)\n\t\t\t}\n\n\t\t\tnavigator.mediaDevices.getUserMedia({\n\t\t\t\tvideo: {\n\t\t\t\t\twidth: {ideal: BX.Call.Hardware.preferHdQuality ? 1280 : 640},\n\t\t\t\t\theight: {ideal: BX.Call.Hardware.preferHdQuality ? 720 : 360}\n\t\t\t\t}\n\t\t\t}).then(stream => {\n\t\t\t\tthis.localVideoStream = stream;\n\t\t\t\tclearTimeout(this.localVideoTimeout);\n\t\t\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\t\t\tcallError: \"\"\n\t\t\t\t});\n\t\t\t\tif(BX.Call.Util.hasHdVideo(this.localVideoStream))\n\t\t\t\t{\n\t\t\t\t\t// restore possibly cleared in localVideoTimeout flag\n\t\t\t\t\tBX.Call.Hardware.preferHdQuality = true;\n\t\t\t\t}\n\n\t\t\t\tresolve(stream)\n\t\t\t}).catch((error) => {\n\t\t\t\tclearTimeout(this.localVideoTimeout);\n\t\t\t\tif(error.name === \"OverconstrainedError\")\n\t\t\t\t{\n\t\t\t\t\tBX.Call.Hardware.preferHdQuality = false;\n\t\t\t\t}\n\n\t\t\t\tconsole.error(typeof(error) === \"string\" ? error : error.name);\n\t\t\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\t\t\tcallError: typeof(error) === \"string\" ? error : error.name\n\t\t\t\t});\n\t\t\t\treject(error);\n\t\t\t});\n\n\t\t\tthis.localVideoTimeout = setTimeout(() => {\n\t\t\t\tBX.Call.Hardware.preferHdQuality = false;\n\n\t\t\t\tthis.controller.getStore().commit('callApplication/common', {\n\t\t\t\t\tcallError: CallErrorCode.noSignalFromCamera\n\t\t\t\t});\n\t\t\t}, 5000)\n\t\t})\n\t}\n\n\tstopLocalVideo()\n\t{\n\t\tif(!this.localVideoStream)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.localVideoStream.getTracks().forEach(tr => tr.stop());\n\t\tthis.localVideoStream = null;\n\t}\n\n\trestart()\n\t{\n\t\tif(this.currentCall)\n\t\t{\n\t\t\tthis.removeCallEvents();\n\t\t\tthis.currentCall = null;\n\t\t}\n\n\t\tif(this.callView)\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t\tthis.callView.close();\n\t\t\tthis.callView.destroy();\n\t\t\tthis.callView = null;\n\t\t}\n\n\t\tthis.initCall();\n\t\tthis.controller.getStore().commit('callApplication/returnToPreparation');\n\t}\n\n/* endregion 01. Initialize */\n\n/* region 02. Methods */\n\n\t/* region 01. Call methods */\n\tstartCall()\n\t{\n\t\tconst provider = BX.Call.Provider.Voximplant;\n\n\t\tBX.Call.Engine.getInstance().createCall({\n\t\t\ttype: BX.Call.Type.Permanent,\n\t\t\tentityType: 'chat',\n\t\t\tentityId: this.getDialogId(),\n\t\t\tprovider: provider,\n\t\t\tvideoEnabled: true,\n\t\t\tenableMicAutoParameters: BX.Call.Hardware.enableMicAutoParameters,\n\t\t\tjoinExisting: true\n\t\t}).then(e => {\n\t\t\tconsole.warn('call created', e);\n\n\t\t\tthis.currentCall = e.call;\n\t\t\tthis.currentCall.useHdVideo(BX.Call.Hardware.preferHdQuality);\n\t\t\tif(BX.Call.Hardware.defaultMicrophone)\n\t\t\t{\n\t\t\t\tthis.currentCall.setMicrophoneId(BX.Call.Hardware.defaultMicrophone);\n\t\t\t}\n\t\t\tif(BX.Call.Hardware.defaultCamera)\n\t\t\t{\n\t\t\t\tthis.currentCall.setCameraId(BX.Call.Hardware.defaultCamera);\n\t\t\t}\n\n\t\t\tthis.callView.setUiState(BX.Call.View.UiState.Calling);\n\t\t\tthis.callView.setLayout(BX.Call.View.Layout.Grid);\n\t\t\tthis.callView.appendUsers(this.currentCall.getUsers());\n\t\t\tBX.Call.Util.getUsers(this.currentCall.id, this.getCallUsers(true)).then(userData => {\n\t\t\t\tthis.callView.updateUserData(userData)\n\t\t\t});\n\t\t\tthis.bindCallEvents();\n\t\t\tif(e.isNew)\n\t\t\t{\n\t\t\t\tthis.currentCall.setVideoEnabled(this.useVideo);\n\t\t\t\tthis.currentCall.inviteUsers();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.currentCall.answer({\n\t\t\t\t\tuseVideo: this.useVideo\n\t\t\t\t});\n\t\t\t}\n\n\t\t}).catch(e => {\n\t\t\tconsole.warn('creating call error', e);\n\t\t});\n\n\t\tthis.controller.getStore().commit('callApplication/startCall');\n\t}\n\n\tendCall()\n\t{\n\t\tif(this.currentCall)\n\t\t{\n\t\t\tthis.removeCallEvents();\n\t\t\tthis.currentCall.hangup();\n\t\t}\n\n\t\tthis.controller.getStore().commit('callApplication/endCall');\n\n\t\tthis.restart();\n\n\t\twindow.close();\n\t}\n\n\tkickFromCall()\n\t{\n\t\tthis.setComponentError(CallApplicationErrorCode.kickedFromCall);\n\t\tthis.pullClient.disconnect();\n\t\tthis.endCall();\n\t\tLocalStorage.set(this.controller.getSiteId(), 0, `conf${this.params.alias}`, true);\n\t}\n\n\tgetCallUsers(includeSelf)\n\t{\n\t\tlet result = Object.keys(this.currentCall.getUsers());\n\t\tif(includeSelf)\n\t\t{\n\t\t\tresult.push(this.currentCall.userId);\n\t\t}\n\t\treturn result;\n\t}\n\n\tonCallButtonClick(event)\n\t{\n\t\tconst buttonName = event.buttonName;\n\t\tconsole.warn('Button clicked!', buttonName);\n\n\t\tconst handlers = {\n\t\t\thangup: this.onCallViewHangupButtonClick.bind(this),\n\t\t\tclose: this.onCallViewCloseButtonClick.bind(this),\n\t\t\t//inviteUser: this.onCallViewInviteUserButtonClick.bind(this),\n\t\t\ttoggleMute: this.onCallViewToggleMuteButtonClick.bind(this),\n\t\t\ttoggleScreenSharing: this.onCallViewToggleScreenSharingButtonClick.bind(this),\n\t\t\ttoggleVideo: this.onCallViewToggleVideoButtonClick.bind(this),\n\t\t\tshowChat: this.onCallViewShowChatButtonClick.bind(this),\n\t\t\tshare: this.onCallViewShareButtonClick.bind(this),\n\t\t\tfullscreen: this.onCallViewFullScreenButtonClick.bind(this),\n\t\t};\n\n\t\tif(handlers[buttonName])\n\t\t{\n\t\t\thandlers[buttonName](event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error('Button handler not found!', buttonName);\n\t\t}\n\t}\n\n\tonCallViewHangupButtonClick(e)\n\t{\n\t\tthis.endCall();\n\t}\n\n\tonCallViewCloseButtonClick(e)\n\t{\n\t\tthis.endCall();\n\t}\n\n\tonCallViewToggleMuteButtonClick(e)\n\t{\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.setMuted(e.muted);\n\t\t}\n\n\t\tthis.callView.setMuted(e.muted);\n\t}\n\n\tonCallViewToggleScreenSharingButtonClick()\n\t{\n\t\tif(this.currentCall.isScreenSharingStarted())\n\t\t{\n\t\t\tthis.currentCall.stopScreenSharing();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t\tthis.currentCall.startScreenSharing();\n\t\t}\n\t}\n\n\tonCallViewToggleVideoButtonClick(e)\n\t{\n\t\tthis.useVideo = e.video;\n\t\tif (!this.useVideo)\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t\tthis.stopLocalVideo();\n\t\t}\n\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.setVideoEnabled(e.video);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(this.useVideo)\n\t\t\t{\n\t\t\t\tthis.getLocalVideo().then(stream => this.callView.setLocalStream(stream, true));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.callView.setLocalStream(new MediaStream());\n\t\t\t}\n\t\t}\n\t}\n\n\tonCallViewShareButtonClick()\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('BX_IM_VIDEOCONF_LINK_COPY_DONE'),\n\t\t\tautoHideDelay: 4000\n\t\t});\n\n\t\tClipboard.copy(this.getDialogData().public.link);\n\t}\n\n\tonCallViewFullScreenButtonClick()\n\t{\n\t\tthis.callView.toggleFullScreen();\n\t}\n\n\tonCallViewShowChatButtonClick()\n\t{\n\t\tthis.toggleChat();\n\t}\n\n\tbindCallEvents()\n\t{\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onUserInvited, this.onCallUserInvitedHandler);\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onDestroy, this.onCallDestroyHandler);\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onUserStateChanged, this.onCallUserStateChangedHandler);\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onUserMicrophoneState, this.onCallUserMicrophoneStateHandler);\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onLocalMediaReceived, this.onCallLocalMediaReceivedHandler);\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onStreamReceived, this.onCallUserStreamReceivedHandler);\n\t\t//this.currentCall.addEventListener(BX.Call.Event.onStreamRemoved, this.onCallUserStreamRemoved.bind(this));\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onUserVoiceStarted, this.onCallUserVoiceStartedHandler);\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onUserVoiceStopped, this.onCallUserVoiceStoppedHandler);\n\t\t//this.currentCall.addEventListener(BX.Call.Event.onDeviceListUpdated, this._onCallDeviceListUpdatedHandler);\n\t\t//this.currentCall.addEventListener(BX.Call.Event.onCallFailure, this._onCallFailureHandler);\n\t\t//this.currentCall.addEventListener(BX.Call.Event.onJoin, this._onCallJoinHandler);\n\t\tthis.currentCall.addEventListener(BX.Call.Event.onLeave, this.onCallLeaveHandler);\n\t}\n\n\tremoveCallEvents()\n\t{\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onUserInvited, this.onCallUserInvitedHandler);\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onDestroy, this.onCallDestroyHandler);\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onUserStateChanged, this.onCallUserStateChangedHandler);\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onUserMicrophoneState, this.onCallUserMicrophoneStateHandler);\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onLocalMediaReceived, this.onCallLocalMediaReceivedHandler);\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onStreamReceived, this.onCallUserStreamReceivedHandler);\n\t\t//this.currentCall.removeEventListener(BX.Call.Event.onStreamRemoved, this.onCallUserStreamRemoved.bind(this));\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onUserVoiceStarted, this.onCallUserVoiceStartedHandler);\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onUserVoiceStopped, this.onCallUserVoiceStoppedHandler);\n\t\t//this.currentCall.removeEventListener(BX.Call.Event.onDeviceListUpdated, this._onCallDeviceListUpdatedHandler);\n\t\t//this.currentCall.removeEventListener(BX.Call.Event.onCallFailure, this._onCallFailureHandler);\n\t\tthis.currentCall.removeEventListener(BX.Call.Event.onLeave, this.onCallLeaveHandler);\n\t}\n\n\tonCallUserInvited(e)\n\t{\n\t\tthis.callView.addUser(e.userId);\n\n\t\tBX.Call.Util.getUsers(this.currentCall.id, [e.userId]).then(userData => {\n\t\t\tthis.callView.updateUserData(userData)\n\t\t});\n\t}\n\n\tonCallUserStateChanged(e)\n\t{\n\t\tthis.callView.setUserState(e.userId, e.state);\n\t}\n\n\tonCallUserMicrophoneState(e)\n\t{\n\t\tthis.callView.setUserMicrophoneState(e.userId, e.microphoneState);\n\t}\n\n\tonCallLocalMediaReceived(e)\n\t{\n\t\tthis.callView.setLocalStream(e.stream, e.tag == \"main\");\n\t\tthis.callView.setButtonActive(\"screen\", e.tag == \"screen\");\n\t\tif(e.tag == \"screen\")\n\t\t{\n\t\t\tthis.callView.disableSwitchCamera();\n\t\t\tthis.callView.updateButtons();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(!this.currentCall.callFromMobile)\n\t\t\t{\n\t\t\t\tthis.callView.enableSwitchCamera();\n\t\t\t\tthis.callView.updateButtons();\n\t\t\t}\n\t\t}\n\t}\n\n\tonCallUserStreamReceived(e)\n\t{\n\t\tthis.callView.setStream(e.userId, e.stream);\n\t}\n\n\tonCallUserVoiceStarted(e)\n\t{\n\t\tthis.callView.setUserTalking(e.userId, true);\n\t}\n\n\tonCallUserVoiceStopped(e)\n\t{\n\t\tthis.callView.setUserTalking(e.userId, false);\n\t}\n\n\tonCallLeave(e)\n\t{\n\t\tthis.restart();\n\t}\n\n\tonCallDestroy(e)\n\t{\n\t\tthis.currentCall = null;\n\t\tthis.restart();\n\t}\n\n\tonCheckDevicesSave(changedValues)\n\t{\n\t\tif (changedValues['camera'])\n\t\t{\n\t\t\tBX.Call.Hardware.defaultCamera = changedValues['camera'];\n\t\t}\n\n\t\tif (changedValues['microphone'])\n\t\t{\n\t\t\tBX.Call.Hardware.defaultMicrophone = changedValues['microphone'];\n\t\t}\n\n\t\tif (changedValues['audioOutput'])\n\t\t{\n\t\t\tBX.Call.Hardware.defaultSpeaker = changedValues['audioOutput'];\n\t\t}\n\n\t\tif (changedValues['preferHDQuality'])\n\t\t{\n\t\t\tBX.Call.Hardware.preferHdQuality = changedValues['preferHDQuality'];\n\t\t}\n\n\t\tif (changedValues['enableMicAutoParameters'])\n\t\t{\n\t\t\tBX.Call.Hardware.enableMicAutoParameters = changedValues['enableMicAutoParameters'];\n\t\t}\n\t}\n\n\t/* endregion 01. Call methods */\n\n\t/* region 02. Component methods */\n\tsetCallError(errorCode)\n\t{\n\t\tthis.controller.getStore().commit('callApplication/setCallError', {errorCode});\n\t}\n\n\tsetComponentError(errorCode)\n\t{\n\t\tthis.controller.getStore().commit('callApplication/setComponentError', {errorCode});\n\t}\n\n\tisChatShow()\n\t{\n\t\treturn this.controller.getStore().state.callApplication.common.showChat;\n\t}\n\n\ttoggleChat()\n\t{\n\t\tlet newState = !this.isChatShow();\n\n\t\tthis.controller.getStore().state.callApplication.common.showChat = newState;\n\t\tthis.callView.setButtonActive('chat', newState);\n\t}\n\n\tsetUserName(name)\n\t{\n\t\tthis.restClient.callMethod('im.call.user.update', {\n\t\t\tname: name,\n\t\t\tchat_id: this.getChatId()\n\t\t}).then(() => {\n\t\t\tthis.template.isSettingNewName = false;\n\t\t});\n\t}\n\n\tsetDialogInited()\n\t{\n\t\tthis.dialogInited = true;\n\t\tlet dialogData = this.getDialogData();\n\t\tdocument.title = dialogData.name;\n\t}\n\n\tchangeVideoconfUrl(newUrl)\n\t{\n\t\twindow.history.pushState(\"\", \"\", newUrl);\n\t}\n\n\tsendNewMessageNotify(text)\n\t{\n\t\tconst MAX_LENGTH = 40;\n\t\tconst AUTO_HIDE_TIME = 4000;\n\n\t\ttext = text.replace(/<br \\/>/gi, ' ');\n\n\t\ttext = text.replace(/\\[USER=([0-9]+)](.*?)\\[\\/USER]/ig, (whole, userId, text) => text);\n\t\ttext = text.replace(/\\[CHAT=(imol\\|)?([0-9]+)](.*?)\\[\\/CHAT]/ig, (whole, imol, chatId, text) => text);\n\t\ttext = text.replace(/\\[PCH=([0-9]+)](.*?)\\[\\/PCH]/ig, (whole, historyId, text) => text);\n\t\ttext = text.replace(/\\[SEND(?:=(.+?))?](.+?)?\\[\\/SEND]/ig, (whole, command, text) => text? text: command);\n\t\ttext = text.replace(/\\[PUT(?:=(.+?))?](.+?)?\\[\\/PUT]/ig, (whole, command, text) => text? text: command);\n\t\ttext = text.replace(/\\[CALL(?:=(.+?))?](.+?)?\\[\\/CALL]/ig, (whole, command, text) => text? text: command);\n\t\ttext = text.replace(/\\[ATTACH=([0-9]+)]/ig, (whole, historyId, text) => '');\n\n\t\tif (text.length > MAX_LENGTH)\n\t\t{\n\t\t\ttext = text.substring(0, MAX_LENGTH - 1) + '...';\n\t\t}\n\n\t\tconst notifyNode = BX.create(\"div\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'bx-im-application-call-notify-new-message'\n\t\t\t},\n\t\t\thtml: text\n\t\t});\n\n\t\tconst notify = BX.UI.Notification.Center.notify({\n\t\t\tcontent: notifyNode,\n\t\t\tautoHideDelay: AUTO_HIDE_TIME\n\t\t});\n\n\t\tnotifyNode.addEventListener('click', (event) => {\n\t\t\tnotify.close();\n\t\t\tthis.toggleChat();\n\t\t});\n\t}\n\n\tinsertText(params = {})\n\t{\n\t\tthis.template.$emit(EventType.textarea.insertText, params);\n\t}\n\n\taddMessage(text = '', file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({ id: 0, text, file });\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tlet params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/increaseDialogExtraCount');\n\n\t\tthis.controller.getStore().dispatch('messages/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.controller.getUserId(),\n\t\t\ttext: text,\n\t\t\tparams,\n\t\t\tsending: !file,\n\t\t}).then(messageId => {\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tfile,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tthis.processSendMessages();\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tthis.sendMessageWithFile(element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendMessage(element);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\t//let quiteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.getDialogId());\n\t\t//if (quiteId)\n\t\t//{\n\t\t//\tlet quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.getChatId(), quiteId);\n\t\t//\tif (quoteMessage)\n\t\t//\t{\n\t\t//\t\tlet user = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\t\t//\n\t\t//\t\tlet newMessage = [];\n\t\t//\t\tnewMessage.push(\"------------------------------------------------------\");\n\t\t//\t\tnewMessage.push((user.name ? user.name : this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE')));\n\t\t//\t\tnewMessage.push(quoteMessage.text);\n\t\t//\t\tnewMessage.push('------------------------------------------------------');\n\t\t//\t\tnewMessage.push(message.text);\n\t\t//\t\tmessage.text = newMessage.join(\"\\n\");\n\t\t//\n\t\t//\t\tthis.quoteMessageClear();\n\t\t//\t}\n\t\t//}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t'CHAT_ID': message.chatId,\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null)\n\t\t.then(response => {\n\t\t\tthis.controller.getStore().dispatch('messages/update', {\n\t\t\t\tid: message.id,\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tfields: {\n\t\t\t\t\tid: response.data(),\n\t\t\t\t\tsending: false,\n\t\t\t\t\terror: false,\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.getStore().dispatch('messages/actionFinish', {\n\t\t\t\t\tid: response.data(),\n\t\t\t\t\tchatId: message.chatId\n\t\t\t\t});\n\t\t\t});\n\t\t\t//this.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\t//this.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessageWithFile(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tlet fileType = this.controller.getStore().getters['files/get'](this.getChatId(), message.file.id, true).type;\n\n\t\tlet diskFolderId = this.getDiskFolderId();\n\n\t\tlet query = {};\n\n\t\tif (diskFolderId)\n\t\t{\n\t\t\tquery[ImRestMethod.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid: diskFolderId,\n\t\t\t\tdata: { NAME: message.file.source.files[0].name },\n\t\t\t\tfileContent: message.file.source,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[ImRestMethod.imDiskFolderGet] = [ImRestMethod.imDiskFolderGet, { chat_id: this.getChatId() }];\n\t\t\tquery[ImRestMethod.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid: '$result[' + ImRestMethod.imDiskFolderGet + '][ID]',\n\t\t\t\tdata: {\n\t\t\t\t\tNAME: message.file.source.files[0].name\n\t\t\t\t},\n\t\t\t\tfileContent: message.file.source,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\n\t\tthis.controller.restClient.callBatch(query, (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [1]');\n\t\t\t\tthis.fileError(this.getChatId, message.file.id, message.id);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!diskFolderId)\n\t\t\t{\n\t\t\t\tlet diskFolderGet = response[ImRestMethodHandler.imDiskFolderGet];\n\t\t\t\tif (diskFolderGet && diskFolderGet.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFolderGet.error().ex.error, diskFolderGet.error().ex.error_description);\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t//\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, diskFolderGet);\n\t\t\t\tthis.controller.getStore().commit('application/set', {\n\t\t\t\t\tdialog: {\n\t\t\t\t\t\tdiskFolderId: diskFolderGet.ID,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet diskId = 0;\n\t\t\tlet diskFileUpload = response[ImRestMethod.imDiskFileUpload];\n\t\t\tif (diskFileUpload)\n\t\t\t{\n\t\t\t\tlet result = diskFileUpload.data();\n\t\t\t\tif (diskFileUpload.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFileUpload.error().ex.error, diskFileUpload.error().ex.error_description);\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse if (!result)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [2]');\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tdiskId = result.ID;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [3]');\n\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tmessage.chatId = this.getChatId();\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tid: message.file.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.wait,\n\t\t\t\t\tprogress: 95\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.fileCommit({\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tuploadId: diskId,\n\t\t\t\tmessageText: message.text,\n\t\t\t\tmessageId: message.id,\n\t\t\t\tfileId: message.file.id,\n\t\t\t\tfileType\n\t\t\t}, message);\n\n\t\t}, false, (xhr) => {\n\t\t\tmessage.xhr = xhr\n\t\t});\n\t}\n\n\tuploadFile(fileInput)\n\t{\n\t\tif (!fileInput)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.warn('addFile', fileInput.files[0].name, fileInput.files[0].size, fileInput.files[0]);\n\n\t\tlet file = fileInput.files[0];\n\n\t\tlet fileType = 'file';\n\t\tif (file.type.toString().startsWith('image'))\n\t\t{\n\t\t\tfileType = 'image';\n\t\t}\n\n\t\t//if (!this.controller.application.isUnreadMessagesLoaded())\n\t\t//{\n\t\t//\tthis.addMessage('', { id: 0, source: fileInput });\n\t\t//\treturn true;\n\t\t//}\n\n\t\tthis.controller.getStore().dispatch('files/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.controller.getUserId(),\n\t\t\tname: file.name,\n\t\t\ttype: fileType,\n\t\t\textension: file.name.split('.').splice(-1)[0],\n\t\t\tsize: file.size,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.upload,\n\t\t\tprogress: 0,\n\t\t\tauthorName: this.controller.application.getCurrentUser().name,\n\t\t\turlPreview: \"\",\n\t\t}).then(fileId => this.addMessage('', { id: fileId, source: fileInput }));\n\n\t\treturn true;\n\t}\n\n\tfileError(chatId, fileId, messageId = 0)\n\t{\n\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\tchatId: chatId,\n\t\t\tid: fileId,\n\t\t\tfields: {\n\t\t\t\tstatus: FileStatus.error,\n\t\t\t\tprogress: 0\n\t\t\t}\n\t\t});\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('messages/actionError', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: messageId,\n\t\t\t\tretry: false,\n\t\t\t});\n\t\t}\n\t}\n\n\tfileCommit(params, message)\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFileCommit, {\n\t\t\tchat_id: params.chatId,\n\t\t\tupload_id: params.uploadId,\n\t\t\tmessage: params.messageText,\n\t\t\ttemplate_id: params.messageId,\n\t\t\tfile_template_id: params.fileId,\n\t\t}, null, null, ).then(response => {\n\t\t\t//this.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, response, message);\n\t\t\tthis.controller.getStore().dispatch('messages/update', {\n\t\t\t\tid: message.id,\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tfields: {\n\t\t\t\t\tid: response['MESSAGE_ID'],\n\t\t\t\t\tsending: false,\n\t\t\t\t\terror: false,\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.getStore().dispatch('messages/actionFinish', {\n\t\t\t\t\tid: response['MESSAGE_ID'],\n\t\t\t\t\tchatId: message.chatId\n\t\t\t\t});\n\t\t\t});\n\t\t}).catch(error => {\n\t\t\t//this.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\t/* endregion 02. Component methods */\n\n/* endregion 02. Methods */\n\n/* region 03. Utils */\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.controller.addLocalize(phrases);\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\treturn this.controller.getLocalize(name);\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn parseInt(this.params.chatId);\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.params.dialogId;\n\t}\n\n\tgetDialogData()\n\t{\n\t\tif (!this.dialogInited)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().getters['dialogues/get'](this.getDialogId());\n\t}\n\n\tgetHost()\n\t{\n\t\treturn location.origin || '';\n\t}\n\n\tgetStartupErrorCode()\n\t{\n\t\treturn this.params.startupErrorCode? this.params.startupErrorCode : '';\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.diskFolderId;\n\t}\n\n\tisHttps()\n\t{\n\t\treturn location.protocol === 'https:';\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.controller.getStore().state.callApplication.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'BITRIX_CALL_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash = cookie;\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetAlias()\n\t{\n\t\treturn this.params.alias ? this.params.alias : '';\n\t}\n\n\tswitchToSessAuth()\n\t{\n\t\tthis.restClient.restClient.queryParams = undefined;\n\t\treturn true;\n\t}\n\n/* endregion 03. Utils */\n}"],"names":["RestAuth","Object","freeze","guest","CallRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","call_auth_id","console","error","call_custom_auth_id","chatId","call_chat_id","method","callback","sendCallback","logTag","Utils","getLogTrackingParams","name","promise","BX","Promise","callMethod","then","result","fulfill","catch","ex","hash","RestMethod","widgetUserRegister","warn","error_description","reject","calls","bHaltOnError","resultCallback","hasOwnProperty","callBatch","Vue","component","data","downloadAppArticleCode","props","default","dialogId","startupErrorCode","methods","redirectToAuthorize","location","href","origin","pathname","continueAsGuest","Cookie","set","path","reload","getBxLink","$root","$bitrixApplication","getAlias","getErrorFromCode","CallApplicationErrorCode","bitrix24only","localize","detectIntranetUser","userLimitReached","kickedFromCall","callApplication","common","componentError","unsupportedBrowser","missingMicrophone","unsafeConnection","openHelpArticle","Helper","show","computed","authorizeButtonClasses","continueAsGuestButtonClasses","isIntranetUserError","isUnsupportedBrowserError","getFilteredPhrases","$bitrixMessages","Vuex","mapState","state","application","template","CallApplication","inited","dialogInited","initPromise","userId","parseInt","siteId","toString","messagesQueue","rootNode","node","document","createElement","event","VueVendorV2","callContainer","callView","preCall","currentCall","useVideo","localVideoStream","selectedCameraId","selectedMicrophoneId","localVideoTimeout","conferencePageTagInterval","onCallUserInvitedHandler","onCallUserInvited","bind","onCallUserStateChangedHandler","onCallUserStateChanged","onCallUserMicrophoneStateHandler","onCallUserMicrophoneState","onCallLocalMediaReceivedHandler","onCallLocalMediaReceived","onCallUserStreamReceivedHandler","onCallUserStreamReceived","onCallUserVoiceStartedHandler","onCallUserVoiceStarted","onCallUserVoiceStoppedHandler","onCallUserVoiceStopped","onCallLeaveHandler","onCallLeave","onCallDestroyHandler","onCallDestroy","onPreCallDestroyHandler","onPreCallDestroy","onPreCallUserStateChangedHandler","onPreCallUserStateChanged","initRestClient","subscribePreCallChanges","initPullClient","initCore","initComponent","initUser","startPageTagInterval","tryJoinExistingCall","initCall","initPullHandlers","subscribeToStoreChanges","initComplete","log","getHost","resolve","isIntranetOrExtranet","pullClient","PullClient","serverEnabled","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","PULL","start","subscribe","ImCallPullHandler","store","controller","getStore","Controller","host","languageId","language","pull","client","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","CallApplicationModel","create","ready","commit","dialog","getChatId","getDialogId","createVue","el","getStartupErrorCode","vue","userWasKicked","LocalStorage","get","getSiteId","alias","setUserId","switchToSessAuth","id","hashFromCookie","getUserHashCookie","setChatId","SidePanel","Instance","disableAnchorBinding","user_hash","created","userCount","clearInterval","setInterval","CallEngine","getConferencePageTag","entityType","entityId","provider","Call","Provider","Voximplant","type","Type","Permanent","addCustomEvent","window","onCallCreated","e","call","associatedEntity","updatePreCallCounter","addEventListener","Event","onUserStateChanged","onDestroy","removeEventListener","releasePreCall","userInCallCount","getParticipatingUsers","length","setRestClient","setPullClient","setCurrentUserId","getUserId","getElementById","Hardware","init","values","microphoneList","setComponentError","View","container","showChatButtons","showShareButton","userLimit","Util","getUserLimit","uiState","UiState","Preparing","setCallback","onCallButtonClick","disableAddUser","disableHistoryButton","getLocalVideo","isHttps","stream","setLocalStream","mutation","payload","fields","updateUserData","counter","setButtonCounter","title","navigator","mediaDevices","getUserMedia","video","width","ideal","preferHdQuality","height","clearTimeout","callError","hasHdVideo","setTimeout","CallErrorCode","noSignalFromCamera","getTracks","forEach","tr","stop","removeCallEvents","releaseLocalMedia","close","destroy","Engine","getInstance","createCall","videoEnabled","enableMicAutoParameters","joinExisting","useHdVideo","defaultMicrophone","setMicrophoneId","defaultCamera","setCameraId","setUiState","Calling","setLayout","Layout","Grid","appendUsers","getUsers","getCallUsers","userData","bindCallEvents","isNew","setVideoEnabled","inviteUsers","answer","hangup","restart","disconnect","endCall","includeSelf","keys","push","buttonName","handlers","onCallViewHangupButtonClick","onCallViewCloseButtonClick","toggleMute","onCallViewToggleMuteButtonClick","toggleScreenSharing","onCallViewToggleScreenSharingButtonClick","toggleVideo","onCallViewToggleVideoButtonClick","showChat","onCallViewShowChatButtonClick","share","onCallViewShareButtonClick","fullscreen","onCallViewFullScreenButtonClick","setMuted","muted","isScreenSharingStarted","stopScreenSharing","startScreenSharing","stopLocalVideo","MediaStream","UI","Notification","Center","notify","content","Loc","getMessage","autoHideDelay","Clipboard","copy","getDialogData","public","link","toggleFullScreen","toggleChat","onUserInvited","onUserMicrophoneState","onLocalMediaReceived","onStreamReceived","onUserVoiceStarted","onUserVoiceStopped","onLeave","addUser","setUserState","setUserMicrophoneState","microphoneState","tag","setButtonActive","disableSwitchCamera","updateButtons","callFromMobile","enableSwitchCamera","setStream","setUserTalking","changedValues","defaultSpeaker","errorCode","newState","isChatShow","chat_id","isSettingNewName","dialogData","newUrl","history","pushState","text","MAX_LENGTH","AUTO_HIDE_TIME","replace","whole","imol","historyId","command","substring","notifyNode","className","html","$emit","EventType","textarea","insertText","file","isUnreadMessagesLoaded","sendMessage","processSendMessages","FILE_ID","dispatch","authorId","sending","messageId","filter","element","sendMessageWithFile","message","stopWriting","ImRestMethod","imMessageAdd","response","fileType","getters","diskFolderId","getDiskFolderId","query","imDiskFileUpload","NAME","source","files","fileContent","generateUniqueName","imDiskFolderGet","requestDataSend","fileError","diskFolderGet","ImRestMethodHandler","ID","diskId","diskFileUpload","status","FileStatus","wait","progress","fileCommit","uploadId","messageText","fileId","xhr","fileInput","size","startsWith","extension","split","splice","image","upload","authorName","getCurrentUser","urlPreview","addMessage","retry","imDiskFileCommit","upload_id","template_id","file_template_id","phrases","addLocalize","getLocalize","getUserHash","protocol","user","userHash","cookie","undefined"],"mappings":"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"}