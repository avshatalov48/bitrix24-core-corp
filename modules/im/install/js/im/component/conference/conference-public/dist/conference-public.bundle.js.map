{"version":3,"file":"conference-public.bundle.js","sources":["../src/event-handler/conference-textarea-handler.js","../src/event-handler/conference-textarea-upload-handler.js","../src/component/conference-smiles.js","../src/component/mic-level.js","../src/component/check-devices.js","../src/component/error.js","../src/component/orientation-disabled.js","../src/component/password-check.js","../src/component/loading-status.js","../src/component/request-permissions.js","../src/component/mobile-chat-button.js","../src/component/conference-info.js","../src/component/user-form.js","../src/component/chat-header.js","../src/component/waiting-for-start.js","../src/component/user-list/user-list-item.js","../src/component/user-list/user-list.js","../src/component/user-list/user-list-header.js","../src/conference-public.js"],"sourcesContent":["import { TextareaHandler } from \"im.event-handler\";\n\nexport class ConferenceTextareaHandler extends TextareaHandler\n{\n\tapplication: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tsuper($Bitrix);\n\t\tthis.application = $Bitrix.Application.get();\n\t}\n\n\tonAppButtonClick({data: event})\n\t{\n\t\tif (event.appId === 'smile')\n\t\t{\n\t\t\tthis.application.toggleSmiles();\n\t\t}\n\t}\n}","import { TextareaUploadHandler } from 'im.event-handler';\nimport { Logger } from 'im.lib.logger';\n\nexport class ConferenceTextareaUploadHandler extends TextareaUploadHandler\n{\n\taddMessageWithFile(event)\n\t{\n\t\tconst message = event.getData();\n\n\t\tif (!this.getDiskFolderId())\n\t\t{\n\t\t\tthis.requestDiskFolderId(message.chatId).then(() => {\n\t\t\t\tthis.addMessageWithFile(event);\n\t\t\t}).catch(error => {\n\t\t\t\tLogger.error('addMessageWithFile error', error);\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.setUploaderCustomHeaders();\n\n\t\tthis.uploader.addTask({\n\t\t\ttaskId: message.file.id,\n\t\t\tfileData: message.file.source.file,\n\t\t\tfileName: message.file.source.file.name,\n\t\t\tgenerateUniqueName: true,\n\t\t\tdiskFolderId: this.getDiskFolderId(),\n\t\t\tpreviewBlob: message.file.previewBlob,\n\t\t});\n\t}\n\n\tsetUploaderCustomHeaders()\n\t{\n\t\tif (!this.uploader.senderOptions.customHeaders)\n\t\t{\n\t\t\tthis.uploader.senderOptions.customHeaders = {};\n\t\t}\n\t\tthis.uploader.senderOptions.customHeaders['Call-Auth-Id'] = this.getUserHash();\n\t\tthis.uploader.senderOptions.customHeaders['Call-Chat-Id'] = this.getChatId();\n\t}\n\n\tgetUserHash(): string\n\t{\n\t\treturn this.controller.store.state.conference.user.hash;\n\t}\n\n\tgetActionCommitFile(): ?string\n\t{\n\t\treturn 'im.call.disk.commit';\n\t}\n\n\tgetActionUploadChunk(): ?string\n\t{\n\t\treturn 'im.call.disk.upload';\n\t}\n}","import 'ui.vue.components.smiles';\nimport { EventEmitter } from 'main.core.events';\nimport { EventType } from \"im.const\";\n\nconst ConferenceSmiles = {\n\tmethods:\n\t{\n\t\tonSelectSmile(event)\n\t\t{\n\t\t\tthis.$emit('selectSmile', event);\n\t\t},\n\t\tonSelectSet(event)\n\t\t{\n\t\t\tthis.$emit('selectSet', event);\n\t\t},\n\t\thideSmiles()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.conference.hideSmiles);\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-smiles-box\">\n\t\t\t<div class=\"bx-im-component-smiles-box-close\" @click=\"hideSmiles\"></div>\n\t\t\t<div class=\"bx-im-component-smiles-box-list\">\n\t\t\t\t<bx-smiles\n\t\t\t\t\t@selectSmile=\"onSelectSmile\"\n\t\t\t\t\t@selectSet=\"onSelectSet\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {ConferenceSmiles};","import { BitrixVue } from \"ui.vue\";\nimport { Type } from \"main.core\";\n\nconst MicLevel = {\n\tprops: ['localStream'],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tbars: [],\n\t\t\tbarDisabledColor: 'rgba(255,255,255,0.42)',\n\t\t\tbarEnabledColor: '#B3E600'\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tlocalStream(stream)\n\t\t{\n\t\t\tif (!Type.isNil(stream))\n\t\t\t{\n\t\t\t\tthis.startAudioCheck();\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.bars = [...document.querySelectorAll('.bx-im-component-call-check-devices-micro-level-item')];\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_CHECK_DEVICES_');\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tstartAudioCheck()\n\t\t{\n\t\t\tthis.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n\t\t\tthis.analyser = this.audioContext.createAnalyser();\n\t\t\tthis.microphone = this.audioContext.createMediaStreamSource(this.localStream);\n\t\t\tthis.scriptNode = this.audioContext.createScriptProcessor(2048, 1, 1);\n\n\t\t\tthis.analyser.smoothingTimeConstant = 0.8;\n\t\t\tthis.analyser.fftSize = 1024;\n\n\t\t\tthis.microphone.connect(this.analyser);\n\t\t\tthis.analyser.connect(this.scriptNode);\n\t\t\tthis.scriptNode.connect(this.audioContext.destination);\n\t\t\tthis.scriptNode.onaudioprocess = this.processVolume;\n\t\t},\n\t\tprocessVolume()\n\t\t{\n\t\t\tlet arr = new Uint8Array(this.analyser.frequencyBinCount);\n\t\t\tthis.analyser.getByteFrequencyData(arr);\n\t\t\tlet values = 0;\n\n\t\t\tfor (let i = 0; i < arr.length; i++)\n\t\t\t{\n\t\t\t\tvalues += arr[i];\n\t\t\t}\n\t\t\tlet average = values / arr.length;\n\n\t\t\tlet oneBarValue = 100 / this.bars.length;\n\t\t\tlet barsToColor = Math.round(average / oneBarValue);\n\t\t\tlet elementsToColor = this.bars.slice(0, barsToColor);\n\t\t\tthis.bars.forEach(elem => {\n\t\t\t\telem.style.backgroundColor = this.barDisabledColor;\n\t\t\t});\n\t\t\telementsToColor.forEach(elem => {\n\t\t\t\telem.style.backgroundColor = this.barEnabledColor;\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-check-devices-row\">\n\t\t\t<div class=\"bx-im-component-call-check-devices-micro-icon\"></div>\n\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level\">\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {MicLevel};","import {BitrixVue} from \"ui.vue\";\nimport {MicLevel} from './mic-level';\nimport {Type} from \"main.core\";\nimport {Logger} from \"im.lib.logger\";\nimport {Utils} from \"im.lib.utils\";\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\n\nimport 'ui.forms';\n\nconst CheckDevices = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tnoVideo: true,\n\t\t\tselectedCamera: null,\n\t\t\tselectedMic: null,\n\t\t\tmediaStream: null,\n\t\t\tshowMic: true,\n\t\t\tuserDisabledCamera: false,\n\t\t\tgettingVideo: false,\n\t\t\tisFlippedVideo: BX.Call.Hardware.enableMirroring,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.$root.$on('setCameraState', (state) => {this.onCameraStateChange(state)});\n\t\tthis.$root.$on('setMicState', (state) => {this.onMicStateChange(state)});\n\t\tthis.$root.$on('callLocalMediaReceived', () => {this.stopLocalVideo()});\n\t\tthis.$root.$on('cameraSelected', (cameraId) => {this.onCameraSelected(cameraId)});\n\t\tthis.$root.$on('micSelected', (micId) => {this.onMicSelected(micId)});\n\n\t\tthis.getApplication().initHardware().then(() => {\n\t\t\tthis.getDefaultDevices();\n\t\t}).catch(() => {\n\t\t\tMessageBox.show({\n\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_HARDWARE_ERROR'),\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK\n\t\t\t});\n\t\t});\n\n\t},\n\tdestroyed()\n\t{\n\t\t// do not stop local media stream, because it is required in the controller\n\t\tthis.mediaStream = null;\n\t},\n\tcomputed:\n\t{\n\t\tnoVideoText()\n\t\t{\n\t\t\tif (this.gettingVideo)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_CHECK_DEVICES_GETTING_CAMERA'];\n\t\t\t}\n\n\t\t\tif (this.userDisabledCamera)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_CHECK_DEVICES_DISABLED_CAMERA'];\n\t\t\t}\n\n\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_CHECK_DEVICES_NO_VIDEO'];\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_CHECK_DEVICES_');\n\t\t},\n\t\tcameraVideoClasses()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'bx-im-component-call-check-devices-camera-video' : true,\n\t\t\t\t'bx-im-component-call-check-devices-camera-video-flipped' : this.isFlippedVideo\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetDefaultDevices()\n\t\t{\n\t\t\tthis.gettingVideo = true;\n\t\t\tconst constraints = {audio: true, video: true};\n\n\t\t\tif (!Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tconstraints.video = {};\n\t\t\t\tconstraints.video.width = {ideal: /*BX.Call.Hardware.preferHdQuality*/  true ? 1280 : 640};\n\t\t\t\tconstraints.video.height = {ideal: /*BX.Call.Hardware.preferHdQuality*/ true ? 720 : 360};\n\t\t\t}\n\n\t\t\tif (BX.Call.Hardware.defaultCamera)\n\t\t\t{\n\t\t\t\tthis.selectedCamera = BX.Call.Hardware.defaultCamera;\n\t\t\t\tconstraints.video = {deviceId: { exact: this.selectedCamera }};\n\t\t\t}\n\t\t\telse if (Object.keys(BX.Call.Hardware.cameraList).length === 0)\n\t\t\t{\n\t\t\t\tconstraints.video = false;\n\t\t\t}\n\n\t\t\tif (BX.Call.Hardware.defaultMicrophone)\n\t\t\t{\n\t\t\t\tthis.selectedMic = BX.Call.Hardware.defaultMicrophone;\n\t\t\t\tconstraints.audio = {deviceId: { exact: this.selectedMic }};\n\t\t\t}\n\n\t\t\tnavigator.mediaDevices.getUserMedia(constraints)\n\t\t\t\t.then(stream => {\n\t\t\t\t\tthis.gettingVideo = false;\n\t\t\t\t\tthis.setLocalStream(stream);\n\t\t\t\t\tif (stream.getVideoTracks().length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!this.selectedCamera)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectedCamera = stream.getVideoTracks()[0].getSettings().deviceId;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.noVideo = false;\n\t\t\t\t\t\tthis.playLocalVideo();\n\t\t\t\t\t\tthis.getApplication().setSelectedCamera(this.selectedCamera);\n\t\t\t\t\t}\n\t\t\t\t\tif (stream.getAudioTracks().length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!this.selectedMic)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectedMic = stream.getAudioTracks()[0].getSettings().deviceId;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.getApplication().setSelectedMic(this.selectedMic);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tthis.gettingVideo = false;\n\t\t\t\t\tLogger.warn('Error getting default media stream', e);\n\t\t\t\t});\n\t\t},\n\t\tgetLocalStream()\n\t\t{\n\t\t\tthis.gettingVideo = true;\n\t\t\tif (Type.isNil(this.selectedCamera) && Type.isNil(this.selectedMic))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst constraints = {video: false, audio: false};\n\t\t\tif (this.selectedCamera && !this.noVideo)\n\t\t\t{\n\t\t\t\tconstraints.video = {deviceId: { exact: this.selectedCamera }};\n\t\t\t\tif (!Utils.device.isMobile() )\n\t\t\t\t{\n\t\t\t\t\tconstraints.video.width = {ideal: /*BX.Call.Hardware.preferHdQuality*/  true ? 1280 : 640};\n\t\t\t\t\tconstraints.video.height = {ideal: /*BX.Call.Hardware.preferHdQuality*/ true ? 720 : 360};\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.selectedMic)\n\t\t\t{\n\t\t\t\tconstraints.audio = { deviceId: { exact: this.selectedMic } };\n\t\t\t}\n\n\t\t\tnavigator.mediaDevices.getUserMedia(constraints).then(stream => {\n\t\t\t\tthis.gettingVideo = false;\n\t\t\t\tthis.setLocalStream(stream);\n\t\t\t\tif (stream.getVideoTracks().length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.playLocalVideo();\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\tthis.gettingVideo = false;\n\t\t\t\tLogger.warn('Getting video from camera error', error);\n\t\t\t\tthis.noVideo = true;\n\t\t\t\tthis.getApplication().setCameraState(false);\n\t\t\t});\n\t\t},\n\t\tsetLocalStream(stream)\n\t\t{\n\t\t\tthis.mediaStream = stream;\n\t\t\tthis.getApplication().setLocalVideoStream(this.mediaStream);\n\t\t},\n\t\tplayLocalVideo()\n\t\t{\n\t\t\tLogger.warn('playing local video');\n\t\t\tthis.noVideo = false;\n\t\t\tthis.userDisabledCamera = false;\n\t\t\tthis.getApplication().setCameraState(true);\n\t\t\tthis.$refs['video'].volume = 0;\n\t\t\tthis.$refs['video'].srcObject = this.mediaStream;\n\t\t\tthis.$refs['video'].play();\n\t\t},\n\t\tstopLocalVideo()\n\t\t{\n\t\t\tif(!this.mediaStream)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.mediaStream.getTracks().forEach(tr => tr.stop());\n\t\t\tthis.mediaStream = null;\n\t\t\tthis.getApplication().stopLocalVideoStream();\n\t\t},\n\t\tonCameraSelected(cameraId)\n\t\t{\n\t\t\tthis.stopLocalVideo();\n\t\t\tthis.selectedCamera = cameraId;\n\t\t\tthis.getLocalStream();\n\t\t},\n\t\tonMicSelected(micId)\n\t\t{\n\t\t\t/*this.stopLocalVideo();\n\t\t\tthis.selectedMic = micId;\n\t\t\tthis.getLocalStream();*/\n\t\t},\n\t\tonCameraStateChange(state)\n\t\t{\n\t\t\tif (state)\n\t\t\t{\n\t\t\t\tthis.noVideo = false;\n\t\t\t\tthis.getLocalStream();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.stopLocalVideo();\n\t\t\t\tthis.userDisabledCamera = true;\n\t\t\t\tthis.noVideo = true;\n\t\t\t\tthis.getApplication().setCameraState(false);\n\t\t\t}\n\t\t},\n\t\tonMicStateChange(state)\n\t\t{\n\t\t\tif (state)\n\t\t\t{\n\t\t\t\tthis.getLocalStream();\n\t\t\t}\n\n\t\t\tthis.showMic = state;\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn Utils.device.isMobile();\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t},\n\tcomponents:\n\t\t{ MicLevel },\n\ttemplate: `\n\t<div class=\"bx-im-component-call-device-check-container\">\n\t\t<div class=\"bx-im-component-call-check-devices\">\n\t\t\t<div v-show=\"noVideo\">\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-no-video\">\n\t\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-no-video-icon\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-no-video-text\">{{ noVideoText }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show=\"!noVideo\">\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-video-container\">\n\t\t\t\t\t<video :class=\"cameraVideoClasses\" ref=\"video\" muted autoplay playsinline></video>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t<mic-level v-show=\"showMic\" :localStream=\"mediaStream\"/>\n\t\t\t</template>\n\t\t</div>\n\t</div>\n\t`\n};\n\nexport {CheckDevices};","import { BitrixVue } from \"ui.vue\";\nimport { ConferenceErrorCode } from \"im.const\";\nimport { Cookie } from 'im.lib.cookie';\nimport { Utils } from \"im.lib.utils\";\nimport { Vuex } from \"ui.vue.vuex\";\n\nimport 'im.component.call-feedback';\n\nconst Error = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdownloadAppArticleCode: 11387752,\n\t\t\tcallFeedbackSent: false\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\terrorCode()\n\t\t{\n\t\t\treturn this.conference.common.error;\n\t\t},\n\t\tbitrix24only()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.bitrix24only;\n\t\t},\n\t\tdetectIntranetUser()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.detectIntranetUser;\n\t\t},\n\t\tuserLimitReached()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.userLimitReached;\n\t\t},\n\t\tkickedFromCall()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.kickedFromCall;\n\t\t},\n\t\twrongAlias()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.wrongAlias;\n\t\t},\n\t\tconferenceFinished()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.finished;\n\t\t},\n\t\tunsupportedBrowser()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.unsupportedBrowser;\n\t\t},\n\t\tmissingMicrophone()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.missingMicrophone;\n\t\t},\n\t\tunsafeConnection()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.unsafeConnection;\n\t\t},\n\t\tnoSignalFromCamera()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.noSignalFromCamera;\n\t\t},\n\t\tuserLeftCall()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.userLeftCall;\n\t\t},\n\t\tshowFeedback()\n\t\t{\n\t\t\tconsole.warn('this.$Bitrix.Application.get()', this.$Bitrix.Application.get());\n\t\t\tconsole.warn('this.$Bitrix.Application.get().showFeedback', this.$Bitrix.Application.get().showFeedback);\n\t\t\treturn this.$Bitrix.Application.get().showFeedback;\n\t\t},\n\t\tcallDetails()\n\t\t{\n\t\t\tconsole.warn('this.$Bitrix.Application.get().callDetails', this.$Bitrix.Application.get().callDetails);\n\t\t\treturn this.$Bitrix.Application.get().callDetails;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\treloadPage()\n\t\t{\n\t\t\tlocation.reload();\n\t\t},\n\t\tredirectToAuthorize()\n\t\t{\n\t\t\tlocation.href = location.origin + '/auth/?backurl=' + location.pathname;\n\t\t},\n\t\tcontinueAsGuest()\n\t\t{\n\t\t\tCookie.set(null, `VIDEOCONF_GUEST_${this.conference.common.alias}`, '', {path: '/'});\n\t\t\tlocation.reload(true);\n\t\t},\n\t\tgetBxLink()\n\t\t{\n\t\t\treturn `bx://videoconf/code/${this.$Bitrix.Application.get().getAlias()}`;\n\t\t},\n\t\topenHelpArticle()\n\t\t{\n\t\t\tif (BX.Helper)\n\t\t\t{\n\t\t\t\tBX.Helper.show(\"redirect=detail&code=\" + this.downloadAppArticleCode);\n\t\t\t}\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn Utils.device.isMobile();\n\t\t},\n\t\tonFeedbackSent()\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.callFeedbackSent = true;\n\t\t\t}, 1500);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-error-wrap\">\n\t\t\t<template v-if=\"bitrix24only\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-b24only\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_B24_ONLY'] }}</div>\n\t\t\t\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t\t\t\t<a @click.prevent=\"openHelpArticle\" class=\"bx-im-component-call-error-more-link\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_CREATE_OWN'] }}</a>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"detectIntranetUser\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-intranet\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_PLEASE_LOG_IN'] }}</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-buttons\">\n\t\t\t\t\t\t\t<button @click=\"redirectToAuthorize\" class=\"ui-btn ui-btn-sm ui-btn-primary bx-im-component-call-error-button-authorize\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_AUTHORIZE'] }}</button>\n\t\t\t\t\t\t\t<button @click=\"continueAsGuest\" class=\"ui-btn ui-btn-sm bx-im-component-call-error-button-as-guest\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_AS_GUEST'] }}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"userLimitReached\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-full\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_USER_LIMIT'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"kickedFromCall\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-kicked\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_KICKED'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"wrongAlias || conferenceFinished\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-finished\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_FINISHED'] }}</div>\n\t\t\t\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t\t\t\t<a @click.prevent=\"openHelpArticle\" class=\"bx-im-component-call-error-more-link\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_CREATE_OWN'] }}</a>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"unsupportedBrowser\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-browser\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_UNSUPPORTED_BROWSER'] }}</div>\n\t\t\t\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t\t\t\t<a @click.prevent=\"openHelpArticle\" class=\"bx-im-component-call-error-more-link\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_DETAILS'] }}</a>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"missingMicrophone\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_NO_MIC'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"unsafeConnection\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-https\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_NO_HTTPS'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"noSignalFromCamera\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_NO_SIGNAL_FROM_CAMERA'] }}</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-buttons\">\n\t\t\t\t\t\t\t<button @click=\"reloadPage\" class=\"ui-btn ui-btn-sm ui-btn-no-caps\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_RELOAD'] }}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"userLeftCall\">\n\t\t\t\t<template v-if=\"!callFeedbackSent && showFeedback\">\n\t\t\t\t\t<bx-im-component-call-feedback @feedbackSent=\"onFeedbackSent\" :callDetails=\"callDetails\" :darkMode=\"true\"/>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_USER_LEFT_THE_CALL'] }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t</div>\n\t`\n};\n\nexport {Error};","const OrientationDisabled = {\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-orientation-disabled-wrap\">\n\t\t\t<div class=\"bx-im-component-call-orientation-disabled-icon\"></div>\n\t\t\t<div class=\"bx-im-component-call-orientation-disabled-text\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_ROTATE_DEVICE') }}\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {OrientationDisabled};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\nimport { EventEmitter } from \"main.core.events\";\nimport { EventType } from \"im.const\";\n\nconst PasswordCheck = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpassword: '',\n\t\t\tcheckingPassword: '',\n\t\t\twrongPassword: ''\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.conference.setPasswordFocus, this.onSetPasswordFocus);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.conference.setPasswordFocus, this.onSetPasswordFocus);\n\t},\n\tcomputed:\n\t{\n\t\tconferenceTitle()\n\t\t{\n\t\t\treturn this.conference.common.conferenceTitle;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonSetPasswordFocus()\n\t\t{\n\t\t\tthis.$refs['passwordInput'].focus();\n\t\t},\n\t\tcheckPassword()\n\t\t{\n\t\t\tif (!this.password || this.checkingPassword)\n\t\t\t{\n\t\t\t\tthis.wrongPassword = true;\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.checkingPassword = true;\n\t\t\tthis.wrongPassword = false;\n\t\t\tthis.getApplication().checkPassword(this.password)\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.wrongPassword = true;\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.checkingPassword = false;\n\t\t\t\t});\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"bx-im-component-call-info-container\">\n\t\t\t\t<div class=\"bx-im-component-call-info-logo\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-info-title\">{{ conferenceTitle }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-component-call-password-container\">\n\t\t\t\t<template v-if=\"wrongPassword\">\n\t\t\t\t\t<div class=\"bx-im-component-call-password-error\">\n\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_PASSWORD_WRONG'] }}\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-im-component-call-password-title\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-password-title-logo\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-password-title-text\">\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_PASSWORD_TITLE'] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<input\n\t\t\t\t\t@keyup.enter=\"checkPassword\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tv-model=\"password\"\n\t\t\t\t\tclass=\"bx-im-component-call-password-input\"\n\t\t\t\t\t:placeholder=\"localize['BX_IM_COMPONENT_CALL_PASSWORD_PLACEHOLDER']\"\n\t\t\t\t\tref=\"passwordInput\"\n\t\t\t\t/>\n\t\t\t\t<button @click=\"checkPassword\" class=\"ui-btn ui-btn-sm ui-btn-primary bx-im-component-call-password-button\">\n\t\t\t  \t\t{{ localize['BX_IM_COMPONENT_CALL_PASSWORD_JOIN'] }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {PasswordCheck};","import { BitrixVue } from \"ui.vue\";\n\nconst LoadingStatus = {\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-loading\">\n\t\t\t<div class=\"bx-im-component-call-loading-text\">{{ localize['BX_IM_COMPONENT_CALL_LOADING'] }}</div>\n\t\t</div>\n\t`\n};\n\nexport {LoadingStatus};","import { BitrixVue } from \"ui.vue\";\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\nimport { EventEmitter } from \"main.core.events\";\nimport { EventType } from \"im.const\";\n\nconst NOT_ALLOWED_ERROR_CODE = 'NotAllowedError';\nconst NOT_FOUND_ERROR_CODE = 'NotFoundError';\n\nconst RequestPermissions = {\n\tprops: {\n\t\tskipRequest: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.conference.requestPermissions, this.onRequestPermissions);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.conference.requestPermissions, this.onRequestPermissions);\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonRequestPermissions()\n\t\t{\n\t\t\tthis.requestPermissions();\n\t\t},\n\t\trequestPermissions()\n\t\t{\n\t\t\tthis.getApplication().initHardware().then(() => {\n\t\t\t\treturn navigator.mediaDevices.getUserMedia({audio: true, video: true});\n\t\t\t}).then(() => {\n\t\t\t\tthis.setPermissionsRequestedFlag();\n\t\t\t}).catch((error) => {\n\t\t\t\tif (error.name === NOT_ALLOWED_ERROR_CODE)\n\t\t\t\t{\n\t\t\t\t\tthis.showMessageBox(this.localize['BX_IM_COMPONENT_CALL_NOT_ALLOWED_ERROR']);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse if (error.name === NOT_FOUND_ERROR_CODE)\n\t\t\t\t{\n\t\t\t\t\t// means there is no camera, request only microphone\n\t\t\t\t\treturn navigator.mediaDevices.getUserMedia({audio: true, video: false}).then(() => {\n\t\t\t\t\t\tthis.setPermissionsRequestedFlag();\n\t\t\t\t\t}).catch((error) => {\n\t\t\t\t\t\tif (error.name === NOT_ALLOWED_ERROR_CODE)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.showMessageBox(this.localize['BX_IM_COMPONENT_CALL_NOT_ALLOWED_ERROR']);\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.showMessageBox(this.localize['BX_IM_COMPONENT_CALL_HARDWARE_ERROR']);\n\t\t\t});\n\t\t},\n\t\tsetPermissionsRequestedFlag()\n\t\t{\n\t\t\tthis.$nextTick(() => this.$store.dispatch('conference/setPermissionsRequested', {status: true}));\n\t\t},\n\t\tshowMessageBox(text)\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tmessage: text,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK\n\t\t\t});\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-permissions-container\">\n\t\t\t<template v-if=\"!skipRequest\">\n\t\t\t\t<div class=\"bx-im-component-call-permissions-text\">{{ localize['BX_IM_COMPONENT_CALL_PERMISSIONS_TEXT'] }}</div>\n\t\t\t\t<button @click=\"requestPermissions\" class=\"ui-btn ui-btn-sm ui-btn-primary bx-im-component-call-permissions-button\">\n\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_ENABLE_DEVICES_BUTTON'] }}\n\t\t\t\t</button>\n\t\t\t\t<slot></slot>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-im-component-call-permissions-text\">{{ localize['BX_IM_COMPONENT_CALL_PERMISSIONS_LOADING'] }}</div>\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-wait bx-im-component-call-permissions-button\">\n\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_PERMISSIONS_BUTTON'] }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</div>\n\t`\n};\n\nexport {RequestPermissions};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\n\nconst MobileChatButton = {\n\tcomputed:\n\t{\n\t\tdialogCounter()\n\t\t{\n\t\t\tif (this.dialog)\n\t\t\t{\n\t\t\t\treturn this.dialog.counter;\n\t\t\t}\n\t\t},\n\t\tuserCounter()\n\t\t{\n\t\t\treturn this.conference.common.userCount;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\topenChat()\n\t\t{\n\t\t\tthis.getApplication().toggleChat();\n\t\t},\n\t\topenUserList()\n\t\t{\n\t\t\tthis.getApplication().toggleUserList();\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-open-chat-button-container\">\n\t\t\t<div @click=\"openChat\" class=\"ui-btn ui-btn-sm ui-btn-icon-chat bx-im-component-call-open-chat-button\">\n\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_OPEN_CHAT'] }}\n\t\t\t\t<div v-if=\"dialogCounter > 0\" class=\"bx-im-component-call-open-chat-button-counter\">{{ dialogCounter }}</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div @click=\"openUserList\" class=\"ui-btn ui-btn-sm ui-btn-icon-chat bx-im-component-call-open-user-list-button\">\n\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_OPEN_USER_LIST'] }}\n\t\t\t\t<div class=\"bx-im-component-call-open-chat-button-counter\">{{ userCounter }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {MobileChatButton};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\n\nconst ConferenceInfo = {\n\tprops: {\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tconferenceDuration: '',\n\t\t\tdurationInterval: null\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tif (this.conferenceStarted)\n\t\t{\n\t\t\tthis.updateConferenceDuration();\n\t\t\tthis.durationInterval = setInterval(() => {\n\t\t\t\tthis.updateConferenceDuration();\n\t\t\t}, 1000);\n\t\t}\n\t},\n\tbeforeDestroy()\n\t{\n\t\tclearInterval(this.durationInterval);\n\t},\n\tcomputed:\n\t{\n\t\tconferenceStarted()\n\t\t{\n\t\t\treturn this.conference.common.conferenceStarted;\n\t\t},\n\t\tconferenceStartDate()\n\t\t{\n\t\t\treturn this.conference.common.conferenceStartDate;\n\t\t},\n\t\tconferenceTitle()\n\t\t{\n\t\t\treturn this.conference.common.conferenceTitle;\n\t\t},\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn this.conference.common.presenters;\n\t\t},\n\t\tpresentersInfo()\n\t\t{\n\t\t\treturn this.$store.getters['users/getList'](this.presentersList);\n\t\t},\n\t\tformattedPresentersList()\n\t\t{\n\t\t\tconst presentersCount = this.presentersList.length;\n\t\t\tconst prefix = presentersCount > 1 ? this.localize['BX_IM_COMPONENT_CALL_SPEAKERS_MULTIPLE'] : this.localize['BX_IM_COMPONENT_CALL_SPEAKER'];\n\t\t\tconst presenters = this.presentersInfo.map(user => user.name).join(', ');\n\n\t\t\treturn `${prefix}: ${presenters}`;\n\t\t},\n\t\tisCurrentUserPresenter()\n\t\t{\n\t\t\treturn this.presentersList.includes(this.userId);\n\t\t},\n\t\tconferenceStatusText()\n\t\t{\n\t\t\tif (this.conferenceStarted === true)\n\t\t\t{\n\t\t\t\treturn `${this.localize['BX_IM_COMPONENT_CALL_STATUS_STARTED']}, ${this.conferenceDuration}`;\n\t\t\t}\n\t\t\telse if (this.conferenceStarted === false)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_STATUS_NOT_STARTED'];\n\t\t\t}\n\t\t\telse if (this.conferenceStarted === null)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_STATUS_LOADING'];\n\t\t\t}\n\t\t},\n\t\tconferenceStatusClasses()\n\t\t{\n\t\t\treturn [\n\t\t\t\t'bx-im-component-call-info-status',\n\t\t\t\tthis.conferenceStarted? 'bx-im-component-call-info-status-active' : 'bx-im-component-call-info-status-not-active'\n\t\t\t];\n\t\t},\n\t\tcontainerClasses()\n\t\t{\n\t\t\treturn [this.compactMode? 'bx-im-component-call-info-container-compact' : 'bx-im-component-call-info-container'];\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tconferenceStarted(newValue)\n\t\t{\n\t\t\tif (newValue === true)\n\t\t\t{\n\t\t\t\tthis.durationInterval = setInterval(() => {\n\t\t\t\t\tthis.updateConferenceDuration();\n\t\t\t\t}, 1000);\n\t\t\t}\n\n\t\t\tthis.updateConferenceDuration();\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tupdateConferenceDuration()\n\t\t{\n\t\t\tif (!this.conferenceStartDate)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst startDate = this.conferenceStartDate;\n\t\t\tconst currentDate = new Date();\n\n\t\t\tlet durationInSeconds = Math.floor((currentDate - startDate) / 1000);\n\t\t\tlet minutes = 0;\n\t\t\tif (durationInSeconds > 60)\n\t\t\t{\n\t\t\t\tminutes = Math.floor(durationInSeconds / 60);\n\t\t\t\tif (minutes < 10)\n\t\t\t\t{\n\t\t\t\t\tminutes = '0' + minutes;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet seconds = durationInSeconds - (minutes * 60);\n\t\t\tif (seconds < 10)\n\t\t\t{\n\t\t\t\tseconds = '0' + seconds;\n\t\t\t}\n\t\t\tthis.conferenceDuration = `${minutes}:${seconds}`;\n\n\t\t\treturn true;\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :class=\"containerClasses\">\n\t\t\t<template v-if=\"compactMode\">\n\t\t\t\t<div class=\"bx-im-component-call-info-title-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-info-logo\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-info-title\">{{ conferenceTitle }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isBroadcast\" class=\"bx-im-component-call-info-speakers\">{{ formattedPresentersList }}</div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-im-component-call-info-logo\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-info-title\">{{ conferenceTitle }}</div>\n\t\t\t  \t<div v-if=\"isBroadcast\" class=\"bx-im-component-call-info-speakers\">{{ formattedPresentersList }}</div>\t\n\t\t\t</template>\n\t\t\t<div :class=\"conferenceStatusClasses\">{{ conferenceStatusText }}</div>\n\t\t</div>\n\t`\n};\n\nexport {ConferenceInfo};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\nimport { Utils } from \"im.lib.utils\";\nimport { EventEmitter } from \"main.core.events\";\nimport { EventType } from \"im.const\";\nimport { Logger } from \"im.lib.logger\";\n\nconst UserForm = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tuserNewName: ''\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tconferenceStarted()\n\t\t{\n\t\t\treturn this.conference.common.conferenceStarted;\n\t\t},\n\t\tuserHasRealName()\n\t\t{\n\t\t\tif (this.user)\n\t\t\t{\n\t\t\t\treturn this.user.name !== this.localize['BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME'];\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tintranetAvatarStyle()\n\t\t{\n\t\t\tif (this.user && !this.user.extranet && this.user.avatar)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tbackgroundImage: `url('${this.user.avatar}')`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tlogoutLink()\n\t\t{\n\t\t\treturn `${this.publicLink}?logout=yes&sessid=${BX.bitrix_sessid()}`;\n\t\t},\n\t\tpublicLink()\n\t\t{\n\t\t\tif (this.dialog)\n\t\t\t{\n\t\t\t\treturn this.dialog.public.link;\n\t\t\t}\n\t\t},\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn this.conference.common.presenters;\n\t\t},\n\t\tisCurrentUserPresenter()\n\t\t{\n\t\t\treturn this.presentersList.includes(this.userId);\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\tvideoModeButtonClasses()\n\t\t{\n\t\t\tconst classes = ['ui-btn', 'ui-btn-sm', 'ui-btn-primary', 'bx-im-component-call-join-video'];\n\n\t\t\tif (!this.getApplication().hardwareInited)\n\t\t\t{\n\t\t\t\tclasses.push('ui-btn-disabled');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\taudioModeButtonClasses()\n\t\t{\n\t\t\tconst classes = ['ui-btn', 'ui-btn-sm', 'bx-im-component-call-join-audio'];\n\n\t\t\tif (!this.getApplication().hardwareInited)\n\t\t\t{\n\t\t\t\tclasses.push('ui-btn-disabled');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tstartConference({ video })\n\t\t{\n\t\t\tthis.getApplication().startCall(video);\n\t\t},\n\t\tjoinConference({ video })\n\t\t{\n\t\t\tif (this.user.extranet && !this.userHasRealName)\n\t\t\t{\n\t\t\t\tthis.setNewName();\n\t\t\t}\n\n\t\t\tif (!this.conferenceStarted)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.conference.waitForStart);\n\n\t\t\t\tthis.getApplication().setUserReadyToJoin();\n\t\t\t\tthis.getApplication().setJoinType(video);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst viewerMode = this.isBroadcast && !this.isCurrentUserPresenter;\n\t\t\t\tLogger.warn('ready to join call', video, viewerMode);\n\t\t\t\tif (viewerMode)\n\t\t\t\t{\n\t\t\t\t\tthis.getApplication().joinCall(this.getApplication().preCall.id, {\n\t\t\t\t\t\tjoinAsViewer: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getApplication().startCall(video);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetNewName()\n\t\t{\n\t\t\tif (this.userNewName.length > 0)\n\t\t\t{\n\t\t\t\tthis.getApplication().renameGuest(this.userNewName.trim());\n\t\t\t}\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t\tisDesktop()\n\t\t{\n\t\t\treturn Utils.platform.isBitrixDesktop();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-form\">\n\t\t\t<template v-if=\"user && userHasRealName\">\n\t\t\t\t<template v-if=\"!user.extranet\">\n\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-container\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-title\">\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_INTRANET_NAME_TITLE'] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-content\">\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-content-left\">\n\t\t\t\t\t\t\t\t<div :style=\"intranetAvatarStyle\" class=\"bx-im-component-call-intranet-name-avatar\"></div>\n\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-text\">{{ user.name }}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<template v-if=\"!isDesktop()\">\n\t\t\t\t\t\t\t\t<a :href=\"logoutLink\" class=\"bx-im-component-call-intranet-name-logout\">\n\t\t\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_INTRANET_LOGOUT'] }}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if=\"user.extranet\">\n\t\t\t\t\t<div class=\"bx-im-component-call-guest-name-container\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-guest-name-text\">{{ user.name }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t\t<!-- New guest, need to specify name -->\n\t\t\t<template v-else-if=\"user && !userHasRealName\">\n\t\t\t\t<input\n\t\t\t\t\tv-model=\"userNewName\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t:placeholder=\"localize['BX_IM_COMPONENT_CALL_NAME_PLACEHOLDER']\"\n\t\t\t\t\tclass=\"bx-im-component-call-name-input\"\n\t\t\t\t\tref=\"nameInput\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<!-- Buttons -->\n\t\t\t<template v-if=\"user\">\n\t\t\t\t<!-- Broadcast mode -->\n\t\t\t\t<template v-if=\"isBroadcast\">\n\t\t\t\t\t<!-- Speaker can start conference -->\n\t\t\t\t\t<template v-if=\"isCurrentUserPresenter && !conferenceStarted\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<!-- Speakers can join with audio/video -->\n\t\t\t\t\t<template v-else-if=\"conferenceStarted && isCurrentUserPresenter\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<!-- Others can join as viewers -->\n\t\t\t\t\t<template v-else-if=\"!isCurrentUserPresenter\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: false})\"\n\t\t\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-primary bx-im-component-call-join-video\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<!-- End broadcast mode -->\n\t\t\t\t<template v-else-if=\"!isBroadcast\">\n\t\t\t\t\t<!-- Intranet user can start conference -->\n\t\t\t\t\t<template v-if=\"!user.extranet && !conferenceStarted\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<!-- Others can join -->\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t\t<!--End normal (not broadcast) mode-->\n\t\t</div>\n\t`\n};\n\nexport {UserForm};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\nimport { Utils } from \"im.lib.utils\";\nimport { Desktop } from \"im.lib.desktop\";\n\nconst ChatHeader = {\n\tcreated()\n\t{\n\t\tthis.desktop = new Desktop();\n\t},\n\tcomputed:\n\t{\n\t\tshowTotalCounter()\n\t\t{\n\t\t\treturn Utils.platform.isBitrixDesktop()\n\t\t\t\t&& (this.desktop.getApiVersion() >= 60 || !Utils.platform.isWindows())\n\t\t\t\t&& !this.getApplication().isExternalUser()\n\t\t\t\t&& this.messageCount > 0;\n\t\t},\n\t\tmessageCount()\n\t\t{\n\t\t\treturn this.conference.common.messageCount;\n\t\t},\n\t\tformattedCounter()\n\t\t{\n\t\t\treturn this.messageCount > 99 ? '99+' : this.messageCount;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonCloseChat()\n\t\t{\n\t\t\tthis.getApplication().toggleChat();\n\t\t},\n\t\tonTotalCounterClick()\n\t\t{\n\t\t\tif (opener && opener.BXDesktopWindow)\n\t\t\t{\n\t\t\t\topener.BXDesktopWindow.ExecuteCommand('show.active');\n\t\t\t}\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-right-header\">\n\t\t\t<div class=\"bx-im-component-call-right-header-left\">\n\t\t\t\t<div @click=\"onCloseChat\" class=\"bx-im-component-call-right-header-close\" :title=\"localize['BX_IM_COMPONENT_CALL_CHAT_CLOSE_TITLE']\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-right-header-title\">{{ localize['BX_IM_COMPONENT_CALL_CHAT_TITLE'] }}</div>\n\t\t\t</div>\n\t\t\t<template v-if=\"showTotalCounter\">\n\t\t\t\t<div @click=\"onTotalCounterClick\" class=\"bx-im-component-call-right-header-right bx-im-component-call-right-header-all-chats\">\n\t\t\t\t\t<div class=\"bx-im-component-call-right-header-all-chats-title\">{{ localize['BX_IM_COMPONENT_CALL_ALL_CHATS'] }}</div>\n\t\t\t\t\t<div class=\"bx-im-component-call-right-header-all-chats-counter\">{{ messageCount }}</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n};\n\nexport {ChatHeader};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\n\nconst WaitingForStart = {\n\tcomputed:\n\t{\n\t\tuserCounter()\n\t\t{\n\t\t\treturn this.dialog.userCounter;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-wait-container\">\n\t\t\t<div class=\"bx-im-component-call-wait-logo\"></div>\n\t\t\t<div class=\"bx-im-component-call-wait-title\">{{ localize['BX_IM_COMPONENT_CALL_WAIT_START_TITLE'] }}</div>\n\t\t\t<div class=\"bx-im-component-call-wait-user-counter\">\n\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_WAIT_START_USER_COUNT'] }} {{ userCounter }}\n\t\t\t</div>\n\t\t\t<slot></slot>\n\t\t</div>\n\t`\n};\n\nexport {WaitingForStart};","import { Vuex } from \"ui.vue.vuex\";\nimport { Utils } from \"im.lib.utils\";\nimport { MenuManager } from \"main.popup\";\nimport { ConferenceUserState, ConferenceStateType, EventType } from 'im.const';\nimport { EventEmitter } from \"main.core.events\";\n\nconst UserListItem = {\n\tprops: {\n\t\tuserId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata: function() {\n\t\treturn {\n\t\t\trenameMode: false,\n\t\t\tnewName: '',\n\t\t\trenameRequested: false,\n\t\t\tmenuId: 'bx-messenger-context-popup-external-data',\n\t\t\tonlineStates: [ConferenceUserState.Ready, ConferenceUserState.Connected]\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tuser()\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.userId, true);\n\t\t},\n\t\t// statuses\n\t\tcurrentUser()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tchatOwner()\n\t\t{\n\t\t\tif (!this.dialog)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\treturn this.dialog.ownerId;\n\t\t},\n\t\tisCurrentUserOwner()\n\t\t{\n\t\t\treturn this.chatOwner === this.currentUser;\n\t\t},\n\t\tisCurrentUserExternal()\n\t\t{\n\t\t\treturn !!this.conference.user.hash;\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn Utils.device.isMobile();\n\t\t},\n\t\tisDesktop()\n\t\t{\n\t\t\treturn Utils.platform.isBitrixDesktop();\n\t\t},\n\t\tisGuestWithDefaultName()\n\t\t{\n\t\t\tconst guestDefaultName = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME');\n\n\t\t\treturn this.user.id === this.currentUser && this.user.extranet && this.user.name === guestDefaultName;\n\t\t},\n\t\tuserCallStatus()\n\t\t{\n\t\t\treturn this.$store.getters['call/getUser'](this.user.id);\n\t\t},\n\t\tisUserInCall()\n\t\t{\n\t\t\treturn this.onlineStates.includes(this.userCallStatus.state);\n\t\t},\n\t\tuserInCallCount()\n\t\t{\n\t\t\tconst usersInCall = Object.values(this.call.users).filter(user => {\n\t\t\t\treturn this.onlineStates.includes(user.state);\n\t\t\t});\n\n\t\t\treturn usersInCall.length;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn this.conference.common.presenters;\n\t\t},\n\t\tisUserPresenter()\n\t\t{\n\t\t\treturn this.presentersList.includes(this.user.id);\n\t\t},\n\t\t// end statuses\n\t\tformattedSubtitle()\n\t\t{\n\t\t\tconst subtitles = [];\n\n\t\t\tif (this.user.id === this.chatOwner)\n\t\t\t{\n\t\t\t\tsubtitles.push(this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_STATUS_OWNER'));\n\t\t\t}\n\n\t\t\tif (this.user.id === this.currentUser)\n\t\t\t{\n\t\t\t\tsubtitles.push(this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_STATUS_CURRENT_USER'));\n\t\t\t}\n\n\t\t\t// if (!this.user.extranet && !this.user.isOnline)\n\t\t\t// {\n\t\t\t// \tsubtitles.push(this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_STATUS_OFFLINE'));\n\t\t\t// }\n\n\t\t\treturn subtitles.join(', ');\n\t\t},\n\t\tisMenuNeeded()\n\t\t{\n\t\t\treturn this.getMenuItems.length > 0;\n\t\t},\n\t\tmenuItems()\n\t\t{\n\t\t\tconst items = [];\n\t\t\t// for self\n\t\t\tif (this.user.id === this.currentUser)\n\t\t\t{\n\t\t\t\t// self-rename\n\t\t\t\tif (this.isCurrentUserExternal)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_RENAME_SELF'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.onRenameStart();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// change background\n\t\t\t\tif (this.isDesktop)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_CHANGE_BACKGROUND'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userChangeBackground');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// for other users\n\t\t\telse\n\t\t\t{\n\t\t\t\t// force-rename\n\t\t\t\tif (this.isCurrentUserOwner && this.user.externalAuthId === 'call')\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_RENAME'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.onRenameStart();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// kick\n\t\t\t\tif (this.isCurrentUserOwner && !this.isUserPresenter)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_KICK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userKick', {user: this.user});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (this.isUserInCall && this.userCallStatus.cameraState && this.userInCallCount > 2)\n\t\t\t\t{\n\t\t\t\t\t// pin\n\t\t\t\t\tif (!this.userCallStatus.pinned)\n\t\t\t\t\t{\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_PIN'),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\t\tthis.$emit('userPin', {user: this.user});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t// unpin\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_UNPIN'),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\t\tthis.$emit('userUnpin');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t// open 1-1 chat and profile\n\t\t\t\tif (this.isDesktop && !this.user.extranet)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_OPEN_CHAT'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userOpenChat', {user: this.user});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_OPEN_PROFILE'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userOpenProfile', {user: this.user});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// insert name\n\t\t\t\titems.push({\n\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_INSERT_NAME'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\tthis.$emit('userInsertName', {user: this.user});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\t\tavatarWrapClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-avatar-wrap'];\n\n\t\t\tif (this.userCallStatus.talking)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-avatar-wrap-talking');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tavatarClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-avatar'];\n\n\t\t\tif (!this.user.avatar && this.user.extranet)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-avatar-extranet');\n\t\t\t}\n\t\t\telse if (!this.user.avatar && !this.user.extranet)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-avatar-default');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tavatarStyle()\n\t\t{\n\t\t\tconst style = {};\n\n\t\t\tif (this.user.avatar)\n\t\t\t{\n\t\t\t\tstyle.backgroundImage = `url('${this.user.avatar}')`;\n\t\t\t}\n\t\t\telse if (!this.user.avatar && !this.user.extranet)\n\t\t\t{\n\t\t\t\tstyle.backgroundColor = this.user.color;\n\t\t\t}\n\n\t\t\treturn style;\n\t\t},\n\t\tisCallStatusPanelNeeded()\n\t\t{\n\t\t\tif (this.isBroadcast)\n\t\t\t{\n\t\t\t\treturn this.conference.common.state === ConferenceStateType.call && this.isUserInCall && this.isUserPresenter;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.conference.common.state === ConferenceStateType.call && this.isUserInCall;\n\t\t\t}\n\t\t},\n\t\tcallLeftIconClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-icons-icon bx-im-component-call-user-list-item-icons-left'];\n\n\t\t\tif (this.userCallStatus.floorRequestState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-floor-request');\n\t\t\t}\n\t\t\telse if (this.userCallStatus.screenState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-screen');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tcallCenterIconClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-icons-icon bx-im-component-call-user-list-item-icons-center'];\n\n\t\t\tif (this.userCallStatus.microphoneState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-mic-on');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-mic-off');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tcallRightIconClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-icons-icon bx-im-component-call-user-list-item-icons-right'];\n\n\t\t\tif (this.userCallStatus.cameraState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-camera-on');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-camera-off');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tbodyClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-body'];\n\n\t\t\tif (!this.isUserInCall)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-body-offline');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference,\n\t\t\tcall: state => state.call,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\topenMenu()\n\t\t{\n\t\t\tif (this.menuPopup)\n\t\t\t{\n\t\t\t\tthis.closeMenu();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//menu for other items\n\t\t\tconst existingMenu = MenuManager.getMenuById(this.menuId);\n\t\t\tif (existingMenu)\n\t\t\t{\n\t\t\t\texistingMenu.destroy();\n\t\t\t}\n\n\t\t\tthis.menuPopup = MenuManager.create({\n\t\t\t\tid: this.menuId,\n\t\t\t\tbindElement: this.$refs['user-menu'],\n\t\t\t\titems: this.menuItems,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => this.menuPopup.destroy(),\n\t\t\t\t\tonPopupDestroy: () => this.menuPopup = null\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.menuPopup.show();\n\t\t},\n\t\tcloseMenu()\n\t\t{\n\t\t\tthis.menuPopup.destroy();\n\t\t\tthis.menuPopup = null;\n\t\t},\n\t\tonRenameStart()\n\t\t{\n\t\t\tthis.newName = this.user.name;\n\t\t\tthis.renameMode = true;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs['rename-input'].focus();\n\t\t\t\tthis.$refs['rename-input'].select();\n\t\t\t});\n\t\t},\n\t\tonRenameKeyDown(event)\n\t\t{\n\t\t\t//enter\n\t\t\tif (event.keyCode === 13)\n\t\t\t{\n\t\t\t\tthis.changeName();\n\t\t\t}\n\t\t\t//escape\n\t\t\telse if (event.keyCode === 27)\n\t\t\t{\n\t\t\t\tthis.renameMode = false;\n\t\t\t}\n\t\t},\n\t\tchangeName()\n\t\t{\n\t\t\tif (this.user.name === this.newName.trim() || this.newName === '')\n\t\t\t{\n\t\t\t\tthis.renameMode = false;\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$emit('userChangeName', {user: this.user, newName: this.newName});\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.renameMode = false;\n\t\t\t});\n\t\t},\n\t\tonFocus(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.conference.userRenameFocus, event);\n\t\t},\n\t\tonBlur(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.conference.userRenameBlur, event);\n\t\t},\n\t},\n\t//language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-user-list-item\">\n\t\t\t<!-- Avatar -->\n\t\t\t<div :class=\"avatarWrapClasses\">\n\t\t\t\t<div :class=\"avatarClasses\" :style=\"avatarStyle\"></div>\n\t\t\t</div>\n\t\t\t<!-- Body -->\n\t\t\t<div :class=\"bodyClasses\">\n\t\t\t\t<!-- Introduce yourself blinking mode -->\n\t\t\t\t<template v-if=\"!renameMode && isGuestWithDefaultName\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-body-left\">\n\t\t\t\t\t\t<div @click=\"onRenameStart\" class=\"bx-im-component-call-user-list-introduce-yourself\">\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-introduce-yourself-text\">{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_INTRODUCE_YOURSELF') }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<!-- Rename mode -->\n\t\t\t\t<template v-else-if=\"renameMode\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-body-left\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-change-name-container\">\n\t\t\t\t\t\t\t<div @click=\"renameMode = false\" class=\"bx-im-component-call-user-list-change-name-cancel\"></div>\n\t\t\t\t\t\t\t<input @keydown=\"onRenameKeyDown\" @focus=\"onFocus\" @blur=\"onBlur\" v-model=\"newName\" :ref=\"'rename-input'\" type=\"text\" class=\"bx-im-component-call-user-list-change-name-input\">\n\t\t\t\t\t\t\t<div v-if=\"!renameRequested\" @click=\"changeName\" class=\"bx-im-component-call-user-list-change-name-confirm\"></div>\n\t\t\t\t\t\t\t<div v-else class=\"bx-im-component-call-user-list-change-name-loader\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-change-name-loader-icon\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"!renameMode && !isGuestWithDefaultName\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-body-left\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-name-wrap\">\n\t\t\t\t\t\t\t<!-- Name -->\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-name\">{{ user.name }}</div>\n\t\t\t\t\t\t\t<!-- Status subtitle -->\n\t\t\t\t\t\t\t<div v-if=\"formattedSubtitle !== ''\" class=\"bx-im-component-call-user-list-item-name-subtitle\">{{ formattedSubtitle }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!-- Context menu icon -->\n\t\t\t\t\t\t<div v-if=\"menuItems.length > 0 && !isMobile\" @click=\"openMenu\" ref=\"user-menu\" class=\"bx-im-component-call-user-list-item-menu\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"isCallStatusPanelNeeded\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-icons\">\n\t\t\t\t\t\t<div :class=\"callLeftIconClasses\"></div>\n\t\t\t\t\t\t<div :class=\"callCenterIconClasses\"></div>\n\t\t\t\t\t\t<div :class=\"callRightIconClasses\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {UserListItem};","import { Vuex } from \"ui.vue.vuex\";\nimport { Logger } from \"im.lib.logger\";\nimport { EventEmitter } from 'main.core.events';\nimport { EventType } from \"im.const\";\nimport { ConferenceRightPanelMode as RightPanelMode, ConferenceUserState } from 'im.const';\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\n\nimport {UserListItem} from './user-list-item';\n\nconst UserList = {\n\tcomponents: {UserListItem},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tusersPerPage: 50,\n\t\t\tfirstPageLoaded: false,\n\t\t\tpagesLoaded: 0,\n\t\t\thasMoreToLoad: true,\n\t\t\trename: {\n\t\t\t\tuser: 0,\n\t\t\t\tnewName: '',\n\t\t\t\trenameRequested: false\n\t\t\t}\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('Conference: user list created');\n\t\tthis.requestUsers({firstPage: true});\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.loaderObserver = null;\n\t},\n\tcomputed:\n\t{\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tusersList()\n\t\t{\n\t\t\tconst users = this.conference.common.users.filter(user => {\n\t\t\t\treturn !this.presentersList.includes(user);\n\t\t\t});\n\n\t\t\treturn [...users].sort(this.userSortFunction);\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn [...this.conference.common.presenters].sort(this.userSortFunction);\n\t\t},\n\t\trightPanelMode()\n\t\t{\n\t\t\treturn this.conference.common.rightPanelMode;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference,\n\t\t\tcall: state => state.call,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\trequestUsers({firstPage = false} = {})\n\t\t{\n\t\t\tthis.$Bitrix.RestClient.get().callMethod('im.dialog.users.list', {\n\t\t\t\t'DIALOG_ID': this.application.dialog.dialogId,\n\t\t\t\t'LIMIT': this.usersPerPage,\n\t\t\t\t'OFFSET': firstPage? 0 : (this.pagesLoaded * this.usersPerPage)\n\t\t\t}).then(result => {\n\t\t\t\tLogger.warn('Conference: getting next user list result', result.data());\n\t\t\t\tconst users = result.data();\n\t\t\t\tthis.pagesLoaded++;\n\t\t\t\tif (users.length < this.usersPerPage)\n\t\t\t\t{\n\t\t\t\t\tthis.hasMoreToLoad = false;\n\t\t\t\t}\n\n\t\t\t\tthis.$store.dispatch('users/set', users);\n\t\t\t\tconst usersIds = users.map(user => user.id);\n\n\t\t\t\treturn this.$store.dispatch('conference/setUsers', { users: usersIds });\n\t\t\t}).then(() => {\n\t\t\t\tif (firstPage)\n\t\t\t\t{\n\t\t\t\t\tthis.firstPageLoaded = true;\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tLogger.warn('Conference: error getting users list', result.error().ex);\n\t\t\t});\n\t\t},\n\t\tonUserMenuKick({user})\n\t\t{\n\t\t\tthis.showUserKickConfirm(user);\n\t\t},\n\t\tshowUserKickConfirm(user)\n\t\t{\n\t\t\tif (this.userKickConfirm)\n\t\t\t{\n\t\t\t\tthis.userKickConfirm.close();\n\t\t\t}\n\n\t\t\tlet confirmMessage = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_KICK_INTRANET_USER_CONFIRM_TEXT');\n\t\t\tif (user.extranet)\n\t\t\t{\n\t\t\t\tconfirmMessage = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_KICK_GUEST_USER_CONFIRM_TEXT');\n\t\t\t}\n\t\t\tthis.userKickConfirm = MessageBox.create({\n\t\t\t\tmessage: confirmMessage,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tonOk: () => {\n\t\t\t\t\tthis.kickUser(user);\n\t\t\t\t\tthis.userKickConfirm.close();\n\t\t\t\t},\n\t\t\t\tonCancel: () => {\n\t\t\t\t\tthis.userKickConfirm.close();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.userKickConfirm.show();\n\t\t},\n\t\tkickUser(user)\n\t\t{\n\t\t\tthis.$store.dispatch('conference/removeUsers', { users: [user.id] });\n\t\t\tthis.$Bitrix.RestClient.get().callMethod('im.chat.user.delete', {\n\t\t\t\tuser_id: user.id,\n\t\t\t\tchat_id: this.application.dialog.chatId\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.error('Conference: removing user from chat error', error);\n\t\t\t\tthis.$store.dispatch('conference/setUsers', { users: [user.id] });\n\t\t\t});\n\t\t},\n\t\tonUserMenuInsertName({user})\n\t\t{\n\t\t\tif (this.rightPanelMode === RightPanelMode.hidden || this.rightPanelMode === RightPanelMode.users)\n\t\t\t{\n\t\t\t\tthis.getApplication().toggleChat();\n\t\t\t}\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: `${user.name}, `, focus: true});\n\t\t\t});\n\t\t},\n\t\tonUserChangeName({user, newName})\n\t\t{\n\t\t\tconst method = user.id === this.userId ? 'im.call.user.update' : 'im.call.user.force.rename';\n\n\t\t\tconst oldName = user.name;\n\t\t\tthis.$store.dispatch('users/update', {\n\t\t\t\tid: user.id,\n\t\t\t\tfields: {name: newName, lastActivityDate: new Date()}\n\t\t\t});\n\t\t\tthis.$Bitrix.RestClient.get().callMethod(method, {\n\t\t\t\tname: newName,\n\t\t\t\tchat_id: this.application.dialog.chatId,\n\t\t\t\tuser_id: user.id\n\t\t\t}).then(() => {\n\t\t\t\tLogger.warn('Conference: rename completed', user.id, newName);\n\t\t\t\tif (oldName === this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME'))\n\t\t\t\t{\n\t\t\t\t\tthis.getApplication().setUserWasRenamed();\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.error('Conference: renaming error', error);\n\t\t\t\tthis.$store.dispatch('users/update', {\n\t\t\t\t\tid: user.id,\n\t\t\t\t\tfields: {name: oldName, lastActivityDate: new Date()}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonUserMenuPin({user})\n\t\t{\n\t\t\tthis.getApplication().pinUser(user);\n\t\t},\n\t\tonUserMenuUnpin()\n\t\t{\n\t\t\tthis.getApplication().unpinUser();\n\t\t},\n\t\tonUserMenuChangeBackground()\n\t\t{\n\t\t\tthis.getApplication().changeBackground();\n\t\t},\n\t\tonUserMenuOpenChat({user})\n\t\t{\n\t\t\tthis.getApplication().openChat(user);\n\t\t},\n\t\tonUserMenuOpenProfile({user})\n\t\t{\n\t\t\tthis.getApplication().openProfile(user);\n\t\t},\n\t\t// Helpers\n\t\tgetLoaderObserver()\n\t\t{\n\t\t\tconst options = {\n\t\t\t\troot: document.querySelector('.bx-im-component-call-right-users'),\n\t\t\t\tthreshold: 0.01\n\t\t\t};\n\n\t\t\tconst callback = (entries, observer) => {\n\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\tif (entry.isIntersecting && entry.intersectionRatio > 0.01)\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('Conference: UserList: I see loader! Load next page!');\n\t\t\t\t\t\tthis.requestUsers();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t};\n\n\t\t\treturn new IntersectionObserver(callback, options);\n\t\t},\n\t\tuserSortFunction(userA, userB)\n\t\t{\n\t\t\tif (userA === this.userId)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (userB === this.userId)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (this.call.users[userA] && (this.call.users[userA].floorRequestState || this.call.users[userA].screenState))\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (this.call.users[userB] && (this.call.users[userB].floorRequestState || this.call.users[userB].screenState))\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (this.call.users[userA] && [ConferenceUserState.Ready, ConferenceUserState.Connected].includes(this.call.users[userA].state))\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (this.call.users[userB] && [ConferenceUserState.Ready, ConferenceUserState.Connected].includes(this.call.users[userB].state))\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\tdirectives:\n\t{\n\t\t'bx-im-directive-user-list-observer':\n\t\t\t{\n\t\t\t\tinserted(element, bindings, vnode)\n\t\t\t\t{\n\t\t\t\t\tvnode.context.loaderObserver = vnode.context.getLoaderObserver();\n\t\t\t\t\tvnode.context.loaderObserver.observe(element);\n\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tunbind(element, bindings, vnode)\n\t\t\t\t{\n\t\t\t\t\tif (vnode.context.loaderObserver)\n\t\t\t\t\t{\n\t\t\t\t\t\tvnode.context.loaderObserver.unobserve(element);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-user-list\">\n\t\t\t<!-- Loading first page -->\n\t\t\t<div v-if=\"!firstPageLoaded\" class=\"bx-im-component-call-user-list-loader\">\n\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-icon\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-text\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_LOADING_USERS') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<!-- Loading completed -->\n\t\t\t<template v-else>\n\t\t\t\t<!-- Speakers list section (if broadcast) -->\n\t\t\t\t<template v-if=\"isBroadcast\">\n\t\t\t\t\t<!-- Speakers category title -->\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_CATEGORY_PRESENTERS') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-counter\">\n\t\t\t\t\t\t\t{{ presentersList.length }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- Speakers list -->\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-items\">\n\t\t\t\t\t\t<template v-for=\"presenter in presentersList\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t@userChangeName=\"onUserChangeName\"\n\t\t\t\t\t\t\t\t@userKick=\"onUserMenuKick\"\n\t\t\t\t\t\t\t\t@userInsertName=\"onUserMenuInsertName\"\n\t\t\t\t\t\t\t\t@userPin=\"onUserMenuPin\"\n\t\t\t\t\t\t\t\t@userUnpin=\"onUserMenuUnpin\"\n\t\t\t\t\t\t\t\t@userChangeBackground=\"onUserMenuChangeBackground\"\n\t\t\t\t\t\t\t\t@userOpenChat=\"onUserMenuOpenChat\"\n\t\t\t\t\t\t\t\t@userOpenProfile=\"onUserMenuOpenProfile\"\n\t\t\t\t\t\t\t\t:userId=\"presenter\"\n\t\t\t\t\t\t\t\t:key=\"presenter\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<!-- Participants list section (if there are any users) -->\n\t\t\t\t<template v-if=\"usersList.length > 0\">\n\t\t\t\t\t<!-- Show participants category title if broadcast -->\n\t\t\t\t\t<div v-if=\"isBroadcast\" class=\"bx-im-component-call-user-list-category bx-im-component-call-user-list-category-participants\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_CATEGORY_PARTICIPANTS') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-counter\">\n\t\t\t\t\t\t\t{{ usersList.length }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- Participants list -->\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-items\">\n\t\t\t\t\t\t<template v-for=\"user in usersList\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t@userChangeName=\"onUserChangeName\"\n\t\t\t\t\t\t\t\t@userKick=\"onUserMenuKick\"\n\t\t\t\t\t\t\t\t@userInsertName=\"onUserMenuInsertName\" \n\t\t\t\t\t\t\t\t@userPin=\"onUserMenuPin\"\n\t\t\t\t\t\t\t\t@userUnpin=\"onUserMenuUnpin\"\n\t\t\t\t\t\t\t\t@userChangeBackground=\"onUserMenuChangeBackground\"\n\t\t\t\t\t\t\t\t@userOpenChat=\"onUserMenuOpenChat\"\n\t\t\t\t\t\t\t\t@userOpenProfile=\"onUserMenuOpenProfile\"\n\t\t\t\t\t\t\t\t:userId=\"user\"\n\t\t\t\t\t\t\t\t:key=\"user\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<!-- Next page loader -->\n\t\t\t\t<div v-if=\"hasMoreToLoad\" v-bx-im-directive-user-list-observer class=\"bx-im-component-call-user-list-loader\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-icon\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_LOADING_USERS') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\n\t\t</div>\n\t`\n};\n\nexport {UserList};","import { Vuex } from \"ui.vue.vuex\";\nimport { MenuManager } from 'main.popup';\nimport { Clipboard } from \"im.lib.clipboard\";\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\n\nconst UserListHeader = {\n\tcomputed:\n\t{\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisCurrentUserOwner()\n\t\t{\n\t\t\tif (!this.dialog)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.dialog.ownerId === this.userId;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonCloseUsers()\n\t\t{\n\t\t\tthis.getApplication().toggleUserList();\n\t\t},\n\t\topenMenu()\n\t\t{\n\t\t\tif (this.menuPopup)\n\t\t\t{\n\t\t\t\tthis.closeMenu();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.menuPopup = MenuManager.create({\n\t\t\t\tid: 'bx-im-component-call-user-list-header-popup',\n\t\t\t\tbindElement: this.$refs['user-list-header-menu'],\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => this.menuPopup.destroy(),\n\t\t\t\t\tonPopupDestroy: () => this.menuPopup = null\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.menuPopup.show();\n\t\t},\n\t\tcloseMenu()\n\t\t{\n\t\t\tthis.menuPopup.destroy();\n\t\t\tthis.menuPopup = null;\n\t\t},\n\t\tgetMenuItems()\n\t\t{\n\t\t\tconst items = [{\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_HEADER_MENU_COPY_LINK'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\tthis.onMenuCopyLink();\n\t\t\t\t}\n\t\t\t}];\n\t\t\tif (this.isCurrentUserOwner)\n\t\t\t{\n\t\t\t\titems.push({\n\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_HEADER_MENU_CHANGE_LINK'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\tthis.onMenuChangeLink();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\t\tonMenuCopyLink()\n\t\t{\n\t\t\tconst publicLink = this.dialog.public.link;\n\t\t\tClipboard.copy(publicLink);\n\n\t\t\tconst notificationText = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_LINK_COPIED');\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: notificationText,\n\t\t\t\tautoHideDelay: 4000\n\t\t\t})\n\t\t},\n\t\tonMenuChangeLink()\n\t\t{\n\t\t\tconst confirmMessage = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_CHANGE_LINK_CONFIRM_TEXT');\n\t\t\tthis.changeLinkConfirm = MessageBox.create({\n\t\t\t\tmessage: confirmMessage,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tonOk: () => {\n\t\t\t\t\tthis.changeLink();\n\t\t\t\t\tthis.changeLinkConfirm.getPopupWindow().destroy();\n\t\t\t\t},\n\t\t\t\tonCancel: () => {\n\t\t\t\t\tthis.changeLinkConfirm.getPopupWindow().destroy();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.changeLinkConfirm.show();\n\t\t},\n\t\tchangeLink()\n\t\t{\n\t\t\tthis.getApplication().changeLink().then(() => {\n\t\t\t\tconst notificationText = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_LINK_CHANGED');\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: notificationText,\n\t\t\t\t\tautoHideDelay: 4000\n\t\t\t\t})\n\t\t\t}).catch(error => {\n\t\t\t\tconsole.error('Conference: change link error', error);\n\t\t\t});\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-right-header\">\n\t\t\t<div class=\"bx-im-component-call-right-header-left\">\n\t\t\t\t<div @click=\"onCloseUsers\" class=\"bx-im-component-call-right-header-close\" :title=\"$Bitrix.Loc.getMessage['BX_IM_COMPONENT_CALL_CHAT_CLOSE_TITLE']\"></div>\n\t\t\t<div class=\"bx-im-component-call-right-header-title\">{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USERS_LIST_TITLE') }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-component-call-right-header-right\">\n\t\t\t\t<div @click=\"openMenu\" class=\"bx-im-component-call-user-list-header-more\" ref=\"user-list-header-menu\"></div>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {UserListHeader};","/**\n * Bitrix im\n * Pubic conference Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2021 Bitrix\n */\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {\n\tConferenceStateType,\n\tEventType,\n\tConferenceErrorCode,\n\tConferenceRightPanelMode as RightPanelMode\n} from \"im.const\";\nimport { SendMessageHandler, ReadingHandler, ReactionHandler } from \"im.event-handler\";\nimport {ConferenceTextareaHandler} from \"./event-handler/conference-textarea-handler\";\nimport {ConferenceTextareaUploadHandler} from \"./event-handler/conference-textarea-upload-handler\";\nimport {EventEmitter} from \"main.core.events\";\n\n//global components\nimport \"im.component.dialog\";\nimport \"im.component.textarea\";\nimport \"ui.switcher\";\n\n//internal components\nimport {ConferenceSmiles} from './component/conference-smiles';\nimport {CheckDevices} from './component/check-devices';\nimport {Error} from \"./component/error\";\nimport {OrientationDisabled} from \"./component/orientation-disabled\";\nimport {PasswordCheck} from \"./component/password-check\";\nimport {LoadingStatus} from \"./component/loading-status\";\nimport {RequestPermissions} from \"./component/request-permissions\";\nimport {MobileChatButton} from \"./component/mobile-chat-button\";\nimport {ConferenceInfo} from \"./component/conference-info\";\nimport {UserForm} from \"./component/user-form\";\nimport {ChatHeader} from \"./component/chat-header\";\nimport {WaitingForStart} from \"./component/waiting-for-start\";\nimport {UserList} from \"./component/user-list/user-list\";\nimport {UserListHeader} from \"./component/user-list/user-list-header\";\n\n//css\nimport \"./conference-public.css\";\n\n//const\nconst popupModes = Object.freeze({\n\tpreparation: 'preparation'\n});\n\nBitrixVue.component('bx-im-component-conference-public',\n{\n\tcomponents: {\n\t\tError, CheckDevices, OrientationDisabled, PasswordCheck, LoadingStatus,\n\t\tRequestPermissions, MobileChatButton, ConferenceInfo, UserForm, ChatHeader, WaitingForStart, UserList, UserListHeader,\n\t\tConferenceSmiles\n\t},\n\tprops: {\n\t\tdialogId: { type: String, default: \"0\" }\n\t},\n\tdata: function()\n\t{\n\t\treturn {\n\t\t\twaitingForStart: false,\n\t\t\tpopupMode: popupModes.preparation,\n\t\t\tviewPortMetaNode: null,\n\t\t\tchatDrag: false,\n\t\t\t// in %\n\t\t\trightPanelSplitMode: {\n\t\t\t\tusersHeight: 50,\n\t\t\t\tchatHeight: 50,\n\t\t\t\tchatMinHeight: 30,\n\t\t\t\tchatMaxHeight: 80\n\t\t\t}\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.initEventHandlers();\n\n\t\tEventEmitter.subscribe(EventType.conference.waitForStart, this.onWaitForStart);\n\t\tEventEmitter.subscribe(EventType.conference.hideSmiles, this.onHideSmiles);\n\n\t\tif (this.isMobile())\n\t\t{\n\t\t\tthis.setMobileMeta();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdocument.body.classList.add('bx-im-application-call-desktop-state');\n\t\t}\n\n\t\tif (!this.isDesktop())\n\t\t{\n\t\t\twindow.addEventListener('beforeunload', this.onBeforeUnload.bind(this));\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tif (!this.isHttps())\n\t\t{\n\t\t\tthis.getApplication().setError(ConferenceErrorCode.unsafeConnection);\n\t\t}\n\n\t\tif (!this.passwordChecked)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.conference.setPasswordFocus);\n\t\t}\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.destroyHandlers();\n\n\t\tEventEmitter.unsubscribe(EventType.conference.waitForStart, this.onWaitForStart);\n\t\tEventEmitter.unsubscribe(EventType.conference.hideSmiles, this.onHideSmiles);\n\n\t\tclearInterval(this.durationInterval);\n\t},\n\tcomputed:\n\t{\n\t\tEventType: () => EventType,\n\t\tRightPanelMode: () => RightPanelMode,\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tdialogInited()\n\t\t{\n\t\t\tif (this.dialog)\n\t\t\t{\n\t\t\t\treturn this.dialog.init;\n\t\t\t}\n\t\t},\n\t\tconferenceStarted()\n\t\t{\n\t\t\treturn this.conference.common.conferenceStarted;\n\t\t},\n\t\tuserInited()\n\t\t{\n\t\t\treturn this.conference.common.inited;\n\t\t},\n\t\tuserHasRealName()\n\t\t{\n\t\t\tif (this.user)\n\t\t\t{\n\t\t\t\treturn this.user.name !== this.localize['BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME'];\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\trightPanelMode()\n\t\t{\n\t\t\treturn this.conference.common.rightPanelMode;\n\t\t},\n\t\tuserListClasses()\n\t\t{\n\t\t\tconst result = [];\n\t\t\tif (this.rightPanelMode === 'split')\n\t\t\t{\n\t\t\t\tresult.push('bx-im-component-call-right-top');\n\t\t\t}\n\t\t\telse if (this.rightPanelMode === 'users')\n\t\t\t{\n\t\t\t\tresult.push('bx-im-component-call-right-full');\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tuserListStyles()\n\t\t{\n\t\t\tif (this.rightPanelMode !== RightPanelMode.split)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: `${this.rightPanelSplitMode.usersHeight}%`\n\t\t\t}\n\t\t},\n\t\tchatClasses()\n\t\t{\n\t\t\tconst result = [];\n\t\t\tif (this.rightPanelMode === 'split')\n\t\t\t{\n\t\t\t\tresult.push('bx-im-component-call-right-bottom');\n\t\t\t}\n\t\t\telse if (this.rightPanelMode === 'chat')\n\t\t\t{\n\t\t\t\tresult.push('bx-im-component-call-right-full');\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tchatStyles()\n\t\t{\n\t\t\tif (this.rightPanelMode !== RightPanelMode.split)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: `${this.rightPanelSplitMode.chatHeight}%`\n\t\t\t}\n\t\t},\n\t\tisChatShowed()\n\t\t{\n\t\t\treturn this.conference.common.showChat;\n\t\t},\n\t\tisPreparationStep()\n\t\t{\n\t\t\treturn this.conference.common.state === ConferenceStateType.preparation;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn this.conference.common.presenters;\n\t\t},\n\t\tisCurrentUserPresenter()\n\t\t{\n\t\t\treturn this.presentersList.includes(this.userId);\n\t\t},\n\t\terrorCode()\n\t\t{\n\t\t\treturn this.conference.common.error;\n\t\t},\n\t\tpasswordChecked()\n\t\t{\n\t\t\treturn this.conference.common.passChecked;\n\t\t},\n\t\tpermissionsRequested()\n\t\t{\n\t\t\treturn this.conference.common.permissionsRequested;\n\t\t},\n\t\tcallContainerClasses()\n\t\t{\n\t\t\treturn [this.conference.common.callEnded ? 'with-clouds': ''];\n\t\t},\n\t\twrapClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-wrap'];\n\n\t\t\tif (this.isMobile() && this.isBroadcast && !this.isCurrentUserPresenter && this.isPreparationStep)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-mobile-viewer-mode');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tchatId()\n\t\t{\n\t\t\tif (this.application)\n\t\t\t{\n\t\t\t\treturn this.application.dialog.chatId;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases(['BX_IM_COMPONENT_CALL_', 'IM_DIALOG_CLIPBOARD_']);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference,\n\t\t\tapplication: state => state.application,\n\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tisChatShowed(newValue)\n\t\t{\n\t\t\tif (this.isMobile())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (newValue === true)\n\t\t\t{\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollOnStart, {chatId: this.chatId});\n\t\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\trightPanelMode(newValue)\n\t\t{\n\t\t\tif (newValue === RightPanelMode.chat || newValue === RightPanelMode.split)\n\t\t\t{\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollOnStart, {chatId: this.chatId});\n\t\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tdialogInited(newValue)\n\t\t{\n\t\t\tif (newValue === true)\n\t\t\t{\n\t\t\t\tthis.getApplication().setDialogInited();\n\t\t\t}\n\t\t},\n\t\t//to skip request permissions step in desktop\n\t\tuserInited(newValue)\n\t\t{\n\t\t\tif (newValue === true && this.isDesktop() && this.passwordChecked)\n\t\t\t{\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.conference.requestPermissions);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tuser()\n\t\t{\n\t\t\tif (this.user && this.userHasRealName)\n\t\t\t{\n\t\t\t\tthis.getApplication().setUserWasRenamed();\n\t\t\t}\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tinitEventHandlers()\n\t\t{\n\t\t\tthis.sendMessageHandler = new SendMessageHandler(this.$Bitrix);\n\t\t\tthis.textareaHandler = new ConferenceTextareaHandler(this.$Bitrix);\n\t\t\tthis.readingHandler = new ReadingHandler(this.$Bitrix);\n\t\t\tthis.reactionHandler = new ReactionHandler(this.$Bitrix);\n\t\t\tthis.textareaUploadHandler = new ConferenceTextareaUploadHandler(this.$Bitrix);\n\t\t},\n\t\tdestroyHandlers()\n\t\t{\n\t\t\tthis.sendMessageHandler.destroy();\n\t\t\tthis.textareaHandler.destroy();\n\t\t\tthis.readingHandler.destroy();\n\t\t\tthis.reactionHandler.destroy();\n\t\t\tthis.textareaUploadHandler.destroy();\n\t\t},\n\t\tonHideSmiles()\n\t\t{\n\t\t\tthis.getApplication().toggleSmiles();\n\t\t},\n\t\tonBeforeUnload(event)\n\t\t{\n\t\t\tif (!this.getApplication().callView)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isPreparationStep)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n                event.returnValue = '';\n\t\t\t}\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.insertText, { text: event.text });\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t},\n\t\tonWaitForStart()\n\t\t{\n\t\t\tthis.waitingForStart = true;\n\t\t},\n\t\tonChatStartDrag(event)\n\t\t{\n\t\t\tif (this.chatDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.chatDrag = true;\n\n\t\t\tthis.chatDragStartPoint = event.clientY;\n\t\t\tthis.chatDragStartHeight = this.rightPanelSplitMode.chatHeight;\n\n\t\t\tthis.addChatDragEvents();\n\t\t},\n\t\tonChatContinueDrag(event)\n\t\t{\n\t\t\tif (!this.chatDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.chatDragControlPoint = event.clientY;\n\t\t\tconst availableHeight = document.body.clientHeight;\n\n\t\t\tconst maxHeightInPx = availableHeight * (this.rightPanelSplitMode.chatMaxHeight / 100);\n\t\t\tconst minHeightInPx = availableHeight * (this.rightPanelSplitMode.chatMinHeight / 100)\n\t\t\tconst startHeightInPx = availableHeight * (this.chatDragStartHeight / 100);\n\t\t\tconst chatHeightInPx = Math.max(\n\t\t\t\tMath.min(startHeightInPx + this.chatDragStartPoint - this.chatDragControlPoint, maxHeightInPx),\n\t\t\t\tminHeightInPx\n\t\t\t);\n\n\t\t\tconst chatHeight = (chatHeightInPx / availableHeight) * 100;\n\n\t\t\tif (this.rightPanelSplitMode.chatHeight !== chatHeight)\n\t\t\t{\n\t\t\t\tthis.rightPanelSplitMode.chatHeight = chatHeight;\n\t\t\t\tthis.rightPanelSplitMode.usersHeight = 100 - chatHeight;\n\t\t\t}\n\t\t},\n\t\tonChatStopDrag(event)\n\t\t{\n\t\t\tif (!this.chatDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.chatDrag = false;\n\t\t\tthis.removeChatDragEvents();\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t},\n\t\taddChatDragEvents()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onChatContinueDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onChatStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onChatStopDrag);\n\t\t},\n\t\tremoveChatDragEvents()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onChatContinueDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onChatStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onChatStopDrag);\n\t\t},\n\n\t\tisMobile()\n\t\t{\n\t\t\treturn Utils.device.isMobile();\n\t\t},\n\t\tisDesktop()\n\t\t{\n\t\t\treturn Utils.platform.isBitrixDesktop();\n\t\t},\n\t\tsetMobileMeta()\n\t\t{\n\t\t\tif (!this.viewPortMetaNode)\n\t\t\t{\n\t\t\t\tthis.viewPortMetaNode = document.createElement('meta');\n\t\t\t\tthis.viewPortMetaNode.setAttribute('name', 'viewport');\n\t\t\t\tthis.viewPortMetaNode.setAttribute(\"content\", \"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\");\n\t\t\t\tdocument.head.appendChild(this.viewPortMetaNode);\n\t\t\t}\n\n\t\t\tdocument.body.classList.add('bx-im-application-call-mobile-state');\n\n\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t{\n\t\t\t\tdocument.body.classList.add('bx-im-application-call-mobile-safari-based');\n\t\t\t}\n\t\t},\n\t\tisHttps()\n\t\t{\n\t\t\treturn location.protocol === 'https:';\n\t\t},\n\t\tgetUserHash()\n\t\t{\n\t\t\treturn this.conference.user.hash;\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t\t/* endregion 03. Helpers */\n\t},\n\ttemplate: `\n\t<div :class=\"wrapClasses\">\n\t\t<div class=\"bx-im-component-call\">\n\t\t\t<div class=\"bx-im-component-call-left\">\n\t\t\t\t<div id=\"bx-im-component-call-container\" :class=\"callContainerClasses\"></div>\n\t\t\t\t<div v-if=\"isPreparationStep\" class=\"bx-im-component-call-left-preparation\">\n\t\t\t\t\t<!-- Step 1: Errors page -->\n\t\t\t\t\t<Error v-if=\"errorCode\"/>\n\t\t\t\t\t<!-- Step 2: Password page -->\n\t\t\t\t\t<PasswordCheck v-else-if=\"!passwordChecked\"/>\n\t\t\t\t\t<template v-else-if=\"!errorCode && passwordChecked\">\n\t\t\t\t\t\t<!-- Step 3: Loading page -->\n\t\t\t\t\t\t<LoadingStatus v-if=\"!userInited\"/>\n\t\t\t\t\t\t<template v-else-if=\"userInited\">\n\t\t\t\t\t\t\t<!-- BROADCAST MODE -->\n\t\t\t\t\t\t  \t<template v-if=\"isBroadcast\">\n\t\t\t\t\t\t  \t\t<template v-if=\"!isDesktop() && !permissionsRequested && isCurrentUserPresenter\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<RequestPermissions>\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</RequestPermissions>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Skip permissions request for desktop and show button with loader  -->\n\t\t\t\t\t\t\t\t<template v-if=\"isDesktop() && (!permissionsRequested || !user) && isCurrentUserPresenter\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<RequestPermissions :skipRequest=\"true\"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Step 5: Page with video and mic check -->\n\t\t\t\t\t\t\t\t<div v-if=\"permissionsRequested || !isCurrentUserPresenter\" class=\"bx-im-component-call-video-step-container\">\n\t\t\t\t\t\t\t\t\t<!-- Compact conference info -->\n\t\t\t\t\t\t\t\t\t<ConferenceInfo :compactMode=\"true\"/>\n\t\t\t\t\t\t\t\t\t<CheckDevices v-if=\"isCurrentUserPresenter\" />\n\t\t\t\t\t\t\t\t\t<!-- Bottom part of interface -->\n\t\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-bottom-container\">\n\t\t\t\t\t\t\t\t\t\t<UserForm v-if=\"!waitingForStart\"/>\n\t\t\t\t\t\t\t\t\t\t<WaitingForStart v-else>\n\t\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t</WaitingForStart>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<!-- END BROADCAST MODE -->\n\t\t\t\t\t\t\t<!-- NORMAL MODE (NOT BROADCAST) -->\n\t\t\t\t\t\t  \t<template v-else-if=\"!isBroadcast\">\n\t\t\t\t\t\t\t\t<!-- Step 4: Permissions page -->\n\t\t\t\t\t\t\t\t<template v-if=\"!isDesktop() && !permissionsRequested\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<RequestPermissions>\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</RequestPermissions>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Skip permissions request for desktop and show button with loader  -->\n\t\t\t\t\t\t\t\t<template v-if=\"isDesktop() && (!permissionsRequested || !user)\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<RequestPermissions :skipRequest=\"true\"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Step 5: Page with video and mic check -->\n\t\t\t\t\t\t\t\t<div v-else-if=\"permissionsRequested\" class=\"bx-im-component-call-video-step-container\">\n\t\t\t\t\t\t\t\t\t<!-- Compact conference info -->\n\t\t\t\t\t\t\t\t\t<ConferenceInfo :compactMode=\"true\"/>\n\t\t\t\t\t\t\t\t\t<CheckDevices/>\n\t\t\t\t\t\t\t\t\t<!-- Bottom part of interface -->\n\t\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-bottom-container\">\n\t\t\t\t\t\t\t\t\t\t<UserForm v-if=\"!waitingForStart\"/>\n\t\t\t\t\t\t\t\t\t\t<WaitingForStart v-else>\n\t\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t</WaitingForStart>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<!-- END NORMAL MODE (NOT BROADCAST) -->\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template v-if=\"userInited && !errorCode\">\n\t\t\t\t<transition :name=\"!isMobile()? 'videoconf-chat-slide': ''\">\n\t\t\t\t\t<div v-show=\"rightPanelMode !== RightPanelMode.hidden\" class=\"bx-im-component-call-right\">\n\t\t\t\t\t\t<!-- Start users list -->\n\t\t\t\t\t\t<div v-show=\"rightPanelMode === RightPanelMode.split || rightPanelMode === RightPanelMode.users\" :class=\"userListClasses\" :style=\"userListStyles\">\n\t\t\t\t\t\t\t<UserListHeader />\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-right-users\">\n\t\t\t\t\t\t\t\t<UserList />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!-- End users list -->\n\t\t\t\t\t\t<!-- Start chat -->\n\t\t\t\t\t\t<div v-show=\"rightPanelMode === RightPanelMode.split || rightPanelMode === RightPanelMode.chat\" :class=\"chatClasses\" :style=\"chatStyles\">\n\t\t\t\t\t\t\t<!-- Resize handler -->\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"rightPanelMode === RightPanelMode.split\"\n\t\t\t\t\t\t\t\t@mousedown=\"onChatStartDrag\"\n\t\t\t\t\t\t\t\tclass=\"bx-im-component-call-right-bottom-resize-handle\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<ChatHeader />\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-right-chat\">\n\t\t\t\t\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t\t\t\t\t:userId=\"userId\"\n\t\t\t\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-im-component-call-smiles\">\n\t\t\t\t\t\t\t\t\t<ConferenceSmiles\n\t\t\t\t\t\t\t\t\t\tv-if=\"conference.common.showSmiles\"\n\t\t\t\t\t\t\t\t\t\t@selectSmile=\"onSmilesSelectSmile\"\n\t\t\t\t\t\t\t\t\t\t@selectSet=\"onSmilesSelectSet\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t\t<div v-if=\"user\" class=\"bx-im-component-call-textarea\">\n\t\t\t\t\t\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t\t\t\t\t\t:userId=\"userId\"\n\t\t\t\t\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t\t\t:enableFile=\"true\"\n\t\t\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t\t\t:autoFocus=\"true\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!-- End chat -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</transition>\n\t\t\t</template>\n\t\t</div>\n\t</div>\n\t`\n});\n"],"names":["ConferenceTextareaHandler","$Bitrix","application","Application","get","event","data","appId","toggleSmiles","TextareaHandler","ConferenceTextareaUploadHandler","message","getData","getDiskFolderId","requestDiskFolderId","chatId","then","addMessageWithFile","error","Logger","getChatId","setUploaderCustomHeaders","uploader","addTask","taskId","file","id","fileData","source","fileName","name","generateUniqueName","diskFolderId","previewBlob","senderOptions","customHeaders","getUserHash","controller","store","state","conference","user","hash","TextareaUploadHandler","ConferenceSmiles","methods","onSelectSmile","$emit","onSelectSet","hideSmiles","EventEmitter","emit","EventType","template","MicLevel","props","bars","barDisabledColor","barEnabledColor","watch","localStream","stream","Type","isNil","startAudioCheck","mounted","document","querySelectorAll","computed","localize","BitrixVue","getFilteredPhrases","audioContext","window","AudioContext","webkitAudioContext","analyser","createAnalyser","microphone","createMediaStreamSource","scriptNode","createScriptProcessor","smoothingTimeConstant","fftSize","connect","destination","onaudioprocess","processVolume","arr","Uint8Array","frequencyBinCount","getByteFrequencyData","values","i","length","average","oneBarValue","barsToColor","Math","round","elementsToColor","slice","forEach","elem","style","backgroundColor","CheckDevices","noVideo","selectedCamera","selectedMic","mediaStream","showMic","userDisabledCamera","gettingVideo","isFlippedVideo","BX","Call","Hardware","enableMirroring","created","$root","$on","onCameraStateChange","onMicStateChange","stopLocalVideo","cameraId","onCameraSelected","micId","onMicSelected","getApplication","initHardware","getDefaultDevices","MessageBox","show","Loc","getMessage","modal","buttons","MessageBoxButtons","OK","destroyed","noVideoText","cameraVideoClasses","constraints","audio","video","Utils","device","isMobile","width","ideal","height","defaultCamera","deviceId","exact","Object","keys","cameraList","defaultMicrophone","navigator","mediaDevices","getUserMedia","setLocalStream","getVideoTracks","getSettings","playLocalVideo","setSelectedCamera","getAudioTracks","setSelectedMic","e","warn","getLocalStream","setCameraState","setLocalVideoStream","$refs","volume","srcObject","play","getTracks","tr","stop","stopLocalVideoStream","components","Error","downloadAppArticleCode","callFeedbackSent","errorCode","common","bitrix24only","ConferenceErrorCode","detectIntranetUser","userLimitReached","kickedFromCall","wrongAlias","conferenceFinished","finished","unsupportedBrowser","missingMicrophone","unsafeConnection","noSignalFromCamera","userLeftCall","showFeedback","console","callDetails","Vuex","mapState","reloadPage","location","reload","redirectToAuthorize","href","origin","pathname","continueAsGuest","Cookie","set","alias","path","getBxLink","getAlias","openHelpArticle","Helper","onFeedbackSent","setTimeout","OrientationDisabled","PasswordCheck","password","checkingPassword","wrongPassword","subscribe","setPasswordFocus","onSetPasswordFocus","beforeDestroy","unsubscribe","conferenceTitle","focus","checkPassword","LoadingStatus","NOT_ALLOWED_ERROR_CODE","NOT_FOUND_ERROR_CODE","RequestPermissions","skipRequest","type","Boolean","required","requestPermissions","onRequestPermissions","setPermissionsRequestedFlag","showMessageBox","$nextTick","$store","dispatch","status","text","MobileChatButton","dialogCounter","dialog","counter","userCounter","userCount","dialogues","collection","dialogId","openChat","toggleChat","openUserList","toggleUserList","ConferenceInfo","compactMode","conferenceDuration","durationInterval","conferenceStarted","updateConferenceDuration","setInterval","clearInterval","conferenceStartDate","userId","isBroadcast","presentersList","presenters","presentersInfo","getters","formattedPresentersList","presentersCount","prefix","map","join","isCurrentUserPresenter","includes","conferenceStatusText","conferenceStatusClasses","containerClasses","newValue","startDate","currentDate","Date","durationInSeconds","floor","minutes","seconds","UserForm","userNewName","userHasRealName","intranetAvatarStyle","extranet","avatar","backgroundImage","logoutLink","publicLink","bitrix_sessid","link","videoModeButtonClasses","classes","hardwareInited","push","audioModeButtonClasses","users","startConference","startCall","joinConference","setNewName","waitForStart","setUserReadyToJoin","setJoinType","viewerMode","joinCall","preCall","joinAsViewer","renameGuest","trim","isDesktop","platform","isBitrixDesktop","ChatHeader","desktop","Desktop","showTotalCounter","getApiVersion","isWindows","isExternalUser","messageCount","formattedCounter","onCloseChat","onTotalCounterClick","opener","BXDesktopWindow","ExecuteCommand","WaitingForStart","UserListItem","Number","renameMode","newName","renameRequested","menuId","onlineStates","ConferenceUserState","Ready","Connected","currentUser","chatOwner","ownerId","isCurrentUserOwner","isCurrentUserExternal","isGuestWithDefaultName","guestDefaultName","userCallStatus","isUserInCall","userInCallCount","usersInCall","call","filter","isUserPresenter","formattedSubtitle","subtitles","isMenuNeeded","getMenuItems","menuItems","items","onclick","closeMenu","onRenameStart","externalAuthId","cameraState","pinned","avatarWrapClasses","talking","avatarClasses","avatarStyle","color","isCallStatusPanelNeeded","ConferenceStateType","callLeftIconClasses","floorRequestState","screenState","callCenterIconClasses","microphoneState","callRightIconClasses","bodyClasses","openMenu","menuPopup","existingMenu","MenuManager","getMenuById","destroy","create","bindElement","events","onPopupClose","onPopupDestroy","select","onRenameKeyDown","keyCode","changeName","onFocus","userRenameFocus","onBlur","userRenameBlur","UserList","usersPerPage","firstPageLoaded","pagesLoaded","hasMoreToLoad","rename","requestUsers","firstPage","loaderObserver","usersList","sort","userSortFunction","rightPanelMode","RestClient","callMethod","result","usersIds","ex","onUserMenuKick","showUserKickConfirm","userKickConfirm","close","confirmMessage","OK_CANCEL","onOk","kickUser","onCancel","user_id","chat_id","onUserMenuInsertName","RightPanelMode","hidden","textarea","insertText","onUserChangeName","method","oldName","fields","lastActivityDate","setUserWasRenamed","onUserMenuPin","pinUser","onUserMenuUnpin","unpinUser","onUserMenuChangeBackground","changeBackground","onUserMenuOpenChat","onUserMenuOpenProfile","openProfile","getLoaderObserver","options","root","querySelector","threshold","callback","entries","observer","entry","isIntersecting","intersectionRatio","IntersectionObserver","userA","userB","directives","inserted","element","bindings","vnode","context","observe","unbind","unobserve","UserListHeader","onCloseUsers","onMenuCopyLink","onMenuChangeLink","Clipboard","copy","notificationText","UI","Notification","Center","notify","content","autoHideDelay","changeLinkConfirm","changeLink","getPopupWindow","popupModes","freeze","preparation","component","String","waitingForStart","popupMode","viewPortMetaNode","chatDrag","rightPanelSplitMode","usersHeight","chatHeight","chatMinHeight","chatMaxHeight","initEventHandlers","onWaitForStart","onHideSmiles","setMobileMeta","body","classList","add","addEventListener","onBeforeUnload","bind","isHttps","setError","passwordChecked","destroyHandlers","dialogInited","init","userInited","inited","userListClasses","userListStyles","split","chatClasses","chatStyles","isChatShowed","showChat","isPreparationStep","passChecked","permissionsRequested","callContainerClasses","callEnded","wrapClasses","scrollOnStart","setFocus","chat","setDialogInited","sendMessageHandler","SendMessageHandler","textareaHandler","readingHandler","ReadingHandler","reactionHandler","ReactionHandler","textareaUploadHandler","callView","preventDefault","returnValue","onSmilesSelectSmile","onSmilesSelectSet","onChatStartDrag","chatDragStartPoint","clientY","chatDragStartHeight","addChatDragEvents","onChatContinueDrag","chatDragControlPoint","availableHeight","clientHeight","maxHeightInPx","minHeightInPx","startHeightInPx","chatHeightInPx","max","min","onChatStopDrag","removeChatDragEvents","scrollToBottom","force","removeEventListener","createElement","setAttribute","head","appendChild","browser","isSafariBased","protocol"],"mappings":";;;;KAEaA,yBAAb;CAAA;;CAIC,qCAAYC,OAAZ,EACA;CAAA;;CAAA;CACC,2HAAMA,OAAN;CADD,0FAHsB,IAGtB;CAEC,UAAKC,WAAL,GAAmBD,OAAO,CAACE,WAAR,CAAoBC,GAApB,EAAnB;CAFD;CAGC;;CARF;CAAA;CAAA,2CAWC;CAAA,UADwBC,KACxB,QADkBC,IAClB;;CACC,UAAID,KAAK,CAACE,KAAN,KAAgB,OAApB,EACA;CACC,aAAKL,WAAL,CAAiBM,YAAjB;CACA;CACD;CAhBF;CAAA;CAAA,EAA+CC,+BAA/C;;KCCaC,+BAAb;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,uCAEoBL,KAFpB,EAGC;CAAA;;CACC,UAAMM,OAAO,GAAGN,KAAK,CAACO,OAAN,EAAhB;;CAEA,UAAI,CAAC,KAAKC,eAAL,EAAL,EACA;CACC,aAAKC,mBAAL,CAAyBH,OAAO,CAACI,MAAjC,EAAyCC,IAAzC,CAA8C,YAAM;CACnD,UAAA,KAAI,CAACC,kBAAL,CAAwBZ,KAAxB;CACA,SAFD,WAES,UAAAa,KAAK,EAAI;CACjBC,UAAAA,oBAAM,CAACD,KAAP,CAAa,0BAAb,EAAyCA,KAAzC;CACA,iBAAO,KAAP;CACA,SALD;CAOA,eAAO,KAAP;CACA;;CAEDP,MAAAA,OAAO,CAACI,MAAR,GAAiB,KAAKK,SAAL,EAAjB;CAEA,WAAKC,wBAAL;CAEA,WAAKC,QAAL,CAAcC,OAAd,CAAsB;CACrBC,QAAAA,MAAM,EAAEb,OAAO,CAACc,IAAR,CAAaC,EADA;CAErBC,QAAAA,QAAQ,EAAEhB,OAAO,CAACc,IAAR,CAAaG,MAAb,CAAoBH,IAFT;CAGrBI,QAAAA,QAAQ,EAAElB,OAAO,CAACc,IAAR,CAAaG,MAAb,CAAoBH,IAApB,CAAyBK,IAHd;CAIrBC,QAAAA,kBAAkB,EAAE,IAJC;CAKrBC,QAAAA,YAAY,EAAE,KAAKnB,eAAL,EALO;CAMrBoB,QAAAA,WAAW,EAAEtB,OAAO,CAACc,IAAR,CAAaQ;CANL,OAAtB;CAQA;CA9BF;CAAA;CAAA,+CAiCC;CACC,UAAI,CAAC,KAAKX,QAAL,CAAcY,aAAd,CAA4BC,aAAjC,EACA;CACC,aAAKb,QAAL,CAAcY,aAAd,CAA4BC,aAA5B,GAA4C,EAA5C;CACA;;CACD,WAAKb,QAAL,CAAcY,aAAd,CAA4BC,aAA5B,CAA0C,cAA1C,IAA4D,KAAKC,WAAL,EAA5D;CACA,WAAKd,QAAL,CAAcY,aAAd,CAA4BC,aAA5B,CAA0C,cAA1C,IAA4D,KAAKf,SAAL,EAA5D;CACA;CAxCF;CAAA;CAAA,kCA2CC;CACC,aAAO,KAAKiB,UAAL,CAAgBC,KAAhB,CAAsBC,KAAtB,CAA4BC,UAA5B,CAAuCC,IAAvC,CAA4CC,IAAnD;CACA;CA7CF;CAAA;CAAA,0CAgDC;CACC,aAAO,qBAAP;CACA;CAlDF;CAAA;CAAA,2CAqDC;CACC,aAAO,qBAAP;CACA;CAvDF;CAAA;CAAA,EAAqDC,qCAArD;;CCCA,IAAMC,gBAAgB,GAAG;CACxBC,EAAAA,OAAO,EACP;CACCC,IAAAA,aADD,yBACezC,KADf,EAEC;CACC,WAAK0C,KAAL,CAAW,aAAX,EAA0B1C,KAA1B;CACA,KAJF;CAKC2C,IAAAA,WALD,uBAKa3C,KALb,EAMC;CACC,WAAK0C,KAAL,CAAW,WAAX,EAAwB1C,KAAxB;CACA,KARF;CASC4C,IAAAA,UATD,wBAUC;CACCC,MAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAACZ,UAAV,CAAqBS,UAAvC;CACA;CAZF,GAFwB;CAgBxB;CACAI,EAAAA,QAAQ;CAjBgB,CAAzB;;CCDA,IAAMC,QAAQ,GAAG;CAChBC,EAAAA,KAAK,EAAE,CAAC,aAAD,CADS;CAEhBjD,EAAAA,IAFgB,kBAGhB;CACC,WAAO;CACNkD,MAAAA,IAAI,EAAE,EADA;CAENC,MAAAA,gBAAgB,EAAE,wBAFZ;CAGNC,MAAAA,eAAe,EAAE;CAHX,KAAP;CAKA,GATe;CAUhBC,EAAAA,KAAK,EACL;CACCC,IAAAA,WADD,uBACaC,MADb,EAEC;CACC,UAAI,CAACC,cAAI,CAACC,KAAL,CAAWF,MAAX,CAAL,EACA;CACC,aAAKG,eAAL;CACA;CACD;CAPF,GAXgB;CAoBhBC,EAAAA,OApBgB,qBAqBhB;CACC,SAAKT,IAAL,kCAAgBU,QAAQ,CAACC,gBAAT,CAA0B,sDAA1B,CAAhB;CACA,GAvBe;CAwBhBC,EAAAA,QAAQ,EACR;CACCC,IAAAA,QADD,sBAEC;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,qCAA7B,CAAP;CACA;CAJF,GAzBgB;CA+BhB1B,EAAAA,OAAO,EACP;CACCmB,IAAAA,eADD,6BAEC;CACC,WAAKQ,YAAL,GAAoB,KAAKC,MAAM,CAACC,YAAP,IAAuBD,MAAM,CAACE,kBAAnC,GAApB;CACA,WAAKC,QAAL,GAAgB,KAAKJ,YAAL,CAAkBK,cAAlB,EAAhB;CACA,WAAKC,UAAL,GAAkB,KAAKN,YAAL,CAAkBO,uBAAlB,CAA0C,KAAKnB,WAA/C,CAAlB;CACA,WAAKoB,UAAL,GAAkB,KAAKR,YAAL,CAAkBS,qBAAlB,CAAwC,IAAxC,EAA8C,CAA9C,EAAiD,CAAjD,CAAlB;CAEA,WAAKL,QAAL,CAAcM,qBAAd,GAAsC,GAAtC;CACA,WAAKN,QAAL,CAAcO,OAAd,GAAwB,IAAxB;CAEA,WAAKL,UAAL,CAAgBM,OAAhB,CAAwB,KAAKR,QAA7B;CACA,WAAKA,QAAL,CAAcQ,OAAd,CAAsB,KAAKJ,UAA3B;CACA,WAAKA,UAAL,CAAgBI,OAAhB,CAAwB,KAAKZ,YAAL,CAAkBa,WAA1C;CACA,WAAKL,UAAL,CAAgBM,cAAhB,GAAiC,KAAKC,aAAtC;CACA,KAfF;CAgBCA,IAAAA,aAhBD,2BAiBC;CAAA;;CACC,UAAIC,GAAG,GAAG,IAAIC,UAAJ,CAAe,KAAKb,QAAL,CAAcc,iBAA7B,CAAV;CACA,WAAKd,QAAL,CAAce,oBAAd,CAAmCH,GAAnC;CACA,UAAII,MAAM,GAAG,CAAb;;CAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,GAAG,CAACM,MAAxB,EAAgCD,CAAC,EAAjC,EACA;CACCD,QAAAA,MAAM,IAAIJ,GAAG,CAACK,CAAD,CAAb;CACA;;CACD,UAAIE,OAAO,GAAGH,MAAM,GAAGJ,GAAG,CAACM,MAA3B;CAEA,UAAIE,WAAW,GAAG,MAAM,KAAKxC,IAAL,CAAUsC,MAAlC;CACA,UAAIG,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWJ,OAAO,GAAGC,WAArB,CAAlB;CACA,UAAII,eAAe,GAAG,KAAK5C,IAAL,CAAU6C,KAAV,CAAgB,CAAhB,EAAmBJ,WAAnB,CAAtB;CACA,WAAKzC,IAAL,CAAU8C,OAAV,CAAkB,UAAAC,IAAI,EAAI;CACzBA,QAAAA,IAAI,CAACC,KAAL,CAAWC,eAAX,GAA6B,KAAI,CAAChD,gBAAlC;CACA,OAFD;CAGA2C,MAAAA,eAAe,CAACE,OAAhB,CAAwB,UAAAC,IAAI,EAAI;CAC/BA,QAAAA,IAAI,CAACC,KAAL,CAAWC,eAAX,GAA6B,KAAI,CAAC/C,eAAlC;CACA,OAFD;CAGA;CArCF,GAhCgB;CAuEhBL,EAAAA,QAAQ;CAvEQ,CAAjB;;CCMA,IAAMqD,YAAY,GAAG;CACpBpG,EAAAA,IADoB,kBAEpB;CACC,WAAO;CACNqG,MAAAA,OAAO,EAAE,IADH;CAENC,MAAAA,cAAc,EAAE,IAFV;CAGNC,MAAAA,WAAW,EAAE,IAHP;CAINC,MAAAA,WAAW,EAAE,IAJP;CAKNC,MAAAA,OAAO,EAAE,IALH;CAMNC,MAAAA,kBAAkB,EAAE,KANd;CAONC,MAAAA,YAAY,EAAE,KAPR;CAQNC,MAAAA,cAAc,EAAEC,EAAE,CAACC,IAAH,CAAQC,QAAR,CAAiBC;CAR3B,KAAP;CAUA,GAbmB;CAcpBC,EAAAA,OAdoB,qBAepB;CAAA;;CACC,SAAKC,KAAL,CAAWC,GAAX,CAAe,gBAAf,EAAiC,UAAClF,KAAD,EAAW;CAAC,MAAA,KAAI,CAACmF,mBAAL,CAAyBnF,KAAzB;CAAgC,KAA7E;CACA,SAAKiF,KAAL,CAAWC,GAAX,CAAe,aAAf,EAA8B,UAAClF,KAAD,EAAW;CAAC,MAAA,KAAI,CAACoF,gBAAL,CAAsBpF,KAAtB;CAA6B,KAAvE;CACA,SAAKiF,KAAL,CAAWC,GAAX,CAAe,wBAAf,EAAyC,YAAM;CAAC,MAAA,KAAI,CAACG,cAAL;CAAsB,KAAtE;CACA,SAAKJ,KAAL,CAAWC,GAAX,CAAe,gBAAf,EAAiC,UAACI,QAAD,EAAc;CAAC,MAAA,KAAI,CAACC,gBAAL,CAAsBD,QAAtB;CAAgC,KAAhF;CACA,SAAKL,KAAL,CAAWC,GAAX,CAAe,aAAf,EAA8B,UAACM,KAAD,EAAW;CAAC,MAAA,KAAI,CAACC,aAAL,CAAmBD,KAAnB;CAA0B,KAApE;CAEA,SAAKE,cAAL,GAAsBC,YAAtB,GAAqClH,IAArC,CAA0C,YAAM;CAC/C,MAAA,KAAI,CAACmH,iBAAL;CACA,KAFD,WAES,YAAM;CACdC,MAAAA,gCAAU,CAACC,IAAX,CAAgB;CACf1H,QAAAA,OAAO,EAAE,KAAI,CAACV,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,qCAA5B,CADM;CAEfC,QAAAA,KAAK,EAAE,IAFQ;CAGfC,QAAAA,OAAO,EAAEC,uCAAiB,CAACC;CAHZ,OAAhB;CAKA,KARD;CAUA,GAhCmB;CAiCpBC,EAAAA,SAjCoB,uBAkCpB;CACC;CACA,SAAK9B,WAAL,GAAmB,IAAnB;CACA,GArCmB;CAsCpB1C,EAAAA,QAAQ,EACR;CACCyE,IAAAA,WADD,yBAEC;CACC,UAAI,KAAK5B,YAAT,EACA;CACC,eAAO,KAAK5C,QAAL,CAAc,mDAAd,CAAP;CACA;;CAED,UAAI,KAAK2C,kBAAT,EACA;CACC,eAAO,KAAK3C,QAAL,CAAc,oDAAd,CAAP;CACA;;CAED,aAAO,KAAKA,QAAL,CAAc,6CAAd,CAAP;CACA,KAdF;CAeCA,IAAAA,QAfD,sBAgBC;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,qCAA7B,CAAP;CACA,KAlBF;CAmBCuE,IAAAA,kBAnBD,gCAoBC;CACC,aAAO;CACN,2DAAoD,IAD9C;CAEN,mEAA4D,KAAK5B;CAF3D,OAAP;CAIA;CAzBF,GAvCoB;CAkEpBrE,EAAAA,OAAO,EACP;CACCsF,IAAAA,iBADD,+BAEC;CAAA;;CACC,WAAKlB,YAAL,GAAoB,IAApB;CACA,UAAM8B,WAAW,GAAG;CAACC,QAAAA,KAAK,EAAE,IAAR;CAAcC,QAAAA,KAAK,EAAE;CAArB,OAApB;;CAEA,UAAI,CAACC,kBAAK,CAACC,MAAN,CAAaC,QAAb,EAAL,EACA;CACCL,QAAAA,WAAW,CAACE,KAAZ,GAAoB,EAApB;CACAF,QAAAA,WAAW,CAACE,KAAZ,CAAkBI,KAAlB,GAA0B;CAACC,UAAAA,KAAK;CAAE;CAAsC,UAAO,IAAP;CAA9C,SAA1B;CACAP,QAAAA,WAAW,CAACE,KAAZ,CAAkBM,MAAlB,GAA2B;CAACD,UAAAA,KAAK;CAAE;CAAqC,UAAO,GAAP;CAA7C,SAA3B;CACA;;CAED,UAAInC,EAAE,CAACC,IAAH,CAAQC,QAAR,CAAiBmC,aAArB,EACA;CACC,aAAK5C,cAAL,GAAsBO,EAAE,CAACC,IAAH,CAAQC,QAAR,CAAiBmC,aAAvC;CACAT,QAAAA,WAAW,CAACE,KAAZ,GAAoB;CAACQ,UAAAA,QAAQ,EAAE;CAAEC,YAAAA,KAAK,EAAE,KAAK9C;CAAd;CAAX,SAApB;CACA,OAJD,MAKK,IAAI+C,MAAM,CAACC,IAAP,CAAYzC,EAAE,CAACC,IAAH,CAAQC,QAAR,CAAiBwC,UAA7B,EAAyC/D,MAAzC,KAAoD,CAAxD,EACL;CACCiD,QAAAA,WAAW,CAACE,KAAZ,GAAoB,KAApB;CACA;;CAED,UAAI9B,EAAE,CAACC,IAAH,CAAQC,QAAR,CAAiByC,iBAArB,EACA;CACC,aAAKjD,WAAL,GAAmBM,EAAE,CAACC,IAAH,CAAQC,QAAR,CAAiByC,iBAApC;CACAf,QAAAA,WAAW,CAACC,KAAZ,GAAoB;CAACS,UAAAA,QAAQ,EAAE;CAAEC,YAAAA,KAAK,EAAE,KAAK7C;CAAd;CAAX,SAApB;CACA;;CAEDkD,MAAAA,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoClB,WAApC,EACE/H,IADF,CACO,UAAA6C,MAAM,EAAI;CACf,QAAA,MAAI,CAACoD,YAAL,GAAoB,KAApB;;CACA,QAAA,MAAI,CAACiD,cAAL,CAAoBrG,MAApB;;CACA,YAAIA,MAAM,CAACsG,cAAP,GAAwBrE,MAAxB,GAAiC,CAArC,EACA;CACC,cAAI,CAAC,MAAI,CAACc,cAAV,EACA;CACC,YAAA,MAAI,CAACA,cAAL,GAAsB/C,MAAM,CAACsG,cAAP,GAAwB,CAAxB,EAA2BC,WAA3B,GAAyCX,QAA/D;CACA;;CACD,UAAA,MAAI,CAAC9C,OAAL,GAAe,KAAf;;CACA,UAAA,MAAI,CAAC0D,cAAL;;CACA,UAAA,MAAI,CAACpC,cAAL,GAAsBqC,iBAAtB,CAAwC,MAAI,CAAC1D,cAA7C;CACA;;CACD,YAAI/C,MAAM,CAAC0G,cAAP,GAAwBzE,MAAxB,GAAiC,CAArC,EACA;CACC,cAAI,CAAC,MAAI,CAACe,WAAV,EACA;CACC,YAAA,MAAI,CAACA,WAAL,GAAmBhD,MAAM,CAAC0G,cAAP,GAAwB,CAAxB,EAA2BH,WAA3B,GAAyCX,QAA5D;CACA;;CACD,UAAA,MAAI,CAACxB,cAAL,GAAsBuC,cAAtB,CAAqC,MAAI,CAAC3D,WAA1C;CACA;CACD,OAtBF,WAuBQ,UAAA4D,CAAC,EAAI;CACX,QAAA,MAAI,CAACxD,YAAL,GAAoB,KAApB;CACA9F,QAAAA,oBAAM,CAACuJ,IAAP,CAAY,oCAAZ,EAAkDD,CAAlD;CACA,OA1BF;CA2BA,KAxDF;CAyDCE,IAAAA,cAzDD,4BA0DC;CAAA;;CACC,WAAK1D,YAAL,GAAoB,IAApB;;CACA,UAAInD,cAAI,CAACC,KAAL,CAAW,KAAK6C,cAAhB,KAAmC9C,cAAI,CAACC,KAAL,CAAW,KAAK8C,WAAhB,CAAvC,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAMkC,WAAW,GAAG;CAACE,QAAAA,KAAK,EAAE,KAAR;CAAeD,QAAAA,KAAK,EAAE;CAAtB,OAApB;;CACA,UAAI,KAAKpC,cAAL,IAAuB,CAAC,KAAKD,OAAjC,EACA;CACCoC,QAAAA,WAAW,CAACE,KAAZ,GAAoB;CAACQ,UAAAA,QAAQ,EAAE;CAAEC,YAAAA,KAAK,EAAE,KAAK9C;CAAd;CAAX,SAApB;;CACA,YAAI,CAACsC,kBAAK,CAACC,MAAN,CAAaC,QAAb,EAAL,EACA;CACCL,UAAAA,WAAW,CAACE,KAAZ,CAAkBI,KAAlB,GAA0B;CAACC,YAAAA,KAAK;CAAE;CAAsC,YAAO,IAAP;CAA9C,WAA1B;CACAP,UAAAA,WAAW,CAACE,KAAZ,CAAkBM,MAAlB,GAA2B;CAACD,YAAAA,KAAK;CAAE;CAAqC,YAAO,GAAP;CAA7C,WAA3B;CACA;CACD;;CACD,UAAI,KAAKzC,WAAT,EACA;CACCkC,QAAAA,WAAW,CAACC,KAAZ,GAAoB;CAAES,UAAAA,QAAQ,EAAE;CAAEC,YAAAA,KAAK,EAAE,KAAK7C;CAAd;CAAZ,SAApB;CACA;;CAEDkD,MAAAA,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoClB,WAApC,EAAiD/H,IAAjD,CAAsD,UAAA6C,MAAM,EAAI;CAC/D,QAAA,MAAI,CAACoD,YAAL,GAAoB,KAApB;;CACA,QAAA,MAAI,CAACiD,cAAL,CAAoBrG,MAApB;;CACA,YAAIA,MAAM,CAACsG,cAAP,GAAwBrE,MAAxB,GAAiC,CAArC,EACA;CACC,UAAA,MAAI,CAACuE,cAAL;CACA;CACD,OAPD,WAOS,UAAAnJ,KAAK,EAAI;CACjB,QAAA,MAAI,CAAC+F,YAAL,GAAoB,KAApB;CACA9F,QAAAA,oBAAM,CAACuJ,IAAP,CAAY,iCAAZ,EAA+CxJ,KAA/C;CACA,QAAA,MAAI,CAACyF,OAAL,GAAe,IAAf;;CACA,QAAA,MAAI,CAACsB,cAAL,GAAsB2C,cAAtB,CAAqC,KAArC;CACA,OAZD;CAaA,KA7FF;CA8FCV,IAAAA,cA9FD,0BA8FgBrG,MA9FhB,EA+FC;CACC,WAAKiD,WAAL,GAAmBjD,MAAnB;CACA,WAAKoE,cAAL,GAAsB4C,mBAAtB,CAA0C,KAAK/D,WAA/C;CACA,KAlGF;CAmGCuD,IAAAA,cAnGD,4BAoGC;CACClJ,MAAAA,oBAAM,CAACuJ,IAAP,CAAY,qBAAZ;CACA,WAAK/D,OAAL,GAAe,KAAf;CACA,WAAKK,kBAAL,GAA0B,KAA1B;CACA,WAAKiB,cAAL,GAAsB2C,cAAtB,CAAqC,IAArC;CACA,WAAKE,KAAL,CAAW,OAAX,EAAoBC,MAApB,GAA6B,CAA7B;CACA,WAAKD,KAAL,CAAW,OAAX,EAAoBE,SAApB,GAAgC,KAAKlE,WAArC;CACA,WAAKgE,KAAL,CAAW,OAAX,EAAoBG,IAApB;CACA,KA5GF;CA6GCrD,IAAAA,cA7GD,4BA8GC;CACC,UAAG,CAAC,KAAKd,WAAT,EACA;CACC;CACA;;CACD,WAAKA,WAAL,CAAiBoE,SAAjB,GAA6B5E,OAA7B,CAAqC,UAAA6E,EAAE;CAAA,eAAIA,EAAE,CAACC,IAAH,EAAJ;CAAA,OAAvC;CACA,WAAKtE,WAAL,GAAmB,IAAnB;CACA,WAAKmB,cAAL,GAAsBoD,oBAAtB;CACA,KAtHF;CAuHCvD,IAAAA,gBAvHD,4BAuHkBD,QAvHlB,EAwHC;CACC,WAAKD,cAAL;CACA,WAAKhB,cAAL,GAAsBiB,QAAtB;CACA,WAAK8C,cAAL;CACA,KA5HF;CA6HC3C,IAAAA,aA7HD,yBA6HeD,KA7Hf,EA8HC;CACC;CACH;CACA;CACG,KAlIF;CAmICL,IAAAA,mBAnID,+BAmIqBnF,KAnIrB,EAoIC;CACC,UAAIA,KAAJ,EACA;CACC,aAAKoE,OAAL,GAAe,KAAf;CACA,aAAKgE,cAAL;CACA,OAJD,MAMA;CACC,aAAK/C,cAAL;CACA,aAAKZ,kBAAL,GAA0B,IAA1B;CACA,aAAKL,OAAL,GAAe,IAAf;CACA,aAAKsB,cAAL,GAAsB2C,cAAtB,CAAqC,KAArC;CACA;CACD,KAjJF;CAkJCjD,IAAAA,gBAlJD,4BAkJkBpF,KAlJlB,EAmJC;CACC,UAAIA,KAAJ,EACA;CACC,aAAKoI,cAAL;CACA;;CAED,WAAK5D,OAAL,GAAexE,KAAf;CACA,KA1JF;CA2JC6G,IAAAA,QA3JD,sBA4JC;CACC,aAAOF,kBAAK,CAACC,MAAN,CAAaC,QAAb,EAAP;CACA,KA9JF;CA+JCnB,IAAAA,cA/JD,4BAgKC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CAlKF,GAnEoB;CAuOpBkL,EAAAA,UAAU,EACT;CAAEhI,IAAAA,QAAQ,EAARA;CAAF,GAxOmB;CAyOpBD,EAAAA,QAAQ;CAzOY,CAArB;;;;;CCDA,IAAMkI,KAAK,GAAG;CACbjL,EAAAA,IADa,kBAEb;CACC,WAAO;CACNkL,MAAAA,sBAAsB,EAAE,QADlB;CAENC,MAAAA,gBAAgB,EAAE;CAFZ,KAAP;CAIA,GAPY;CAQbrH,EAAAA,QAAQ;CAEPsH,IAAAA,SAFO,uBAGP;CACC,aAAO,KAAKlJ,UAAL,CAAgBmJ,MAAhB,CAAuBzK,KAA9B;CACA,KALM;CAMP0K,IAAAA,YANO,0BAOP;CACC,aAAO,KAAKF,SAAL,KAAmBG,4BAAmB,CAACD,YAA9C;CACA,KATM;CAUPE,IAAAA,kBAVO,gCAWP;CACC,aAAO,KAAKJ,SAAL,KAAmBG,4BAAmB,CAACC,kBAA9C;CACA,KAbM;CAcPC,IAAAA,gBAdO,8BAeP;CACC,aAAO,KAAKL,SAAL,KAAmBG,4BAAmB,CAACE,gBAA9C;CACA,KAjBM;CAkBPC,IAAAA,cAlBO,4BAmBP;CACC,aAAO,KAAKN,SAAL,KAAmBG,4BAAmB,CAACG,cAA9C;CACA,KArBM;CAsBPC,IAAAA,UAtBO,wBAuBP;CACC,aAAO,KAAKP,SAAL,KAAmBG,4BAAmB,CAACI,UAA9C;CACA,KAzBM;CA0BPC,IAAAA,kBA1BO,gCA2BP;CACC,aAAO,KAAKR,SAAL,KAAmBG,4BAAmB,CAACM,QAA9C;CACA,KA7BM;CA8BPC,IAAAA,kBA9BO,gCA+BP;CACC,aAAO,KAAKV,SAAL,KAAmBG,4BAAmB,CAACO,kBAA9C;CACA,KAjCM;CAkCPC,IAAAA,iBAlCO,+BAmCP;CACC,aAAO,KAAKX,SAAL,KAAmBG,4BAAmB,CAACQ,iBAA9C;CACA,KArCM;CAsCPC,IAAAA,gBAtCO,8BAuCP;CACC,aAAO,KAAKZ,SAAL,KAAmBG,4BAAmB,CAACS,gBAA9C;CACA,KAzCM;CA0CPC,IAAAA,kBA1CO,gCA2CP;CACC,aAAO,KAAKb,SAAL,KAAmBG,4BAAmB,CAACU,kBAA9C;CACA,KA7CM;CA8CPC,IAAAA,YA9CO,0BA+CP;CACC,aAAO,KAAKd,SAAL,KAAmBG,4BAAmB,CAACW,YAA9C;CACA,KAjDM;CAkDPC,IAAAA,YAlDO,0BAmDP;CACCC,MAAAA,OAAO,CAAChC,IAAR,CAAa,gCAAb,EAA+C,KAAKzK,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAA/C;CACAsM,MAAAA,OAAO,CAAChC,IAAR,CAAa,6CAAb,EAA4D,KAAKzK,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,GAA+BqM,YAA3F;CACA,aAAO,KAAKxM,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,GAA+BqM,YAAtC;CACA,KAvDM;CAwDPE,IAAAA,WAxDO,yBAyDP;CACCD,MAAAA,OAAO,CAAChC,IAAR,CAAa,4CAAb,EAA2D,KAAKzK,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,GAA+BuM,WAA1F;CACA,aAAO,KAAK1M,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,GAA+BuM,WAAtC;CACA,KA5DM;CA6DPtI,IAAAA,QA7DO,sBA8DP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CAhEM,KAiEJqI,gBAAI,CAACC,QAAL,CAAc;CAChBrK,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA;CADD,GAAd,CAjEI,CARK;CA6EbK,EAAAA,OAAO,EACP;CACCiK,IAAAA,UADD,wBAEC;CACCC,MAAAA,QAAQ,CAACC,MAAT;CACA,KAJF;CAKCC,IAAAA,mBALD,iCAMC;CACCF,MAAAA,QAAQ,CAACG,IAAT,GAAgBH,QAAQ,CAACI,MAAT,GAAkB,iBAAlB,GAAsCJ,QAAQ,CAACK,QAA/D;CACA,KARF;CASCC,IAAAA,eATD,6BAUC;CACCC,MAAAA,oBAAM,CAACC,GAAP,CAAW,IAAX,4BAAoC,KAAK/K,UAAL,CAAgBmJ,MAAhB,CAAuB6B,KAA3D,GAAoE,EAApE,EAAwE;CAACC,QAAAA,IAAI,EAAE;CAAP,OAAxE;CACAV,MAAAA,QAAQ,CAACC,MAAT,CAAgB,IAAhB;CACA,KAbF;CAcCU,IAAAA,SAdD,uBAeC;CACC,2CAA8B,KAAKzN,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,GAA+BuN,QAA/B,EAA9B;CACA,KAjBF;CAkBCC,IAAAA,eAlBD,6BAmBC;CACC,UAAIzG,EAAE,CAAC0G,MAAP,EACA;CACC1G,QAAAA,EAAE,CAAC0G,MAAH,CAAUxF,IAAV,CAAe,0BAA0B,KAAKmD,sBAA9C;CACA;CACD,KAxBF;CAyBCpC,IAAAA,QAzBD,sBA0BC;CACC,aAAOF,kBAAK,CAACC,MAAN,CAAaC,QAAb,EAAP;CACA,KA5BF;CA6BC0E,IAAAA,cA7BD,4BA8BC;CAAA;;CACCC,MAAAA,UAAU,CAAC,YAAM;CAChB,QAAA,KAAI,CAACtC,gBAAL,GAAwB,IAAxB;CACA,OAFS,EAEP,IAFO,CAAV;CAGA;CAlCF,GA9Ea;CAkHbpI,EAAAA,QAAQ;CAlHK,CAAd;;CCRA,IAAM2K,mBAAmB,GAAG;CAC3B3K,EAAAA,QAAQ;CADmB,CAA5B;;;;;CCKA,IAAM4K,aAAa,GAAG;CACrB3N,EAAAA,IADqB,kBAErB;CACC,WAAO;CACN4N,MAAAA,QAAQ,EAAE,EADJ;CAENC,MAAAA,gBAAgB,EAAE,EAFZ;CAGNC,MAAAA,aAAa,EAAE;CAHT,KAAP;CAKA,GARoB;CASrB7G,EAAAA,OATqB,qBAUrB;CACCrE,IAAAA,6BAAY,CAACmL,SAAb,CAAuBjL,kBAAS,CAACZ,UAAV,CAAqB8L,gBAA5C,EAA8D,KAAKC,kBAAnE;CACA,GAZoB;CAarBC,EAAAA,aAbqB,2BAcrB;CACCtL,IAAAA,6BAAY,CAACuL,WAAb,CAAyBrL,kBAAS,CAACZ,UAAV,CAAqB8L,gBAA9C,EAAgE,KAAKC,kBAArE;CACA,GAhBoB;CAiBrBnK,EAAAA,QAAQ;CAEPsK,IAAAA,eAFO,6BAGP;CACC,aAAO,KAAKlM,UAAL,CAAgBmJ,MAAhB,CAAuB+C,eAA9B;CACA,KALM;CAMPrK,IAAAA,QANO,sBAOP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CATM,KAUJqI,gBAAI,CAACC,QAAL,CAAc;CAChBrK,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA;CADD,GAAd,CAVI,CAjBa;CA+BrBK,EAAAA,OAAO,EACP;CACC0L,IAAAA,kBADD,gCAEC;CACC,WAAKzD,KAAL,CAAW,eAAX,EAA4B6D,KAA5B;CACA,KAJF;CAKCC,IAAAA,aALD,2BAMC;CAAA;;CACC,UAAI,CAAC,KAAKV,QAAN,IAAkB,KAAKC,gBAA3B,EACA;CACC,aAAKC,aAAL,GAAqB,IAArB;CAEA,eAAO,KAAP;CACA;;CACD,WAAKD,gBAAL,GAAwB,IAAxB;CACA,WAAKC,aAAL,GAAqB,KAArB;CACA,WAAKnG,cAAL,GAAsB2G,aAAtB,CAAoC,KAAKV,QAAzC,WACQ,YAAM;CACZ,QAAA,KAAI,CAACE,aAAL,GAAqB,IAArB;CACA,OAHF,aAIU,YAAM;CACd,QAAA,KAAI,CAACD,gBAAL,GAAwB,KAAxB;CACA,OANF;CAOA,KAtBF;CAuBClG,IAAAA,cAvBD,4BAwBC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CA1BF,GAhCqB;CA4DrB;CACAiD,EAAAA,QAAQ;CA7Da,CAAtB;;CCHA,IAAMwL,aAAa,GAAG;CACrBzK,EAAAA,QAAQ,EACR;CACCC,IAAAA,QADD,sBAEC;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CAJF,GAFqB;CAQrB;CACAlB,EAAAA,QAAQ;CATa,CAAtB;;CCGA,IAAMyL,sBAAsB,GAAG,iBAA/B;CACA,IAAMC,oBAAoB,GAAG,eAA7B;CAEA,IAAMC,kBAAkB,GAAG;CAC1BzL,EAAAA,KAAK,EAAE;CACN0L,IAAAA,WAAW,EAAE;CACZC,MAAAA,IAAI,EAAEC,OADM;CAEZC,MAAAA,QAAQ,EAAE,KAFE;CAGZ,iBAAS;CAHG;CADP,GADmB;CAQ1B7H,EAAAA,OAR0B,qBAS1B;CACCrE,IAAAA,6BAAY,CAACmL,SAAb,CAAuBjL,kBAAS,CAACZ,UAAV,CAAqB6M,kBAA5C,EAAgE,KAAKC,oBAArE;CACA,GAXyB;CAY1Bd,EAAAA,aAZ0B,2BAa1B;CACCtL,IAAAA,6BAAY,CAACuL,WAAb,CAAyBrL,kBAAS,CAACZ,UAAV,CAAqB6M,kBAA9C,EAAkE,KAAKC,oBAAvE;CACA,GAfyB;CAgB1BlL,EAAAA,QAAQ,EACR;CACCC,IAAAA,QADD,sBAEC;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CAJF,GAjB0B;CAuB1B1B,EAAAA,OAAO,EACP;CACCyM,IAAAA,oBADD,kCAEC;CACC,WAAKD,kBAAL;CACA,KAJF;CAKCA,IAAAA,kBALD,gCAMC;CAAA;;CACC,WAAKpH,cAAL,GAAsBC,YAAtB,GAAqClH,IAArC,CAA0C,YAAM;CAC/C,eAAO+I,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoC;CAACjB,UAAAA,KAAK,EAAE,IAAR;CAAcC,UAAAA,KAAK,EAAE;CAArB,SAApC,CAAP;CACA,OAFD,EAEGjI,IAFH,CAEQ,YAAM;CACb,QAAA,KAAI,CAACuO,2BAAL;CACA,OAJD,WAIS,UAACrO,KAAD,EAAW;CACnB,YAAIA,KAAK,CAACY,IAAN,KAAegN,sBAAnB,EACA;CACC,UAAA,KAAI,CAACU,cAAL,CAAoB,KAAI,CAACnL,QAAL,CAAc,wCAAd,CAApB;;CAEA,iBAAO,KAAP;CACA,SALD,MAMK,IAAInD,KAAK,CAACY,IAAN,KAAeiN,oBAAnB,EACL;CACC;CACA,iBAAOhF,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoC;CAACjB,YAAAA,KAAK,EAAE,IAAR;CAAcC,YAAAA,KAAK,EAAE;CAArB,WAApC,EAAiEjI,IAAjE,CAAsE,YAAM;CAClF,YAAA,KAAI,CAACuO,2BAAL;CACA,WAFM,WAEE,UAACrO,KAAD,EAAW;CACnB,gBAAIA,KAAK,CAACY,IAAN,KAAegN,sBAAnB,EACA;CACC,cAAA,KAAI,CAACU,cAAL,CAAoB,KAAI,CAACnL,QAAL,CAAc,wCAAd,CAApB;;CAEA,qBAAO,KAAP;CACA;CACD,WATM,CAAP;CAUA;;CAED,QAAA,KAAI,CAACmL,cAAL,CAAoB,KAAI,CAACnL,QAAL,CAAc,qCAAd,CAApB;CACA,OA3BD;CA4BA,KAnCF;CAoCCkL,IAAAA,2BApCD,yCAqCC;CAAA;;CACC,WAAKE,SAAL,CAAe;CAAA,eAAM,MAAI,CAACC,MAAL,CAAYC,QAAZ,CAAqB,oCAArB,EAA2D;CAACC,UAAAA,MAAM,EAAE;CAAT,SAA3D,CAAN;CAAA,OAAf;CACA,KAvCF;CAwCCJ,IAAAA,cAxCD,0BAwCgBK,IAxChB,EAyCC;CACCzH,MAAAA,gCAAU,CAACC,IAAX,CAAgB;CACf1H,QAAAA,OAAO,EAAEkP,IADM;CAEfrH,QAAAA,KAAK,EAAE,IAFQ;CAGfC,QAAAA,OAAO,EAAEC,uCAAiB,CAACC;CAHZ,OAAhB;CAKA,KA/CF;CAgDCV,IAAAA,cAhDD,4BAiDC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CAnDF,GAxB0B;CA6E1B;CACAiD,EAAAA,QAAQ;CA9EkB,CAA3B;;;;;CCLA,IAAMyM,gBAAgB,GAAG;CACxB1L,EAAAA,QAAQ;CAEP2L,IAAAA,aAFO,2BAGP;CACC,UAAI,KAAKC,MAAT,EACA;CACC,eAAO,KAAKA,MAAL,CAAYC,OAAnB;CACA;CACD,KARM;CASPC,IAAAA,WATO,yBAUP;CACC,aAAO,KAAK1N,UAAL,CAAgBmJ,MAAhB,CAAuBwE,SAA9B;CACA,KAZM;CAaP9L,IAAAA,QAbO,sBAcP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CAhBM,KAiBJqI,gBAAI,CAACC,QAAL,CAAc;CAChBmD,IAAAA,MAAM,EAAE,gBAAAzN,KAAK;CAAA,aAAIA,KAAK,CAAC6N,SAAN,CAAgBC,UAAhB,CAA2B9N,KAAK,CAACrC,WAAN,CAAkB8P,MAAlB,CAAyBM,QAApD,CAAJ;CAAA,KADG;CAEhB9N,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA;CAFD,GAAd,CAjBI,CADgB;CAuBxBK,EAAAA,OAAO,EACP;CACC0N,IAAAA,QADD,sBAEC;CACC,WAAKtI,cAAL,GAAsBuI,UAAtB;CACA,KAJF;CAKCC,IAAAA,YALD,0BAMC;CACC,WAAKxI,cAAL,GAAsByI,cAAtB;CACA,KARF;CASCzI,IAAAA,cATD,4BAUC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CAZF,GAxBwB;CAsCxBiD,EAAAA,QAAQ;CAtCgB,CAAzB;;;;;CCAA,IAAMsN,cAAc,GAAG;CACtBpN,EAAAA,KAAK,EAAE;CACNqN,IAAAA,WAAW,EAAE;CACZ1B,MAAAA,IAAI,EAAEC,OADM;CAEZC,MAAAA,QAAQ,EAAE,KAFE;CAGZ,iBAAS;CAHG;CADP,GADe;CAQtB9O,EAAAA,IARsB,kBAStB;CACC,WAAO;CACNuQ,MAAAA,kBAAkB,EAAE,EADd;CAENC,MAAAA,gBAAgB,EAAE;CAFZ,KAAP;CAIA,GAdqB;CAetBvJ,EAAAA,OAfsB,qBAgBtB;CAAA;;CACC,QAAI,KAAKwJ,iBAAT,EACA;CACC,WAAKC,wBAAL;CACA,WAAKF,gBAAL,GAAwBG,WAAW,CAAC,YAAM;CACzC,QAAA,KAAI,CAACD,wBAAL;CACA,OAFkC,EAEhC,IAFgC,CAAnC;CAGA;CACD,GAxBqB;CAyBtBxC,EAAAA,aAzBsB,2BA0BtB;CACC0C,IAAAA,aAAa,CAAC,KAAKJ,gBAAN,CAAb;CACA,GA5BqB;CA6BtB1M,EAAAA,QAAQ;CAEP2M,IAAAA,iBAFO,+BAGP;CACC,aAAO,KAAKvO,UAAL,CAAgBmJ,MAAhB,CAAuBoF,iBAA9B;CACA,KALM;CAMPI,IAAAA,mBANO,iCAOP;CACC,aAAO,KAAK3O,UAAL,CAAgBmJ,MAAhB,CAAuBwF,mBAA9B;CACA,KATM;CAUPzC,IAAAA,eAVO,6BAWP;CACC,aAAO,KAAKlM,UAAL,CAAgBmJ,MAAhB,CAAuB+C,eAA9B;CACA,KAbM;CAcP0C,IAAAA,MAdO,oBAeP;CACC,aAAO,KAAKlR,WAAL,CAAiByL,MAAjB,CAAwByF,MAA/B;CACA,KAjBM;CAkBPC,IAAAA,WAlBO,yBAmBP;CACC,aAAO,KAAK7O,UAAL,CAAgBmJ,MAAhB,CAAuB0F,WAA9B;CACA,KArBM;CAsBPC,IAAAA,cAtBO,4BAuBP;CACC,aAAO,KAAK9O,UAAL,CAAgBmJ,MAAhB,CAAuB4F,UAA9B;CACA,KAzBM;CA0BPC,IAAAA,cA1BO,4BA2BP;CACC,aAAO,KAAK9B,MAAL,CAAY+B,OAAZ,CAAoB,eAApB,EAAqC,KAAKH,cAA1C,CAAP;CACA,KA7BM;CA8BPI,IAAAA,uBA9BO,qCA+BP;CACC,UAAMC,eAAe,GAAG,KAAKL,cAAL,CAAoBxL,MAA5C;CACA,UAAM8L,MAAM,GAAGD,eAAe,GAAG,CAAlB,GAAsB,KAAKtN,QAAL,CAAc,wCAAd,CAAtB,GAAgF,KAAKA,QAAL,CAAc,8BAAd,CAA/F;CACA,UAAMkN,UAAU,GAAG,KAAKC,cAAL,CAAoBK,GAApB,CAAwB,UAAApP,IAAI;CAAA,eAAIA,IAAI,CAACX,IAAT;CAAA,OAA5B,EAA2CgQ,IAA3C,CAAgD,IAAhD,CAAnB;CAEA,uBAAUF,MAAV,eAAqBL,UAArB;CACA,KArCM;CAsCPQ,IAAAA,sBAtCO,oCAuCP;CACC,aAAO,KAAKT,cAAL,CAAoBU,QAApB,CAA6B,KAAKZ,MAAlC,CAAP;CACA,KAzCM;CA0CPa,IAAAA,oBA1CO,kCA2CP;CACC,UAAI,KAAKlB,iBAAL,KAA2B,IAA/B,EACA;CACC,yBAAU,KAAK1M,QAAL,CAAc,qCAAd,CAAV,eAAmE,KAAKwM,kBAAxE;CACA,OAHD,MAIK,IAAI,KAAKE,iBAAL,KAA2B,KAA/B,EACL;CACC,eAAO,KAAK1M,QAAL,CAAc,yCAAd,CAAP;CACA,OAHI,MAIA,IAAI,KAAK0M,iBAAL,KAA2B,IAA/B,EACL;CACC,eAAO,KAAK1M,QAAL,CAAc,qCAAd,CAAP;CACA;CACD,KAxDM;CAyDP6N,IAAAA,uBAzDO,qCA0DP;CACC,aAAO,CACN,kCADM,EAEN,KAAKnB,iBAAL,GAAwB,yCAAxB,GAAoE,6CAF9D,CAAP;CAIA,KA/DM;CAgEPoB,IAAAA,gBAhEO,8BAiEP;CACC,aAAO,CAAC,KAAKvB,WAAL,GAAkB,6CAAlB,GAAkE,qCAAnE,CAAP;CACA,KAnEM;CAoEPvM,IAAAA,QApEO,sBAqEP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CAvEM,KAwEJqI,gBAAI,CAACC,QAAL,CAAc;CAChBrK,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA;CADD,GAAd,CAxEI,CA7Bc;CAyGtBmB,EAAAA,KAAK,EACL;CACCoN,IAAAA,iBADD,6BACmBqB,QADnB,EAEC;CAAA;;CACC,UAAIA,QAAQ,KAAK,IAAjB,EACA;CACC,aAAKtB,gBAAL,GAAwBG,WAAW,CAAC,YAAM;CACzC,UAAA,MAAI,CAACD,wBAAL;CACA,SAFkC,EAEhC,IAFgC,CAAnC;CAGA;;CAED,WAAKA,wBAAL;CACA;CAXF,GA1GsB;CAuHtBnO,EAAAA,OAAO,EACP;CACCmO,IAAAA,wBADD,sCAEC;CACC,UAAI,CAAC,KAAKG,mBAAV,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAMkB,SAAS,GAAG,KAAKlB,mBAAvB;CACA,UAAMmB,WAAW,GAAG,IAAIC,IAAJ,EAApB;CAEA,UAAIC,iBAAiB,GAAGtM,IAAI,CAACuM,KAAL,CAAW,CAACH,WAAW,GAAGD,SAAf,IAA4B,IAAvC,CAAxB;CACA,UAAIK,OAAO,GAAG,CAAd;;CACA,UAAIF,iBAAiB,GAAG,EAAxB,EACA;CACCE,QAAAA,OAAO,GAAGxM,IAAI,CAACuM,KAAL,CAAWD,iBAAiB,GAAG,EAA/B,CAAV;;CACA,YAAIE,OAAO,GAAG,EAAd,EACA;CACCA,UAAAA,OAAO,GAAG,MAAMA,OAAhB;CACA;CACD;;CACD,UAAIC,OAAO,GAAGH,iBAAiB,GAAIE,OAAO,GAAG,EAA7C;;CACA,UAAIC,OAAO,GAAG,EAAd,EACA;CACCA,QAAAA,OAAO,GAAG,MAAMA,OAAhB;CACA;;CACD,WAAK9B,kBAAL,aAA6B6B,OAA7B,cAAwCC,OAAxC;CAEA,aAAO,IAAP;CACA;CA7BF,GAxHsB;CAuJtB;CACAtP,EAAAA,QAAQ;CAxJc,CAAvB;;;;;CCIA,IAAMuP,QAAQ,GAAG;CAChBtS,EAAAA,IADgB,kBAEhB;CACC,WAAO;CACNuS,MAAAA,WAAW,EAAE;CADP,KAAP;CAGA,GANe;CAOhBzO,EAAAA,QAAQ;CAEP2M,IAAAA,iBAFO,+BAGP;CACC,aAAO,KAAKvO,UAAL,CAAgBmJ,MAAhB,CAAuBoF,iBAA9B;CACA,KALM;CAMP+B,IAAAA,eANO,6BAOP;CACC,UAAI,KAAKrQ,IAAT,EACA;CACC,eAAO,KAAKA,IAAL,CAAUX,IAAV,KAAmB,KAAKuC,QAAL,CAAc,wCAAd,CAA1B;CACA;;CAED,aAAO,KAAP;CACA,KAdM;CAeP0O,IAAAA,mBAfO,iCAgBP;CACC,UAAI,KAAKtQ,IAAL,IAAa,CAAC,KAAKA,IAAL,CAAUuQ,QAAxB,IAAoC,KAAKvQ,IAAL,CAAUwQ,MAAlD,EACA;CACC,eAAO;CACNC,UAAAA,eAAe,iBAAU,KAAKzQ,IAAL,CAAUwQ,MAApB;CADT,SAAP;CAGA;;CAED,aAAO,EAAP;CACA,KAzBM;CA0BPE,IAAAA,UA1BO,wBA2BP;CACC,uBAAU,KAAKC,UAAf,gCAA+CjM,EAAE,CAACkM,aAAH,EAA/C;CACA,KA7BM;CA8BPD,IAAAA,UA9BO,wBA+BP;CACC,UAAI,KAAKpD,MAAT,EACA;CACC,eAAO,KAAKA,MAAL,WAAmBsD,IAA1B;CACA;CACD,KApCM;CAqCPlC,IAAAA,MArCO,oBAsCP;CACC,aAAO,KAAKlR,WAAL,CAAiByL,MAAjB,CAAwByF,MAA/B;CACA,KAxCM;CAyCPC,IAAAA,WAzCO,yBA0CP;CACC,aAAO,KAAK7O,UAAL,CAAgBmJ,MAAhB,CAAuB0F,WAA9B;CACA,KA5CM;CA6CPC,IAAAA,cA7CO,4BA8CP;CACC,aAAO,KAAK9O,UAAL,CAAgBmJ,MAAhB,CAAuB4F,UAA9B;CACA,KAhDM;CAiDPQ,IAAAA,sBAjDO,oCAkDP;CACC,aAAO,KAAKT,cAAL,CAAoBU,QAApB,CAA6B,KAAKZ,MAAlC,CAAP;CACA,KApDM;CAqDP/M,IAAAA,QArDO,sBAsDP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA,KAxDM;CAyDPgP,IAAAA,sBAzDO,oCA0DP;CACC,UAAMC,OAAO,GAAG,CAAC,QAAD,EAAW,WAAX,EAAwB,gBAAxB,EAA0C,iCAA1C,CAAhB;;CAEA,UAAI,CAAC,KAAKvL,cAAL,GAAsBwL,cAA3B,EACA;CACCD,QAAAA,OAAO,CAACE,IAAR,CAAa,iBAAb;CACA;;CAED,aAAOF,OAAP;CACA,KAnEM;CAoEPG,IAAAA,sBApEO,oCAqEP;CACC,UAAMH,OAAO,GAAG,CAAC,QAAD,EAAW,WAAX,EAAwB,iCAAxB,CAAhB;;CAEA,UAAI,CAAC,KAAKvL,cAAL,GAAsBwL,cAA3B,EACA;CACCD,QAAAA,OAAO,CAACE,IAAR,CAAa,iBAAb;CACA;;CAED,aAAOF,OAAP;CACA;CA9EM,KA+EJ5G,gBAAI,CAACC,QAAL,CAAc;CAChBpK,IAAAA,IAAI,EAAE,cAAAF,KAAK;CAAA,aAAIA,KAAK,CAACqR,KAAN,CAAYvD,UAAZ,CAAuB9N,KAAK,CAACrC,WAAN,CAAkByL,MAAlB,CAAyByF,MAAhD,CAAJ;CAAA,KADK;CAEhBlR,IAAAA,WAAW,EAAE,qBAAAqC,KAAK;CAAA,aAAIA,KAAK,CAACrC,WAAV;CAAA,KAFF;CAGhBsC,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA;CAHD,GAAd,CA/EI,CAPQ;CA4FhBK,EAAAA,OAAO,EACP;CACCgR,IAAAA,eADD,iCAEC;CAAA,UADkB5K,KAClB,QADkBA,KAClB;CACC,WAAKhB,cAAL,GAAsB6L,SAAtB,CAAgC7K,KAAhC;CACA,KAJF;CAKC8K,IAAAA,cALD,iCAMC;CAAA,UADiB9K,KACjB,SADiBA,KACjB;;CACC,UAAI,KAAKxG,IAAL,CAAUuQ,QAAV,IAAsB,CAAC,KAAKF,eAAhC,EACA;CACC,aAAKkB,UAAL;CACA;;CAED,UAAI,CAAC,KAAKjD,iBAAV,EACA;CACC7N,QAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAACZ,UAAV,CAAqByR,YAAvC;CAEA,aAAKhM,cAAL,GAAsBiM,kBAAtB;CACA,aAAKjM,cAAL,GAAsBkM,WAAtB,CAAkClL,KAAlC;CACA,OAND,MAQA;CACC,YAAMmL,UAAU,GAAG,KAAK/C,WAAL,IAAoB,CAAC,KAAKU,sBAA7C;CACA5Q,QAAAA,oBAAM,CAACuJ,IAAP,CAAY,oBAAZ,EAAkCzB,KAAlC,EAAyCmL,UAAzC;;CACA,YAAIA,UAAJ,EACA;CACC,eAAKnM,cAAL,GAAsBoM,QAAtB,CAA+B,KAAKpM,cAAL,GAAsBqM,OAAtB,CAA8B5S,EAA7D,EAAiE;CAChE6S,YAAAA,YAAY,EAAE;CADkD,WAAjE;CAGA,SALD,MAOA;CACC,eAAKtM,cAAL,GAAsB6L,SAAtB,CAAgC7K,KAAhC;CACA;CACD;CACD,KAlCF;CAmCC+K,IAAAA,UAnCD,wBAoCC;CACC,UAAI,KAAKnB,WAAL,CAAiB/M,MAAjB,GAA0B,CAA9B,EACA;CACC,aAAKmC,cAAL,GAAsBuM,WAAtB,CAAkC,KAAK3B,WAAL,CAAiB4B,IAAjB,EAAlC;CACA;CACD,KAzCF;CA0CCxM,IAAAA,cA1CD,4BA2CC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA,KA7CF;CA8CCsU,IAAAA,SA9CD,uBA+CC;CACC,aAAOxL,kBAAK,CAACyL,QAAN,CAAeC,eAAf,EAAP;CACA;CAjDF,GA7FgB;CAgJhBvR,EAAAA,QAAQ;CAhJQ,CAAjB;;;;;CCFA,IAAMwR,UAAU,GAAG;CAClBtN,EAAAA,OADkB,qBAElB;CACC,SAAKuN,OAAL,GAAe,IAAIC,sBAAJ,EAAf;CACA,GAJiB;CAKlB3Q,EAAAA,QAAQ;CAEP4Q,IAAAA,gBAFO,8BAGP;CACC,aAAO9L,kBAAK,CAACyL,QAAN,CAAeC,eAAf,OACF,KAAKE,OAAL,CAAaG,aAAb,MAAgC,EAAhC,IAAsC,CAAC/L,kBAAK,CAACyL,QAAN,CAAeO,SAAf,EADrC,KAEH,CAAC,KAAKjN,cAAL,GAAsBkN,cAAtB,EAFE,IAGH,KAAKC,YAAL,GAAoB,CAHxB;CAIA,KARM;CASPA,IAAAA,YATO,0BAUP;CACC,aAAO,KAAK5S,UAAL,CAAgBmJ,MAAhB,CAAuByJ,YAA9B;CACA,KAZM;CAaPC,IAAAA,gBAbO,8BAcP;CACC,aAAO,KAAKD,YAAL,GAAoB,EAApB,GAAyB,KAAzB,GAAiC,KAAKA,YAA7C;CACA,KAhBM;CAiBP/Q,IAAAA,QAjBO,sBAkBP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CApBM,KAqBJqI,gBAAI,CAACC,QAAL,CAAc;CAChBrK,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA;CADD,GAAd,CArBI,CALU;CA8BlBK,EAAAA,OAAO,EACP;CACCyS,IAAAA,WADD,yBAEC;CACC,WAAKrN,cAAL,GAAsBuI,UAAtB;CACA,KAJF;CAKC+E,IAAAA,mBALD,iCAMC;CACC,UAAIC,MAAM,IAAIA,MAAM,CAACC,eAArB,EACA;CACCD,QAAAA,MAAM,CAACC,eAAP,CAAuBC,cAAvB,CAAsC,aAAtC;CACA;CACD,KAXF;CAYCzN,IAAAA,cAZD,4BAaC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CAfF,GA/BkB;CAgDlBiD,EAAAA,QAAQ;CAhDU,CAAnB;;;;;CCFA,IAAMsS,eAAe,GAAG;CACvBvR,EAAAA,QAAQ;CAEP8L,IAAAA,WAFO,yBAGP;CACC,aAAO,KAAKF,MAAL,CAAYE,WAAnB;CACA,KALM;CAMP7L,IAAAA,QANO,sBAOP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,uBAA7B,CAAP;CACA;CATM,KAUJqI,gBAAI,CAACC,QAAL,CAAc;CAChBrK,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA,KADD;CAEhBwN,IAAAA,MAAM,EAAE,gBAAAzN,KAAK;CAAA,aAAIA,KAAK,CAAC6N,SAAN,CAAgBC,UAAhB,CAA2B9N,KAAK,CAACrC,WAAN,CAAkB8P,MAAlB,CAAyBM,QAApD,CAAJ;CAAA;CAFG,GAAd,CAVI,CADe;CAgBvB;CACAjN,EAAAA,QAAQ;CAjBe,CAAxB;;;;;CCGA,IAAMuS,YAAY,GAAG;CACpBrS,EAAAA,KAAK,EAAE;CACN6N,IAAAA,MAAM,EAAE;CACPlC,MAAAA,IAAI,EAAE2G,MADC;CAEPzG,MAAAA,QAAQ,EAAE;CAFH;CADF,GADa;CAOpB9O,EAAAA,IAAI,EAAE,gBAAW;CAChB,WAAO;CACNwV,MAAAA,UAAU,EAAE,KADN;CAENC,MAAAA,OAAO,EAAE,EAFH;CAGNC,MAAAA,eAAe,EAAE,KAHX;CAINC,MAAAA,MAAM,EAAE,0CAJF;CAKNC,MAAAA,YAAY,EAAE,CAACC,4BAAmB,CAACC,KAArB,EAA4BD,4BAAmB,CAACE,SAAhD;CALR,KAAP;CAOA,GAfmB;CAgBpBjS,EAAAA,QAAQ;CAEP3B,IAAAA,IAFO,kBAGP;CACC,aAAO,KAAKiN,MAAL,CAAY+B,OAAZ,CAAoB,WAApB,EAAiC,KAAKL,MAAtC,EAA8C,IAA9C,CAAP;CACA,KALM;CAMP;CACAkF,IAAAA,WAPO,yBAQP;CACC,aAAO,KAAKpW,WAAL,CAAiByL,MAAjB,CAAwByF,MAA/B;CACA,KAVM;CAWPmF,IAAAA,SAXO,uBAYP;CACC,UAAI,CAAC,KAAKvG,MAAV,EACA;CACC,eAAO,CAAP;CACA;;CAED,aAAO,KAAKA,MAAL,CAAYwG,OAAnB;CACA,KAnBM;CAoBPC,IAAAA,kBApBO,gCAqBP;CACC,aAAO,KAAKF,SAAL,KAAmB,KAAKD,WAA/B;CACA,KAvBM;CAwBPI,IAAAA,qBAxBO,mCAyBP;CACC,aAAO,CAAC,CAAC,KAAKlU,UAAL,CAAgBC,IAAhB,CAAqBC,IAA9B;CACA,KA3BM;CA4BP0G,IAAAA,QA5BO,sBA6BP;CACC,aAAOF,kBAAK,CAACC,MAAN,CAAaC,QAAb,EAAP;CACA,KA/BM;CAgCPsL,IAAAA,SAhCO,uBAiCP;CACC,aAAOxL,kBAAK,CAACyL,QAAN,CAAeC,eAAf,EAAP;CACA,KAnCM;CAoCP+B,IAAAA,sBApCO,oCAqCP;CACC,UAAMC,gBAAgB,GAAG,KAAK3W,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,wCAA5B,CAAzB;CAEA,aAAO,KAAK9F,IAAL,CAAUf,EAAV,KAAiB,KAAK4U,WAAtB,IAAqC,KAAK7T,IAAL,CAAUuQ,QAA/C,IAA2D,KAAKvQ,IAAL,CAAUX,IAAV,KAAmB8U,gBAArF;CACA,KAzCM;CA0CPC,IAAAA,cA1CO,4BA2CP;CACC,aAAO,KAAKnH,MAAL,CAAY+B,OAAZ,CAAoB,cAApB,EAAoC,KAAKhP,IAAL,CAAUf,EAA9C,CAAP;CACA,KA7CM;CA8CPoV,IAAAA,YA9CO,0BA+CP;CACC,aAAO,KAAKZ,YAAL,CAAkBlE,QAAlB,CAA2B,KAAK6E,cAAL,CAAoBtU,KAA/C,CAAP;CACA,KAjDM;CAkDPwU,IAAAA,eAlDO,6BAmDP;CAAA;;CACC,UAAMC,WAAW,GAAGrN,MAAM,CAAC/D,MAAP,CAAc,KAAKqR,IAAL,CAAUrD,KAAxB,EAA+BsD,MAA/B,CAAsC,UAAAzU,IAAI,EAAI;CACjE,eAAO,KAAI,CAACyT,YAAL,CAAkBlE,QAAlB,CAA2BvP,IAAI,CAACF,KAAhC,CAAP;CACA,OAFmB,CAApB;CAIA,aAAOyU,WAAW,CAAClR,MAAnB;CACA,KAzDM;CA0DPuL,IAAAA,WA1DO,yBA2DP;CACC,aAAO,KAAK7O,UAAL,CAAgBmJ,MAAhB,CAAuB0F,WAA9B;CACA,KA7DM;CA8DPC,IAAAA,cA9DO,4BA+DP;CACC,aAAO,KAAK9O,UAAL,CAAgBmJ,MAAhB,CAAuB4F,UAA9B;CACA,KAjEM;CAkEP4F,IAAAA,eAlEO,6BAmEP;CACC,aAAO,KAAK7F,cAAL,CAAoBU,QAApB,CAA6B,KAAKvP,IAAL,CAAUf,EAAvC,CAAP;CACA,KArEM;CAsEP;CACA0V,IAAAA,iBAvEO,+BAwEP;CACC,UAAMC,SAAS,GAAG,EAAlB;;CAEA,UAAI,KAAK5U,IAAL,CAAUf,EAAV,KAAiB,KAAK6U,SAA1B,EACA;CACCc,QAAAA,SAAS,CAAC3D,IAAV,CAAe,KAAKzT,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,6CAA5B,CAAf;CACA;;CAED,UAAI,KAAK9F,IAAL,CAAUf,EAAV,KAAiB,KAAK4U,WAA1B,EACA;CACCe,QAAAA,SAAS,CAAC3D,IAAV,CAAe,KAAKzT,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,oDAA5B,CAAf;CACA,OAXF;CAcC;CACA;CACA;;;CAEA,aAAO8O,SAAS,CAACvF,IAAV,CAAe,IAAf,CAAP;CACA,KA3FM;CA4FPwF,IAAAA,YA5FO,0BA6FP;CACC,aAAO,KAAKC,YAAL,CAAkBzR,MAAlB,GAA2B,CAAlC;CACA,KA/FM;CAgGP0R,IAAAA,SAhGO,uBAiGP;CAAA;;CACC,UAAMC,KAAK,GAAG,EAAd,CADD;;CAGC,UAAI,KAAKhV,IAAL,CAAUf,EAAV,KAAiB,KAAK4U,WAA1B,EACA;CACC;CACA,YAAI,KAAKI,qBAAT,EACA;CACCe,UAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,YAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,iDAA5B,CADI;CAEVmP,YAAAA,OAAO,EAAE,mBAAM;CACd,cAAA,MAAI,CAACC,SAAL;;CACA,cAAA,MAAI,CAACC,aAAL;CACA;CALS,WAAX;CAOA,SAXF;;;CAaC,YAAI,KAAKlD,SAAT,EACA;CACC+C,UAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,YAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,uDAA5B,CADI;CAEVmP,YAAAA,OAAO,EAAE,mBAAM;CACd,cAAA,MAAI,CAACC,SAAL;;CACA,cAAA,MAAI,CAAC5U,KAAL,CAAW,sBAAX;CACA;CALS,WAAX;CAOA;CACD,OAxBD;CAAA,WA2BA;CACC;CACA,YAAI,KAAK0T,kBAAL,IAA2B,KAAKhU,IAAL,CAAUoV,cAAV,KAA6B,MAA5D,EACA;CACCJ,UAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,YAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,4CAA5B,CADI;CAEVmP,YAAAA,OAAO,EAAE,mBAAM;CACd,cAAA,MAAI,CAACC,SAAL;;CACA,cAAA,MAAI,CAACC,aAAL;CACA;CALS,WAAX;CAOA,SAXF;;;CAaC,YAAI,KAAKnB,kBAAL,IAA2B,CAAC,KAAKU,eAArC,EACA;CACCM,UAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,YAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,0CAA5B,CADI;CAEVmP,YAAAA,OAAO,EAAE,mBAAM;CACd,cAAA,MAAI,CAACC,SAAL;;CACA,cAAA,MAAI,CAAC5U,KAAL,CAAW,UAAX,EAAuB;CAACN,gBAAAA,IAAI,EAAE,MAAI,CAACA;CAAZ,eAAvB;CACA;CALS,WAAX;CAOA;;CACD,YAAI,KAAKqU,YAAL,IAAqB,KAAKD,cAAL,CAAoBiB,WAAzC,IAAwD,KAAKf,eAAL,GAAuB,CAAnF,EACA;CACC;CACA,cAAI,CAAC,KAAKF,cAAL,CAAoBkB,MAAzB,EACA;CACCN,YAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,cAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,yCAA5B,CADI;CAEVmP,cAAAA,OAAO,EAAE,mBAAM;CACd,gBAAA,MAAI,CAACC,SAAL;;CACA,gBAAA,MAAI,CAAC5U,KAAL,CAAW,SAAX,EAAsB;CAACN,kBAAAA,IAAI,EAAE,MAAI,CAACA;CAAZ,iBAAtB;CACA;CALS,aAAX;CAOA,WATD;CAAA,eAYA;CACCgV,YAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,cAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,2CAA5B,CADI;CAEVmP,cAAAA,OAAO,EAAE,mBAAM;CACd,gBAAA,MAAI,CAACC,SAAL;;CACA,gBAAA,MAAI,CAAC5U,KAAL,CAAW,WAAX;CACA;CALS,aAAX;CAOA;CAED,SAhDF;;;CAkDC,YAAI,KAAK2R,SAAL,IAAkB,CAAC,KAAKjS,IAAL,CAAUuQ,QAAjC,EACA;CACCyE,UAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,YAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,+CAA5B,CADI;CAEVmP,YAAAA,OAAO,EAAE,mBAAM;CACd,cAAA,MAAI,CAACC,SAAL;;CACA,cAAA,MAAI,CAAC5U,KAAL,CAAW,cAAX,EAA2B;CAACN,gBAAAA,IAAI,EAAE,MAAI,CAACA;CAAZ,eAA3B;CACA;CALS,WAAX;CAOAgV,UAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,YAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,kDAA5B,CADI;CAEVmP,YAAAA,OAAO,EAAE,mBAAM;CACd,cAAA,MAAI,CAACC,SAAL;;CACA,cAAA,MAAI,CAAC5U,KAAL,CAAW,iBAAX,EAA8B;CAACN,gBAAAA,IAAI,EAAE,MAAI,CAACA;CAAZ,eAA9B;CACA;CALS,WAAX;CAOA,SAlEF;;;CAoECgV,QAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,UAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,iDAA5B,CADI;CAEVmP,UAAAA,OAAO,EAAE,mBAAM;CACd,YAAA,MAAI,CAACC,SAAL;;CACA,YAAA,MAAI,CAAC5U,KAAL,CAAW,gBAAX,EAA6B;CAACN,cAAAA,IAAI,EAAE,MAAI,CAACA;CAAZ,aAA7B;CACA;CALS,SAAX;CAOA;;CAED,aAAOgV,KAAP;CACA,KA7MM;CA8MPO,IAAAA,iBA9MO,+BA+MP;CACC,UAAMxE,OAAO,GAAG,CAAC,iDAAD,CAAhB;;CAEA,UAAI,KAAKqD,cAAL,CAAoBoB,OAAxB,EACA;CACCzE,QAAAA,OAAO,CAACE,IAAR,CAAa,yDAAb;CACA;;CAED,aAAOF,OAAP;CACA,KAxNM;CAyNP0E,IAAAA,aAzNO,2BA0NP;CACC,UAAM1E,OAAO,GAAG,CAAC,4CAAD,CAAhB;;CAEA,UAAI,CAAC,KAAK/Q,IAAL,CAAUwQ,MAAX,IAAqB,KAAKxQ,IAAL,CAAUuQ,QAAnC,EACA;CACCQ,QAAAA,OAAO,CAACE,IAAR,CAAa,qDAAb;CACA,OAHD,MAIK,IAAI,CAAC,KAAKjR,IAAL,CAAUwQ,MAAX,IAAqB,CAAC,KAAKxQ,IAAL,CAAUuQ,QAApC,EACL;CACCQ,QAAAA,OAAO,CAACE,IAAR,CAAa,oDAAb;CACA;;CAED,aAAOF,OAAP;CACA,KAvOM;CAwOP2E,IAAAA,WAxOO,yBAyOP;CACC,UAAM3R,KAAK,GAAG,EAAd;;CAEA,UAAI,KAAK/D,IAAL,CAAUwQ,MAAd,EACA;CACCzM,QAAAA,KAAK,CAAC0M,eAAN,kBAAgC,KAAKzQ,IAAL,CAAUwQ,MAA1C;CACA,OAHD,MAIK,IAAI,CAAC,KAAKxQ,IAAL,CAAUwQ,MAAX,IAAqB,CAAC,KAAKxQ,IAAL,CAAUuQ,QAApC,EACL;CACCxM,QAAAA,KAAK,CAACC,eAAN,GAAwB,KAAKhE,IAAL,CAAU2V,KAAlC;CACA;;CAED,aAAO5R,KAAP;CACA,KAtPM;CAuPP6R,IAAAA,uBAvPO,qCAwPP;CACC,UAAI,KAAKhH,WAAT,EACA;CACC,eAAO,KAAK7O,UAAL,CAAgBmJ,MAAhB,CAAuBpJ,KAAvB,KAAiC+V,4BAAmB,CAACrB,IAArD,IAA6D,KAAKH,YAAlE,IAAkF,KAAKK,eAA9F;CACA,OAHD,MAKA;CACC,eAAO,KAAK3U,UAAL,CAAgBmJ,MAAhB,CAAuBpJ,KAAvB,KAAiC+V,4BAAmB,CAACrB,IAArD,IAA6D,KAAKH,YAAzE;CACA;CACD,KAjQM;CAkQPyB,IAAAA,mBAlQO,iCAmQP;CACC,UAAM/E,OAAO,GAAG,CAAC,+FAAD,CAAhB;;CAEA,UAAI,KAAKqD,cAAL,CAAoB2B,iBAAxB,EACA;CACChF,QAAAA,OAAO,CAACE,IAAR,CAAa,yDAAb;CACA,OAHD,MAIK,IAAI,KAAKmD,cAAL,CAAoB4B,WAAxB,EACL;CACCjF,QAAAA,OAAO,CAACE,IAAR,CAAa,kDAAb;CACA;;CAED,aAAOF,OAAP;CACA,KAhRM;CAiRPkF,IAAAA,qBAjRO,mCAkRP;CACC,UAAMlF,OAAO,GAAG,CAAC,iGAAD,CAAhB;;CAEA,UAAI,KAAKqD,cAAL,CAAoB8B,eAAxB,EACA;CACCnF,QAAAA,OAAO,CAACE,IAAR,CAAa,kDAAb;CACA,OAHD,MAKA;CACCF,QAAAA,OAAO,CAACE,IAAR,CAAa,mDAAb;CACA;;CAED,aAAOF,OAAP;CACA,KA/RM;CAgSPoF,IAAAA,oBAhSO,kCAiSP;CACC,UAAMpF,OAAO,GAAG,CAAC,gGAAD,CAAhB;;CAEA,UAAI,KAAKqD,cAAL,CAAoBiB,WAAxB,EACA;CACCtE,QAAAA,OAAO,CAACE,IAAR,CAAa,qDAAb;CACA,OAHD,MAKA;CACCF,QAAAA,OAAO,CAACE,IAAR,CAAa,sDAAb;CACA;;CAED,aAAOF,OAAP;CACA,KA9SM;CA+SPqF,IAAAA,WA/SO,yBAgTP;CACC,UAAMrF,OAAO,GAAG,CAAC,0CAAD,CAAhB;;CAEA,UAAI,CAAC,KAAKsD,YAAV,EACA;CACCtD,QAAAA,OAAO,CAACE,IAAR,CAAa,kDAAb;CACA;;CAED,aAAOF,OAAP;CACA;CAzTM,KA0TJ5G,gBAAI,CAACC,QAAL,CAAc;CAChB3M,IAAAA,WAAW,EAAE,qBAAAqC,KAAK;CAAA,aAAIA,KAAK,CAACrC,WAAV;CAAA,KADF;CAEhBsC,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA,KAFD;CAGhByU,IAAAA,IAAI,EAAE,cAAA1U,KAAK;CAAA,aAAIA,KAAK,CAAC0U,IAAV;CAAA,KAHK;CAIhBjH,IAAAA,MAAM,EAAE,gBAAAzN,KAAK;CAAA,aAAIA,KAAK,CAAC6N,SAAN,CAAgBC,UAAhB,CAA2B9N,KAAK,CAACrC,WAAN,CAAkB8P,MAAlB,CAAyBM,QAApD,CAAJ;CAAA;CAJG,GAAd,CA1TI,CAhBY;CAiVpBzN,EAAAA,OAAO,EACP;CACCiW,IAAAA,QADD,sBAEC;CAAA;;CACC,UAAI,KAAKC,SAAT,EACA;CACC,aAAKpB,SAAL;CACA,eAAO,KAAP;CACA,OALF;;;CAQC,UAAMqB,YAAY,GAAGC,sBAAW,CAACC,WAAZ,CAAwB,KAAKjD,MAA7B,CAArB;;CACA,UAAI+C,YAAJ,EACA;CACCA,QAAAA,YAAY,CAACG,OAAb;CACA;;CAED,WAAKJ,SAAL,GAAiBE,sBAAW,CAACG,MAAZ,CAAmB;CACnC1X,QAAAA,EAAE,EAAE,KAAKuU,MAD0B;CAEnCoD,QAAAA,WAAW,EAAE,KAAKvO,KAAL,CAAW,WAAX,CAFsB;CAGnC2M,QAAAA,KAAK,EAAE,KAAKD,SAHuB;CAInC8B,QAAAA,MAAM,EAAE;CACPC,UAAAA,YAAY,EAAE;CAAA,mBAAM,MAAI,CAACR,SAAL,CAAeI,OAAf,EAAN;CAAA,WADP;CAEPK,UAAAA,cAAc,EAAE;CAAA,mBAAM,MAAI,CAACT,SAAL,GAAiB,IAAvB;CAAA;CAFT;CAJ2B,OAAnB,CAAjB;CAUA,WAAKA,SAAL,CAAe1Q,IAAf;CACA,KA3BF;CA4BCsP,IAAAA,SA5BD,uBA6BC;CACC,WAAKoB,SAAL,CAAeI,OAAf;CACA,WAAKJ,SAAL,GAAiB,IAAjB;CACA,KAhCF;CAiCCnB,IAAAA,aAjCD,2BAkCC;CAAA;;CACC,WAAK7B,OAAL,GAAe,KAAKtT,IAAL,CAAUX,IAAzB;CACA,WAAKgU,UAAL,GAAkB,IAAlB;CACA,WAAKrG,SAAL,CAAe,YAAM;CACpB,QAAA,MAAI,CAAC3E,KAAL,CAAW,cAAX,EAA2B6D,KAA3B;;CACA,QAAA,MAAI,CAAC7D,KAAL,CAAW,cAAX,EAA2B2O,MAA3B;CACA,OAHD;CAIA,KAzCF;CA0CCC,IAAAA,eA1CD,2BA0CiBrZ,KA1CjB,EA2CC;CACC;CACA,UAAIA,KAAK,CAACsZ,OAAN,KAAkB,EAAtB,EACA;CACC,aAAKC,UAAL;CACA,OAHD;CAAA,WAKK,IAAIvZ,KAAK,CAACsZ,OAAN,KAAkB,EAAtB,EACL;CACC,aAAK7D,UAAL,GAAkB,KAAlB;CACA;CACD,KAtDF;CAuDC8D,IAAAA,UAvDD,wBAwDC;CAAA;;CACC,UAAI,KAAKnX,IAAL,CAAUX,IAAV,KAAmB,KAAKiU,OAAL,CAAatB,IAAb,EAAnB,IAA0C,KAAKsB,OAAL,KAAiB,EAA/D,EACA;CACC,aAAKD,UAAL,GAAkB,KAAlB;CAEA,eAAO,KAAP;CACA;;CAED,WAAK/S,KAAL,CAAW,gBAAX,EAA6B;CAACN,QAAAA,IAAI,EAAE,KAAKA,IAAZ;CAAkBsT,QAAAA,OAAO,EAAE,KAAKA;CAAhC,OAA7B;CACA,WAAKtG,SAAL,CAAe,YAAM;CACpB,QAAA,MAAI,CAACqG,UAAL,GAAkB,KAAlB;CACA,OAFD;CAGA,KApEF;CAqEC+D,IAAAA,OArED,mBAqESxZ,KArET,EAsEC;CACC6C,MAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAACZ,UAAV,CAAqBsX,eAAvC,EAAwDzZ,KAAxD;CACA,KAxEF;CAyEC0Z,IAAAA,MAzED,kBAyEQ1Z,KAzER,EA0EC;CACC6C,MAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAACZ,UAAV,CAAqBwX,cAAvC,EAAuD3Z,KAAvD;CACA;CA5EF,GAlVoB;CAgapB;CACAgD,EAAAA,QAAQ;CAjaY,CAArB;;;;;CCGA,IAAM4W,QAAQ,GAAG;CAChB3O,EAAAA,UAAU,EAAE;CAACsK,IAAAA,YAAY,EAAZA;CAAD,GADI;CAEhBtV,EAAAA,IAFgB,kBAGhB;CACC,WAAO;CACN4Z,MAAAA,YAAY,EAAE,EADR;CAENC,MAAAA,eAAe,EAAE,KAFX;CAGNC,MAAAA,WAAW,EAAE,CAHP;CAINC,MAAAA,aAAa,EAAE,IAJT;CAKNC,MAAAA,MAAM,EAAE;CACP7X,QAAAA,IAAI,EAAE,CADC;CAEPsT,QAAAA,OAAO,EAAE,EAFF;CAGPC,QAAAA,eAAe,EAAE;CAHV;CALF,KAAP;CAWA,GAfe;CAgBhBzO,EAAAA,OAhBgB,qBAiBhB;CACCpG,IAAAA,oBAAM,CAACuJ,IAAP,CAAY,+BAAZ;CACA,SAAK6P,YAAL,CAAkB;CAACC,MAAAA,SAAS,EAAE;CAAZ,KAAlB;CACA,GApBe;CAqBhBhM,EAAAA,aArBgB,2BAsBhB;CACC,SAAKiM,cAAL,GAAsB,IAAtB;CACA,GAxBe;CAyBhBrW,EAAAA,QAAQ;CAEPgN,IAAAA,MAFO,oBAGP;CACC,aAAO,KAAKlR,WAAL,CAAiByL,MAAjB,CAAwByF,MAA/B;CACA,KALM;CAMPC,IAAAA,WANO,yBAOP;CACC,aAAO,KAAK7O,UAAL,CAAgBmJ,MAAhB,CAAuB0F,WAA9B;CACA,KATM;CAUPqJ,IAAAA,SAVO,uBAWP;CAAA;;CACC,UAAM9G,KAAK,GAAG,KAAKpR,UAAL,CAAgBmJ,MAAhB,CAAuBiI,KAAvB,CAA6BsD,MAA7B,CAAoC,UAAAzU,IAAI,EAAI;CACzD,eAAO,CAAC,KAAI,CAAC6O,cAAL,CAAoBU,QAApB,CAA6BvP,IAA7B,CAAR;CACA,OAFa,CAAd;CAIA,aAAO,+BAAImR,KAAJ,EAAW+G,IAAX,CAAgB,KAAKC,gBAArB,CAAP;CACA,KAjBM;CAkBPtJ,IAAAA,cAlBO,4BAmBP;CACC,aAAO,+BAAI,KAAK9O,UAAL,CAAgBmJ,MAAhB,CAAuB4F,UAA3B,EAAuCoJ,IAAvC,CAA4C,KAAKC,gBAAjD,CAAP;CACA,KArBM;CAsBPC,IAAAA,cAtBO,4BAuBP;CACC,aAAO,KAAKrY,UAAL,CAAgBmJ,MAAhB,CAAuBkP,cAA9B;CACA;CAzBM,KA0BJjO,gBAAI,CAACC,QAAL,CAAc;CAChBpK,IAAAA,IAAI,EAAE,cAAAF,KAAK;CAAA,aAAIA,KAAK,CAACqR,KAAN,CAAYvD,UAAZ,CAAuB9N,KAAK,CAACrC,WAAN,CAAkByL,MAAlB,CAAyByF,MAAhD,CAAJ;CAAA,KADK;CAEhBlR,IAAAA,WAAW,EAAE,qBAAAqC,KAAK;CAAA,aAAIA,KAAK,CAACrC,WAAV;CAAA,KAFF;CAGhBsC,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA,KAHD;CAIhByU,IAAAA,IAAI,EAAE,cAAA1U,KAAK;CAAA,aAAIA,KAAK,CAAC0U,IAAV;CAAA,KAJK;CAKhBjH,IAAAA,MAAM,EAAE,gBAAAzN,KAAK;CAAA,aAAIA,KAAK,CAAC6N,SAAN,CAAgBC,UAAhB,CAA2B9N,KAAK,CAACrC,WAAN,CAAkB8P,MAAlB,CAAyBM,QAApD,CAAJ;CAAA;CALG,GAAd,CA1BI,CAzBQ;CA2DhBzN,EAAAA,OAAO,EACP;CACC0X,IAAAA,YADD,0BAEC;CAAA;;CAAA,qFADmC,EACnC;CAAA,gCADcC,SACd;CAAA,UADcA,SACd,+BAD0B,KAC1B;;CACC,WAAKva,OAAL,CAAa6a,UAAb,CAAwB1a,GAAxB,GAA8B2a,UAA9B,CAAyC,sBAAzC,EAAiE;CAChE,qBAAa,KAAK7a,WAAL,CAAiB8P,MAAjB,CAAwBM,QAD2B;CAEhE,iBAAS,KAAK4J,YAFkD;CAGhE,kBAAUM,SAAS,GAAE,CAAF,GAAO,KAAKJ,WAAL,GAAmB,KAAKF;CAHc,OAAjE,EAIGlZ,IAJH,CAIQ,UAAAga,MAAM,EAAI;CACjB7Z,QAAAA,oBAAM,CAACuJ,IAAP,CAAY,2CAAZ,EAAyDsQ,MAAM,CAAC1a,IAAP,EAAzD;CACA,YAAMsT,KAAK,GAAGoH,MAAM,CAAC1a,IAAP,EAAd;CACA,QAAA,MAAI,CAAC8Z,WAAL;;CACA,YAAIxG,KAAK,CAAC9N,MAAN,GAAe,MAAI,CAACoU,YAAxB,EACA;CACC,UAAA,MAAI,CAACG,aAAL,GAAqB,KAArB;CACA;;CAED,QAAA,MAAI,CAAC3K,MAAL,CAAYC,QAAZ,CAAqB,WAArB,EAAkCiE,KAAlC;;CACA,YAAMqH,QAAQ,GAAGrH,KAAK,CAAC/B,GAAN,CAAU,UAAApP,IAAI;CAAA,iBAAIA,IAAI,CAACf,EAAT;CAAA,SAAd,CAAjB;CAEA,eAAO,MAAI,CAACgO,MAAL,CAAYC,QAAZ,CAAqB,qBAArB,EAA4C;CAAEiE,UAAAA,KAAK,EAAEqH;CAAT,SAA5C,CAAP;CACA,OAjBD,EAiBGja,IAjBH,CAiBQ,YAAM;CACb,YAAIwZ,SAAJ,EACA;CACC,UAAA,MAAI,CAACL,eAAL,GAAuB,IAAvB;CACA;CACD,OAtBD,WAsBS,UAAAa,MAAM,EAAI;CAClB7Z,QAAAA,oBAAM,CAACuJ,IAAP,CAAY,sCAAZ,EAAoDsQ,MAAM,CAAC9Z,KAAP,GAAega,EAAnE;CACA,OAxBD;CAyBA,KA5BF;CA6BCC,IAAAA,cA7BD,iCA8BC;CAAA,UADgB1Y,IAChB,SADgBA,IAChB;CACC,WAAK2Y,mBAAL,CAAyB3Y,IAAzB;CACA,KAhCF;CAiCC2Y,IAAAA,mBAjCD,+BAiCqB3Y,IAjCrB,EAkCC;CAAA;;CACC,UAAI,KAAK4Y,eAAT,EACA;CACC,aAAKA,eAAL,CAAqBC,KAArB;CACA;;CAED,UAAIC,cAAc,GAAG,KAAKtb,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,sDAA5B,CAArB;;CACA,UAAI9F,IAAI,CAACuQ,QAAT,EACA;CACCuI,QAAAA,cAAc,GAAG,KAAKtb,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,mDAA5B,CAAjB;CACA;;CACD,WAAK8S,eAAL,GAAuBjT,gCAAU,CAACgR,MAAX,CAAkB;CACxCzY,QAAAA,OAAO,EAAE4a,cAD+B;CAExC/S,QAAAA,KAAK,EAAE,IAFiC;CAGxCC,QAAAA,OAAO,EAAEC,uCAAiB,CAAC8S,SAHa;CAIxCC,QAAAA,IAAI,EAAE,gBAAM;CACX,UAAA,MAAI,CAACC,QAAL,CAAcjZ,IAAd;;CACA,UAAA,MAAI,CAAC4Y,eAAL,CAAqBC,KAArB;CACA,SAPuC;CAQxCK,QAAAA,QAAQ,EAAE,oBAAM;CACf,UAAA,MAAI,CAACN,eAAL,CAAqBC,KAArB;CACA;CAVuC,OAAlB,CAAvB;CAYA,WAAKD,eAAL,CAAqBhT,IAArB;CACA,KA1DF;CA2DCqT,IAAAA,QA3DD,oBA2DUjZ,IA3DV,EA4DC;CAAA;;CACC,WAAKiN,MAAL,CAAYC,QAAZ,CAAqB,wBAArB,EAA+C;CAAEiE,QAAAA,KAAK,EAAE,CAACnR,IAAI,CAACf,EAAN;CAAT,OAA/C;CACA,WAAKzB,OAAL,CAAa6a,UAAb,CAAwB1a,GAAxB,GAA8B2a,UAA9B,CAAyC,qBAAzC,EAAgE;CAC/Da,QAAAA,OAAO,EAAEnZ,IAAI,CAACf,EADiD;CAE/Dma,QAAAA,OAAO,EAAE,KAAK3b,WAAL,CAAiB8P,MAAjB,CAAwBjP;CAF8B,OAAhE,WAGS,UAACG,KAAD,EAAW;CACnBC,QAAAA,oBAAM,CAACD,KAAP,CAAa,2CAAb,EAA0DA,KAA1D;;CACA,QAAA,MAAI,CAACwO,MAAL,CAAYC,QAAZ,CAAqB,qBAArB,EAA4C;CAAEiE,UAAAA,KAAK,EAAE,CAACnR,IAAI,CAACf,EAAN;CAAT,SAA5C;CACA,OAND;CAOA,KArEF;CAsECoa,IAAAA,oBAtED,uCAuEC;CAAA,UADsBrZ,IACtB,SADsBA,IACtB;;CACC,UAAI,KAAKoY,cAAL,KAAwBkB,iCAAc,CAACC,MAAvC,IAAiD,KAAKnB,cAAL,KAAwBkB,iCAAc,CAACnI,KAA5F,EACA;CACC,aAAK3L,cAAL,GAAsBuI,UAAtB;CACA;;CACD,WAAKf,SAAL,CAAe,YAAM;CACpBvM,QAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC6Y,QAAV,CAAmBC,UAArC,EAAiD;CAACrM,UAAAA,IAAI,YAAKpN,IAAI,CAACX,IAAV,OAAL;CAAyB6M,UAAAA,KAAK,EAAE;CAAhC,SAAjD;CACA,OAFD;CAGA,KA/EF;CAgFCwN,IAAAA,gBAhFD,mCAiFC;CAAA;;CAAA,UADkB1Z,IAClB,SADkBA,IAClB;CAAA,UADwBsT,OACxB,SADwBA,OACxB;CACC,UAAMqG,MAAM,GAAG3Z,IAAI,CAACf,EAAL,KAAY,KAAK0P,MAAjB,GAA0B,qBAA1B,GAAkD,2BAAjE;CAEA,UAAMiL,OAAO,GAAG5Z,IAAI,CAACX,IAArB;CACA,WAAK4N,MAAL,CAAYC,QAAZ,CAAqB,cAArB,EAAqC;CACpCjO,QAAAA,EAAE,EAAEe,IAAI,CAACf,EAD2B;CAEpC4a,QAAAA,MAAM,EAAE;CAACxa,UAAAA,IAAI,EAAEiU,OAAP;CAAgBwG,UAAAA,gBAAgB,EAAE,IAAIhK,IAAJ;CAAlC;CAF4B,OAArC;CAIA,WAAKtS,OAAL,CAAa6a,UAAb,CAAwB1a,GAAxB,GAA8B2a,UAA9B,CAAyCqB,MAAzC,EAAiD;CAChDta,QAAAA,IAAI,EAAEiU,OAD0C;CAEhD8F,QAAAA,OAAO,EAAE,KAAK3b,WAAL,CAAiB8P,MAAjB,CAAwBjP,MAFe;CAGhD6a,QAAAA,OAAO,EAAEnZ,IAAI,CAACf;CAHkC,OAAjD,EAIGV,IAJH,CAIQ,YAAM;CACbG,QAAAA,oBAAM,CAACuJ,IAAP,CAAY,8BAAZ,EAA4CjI,IAAI,CAACf,EAAjD,EAAqDqU,OAArD;;CACA,YAAIsG,OAAO,KAAK,MAAI,CAACpc,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,wCAA5B,CAAhB,EACA;CACC,UAAA,MAAI,CAACN,cAAL,GAAsBuU,iBAAtB;CACA;CACD,OAVD,WAUS,UAACtb,KAAD,EAAW;CACnBC,QAAAA,oBAAM,CAACD,KAAP,CAAa,4BAAb,EAA2CA,KAA3C;;CACA,QAAA,MAAI,CAACwO,MAAL,CAAYC,QAAZ,CAAqB,cAArB,EAAqC;CACpCjO,UAAAA,EAAE,EAAEe,IAAI,CAACf,EAD2B;CAEpC4a,UAAAA,MAAM,EAAE;CAACxa,YAAAA,IAAI,EAAEua,OAAP;CAAgBE,YAAAA,gBAAgB,EAAE,IAAIhK,IAAJ;CAAlC;CAF4B,SAArC;CAIA,OAhBD;CAiBA,KA1GF;CA2GCkK,IAAAA,aA3GD,gCA4GC;CAAA,UADeha,IACf,SADeA,IACf;CACC,WAAKwF,cAAL,GAAsByU,OAAtB,CAA8Bja,IAA9B;CACA,KA9GF;CA+GCka,IAAAA,eA/GD,6BAgHC;CACC,WAAK1U,cAAL,GAAsB2U,SAAtB;CACA,KAlHF;CAmHCC,IAAAA,0BAnHD,wCAoHC;CACC,WAAK5U,cAAL,GAAsB6U,gBAAtB;CACA,KAtHF;CAuHCC,IAAAA,kBAvHD,qCAwHC;CAAA,UADoBta,IACpB,SADoBA,IACpB;CACC,WAAKwF,cAAL,GAAsBsI,QAAtB,CAA+B9N,IAA/B;CACA,KA1HF;CA2HCua,IAAAA,qBA3HD,wCA4HC;CAAA,UADuBva,IACvB,SADuBA,IACvB;CACC,WAAKwF,cAAL,GAAsBgV,WAAtB,CAAkCxa,IAAlC;CACA,KA9HF;CA+HC;CACAya,IAAAA,iBAhID,+BAiIC;CAAA;;CACC,UAAMC,OAAO,GAAG;CACfC,QAAAA,IAAI,EAAElZ,QAAQ,CAACmZ,aAAT,CAAuB,mCAAvB,CADS;CAEfC,QAAAA,SAAS,EAAE;CAFI,OAAhB;;CAKA,UAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,OAAD,EAAUC,QAAV,EAAuB;CACvCD,QAAAA,OAAO,CAAClX,OAAR,CAAgB,UAAAoX,KAAK,EAAI;CACxB,cAAIA,KAAK,CAACC,cAAN,IAAwBD,KAAK,CAACE,iBAAN,GAA0B,IAAtD,EACA;CACCzc,YAAAA,oBAAM,CAACuJ,IAAP,CAAY,qDAAZ;;CACA,YAAA,MAAI,CAAC6P,YAAL;CACA;CACD,SAND;CAOA,OARD;;CAUA,aAAO,IAAIsD,oBAAJ,CAAyBN,QAAzB,EAAmCJ,OAAnC,CAAP;CACA,KAlJF;CAmJCvC,IAAAA,gBAnJD,4BAmJkBkD,KAnJlB,EAmJyBC,KAnJzB,EAoJC;CACC,UAAID,KAAK,KAAK,KAAK1M,MAAnB,EACA;CACC,eAAO,CAAC,CAAR;CACA;;CACD,UAAI2M,KAAK,KAAK,KAAK3M,MAAnB,EACA;CACC,eAAO,CAAP;CACA;;CAED,UAAI,KAAK6F,IAAL,CAAUrD,KAAV,CAAgBkK,KAAhB,MAA2B,KAAK7G,IAAL,CAAUrD,KAAV,CAAgBkK,KAAhB,EAAuBtF,iBAAvB,IAA4C,KAAKvB,IAAL,CAAUrD,KAAV,CAAgBkK,KAAhB,EAAuBrF,WAA9F,CAAJ,EACA;CACC,eAAO,CAAC,CAAR;CACA;;CACD,UAAI,KAAKxB,IAAL,CAAUrD,KAAV,CAAgBmK,KAAhB,MAA2B,KAAK9G,IAAL,CAAUrD,KAAV,CAAgBmK,KAAhB,EAAuBvF,iBAAvB,IAA4C,KAAKvB,IAAL,CAAUrD,KAAV,CAAgBmK,KAAhB,EAAuBtF,WAA9F,CAAJ,EACA;CACC,eAAO,CAAP;CACA;;CAED,UAAI,KAAKxB,IAAL,CAAUrD,KAAV,CAAgBkK,KAAhB,KAA0B,CAAC3H,4BAAmB,CAACC,KAArB,EAA4BD,4BAAmB,CAACE,SAAhD,EAA2DrE,QAA3D,CAAoE,KAAKiF,IAAL,CAAUrD,KAAV,CAAgBkK,KAAhB,EAAuBvb,KAA3F,CAA9B,EACA;CACC,eAAO,CAAC,CAAR;CACA;;CACD,UAAI,KAAK0U,IAAL,CAAUrD,KAAV,CAAgBmK,KAAhB,KAA0B,CAAC5H,4BAAmB,CAACC,KAArB,EAA4BD,4BAAmB,CAACE,SAAhD,EAA2DrE,QAA3D,CAAoE,KAAKiF,IAAL,CAAUrD,KAAV,CAAgBmK,KAAhB,EAAuBxb,KAA3F,CAA9B,EACA;CACC,eAAO,CAAP;CACA;;CAED,aAAO,CAAP;CACA,KAjLF;CAkLC0F,IAAAA,cAlLD,4BAmLC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CArLF,GA5DgB;CAmPhB4d,EAAAA,UAAU,EACV;CACC,0CACC;CACCC,MAAAA,QADD,oBACUC,OADV,EACmBC,QADnB,EAC6BC,KAD7B,EAEC;CACCA,QAAAA,KAAK,CAACC,OAAN,CAAc5D,cAAd,GAA+B2D,KAAK,CAACC,OAAN,CAAcnB,iBAAd,EAA/B;CACAkB,QAAAA,KAAK,CAACC,OAAN,CAAc5D,cAAd,CAA6B6D,OAA7B,CAAqCJ,OAArC;CAEA,eAAO,IAAP;CACA,OAPF;CAQCK,MAAAA,MARD,kBAQQL,OARR,EAQiBC,QARjB,EAQ2BC,KAR3B,EASC;CACC,YAAIA,KAAK,CAACC,OAAN,CAAc5D,cAAlB,EACA;CACC2D,UAAAA,KAAK,CAACC,OAAN,CAAc5D,cAAd,CAA6B+D,SAA7B,CAAuCN,OAAvC;CACA;;CAED,eAAO,IAAP;CACA;CAhBF;CAFF,GApPgB;CAyQhB7a,EAAAA,QAAQ;CAzQQ,CAAjB;;;;;CCJA,IAAMob,cAAc,GAAG;CACtBra,EAAAA,QAAQ;CAEPgN,IAAAA,MAFO,oBAGP;CACC,aAAO,KAAKlR,WAAL,CAAiByL,MAAjB,CAAwByF,MAA/B;CACA,KALM;CAMPqF,IAAAA,kBANO,gCAOP;CACC,UAAI,CAAC,KAAKzG,MAAV,EACA;CACC,eAAO,KAAP;CACA;;CAED,aAAO,KAAKA,MAAL,CAAYwG,OAAZ,KAAwB,KAAKpF,MAApC;CACA;CAdM,KAeJxE,gBAAI,CAACC,QAAL,CAAc;CAChBpK,IAAAA,IAAI,EAAE,cAAAF,KAAK;CAAA,aAAIA,KAAK,CAACqR,KAAN,CAAYvD,UAAZ,CAAuB9N,KAAK,CAACrC,WAAN,CAAkByL,MAAlB,CAAyByF,MAAhD,CAAJ;CAAA,KADK;CAEhBlR,IAAAA,WAAW,EAAE,qBAAAqC,KAAK;CAAA,aAAIA,KAAK,CAACrC,WAAV;CAAA,KAFF;CAGhBsC,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA,KAHD;CAIhBwN,IAAAA,MAAM,EAAE,gBAAAzN,KAAK;CAAA,aAAIA,KAAK,CAAC6N,SAAN,CAAgBC,UAAhB,CAA2B9N,KAAK,CAACrC,WAAN,CAAkB8P,MAAlB,CAAyBM,QAApD,CAAJ;CAAA;CAJG,GAAd,CAfI,CADc;CAuBtBzN,EAAAA,OAAO,EACP;CACC6b,IAAAA,YADD,0BAEC;CACC,WAAKzW,cAAL,GAAsByI,cAAtB;CACA,KAJF;CAKCoI,IAAAA,QALD,sBAMC;CAAA;;CACC,UAAI,KAAKC,SAAT,EACA;CACC,aAAKpB,SAAL;CACA,eAAO,KAAP;CACA;;CAED,WAAKoB,SAAL,GAAiBE,sBAAW,CAACG,MAAZ,CAAmB;CACnC1X,QAAAA,EAAE,EAAE,6CAD+B;CAEnC2X,QAAAA,WAAW,EAAE,KAAKvO,KAAL,CAAW,uBAAX,CAFsB;CAGnC2M,QAAAA,KAAK,EAAE,KAAKF,YAAL,EAH4B;CAInC+B,QAAAA,MAAM,EAAE;CACPC,UAAAA,YAAY,EAAE;CAAA,mBAAM,KAAI,CAACR,SAAL,CAAeI,OAAf,EAAN;CAAA,WADP;CAEPK,UAAAA,cAAc,EAAE;CAAA,mBAAM,KAAI,CAACT,SAAL,GAAiB,IAAvB;CAAA;CAFT;CAJ2B,OAAnB,CAAjB;CAUA,WAAKA,SAAL,CAAe1Q,IAAf;CACA,KAxBF;CAyBCsP,IAAAA,SAzBD,uBA0BC;CACC,WAAKoB,SAAL,CAAeI,OAAf;CACA,WAAKJ,SAAL,GAAiB,IAAjB;CACA,KA7BF;CA8BCxB,IAAAA,YA9BD,0BA+BC;CAAA;;CACC,UAAME,KAAK,GAAG,CAAC;CACd5H,QAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,sDAA5B,CADQ;CAEdmP,QAAAA,OAAO,EAAE,mBAAM;CACd,UAAA,MAAI,CAACC,SAAL;;CACA,UAAA,MAAI,CAACgH,cAAL;CACA;CALa,OAAD,CAAd;;CAOA,UAAI,KAAKlI,kBAAT,EACA;CACCgB,QAAAA,KAAK,CAAC/D,IAAN,CAAW;CACV7D,UAAAA,IAAI,EAAE,KAAK5P,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,wDAA5B,CADI;CAEVmP,UAAAA,OAAO,EAAE,mBAAM;CACd,YAAA,MAAI,CAACC,SAAL;;CACA,YAAA,MAAI,CAACiH,gBAAL;CACA;CALS,SAAX;CAOA;;CAED,aAAOnH,KAAP;CACA,KAnDF;CAoDCkH,IAAAA,cApDD,4BAqDC;CACC,UAAMvL,UAAU,GAAG,KAAKpD,MAAL,WAAmBsD,IAAtC;CACAuL,MAAAA,0BAAS,CAACC,IAAV,CAAe1L,UAAf;CAEA,UAAM2L,gBAAgB,GAAG,KAAK9e,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,kCAA5B,CAAzB;CACApB,MAAAA,EAAE,CAAC6X,EAAH,CAAMC,YAAN,CAAmBC,MAAnB,CAA0BC,MAA1B,CAAiC;CAChCC,QAAAA,OAAO,EAAEL,gBADuB;CAEhCM,QAAAA,aAAa,EAAE;CAFiB,OAAjC;CAIA,KA9DF;CA+DCT,IAAAA,gBA/DD,8BAgEC;CAAA;;CACC,UAAMrD,cAAc,GAAG,KAAKtb,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,+CAA5B,CAAvB;CACA,WAAK+W,iBAAL,GAAyBlX,gCAAU,CAACgR,MAAX,CAAkB;CAC1CzY,QAAAA,OAAO,EAAE4a,cADiC;CAE1C/S,QAAAA,KAAK,EAAE,IAFmC;CAG1CC,QAAAA,OAAO,EAAEC,uCAAiB,CAAC8S,SAHe;CAI1CC,QAAAA,IAAI,EAAE,gBAAM;CACX,UAAA,MAAI,CAAC8D,UAAL;;CACA,UAAA,MAAI,CAACD,iBAAL,CAAuBE,cAAvB,GAAwCrG,OAAxC;CACA,SAPyC;CAQ1CwC,QAAAA,QAAQ,EAAE,oBAAM;CACf,UAAA,MAAI,CAAC2D,iBAAL,CAAuBE,cAAvB,GAAwCrG,OAAxC;CACA;CAVyC,OAAlB,CAAzB;CAYA,WAAKmG,iBAAL,CAAuBjX,IAAvB;CACA,KA/EF;CAgFCkX,IAAAA,UAhFD,wBAiFC;CAAA;;CACC,WAAKtX,cAAL,GAAsBsX,UAAtB,GAAmCve,IAAnC,CAAwC,YAAM;CAC7C,YAAM+d,gBAAgB,GAAG,MAAI,CAAC9e,OAAL,CAAaqI,GAAb,CAAiBC,UAAjB,CAA4B,mCAA5B,CAAzB;;CACApB,QAAAA,EAAE,CAAC6X,EAAH,CAAMC,YAAN,CAAmBC,MAAnB,CAA0BC,MAA1B,CAAiC;CAChCC,UAAAA,OAAO,EAAEL,gBADuB;CAEhCM,UAAAA,aAAa,EAAE;CAFiB,SAAjC;CAIA,OAND,WAMS,UAAAne,KAAK,EAAI;CACjBwL,QAAAA,OAAO,CAACxL,KAAR,CAAc,+BAAd,EAA+CA,KAA/C;CACA,OARD;CASA,KA3FF;CA4FC+G,IAAAA,cA5FD,4BA6FC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CA/FF,GAxBsB;CAyHtBiD,EAAAA,QAAQ;CAzHc,CAAvB;;;;;;CC8CA,IAAMoc,UAAU,GAAG9V,MAAM,CAAC+V,MAAP,CAAc;CAChCC,EAAAA,WAAW,EAAE;CADmB,CAAd,CAAnB;AAIArb,iBAAS,CAACsb,SAAV,CAAoB,mCAApB,EACA;CACCtU,EAAAA,UAAU,EAAE;CACXC,IAAAA,KAAK,EAALA,KADW;CACJ7E,IAAAA,YAAY,EAAZA,YADI;CACUsH,IAAAA,mBAAmB,EAAnBA,mBADV;CAC+BC,IAAAA,aAAa,EAAbA,aAD/B;CAC8CY,IAAAA,aAAa,EAAbA,aAD9C;CAEXG,IAAAA,kBAAkB,EAAlBA,kBAFW;CAESc,IAAAA,gBAAgB,EAAhBA,gBAFT;CAE2Ba,IAAAA,cAAc,EAAdA,cAF3B;CAE2CiC,IAAAA,QAAQ,EAARA,QAF3C;CAEqDiC,IAAAA,UAAU,EAAVA,UAFrD;CAEiEc,IAAAA,eAAe,EAAfA,eAFjE;CAEkFsE,IAAAA,QAAQ,EAARA,QAFlF;CAE4FwE,IAAAA,cAAc,EAAdA,cAF5F;CAGX7b,IAAAA,gBAAgB,EAAhBA;CAHW,GADb;CAMCW,EAAAA,KAAK,EAAE;CACN+M,IAAAA,QAAQ,EAAE;CAAEpB,MAAAA,IAAI,EAAE2Q,MAAR;CAAgB,iBAAS;CAAzB;CADJ,GANR;CASCvf,EAAAA,IAAI,EAAE,gBACN;CACC,WAAO;CACNwf,MAAAA,eAAe,EAAE,KADX;CAENC,MAAAA,SAAS,EAAEN,UAAU,CAACE,WAFhB;CAGNK,MAAAA,gBAAgB,EAAE,IAHZ;CAINC,MAAAA,QAAQ,EAAE,KAJJ;CAKN;CACAC,MAAAA,mBAAmB,EAAE;CACpBC,QAAAA,WAAW,EAAE,EADO;CAEpBC,QAAAA,UAAU,EAAE,EAFQ;CAGpBC,QAAAA,aAAa,EAAE,EAHK;CAIpBC,QAAAA,aAAa,EAAE;CAJK;CANf,KAAP;CAaA,GAxBF;CAyBC/Y,EAAAA,OAzBD,qBA0BC;CACC,SAAKgZ,iBAAL;CAEArd,IAAAA,6BAAY,CAACmL,SAAb,CAAuBjL,kBAAS,CAACZ,UAAV,CAAqByR,YAA5C,EAA0D,KAAKuM,cAA/D;CACAtd,IAAAA,6BAAY,CAACmL,SAAb,CAAuBjL,kBAAS,CAACZ,UAAV,CAAqBS,UAA5C,EAAwD,KAAKwd,YAA7D;;CAEA,QAAI,KAAKrX,QAAL,EAAJ,EACA;CACC,WAAKsX,aAAL;CACA,KAHD,MAKA;CACCxc,MAAAA,QAAQ,CAACyc,IAAT,CAAcC,SAAd,CAAwBC,GAAxB,CAA4B,sCAA5B;CACA;;CAED,QAAI,CAAC,KAAKnM,SAAL,EAAL,EACA;CACCjQ,MAAAA,MAAM,CAACqc,gBAAP,CAAwB,cAAxB,EAAwC,KAAKC,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAAxC;CACA;CACD,GA7CF;CA8CC/c,EAAAA,OA9CD,qBA+CC;CACC,QAAI,CAAC,KAAKgd,OAAL,EAAL,EACA;CACC,WAAKhZ,cAAL,GAAsBiZ,QAAtB,CAA+BrV,4BAAmB,CAACS,gBAAnD;CACA;;CAED,QAAI,CAAC,KAAK6U,eAAV,EACA;CACCje,MAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAACZ,UAAV,CAAqB8L,gBAAvC;CACA;CACD,GAzDF;CA0DCE,EAAAA,aA1DD,2BA2DC;CACC,SAAK4S,eAAL;CAEAle,IAAAA,6BAAY,CAACuL,WAAb,CAAyBrL,kBAAS,CAACZ,UAAV,CAAqByR,YAA9C,EAA4D,KAAKuM,cAAjE;CACAtd,IAAAA,6BAAY,CAACuL,WAAb,CAAyBrL,kBAAS,CAACZ,UAAV,CAAqBS,UAA9C,EAA0D,KAAKwd,YAA/D;CAEAvP,IAAAA,aAAa,CAAC,KAAKJ,gBAAN,CAAb;CACA,GAlEF;CAmEC1M,EAAAA,QAAQ;CAEPhB,IAAAA,SAAS,EAAE;CAAA,aAAMA,kBAAN;CAAA,KAFJ;CAGP2Y,IAAAA,cAAc,EAAE;CAAA,aAAMA,iCAAN;CAAA,KAHT;CAIP3K,IAAAA,MAJO,oBAKP;CACC,aAAO,KAAKlR,WAAL,CAAiByL,MAAjB,CAAwByF,MAA/B;CACA,KAPM;CAQPiQ,IAAAA,YARO,0BASP;CACC,UAAI,KAAKrR,MAAT,EACA;CACC,eAAO,KAAKA,MAAL,CAAYsR,IAAnB;CACA;CACD,KAdM;CAePvQ,IAAAA,iBAfO,+BAgBP;CACC,aAAO,KAAKvO,UAAL,CAAgBmJ,MAAhB,CAAuBoF,iBAA9B;CACA,KAlBM;CAmBPwQ,IAAAA,UAnBO,wBAoBP;CACC,aAAO,KAAK/e,UAAL,CAAgBmJ,MAAhB,CAAuB6V,MAA9B;CACA,KAtBM;CAuBP1O,IAAAA,eAvBO,6BAwBP;CACC,UAAI,KAAKrQ,IAAT,EACA;CACC,eAAO,KAAKA,IAAL,CAAUX,IAAV,KAAmB,KAAKuC,QAAL,CAAc,wCAAd,CAA1B;CACA;;CAED,aAAO,KAAP;CACA,KA/BM;CAgCPwW,IAAAA,cAhCO,4BAiCP;CACC,aAAO,KAAKrY,UAAL,CAAgBmJ,MAAhB,CAAuBkP,cAA9B;CACA,KAnCM;CAoCP4G,IAAAA,eApCO,6BAqCP;CACC,UAAMzG,MAAM,GAAG,EAAf;;CACA,UAAI,KAAKH,cAAL,KAAwB,OAA5B,EACA;CACCG,QAAAA,MAAM,CAACtH,IAAP,CAAY,gCAAZ;CACA,OAHD,MAIK,IAAI,KAAKmH,cAAL,KAAwB,OAA5B,EACL;CACCG,QAAAA,MAAM,CAACtH,IAAP,CAAY,iCAAZ;CACA;;CAED,aAAOsH,MAAP;CACA,KAjDM;CAkDP0G,IAAAA,cAlDO,4BAmDP;CACC,UAAI,KAAK7G,cAAL,KAAwBkB,iCAAc,CAAC4F,KAA3C,EACA;CACC,eAAO,EAAP;CACA;;CAED,aAAO;CACNpY,QAAAA,MAAM,YAAK,KAAK2W,mBAAL,CAAyBC,WAA9B;CADA,OAAP;CAGA,KA5DM;CA6DPyB,IAAAA,WA7DO,yBA8DP;CACC,UAAM5G,MAAM,GAAG,EAAf;;CACA,UAAI,KAAKH,cAAL,KAAwB,OAA5B,EACA;CACCG,QAAAA,MAAM,CAACtH,IAAP,CAAY,mCAAZ;CACA,OAHD,MAIK,IAAI,KAAKmH,cAAL,KAAwB,MAA5B,EACL;CACCG,QAAAA,MAAM,CAACtH,IAAP,CAAY,iCAAZ;CACA;;CAED,aAAOsH,MAAP;CACA,KA1EM;CA2EP6G,IAAAA,UA3EO,wBA4EP;CACC,UAAI,KAAKhH,cAAL,KAAwBkB,iCAAc,CAAC4F,KAA3C,EACA;CACC,eAAO,EAAP;CACA;;CAED,aAAO;CACNpY,QAAAA,MAAM,YAAK,KAAK2W,mBAAL,CAAyBE,UAA9B;CADA,OAAP;CAGA,KArFM;CAsFP0B,IAAAA,YAtFO,0BAuFP;CACC,aAAO,KAAKtf,UAAL,CAAgBmJ,MAAhB,CAAuBoW,QAA9B;CACA,KAzFM;CA0FPC,IAAAA,iBA1FO,+BA2FP;CACC,aAAO,KAAKxf,UAAL,CAAgBmJ,MAAhB,CAAuBpJ,KAAvB,KAAiC+V,4BAAmB,CAACqH,WAA5D;CACA,KA7FM;CA8FPtO,IAAAA,WA9FO,yBA+FP;CACC,aAAO,KAAK7O,UAAL,CAAgBmJ,MAAhB,CAAuB0F,WAA9B;CACA,KAjGM;CAkGPC,IAAAA,cAlGO,4BAmGP;CACC,aAAO,KAAK9O,UAAL,CAAgBmJ,MAAhB,CAAuB4F,UAA9B;CACA,KArGM;CAsGPQ,IAAAA,sBAtGO,oCAuGP;CACC,aAAO,KAAKT,cAAL,CAAoBU,QAApB,CAA6B,KAAKZ,MAAlC,CAAP;CACA,KAzGM;CA0GP1F,IAAAA,SA1GO,uBA2GP;CACC,aAAO,KAAKlJ,UAAL,CAAgBmJ,MAAhB,CAAuBzK,KAA9B;CACA,KA7GM;CA8GPigB,IAAAA,eA9GO,6BA+GP;CACC,aAAO,KAAK3e,UAAL,CAAgBmJ,MAAhB,CAAuBsW,WAA9B;CACA,KAjHM;CAkHPC,IAAAA,oBAlHO,kCAmHP;CACC,aAAO,KAAK1f,UAAL,CAAgBmJ,MAAhB,CAAuBuW,oBAA9B;CACA,KArHM;CAsHPC,IAAAA,oBAtHO,kCAuHP;CACC,aAAO,CAAC,KAAK3f,UAAL,CAAgBmJ,MAAhB,CAAuByW,SAAvB,GAAmC,aAAnC,GAAkD,EAAnD,CAAP;CACA,KAzHM;CA0HPC,IAAAA,WA1HO,yBA2HP;CACC,UAAM7O,OAAO,GAAG,CAAC,2BAAD,CAAhB;;CAEA,UAAI,KAAKpK,QAAL,MAAmB,KAAKiI,WAAxB,IAAuC,CAAC,KAAKU,sBAA7C,IAAuE,KAAKiQ,iBAAhF,EACA;CACCxO,QAAAA,OAAO,CAACE,IAAR,CAAa,yCAAb;CACA;;CAED,aAAOF,OAAP;CACA,KApIM;CAqIPzS,IAAAA,MArIO,oBAsIP;CACC,UAAI,KAAKb,WAAT,EACA;CACC,eAAO,KAAKA,WAAL,CAAiB8P,MAAjB,CAAwBjP,MAA/B;CACA;;CAED,aAAO,CAAP;CACA,KA7IM;CA8IPsD,IAAAA,QA9IO,sBA+IP;CACC,aAAOC,gBAAS,CAACC,kBAAV,CAA6B,CAAC,uBAAD,EAA0B,sBAA1B,CAA7B,CAAP;CACA;CAjJM,KAkJJqI,gBAAI,CAACC,QAAL,CAAc;CAChBrK,IAAAA,UAAU,EAAE,oBAAAD,KAAK;CAAA,aAAIA,KAAK,CAACC,UAAV;CAAA,KADD;CAEhBtC,IAAAA,WAAW,EAAE,qBAAAqC,KAAK;CAAA,aAAIA,KAAK,CAACrC,WAAV;CAAA,KAFF;CAGhBuC,IAAAA,IAAI,EAAE,cAAAF,KAAK;CAAA,aAAIA,KAAK,CAACqR,KAAN,CAAYvD,UAAZ,CAAuB9N,KAAK,CAACrC,WAAN,CAAkByL,MAAlB,CAAyByF,MAAhD,CAAJ;CAAA,KAHK;CAIhBpB,IAAAA,MAAM,EAAE,gBAAAzN,KAAK;CAAA,aAAIA,KAAK,CAAC6N,SAAN,CAAgBC,UAAhB,CAA2B9N,KAAK,CAACrC,WAAN,CAAkB8P,MAAlB,CAAyBM,QAApD,CAAJ;CAAA;CAJG,GAAd,CAlJI,CAnET;CA4NC3M,EAAAA,KAAK,EACL;CACCme,IAAAA,YADD,wBACc1P,QADd,EAEC;CAAA;;CACC,UAAI,KAAKhJ,QAAL,EAAJ,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAIgJ,QAAQ,KAAK,IAAjB,EACA;CACC,aAAK3C,SAAL,CAAe,YAAM;CACpBvM,UAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC4M,MAAV,CAAiBsS,aAAnC,EAAkD;CAACvhB,YAAAA,MAAM,EAAE,KAAI,CAACA;CAAd,WAAlD;CACAmC,UAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC6Y,QAAV,CAAmBsG,QAArC;CACA,SAHD;CAIA;CACD,KAfF;CAgBC1H,IAAAA,cAhBD,0BAgBgBzI,QAhBhB,EAiBC;CAAA;;CACC,UAAIA,QAAQ,KAAK2J,iCAAc,CAACyG,IAA5B,IAAoCpQ,QAAQ,KAAK2J,iCAAc,CAAC4F,KAApE,EACA;CACC,aAAKlS,SAAL,CAAe,YAAM;CACpBvM,UAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC4M,MAAV,CAAiBsS,aAAnC,EAAkD;CAACvhB,YAAAA,MAAM,EAAE,MAAI,CAACA;CAAd,WAAlD;CACAmC,UAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC6Y,QAAV,CAAmBsG,QAArC;CACA,SAHD;CAIA;CACD,KAzBF;CA0BClB,IAAAA,YA1BD,wBA0BcjP,QA1Bd,EA2BC;CACC,UAAIA,QAAQ,KAAK,IAAjB,EACA;CACC,aAAKnK,cAAL,GAAsBwa,eAAtB;CACA;CACD,KAhCF;CAiCC;CACAlB,IAAAA,UAlCD,sBAkCYnP,QAlCZ,EAmCC;CACC,UAAIA,QAAQ,KAAK,IAAb,IAAqB,KAAKsC,SAAL,EAArB,IAAyC,KAAKyM,eAAlD,EACA;CACC,aAAK1R,SAAL,CAAe,YAAM;CACpBvM,UAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAACZ,UAAV,CAAqB6M,kBAAvC;CACA,SAFD;CAGA;CACD,KA1CF;CA2CC5M,IAAAA,IA3CD,kBA4CC;CACC,UAAI,KAAKA,IAAL,IAAa,KAAKqQ,eAAtB,EACA;CACC,aAAK7K,cAAL,GAAsBuU,iBAAtB;CACA;CACD;CAjDF,GA7ND;CAgRC3Z,EAAAA,OAAO,EACP;CACC0d,IAAAA,iBADD,+BAEC;CACC,WAAKmC,kBAAL,GAA0B,IAAIC,kCAAJ,CAAuB,KAAK1iB,OAA5B,CAA1B;CACA,WAAK2iB,eAAL,GAAuB,IAAI5iB,yBAAJ,CAA8B,KAAKC,OAAnC,CAAvB;CACA,WAAK4iB,cAAL,GAAsB,IAAIC,8BAAJ,CAAmB,KAAK7iB,OAAxB,CAAtB;CACA,WAAK8iB,eAAL,GAAuB,IAAIC,+BAAJ,CAAoB,KAAK/iB,OAAzB,CAAvB;CACA,WAAKgjB,qBAAL,GAA6B,IAAIviB,+BAAJ,CAAoC,KAAKT,OAAzC,CAA7B;CACA,KARF;CASCmhB,IAAAA,eATD,6BAUC;CACC,WAAKsB,kBAAL,CAAwBvJ,OAAxB;CACA,WAAKyJ,eAAL,CAAqBzJ,OAArB;CACA,WAAK0J,cAAL,CAAoB1J,OAApB;CACA,WAAK4J,eAAL,CAAqB5J,OAArB;CACA,WAAK8J,qBAAL,CAA2B9J,OAA3B;CACA,KAhBF;CAiBCsH,IAAAA,YAjBD,0BAkBC;CACC,WAAKxY,cAAL,GAAsBzH,YAAtB;CACA,KApBF;CAqBCugB,IAAAA,cArBD,0BAqBgB1gB,KArBhB,EAsBC;CACC,UAAI,CAAC,KAAK4H,cAAL,GAAsBib,QAA3B,EACA;CACC;CACA;;CAED,UAAI,CAAC,KAAKlB,iBAAV,EACA;CACC3hB,QAAAA,KAAK,CAAC8iB,cAAN;CACY9iB,QAAAA,KAAK,CAAC+iB,WAAN,GAAoB,EAApB;CACZ;CACD,KAjCF;CAkCCC,IAAAA,mBAlCD,+BAkCqBhjB,KAlCrB,EAmCC;CACC6C,MAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC6Y,QAAV,CAAmBC,UAArC,EAAiD;CAAErM,QAAAA,IAAI,EAAExP,KAAK,CAACwP;CAAd,OAAjD;CACA,KArCF;CAsCCyT,IAAAA,iBAtCD,+BAuCC;CACCpgB,MAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC6Y,QAAV,CAAmBsG,QAArC;CACA,KAzCF;CA0CC/B,IAAAA,cA1CD,4BA2CC;CACC,WAAKV,eAAL,GAAuB,IAAvB;CACA,KA7CF;CA8CCyD,IAAAA,eA9CD,2BA8CiBljB,KA9CjB,EA+CC;CACC,UAAI,KAAK4f,QAAT,EACA;CACC;CACA;;CAED,WAAKA,QAAL,GAAgB,IAAhB;CAEA,WAAKuD,kBAAL,GAA0BnjB,KAAK,CAACojB,OAAhC;CACA,WAAKC,mBAAL,GAA2B,KAAKxD,mBAAL,CAAyBE,UAApD;CAEA,WAAKuD,iBAAL;CACA,KA3DF;CA4DCC,IAAAA,kBA5DD,8BA4DoBvjB,KA5DpB,EA6DC;CACC,UAAI,CAAC,KAAK4f,QAAV,EACA;CACC;CACA;;CAED,WAAK4D,oBAAL,GAA4BxjB,KAAK,CAACojB,OAAlC;CACA,UAAMK,eAAe,GAAG5f,QAAQ,CAACyc,IAAT,CAAcoD,YAAtC;CAEA,UAAMC,aAAa,GAAGF,eAAe,IAAI,KAAK5D,mBAAL,CAAyBI,aAAzB,GAAyC,GAA7C,CAArC;CACA,UAAM2D,aAAa,GAAGH,eAAe,IAAI,KAAK5D,mBAAL,CAAyBG,aAAzB,GAAyC,GAA7C,CAArC;CACA,UAAM6D,eAAe,GAAGJ,eAAe,IAAI,KAAKJ,mBAAL,GAA2B,GAA/B,CAAvC;CACA,UAAMS,cAAc,GAAGje,IAAI,CAACke,GAAL,CACtBle,IAAI,CAACme,GAAL,CAASH,eAAe,GAAG,KAAKV,kBAAvB,GAA4C,KAAKK,oBAA1D,EAAgFG,aAAhF,CADsB,EAEtBC,aAFsB,CAAvB;CAKA,UAAM7D,UAAU,GAAI+D,cAAc,GAAGL,eAAlB,GAAqC,GAAxD;;CAEA,UAAI,KAAK5D,mBAAL,CAAyBE,UAAzB,KAAwCA,UAA5C,EACA;CACC,aAAKF,mBAAL,CAAyBE,UAAzB,GAAsCA,UAAtC;CACA,aAAKF,mBAAL,CAAyBC,WAAzB,GAAuC,MAAMC,UAA7C;CACA;CACD,KArFF;CAsFCkE,IAAAA,cAtFD,0BAsFgBjkB,KAtFhB,EAuFC;CACC,UAAI,CAAC,KAAK4f,QAAV,EACA;CACC;CACA;;CAED,WAAKA,QAAL,GAAgB,KAAhB;CACA,WAAKsE,oBAAL;CACArhB,MAAAA,6BAAY,CAACC,IAAb,CAAkBC,kBAAS,CAAC4M,MAAV,CAAiBwU,cAAnC,EAAmD;CAACzjB,QAAAA,MAAM,EAAE,KAAKA,MAAd;CAAsB0jB,QAAAA,KAAK,EAAE;CAA7B,OAAnD;CACA,KAhGF;CAiGCd,IAAAA,iBAjGD,+BAkGC;CACCzf,MAAAA,QAAQ,CAAC4c,gBAAT,CAA0B,WAA1B,EAAuC,KAAK8C,kBAA5C;CACA1f,MAAAA,QAAQ,CAAC4c,gBAAT,CAA0B,SAA1B,EAAqC,KAAKwD,cAA1C;CACApgB,MAAAA,QAAQ,CAAC4c,gBAAT,CAA0B,YAA1B,EAAwC,KAAKwD,cAA7C;CACA,KAtGF;CAuGCC,IAAAA,oBAvGD,kCAwGC;CACCrgB,MAAAA,QAAQ,CAACwgB,mBAAT,CAA6B,WAA7B,EAA0C,KAAKd,kBAA/C;CACA1f,MAAAA,QAAQ,CAACwgB,mBAAT,CAA6B,SAA7B,EAAwC,KAAKJ,cAA7C;CACApgB,MAAAA,QAAQ,CAACwgB,mBAAT,CAA6B,YAA7B,EAA2C,KAAKJ,cAAhD;CACA,KA5GF;CA8GClb,IAAAA,QA9GD,sBA+GC;CACC,aAAOF,kBAAK,CAACC,MAAN,CAAaC,QAAb,EAAP;CACA,KAjHF;CAkHCsL,IAAAA,SAlHD,uBAmHC;CACC,aAAOxL,kBAAK,CAACyL,QAAN,CAAeC,eAAf,EAAP;CACA,KArHF;CAsHC8L,IAAAA,aAtHD,2BAuHC;CACC,UAAI,CAAC,KAAKV,gBAAV,EACA;CACC,aAAKA,gBAAL,GAAwB9b,QAAQ,CAACygB,aAAT,CAAuB,MAAvB,CAAxB;CACA,aAAK3E,gBAAL,CAAsB4E,YAAtB,CAAmC,MAAnC,EAA2C,UAA3C;CACA,aAAK5E,gBAAL,CAAsB4E,YAAtB,CAAmC,SAAnC,EAA8C,+FAA9C;CACA1gB,QAAAA,QAAQ,CAAC2gB,IAAT,CAAcC,WAAd,CAA0B,KAAK9E,gBAA/B;CACA;;CAED9b,MAAAA,QAAQ,CAACyc,IAAT,CAAcC,SAAd,CAAwBC,GAAxB,CAA4B,qCAA5B;;CAEA,UAAI3X,kBAAK,CAAC6b,OAAN,CAAcC,aAAd,EAAJ,EACA;CACC9gB,QAAAA,QAAQ,CAACyc,IAAT,CAAcC,SAAd,CAAwBC,GAAxB,CAA4B,4CAA5B;CACA;CACD,KAtIF;CAuICI,IAAAA,OAvID,qBAwIC;CACC,aAAOlU,QAAQ,CAACkY,QAAT,KAAsB,QAA7B;CACA,KA1IF;CA2IC7iB,IAAAA,WA3ID,yBA4IC;CACC,aAAO,KAAKI,UAAL,CAAgBC,IAAhB,CAAqBC,IAA5B;CACA,KA9IF;CA+ICuF,IAAAA,cA/ID,4BAgJC;CACC,aAAO,KAAKhI,OAAL,CAAaE,WAAb,CAAyBC,GAAzB,EAAP;CACA;CACD;;CAnJD,GAjRD;CAsaCiD,EAAAA,QAAQ;CAtaT,CADA;;;;"}