{"version":3,"file":"media.bundle.js","sources":["../src/file.js","../src/audio.js","../src/image.js","../src/video.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './file.css';\nimport 'ui.icons';\n\nimport {Uploader} from \"ui.progressbarjs.uploader\";\n\nimport {Vue} from 'ui.vue';\nimport {Vuex} from \"ui.vue.vuex\";\nimport {FilesModel} from 'im.model';\nimport {FileType, FileStatus, MessageType} from 'im.const';\nimport {Utils} from \"im.utils\";\n\nVue.component('bx-messenger-element-file',\n{\n\t/*\n\t * @emits 'uploadCancel' {file: object, event: MouseEvent}\n\t */\n\n\tmounted()\n\t{\n\t\tthis.createProgressbar();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.removeProgressbar();\n\t},\n\tprops:\n\t{\n\t\tuserId: { default: 0 },\n\t\tmessageType: { default: MessageType.self },\n\t\tfile: {\n\t\t\ttype: Object,\n\t\t\tdefault: FilesModel.create().getElementState\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload(file)\n\t\t{\n\t\t\tif (file.progress !== 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (file.type === FileType.image && file.urlShow)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tBXMobileApp.UI.Photo.show({\n\t\t\t\t\t\tphotos: this.files.collection[this.application.dialog.chatId].filter(file => file.type === 'image').map(file => {return {url: file.urlShow.replace('bxhttp', 'http')}}).reverse(),\n\t\t\t\t\t\tdefault_photo: file.urlShow.replace('bxhttp', 'http')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (file.type === FileType.video && file.urlShow)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlShow, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (file.urlDownload)\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlDownload, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlDownload, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\tapp.openDocument({url: file.urlShow, name: file.name});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file.urlShow, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcreateProgressbar()\n\t\t{\n\t\t\tif (this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.file.progress === 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet blurElement = undefined;\n\n\t\t\tif (\n\t\t\t\tthis.file.progress < 0\n\t\t\t\t|| this.file.type !== FileType.image && this.file.type !== FileType.video\n\t\t\t)\n\t\t\t{\n\t\t\t\tblurElement = false;\n\t\t\t}\n\n\t\t\tthis.uploader = new Uploader({\n\t\t\t\tcontainer: this.$refs.container,\n\t\t\t\tblurElement,\n\t\t\t\tdirection: this.$refs.container.offsetHeight > 54? Uploader.direction.vertical: Uploader.direction.horizontal,\n\t\t\t\ticon: this.file.progress < 0? Uploader.icon.cloud: Uploader.icon.cancel,\n\t\t\t\tsizes: {\n\t\t\t\t\tcircle: this.$refs.container.offsetHeight > 54? 54: 38,\n\t\t\t\t\tprogress: this.$refs.container.offsetHeight > 54? 4: 8,\n\t\t\t\t},\n\t\t\t\tlabels: {\n\t\t\t\t\tloading: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING'],\n\t\t\t\t\tcompleted: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_COMPLETED'],\n\t\t\t\t\tcanceled: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCELED'],\n\t\t\t\t\tcancelTitle: this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCEL_TITLE'],\n\t\t\t\t\tmegabyte: this.localize['IM_MESSENGER_ELEMENT_FILE_SIZE_MB'],\n\t\t\t\t},\n\t\t\t\tcancelCallback: this.file.progress < 0? null: (event) => {\n\t\t\t\t\tthis.$emit('uploadCancel', {file: this.file, event});\n\t\t\t\t},\n\t\t\t\tdestroyCallback: () => {\n\t\t\t\t\tif (this.uploader)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.uploader = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.uploader.start();\n\n\t\t\tif(\n\t\t\t\tthis.file.size && (this.file.size/1024/1024) <= 2\n\t\t\t\t|| this.$refs.container.offsetHeight <= 54 && this.$refs.container.offsetWidth < 240\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgressTitleVisibility(false)\n\t\t\t}\n\n\t\t\tthis.updateProgressbar();\n\n\t\t\treturn true;\n\t\t},\n\t\tupdateProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\tlet result = this.createProgressbar();\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.file.status === FileStatus.error)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(0);\n\t\t\t\tthis.uploader.setCancelDisable(false);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.error);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_ERROR']);\n\t\t\t}\n\t\t\telse if (this.file.status === FileStatus.wait)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(this.file.progress > 5? this.file.progress: 5);\n\t\t\t\tthis.uploader.setCancelDisable(true);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.cloud);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_SAVING']);\n\t\t\t}\n\t\t\telse if (this.file.progress === 100)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(100);\n\t\t\t}\n\t\t\telse if (this.file.progress === -1)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(10);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_WAITING']);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.file.progress === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setIcon(Uploader.icon.cancel);\n\t\t\t\t}\n\t\t\t\tlet progress = this.file.progress > 5? this.file.progress: 5;\n\n\t\t\t\tthis.uploader.setProgress(progress);\n\n\t\t\t\tif((this.file.size/1024/1024) <= 2)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setProgressTitle(this.localize['IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setByteSent(this.file.size/100*this.file.progress, this.file.size);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.uploader.destroy(false);\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tFileStatus: () => FileStatus,\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('IM_MESSENGER_ELEMENT_FILE_', this.$root.$bitrixMessages);\n\t\t},\n\t\tfileName()\n\t\t{\n\t\t\tlet maxLength = 70;\n\n\t\t\tif (this.file.name.length < maxLength)\n\t\t\t{\n\t\t\t\treturn this.file.name;\n\t\t\t}\n\n\t\t\tlet endWordLength = 10;\n\n\t\t\tlet secondPart = this.file.name.substring(this.file.name.length-1 - (this.file.extension.length+1+endWordLength));\n\t\t\tlet firstPart = this.file.name.substring(0, maxLength-secondPart.length-3);\n\n\t\t\treturn firstPart.trim()+'...'+secondPart.trim();\n\t\t},\n\t\tfileSize()\n\t\t{\n\t\t\tlet size = this.file.size;\n\n\t\t\tif (size <= 0)\n\t\t\t{\n\t\t\t\treturn '&nbsp;';\n\t\t\t}\n\n\t\t\tlet sizes = [\"BYTE\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\t\tlet position = 0;\n\n\t\t\twhile (size >= 1024 && position < 4)\n\t\t\t{\n\t\t\t\tsize /= 1024;\n\t\t\t\tposition++;\n\t\t\t}\n\n\t\t\treturn Math.round(size) + \" \" + this.localize['IM_MESSENGER_ELEMENT_FILE_SIZE_'+sizes[position]];\n\t\t},\n\t\tuploadProgress()\n\t\t{\n\t\t\treturn this.file.status+' '+this.file.progress;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t\tfiles: state => state.files,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tthis.updateProgressbar();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-element-file\" @click=\"download(file, $event)\" ref=\"container\">\n\t\t\t<div class=\"bx-im-element-file-icon\">\n\t\t\t\t<div :class=\"['ui-icon', 'ui-icon-file-'+file.icon]\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-element-file-block\">\n\t\t\t\t<div class=\"bx-im-element-file-name\" :title=\"file.name\">\n\t\t\t\t\t{{fileName}}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-element-file-size\" v-html=\"fileSize\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './audio.css';\nimport \"ui.vue.components.audioplayer\";\n\nimport {Vue} from 'ui.vue';\nimport {MessageType} from 'im.const';\n\nVue.cloneComponent('bx-messenger-element-file-audio', 'bx-messenger-element-file',\n{\n\tcomputed:\n\t{\n\t\tbackground()\n\t\t{\n\t\t\treturn this.messageType === MessageType.self? 'dark': 'light';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['bx-im-element-file-audio', 'bx-im-element-file-audio-'+messageType]\" ref=\"container\">\n\t\t\t<bx-audioplayer :id=\"file.id\" :src=\"file.urlShow\" :background=\"background\"/>\n\t\t</div>\t\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './image.css';\nimport 'ui.vue.directives.lazyload';\nimport 'ui.icons';\n\nimport \"ui.vue.components.audioplayer\";\n\nimport {Vue} from 'ui.vue';\n\nVue.cloneComponent('bx-messenger-element-file-image', 'bx-messenger-element-file',\n{\n\tmethods:\n\t{\n\t\tgetImageSize(width, height, maxWidth)\n\t\t{\n\t\t\tlet aspectRatio;\n\n\t\t\tif (width > maxWidth)\n\t\t\t{\n\t\t\t\taspectRatio = maxWidth / width;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\taspectRatio = 1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: width * aspectRatio,\n\t\t\t\theight: height * aspectRatio\n\t\t\t};\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('IM_MESSENGER_ELEMENT_FILE_', this.$root.$bitrixMessages);\n\t\t},\n\t\tstyleFileSizes()\n\t\t{\n\t\t\tlet sizes = this.getImageSize(this.file.image.width, this.file.image.height, 280);\n\n\t\t\treturn {\n\t\t\t\twidth: sizes.width+'px',\n\t\t\t\theight: sizes.height+'px',\n\t\t\t\tbackgroundSize: sizes.width < 100 || sizes.height < 100? 'contain': 'initial'\n\t\t\t}\n\t\t},\n\t\tstyleBoxSizes()\n\t\t{\n\t\t\tif (parseInt(this.styleFileSizes.height) <= 280)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: '280px'\n\t\t\t}\n\t\t},\n\t\tfileSource()\n\t\t{\n\t\t\treturn this.file.urlPreview;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-element-file-image\" @click=\"download(file, $event)\" :style=\"styleBoxSizes\" ref=\"container\">\n\t\t\t<img v-bx-lazyload\n\t\t\t\tclass=\"bx-im-element-file-image-source\"\n\t\t\t\t:data-lazyload-src=\"fileSource\"\n\t\t\t\t:title=\"localize.IM_MESSENGER_ELEMENT_FILE_SHOW_TITLE.replace('#NAME#', file.name).replace('#SIZE#', fileSize)\"\n\t\t\t\t:style=\"styleFileSizes\"\n\t\t\t/>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './video.css';\nimport 'ui.vue.directives.lazyload';\nimport 'ui.icons';\nimport \"ui.vue.components.socialvideo\";\n\nimport {Vue} from 'ui.vue';\n\nVue.cloneComponent('bx-messenger-element-file-video', 'bx-messenger-element-file',\n{\n\tmethods:\n\t{\n\t\tgetImageSize(width, height, maxWidth)\n\t\t{\n\t\t\tlet aspectRatio;\n\n\t\t\tif (width > maxWidth)\n\t\t\t{\n\t\t\t\taspectRatio = maxWidth / width;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\taspectRatio = 1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: width * aspectRatio,\n\t\t\t\theight: height * aspectRatio\n\t\t\t};\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('IM_MESSENGER_ELEMENT_FILE_', this.$root.$bitrixMessages);\n\t\t},\n\t\tstyleBoxSizes()\n\t\t{\n\t\t\tif (parseInt(this.styleVideoSizes.height) <= 280)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: '280px'\n\t\t\t}\n\t\t},\n\t\tstyleVideoSizes()\n\t\t{\n\t\t\tif (!this.file.image)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tlet sizes = this.getImageSize(this.file.image.width, this.file.image.height, 280);\n\n\t\t\treturn {\n\t\t\t\twidth: sizes.width+'px',\n\t\t\t\theight: sizes.height+'px',\n\t\t\t\tbackgroundSize: sizes.width < 100 || sizes.height < 100? 'contain': 'initial'\n\t\t\t}\n\t\t},\n\t\tautoplay()\n\t\t{\n\t\t\treturn this.file.size < 5000000 && this.application.options.autoplayVideo;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-element-file-video\" :style=\"styleBoxSizes\" ref=\"container\">\n\t\t\t<bx-socialvideo \n\t\t\t\t:id=\"file.id\" \n\t\t\t\t:src=\"file.urlShow\" \n\t\t\t\t:preview=\"file.urlPreview\" \n\t\t\t\t:containerStyle=\"styleBoxSizes\"\n\t\t\t\t:elementStyle=\"styleVideoSizes\"\n\t\t\t\t:autoplay=\"autoplay\"\n\t\t\t\t@click=\"download(file, $event)\"\n\t\t\t/>\n\t\t</div>\n\t`\n});"],"names":["Vue","component","mounted","createProgressbar","beforeDestroy","removeProgressbar","props","userId","default","messageType","MessageType","self","file","type","Object","FilesModel","create","getElementState","methods","download","progress","FileType","image","urlShow","Utils","platform","isBitrixMobile","BXMobileApp","UI","Photo","show","photos","files","collection","application","dialog","chatId","filter","map","url","replace","reverse","default_photo","window","open","video","app","openDocument","name","urlDownload","uploader","blurElement","undefined","Uploader","container","$refs","direction","offsetHeight","vertical","horizontal","icon","cloud","cancel","sizes","circle","labels","loading","localize","completed","canceled","cancelTitle","megabyte","cancelCallback","event","$emit","destroyCallback","start","size","offsetWidth","setProgressTitleVisibility","updateProgressbar","result","status","FileStatus","error","setProgress","setCancelDisable","setIcon","setProgressTitle","wait","setByteSent","destroy","computed","getFilteredPhrases","$root","$bitrixMessages","fileName","maxLength","length","endWordLength","secondPart","substring","extension","firstPart","trim","fileSize","position","Math","round","uploadProgress","Vuex","mapState","state","watch","template","cloneComponent","background","getImageSize","width","height","maxWidth","aspectRatio","styleFileSizes","backgroundSize","styleBoxSizes","parseInt","fileSource","urlPreview","styleVideoSizes","autoplay","options","autoplayVideo"],"mappings":"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"}