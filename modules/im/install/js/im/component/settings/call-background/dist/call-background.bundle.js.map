{"version":3,"file":"call-background.bundle.js","sources":["../src/item-background.js","../src/call-background.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2021 Bitrix\n */\n\nimport {Vue} from 'ui.vue';\nimport {Uploader} from \"ui.progressbarjs.uploader\";\nimport {FileStatus} from \"im.const\";\n\nexport const CallBackgroundItem =\n{\n\tprops:\n\t{\n\t\tselected: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\tdefault: {}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.createProgressbar();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.removeProgressbar();\n\t},\n\tmethods:\n\t{\n\t\tcreateProgressbar()\n\t\t{\n\t\t\tif (this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.item.state)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.item.state.progress === 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.uploader = new Uploader({\n\t\t\t\tcontainer: this.$refs.container,\n\t\t\t\tlabels: {\n\t\t\t\t\tloading: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_LOADING'],\n\t\t\t\t\tcompleted: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_COMPLETED'],\n\t\t\t\t\tcanceled: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_CANCELED'],\n\t\t\t\t\tcancelTitle: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_CANCEL_TITLE'],\n\t\t\t\t\tmegabyte: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_SIZE_MB'],\n\t\t\t\t},\n\t\t\t\tcancelCallback: this.item.state.progress < 0? null: (event) =>\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('cancel', {item: this.item, event});\n\t\t\t\t},\n\t\t\t\tdestroyCallback: () =>\n\t\t\t\t{\n\t\t\t\t\tif (this.uploader)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.uploader = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.uploader.start();\n\n\t\t\tif(\n\t\t\t\tthis.item.state.size && (this.item.state.size/1024/1024) <= 2\n\t\t\t\t|| this.$refs.container.offsetHeight <= 54 && this.$refs.container.offsetWidth < 240\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgressTitleVisibility(false)\n\t\t\t}\n\n\t\t\tthis.updateProgressbar();\n\n\t\t\treturn true;\n\t\t},\n\t\tupdateProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\tlet result = this.createProgressbar();\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.item.state.status === FileStatus.error)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(0);\n\t\t\t\tthis.uploader.setCancelDisable(false);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.error);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_ERROR']);\n\t\t\t}\n\t\t\telse if (this.item.state.status === FileStatus.wait)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(this.item.state.progress > 5? this.item.state.progress: 5);\n\t\t\t\tthis.uploader.setCancelDisable(true);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.cloud);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_SAVING']);\n\t\t\t}\n\t\t\telse if (this.item.state.progress === 100)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(100);\n\t\t\t}\n\t\t\telse if (this.item.state.progress === -1)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(10);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_WAITING']);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.item.state.progress === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setIcon(Uploader.icon.cancel);\n\t\t\t\t}\n\t\t\t\tlet progress = this.item.state.progress > 5? this.item.state.progress: 5;\n\n\t\t\t\tthis.uploader.setProgress(progress);\n\n\t\t\t\tif((this.item.state.size/1024/1024) <= 2)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_LOADING']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setByteSent(this.item.state.size/100*this.item.state.progress, this.item.state.size);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.uploader.destroy(false);\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tif (!this.item.state)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.item.state.status+' '+this.item.state.progress;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_IM_COMPONENT_SETTINGS_CALL_BG_', this.$root.$bitrixMessages);\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tthis.updateProgressbar();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :key=\"item.id\" @click=\"$emit('select')\" :class=\"['bx-im-settings-video-background-dialog-item', {'bx-im-settings-video-background-dialog-item-selected': selected, 'bx-im-settings-video-background-dialog-item-unsupported': !item.supported , 'bx-im-settings-video-background-dialog-item-loading': item.loading }]\" ref=\"container\">\n\t\t\t<div class=\"bx-im-settings-video-background-dialog-item-image\" :style=\"{backgroundImage: item.preview? 'url('+item.preview+')': ''}\"></div>\n\t\t\t<div v-if=\"item.supported && item.video\" class=\"bx-im-settings-video-background-dialog-item-video\"></div>\n\t\t\t<div v-if=\"!item.loading\" class=\"bx-im-settings-video-background-dialog-item-title\">\n\t\t\t\t<span class=\"bx-im-settings-video-background-dialog-item-title-text\">{{item.title}}</span>\n\t\t\t\t<div v-if=\"item.canRemove\" class=\"bx-im-settings-video-background-dialog-item-remove\" :title=\"localize.BX_IM_COMPONENT_SETTINGS_CALL_BG_REMOVE\" @click=\"$emit('remove')\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {ajax as Ajax, Loc} from \"main.core\";\nimport {Vue} from \"ui.vue\";\nimport {Uploader} from \"im.lib.uploader\";\nimport {Utils} from \"im.lib.utils\";\nimport {FileStatus} from \"im.const\";\nimport \"ui.info-helper\";\nimport \"ui.notification\";\n\nimport \"./call-background.css\";\nimport {CallBackgroundItem} from \"./item-background\";\n\nconst ActionType = Object.freeze({\n\tnone: 'none',\n\tupload: 'upload',\n\tblur: 'blur',\n\tgaussianBlur: 'gaussianBlur',\n});\n\nconst LimitCode = Object.freeze({\n\tblur: 'call_blur_background',\n\timage: 'call_background',\n});\n\nVue.component('bx-im-component-settings-call-background',\n{\n\tprops:\n\t{\n\t\tisDesktop: {type: Boolean, default: false},\n\t\twidth: {default: 0},\n\t\theight: {default: 450},\n\t},\n\tdata: function()\n\t{\n\t\treturn {\n\t\t\tactions: [],\n\t\t\tstandard: [],\n\t\t\tcustom: [],\n\t\t\tselected: '',\n\t\t\tActionType: ActionType,\n\t\t\tloading: true,\n\t\t\tdiskFolderId: 0\n\t\t};\n\t},\n\tcomponents:\n\t{\n\t\t'bx-im-component-settings-call-background-item': CallBackgroundItem\n\t},\n\tcreated()\n\t{\n\t\tthis.defaultValue = this.isDesktop? window.BX.desktop.getBackgroundImage(): {id: ActionType.none, source: ''};\n\t\tthis.selected = this.defaultValue.id;\n\t\tthis.limit = {};\n\n\t\tAjax.runAction(\"im.call.getBackground\", {\n\t\t}).then((response) => {\n\t\t\tthis.loading = false;\n\n\t\t\tthis.diskFolderId = response.data.diskFolderId;\n\n\t\t\tresponse.data.list.default.forEach(element => {\n\t\t\t\telement.video = element.id.includes(':video');\n\t\t\t\telement.custom = false;\n\t\t\t\telement.canRemove = false;\n\t\t\t\telement.supported = true;\n\t\t\t\tthis.standard.push(element);\n\t\t\t});\n\n\t\t\tresponse.data.list.custom.forEach(element => {\n\t\t\t\telement.custom = true;\n\t\t\t\telement.canRemove = true;\n\t\t\t\tif (element.supported)\n\t\t\t\t{\n\t\t\t\t\telement.title = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CUSTOM');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\telement.title = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_UNSUPPORTED');\n\t\t\t\t}\n\n\t\t\t\tthis.custom.push(element);\n\t\t\t});\n\n\t\t\tresponse.data.limit.forEach(element => {\n\t\t\t\tthis.limit[element.id] = element;\n\t\t\t});\n\n\t\t\tif (this.diskFolderId)\n\t\t\t{\n\t\t\t\tthis.actions = this.actions.map(element => {\n\t\t\t\t\telement.supported = true;\n\t\t\t\t\treturn element;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.actions = this.actions.filter(element => {\n\t\t\t\t\treturn element.id !== ActionType.upload\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!window.BX.UI.InfoHelper.isInited())\n\t\t\t{\n\t\t\t\twindow.BX.UI.InfoHelper.init({\n\t\t\t\t\tframeUrlTemplate: response.data.infohelper.frameUrlTemplate\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.hideLoader();\n\t\t\t}\n\t\t}).catch(() => {\n\t\t\tthis.loading = false;\n\t\t});\n\n\t\tthis.actions.push({\n\t\t\tid: ActionType.none,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_NONE'),\n\t\t\tsource: ActionType.none,\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.upload,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_UPLOAD'),\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.gaussianBlur,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_BLUR'),\n\t\t\tsource: ActionType.gaussianBlur,\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.blur,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_BLUR_MAX'),\n\t\t\tsource: ActionType.blur,\n\t\t});\n\t},\n\tmounted()\n\t{\n\t\tthis.uploader = new Uploader({\n\t\t\tinputNode: this.$refs.uploadInput,\n\t\t\tgeneratePreview: true,\n\t\t\tfileMaxSize: 100 * 1024 * 1024,\n\t\t});\n\n\t\tthis.uploader.subscribe('onFileMaxSizeExceeded', (event) => {\n            const eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\n\t\t\tconst localize = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_SIZE_EXCEEDED');\n\t\t\tif (localize)\n\t\t\t{\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: localize.replace('#LIMIT#', 100).replace('#FILE_NAME#', file.name),\n\t\t\t\t\tautoHideDelay: 5000\n\t\t\t\t});\n\t\t\t}\n        });\n\n\t\tthis.uploader.subscribe('onSelectFile', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\n\t\t\tif (!this.isAllowedType(file.type) || !eventData.previewData)\n\t\t\t{\n\t\t\t\tconst localize = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_UNSUPPORTED_FILE');\n\t\t\t\tif (localize)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: localize.replace('#FILE_NAME#', file.name),\n\t\t\t\t\t\tautoHideDelay: 5000\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.uploader.addTask({\n\t\t\t\ttaskId: `custom:${Date.now()}`,\n\t\t\t\tchunkSize: 1024 * 1024,\n\t\t\t\tfileData: file,\n\t\t\t\tfileName: file.name,\n\t\t\t\tdiskFolderId: this.diskFolderId,\n\t\t\t\tgenerateUniqueName: true,\n\t\t\t\tpreviewBlob: eventData.previewData,\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onStartUpload', event => {\n\t\t\tconst eventData = event.getData();\n\n\t\t\tconst filePreview = URL.createObjectURL(eventData.previewData);\n\n\t\t\tthis.custom.unshift({\n\t\t\t\tid: eventData.id,\n\t\t\t\tsource: filePreview,\n\t\t\t\tpreview: filePreview,\n\t\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CUSTOM'),\n\t\t\t\tvideo: eventData.file.type.startsWith('video'),\n\t\t\t\tcustom: true,\n\t\t\t\tcanRemove: false,\n\t\t\t\tsupported: true,\n\t\t\t\tloading: true,\n\t\t\t\tstate:\n\t\t\t\t{\n\t\t\t\t\tprogress: 0,\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tsize: eventData.file.size,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onProgress', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.progress = eventData.progress;\n\t\t});\n\n\t\tthis.uploader.subscribe('onComplete', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.id = eventData.result.data.file.id;\n\n\t\t\tif (element.video)\n\t\t\t{\n\t\t\t\telement.source = eventData.result.data.file.links.download;\n\t\t\t}\n\n\t\t\telement.loading = false;\n\t\t\telement.canRemove = true;\n\n\t\t\tthis.select(element);\n\n\t\t\tAjax.runAction('im.call.commitBackground', {data: {\n\t\t\t\tfileId: element.id\n\t\t\t}});\n\t\t});\n\n\t\tthis.uploader.subscribe('onUploadFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.status = FileStatus.error;\n\t\t\telement.state.progress = 0;\n\t\t});\n\n\t\tthis.uploader.subscribe('onCreateFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.status = FileStatus.error;\n\t\t\telement.state.progress = 0;\n\t\t});\n\t},\n\tcomputed:\n\t{\n\t\tcontainerSize()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\tresult.height = 'calc(100vh - 79px)'; // 79 button panel\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.height = this.height+'px';\n\t\t\t}\n\n\t\t\tif (this.width > 0)\n\t\t\t{\n\t\t\t\tresult.width = this.width+'px';\n\t\t\t}\n\n\t\t\treturn result\n\t\t},\n\t\tbackgrounds()\n\t\t{\n\t\t\treturn [].concat(this.custom).concat(this.standard);\n\t\t},\n\t\tuploadTypes()\n\t\t{\n\t\t\tif (Utils.platform.isBitrixDesktop())\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn '.png, .jpg, .jpeg, .avi, .mp4';\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_IM_COMPONENT_SETTINGS_CALL_BG_', this.$root.$bitrixMessages);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\thasLimit(elementId)\n\t\t{\n\t\t\tif (elementId === ActionType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ([ActionType.blur, ActionType.gaussianBlur].includes(elementId))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tthis.limit[LimitCode.blur]\n\t\t\t\t\t&& this.limit[LimitCode.blur].active\n\t\t\t\t\t&& this.limit[LimitCode.blur].articleCode\n\t\t\t\t\t&& window.BX.UI.InfoHelper\n\t\t\t\t)\n\t\t\t\t{\n\n\t\t\t\t\twindow.BX.UI.InfoHelper.show(this.limit[LimitCode.blur].articleCode);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.limit[LimitCode.image]\n\t\t\t\t&& this.limit[LimitCode.image].active\n\t\t\t\t&& this.limit[LimitCode.image].articleCode\n\t\t\t\t&& window.BX.UI.InfoHelper\n\t\t\t)\n\t\t\t{\n\t\t\t\twindow.BX.UI.InfoHelper.show(this.limit[LimitCode.image].articleCode)\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tselect(element)\n\t\t{\n\t\t\tif (!this.hasLimit(element.id))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!element.supported || element.loading)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (element.id === ActionType.upload)\n\t\t\t{\n\t\t\t\tthis.$refs.uploadInput.click();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.selected = element.id;\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.setBackgroundImage(element.id, element.source);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tremove(element)\n\t\t{\n\t\t\tif (element.id === this.selected)\n\t\t\t{\n\t\t\t\tthis.selected = ActionType.none;\n\n\t\t\t\tif (this.isDesktop)\n\t\t\t\t{\n\t\t\t\t\twindow.BX.desktop.setBackgroundImage(ActionType.none, ActionType.none);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (element.loading)\n\t\t\t{\n\t\t\t\tthis.uploader.deleteTask(element.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tAjax.runAction('disk.api.file.delete', {data: {\n\t\t\t\t\tfileId: element.id\n\t\t\t\t}});\n\t\t\t}\n\n\t\t\tthis.custom = this.custom.filter(el => el.id !== element.id);\n\n\t\t\treturn true;\n\t\t},\n\n\t\tsave()\n\t\t{\n\t\t\twindow.close();\n\t\t},\n\n\t\tcancel()\n\t\t{\n\t\t\tif (this.defaultValue.id === this.selected)\n\t\t\t{\n\t\t\t\twindow.close();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.setBackgroundImage(this.defaultValue.id, this.defaultValue.source).then(() => {\n\t\t\t\t\twindow.close();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.close();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tisAllowedType(type)\n\t\t{\n\t\t\treturn [\n\t\t\t\t'image/png',\n\t\t\t\t'image/jpeg',\n\t\t\t\t'video/avi',\n\t\t\t\t'video/mp4',\n\t\t\t\t'video/quicktime',\n\t\t\t].includes(type);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-settings-video-background-dialog\">\n\t\t\t<div class=\"bx-im-settings-video-background-dialog-inner\" :style=\"containerSize\">\n\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-container\">\n\t\t\t\t\t<div class=\"bx-im-settings-video-background-upload-input\"><input type=\"file\" :accept=\"uploadTypes\" ref=\"uploadInput\"/></div>\n\t\t\t\t\t<template v-if=\"loading\">\n\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-loader\">\n\t\t\t\t\t\t\t<svg class=\"bx-desktop-loader-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t\t\t\t\t<circle class=\"bx-desktop-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-content\">\n\t\t\t\t\t\t<template v-for=\"(element in actions\">\n\t\t\t\t\t\t\t<div :key=\"element.id\" @click=\"select(element)\" :class=\"['bx-im-settings-video-background-dialog-item', 'bx-im-settings-video-background-dialog-action', 'bx-im-settings-video-background-dialog-action-'+element.id, {'bx-im-settings-video-background-dialog-item-selected': selected === element.id }]\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-action-title\">{{element.title}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t<template v-for=\"(item in backgrounds\">\n\t\t\t\t\t\t\t<bx-im-component-settings-call-background-item \n\t\t\t\t\t\t\t\t:key=\"item.id\" \n\t\t\t\t\t\t\t\t:item=\"item\" \n\t\t\t\t\t\t\t\t:selected=\"selected === item.id\" \n\t\t\t\t\t\t\t\t@select=\"select(item)\" \n\t\t\t\t\t\t\t\t@cancel=\"remove(item)\"\n\t\t\t\t\t\t\t\t@remove=\"remove(item)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-btn-container ui-btn-container-center\">\n\t\t\t\t<button :class=\"['ui-btn', 'ui-btn-success', {'ui-btn-wait ui-btn-disabled': loading}]\" @click=\"save\">{{localize.BX_IM_COMPONENT_SETTINGS_CALL_BG_SAVE}}</button>\n\t\t\t\t<button class=\"ui-btn ui-btn-link\" @click=\"cancel\">{{localize.BX_IM_COMPONENT_SETTINGS_CALL_BG_CANCEL}}</button>\n\t\t\t</div>\n\t\t</div>\n\t`\n});"],"names":["CallBackgroundItem","props","selected","type","Boolean","default","item","Object","mounted","createProgressbar","beforeDestroy","removeProgressbar","methods","uploader","state","progress","Uploader","container","$refs","labels","loading","localize","completed","canceled","cancelTitle","megabyte","cancelCallback","event","$emit","destroyCallback","start","size","offsetHeight","offsetWidth","setProgressTitleVisibility","updateProgressbar","result","status","FileStatus","error","setProgress","setCancelDisable","setIcon","icon","setProgressTitle","wait","cloud","cancel","setByteSent","destroy","computed","uploadProgress","Vue","getFilteredPhrases","$root","$bitrixMessages","watch","template","ActionType","freeze","none","upload","blur","gaussianBlur","LimitCode","image","component","isDesktop","width","height","data","actions","standard","custom","diskFolderId","components","created","defaultValue","window","BX","desktop","getBackgroundImage","id","source","limit","Ajax","runAction","then","response","list","forEach","element","video","includes","canRemove","supported","push","title","Loc","getMessage","map","filter","UI","InfoHelper","isInited","init","frameUrlTemplate","infohelper","hideLoader","catch","inputNode","uploadInput","generatePreview","fileMaxSize","subscribe","eventData","getData","file","Notification","Center","notify","content","replace","name","autoHideDelay","isAllowedType","previewData","addTask","taskId","Date","now","chunkSize","fileData","fileName","generateUniqueName","previewBlob","filePreview","URL","createObjectURL","unshift","preview","startsWith","find","links","download","select","fileId","containerSize","backgrounds","concat","uploadTypes","Utils","platform","isBitrixDesktop","hasLimit","elementId","active","articleCode","show","click","setBackgroundImage","remove","deleteTask","el","save","close"],"mappings":"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"}