{"version":3,"file":"call-background.bundle.js","sources":["../src/item-background.js","../src/call-background.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2021 Bitrix\n */\n\nimport {BitrixVue} from 'ui.vue';\nimport {Uploader} from \"ui.progressbarjs.uploader\";\nimport {FileStatus} from \"im.const\";\n\nexport const CallBackgroundItem =\n{\n\tprops:\n\t{\n\t\tselected: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\tdefault: {}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.createProgressbar();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.removeProgressbar();\n\t},\n\tmethods:\n\t{\n\t\tcreateProgressbar()\n\t\t{\n\t\t\tif (this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.item.state)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.item.state.progress === 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.uploader = new Uploader({\n\t\t\t\tcontainer: this.$refs.container,\n\t\t\t\tlabels: {\n\t\t\t\t\tloading: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_LOADING'],\n\t\t\t\t\tcompleted: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_COMPLETED'],\n\t\t\t\t\tcanceled: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_CANCELED'],\n\t\t\t\t\tcancelTitle: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_CANCEL_TITLE'],\n\t\t\t\t\tmegabyte: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_SIZE_MB'],\n\t\t\t\t},\n\t\t\t\tcancelCallback: this.item.state.progress < 0? null: (event) =>\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('cancel', {item: this.item, event});\n\t\t\t\t},\n\t\t\t\tdestroyCallback: () =>\n\t\t\t\t{\n\t\t\t\t\tif (this.uploader)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.uploader = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.uploader.start();\n\n\t\t\tif(\n\t\t\t\tthis.item.state.size && (this.item.state.size/1024/1024) <= 2\n\t\t\t\t|| this.$refs.container.offsetHeight <= 54 && this.$refs.container.offsetWidth < 240\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgressTitleVisibility(false)\n\t\t\t}\n\n\t\t\tthis.updateProgressbar();\n\n\t\t\treturn true;\n\t\t},\n\t\tupdateProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\tlet result = this.createProgressbar();\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.item.state.status === FileStatus.error)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(0);\n\t\t\t\tthis.uploader.setCancelDisable(false);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.error);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_ERROR']);\n\t\t\t}\n\t\t\telse if (this.item.state.status === FileStatus.wait)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(this.item.state.progress > 5? this.item.state.progress: 5);\n\t\t\t\tthis.uploader.setCancelDisable(true);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.cloud);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_SAVING']);\n\t\t\t}\n\t\t\telse if (this.item.state.progress === 100)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(100);\n\t\t\t}\n\t\t\telse if (this.item.state.progress === -1)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(10);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_WAITING']);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.item.state.progress === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setIcon(Uploader.icon.cancel);\n\t\t\t\t}\n\t\t\t\tlet progress = this.item.state.progress > 5? this.item.state.progress: 5;\n\n\t\t\t\tthis.uploader.setProgress(progress);\n\n\t\t\t\tif((this.item.state.size/1024/1024) <= 2)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_LOADING']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setByteSent(this.item.state.size/100*this.item.state.progress, this.item.state.size);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.uploader.destroy(false);\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tif (!this.item.state)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.item.state.status+' '+this.item.state.progress;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_SETTINGS_CALL_BG_', this);\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tthis.updateProgressbar();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :key=\"item.id\" @click=\"$emit('select')\" :class=\"['bx-im-settings-video-background-dialog-item', {'bx-im-settings-video-background-dialog-item-selected': selected, 'bx-im-settings-video-background-dialog-item-unsupported': !item.isSupported , 'bx-im-settings-video-background-dialog-item-loading': item.isLoading }]\" ref=\"container\">\n\t\t\t<div class=\"bx-im-settings-video-background-dialog-item-image\" :style=\"{backgroundImage: item.preview? 'url('+item.preview+')': ''}\"></div>\n\t\t\t<div v-if=\"item.isSupported && item.isVideo\" class=\"bx-im-settings-video-background-dialog-item-video\"></div>\n\t\t\t<div v-if=\"!item.isLoading\" class=\"bx-im-settings-video-background-dialog-item-title\">\n\t\t\t\t<span class=\"bx-im-settings-video-background-dialog-item-title-text\">{{item.title}}</span>\n\t\t\t\t<div v-if=\"item.canRemove\" class=\"bx-im-settings-video-background-dialog-item-remove\" :title=\"localize.BX_IM_COMPONENT_SETTINGS_CALL_BG_REMOVE\" @click=\"$emit('remove')\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {ajax as Ajax, Loc} from \"main.core\";\nimport {BitrixVue} from \"ui.vue\";\nimport {Uploader} from \"im.lib.uploader\";\nimport {Utils} from \"im.lib.utils\";\nimport {FileStatus} from \"im.const\";\nimport {rest as Rest} from \"rest.client\";\nimport \"ui.info-helper\";\nimport \"ui.notification\";\nimport \"ui.fonts.opensans\";\n\nimport \"./call-background.css\";\nimport {CallBackgroundItem} from \"./item-background\";\n\nconst ActionType = Object.freeze({\n\tnone: 'none',\n\tupload: 'upload',\n\tblur: 'blur',\n\tgaussianBlur: 'gaussianBlur',\n});\n\nconst LimitCode = Object.freeze({\n\tblur: 'call_blur_background',\n\timage: 'call_background',\n});\n\nBitrixVue.component('bx-im-component-settings-call-background',\n{\n\tprops:\n\t{\n\t\tisDesktop: {type: Boolean, default: false},\n\t\twidth: {default: 0},\n\t\theight: {default: 450},\n\t},\n\tdata: function()\n\t{\n\t\treturn {\n\t\t\tactions: [],\n\t\t\tstandard: [],\n\t\t\tcustom: [],\n\t\t\tselected: '',\n\t\t\tActionType: ActionType,\n\t\t\tloading: true,\n\t\t\tdiskFolderId: 0\n\t\t};\n\t},\n\tcomponents:\n\t{\n\t\t'bx-im-component-settings-call-background-item': CallBackgroundItem\n\t},\n\tcreated()\n\t{\n\t\tthis.defaultValue = this.isDesktop? window.BX.desktop.getBackgroundImage(): {id: ActionType.none, background: ''};\n\t\tthis.selected = this.defaultValue.id;\n\t\tthis.limit = {};\n\n\t\tRest.callMethod(\"im.v2.call.background.get\").then((response) => {\n\t\t\tthis.loading = false;\n\n\t\t\tthis.diskFolderId = response.data().upload.folderId;\n\n\t\t\tresponse.data().backgrounds.default.forEach(element => {\n\t\t\t\telement.isVideo = element.id.includes(':video');\n\t\t\t\telement.isCustom = false;\n\t\t\t\telement.canRemove = false;\n\t\t\t\telement.isSupported = true;\n\t\t\t\tthis.standard.push(element);\n\t\t\t});\n\n\t\t\tresponse.data().backgrounds.custom.forEach(element => {\n\t\t\t\telement.isCustom = true;\n\t\t\t\telement.canRemove = true;\n\t\t\t\tif (element.isSupported)\n\t\t\t\t{\n\t\t\t\t\telement.title = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CUSTOM');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\telement.title = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_UNSUPPORTED');\n\t\t\t\t}\n\n\t\t\t\tthis.custom.push(element);\n\t\t\t});\n\n\t\t\tresponse.data().limits.forEach(element => {\n\t\t\t\tthis.limit[element.id] = element;\n\t\t\t});\n\n\t\t\tif (this.diskFolderId)\n\t\t\t{\n\t\t\t\tthis.actions = this.actions.map(element => {\n\t\t\t\t\telement.isSupported = true;\n\t\t\t\t\treturn element;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.actions = this.actions.filter(element => {\n\t\t\t\t\treturn element.id !== ActionType.upload\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!window.BX.UI.InfoHelper.isInited())\n\t\t\t{\n\t\t\t\twindow.BX.UI.InfoHelper.init({\n\t\t\t\t\tframeUrlTemplate: response.data().infoHelperParams.frameUrlTemplate\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.hideLoader();\n\t\t\t}\n\t\t}).catch(() => {\n\t\t\tthis.loading = false;\n\t\t});\n\n\t\tthis.actions.push({\n\t\t\tid: ActionType.none,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_NONE'),\n\t\t\tbackground: ActionType.none,\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.upload,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_UPLOAD'),\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.gaussianBlur,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_BLUR'),\n\t\t\tbackground: ActionType.gaussianBlur,\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.blur,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_BLUR_MAX'),\n\t\t\tbackground: ActionType.blur,\n\t\t});\n\t},\n\tmounted()\n\t{\n\t\tthis.uploader = new Uploader({\n\t\t\tinputNode: this.$refs.uploadInput,\n\t\t\tgeneratePreview: true,\n\t\t\tfileMaxSize: 100 * 1024 * 1024,\n\t\t});\n\n\t\tthis.uploader.subscribe('onFileMaxSizeExceeded', (event) => {\n            const eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_SIZE_EXCEEDED').replace('#LIMIT#', 100).replace('#FILE_NAME#', file.name),\n\t\t\t\tautoHideDelay: 5000\n\t\t\t});\n        });\n\n\t\tthis.uploader.subscribe('onSelectFile', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\n\t\t\tif (!this.isAllowedType(file.type) || !eventData.previewData)\n\t\t\t{\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_UNSUPPORTED_FILE').replace('#FILE_NAME#', file.name),\n\t\t\t\t\tautoHideDelay: 5000\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.uploader.addTask({\n\t\t\t\ttaskId: `custom:${Date.now()}`,\n\t\t\t\tchunkSize: 1024 * 1024,\n\t\t\t\tfileData: file,\n\t\t\t\tfileName: file.name,\n\t\t\t\tdiskFolderId: this.diskFolderId,\n\t\t\t\tgenerateUniqueName: true,\n\t\t\t\tpreviewBlob: eventData.previewData,\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onStartUpload', event => {\n\t\t\tconst eventData = event.getData();\n\n\t\t\tconst filePreview = URL.createObjectURL(eventData.previewData);\n\n\t\t\tthis.custom.unshift({\n\t\t\t\tid: eventData.id,\n\t\t\t\tbackground: filePreview,\n\t\t\t\tpreview: filePreview,\n\t\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CUSTOM'),\n\t\t\t\tisVideo: eventData.file.type.startsWith('video'),\n\t\t\t\tisCustom: true,\n\t\t\t\tcanRemove: false,\n\t\t\t\tisSupported: true,\n\t\t\t\tisLoading: true,\n\t\t\t\tstate:\n\t\t\t\t{\n\t\t\t\t\tprogress: 0,\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tsize: eventData.file.size,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onProgress', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.progress = eventData.progress;\n\t\t});\n\n\t\tthis.uploader.subscribe('onComplete', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.id = eventData.result.data.file.id;\n\n\t\t\tif (element.isVideo)\n\t\t\t{\n\t\t\t\telement.background = eventData.result.data.file.links.download;\n\t\t\t}\n\n\t\t\telement.isLoading = false;\n\t\t\telement.canRemove = true;\n\n\t\t\tthis.select(element);\n\n\t\t\tRest.callMethod('im.v2.call.background.commit', {\n\t\t\t\tfileId: element.id\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onUploadFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.status = FileStatus.error;\n\t\t\telement.state.progress = 0;\n\t\t});\n\n\t\tthis.uploader.subscribe('onCreateFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.status = FileStatus.error;\n\t\t\telement.state.progress = 0;\n\t\t});\n\t},\n\tcomputed:\n\t{\n\t\tisMaskAvailable()\n\t\t{\n\t\t\tif (window.BX.getClass('BX.desktop'))\n\t\t\t{\n\t\t\t\treturn window.BX.desktop.getApiVersion() >= 72;\n\t\t\t}\n\t\t\telse if (window.BX.getClass(\"BX.Messenger.Lib.Utils.platform\"))\n\t\t\t{\n\t\t\t\treturn window.BX.Messenger.Lib.Utils.platform.getDesktopVersion() >= 72;\n\t\t\t}\n\t\t},\n\n\t\tcontainerSize()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\tresult.height = 'calc(100vh - 79px)'; // 79 button panel\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.height = this.height+'px';\n\t\t\t}\n\n\t\t\tif (this.width > 0)\n\t\t\t{\n\t\t\t\tresult.width = this.width+'px';\n\t\t\t}\n\n\t\t\treturn result\n\t\t},\n\t\tbackgrounds()\n\t\t{\n\t\t\treturn [].concat(this.custom).concat(this.standard);\n\t\t},\n\t\tuploadTypes()\n\t\t{\n\t\t\tif (Utils.platform.isBitrixDesktop())\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn '.png, .jpg, .jpeg, .avi, .mp4';\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\thasLimit(elementId)\n\t\t{\n\t\t\tif (elementId === ActionType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ([ActionType.blur, ActionType.gaussianBlur].includes(elementId))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tthis.limit[LimitCode.blur]\n\t\t\t\t\t&& this.limit[LimitCode.blur].active\n\t\t\t\t\t&& this.limit[LimitCode.blur].articleCode\n\t\t\t\t\t&& window.BX.UI.InfoHelper\n\t\t\t\t)\n\t\t\t\t{\n\n\t\t\t\t\twindow.BX.UI.InfoHelper.show(this.limit[LimitCode.blur].articleCode);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.limit[LimitCode.image]\n\t\t\t\t&& this.limit[LimitCode.image].active\n\t\t\t\t&& this.limit[LimitCode.image].articleCode\n\t\t\t\t&& window.BX.UI.InfoHelper\n\t\t\t)\n\t\t\t{\n\t\t\t\twindow.BX.UI.InfoHelper.show(this.limit[LimitCode.image].articleCode)\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tselect(element)\n\t\t{\n\t\t\tif (!this.hasLimit(element.id))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!element.isSupported || element.isLoading)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (element.id === ActionType.upload)\n\t\t\t{\n\t\t\t\tthis.$refs.uploadInput.click();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.selected = element.id;\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.setCallBackground(element.id, element.background);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tremove(element)\n\t\t{\n\t\t\tif (element.id === this.selected)\n\t\t\t{\n\t\t\t\tthis.selected = ActionType.none;\n\n\t\t\t\tif (this.isDesktop)\n\t\t\t\t{\n\t\t\t\t\twindow.BX.desktop.setCallBackground(ActionType.none, ActionType.none);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (element.isLoading)\n\t\t\t{\n\t\t\t\tthis.uploader.deleteTask(element.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tAjax.runAction('disk.api.file.delete', {data: {\n\t\t\t\t\tfileId: element.id\n\t\t\t\t}});\n\t\t\t}\n\n\t\t\tthis.custom = this.custom.filter(el => el.id !== element.id);\n\n\t\t\treturn true;\n\t\t},\n\n\t\tsave()\n\t\t{\n\t\t\twindow.close();\n\t\t},\n\n\t\tcancel()\n\t\t{\n\t\t\tif (this.defaultValue.id === this.selected)\n\t\t\t{\n\t\t\t\twindow.close();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.setCallBackground(this.defaultValue.id, this.defaultValue.background).then(() => {\n\t\t\t\t\twindow.close();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.close();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tisAllowedType(type)\n\t\t{\n\t\t\treturn [\n\t\t\t\t'image/png',\n\t\t\t\t'image/jpeg',\n\t\t\t\t'video/avi',\n\t\t\t\t'video/mp4',\n\t\t\t\t'video/quicktime',\n\t\t\t].includes(type);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-settings-video-background-dialog\">\n\t\t\t<div class=\"bx-im-settings-video-background-dialog-inner\" :style=\"containerSize\">\n\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-container\">\n\t\t\t\t\t<div class=\"bx-im-settings-video-background-upload-input\"><input type=\"file\" :accept=\"uploadTypes\" ref=\"uploadInput\"/></div>\n\t\t\t\t\t<template v-if=\"loading\">\n\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-loader\">\n\t\t\t\t\t\t\t<svg class=\"bx-desktop-loader-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t\t\t\t\t<circle class=\"bx-desktop-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-content\">\n\t\t\t\t\t\t<template v-for=\"(element in actions\">\n\t\t\t\t\t\t\t<div :key=\"element.id\" @click=\"select(element)\" :class=\"['bx-im-settings-video-background-dialog-item', 'bx-im-settings-video-background-dialog-action', 'bx-im-settings-video-background-dialog-action-'+element.id, {'bx-im-settings-video-background-dialog-item-selected': selected === element.id }]\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-action-title\">{{element.title}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t<template v-for=\"(item in backgrounds\">\n\t\t\t\t\t\t\t<bx-im-component-settings-call-background-item \n\t\t\t\t\t\t\t\t:key=\"item.id\" \n\t\t\t\t\t\t\t\t:item=\"item\" \n\t\t\t\t\t\t\t\t:selected=\"selected === item.id\" \n\t\t\t\t\t\t\t\t@select=\"select(item)\" \n\t\t\t\t\t\t\t\t@cancel=\"remove(item)\"\n\t\t\t\t\t\t\t\t@remove=\"remove(item)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-btn-container ui-btn-container-center\">\n\t\t\t\t<button :class=\"['ui-btn', 'ui-btn-success', {'ui-btn-wait ui-btn-disabled': loading}]\" @click=\"save\">{{$Bitrix.Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_SAVE')}}</button>\n\t\t\t\t<button class=\"ui-btn ui-btn-link\" @click=\"cancel\">{{$Bitrix.Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CANCEL')}}</button>\n\t\t\t</div>\n\t\t</div>\n\t`\n});"],"names":["CallBackgroundItem","props","selected","type","Boolean","item","Object","mounted","createProgressbar","beforeDestroy","removeProgressbar","methods","uploader","state","progress","Uploader","container","$refs","labels","loading","localize","completed","canceled","cancelTitle","megabyte","cancelCallback","event","$emit","destroyCallback","start","size","offsetHeight","offsetWidth","setProgressTitleVisibility","updateProgressbar","result","status","FileStatus","error","setProgress","setCancelDisable","setIcon","icon","setProgressTitle","wait","cloud","cancel","setByteSent","destroy","computed","uploadProgress","BitrixVue","getFilteredPhrases","watch","template","ActionType","freeze","none","upload","blur","gaussianBlur","LimitCode","image","component","isDesktop","width","height","data","actions","standard","custom","diskFolderId","components","created","defaultValue","window","BX","desktop","getBackgroundImage","id","background","limit","Rest","callMethod","then","response","folderId","backgrounds","forEach","element","isVideo","includes","isCustom","canRemove","isSupported","push","title","Loc","getMessage","limits","map","filter","UI","InfoHelper","isInited","init","frameUrlTemplate","infoHelperParams","hideLoader","inputNode","uploadInput","generatePreview","fileMaxSize","subscribe","eventData","getData","file","Notification","Center","notify","content","replace","name","autoHideDelay","isAllowedType","previewData","addTask","taskId","Date","now","chunkSize","fileData","fileName","generateUniqueName","previewBlob","filePreview","URL","createObjectURL","unshift","preview","startsWith","isLoading","find","links","download","select","fileId","isMaskAvailable","getClass","getApiVersion","Messenger","Lib","Utils","platform","getDesktopVersion","containerSize","concat","uploadTypes","isBitrixDesktop","hasLimit","elementId","active","articleCode","show","click","setCallBackground","remove","deleteTask","Ajax","runAction","el","save","close"],"mappings":"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"}