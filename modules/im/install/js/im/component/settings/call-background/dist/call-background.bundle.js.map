{"version":3,"file":"call-background.bundle.js","sources":["../src/item-background.js","../src/call-background.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * File element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2021 Bitrix\n */\n\nimport {BitrixVue} from 'ui.vue';\nimport {Uploader} from \"ui.progressbarjs.uploader\";\nimport {FileStatus} from \"im.const\";\n\nexport const CallBackgroundItem =\n{\n\tprops:\n\t{\n\t\tselected: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\tdefault: {}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.createProgressbar();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.removeProgressbar();\n\t},\n\tmethods:\n\t{\n\t\tcreateProgressbar()\n\t\t{\n\t\t\tif (this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.item.state)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.item.state.progress === 100)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.uploader = new Uploader({\n\t\t\t\tcontainer: this.$refs.container,\n\t\t\t\tlabels: {\n\t\t\t\t\tloading: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_LOADING'],\n\t\t\t\t\tcompleted: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_COMPLETED'],\n\t\t\t\t\tcanceled: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_CANCELED'],\n\t\t\t\t\tcancelTitle: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_CANCEL_TITLE'],\n\t\t\t\t\tmegabyte: this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_SIZE_MB'],\n\t\t\t\t},\n\t\t\t\tcancelCallback: this.item.state.progress < 0? null: (event) =>\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('cancel', {item: this.item, event});\n\t\t\t\t},\n\t\t\t\tdestroyCallback: () =>\n\t\t\t\t{\n\t\t\t\t\tif (this.uploader)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.uploader = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.uploader.start();\n\n\t\t\tif(\n\t\t\t\tthis.item.state.size && (this.item.state.size/1024/1024) <= 2\n\t\t\t\t|| this.$refs.container.offsetHeight <= 54 && this.$refs.container.offsetWidth < 240\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgressTitleVisibility(false)\n\t\t\t}\n\n\t\t\tthis.updateProgressbar();\n\n\t\t\treturn true;\n\t\t},\n\t\tupdateProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\tlet result = this.createProgressbar();\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.item.state.status === FileStatus.error)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(0);\n\t\t\t\tthis.uploader.setCancelDisable(false);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.error);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_ERROR']);\n\t\t\t}\n\t\t\telse if (this.item.state.status === FileStatus.wait)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(this.item.state.progress > 5? this.item.state.progress: 5);\n\t\t\t\tthis.uploader.setCancelDisable(true);\n\t\t\t\tthis.uploader.setIcon(Uploader.icon.cloud);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_SAVING']);\n\t\t\t}\n\t\t\telse if (this.item.state.progress === 100)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(100);\n\t\t\t}\n\t\t\telse if (this.item.state.progress === -1)\n\t\t\t{\n\t\t\t\tthis.uploader.setProgress(10);\n\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_WAITING']);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.item.state.progress === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setIcon(Uploader.icon.cancel);\n\t\t\t\t}\n\t\t\t\tlet progress = this.item.state.progress > 5? this.item.state.progress: 5;\n\n\t\t\t\tthis.uploader.setProgress(progress);\n\n\t\t\t\tif((this.item.state.size/1024/1024) <= 2)\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setProgressTitle(this.localize['BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_UPLOAD_LOADING']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.uploader.setByteSent(this.item.state.size/100*this.item.state.progress, this.item.state.size);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveProgressbar()\n\t\t{\n\t\t\tif (!this.uploader)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.uploader.destroy(false);\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tif (!this.item.state)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.item.state.status+' '+this.item.state.progress;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_SETTINGS_CALL_BG_', this);\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tthis.updateProgressbar();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :key=\"item.id\" @click=\"$emit('select')\" :class=\"['bx-im-settings-video-background-dialog-item', {'bx-im-settings-video-background-dialog-item-selected': selected, 'bx-im-settings-video-background-dialog-item-unsupported': !item.isSupported , 'bx-im-settings-video-background-dialog-item-loading': item.isLoading }]\" ref=\"container\">\n\t\t\t<div class=\"bx-im-settings-video-background-dialog-item-image\" :style=\"{backgroundImage: item.preview? 'url('+item.preview+')': ''}\"></div>\n\t\t\t<div v-if=\"item.isSupported && item.isVideo\" class=\"bx-im-settings-video-background-dialog-item-video\"></div>\n\t\t\t<div v-if=\"!item.isLoading\" class=\"bx-im-settings-video-background-dialog-item-title\">\n\t\t\t\t<span class=\"bx-im-settings-video-background-dialog-item-title-text\">{{item.title}}</span>\n\t\t\t\t<div v-if=\"item.canRemove\" class=\"bx-im-settings-video-background-dialog-item-remove\" :title=\"localize.BX_IM_COMPONENT_SETTINGS_CALL_BG_REMOVE\" @click=\"$emit('remove')\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {ajax as Ajax, Loc} from \"main.core\";\nimport {BitrixVue} from \"ui.vue\";\nimport {Uploader} from \"im.lib.uploader\";\nimport {Utils} from \"im.lib.utils\";\nimport {FileStatus} from \"im.const\";\nimport {rest as Rest} from \"rest.client\";\nimport \"ui.info-helper\";\nimport \"ui.notification\";\nimport \"ui.fonts.opensans\";\n\nimport \"./call-background.css\";\nimport {CallBackgroundItem} from \"./item-background\";\n\nconst ActionType = Object.freeze({\n\tnone: 'none',\n\tupload: 'upload',\n\tblur: 'blur',\n\tgaussianBlur: 'gaussianBlur',\n});\n\nconst LimitCode = Object.freeze({\n\tblur: 'call_blur_background',\n\timage: 'call_background',\n});\n\nBitrixVue.component('bx-im-component-settings-call-background',\n{\n\tprops:\n\t{\n\t\tisDesktop: {type: Boolean, default: false},\n\t\twidth: {default: 0},\n\t\theight: {default: 450},\n\t},\n\tdata: function()\n\t{\n\t\treturn {\n\t\t\tactions: [],\n\t\t\tstandard: [],\n\t\t\tcustom: [],\n\t\t\tselected: '',\n\t\t\tActionType: ActionType,\n\t\t\tloading: true,\n\t\t\tdiskFolderId: 0\n\t\t};\n\t},\n\tcomponents:\n\t{\n\t\t'bx-im-component-settings-call-background-item': CallBackgroundItem\n\t},\n\tcreated()\n\t{\n\t\tthis.defaultValue = this.isDesktop? window.BX.desktop.getBackgroundImage(): {id: ActionType.none, background: ''};\n\t\tthis.selected = this.defaultValue.id;\n\t\tthis.limit = {};\n\n\t\tRest.callMethod(\"im.v2.call.background.get\").then((response) => {\n\t\t\tthis.loading = false;\n\n\t\t\tthis.diskFolderId = response.data().upload.folderId;\n\n\t\t\tresponse.data().backgrounds.default.forEach(element => {\n\t\t\t\telement.isVideo = element.id.includes(':video');\n\t\t\t\telement.isCustom = false;\n\t\t\t\telement.canRemove = false;\n\t\t\t\telement.isSupported = true;\n\t\t\t\tthis.standard.push(element);\n\t\t\t});\n\n\t\t\tresponse.data().backgrounds.custom.forEach(element => {\n\t\t\t\telement.isCustom = true;\n\t\t\t\telement.canRemove = true;\n\t\t\t\tif (element.isSupported)\n\t\t\t\t{\n\t\t\t\t\telement.title = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CUSTOM');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\telement.title = Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_UNSUPPORTED');\n\t\t\t\t}\n\n\t\t\t\tthis.custom.push(element);\n\t\t\t});\n\n\t\t\tresponse.data().limits.forEach(element => {\n\t\t\t\tthis.limit[element.id] = element;\n\t\t\t});\n\n\t\t\tif (this.diskFolderId)\n\t\t\t{\n\t\t\t\tthis.actions = this.actions.map(element => {\n\t\t\t\t\telement.isSupported = true;\n\t\t\t\t\treturn element;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.actions = this.actions.filter(element => {\n\t\t\t\t\treturn element.id !== ActionType.upload\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!window.BX.UI.InfoHelper.isInited())\n\t\t\t{\n\t\t\t\twindow.BX.UI.InfoHelper.init({\n\t\t\t\t\tframeUrlTemplate: response.data().infoHelperParams.frameUrlTemplate\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.hideLoader();\n\t\t\t}\n\t\t}).catch(() => {\n\t\t\tthis.loading = false;\n\t\t});\n\n\t\tthis.actions.push({\n\t\t\tid: ActionType.none,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_NONE'),\n\t\t\tbackground: ActionType.none,\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.upload,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_UPLOAD'),\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.gaussianBlur,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_BLUR'),\n\t\t\tbackground: ActionType.gaussianBlur,\n\t\t});\n\t\tthis.actions.push({\n\t\t\tid: ActionType.blur,\n\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_ACTION_BLUR_MAX'),\n\t\t\tbackground: ActionType.blur,\n\t\t});\n\t},\n\tmounted()\n\t{\n\t\tthis.uploader = new Uploader({\n\t\t\tinputNode: this.$refs.uploadInput,\n\t\t\tgeneratePreview: true,\n\t\t\tfileMaxSize: 100 * 1024 * 1024,\n\t\t});\n\n\t\tthis.uploader.subscribe('onFileMaxSizeExceeded', (event) => {\n            const eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_FILE_SIZE_EXCEEDED').replace('#LIMIT#', 100).replace('#FILE_NAME#', file.name),\n\t\t\t\tautoHideDelay: 5000\n\t\t\t});\n        });\n\n\t\tthis.uploader.subscribe('onSelectFile', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\n\t\t\tif (!this.isAllowedType(file.type) || !eventData.previewData)\n\t\t\t{\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_UNSUPPORTED_FILE').replace('#FILE_NAME#', file.name),\n\t\t\t\t\tautoHideDelay: 5000\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.uploader.addTask({\n\t\t\t\ttaskId: `custom:${Date.now()}`,\n\t\t\t\tchunkSize: 1024 * 1024,\n\t\t\t\tfileData: file,\n\t\t\t\tfileName: file.name,\n\t\t\t\tdiskFolderId: this.diskFolderId,\n\t\t\t\tgenerateUniqueName: true,\n\t\t\t\tpreviewBlob: eventData.previewData,\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onStartUpload', event => {\n\t\t\tconst eventData = event.getData();\n\n\t\t\tconst filePreview = URL.createObjectURL(eventData.previewData);\n\n\t\t\tthis.custom.unshift({\n\t\t\t\tid: eventData.id,\n\t\t\t\tbackground: filePreview,\n\t\t\t\tpreview: filePreview,\n\t\t\t\ttitle: Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CUSTOM'),\n\t\t\t\tisVideo: eventData.file.type.startsWith('video'),\n\t\t\t\tisCustom: true,\n\t\t\t\tcanRemove: false,\n\t\t\t\tisSupported: true,\n\t\t\t\tisLoading: true,\n\t\t\t\tstate:\n\t\t\t\t{\n\t\t\t\t\tprogress: 0,\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tsize: eventData.file.size,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onProgress', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.progress = eventData.progress;\n\t\t});\n\n\t\tthis.uploader.subscribe('onComplete', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.id = eventData.result.data.file.id;\n\n\t\t\tif (element.isVideo)\n\t\t\t{\n\t\t\t\telement.background = eventData.result.data.file.links.download;\n\t\t\t}\n\n\t\t\telement.isLoading = false;\n\t\t\telement.canRemove = true;\n\n\t\t\tthis.select(element);\n\n\t\t\tRest.callMethod('im.v2.call.background.commit', {\n\t\t\t\tfileId: element.id\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onUploadFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.status = FileStatus.error;\n\t\t\telement.state.progress = 0;\n\t\t});\n\n\t\tthis.uploader.subscribe('onCreateFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst element = this.custom.find(element => element.id === eventData.id);\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.state.status = FileStatus.error;\n\t\t\telement.state.progress = 0;\n\t\t});\n\t},\n\tcomputed:\n\t{\n\t\tisMaskAvailable()\n\t\t{\n\t\t\tif (window.BX.getClass('BX.desktop'))\n\t\t\t{\n\t\t\t\treturn window.BX.desktop.getApiVersion() >= 72;\n\t\t\t}\n\t\t\telse if (window.BX.getClass(\"BX.Messenger.Lib.Utils.platform\"))\n\t\t\t{\n\t\t\t\treturn window.BX.Messenger.Lib.Utils.platform.getDesktopVersion() >= 72;\n\t\t\t}\n\t\t},\n\n\t\tcontainerSize()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\tresult.height = 'calc(100vh - 79px)'; // 79 button panel\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.height = this.height+'px';\n\t\t\t}\n\n\t\t\tif (this.width > 0)\n\t\t\t{\n\t\t\t\tresult.width = this.width+'px';\n\t\t\t}\n\n\t\t\treturn result\n\t\t},\n\t\tbackgrounds()\n\t\t{\n\t\t\treturn [].concat(this.custom).concat(this.standard);\n\t\t},\n\t\tuploadTypes()\n\t\t{\n\t\t\tif (Utils.platform.isBitrixDesktop())\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn '.png, .jpg, .jpeg, .avi, .mp4';\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\thasLimit(elementId)\n\t\t{\n\t\t\tif (elementId === ActionType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ([ActionType.blur, ActionType.gaussianBlur].includes(elementId))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tthis.limit[LimitCode.blur]\n\t\t\t\t\t&& this.limit[LimitCode.blur].active\n\t\t\t\t\t&& this.limit[LimitCode.blur].articleCode\n\t\t\t\t\t&& window.BX.UI.InfoHelper\n\t\t\t\t)\n\t\t\t\t{\n\n\t\t\t\t\twindow.BX.UI.InfoHelper.show(this.limit[LimitCode.blur].articleCode);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.limit[LimitCode.image]\n\t\t\t\t&& this.limit[LimitCode.image].active\n\t\t\t\t&& this.limit[LimitCode.image].articleCode\n\t\t\t\t&& window.BX.UI.InfoHelper\n\t\t\t)\n\t\t\t{\n\t\t\t\twindow.BX.UI.InfoHelper.show(this.limit[LimitCode.image].articleCode)\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tselect(element)\n\t\t{\n\t\t\tif (!this.hasLimit(element.id))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!element.isSupported || element.isLoading)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (element.id === ActionType.upload)\n\t\t\t{\n\t\t\t\tthis.$refs.uploadInput.click();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.selected = element.id;\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.setCallBackground(element.id, element.background);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tremove(element)\n\t\t{\n\t\t\tif (element.id === this.selected)\n\t\t\t{\n\t\t\t\tthis.selected = ActionType.none;\n\n\t\t\t\tif (this.isDesktop)\n\t\t\t\t{\n\t\t\t\t\twindow.BX.desktop.setCallBackground(ActionType.none, ActionType.none);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (element.isLoading)\n\t\t\t{\n\t\t\t\tthis.uploader.deleteTask(element.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tAjax.runAction('disk.api.file.delete', {data: {\n\t\t\t\t\tfileId: element.id\n\t\t\t\t}});\n\t\t\t}\n\n\t\t\tthis.custom = this.custom.filter(el => el.id !== element.id);\n\n\t\t\treturn true;\n\t\t},\n\n\t\tsave()\n\t\t{\n\t\t\twindow.close();\n\t\t},\n\n\t\tcancel()\n\t\t{\n\t\t\tif (this.defaultValue.id === this.selected)\n\t\t\t{\n\t\t\t\twindow.close();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.isDesktop)\n\t\t\t{\n\t\t\t\twindow.BX.desktop.setCallBackground(this.defaultValue.id, this.defaultValue.background).then(() => {\n\t\t\t\t\twindow.close();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.close();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tisAllowedType(type)\n\t\t{\n\t\t\treturn [\n\t\t\t\t'image/png',\n\t\t\t\t'image/jpeg',\n\t\t\t\t'video/avi',\n\t\t\t\t'video/mp4',\n\t\t\t\t'video/quicktime',\n\t\t\t].includes(type);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-settings-video-background-dialog\">\n\t\t\t<div class=\"bx-im-settings-video-background-dialog-inner\" :style=\"containerSize\">\n\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-container\">\n\t\t\t\t\t<div class=\"bx-im-settings-video-background-upload-input\"><input type=\"file\" :accept=\"uploadTypes\" ref=\"uploadInput\"/></div>\n\t\t\t\t\t<template v-if=\"loading\">\n\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-loader\">\n\t\t\t\t\t\t\t<svg class=\"bx-desktop-loader-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t\t\t\t\t<circle class=\"bx-desktop-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-content\">\n\t\t\t\t\t\t<template v-for=\"(element in actions\">\n\t\t\t\t\t\t\t<div :key=\"element.id\" @click=\"select(element)\" :class=\"['bx-im-settings-video-background-dialog-item', 'bx-im-settings-video-background-dialog-action', 'bx-im-settings-video-background-dialog-action-'+element.id, {'bx-im-settings-video-background-dialog-item-selected': selected === element.id }]\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-settings-video-background-dialog-action-title\">{{element.title}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t<template v-for=\"(item in backgrounds\">\n\t\t\t\t\t\t\t<bx-im-component-settings-call-background-item \n\t\t\t\t\t\t\t\t:key=\"item.id\" \n\t\t\t\t\t\t\t\t:item=\"item\" \n\t\t\t\t\t\t\t\t:selected=\"selected === item.id\" \n\t\t\t\t\t\t\t\t@select=\"select(item)\" \n\t\t\t\t\t\t\t\t@cancel=\"remove(item)\"\n\t\t\t\t\t\t\t\t@remove=\"remove(item)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-btn-container ui-btn-container-center\">\n\t\t\t\t<button :class=\"['ui-btn', 'ui-btn-success', {'ui-btn-wait ui-btn-disabled': loading}]\" @click=\"save\">{{$Bitrix.Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_SAVE')}}</button>\n\t\t\t\t<button class=\"ui-btn ui-btn-link\" @click=\"cancel\">{{$Bitrix.Loc.getMessage('BX_IM_COMPONENT_SETTINGS_CALL_BG_CANCEL')}}</button>\n\t\t\t</div>\n\t\t</div>\n\t`\n});"],"names":["CallBackgroundItem","props","selected","type","Boolean","item","Object","mounted","createProgressbar","beforeDestroy","removeProgressbar","methods","uploader","state","progress","Uploader","container","$refs","labels","loading","localize","completed","canceled","cancelTitle","megabyte","cancelCallback","event","$emit","destroyCallback","start","size","offsetHeight","offsetWidth","setProgressTitleVisibility","updateProgressbar","result","status","FileStatus","error","setProgress","setCancelDisable","setIcon","icon","setProgressTitle","wait","cloud","cancel","setByteSent","destroy","computed","uploadProgress","BitrixVue","getFilteredPhrases","watch","template","ActionType","freeze","none","upload","blur","gaussianBlur","LimitCode","image","component","isDesktop","width","height","data","actions","standard","custom","diskFolderId","components","created","defaultValue","window","BX","desktop","getBackgroundImage","id","background","limit","Rest","callMethod","then","response","folderId","backgrounds","forEach","element","isVideo","includes","isCustom","canRemove","isSupported","push","title","Loc","getMessage","limits","map","filter","UI","InfoHelper","isInited","init","frameUrlTemplate","infoHelperParams","hideLoader","inputNode","uploadInput","generatePreview","fileMaxSize","subscribe","eventData","getData","file","Notification","Center","notify","content","replace","name","autoHideDelay","isAllowedType","previewData","addTask","taskId","Date","now","chunkSize","fileData","fileName","generateUniqueName","previewBlob","filePreview","URL","createObjectURL","unshift","preview","startsWith","isLoading","find","links","download","select","fileId","isMaskAvailable","getClass","getApiVersion","Messenger","Lib","Utils","platform","getDesktopVersion","containerSize","concat","uploadTypes","isBitrixDesktop","hasLimit","elementId","active","articleCode","show","click","setCallBackground","remove","deleteTask","Ajax","runAction","el","save","close"],"mappings":"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"}