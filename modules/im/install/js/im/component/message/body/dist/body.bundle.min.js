(function(t,e,s){"use strict";var n=window.BX;var a=Object.freeze({self:"self",opponent:"opponent",system:"system"});var i=Object.freeze({default:"default",image:"image",video:"video",richLink:"richLink"});e.Vue.component("bx-messenger-message-body",{props:{userId:{default:0},dialogId:{default:0},chatId:{default:0},messageType:{default:a.self},message:{type:Object,default:s.MessagesModel.create().getElementStore},user:{type:Object,default:s.UsersModel.create().getElementStore},files:{type:Object,default:{}},enableEmotions:{default:true},showName:{default:true},showAvatar:{default:true},referenceContentBodyClassName:{default:""}},created:function t(){this.dateFormatFunction=null;this.cacheFormatDate={}},methods:{clickByUserName:function t(e,s){this.$emit("clickByUserName",{user:e,event:s})},formatDate:function t(e){var s=e.toJSON().slice(0,10);if(this.cacheFormatDate[s]){return this.cacheFormatDate[s]}var a=n.Messenger.Utils.getDateFormatType(n.Messenger.Const.DateFormat.message,this.$root.$bitrixMessages);this.cacheFormatDate[s]=this._getDateFormat().format(a,e);return this.cacheFormatDate[s]},_getDateFormat:function t(){var e=this;if(this.dateFormatFunction){return this.dateFormatFunction}this.dateFormatFunction=Object.create(n.Main.Date);if(this.$root.$bitrixMessages){this.dateFormatFunction._getMessage=function(t){return e.$root.$bitrixMessages[t]}}return this.dateFormatFunction}},computed:{MessageType:function t(){return a},ContentType:function t(){return i},contentType:function t(){if(this.filesData.length>0){var e=false;var s=false;var n=true;var a=false;var r=undefined;try{for(var m=this.filesData[Symbol.iterator](),o;!(n=(o=m.next()).done);n=true){var l=o.value;if(l.type=="image"){if(s){s=false;break}e=true}else{e=false;s=false;break}}}catch(t){a=true;r=t}finally{try{if(!n&&m.return!=null){m.return()}}finally{if(a){throw r}}}if(e){return i.image}else if(s){return i.video}}return i.default},localize:function t(){return e.Vue.getFilteredPhrases("IM_MESSENGER_MESSAGE_",this.$root.$bitrixMessages)},formattedDate:function t(){return this.formatDate(this.message.date)},messageText:function t(){if(this.isDeleted){return this.localize.IM_MESSENGER_MESSAGE_DELETED}return this.message.textConverted},isEdited:function t(){return this.message.params.IS_EDITED=="Y"},isDeleted:function t(){return this.message.params.IS_DELETED=="Y"},filesData:function t(){var e=this;var s=[];if(!this.message.params.FILE_ID||this.message.params.FILE_ID.length<=0){return s}this.message.params.FILE_ID.forEach(function(t){if(e.files[t]){s.push(e.files[t])}});return s}},template:'\n\t\t<div class="bx-im-message-content-wrap">\n\t\t\t<template v-if="contentType == ContentType.default">\n\t\t\t\t<div class="bx-im-message-content">\n\t\t\t\t\t<span class="bx-im-message-content-box">\n\t\t\t\t\t\t<template v-if="showName && messageType == MessageType.opponent">\n\t\t\t\t\t\t\t<div class="bx-im-message-content-name" :style="{color: user.color}" @click="clickByUserName(user, $event)">{{!showAvatar? user.name: (user.firstName? user.firstName: user.name)}}</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body\', referenceContentBodyClassName]">\n\t\t\t\t\t\t\t<template v-for="file in filesData">\n\t\t\t\t\t\t\t\t<bx-messenger-element-file :file="file"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body-wrap\', {\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-with-text\': messageText.length > 0,\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-without-text\': messageText.length <= 0,\n\t\t\t\t\t\t\t}]">\n\t\t\t\t\t\t\t\t<template v-if="messageText">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-text" v-html="messageText"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class="bx-im-message-content-params">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-date">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- keyboard --\x3e\n\t\t\t</template>\n\t\t\t<template v-else-if="contentType == ContentType.richLink">\n\t\t\t\t\x3c!-- richLink type markup --\x3e\n\t\t\t</template>\n\t\t\t<template v-else-if="contentType == ContentType.image || contentType == ContentType.video">\n\t\t\t\t<div class="bx-im-message-content bx-im-message-content-fit">\n\t\t\t\t\t<span class="bx-im-message-content-box">\n\t\t\t\t\t\t<template v-if="showName && messageType == MessageType.opponent">\n\t\t\t\t\t\t\t<div class="bx-im-message-content-name" :style="{color: user.color}" @click="clickByUserName(user, $event)">{{!showAvatar? user.name: (user.firstName? user.firstName: user.name)}}</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body\', referenceContentBodyClassName]">\n\t\t\t\t\t\t\t<template v-if="contentType == ContentType.image">\n\t\t\t\t\t\t\t\t<template v-for="file in filesData">\n\t\t\t\t\t\t\t\t\t<bx-messenger-element-file-image :file="file"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else-if="contentType == ContentType.video">\n\t\t\t\t\t\t\t\t<template v-for="file in filesData">\n\t\t\t\t\t\t\t\t\t<bx-messenger-element-file-video :file="file"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body-wrap\', {\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-with-text\': messageText.length > 0,\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-without-text\': messageText.length <= 0,\n\t\t\t\t\t\t\t}]">\n\t\t\t\t\t\t\t\t<template v-if="messageText">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-text" v-html="messageText"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class="bx-im-message-content-params">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-date">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- keyboard --\x3e\n\t\t\t</template>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX.Messenger.Model);
//# sourceMappingURL=body.bundle.map.js