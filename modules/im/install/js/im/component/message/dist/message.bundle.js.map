{"version":3,"file":"message.bundle.js","sources":["../src/message.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Message Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './message.css';\nimport 'im.component.message.body';\n\nimport {DialoguesModel, MessagesModel} from 'im.model';\nimport {Vue} from \"ui.vue\";\nimport {MessageType} from \"im.const\";\nimport {Utils} from \"im.utils\";\nimport {Animation} from \"im.tools.animation\";\n\nVue.component('bx-messenger-message',\n{\n\t/**\n\t * @emits 'clickByUserName' {user: object, event: MouseEvent}\n\t * @emits 'clickByUploadCancel' {file: object, event: MouseEvent}\n\t * @emits 'clickByKeyboardButton' {message: object, action: string, params: Object}\n\t * @emits 'clickByChatTeaser' {message: object, event: MouseEvent}\n\t * @emits 'clickByMessageMenu' {message: object, event: MouseEvent}\n\t * @emits 'clickByMessageRetry' {message: object, event: MouseEvent}\n\t * @emits 'setMessageReaction' {message: object, reaction: object}\n\t * @emits 'openMessageReactionList' {message: object, values: object}\n\t * @emits 'dragMessage' {result: boolean, event: MouseEvent}\n\t * @emits 'quoteMessage' {message: object}\n\t */\n\tprops:\n\t{\n\t\tuserId: { default: 0 },\n\t\tdialogId: { default: 0 },\n\t\tchatId: { default: 0 },\n\t\tenableReactions: { default: true },\n\t\tenableDateActions: { default: true },\n\t\tenableCreateContent: { default: true },\n\t\tenableGestureQuote: { default: true },\n\t\tenableGestureQuoteFromRight: { default: true },\n\t\tenableGestureMenu: { default: false },\n\t\tshowAvatar: { default: true },\n\t\tshowMenu: { default: true },\n\t\tshowName: { default: true },\n\t\tshowLargeFont: { default: true },\n\t\tcapturedMoveEvent: { default: null },\n\t\treferenceContentClassName: { default: ''},\n\t\treferenceContentBodyClassName: { default: ''},\n\t\treferenceContentNameClassName: { default: ''},\n\t\tdialog: {\n\t\t\ttype: Object,\n\t\t\tdefault: DialoguesModel.create().getElementState\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\tdefault: MessagesModel.create().getElementState\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcomponentBodyId: 'bx-messenger-message-body',\n\t\t\tdrag: false,\n\t\t\tdragWidth: 0,\n\t\t\tdragPosition: 0,\n\t\t\tdragIconShowLeft: false,\n\t\t\tdragIconShowRight: false,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.dragStartPositionX = 0;\n\t\tthis.dragStartPositionY = 0;\n\t\tthis.dragMovePositionX = 0;\n\t\tthis.dragMovePositionY = 0;\n\t},\n\tbeforeDestroy()\n\t{\n\t\tclearTimeout(this.dragStartTimeout1);\n\t\tclearTimeout(this.dragStartTimeout2);\n\n\t\tif (this.dragBackAnimation)\n\t\t{\n\t\t\tAnimation.cancel(this.dragBackAnimation);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tclickByAvatar(event)\n\t\t{\n\t\t\tthis.$emit('clickByUserName', event)\n\t\t},\n\t\tclickByUserName(event)\n\t\t{\n\t\t\tif (this.showAvatar && Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$emit('clickByUserName', event)\n\t\t},\n\t\tclickByUploadCancel(event)\n\t\t{\n\t\t\tthis.$emit('clickByUploadCancel', event)\n\t\t},\n\t\tclickByKeyboardButton(event)\n\t\t{\n\t\t\tthis.$emit('clickByKeyboardButton', event)\n\t\t},\n\t\tclickByChatTeaser(event)\n\t\t{\n\t\t\tthis.$emit('clickByChatTeaser', event)\n\t\t},\n\t\tclickByMessageMenu(event)\n\t\t{\n\t\t\tthis.$emit('clickByMessageMenu', event)\n\t\t},\n\t\tclickByMessageRetry(event)\n\t\t{\n\t\t\tthis.$emit('clickByMessageRetry', event)\n\t\t},\n\t\tsetMessageReaction(event)\n\t\t{\n\t\t\tthis.$emit('setMessageReaction', event)\n\t\t},\n\t\topenMessageReactionList(event)\n\t\t{\n\t\t\tthis.$emit('openMessageReactionList', event)\n\t\t},\n\t\tgestureRouter(eventName, event)\n\t\t{\n\t\t\tthis.gestureQuote(eventName, event);\n\t\t\tthis.gestureMenu(eventName, event);\n\t\t},\n\t\tgestureMenu(eventName, event)\n\t\t{\n\t\t\tif (!this.enableGestureMenu)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (eventName === 'touchstart')\n\t\t\t{\n\t\t\t\tthis.gestureMenuStarted = true;\n\t\t\t\tthis.gestureMenuPreventTouchEnd = false;\n\t\t\t\tif (event.target.tagName === \"A\")\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.gestureMenuStartPosition = {\n\t\t\t\t\tx: event.changedTouches[0].clientX,\n\t\t\t\t\ty: event.changedTouches[0].clientY\n\t\t\t\t};\n\n\t\t\t\tthis.gestureMenuTimeout = setTimeout(() => {\n\t\t\t\t\tthis.gestureMenuPreventTouchEnd = true;\n\t\t\t\t\tthis.$emit('clickByMessageMenu', {message: this.message, event});\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t\telse if (eventName === 'touchmove')\n\t\t\t{\n\t\t\t\tif (!this.gestureMenuStarted)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tMath.abs(this.gestureMenuStartPosition.x - event.changedTouches[0].clientX) >= 10\n\t\t\t\t\t|| Math.abs(this.gestureMenuStartPosition.y - event.changedTouches[0].clientY) >= 10\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.gestureMenuStarted = false;\n\t\t\t\t\tclearTimeout(this.gestureMenuTimeout);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'touchend')\n\t\t\t{\n\t\t\t\tif (!this.gestureMenuStarted)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.gestureMenuStarted = false;\n\t\t\t\tclearTimeout(this.gestureMenuTimeout);\n\t\t\t\tif (this.gestureMenuPreventTouchEnd)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgestureQuote(eventName, event)\n\t\t{\n\t\t\tlet target = Utils.browser.findParent(event.target, 'bx-im-message') || event.target;\n\t\t\tif (!this.enableGestureQuote || Utils.platform.isAndroid())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst fromRight = this.enableGestureQuoteFromRight;\n\n\t\t\tconst layerX = target.getBoundingClientRect().left + event.layerX;\n\t\t\tconst layerY = target.getBoundingClientRect().top + event.layerY;\n\n\t\t\tif (eventName === 'touchstart')\n\t\t\t{\n\t\t\t\tthis.dragCheck = true;\n\n\t\t\t\tthis.dragStartInitialX = target.getBoundingClientRect().left;\n\t\t\t\tthis.dragStartInitialY = target.getBoundingClientRect().top;\n\t\t\t\tthis.dragStartPositionX = layerX;\n\t\t\t\tthis.dragStartPositionY = layerY;\n\t\t\t\tthis.dragMovePositionX = null;\n\t\t\t\tthis.dragMovePositionY = null;\n\n\t\t\t\tclearTimeout(this.dragStartTimeout1);\n\t\t\t\tclearTimeout(this.dragStartTimeout2);\n\t\t\t\tthis.dragStartTimeout1 = setTimeout(() => {\n\t\t\t\t\tif (this.dragMovePositionX !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Math.abs(this.dragStartPositionY - this.dragMovePositionY) >= 10)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.dragCheck = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, 29);\n\n\t\t\t\tthis.dragStartTimeout2 = setTimeout(() => {\n\t\t\t\t\tthis.dragCheck = false;\n\n\t\t\t\t\tif (Math.abs(this.dragStartPositionY - this.dragMovePositionY) >= 10)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.dragMovePositionX === null)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if (fromRight && this.dragStartPositionX - this.dragMovePositionX < 9)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if (!fromRight && this.dragStartPositionX - this.dragMovePositionX > 9)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tAnimation.cancel(this.dragBackAnimation);\n\n\t\t\t\t\tthis.drag = true;\n\n\t\t\t\t\tthis.$emit('dragMessage', {result: this.drag, event});\n\t\t\t\t\tthis.dragWidth = this.$refs.body.offsetWidth;\n\n\t\t\t\t}, 80);\n\t\t\t}\n\t\t\telse if (eventName === 'touchmove')\n\t\t\t{\n\t\t\t\tif (this.drag || !this.dragCheck)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.dragMovePositionX = layerX;\n\t\t\t\tthis.dragMovePositionY = layerY;\n\t\t\t}\n\t\t\telse if (eventName === 'touchend')\n\t\t\t{\n\t\t\t\tclearTimeout(this.dragStartTimeout1);\n\t\t\t\tclearTimeout(this.dragStartTimeout2);\n\n\t\t\t\tthis.dragCheck = false;\n\n\t\t\t\tif (!this.drag)\n\t\t\t\t{\n\t\t\t\t\tthis.dragIconShowLeft = false;\n\t\t\t\t\tthis.dragIconShowRight = false;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tAnimation.cancel(this.dragBackAnimation);\n\n\t\t\t\tthis.drag = false;\n\t\t\t\tthis.$emit('dragMessage', {result: this.drag, event});\n\n\t\t\t\tif (\n\t\t\t\t\tthis.enableGestureQuoteFromRight && this.dragIconShowRight && this.dragPosition !== 0\n\t\t\t\t\t|| !this.enableGestureQuoteFromRight && this.dragIconShowLeft && this.dragPosition !== this.dragStartInitialX\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(() => app.exec(\"callVibration\"), 200);\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit('quoteMessage', {message: this.message});\n\t\t\t\t}\n\n\t\t\t\tthis.dragIconShowLeft = false;\n\t\t\t\tthis.dragIconShowRight = false;\n\n\t\t\t\tthis.dragBackAnimation = Animation.start({\n\t\t\t\t\tstart: this.dragPosition,\n\t\t\t\t\tend: this.dragStartInitialX,\n\t\t\t\t\tincrement: 20,\n\t\t\t\t\tduration:  300,\n\n\t\t\t\t\telement: this,\n\t\t\t\t\telementProperty: 'dragPosition',\n\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.dragLayerPosition = undefined;\n\t\t\t\t\t\tthis.dragWidth = 0;\n\t\t\t\t\t\tthis.dragPosition = 0;\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tcapturedMoveEvent(event)\n\t\t{\n\t\t\tif (!this.drag || !event)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet target = Utils.browser.findParent(event.target, 'bx-im-message') || event.target;\n\n\t\t\tconst layerX = target.getBoundingClientRect().left + event.layerX;\n\n\t\t\tif (typeof this.dragLayerPosition === 'undefined')\n\t\t\t{\n\t\t\t\tthis.dragLayerPosition = layerX;\n\t\t\t}\n\n\t\t\tconst movementX = this.dragLayerPosition - layerX;\n\n\t\t\tthis.dragLayerPosition = layerX;\n\n\t\t\tthis.dragPosition = this.dragPosition - movementX;\n\n\t\t\tif (this.enableGestureQuoteFromRight)\n\t\t\t{\n\t\t\t\tconst dragPositionMax = (this.showAvatar? 30: 0) + 45;\n\t\t\t\tconst dragPositionIcon = (this.showAvatar? 30: 30);\n\n\t\t\t\tif (this.dragPosition < -dragPositionMax)\n\t\t\t\t{\n\t\t\t\t\tthis.dragPosition = -dragPositionMax;\n\t\t\t\t}\n\t\t\t\telse if (this.dragPosition < -dragPositionIcon)\n\t\t\t\t{\n\t\t\t\t\tif (!this.dragIconShowRight)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dragIconShowRight = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (this.dragPosition >= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.dragPosition = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst dragPositionMax = 60;\n\t\t\t\tconst dragPositionIcon = 40;\n\n\t\t\t\tif (this.dragPosition <= this.dragStartInitialX)\n\t\t\t\t{\n\t\t\t\t\tthis.dragPosition = this.dragStartInitialX;\n\t\t\t\t}\n\t\t\t\telse if (this.dragPosition >= dragPositionMax)\n\t\t\t\t{\n\t\t\t\t\tthis.dragPosition = dragPositionMax;\n\t\t\t\t}\n\t\t\t\telse if (this.dragPosition >= dragPositionIcon)\n\t\t\t\t{\n\t\t\t\t\tif (!this.dragIconShowLeft)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dragIconShowLeft = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tMessageType: () => MessageType,\n\n\t\ttype()\n\t\t{\n\t\t\tif (this.message.system || this.message.authorId == 0)\n\t\t\t{\n\t\t\t\treturn MessageType.system;\n\t\t\t}\n\t\t\telse if (this.message.authorId === -1 || this.message.authorId == this.userId)\n\t\t\t{\n\t\t\t\treturn MessageType.self;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn MessageType.opponent;\n\t\t\t}\n\t\t},\n\n\t\tlocalize()\n\t\t{\n\t\t\tlet localize = Vue.getFilteredPhrases('IM_MESSENGER_MESSAGE_', this.$root.$bitrixMessages);\n\n\t\t\treturn Object.freeze(\n\t\t\t\tObject.assign({}, localize, {\n\t\t\t\t\t'IM_MESSENGER_MESSAGE_MENU_TITLE': localize.IM_MESSENGER_MESSAGE_MENU_TITLE.replace('#SHORTCUT#', Utils.platform.isMac()? 'CMD':'CTRL')\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\n\t\tuserData()\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.message.authorId, true);\n\t\t},\n\n\t\tuserAvatar()\n\t\t{\n\t\t\tif (this.message.params.AVATAR)\n\t\t\t{\n\t\t\t\treturn `url('${this.message.params.AVATAR}')`;\n\t\t\t}\n\t\t\tif (this.userData.avatar)\n\t\t\t{\n\t\t\t\treturn `url('${this.userData.avatar}')`;\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\n\t\tfilesData()\n\t\t{\n\t\t\tlet files = this.$store.getters['files/getList'](this.chatId);\n\t\t\treturn files? files: {};\n\t\t},\n\n\t\tisEdited()\n\t\t{\n\t\t\treturn this.message.params.IS_EDITED === 'Y';\n\t\t},\n\n\t\tisDeleted()\n\t\t{\n\t\t\treturn this.message.params.IS_DELETED === 'Y';\n\t\t},\n\n\t\tisLargeFont()\n\t\t{\n\t\t\treturn this.showLargeFont && this.message.params.LARGE_FONT === 'Y';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['bx-im-message', {\n\t\t\t\t'bx-im-message-without-menu': !showMenu,\n\t\t\t\t'bx-im-message-without-avatar': !showAvatar,\n\t\t\t\t'bx-im-message-type-system': type === MessageType.system,\n\t\t\t\t'bx-im-message-type-self': type === MessageType.self,\n\t\t\t\t'bx-im-message-type-other': type !== MessageType.self,\n\t\t\t\t'bx-im-message-type-opponent': type === MessageType.opponent,\n\t\t\t\t'bx-im-message-status-error': message.error,\n\t\t\t\t'bx-im-message-status-unread': message.unread,\n\t\t\t\t'bx-im-message-status-blink': message.blink,\n\t\t\t\t'bx-im-message-status-edited': isEdited,\n\t\t\t\t'bx-im-message-status-deleted': isDeleted,\n\t\t\t\t'bx-im-message-large-font': isLargeFont,\n\t\t\t}]\" \n\t\t\t@touchstart=\"gestureRouter('touchstart', $event)\"\n\t\t\t@touchmove=\"gestureRouter('touchmove', $event)\"\n\t\t\t@touchend=\"gestureRouter('touchend', $event)\"\n\t\t\tref=\"body\"\n\t\t\t:style=\"{\n\t\t\t\twidth: dragWidth > 0? dragWidth+'px': '', \n\t\t\t\tmarginLeft: (enableGestureQuoteFromRight && dragPosition < 0) || (!enableGestureQuoteFromRight && dragPosition > 0)? dragPosition+'px': '',\n\t\t\t}\"\n\t\t>\n\t\t\t<template v-if=\"type === MessageType.self\">\n\t\t\t\t<template v-if=\"dragIconShowRight\">\n\t\t\t\t\t<div class=\"bx-im-message-reply bx-im-message-reply-right\">\n\t\t\t\t\t\t<div class=\"bx-im-message-reply-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t\t<div class=\"bx-im-message-box\">\n\t\t\t\t\t<component :is=\"componentBodyId\"\n\t\t\t\t\t\t:userId=\"userId\" \n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t\t:messageType=\"type\"\n\t\t\t\t\t\t:dialog=\"dialog\"\n\t\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t\t:user=\"userData\"\n\t\t\t\t\t\t:files=\"filesData\"\n\t\t\t\t\t\t:showAvatar=\"showAvatar\"\n\t\t\t\t\t\t:showName=\"showName\"\n\t\t\t\t\t\t:enableReactions=\"enableReactions\"\n\t\t\t\t\t\t:referenceContentBodyClassName=\"referenceContentBodyClassName\"\n\t\t\t\t\t\t:referenceContentNameClassName=\"referenceContentNameClassName\"\n\t\t\t\t\t\t@clickByUserName=\"clickByUserName\"\n\t\t\t\t\t\t@clickByUploadCancel=\"clickByUploadCancel\"\n\t\t\t\t\t\t@clickByKeyboardButton=\"clickByKeyboardButton\"\n\t\t\t\t\t\t@clickByChatTeaser=\"clickByChatTeaser\"\n\t\t\t\t\t\t@setReaction=\"setMessageReaction\"\n\t\t\t\t\t\t@openReactionList=\"openMessageReactionList\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-message-box-status\">\n\t\t\t\t\t<template v-if=\"message.sending\">\n\t\t\t\t\t\t<div class=\"bx-im-message-sending\"></div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<transition name=\"bx-im-message-status-retry\">\n\t\t\t\t\t\t<template v-if=\"!message.sending && message.error && message.retry\">\n\t\t\t\t\t\t\t<div class=\"bx-im-message-status-retry\" :title=\"localize.IM_MESSENGER_MESSAGE_RETRY_TITLE\" @click=\"clickByMessageRetry({message: message, event: $event})\">\n\t\t\t\t\t\t\t\t<span class=\"bx-im-message-retry-icon\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</transition>\n\t\t\t\t\t<template v-if=\"showMenu && !message.sending && !message.error\">\n\t\t\t\t\t\t<div class=\"bx-im-message-status-menu\" :title=\"localize.IM_MESSENGER_MESSAGE_MENU_TITLE\" @click=\"clickByMessageMenu({message: message, event: $event})\">\n\t\t\t\t\t\t\t<span class=\"bx-im-message-menu-icon\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template> \n\t\t\t\t</div>\n\t\t\t\t<template v-if=\"dragIconShowLeft\">\n\t\t\t\t\t<div class=\"bx-im-message-reply bx-im-message-reply-left\">\n\t\t\t\t\t\t<div class=\"bx-im-message-reply-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t</template>\n\t\t\t<template v-else-if=\"type !== MessageType.self\">\n\t\t\t\t<template v-if=\"dragIconShowLeft\">\n\t\t\t\t\t<div class=\"bx-im-message-reply bx-im-message-reply-left\">\n\t\t\t\t\t\t<div class=\"bx-im-message-reply-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t\t<template v-if=\"type === MessageType.opponent\">\n\t\t\t\t\t<div v-if=\"showAvatar\" class=\"bx-im-message-avatar\" @click=\"clickByAvatar({user: userData, event: $event})\">\n\t\t\t\t\t\t<div :class=\"['bx-im-message-avatar-image', {\n\t\t\t\t\t\t\t\t'bx-im-message-avatar-image-default': !userData.avatar\n\t\t\t\t\t\t\t}]\"\n\t\t\t\t\t\t\t:style=\"{\n\t\t\t\t\t\t\t\tbackgroundColor: !userData.avatar? userData.color: '', \n\t\t\t\t\t\t\t\tbackgroundImage: userAvatar\n\t\t\t\t\t\t\t}\" \n\t\t\t\t\t\t\t:title=\"userData.name\"\n\t\t\t\t\t\t></div>\t\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class=\"bx-im-message-box\">\n\t\t\t\t\t<component :is=\"componentBodyId\"\n\t\t\t\t\t\t:userId=\"userId\" \n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t\t:messageType=\"type\"\n\t\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t\t:user=\"userData\"\n\t\t\t\t\t\t:files=\"filesData\"\n\t\t\t\t\t\t:showAvatar=\"showAvatar\"\n\t\t\t\t\t\t:showName=\"showName\"\n\t\t\t\t\t\t:enableReactions=\"enableReactions\"\n\t\t\t\t\t\t:referenceContentBodyClassName=\"referenceContentBodyClassName\"\n\t\t\t\t\t\t:referenceContentNameClassName=\"referenceContentNameClassName\"\n\t\t\t\t\t\t@clickByUserName=\"clickByUserName\"\n\t\t\t\t\t\t@clickByUploadCancel=\"clickByUploadCancel\"\n\t\t\t\t\t\t@clickByKeyboardButton=\"clickByKeyboardButton\"\n\t\t\t\t\t\t@clickByChatTeaser=\"clickByChatTeaser\"\n\t\t\t\t\t\t@setReaction=\"setMessageReaction\"\n\t\t\t\t\t\t@openReactionList=\"openMessageReactionList\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showMenu\"  class=\"bx-im-message-menu\" :title=\"localize.IM_MESSENGER_MESSAGE_MENU_TITLE\" @click=\"clickByMessageMenu({message: message, event: $event})\">\n\t\t\t\t\t<span class=\"bx-im-message-menu-icon\"></span>\n\t\t\t\t</div>\t\n\t\t\t\t<template v-if=\"dragIconShowRight\">\n\t\t\t\t\t<div class=\"bx-im-message-reply bx-im-message-reply-right\">\n\t\t\t\t\t\t<div class=\"bx-im-message-reply-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t</template>\n\t\t</div>\n\t`\n});"],"names":["Vue","component","props","userId","default","dialogId","chatId","enableReactions","enableDateActions","enableCreateContent","enableGestureQuote","enableGestureQuoteFromRight","enableGestureMenu","showAvatar","showMenu","showName","showLargeFont","capturedMoveEvent","referenceContentClassName","referenceContentBodyClassName","referenceContentNameClassName","dialog","type","Object","DialoguesModel","create","getElementState","message","MessagesModel","data","componentBodyId","drag","dragWidth","dragPosition","dragIconShowLeft","dragIconShowRight","created","dragStartPositionX","dragStartPositionY","dragMovePositionX","dragMovePositionY","beforeDestroy","clearTimeout","dragStartTimeout1","dragStartTimeout2","dragBackAnimation","Animation","cancel","methods","clickByAvatar","event","$emit","clickByUserName","Utils","platform","isMobile","clickByUploadCancel","clickByKeyboardButton","clickByChatTeaser","clickByMessageMenu","clickByMessageRetry","setMessageReaction","openMessageReactionList","gestureRouter","eventName","gestureQuote","gestureMenu","gestureMenuStarted","gestureMenuPreventTouchEnd","target","tagName","gestureMenuStartPosition","x","changedTouches","clientX","y","clientY","gestureMenuTimeout","setTimeout","Math","abs","preventDefault","browser","findParent","isAndroid","fromRight","layerX","getBoundingClientRect","left","layerY","top","dragCheck","dragStartInitialX","dragStartInitialY","result","$refs","body","offsetWidth","isBitrixMobile","app","exec","start","end","increment","duration","element","elementProperty","callback","dragLayerPosition","undefined","watch","movementX","dragPositionMax","dragPositionIcon","computed","MessageType","system","authorId","self","opponent","localize","getFilteredPhrases","$root","$bitrixMessages","freeze","assign","IM_MESSENGER_MESSAGE_MENU_TITLE","replace","isMac","userData","$store","getters","userAvatar","params","AVATAR","avatar","filesData","files","isEdited","IS_EDITED","isDeleted","IS_DELETED","isLargeFont","LARGE_FONT","template"],"mappings":"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"}