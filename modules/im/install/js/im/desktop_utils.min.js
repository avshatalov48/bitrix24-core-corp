(function(){if(BX.desktopUtils)return;BX.desktopUtils=function(){this.runningCheckTimeout={};this.checkUrl="http://127.0.0.1:20141/";this._openedBxLink=false};BX.desktopUtils.prototype.runningCheck=function(e,t,n){if(typeof e=="undefined"){return false}if(typeof t=="undefined"){t=function(){}}n=typeof n=="undefined"||!n?false:true;var i=+new Date;if(typeof BXDesktopSystem!=="undefined"){if(BX.MessengerCommon.isDesktop()){t(false,i)}else{e(true,i)}return true}else if(typeof BXIM=="undefined"||BX.MessengerCommon.isDesktop()||!BXIM.desktopStatus||BXIM.desktopVersion<18){t(false,i);return false}else if(BXIM.desktopVersion<35){if(n){t(false,i)}else{e(true,i)}return true}var o=false;var s=BX.create("img",{attrs:{src:this.checkUrl+"icon.png?"+i,"data-id":i},props:{className:"bx-messenger-out-of-view"},events:{error:function(){if(o){return}var e=this.getAttribute("data-id");t(false,e);clearTimeout(BX.desktopUtils.runningCheckTimeout[e]);BX.remove(this)},load:function(){var t=this.getAttribute("data-id");e(true,t);clearTimeout(BX.desktopUtils.runningCheckTimeout[t]);BX.remove(this)}}});document.body.appendChild(s);this.runningCheckTimeout[i]=setTimeout(function(){t(false,i);clearTimeout(BX.desktopUtils.runningCheckTimeout[i]);BX.remove(this);o=true},500);return true};BX.desktopUtils.prototype.goToBx=function(e){if(typeof BXIM!="undefined"&&BXIM.desktopVersion>=36&&!e.match(/^bx:\/\/v(\d)\//)){e=e.replace("bx://","bx://v"+BXIM.desktopProtocolVersion+"/"+location.hostname+"/")}this._setOpenedBxLink();location.href=e};BX.desktopUtils.prototype._setOpenedBxLink=function(){this._openedBxLink=true;setTimeout(function(){BX.onCustomEvent("BXLinkOpened",[]);this._openedBxLink=false}.bind(this),1e3)};BX.desktopUtils.prototype.isChangedLocationToBx=function(){return this._openedBxLink};BX.desktopUtils.prototype.encodeParams=function(e){if(!BX.type.isPlainObject(e))return"";var t="";var n=true;for(var i in e){t=t+(n?"":"!!")+i+"!!"+e[i];n=false}return t};BX.desktopUtils.prototype.decodeParams=function(e){var t={};if(!BX.type.isNotEmptyString(e))return t;var n=e.split("!!");for(var i=0;i<n.length;i=i+2){t[n[i]]=n[i+1]}return t};BX.desktopUtils=new BX.desktopUtils})();
//# sourceMappingURL=desktop_utils.map.js