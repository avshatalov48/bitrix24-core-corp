{"version":3,"file":"registry.bundle.js","sources":["../src/application.js","../src/conference.js","../src/messages.js","../src/dialogues.js","../src/users.js","../src/files.js","../src/recent.js","../src/notifications.js","../src/call.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Application model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {DeviceType, DeviceOrientation} from 'im.const';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nexport class ApplicationModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tsiteId: this.getVariable('common.siteId', 'default'),\n\t\t\t\tuserId: this.getVariable('common.userId', 0),\n\t\t\t\tlanguageId: this.getVariable('common.languageId', 'en'),\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tdialogId: this.getVariable('dialog.dialogId', '0'),\n\t\t\t\tchatId: this.getVariable('dialog.chatId', 0),\n\t\t\t\tdiskFolderId: this.getVariable('dialog.diskFolderId', 0),\n\t\t\t\tmessageLimit: this.getVariable('dialog.messageLimit', 20),\n\t\t\t\tenableReadMessages: this.getVariable('dialog.enableReadMessages', true),\n\t\t\t\tmessageExtraCount: 0,\n\t\t\t},\n\t\t\tdisk:\n\t\t\t{\n\t\t\t\tenabled: false,\n\t\t\t\tmaxFileSize: 5242880,\n\t\t\t},\n\t\t\tcall:\n\t\t\t{\n\t\t\t\tserverEnabled: false,\n\t\t\t\tmaxParticipants: 24,\n\t\t\t},\n\t\t\tmobile:\n\t\t\t{\n\t\t\t\tkeyboardShow: false,\n\t\t\t},\n\t\t\tdevice:\n\t\t\t{\n\t\t\t\ttype: this.getVariable('device.type', DeviceType.desktop),\n\t\t\t\torientation: this.getVariable('device.orientation', DeviceOrientation.portrait),\n\t\t\t},\n\t\t\toptions:\n\t\t\t{\n\t\t\t\tquoteEnable: this.getVariable('options.quoteEnable', true),\n\t\t\t\tquoteFromRight: this.getVariable('options.quoteFromRight', true),\n\t\t\t\tautoplayVideo: this.getVariable('options.autoplayVideo', true),\n\t\t\t\tdarkBackground: this.getVariable('options.darkBackground', false),\n\t\t\t\tshowSmiles: false\n\t\t\t},\n\t\t\terror:\n\t\t\t{\n\t\t\t\tactive: false,\n\t\t\t\tcode: '',\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn Object.assign({\n\t\t\tcommon: this.getVariable('saveException.common', null),\n\t\t\tdialog: this.getVariable('saveException.dialog', null),\n\t\t\tmobile: this.getVariable('saveException.mobile', null),\n\t\t\tdevice: this.getVariable('saveException.device', null),\n\t\t\terror: this.getVariable('saveException.error', null)\n\t\t});\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.validate(payload));\n\t\t\t},\n\t\t\tshowSmiles: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('showSmiles')\n\t\t\t},\n\t\t\thideSmiles: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('hideSmiles');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet hasChange = false;\n\t\t\t\tfor (let group in payload)\n\t\t\t\t{\n\t\t\t\t\tif (!payload.hasOwnProperty(group))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let field in payload[group])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload[group].hasOwnProperty(field))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate[group][field] = payload[group][field];\n\t\t\t\t\t\thasChange = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (hasChange && this.isSaveNeeded(payload))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseDialogExtraCount(state, payload = {})\n\t\t\t{\n\t\t\t\tlet {count = 1} = payload;\n\n\t\t\t\tstate.dialog.messageExtraCount += count;\n\t\t\t},\n\t\t\tdecreaseDialogExtraCount(state, payload = {})\n\t\t\t{\n\t\t\t\tlet {count = 1} = payload;\n\n\t\t\t\tlet newCounter = state.dialog.messageExtraCount - count;\n\t\t\t\tif (newCounter <= 0)\n\t\t\t\t{\n\t\t\t\t\tnewCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstate.dialog.messageExtraCount = newCounter;\n\t\t\t},\n\t\t\tclearDialogExtraCount(state)\n\t\t\t{\n\t\t\t\tstate.dialog.messageExtraCount = 0;\n\t\t\t},\n\t\t\tshowSmiles(state)\n\t\t\t{\n\t\t\t\tstate.options.showSmiles = true;\n\t\t\t},\n\t\t\thideSmiles(state)\n\t\t\t{\n\t\t\t\tstate.options.showSmiles = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.common === 'object' && fields.common)\n\t\t{\n\t\t\tresult.common = {};\n\n\t\t\tif (typeof fields.common.userId === 'number')\n\t\t\t{\n\t\t\t\tresult.common.userId = fields.common.userId;\n\t\t\t}\n\n\t\t\tif (typeof fields.common.languageId === 'string')\n\t\t\t{\n\t\t\t\tresult.common.languageId = fields.common.languageId;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.dialog === 'object' && fields.dialog)\n\t\t{\n\t\t\tresult.dialog = {};\n\n\t\t\tif (typeof fields.dialog.dialogId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId.toString();\n\t\t\t\tresult.dialog.chatId = 0;\n\t\t\t}\n\t\t\telse if (typeof fields.dialog.dialogId === 'string')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId;\n\n\t\t\t\tif (typeof fields.dialog.chatId !== 'number')\n\t\t\t\t{\n\t\t\t\t\tlet chatId = fields.dialog.dialogId;\n\t\t\t\t\tif (chatId.startsWith('chat'))\n\t\t\t\t\t{\n\t\t\t\t\t\tchatId = fields.dialog.dialogId.substr(4);\n\t\t\t\t\t}\n\n\t\t\t\t\tchatId = parseInt(chatId);\n\n\t\t\t\t\tresult.dialog.chatId = !isNaN(chatId)? chatId: 0;\n\t\t\t\t\tfields.dialog.chatId = result.dialog.chatId;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.chatId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.chatId = fields.dialog.chatId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.diskFolderId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.diskFolderId = fields.dialog.diskFolderId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.messageLimit === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.messageLimit = fields.dialog.messageLimit;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.messageExtraCount === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.messageExtraCount = fields.dialog.messageExtraCount;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.enableReadMessages === 'boolean')\n\t\t\t{\n\t\t\t\tresult.dialog.enableReadMessages = fields.dialog.enableReadMessages;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.disk === 'object' && fields.disk)\n\t\t{\n\t\t\tresult.disk = {};\n\n\t\t\tif (typeof fields.disk.enabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.disk.enabled = fields.disk.enabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.disk.maxFileSize === 'number')\n\t\t\t{\n\t\t\t\tresult.disk.maxFileSize = fields.disk.maxFileSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.call === 'object' && fields.call)\n\t\t{\n\t\t\tresult.call = {};\n\n\t\t\tif (typeof fields.call.serverEnabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.call.serverEnabled = fields.call.serverEnabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.call.maxParticipants === 'number')\n\t\t\t{\n\t\t\t\tresult.call.maxParticipants = fields.call.maxParticipants;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.mobile === 'object' && fields.mobile)\n\t\t{\n\t\t\tresult.mobile = {};\n\n\t\t\tif (typeof fields.mobile.keyboardShow === 'boolean')\n\t\t\t{\n\t\t\t\tresult.mobile.keyboardShow = fields.mobile.keyboardShow;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.device === 'object' && fields.device)\n\t\t{\n\t\t\tresult.device = {};\n\n\t\t\tif (typeof fields.device.type === 'string' && typeof DeviceType[fields.device.type] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.type = fields.device.type;\n\t\t\t}\n\n\t\t\tif (typeof fields.device.orientation === 'string' && typeof DeviceOrientation[fields.device.orientation] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.orientation = fields.device.orientation;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.error === 'object' && fields.error)\n\t\t{\n\t\t\tif (typeof fields.error.active === 'boolean')\n\t\t\t{\n\t\t\t\tresult.error = {\n\t\t\t\t\tactive: fields.error.active,\n\t\t\t\t\tcode: fields.error.code.toString() || '',\n\t\t\t\t\tdescription: fields.error.description.toString() || '',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}","/**\n * Bitrix Messenger\n * Call Application model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {ConferenceStateType, ConferenceRightPanelMode as RightPanelMode} from 'im.const';\n\nexport class ConferenceModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'conference';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tinited: false,\n\t\t\t\tpassChecked: true,\n\t\t\t\tshowChat: false,\n\t\t\t\tuserCount: 0,\n\t\t\t\tmessageCount: 0,\n\t\t\t\tuserInCallCount: 0,\n\t\t\t\tstate: ConferenceStateType.preparation,\n\t\t\t\tcallEnded: false,\n\t\t\t\tshowSmiles: false,\n\t\t\t\terror: '',\n\t\t\t\tconferenceTitle: '',\n\t\t\t\talias: '',\n\t\t\t\tpermissionsRequested: false,\n\t\t\t\tconferenceStarted: null,\n\t\t\t\tconferenceStartDate: null,\n\t\t\t\tjoinWithVideo: null,\n\t\t\t\tuserReadyToJoin: false,\n\t\t\t\tisBroadcast: false,\n\t\t\t\tusers: [],\n\t\t\t\tusersInCall: [],\n\t\t\t\tpresenters: [],\n\t\t\t\trightPanelMode: RightPanelMode.hidden\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: ''\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tshowChat: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.newState !== 'boolean')\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('showChat', payload);\n\t\t\t},\n\t\t\tchangeRightPanelMode: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!RightPanelMode[payload.mode])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('changeRightPanelMode', payload);\n\t\t\t},\n\t\t\tsetPermissionsRequested: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.status !== 'boolean')\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tstore.commit('setPermissionsRequested', payload);\n\t\t\t},\n\t\t\tsetPresenters: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload.presenters))\n\t\t\t\t{\n\t\t\t\t\tpayload.presenters = [payload.presenters];\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setPresenters', payload);\n\t\t\t},\n\t\t\tsetUsers: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload.users))\n\t\t\t\t{\n\t\t\t\t\tpayload.users = [payload.users];\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUsers', payload);\n\t\t\t},\n\t\t\tremoveUsers: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload.users))\n\t\t\t\t{\n\t\t\t\t\tpayload.users = [payload.users];\n\t\t\t\t}\n\n\t\t\t\tstore.commit('removeUsers', payload);\n\t\t\t},\n\t\t\tsetUsersInCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload.users))\n\t\t\t\t{\n\t\t\t\t\tpayload.users = [payload.users];\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUsersInCall', payload);\n\t\t\t},\n\t\t\tremoveUsersInCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload.users))\n\t\t\t\t{\n\t\t\t\t\tpayload.users = [payload.users];\n\t\t\t\t}\n\n\t\t\t\tstore.commit('removeUsersInCall', payload);\n\t\t\t},\n\t\t\tsetConferenceTitle: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.conferenceTitle !== 'string')\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setConferenceTitle', payload);\n\t\t\t},\n\t\t\tsetBroadcastMode: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.broadcastMode !== 'boolean')\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setBroadcastMode', payload);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.inited === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.inited = payload.inited;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.passChecked === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.passChecked = payload.passChecked;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userCount === 'number' || typeof payload.userCount === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.userCount = parseInt(payload.userCount);\n\t\t\t\t}\n\t\t\t\tif (typeof payload.messageCount === 'number' || typeof payload.messageCount === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.messageCount = parseInt(payload.messageCount);\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userInCallCount === 'number' || typeof payload.userInCallCount === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.userInCallCount = parseInt(payload.userInCallCount);\n\t\t\t\t}\n\t\t\t\tif (typeof payload.componentError === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.componentError = payload.componentError;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.isBroadcast === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.isBroadcast = payload.isBroadcast;\n\t\t\t\t}\n\t\t\t\tif (Array.isArray(payload.presenters))\n\t\t\t\t{\n\t\t\t\t\tstate.common.presenters = payload.presenters;\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowChat: (state, {newState}) =>\n\t\t\t{\n\t\t\t\tstate.common.showChat = newState;\n\t\t\t},\n\t\t\tchangeRightPanelMode: (state, {mode}) =>\n\t\t\t{\n\t\t\t\tstate.common.rightPanelMode = mode;\n\t\t\t},\n\t\t\tsetPermissionsRequested: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.permissionsRequested = payload.status;\n\t\t\t},\n\t\t\tstartCall: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.state = ConferenceStateType.call;\n\t\t\t\tstate.common.callEnded = false;\n\t\t\t},\n\t\t\tendCall: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.state = ConferenceStateType.preparation;\n\t\t\t\tstate.common.callEnded = true;\n\t\t\t},\n\t\t\treturnToPreparation: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.state = ConferenceStateType.preparation;\n\t\t\t},\n\t\t\ttoggleSmiles: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.showSmiles = !state.common.showSmiles;\n\t\t\t},\n\t\t\tsetError: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.errorCode === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.error = payload.errorCode;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetConferenceTitle: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.conferenceTitle = payload.conferenceTitle;\n\t\t\t},\n\t\t\tsetBroadcastMode: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.isBroadcast = payload.broadcastMode;\n\t\t\t},\n\t\t\tsetAlias: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.alias === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.alias = payload.alias;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetJoinType: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.joinWithVideo === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.joinWithVideo = payload.joinWithVideo;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetConferenceStatus: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.conferenceStarted === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.conferenceStarted = payload.conferenceStarted;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetConferenceStartDate: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.conferenceStartDate instanceof Date)\n\t\t\t\t{\n\t\t\t\t\tstate.common.conferenceStartDate = payload.conferenceStartDate;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetUserReadyToJoin: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.userReadyToJoin = true;\n\t\t\t},\n\t\t\tsetPresenters: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.replace)\n\t\t\t\t{\n\t\t\t\t\tstate.common.presenters = payload.presenters;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpayload.presenters.forEach(presenter => {\n\t\t\t\t\t\tpresenter = parseInt(presenter);\n\t\t\t\t\t\tif (!state.common.presenters.includes(presenter))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.common.presenters.push(presenter);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetUsers: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.users.forEach(user => {\n\t\t\t\t\tuser = parseInt(user);\n\t\t\t\t\tif (!state.common.users.includes(user))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.users.push(user);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tremoveUsers: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.users = state.common.users.filter(user => {\n\t\t\t\t\treturn !payload.users.includes(parseInt(user));\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUsersInCall: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.users.forEach(user => {\n\t\t\t\t\tuser = parseInt(user);\n\t\t\t\t\tif (!state.common.usersInCall.includes(user))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.usersInCall.push(user);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tremoveUsersInCall: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.common.usersInCall = state.common.usersInCall.filter(user => {\n\t\t\t\t\treturn !payload.users.includes(parseInt(user));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\tinited: null,\n\t\t\t\tstate: null,\n\t\t\t\tshowSmiles: null,\n\t\t\t\tuserCount: null,\n\t\t\t\tmessageCount: null,\n\t\t\t\tuserInCallCount: null,\n\t\t\t\terror: null,\n\t\t\t\tconferenceTitle: null,\n\t\t\t\talias: null,\n\t\t\t\tconferenceStarted: null,\n\t\t\t\tconferenceStartDate: null,\n\t\t\t\tjoinWithVideo: null,\n\t\t\t\tuserReadyToJoin: null,\n\t\t\t\trightPanelMode: null,\n\t\t\t\tpresenters: null,\n\t\t\t\tusers: null\n\t\t\t},\n\t\t}\n\t}\n}","/**\n * Bitrix Messenger\n * Messages model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport { MutationType, RecentSection as Section, StorageLimit, EventType } from 'im.const';\nimport {Utils} from \"im.lib.utils\";\nimport { Logger } from \"im.lib.logger\";\n\nimport {EventEmitter} from 'main.core.events';\n\nconst IntersectionType = {\n\tempty: 'empty',\n\tequal: 'equal',\n\tnone: 'none',\n\tfound: 'found',\n\tfoundReverse: 'foundReverse',\n};\n\nexport class MessagesModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcreated: 0,\n\t\t\tcollection: {},\n\t\t\tmutationType: {},\n\t\t\tsaveMessageList: {},\n\t\t\tsaveFileList: {},\n\t\t\tsaveUserList: {},\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t}\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\ttemplateId: 0,\n\t\t\ttemplateType: 'message',\n\t\t\tplaceholderType: 0,\n\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: \"\",\n\t\t\ttextConverted: \"\",\n\t\t\tparams: {\n\t\t\t\tTYPE : 'default',\n\t\t\t\tCOMPONENT_ID : 'bx-im-view-message',\n\t\t\t},\n\n\t\t\tpush: false,\n\t\t\tunread: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tretry: false,\n\t\t\tblink: false,\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\n\t\t\tgetMutationType: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.mutationType[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn {initialType: MutationType.none, appliedType: MutationType.none};\n\t\t\t\t}\n\n\t\t\t\treturn state.mutationType[chatId];\n\t\t\t},\n\t\t\tgetLastId: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tlet lastId = 0;\n\n\t\t\t\tfor (let i = 0; i < state.collection[chatId].length; i++)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[chatId][i];\n\t\t\t\t\tif (\n\t\t\t\t\t\telement.push\n\t\t\t\t\t\t|| element.sending\n\t\t\t\t\t\t|| element.id.toString().startsWith('temporary')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (lastId < element.id)\n\t\t\t\t\t{\n\t\t\t\t\t\tlastId = element.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn lastId? lastId: null;\n\t\t\t},\n\t\t\tgetMessage: state => (chatId, messageId) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tfor (let index = state.collection[chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tif (state.collection[chatId][index].id === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.collection[chatId][index];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tget: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetSaveFileList: state => params =>\n\t\t\t{\n\t\t\t\treturn state.saveFileList;\n\t\t\t},\n\t\t\tgetSaveUserList: state => params =>\n\t\t\t{\n\t\t\t\treturn state.saveUserList;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload));\n\t\t\t\tresult.params = Object.assign({}, this.getElementState().params, result.params);\n\t\t\t\tresult.id = 'temporary' + (new Date).getTime() + store.state.created;\n\t\t\t\tresult.templateId = result.id;\n\t\t\t\tresult.unread = false;\n\n\t\t\t\tstore.commit('add', Object.assign({}, this.getElementState(), result));\n\n\t\t\t\tif (payload.sending !== false)\n\t\t\t\t{\n\t\t\t\t\tstore.dispatch('actionStart', {\n\t\t\t\t\t\tid: result.id,\n\t\t\t\t\t\tchatId: result.chatId,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn result.id;\n\t\t\t},\n\t\t\tactionStart: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: true}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tactionError: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: false, error: true, retry: payload.retry !== false}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tactionFinish: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: false, error: false, retry: false}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message, {host: store.state.host}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload, {host: store.state.host});\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.set,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\n\t\t\t\treturn 'set is done';\n\t\t\t},\n\t\t\taddPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.placeholders instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.placeholders = payload.placeholders.map(message => this.prepareMessage(message, { host: store.state.host }));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst insertType = payload.requestMode === 'history'? MutationType.setBefore : MutationType.setAfter;\n\t\t\t\tif (insertType === MutationType.setBefore)\n\t\t\t\t{\n\t\t\t\t\tpayload.placeholders = payload.placeholders.reverse();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType,\n\t\t\t\t\tdata : payload.placeholders\n\t\t\t\t});\n\n\t\t\t\treturn payload.placeholders[0].id;\n\t\t\t},\n\t\t\tclearPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPlaceholders', payload);\n\t\t\t},\n\t\t\tupdatePlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.data instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.data = payload.data.map(message => this.prepareMessage(message, { host: store.state.host }));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updatePlaceholders', payload);\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsetAfter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload);\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setAfter,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetBefore: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload);\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setBefore,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tif (/^\\d+$/.test(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('initCollection', {chatId: payload.chatId});\n\n\t\t\t\tif (!store.state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet index = store.state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\tif (index < 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet result = this.validate(Object.assign({}, payload.fields));\n\n\t\t\t\tif (result.params)\n\t\t\t\t{\n\t\t\t\t\tresult.params = Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tthis.getElementState().params,\n\t\t\t\t\t\tstore.state.collection[payload.chatId][index].params,\n\t\t\t\t\t\tresult.params\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\tindex : index,\n\t\t\t\t\tfields : result\n\t\t\t\t});\n\n\t\t\t\tif (payload.fields.blink)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\t\tfields : {blink: false}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!(payload.id instanceof Array))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = [payload.id];\n\t\t\t\t}\n\n\t\t\t\tpayload.id = payload.id.map(id => {\n\t\t\t\t\tif (/^\\d+$/.test(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tid = parseInt(id);\n\t\t\t\t\t}\n\t\t\t\t\treturn id;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\telements : payload.id,\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tclear: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (payload.keepPlaceholders)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearMessages', {\n\t\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clear', {\n\t\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tapplyMutationType: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tstore.commit('applyMutationType', {\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\treadMessages: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.readId = parseInt(payload.readId) || 0;\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (typeof store.state.collection[payload.chatId] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\treturn {count: 0}\n\t\t\t\t}\n\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let index = store.state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = store.state.collection[payload.chatId][index];\n\t\t\t\t\tif (!element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (payload.readId === 0 || element.id <= payload.readId)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tchatId: payload.chatId,\n\t\t\t\t\treadId: payload.readId,\n\t\t\t\t});\n\n\t\t\t\treturn {count};\n\t\t\t},\n\t\t\tunreadMessages: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.unreadId = parseInt(payload.unreadId) || 0;\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (typeof store.state.collection[payload.chatId] === 'undefined' || !payload.unreadId)\n\t\t\t\t{\n\t\t\t\t\treturn {count: 0}\n\t\t\t\t}\n\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let index = store.state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = store.state.collection[payload.chatId][index];\n\t\t\t\t\tif (element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (element.id >= payload.unreadId)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('unreadMessages', {\n\t\t\t\t\tchatId: payload.chatId,\n\t\t\t\t\tunreadId: payload.unreadId,\n\t\t\t\t});\n\n\t\t\t\treturn {count};\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\treturn this.initCollection(state, payload);\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId].push(payload);\n\t\t\t\tstate.saveMessageList[payload.chatId].push(payload.id);\n\n\t\t\t\tstate.created += 1;\n\n\t\t\t\tstate.collection[payload.chatId].sort((a, b) => a.id - b.id);\n\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\tLogger.warn('Messages model: saving state after add');\n\t\t\t},\n\t\t\tclearPlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdatePlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst firstPlaceholderId = `placeholder${payload.firstMessage}`;\n\t\t\t\tconst firstPlaceholderIndex = state.collection[payload.chatId].findIndex((message) => {\n\t\t\t\t\treturn message.id === firstPlaceholderId;\n\t\t\t\t});\n\t\t\t\t// Logger.warn('firstPlaceholderIndex', firstPlaceholderIndex);\n\t\t\t\tif (firstPlaceholderIndex >= 0)\n\t\t\t\t{\n\t\t\t\t\t// Logger.warn('before delete', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t\tstate.collection[payload.chatId].splice(firstPlaceholderIndex, payload.amount);\n\t\t\t\t\t// Logger.warn('after delete', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t\tstate.collection[payload.chatId].splice(firstPlaceholderIndex, 0, ...payload.data);\n\t\t\t\t\t// Logger.warn('after add', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.chatId].sort((a, b) => a.id - b.id);\n\t\t\t\tLogger.warn('Messages model: saving state after updating placeholders');\n\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: set mutation', payload);\n\t\t\t\tlet chats = [];\n\t\t\t\tlet chatsSave = [];\n\t\t\t\tlet isPush = false;\n\n\t\t\t\tconst initialType = payload.insertType;\n\n\t\t\t\tif (payload.insertType === MutationType.set)\n\t\t\t\t{\n\t\t\t\t\tpayload.insertType = MutationType.setAfter;\n\n\t\t\t\t\tlet elements = {};\n\t\t\t\t\tpayload.data.forEach(element => {\n\t\t\t\t\t\tif (!elements[element.chatId])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telements[element.chatId] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telements[element.chatId].push(element.id);\n\t\t\t\t\t});\n\n\t\t\t\t\tfor (let chatId in elements)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!elements.hasOwnProperty(chatId))\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tthis.initCollection(state, {chatId});\n\t\t\t\t\t\tLogger.warn('Messages model: messages before adding from request - ', state.collection[chatId].length);\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstate.saveMessageList[chatId].length > elements[chatId].length\n\t\t\t\t\t\t\t|| elements[chatId].length < StorageLimit.messages\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => elements[chatId].includes(element.id));\n\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => elements[chatId].includes(id));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLogger.warn('Messages model: cache length', state.saveMessageList[chatId].length);\n\t\t\t\t\t\tlet intersection = this.manageCacheBeforeSet(\n\t\t\t\t\t\t\t[...state.saveMessageList[chatId].reverse()],\n\t\t\t\t\t\t\telements[chatId]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tLogger.warn('Messages model: set intersection with cache', intersection);\n\n\t\t\t\t\t\tif (intersection.type === IntersectionType.none)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (intersection.foundElements.length > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => !intersection.foundElements.includes(element.id));\n\t\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => !intersection.foundElements.includes(id));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tLogger.warn('Messages model: no intersection - removing cache');\n\t\t\t\t\t\t\tthis.removeIntersectionCacheElements = state.collection[chatId].map(element => element.id);\n\n\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => !this.removeIntersectionCacheElements.includes(element.id));\n\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => !this.removeIntersectionCacheElements.includes(id));\n\t\t\t\t\t\t\tthis.removeIntersectionCacheElements = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (intersection.type === IntersectionType.foundReverse)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn('Messages model: found reverse intersection');\n\t\t\t\t\t\t\tpayload.insertType = MutationType.setBefore;\n\t\t\t\t\t\t\tpayload.data = payload.data.reverse();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tLogger.warn('Messages model: adding messages to model', payload.data);\n\t\t\t\tfor (let element of payload.data)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {chatId: element.chatId});\n\n\t\t\t\t\tlet index = state.collection[element.chatId].findIndex(el => el.id === element.id);\n\t\t\t\t\tif (index > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete element.templateId;\n\n\t\t\t\t\t\tstate.collection[element.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[element.chatId][index],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setBefore)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].unshift(element);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setAfter)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].push(element);\n\t\t\t\t\t}\n\n\t\t\t\t\tchats.push(element.chatId);\n\n\t\t\t\t\tif (this.store.getters['dialogues/canSaveChat'] && this.store.getters['dialogues/canSaveChat'](element.chatId))\n\t\t\t\t\t{\n\t\t\t\t\t\tchatsSave.push(element.chatId);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tchats = [...new Set(chats)];\n\t\t\t\tchatsSave = [...new Set(chatsSave)];\n\n\t\t\t\tisPush = payload.data.every(element => element.push === true);\n\t\t\t\tLogger.warn('Is it fake push message?', isPush);\n\t\t\t\tchats.forEach(chatId => {\n\t\t\t\t\tstate.collection[chatId].sort((a, b) => a.id - b.id);\n\n\t\t\t\t\tif (!isPush)\n\t\t\t\t\t{\n\t\t\t\t\t\t//send event that messages are ready and we can start reading etc\n\t\t\t\t\t\tLogger.warn('setting messagesSet = true for chatId = ', chatId);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.messagesSet, {chatId});\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.readVisibleMessages, {chatId});\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (initialType !== MutationType.setBefore)\n\t\t\t\t{\n\t\t\t\t\tchatsSave.forEach(chatId => {\n\t\t\t\t\t\tLogger.warn('Messages model: saving state after set');\n\t\t\t\t\t\tthis.saveState(state, chatId);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet index = -1;\n\t\t\t\tif (typeof payload.index !== 'undefined' && state.collection[payload.chatId][payload.index])\n\t\t\t\t{\n\t\t\t\t\tindex = payload.index;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tindex = state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\t}\n\n\t\t\t\tif (index >= 0)\n\t\t\t\t{\n\t\t\t\t\tlet isSaveState = (\n\t\t\t\t\t\tstate.saveMessageList[payload.chatId].includes(state.collection[payload.chatId][index].id)\n\t\t\t\t\t\t|| payload.fields.id && !payload.fields.id.toString().startsWith('temporary') && state.collection[payload.chatId][index].id.toString().startsWith('temporary')\n\t\t\t\t\t);\n\n\t\t\t\t\tdelete payload.fields.templateId;\n\n\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\tpayload.fields\n\t\t\t\t\t);\n\n\t\t\t\t\tif (isSaveState)\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('Messages model: saving state after update');\n\t\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => !payload.elements.includes(element.id));\n\n\t\t\t\tif (state.saveMessageList[payload.chatId].length > 0)\n\t\t\t\t{\n\t\t\t\t\tfor (let id of payload.elements)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (state.saveMessageList[payload.chatId].includes(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn('Messages model: saving state after delete');\n\t\t\t\t\t\t\tthis.saveState(state, payload.chatId);\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tclear: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = [];\n\t\t\t\tstate.saveMessageList[payload.chatId] = [];\n\t\t\t},\n\t\t\tclearMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => {\n\t\t\t\t\treturn element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t\tstate.saveMessageList[payload.chatId] = [];\n\t\t\t},\n\t\t\tapplyMutationType: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof state.mutationType[payload.chatId] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\tVue.set(state.mutationType, payload.chatId, {applied: false, initialType: MutationType.none, appliedType: MutationType.none, scrollStickToTop: 0, scrollMessageId: 0});\n\t\t\t\t}\n\n\t\t\t\tstate.mutationType[payload.chatId].applied = true;\n\t\t\t},\n\t\t\treadMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet saveNeeded = false;\n\t\t\t\tfor (let index = state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[payload.chatId][index];\n\t\t\t\t\tif (!element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (payload.readId === 0 || element.id <= payload.readId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\t\t{unread: false}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsaveNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (saveNeeded)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('Messages model: saving state after reading');\n\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t}\n\t\t\t},\n\t\t\tunreadMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet saveNeeded = false;\n\t\t\t\tfor (let index = state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[payload.chatId][index];\n\t\t\t\t\tif (element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (element.id >= payload.unreadId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\t\t{unread: true}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsaveNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (saveNeeded)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('Messages model: saving state after unreading');\n\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t\tthis.updateSubordinateStates();\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof payload.chatId === 'undefined')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof payload.chatId === 'undefined'\n\t\t\t|| typeof state.collection[payload.chatId] !== 'undefined'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tVue.set(state.collection, payload.chatId, payload.messages? [].concat(payload.messages): []);\n\t\tVue.set(state.saveMessageList, payload.chatId, []);\n\t\tVue.set(state.saveFileList, payload.chatId, []);\n\t\tVue.set(state.saveUserList, payload.chatId, []);\n\n\t\treturn true;\n\t}\n\n\tprepareMessage(message, options = {})\n\t{\n\t\tlet result = this.validate(Object.assign({}, message), options);\n\n\t\tresult.params = Object.assign({}, this.getElementState().params, result.params);\n\t\tresult.templateId = result.id;\n\n\t\treturn Object.assign({}, this.getElementState(), result);\n\t}\n\n\tmanageCacheBeforeSet(cache, elements, recursive = false)\n\t{\n\t\tLogger.warn('manageCacheBeforeSet', cache, elements);\n\t\tlet result = {\n\t\t\ttype: IntersectionType.empty,\n\t\t\tfoundElements: [],\n\t\t\tnoneElements: []\n\t\t};\n\n\t\tif (!cache || cache.length <= 0)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tfor (let id of elements)\n\t\t{\n\t\t\tif (cache.includes(id))\n\t\t\t{\n\t\t\t\tif (result.type === IntersectionType.empty)\n\t\t\t\t{\n\t\t\t\t\tresult.type = IntersectionType.found;\n\t\t\t\t}\n\t\t\t\tresult.foundElements.push(id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (result.type === IntersectionType.empty)\n\t\t\t\t{\n\t\t\t\t\tresult.type = IntersectionType.none;\n\t\t\t\t}\n\t\t\t\tresult.noneElements.push(id);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tresult.type === IntersectionType.found\n\t\t\t&& cache.length === elements.length\n\t\t\t&& result.foundElements.length === elements.length\n\t\t)\n\t\t{\n\t\t\tresult.type = IntersectionType.equal;\n\t\t}\n\t\telse if (\n\t\t\tresult.type === IntersectionType.none\n\t\t\t&& !recursive\n\t\t\t&& result.foundElements.length > 0\n\t\t)\n\t\t{\n\t\t\tlet reverseResult = this.manageCacheBeforeSet(cache.reverse(), elements.reverse(), true);\n\t\t\tif (reverseResult.type === IntersectionType.found)\n\t\t\t{\n\t\t\t\treverseResult.type = IntersectionType.foundReverse;\n\t\t\t\treturn reverseResult;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tupdateSaveLists(state, chatId)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\t!chatId\n\t\t\t|| !this.store.getters['dialogues/canSaveChat']\n\t\t\t|| !this.store.getters['dialogues/canSaveChat'](chatId)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initCollection(state, {chatId: chatId});\n\n\t\tlet count = 0;\n\t\tlet saveMessageList = [];\n\t\tlet saveFileList = [];\n\t\tlet saveUserList = [];\n\n\t\tlet dialog = this.store.getters['dialogues/getByChatId'](chatId);\n\t\tif (dialog && dialog.type === 'private')\n\t\t{\n\t\t\tsaveUserList.push(parseInt(dialog.dialogId));\n\t\t}\n\n\t\tlet readCounter = 0;\n\t\tfor (let index = state.collection[chatId].length-1; index >= 0; index--)\n\t\t{\n\t\t\tif (state.collection[chatId][index].id.toString().startsWith('temporary'))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!state.collection[chatId][index].unread)\n\t\t\t{\n\t\t\t\treadCounter++;\n\t\t\t}\n\n\t\t\tif (count >= StorageLimit.messages && readCounter >= 50)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsaveMessageList.unshift(state.collection[chatId][index].id);\n\n\t\t\tcount++;\n\t\t}\n\n\t\tsaveMessageList = saveMessageList.slice(0, StorageLimit.messages);\n\n\t\tstate.collection[chatId].filter(element => saveMessageList.includes(element.id)).forEach(element =>\n\t\t{\n\t\t\tif (element.authorId > 0)\n\t\t\t{\n\t\t\t\tsaveUserList.push(element.authorId);\n\t\t\t}\n\n\t\t\tif (element.params.FILE_ID instanceof Array)\n\t\t\t{\n\t\t\t\tsaveFileList = element.params.FILE_ID.concat(saveFileList);\n\t\t\t}\n\t\t});\n\n\t\tstate.saveMessageList[chatId] = saveMessageList;\n\t\tstate.saveFileList[chatId] = [...new Set(saveFileList)];\n\t\tstate.saveUserList[chatId] = [...new Set(saveUserList)];\n\n\t\treturn true;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 150;\n\t}\n\n\tsaveState(state, chatId)\n\t{\n\t\tif (!this.updateSaveLists(state, chatId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t\tsaveMessageList: {},\n\t\t\t\tsaveUserList: {},\n\t\t\t\tsaveFileList: {},\n\t\t\t};\n\n\t\t\tfor (let chatId in state.saveMessageList)\n\t\t\t{\n\t\t\t\tif (!state.saveMessageList.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!storedState.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstoredState.collection[chatId] = [];\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId]\n\t\t\t\t\t.filter(element => state.saveMessageList[chatId].includes(element.id))\n\t\t\t\t\t.forEach(element => {\n\t\t\t\t\t\tif (element.templateType !== 'placeholder')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstoredState.collection[chatId].push(element);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tLogger.warn('Cache after updating', storedState.collection[chatId]);\n\n\t\t\t\tstoredState.saveMessageList[chatId] = state.saveMessageList[chatId];\n\t\t\t\tstoredState.saveFileList[chatId] = state.saveFileList[chatId];\n\t\t\t\tstoredState.saveUserList[chatId] = state.saveUserList[chatId];\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tupdateSubordinateStates()\n\t{\n\t\tthis.store.dispatch('users/saveState');\n\t\tthis.store.dispatch('files/saveState');\n\t}\n\n\tvalidate(fields, options)\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.id === \"number\")\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (typeof fields.id === \"string\")\n\t\t{\n\t\t\tif (fields.id.startsWith('temporary') || fields.id.startsWith('placeholder'))\n\t\t\t{\n\t\t\t\tresult.id = fields.id;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.id = parseInt(fields.id);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.templateId === \"number\")\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\t\telse if (typeof fields.templateId === \"string\")\n\t\t{\n\t\t\tif (fields.templateId.startsWith('temporary'))\n\t\t\t{\n\t\t\t\tresult.templateId = fields.templateId;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.templateId = parseInt(fields.templateId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.templateType === \"string\")\n\t\t{\n\t\t\tresult.templateType = fields.templateType;\n\t\t}\n\n\t\tif (typeof fields.placeholderType === \"number\")\n\t\t{\n\t\t\tresult.placeholderType = fields.placeholderType;\n\t\t}\n\n\t\tif (typeof fields.chat_id !== 'undefined')\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\t\tif (typeof fields.date !== \"undefined\")\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\t// previous P&P format\n\t\tif (typeof fields.textOriginal === \"string\" || typeof fields.textOriginal === \"number\")\n\t\t{\n\t\t\tresult.text = fields.textOriginal.toString();\n\n\t\t\tif (typeof fields.text === \"string\" || typeof fields.text === \"number\")\n\t\t\t{\n\t\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\t\ttext: fields.text.toString(),\n\t\t\t\t\tisConverted: true\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse // modern format\n\t\t{\n\t\t\tif (typeof fields.text_converted !== 'undefined')\n\t\t\t{\n\t\t\t\tfields.textConverted = fields.text_converted;\n\t\t\t}\n\t\t\tif (typeof fields.textConverted === \"string\" || typeof fields.textConverted === \"number\")\n\t\t\t{\n\t\t\t\tresult.textConverted = fields.textConverted.toString();\n\t\t\t}\n\t\t\tif (typeof fields.text === \"string\" || typeof fields.text === \"number\")\n\t\t\t{\n\t\t\t\tresult.text = fields.text.toString();\n\n\t\t\t\tlet isConverted = typeof result.textConverted !== 'undefined';\n\n\t\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\t\ttext: isConverted? result.textConverted: result.text,\n\t\t\t\t\tisConverted\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.senderId !== 'undefined')\n\t\t{\n\t\t\tfields.authorId = fields.senderId;\n\t\t}\n\t\telse if (typeof fields.author_id !== 'undefined')\n\t\t{\n\t\t\tfields.authorId = fields.author_id;\n\t\t}\n\t\tif (typeof fields.authorId === \"number\" || typeof fields.authorId === \"string\")\n\t\t{\n\t\t\tif (fields.system === true || fields.system === 'Y')\n\t\t\t{\n\t\t\t\tresult.authorId = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.authorId = parseInt(fields.authorId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.params === \"object\" && fields.params !== null)\n\t\t{\n\t\t\tconst params = this.validateParams(fields.params, options);\n\t\t\tif (params)\n\t\t\t{\n\t\t\t\tresult.params = params;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.push === \"boolean\")\n\t\t{\n\t\t\tresult.push = fields.push;\n\t\t}\n\n\t\tif (typeof fields.sending === \"boolean\")\n\t\t{\n\t\t\tresult.sending = fields.sending;\n\t\t}\n\n\t\tif (typeof fields.unread === \"boolean\")\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (typeof fields.blink === \"boolean\")\n\t\t{\n\t\t\tresult.blink = fields.blink;\n\t\t}\n\n\t\tif (typeof fields.error === \"boolean\" || typeof fields.error === \"string\")\n\t\t{\n\t\t\tresult.error = fields.error;\n\t\t}\n\n\t\tif (typeof fields.retry === \"boolean\")\n\t\t{\n\t\t\tresult.retry = fields.retry;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateParams(params, options)\n\t{\n\t\tconst result = {};\n\t\ttry\n\t\t{\n\t\t\tfor (let field in params)\n\t\t\t{\n\t\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (field === 'COMPONENT_ID')\n\t\t\t\t{\n\t\t\t\t\tif (typeof params[field] === \"string\" && BX.Vue.isComponent(params[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'LIKE')\n\t\t\t\t{\n\t\t\t\t\tif (params[field] instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult['REACTION'] = {like: params[field].map(element => parseInt(element))};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'CHAT_LAST_DATE')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = Utils.date.cast(params[field]);\n\t\t\t\t}\n\t\t\t\telse if (field === 'AVATAR')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field].startsWith('http') ? params[field] : options.host + params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'NAME')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'ATTACH')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = this.decodeAttach(params[field]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (e) {}\n\n\t\tlet hasResultElements = false;\n\t\tfor (let field in result)\n\t\t{\n\t\t\tif (!result.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\thasResultElements = true;\n\t\t\tbreak\n\t\t}\n\n\t\treturn hasResultElements? result: null;\n\t}\n\n\tconvertToHtml(params = {})\n\t{\n\t\tlet {\n\t\t\tquote = true,\n\t\t\timage = true,\n\t\t\ttext = '',\n\t\t\tisConverted = false,\n\t\t\tenableBigSmile = true\n\t\t} = params;\n\n\t\ttext = text.trim();\n\n\t\tif (!isConverted)\n\t\t{\n\t\t\ttext = text.replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\t\t}\n\n\t\tif (text.startsWith('/me'))\n\t\t{\n\t\t\ttext = `<i>${text.substr(4)}</i>`;\n\t\t}\n\t\telse if (text.startsWith('/loud'))\n\t\t{\n\t\t\ttext = `<b>${text.substr(6)}</b>`;\n\t\t}\n\n\t\tconst quoteSign = \"&gt;&gt;\";\n\t\tif (quote && text.indexOf(quoteSign) >= 0)\n\t\t{\n\t\t\tlet textPrepareFlag = false;\n\t\t\tlet textPrepare = text.split(isConverted? \"<br />\": \"\\n\");\n\t\t\tfor (let i = 0; i < textPrepare.length; i++)\n\t\t\t{\n\t\t\t\tif (textPrepare[i].startsWith(quoteSign))\n\t\t\t\t{\n\t\t\t\t\ttextPrepare[i] = textPrepare[i].replace(quoteSign, '<div class=\"bx-im-message-content-quote\"><div class=\"bx-im-message-content-quote-wrap\">');\n\t\t\t\t\twhile (++i < textPrepare.length && textPrepare[i].startsWith(quoteSign))\n\t\t\t\t\t{\n\t\t\t\t\t\ttextPrepare[i] = textPrepare[i].replace(quoteSign, '');\n\t\t\t\t\t}\n\t\t\t\t\ttextPrepare[i - 1] += '</div></div><br>';\n\t\t\t\t\ttextPrepareFlag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttext = textPrepare.join(\"<br />\");\n\t\t}\n\n\t\ttext = text.replace(/\\n/gi, '<br />');\n\n\t\ttext = text.replace(/\\t/gi, '&nbsp;&nbsp;&nbsp;&nbsp;');\n\n\t\ttext = this.decodeBbCode(text, false, enableBigSmile);\n\n\t\tif (quote)\n\t\t{\n\t\t\ttext = text.replace(/------------------------------------------------------<br \\/>(.*?)\\[(.*?)\\]<br \\/>(.*?)------------------------------------------------------(<br \\/>)?/g, function (whole, p1, p2, p3, p4, offset) {\n\t\t\t\treturn (offset > 0? '<br>': '') + \"<div class=\\\"bx-im-message-content-quote\\\"><div class=\\\"bx-im-message-content-quote-wrap\\\"><div class=\\\"bx-im-message-content-quote-name\\\"><span class=\\\"bx-im-message-content-quote-name-text\\\">\" + p1 + \"</span><span class=\\\"bx-im-message-content-quote-name-time\\\">\" + p2 + \"</span></div>\" + p3 + \"</div></div><br />\";\n\t\t\t});\n\t\t\ttext = text.replace(/------------------------------------------------------<br \\/>(.*?)------------------------------------------------------(<br \\/>)?/g, function (whole, p1, p2, p3, offset) {\n\t\t\t\treturn (offset > 0? '<br>': '') + \"<div class=\\\"bx-im-message-content-quote\\\"><div class=\\\"bx-im-message-content-quote-wrap\\\">\" + p1 + \"</div></div><br />\";\n\t\t\t});\n\t\t}\n\n\t\tif (image)\n\t\t{\n\t\t\tlet changed = false;\n\t\t\ttext = text.replace(/<a(.*?)>(http[s]{0,1}:\\/\\/.*?)<\\/a>/ig, function(whole, aInner, text, offset)\n\t\t\t{\n\t\t\t\tif(!text.match(/(\\.(jpg|jpeg|png|gif|webp)\\?|\\.(jpg|jpeg|png|gif|webp)$)/i) || text.indexOf(\"/docs/pub/\") > 0 || text.indexOf(\"logout=yes\") > 0)\n\t\t\t\t{\n\t\t\t\t\treturn whole;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchanged = true;\n\t\t\t\t\treturn (offset > 0? '<br />':'')+'<a' +aInner+ ' target=\"_blank\" class=\"bx-im-element-file-image\"><img src=\"'+text+'\" class=\"bx-im-element-file-image-source-text\" onerror=\"BX.Messenger.Model.MessagesModel.hideErrorImage(this)\"></a></span>';\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (changed)\n\t\t\t{\n\t\t\t\ttext = text.replace(/<\\/span>(\\n?)<br(\\s\\/?)>/ig, '</span>').replace(/<br(\\s\\/?)>(\\n?)<br(\\s\\/?)>(\\n?)<span/ig, '<br /><span');\n\t\t\t}\n\t\t}\n\n\t\tif (enableBigSmile)\n\t\t{\n\t\t\ttext = text.replace(\n\t\t\t\t/^(\\s*<img\\s+src=[^>]+?data-code=[^>]+?data-definition=\"UHD\"[^>]+?style=\"width:)(\\d+)(px[^>]+?height:)(\\d+)(px[^>]+?class=\"bx-smile\"\\s*\\/?>\\s*)$/,\n\t\t\t\tfunction doubleSmileSize(match, start, width, middle, height, end) {\n\t\t\t\t\treturn start + (parseInt(width, 10) * 1.7) + middle + (parseInt(height, 10) * 1.7) + end;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tif (text.substr(-6) == '<br />')\n\t\t{\n\t\t\ttext = text.substr(0, text.length - 6);\n\t\t}\n\t\ttext = text.replace(/<br><br \\/>/ig, '<br />');\n\t\ttext = text.replace(/<br \\/><br>/ig, '<br />');\n\n\t\treturn text;\n\t};\n\n\tdecodeBbCode(text, textOnly = false, enableBigSmile = true)\n\t{\n\t\treturn MessagesModel.decodeBbCode({text, textOnly, enableBigSmile})\n\t}\n\n\tdecodeAttach(item)\n\t{\n\t\tif (Array.isArray(item))\n\t\t{\n\t\t\titem.forEach(arrayElement => {\n\t\t\t\tarrayElement = this.decodeAttach(arrayElement);\n\t\t\t});\n\t\t}\n\t\telse if (typeof item === 'object' && item !== null)\n\t\t{\n\t\t\tfor (const prop in item)\n\t\t\t{\n\t\t\t\tif (item.hasOwnProperty(prop))\n\t\t\t\t{\n\t\t\t\t\titem[prop] = this.decodeAttach(item[prop]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (typeof item === 'string')\n\t\t\t{\n\t\t\t\titem = Utils.text.htmlspecialcharsback(item);\n\t\t\t}\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tstatic decodeBbCode(params = {})\n\t{\n\t\tlet {text, textOnly = false, enableBigSmile = true} = params;\n\n\t\tlet putReplacement = [];\n\t\ttext = text.replace(/\\[PUT(?:=(.+?))?\\](.+?)?\\[\\/PUT\\]/ig, function(whole)\n\t\t{\n\t\t\tvar id = putReplacement.length;\n\t\t\tputReplacement.push(whole);\n\t\t\treturn '####REPLACEMENT_PUT_'+id+'####';\n\t\t});\n\n\t\tlet sendReplacement = [];\n\t\ttext = text.replace(/\\[SEND(?:=(.+?))?\\](.+?)?\\[\\/SEND\\]/ig, function(whole)\n\t\t{\n\t\t\tvar id = sendReplacement.length;\n\t\t\tsendReplacement.push(whole);\n\t\t\treturn '####REPLACEMENT_SEND_'+id+'####';\n\t\t});\n\n\t\tlet codeReplacement = [];\n\t\ttext = text.replace(/\\[CODE\\]\\n?(.*?)\\[\\/CODE\\]/sig, function(whole, text) {\n\t\t\tlet id = codeReplacement.length;\n\t\t\tcodeReplacement.push(text);\n\t\t\treturn '####REPLACEMENT_CODE_'+id+'####';\n\t\t});\n\n\t\ttext = text.replace(/\\[url=([^\\]]+)\\](.*?)\\[\\/url\\]/ig, function(whole, link, text)\n\t\t{\n\t\t\tlet tag = document.createElement('a');\n\t\t\ttag.href = Utils.text.htmlspecialcharsback(link);\n\t\t\ttag.target = '_blank';\n\t\t\ttag.text = Utils.text.htmlspecialcharsback(text);\n\n\t\t\tlet allowList = [\n\t\t\t\t\"http:\",\n\t\t\t\t\"https:\",\n\t\t\t\t\"ftp:\",\n\t\t\t\t\"file:\",\n\t\t\t\t\"tel:\",\n\t\t\t\t\"callto:\",\n\t\t\t\t\"mailto:\",\n\t\t\t\t\"skype:\",\n\t\t\t\t\"viber:\",\n\t\t\t];\n\t\t\tif (allowList.indexOf(tag.protocol) <= -1)\n\t\t\t{\n\t\t\t\treturn whole;\n\t\t\t}\n\n\t\t\treturn tag.outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[url\\]([^\\]]+)\\[\\/url\\]/ig, function(whole, link)\n\t\t{\n\t\t\tlink = Utils.text.htmlspecialcharsback(link);\n\n\t\t\tlet tag = document.createElement('a');\n\t\t\ttag.href = link;\n\t\t\ttag.target = '_blank';\n\t\t\ttag.text = link;\n\n\t\t\tlet allowList = [\n\t\t\t\t\"http:\",\n\t\t\t\t\"https:\",\n\t\t\t\t\"ftp:\",\n\t\t\t\t\"file:\",\n\t\t\t\t\"tel:\",\n\t\t\t\t\"callto:\",\n\t\t\t\t\"mailto:\",\n\t\t\t\t\"skype:\",\n\t\t\t\t\"viber:\",\n\t\t\t];\n\t\t\tif (allowList.indexOf(tag.protocol) <= -1)\n\t\t\t{\n\t\t\t\treturn whole;\n\t\t\t}\n\n\t\t\treturn tag.outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[LIKE\\]/ig, '<span class=\"bx-smile bx-im-smile-like\"></span>');\n\t\ttext = text.replace(/\\[DISLIKE\\]/ig, '<span class=\"bx-smile bx-im-smile-dislike\"></span>');\n\n\t\ttext = text.replace(/\\[BR\\]/ig, '<br/>');\n\t\ttext = text.replace(/\\[([buis])\\](.*?)\\[(\\/[buis])\\]/ig, (whole, open, inner, close) => '<'+open+'>'+inner+'<'+close+'>'); // TODO tag USER\n\n\t\t// this code needs to be ported to im/install/js/im/view/message/body/src/body.js:229\n\t\ttext = text.replace(/\\[CHAT=(imol\\|)?([0-9]{1,})\\](.*?)\\[\\/CHAT\\]/ig, (whole, openlines, chatId, inner) => openlines? inner: '<span class=\"bx-im-mention\" data-type=\"CHAT\" data-value=\"chat'+chatId+'\">'+inner+'</span>'); // TODO tag CHAT\n\n\t\tif (false && Utils.device.isMobile())\n\t\t{\n\t\t\tlet replacements = [];\n\t\t\ttext = text.replace(/\\[CALL(?:=(.+?))?\\](.+?)?\\[\\/CALL\\]/ig, (whole, number, text) => {\n\t\t\t\tlet index = replacements.length;\n\t\t\t\treplacements.push({number, text});\n\t\t\t\treturn `####REPLACEMENT_MARK_${index}####`;\n\t\t\t});\n\n\t\t\ttext = text.replace(/[+]{0,1}(?:[-\\/. ()\\[\\]~;#,]*[0-9]){10,}[^\\n\\r<][-\\/. ()\\[\\]~;#,0-9^]*/g, (number) => {\n\t\t\t\tlet pureNumber = number.replace(/\\D/g, '');\n\t\t\t\treturn `[CALL=${pureNumber}]${number}[/CALL]`;\n\t\t\t});\n\n\t\t\treplacements.forEach((item, index) => {\n\t\t\t\ttext = text.replace(`####REPLACEMENT_MARK_${index}####`, `[CALL=${item.number}]${item.text}[/CALL]`)\n\t\t\t});\n\t\t}\n\n\t\ttext = text.replace(/\\[CALL(?:=(.+?))?\\](.+?)?\\[\\/CALL\\]/ig, (whole, number, text) => '<span class=\"bx-im-mention\" data-type=\"CALL\" data-value=\"'+Utils.text.htmlspecialchars(number)+'\">'+text+'</span>'); // TODO tag CHAT\n\n\t\ttext = text.replace(/\\[PCH=([0-9]{1,})\\](.*?)\\[\\/PCH\\]/ig, (whole, historyId, text) => text); // TODO tag PCH\n\n\t\tlet textElementSize = 0;\n\t\tif (enableBigSmile)\n\t\t{\n\t\t\ttextElementSize = text.replace(/\\[icon\\=([^\\]]*)\\]/ig, '').trim().length;\n\t\t}\n\n\t\ttext = text.replace(/\\[icon\\=([^\\]]*)\\]/ig, (whole) =>\n\t\t{\n\t\t\tlet url = whole.match(/icon\\=(\\S+[^\\s.,> )\\];\\'\\\"!?])/i);\n\t\t\tif (url && url[1])\n\t\t\t{\n\t\t\t\turl = url[1];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet attrs = {'src': url, 'border': 0};\n\n\t\t\tlet size = whole.match(/size\\=(\\d+)/i);\n\t\t\tif (size && size[1])\n\t\t\t{\n\t\t\t\tattrs['width'] = size[1];\n\t\t\t\tattrs['height'] = size[1];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet width = whole.match(/width\\=(\\d+)/i);\n\t\t\t\tif (width && width[1])\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = width[1];\n\t\t\t\t}\n\n\t\t\t\tlet height = whole.match(/height\\=(\\d+)/i);\n\t\t\t\tif (height && height[1])\n\t\t\t\t{\n\t\t\t\t\tattrs['height'] = height[1];\n\t\t\t\t}\n\n\t\t\t\tif (attrs['width'] && !attrs['height'])\n\t\t\t\t{\n\t\t\t\t\tattrs['height'] = attrs['width'];\n\t\t\t\t}\n\t\t\t\telse if (attrs['height'] && !attrs['width'])\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = attrs['height'];\n\t\t\t\t}\n\t\t\t\telse if (attrs['height'] && attrs['width'])\n\t\t\t\t{}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = 20;\n\t\t\t\t\tattrs['height'] = 20;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tattrs['width'] = attrs['width']>100? 100: attrs['width'];\n\t\t\tattrs['height'] = attrs['height']>100? 100: attrs['height'];\n\n\t\t\tif (enableBigSmile && textElementSize === 0 && attrs['width'] === attrs['height'] && attrs['width'] === 20)\n\t\t\t{\n\t\t\t\tattrs['width'] = 40;\n\t\t\t\tattrs['height'] = 40;\n\t\t\t}\n\n\t\t\tlet title = whole.match(/title\\=(.*[^\\s\\]])/i);\n\t\t\tif (title && title[1])\n\t\t\t{\n\t\t\t\ttitle = title[1];\n\t\t\t\tif (title.indexOf('width=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('width='))\n\t\t\t\t}\n\t\t\t\tif (title.indexOf('height=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('height='))\n\t\t\t\t}\n\t\t\t\tif (title.indexOf('size=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('size='))\n\t\t\t\t}\n\t\t\t\tif (title)\n\t\t\t\t{\n\t\t\t\t\tattrs['title'] = Utils.text.htmlspecialchars(title).trim();\n\t\t\t\t\tattrs['alt'] = attrs['title'];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet attributes = '';\n\t\t\tfor (let name in attrs)\n\t\t\t{\n\t\t\t\tif (attrs.hasOwnProperty(name))\n\t\t\t\t{\n\t\t\t\t\tattributes += name+'=\"'+attrs[name]+'\" ';\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\treturn '<img class=\"bx-smile bx-icon\" '+attributes+'>';\n\t\t});\n\n\t\tsendReplacement.forEach((value, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_SEND_'+index+'####', value);\n\t\t});\n\n\t\ttext = text.replace(/\\[SEND(?:=(?:.+?))?\\](?:.+?)?\\[\\/SEND]/ig, (match) =>\n\t\t{\n\t\t\treturn match.replace(/\\[SEND(?:=(.+))?\\](.+?)?\\[\\/SEND]/ig, (whole, command, text) =>\n\t\t\t{\n\t\t\t\tlet html = '';\n\n\t\t\t\ttext = text? text: command;\n\t\t\t\tcommand = (command? command: text).replace('<br />', '\\n');\n\n\t\t\t\tif (!textOnly && text)\n\t\t\t\t{\n\t\t\t\t\ttext = text.replace(/<([\\w]+)[^>]*>(.*?)<\\\\1>/i, \"$2\", text);\n\t\t\t\t\ttext = text.replace(/\\[([\\w]+)[^\\]]*\\](.*?)\\[\\/\\1\\]/i, \"$2\", text);\n\n\t\t\t\t\tcommand = command.split('####REPLACEMENT_PUT_').join('####REPLACEMENT_SP_');\n\n\t\t\t\t\thtml = '<!--IM_COMMAND_START-->' +\n\t\t\t\t\t\t'<span class=\"bx-im-message-command-wrap\">'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command\" data-entity=\"send\">'+text+'</span>'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command-data\">'+command+'</span>'+\n\t\t\t\t\t\t'</span>'+\n\t\t\t\t\t'<!--IM_COMMAND_END-->';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thtml = text;\n\t\t\t\t}\n\n\t\t\t\treturn html;\n\t\t\t});\n\t\t});\n\n\t\tputReplacement.forEach((value, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_PUT_'+index+'####', value);\n\t\t});\n\n\t\ttext = text.replace(/\\[PUT(?:=(?:.+?))?\\](?:.+?)?\\[\\/PUT]/ig, (match) =>\n\t\t{\n\t\t\treturn match.replace(/\\[PUT(?:=(.+))?\\](.+?)?\\[\\/PUT]/ig, (whole, command, text) =>\n\t\t\t{\n\t\t\t\tlet html = '';\n\n\t\t\t\ttext = text? text: command;\n\t\t\t\tcommand = (command? command: text).replace('<br />', '\\n');\n\n\t\t\t\tif (!textOnly && text)\n\t\t\t\t{\n\t\t\t\t\ttext = text.replace(/<([\\w]+)[^>]*>(.*?)<\\/\\1>/i, \"$2\", text);\n\t\t\t\t\ttext = text.replace(/\\[([\\w]+)[^\\]]*\\](.*?)\\[\\/\\1\\]/i, \"$2\", text);\n\n\t\t\t\t\thtml = '<!--IM_COMMAND_START-->' +\n\t\t\t\t\t\t'<span class=\"bx-im-message-command-wrap\">'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command\" data-entity=\"put\">'+text+'</span>'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command-data\">'+command+'</span>'+\n\t\t\t\t\t\t'</span>'+\n\t\t\t\t\t'<!--IM_COMMAND_END-->';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thtml = text;\n\t\t\t\t}\n\n\t\t\t\treturn html;\n\t\t\t});\n\t\t});\n\n\t\tcodeReplacement.forEach((code, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_CODE_'+index+'####',\n\t\t\t\t!textOnly? '<div class=\"bx-im-message-content-code\">'+code+'</div>': code\n\t\t\t)\n\t\t});\n\n\t\tif (sendReplacement.length > 0)\n\t\t{\n\t\t\tdo\n\t\t\t{\n\t\t\t\tsendReplacement.forEach((value, index) => {\n\t\t\t\t\ttext = text.replace('####REPLACEMENT_SEND_'+index+'####', value);\n\t\t\t\t});\n\t\t\t}\n\t\t\twhile (text.includes('####REPLACEMENT_SEND_'));\n\t\t}\n\n\t\ttext = text.split('####REPLACEMENT_SP_').join('####REPLACEMENT_PUT_');\n\n\t\tif (putReplacement.length > 0)\n\t\t{\n\t\t\tdo\n\t\t\t{\n\t\t\t\tputReplacement.forEach((value, index) => {\n\t\t\t\t\ttext = text.replace('####REPLACEMENT_PUT_'+index+'####', value);\n\t\t\t\t});\n\t\t\t}\n\t\t\twhile (text.includes('####REPLACEMENT_PUT_'));\n\t\t}\n\n\t\treturn text;\n\t}\n\n\tstatic hideErrorImage(element)\n\t{\n\t\tif (element.parentNode && element.parentNode)\n\t\t{\n\t\t\telement.parentNode.innerHTML = '<a href=\"'+element.src+'\" target=\"_blank\">'+element.src+'</a>';\n\t\t}\n\t\treturn true;\n\t};\n}\n","/**\n * Bitrix Messenger\n * Dialogues model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {StorageLimit} from \"im.const\";\nimport {Utils} from \"im.lib.utils\";\n\nexport class DialoguesModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'dialogues';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: {},\n\t\t\tsaveDialogList: [],\n\t\t\tsaveChatList: [],\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\thost: null\n\t\t}\n\t}\n\n\tgetElementStateSaveException()\n\t{\n\t\treturn {\n\t\t\twritingList: null,\n\t\t\tquoteId: null\n\t\t}\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tmessageCount: 0,\n\t\t\tunreadId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\treadedList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\ttextareaMessage: \"\",\n\t\t\tquoteId: 0,\n\t\t\teditId: 0,\n\t\t\tinit: false,\n\n\t\t\tname: \"\",\n\t\t\towner: 0,\n\t\t\textranet: false,\n\t\t\tavatar: \"\",\n\t\t\tcolor: \"#17A3EA\",\n\t\t\ttype: \"chat\",\n\t\t\tentityType: \"\",\n\t\t\tentityId: \"\",\n\t\t\tentityData1: \"\",\n\t\t\tentityData2: \"\",\n\t\t\tentityData3: \"\",\n\t\t\tdateCreate: new Date(),\n\t\t\trestrictions: {\n\t\t\t\tavatar: true,\n\t\t\t\textend: true,\n\t\t\t\tleave: true,\n\t\t\t\tleaveOwner: true,\n\t\t\t\trename: true\n\t\t\t},\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\tgetByChatId: state => chatId =>\n\t\t\t{\n\t\t\t\tchatId = parseInt(chatId);\n\n\t\t\t\tfor (let dialogId in state.collection)\n\t\t\t\t{\n\t\t\t\t\tif (!state.collection.hasOwnProperty(dialogId))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (state.collection[dialogId].chatId === chatId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetQuoteId: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\tgetEditId: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].editId;\n\t\t\t},\n\t\t\tcanSaveChat: state => chatId =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(chatId))\n\t\t\t\t{\n\t\t\t\t\tchatId = parseInt(chatId);\n\t\t\t\t}\n\t\t\t\treturn state.saveChatList.includes(parseInt(chatId));\n\t\t\t},\n\t\t\tcanSaveDialog: state => dialogId =>\n\t\t\t{\n\t\t\t\treturn state.saveDialogList.includes(dialogId.toString());\n\t\t\t},\n\t\t\tisPrivateDialog: state => dialogId =>\n\t\t\t{\n\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\treturn state.collection[dialogId.toString()] && state.collection[dialogId].type === 'private';\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(dialog => {\n\t\t\t\t\t\treturn Object.assign(\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\tthis.validate(Object.assign({}, dialog), {host: store.state.host}),\n\t\t\t\t\t\t\t{init: true}\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\tresult.push(Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tthis.validate(Object.assign({}, payload), {host: store.state.host}),\n\t\t\t\t\t\t{init: true}\n\t\t\t\t\t));\n\t\t\t\t\tpayload = result;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tfields : this.validate(Object.assign({}, payload.fields), {host: store.state.host})\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.dialogId);\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tupdateWriting: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet index = store.state.collection[payload.dialogId].writingList.findIndex(el => el.userId === payload.userId);\n\t\t\t\tif (payload.action)\n\t\t\t\t{\n\t\t\t\t\tif (index >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tlet writingList = [].concat(store.state.collection[payload.dialogId].writingList);\n\t\t\t\t\t\twritingList.unshift({\n\t\t\t\t\t\t\tuserId: payload.userId,\n\t\t\t\t\t\t\tuserName: payload.userName,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tactionName: 'updateWriting/1',\n\t\t\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\t\t\tfields : this.validate({writingList}, {host: store.state.host})\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (index >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet writingList = store.state.collection[payload.dialogId].writingList.filter(el => el.userId !== payload.userId);\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tactionName: 'updateWriting/2',\n\t\t\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\t\t\tfields : this.validate({writingList}, {host: store.state.host})\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tupdateReaded: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet readedList = store.state.collection[payload.dialogId].readedList.filter(el => el.userId !== payload.userId);\n\n\t\t\t\tif (payload.action)\n\t\t\t\t{\n\t\t\t\t\treadedList.push({\n\t\t\t\t\t\tuserId: payload.userId,\n\t\t\t\t\t\tuserName: payload.userName || '',\n\t\t\t\t\t\tmessageId: payload.messageId,\n\t\t\t\t\t\tdate: payload.date || (new Date()),\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'updateReaded',\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tfields : this.validate({readedList}, {host: store.state.host})\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tincreaseCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet counter = store.state.collection[payload.dialogId].counter;\n\t\t\t\tif (counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet increasedCounter = counter + payload.count;\n\t\t\t\tif (increasedCounter > 100)\n\t\t\t\t{\n\t\t\t\t\tincreasedCounter = 100;\n\t\t\t\t}\n\n\t\t\t\tconst userId = store.rootState.application?.common.userId;\n\t\t\t\tconst dialogMuted = userId && store.state.collection[payload.dialogId].muteList.includes(userId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseCounter',\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tdialogMuted,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: increasedCounter,\n\t\t\t\t\t\tpreviousCounter: counter\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tdecreaseCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet counter = store.state.collection[payload.dialogId].counter;\n\t\t\t\tif (counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet decreasedCounter = counter - payload.count;\n\t\t\t\tif (decreasedCounter < 0)\n\t\t\t\t{\n\t\t\t\t\tdecreasedCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tlet unreadId = payload.unreadId > store.state.collection[payload.dialogId].unreadId? payload.unreadId: store.state.collection[payload.dialogId].unreadId;\n\n\t\t\t\tif (\n\t\t\t\t\tstore.state.collection[payload.dialogId].unreadId !== unreadId\n\t\t\t\t\t|| store.state.collection[payload.dialogId].counter !== decreasedCounter\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst previousCounter = store.state.collection[payload.dialogId].counter;\n\t\t\t\t\tif (decreasedCounter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tunreadId = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst userId = store.rootState.application?.common.userId;\n\t\t\t\t\tconst dialogMuted = userId && store.state.collection[payload.dialogId].muteList.includes(userId);\n\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tactionName: 'decreaseCounter',\n\t\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\t\tdialogMuted,\n\t\t\t\t\t\tfields : {\n\t\t\t\t\t\t\tcounter: decreasedCounter,\n\t\t\t\t\t\t\tpreviousCounter,\n\t\t\t\t\t\t\tunreadId\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tincreaseMessageCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst currentCounter = store.state.collection[payload.dialogId].messageCount;\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseMessageCount',\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tfields : {\n\t\t\t\t\t\tmessageCount: currentCounter + payload.count,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsaveDialog: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('saveDialog', {\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\t\t\t},\n\t\t\tsaveDialog: (state, payload) =>\n\t\t\t{\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update this flag\n\t\t\t\tif (!(payload.chatId > 0 && payload.dialogId.length > 0))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet saveDialogList = state.saveDialogList.filter(function(element) {\n\t\t\t\t\treturn element !== payload.dialogId;\n\t\t\t\t});\n\n\t\t\t\tsaveDialogList.unshift(payload.dialogId);\n\n\t\t\t\tsaveDialogList = saveDialogList.slice(0, StorageLimit.dialogues);\n\n\t\t\t\tif (state.saveDialogList.join(',') === saveDialogList.join(','))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstate.saveDialogList = saveDialogList;\n\n\n\t\t\t\tlet saveChatList = state.saveChatList.filter(function(element) {\n\t\t\t\t\treturn element !== payload.chatId;\n\t\t\t\t});\n\n\t\t\t\tsaveChatList.unshift(payload.chatId);\n\n\t\t\t\tstate.saveChatList = saveChatList.slice(0, StorageLimit.dialogues);\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let element of payload)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {dialogId: element.dialogId});\n\n\t\t\t\t\tstate.collection[element.dialogId] = Object.assign(\n\t\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\t\tstate.collection[element.dialogId],\n\t\t\t\t\t\telement\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update cache\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.dialogId] = Object.assign(\n\t\t\t\t\tstate.collection[payload.dialogId],\n\t\t\t\t\tpayload.fields\n\t\t\t\t);\n\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update cache\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.dialogId];\n\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update cache\n\t\t\t\tthis.saveState(state);\n\t\t\t}\n\t\t};\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof state.collection[payload.dialogId] !== 'undefined')\n\t\t{\n\t\t\treturn true\n\t\t}\n\n\t\tVue.set(state.collection, payload.dialogId, this.getElementState());\n\n\t\tif (payload.fields)\n\t\t{\n\t\t\tstate.collection[payload.dialogId] = Object.assign(\n\t\t\t\tstate.collection[payload.dialogId],\n\t\t\t\tthis.validate(Object.assign({}, payload.fields), {host: state.host})\n\t\t\t);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 100;\n\t}\n\n\tsaveState(state = {})\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t\tsaveDialogList: [].concat(state.saveDialogList),\n\t\t\t\tsaveChatList: [].concat(state.saveChatList),\n\t\t\t};\n\n\t\t\tstate.saveDialogList.forEach(dialogId => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t\treturn false;\n\n\t\t\t\tstoredState.collection[dialogId] = Object.assign(\n\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\tthis.cloneState(state.collection[dialogId], this.getElementStateSaveException())\n\t\t\t\t);\n\t\t\t});\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tvalidate(fields, options = {})\n\t{\n\t\tconst result = {};\n\n\t\toptions.host = options.host || this.getState().host;\n\n\t\tif (typeof fields.dialog_id !== 'undefined')\n\t\t{\n\t\t\tfields.dialogId = fields.dialog_id;\n\t\t}\n\t\tif (typeof fields.dialogId === \"number\" || typeof fields.dialogId === \"string\")\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (typeof fields.chat_id !== 'undefined')\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\telse if (typeof fields.id !== 'undefined')\n\t\t{\n\t\t\tfields.chatId = fields.id;\n\t\t}\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\t\tif (typeof fields.quoteId === \"number\")\n\t\t{\n\t\t\tresult.quoteId = parseInt(fields.quoteId);\n\t\t}\n\t\tif (typeof fields.editId === \"number\")\n\t\t{\n\t\t\tresult.editId = parseInt(fields.editId);\n\t\t}\n\n\t\tif (typeof fields.counter === \"number\" || typeof fields.counter === \"string\")\n\t\t{\n\t\t\tresult.counter = parseInt(fields.counter);\n\t\t}\n\n\t\tif (typeof fields.user_counter === \"number\" || typeof fields.user_counter === \"string\")\n\t\t{\n\t\t\tresult.userCounter = parseInt(fields.user_counter);\n\t\t}\n\t\tif (typeof fields.userCounter === \"number\" || typeof fields.userCounter === \"string\")\n\t\t{\n\t\t\tresult.userCounter = parseInt(fields.userCounter);\n\t\t}\n\n\t\tif (typeof fields.message_count === \"number\" || typeof fields.message_count === \"string\")\n\t\t{\n\t\t\tresult.messageCount = parseInt(fields.message_count);\n\t\t}\n\t\tif (typeof fields.messageCount === \"number\" || typeof fields.messageCount === \"string\")\n\t\t{\n\t\t\tresult.messageCount = parseInt(fields.messageCount);\n\t\t}\n\n\t\tif (typeof fields.unread_id !== 'undefined')\n\t\t{\n\t\t\tfields.unreadId = fields.unread_id;\n\t\t}\n\t\tif (typeof fields.unreadId === \"number\" || typeof fields.unreadId === \"string\")\n\t\t{\n\t\t\tresult.unreadId = parseInt(fields.unreadId);\n\t\t}\n\n\t\tif (typeof fields.last_message_id !== 'undefined')\n\t\t{\n\t\t\tfields.lastMessageId = fields.last_message_id;\n\t\t}\n\t\tif (typeof fields.lastMessageId === \"number\" || typeof fields.lastMessageId === \"string\")\n\t\t{\n\t\t\tresult.lastMessageId = parseInt(fields.lastMessageId);\n\t\t}\n\n\t\tif (typeof fields.readed_list !== 'undefined')\n\t\t{\n\t\t\tfields.readedList = fields.readed_list;\n\t\t}\n\t\tif (typeof fields.readedList !== 'undefined')\n\t\t{\n\t\t\tresult.readedList = [];\n\n\t\t\tif (fields.readedList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.readedList.forEach(element =>\n\t\t\t\t{\n\t\t\t\t\tlet record = {};\n\t\t\t\t\tif (typeof element.user_id !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.userId = element.user_id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof element.user_name !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.userName = element.user_name;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof element.message_id !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.messageId = element.message_id;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!element.userId || !element.userName || !element.messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\trecord.userId = parseInt(element.userId);\n\t\t\t\t\trecord.userName = element.userName.toString();\n\t\t\t\t\trecord.messageId = parseInt(element.messageId);\n\n\t\t\t\t\trecord.date = Utils.date.cast(element.date);\n\n\t\t\t\t\tresult.readedList.push(record);\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.writing_list !== 'undefined')\n\t\t{\n\t\t\tfields.writingList = fields.writing_list;\n\t\t}\n\t\tif (typeof fields.writingList !== 'undefined')\n\t\t{\n\t\t\tresult.writingList = [];\n\n\t\t\tif (fields.writingList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.writingList.forEach(element =>\n\t\t\t\t{\n\t\t\t\t\tlet record = {};\n\n\t\t\t\t\tif (!element.userId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\trecord.userId = parseInt(element.userId);\n\t\t\t\t\trecord.userName = Utils.text.htmlspecialcharsback(element.userName);\n\n\t\t\t\t\tresult.writingList.push(record);\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.manager_list !== 'undefined')\n\t\t{\n\t\t\tfields.managerList = fields.manager_list;\n\t\t}\n\t\tif (typeof fields.managerList !== 'undefined')\n\t\t{\n\t\t\tresult.managerList = [];\n\n\t\t\tif (fields.managerList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.managerList.forEach(userId =>\n\t\t\t\t{\n\t\t\t\t\tuserId = parseInt(userId);\n\t\t\t\t\tif (userId > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.managerList.push(userId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.mute_list !== 'undefined')\n\t\t{\n\t\t\tfields.muteList = fields.mute_list;\n\t\t}\n\t\tif (typeof fields.muteList !== 'undefined')\n\t\t{\n\t\t\tresult.muteList = [];\n\n\t\t\tif (fields.muteList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.muteList.forEach(userId =>\n\t\t\t\t{\n\t\t\t\t\tuserId = parseInt(userId);\n\t\t\t\t\tif (userId > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.muteList.push(userId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (typeof fields.muteList === 'object')\n\t\t\t{\n\t\t\t\tObject.entries(fields.muteList).forEach(entry => {\n\t\t\t\t\tif (entry[1] === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst userId = parseInt(entry[0]);\n\t\t\t\t\t\tif (userId > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.muteList.push(userId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.textareaMessage !== 'undefined')\n\t\t{\n\t\t\tresult.textareaMessage = fields.textareaMessage.toString();\n\t\t}\n\n\t\tif (typeof fields.title !== 'undefined')\n\t\t{\n\t\t\tfields.name = fields.title;\n\t\t}\n\t\tif (typeof fields.name === \"string\" || typeof fields.name === \"number\")\n\t\t{\n\t\t\tresult.name = Utils.text.htmlspecialcharsback(fields.name.toString());\n\t\t}\n\n\t\tif (typeof fields.owner !== 'undefined')\n\t\t{\n\t\t\tfields.ownerId = fields.owner;\n\t\t}\n\t\tif (typeof fields.ownerId === \"number\" || typeof fields.ownerId === \"string\")\n\t\t{\n\t\t\tresult.ownerId = parseInt(fields.ownerId);\n\t\t}\n\n\t\tif (typeof fields.extranet === \"boolean\")\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (typeof fields.avatar === 'string')\n\t\t{\n\t\t\tlet avatar;\n\n\t\t\tif (!fields.avatar || fields.avatar.endsWith('/js/im/images/blank.gif'))\n\t\t\t{\n\t\t\t\tavatar = '';\n\t\t\t}\n\t\t\telse if (fields.avatar.startsWith('http'))\n\t\t\t{\n\t\t\t\tavatar = fields.avatar;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatar = options.host + fields.avatar;\n\t\t\t}\n\n\t\t\tif (avatar)\n\t\t\t{\n\t\t\t\tresult.avatar = encodeURI(avatar);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.color === \"string\")\n\t\t{\n\t\t\tresult.color = fields.color.toString();\n\t\t}\n\n\t\tif (typeof fields.type === \"string\")\n\t\t{\n\t\t\tresult.type = fields.type.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_type !== 'undefined')\n\t\t{\n\t\t\tfields.entityType = fields.entity_type;\n\t\t}\n\t\tif (typeof fields.entityType === \"string\")\n\t\t{\n\t\t\tresult.entityType = fields.entityType.toString();\n\t\t}\n\t\tif (typeof fields.entity_id !== 'undefined')\n\t\t{\n\t\t\tfields.entityId = fields.entity_id;\n\t\t}\n\t\tif (typeof fields.entityId === \"string\" || typeof fields.entityId === \"number\")\n\t\t{\n\t\t\tresult.entityId = fields.entityId.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_data_1 !== 'undefined')\n\t\t{\n\t\t\tfields.entityData1 = fields.entity_data_1;\n\t\t}\n\t\tif (typeof fields.entityData1 === \"string\")\n\t\t{\n\t\t\tresult.entityData1 = fields.entityData1.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_data_2 !== 'undefined')\n\t\t{\n\t\t\tfields.entityData2 = fields.entity_data_2;\n\t\t}\n\t\tif (typeof fields.entityData2 === \"string\")\n\t\t{\n\t\t\tresult.entityData2 = fields.entityData2.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_data_3 !== 'undefined')\n\t\t{\n\t\t\tfields.entityData3 = fields.entity_data_3;\n\t\t}\n\t\tif (typeof fields.entityData3 === \"string\")\n\t\t{\n\t\t\tresult.entityData3 = fields.entityData3.toString();\n\t\t}\n\n\t\tif (typeof fields.date_create !== 'undefined')\n\t\t{\n\t\t\tfields.dateCreate = fields.date_create;\n\t\t}\n\n\t\tif (typeof fields.dateCreate !== \"undefined\")\n\t\t{\n\t\t\tresult.dateCreate = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (typeof fields.dateLastOpen !== \"undefined\")\n\t\t{\n\t\t\tresult.dateLastOpen = Utils.date.cast(fields.dateLastOpen);\n\t\t}\n\n\t\tif (typeof fields.restrictions === 'object' && fields.restrictions)\n\t\t{\n\t\t\tresult.restrictions = {};\n\n\t\t\tif (typeof fields.restrictions.AVATAR === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.avatar = fields.restrictions.AVATAR;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.EXTEND === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.extend = fields.restrictions.EXTEND;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.LEAVE === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.leave = fields.restrictions.LEAVE;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.LEAVE_OWNER === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.leaveOwner = fields.restrictions.LEAVE_OWNER;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.RENAME === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.rename = fields.restrictions.RENAME;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.public === 'object' && fields.public)\n\t\t{\n\t\t\tresult.public = {};\n\n\t\t\tif (typeof fields.public.code === 'string')\n\t\t\t{\n\t\t\t\tresult.public.code = fields.public.code;\n\t\t\t}\n\n\t\t\tif (typeof fields.public.link === 'string')\n\t\t\t{\n\t\t\t\tresult.public.link = fields.public.link;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}","/**\n * Bitrix Messenger\n * Users model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {Utils} from \"im.lib.utils\";\n\nexport class UsersModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetState()\n\t{\n\t\tthis.startOnlineCheckInterval();\n\n\t\treturn {\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: []\n\t\t}\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tlet {\n\t\t\tid = 0,\n\t\t\tname = this.getVariable('default.name', ''),\n\t\t\tfirstName = this.getVariable('default.name', ''),\n\t\t\tlastName = '',\n\t\t} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname,\n\t\t\tfirstName,\n\t\t\tlastName,\n\t\t\tworkPosition: \"\",\n\t\t\tcolor: \"#048bd0\",\n\t\t\tavatar: \"\",\n\t\t\tgender: \"M\",\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: \"default\",\n\t\t\tstatus: \"online\",\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: \"\",\n\t\t\t\tpersonalMobile: \"\",\n\t\t\t\tpersonalPhone: \"\",\n\t\t\t\tinnerPhone: \"\",\n\t\t\t},\n\t\t\tinit: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (userId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tuserId = parseInt(userId);\n\n\t\t\t\tif (userId <= 0)\n\t\t\t\t{\n\t\t\t\t\tif (getTemporary)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserId = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t!getTemporary\n\t\t\t\t\t&& (!state.collection[userId] || !state.collection[userId].init)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[userId])\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[userId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\tgetList: state => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({id}));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(user => {\n\t\t\t\t\t\treturn Object.assign(\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\t\t\tthis.validate(Object.assign({}, user), {host: store.state.host}),\n\t\t\t\t\t\t\t{init: true}\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\tresult.push(Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\t\tthis.validate(Object.assign({}, payload), {host: store.state.host}),\n\t\t\t\t\t\t{init: true}\n\t\t\t\t\t));\n\t\t\t\t\tpayload = result;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = parseInt(payload.id);\n\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.id] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.id].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tfields : this.validate(Object.assign({}, payload.fields), {host: store.state.host})\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsaveState: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('saveState', {});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let element of payload)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {id: element.id});\n\n\t\t\t\t\tstate.collection[element.id] = Object.assign(state.collection[element.id], element);\n\n\t\t\t\t\tlet status = Utils.user.getOnlineStatus(element);\n\t\t\t\t\tif (status.isOnline)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.id].isOnline = true;\n\t\t\t\t\t\tthis.addToOnlineList(state, element.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet mobileStatus = Utils.user.isMobileActive(element);\n\t\t\t\t\tif (mobileStatus)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.id].isMobileOnline = true;\n\t\t\t\t\t\tthis.addToMobileOnlineList(state, element.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (element.birthday)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet today = Utils.date.format(new Date(), \"d-m\");\n\t\t\t\t\t\tif (element.birthday === today)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collection[element.id].isBirthday = true;\n\n\t\t\t\t\t\t\tlet timeToNextMidnight = this.getTimeToNextMidnight();\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tstate.collection[element.id].isBirthday = false;\n\t\t\t\t\t\t\t}, timeToNextMidnight);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (element.absent)\n\t\t\t\t\t{\n\t\t\t\t\t\telement.isAbsent = true;\n\n\t\t\t\t\t\tif (!state.absentList.includes(element.id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.addToAbsentList(state, element.id);\n\n\t\t\t\t\t\t\tlet timeToNextMidnight = this.getTimeToNextMidnight();\n\t\t\t\t\t\t\tlet timeToNextDay = 1000*60*60*24;\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tsetInterval(() => this.startAbsentCheckInterval(state), timeToNextDay);\n\t\t\t\t\t\t\t}, timeToNextMidnight);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tif (typeof payload.fields.lastActivityDate !== 'undefined' && state.collection[payload.id].lastActivityDate)\n\t\t\t\t{\n\t\t\t\t\tlet lastActivityDate = state.collection[payload.id].lastActivityDate.getTime();\n\t\t\t\t\tlet newActivityDate = payload.fields.lastActivityDate.getTime();\n\t\t\t\t\tif (newActivityDate > lastActivityDate)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet status = Utils.user.getOnlineStatus(payload.fields);\n\t\t\t\t\t\tif (status.isOnline)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collection[payload.id].isOnline = true;\n\t\t\t\t\t\t\tthis.addToOnlineList(state, payload.fields.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\ttypeof payload.fields.mobileLastDate !== 'undefined'\n\t\t\t\t\t&& state.collection[payload.id].mobileLastDate !== payload.fields.mobileLastDate\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tlet mobileStatus = Utils.user.isMobileActive(payload.fields);\n\t\t\t\t\tif (mobileStatus)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.id].isMobileOnline = true;\n\t\t\t\t\t\tthis.addToMobileOnlineList(state, payload.fields.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.id] = Object.assign(\n\t\t\t\t\tstate.collection[payload.id],\n\t\t\t\t\tpayload.fields\n\t\t\t\t);\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tsaveState: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t}\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof state.collection[payload.id] !== 'undefined')\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tVue.set(state.collection, payload.id, this.getElementState());\n\n\t\treturn true;\n\t}\n\n\tgetSaveUserList()\n\t{\n\t\tif (!this.db)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!this.store.getters['messages/getSaveUserList'])\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tlet list = this.store.getters['messages/getSaveUserList']();\n\t\tif (!list)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 250;\n\t}\n\n\tsaveState(state)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet list = this.getSaveUserList();\n\t\t\tif (!list)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t};\n\n\t\t\tlet exceptionList = {\n\t\t\t\tabsent: true,\n\t\t\t\tidle: true,\n\t\t\t\tmobileLastDate: true,\n\t\t\t\tlastActivityDate: true,\n\t\t\t};\n\n\t\t\tfor (let chatId in list)\n\t\t\t{\n\t\t\t\tif (!list.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlist[chatId].forEach(userId =>\n\t\t\t\t{\n\t\t\t\t\tif (!state.collection[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tstoredState.collection[userId] = this.cloneState(state.collection[userId], exceptionList);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tvalidate(fields, options = {})\n\t{\n\t\tconst result = {};\n\n\t\toptions.host = options.host || this.getState().host;\n\n\t\tif (typeof fields.id === \"number\" || typeof fields.id === \"string\")\n\t\t{\n\t\t\tresult.id = parseInt(fields.id);\n\t\t}\n\n\t\tif (typeof fields.first_name !== \"undefined\")\n\t\t{\n\t\t\tfields.firstName = Utils.text.htmlspecialcharsback(fields.first_name);\n\t\t}\n\t\tif (typeof fields.last_name !== \"undefined\")\n\t\t{\n\t\t\tfields.lastName = Utils.text.htmlspecialcharsback(fields.last_name);\n\t\t}\n\t\tif (typeof fields.name === \"string\" || typeof fields.name === \"number\")\n\t\t{\n\t\t\tfields.name = Utils.text.htmlspecialcharsback(fields.name.toString());\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (typeof fields.firstName === \"string\" || typeof fields.firstName === \"number\")\n\t\t{\n\t\t\tresult.firstName = Utils.text.htmlspecialcharsback(fields.firstName.toString());\n\t\t}\n\t\tif (typeof fields.lastName === \"string\" || typeof fields.lastName === \"number\")\n\t\t{\n\t\t\tresult.lastName = Utils.text.htmlspecialcharsback(fields.lastName.toString());\n\t\t}\n\n\t\tif (typeof fields.work_position !== \"undefined\")\n\t\t{\n\t\t\tfields.workPosition = fields.work_position;\n\t\t}\n\t\tif (typeof fields.workPosition === \"string\" || typeof fields.workPosition === \"number\")\n\t\t{\n\t\t\tresult.workPosition = fields.workPosition.toString();\n\t\t}\n\n\t\tif (typeof fields.color === \"string\")\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (typeof fields.avatar === 'string')\n\t\t{\n\t\t\tlet avatar;\n\n\t\t\tif (!fields.avatar || fields.avatar.endsWith('/js/im/images/blank.gif'))\n\t\t\t{\n\t\t\t\tavatar = '';\n\t\t\t}\n\t\t\telse if (fields.avatar.startsWith('http'))\n\t\t\t{\n\t\t\t\tavatar = fields.avatar;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatar = options.host + fields.avatar;\n\t\t\t}\n\n\t\t\tif (avatar)\n\t\t\t{\n\t\t\t\tresult.avatar = encodeURI(avatar);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.gender !== 'undefined')\n\t\t{\n\t\t\tresult.gender = fields.gender === 'F'? 'F': 'M';\n\t\t}\n\n\t\tif (typeof fields.birthday === \"string\")\n\t\t{\n\t\t\tresult.birthday = fields.birthday;\n\t\t}\n\n\t\tif (typeof fields.extranet === \"boolean\")\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (typeof fields.network === \"boolean\")\n\t\t{\n\t\t\tresult.network = fields.network;\n\t\t}\n\n\t\tif (typeof fields.bot === \"boolean\")\n\t\t{\n\t\t\tresult.bot = fields.bot;\n\t\t}\n\n\t\tif (typeof fields.connector === \"boolean\")\n\t\t{\n\t\t\tresult.connector = fields.connector;\n\t\t}\n\n\t\tif (typeof fields.external_auth_id !== \"undefined\")\n\t\t{\n\t\t\tfields.externalAuthId = fields.external_auth_id;\n\t\t}\n\t\tif (typeof fields.externalAuthId === \"string\" && fields.externalAuthId)\n\t\t{\n\t\t\tresult.externalAuthId = fields.externalAuthId;\n\t\t}\n\n\t\tif (typeof fields.status === \"string\")\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (typeof fields.idle !== \"undefined\")\n\t\t{\n\t\t\tresult.idle = Utils.date.cast(fields.idle, false);\n\t\t}\n\t\tif (typeof fields.last_activity_date !== \"undefined\")\n\t\t{\n\t\t\tfields.lastActivityDate = fields.last_activity_date;\n\t\t}\n\t\tif (typeof fields.lastActivityDate !== \"undefined\")\n\t\t{\n\t\t\tresult.lastActivityDate = Utils.date.cast(fields.lastActivityDate, false);\n\t\t}\n\t\tif (typeof fields.mobile_last_date !== \"undefined\")\n\t\t{\n\t\t\tfields.mobileLastDate = fields.mobile_last_date;\n\t\t}\n\t\tif (typeof fields.mobileLastDate !== \"undefined\")\n\t\t{\n\t\t\tresult.mobileLastDate = Utils.date.cast(fields.mobileLastDate, false);\n\t\t}\n\n\t\tif (typeof fields.absent !== \"undefined\")\n\t\t{\n\t\t\tresult.absent = Utils.date.cast(fields.absent, false);\n\t\t}\n\n\t\tif (typeof fields.departments !== 'undefined')\n\t\t{\n\t\t\tresult.departments = [];\n\n\t\t\tif (fields.departments instanceof Array)\n\t\t\t{\n\t\t\t\tfields.departments.forEach(departmentId =>\n\t\t\t\t{\n\t\t\t\t\tdepartmentId = parseInt(departmentId);\n\t\t\t\t\tif (departmentId > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.departments.push(departmentId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.phones === 'object' && fields.phones)\n\t\t{\n\t\t\tresult.phones = {};\n\n\t\t\tif (typeof fields.phones.work_phone !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.workPhone = fields.phones.work_phone;\n\t\t\t}\n\t\t\tif (typeof fields.phones.workPhone === 'string' || typeof fields.phones.workPhone === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.workPhone = fields.phones.workPhone.toString();\n\t\t\t}\n\n\t\t\tif (typeof fields.phones.personal_mobile !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.personalMobile = fields.phones.personal_mobile;\n\t\t\t}\n\t\t\tif (typeof fields.phones.personalMobile === 'string' || typeof fields.phones.personalMobile === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.personalMobile = fields.phones.personalMobile.toString();\n\t\t\t}\n\n\t\t\tif (typeof fields.phones.personal_phone !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.personalPhone = fields.phones.personal_phone;\n\t\t\t}\n\t\t\tif (typeof fields.phones.personalPhone === 'string' || typeof fields.phones.personalPhone === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.personalPhone = fields.phones.personalPhone.toString();\n\t\t\t}\n\n\t\t\tif (typeof fields.phones.inner_phone !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.innerPhone = fields.phones.inner_phone;\n\t\t\t}\n\t\t\tif (typeof fields.phones.innerPhone === 'string' || typeof fields.phones.innerPhone === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.innerPhone = fields.phones.innerPhone.toString();\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\taddToOnlineList(state, id)\n\t{\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(state, id)\n\t{\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(state, id)\n\t{\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tgetTimeToNextMidnight()\n\t{\n\t\tlet nextMidnight = new Date(new Date().setHours(24,0,0)).getTime();\n\t\treturn nextMidnight - new Date();\n\t}\n\n\tstartAbsentCheckInterval(state)\n\t{\n\t\tfor (let userId of state.absentList)\n\t\t{\n\t\t\tlet user = state.collection[userId];\n\n\t\t\tif (!user)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet currentTime = new Date().getTime();\n\t\t\tlet absentEnd = new Date(state.collection[userId].absent).getTime();\n\n\t\t\tif (absentEnd <= currentTime)\n\t\t\t{\n\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\treturn element !== userId;\n\t\t\t\t});\n\t\t\t\tuser.isAbsent = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tconst intervalTime = 60000;\n\n\t\tsetInterval(() => {\n\t\t\tfor (let userId of this.store.state.users.onlineList)\n\t\t\t{\n\t\t\t\tlet user = this.store.state.users.collection[userId];\n\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet status = Utils.user.getOnlineStatus(user);\n\t\t\t\tif (status.isOnline)\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tthis.store.state.users.onlineList = this.store.state.users.onlineList.filter(element => {\n\t\t\t\t\t\treturn element !== userId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (let userId of this.store.state.users.mobileOnlineList)\n\t\t\t{\n\t\t\t\tlet user = this.store.state.users.collection[userId];\n\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet mobileStatus = Utils.user.isMobileActive(user);\n\t\t\t\tif (mobileStatus)\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tthis.store.state.users.mobileOnlineList = this.store.state.users.mobileOnlineList.filter(element => {\n\t\t\t\t\t\treturn element !== userId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}, intervalTime);\n\t}\n}","/**\n * Bitrix Messenger\n * Files model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {FileStatus, FileType, MutationType} from 'im.const';\nimport {Utils} from \"im.lib.utils\";\n\nexport class FilesModel extends VuexBuilderModel\n{\n\tstatic maxDiskFileSize = 5242880;\n\n\tgetName()\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcreated: 0,\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: {},\n\t\t\tindex: {},\n\t\t}\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tlet {\n\t\t\tid = 0,\n\t\t\tchatId = 0,\n\t\t\tname = this.getVariable('default.name', ''),\n\t\t} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tchatId,\n\t\t\tname,\n\t\t\ttemplateId: id,\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: \"\",\n\t\t\ticon: \"empty\",\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: \"\",\n\t\t\turlPreview: \"\",\n\t\t\turlShow: \"\",\n\t\t\turlDownload: \"\",\n\t\t\tinit: false,\n\t\t\tviewerAttrs: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (chatId, fileId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tif (!chatId || !fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!state.index[chatId] || !state.index[chatId][fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.index[chatId][fileId].init)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.index[chatId][fileId];\n\t\t\t},\n\t\t\tgetList: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.index[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.index[chatId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload), {host: store.state.host});\n\t\t\t\tresult.id = 'temporary' + (new Date).getTime() + store.state.created;\n\t\t\t\tresult.templateId = result.id;\n\t\t\t\tresult.init = true;\n\n\t\t\t\tstore.commit('add', Object.assign({}, this.getElementState(), result));\n\n\t\t\t\treturn result.id;\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\t\tlet result = this.validate(Object.assign({}, file), {host: store.state.host});\n\t\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\t\treturn Object.assign({}, this.getElementState(), result, {init: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.validate(Object.assign({}, payload), {host: store.state.host});\n\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\tpayload = [];\n\t\t\t\t\tpayload.push(\n\t\t\t\t\t\tObject.assign({}, this.getElementState(), result, {init: true})\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setAfter,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetBefore: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\t\tlet result = this.validate(Object.assign({}, file), {host: store.state.host});\n\t\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\t\treturn Object.assign({}, this.getElementState(), result, {init: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.validate(Object.assign({}, payload), {host: store.state.host});\n\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\tpayload = [];\n\t\t\t\t\tpayload.push(\n\t\t\t\t\t\tObject.assign({}, this.getElementState(), result, {init: true})\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tactionName: 'setBefore',\n\t\t\t\t\tinsertType : MutationType.setBefore,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload.fields), {host: store.state.host});\n\n\t\t\t\tstore.commit('initCollection', {chatId: payload.chatId});\n\n\t\t\t\tlet index = store.state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\tif (index < 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\tindex : index,\n\t\t\t\t\tfields : result\n\t\t\t\t});\n\n\t\t\t\tif (payload.fields.blink)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\t\tfields : {blink: false}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsaveState: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('saveState', {});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.chatId].push(payload);\n\t\t\t\tstate.index[payload.chatId][payload.id] = payload;\n\n\t\t\t\tstate.created += 1;\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let element of payload.data)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {chatId: element.chatId});\n\n\t\t\t\t\tlet index = state.collection[element.chatId].findIndex(el => el.id === element.id);\n\t\t\t\t\tif (index > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete element.templateId;\n\t\t\t\t\t\tstate.collection[element.chatId][index] = Object.assign(state.collection[element.chatId][index], element);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setBefore)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].unshift(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].push(element);\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.index[element.chatId][element.id] = element;\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tlet index = -1;\n\t\t\t\tif (typeof payload.index !== 'undefined' && state.collection[payload.chatId][payload.index])\n\t\t\t\t{\n\t\t\t\t\tindex = payload.index;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tindex = state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\t}\n\n\t\t\t\tif (index >= 0)\n\t\t\t\t{\n\t\t\t\t\tdelete payload.fields.templateId;\n\t\t\t\t\tlet element = Object.assign(\n\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\tpayload.fields\n\t\t\t\t\t);\n\t\t\t\t\tstate.collection[payload.chatId][index] = element;\n\t\t\t\t\tstate.index[payload.chatId][element.id] = element;\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => element.id !== payload.id);\n\t\t\t\tdelete state.index[payload.chatId][payload.id];\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tsaveState: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t}\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof state.collection[payload.chatId] !== 'undefined')\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tVue.set(state.collection, payload.chatId, []);\n\t\tVue.set(state.index, payload.chatId, {});\n\n\t\treturn true;\n\t}\n\n\tgetLoadedState(state)\n\t{\n\t\tif (!state || typeof state !== 'object')\n\t\t{\n\t\t\treturn state;\n\t\t}\n\n\t\tif (typeof state.collection !== 'object')\n\t\t{\n\t\t\treturn state;\n\t\t}\n\n\t\tstate.index = {};\n\n\t\tfor (let chatId in state.collection)\n\t\t{\n\t\t\tif (!state.collection.hasOwnProperty(chatId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tstate.index[chatId] = {};\n\n\t\t\tstate.collection[chatId]\n\t\t\t\t.filter(file => file != null)\n\t\t\t\t.forEach(file => {\n\t\t\t\t\tstate.index[chatId][file.id] = file;\n\t\t\t});\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tgetSaveFileList()\n\t{\n\t\tif (!this.db)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!this.store.getters['messages/getSaveFileList'])\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tlet list = this.store.getters['messages/getSaveFileList']();\n\t\tif (!list)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 250;\n\t}\n\n\tsaveState(state)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet list = this.getSaveFileList();\n\t\t\tif (!list)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t};\n\n\t\t\tfor (let chatId in list)\n\t\t\t{\n\t\t\t\tif (!list.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlist[chatId].forEach(fileId =>\n\t\t\t\t{\n\t\t\t\t\tif (!state.index[chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!state.index[chatId][fileId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!storedState.collection[chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstoredState.collection[chatId] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tstoredState.collection[chatId].push(\n\t\t\t\t\t\tstate.index[chatId][fileId]\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tvalidate(fields, options = {})\n\t{\n\t\tconst result = {};\n\n\t\toptions.host = options.host || this.getState().host;\n\n\t\tif (typeof fields.id === \"number\")\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (typeof fields.id === \"string\")\n\t\t{\n\t\t\tif (fields.id.startsWith('temporary'))\n\t\t\t{\n\t\t\t\tresult.id = fields.id;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.id = parseInt(fields.id);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.templateId === \"number\")\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\t\telse if (typeof fields.templateId === \"string\")\n\t\t{\n\t\t\tif (fields.templateId.startsWith('temporary'))\n\t\t\t{\n\t\t\t\tresult.templateId = fields.templateId;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.templateId = parseInt(fields.templateId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\n\t\tif (typeof fields.date !== \"undefined\")\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (typeof fields.type === \"string\")\n\t\t{\n\t\t\tresult.type = fields.type;\n\t\t}\n\n\t\tif (typeof fields.extension === \"string\")\n\t\t{\n\t\t\tresult.extension = fields.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = FilesModel.getIconType(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.name === \"string\" || typeof fields.name === \"number\")\n\t\t{\n\t\t\tresult.name = fields.name.toString();\n\t\t}\n\n\n\t\tif (typeof fields.size === \"number\" || typeof fields.size === \"string\")\n\t\t{\n\t\t\tresult.size = parseInt(fields.size);\n\t\t}\n\n\t\tif (typeof fields.image === 'boolean')\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (typeof fields.image === 'object' && fields.image)\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (typeof fields.image.width === \"string\" || typeof fields.image.width === \"number\")\n\t\t\t{\n\t\t\t\tresult.image.width = parseInt(fields.image.width);\n\t\t\t}\n\t\t\tif (typeof fields.image.height === \"string\" || typeof fields.image.height === \"number\")\n\t\t\t{\n\t\t\t\tresult.image.height = parseInt(fields.image.height);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.status === \"string\" && typeof FileStatus[fields.status] !== 'undefined')\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (typeof fields.progress === \"number\" || typeof fields.progress === \"string\")\n\t\t{\n\t\t\tresult.progress = parseInt(fields.progress);\n\t\t}\n\n\t\tif (typeof fields.authorId === \"number\" || typeof fields.authorId === \"string\")\n\t\t{\n\t\t\tresult.authorId = parseInt(fields.authorId);\n\t\t}\n\n\t\tif (typeof fields.authorName === \"string\" || typeof fields.authorName === \"number\")\n\t\t{\n\t\t\tresult.authorName = fields.authorName.toString();\n\t\t}\n\n\t\tif (typeof fields.urlPreview === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlPreview\n\t\t\t\t|| fields.urlPreview.startsWith('http')\n\t\t\t\t|| fields.urlPreview.startsWith('bx')\n\t\t\t\t|| fields.urlPreview.startsWith('file')\n\t\t\t\t|| fields.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = fields.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = options.host+fields.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.urlDownload === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlDownload\n\t\t\t\t|| fields.urlDownload.startsWith('http')\n\t\t\t\t|| fields.urlDownload.startsWith('bx')\n\t\t\t\t|| fields.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = fields.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = options.host+fields.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.urlShow === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlShow\n\t\t\t\t|| fields.urlShow.startsWith('http')\n\t\t\t\t|| fields.urlShow.startsWith('bx')\n\t\t\t\t|| fields.urlShow.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = fields.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = options.host+fields.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.viewerAttrs === 'object')\n\t\t{\n\t\t\tif (result.type === 'image' && !Utils.platform.isBitrixMobile())\n\t\t\t{\n\t\t\t\tresult.viewerAttrs = fields.viewerAttrs;\n\t\t\t}\n\n\t\t\tif (result.type === 'video' && !Utils.platform.isBitrixMobile() && result.size > FilesModel.maxDiskFileSize)\n\t\t\t{\n\t\t\t\tresult.viewerAttrs = fields.viewerAttrs;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getType(type)\n\t{\n\t\ttype = type.toString().toLowerCase().split('.').splice(-1)[0];\n\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'png':\n\t\t\tcase 'jpe':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\tcase 'heic':\n\t\t\tcase 'bmp':\n\t\t\tcase 'webp':\n\t\t\t\treturn FileType.image;\n\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'webm':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'hevc':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'wmv':\n\t\t\tcase 'mov':\n\t\t\t\treturn FileType.video;\n\n\t\t\tcase 'mp3':\n\t\t\t\treturn FileType.audio;\n\t\t}\n\n\t\treturn FileType.file\n\t}\n\n\tstatic getIconType(extension)\n\t{\n\t\tlet icon = 'empty';\n\n\t\tswitch(extension.toString())\n\t\t{\n\t\t\tcase 'png':\n\t\t\tcase 'jpe':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\tcase 'heic':\n\t\t\tcase 'bmp':\n\t\t\tcase 'webp':\n\t\t\t\ticon = 'img';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'webm':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'hevc':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'wmv':\n\t\t\tcase 'mov':\n\t\t\t\ticon = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\ticon = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\ticon = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\ticon = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\ticon = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\ticon = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\ticon = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\ticon = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\tcase '7z':\n\t\t\tcase 'tar':\n\t\t\tcase 'gz':\n\t\t\tcase 'gzip':\n\t\t\t\ticon = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\ticon = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'conf':\n\t\t\tcase 'ini':\n\t\t\tcase 'plist':\n\t\t\t\ticon = 'set';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn icon;\n\t}\n}","/**\n * Bitrix Messenger\n * Recent model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {Type} from 'main.core';\nimport {ChatTypes, MessageStatus, RecentSection as Section, TemplateTypes} from \"im.const\";\nimport {Utils} from \"im.lib.utils\";\n\nexport class RecentModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: []\n\t\t}\n\t}\n\n\tgetElementState(): RecentItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttemplateId: '',\n\t\t\ttemplate: TemplateTypes.item,\n\t\t\tchatType: ChatTypes.chat,\n\t\t\tsectionCode: Section.general,\n\t\t\tavatar: '',\n\t\t\tcolor: '#048bd0',\n\t\t\ttitle: '',\n\t\t\tlines: {id: 0, status: 0},\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\ttext: '',\n\t\t\t\tdate: new Date(),\n\t\t\t\tsenderId: 0,\n\t\t\t\tstatus: MessageStatus.received\n\t\t\t},\n\t\t\tcounter: 0,\n\t\t\tpinned: false,\n\t\t\tchatId: 0,\n\t\t\tuserId: 0\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (dialogId: string): {index: number, element: RecentItem} | boolean =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tlet currentItem = this.findItem(dialogId);\n\t\t\t\tif (currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = [];\n\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tresult = payload.map(\n\t\t\t\t\t\trecentItem => this.prepareItem(recentItem, { host: store.state.host })\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (result.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tresult.forEach(element => {\n\t\t\t\t\tconst existingItem = this.findItem(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t},\n\n\t\t\taddPlaceholders: (store, payload: []) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(element => {\n\t\t\t\t\tstore.commit('addPlaceholder', {\n\t\t\t\t\t\tfields: element\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdatePlaceholders: (store, payload: {items: [], firstMessage: number}) =>\n\t\t\t{\n\t\t\t\tpayload.items = payload.items.map(element => this.prepareItem(element));\n\n\t\t\t\tpayload.items.forEach((element, index) => {\n\t\t\t\t\tconst placeholderId = 'placeholder' + (payload.firstMessage + index);\n\t\t\t\t\tconst existingPlaceholder = this.findItem(placeholderId, 'templateId');\n\n\t\t\t\t\tconst existingItem = this.findItem(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t\tstore.commit('delete', {\n\t\t\t\t\t\t\tindex: existingPlaceholder.index,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tindex: existingPlaceholder.index,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'string' && !payload.id.startsWith('chat') && payload.id !== 'notify')\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItem(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tpayload.fields = this.validate(Object.assign({}, payload.fields));\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\tfields: payload.fields\n\t\t\t\t});\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t},\n\n\t\t\tpin: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'string' && !payload.id.startsWith('chat') && payload.id !== 'notify')\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\n\t\t\t\tlet existingItem = this.findItem(payload.id);\n\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\tfields: Object.assign({}, existingItem.element, {\n\t\t\t\t\t\tpinned: payload.action\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t},\n\n\t\t\tclearPlaceholders: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPlaceholders');\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'string' && !payload.id.startsWith('chat') && payload.id !== 'notify')\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItem(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tindex: existingItem.index\n\t\t\t\t});\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {fields: Object}) => {\n\t\t\t\tstate.collection.push(Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\t\t\t},\n\n\t\t\tupdate: (state, payload: {index: number, fields: Object}) => {\n\t\t\t\tstate.collection.splice(payload.index, 1, Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tstate.collection[payload.index],\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\t\t\t},\n\n\t\t\tdelete: (state, payload: {index: number}) => {\n\t\t\t\tstate.collection.splice(payload.index, 1);\n\t\t\t},\n\n\t\t\taddPlaceholder: (state, payload: {fields: Object}) => {\n\t\t\t\tstate.collection.push(Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\t\t\t},\n\n\t\t\tclearPlaceholders: (state) => {\n\t\t\t\tstate.collection = state.collection.filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tvalidate(fields: rawRecentItem, options = {}): RecentItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isString(fields.templateId))\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\n\t\tif (Type.isString(fields.template))\n\t\t{\n\t\t\tresult.template = fields.template;\n\t\t}\n\n\t\tif (Type.isString(fields.type))\n\t\t{\n\t\t\tif (fields.type === ChatTypes.chat)\n\t\t\t{\n\t\t\t\tif (fields.chat.type === ChatTypes.open)\n\t\t\t\t{\n\t\t\t\t\tresult.chatType = ChatTypes.open;\n\t\t\t\t}\n\t\t\t\telse if (fields.chat.type === ChatTypes.chat)\n\t\t\t\t{\n\t\t\t\t\tresult.chatType = ChatTypes.chat;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (fields.type === ChatTypes.user)\n\t\t\t{\n\t\t\t\tresult.chatType = ChatTypes.user;\n\t\t\t}\n\t\t\telse if (fields.type === ChatTypes.notification)\n\t\t\t{\n\t\t\t\tresult.chatType = ChatTypes.notification;\n\t\t\t\tfields.title = 'Notifications';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.chatType = ChatTypes.chat;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(fields.avatar))\n\t\t{\n\t\t\tlet avatar;\n\n\t\t\tif (!fields.avatar || fields.avatar.endsWith('/js/im/images/blank.gif'))\n\t\t\t{\n\t\t\t\tavatar = '';\n\t\t\t}\n\t\t\telse if (fields.avatar.startsWith('http'))\n\t\t\t{\n\t\t\t\tavatar = fields.avatar;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatar = options.host + fields.avatar;\n\t\t\t}\n\n\t\t\tif (avatar)\n\t\t\t{\n\t\t\t\tresult.avatar = encodeURI(avatar);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tconst message = {};\n\t\t\tif (Type.isNumber(fields.message.id))\n\t\t\t{\n\t\t\t\tmessage.id = fields.message.id;\n\t\t\t}\n\t\t\tif (Type.isString(fields.message.text))\n\t\t\t{\n\t\t\t\tconst options = {}\n\t\t\t\tif (fields.message.withAttach)\n\t\t\t\t{\n\t\t\t\t\toptions.WITH_ATTACH = true;\n\t\t\t\t}\n\t\t\t\telse if (fields.message.withFile)\n\t\t\t\t{\n\t\t\t\t\toptions.WITH_FILE = true;\n\t\t\t\t}\n\n\t\t\t\tmessage.text = Utils.text.purify(fields.message.text, options);\n\t\t\t}\n\t\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t\t{\n\t\t\t\tmessage.date = fields.message.date;\n\t\t\t}\n\t\t\tif (Type.isNumber(fields.message.author_id))\n\t\t\t{\n\t\t\t\tmessage.senderId = fields.message.author_id;\n\t\t\t}\n\t\t\tif (Type.isNumber(fields.message.senderId))\n\t\t\t{\n\t\t\t\tmessage.senderId = fields.message.senderId;\n\t\t\t}\n\t\t\tif (Type.isStringFilled(fields.message.status))\n\t\t\t{\n\t\t\t\tmessage.status = fields.message.status;\n\t\t\t}\n\n\t\t\tresult.message = message;\n\t\t}\n\n\t\tif (Type.isNumber(fields.counter))\n\t\t{\n\t\t\tresult.counter = fields.counter;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.userId = fields.userId;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortListByMessageDate(a: RecentItem, b: RecentItem)\n\t{\n\t\tif (a.message && b.message)\n\t\t{\n\t\t\tlet timestampA = new Date(a.message.date).getTime();\n\t\t\tlet timestampB = new Date(b.message.date).getTime();\n\n\t\t\treturn timestampB - timestampA;\n\t\t}\n\t}\n\n\tprepareItem(item, options = {})\n\t{\n\t\tlet result = this.validate(Object.assign({}, item));\n\n\t\treturn Object.assign({}, this.getElementState(), result, options);\n\t}\n\n\tfindItem(value, key = 'id'): {index: number, element: RecentItem} | boolean\n\t{\n\t\tlet result = {};\n\n\t\tif (key === 'id' && Type.isNumber(value))\n\t\t{\n\t\t\tvalue = value.toString();\n\t\t}\n\n\t\tlet elementIndex = this.store.state.recent.collection.findIndex((element, index) => {\n\t\t\treturn element[key] === value;\n\t\t});\n\n\t\tif (elementIndex !== -1)\n\t\t{\n\t\t\tresult.index = elementIndex;\n\t\t\tresult.element = this.store.state.recent.collection[elementIndex];\n\n\t\t\treturn result;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\n//raw input object for validation\ntype rawRecentItem = {\n\tid?: number | string,\n\ttemplateId?: string,\n\ttemplate?: TemplateTypes.item | TemplateTypes.placeholder,\n\ttype?: ChatTypes.chat | ChatTypes.user | ChatTypes.notification,\n\tchat?: {\n\t\ttype?: string\n\t},\n\tavatar?: string,\n\tcolor?: string,\n\ttitle?: string,\n\tmessage?: RawRecentItemMessage,\n\tcounter?: number,\n\tpinned?: boolean,\n\tchatId?: number,\n\tuserId?: number\n}\n\ntype RawRecentItemMessage = {\n\tid?: number,\n\ttext?: string,\n\tdate?: Date,\n\tsenderId?: number,\n\tauthor_id?: number, //senderId alias\n\tstatus?: MessageStatus.received | MessageStatus.delivered\n}\n\n//item in collection\ntype RecentItem = {\n\tid?: number,\n\ttemplateId?: string,\n\ttemplate?: TemplateTypes.item | TemplateTypes.placeholder,\n\tchatType?: ChatTypes.chat | ChatTypes.open | ChatTypes.user | ChatTypes.notification,\n\tsectionCode?: Section.general | Section.pinned,\n\tavatar?: string,\n\tcolor?: string,\n\ttitle?: string,\n\tmessage?: RecentItemMessage,\n\tcounter?: number,\n\tpinned?: boolean,\n\tchatId?: number,\n\tuserId?: number\n}\n\ntype RecentItemMessage = {\n\tid?: number,\n\ttext?: string,\n\tdate?: Date | string,\n\tsenderId?: number,\n\tstatus?: MessageStatus.received | MessageStatus.delivered\n}","/**\n * Bitrix Messenger\n * Notifications model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2021 Bitrix\n */\n\nimport { Vue } from 'ui.vue';\nimport { VuexBuilderModel } from 'ui.vue.vuex';\nimport { Utils } from 'im.lib.utils';\nimport { Type } from 'main.core';\nimport { NotificationTypesCodes } from 'im.const';\n\nclass NotificationsModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: [],\n\t\t\tsearchCollection: [],\n\t\t\tchat_id: 0,\n\t\t\ttotal: 0,\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tunreadCounter: 0,\n\t\t\tschema: {}\n\t\t}\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\ttextConverted: '',\n\t\t\tunread: false,\n\t\t\tdisplay: true,\n\t\t\tsettingName: 'im|default',\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => () =>\n\t\t\t{\n\t\t\t\treturn state.collection;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = parseInt(notificationId);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItemInArr(state.collection, notificationId);\n\t\t\t\tif (!existingItem.element)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem.element;\n\t\t\t},\n\t\t\tgetSearchItemById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = parseInt(notificationId);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItemInArr(state.searchCollection, notificationId);\n\t\t\t\tif (!existingItem.element)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem.element;\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst result = {\n\t\t\t\t\tnotification: [],\n\t\t\t\t};\n\n\t\t\t\tif (payload.notification instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tresult.notification = payload.notification.map(notification => this.prepareNotification(notification, { host: store.state.host }));\n\t\t\t\t}\n\n\t\t\t\tif (Type.isNumber(payload.total) || Type.isString(payload.total))\n\t\t\t\t{\n\t\t\t\t\tresult.total = parseInt(payload.total);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', result);\n\t\t\t},\n\t\t\tsetSearchResults: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst result = {\n\t\t\t\t\tnotification: [],\n\t\t\t\t};\n\n\t\t\t\tif (!(payload.notification instanceof Array))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// we don't need validation for the local results\n\t\t\t\tif (payload.type === 'local')\n\t\t\t\t{\n\t\t\t\t\tresult.notification = payload.notification;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.notification = payload.notification.map(notification => this.prepareNotification(notification, { host: store.state.host }));\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setSearchResults', {\n\t\t\t\t\tdata: result\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteSearchResults: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('deleteSearchResults');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.unreadTotal) || Type.isString(payload.unreadTotal))\n\t\t\t\t{\n\t\t\t\t\tconst unreadCounter = parseInt(payload.unreadTotal);\n\t\t\t\t\tstore.commit('setCounter', unreadCounter);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetTotal: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total) || Type.isString(payload.total))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setTotal', payload.total);\n\t\t\t\t}\n\t\t\t},\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst addItem = this.prepareNotification(payload.data, { host: store.state.host });\n\t\t\t\taddItem.unread = true;\n\n\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, addItem.id);\n\t\t\t\tif (!existingItem.element)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\tdata: addItem,\n\t\t\t\t\t});\n\n\t\t\t\t\tstore.commit('setTotal', store.state.total + 1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\tfields: Object.assign({}, payload.fields),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdatePlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.items instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.items = payload.items.map(notification => this.prepareNotification(notification));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updatePlaceholders', payload);\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tclearPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPlaceholders', payload);\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, payload.id);\n\t\t\t\tif (existingItem.element)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\tfields: Object.assign({}, payload.fields),\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (payload.searchMode)\n\t\t\t\t{\n\t\t\t\t\tconst existingItemInSearchCollection = this.findItemInArr(store.state.searchCollection, payload.id);\n\t\t\t\t\tif (existingItemInSearchCollection.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tsearchCollection: true,\n\t\t\t\t\t\t\tindex: existingItemInSearchCollection.index,\n\t\t\t\t\t\t\tfields: Object.assign({}, payload.fields),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tfor (const notificationId of payload.ids)\n\t\t\t\t{\n\t\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, notificationId);\n\t\t\t\t\tif (!existingItem.element)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\taction: !payload.action,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\treadAll: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('readAll');\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, payload.id);\n\t\t\t\tif (existingItem.element)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('delete', {\n\t\t\t\t\t\tsearchCollection: false,\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t});\n\n\t\t\t\t\tstore.commit('setTotal', store.state.total - 1);\n\t\t\t\t}\n\n\t\t\t\tif (payload.searchMode)\n\t\t\t\t{\n\t\t\t\t\tconst existingItemInSearchCollection = this.findItemInArr(store.state.searchCollection, payload.id);\n\t\t\t\t\tif (existingItemInSearchCollection.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('delete', {\n\t\t\t\t\t\t\tsearchCollection: true,\n\t\t\t\t\t\t\tindex: existingItemInSearchCollection.index,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeleteAll: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('deleteAll');\n\t\t\t},\n\t\t\tsetSchema: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setSchema', {\n\t\t\t\t\tdata: payload.data,\n\t\t\t\t});\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.total = payload.hasOwnProperty('total') ? payload.total : state.total;\n\n\t\t\t\tif (!payload.hasOwnProperty('notification') || !Type.isArray(payload.notification))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (const element of payload.notification)\n\t\t\t\t{\n\t\t\t\t\tconst existingItem = this.findItemInArr(state.collection, element.id);\n\n\t\t\t\t\tif (!existingItem.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection.push(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t// we trust unread status of existing item to prevent notifications blinking while init loading.\n\t\t\t\t\t\tif (element.unread !== state.collection[existingItem.index].unread)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telement.unread = state.collection[existingItem.index].unread;\n\t\t\t\t\t\t\tstate.unreadCounter = (element.unread === true ? state.unreadCounter + 1 : state.unreadCounter - 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.collection[existingItem.index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[existingItem.index],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.collection.sort(this.sortByType);\n\t\t\t},\n\t\t\tsetSearchResults: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (const element of payload.data.notification)\n\t\t\t\t{\n\t\t\t\t\tconst existingItem = this.findItemInArr(state.searchCollection, element.id);\n\n\t\t\t\t\tif (!existingItem.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.searchCollection.push(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.searchCollection[existingItem.index] = Object.assign(\n\t\t\t\t\t\t\tstate.searchCollection[existingItem.index],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeleteAll: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection = [];\n\t\t\t},\n\t\t\tdeleteSearchResults: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection = [];\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet firstNotificationIndex = null;\n\t\t\t\tif (payload.data.sectionCode === NotificationTypesCodes.confirm)\n\t\t\t\t{\n\t\t\t\t\t//new confirms should always add to the beginning of the collection\n\t\t\t\t\tstate.collection.unshift(payload.data);\n\t\t\t\t}\n\t\t\t\telse //if (payload.data.sectionCode === NotificationTypesCodes.simple)\n\t\t\t\t{\n\t\t\t\t\tfor (let index = 0; state.collection.length > index; index++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (state.collection[index].sectionCode === NotificationTypesCodes.simple)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfirstNotificationIndex = index;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t//if we didn't find any simple notification and its index, then add new one to the end.\n\t\t\t\t\tif (firstNotificationIndex === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection.push(payload.data);\n\t\t\t\t\t}\n\t\t\t\t\telse //otherwise, put it right before first simple notification.\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection.splice(firstNotificationIndex, 0, payload.data);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.collection.sort(this.sortByType);\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst collectionName = payload.searchCollection ? 'searchCollection' : 'collection';\n\n\t\t\t\tVue.set(state[collectionName], payload.index, Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tstate[collectionName][payload.index],\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst collectionName = payload.searchCollection ? 'searchCollection' : 'collection';\n\t\t\t\tstate[collectionName].splice(payload.index, 1);\n\t\t\t},\n\t\t\tread: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.index].unread = payload.action;\n\t\t\t},\n\t\t\treadAll: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let index = 0; state.collection.length > index; index++)\n\t\t\t\t{\n\t\t\t\t\tif (state.collection[index].sectionCode === NotificationTypesCodes.simple)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[index].unread = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdatePlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst collectionName = payload.searchCollection ? 'searchCollection' : 'collection';\n\n\t\t\t\tpayload.items.forEach((element, index) => {\n\t\t\t\t\tconst placeholderId = `placeholder${payload.firstItem + index}`;\n\t\t\t\t\tconst existingPlaceholderIndex = state[collectionName].findIndex(notification => {\n\t\t\t\t\t\treturn notification.id === placeholderId;\n\t\t\t\t\t});\n\n\t\t\t\t\tconst existingMessageIndex = state[collectionName].findIndex(notification => {\n\t\t\t\t\t\treturn notification.id === element.id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (existingMessageIndex >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate[collectionName][existingMessageIndex] = Object.assign(\n\t\t\t\t\t\t\tstate[collectionName][existingMessageIndex],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t\tstate[collectionName].splice(existingPlaceholderIndex, 1);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate[collectionName].splice(\n\t\t\t\t\t\t\texistingPlaceholderIndex,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tObject.assign({}, element)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstate[collectionName].sort(this.sortByType);\n\t\t\t},\n\t\t\tclearPlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection = state.collection.filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\n\t\t\t\tstate.searchCollection = state.searchCollection.filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = payload;\n\t\t\t},\n\t\t\tsetTotal: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.total = payload;\n\t\t\t},\n\t\t\tsetSchema: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.schema = payload.data;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* region Validation */\n\tvalidate(fields, options)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\t// previous P&P format\n\t\tif (Type.isString(fields.textOriginal) || Type.isNumber(fields.textOriginal))\n\t\t{\n\t\t\tresult.text = fields.textOriginal.toString();\n\n\t\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t\t{\n\t\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\t\ttext: fields.text.toString(),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse // modern format\n\t\t{\n\t\t\tif (!Type.isNil(fields.text_converted))\n\t\t\t{\n\t\t\t\tfields.textConverted = fields.text_converted;\n\t\t\t}\n\t\t\tif (Type.isString(fields.textConverted) || Type.isNumber(fields.textConverted))\n\t\t\t{\n\t\t\t\tresult.textConverted = fields.textConverted.toString();\n\t\t\t}\n\t\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t\t{\n\t\t\t\tresult.text = fields.text.toString();\n\n\t\t\t\tlet isConverted = !Type.isNil(result.textConverted);\n\n\t\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\t\ttext: isConverted? result.textConverted: result.text,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tif (fields.system === true || fields.system === 'Y')\n\t\t\t{\n\t\t\t\tresult.authorId = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.authorId = fields.author_id;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tconst params = this.validateParams(fields.params);\n\t\t\tif (params)\n\t\t\t{\n\t\t\t\tresult.params = params;\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\n\t\t//p&p format\n\t\tif (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map((button) => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse if (fields.type === NotificationTypesCodes.placeholder)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.placeholder;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.unread = fields.notify_read === 'N';\n\t\t}\n\n\t\t//p&p format\n\t\tif (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.unread = fields.read === 'N'; //?\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateParams(params)\n\t{\n\t\tconst result = {};\n\t\ttry\n\t\t{\n\t\t\tfor (let field in params)\n\t\t\t{\n\t\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (field === 'COMPONENT_ID')\n\t\t\t\t{\n\t\t\t\t\tif (Type.isString(params[field]) && BX.Vue.isComponent(params[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'LIKE')\n\t\t\t\t{\n\t\t\t\t\tif (params[field] instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult['REACTION'] = {like: params[field].map(element => parseInt(element))};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'CHAT_LAST_DATE')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = Utils.date.cast(params[field]);\n\t\t\t\t}\n\t\t\t\telse if (field === 'AVATAR')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field].startsWith('http') ? params[field] : options.host + params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'NAME')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (e) {}\n\n\t\tlet hasResultElements = false;\n\t\tfor (let field in result)\n\t\t{\n\t\t\tif (!result.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\thasResultElements = true;\n\t\t\tbreak\n\t\t}\n\n\t\treturn hasResultElements? result: null;\n\t}\n\t/* endregion Validation */\n\n\t/* region Internal helpers */\n\tprepareNotification(notification, options = {})\n\t{\n\t\tlet result = this.validate(Object.assign({}, notification));\n\n\t\treturn Object.assign({}, this.getElementState(), result, options);\n\t}\n\n\tfindItemInArr(arr, value, key = 'id')\n\t{\n\t\tconst result = {};\n\n\t\tconst elementIndex = arr.findIndex((element, index) => {\n\t\t\treturn element[key] === value;\n\t\t});\n\n\t\tif (elementIndex !== -1)\n\t\t{\n\t\t\tresult.index = elementIndex;\n\t\t\tresult.element = arr[elementIndex];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n\t/* endregion Internal helpers */\n\n\t/* region Text utils */\n\tconvertToHtml(params = {})\n\t{\n\t\tlet { text = '' } = params;\n\n\t\ttext = text.trim();\n\t\ttext = text.replace(/\\n/gi, '<br />');\n\t\ttext = text.replace(/\\t/gi, '&nbsp;&nbsp;&nbsp;&nbsp;');\n\n\t\ttext = NotificationsModel.decodeBbCode({ text });\n\n\t\tif (Utils.platform.isBitrixDesktop())\n\t\t{\n\t\t\ttext = text.replace(/<a(.*?)>(.*?)<\\/a>/ig, function(whole, anchor, text) {\n\t\t\t\treturn '<a'+anchor.replace('target=\"_self\"', 'target=\"_blank\"')+' class=\"bx-im-notifications-item-link\">'+text+'</a>';\n\t\t\t});\n\t\t}\n\n\t\treturn text;\n\t};\n\n\tstatic decodeBbCode(params = {})\n\t{\n\t\tlet { text } = params;\n\n\t\ttext = text.replace(/\\[url=([^\\]]+)\\](.*?)\\[\\/url\\]/ig, function(whole, link, text)\n\t\t{\n\t\t\tlet tag = document.createElement('a');\n\t\t\ttag.href = Utils.text.htmlspecialcharsback(link);\n\t\t\ttag.target = '_blank';\n\t\t\ttag.text = Utils.text.htmlspecialcharsback(text);\n\n\t\t\tconst allowList = [\n\t\t\t\t'http:',\n\t\t\t\t'https:',\n\t\t\t\t'ftp:',\n\t\t\t\t'file:',\n\t\t\t\t'tel:',\n\t\t\t\t'callto:',\n\t\t\t\t'mailto:',\n\t\t\t\t'skype:',\n\t\t\t\t'viber:',\n\t\t\t];\n\t\t\tif (allowList.indexOf(tag.protocol) <= -1)\n\t\t\t{\n\t\t\t\treturn whole;\n\t\t\t}\n\n\t\t\treturn tag.outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[LIKE\\]/ig, '<span class=\"bx-smile bx-im-smile-like\"></span>');\n\t\ttext = text.replace(/\\[DISLIKE\\]/ig, '<span class=\"bx-smile bx-im-smile-dislike\"></span>');\n\n\t\ttext = text.replace(/\\[RATING\\=([1-5]{1})\\]/ig, (whole, rating) => {\n\t\t\t// todo: refactor legacy call\n\t\t\treturn BX.MessengerCommon.linesVoteHeadNodes(0, rating, false).outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[BR\\]/ig, '<br/>');\n\t\ttext = text.replace(/\\[([buis])\\](.*?)\\[(\\/[buis])\\]/ig, (whole, open, inner, close) => {\n\t\t\treturn '<' + open + '>' + inner + '<' + close + '>';\n\t\t});\n\n\t\ttext = text.replace(/\\[CHAT=(imol\\|)?([0-9]{1,})\\](.*?)\\[\\/CHAT\\]/ig, (whole, openlines, chatId, inner) => {\n\t\t\tchatId = parseInt(chatId);\n\n\t\t\tif (chatId <= 0)\n\t\t\t{\n\t\t\t\treturn inner;\n\t\t\t}\n\n\t\t\tif (openlines)\n\t\t\t{\n\t\t\t\treturn '<span class=\"bx-im-mention\" data-type=\"OPENLINES\" data-value=\"'+chatId+'\">'+inner+'</span>';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn '<span class=\"bx-im-mention\" data-type=\"CHAT\" data-value=\"'+chatId+'\">'+inner+'</span>';\n\t\t\t}\n\t\t});\n\t\ttext = text.replace(/\\[USER=([0-9]{1,})\\](.*?)\\[\\/USER\\]/ig, (whole, userId, text) =>\n\t\t{\n\t\t\tlet html = '';\n\n\t\t\tuserId = parseInt(userId);\n\t\t\tif (userId > 0 && typeof(BXIM) != 'undefined')\n\t\t\t{\n\t\t\t\thtml = `<span class=\"bx-im-mention ${userId === +BXIM.userId ? 'bx-messenger-ajax-self' : ''}\" data-type=\"USER\" data-value=\"${userId}\">${text}</span>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thtml = text;\n\t\t\t}\n\n\t\t\treturn html;\n\t\t});\n\n\t\ttext = text.replace(/\\[PCH=([0-9]{1,})\\](.*?)\\[\\/PCH\\]/ig, (whole, historyId, text) => text);\n\n\t\treturn text;\n\t}\n\t/* endregion Text utils */\n}\n\nexport {NotificationsModel};","/**\n * Bitrix Messenger\n * Call Application model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {Type} from 'main.core';\nimport {ConferenceUserState} from 'im.const';\n\nexport class CallModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'call';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tusers: {}\n\t\t}\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\treturn {\n\t\t\tid: params.id ? params.id : 0,\n\t\t\tstate: ConferenceUserState.Idle,\n\t\t\ttalking: false,\n\t\t\tpinned: false,\n\t\t\tcameraState: false,\n\t\t\tmicrophoneState: false,\n\t\t\tscreenState: false,\n\t\t\tfloorRequestState: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetUser: state => (userId) =>\n\t\t\t{\n\t\t\t\tuserId = parseInt(userId, 10);\n\n\t\t\t\tif (!state.users[userId])\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn state.users[userId];\n\t\t\t},\n\t\t\tgetBlankUser: state => (userId) =>\n\t\t\t{\n\t\t\t\tuserId = parseInt(userId, 10);\n\n\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tupdateUser: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = parseInt(payload.id, 10);\n\n\t\t\t\tpayload.fields = Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tthis.validate(payload.fields),\n\t\t\t\t);\n\n\t\t\t\tstore.commit('updateUser', payload);\n\t\t\t},\n\t\t\tunpinUser: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('unpinUser');\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tupdateUser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.users[payload.id])\n\t\t\t\t{\n\t\t\t\t\tVue.set(state.users, payload.id, Object.assign(this.getElementState(), payload.fields, {id: payload.id}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.users[payload.id] = Object.assign(state.users[payload.id], payload.fields);\n\t\t\t\t}\n\t\t\t},\n\t\t\tunpinUser: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst pinnedUser = Object.values(state.users).find(user => user.pinned === true);\n\n\t\t\t\tif (pinnedUser)\n\t\t\t\t{\n\t\t\t\t\tstate.users[pinnedUser.id].pinned = false;\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tvalidate(payload)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(payload.id) || Type.isString(payload.id))\n\t\t{\n\t\t\tresult.id = parseInt(payload.id, 10);\n\t\t}\n\n\t\tif (ConferenceUserState[payload.state])\n\t\t{\n\t\t\tresult.state = payload.state;\n\t\t}\n\n\t\tif (Type.isBoolean(payload.talking))\n\t\t{\n\t\t\tresult.talking = payload.talking;\n\t\t}\n\n\t\tif (Type.isBoolean(payload.pinned))\n\t\t{\n\t\t\tresult.pinned = payload.pinned;\n\t\t}\n\n\t\tif (Type.isBoolean(payload.cameraState))\n\t\t{\n\t\t\tresult.cameraState = payload.cameraState;\n\t\t}\n\n\t\tif (Type.isBoolean(payload.microphoneState))\n\t\t{\n\t\t\tresult.microphoneState = payload.microphoneState;\n\t\t}\n\n\t\tif (Type.isBoolean(payload.screenState))\n\t\t{\n\t\t\tresult.screenState = payload.screenState;\n\t\t}\n\n\t\tif (Type.isBoolean(payload.floorRequestState))\n\t\t{\n\t\t\tresult.floorRequestState = payload.floorRequestState;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tusers: false\n\t\t}\n\t}\n}"],"names":["ApplicationModel","common","host","getVariable","location","protocol","siteId","userId","languageId","dialog","dialogId","chatId","diskFolderId","messageLimit","enableReadMessages","messageExtraCount","disk","enabled","maxFileSize","call","serverEnabled","maxParticipants","mobile","keyboardShow","device","type","DeviceType","desktop","orientation","DeviceOrientation","portrait","options","quoteEnable","quoteFromRight","autoplayVideo","darkBackground","showSmiles","error","active","code","description","Object","assign","set","store","payload","commit","validate","hideSmiles","state","hasChange","group","hasOwnProperty","field","isSaveNeeded","saveState","increaseDialogExtraCount","count","decreaseDialogExtraCount","newCounter","clearDialogExtraCount","fields","result","toString","startsWith","substr","parseInt","isNaN","VuexBuilderModel","ConferenceModel","inited","passChecked","showChat","userCount","messageCount","userInCallCount","ConferenceStateType","preparation","callEnded","conferenceTitle","alias","permissionsRequested","conferenceStarted","conferenceStartDate","joinWithVideo","userReadyToJoin","isBroadcast","users","usersInCall","presenters","rightPanelMode","RightPanelMode","hidden","user","id","hash","newState","changeRightPanelMode","mode","setPermissionsRequested","status","setPresenters","Array","isArray","setUsers","removeUsers","setUsersInCall","removeUsersInCall","setConferenceTitle","setBroadcastMode","broadcastMode","componentError","startCall","endCall","returnToPreparation","toggleSmiles","setError","errorCode","setAlias","setJoinType","setConferenceStatus","setConferenceStartDate","Date","setUserReadyToJoin","replace","forEach","presenter","includes","push","filter","IntersectionType","empty","equal","none","found","foundReverse","MessagesModel","created","collection","mutationType","saveMessageList","saveFileList","saveUserList","templateId","templateType","placeholderType","authorId","date","text","textConverted","params","TYPE","COMPONENT_ID","unread","sending","retry","blink","getMutationType","initialType","MutationType","appliedType","getLastId","length","lastId","i","element","getMessage","messageId","index","get","getBlank","getElementState","getSaveFileList","getSaveUserList","add","getTime","dispatch","actionStart","test","Vue","nextTick","actionError","actionFinish","map","message","prepareMessage","insertType","data","addPlaceholders","placeholders","requestMode","setBefore","setAfter","reverse","clearPlaceholders","updatePlaceholders","update","findIndex","el","setTimeout","delete","elements","clear","keepPlaceholders","applyMutationType","readMessages","readId","unreadMessages","unreadId","initCollection","sort","a","b","Logger","warn","firstPlaceholderId","firstMessage","firstPlaceholderIndex","splice","amount","chats","chatsSave","isPush","StorageLimit","messages","intersection","manageCacheBeforeSet","foundElements","removeIntersectionCacheElements","unshift","getters","Set","every","EventEmitter","emit","EventType","messagesSet","readVisibleMessages","isSaveState","clearMessages","applied","scrollStickToTop","scrollMessageId","saveNeeded","updateSubordinateStates","concat","cache","recursive","noneElements","reverseResult","isSaveAvailable","readCounter","slice","FILE_ID","updateSaveLists","storedState","chat_id","Utils","cast","textOriginal","convertToHtml","isConverted","text_converted","senderId","author_id","system","validateParams","BX","isComponent","like","decodeAttach","e","hasResultElements","quote","image","enableBigSmile","trim","quoteSign","indexOf","textPrepare","split","textPrepareFlag","join","decodeBbCode","whole","p1","p2","p3","p4","offset","changed","aInner","match","doubleSmileSize","start","width","middle","height","end","textOnly","item","arrayElement","prop","htmlspecialcharsback","putReplacement","sendReplacement","codeReplacement","link","tag","document","createElement","href","target","allowList","outerHTML","open","inner","close","openlines","number","htmlspecialchars","historyId","textElementSize","url","attrs","size","title","attributes","name","value","command","html","parentNode","innerHTML","src","DialoguesModel","saveDialogList","saveChatList","writingList","quoteId","counter","userCounter","lastMessageId","managerList","readedList","muteList","textareaMessage","editId","init","owner","extranet","avatar","color","entityType","entityId","entityData1","entityData2","entityData3","dateCreate","restrictions","extend","leave","leaveOwner","rename","public","getByChatId","getQuoteId","getEditId","canSaveChat","canSaveDialog","isPrivateDialog","updateWriting","action","userName","actionName","updateReaded","increaseCounter","increasedCounter","rootState","application","dialogMuted","previousCounter","decreaseCounter","decreasedCounter","increaseMessageCounter","currentCounter","saveDialog","dialogues","cloneState","getElementStateSaveException","getState","dialog_id","user_counter","message_count","unread_id","last_message_id","readed_list","record","user_id","user_name","message_id","writing_list","manager_list","mute_list","entries","entry","ownerId","endsWith","encodeURI","entity_type","entity_id","entity_data_1","entity_data_2","entity_data_3","date_create","dateLastOpen","AVATAR","EXTEND","LEAVE","LEAVE_OWNER","RENAME","UsersModel","startOnlineCheckInterval","onlineList","mobileOnlineList","absentList","firstName","lastName","workPosition","gender","birthday","isBirthday","network","bot","connector","externalAuthId","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","absent","isAbsent","departments","phones","workPhone","personalMobile","personalPhone","innerPhone","getTemporary","getList","userList","getOnlineStatus","addToOnlineList","mobileStatus","isMobileActive","addToMobileOnlineList","today","format","timeToNextMidnight","getTimeToNextMidnight","addToAbsentList","timeToNextDay","setInterval","startAbsentCheckInterval","newActivityDate","db","list","exceptionList","first_name","last_name","work_position","external_auth_id","last_activity_date","mobile_last_date","departmentId","work_phone","personal_mobile","personal_phone","inner_phone","nextMidnight","setHours","currentTime","absentEnd","intervalTime","FilesModel","extension","icon","FileStatus","done","progress","authorName","urlPreview","urlShow","urlDownload","viewerAttrs","fileId","file","getIconType","platform","isBitrixMobile","maxDiskFileSize","toLowerCase","FileType","video","audio","RecentModel","template","TemplateTypes","chatType","ChatTypes","chat","sectionCode","Section","general","lines","MessageStatus","received","pinned","Type","isNumber","currentItem","findItem","recentItem","prepareItem","existingItem","sortListByMessageDate","items","placeholderId","existingPlaceholder","pin","addPlaceholder","isStringFilled","isString","notification","isPlainObject","withAttach","WITH_ATTACH","withFile","WITH_FILE","purify","isDate","isBoolean","timestampA","timestampB","key","elementIndex","recent","NotificationsModel","searchCollection","total","unreadCounter","schema","NotificationTypesCodes","simple","display","settingName","getById","notificationId","findItemInArr","getSearchItemById","prepareNotification","setSearchResults","deleteSearchResults","setCounter","unreadTotal","setTotal","addItem","searchMode","existingItemInSearchCollection","read","ids","readAll","deleteAll","setSchema","sortByType","firstNotificationIndex","confirm","collectionName","firstItem","existingPlaceholderIndex","existingMessageIndex","isNil","isObjectLike","notify_buttons","notifyButtons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","placeholder","notify_read","setting_name","arr","isBitrixDesktop","anchor","rating","MessengerCommon","linesVoteHeadNodes","BXIM","CallModel","ConferenceUserState","Idle","talking","cameraState","microphoneState","screenState","floorRequestState","getUser","getBlankUser","updateUser","unpinUser","pinnedUser","values","find"],"mappings":"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"}