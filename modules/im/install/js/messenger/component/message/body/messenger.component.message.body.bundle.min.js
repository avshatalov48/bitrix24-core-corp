(function(t){"use strict";var e=window.BX;var s=Object.freeze({self:"self",opponent:"opponent",system:"system"});var n=Object.freeze({default:"default",image:"image",video:"video",richLink:"richLink"});var a=Object.freeze({files:e.Messenger.Model.Files.getName()});e.Vue.component("bx-messenger-message-body",{props:{userId:{default:0},dialogId:{default:0},chatId:{default:0},messageType:{default:s.self},message:{type:Object,default:e.Messenger.Model.Messages.getMessageBlank},user:{type:Object,default:e.Messenger.Model.Users.getUserBlank},files:{type:Object,default:{}},enableEmotions:{default:true},showName:{default:true},showAvatar:{default:true},referenceContentBodyClassName:{default:""}},created:function t(){this.dateFormatFunction=null;this.cacheFormatDate={}},methods:{clickByUserName:function t(e,s){this.$emit("clickByUserName",{user:e,event:s})},formatDate:function t(s){var n=s.toJSON().slice(0,10);if(this.cacheFormatDate[n]){return this.cacheFormatDate[n]}var a=e.Messenger.Utils.getDateFormatType(e.Messenger.Const.dateFormat.message,this.$root.$bitrixMessages);this.cacheFormatDate[n]=this._getDateFormat().format(a,s);return this.cacheFormatDate[n]},_getDateFormat:function t(){var s=this;if(this.dateFormatFunction){return this.dateFormatFunction}this.dateFormatFunction=Object.create(e.Main.Date);if(this.$root.$bitrixMessages){this.dateFormatFunction._getMessage=function(t){return s.$root.$bitrixMessages[t]}}return this.dateFormatFunction}},computed:{MessageType:function t(){return s},ContentType:function t(){return n},contentType:function t(){if(this.filesData.length>0){var e=false;var s=false;var a=true;var i=false;var r=undefined;try{for(var m=this.filesData[Symbol.iterator](),o;!(a=(o=m.next()).done);a=true){var l=o.value;if(l.type=="image"){if(s){s=false;break}e=true}else{e=false;s=false;break}}}catch(t){i=true;r=t}finally{try{if(!a&&m.return!=null){m.return()}}finally{if(i){throw r}}}if(e){return n.image}else if(s){return n.video}}return n.default},localize:function t(){return e.Vue.getFilteredPhrases("IM_MESSENGER_MESSAGE_",this.$root.$bitrixMessages)},formattedDate:function t(){return this.formatDate(this.message.date)},messageText:function t(){if(this.isDeleted){return this.localize.IM_MESSENGER_MESSAGE_DELETED}return this.message.textConverted},isEdited:function t(){return this.message.params.IS_EDITED=="Y"},isDeleted:function t(){return this.message.params.IS_DELETED=="Y"},filesData:function t(){var e=this;var s=[];if(!this.message.params.FILE_ID||this.message.params.FILE_ID.length<=0){return s}this.message.params.FILE_ID.forEach(function(t){if(e.files[t]){s.push(e.files[t])}});return s}},template:'\n\t\t<div class="bx-im-message-content-wrap">\n\t\t\t<template v-if="contentType == ContentType.default">\n\t\t\t\t<div class="bx-im-message-content">\n\t\t\t\t\t<span class="bx-im-message-content-box">\n\t\t\t\t\t\t<template v-if="showName && messageType == MessageType.opponent">\n\t\t\t\t\t\t\t<div class="bx-im-message-content-name" :style="{color: user.color}" @click="clickByUserName(user, $event)">{{!showAvatar? user.name: (user.firstName? user.firstName: user.name)}}</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body\', referenceContentBodyClassName]">\n\t\t\t\t\t\t\t<template v-for="file in filesData">\n\t\t\t\t\t\t\t\t<bx-messenger-element-file :file="file"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body-wrap\', {\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-with-text\': messageText.length > 0,\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-without-text\': messageText.length <= 0,\n\t\t\t\t\t\t\t}]">\n\t\t\t\t\t\t\t\t<template v-if="messageText">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-text" v-html="messageText"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class="bx-im-message-content-params">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-date">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- keyboard --\x3e\n\t\t\t</template>\n\t\t\t<template v-else-if="contentType == ContentType.richLink">\n\t\t\t\t\x3c!-- richLink type markup --\x3e\n\t\t\t</template>\n\t\t\t<template v-else-if="contentType == ContentType.image || contentType == ContentType.video">\n\t\t\t\t<div class="bx-im-message-content bx-im-message-content-fit">\n\t\t\t\t\t<span class="bx-im-message-content-box">\n\t\t\t\t\t\t<template v-if="showName && messageType == MessageType.opponent">\n\t\t\t\t\t\t\t<div class="bx-im-message-content-name" :style="{color: user.color}" @click="clickByUserName(user, $event)">{{!showAvatar? user.name: (user.firstName? user.firstName: user.name)}}</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body\', referenceContentBodyClassName]">\n\t\t\t\t\t\t\t<template v-if="contentType == ContentType.image">\n\t\t\t\t\t\t\t\t<template v-for="file in filesData">\n\t\t\t\t\t\t\t\t\t<bx-messenger-element-file-image :file="file"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else-if="contentType == ContentType.video">\n\t\t\t\t\t\t\t\t<template v-for="file in filesData">\n\t\t\t\t\t\t\t\t\t<bx-messenger-element-file-video :file="file"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body-wrap\', {\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-with-text\': messageText.length > 0,\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-without-text\': messageText.length <= 0,\n\t\t\t\t\t\t\t}]">\n\t\t\t\t\t\t\t\t<template v-if="messageText">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-text" v-html="messageText"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class="bx-im-message-content-params">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-date">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- keyboard --\x3e\n\t\t\t</template>\n\t\t</div>\n\t'})})(this.window=this.window||{});
//# sourceMappingURL=messenger.component.message.body.bundle.map.js