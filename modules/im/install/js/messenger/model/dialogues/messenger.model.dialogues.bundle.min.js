(function(e){"use strict";var t=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"getStore",value:function t(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{namespaced:true,state:{host:i.host||location.protocol+"//"+location.host,collection:{}},actions:{set:function t(i,n){if(n instanceof Array){n=n.map(function(t){return Object.assign({},e.getDialogBlank(),e.validate(Object.assign({},t),{host:i.state.host}),{init:true})})}else{var a=[];a.push(Object.assign({},e.getDialogBlank(),e.validate(Object.assign({},n),{host:i.state.host}),{init:true}));n=a}i.commit("set",n)},update:function t(i,n){if(typeof i.state.collection[n.dialogId]==="undefined"||i.state.collection[n.dialogId].init===false){return true}i.commit("update",{dialogId:n.dialogId,fields:e.validate(Object.assign({},n.fields),{host:i.state.host})});return true},delete:function e(t,i){t.commit("delete",i.dialogId);return true},updateWriting:function e(t,i){if(typeof t.state.collection[i.dialogId]==="undefined"||t.state.collection[i.dialogId].init===false){return true}var n=t.state.collection[i.dialogId].writingList.findIndex(function(e){return e.userId==i.userId});if(i.action){if(n>=0){return true}else{var a=[].concat(t.state.collection[i.dialogId].writingList);a.unshift({userId:i.userId,userName:i.userName});t.commit("update",{actionName:"updateWriting/1",dialogId:i.dialogId,fields:{writingList:a}})}}else{if(n>=0){var d=t.state.collection[i.dialogId].writingList.filter(function(e){return e.userId!=i.userId});t.commit("update",{actionName:"updateWriting/2",dialogId:i.dialogId,fields:{writingList:d}});return true}else{return true}}return false},increaseCounter:function e(t,i){if(typeof t.state.collection[i.dialogId]==="undefined"||t.state.collection[i.dialogId].init===false){return true}var n=t.state.collection[i.dialogId].counter;var a=n+i.count;var d={counter:a};if(typeof i.unreadLastId!=="undefined"){d.unreadLastId=i.unreadLastId}t.commit("update",{actionName:"increaseCounter",dialogId:i.dialogId,fields:d});return false},decreaseCounter:function e(t,i){if(typeof t.state.collection[i.dialogId]==="undefined"||t.state.collection[i.dialogId].init===false){return true}var n=t.state.collection[i.dialogId].counter;var a=n-i.count;if(a<0){a=0}var d=i.unreadId>t.state.collection[i.dialogId].unreadId?i.unreadId:t.state.collection[i.dialogId].unreadId;t.commit("update",{actionName:"decreaseCounter",dialogId:i.dialogId,fields:{counter:a,unreadId:d}});return false}},mutations:{initCollection:function t(i,n){if(typeof i.collection[n.dialogId]==="undefined"){BX.Vue.set(i.collection,n.dialogId,e.getDialogBlank());if(n.fields){i.collection[n.dialogId]=Object.assign(i.collection[n.dialogId],e.validate(Object.assign({},n.fields),{host:i.host}))}}},set:function e(t,i){var n=true;var a=false;var d=undefined;try{for(var o=i[Symbol.iterator](),r;!(n=(r=o.next()).done);n=true){var s=r.value;if(typeof t.collection[s.dialogId]==="undefined"){BX.Vue.set(t.collection,s.dialogId,s)}t.collection[s.dialogId]=s}}catch(e){a=true;d=e}finally{try{if(!n&&o.return!=null){o.return()}}finally{if(a){throw d}}}},update:function t(i,n){if(typeof i.collection[n.dialogId]==="undefined"){BX.Vue.set(i.collection,n.dialogId,e.getDialogBlank())}i.collection[n.dialogId]=Object.assign(i.collection[n.dialogId],n.fields)},delete:function e(t,i){delete t.collection[i.dialogId]}}}}}],[{key:"getInstance",value:function t(){return new e}},{key:"getName",value:function e(){return"messengerDialogues"}},{key:"getDialogBlank",value:function e(){return{dialogId:0,chatId:0,counter:0,unreadId:0,unreadLastId:0,readedList:[],writingList:[],init:false,name:"",owner:0,extranet:false,avatar:"",color:"#17A3EA",type:"chat",entityType:"",entityId:"",entityData1:"",entityData2:"",entityData3:"",dateCreate:new Date}}},{key:"validate",value:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n={};i.host=i.host||location.protocol+"//"+location.host;if(typeof t.dialog_id!=="undefined"){t.dialogId=t.dialog_id}if(typeof t.dialogId==="number"||typeof t.dialogId==="string"){n.dialogId=t.dialogId.toString()}if(typeof t.chat_id!=="undefined"){t.chatId=t.chat_id}else if(typeof t.id!=="undefined"){t.chatId=t.id}if(typeof t.chatId==="number"||typeof t.chatId==="string"){n.chatId=parseInt(t.chatId)}if(typeof t.counter==="number"||typeof t.counter==="string"){n.counter=parseInt(t.counter)}if(typeof t.unread_id!=="undefined"){t.unreadId=t.unread_id}if(typeof t.unreadId==="number"||typeof t.unreadId==="string"){n.unreadId=parseInt(t.unreadId)}if(typeof t.unread_last_id!=="undefined"){t.unreadLastId=t.unread_last_id}if(typeof t.unreadLastId==="number"||typeof t.unreadLastId==="string"){n.unreadLastId=parseInt(t.unreadLastId)}if(typeof t.readed_list!=="undefined"){t.readedList=t.readed_list}if(typeof t.readedList!=="undefined"){n.readedList=[];if(t.readedList instanceof Array){t.readedList.forEach(function(e){var i={};if(typeof e.user_id!=="undefined"){e.userId=e.user_id}if(typeof e.user_name!=="undefined"){e.userName=e.user_name}if(typeof e.message_id!=="undefined"){e.messageId=e.message_id}if(!e.userId||!e.userName||!e.messageId){return false}i.userId=parseInt(e.userId);i.userName=e.userName.toString();i.messageId=parseInt(e.messageId);if(t.date instanceof Date){i.date=t.date}else if(typeof t.date==="string"){i.date=new Date(t.date)}else{i.date=new Date}n.readedList.push(i)})}}if(typeof t.writing_list!=="undefined"){t.writingList=t.writing_list}if(typeof t.writingList!=="undefined"){n.writingList=[];if(t.writingList instanceof Array){t.writingList.forEach(function(e){var t={};if(!e.userId){return false}t.userId=parseInt(e.userId);t.userName=e.userName;n.writingList.push(t)})}}if(typeof t.mute_list!=="undefined"){t.muteList=t.mute_list}if(typeof t.muteList!=="undefined"){n.muteList=[];if(t.muteList instanceof Array){t.muteList.forEach(function(e){e=parseInt(e);if(e>0){n.muteList.push(e)}})}}if(typeof t.title!=="undefined"){t.name=t.title}if(typeof t.name==="string"||typeof t.name==="number"){n.name=t.name.toString()}if(typeof t.owner!=="undefined"){t.ownerId=t.owner}if(typeof t.ownerId==="number"||typeof t.ownerId==="string"){n.ownerId=parseInt(t.ownerId)}if(typeof t.extranet==="boolean"){n.extranet=t.extranet}if(typeof t.avatar==="string"){if(!t.avatar||t.avatar.startsWith("http")){n.avatar=t.avatar}else{n.avatar=i.host+t.avatar}}if(typeof t.color==="string"){n.color=t.color.toString()}if(typeof t.type==="string"){n.type=t.type.toString()}if(typeof t.entity_type!=="undefined"){t.entityType=t.entity_type}if(typeof t.entityType==="string"){n.entityType=t.entityType.toString()}if(typeof t.entity_id!=="undefined"){t.entityId=t.entity_id}if(typeof t.entityId==="string"||typeof t.entityId==="number"){n.entityId=t.entityId.toString()}if(typeof t.entity_data_1!=="undefined"){t.entityData1=t.entity_data_1}if(typeof t.entityData1==="string"){n.entityData1=t.entityData1.toString()}if(typeof t.entity_data_2!=="undefined"){t.entityData2=t.entity_data_2}if(typeof t.entityData2==="string"){n.entityData2=t.entityData2.toString()}if(typeof t.entity_data_3!=="undefined"){t.entityData3=t.entity_data_3}if(typeof t.entityData3==="string"){n.entityData3=t.entityData3.toString()}if(typeof t.date_create!=="undefined"){t.dateCreate=t.date_create}if(t.dateCreate instanceof Date){n.dateCreate=t.dateCreate}else if(typeof t.dateCreate==="string"){n.dateCreate=new Date(t.dateCreate)}return n}}]);return e}();if(!window.BX){window.BX={}}if(typeof window.BX.Messenger=="undefined"){window.BX.Messenger={}}if(typeof window.BX.Messenger.Model=="undefined"){window.BX.Messenger.Model={}}if(typeof window.BX.Messenger.Model.Dialogues=="undefined"){BX.Messenger.Model.Dialogues=t}})(this.window=this.window||{});
//# sourceMappingURL=messenger.model.dialogues.bundle.map.js