this.BX=this.BX||{};this.BX.Im=this.BX.Im||{};(function(e,t,a,s){"use strict";var i,l;function r(e,t){c(e,t);t.add(e)}function n(e,t,a){c(e,t);t.set(e,a)}function c(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function b(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var d=t.Reflection.namespace("BX.Im.Activity");var o=new WeakMap;var p=new WeakMap;var v=new WeakMap;var h=new WeakMap;var u=new WeakMap;var m=new WeakMap;var f=new WeakMap;var g=new WeakMap;var w=new WeakMap;var H=new WeakSet;var F=new WeakSet;var P=new WeakSet;var G=new WeakSet;var S=new WeakSet;var k=new WeakSet;var T=new WeakSet;var y=function(){function e(a){babelHelpers.classCallCheck(this,e);r(this,T);r(this,k);r(this,S);r(this,G);r(this,P);r(this,F);r(this,H);n(this,o,{writable:true,value:void 0});n(this,p,{writable:true,value:void 0});n(this,v,{writable:true,value:void 0});n(this,h,{writable:true,value:void 0});n(this,u,{writable:true,value:void 0});n(this,m,{writable:true,value:void 0});n(this,f,{writable:true,value:void 0});n(this,g,{writable:true,value:void 0});n(this,w,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,o,a.form);babelHelpers.classPrivateFieldSet(this,v,a.isRobot);babelHelpers.classPrivateFieldSet(this,p,a.documentType);babelHelpers.classPrivateFieldSet(this,h,a.currentValues);babelHelpers.classPrivateFieldSet(this,m,a.messageTemplateFields);babelHelpers.classPrivateFieldSet(this,f,a.messageTemplateList);babelHelpers.classPrivateFieldSet(this,g,document.getElementById("id_message_fields"));babelHelpers.classPrivateFieldSet(this,w,document.querySelector('[data-role="message-type"]'));if(!t.Type.isPlainObject(babelHelpers.classPrivateFieldGet(this,h)["message_fields"])){babelHelpers.classPrivateFieldGet(this,h)["message_fields"]={}}}babelHelpers.createClass(e,[{key:"init",value:function e(){var a=this;b(this,k,X).call(this);b(this,T,C).call(this);t.Event.bind(babelHelpers.classPrivateFieldGet(this,u).getTargetNode(),"click",(function(){babelHelpers.classPrivateFieldGet(a,u).show()}));b(this,H,W).call(this,babelHelpers.classPrivateFieldGet(this,o)["message_template"].value,true)}},{key:"showTemplateMessageFields",value:function e(a){var s=this;if(!babelHelpers.classPrivateFieldGet(this,g)){return}t.Dom.clean(babelHelpers.classPrivateFieldGet(this,g));if(babelHelpers.classPrivateFieldGet(this,m).hasOwnProperty(a)){Object.entries(babelHelpers.classPrivateFieldGet(this,m)[a]).forEach((function(e){var a=babelHelpers.slicedToArray(e,2),i=a[0],l=a[1];t.Dom.append(b(s,F,M).call(s,i,l),babelHelpers.classPrivateFieldGet(s,g))}))}}}]);return e}();function W(e,t){if(babelHelpers.classPrivateFieldGet(this,o)["message_template"].value===e&&!t){return}if(babelHelpers.classPrivateFieldGet(this,w)){babelHelpers.classPrivateFieldGet(this,o)["message_template"].value=e;babelHelpers.classPrivateFieldGet(this,w).textContent=babelHelpers.classPrivateFieldGet(this,f)[e]||""}this.showTemplateMessageFields(e)}function M(e,t){return babelHelpers.classPrivateFieldGet(this,v)?b(this,P,B).call(this,e,t):b(this,G,_).call(this,e,t)}function B(e,a){return t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="bizproc-automation-popup-settings">\n\t\t\t\t<span class="bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-top bizproc-automation-popup-settings-title-autocomplete">\n\t\t\t\t\t',"\n\t\t\t\t</span>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),t.Text.encode(a.Name),b(this,S,I).call(this,e,a))}function _(e,a){return t.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tr>\n\t\t\t\t<td align="right" width="40%">\n\t\t\t\t\t',"\n\t\t\t\t\t",":\n\t\t\t\t\t",'\n\t\t\t\t</td>\n\t\t\t\t<td width="60%">\n\t\t\t\t\t',"\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t"])),a.Required?'<span class="adm-required-field">':"",t.Text.encode(a.Name),a.Required?"</span>":"",b(this,S,I).call(this,e,a))}function I(e,t){var a=this;var s=t["FieldName"];var i=BX.Bizproc.FieldType.renderControl(babelHelpers.classPrivateFieldGet(this,p),t,s,babelHelpers.classPrivateFieldGet(this,h)["message_fields"][e],babelHelpers.classPrivateFieldGet(this,v)?"public":"designer");i.onchange=function(t){babelHelpers.classPrivateFieldGet(a,h)["message_fields"][e]=t.target.value};return i}function X(){var e="chat_id";var t=babelHelpers.classPrivateFieldGet(this,o)[e];babelHelpers.classPrivateFieldSet(this,u,new a.Dialog({entities:[{id:"im-chat",options:{searchableChatTypes:["C"]}}],targetNode:t,multiple:false,enableSearch:true,hideOnSelect:true,height:300,width:490,autoHide:true,compactView:true,showAvatars:false,dropdownMode:true,events:{"Item:onBeforeSelect":function e(a){a.preventDefault();t.value=a.getData().item.getId()}}}));babelHelpers.classPrivateFieldGet(this,u).load()}function C(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,v)){t.Event.bind(babelHelpers.classPrivateFieldGet(this,o)["message_template"],"change",(function(t){b(e,H,W).call(e,t.target.value,true)}));return}var a=new s.MessageTemplateSelector;t.Event.bind(babelHelpers.classPrivateFieldGet(this,w),"click",(function(){a.show(babelHelpers.classPrivateFieldGet(e,w),babelHelpers.classPrivateFieldGet(e,o)["message_template"].value)}));a.subscribe("select",(function(t){b(e,H,W).call(e,t.getData().selected)}))}d.ImAddMessageToGroupChatActivity=y})(this.BX.Im.Activity=this.BX.Im.Activity||{},BX,BX.UI.EntitySelector,BX.IM.Robot);
//# sourceMappingURL=script.map.js