{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Dom, Loc, Tag, Reflection, Cache, Event} from 'main.core';\nimport {Manager} from 'rpa.manager';\nimport jsDDObject from 'main/install/js/main/dd.js';\n\nconst namespace = Reflection.namespace('BX.Rpa');\n\nclass DragDropBtn\n{\n\tconstructor(options) {\n\t\tthis.btnContainer = options;\n\t\tthis.draggableBtnContainer = null;\n\t\tthis.dragElement = null;\n\t\tthis.cache = new Cache.MemoryCache();\n\t}\n\n\tinit()\n\t{\n\t\tconst dragButton = this.getDragButton();\n\t\tDom.prepend(dragButton, this.btnContainer);\n\n\t\tdragButton.onbxdragstart = this.onDragStart.bind(this);\n\t\tdragButton.onbxdrag = this.onDrag.bind(this);\n\t\tdragButton.onbxdragstop = this.onDragStop.bind(this);\n\t\tjsDD.registerObject(dragButton);\n\n\t\tthis.btnContainer.onbxdestdraghover = this.onDragEnter.bind(this);\n\t\tthis.btnContainer.onbxdestdraghout = this.onDragLeave.bind(this);\n\t\tthis.btnContainer.onbxdestdragfinish = this.onDragDrop.bind(this);\n\n\t\tjsDD.registerDest(this.btnContainer, 30);\n\t}\n\n\tgetDragButton(): HTMLSpanElement | jsDDObject\n\t{\n\t\treturn this.cache.remember('dragButton', () => (\n\t\t\tTag.render`\n\t\t\t\t<span class=\"rpa-edit-robot-btn-icon-draggable\"></span>\n\t\t\t`\n\t\t));\n\t}\n\n\tonDragStart()\n\t{\n\t\tDom.addClass(this.btnContainer, \"rpa-edit-robot-btn-item-disabled\");\n\n\t\tif (!this.dragElement)\n\t\t{\n\t\t\tthis.dragElement = this.btnContainer.cloneNode(true);\n\n\t\t\tthis.dragElement.style.position = \"absolute\";\n\t\t\tthis.dragElement.style.width = this.btnContainer.offsetWidth + \"px\";\n\t\t\tthis.dragElement.className = \"rpa-edit-robot-btn-item rpa-edit-robot-btn-item-drag\";\n\n\t\t\tDom.append(this.dragElement, document.body);\n\t\t}\n\t}\n\n\tonDrag(x, y)\n\t{\n\t\tif (this.dragElement)\n\t\t{\n\t\t\tthis.dragElement.style.left = x + \"px\";\n\t\t\tthis.dragElement.style.top = y + \"px\";\n\t\t}\n\t}\n\n\tonDragStop()\n\t{\n\t\tDom.removeClass(this.btnContainer, \"rpa-edit-robot-btn-item-disabled\");\n\t\tDom.remove(this.dragElement);\n\t\tthis.dragElement = null;\n\t}\n\n\tonDragEnter(draggableItem)\n\t{\n\t\tthis.draggableBtnContainer = draggableItem.closest('.rpa-edit-robot-btn-item');\n\t\tif (this.draggableBtnContainer !== this.btnContainer)\n\t\t{\n\t\t\tthis.showDragTarget();\n\t\t}\n\t}\n\n\tonDragLeave()\n\t{\n\t\tthis.hideDragTarget();\n\t}\n\n\tonDragDrop()\n\t{\n\t\tif (this.draggableBtnContainer !== this.btnContainer)\n\t\t{\n\t\t\tthis.hideDragTarget();\n\t\t\tDom.remove(this.draggableBtnContainer);\n\t\t\tDom.insertBefore(this.draggableBtnContainer, this.btnContainer);\n\t\t}\n\t}\n\n\tshowDragTarget()\n\t{\n\t\tDom.addClass(this.btnContainer, 'rpa-edit-robot-btn-item-target-shown');\n\t\tthis.getDragTarget().style.height = this.btnContainer.offsetHeight + \"px\";\n\t}\n\n\thideDragTarget()\n\t{\n\t\tDom.removeClass(this.btnContainer, \"rpa-edit-robot-btn-item-target-shown\");\n\t\tthis.getDragTarget().style.height = 0;\n\t}\n\n\tgetDragTarget()\n\t{\n\t\tif (!this.dragTarget)\n\t\t{\n\t\t\tthis.dragTarget = Tag.render`<div class=\"rpa-edit-robot-btn-item-drag-target\"></div>`;\n\t\t\tDom.prepend(this.dragTarget, this.btnContainer);\n\t\t}\n\n\t\treturn this.dragTarget;\n\t}\n\n}\n\nclass DragDropBtnContainer\n{\n\tconstructor() {\n\n\t\tthis.container = document.querySelector('.rpa-edit-robot-btn-item-list');\n\t\tthis.height = null;\n\t}\n\n\tinit()\n\t{\n\t\tthis.container.onbxdestdraghover = BX.delegate(this.onDragEnter, this);\n\t\tthis.container.onbxdestdraghout = BX.delegate(this.onDragLeave, this);\n\t\tthis.container.onbxdestdragfinish = BX.delegate(this.onDragDrop, this);\n\t\tjsDD.registerDest(this.container, 40);\n\t}\n\n\tonDragEnter(draggableItem)\n\t{\n\t\tthis.draggableBtnContainer = draggableItem.closest('.rpa-edit-robot-btn-item');\n\t\tthis.height = this.draggableBtnContainer.offsetHeight;\n\n\t\tthis.showDragTarget();\n\t}\n\n\tonDragLeave()\n\t{\n\t\tthis.hideDragTarget();\n\t}\n\n\tonDragDrop()\n\t{\n\t\tthis.hideDragTarget();\n\t\tDom.remove(this.draggableBtnContainer);\n\t\tDom.insertBefore(this.draggableBtnContainer, this.dragTarget);\n\t}\n\n\tshowDragTarget()\n\t{\n\t\tDom.addClass(this.container, 'rpa-edit-robot-btn-list-target-shown');\n\t\tthis.getDragTarget().style.height = this.height + \"px\";\n\t}\n\n\thideDragTarget()\n\t{\n\t\tDom.removeClass(this.container, \"rpa-edit-robot-btn-list-target-shown\");\n\t\tthis.getDragTarget().style.height = 0;\n\t}\n\n\tgetDragTarget()\n\t{\n\t\tif (!this.dragTarget)\n\t\t{\n\t\t\tthis.dragTarget = Tag.render`<div class=\"rpa-edit-robot-btn-list-target-target\"></div>`;\n\t\t\tDom.append(this.dragTarget, this.container);\n\t\t}\n\n\t\treturn this.dragTarget;\n\t}\n\n}\n\nnamespace.DragDropBtn = DragDropBtn;\nnamespace.DragDropBtnContainer = DragDropBtnContainer;"],"names":["namespace","Reflection","DragDropBtn","options","btnContainer","draggableBtnContainer","dragElement","cache","Cache","MemoryCache","dragButton","getDragButton","Dom","prepend","onbxdragstart","onDragStart","bind","onbxdrag","onDrag","onbxdragstop","onDragStop","jsDD","registerObject","onbxdestdraghover","onDragEnter","onbxdestdraghout","onDragLeave","onbxdestdragfinish","onDragDrop","registerDest","remember","Tag","render","addClass","cloneNode","style","position","width","offsetWidth","className","append","document","body","x","y","left","top","removeClass","remove","draggableItem","closest","showDragTarget","hideDragTarget","insertBefore","getDragTarget","height","offsetHeight","dragTarget","DragDropBtnContainer","container","querySelector","BX","delegate"],"mappings":"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"}