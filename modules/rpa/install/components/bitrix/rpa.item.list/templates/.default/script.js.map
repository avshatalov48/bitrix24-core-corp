{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Event, Reflection, Text, Type} from 'main.core';\n\nconst namespace = Reflection.namespace('BX.Rpa');\n\nclass ItemsListComponent\n{\n\ttypeId = 0;\n\tgridId = null;\n\teventIds;\n\tkanbanPullTag = null;\n\tgrid = null;\n\n\tconstructor(params: {\n\t\ttypeId: number,\n\t\tkanbanPullTag: ?string,\n\t\tgridId: ?string,\n\t})\n\t{\n\t\tif(Type.isPlainObject(params))\n\t\t{\n\t\t\tthis.typeId = Text.toInteger(params.typeId);\n\t\t\tthis.gridId = params.gridId;\n\t\t\tthis.kanbanPullTag = params.kanbanPullTag;\n\t\t}\n\n\t\tthis.eventIds = new Set();\n\n\t\tthis.bindEvents();\n\t}\n\n\tgetGrid(): ?BX.Main.grid\n\t{\n\t\tif(this.grid)\n\t\t{\n\t\t\treturn this.grid;\n\t\t}\n\n\t\tif(this.gridId && BX.Main.grid && BX.Main.gridManager)\n\t\t{\n\t\t\tthis.grid = BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t}\n\n\t\treturn this.grid;\n\t}\n\n\tbindEvents()\n\t{\n\t\tEvent.ready(() =>\n\t\t{\n\t\t\tconst Pull = BX.PULL;\n\t\t\tif(!Pull)\n\t\t\t{\n\t\t\t\tconsole.error('pull is not initialized');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(Type.isString(this.kanbanPullTag) && this.typeId > 0)\n\t\t\t{\n\t\t\t\tPull.subscribe({\n\t\t\t\t\tmoduleId: 'rpa',\n\t\t\t\t\tcommand: this.kanbanPullTag,\n\t\t\t\t\tcallback: (params) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tif(Type.isString(params.eventName))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(Type.isString(params.eventId))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(this.eventIds.has(params.eventId))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(params.eventName.indexOf('ITEMUPDATED' + this.typeId) === 0 && Type.isPlainObject(params.item))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.onPullItemUpdated(params.item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonPullItemUpdated(item: {\n\t\t\tid: number,\n\t})\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif(!grid)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst row = grid.getRows().getById(item.id);\n\t\tif(!row)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\trow.update()\n\t}\n}\n\nnamespace.ItemsListComponent = ItemsListComponent;"],"names":["namespace","Reflection","ItemsListComponent","params","Type","isPlainObject","typeId","Text","toInteger","gridId","kanbanPullTag","eventIds","Set","bindEvents","grid","BX","Main","gridManager","getInstanceById","Event","ready","Pull","PULL","console","error","isString","subscribe","moduleId","command","callback","eventName","eventId","has","indexOf","item","onPullItemUpdated","getGrid","row","getRows","getById","id","update"],"mappings":";;;CAEA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAX,CAAqB,QAArB,CAAlB;;KAEME;;;CAQL,8BAAYC,MAAZ,EAKA;CAAA;CAAA,gDAXS,CAWT;CAAA,gDAVS,IAUT;CAAA,uDARgB,IAQhB;CAAA,8CAPO,IAOP;;CACC,QAAGC,cAAI,CAACC,aAAL,CAAmBF,MAAnB,CAAH,EACA;CACC,WAAKG,MAAL,GAAcC,cAAI,CAACC,SAAL,CAAeL,MAAM,CAACG,MAAtB,CAAd;CACA,WAAKG,MAAL,GAAcN,MAAM,CAACM,MAArB;CACA,WAAKC,aAAL,GAAqBP,MAAM,CAACO,aAA5B;CACA;;CAED,SAAKC,QAAL,GAAgB,IAAIC,GAAJ,EAAhB;CAEA,SAAKC,UAAL;CACA;;;;+BAGD;CACC,UAAG,KAAKC,IAAR,EACA;CACC,eAAO,KAAKA,IAAZ;CACA;;CAED,UAAG,KAAKL,MAAL,IAAeM,EAAE,CAACC,IAAH,CAAQF,IAAvB,IAA+BC,EAAE,CAACC,IAAH,CAAQC,WAA1C,EACA;CACC,aAAKH,IAAL,GAAYC,EAAE,CAACC,IAAH,CAAQC,WAAR,CAAoBC,eAApB,CAAoC,KAAKT,MAAzC,CAAZ;CACA;;CAED,aAAO,KAAKK,IAAZ;CACA;;;kCAGD;CAAA;;CACCK,MAAAA,eAAK,CAACC,KAAN,CAAY,YACZ;CACC,YAAMC,IAAI,GAAGN,EAAE,CAACO,IAAhB;;CACA,YAAG,CAACD,IAAJ,EACA;CACCE,UAAAA,OAAO,CAACC,KAAR,CAAc,yBAAd;CACA;CACA;;CACD,YAAGpB,cAAI,CAACqB,QAAL,CAAc,KAAI,CAACf,aAAnB,KAAqC,KAAI,CAACJ,MAAL,GAAc,CAAtD,EACA;CACCe,UAAAA,IAAI,CAACK,SAAL,CAAe;CACdC,YAAAA,QAAQ,EAAE,KADI;CAEdC,YAAAA,OAAO,EAAE,KAAI,CAAClB,aAFA;CAGdmB,YAAAA,QAAQ,EAAE,kBAAC1B,MAAD,EACV;CACC,kBAAGC,cAAI,CAACqB,QAAL,CAActB,MAAM,CAAC2B,SAArB,CAAH,EACA;CACC,oBAAG1B,cAAI,CAACqB,QAAL,CAActB,MAAM,CAAC4B,OAArB,CAAH,EACA;CACC,sBAAG,KAAI,CAACpB,QAAL,CAAcqB,GAAd,CAAkB7B,MAAM,CAAC4B,OAAzB,CAAH,EACA;CACC;CACA;CACD;;CACD,oBAAG5B,MAAM,CAAC2B,SAAP,CAAiBG,OAAjB,CAAyB,gBAAgB,KAAI,CAAC3B,MAA9C,MAA0D,CAA1D,IAA+DF,cAAI,CAACC,aAAL,CAAmBF,MAAM,CAAC+B,IAA1B,CAAlE,EACA;CACC,kBAAA,KAAI,CAACC,iBAAL,CAAuBhC,MAAM,CAAC+B,IAA9B;CACA;CACD;CACD;CAnBa,WAAf;CAqBA;CACD,OAhCD;CAiCA;;;uCAEiBA,MAGlB;CACC,UAAMpB,IAAI,GAAG,KAAKsB,OAAL,EAAb;;CACA,UAAG,CAACtB,IAAJ,EACA;CACC;CACA;;CACD,UAAMuB,GAAG,GAAGvB,IAAI,CAACwB,OAAL,GAAeC,OAAf,CAAuBL,IAAI,CAACM,EAA5B,CAAZ;;CACA,UAAG,CAACH,GAAJ,EACA;CACC;CACA;;CAEDA,MAAAA,GAAG,CAACI,MAAJ;CACA;;;;;CAGFzC,SAAS,CAACE,kBAAV,GAA+BA,kBAA/B;;;;"}