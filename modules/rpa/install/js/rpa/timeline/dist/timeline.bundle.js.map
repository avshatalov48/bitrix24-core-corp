{"version":3,"file":"timeline.bundle.js","sources":["../src/task.js","../src/taskcomplete.js","../src/timeline.js"],"sourcesContent":["import {ajax, Tag, Text, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Timeline} from 'ui.timeline';\nimport {Manager} from \"rpa.manager\";\nimport {Popup} from \"main.popup\";\n\n/**\n * @memberOf BX.Rpa.Timeline\n * @mixes EventEmitter\n */\nexport class Task extends Timeline.Item\n{\n\tstatusWait = 0;\n\tstatusYes = 1;\n\tstatusNo = 2;\n\tstatusOk = 3;\n\tstatusCancel = 4;\n\n\tconstructor(props)\n\t{\n\t\tsuper(props);\n\t\tthis.setEventNamespace('BX.Rpa.Timeline.Task');\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'task-' + this.id;\n\t}\n\n\tgetTaskUsers(): Array\n\t{\n\t\treturn this.data.users;\n\t}\n\n\trender(): Element\n\t{\n\t\tthis.layout.container = this.renderContainer();\n\n\t\tthis.layout.container.appendChild(this.renderIcon());\n\t\tthis.layout.container.appendChild(this.renderContent());\n\n\t\treturn this.layout.container;\n\t}\n\n\trenderContainer(): Element\n\t{\n\t\treturn Tag.render`<div class=\"ui-item-detail-stream-section ui-item-detail-stream-section-task ${(this.isLast ? 'ui-item-detail-stream-section-last' : '')}\"></div>`;\n\t}\n\n\trenderHeader(): Element\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-item-detail-stream-content-header\">\n\t\t\t\t<div class=\"ui-item-detail-stream-content-title\">\n\t\t\t\t\t<span class=\"ui-item-detail-stream-content-title-text\">${Loc.getMessage('RPA_TIMELINE_TASKS_TITLE')}</span>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t}\n\n\trenderMain(): Element\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-item-detail-stream-content-detail\">\n\t\t\t\t<div class=\"ui-item-detail-stream-content-detail-subject\">\n\t\t\t\t\t${this.renderParticipants()}\n\t\t\t\t\t<div class=\"ui-item-detail-stream-content-detail-subject-inner\">\n\t\t\t\t\t\t<a class=\"ui-item-detail-stream-content-detail-subject-text\" href=\"${Text.encode(this.data.url)}\">${Text.encode(this.getTitle())}</a>\n\t\t\t\t\t\t${this.renderParticipantsLine()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-item-detail-stream-content-detail-main\">\n\t\t\t\t\t<span class=\"ui-item-detail-stream-content-detail-main-text\">${Text.encode(this.description)}</span>\n\t\t\t\t</div>\n\t\t\t\t${this.renderTaskFields()}\n\t\t\t\t${this.renderTaskButtons()}\n\t\t\t</div>`;\n\t}\n\n\trenderParticipants(): Element\n\t{\n\t\tlet photos = this.getTaskUsers().map(({id, status}) => {\n\t\t\treturn this.renderParticipantPhoto(id)\n\t\t});\n\n\t\tif (photos.length > 4)\n\t\t{\n\t\t\tlet counter = photos.length - 4;\n\t\t\tphotos = photos.slice(0, 4);\n\n\t\t\tphotos.push(\n\t\t\t\tTag.render`<span class=\"ui-item-detail-stream-content-other\">\n\t\t\t\t\t\t<span class=\"ui-item-detail-stream-content-other-text\">+${counter}</span>\n\t\t\t\t\t</span>`\n\t\t\t);\n\t\t}\n\n\t\treturn Tag.render`<div class=\"ui-item-detail-stream-content-employee-wrap\" onclick=\"${this.showParticipants.bind(this)}\">\n\t\t\t\t${photos}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderParticipantsLine(): Element\n\t{\n\t\tlet elements = [];\n\t\tlet taskUsers = this.getTaskUsers();\n\n\t\ttaskUsers.forEach(({id, status}, i) => {\n\t\t\tlet node = Tag.render`<span class=\"ui-item-detail-stream-content-detail-subject-resp\">${Text.encode(this.getTaskUserName(id))}</span>`;\n\n\t\t\tif (status > this.statusWait)\n\t\t\t{\n\t\t\t\tnode.classList.add('ui-item-detail-stream-content-detail-subject-resp-past');\n\t\t\t}\n\t\t\telse if (id === this.getUserId())\n\t\t\t{\n\t\t\t\tnode.classList.add('ui-item-detail-stream-content-detail-subject-resp-current');\n\t\t\t}\n\n\t\t\telements.push(node);\n\n\t\t\tif (this.data.participantJoint !== 'queue' && taskUsers.length - 1 !== i)\n\t\t\t{\n\t\t\t\tlet msg = this.data.participantJoint === 'and' ? 'RPA_TIMELINE_TASKS_SEPARATOR_AND' : 'RPA_TIMELINE_TASKS_SEPARATOR_OR';\n\t\t\t\telements.push(Tag.render`<span class=\"ui-item-detail-stream-content-detail-subject-separator\">${Loc.getMessage(msg)}</span>`);\n\t\t\t}\n\t\t});\n\n\t\tlet queueCls = (\n\t\t\tthis.data.participantJoint === 'queue'? 'ui-item-detail-stream-content-detail-subject-resp-wrap-queue' : ''\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-item-detail-stream-content-detail-subject-resp-wrap ${queueCls}\">\n\t\t\t\t${elements}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowParticipants(event): void\n\t{\n\t\tlet taskUsers = this.getTaskUsers();\n\t\tlet users = taskUsers.map(({id, status}, i) => {\n\n\t\t\tlet user = this.users.get(id);\n\t\t\tlet sep = (taskUsers.length -1 !== i)\n\t\t\t\t? Tag.render`<span class=\"ui-item-detail-popup-item-separator\">\n\t\t\t\t\t${Loc.getMessage(this.data.participantJoint === 'and'\n\t\t\t\t\t? 'RPA_TIMELINE_TASKS_SEPARATOR_AND' : 'RPA_TIMELINE_TASKS_SEPARATOR_OR')}\n\t\t\t\t\t</span>`\n\t\t\t\t: ''\n\t\t\t;\n\n\t\t\tlet node = Tag.render`<div class=\"ui-item-detail-popup-item\">\n\t\t\t\t\t<a class=\"ui-item-detail-stream-content-employee\"\n\t\t\t\t\t   ${user.link? `href=\"${user.link}\"`:''}\n\t\t\t\t\t   target=\"_blank\"\n\t\t\t\t\t   title=\"${Text.encode(user.fullName)}\"\n\t\t\t\t\t   ${user.photo? `style=\"background-image: url('${user.photo}'); background-size: 100%;\"`:''}></a>\n\t\t\t\t\t<div class=\"ui-item-detail-popup-item-inner\">\n\t\t\t\t\t\t<span class=\"ui-item-detail-popup-item-name\">${Text.encode(user.fullName)}</span>\n\t\t\t\t\t\t<span class=\"ui-item-detail-popup-item-position\">${user.workPosition}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t${sep}\n\t\t\t\t</div>`;\n\n\t\t\tif (status > this.statusWait)\n\t\t\t{\n\t\t\t\tnode.classList.add('ui-item-detail-popup-item-'\n\t\t\t\t\t+ (status === this.statusOk || status === this.statusYes ? 'success' : 'fail')\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnode.classList.add('ui-item-detail-popup-item-'\n\t\t\t\t\t+ (id === this.getUserId() ? 'current' : 'wait')\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn node;\n\t\t});\n\n\t\tlet content = Tag.render`\n\t\t\t\t\t<div class=\"ui-item-detail-popup\">\n\t\t\t\t\t\t${users}\n\t\t\t\t\t</div>`;\n\n\t\tif (this.data.participantJoint !== 'queue')\n\t\t{\n\t\t\tcontent.classList.add('ui-item-detail-popup-option');\n\t\t}\n\n\t\tlet popup = new Popup('rpa-detail-task-participant-' + this.getId(), event.target, {\n\t\t\tautoHide: true,\n\t\t\tdraggable: false,\n\t\t\tbindOptions: { forceBindPosition: true },\n\t\t\tnoAllPaddings: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcacheable: false,\n\t\t\twidth: 280,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\toverlay: { backgroundColor: 'transparent' },\n\t\t\tcontent: content\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\trenderTaskButtons(): Element|string\n\t{\n\t\tconst controls = this.data.controls;\n\n\t\tif (!controls)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst elements = this.data.type === 'RpaRequestActivity'\n\t\t\t? this.getLinkButtonElements(controls.BUTTONS)\n\t\t\t: this.getActionButtonElements(controls.BUTTONS);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-item-detail-stream-content-detail-status-block\">\n\t\t\t\t${elements}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetActionButtonElements(buttons: Array)\n\t{\n\t\treturn buttons.map(\n\t\t\t(button) => {\n\t\t\t\tlet bgColor = button.COLOR;\n\t\t\t\tlet fgColor = Manager.calculateTextColor(button.COLOR);\n\n\t\t\t\treturn Tag.render`<button class=\"ui-btn ui-btn-sm ui-btn-default\" \n\t\t\t\t\tname=\"${button.NAME}\"\n\t\t\t\t\tvalue=\"${button.VALUE}\"\n\t\t\t\t\tstyle=\"background-color: #${bgColor};border-color: #${bgColor};color:${fgColor}\"\n\t\t\t\t\tonclick=\"${this.doTaskHandler.bind(this, button)}\"\n\t\t\t\t\t>${Text.encode(button.TEXT)}</button>\n\t\t\t\t`;\n\t\t\t}\n\t\t)\n\t}\n\n\tgetLinkButtonElements(buttons: Array)\n\t{\n\t\treturn [\n\t\t\tTag.render`<a class=\"ui-btn ui-btn-sm ui-btn-default ui-btn-primary\" \n\t\t\t\t\thref=\"${Text.encode(this.data.url)}\"\n\t\t\t\t\t>${Loc.getMessage('RPA_TIMELINE_TASKS_OPEN_TASK')}</a>\n\t\t\t`\n\t\t];\n\t}\n\n\trenderTaskFields(): Element\n\t{\n\t\tif (!this.data.fieldsToSet)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst elements = this.data.fieldsToSet.map(\n\t\t\t(field) => {\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"ui-item-detail-stream-content-detail-main-field-value\">&ndash; ${Text.encode(field)}</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-item-detail-stream-content-detail-main-field\">\n\t\t\t\t<div class=\"ui-item-detail-stream-content-detail-main-field-title\">${Loc.getMessage('RPA_TIMELINE_TASKS_FIELDS_TO_SET')}</div>\n\t\t\t\t<div class=\"ui-item-detail-stream-content-detail-main-field-value-block\">\n\t\t\t\t\t${elements}\n\t\t\t\t</div>\n\t\t\t</div>\t\t\n\t\t`;\n\t}\n\n\tgetTaskUserName(id): string\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\tid = this.getUserId();\n\t\t}\n\n\t\tlet userData = this.users.get(Text.toInteger(id));\n\t\treturn userData ? userData.fullName : '-?-';\n\t}\n\n\trenderParticipantPhoto(userId: ?number): Element\n\t{\n\t\tuserId = Text.toInteger(userId);\n\t\tlet userData = {\n\t\t\tfullName: '',\n\t\t\tphoto: null,\n\t\t};\n\t\tif(userId > 0)\n\t\t{\n\t\t\tuserData = this.users.get(userId);\n\t\t}\n\t\tif(!userData)\n\t\t{\n\t\t\treturn Tag.render`<span></span>`;\n\t\t}\n\n\t\tconst safeFullName = Text.encode(userData.fullName);\n\t\treturn Tag.render`<span class=\"ui-item-detail-stream-content-employee\" title=\"${safeFullName}\" ${userData.photo ? `style=\"background-image: url('${userData.photo}'); background-size: 100%;\"` : ''}></span>`;\n\t}\n\n\tdoTaskHandler(button)\n\t{\n\t\tconst ajaxData = {};\n\t\tajaxData[button.NAME] = button.VALUE;\n\t\tajaxData['taskId'] = this.id;\n\n\t\tthis.emit('onBeforeCompleteTask', {\n\t\t\ttaskId: this.id,\n\t\t});\n\n\t\tajax.runAction('rpa.task.do', {\n\t\t\tanalyticsLabel: 'rpaTaskDo',\n\t\t\tdata: ajaxData,\n\t\t}).then((response) =>\n\t\t{\n\t\t\tif (response.data.completed)\n\t\t\t{\n\t\t\t\tif(response.data.timeline)\n\t\t\t\t{\n\t\t\t\t\tthis.completedData = response.data.timeline;\n\t\t\t\t}\n\t\t\t\tthis.onDelete();\n\t\t\t\tthis.emit('onCompleteTask', {\n\t\t\t\t\ttaskId: this.id,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}","import {Tag, Text, Type} from 'main.core';\nimport {Timeline} from 'ui.timeline';\n\nexport class TaskComplete extends Timeline.History\n{\n\trenderContainer(): Element\n\t{\n\t\tconst container = super.renderContainer();\n\t\tcontainer.classList.add('ui-item-detail-stream-section-history');\n\n\t\treturn container;\n\t}\n\n\trenderTaskInfo(): Element\n\t{\n\t\tlet taskName = this.renderTaskName();\n\t\tif(!taskName)\n\t\t{\n\t\t\ttaskName = '';\n\t\t}\n\n\t\tlet taskResponsible = this.renderTaskResponsible();\n\t\tif(!taskResponsible)\n\t\t{\n\t\t\ttaskResponsible = '';\n\t\t}\n\n\t\treturn Tag.render`<div class=\"ui-item-detail-stream-content-detail-subject\">\n\t\t\t${this.renderHeaderUser(this.getUserId(), 30)}\n\t\t\t<div class=\"ui-item-detail-stream-content-detail-subject-inner\">\n\t\t\t\t${taskName}\n\t\t\t\t${taskResponsible}\n\t\t\t</div>\n\t\t</div>`;\n\t}\n\n\trenderTaskName(): ?Element\n\t{\n\t\tconst task = this.getTask();\n\t\tif(task)\n\t\t{\n\t\t\treturn Tag.render`<a class=\"ui-item-detail-stream-content-detail-subject-text\">${Text.encode(task.NAME)}</a>`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\trenderTaskResponsible(): ?Element\n\t{\n\t\tlet user = this.users.get(Text.toInteger(this.getUserId()));\n\t\tif(user)\n\t\t{\n\t\t\treturn Tag.render`<span class=\"ui-item-detail-stream-content-detail-subject-resp\">${Text.encode(user.fullName)}</span>`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\trenderMain(): Element\n\t{\n\t\tlet taskInfo = this.renderTaskInfo();\n\t\tlet detailMain = this.renderDetailMain();\n\t\tif(!detailMain)\n\t\t{\n\t\t\ttaskInfo.classList.add('rpa-item-detail-stream-content-detail-no-main');\n\t\t}\n\n\t\treturn Tag.render`<div class=\"ui-item-detail-stream-content-detail\">\n\t\t\t${taskInfo}\n\t\t\t${detailMain || ''}\n\t\t</div>`;\n\t}\n\n\tgetTask(): ?{NAME: ?string, DESCRIPTION: ?string, USERS: ?Array}\n\t{\n\t\tif(Type.isPlainObject(this.data.task))\n\t\t{\n\t\t\treturn this.data.task;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\trenderDetailMain(): Element\n\t{\n\t\tconst task = this.getTask();\n\t\tlet taskDescription = '';\n\t\tif(task && task.DESCRIPTION)\n\t\t{\n\t\t\ttaskDescription = Tag.render`<span class=\"ui-item-detail-stream-content-detail-main-text\">${Text.encode(task.DESCRIPTION)}</span>`;\n\t\t}\n\n\t\tlet stageChange = this.renderStageChange();\n\t\tlet fieldsChange = this.renderFieldsChange();\n\t\tif(taskDescription || stageChange || fieldsChange)\n\t\t{\n\t\t\treturn Tag.render`<div class=\"ui-item-detail-stream-content-detail-main\">\n\t\t\t\t${taskDescription}\n\t\t\t\t${(fieldsChange ? [this.renderFieldsChangeTitle(), fieldsChange] : '')}\n\t\t\t\t${(stageChange ? [this.renderStageChangeTitle(), stageChange] : '')}\n\t\t\t</div>`;\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {Task} from './task';\nimport {TaskComplete} from './taskcomplete';\n\n/**\n * @memberOf BX.Rpa\n */\nexport const Timeline = {\n\tTask,\n\tTaskComplete,\n};"],"names":["Task","Timeline","Item","constructor","props","statusWait","statusYes","statusNo","statusOk","statusCancel","setEventNamespace","getId","id","getTaskUsers","data","users","render","layout","container","renderContainer","appendChild","renderIcon","renderContent","Tag","isLast","renderHeader","Loc","getMessage","renderMain","renderParticipants","Text","encode","url","getTitle","renderParticipantsLine","description","renderTaskFields","renderTaskButtons","photos","map","status","renderParticipantPhoto","length","counter","slice","push","showParticipants","bind","elements","taskUsers","forEach","i","node","getTaskUserName","classList","add","getUserId","participantJoint","msg","queueCls","event","user","get","sep","link","fullName","photo","workPosition","content","popup","Popup","target","autoHide","draggable","bindOptions","forceBindPosition","noAllPaddings","closeByEsc","cacheable","width","angle","position","overlay","backgroundColor","show","controls","type","getLinkButtonElements","BUTTONS","getActionButtonElements","buttons","button","bgColor","COLOR","fgColor","Manager","calculateTextColor","NAME","VALUE","doTaskHandler","TEXT","fieldsToSet","field","userData","toInteger","userId","safeFullName","ajaxData","emit","taskId","ajax","runAction","analyticsLabel","then","response","completed","timeline","completedData","onDelete","TaskComplete","History","renderTaskInfo","taskName","renderTaskName","taskResponsible","renderTaskResponsible","renderHeaderUser","task","getTask","taskInfo","detailMain","renderDetailMain","Type","isPlainObject","taskDescription","DESCRIPTION","stageChange","renderStageChange","fieldsChange","renderFieldsChange","renderFieldsChangeTitle","renderStageChangeTitle"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;CAMA;CACA;CACA;CACA;AACA,CAAO,MAAMA,IAAI,SAASC,oBAAQ,CAACC,IAAI,CACvC;GAOCC,WAAW,CAACC,KAAK,EACjB;KACC,KAAK,CAACA,KAAK,CAAC;KAAC,KARdC,UAAU,GAAG,CAAC;KAAA,KACdC,SAAS,GAAG,CAAC;KAAA,KACbC,QAAQ,GAAG,CAAC;KAAA,KACZC,QAAQ,GAAG,CAAC;KAAA,KACZC,YAAY,GAAG,CAAC;KAKf,IAAI,CAACC,iBAAiB,CAAC,sBAAsB,CAAC;;GAG/CC,KAAK,GACL;KACC,OAAO,OAAO,GAAG,IAAI,CAACC,EAAE;;GAGzBC,YAAY,GACZ;KACC,OAAO,IAAI,CAACC,IAAI,CAACC,KAAK;;GAGvBC,MAAM,GACN;KACC,IAAI,CAACC,MAAM,CAACC,SAAS,GAAG,IAAI,CAACC,eAAe,EAAE;KAE9C,IAAI,CAACF,MAAM,CAACC,SAAS,CAACE,WAAW,CAAC,IAAI,CAACC,UAAU,EAAE,CAAC;KACpD,IAAI,CAACJ,MAAM,CAACC,SAAS,CAACE,WAAW,CAAC,IAAI,CAACE,aAAa,EAAE,CAAC;KAEvD,OAAO,IAAI,CAACL,MAAM,CAACC,SAAS;;GAG7BC,eAAe,GACf;KACC,OAAOI,aAAG,CAACP,MAAM,cAAC,gFAA6E,CAA4D,UAAQ,GAAjE,IAAI,CAACQ,MAAM,GAAG,oCAAoC,GAAG,EAAE;;GAG1JC,YAAY,GACZ;KACC,OAAOF,aAAG,CAACP,MAAM,gBAAC;;;8DAGwC,CAA6C;;UAEhG,GAFqDU,aAAG,CAACC,UAAU,CAAC,0BAA0B,CAAC;;GAKvGC,UAAU,GACV;KACC,OAAOL,aAAG,CAACP,MAAM,gBAAC;;;OAGf,CAA4B;;2EAEwC,CAA6B,KAAE,CAA+B;QACjI,CAAgC;;;;oEAI4B,CAAgC;;MAE9F,CAA0B;MAC1B,CAA2B;UACtB,GAXF,IAAI,CAACa,kBAAkB,EAAE,EAE2CC,cAAI,CAACC,MAAM,CAAC,IAAI,CAACjB,IAAI,CAACkB,GAAG,CAAC,EAAKF,cAAI,CAACC,MAAM,CAAC,IAAI,CAACE,QAAQ,EAAE,CAAC,EAC9H,IAAI,CAACC,sBAAsB,EAAE,EAI+BJ,cAAI,CAACC,MAAM,CAAC,IAAI,CAACI,WAAW,CAAC,EAE3F,IAAI,CAACC,gBAAgB,EAAE,EACvB,IAAI,CAACC,iBAAiB,EAAE;;GAI7BR,kBAAkB,GAClB;KACC,IAAIS,MAAM,GAAG,IAAI,CAACzB,YAAY,EAAE,CAAC0B,GAAG,CAAC,CAAC;OAAC3B,EAAE;OAAE4B;MAAO,KAAK;OACtD,OAAO,IAAI,CAACC,sBAAsB,CAAC7B,EAAE,CAAC;MACtC,CAAC;KAEF,IAAI0B,MAAM,CAACI,MAAM,GAAG,CAAC,EACrB;OACC,IAAIC,OAAO,GAAGL,MAAM,CAACI,MAAM,GAAG,CAAC;OAC/BJ,MAAM,GAAGA,MAAM,CAACM,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;OAE3BN,MAAM,CAACO,IAAI,CACVtB,aAAG,CAACP,MAAM,gBAAC;gEAC+C,CAAU;aAC5D,GADoD2B,OAAO,EAEnE;;KAGF,OAAOpB,aAAG,CAACP,MAAM,gBAAC,qEAAkE,CAAmC;MACrH,CAAS;;GAEX,GAHsF,IAAI,CAAC8B,gBAAgB,CAACC,IAAI,CAAC,IAAI,CAAC,EAClHT,MAAM;;GAKXJ,sBAAsB,GACtB;KACC,IAAIc,QAAQ,GAAG,EAAE;KACjB,IAAIC,SAAS,GAAG,IAAI,CAACpC,YAAY,EAAE;KAEnCoC,SAAS,CAACC,OAAO,CAAC,CAAC;OAACtC,EAAE;OAAE4B;MAAO,EAAEW,CAAC,KAAK;OACtC,IAAIC,IAAI,GAAG7B,aAAG,CAACP,MAAM,gBAAC,mEAAgE,CAAwC,SAAO,GAA7Cc,cAAI,CAACC,MAAM,CAAC,IAAI,CAACsB,eAAe,CAACzC,EAAE,CAAC,CAAC,CAAS;OAEtI,IAAI4B,MAAM,GAAG,IAAI,CAACnC,UAAU,EAC5B;SACC+C,IAAI,CAACE,SAAS,CAACC,GAAG,CAAC,wDAAwD,CAAC;QAC5E,MACI,IAAI3C,EAAE,KAAK,IAAI,CAAC4C,SAAS,EAAE,EAChC;SACCJ,IAAI,CAACE,SAAS,CAACC,GAAG,CAAC,2DAA2D,CAAC;;OAGhFP,QAAQ,CAACH,IAAI,CAACO,IAAI,CAAC;OAEnB,IAAI,IAAI,CAACtC,IAAI,CAAC2C,gBAAgB,KAAK,OAAO,IAAIR,SAAS,CAACP,MAAM,GAAG,CAAC,KAAKS,CAAC,EACxE;SACC,IAAIO,GAAG,GAAG,IAAI,CAAC5C,IAAI,CAAC2C,gBAAgB,KAAK,KAAK,GAAG,kCAAkC,GAAG,iCAAiC;SACvHT,QAAQ,CAACH,IAAI,CAACtB,aAAG,CAACP,MAAM,gBAAC,wEAAqE,CAAsB,SAAO,GAA3BU,aAAG,CAACC,UAAU,CAAC+B,GAAG,CAAC,EAAU;;MAE9H,CAAC;KAEF,IAAIC,QAAQ,GACX,IAAI,CAAC7C,IAAI,CAAC2C,gBAAgB,KAAK,OAAO,GAAE,8DAA8D,GAAG,EACzG;KAED,OAAOlC,aAAG,CAACP,MAAM,gBAAC;wEACkD,CAAW;MAC7E,CAAW;;GAEb,GAHsE2C,QAAQ,EAC1EX,QAAQ;;GAKbF,gBAAgB,CAACc,KAAK,EACtB;KACC,IAAIX,SAAS,GAAG,IAAI,CAACpC,YAAY,EAAE;KACnC,IAAIE,KAAK,GAAGkC,SAAS,CAACV,GAAG,CAAC,CAAC;OAAC3B,EAAE;OAAE4B;MAAO,EAAEW,CAAC,KAAK;OAE9C,IAAIU,IAAI,GAAG,IAAI,CAAC9C,KAAK,CAAC+C,GAAG,CAAClD,EAAE,CAAC;OAC7B,IAAImD,GAAG,GAAId,SAAS,CAACP,MAAM,GAAE,CAAC,KAAKS,CAAC,GACjC5B,aAAG,CAACP,MAAM,gBAAC;OACZ,CAC0E;aACnE,GAFLU,aAAG,CAACC,UAAU,CAAC,IAAI,CAACb,IAAI,CAAC2C,gBAAgB,KAAK,KAAK,GACnD,kCAAkC,GAAG,iCAAiC,CAAC,IAExE,EAAE;OAGL,IAAIL,IAAI,GAAG7B,aAAG,CAACP,MAAM,kBAAC;;UAEjB,CAAsC;;iBAE/B,CAA6B;UACpC,CAA0F;;qDAE/C,CAA6B;yDACzB,CAAoB;;OAEtE,CAAM;WACD,GATA6C,IAAI,CAACG,IAAI,GAAG,SAAQH,IAAI,CAACG,IAAK,GAAE,GAAC,EAAE,EAE5BlC,cAAI,CAACC,MAAM,CAAC8B,IAAI,CAACI,QAAQ,CAAC,EACjCJ,IAAI,CAACK,KAAK,GAAG,iCAAgCL,IAAI,CAACK,KAAM,6BAA4B,GAAC,EAAE,EAE5CpC,cAAI,CAACC,MAAM,CAAC8B,IAAI,CAACI,QAAQ,CAAC,EACtBJ,IAAI,CAACM,YAAY,EAEnEJ,GAAG,CACC;OAER,IAAIvB,MAAM,GAAG,IAAI,CAACnC,UAAU,EAC5B;SACC+C,IAAI,CAACE,SAAS,CAACC,GAAG,CAAC,4BAA4B,IAC3Cf,MAAM,KAAK,IAAI,CAAChC,QAAQ,IAAIgC,MAAM,KAAK,IAAI,CAAClC,SAAS,GAAG,SAAS,GAAG,MAAM,CAAC,CAC9E;QACD,MAED;SACC8C,IAAI,CAACE,SAAS,CAACC,GAAG,CAAC,4BAA4B,IAC3C3C,EAAE,KAAK,IAAI,CAAC4C,SAAS,EAAE,GAAG,SAAS,GAAG,MAAM,CAAC,CAChD;;OAGF,OAAOJ,IAAI;MACX,CAAC;KAEF,IAAIgB,OAAO,GAAG7C,aAAG,CAACP,MAAM,kBAAC;;QAErB,CAAQ;YACH,GADHD,KAAK,CACD;KAEV,IAAI,IAAI,CAACD,IAAI,CAAC2C,gBAAgB,KAAK,OAAO,EAC1C;OACCW,OAAO,CAACd,SAAS,CAACC,GAAG,CAAC,6BAA6B,CAAC;;KAGrD,IAAIc,KAAK,GAAG,IAAIC,gBAAK,CAAC,8BAA8B,GAAG,IAAI,CAAC3D,KAAK,EAAE,EAAEiD,KAAK,CAACW,MAAM,EAAE;OAClFC,QAAQ,EAAE,IAAI;OACdC,SAAS,EAAE,KAAK;OAChBC,WAAW,EAAE;SAAEC,iBAAiB,EAAE;QAAM;OACxCC,aAAa,EAAE,IAAI;OACnBC,UAAU,EAAE,IAAI;OAChBC,SAAS,EAAE,KAAK;OAChBC,KAAK,EAAE,GAAG;OACVC,KAAK,EAAE;SACNC,QAAQ,EAAE;QACV;OACDC,OAAO,EAAE;SAAEC,eAAe,EAAE;QAAe;OAC3Cf,OAAO,EAAEA;MACT,CAAC;KAEFC,KAAK,CAACe,IAAI,EAAE;;GAGb/C,iBAAiB,GACjB;KACC,MAAMgD,QAAQ,GAAG,IAAI,CAACvE,IAAI,CAACuE,QAAQ;KAEnC,IAAI,CAACA,QAAQ,EACb;OACC,OAAO,EAAE;;KAGV,MAAMrC,QAAQ,GAAG,IAAI,CAAClC,IAAI,CAACwE,IAAI,KAAK,oBAAoB,GACrD,IAAI,CAACC,qBAAqB,CAACF,QAAQ,CAACG,OAAO,CAAC,GAC5C,IAAI,CAACC,uBAAuB,CAACJ,QAAQ,CAACG,OAAO,CAAC;KAEjD,OAAOjE,aAAG,CAACP,MAAM,kBAAC;;MAEhB,CAAW;;GAEb,GAFIgC,QAAQ;;GAKbyC,uBAAuB,CAACC,OAAc,EACtC;KACC,OAAOA,OAAO,CAACnD,GAAG,CAChBoD,MAAM,IAAK;OACX,IAAIC,OAAO,GAAGD,MAAM,CAACE,KAAK;OAC1B,IAAIC,OAAO,GAAGC,mBAAO,CAACC,kBAAkB,CAACL,MAAM,CAACE,KAAK,CAAC;OAEtD,OAAOtE,aAAG,CAACP,MAAM,kBAAC;aACX,CAAc;cACb,CAAe;iCACI,CAAU,mBAAgB,CAAU,UAAO,CAAU;gBACtE,CAAwC;QAChD,CAA2B;KAC7B,GALS2E,MAAM,CAACM,IAAI,EACVN,MAAM,CAACO,KAAK,EACON,OAAO,EAAmBA,OAAO,EAAUE,OAAO,EACnE,IAAI,CAACK,aAAa,CAACpD,IAAI,CAAC,IAAI,EAAE4C,MAAM,CAAC,EAC7C7D,cAAI,CAACC,MAAM,CAAC4D,MAAM,CAACS,IAAI,CAAC;MAE5B,CACD;;GAGFb,qBAAqB,CAACG,OAAc,EACpC;KACC,OAAO,CACNnE,aAAG,CAACP,MAAM,kBAAC;aACH,CAA6B;QAClC,CAAiD;IACpD,GAFUc,cAAI,CAACC,MAAM,CAAC,IAAI,CAACjB,IAAI,CAACkB,GAAG,CAAC,EAC/BN,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,EAEnD;;GAGFS,gBAAgB,GAChB;KACC,IAAI,CAAC,IAAI,CAACtB,IAAI,CAACuF,WAAW,EAC1B;OACC,OAAO,EAAE;;KAGV,MAAMrD,QAAQ,GAAG,IAAI,CAAClC,IAAI,CAACuF,WAAW,CAAC9D,GAAG,CACxC+D,KAAK,IAAK;OACV,OAAO/E,aAAG,CAACP,MAAM,kBAAC;kFAC0D,CAAqB;KACjG,GAD8Ec,cAAI,CAACC,MAAM,CAACuE,KAAK,CAAC;MAEhG,CACD;KAED,OAAO/E,aAAG,CAACP,MAAM,kBAAC;;yEAEmD,CAAqD;;OAEvH,CAAW;;;GAGd,GALuEU,aAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC,EAEpHqB,QAAQ;;GAMdK,eAAe,CAACzC,EAAE,EAClB;KACC,IAAI,CAACA,EAAE,EACP;OACCA,EAAE,GAAG,IAAI,CAAC4C,SAAS,EAAE;;KAGtB,IAAI+C,QAAQ,GAAG,IAAI,CAACxF,KAAK,CAAC+C,GAAG,CAAChC,cAAI,CAAC0E,SAAS,CAAC5F,EAAE,CAAC,CAAC;KACjD,OAAO2F,QAAQ,GAAGA,QAAQ,CAACtC,QAAQ,GAAG,KAAK;;GAG5CxB,sBAAsB,CAACgE,MAAe,EACtC;KACCA,MAAM,GAAG3E,cAAI,CAAC0E,SAAS,CAACC,MAAM,CAAC;KAC/B,IAAIF,QAAQ,GAAG;OACdtC,QAAQ,EAAE,EAAE;OACZC,KAAK,EAAE;MACP;KACD,IAAGuC,MAAM,GAAG,CAAC,EACb;OACCF,QAAQ,GAAG,IAAI,CAACxF,KAAK,CAAC+C,GAAG,CAAC2C,MAAM,CAAC;;KAElC,IAAG,CAACF,QAAQ,EACZ;OACC,OAAOhF,aAAG,CAACP,MAAM,kBAAC,eAAa;;KAGhC,MAAM0F,YAAY,GAAG5E,cAAI,CAACC,MAAM,CAACwE,QAAQ,CAACtC,QAAQ,CAAC;KACnD,OAAO1C,aAAG,CAACP,MAAM,kBAAC,+DAA4D,CAAe,KAAE,CAAqG,UAAQ,GAA5H0F,YAAY,EAAKH,QAAQ,CAACrC,KAAK,GAAI,iCAAgCqC,QAAQ,CAACrC,KAAM,6BAA4B,GAAG,EAAE;;GAGpMiC,aAAa,CAACR,MAAM,EACpB;KACC,MAAMgB,QAAQ,GAAG,EAAE;KACnBA,QAAQ,CAAChB,MAAM,CAACM,IAAI,CAAC,GAAGN,MAAM,CAACO,KAAK;KACpCS,QAAQ,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC/F,EAAE;KAE5B,IAAI,CAACgG,IAAI,CAAC,sBAAsB,EAAE;OACjCC,MAAM,EAAE,IAAI,CAACjG;MACb,CAAC;KAEFkG,cAAI,CAACC,SAAS,CAAC,aAAa,EAAE;OAC7BC,cAAc,EAAE,WAAW;OAC3BlG,IAAI,EAAE6F;MACN,CAAC,CAACM,IAAI,CAAEC,QAAQ,IACjB;OACC,IAAIA,QAAQ,CAACpG,IAAI,CAACqG,SAAS,EAC3B;SACC,IAAGD,QAAQ,CAACpG,IAAI,CAACsG,QAAQ,EACzB;WACC,IAAI,CAACC,aAAa,GAAGH,QAAQ,CAACpG,IAAI,CAACsG,QAAQ;;SAE5C,IAAI,CAACE,QAAQ,EAAE;SACf,IAAI,CAACV,IAAI,CAAC,gBAAgB,EAAE;WAC3BC,MAAM,EAAE,IAAI,CAACjG;UACb,CAAC;;MAEH,CAAC;;CAEJ;;;;;;;;;ACtVA,CAGO,MAAM2G,YAAY,SAAStH,oBAAQ,CAACuH,OAAO,CAClD;GACCrG,eAAe,GACf;KACC,MAAMD,SAAS,GAAG,KAAK,CAACC,eAAe,EAAE;KACzCD,SAAS,CAACoC,SAAS,CAACC,GAAG,CAAC,uCAAuC,CAAC;KAEhE,OAAOrC,SAAS;;GAGjBuG,cAAc,GACd;KACC,IAAIC,QAAQ,GAAG,IAAI,CAACC,cAAc,EAAE;KACpC,IAAG,CAACD,QAAQ,EACZ;OACCA,QAAQ,GAAG,EAAE;;KAGd,IAAIE,eAAe,GAAG,IAAI,CAACC,qBAAqB,EAAE;KAClD,IAAG,CAACD,eAAe,EACnB;OACCA,eAAe,GAAG,EAAE;;KAGrB,OAAOrG,aAAG,CAACP,MAAM,oBAAC;KACjB,CAA8C;;MAE7C,CAAW;MACX,CAAkB;;SAEd,GALH,IAAI,CAAC8G,gBAAgB,CAAC,IAAI,CAACtE,SAAS,EAAE,EAAE,EAAE,CAAC,EAE1CkE,QAAQ,EACRE,eAAe;;GAKpBD,cAAc,GACd;KACC,MAAMI,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;KAC3B,IAAGD,IAAI,EACP;OACC,OAAOxG,aAAG,CAACP,MAAM,sBAAC,gEAA6D,CAAyB,MAAI,GAA3Bc,cAAI,CAACC,MAAM,CAACgG,IAAI,CAAC9B,IAAI,CAAC;;KAGxG,OAAO,IAAI;;GAGZ4B,qBAAqB,GACrB;KACC,IAAIhE,IAAI,GAAG,IAAI,CAAC9C,KAAK,CAAC+C,GAAG,CAAChC,cAAI,CAAC0E,SAAS,CAAC,IAAI,CAAChD,SAAS,EAAE,CAAC,CAAC;KAC3D,IAAGK,IAAI,EACP;OACC,OAAOtC,aAAG,CAACP,MAAM,sBAAC,mEAAgE,CAA6B,SAAO,GAAlCc,cAAI,CAACC,MAAM,CAAC8B,IAAI,CAACI,QAAQ,CAAC;;KAG/G,OAAO,IAAI;;GAGZrC,UAAU,GACV;KACC,IAAIqG,QAAQ,GAAG,IAAI,CAACR,cAAc,EAAE;KACpC,IAAIS,UAAU,GAAG,IAAI,CAACC,gBAAgB,EAAE;KACxC,IAAG,CAACD,UAAU,EACd;OACCD,QAAQ,CAAC3E,SAAS,CAACC,GAAG,CAAC,+CAA+C,CAAC;;KAGxE,OAAOhC,aAAG,CAACP,MAAM,sBAAC;KACjB,CAAW;KACX,CAAmB;SACd,GAFHiH,QAAQ,EACRC,UAAU,IAAI,EAAE;;GAIpBF,OAAO,GACP;KACC,IAAGI,cAAI,CAACC,aAAa,CAAC,IAAI,CAACvH,IAAI,CAACiH,IAAI,CAAC,EACrC;OACC,OAAO,IAAI,CAACjH,IAAI,CAACiH,IAAI;;KAGtB,OAAO,IAAI;;GAGZI,gBAAgB,GAChB;KACC,MAAMJ,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;KAC3B,IAAIM,eAAe,GAAG,EAAE;KACxB,IAAGP,IAAI,IAAIA,IAAI,CAACQ,WAAW,EAC3B;OACCD,eAAe,GAAG/G,aAAG,CAACP,MAAM,sBAAC,gEAA6D,CAAgC,SAAO,GAArCc,cAAI,CAACC,MAAM,CAACgG,IAAI,CAACQ,WAAW,CAAC,CAAS;;KAGnI,IAAIC,WAAW,GAAG,IAAI,CAACC,iBAAiB,EAAE;KAC1C,IAAIC,YAAY,GAAG,IAAI,CAACC,kBAAkB,EAAE;KAC5C,IAAGL,eAAe,IAAIE,WAAW,IAAIE,YAAY,EACjD;OACC,OAAOnH,aAAG,CAACP,MAAM,sBAAC;MACjB,CAAkB;MAClB,CAAuE;MACvE,CAAoE;UAC/D,GAHHsH,eAAe,EACdI,YAAY,GAAG,CAAC,IAAI,CAACE,uBAAuB,EAAE,EAAEF,YAAY,CAAC,GAAG,EAAE,EAClEF,WAAW,GAAG,CAAC,IAAI,CAACK,sBAAsB,EAAE,EAAEL,WAAW,CAAC,GAAG,EAAE;;KAIpE,OAAO,IAAI;;CAEb;;CCtGA;CACA;CACA;AACA,OAAavI,QAAQ,GAAG;GACvBD,IAAI;GACJuH;CACD,CAAC;;;;;;;;"}