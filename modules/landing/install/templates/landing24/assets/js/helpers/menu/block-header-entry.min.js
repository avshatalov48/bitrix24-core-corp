(function(){"use strict";BX.namespace("BX.Landing");var e=BX.Landing.Utils.style;var n=BX.Landing.Utils.addClass;var t=BX.Landing.Utils.removeClass;BX.Landing.BlockHeaderEntry=function(e){this.headerNode=e;this.wrapperNode=e.parentNode;this.fixMomentNodes=this.headerNode.querySelectorAll(BX.Landing.BlockHeaderEntry.FIX_MOMENT_SELECTOR);this.hiddenSectionsNodes=this.headerNode.querySelectorAll(BX.Landing.BlockHeaderEntry.SECTION_HIDDEN_SELECTOR);this.mode=this.getMode();this.prevState=0;var n=document.querySelector(".landing-pub-top-panel-wrapper");this.headerOffset=n?n.offsetHeight:0};BX.Landing.BlockHeaderEntry.HEADER_SELECTOR=".u-header";BX.Landing.BlockHeaderEntry.SECTION_HIDDEN_SELECTOR=".u-header__section--hidden";BX.Landing.BlockHeaderEntry.FIX_MOMENT_SELECTOR="[data-header-fix-moment-classes], [data-header-fix-moment-exclude]";BX.Landing.BlockHeaderEntry.STATE_IN_FLOW=10;BX.Landing.BlockHeaderEntry.STATE_ON_TOP=20;BX.Landing.BlockHeaderEntry.STATE_FIX_MOMENT=30;BX.Landing.BlockHeaderEntry.DIRECTION_TOP_TO_BOTTOM=1;BX.Landing.BlockHeaderEntry.DIRECTION_BOTTOM_TO_TOP=-1;BX.Landing.BlockHeaderEntry.THRESHOLD_FULL=1;BX.Landing.BlockHeaderEntry.STICKY_CLASS="u-header--sticky";BX.Landing.BlockHeaderEntry.FLOAT_CLASS="u-header--float";BX.Landing.BlockHeaderEntry.MODE_STICKY=10;BX.Landing.BlockHeaderEntry.MODE_STICKY_RELATIVE=20;BX.Landing.BlockHeaderEntry.MODE_STATIC=30;BX.Landing.BlockHeaderEntry.FIX_MOMENT_CLASSES=["js-header-fix-moment"];BX.Landing.BlockHeaderEntry.FIX_MOMENT_ADD_DATA="header-fix-moment-classes";BX.Landing.BlockHeaderEntry.FIX_MOMENT_REMOVE_DATA="header-fix-moment-exclude";BX.Landing.BlockHeaderEntry.getHeaderNodeByWrapper=function(e){return e.querySelector(BX.Landing.BlockHeaderEntry.HEADER_SELECTOR)};BX.Landing.BlockHeaderEntry.prototype={getNodeForObserve:function(){return this.wrapperNode},getMode:function(){if(BX.hasClass(this.headerNode,BX.Landing.BlockHeaderEntry.STICKY_CLASS)){if(BX.hasClass(this.headerNode,BX.Landing.BlockHeaderEntry.FLOAT_CLASS)){return BX.Landing.BlockHeaderEntry.MODE_STICKY}return BX.Landing.BlockHeaderEntry.MODE_STICKY_RELATIVE}return BX.Landing.BlockHeaderEntry.MODE_STATIC},getCurrentState:function(e){if(e.isIntersecting){if(!this.isOnTop(e)){return BX.Landing.BlockHeaderEntry.STATE_IN_FLOW}else if(e.intersectionRatio===BX.Landing.BlockHeaderEntry.THRESHOLD_FULL){return BX.Landing.BlockHeaderEntry.STATE_IN_FLOW}else if(e.intersectionRatio<BX.Landing.BlockHeaderEntry.THRESHOLD_FULL){return BX.Landing.BlockHeaderEntry.STATE_ON_TOP}}else{if(!this.isOnTop(e)){return BX.Landing.BlockHeaderEntry.STATE_IN_FLOW}else{return BX.Landing.BlockHeaderEntry.STATE_FIX_MOMENT}}},isOnTop:function(e){return e.boundingClientRect.top<=0},getDirection:function(e){if(this.prevState===null){return 0}if(e>this.prevState){return BX.Landing.BlockHeaderEntry.DIRECTION_TOP_TO_BOTTOM}return BX.Landing.BlockHeaderEntry.DIRECTION_BOTTOM_TO_TOP},isOverScreen:function(e){return e.boundingClientRect.height>=e.rootBounds.height},setInFlow:function(){if(this.mode===BX.Landing.BlockHeaderEntry.MODE_STICKY){void e(this.headerNode,{position:"absolute",top:0,left:0,right:0})}else if(this.mode===BX.Landing.BlockHeaderEntry.MODE_STICKY_RELATIVE){void e(this.wrapperNode,{height:"auto"});void e(this.headerNode,{position:"relative",top:0,left:0,right:0})}},setOnTop:function(){if(this.mode===BX.Landing.BlockHeaderEntry.MODE_STICKY_RELATIVE){void e(this.wrapperNode,{height:this.wrapperNode.offsetHeight+"px"})}void e(this.headerNode,{position:"fixed",top:this.headerOffset+"px",left:0,right:0})},setFixMoment:function(){n(this.headerNode,BX.Landing.BlockHeaderEntry.FIX_MOMENT_CLASSES);this.fixMomentNodes.forEach(function(e){var r=BX.data(e,BX.Landing.BlockHeaderEntry.FIX_MOMENT_ADD_DATA);if(r!==undefined){n(e,r.split(" "))}var i=BX.data(e,BX.Landing.BlockHeaderEntry.FIX_MOMENT_REMOVE_DATA);if(i!==undefined){t(e,i.split(" "))}});this.hideSections()},unsetFixMoment:function(){t(this.headerNode,BX.Landing.BlockHeaderEntry.FIX_MOMENT_CLASSES);this.fixMomentNodes.forEach(function(e){var r=BX.data(e,BX.Landing.BlockHeaderEntry.FIX_MOMENT_ADD_DATA);if(r!==undefined){t(e,r.split(" "))}var i=BX.data(e,BX.Landing.BlockHeaderEntry.FIX_MOMENT_REMOVE_DATA);if(i!==undefined){n(e,i.split(" "))}});this.showSections()},hideSections:function(){this.hiddenSectionsNodes.forEach(function(e){e.style.setProperty("height",0);e.style.setProperty("border","none","important");e.style.setProperty("overflow","hidden");e.style.setProperty("padding",0,"important")})},showSections:function(){this.hiddenSectionsNodes.forEach(function(e){e.style.removeProperty("height");e.style.removeProperty("border");e.style.removeProperty("overflow");e.style.removeProperty("padding")})}};BX.Landing.BlockHeaderEntry.onIntersection=function(e){e.forEach(function(e){var n=BX.Landing.BlockHeaders.getInstance();var t=n.getEntryByIntersectionTarget(e.target);if(t.mode===BX.Landing.BlockHeaderEntry.MODE_STATIC){return}var r=t.getCurrentState(e);if(r!==t.prevState){if(r===BX.Landing.BlockHeaderEntry.STATE_IN_FLOW){t.setInFlow()}else if(r===BX.Landing.BlockHeaderEntry.STATE_ON_TOP){t.setOnTop()}else if(r===BX.Landing.BlockHeaderEntry.STATE_FIX_MOMENT){if(t.prevState<BX.Landing.BlockHeaderEntry.STATE_ON_TOP){t.setOnTop()}t.setFixMoment()}var i=t.getDirection(r);if(i<0&&r<BX.Landing.BlockHeaderEntry.STATE_FIX_MOMENT){t.unsetFixMoment()}t.prevState=r}else if(t.isOverScreen(e)){t.wrapperNode.scrollIntoView({behavior:"smooth"});t.setOnTop();t.prevState=BX.Landing.BlockHeaderEntry.STATE_ON_TOP}})}})();
//# sourceMappingURL=block-header-entry.map.js