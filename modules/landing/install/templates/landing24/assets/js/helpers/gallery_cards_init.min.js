(function(){"use strict";BX.namespace("BX.Landing");BX.Landing.CardGalleryCollection=function(){this.galleries={}};BX.Landing.CardGalleryCollection.GALLERY_SELECTOR=".js-gallery-cards";BX.Landing.CardGalleryCollection.getInstance=function(){return BX.Landing.CardGalleryCollection.instance||(BX.Landing.CardGalleryCollection.instance=new BX.Landing.CardGalleryCollection)};BX.Landing.CardGalleryCollection.initBlock=function(a){if(this.isGalleryBlock(a)){var n=this.getInstance();n.add(a)}};BX.Landing.CardGalleryCollection.reinitImg=function(a,n){if(this.isGalleryBlock(a)){var e=this.getInstance();var l=e.findGalleryByBlock(a);if(l){l.reinitImage(n)}}};BX.Landing.CardGalleryCollection.isGalleryBlock=function(a){var n=this.getGalleryNode(a);return n!==null};BX.Landing.CardGalleryCollection.getGalleryNode=function(a){return a.querySelector(this.GALLERY_SELECTOR)};BX.Landing.CardGalleryCollection.prototype={add:function(a){var n=new BX.Landing.CardGallery(a,BX.Landing.CardGalleryCollection.getGalleryNode(a));n.initImages();this.galleries[n.getId()]=n},findGalleryByBlock:function(a){return this.galleries[a.id]||null}};BX.Landing.CardGallery=function(a,n){this.gallery=n;this.uniqId=a.id};BX.Landing.CardGallery.IMAGES_SELECTOR="[data-fancybox]";BX.Landing.CardGallery.DATA_FANCYBOX_ID="fancybox";BX.Landing.CardGallery.DATA_FANCYBOX_INITIED="fancyboxInitied";BX.Landing.CardGallery.DATA_FANCYBOX_TITLE="caption";BX.Landing.CardGallery.DATA_LINK_CLASSES="linkClasses";BX.Landing.CardGallery.CAROUSEL_CLONED_CLASSES="slick-cloned";BX.Landing.CardGallery.prototype={getId:function(){return this.uniqId},initImages:function(){var a=[].slice.call(this.gallery.querySelectorAll(BX.Landing.CardGallery.IMAGES_SELECTOR));a.forEach(function(a){if(BX.findParent(a,{class:BX.Landing.CardGallery.CAROUSEL_CLONED_CLASSES})){return}if(!this.isImageInit(a)){this.addOuterLink(a)}},this)},isImageInit:function(a){return a.tagName==="IMG"&&a.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_INITIED]==="Y"||a.tagName==="A"&&a.firstChild!==null&&this.isImageInit(a.firstChild)},addOuterLink:function(a){var n=a.getAttribute("src");if(n!=null){var e=a.parentNode;var l=BX.create("a",{attrs:{href:n,class:a.dataset[BX.Landing.CardGallery.DATA_LINK_CLASSES]||""},children:[].slice.call(e.children)});BX.adjust(e,{children:[l]});l.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_ID]=a.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_ID]+"_"+this.uniqId;l.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_TITLE]=BX.Text.encode(a.getAttribute("alt"))||"";delete a.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_ID];a.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_INITIED]="Y"}},reinitImage:function(a){if(this.isImageInit(a)){var n=a.getAttribute("src");if(n!==null){var e=a.parentNode;if(e.tagName==="A"&&e.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_ID]){e.href=n;e.dataset[BX.Landing.CardGallery.DATA_FANCYBOX_TITLE]=BX.Text.encode(a.getAttribute("alt"))||""}}}}};BX.addCustomEvent("BX.Landing.Block:init",function(a){if(BX.Landing.getMode()==="edit"){return}BX.Landing.CardGalleryCollection.initBlock(a.block)});BX.addCustomEvent("BX.Landing.Lazyload:loadImage",function(a){if(BX.Landing.getMode()==="edit"){return}BX.Landing.CardGalleryCollection.reinitImg(a.block,a.node)})})();
//# sourceMappingURL=gallery_cards_init.map.js