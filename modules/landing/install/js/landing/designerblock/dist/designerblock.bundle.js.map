{"version":3,"file":"designerblock.bundle.js","sources":["../src/node.js","../src/ui/designerblock.js","../src/ui/panels/repo.js","../src/panels/repo.js","../src/designerblock.js"],"sourcesContent":["import {Dom, Event} from 'main.core';\n\nexport type NodeType = {\n\telement: HTMLElement,\n\tselector: string,\n\ttype: ?string,\n\tclassName: ?string,\n\tcardSelector: ?string,\n\tonHover: ?() => {}\n};\n\nexport class Node\n{\n\telement: HTMLElement;\n\tselector: string;\n\tcardSelector: string;\n\tpseudoElement: boolean;\n\tonHover: ?() => {};\n\n\tconstructor(options: NodeType)\n\t{\n\t\tthis.element = options.element;\n\t\tthis.selector = options.selector;\n\t\tthis.cardSelector = options.cardSelector;\n\t\tthis.onHover = options.onHover;\n\t\tthis.pseudoElement = Dom.hasClass(this.element, 'landing-designer-block-pseudo-last');\n\n\t\tEvent.bind(this.element, 'mouseover', this.onMouseOver.bind(this));\n\n\t\tif (options.className)\n\t\t{\n\t\t\tDom.addClass(this.element, options.className);\n\t\t}\n\t}\n\n\tisPseudoElement(): boolean\n\t{\n\t\treturn this.pseudoElement;\n\t}\n\n\tgetSelector(): string\n\t{\n\t\treturn (this.cardSelector ? this.cardSelector + ' ' : '') + this.selector;\n\t}\n\n\tgetCardSelector(): string\n\t{\n\t\treturn this.cardSelector;\n\t}\n\n\tgetOriginalSelector(): string\n\t{\n\t\treturn this.selector;\n\t}\n\n\tgetElement(): HTMLElement\n\t{\n\t\treturn this.element;\n\t}\n\n\tonMouseOver(event: Event)\n\t{\n\t\tevent.stopPropagation();\n\t\tthis.onHover(this);\n\t}\n}\n","import {Tag} from 'main.core';\nimport {Loc} from 'landing.loc';\n\nexport class DesignerBlockUI\n{\n\tstatic getHoverDiv(): HTMLDivElement\n\t{\n\t\treturn Tag.render`<div class=\"landing-designer-block-node-hover\"></div>`;\n\t}\n\n\tstatic getPseudoLast(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"landing-designer-block-pseudo-last\"></div>`;\n\t}\n\n\tstatic getAddNodeButton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-designer-block-node-hover-add\">\n\t\t\t\t<span class=\"landing-designer-block-node-hover-add-title\">\n\t\t\t\t\t${Loc.getMessage('LANDING_DESIGN_BLOCK_REPO_BUTTON')}\n\t\t\t\t</span>\n\t\t\t</div>`;\n\t}\n}\n","import {Loc} from 'landing.loc';\nimport {Content} from 'landing.ui.panel.content';\nimport {Dom, Cache, Tag} from 'main.core';\n\nexport type RepoElementType = {\n\tname: string,\n\tcode: string,\n\thtml: string,\n\tmanifest: {\n\t\tnodes: {\n\t\t\t[selector: string]: {\n\t\t\t\ttype: string\n\t\t\t}\n\t\t},\n\t\tstyle: {\n\t\t\t[selector: string]: {\n\t\t\t\ttype: string\n\t\t\t}\n\t\t}\n\t}\n};\n\nexport type RepoPanelOptions = {\n\tonElementSelect: (RepoElementType) => {}\n};\n\n\nexport class RepoPanel extends Content\n{\n\tconstructor(options: RepoPanelOptions)\n\t{\n\t\tsuper('design_repo', {\n\t\t\ttitle: Loc.getMessage('LANDING_DESIGN_BLOCK_REPO_TITLE'),\n\t\t\tscrollAnimation: true\n\t\t});\n\n\t\tthis.currentCategory = null;\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.onElementSelect = options.onElementSelect;\n\n\t\tthis.renderTo(\n\t\t\tparent.document.body\n\t\t\t? parent.document.body\n\t\t\t: document.body\n\t\t);\n\n\t\tDom.addClass(this.layout, 'landing-ui-panel-repo');\n\t}\n\n\taddRepository(repository: Array<RepoElementType>)\n\t{\n\t\trepository.map(item => {\n\t\t\tthis.addElement(item);\n\t\t});\n\t}\n\n\tmakeElementUnique(element: RepoElementType): RepoElementType\n\t{\n\t\tconst newManifest = {};\n\t\tObject.keys(element.manifest.nodes).map(selector => {\n\t\t\tconst randPostfix = '-' + this.randomNum(1000, 9999);\n\t\t\tconst className = selector.substr(1);\n\t\t\telement.html = element.html.replaceAll(new RegExp(className + '([\\\\s\"]{1})', 'g'), className + randPostfix + '$1');\n\t\t\tnewManifest[selector + randPostfix] = element.manifest.nodes[selector];\n\t\t});\n\t\telement.manifest.nodes = newManifest;\n\t\treturn element;\n\t}\n\n\taddElement(element: RepoElementType)\n\t{\n\t\tconst nodeCard = new BX.Landing.UI.Card.BlockPreviewCard({\n\t\t\ttitle: element.name,\n\t\t\timage: '/bitrix/images/landing/designerblock/presets/' + element .code + '.jpg',\n\t\t\tonClick: () => {\n\t\t\t\tthis.onElementSelect(this.makeElementUnique(element));\n\t\t\t\tvoid this.hide();\n\t\t\t}\n\t\t});\n\t\tthis.appendCard(nodeCard);\n\t}\n\n\trandomNum(min: number, max: number): number\n\t{\n\t\treturn parseInt(Math.random() * (max - min) + min);\n\t}\n\n\tgetListContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('listContainer', () => {\n\t\t\treturn Tag.render`<div class=\"landing-ui-field-layer-list-container\"></div>`;\n\t\t});\n\t}\n}\n","import {RepoPanel, RepoElementType} from '../ui/panels/repo';\n\nexport type RepoManagerOptions = {\n\trepository: Array<RepoElementType>,\n\tonElementSelect: (RepoElementType) => {}\n};\n\nexport class RepoManager\n{\n\tconstructor(options: RepoManagerOptions)\n\t{\n\t\tthis.panel = new RepoPanel({\n\t\t\tonElementSelect: options.onElementSelect\n\t\t});\n\n\t\tthis.panel.addRepository(options.repository);\n\t}\n\n\tshowPanel()\n\t{\n\t\tthis.panel.show().then();\n\t}\n}\n","import {Dom, Event, Tag, Text} from 'main.core';\nimport {Backend} from 'landing.backend';\nimport {Env} from 'landing.env';\nimport {Metrika} from 'landing.metrika';\nimport {Highlight} from 'landing.ui.highlight';\n\nimport {Node, NodeType} from './node';\nimport {DesignerBlockUI} from './ui/designerblock';\nimport {RepoElementType} from './ui/panels/repo';\nimport {RepoManager} from './panels/repo';\n\nimport 'ui.fonts.opensans';\nimport './designerblock.css';\n\ntype ManifestNodesItem = {\n\t[selector: string]: {\n\t\tcode: ?string,\n\t\tname: ?string,\n\t\ttype: string,\n\t\tuseInDesigner: ?boolean\n\t}\n};\n\nexport type DesignerBlockOptions = {\n\tid: number,\n\tlid: number,\n\tcode: string,\n\tdesigned: boolean,\n\tautoPublicationEnabled: boolean,\n\taccess: string,\n\tactive: boolean,\n\tanchor: string,\n\tmanifest: {\n\t\tcards: {\n\t\t\t[selector: string]: {\n\t\t\t\tname: string\n\t\t\t}\n\t\t},\n\t\tnodes: {\n\t\t\t[selector: string]: {\n\t\t\t\tcode: ?string,\n\t\t\t\tname: ?string,\n\t\t\t\ttype: string\n\t\t\t}\n\t\t}\n\t},\n\trepository: Array<RepoElementType>\n};\n\nexport class DesignerBlock\n{\n\tblockNode: HTMLElement;\n\toriginalNode: HTMLElement;\n\thoverArea: HTMLElement = null;\n\tactiveNode: Node = null;\n\tchanged: boolean = false;\n\tsaving: boolean = false;\n\tdesigned: boolean;\n\tautoPublicationEnabled: boolean;\n\tblockCode: string;\n\tblockId: number;\n\tlandingId: number;\n\tnodes: ManifestNodesItem;\n\thighlight: Highlight;\n\tnodeMap: WeakMap;\n\tmetrika: Metrika;\n\trepoManager: RepoManager;\n\tcardSelectors: Array<string>;\n\n\tconstructor(blockNode: HTMLElement, options: DesignerBlockOptions)\n\t{\n\t\tif (!blockNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.originalNode = blockNode;\n\t\tthis.blockNode = blockNode.children[0];\n\t\tthis.blockCode = options.code;\n\t\tthis.blockId = options.id;\n\t\tthis.designed = options.designed;\n\t\tthis.autoPublicationEnabled = options.autoPublicationEnabled;\n\t\tthis.landingId = options.lid;\n\t\tthis.nodes = options.manifest.nodes;\n\t\tthis.highlight = new Highlight();\n\t\tthis.cardSelectors = options.manifest.cards ? Object.keys(options.manifest.cards) : [];\n\t\tthis.designAllowed = !!Env.getInstance().getOptions().design_block_allowed;\n\t\tthis.cardSelectors.push('');// for without cards elements\n\t\tthis.nodeMap = new WeakMap();\n\t\tthis.metrika = new Metrika(true);\n\t\tthis.repoManager = new RepoManager({\n\t\t\trepository: options.repository,\n\t\t\tonElementSelect: this.addElement.bind(this)\n\t\t});\n\n\t\tthis.saveButton = parent.document.getElementById('landing-design-block-save')\n\t\t\t|| top.document.getElementById('landing-design-block-save')\n\t\t\t|| document.getElementById('landing-design-block-save');\n\n\t\tBX.addCustomEvent('Landing.Editor:load', () => {\n\t\t\tthis.preventEvents();\n\t\t\t// todo: force reinit history instance with D type\n\t\t\tthis.initHistoryEvents();\n\t\t\tthis.initTopPanel();\n\t\t\tthis.initNodes();\n\t\t\tthis.initGrid();\n\t\t\tthis.initSliders();\n\t\t\tthis.initHoverArea();\n\t\t});\n\t}\n\n\tclearHtml(content: string): string\n\t{\n\t\treturn content\n\t\t\t.replace(/<div class=\"[^\"]*landing-designer-block-pseudo-last[^\"]*\"[^>]*>[\\s]*<\\/div>/g, '')\n\t\t\t.replace(/<div class=\"[^\"]*landing-highlight-border[^\"]*\"[^>]*>[\\s]*<\\/div>/g, '')\n\t\t\t.replace(/url\\(&quot;(.*?)&quot;\\)/g, 'url($1)')\n\t\t\t.replace(/\\s*data-(landingwrapper)=\"[^\"]+\"\\s*/g, ' ')\n\t\t\t.replace(/\\s*[\\w-_]+--type-wrapper\\s*/g, ' ')\n\t\t\t.replace(/<div[\\s]*>[\\s]*<\\/div>/g, '')\n\t\t\t.replace(/\\s*style=\"\"/g, '');\n\t}\n\n\tpreventEvents()\n\t{\n\t\tconst preventMap = {\n\t\t\ta: 'click',\n\t\t\tform: 'submit',\n\t\t\tinput: 'keydown'\n\t\t};\n\t\tObject.keys(preventMap).map(tag => {\n\t\t\t[...this.blockNode.querySelectorAll(tag)].map(node => {\n\t\t\t\tEvent.bind(node, preventMap[tag], (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tinitHistoryEvents()\n\t{\n\t\tBX.Landing.History.getInstance()\n\t\t\t.setTypeDesignerBlock(this.blockId)\n\t\t\t.then(() => {\n\t\t\t\treturn Backend.getInstance()\n\t\t\t\t\t.action(\"History::clearDesignerBlock\", {\n\t\t\t\t\t\tblockId: this.blockId,\n\t\t\t\t\t});\n\t\t\t});\n\n\t\tconst body = this.getDocumentBody();\n\n\t\ttop.BX.addCustomEvent('Landing:onHistoryAddNode',\n\t\t\ttags => {\n\t\t\t\tlet elementAdded = false;\n\t\t\t\ttags.map(tag => {\n\t\t\t\t\tconst insertAfterSelector = tag.insertAfterSelector || null;\n\t\t\t\t\tconst parentNodeSelector = tag.parentNodeSelector || null;\n\t\t\t\t\tconst element = Tag.render`${tag.elementHtml}`;\n\n\t\t\t\t\tif (insertAfterSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\telementAdded = true;\n\t\t\t\t\t\tDom.insertAfter(element, body.querySelector(insertAfterSelector));\n\t\t\t\t\t}\n\t\t\t\t\telse if (parentNodeSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\telementAdded = true;\n\t\t\t\t\t\tDom.prepend(element, body.querySelector(parentNodeSelector));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (elementAdded)\n\t\t\t\t{\n\t\t\t\t\tthis.refreshManifest();\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.sendLabel(\n\t\t\t\t\t\t\t'designerBlock',\n\t\t\t\t\t\t\t'onHistoryAddNode'\n\t\t\t\t\t\t);\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\ttop.BX.addCustomEvent('Landing:onHistoryRemoveNode',\n\t\t\ttags => {\n\t\t\t\ttags.map(tag => {\n\t\t\t\t\tthis.removeNode(\n\t\t\t\t\t\tbody.querySelector(tag.elementSelector)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t\tthis.refreshManifest();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.sendLabel(\n\t\t\t\t\t\t'designerBlock',\n\t\t\t\t\t\t'onHistoryRemoveNode'\n\t\t\t\t\t);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t);\n\t}\n\n\tinitTopPanel()\n\t{\n\t\tEvent.bind(this.saveButton, 'click', () => {\n\t\t\tthis.highlight.hide(true);\n\n\t\t\tconst finishCallback = () => {\n\t\t\t\tif (BX.SidePanel && BX.SidePanel.Instance)\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (!this.changed)\n\t\t\t{\n\t\t\t\tfinishCallback();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this.designAllowed)\n\t\t\t{\n\t\t\t\ttop.BX.UI.InfoHelper.show('limit_crm_free_superblock1');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.saving = true;\n\n\t\t\tconst batch = {};\n\t\t\tbatch['Block::updateContent'] = {\n\t\t\t\taction: 'Block::updateContent',\n\t\t\t\tdata: {\n\t\t\t\t\tlid: this.landingId,\n\t\t\t\t\tblock: this.blockId,\n\t\t\t\t\tcontent: this.clearHtml(this.originalNode.innerHTML).replaceAll(' style=\"', ' bxstyle=\"'),\n\t\t\t\t\tdesigned: 1\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (this.autoPublicationEnabled)\n\t\t\t{\n\t\t\t\tbatch['Landing::publication'] = {\n\t\t\t\t\taction: 'Landing::publication',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tlid: this.landingId\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tbatch['History::clearDesignerBlock'] = {\n\t\t\t\taction: 'History::clearDesignerBlock',\n\t\t\t\tdata: {\n\t\t\t\t\tblockId: this.blockId,\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tBackend.getInstance()\n\t\t\t\t.batch('Block::updateContent', batch)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.saving = false;\n\t\t\t\t\tfinishCallback();\n\t\t\t\t});\n\n\t\t\tthis.sendLabel(\n\t\t\t\t'designerBlock',\n\t\t\t\t'save' +\n\t\t\t\t'&designed=' + (this.designed ? 'Y' : 'N') +\n\t\t\t\t'&code=' + this.blockCode\n\t\t\t);\n\t\t});\n\t}\n\n\tinitNodes()\n\t{\n\t\tObject.keys(this.nodes).map(selector => {\n\t\t\tthis.cardSelectors.map(cardSelector => {\n\t\t\t\t[...this.blockNode.querySelectorAll((cardSelector ? cardSelector + ' ' : '') + selector)].map(element => {\n\t\t\t\t\tif (this.nodes[selector]['useInDesigner'] === false)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.addNode({\n\t\t\t\t\t\telement,\n\t\t\t\t\t\tselector,\n\t\t\t\t\t\tcardSelector,\n\t\t\t\t\t\ttype: this.nodes[selector]['type']\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tinitGrid()\n\t{\n\t\t// collect node's parent and add pseudo last elements into the wrappers\n\t\tObject.keys(this.nodes).map(selector => {\n\t\t\tthis.cardSelectors.map(cardSelector => {\n\t\t\t\t[...this.blockNode.querySelectorAll((cardSelector ? cardSelector + ' ' : '') + selector)].map(element => {\n\t\t\t\t\tif (this.nodes[selector]['useInDesigner'] === false)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst wrapper = (this.nodes[selector]['type'] === 'icon')\n\t\t\t\t\t\t? element.parentNode.parentNode\n\t\t\t\t\t\t: element.parentNode;\n\t\t\t\t\tif (Dom.attr(wrapper, 'data-landingWrapper'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst pseudoElement = DesignerBlockUI.getPseudoLast();\n\t\t\t\t\tDom.attr(wrapper, 'data-landingWrapper', true);\n\t\t\t\t\tDom.append(pseudoElement, wrapper);\n\t\t\t\t\tthis.addNode({\n\t\t\t\t\t\tcardSelector,\n\t\t\t\t\t\telement: pseudoElement,\n\t\t\t\t\t\tclassName: selector.substr(1) + '-last',\n\t\t\t\t\t\tselector: selector + '-last'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tinitSliders()\n\t{\n\t\tconst sliderSelector = '.js-carousel';\n\t\t[...this.blockNode.querySelectorAll(sliderSelector)].map(slider => {\n\t\t\tconst count =\n\t\t\t\t(Text.toNumber(slider.dataset.slidesShow) || 1)\n\t\t\t\t* (Text.toNumber(slider.dataset.rows) || 1)\n\t\t\t;\n\t\t\tconst selector = `.${[...slider.classList].join('.')} .js-slide:not(:nth-child(-n+${count}))`;\n\t\t\tdocument.head.appendChild(\n\t\t\t\tTag.render`<style>${selector}{display: none !important;}</style>`\n\t\t\t);\n\t\t});\n\t}\n\n\tinitHoverArea()\n\t{\n\t\tif (this.hoverArea)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hoverArea = DesignerBlockUI.getHoverDiv();\n\n\t\tconst addNodeElement = DesignerBlockUI.getAddNodeButton();\n\t\tconst CardAction = BX.Landing.UI.Button.CardAction;\n\t\tconst BaseButtonPanel = BX.Landing.UI.Panel.BaseButtonPanel;\n\t\tconst cardAction = new BaseButtonPanel(\n\t\t\t'nodeAction',\n\t\t\t'landing-ui-panel-block-card-action'\n\t\t);\n\n\t\tEvent.bind(addNodeElement, 'click', () => {\n\t\t\tthis.repoManager.showPanel();\n\t\t\tthis.hideHoverArea();\n\t\t});\n\n\t\tcardAction.addButton(new CardAction('remove', {\n\t\t\thtml: '&nbsp;',\n\t\t\tonClick: this.removeElement.bind(this)\n\t\t}));\n\n\t\tvoid cardAction.show();\n\n\t\tDom.append(addNodeElement, this.hoverArea);\n\t\tDom.append(cardAction.layout, this.hoverArea);\n\t\tDom.append(this.hoverArea, this.getDocumentBody());\n\n\t\tEvent.bind(this.blockNode, 'mouseover', () => {\n\t\t\tthis.hideHoverArea();\n\t\t});\n\t}\n\n\tadjustHoverArea()\n\t{\n\t\tif (!this.hoverArea)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.showHoverArea();\n\n\t\tconst clientRect = this.activeNode.getElement().getBoundingClientRect();\n\t\tconst hoverElementAdd = this.hoverArea.querySelector('.landing-designer-block-node-hover-add');\n\t\tconst hoverElementActions = this.hoverArea.querySelector('div[data-id=\"nodeAction\"]');\n\t\tconst editorWindow = BX.Landing.PageObject.getEditorWindow();\n\n\t\tif (hoverElementActions)\n\t\t{\n\t\t\tif (this.activeNode.isPseudoElement())\n\t\t\t{\n\t\t\t\tDom.hide(hoverElementActions);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.show(hoverElementActions);\n\t\t\t}\n\t\t}\n\n\t\tif (hoverElementAdd)\n\t\t{\n\t\t\tDom.style(\n\t\t\t\thoverElementAdd,\n\t\t\t\t{ top: (clientRect.height - 5) + 'px' }\n\t\t\t);\n\t\t}\n\n\t\tDom.style(\n\t\t\tthis.hoverArea,\n\t\t\t{\n\t\t\t\ttop: clientRect.top + editorWindow.scrollY + 'px',\n\t\t\t\tleft: clientRect.left + (clientRect.width < 30 ? 30 : 0) + 'px',\n\t\t\t\twidth: clientRect.width + 'px',\n\t\t\t\theight: '35px'\n\t\t\t}\n\t\t);\n\t}\n\n\tshowHoverArea()\n\t{\n\t\tif (this.hoverArea)\n\t\t{\n\t\t\tDom.show(this.hoverArea);\n\t\t}\n\t}\n\n\thideHoverArea()\n\t{\n\t\tif (this.hoverArea)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tDom.hide(this.hoverArea);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\trefreshManifest(manifest: ?ManifestNodesItem)\n\t{\n\t\tif (manifest)\n\t\t{\n\t\t\tObject.keys(manifest).map(selector => {\n\t\t\t\tthis.nodes[selector] = manifest[selector];\n\t\t\t});\n\t\t}\n\t\tthis.initNodes();\n\t\tthis.initGrid();\n\t}\n\n\tgetDocumentBody(): HTMLElement\n\t{\n\t\treturn document.body;\n\t}\n\n\tisInsideElement(element: HTMLElement): boolean\n\t{\n\t\treturn element.parentElement.tagName === 'A';\n\t}\n\n\tsendLabel(key: string, value: string)\n\t{\n\t\tthis.metrika.clearSendedLabel();\n\t\tthis.metrika.sendLabel(null, key, value);\n\t}\n\n\taddElement(repoElement: RepoElementType)\n\t{\n\t\tconst activeNode = this.activeNode;\n\t\tconst tags = [];\n\n\t\t[...document.body.querySelectorAll(activeNode.getSelector())].map(node => {\n\t\t\tconst elementHtml = repoElement.html;\n\t\t\tconst element = Tag.render`${elementHtml}`;\n\t\t\tconst insertAfter = this.isInsideElement(node) ? node.parentNode : node;\n\t\t\tDom.insertAfter(element, insertAfter);\n\t\t\ttags.push({\n\t\t\t\telementHtml,\n\t\t\t\telementSelector: BX.Landing.Utils.getCSSSelector(element),\n\t\t\t\tinsertAfterSelector: BX.Landing.Utils.getCSSSelector(insertAfter)\n\t\t\t});\n\t\t});\n\n\t\tthis.sendLabel(\n\t\t\t'designerBlock',\n\t\t\t'addElement' +\n\t\t\t'&code=' + this.blockCode +\n\t\t\t'&name=' + repoElement.code +\n\t\t\t'&preset=' + (Object.keys(repoElement.manifest.nodes).length === 1 ? 'N' : 'Y')\n\t\t);\n\n\t\tthis.changed = true;\n\t\tthis.refreshManifest(repoElement.manifest.nodes);\n\t\tthis.highlight.show(null);\n\n\t\tBackend.getInstance()\n\t\t\t.action(\"History::pushDesignerBlock\", {\n\t\t\t\tblockId: this.blockId,\n\t\t\t\taction: 'ADD_NODE',\n\t\t\t\tdata: {\n\t\t\t\t\ttags: tags,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.then(result => {\n\t\t\t\tBX.Landing.History.getInstance().push();\n\t\t\t});\n\t}\n\n\tremoveElement()\n\t{\n\t\tconst tags = [];\n\t\tthis.hideHoverArea();\n\n\t\tthis.highlight.hide();\n\n\t\tsetTimeout(() => {\n\n\t\t\tthis.sendLabel(\n\t\t\t\t'designerBlock',\n\t\t\t\t'removeElement' +\n\t\t\t\t'&tagName=' + this.activeNode.getElement().tagName +\n\t\t\t\t'&code=' + this.blockCode\n\t\t\t);\n\n\t\t\t[...document.body.querySelectorAll(this.activeNode.getSelector())].map(node => {\n\t\t\t\ttags.push({\n\t\t\t\t\telementHtml: this.clearHtml(node.outerHTML),\n\t\t\t\t\telementSelector: BX.Landing.Utils.getCSSSelector(node),\n\t\t\t\t\tinsertAfterSelector: node.previousElementSibling ? BX.Landing.Utils.getCSSSelector(node.previousElementSibling) : null,\n\t\t\t\t\tparentNodeSelector: BX.Landing.Utils.getCSSSelector(node.parentNode)\n\t\t\t\t});\n\t\t\t\tthis.removeNode(node);\n\t\t\t});\n\n\t\t\tthis.changed = true;\n\t\t\tthis.refreshManifest();\n\n\t\t\tBackend.getInstance()\n\t\t\t\t.action(\"History::pushDesignerBlock\", {\n\t\t\t\t\tblockId: this.blockId,\n\t\t\t\t\taction: 'REMOVE_NODE',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tselector: this.activeNode.getOriginalSelector(),\n\t\t\t\t\t\ttags: tags,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.then(result => {\n\t\t\t\t\tBX.Landing.History.getInstance().push();\n\t\t\t\t});\n\n\t\t}, 0);\n\t}\n\n\ttypeWithWrapper(type: string)\n\t{\n\t\treturn type === 'icon' || type === 'embed';\n\t}\n\n\taddNode(nodeOptions: NodeType): boolean\n\t{\n\t\tif (!this.nodeMap.get(nodeOptions.element))\n\t\t{\n\t\t\tif (nodeOptions.selector.match(/^\\.[\\w-_]+$/i) === null)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// for some type we get parent node\n\t\t\tconst withWrapper = this.typeWithWrapper(nodeOptions.type);\n\t\t\tnodeOptions.element = withWrapper\n\t\t\t\t? nodeOptions.element.parentNode\n\t\t\t\t: nodeOptions.element;\n\t\t\tif (withWrapper)\n\t\t\t{\n\t\t\t\tnodeOptions.selector = nodeOptions.selector + '--type-wrapper';\n\t\t\t\tDom.addClass(nodeOptions.element, nodeOptions.selector.substr(1));\n\t\t\t}\n\t\t\t// mouse over callback\n\t\t\tnodeOptions.onHover = this.onMouseOver.bind(this);\n\n\t\t\tthis.nodeMap.set(\n\t\t\t\tnodeOptions.element,\n\t\t\t\tnew Node(nodeOptions)\n\t\t\t);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveNode(node: HTMLElement)\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tDom.remove(node);\n\t\t\tthis.nodeMap.delete(node);\n\t\t}\n\t}\n\n\tonMouseOver(node: Node)\n\t{\n\t\tif (this.saving)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.activeNode = node;\n\t\tthis.adjustHoverArea();\n\t\tif (!node.isPseudoElement())\n\t\t{\n\t\t\tthis.highlight.show(node.getElement());\n\t\t}\n\t}\n}\n"],"names":["Node","options","element","selector","cardSelector","onHover","pseudoElement","Dom","hasClass","Event","bind","onMouseOver","className","addClass","event","stopPropagation","DesignerBlockUI","Tag","render","Loc","getMessage","RepoPanel","title","scrollAnimation","currentCategory","cache","Cache","MemoryCache","onElementSelect","renderTo","parent","document","body","layout","repository","map","item","addElement","newManifest","Object","keys","manifest","nodes","randPostfix","randomNum","substr","html","replaceAll","RegExp","nodeCard","BX","Landing","UI","Card","BlockPreviewCard","name","image","code","onClick","makeElementUnique","hide","appendCard","min","max","parseInt","Math","random","remember","Content","RepoManager","panel","addRepository","show","then","DesignerBlock","blockNode","originalNode","children","blockCode","blockId","id","designed","autoPublicationEnabled","landingId","lid","highlight","Highlight","cardSelectors","cards","designAllowed","Env","getInstance","getOptions","design_block_allowed","push","nodeMap","WeakMap","metrika","Metrika","repoManager","saveButton","getElementById","top","addCustomEvent","preventEvents","initHistoryEvents","initTopPanel","initNodes","initGrid","initSliders","initHoverArea","content","replace","preventMap","a","form","input","tag","querySelectorAll","node","e","preventDefault","History","setTypeDesignerBlock","Backend","action","getDocumentBody","tags","elementAdded","insertAfterSelector","parentNodeSelector","elementHtml","insertAfter","querySelector","prepend","refreshManifest","setTimeout","sendLabel","removeNode","elementSelector","finishCallback","SidePanel","Instance","close","changed","InfoHelper","saving","batch","data","block","clearHtml","innerHTML","addNode","type","wrapper","parentNode","attr","getPseudoLast","append","sliderSelector","slider","count","Text","toNumber","dataset","slidesShow","rows","classList","join","head","appendChild","hoverArea","getHoverDiv","addNodeElement","getAddNodeButton","CardAction","Button","BaseButtonPanel","Panel","cardAction","showPanel","hideHoverArea","addButton","removeElement","showHoverArea","clientRect","activeNode","getElement","getBoundingClientRect","hoverElementAdd","hoverElementActions","editorWindow","PageObject","getEditorWindow","isPseudoElement","style","height","scrollY","left","width","parentElement","tagName","key","value","clearSendedLabel","repoElement","getSelector","isInsideElement","Utils","getCSSSelector","length","result","outerHTML","previousElementSibling","getOriginalSelector","nodeOptions","get","match","withWrapper","typeWithWrapper","set","remove","adjustHoverArea"],"mappings":"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"}