this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(e,t,o){"use strict";var n=function(){function e(t){babelHelpers.classCallCheck(this,e);this.node=t;return this}babelHelpers.createClass(e,[{key:"setParent",value:function e(t){this.parent=t;return this}},{key:"setDefaultValue",value:function e(t){this.defaultValue=t;return this}},{key:"setChangeHandler",value:function e(o){t.Event.bind(this.node,"change",o)}},{key:"setClickHandler",value:function e(o){t.Event.bind(this.node,"click",o)}},{key:"getValue",value:function e(){return this.parent&&this.parent.getValue()!==true?this.defaultValue:this.getValueInternal()}},{key:"getValueInternal",value:function e(){return this.node}}]);return e}();var i;var r=function(e){babelHelpers.inherits(r,e);function r(e){var t;var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;babelHelpers.classCallCheck(this,r);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(r).call(this));t.setEventNamespace("BX.Landing.SettingsForm.DesignPreview");t.form=e;t.phrase=n;t.id=i;t.options=o;t.initControls();t.initLayout();t.applyStyles();t.onApplyStyles=t.applyStyles.bind(babelHelpers.assertThisInitialized(t));return t}babelHelpers.createClass(r,[{key:"initLayout",value:function e(){var o=this;this.layout=this.createLayout();this.styleNode=document.createElement("style");t.Dom.append(this.styleNode,this.layout);t.Dom.append(this.layout,this.form);var n={threshold:1};var i=new IntersectionObserver((function(e){e.forEach((function(e){var t=document.documentElement.clientHeight-r.HEIGHT_PAGE_TITLE_WRAP;if(e.target.getBoundingClientRect().height<=t){if(e.isIntersecting){if(!o.hasOwnProperty("defaultIntersecting")){o.defaultIntersecting=true}if(o.defaultIntersecting){o.unFixElement()}}else{if(!o.hasOwnProperty("defaultIntersecting")){o.defaultIntersecting=false}if(o.defaultIntersecting){o.fixElement()}}}}))}),n);var s=document.querySelector("#"+this.id).parentNode;i.observe(s)}},{key:"initControls",value:function e(){this.controls={};for(var i in this.options){if(!this.options.hasOwnProperty(i)){continue}for(var r in this.options[i]){if(!this.options[i].hasOwnProperty(r)){continue}if(!this.controls[i]){this.controls[i]={}}var s=new n(this.options[i][r]["control"]);s.setChangeHandler(this.applyStyles.bind(this));if(i==="theme"&&r!=="use"){s.setClickHandler(this.applyStyles.bind(this))}if(i==="background"&&r==="field"){s.setClickHandler(this.applyStyles.bind(this))}this.controls[i][r]=s}}for(var l in this.controls){if(!this.controls.hasOwnProperty(l)){continue}for(var a in this.controls[l]){if(!this.controls[l].hasOwnProperty(a)){continue}if(a!=="use"&&this.controls[l]["use"]){this.controls[l][a].setParent(this.controls[l]["use"]);if(this.options[l][a]["defaultValue"]){this.controls[l][a].setDefaultValue(this.options[l][a]["defaultValue"])}}}}if(this.controls.theme.corporateColor.node){this.controls.theme.corporateColor.node.subscribe("onSelectCustomColor",this.applyStyles.bind(this))}if(this.controls.background.image.node){this.controls.background.image.node.subscribe("change",this.onApplyStyles.bind(this))}if(this.controls.typo.textColor.node){o.EventEmitter.subscribe(this.controls.typo.textColor.node,"BX.Landing.ColorPicker:onSelectColor",this.onApplyStyles.bind(this));o.EventEmitter.subscribe(this.controls.typo.textColor.node,"BX.Landing.ColorPicker:onClearColorPicker",this.onApplyStyles.bind(this))}if(this.controls.typo.hColor.node){o.EventEmitter.subscribe(this.controls.typo.hColor.node,"BX.Landing.ColorPicker:onSelectColor",this.onApplyStyles.bind(this));o.EventEmitter.subscribe(this.controls.typo.hColor.node,"BX.Landing.ColorPicker:onClearColorPicker",this.onApplyStyles.bind(this))}if(this.controls.background.color.node){o.EventEmitter.subscribe(this.controls.background.color.node,"BX.Landing.ColorPicker:onSelectColor",this.onApplyStyles.bind(this));o.EventEmitter.subscribe(this.controls.background.color.node,"BX.Landing.ColorPicker:onClearColorPicker",this.onApplyStyles.bind(this))}this.panel=BX.Landing.UI.Panel.GoogleFonts.getInstance();t.Dom.append(this.panel.layout,document.body);var c=this.controls.typo.textFont.node;var h=this.controls.typo.hFont.node;if(c&&h){c.setAttribute("value",this.convertFont(c.value));h.setAttribute("value",this.convertFont(h.value));t.Event.bind(c,"click",this.onCodeClick.bind(this));t.Event.bind(h,"click",this.onCodeClick.bind(this))}}},{key:"onCodeClick",value:function e(t){var o=this;this.panel.show({hideOverlay:true,context:window}).then((function(e){var n=t.target;n.setAttribute("value",e.family);o.onApplyStyles()}))}},{key:"onApplyStyles",value:function e(){this.applyStyles()}},{key:"applyStyles",value:function e(){this.styleNode.innerHTML=this.generateCss()}},{key:"generateSelectorStart",value:function e(t){return"#"+t+" {"}},{key:"generateSelectorEnd",value:function e(t){return t+" }"}},{key:"getCSSPart1",value:function e(t){var o;var n=this.controls.theme.baseColors.node;var i;if(this.controls.theme.corporateColor.node){i=this.controls.theme.corporateColor.node.element}var r;if(n){r=n.querySelector(".active")}var s;if(i){s=i.classList.contains("active")}if(r){o=r.dataset.value}if(s){o=i.dataset.value}if(this.controls.theme.use.node){if(this.controls.theme.use.node.checked===false){o=this.controls.theme.corporateColor.defaultValue}}if(o){if(o[0]!=="#"){o="#"+o}t+="--design-preview-primary: ".concat(o,";")}return t}},{key:"getCSSPart2",value:function e(o){var n;var i;var s;var l;var a;var c;var h;var u;if(this.controls.typo.textColor.node){n=this.controls.typo.textColor.node.input.value}if(this.controls.typo.textFont.node){i=this.controls.typo.textFont.node.value}if(this.controls.typo.hFont.node){s=this.controls.typo.hFont.node.value}if(this.controls.typo.textSize.node){l=Math.round(this.controls.typo.textSize.node.value*r.DEFAULT_FONT_SIZE)+"px"}if(this.controls.typo.textWeight.node){a=this.controls.typo.textWeight.node.value}if(this.controls.typo.textLineHeight.node){c=this.controls.typo.textLineHeight.node.value}if(this.controls.typo.hColor.node){h=this.controls.typo.hColor.node.input.value}if(this.controls.typo.hWeight.node){u=this.controls.typo.hWeight.node.value}if(this.controls.typo.use.node){if(this.controls.typo.use.node.checked===false){n=this.controls.typo.textColor.defaultValue;i=this.controls.typo.textFont.defaultValue;s=this.controls.typo.hFont.defaultValue;l=Math.round(this.controls.typo.textSize.defaultValue*r.DEFAULT_FONT_SIZE)+"px";a=this.controls.typo.textWeight.defaultValue;c=this.controls.typo.textLineHeight.defaultValue;h=this.controls.typo.hColor.defaultValue;u=this.controls.typo.hWeight.defaultValue}}var d;var p;if(i){d=this.createLink(i);t.Dom.append(d,this.form)}if(s){p=this.createLink(s);t.Dom.append(p,this.form)}o+="--design-preview-color: ".concat(n,";");o+="--design-preview-font-theme: ".concat(i,";");o+="--design-preview-font-size: ".concat(l,";");o+="--design-preview-font-weight: ".concat(a,";");o+="--design-preview-line-height: ".concat(c,";");if(h){o+="--design-preview-color-h: ".concat(h,";")}else{o+="--design-preview-color-h: ".concat(n,";")}if(u){o+="--design-preview-font-weight-h: ".concat(u,";")}else{o+="--design-preview-font-weight-h: ".concat(a,";")}if(this.controls.typo.hFont.node){o+="--design-preview-font-h-theme: ".concat(s,";")}else{o+="--design-preview-font-h-theme: ".concat(i,";")}return o}},{key:"createLink",value:function e(t){var o=document.createElement("link");o.rel="stylesheet";o.href="https://fonts.googleapis.com/css2?family=";o.href+=t.replace(" ","+");o.href+=":wght@100;200;300;400;500;600;700;800;900";return o}},{key:"getCSSPart3",value:function e(t){var o=this.controls.background.color.node.input.value;var n=this.controls.background.field.node;var i=n.getElementsByClassName("landing-ui-field-image-hidden");var r=i[0].getAttribute("src");var s=this.controls.background.position.node.value;if(this.controls.background.use.node.checked===true){t+="--design-preview-bg: ".concat(o,";")}else{r="";if(this.controls.background.useSite){if(this.controls.background.useSite.defaultValue==="Y"){o=this.controls.background.color.defaultValue;r=this.controls.background.field.defaultValue;s=this.controls.background.position.defaultValue;t+="--design-preview-bg: ".concat(o,";")}}}if(this.controls.background.position){if(s==="center"){t+="background-image: url(".concat(r,");");t+="background-attachment: scroll;";t+="background-position: center;";t+="background-repeat: no-repeat;";t+="background-size: cover;"}if(s==="repeat"){t+="background-image: url(".concat(r,");");t+="background-attachment: scroll;";t+="background-position: center;";t+="background-repeat: repeat;";t+="background-size: 50%;"}if(s==="center_repeat_y"){t+="background-image: url(".concat(r,");");t+="background-attachment: scroll;";t+="background-position: top;";t+="background-repeat: repeat-y;";t+="background-size: 100%;"}}return t}},{key:"generateCss",value:function e(){var t;t=this.generateSelectorStart(this.id);t=this.getCSSPart1(t);t=this.getCSSPart2(t);t=this.getCSSPart3(t);t=this.generateSelectorEnd(t);return t}},{key:"createLayout",value:function e(){return t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['<div class="landing-design-preview-wrap"><div id="','" class="landing-design-preview"><h2 class="landing-design-preview-title">','</h2><h4 class="landing-design-preview-subtitle">','</h4><p class="landing-design-preview-text">','</p><p class="landing-design-preview-text">','</p><div class=""><a href="#" class="landing-design-preview-button">',"</a></div></div></div>"])),this.id,this.phrase.title,this.phrase.subtitle,this.phrase.text1,this.phrase.text2,this.phrase.button)}},{key:"fixElement",value:function e(){var t=20;var o=document.querySelector("#"+this.id);var n=o.parentNode;var i=n.getBoundingClientRect();var r=20;var s=i.width-r*2;var l=n.parentNode;var a=l.getBoundingClientRect();var c=o.getBoundingClientRect();var h=document.body.clientWidth;var u=h-a.right+t;if(a.height>c.height){var d;d="position: fixed; ";d+="top: 20px; ";d+="margin-top: 0; ";d+="right: "+u+"px;";d+="max-width: "+s+"px;";o.setAttribute("style",d)}}},{key:"unFixElement",value:function e(){var t=document.querySelector("#"+this.id);t.setAttribute("style","")}},{key:"convertFont",value:function e(t){t=t.replace("g-font-","");t=t.replaceAll("-"," ");t=t.replace("ibm ","IBM ");t=t.replace("pt ","PT ");t=t.replace(/sc(?:(?![a-z]))/i,"SC");t=t.replace(/jp(?:(?![a-z]))/i,"JP");t=t.replace(/kr(?:(?![a-z]))/i,"KR");t=t.replace(/tc(?:(?![a-z]))/i,"TC");t=t.replace(/(^|\s)\S/g,(function(e){return e.toUpperCase()}));return t}}]);return r}(o.EventEmitter);babelHelpers.defineProperty(r,"DEFAULT_FONT_SIZE",14);babelHelpers.defineProperty(r,"HEIGHT_PAGE_TITLE_WRAP",74);e.DesignPreview=r})(this.BX.Landing.SettingsForm=this.BX.Landing.SettingsForm||{},BX,BX.Event);
//# sourceMappingURL=designpreview.bundle.map.js