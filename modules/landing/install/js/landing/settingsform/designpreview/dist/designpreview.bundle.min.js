this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(t,e){"use strict";var n=function(){function t(e){babelHelpers.classCallCheck(this,t);this.node=e;return this}babelHelpers.createClass(t,[{key:"setParent",value:function t(e){this.parent=e;return this}},{key:"setDefaultValue",value:function t(e){this.defaultValue=e;return this}},{key:"setChangeHandler",value:function t(n){e.Event.bind(this.node,"change",n)}},{key:"setClickHandler",value:function t(n){e.Event.bind(this.node,"click",n)}},{key:"getValue",value:function t(){return this.parent&&this.parent.getValue()!==true?this.defaultValue:this.getValueInternal()}},{key:"getValueInternal",value:function t(){return this.node}}]);return t}();function i(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-design-preview-wrap">\n\t\t\t\t<div class="landing-design-preview">\n\t\t\t\t\t<h2 class="landing-design-preview-title">','</h2>\n\t\t\t\t\t<h4 class="landing-design-preview-subtitle">','</h4>\n\t\t\t\t\t<p class="landing-design-preview-text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</p>\n\t\t\t\t\t<p class="landing-design-preview-text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class="">\n\t\t\t\t\t\t<a href="#" class="landing-design-preview-button">',"</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);i=function e(){return t};return t}var o=function(){function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};babelHelpers.classCallCheck(this,t);this.form=e;this.phrase=i;this.initControls(n);this.initLayout();this.applyStyles();this.onApplyStyles=this.applyStyles.bind(this)}babelHelpers.createClass(t,[{key:"initLayout",value:function n(){var i=this;this.layout=t.createLayout(this.phrase);this.styleNode=document.createElement("style");e.Dom.append(this.styleNode,this.layout);e.Dom.append(this.layout,this.form);var o={threshold:1};var r=new IntersectionObserver(function(t){t.forEach(function(t){if(t.isIntersecting){if(!i.hasOwnProperty("defaultIntersecting")){i.defaultIntersecting=true}if(i.defaultIntersecting){i.unFixElement()}}else{if(!i.hasOwnProperty("defaultIntersecting")){i.defaultIntersecting=false}if(i.defaultIntersecting){i.fixElement()}}})},o);var a=document.querySelector(".landing-design-preview-wrap");r.observe(a)}},{key:"initControls",value:function t(e){this.controls={};for(var i in e){if(!e.hasOwnProperty(i)){continue}for(var o in e[i]){if(!e[i].hasOwnProperty(o)){continue}if(!this.controls[i]){this.controls[i]={}}var r=new n(e[i][o]["control"]);r.setChangeHandler(this.applyStyles.bind(this));if(i==="theme"&&o!=="use"){r.setClickHandler(this.applyStyles.bind(this))}if(i==="background"&&o==="picture"){r.setClickHandler(this.applyStyles.bind(this))}this.controls[i][o]=r}}for(var a in this.controls){if(!this.controls.hasOwnProperty(a)){continue}for(var s in this.controls[a]){if(!this.controls[a].hasOwnProperty(s)){continue}if(s!=="use"&&this.controls[a]["use"]){this.controls[a][s].setParent(this.controls[a]["use"]);if(e[a][s]["defaultValue"]){this.controls[a][s].setDefaultValue(e[a][s]["defaultValue"])}}}}BX.addCustomEvent("BX.Landing.ColorPicker:onSelectColor",this.onApplyStyles.bind(this));BX.addCustomEvent("BX.Landing.ColorPicker:onClearColorPicker",this.onApplyStyles.bind(this));BX.addCustomEvent("BX.Landing.UI.Field.Image:onChangeImage",this.onApplyStyles.bind(this));BX.addCustomEvent("BX.Landing.UI.Panel.GoogleFonts:onSelectFont",this.onApplyStyles.bind(this));var l=BX("field-themefonts_code");var c=BX("field-themefonts_code_h");var u=BX.Landing.UI.Panel.GoogleFonts.getInstance();BX.Dom.append(u.layout,document.body);l.setAttribute("value",this.convertFont(l.value));c.setAttribute("value",this.convertFont(c.value));this.showFontPanel(u,l);this.showFontPanel(u,c)}},{key:"showFontPanel",value:function t(e,n){n.onclick=function(){e.show({hideOverlay:true,targetWindow:"window"}).then(function(t){if(!this.response){n.setAttribute("value",t.family);BX.onCustomEvent("BX.Landing.UI.Panel.GoogleFonts:onSelectFont")}}.bind(this))}}},{key:"generateSelectorStart",value:function t(e){return"."+e+" {"}},{key:"generateSelectorEnd",value:function t(e){return e+" }"}},{key:"getCSSPart1",value:function t(e){var n;var i=BX("set-colors");var o=BX("colorpicker-theme");var r=i.querySelector(".active");var a=o.classList.contains("active");if(r){n=r.dataset.value}if(a){n=o.dataset.value}if(n[0]!=="#"){n="#"+n}if(this.controls.theme.use.node){if(this.controls.theme.use.node.checked===false){n=this.controls.theme.corporateColor.defaultValue}}e+="--design-preview-primary: ".concat(n,";");return e}},{key:"getCSSPart2",value:function n(i){var o=this.controls.typo.textColor.node.value;var r=this.controls.typo.font.node.value;var a=this.controls.typo.hFont.node.value;var s=Math.round(this.controls.typo.textSize.node.value*t.DEFAULT_FONT_SIZE)+"px";var l=this.controls.typo.textWeight.node.value;var c=this.controls.typo.textLineHeight.node.value;var u=this.controls.typo.hColor.node.value;var d=this.controls.typo.hWeight.node.value;if(this.controls.typo.use.node){if(this.controls.typo.use.node.checked===false){o=this.controls.typo.textColor.defaultValue;r=this.controls.typo.font.defaultValue;a=this.controls.typo.hFont.defaultValue;s=Math.round(this.controls.typo.textSize.defaultValue*t.DEFAULT_FONT_SIZE)+"px";l=this.controls.typo.textWeight.defaultValue;c=this.controls.typo.textLineHeight.defaultValue;u=this.controls.typo.hColor.defaultValue;d=this.controls.typo.hWeight.defaultValue}}var h=this.createLink(r);e.Dom.append(h,this.form);var g=this.createLink(a);e.Dom.append(g,this.form);i+="--design-preview-color: ".concat(o,";");i+="--design-preview-font-theme: ".concat(r,";");i+="--design-preview-font-size: ".concat(s,";");i+="--design-preview-font-weight: ".concat(l,";");i+="--design-preview-line-height: ".concat(c,";");if(u){i+="--design-preview-color-h: ".concat(u,";")}else{i+="--design-preview-color-h: ".concat(o,";")}if(d){i+="--design-preview-font-weight-h: ".concat(d,";")}else{i+="--design-preview-font-weight-h: ".concat(l,";")}if(this.controls.typo.hFont.node.value){i+="--design-preview-font-h-theme: ".concat(a,";")}else{i+="--design-preview-font-h-theme: ".concat(r,";")}return i}},{key:"getCSSPart3",value:function t(e){var n=this.controls.background.color.node.value;var i=BX("landing-form-background-field");var o=i.getElementsByClassName("landing-ui-field-image-hidden");var r=o[0].getAttribute("src");var a=this.controls.background.position.node.value;if(this.controls.background.use.node.checked===true){e+="--design-preview-bg: ".concat(n,";")}else{r="";if(this.controls.background.useSite){if(this.controls.background.useSite.defaultValue==="Y"){n=this.controls.background.color.defaultValue;r=this.controls.background.picture.defaultValue;a=this.controls.background.position.defaultValue;e+="--design-preview-bg: ".concat(n,";")}}}if(this.controls.background.position){if(a==="center"){e+="background-image: url(".concat(r,");");e+="background-attachment: scroll;";e+="background-position: center;";e+="background-repeat: no-repeat;";e+="background-size: cover;"}if(a==="repeat"){e+="background-image: url(".concat(r,");");e+="background-attachment: scroll;";e+="background-position: center;";e+="background-repeat: repeat;";e+="background-size: 50%;"}if(a==="center_repeat_y"){e+="background-image: url(".concat(r,");");e+="background-attachment: scroll;";e+="background-position: top;";e+="background-repeat: repeat-y;";e+="background-size: 100%;"}}return e}},{key:"createLink",value:function t(e){var n=document.createElement("link");n.rel="stylesheet";n.href="https://fonts.googleapis.com/css2?family=";n.href+=e.replace(" ","+");n.href+=":wght@300;400;500;600;700;900";return n}},{key:"generateCss",value:function t(){var e;e=this.generateSelectorStart("landing-design-preview");e=this.getCSSPart1(e);e=this.getCSSPart2(e);e=this.getCSSPart3(e);e=this.generateSelectorEnd(e);return e}},{key:"onApplyStyles",value:function t(){this.applyStyles()}},{key:"applyStyles",value:function t(){this.styleNode.innerHTML=this.generateCss()}},{key:"fixElement",value:function t(){var e=20;var n=document.querySelector(".landing-design-form");var i=n.getBoundingClientRect();var o=document.querySelector(".landing-design-preview");var r=o.getBoundingClientRect();var a=document.body.clientWidth;var s=a-i.right+e;var l=25;var c=document.querySelector(".landing-design-preview-wrap");var u=c.getBoundingClientRect();var d=u.width-l*2;if(i.height>r.height){var h;h="position: fixed; ";h+="top: 20px; ";h+="margin-top: 0; ";h+="right: "+s+"px;";h+="max-width: "+d+"px;";o.setAttribute("style",h)}}},{key:"unFixElement",value:function t(){var e=document.querySelector(".landing-design-preview");e.setAttribute("style","")}},{key:"convertFont",value:function t(e){e=e.replace("g-font-","");e=e.replaceAll("-"," ");e=e.replace("ibm ","IBM ");e=e.replace("pt ","PT ");e=e.replace(/sc(?:(?![a-z]))/i,"SC");e=e.replace(/jp(?:(?![a-z]))/i,"JP");e=e.replace(/kr(?:(?![a-z]))/i,"KR");e=e.replace(/tc(?:(?![a-z]))/i,"TC");e=e.replace(/(^|\s)\S/g,function(t){return t.toUpperCase()});return e}}],[{key:"createLayout",value:function t(n){return e.Tag.render(i(),n.title,n.subtitle,n.text1,n.text2,n.button)}}]);return t}();babelHelpers.defineProperty(o,"DEFAULT_FONT_SIZE",14);t.DesignPreview=o})(this.BX.Landing.SettingsForm=this.BX.Landing.SettingsForm||{},BX);
//# sourceMappingURL=designpreview.bundle.map.js