this.BX = this.BX || {};
this.BX.Landing = this.BX.Landing || {};
this.BX.Landing.UI = this.BX.Landing.UI || {};
(function (exports,main_core) {
	'use strict';

	function _templateObject14() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t\t\t\t<div class=\"", "\">\n\t\t\t\t\t\t\t\t\t\t", "\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t"]);

	  _templateObject14 = function _templateObject14() {
	    return data;
	  };

	  return data;
	}

	function _templateObject13() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t<div class=\"row ", "\">\n\t\t\t\t\t\t\t", "\n\t\t\t\t\t\t</div>\n\t\t\t\t\t"]);

	  _templateObject13 = function _templateObject13() {
	    return data;
	  };

	  return data;
	}

	function _templateObject12() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div class=\"container\">\n\t\t\t\t", "\n\t\t\t</div>\n\t\t"]);

	  _templateObject12 = function _templateObject12() {
	    return data;
	  };

	  return data;
	}

	function _templateObject11() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t\t<div class=\"col-1 grid-item grid-item-last\" onclick=\"", "\">\n\t\t\t\t\t\t\t\t<div></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t"]);

	  _templateObject11 = function _templateObject11() {
	    return data;
	  };

	  return data;
	}

	function _templateObject10() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t\t<div class=\"", " grid-item\" onclick=\"", "\">\n\t\t\t\t\t\t\t\t<div data-ready=\"true\" data-rowNumber=\"", "\" data-colNumber=\"", "\">", "</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t"]);

	  _templateObject10 = function _templateObject10() {
	    return data;
	  };

	  return data;
	}

	function _templateObject9() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t<div class=\"landing-bootstrap-layout-add-row\" onclick=\"", "\">\n\t\t\t\t\t\t\t+\n\t\t\t\t\t\t</div>\n\t\t\t\t\t"]);

	  _templateObject9 = function _templateObject9() {
	    return data;
	  };

	  return data;
	}

	function _templateObject8() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t<div class=\"landing-bootstrap-layout-remove-row\" onclick=\"", "\">\n\t\t\t\t\t\t\t-\n\t\t\t\t\t\t</div>\n\t\t\t\t\t"]);

	  _templateObject8 = function _templateObject8() {
	    return data;
	  };

	  return data;
	}

	function _templateObject7() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div class=\"landing-bootstrap-layout-work container\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t", "\n\t\t\t\t\t", "\n\t\t\t\t\t", "\n\t\t\t\t\t", "\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);

	  _templateObject7 = function _templateObject7() {
	    return data;
	  };

	  return data;
	}

	function _templateObject6() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div class=\"landing-bootstrap-layout-wrapper-col-menu\">\n\t\t\t\t<div data-command=\"remove\">x</div>\n\t\t\t\t<div data-command=\"decrease\">&larr;</div>\n\t\t\t</div>\n\t\t"]);

	  _templateObject6 = function _templateObject6() {
	    return data;
	  };

	  return data;
	}

	function _templateObject5() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t\t<div class=\"col grid-item\">\n\t\t\t\t\t\t\t\t<div></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t"]);

	  _templateObject5 = function _templateObject5() {
	    return data;
	  };

	  return data;
	}

	function _templateObject4() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div class=\"landing-bootstrap-layout-background container\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t", "\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);

	  _templateObject4 = function _templateObject4() {
	    return data;
	  };

	  return data;
	}

	function _templateObject3() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t<span onclick=\"", "\" class=\"", "\">", "</span>\n\t\t\t\t\t"]);

	  _templateObject3 = function _templateObject3() {
	    return data;
	  };

	  return data;
	}

	function _templateObject2() {
	  var data = babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div class=\"landing-bootstrap-layout-switcher\">\n\t\t\t\t", "\n\t\t\t</div>\n\t\t"]);

	  _templateObject2 = function _templateObject2() {
	    return data;
	  };

	  return data;
	}

	function _templateObject() {
	  var data = babelHelpers.taggedTemplateLiteral(["<div class=\"landing-bootstrap-layout-wrapper\"></div>"]);

	  _templateObject = function _templateObject() {
	    return data;
	  };

	  return data;
	}
	var LayoutUI = /*#__PURE__*/function () {
	  function LayoutUI() {
	    babelHelpers.classCallCheck(this, LayoutUI);
	  }

	  babelHelpers.createClass(LayoutUI, null, [{
	    key: "getWrapper",
	    value: function getWrapper() {
	      return main_core.Tag.render(_templateObject());
	    }
	  }, {
	    key: "getModeSelector",
	    value: function getModeSelector(currentSize, onChangeView) {
	      return main_core.Tag.render(_templateObject2(), ['md', 'sm', 'xs'].map(function (size) {
	        return main_core.Tag.render(_templateObject3(), function () {
	          return onChangeView ? onChangeView(size) : {};
	        }, currentSize === size ? 'active' : '', size);
	      }));
	    }
	  }, {
	    key: "getBackground",
	    value: function getBackground() {
	      return main_core.Tag.render(_templateObject4(), babelHelpers.toConsumableArray(new Array(12)).map(function () {
	        return main_core.Tag.render(_templateObject5());
	      }));
	    }
	  }, {
	    key: "getHoverColMenu",
	    value: function getHoverColMenu() {
	      return main_core.Tag.render(_templateObject6());
	    }
	  }, {
	    key: "getWorkGrid",
	    value: function getWorkGrid(options) {
	      var nums = 0;
	      var rowNumber = parseInt(options.rowNumber);
	      var rowsNumber = options.rowsNumber,
	          cols = options.cols,
	          onNewRowClick = options.onNewRowClick,
	          onRemoveRowClick = options.onRemoveRowClick,
	          onIncColClick = options.onIncColClick,
	          onNewColClick = options.onNewColClick;
	      return main_core.Tag.render(_templateObject7(), rowsNumber <= 1 ? '' : main_core.Tag.render(_templateObject8(), function () {
	        return onRemoveRowClick ? onRemoveRowClick(rowNumber) : {};
	      }), main_core.Tag.render(_templateObject9(), function () {
	        return onNewRowClick ? onNewRowClick(rowNumber) : {};
	      }), cols.map(function (col, i) {
	        nums += col > 0 ? col : 1;
	        return main_core.Tag.render(_templateObject10(), col > 0 ? "col-".concat(col) : 'col', function () {
	          return onIncColClick ? onIncColClick(rowNumber, i) : {};
	        }, rowNumber, i, col);
	      }), nums >= 12 ? '' : main_core.Tag.render(_templateObject11(), function () {
	        return onNewColClick ? onNewColClick(rowNumber) : {};
	      }));
	    }
	  }, {
	    key: "getResult",
	    value: function getResult(matrix) {
	      return main_core.Tag.render(_templateObject12(), matrix.map(function (row) {
	        return main_core.Tag.render(_templateObject13(), row['classes'] ? row['classes'] : '', row['cols'].map(function (col, i) {
	          var classes = col.classes ? col.classes.split(' ') : [];
	          Object.keys(col.sizes).map(function (size) {
	            var colValue = size === 'xs' ? "col-".concat(col.sizes[size]) : "col-".concat(size, "-").concat(col.sizes[size]);

	            if (!classes.includes(colValue)) {
	              classes.push(colValue);
	            }
	          });
	          return main_core.Tag.render(_templateObject14(), classes.join(' '), col.content ? col.content : '<div class="test-height"></div>');
	        }));
	      }));
	    }
	  }]);
	  return LayoutUI;
	}();

	function _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

	function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

	function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }
	var Layout = /*#__PURE__*/function () {
	  // @todo: all attrs too
	  function Layout(container, params) {
	    var _this = this;

	    babelHelpers.classCallCheck(this, Layout);
	    babelHelpers.defineProperty(this, "currentSize", 'md');
	    babelHelpers.defineProperty(this, "gridMatrix", []);
	    this.container = container;
	    this.colMenu = LayoutUI.getHoverColMenu();

	    if (params) {
	      this.result = params.result || null;
	    }

	    this.onChangeView = this.onChangeView.bind(this);
	    this.onNewRowClick = this.onNewRowClick.bind(this);
	    this.onRemoveRowClick = this.onRemoveRowClick.bind(this);
	    this.onIncColClick = this.onIncColClick.bind(this);
	    this.onNewColClick = this.onNewColClick.bind(this);
	    main_core.Event.bind(this.container, 'mouseover', function (e) {
	      _this.onMouseOver(e);
	    });
	    main_core.Event.bind(this.container, 'mouseout', function (e) {
	      _this.onMouseOut(e);
	    });
	    main_core.Event.bind(this.colMenu, 'click', function (e) {
	      _this.onColMenuClick(e);
	    });
	    this.loadMatrix();
	    this.drawMatrix();
	  }

	  babelHelpers.createClass(Layout, [{
	    key: "getResult",
	    value: function getResult() {
	      return LayoutUI.getResult(this.gridMatrix);
	    }
	  }, {
	    key: "getColsInRow",
	    value: function getColsInRow(rowNumber) {
	      var _this2 = this;

	      var cols = [];

	      if (this.gridMatrix[rowNumber]) {
	        this.gridMatrix[rowNumber].cols.map(function (colItem) {
	          cols.push(colItem.sizes[_this2.currentSize] ? colItem.sizes[_this2.currentSize] : 0);
	        });
	      }

	      return cols;
	    }
	  }, {
	    key: "getSumInRow",
	    value: function getSumInRow(rowNumber) {
	      return this.getColsInRow(rowNumber).reduce(function (sum, x) {
	        return sum + x;
	      });
	    }
	  }, {
	    key: "fillZero",
	    value: function fillZero(rowNumber) {
	      var _this3 = this;

	      var cols = this.getColsInRow(rowNumber);

	      if (cols[0] <= 0) {
	        var rowLength = this.gridMatrix[rowNumber]['cols'].length;
	        var newCol = parseInt(12 / rowLength);
	        this.gridMatrix[rowNumber]['cols'].map(function (colItem) {
	          colItem.sizes[_this3.currentSize] = newCol;
	        });
	      }
	    }
	  }, {
	    key: "querySelectorAll",
	    value: function querySelectorAll(node, regex, attribute) {
	      var output = [];

	      var _iterator = _createForOfIteratorHelper(node.querySelectorAll("[".concat(attribute, "]"))),
	          _step;

	      try {
	        for (_iterator.s(); !(_step = _iterator.n()).done;) {
	          var element = _step.value;

	          if (regex.test(element.getAttribute(attribute))) {
	            output.push(element);
	          }
	        }
	      } catch (err) {
	        _iterator.e(err);
	      } finally {
	        _iterator.f();
	      }

	      return output;
	    }
	  }, {
	    key: "loadMatrix",
	    value: function loadMatrix() {
	      var _this4 = this;

	      // @todo: all attrs too
	      this.gridMatrix = [];

	      if (this.result) {
	        babelHelpers.toConsumableArray(this.result.querySelectorAll('.row')).map(function (row) {
	          var cols = [];
	          babelHelpers.toConsumableArray(_this4.querySelectorAll(row, /col[a-z-]*[\d]+/, 'class')).map(function (col) {
	            var newCol = {
	              sizes: {}
	            };
	            var classes = col.getAttribute('class');
	            var found1 = classes.match(/col-([a-z]+)-([\d]+)/g);
	            var found2 = classes.match(/col-([\d]+)/g);

	            if (found1) {
	              found1.map(function (f) {
	                newCol.sizes[f.split('-')[1]] = parseInt(f.split('-')[2]);
	              });
	            }

	            if (found2) {
	              found2.map(function (f) {
	                newCol.sizes['xs'] = parseInt(f.split('-')[1]);
	              });
	            }

	            if (found1 || found2) {
	              newCol['content'] = col.innerHTML;
	              newCol['classes'] = col.getAttribute('class').replace(/col[a-z-]*[\d]+/g, '');
	              cols.push(newCol);
	            }
	          });

	          _this4.gridMatrix.push({
	            classes: row.getAttribute('class') || null,
	            cols: cols
	          });
	        });
	        console.log(this.gridMatrix);
	      }
	    }
	  }, {
	    key: "drawMatrix",
	    value: function drawMatrix() {
	      var _this5 = this;

	      main_core.Dom.clean(this.container);
	      this.container.appendChild(this.colMenu);
	      var rowsNumber = this.gridMatrix.length;
	      this.container.appendChild(LayoutUI.getModeSelector(this.currentSize, this.onChangeView));
	      Object.keys(this.gridMatrix).map(function (rowNumber) {
	        var wrapper = LayoutUI.getWrapper();

	        var cols = _this5.getColsInRow(rowNumber);

	        wrapper.appendChild(LayoutUI.getBackground());
	        wrapper.appendChild(LayoutUI.getWorkGrid({
	          rowNumber: rowNumber,
	          rowsNumber: rowsNumber,
	          cols: cols,
	          onNewRowClick: _this5.onNewRowClick,
	          onRemoveRowClick: _this5.onRemoveRowClick,
	          onIncColClick: _this5.onIncColClick,
	          onNewColClick: _this5.onNewColClick
	        }));

	        _this5.container.appendChild(wrapper);
	      });

	      if (this.result) {
	        main_core.Dom.clean(this.result);
	        this.result.appendChild(this.getResult());
	      }
	    }
	  }, {
	    key: "onChangeView",
	    value: function onChangeView(size) {
	      this.currentSize = size;
	      this.drawMatrix();
	    }
	  }, {
	    key: "onRemoveRowClick",
	    value: function onRemoveRowClick(rowNumber) {
	      this.gridMatrix = this.gridMatrix.filter(function (item, number) {
	        return number !== rowNumber;
	      });
	      this.drawMatrix();
	    }
	  }, {
	    key: "onNewRowClick",
	    value: function onNewRowClick(rowNumber) {
	      if (this.gridMatrix[rowNumber]) {
	        var sizes = {};
	        sizes[this.currentSize] = 1;
	        var newRow = {
	          classes: null,
	          cols: [{
	            sizes: sizes
	          }]
	        };
	        this.gridMatrix.splice(rowNumber + 1, 0, newRow);
	      }

	      this.drawMatrix();
	    }
	  }, {
	    key: "onIncColClick",
	    value: function onIncColClick(rowNumber, colNumber) {
	      this.fillZero(rowNumber);

	      if (this.getSumInRow(rowNumber) < 12) {
	        this.gridMatrix[rowNumber]['cols'][colNumber]['sizes'][this.currentSize]++;
	      }

	      this.drawMatrix();
	    }
	  }, {
	    key: "onDecColClick",
	    value: function onDecColClick(rowNumber, colNumber) {
	      this.fillZero(rowNumber);

	      if (this.gridMatrix[rowNumber]) {
	        if (this.gridMatrix[rowNumber]['cols'][colNumber]['sizes'][this.currentSize] > 1) {
	          this.gridMatrix[rowNumber]['cols'][colNumber]['sizes'][this.currentSize]--;
	        } else {
	          this.onRemoveColClick(rowNumber, colNumber);
	          return;
	        }
	      }

	      this.drawMatrix();
	    }
	  }, {
	    key: "onNewColClick",
	    value: function onNewColClick(rowNumber) {
	      this.fillZero(rowNumber);

	      if (this.gridMatrix[rowNumber]) {
	        var sizes = {};
	        sizes[this.currentSize] = 1;
	        this.gridMatrix[rowNumber]['cols'].push({
	          sizes: sizes
	        });
	      }

	      this.drawMatrix();
	    }
	  }, {
	    key: "onRemoveColClick",
	    value: function onRemoveColClick(rowNumber, colNumber) {
	      this.fillZero(rowNumber);

	      if (this.gridMatrix[rowNumber]) {
	        this.gridMatrix[rowNumber]['cols'] = this.gridMatrix[rowNumber]['cols'].filter(function (item, number) {
	          return number !== colNumber;
	        });
	      }

	      this.drawMatrix();
	    }
	  }, {
	    key: "showColMenu",
	    value: function showColMenu() {
	      this.colMenu.style.display = 'block';
	    }
	  }, {
	    key: "hideColMenu",
	    value: function hideColMenu() {
	      this.colMenu.style.display = 'none';
	    }
	  }, {
	    key: "onMouseOver",
	    value: function onMouseOver(event) {
	      var element = null;
	      event.path.map(function (el) {
	        if (!(el && el.nodeType === Node.ELEMENT_NODE)) {
	          return;
	        }

	        if (el.getAttribute('data-ready')) {
	          element = el;
	        }
	      });

	      if (element) {
	        var clientRect = event.target.getBoundingClientRect();
	        this.showColMenu();
	        this.colMenu.setAttribute('data-rowNumber', element.getAttribute('data-rowNumber'));
	        this.colMenu.setAttribute('data-colNumber', element.getAttribute('data-colNumber'));
	        main_core.Dom.style(this.colMenu, {
	          top: clientRect.top + window.scrollY + 'px',
	          left: clientRect.left + clientRect.width + window.scrollX - 20 + 'px'
	        });
	      }
	    }
	  }, {
	    key: "onMouseOut",
	    value: function onMouseOut(event) {
	      if (!event.target.getAttribute('data-ready')) {
	        this.hideColMenu();
	      }
	    }
	  }, {
	    key: "onColMenuClick",
	    value: function onColMenuClick(event) {
	      var command = event.target.getAttribute('data-command');

	      if (command === 'decrease') {
	        this.onDecColClick(parseInt(event.target.parentNode.getAttribute('data-rowNumber')), parseInt(event.target.parentNode.getAttribute('data-colNumber')));
	      } else {
	        this.onRemoveColClick(parseInt(event.target.parentNode.getAttribute('data-rowNumber')), parseInt(event.target.parentNode.getAttribute('data-colNumber')));
	      }

	      this.hideColMenu();
	    }
	  }]);
	  return Layout;
	}();

	exports.Layout = Layout;

}((this.BX.Landing.UI.Bootstrap = this.BX.Landing.UI.Bootstrap || {}),BX));
//# sourceMappingURL=landing.ui.bootstrap.layout.bundle.js.map
