{"version":3,"file":"styleform.bundle.js","sources":["../src/styleform.js"],"sourcesContent":["import { Dom, Event, Type } from 'main.core';\nimport { BaseForm } from 'landing.ui.form.baseform';\nimport { Highlight } from 'landing.ui.highlight';\nimport { BaseField } from 'landing.ui.field.basefield';\nimport { fetchEventsFromOptions } from 'landing.ui.component.internal';\n\nimport './css/style_form.css';\nimport 'ui.design-tokens';\n\n/**\n * @memberOf BX.Landing.UI.Form\n */\nexport class StyleForm extends BaseForm\n{\n\t#styleFields: Map;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Form.StyleForm');\n\t\tthis.subscribeFromOptions(fetchEventsFromOptions(options));\n\n\t\tDom.addClass(this.layout, 'landing-ui-form-style');\n\t\tthis.iframe = 'iframe' in options ? options.iframe : null;\n\t\tthis.node = 'node' in options ? options.node : null;\n\t\tthis.selector = 'selector' in options ? options.selector : null;\n\t\tthis.collapsed = 'collapsed' in options ? options.collapsed : null;\n\t\tthis.#styleFields = new Map();\n\n\t\tthis.onHeaderEnter = this.onHeaderEnter.bind(this);\n\t\tthis.onHeaderLeave = this.onHeaderLeave.bind(this);\n\t\tthis.onHeaderClick = this.onHeaderClick.bind(this);\n\n\t\tthis.prepareHeader();\n\n\t\tEvent.bind(this.header, 'click', this.onHeaderClick);\n\t\tEvent.bind(this.header, 'mouseenter', this.onHeaderEnter);\n\t\tEvent.bind(this.header, 'mouseleave', this.onHeaderLeave);\n\n\t\tif (this.iframe)\n\t\t{\n\t\t\tthis.onFrameLoad();\n\t\t}\n\n\t\tif (this.collapsed)\n\t\t{\n\t\t\tDom.addClass(this.layout, 'landing-ui-form-style--collapsed');\n\t\t}\n\t}\n\n\tonFrameLoad()\n\t{\n\t\tif (!this.node)\n\t\t{\n\t\t\tthis.node = [...this.iframe.document.querySelectorAll(this.selector)];\n\t\t}\n\t}\n\n\tonHeaderEnter()\n\t{\n\t\tHighlight.getInstance().show(this.node);\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonHeaderLeave()\n\t{\n\t\tHighlight.getInstance().hide();\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonHeaderClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tDom.toggleClass(this.layout, 'landing-ui-form-style--collapsed');\n\t}\n\n\taddField(field: BaseField)\n\t{\n\t\tif (field)\n\t\t{\n\t\t\tconst attrKey = field?.data?.attrKey;\n\n\t\t\tfield.subscribe('onChange', this.onChange.bind(this));\n\t\t\tfield.subscribe('onInit', this.onInit.bind(this));\n\n\t\t\tthis.fields.add(field);\n\t\t\tBX.Dom.append(field.layout, this.body);\n\n\t\t\tif (attrKey)\n\t\t\t{\n\t\t\t\tthis.#styleFields.set(attrKey, field.getLayout());\n\t\t\t}\n\t\t}\n\t}\n\n\tonChange(event)\n\t{\n\t\tthis.#toggleLinkedFields(event.getData());\n\t\tthis.emit('onChange');\n\t}\n\n\tonInit(event)\n\t{\n\t\tthis.#toggleLinkedFields(event.getData());\n\t\tthis.emit('onInit');\n\t}\n\n\t#toggleLinkedFields(fieldData: Object)\n\t{\n\t\t// hide linked fields\n\t\tif (fieldData.hide && Type.isArray(fieldData.hide))\n\t\t{\n\t\t\tfieldData.hide.map((attr) => {\n\t\t\t\tconst layout = this.#styleFields.get(attr);\n\t\t\t\tif (layout)\n\t\t\t\t{\n\t\t\t\t\tBX.Dom.style(layout, 'display', 'none');\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t});\n\t\t}\n\n\t\t// show linked fields\n\t\tif (fieldData.show && Type.isArray(fieldData.show))\n\t\t{\n\t\t\tfieldData.show.map((attr) => {\n\t\t\t\tconst layout = this.#styleFields.get(attr);\n\t\t\t\tif (layout)\n\t\t\t\t{\n\t\t\t\t\tBX.Dom.style(layout, 'display', 'block');\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareHeader()\n\t{\n\t\tconst headerText = document.createElement('div');\n\t\tBX.Dom.addClass(headerText, 'landing-ui-form-header-text');\n\t\twhile (this.header.childNodes[0])\n\t\t{\n\t\t\tBX.Dom.append(this.header.childNodes[0], headerText);\n\t\t}\n\t\tBX.Dom.append(headerText, this.header);\n\t}\n}\n"],"names":["StyleForm","options","setEventNamespace","subscribeFromOptions","fetchEventsFromOptions","Dom","addClass","layout","iframe","node","selector","collapsed","Map","onHeaderEnter","bind","onHeaderLeave","onHeaderClick","prepareHeader","Event","header","onFrameLoad","document","querySelectorAll","Highlight","getInstance","show","hide","event","preventDefault","toggleClass","field","attrKey","data","subscribe","onChange","onInit","fields","add","BX","append","body","set","getLayout","getData","emit","headerText","createElement","childNodes","BaseForm","fieldData","Type","isArray","map","attr","get","style"],"mappings":"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"}