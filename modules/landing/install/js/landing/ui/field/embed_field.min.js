(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var e=BX.Landing.Utils.bind;var i=BX.Landing.Utils.fireCustomEvent;var t=BX.Landing.Utils.getQueryParams;var n=BX.Landing.Utils.remove;var a=BX.Landing.Utils.create;BX.Landing.UI.Field.Embed=function(e){e.textOnly=true;var i=e.content;e.content=i.source||i.src;e.placeholder=BX.Landing.Loc.getMessage("LANDING_EMBED_FIELD_PLACEHOLDER");e.description="<span class='landing-ui-anchor-preview'>"+BX.Landing.Loc.getMessage("LANDING_EMBED_FIELD_DESCRIPTION")+"</span>";BX.Landing.UI.Field.Text.apply(this,arguments);this.hiddenInput=a("input",{props:{type:"hidden",value:i.src||this.input.innerText}});this.error=BX.Landing.UI.Field.BaseField.createDescription(BX.Landing.Loc.getMessage("LANDING_EMBED_ERROR_WRONG_SOURCE_TEXT_2"));BX.Dom.addClass(this.error,"landing-ui-error");BX.Dom.style(this.description,"margin-bottom","0px");this.adjustForm()};BX.Landing.UI.Field.Embed.prototype={constructor:BX.Landing.UI.Field.Embed,__proto__:BX.Landing.UI.Field.Text.prototype,onInputInput:function(){var e=this.getValue();this.adjustForm(true);this.onInputHandler(e);this.onValueChangeHandler(this);var i=new BX.Event.BaseEvent({data:{value:e},compatData:[e]});this.emit("change",i)},isEmbedUrl:function(e){return BX.Landing.Utils.Matchers.youtube.test(e)||BX.Landing.Utils.Matchers.vimeo.test(e)||BX.Landing.Utils.Matchers.vk.test(e)||BX.Landing.Utils.Matchers.rutube.test(e)||BX.Landing.Utils.Matchers.vine.test(e)||BX.Landing.Utils.Matchers.facebookVideos.test(e)},getValue:function(){return{src:this.mediaService?this.mediaService.getEmbedURL():this.input.innerText,preview:this.mediaService?this.mediaService.getEmbedPreview():"",source:this.input.innerText}},adjustForm:function(e){var i=String(this.input.innerText).trim();this.hideError();if(this.isEmbedUrl(i)){var a=new BX.Landing.MediaService.Factory;if(this.mediaService&&this.mediaService.form){n(this.mediaService.form.layout)}this.mediaService=a.create(i,!e?t(this.hiddenInput.value):{});if(this.mediaService){var r=this.mediaService.getSettingsForm();if(r){this.layout.appendChild(r.layout)}if(!this.mediaService.isDataLoaded){this.readyToSave=false;BX.addCustomEvent(this.mediaService,"onDataLoaded",(()=>{this.readyToSave=true;this.emit("onChangeReadyToSave")}))}this.emit("onChangeReadyToSave")}}else{if(this.mediaService){n(this.mediaService.form.layout)}if(BX.Type.isStringFilled(i)){this.showError()}}},showError:function(){BX.Dom.append(this.error,this.layout);BX.Dom.style(this.description,"margin-bottom",null)},hideError:function(){BX.Dom.remove(this.error);BX.Dom.style(this.description,"margin-bottom","0px")}}})();
//# sourceMappingURL=embed_field.map.js