{"version":3,"file":"basefield.bundle.js","sources":["../src/basefield.js"],"sourcesContent":["import {Type, Event, Tag, Text, Dom, Runtime} from 'main.core';\nimport './css/style.css';\n\n/**\n * @memberOf BX.Landing.UI.Field\n */\nexport class BaseField extends Event.EventEmitter\n{\n\tstatic createLayout(): HTMLDivElement\n\t{\n\t\treturn Tag.render`<div class=\"landing-ui-field\"></div>`;\n\t}\n\n\tstatic createHeader(): HTMLDivElement\n\t{\n\t\treturn Tag.render`<div class=\"landing-ui-field-header\"></div>`;\n\t}\n\n\tstatic createDescription(text: string): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-ui-field-description\">\n\t\t\t\t<span class=\"fa fa-info-circle\"> </span> ${text}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tstatic currentField: ?BaseField = null;\n\n\tconstructor(options: {[key: string]: any} = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Field');\n\n\t\tthis.data = {...options};\n\t\tthis.id = Reflect.has(this.data, 'id') ? this.data.id : Text.getRandom();\n\t\tthis.selector = Reflect.has(this.data, 'selector') ? this.data.selector : Text.getRandom();\n\t\tthis.content = Reflect.has(this.data, 'content') ? this.data.content : '';\n\t\tthis.title = Type.isString(this.data.title) ? this.data.title : '';\n\t\tthis.placeholder = Type.isString(this.data.placeholder) ? this.data.placeholder : '';\n\t\tthis.className = Type.isString(this.data.className) ? this.data.className : '';\n\t\tthis.descriptionText = Type.isString(this.data.description) ? this.data.description : '';\n\t\tthis.description = null;\n\t\tthis.attribute = Type.isString(this.data.attribute) ? this.data.attribute : '';\n\t\tthis.hidden = Text.toBoolean(this.data.hidden);\n\t\tthis.property = Type.isString(this.data.property) ? this.data.property : '';\n\t\tthis.style = Reflect.has(this.data, 'style') ? this.data.style : '';\n\n\t\tconst {onValueChange} = this.data;\n\t\tthis.onValueChangeHandler = Type.isFunction(onValueChange) ? onValueChange : (() => {});\n\t\tthis.onPaste = this.onPaste.bind(this);\n\n\t\tthis.layout = BaseField.createLayout();\n\t\tthis.header = BaseField.createHeader();\n\t\tthis.input = this.createInput();\n\t\tthis.header.innerHTML = Text.encode(this.title);\n\n\t\tDom.append(this.header, this.layout);\n\t\tDom.append(this.input, this.layout);\n\n\t\tDom.attr(this.layout, 'data-selector', this.selector);\n\t\tDom.attr(this.input, 'data-placeholder', this.placeholder);\n\n\t\tif (Type.isArrayLike(this.className))\n\t\t{\n\t\t\tDom.addClass(this.layout, this.className);\n\t\t}\n\n\t\tif (\n\t\t\tType.isString(this.descriptionText)\n\t\t\t&& this.descriptionText !== ''\n\t\t)\n\t\t{\n\t\t\tthis.description = BaseField.createDescription(this.descriptionText);\n\t\t\tDom.append(this.description, this.layout);\n\t\t}\n\n\t\tEvent.bind(this.input, 'paste', this.onPaste);\n\n\t\tthis.init();\n\t}\n\n\tcreateInput(): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-ui-field-input\">${this.content}</div>\n\t\t`;\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tinit() {}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonPaste(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (event.clipboardData && event.clipboardData.getData)\n\t\t{\n\t\t\tconst text = event.clipboardData.getData('text/plain');\n\t\t\tdocument.execCommand('insertHTML', false, Text.encode(text));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst text = window.clipboardData.getData('text');\n\t\t\tdocument.execCommand('paste', true, Text.encode(text));\n\t\t}\n\t}\n\n\tgetNode(): HTMLDivElement\n\t{\n\t\treturn this.layout;\n\t}\n\n\tisChanged(): boolean\n\t{\n\t\tconst content = (() => {\n\t\t\tif (Type.isNil(this.content))\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif (Type.isString(this.content))\n\t\t\t{\n\t\t\t\treturn this.content.trim();\n\t\t\t}\n\n\t\t\treturn this.content;\n\t\t})();\n\n\t\treturn content !== this.getValue();\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.input.innerHTML.trim();\n\t}\n\n\tsetValue(value: any = '')\n\t{\n\t\tconst preparedValue = this.textOnly ? Text.encode(value) : value;\n\t\tthis.input.innerHTML = preparedValue.toString().trim();\n\n\t\tthis.onValueChangeHandler(this);\n\n\t\tconst event = new Event.BaseEvent({\n\t\t\tdata: {value: this.getValue()},\n\t\t\tcompatData: [this.getValue()],\n\t\t});\n\n\t\tthis.emit('change', event);\n\t}\n\n\tenable()\n\t{\n\t\tDom.attr(this.layout, 'disabled', false);\n\t\tDom.removeClass(this.layout, 'landing-ui-disable');\n\t}\n\n\tdisable()\n\t{\n\t\tDom.attr(this.layout, 'disabled', true);\n\t\tDom.addClass(this.layout, 'landing-ui-disable');\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\treset() {}\n\n\tclone(data): BaseField\n\t{\n\t\treturn new this.constructor(\n\t\t\tRuntime.clone(data || this.data),\n\t\t);\n\t}\n}"],"names":["BaseField","Tag","render","text","options","setEventNamespace","data","id","Reflect","has","Text","getRandom","selector","content","title","Type","isString","placeholder","className","descriptionText","description","attribute","hidden","toBoolean","property","style","onValueChange","onValueChangeHandler","isFunction","onPaste","bind","layout","createLayout","header","createHeader","input","createInput","innerHTML","encode","Dom","append","attr","isArrayLike","addClass","createDescription","Event","init","event","preventDefault","clipboardData","getData","document","execCommand","window","isNil","trim","getValue","value","preparedValue","textOnly","toString","BaseEvent","compatData","emit","removeClass","constructor","Runtime","clone","EventEmitter"],"mappings":"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"}