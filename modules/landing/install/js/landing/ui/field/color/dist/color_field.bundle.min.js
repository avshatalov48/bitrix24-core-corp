this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};this.BX.Landing.UI=this.BX.Landing.UI||{};(function(e,t,a,r,n,i,s){"use strict";var l;var o=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.cache=new s.Cache.MemoryCache;a.property="color";a.options=e;a.pseudoClass=null;return a}babelHelpers.createClass(t,[{key:"getProperty",value:function e(){return s.Type.isArray(this.property)?this.property:[this.property]}},{key:"getVariableName",value:function e(){return s.Type.isArray(this.variableName)?this.variableName:[this.variableName]}},{key:"isNullValue",value:function e(t){return t===null}},{key:"getPseudoClass",value:function e(){return this.pseudoClass}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return t.buildLayout()})}},{key:"buildLayout",value:function e(){return s.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(["<div>Base processor</div>"])))}},{key:"getClassName",value:function e(){return[this.className]}},{key:"getValue",value:function e(){}},{key:"getStyle",value:function e(){if(this.getValue()===null){return babelHelpers.defineProperty({},this.getVariableName(),null)}return babelHelpers.defineProperty({},this.getVariableName(),this.getValue().getStyleString())}},{key:"setProcessorValue",value:function e(t){var a=this.getVariableName()[this.getVariableName().length-1];this.setValue(t[a])}},{key:"setDefaultValue",value:function e(t){if(t!==null){var a=this.getProperty()[this.getProperty().length-1];if(a in t){this.setValue(t[a]);this.unsetActive();return}}this.setValue(null)}},{key:"setValue",value:function e(t){}},{key:"onReset",value:function e(){this.emit("onReset")}},{key:"unsetActive",value:function e(){}},{key:"onChange",value:function e(){this.cache.delete("value");this.emit("onChange")}}]);return t}(r.EventEmitter);var u=/^rgba? ?\((\d{1,3})[, ]+(\d{1,3})[, ]+(\d{1,3})([, ]+([\d\.]{1,5}))?\)$/i;function c(e){return!!e.match(u)}var h=/^#([\da-f]{3}){1,2}$/i;function g(e){return!!e.trim().match(h)}var p=/^hsla?\((\d{1,3}), ?(\d{1,3})%, ?(\d{1,3})%(, ?([\d .]+))?\)/i;function b(e){return!!e.trim().match(p)}function d(e){if(e.length===4){var t=parseInt("0x".concat(e[1]).concat(e[1]),16);var a=parseInt("0x".concat(e[2]).concat(e[2]),16);var r=parseInt("0x".concat(e[3]).concat(e[3]),16);return{r:t,g:a,b:r}}if(e.length===7){var n=parseInt("0x".concat(e[1]).concat(e[2]),16);var i=parseInt("0x".concat(e[3]).concat(e[4]),16);var s=parseInt("0x".concat(e[5]).concat(e[6]),16);return{r:n,g:i,b:s}}return{r:255,g:255,b:255}}function v(e){var t=e.r/255;var a=e.g/255;var r=e.b/255;var n=Math.max(t,a,r);var i=Math.min(t,a,r);var s,l,o=(n+i)/2;if(n===i){s=l=0}else{var u=n-i;l=o>.5?u/(2-n-i):u/(n+i);switch(n){case t:s=(a-r)/u+(a<r?6:0);break;case a:s=(r-t)/u+2;break;case r:s=(t-a)/u+4;break}s*=.6}return{h:Math.round(s*100),s:Math.round(l*100),l:Math.round(o*100),a:"a"in e?e.a:1}}function f(e){var t=d(e.trim());return v(t)}function y(e){var t=e.r.toString(16);var a=e.g.toString(16);var r=e.b.toString(16);if(t.length===1){t="0"+t}if(a.length===1){a="0"+a}if(r.length===1){r="0"+r}return"#"+t+a+r}function m(e){var t=e.h;var a=e.s/100;var r=e.l/100;var n=(1-Math.abs(2*r-1))*a;var i=n*(1-Math.abs(t/60%2-1));var s=r-n/2;var l=0;var o=0;var u=0;if(0<=t&&t<60){l=n;o=i;u=0}else if(60<=t&&t<120){l=i;o=n;u=0}else if(120<=t&&t<180){l=0;o=n;u=i}else if(180<=t&&t<240){l=0;o=i;u=n}else if(240<=t&&t<300){l=i;o=0;u=n}else if(300<=t&&t<360){l=n;o=0;u=i}l=Math.round((l+s)*255);o=Math.round((o+s)*255);u=Math.round((u+s)*255);return{r:l,g:o,b:u}}function C(e){var t=m(e);return y(t)}function k(e){var t=e.trim().match(u);if(t.length>0){return v({r:s.Text.toNumber(t[1]),g:s.Text.toNumber(t[2]),b:s.Text.toNumber(t[3]),a:t[5]?s.Text.toNumber(t[5]):1})}}function H(e){var t=e.trim().match(p);if(t&&t.length>0){return{h:s.Text.toNumber(t[1]),s:s.Text.toNumber(t[2]),l:s.Text.toNumber(t[3]),a:t[5]?s.Text.toNumber(t[5]):1}}}var L=/^(var\()?((--[\w\d-]*?)(-opacity_([\d_]+)?)?)\)?$/i;function T(e){return!!e.trim().match(L)}function A(e){var t=e.trim().match(L);if(!!t){var a={full:t[2],name:t[3]};if(t[5]){a.opacity=+parseFloat(t[5].replace("_",".")).toFixed(1)}return a}return null}var P={h:205,s:1,l:50,a:1};var I="cover";var E="scroll";var V=null;var _={url:null,size:I,attachment:E,overlay:V};var S=function(){function e(t){babelHelpers.classCallCheck(this,e);this.value=P;this.hex=null;this.cssVar=null;this.setValue(t)}babelHelpers.createClass(e,[{key:"getName",value:function e(){if(this.hex){return this.getHex()+"_"+this.getOpacity()}var t=this.getHsl(),a=t.h,r=t.s,n=t.l;return"".concat(a,"-").concat(r,"-").concat(n,"-").concat(this.getOpacity())}},{key:"setValue",value:function t(a){if(s.Type.isObject(a)){if(a instanceof e){this.value=a.getHsla();this.cssVar=a.getCssVar();this.hex=a.getHexOriginal()}else{this.value=babelHelpers.objectSpread({},this.value,a)}}if(s.Type.isString(a)){if(b(a)){this.value=H(a)}else if(g(a)){this.value=babelHelpers.objectSpread({},f(a),{a:P.a});this.hex=a}else if(c(a)){this.value=k(a)}else if(T(a)){var r=A(a);if(r!==null){this.cssVar=r.name;this.setValue(s.Dom.style(document.documentElement,this.cssVar));if(r.opacity){this.setOpacity(r.opacity)}}}}this.value.h=Math.round(this.value.h);this.value.s=Math.round(this.value.s);this.value.l=Math.round(this.value.l);this.value.a=+this.value.a.toFixed(1);return this}},{key:"setOpacity",value:function e(t){this.setValue({a:t});return this}},{key:"lighten",value:function e(t){this.value.l=Math.min(this.value.l+t,100);this.hex=null;return this}},{key:"darken",value:function e(t){this.value.l=Math.max(this.value.l-t,0);this.hex=null;return this}},{key:"saturate",value:function e(t){this.value.s=Math.min(this.value.s+t,100);this.hex=null;return this}},{key:"desaturate",value:function e(t){this.value.s=Math.max(this.value.s-t,0);this.hex=null;return this}},{key:"adjustHue",value:function e(t){this.value.h=(this.value.h+t)%360;return this}},{key:"getHsl",value:function e(){return{h:this.value.h,s:this.value.s,l:this.value.l}}},{key:"getHsla",value:function e(){return{h:this.value.h,s:this.value.s,l:this.value.l,a:this.value.a}}},{key:"getHex",value:function e(){return this.hex||C(this.value)}},{key:"getHexOriginal",value:function e(){return this.hex}},{key:"getOpacity",value:function e(){var t;return(t=this.value.a)!==null&&t!==void 0?t:P.a}},{key:"getCssVar",value:function e(){return this.cssVar}},{key:"getStyleString",value:function e(){if(this.cssVar===null){if(this.hex&&this.getOpacity()===P.a){return this.hex}var t=this.value,a=t.h,r=t.s,n=t.l,i=t.a;return"hsla(".concat(a,", ").concat(r,"%, ").concat(n,"%, ").concat(i,")")}else{var s=this.cssVar;if(this.value.a!==P.a){s=s+"-opacity-"+String(this.value.a).replace(".","_")}return"var(".concat(s,")")}}},{key:"getStyleStringForOpacity",value:function e(){var t=this.value,a=t.h,r=t.s,n=t.l;return"linear-gradient(to right, hsla(".concat(a,", ").concat(r,"%, ").concat(n,"%, 1) 0%, hsla(").concat(a,", ").concat(r,"%, ").concat(n,"%, 0) 100%)")}},{key:"getContrast",value:function t(){var a=60;var r=this.getHsl().h*Math.PI/180;a+=Math.sin(r)*10+5;var n=a-45*this.getHsl().l/100;return new e(this.value).setValue({l:(this.getHsl().l+n)%100})}},{key:"getLighten",value:function t(){var a=this.getHsl(),r=a.h,n=a.s,i=a.l;if(n>0){n+=(i-50)/100*60;n=Math.min(100,Math.max(0,i))}i+=10+20*i/100;i=Math.min(100,i);return new e({h:r,s:n,l:i})}}],[{key:"compare",value:function e(t,a){return t.getHsla().h===a.getHsla().h&&t.getHsla().s===a.getHsla().s&&t.getHsla().l===a.getHsla().l&&t.getHsla().a===a.getHsla().a&&t.cssVar===a.cssVar}},{key:"getMedian",value:function t(a,r){return new e({h:(a.getHsla().h+r.getHsla().h)/2,s:(a.getHsla().s+r.getHsla().s)/2,l:(a.getHsla().l+r.getHsla().l)/2,a:(a.getHsla().a+r.getHsla().a)/2})}}]);return e}();var O;var R=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.cache=new s.Cache.MemoryCache;return a}babelHelpers.createClass(t,[{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return t.buildLayout()})}},{key:"buildLayout",value:function e(){return s.Tag.render(O||(O=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-base-control">\n\t\t\t\tBase control\n\t\t\t</div>\n\t\t'])))}},{key:"getValue",value:function e(){return this.cache.remember("value",function(){return new S})}},{key:"setValue",value:function e(t){this.cache.set("value",t)}},{key:"onChange",value:function e(t){this.cache.delete("value");this.emit("onChange",t)}},{key:"setActive",value:function e(){s.Dom.addClass(this.getLayout(),t.ACTIVE_CLASS)}},{key:"unsetActive",value:function e(){s.Dom.removeClass(this.getLayout(),t.ACTIVE_CLASS)}},{key:"isActive",value:function e(){return s.Dom.hasClass(this.getLayout(),t.ACTIVE_CLASS)}}]);return t}(r.EventEmitter);babelHelpers.defineProperty(R,"ACTIVE_CLASS","active");var w,N,B,D,x;var F=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.setEventNamespace("BX.Landing.UI.Field.Color.Hex");e.previewMode=false;e.onInput=e.onInput.bind(babelHelpers.assertThisInitialized(e));e.onButtonClick=e.onButtonClick.bind(babelHelpers.assertThisInitialized(e));return e}babelHelpers.createClass(t,[{key:"setPreviewMode",value:function e(t){this.previewMode=!!t}},{key:"buildLayout",value:function e(){if(!this.previewMode){s.Event.bind(this.getInput(),"input",this.onInput);s.Event.bind(this.getButton(),"click",this.onButtonClick)}return s.Tag.render(w||(w=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-hex">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getInput(),this.getButton())}},{key:"getInput",value:function e(){var t=this;return this.cache.remember("input",function(){return t.previewMode?s.Tag.render(N||(N=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-hex-preview"></div>']))):s.Tag.render(B||(B=babelHelpers.taggedTemplateLiteral(['<input type="text" name="hexInput" value="" class="landing-ui-field-color-hex-input">'])))})}},{key:"getButton",value:function e(){var t=this;return this.cache.remember("editButton",function(){return t.previewMode?s.Tag.render(D||(D=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<svg class="landing-ui-field-color-hex-preview-btn" width="9" height="9" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td="M7.108 0l1.588 1.604L2.486 7.8.896 6.194 7.108 0zM.006 8.49a.166.166 0 00.041.158.161.161 0 00.16.042l1.774-.478L.484 6.715.006 8.49z"\n\t\t\t\t\t\t\tfill="#525C69"\n\t\t\t\t\t\t\tfill-rule="evenodd"/>\n\t\t\t\t\t</svg>']))):s.Tag.render(x||(x=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<svg class="landing-ui-field-color-hex-preview-btn" width="12" height="9" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td="M4.27 8.551L.763 5.304 2.2 3.902l2.07 1.846L9.836.533l1.439 1.402z"\n\t\t\t\t\t\t\tfill="#525C69"\n\t\t\t\t\t\t\tfill-rule="evenodd"/>\n\t\t\t\t\t</svg>'])))})}},{key:"onInput",value:function e(){var t=this.getInput().value.replace(/[^\da-f]/gi,"");t=t.substring(0,6);this.getInput().value="#"+t.toLowerCase();this.onChange()}},{key:"onButtonClick",value:function e(){this.onChange();this.emit("onButtonClick",{color:this.getValue()})}},{key:"onChange",value:function e(t){var a=this.getInput().value.length===7&&g(this.getInput().value)?new S(this.getInput().value):null;this.setValue(a);this.emit("onChange",{color:a})}},{key:"adjustColors",value:function e(t,a){s.Dom.style(this.getInput(),"background-color",a);s.Dom.style(this.getInput(),"color",t);s.Dom.style(this.getButton().querySelector("path"),"fill",t)}},{key:"focus",value:function e(){if(!this.previewMode){if(this.getValue()===null){this.getInput().value="#"}this.getInput().focus()}}},{key:"getValue",value:function e(){var a=this;return this.cache.remember("value",function(){return a.getInput().value===t.DEFAULT_TEXT?null:new S(a.getInput().value)})}},{key:"setValue",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a);if(a!==null){this.adjustColors(a.getContrast().getHex(),a.getHex());this.setActive()}else{this.adjustColors(t.DEFAULT_COLOR,t.DEFAULT_BG);this.unsetActive()}if(this.previewMode){this.getInput().innerText=a!==null?a.getHex():t.DEFAULT_TEXT}else if(i.PageObject.getRootWindow().document.activeElement!==this.getInput()){this.getInput().value=a!==null?a.getHex():t.DEFAULT_TEXT}}},{key:"setActive",value:function e(){s.Dom.addClass(this.getInput(),t.ACTIVE_CLASS)}},{key:"unsetActive",value:function e(){s.Dom.removeClass(this.getInput(),t.ACTIVE_CLASS)}},{key:"isActive",value:function e(){return s.Dom.hasClass(this.getInput(),t.ACTIVE_CLASS)}}]);return t}(R);babelHelpers.defineProperty(F,"DEFAULT_TEXT","#HEX");babelHelpers.defineProperty(F,"DEFAULT_COLOR","#000000");babelHelpers.defineProperty(F,"DEFAULT_BG","#eeeeee");var M,U;var G=function(e){babelHelpers.inherits(t,e);babelHelpers.createClass(t,null,[{key:"getDefaultSaturation",value:function e(){var a=window.top.document.location.saturation;var r=new URL(window.top.document.location).searchParams.get("saturation");var n=a||r||t.DEFAULT_SATURATION;window.top.document.body.style.setProperty("--saturation",n+"%");return parseInt(n)}}]);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.setEventNamespace("BX.Landing.UI.Field.Color.Spectrum");a.onPickerDragStart=a.onPickerDragStart.bind(babelHelpers.assertThisInitialized(a));a.onPickerDragMove=a.onPickerDragMove.bind(babelHelpers.assertThisInitialized(a));a.onPickerDragEnd=a.onPickerDragEnd.bind(babelHelpers.assertThisInitialized(a));a.onScroll=a.onScroll.bind(babelHelpers.assertThisInitialized(a));a.document=i.PageObject.getRootWindow().document;a.scrollContext=e.contentRoot;s.Event.bind(a.getLayout(),"mousedown",a.onPickerDragStart);return a}babelHelpers.createClass(t,[{key:"buildLayout",value:function e(){return s.Tag.render(M||(M=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-spectrum">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.getPicker())}},{key:"getPicker",value:function e(){return this.cache.remember("picker",function(){return s.Tag.render(U||(U=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-spectrum-picker"></div>'])))})}},{key:"getPickerPos",value:function e(){return{x:s.Text.toNumber(s.Dom.style(this.getPicker(),"left")),y:s.Text.toNumber(s.Dom.style(this.getPicker(),"top"))}}},{key:"onPickerDragStart",value:function e(t){if(t.ctrlKey||t.metaKey||t.button){return}s.Event.bind(this.scrollContext,"scroll",this.onScroll);s.Event.bind(this.document,"mousemove",this.onPickerDragMove);s.Event.bind(this.document,"mouseup",this.onPickerDragEnd);s.Dom.addClass(this.document.body,"landing-ui-field-color-draggable");this.onScroll();this.showPicker();this.onPickerDragMove(t)}},{key:"onPickerDragMove",value:function e(t){if(t.target===this.getPicker()){return}this.setPickerPos(t.pageX,t.pageY);this.onChange()}},{key:"onPickerDragEnd",value:function e(){s.Event.unbind(this.scrollContext,"scroll",this.onScroll);s.Event.unbind(this.document,"mousemove",this.onPickerDragMove);s.Event.unbind(this.document,"mouseup",this.onPickerDragEnd);s.Dom.removeClass(this.document.body,"landing-ui-field-color-draggable")}},{key:"onScroll",value:function e(){this.cache.delete("layoutSize")}},{key:"getLayoutRect",value:function e(){var t=this;return this.cache.remember("layoutSize",function(){var e=t.getLayout().getBoundingClientRect();return{width:e.width,height:e.height,top:e.top,left:e.left}})}},{key:"setPickerPos",value:function e(a,r){var n=this.getLayoutRect(),i=n.width,l=n.height,o=n.top,u=n.left;var c=Math.min(Math.max(a-u,0),i);c=c>i/t.HUE_RANGE*t.HUE_RANGE_GRAY_THRESHOLD?i/t.HUE_RANGE*t.HUE_RANGE_GRAY_MIDDLE:c;s.Dom.style(this.getPicker(),{left:"".concat(c,"px"),top:"".concat(Math.min(Math.max(r-o,0),l),"px")})}},{key:"getValue",value:function e(){var a=this;return this.cache.remember("value",function(){if(s.Dom.hasClass(a.getPicker(),t.HIDE_CLASS)){return null}var e=a.getLayout().getBoundingClientRect().width;var r=a.getPickerPos().x/e*t.HUE_RANGE;var n=a.getLayout().getBoundingClientRect().height;var i=(1-a.getPickerPos().y/n)*100;if(isNaN(r)||isNaN(i)){return null}return new S({h:Math.min(r,t.HUE_RANGE_GRAY_THRESHOLD),s:r>=t.HUE_RANGE_GRAY_THRESHOLD?0:t.getDefaultSaturation(),l:i})})}},{key:"setValue",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a);if(a!==null&&t.isSpectrumValue(a)){var r=a.getHsl(),n=r.h,i=r.s,l=r.l;var o=i===0?t.HUE_RANGE_GRAY_MIDDLE/t.HUE_RANGE*100:n/t.HUE_RANGE*100;s.Dom.style(this.getPicker(),"left","".concat(o,"%"));var u=100-l;s.Dom.style(this.getPicker(),"top","".concat(u,"%"));this.showPicker()}else{this.hidePicker()}}},{key:"onChange",value:function e(t){this.cache.delete("value");this.emit("onChange",{color:this.getValue()})}},{key:"hidePicker",value:function e(){s.Dom.addClass(this.getPicker(),t.HIDE_CLASS)}},{key:"showPicker",value:function e(){s.Dom.removeClass(this.getPicker(),t.HIDE_CLASS)}},{key:"isActive",value:function e(){return this.getValue()!==null&&t.isSpectrumValue(this.getValue())}}],[{key:"isSpectrumValue",value:function e(a){return a!==null&&(a.getHsl().s===t.getDefaultSaturation()||a.getHsl().s===0)}}]);return t}(R);babelHelpers.defineProperty(G,"DEFAULT_SATURATION",100);babelHelpers.defineProperty(G,"HUE_RANGE",375);babelHelpers.defineProperty(G,"HUE_RANGE_GRAY_THRESHOLD",360);babelHelpers.defineProperty(G,"HUE_RANGE_GRAY_MIDDLE",367);babelHelpers.defineProperty(G,"HIDE_CLASS","hidden");var X,z;var j=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.cache=new s.Cache.MemoryCache;return e}babelHelpers.createClass(t,[{key:"getLayout",value:function e(){this.initItems();return this.getLayoutContainer()}},{key:"getLayoutContainer",value:function e(){return this.cache.remember("layout",function(){return s.Tag.render(X||(X=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-recent"></div>'])))})}},{key:"initItems",value:function e(){var a=this;if(t.itemsLoaded){this.buildItemsLayout()}else{n.Backend.getInstance().action("Utils::getUserOption",{name:t.USER_OPTION_NAME}).then(function(e){if(e&&s.Type.isString(e.items)){t.items=[];e.items.split(",").forEach(function(e){if(g(e)&&t.items.length<t.MAX_ITEMS){t.items.push(e)}});t.itemsLoaded=true;a.buildItemsLayout()}})}}},{key:"buildItemsLayout",value:function e(){var a=this;s.Dom.clean(this.getLayoutContainer());t.items.forEach(function(e){if(g(e)){var t=s.Tag.render(z||(z=babelHelpers.taggedTemplateLiteral(['<div \n\t\t\t\t\tclass="landing-ui-field-color-recent-item" \n\t\t\t\t\tstyle="background:','"\n\t\t\t\t\tdata-value="','"\n\t\t\t\t></div>'])),e,e);s.Event.bind(t,"click",function(){return a.onItemClick(event)});s.Dom.append(t,a.getLayoutContainer())}});return this}},{key:"onItemClick",value:function e(t){this.emit("onChange",{hex:t.currentTarget.dataset.value})}},{key:"addItem",value:function e(a){if(g(a)){var r=t.items.indexOf(a);if(r!==-1){t.items.splice(r,1)}t.items.unshift(a);if(t.items.length>t.MAX_ITEMS){t.items.splice(t.MAX_ITEMS)}this.buildItemsLayout();this.saveItems()}return this}},{key:"saveItems",value:function e(){if(t.items.length>0){BX.userOptions.save("landing",t.USER_OPTION_NAME,"items",t.items)}return this}}]);return t}(r.EventEmitter);babelHelpers.defineProperty(j,"USER_OPTION_NAME","color_field_recent_colors");babelHelpers.defineProperty(j,"MAX_ITEMS",6);babelHelpers.defineProperty(j,"items",[]);babelHelpers.defineProperty(j,"itemsLoaded",false);var Y,W,Z,$;var q=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.setEventNamespace("BX.Landing.UI.Field.Color.Colorpicker");a.popupId="colorpicker_popup_"+s.Text.getRandom();a.popupTargetContainer=e.contentRoot;a.hexPreview=new F;a.hexPreview.setPreviewMode(true);s.Event.bind(a.hexPreview.getLayout(),"click",function(){a.recent.buildItemsLayout();a.previously=a.getValue();a.getPopup().show();if(a.getPopup().isShown()){a.hex.focus()}});a.hex=new F;a.hex.subscribe("onChange",a.onHexChange.bind(babelHelpers.assertThisInitialized(a)));a.hex.subscribe("onButtonClick",a.onSelectClick.bind(babelHelpers.assertThisInitialized(a)));a.spectrum=new G(e);a.spectrum.subscribe("onChange",a.onSpectrumChange.bind(babelHelpers.assertThisInitialized(a)));a.recent=new j;a.recent.subscribe("onChange",a.onRecentChange.bind(babelHelpers.assertThisInitialized(a)));s.Event.bind(a.getCancelButton(),"click",a.onCancelClick.bind(babelHelpers.assertThisInitialized(a)));s.Event.bind(a.getSelectButton(),"click",a.onSelectClick.bind(babelHelpers.assertThisInitialized(a)));a.previously=a.getValue();return a}babelHelpers.createClass(t,[{key:"onHexChange",value:function e(t){this.setValue(t.getData().color);this.onChange(t)}},{key:"onSpectrumChange",value:function e(t){this.setValue(t.getData().color);this.onChange(t)}},{key:"onRecentChange",value:function e(t){var a=new S(t.getData().hex);this.setValue(a);this.onChange(new r.BaseEvent({data:{color:a}}))}},{key:"onCancelClick",value:function e(){this.setValue(this.previously);this.getPopup().close();this.onChange(new r.BaseEvent({data:{color:this.getValue()}}))}},{key:"onSelectClick",value:function e(t){var a=t instanceof r.BaseEvent?t.getData().color:this.getValue();if(a!==null){this.recent.addItem(this.getValue().getHex())}this.getPopup().close()}},{key:"buildLayout",value:function e(){return s.Tag.render(Y||(Y=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-colorpicker">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.hexPreview.getLayout())}},{key:"getPopupContent",value:function e(){return s.Tag.render(W||(W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-popup-container">\n\t\t\t\t<div class="landing-ui-field-color-popup-head">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t\t",'\n\t\t\t\t<div class="landing-ui-field-color-popup-footer">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.recent.getLayout(),this.hex.getLayout(),this.spectrum.getLayout(),this.getSelectButton(),this.getCancelButton())}},{key:"getSelectButton",value:function e(){return this.cache.remember("selectButton",function(){return s.Tag.render(Z||(Z=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<button class="ui-btn ui-btn-xs ui-btn-primary">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t"])),s.Loc.getMessage("LANDING_FIELD_COLOR-BUTTON_SELECT"))})}},{key:"getCancelButton",value:function e(){return this.cache.remember("cancelButton",function(){return s.Tag.render($||($=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<button class="ui-btn ui-btn-xs ui-btn-light-border">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t"])),s.Loc.getMessage("LANDING_FIELD_COLOR-BUTTON_CANCEL"))})}},{key:"getHexPreviewObject",value:function e(){return this.hexPreview}},{key:"getPopup",value:function e(){var t=this;return this.cache.remember("popup",function(){return a.PopupManager.create({id:t.popupId,className:"landing-ui-field-color-spectrum-popup",autoHide:true,bindElement:t.hexPreview.getLayout(),bindOptions:{forceTop:true,forceLeft:true},padding:0,contentPadding:14,width:260,offsetTop:-37,offsetLeft:-180,content:t.getPopupContent(),closeByEsc:true,targetContainer:t.popupTargetContainer})})}},{key:"getValue",value:function e(){var t=this;return this.cache.remember("value",function(){return t.spectrum.getValue()})}},{key:"setValue",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a);this.spectrum.setValue(a);this.hex.setValue(a);this.hexPreview.setValue(a);this.setActivity(a)}},{key:"setActivity",value:function e(t){if(t!==null){if(this.spectrum.isActive()){this.hex.unsetActive()}else{this.hex.setActive()}this.hexPreview.setActive()}}},{key:"unsetActive",value:function e(){this.hex.unsetActive();this.hexPreview.unsetActive()}},{key:"isActive",value:function e(){return this.hex.isActive()||this.hexPreview.isActive()}}]);return t}(R);var K;var J=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.cache=new s.Cache.MemoryCache;e.setEventNamespace("BX.Landing.UI.Field.Color.Primary");s.Event.bind(e.getLayout(),"click",function(){return e.onClick()});return e}babelHelpers.createClass(t,[{key:"getLayout",value:function e(){return this.cache.remember("layout",function(){return s.Tag.render(K||(K=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-primary">\n\t\t\t\t\t<i class="landing-ui-field-color-primary-preview"></i>\n\t\t\t\t\t<span class="landing-ui-field-color-primary-text">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t"])),s.Loc.getMessage("LANDING_FIELD_COLOR-PRIMARY_TITLE"))})}},{key:"getValue",value:function e(){return this.cache.remember("value",function(){return new S(t.CSS_VAR)})}},{key:"onClick",value:function e(){this.setActive();this.emit("onChange",{color:this.getValue()})}},{key:"setActive",value:function e(){s.Dom.addClass(this.getLayout(),t.ACTIVE_CLASS)}},{key:"unsetActive",value:function e(){s.Dom.removeClass(this.getLayout(),t.ACTIVE_CLASS)}},{key:"isActive",value:function e(){return s.Dom.hasClass(this.getLayout(),t.ACTIVE_CLASS)}},{key:"isPrimaryValue",value:function e(t){return t!==null&&this.getValue().getCssVar()===t.getCssVar()}}]);return t}(r.EventEmitter);babelHelpers.defineProperty(J,"ACTIVE_CLASS","active");babelHelpers.defineProperty(J,"CSS_VAR","--primary");function Q(e){return new RegExp(ee(e))}function ee(e){return e.source.replace(/(^\^)|(\$$)/g,"")}var te=/^(linear|radial)-gradient\(.*\)$/i;var ae=/^(linear|radial)-gradient\(.*?((\d)+deg).*?\)$/gi;var re=ee(h);var ne=new RegExp("((rgba|hsla)?\\([\\d% .,]+\\)|transparent|"+re+")+","ig");function ie(e){return!!e.trim().match(te)}var se=function(){function e(t){babelHelpers.classCallCheck(this,e);this.value={from:new S("#ffffff"),to:new S(J.CSS_VAR),angle:e.DEFAULT_ANGLE,type:e.DEFAULT_TYPE};this.setValue(t)}babelHelpers.createClass(e,[{key:"getName",value:function e(){return this.value.from.getName()+"_"+this.value.to.getName()+"_"+this.getAngle()+"_"+this.getType()}},{key:"setValue",value:function t(a){if(s.Type.isObject(a)){if(a instanceof e){this.value.from=new S(a.getFrom());this.value.to=new S(a.getTo());this.value.angle=a.getAngle();this.value.type=a.getType()}else{if("from"in a){this.value.from=new S(a.from)}if("to"in a){this.value.to=new S(a.to)}if("angle"in a){this.value.angle=s.Text.toNumber(a.angle)}if("type"in a){this.value.type=a.type}}}else if(s.Type.isString(a)&&ie(a)){this.parseGradientString(a)}return this}},{key:"setOpacity",value:function e(t){this.value.from.setOpacity(t);this.value.to.setOpacity(t);return this}},{key:"parseGradientString",value:function e(t){var a=t.trim().match(te);if(!!a){this.setValue({type:a[1]})}var r=t.trim().match(ae);if(!!r){this.setValue({angle:r[2]})}var n=t.trim().match(ne);if(n&&n.length>0){this.setValue({from:new S(n[0])});this.setValue({to:new S(n[n.length-1])})}}},{key:"getFrom",value:function e(){return this.value.from}},{key:"getTo",value:function e(){return this.value.to}},{key:"getAngle",value:function e(){return this.value.angle}},{key:"setAngle",value:function e(t){if(s.Type.isNumber(t)){this.value.angle=Math.min(Math.max(t,0),360)}return this}},{key:"getType",value:function e(){return this.value.type}},{key:"setType",value:function t(a){if(a===e.TYPE_RADIAL||a===e.TYPE_LINEAR){this.value.type=a}return this}},{key:"getOpacity",value:function e(){var t;return(t=(this.value.from.getOpacity()+this.value.to.getOpacity())/2)!==null&&t!==void 0?t:P.a}},{key:"getStyleString",value:function e(){var t=this.value.angle;var a=this.value.type;var r=this.value.from.getStyleString();var n=this.value.to.getStyleString();return a==="linear"?"linear-gradient(".concat(t,"deg, ").concat(r," 0%, ").concat(n," 100%)"):"radial-gradient(circle farthest-side at 50% 50%, ".concat(r," 0%, ").concat(n," 100%)")}},{key:"getStyleStringForOpacity",value:function e(){return"radial-gradient(at top left, ".concat(this.value.from.getHex(),", transparent)")+", radial-gradient(at bottom left, ".concat(this.value.to.getHex(),", transparent)")}}],[{key:"compare",value:function e(t,a){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var n=S.compare(t.getFrom(),a.getFrom())&&S.compare(t.getTo(),a.getTo())||S.compare(t.getTo(),a.getFrom())&&S.compare(t.getFrom(),a.getTo());var i=r?t.getAngle()===a.getAngle()&&t.getType()===a.getType():true;return n&&i}}]);return e}();babelHelpers.defineProperty(se,"TYPE_RADIAL","radial");babelHelpers.defineProperty(se,"TYPE_LINEAR","linear");babelHelpers.defineProperty(se,"DEFAULT_ANGLE",180);babelHelpers.defineProperty(se,"DEFAULT_TYPE","linear");var le="color";var oe="gradient";var ue=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getDefaultPresets",value:function t(){return e.cache.remember("default",function(){var t=[];e.defaultPresets.forEach(function(e){t.push({id:e.id,type:"color",items:e.items.map(function(e){return new S(f(e))})})});return t})}},{key:"getPrimaryColorPreset",value:function t(){return this.cache.remember("primary",function(){var t={id:"defaultPrimary",items:[]};var a=new S(s.Dom.style(document.documentElement,"--primary").trim());t.items.push(new S(a));if(a.getHsl().s<=10){var r=a.getHsl().l>50?Math.ceil(a.getHsl().l/100*5):Math.floor(a.getHsl().l/100*5);var n=5-r;var i=a.getHsl().l/(r+1);var l=(100-a.getHsl().l)/(n+1);for(var o=1;o<=r;o++){t.items.push(new S(a).darken(i*o))}for(var u=1;u<=n;u++){t.items.push(new S(a).lighten(l*u))}var c=15;var h=15;var g=new S(e.BITRIX_COLOR);t.items[6]=new S(g);t.items[7]=new S(g.darken(c).saturate(h));t.items[8]=new S(g.darken(c).saturate(h));g.lighten(c*2).desaturate(h*2);t.items[9]=new S(g.lighten(c).desaturate(h));t.items[10]=new S(g.lighten(c).desaturate(h));g.darken(c*2).saturate(h*2);t.items[11]=new S(g).adjustHue(180)}else{var p=(90-a.getHsl().l)/3;var b=(a.getHsl().l-10)/3;var d=(90-a.getHsl().s)/3;var v=(a.getHsl().s-10)/3;t.items[1]=new S(a.darken(b).saturate(d));t.items[2]=new S(a.darken(b).saturate(d));t.items[3]=new S(a.darken(b).saturate(d));a.lighten(b*3).desaturate(d*3);t.items[4]=new S(a.desaturate(v).lighten(p));t.items[5]=new S(a.desaturate(v).lighten(p));t.items[11]=new S(a.desaturate(v).lighten(p));a.saturate(v*3).darken(p*3);t.items[7]=new S(a.adjustHue(40));t.items[8]=new S(a.adjustHue(-80));t.items[9]=new S(a.adjustHue(180));t.items[6]=new S(a.adjustHue(40));t.items[10]=new S(a.adjustHue(40))}return t})}},{key:"getBlackAndWhitePreset",value:function e(){return this.cache.remember("blackAndWhite",function(){var e={id:"blackAndWhite",items:[]};var t=new S("#ffffff");e.items.push(new S(t));e.items.push(new S(t.darken(16.66)));e.items.push(new S(t.darken(16.66)));e.items.push(new S(t.darken(16.66)));e.items.push(new S(t.darken(16.66)));e.items.push(new S(t.darken(16.66)));e.items.push(new S(t.darken(16.7)));return e})}},{key:"getGradientByColorOptions",value:function e(t){var a=[];var r=[[1,2],[1,4],[5,12],[1,8],[8,9],[1,9],[10,7],[7,11]];r.forEach(function(e){a.push(new se({from:new S(t.items[e[0]-1]),to:new S(t.items[e[1]-1]),angle:se.DEFAULT_ANGLE,type:se.DEFAULT_TYPE}))});return{type:oe,items:a}}}]);return e}();babelHelpers.defineProperty(ue,"BITRIX_COLOR","#2fc6f6");babelHelpers.defineProperty(ue,"cache",new s.Cache.MemoryCache);babelHelpers.defineProperty(ue,"defaultPresets",[{id:"agency",items:["#ff6366","#40191a","#803233","#bf4b4d","#e65a5c","#ffc1c2","#363643","#57dca3","#ee76ba","#ffa864","#eaeaec","#fadbdc"]},{id:"accounting",items:["#a5c33c","#384215","#6f8228","#8fa834","#b0cf40","#dae6ae","#4c4c4c","#5d84e6","#cd506b","#fe6466","#dfdfdf","#e9f0cf"]},{id:"app",items:["#4fd2c2","#1f524c","#379187","#46b8aa","#54dece","#c8f1ec","#6639b6","#e81c62","#9a69ca","#6279d8","#ffc337","#e9faf8"]},{id:"architecture",items:["#c94645","#4a1919","#8a2f2f","#b03c3c","#d64949","#eec3c3","#363643","#446d90","#a13773","#c98145","#eaeaec","#f9e8e7"]},{id:"business",items:["#3949a0","#232c61","#313e87","#3e4fad","#556ced","#d8d7dc","#14122c","#1d1937","#a03949","#2f295a","#c87014","#f4f4f5"]},{id:"charity",items:["#f5f219","#f58419","#f5cc19","#a8e32a","#f9f76a","#fcfbb6","#000000","#262e37","#74797f","#e569b1","#edeef0","#fefedf"]},{id:"construction",items:["#f7b70b","#382a02","#785905","#b88907","#dea509","#fdf1d1","#111111","#a3a3a3","#f7410b","#f70b4b","#d6dde9","#fef9ea"]},{id:"consulting",items:["#21a79b","#38afa5","#14665f","#1c8c83","#30f2e2","#a9ddd9","#ec4672","#58d400","#f0ac00","#2d6faf","#2da721","#e6f5f4"]},{id:"corporate",items:["#6ab8ee","#31556e","#4e86ad","#5fa3d4","#70c1fa","#d2e9f8","#36e2c0","#ffaa3c","#ee6a76","#ffa468","#5feb99","#ebf4fb"]},{id:"courses",items:["#6bda95","#2c593d","#4b9969","#5ebf83","#70e69d","#c2f0d3","#31556e","#ff947d","#738ed3","#f791ab","#ffb67d","#e2f8eb"]},{id:"event",items:["#f73859","#380d14","#781c2b","#b82a42","#de334f","#fdbbc6","#151726","#ffb553","#30d59b","#b265e0","#edeef0","#ffeaed"]},{id:"gym",items:["#6b7de0","#2f3661","#4d5aa1","#5f6fc7","#7284ed","#e4e8fa","#333333","#ffd367","#a37fe8","#e06b7d","#6dc1e0","#f4f6fd"]},{id:"lawyer",items:["#e74c3c","#69231b","#a8382c","#cf4536","#f55240","#f9d0cb","#4e4353","#5a505e","#e7863c","#38a27f","#e2e1e3","#fdeeec"]},{id:"photography",items:["#f7a700","#382600","#785200","#b87d00","#de9800","#fde8ba","#333333","#0b5aa0","#e93d18","#06c4ed","#3672a8","#fff6e3"]},{id:"restaurant",items:["#e6125d","#660829","#a60d43","#cc1052","#f21361","#facfde","#0eb88e","#00946f","#e04292","#9b12e6","#bfde00","#fef2f6"]},{id:"shipping",items:["#ff0000","#400000","#800000","#bf0000","#e60000","#ffb4b4","#333333","#ff822a","#d63986","#00ac6b","#ffb800","#fff3f3"]},{id:"spa",items:["#9dba04","#313b01","#667a02","#86a103","#a6c704","#e4ecb9","#ba7c04","#cf54bb","#049dba","#1d7094","#eead2f","#f2f6dd"]},{id:"travel",items:["#ee4136","#6e1f19","#ad3128","#d43c31","#fa4639","#fef1f0","#31353e","#3e434d","#ee8036","#428abc","#eaebec","#c3c4c7"]},{id:"wedding",items:["#d65779","#572431","#963e55","#bd4d6b","#e35d81","#f7dfe5","#af58a7","#6bc34b","#ec8c60","#50a098","#57b9d6","#fdf4f6"]}]);var ce,he;var ge=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.cache=new s.Cache.MemoryCache;a.setEventNamespace("BX.Landing.UI.Field.Color.Preset");a.id=e.id;a.type=e.type||le;a.items=e.items;a.activeItem=null;return a}babelHelpers.createClass(t,[{key:"getId",value:function e(){return this.id}},{key:"getGradientPreset",value:function e(){var a=this.type===oe?{type:oe,items:this.items}:ue.getGradientByColorOptions({items:this.items});return new t(a)}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return s.Tag.render(ce||(ce=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-preset">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),t.items.map(function(e){return t.getItemLayout(e.getName())}))})}},{key:"getItemLayout",value:function e(t){var a=this;return this.cache.remember(t,function(){var e=a.getItemByName(t);var r=s.Type.isString(e)?e:e.getStyleString();var n=s.Tag.render(he||(he=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div\n\t\t\t\t\tclass="landing-ui-field-color-preset-item"\n\t\t\t\t\tstyle="background: ','"\n\t\t\t\t\tdata-name="','"\n\t\t\t\t></div>\n\t\t\t'])),r,t);s.Event.bind(n,"click",a.onItemClick.bind(a));return n})}},{key:"getItemByName",value:function e(t){return this.items.find(function(e){return t===e.getName()})||null}},{key:"isPresetValue",value:function e(t){if(t===null){return false}return this.items.some(function(e){if(e instanceof S&&t instanceof S){return S.compare(e,t)}else if(e instanceof se&&t instanceof se){return se.compare(e,t,false)}return false})}},{key:"onItemClick",value:function e(t){this.setActiveItem(t.currentTarget.dataset.name);var a=null;if(this.activeItem!==null){a=this.activeItem instanceof se?new se(this.activeItem):new S(this.activeItem)}this.emit("onChange",{color:a})}},{key:"setActiveItem",value:function e(a){var r=this;this.activeItem=this.getItemByName(a);this.items.forEach(function(e){var n=e.getName();if(a===n){s.Dom.addClass(r.getItemLayout(n),t.ACTIVE_CLASS)}else{s.Dom.removeClass(r.getItemLayout(n),t.ACTIVE_CLASS)}})}},{key:"setActiveValue",value:function e(t){if(t!==null){if(t instanceof se){this.setActiveItem(new se(t).setAngle(se.DEFAULT_ANGLE).setType(se.DEFAULT_TYPE).getName())}else{this.setActiveItem(t.getName())}}}},{key:"unsetActive",value:function e(){var a=this;this.items.forEach(function(e){s.Dom.removeClass(a.getItemLayout(e.getName()),t.ACTIVE_CLASS)})}},{key:"isActive",value:function e(){var a=this;return this.items.some(function(e){return s.Dom.hasClass(a.getItemLayout(e.getName()),t.ACTIVE_CLASS)})}}]);return t}(r.EventEmitter);babelHelpers.defineProperty(ge,"ACTIVE_CLASS","active");var pe,be,de,ve,fe;var ye=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.cache=new s.Cache.MemoryCache;a.setEventNamespace("BX.Landing.UI.Field.Color.PresetCollection");a.popupId="presets-popup_"+s.Text.getRandom();a.popupTargetContainer=e.contentRoot;a.presets={};a.onPresetClick=a.onPresetClick.bind(babelHelpers.assertThisInitialized(a));s.Event.bind(a.getOpenButton(),"click",function(){a.getPopup().toggle()});return a}babelHelpers.createClass(t,[{key:"addDefaultPresets",value:function e(){var t=this;this.addPreset(ue.getPrimaryColorPreset());ue.getDefaultPresets().map(function(e){t.addPreset(e)})}},{key:"addPreset",value:function e(t){this.cache.delete("popupLayout");if(!Object.keys(this.presets).length||!(t.id in this.presets)){this.presets[t.id]=t}}},{key:"getActivePreset",value:function e(){return this.getActiveId()?this.getPresetById(this.getActiveId()):null}},{key:"getDefaultPreset",value:function e(){return Object.keys(this.presets).length?this.getPresetById(Object.keys(this.presets)[0]):null}},{key:"getActiveId",value:function e(){return t.activeId}},{key:"getPresetById",value:function e(t){var a=this;if(t in this.presets){return this.cache.remember(t,function(){return new ge(a.presets[t])})}else{return null}}},{key:"getPresetByItemValue",value:function e(t){if(t===null){return null}for(var a in this.presets){if(this.getPresetById(a)&&this.getPresetById(a).isPresetValue(t)){return this.getPresetById(a)}}return null}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("value",function(){return s.Tag.render(pe||(pe=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-presets">\n\t\t\t\t\t<div class="landing-ui-field-color-presets-left">\n\t\t\t\t\t\t<span class="landing-ui-field-color-presets-title">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="landing-ui-field-color-presets-right">',"</div>\n\t\t\t\t</div>\n\t\t\t"])),s.Loc.getMessage("LANDING_FIELD_COLOR-PRESETS_TITLE"),t.getOpenButton())})}},{key:"getOpenButton",value:function e(){return this.cache.remember("openButton",function(){return s.Tag.render(be||(be=babelHelpers.taggedTemplateLiteral(['<span class="landing-ui-field-color-presets-open">\n\t\t\t\t',"\n\t\t\t</span>"])),s.Loc.getMessage("LANDING_FIELD_COLOR-PRESETS_MORE"))})}},{key:"getTitleContainer",value:function e(){var t=this;return this.cache.remember("titleContainer",function(){return t.getLayout().querySelector(".landing-ui-field-color-presets-left")})}},{key:"getPopup",value:function e(){var t=this;return this.cache.remember("popup",function(){return a.PopupManager.create({id:t.popupId,className:"presets-popup",autoHide:true,bindElement:t.getOpenButton(),bindOptions:{forceTop:true,forceLeft:true},width:280,offsetLeft:-200,content:t.getPopupLayout(),closeByEsc:true,targetContainer:t.popupTargetContainer})})}},{key:"getPopupLayout",value:function e(){var a=this;return this.cache.remember("popupLayout",function(){var e=s.Tag.render(de||(de=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-presets-popup">\n\t\t\t\t<div class="landing-ui-field-color-presets-popup-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="landing-ui-field-color-presets-popup-inner"></div>\n\t\t\t</div>'])),s.Loc.getMessage("LANDING_FIELD_COLOR-PRESETS_MORE_COLORS"));var r=e.querySelector(".landing-ui-field-color-presets-popup-inner");for(var n in a.presets){var i=a.getPresetLayout(n);if(n===a.getActiveId()){s.Dom.addClass(i,t.ACTIVE_CLASS)}s.Event.bind(i,"click",a.onPresetClick);s.Dom.append(i,r)}return e})}},{key:"getPresetLayout",value:function e(t){var a=this;return this.cache.remember(t+"layout",function(){return s.Tag.render(ve||(ve=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-presets-preset" data-id="','">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),t,a.presets[t].items.map(function(e){return s.Tag.render(fe||(fe=babelHelpers.taggedTemplateLiteral(['<div\n\t\t\t\t\t\t\t\tclass="landing-ui-field-color-presets-preset-item"\n\t\t\t\t\t\t\t\tstyle="background: ','"\n\t\t\t\t\t\t\t></div>'])),s.Type.isString(e)?e:e.getStyleString())}))})}},{key:"onPresetClick",value:function e(t){this.getPopup().close();this.setActiveItem(t.currentTarget.dataset.id);this.emit("onChange",{preset:this.getActivePreset()})}},{key:"setActiveItem",value:function e(a){t.activeId=a;for(var r in this.presets){s.Dom.removeClass(this.getPresetLayout(r),t.ACTIVE_CLASS);if(r===a){s.Dom.addClass(this.getPresetLayout(r),t.ACTIVE_CLASS)}}}},{key:"unsetActive",value:function e(){for(var a in this.presets){s.Dom.removeClass(this.getPresetLayout(a),t.ACTIVE_CLASS)}}}]);return t}(r.EventEmitter);babelHelpers.defineProperty(ye,"activeId",null);babelHelpers.defineProperty(ye,"ACTIVE_CLASS","active");var me;var Ce=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.cache=new s.Cache.MemoryCache;a.setEventNamespace("BX.Landing.UI.Field.Color.Reset");s.Event.bind(a.getLayout(),"click",function(){return a.onClick()});var r=BX.UI.Hint.createInstance({popupParameters:{targetContainer:e.contentRoot,padding:0}});r.init(a.getLayout());return a}babelHelpers.createClass(t,[{key:"getLayout",value:function e(){return this.cache.remember("layout",function(){return s.Tag.render(me||(me=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-reset-container">\n\t\t\t\t\t<div class="landing-ui-field-color-reset"\n\t\t\t\t\t\tdata-hint="','"\n\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t'])),s.Loc.getMessage("LANDING_FIELD_COLOR-RESET_HINT"))})}},{key:"onClick",value:function e(){this.emit("onReset")}}]);return t}(r.EventEmitter);var ke;var He=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.cache=new s.Cache.MemoryCache;e.setEventNamespace("BX.Landing.UI.Field.Color.Transparent");s.Event.bind(e.getLayout(),"click",function(){return e.onClick()});return e}babelHelpers.createClass(t,[{key:"getLayout",value:function e(){return this.cache.remember("layout",function(){return s.Tag.render(ke||(ke=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-preset-item landing-ui-field-color-transparent"></div>'])))})}},{key:"onClick",value:function e(){this.emit("onChange",{color:null})}}]);return t}(r.EventEmitter);var Le,Te;var Ae=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.setEventNamespace("BX.Landing.UI.Field.Color.ColorSet");a.reset=new Ce(e);a.reset.subscribe("onReset",function(){a.emit("onReset")});a.zeroing=new He;a.zeroing.subscribe("onChange",function(e){a.unsetActive();a.setValue(e.getData().color);a.onChange(e)});a.blackAndWhitePreset=new ge(ue.getBlackAndWhitePreset());a.blackAndWhitePreset.subscribe("onChange",function(e){a.preset.unsetActive();a.onPresetItemChange(e)});a.colorpicker=new q(e);a.colorpicker.subscribe("onChange",function(e){a.preset.unsetActive();a.blackAndWhitePreset.unsetActive();a.onChange(e)});a.presets=new ye(e);a.presets.subscribe("onChange",function(e){a.setPreset(e.getData().preset)});a.presets.addDefaultPresets();var r=a.presets.getActivePreset()||a.presets.getDefaultPreset();if(r){a.setPreset(r)}return a}babelHelpers.createClass(t,[{key:"buildLayout",value:function e(){s.Dom.append(this.reset.getLayout(),this.presets.getTitleContainer());s.Dom.prepend(this.zeroing.getLayout(),this.blackAndWhitePreset.getLayout());return s.Tag.render(Le||(Le=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-colorset">\n\t\t\t\t<div class="landing-ui-field-color-colorset-top">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t\t",'\n\t\t\t\t<div class="landing-ui-field-color-colorset-bottom">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.presets.getLayout(),this.getPresetContainer(),this.blackAndWhitePreset.getLayout(),this.colorpicker.getLayout())}},{key:"getTitleLayout",value:function e(){var t=this;return this.cache.remember("titleLayout",function(){return t.getLayout().querySelector(".landing-ui-field-color-colorset-title")})}},{key:"getPresetContainer",value:function e(){return this.cache.remember("presetContainer",function(){return s.Tag.render(Te||(Te=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-colorset-preset-container"></div>'])))})}},{key:"setPreset",value:function e(t){var a=this;this.preset=t;this.preset.unsetActive();if(this.getValue()!==null&&this.preset.isPresetValue(this.getValue())){this.unsetActive();this.preset.setActiveValue(this.getValue())}else{this.unsetActive();this.colorpicker.setValue(this.getValue())}this.preset.subscribe("onChange",function(e){a.blackAndWhitePreset.unsetActive();a.onPresetItemChange(e)});s.Dom.clean(this.getPresetContainer());s.Dom.append(t.getLayout(),this.getPresetContainer());this.emit("onPresetChange",{preset:t})}},{key:"getPreset",value:function e(){return this.preset}},{key:"onPresetItemChange",value:function e(t){this.colorpicker.setValue(t.getData().color);this.colorpicker.unsetActive();this.onChange(t)}},{key:"onChange",value:function e(t){this.cache.set("value",t.getData().color);this.emit("onChange",t)}},{key:"getValue",value:function e(){var t=this;return this.cache.remember("value",function(){return t.colorpicker.getValue()})}},{key:"setValue",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a);this.colorpicker.setValue(a);var r=this.presets.getActiveId()?this.presets.getPresetById(this.presets.getActiveId()):this.presets.getPresetByItemValue(a);if(r!==null){this.setPreset(r);this.presets.setActiveItem(r.getId())}if(a!==null&&this.blackAndWhitePreset.isPresetValue(a)){this.unsetActive();this.blackAndWhitePreset.setActiveValue(a)}}},{key:"unsetActive",value:function e(){this.preset.unsetActive();this.blackAndWhitePreset.unsetActive();this.colorpicker.unsetActive()}},{key:"isActive",value:function e(){return this.preset.isActive()||this.blackAndWhitePreset.isActive()||this.colorpicker.isActive()}}]);return t}(R);var Pe,Ie,Ee;var Ve=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.setEventNamespace("BX.Landing.UI.Field.Color.Opacity");e.document=i.PageObject.getRootWindow().document;e.onPickerDragStart=e.onPickerDragStart.bind(babelHelpers.assertThisInitialized(e));e.onPickerDragMove=e.onPickerDragMove.bind(babelHelpers.assertThisInitialized(e));e.onPickerDragEnd=e.onPickerDragEnd.bind(babelHelpers.assertThisInitialized(e));s.Event.bind(e.getLayout(),"mousedown",e.onPickerDragStart);return e}babelHelpers.createClass(t,[{key:"buildLayout",value:function e(){return s.Tag.render(Pe||(Pe=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-opacity">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getPicker(),this.getColorLayout())}},{key:"onPickerDragStart",value:function e(t){if(t.ctrlKey||t.metaKey||t.button){return}s.Event.bind(this.document,"mousemove",this.onPickerDragMove);s.Event.bind(this.document,"mouseup",this.onPickerDragEnd);s.Dom.addClass(this.document.body,"landing-ui-field-color-draggable");this.onPickerDragMove(t)}},{key:"onPickerDragMove",value:function e(t){if(t.target===this.getPicker()){return}this.setPickerPos(t.pageX);this.onChange()}},{key:"onPickerDragEnd",value:function e(){s.Event.unbind(this.document,"mousemove",this.onPickerDragMove);s.Event.unbind(this.document,"mouseup",this.onPickerDragEnd);s.Dom.removeClass(this.document.body,"landing-ui-field-color-draggable")}},{key:"setPickerPos",value:function e(t){var a=Math.max(Math.min(t-this.getLayoutRect().left,this.getLayoutRect().width),0);s.Dom.style(this.getPicker(),{left:"".concat(a,"px")})}},{key:"getLayoutRect",value:function e(){var t=this;return this.cache.remember("layoutSize",function(){var e=t.getLayout().getBoundingClientRect();return{width:e.width,left:e.left}})}},{key:"getColorLayout",value:function e(){return this.cache.remember("colorLayout",function(){return s.Tag.render(Ie||(Ie=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-opacity-color"></div>\n\t\t\t'])))})}},{key:"getPicker",value:function e(){return this.cache.remember("picker",function(){return s.Tag.render(Ee||(Ee=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-opacity-picker">\n\t\t\t\t\t<div class="landing-ui-field-color-opacity-picker-item">\n\t\t\t\t\t\t<div class="landing-ui-field-color-opacity-picker-item-circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>'])))})}},{key:"getDefaultValue",value:function e(){return this.cache.remember("default",function(){return new S(t.DEFAULT_COLOR)})}},{key:"getValue",value:function e(){var t=this;return this.cache.remember("value",function(){var e=s.Text.toNumber(s.Dom.style(t.getPicker(),"left"));var a=s.Text.toNumber(t.getLayout().getBoundingClientRect().width);return t.getDefaultValue().setOpacity(1-e/a)})}},{key:"setValue",value:function e(a){var r=a!==null?a:this.getDefaultValue();babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,r);s.Dom.style(this.getColorLayout(),{background:r.getStyleStringForOpacity()});s.Dom.style(this.getPicker(),{left:"".concat(100-r.getOpacity()*100,"%")})}},{key:"onChange",value:function e(t){this.cache.delete("value");this.emit("onChange",{color:this.getValue()})}}]);return t}(R);babelHelpers.defineProperty(Ve,"DEFAULT_COLOR","#cccccc");babelHelpers.defineProperty(Ve,"PICKER_WIDTH","#cccccc");var _e,Se,Oe,Re,we,Ne;var Be=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.tabs=[];e.cache=new s.Cache.MemoryCache;e.multiple=true;e.isBig=false;e.onToggle=e.onToggle.bind(babelHelpers.assertThisInitialized(e));return e}babelHelpers.createClass(t,[{key:"setMultiple",value:function e(t){this.multiple=t;return this}},{key:"setBig",value:function e(t){this.isBig=t;this.multiple=false;return this}},{key:"appendTab",value:function e(t,a,r){var n=new De({id:t,title:a,items:s.Type.isArray(r)?r:[r]});this.tabs.push(n);this.bindEvents(n);this.cache.delete("layout");return this}},{key:"prependTab",value:function e(t,a,r){var n=new De({id:t,title:a,items:s.Type.isArray(r)||[r]});this.tabs.unshift(n);this.bindEvents(n);this.cache.delete("layout");return this}},{key:"bindEvents",value:function e(t){t.subscribe("onToggle",this.onToggle);t.subscribe("onShow",this.onToggle);t.subscribe("onHide",this.onToggle)}},{key:"onToggle",value:function e(t){this.emit("onToggle",t)}},{key:"showTab",value:function e(t){if(!this.multiple){this.tabs.forEach(function(e){e.hide()})}var a=this.getTabById(t);if(a){a.show()}return this}},{key:"getTabById",value:function e(t){return this.tabs.find(function(e){return e.id===t})}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){var e=t.isBig?" landing-ui-field-color-tabs--big":"";var a=s.Tag.render(_e||(_e=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-tabs','"></div>'])),e);if(t.isBig){var r=s.Tag.render(Se||(Se=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="landing-ui-field-color-tabs-head landing-ui-field-color-tabs-head--big"></div>\n\t\t\t\t'])));var n=s.Tag.render(Oe||(Oe=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="landing-ui-field-color-tabs-content landing-ui-field-color-tabs-content--big"></div>\n\t\t\t\t'])));t.tabs.forEach(function(e){s.Dom.append(e.getTitle(),r);s.Dom.append(e.getLayout(),n)});s.Dom.append(r,a);s.Dom.append(n,a)}else{t.tabs.forEach(function(e){var t=s.Tag.render(Re||(Re=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-tabs-tab">\n\t\t\t\t\t\t',"","\n\t\t\t\t\t</div>"])),e.getTitle(),e.getLayout());s.Dom.append(t,a)})}t.tabs.forEach(function(e){s.Event.bind(e.getTitle(),"click",function(){if(!t.multiple){t.tabs.forEach(function(e){e.hide()})}e.toggle()})});return a})}}]);return t}(r.EventEmitter);var De=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.id=e.id;a.title=e.title;a.items=e.items;a.cache=new s.Cache.MemoryCache;return a}babelHelpers.createClass(t,[{key:"getId",value:function e(){return this.id}},{key:"getTitle",value:function e(){var t=this;return this.cache.remember("title",function(){return s.Tag.render(we||(we=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="landing-ui-field-color-tabs-tab-toggler">\n\t\t\t\t\t<span class="landing-ui-field-color-tabs-tab-toggler-icon"></span>\n\t\t\t\t\t<span class="landing-ui-field-color-tabs-tab-toggler-name">',"</span>\n\t\t\t\t</span>\n\t\t\t"])),t.title)})}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return s.Tag.render(Ne||(Ne=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-tabs-tab-content">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),t.items.map(function(e){return e.getLayout()}))})}},{key:"toggle",value:function e(){s.Dom.toggleClass(this.getLayout(),t.SHOW_CLASS);s.Dom.toggleClass(this.getTitle(),t.SHOW_CLASS);this.emit("onToggle",{tab:this.title});return this}},{key:"show",value:function e(){s.Dom.addClass(this.getLayout(),t.SHOW_CLASS);s.Dom.addClass(this.getTitle(),t.SHOW_CLASS);this.emit("onShow",{tab:this.title});return this}},{key:"hide",value:function e(){s.Dom.removeClass(this.getLayout(),t.SHOW_CLASS);s.Dom.removeClass(this.getTitle(),t.SHOW_CLASS);this.emit("onHide",{tab:this.title});return this}}]);return t}(r.EventEmitter);babelHelpers.defineProperty(De,"SHOW_CLASS","show");var xe;var Fe=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.Color");a.property="color";a.variableName="--color";a.className="g-color";a.colorSet=new Ae(e);a.colorSet.subscribe("onChange",a.onColorSetChange.bind(babelHelpers.assertThisInitialized(a)));a.colorSet.subscribe("onReset",a.onReset.bind(babelHelpers.assertThisInitialized(a)));a.opacity=new Ve;a.opacity.subscribe("onChange",a.onOpacityChange.bind(babelHelpers.assertThisInitialized(a)));a.primary=new J;a.primary.subscribe("onChange",a.onPrimaryChange.bind(babelHelpers.assertThisInitialized(a)));a.tabs=(new Be).appendTab("Opacity",s.Loc.getMessage("LANDING_FIELD_COLOR-TAB_OPACITY"),a.opacity);return a}babelHelpers.createClass(t,[{key:"isNullValue",value:function e(t){return t===null||t==="none"||t==="rgba(0, 0, 0, 0)"}},{key:"buildLayout",value:function e(){return s.Tag.render(xe||(xe=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-color">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.colorSet.getLayout(),this.primary.getLayout(),this.tabs.getLayout())}},{key:"onColorSetChange",value:function e(t){this.primary.unsetActive();var a=t.getData().color;if(a!==null){a.setOpacity(this.opacity.getValue().getOpacity());this.opacity.setValue(a)}this.onChange()}},{key:"onOpacityChange",value:function e(){this.onChange()}},{key:"onPrimaryChange",value:function e(t){this.colorSet.setValue(t.getData().color);this.onColorSetChange(t);this.colorSet.unsetActive();this.primary.setActive()}},{key:"unsetActive",value:function e(){this.colorSet.unsetActive();this.primary.unsetActive()}},{key:"setValue",value:function e(t){var a=t!==null?new S(t):null;this.colorSet.setValue(a);this.opacity.setValue(a);if(this.primary.isPrimaryValue(a)){this.primary.setActive();this.colorSet.unsetActive()}if(t!==null&&a.getOpacity()<1){this.tabs.showTab("Opacity")}}},{key:"getValue",value:function e(){var t=this;return this.cache.remember("value",function(){var e=t.primary.isActive()?t.primary.getValue():t.colorSet.getValue();return e===null?null:e.setOpacity(t.opacity.getValue().getOpacity())})}}]);return t}(o);babelHelpers.defineProperty(Fe,"PRIMARY_VAR","var(--primary)");var Me=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.ColorHover");a.property="color";a.variableName="--color-hover";a.className="g-color--hover";a.pseudoClass=":hover";return a}return t}(Fe);var Ue,Ge,Xe,ze,je,Ye,We;var Ze=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"ROTATE_STEP",45);a.setEventNamespace("BX.Landing.UI.Field.Color.Gradient");a.popupId="gradient_popup_"+s.Text.getRandom();a.popupTargetContainer=e.contentRoot;a.colorpickerFrom=new q(e);a.colorpickerFrom.subscribe("onChange",function(e){a.onColorChange(e.getData().color,null)});a.colorpickerTo=new q(e);a.colorpickerTo.subscribe("onChange",function(e){a.onColorChange(null,e.getData().color)});s.Event.bind(a.getPopupButton(),"click",a.onPopupOpen.bind(babelHelpers.assertThisInitialized(a)));s.Event.bind(a.getRotateButton(),"click",a.onRotate.bind(babelHelpers.assertThisInitialized(a)));s.Event.bind(a.getSwitchTypeButton(),"click",a.onSwitchType.bind(babelHelpers.assertThisInitialized(a)));s.Event.bind(a.getSwapButton(),"click",a.onSwap.bind(babelHelpers.assertThisInitialized(a)));a.preset=null;return a}babelHelpers.createClass(t,[{key:"onColorChange",value:function e(t,a){if(t===null&&a===null){return}var r=this.getValue()||new se;var n=t||r.getFrom()||(new se).getFrom();var i=a||r.getTo()||(new se).getTo();r.setValue({from:n,to:i});this.setValue(r);this.preset.unsetActive();this.onChange()}},{key:"onPopupOpen",value:function e(){this.getPopup().toggle()}},{key:"onRotate",value:function e(a){if(!t.isButtonEnable(a.target)){return}var r=this.getValue();if(r!==null){r.setValue({angle:(r.getAngle()+this.ROTATE_STEP)%360});this.setValue(r);this.onChange()}this.getPopup().close()}},{key:"onSwitchType",value:function e(a){if(!t.isButtonEnable(a.target)){return}var r=this.getValue();if(r!==null){if(r.getType()===se.TYPE_LINEAR){r.setValue({type:se.TYPE_RADIAL});t.disableButton(this.getRotateButton())}else{r.setValue({type:se.TYPE_LINEAR});t.enableButton(this.getRotateButton())}this.setValue(r);this.onChange()}this.getPopup().close()}},{key:"onSwap",value:function e(a){if(!t.isButtonEnable(a.target)){return}var r=this.getValue();if(r!==null){r.setValue({to:r.getFrom(),from:r.getTo()});this.setValue(r);this.onChange()}this.getPopup().close()}},{key:"correctColorpickerColors",value:function e(){var t=this.getValue();if(t!==null){var a=t.getAngle();var r=this.colorpickerFrom.getHexPreviewObject();var n=this.colorpickerTo.getHexPreviewObject();var i=t.getFrom();var s=t.getTo();if(t.getType()===se.TYPE_LINEAR){if(a===270||a===90){var l=S.getMedian(i,s).getContrast().getHex();r.adjustColors(l,"transparent");n.adjustColors(l,"transparent")}else if(a>=135&&a<=225){r.adjustColors(i.getContrast().getHex(),"transparent");n.adjustColors(s.getContrast().getHex(),"transparent")}else{r.adjustColors(s.getContrast().getHex(),"transparent");n.adjustColors(i.getContrast().getHex(),"transparent")}}else if(t.getType()===se.TYPE_RADIAL){r.adjustColors(s.getContrast().getHex(),"transparent");n.adjustColors(s.getContrast().getHex(),"transparent")}}}},{key:"getPopup",value:function e(){var t=this;return this.cache.remember("popup",function(){return a.PopupManager.create({id:t.popupId,className:"landing-ui-field-color-gradient-preset-popup",autoHide:true,bindElement:t.getPopupButton(),bindOptions:{forceTop:true,forceLeft:true},offsetLeft:15,angle:{offset:-5},padding:0,contentPadding:7,content:t.getPopupContent(),closeByEsc:true,targetContainer:t.popupTargetContainer})})}},{key:"getPopupContent",value:function e(){var t=this;return this.cache.remember("popupContainer",function(){return s.Tag.render(Ue||(Ue=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-color-gradient-preset-popup-container">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"])),t.getRotateButton(),t.getSwapButton())})}},{key:"buildLayout",value:function e(){if(this.preset){s.Dom.clean(this.getPresetContainer());s.Dom.append(this.preset.getLayout(),this.getPresetContainer())}return s.Tag.render(Ge||(Ge=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-gradient">\n\t\t\t\t','\n\t\t\t\t<div class="landing-ui-field-color-gradient-container">\n\t\t\t\t\t<div class="landing-ui-field-color-gradient-from">',"</div>\n\t\t\t\t\t",'\n\t\t\t\t\t<div class="landing-ui-field-color-gradient-to">','</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="landing-ui-field-color-gradient-switch-type-container">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.getPresetContainer(),this.colorpickerFrom.getLayout(),this.getPopupButton(),this.colorpickerTo.getLayout(),this.getSwitchTypeButton())}},{key:"getContainerLayout",value:function e(){return this.getLayout().querySelector(".landing-ui-field-color-gradient-container")}},{key:"getPresetContainer",value:function e(){return this.cache.remember("presetContainer",function(){return s.Tag.render(Xe||(Xe=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-color-gradient-preset-container"></div>'])))})}},{key:"getPopupButton",value:function e(){return this.cache.remember("popupButton",function(){return s.Tag.render(ze||(ze=babelHelpers.taggedTemplateLiteral(['<span class="landing-ui-field-color-gradient-open-popup"></span>'])))})}},{key:"getSwitchTypeButton",value:function e(){return this.cache.remember("switchTypeButton",function(){return s.Tag.render(je||(je=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span\n\t\t\t\t\tclass="landing-ui-field-color-gradient-switch-type"\n\t\t\t\t\ttitle="','"\n\t\t\t\t></span>'])),s.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_SWITCH_TYPE"))})}},{key:"getRotateButton",value:function e(){return this.cache.remember("rotateButton",function(){return s.Tag.render(Ye||(Ye=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span\n\t\t\t\t\tclass="landing-ui-field-color-gradient-rotate"\n\t\t\t\t\ttitle="','"\n\t\t\t\t></span>'])),s.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_ROTATE"))})}},{key:"getSwapButton",value:function e(){return this.cache.remember("swapButton",function(){return s.Tag.render(We||(We=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span\n\t\t\t\t\tclass="landing-ui-field-color-gradient-swap"\n\t\t\t\t\ttitle="','"\n\t\t\t\t></span>'])),s.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_SWAP"))})}},{key:"setPreset",value:function e(t){var a=this;this.preset=t;this.preset.subscribe("onChange",function(e){a.setValue(e.getData().color);a.unsetColorpickerActive();a.onChange(e)});s.Dom.clean(this.getPresetContainer());s.Dom.append(t.getLayout(),this.getPresetContainer())}},{key:"getPreset",value:function e(){return this.preset}},{key:"getValue",value:function e(){var t=this;return this.cache.remember("value",function(){if(t.colorpickerFrom.getValue()===null||t.colorpickerTo.getValue()===null){return null}var e=t.getRotateButton().dataset.rotate;e=e?s.Text.toNumber(e):0;var a=t.getSwitchTypeButton().dataset.type||se.TYPE_LINEAR;return new se({from:t.colorpickerFrom.getValue(),to:t.colorpickerTo.getValue(),angle:e,type:a})})}},{key:"setValue",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a);if(a===null){this.colorpickerFrom.setValue(null);this.colorpickerTo.setValue(null);this.unsetActive();s.Dom.style(this.getContainerLayout(),"background",(new se).getStyleString());t.disableButton(this.getRotateButton());t.disableButton(this.getSwitchTypeButton());t.disableButton(this.getSwapButton())}else{this.colorpickerFrom.setValue(a.getFrom());this.colorpickerTo.setValue(a.getTo());this.correctColorpickerColors();this.getRotateButton().dataset.rotate=a.getAngle();this.getSwitchTypeButton().dataset.type=a.getType();s.Dom.style(this.getRotateButton(),"transform","rotate(".concat(a.getAngle(),"deg)"));s.Dom.style(this.getContainerLayout(),"background",this.getValue().getStyleString());t.enableButton(this.getSwitchTypeButton());t.enableButton(this.getSwapButton());if(a.getType()===se.TYPE_RADIAL){t.disableButton(this.getRotateButton());this.getSwitchTypeButton().innerText=s.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_DO_LINEAR")}else{t.enableButton(this.getRotateButton());this.getSwitchTypeButton().innerText=s.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_DO_RADIAL")}this.setActive()}}},{key:"onChange",value:function e(t){this.emit("onChange",{gradient:this.getValue()})}},{key:"setActive",value:function e(){var t=this.getValue();if(this.preset.isPresetValue(t)){this.preset.setActiveValue(t);this.unsetColorpickerActive()}else{this.preset.unsetActive();this.setColorpickerActive()}}},{key:"unsetActive",value:function e(){this.preset.unsetActive();this.unsetColorpickerActive()}},{key:"setColorpickerActive",value:function e(){s.Dom.addClass(this.getContainerLayout(),t.ACTIVE_CLASS)}},{key:"unsetColorpickerActive",value:function e(){this.colorpickerFrom.unsetActive();this.colorpickerTo.unsetActive();s.Dom.removeClass(this.getContainerLayout(),t.ACTIVE_CLASS)}}],[{key:"disableButton",value:function e(a){s.Dom.addClass(a,t.DISABLE_CLASS)}},{key:"enableButton",value:function e(a){s.Dom.removeClass(a,t.DISABLE_CLASS)}},{key:"isButtonEnable",value:function e(a){return!s.Dom.hasClass(a,t.DISABLE_CLASS)}}]);return t}(R);babelHelpers.defineProperty(Ze,"DISABLE_CLASS","disable");var $e=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.BgColor");a.property=["background-image","background-color"];a.variableName="--bg";a.className="g-bg";a.activeControl=null;a.gradient=new Ze(e);a.gradient.subscribe("onChange",a.onGradientChange.bind(babelHelpers.assertThisInitialized(a)));a.tabs.prependTab("Gradient",s.Loc.getMessage("LANDING_FIELD_COLOR-TAB_GRADIENT"),a.gradient);a.setGradientPreset(a.colorSet.getPreset());a.colorSet.subscribe("onPresetChange",function(e){a.setGradientPreset(e.getData().preset)});a.tabs.subscribe("onToggle",a.onTabsToggle.bind(babelHelpers.assertThisInitialized(a)));return a}babelHelpers.createClass(t,[{key:"isNullValue",value:function e(t){return t===null||t==="none"||t==="rgba(0, 0, 0, 0)"}},{key:"setGradientPreset",value:function e(t){var a=this;var r=t.getGradientPreset();this.gradient.setPreset(r);r.subscribe("onChange",function(){a.activeControl=a.gradient;a.onChange()});var n=this.getValue();if(n!==null&&n instanceof se){console.log("bg grad value",n);if(this.gradient.getPreset().isPresetValue(n)){this.colorSet.getPreset().unsetActive();this.gradient.getPreset().setActiveValue(n)}}}},{key:"onColorSetChange",value:function e(a){this.activeControl=this.colorSet;this.gradient.unsetActive();babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onColorSetChange",this).call(this,a)}},{key:"onGradientChange",value:function e(t){this.activeControl=this.gradient;this.colorSet.unsetActive();var a=t.getData().gradient;if(a!==null){this.opacity.setValue(a.setOpacity(this.opacity.getValue().getOpacity()))}this.onChange()}},{key:"onOverlayOpacityChange",value:function e(){this.onChange()}},{key:"onTabsToggle",value:function e(){this.gradient.getPopup().close()}},{key:"unsetActive",value:function e(){this.colorSet.unsetActive();this.gradient.unsetActive();this.primary.unsetActive()}},{key:"setValue",value:function e(a){this.colorSet.setValue(null);this.gradient.setValue(null);this.unsetActive();this.activeControl=null;if(s.Type.isNull(a));else if(c(a)||g(a)||b(a)||T(a)){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a);this.activeControl=this.colorSet}else if(ie(a)){var r=new se(a);this.gradient.setValue(r);this.opacity.setValue(r);this.tabs.showTab("Gradient");if(r.getOpacity()<1){this.tabs.showTab("Opacity")}this.activeControl=this.gradient}}},{key:"getValue",value:function e(){var a=this;return this.cache.remember("value",function(){if(a.activeControl===null){return null}else if(a.activeControl===a.gradient){var e=a.gradient.getValue();return e===null?e:e.setOpacity(a.opacity.getValue().getOpacity())}else{return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getValue",a).call(a)}})}}]);return t}(Fe);var qe=/url\(['"]?([^ '"]*)['"]?\)([\w \/]*)/i;function Ke(e){if(!!e.trim().match(qe)){return true}return!!e.trim().match(Je())}function Je(){var e=ee(qe);var t=ee(te);return new RegExp("^".concat(t,",").concat(e))}var Qe=function(){function e(t){babelHelpers.classCallCheck(this,e);this.value=_;this.setValue(t)}babelHelpers.createClass(e,[{key:"getName",value:function e(){return"\n\t\t\t".concat(this.value.url.replace(/[^\w\d]/g,""),"_").concat(this.value.size,"_").concat(this.value.attachment,"\n\t\t")}},{key:"setValue",value:function t(a){if(s.Type.isObject(a)){if(a instanceof e){this.value.url=a.getUrl();this.value.url2x=a.getUrl2x();this.value.fileId=a.getFileId();this.value.fileId2x=a.getFileId2x();this.value.size=a.getSize();this.value.attachment=a.getAttachment()}else{this.value=babelHelpers.objectSpread({},this.value,a)}}if(s.Type.isString(a)&&Ke(a)){this.parseBgString(a)}return this}},{key:"parseBgString",value:function e(t){var a=_;var r=t.trim().match(Q(qe));if(!!r){a.url=r[1];a.size=r[2].indexOf("auto")===-1?I:"auto";a.attachment=r[2].indexOf("fixed")===-1?E:"fixed"}var n=t.trim().match(Q(ne));if(!!t.trim().match(Q(te))&&!!n){a.overlay=new S(n[0])}this.setValue(a)}},{key:"setOpacity",value:function e(t){return this}},{key:"setUrl",value:function e(t){this.setValue({url:t});return this}},{key:"setUrl2x",value:function e(t){this.setValue({url2x:t});return this}},{key:"setFileId",value:function e(t){this.setValue({fileId:t});return this}},{key:"setFileId2x",value:function e(t){this.setValue({fileId2x:t});return this}},{key:"setSize",value:function e(t){this.setValue({size:t});return this}},{key:"setAttachment",value:function e(t){this.setValue({attachment:t});return this}},{key:"setOverlay",value:function e(t){this.setValue({overlay:t})}},{key:"getUrl",value:function e(){return this.value.url}},{key:"getUrl2x",value:function e(){return this.value.url2x}},{key:"getFileId",value:function e(){return this.value.fileId}},{key:"getFileId2x",value:function e(){return this.value.fileId2x}},{key:"getSize",value:function e(){return this.value.size}},{key:"getAttachment",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return t?this.value.attachment==="fixed":this.value.attachment}},{key:"getOverlay",value:function e(){return this.value.overlay}},{key:"getOpacity",value:function e(){return 1}},{key:"getStyleString",value:function e(){var t="";if(this.value.overlay!==null){t="linear-gradient(".concat(this.value.overlay.getStyleString(),",").concat(this.value.overlay.getStyleString(),")")}var a=this.value,r=a.url,n=a.url2x,i=a.size,s=a.attachment;var l="center / ".concat(i," ").concat(s);if(r!==null){t=t.length?t+",":"";if(n!==null){t+="-webkit-image-set(url('".concat(r,"') 1x, url('").concat(n,"') 2x) ").concat(l,",");t+="image-set(url('".concat(r,"') 1x, url('").concat(n,"') 2x) ").concat(l,",")}t+="url('".concat(r,"') ").concat(l)}return t}},{key:"getStyleStringForOpacity",value:function e(){return""}}],[{key:"getSizeItemsForButtons",value:function e(){return[{name:s.Loc.getMessage("LANDING_FIELD_COLOR-BG_COVER"),value:"cover"},{name:s.Loc.getMessage("LANDING_FIELD_COLOR-BG_MOSAIC"),value:"auto"}]}},{key:"getAttachmentValueByBool",value:function e(t){return t?"fixed":"scroll"}}]);return e}();var et;var tt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));a.setEventNamespace("BX.Landing.UI.Field.Color.Image");a.options=e;var r=i.PageObject.getRootWindow();a.imgField=new r.BX.Landing.UI.Field.Image({id:"landing_ui_color_image_"+s.Text.getRandom().toLowerCase(),className:"landing-ui-field-color-image-image",compactMode:true,disableLink:true,disableAltField:true,allowClear:true,dimensions:{width:1920},uploadParams:{action:"Block::uploadFile",block:a.options.block.id},contentRoot:a.options.contentRoot});a.imgField.subscribe("change",a.onImageChange.bind(babelHelpers.assertThisInitialized(a)));a.sizeField=new BX.Landing.UI.Field.Dropdown({id:"landing_ui_color_image_size_"+s.Text.getRandom().toLowerCase(),title:s.Loc.getMessage("LANDING_FIELD_COLOR-BG_SIZE_TITLE"),className:"landing-ui-field-color-image-size",items:Qe.getSizeItemsForButtons(),onChange:a.onSizeChange.bind(babelHelpers.assertThisInitialized(a)),contentRoot:a.options.contentRoot});a.attachmentField=new BX.Landing.UI.Field.Checkbox({id:"landing_ui_color_image_attach_"+s.Text.getRandom().toLowerCase(),className:"landing-ui-field-color-image-attachment",multiple:false,compact:true,items:[{name:s.Loc.getMessage("LANDING_FIELD_COLOR-BG_FIXED"),value:true}],onChange:a.onAttachmentChange.bind(babelHelpers.assertThisInitialized(a))});return a}babelHelpers.createClass(t,[{key:"buildLayout",value:function e(){return s.Tag.render(et||(et=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-image">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.imgField.getLayout(),this.sizeField.getLayout(),this.attachmentField.getLayout())}},{key:"onImageChange",value:function e(t){var a=this.getValue()||new Qe;a.setUrl(t.getData().value.src);a.setFileId(t.getData().value.id);if(t.getData().value.src2x){a.setUrl2x(t.getData().value.src2x);a.setFileId2x(t.getData().value.id2x)}this.setValue(a);this.onChange(new r.BaseEvent({data:{image:a}}));this.saveNode(a)}},{key:"saveNode",value:function e(t){var a=this.options.styleNode;var r=this.options.block;var i=a.selector;if(a.selector===r.selector||a.selector===r.makeAbsoluteSelector(r.selector)){i="#wrapper"}else if(!a.isSelectGroup()){i=BX.Landing.Utils.join(a.selector.split("@")[0],"@",a.getElementIndex(a.getNode()[0]))}else{i=a.selector.split("@")[0]}var s=babelHelpers.defineProperty({},i,{});if(t.getFileId()){s[i].id=t.getFileId()}if(t.getFileId2x()){s[i].id2x=t.getFileId2x()}n.Backend.getInstance().action("Landing\\Block::updateNodes",{block:this.options.block.id,data:s})}},{key:"onSizeChange",value:function e(t){if(s.Type.isString(t)){var a=this.getValue()||new Qe;a.setSize(t);this.setValue(a);this.onChange(new r.BaseEvent({data:{image:a}}))}}},{key:"onAttachmentChange",value:function e(t){if(t instanceof r.BaseEvent){var a=this.getValue()||new Qe;a.setAttachment(Qe.getAttachmentValueByBool(this.attachmentField.getValue()));this.setValue(a);this.onChange(new r.BaseEvent({data:{image:a}}))}}},{key:"onChange",value:function e(t){this.emit("onChange",t)}},{key:"getValue",value:function e(){var t=this;return this.cache.remember("value",function(){var e=t.imgField.getValue();var a=e.src;if(a===null){return null}else{var r=new Qe({url:a,fileId:e.id});if(e.src2x){r.setUrl2x(e.src2x);r.setFileId2x(e.fileId2x)}var n=t.sizeField.getValue();if(n!==null){r.setSize(n)}r.setAttachment(Qe.getAttachmentValueByBool(t.attachmentField.getValue()));return r}})}},{key:"setValue",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a);if(a===null){this.imgField.setValue({src:""},true)}else{if(a.getUrl()!==null){this.setActive()}var r={type:"image",src:a.getUrl(),id:a.getFileId()};if(a.getUrl2x()){r.src2x=a.getUrl2x();r.id2x=a.getFileId2x()}this.imgField.setValue(r,true);this.sizeField.setValue(a.getSize(),true);this.attachmentField.setValue([a.getAttachment(true)])}}},{key:"setActive",value:function e(){s.Dom.addClass(this.imgField.getLayout(),t.ACTIVE_CLASS)}},{key:"unsetActive",value:function e(){s.Dom.removeClass(this.imgField.getLayout(),t.ACTIVE_CLASS)}}]);return t}(R);var at;var rt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.Bg");a.parentVariableName=a.variableName;a.variableName=[a.parentVariableName,t.BG_URL_VAR,t.BG_URL_2X_VAR,t.BG_OVERLAY_VAR,t.BG_SIZE_VAR,t.BG_ATTACHMENT_VAR];a.parentClassName=a.className;a.className="g-bg-image";a.image=new tt(e);a.image.subscribe("onChange",a.onImageChange.bind(babelHelpers.assertThisInitialized(a)));a.overlay=new Ae(e);a.overlay.subscribe("onChange",a.onOverlayChange.bind(babelHelpers.assertThisInitialized(a)));a.overlayOpacity=new Ve;a.overlayOpacity.setValue((new S).setOpacity(.5));a.overlayOpacity.subscribe("onChange",a.onOverlayOpacityChange.bind(babelHelpers.assertThisInitialized(a)));a.imageTabs=(new Be).appendTab("Overlay",s.Loc.getMessage("LANDING_FIELD_COLOR-BG_OVERLAY"),[a.overlay,a.overlayOpacity]);a.bigTabs=(new Be).setBig(true).appendTab("Color",s.Loc.getMessage("LANDING_FIELD_COLOR-BG_COLOR"),[a.colorSet,a.primary,a.tabs]).appendTab("Image",s.Loc.getMessage("LANDING_FIELD_COLOR-BG_IMAGE"),[a.image,a.imageTabs]);return a}babelHelpers.createClass(t,[{key:"buildLayout",value:function e(){return s.Tag.render(at||(at=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-ui-field-color-color">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.bigTabs.getLayout())}},{key:"onColorSetChange",value:function e(a){this.image.unsetActive();babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onColorSetChange",this).call(this,a)}},{key:"onGradientChange",value:function e(a){this.image.unsetActive();babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onGradientChange",this).call(this,a)}},{key:"onImageChange",value:function e(){this.unsetActive();this.activeControl=this.image;this.image.setActive();this.onChange()}},{key:"onOverlayChange",value:function e(t){var a=t.getData().color;a.setOpacity(this.overlayOpacity.getValue().getOpacity());this.overlayOpacity.setValue(a);this.onChange()}},{key:"onOverlayOpacityChange",value:function e(){this.onChange()}},{key:"unsetActive",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"unsetActive",this).call(this);this.image.unsetActive()}},{key:"setProcessorValue",value:function e(t){this.setValue(t)}},{key:"setValue",value:function e(a){this.image.setValue(null);this.bigTabs.showTab("Color");if(s.Type.isNull(a)){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a)}else if(s.Type.isString(a)){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a)}else if(this.parentVariableName in a&&s.Type.isString(a[this.parentVariableName])){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setValue",this).call(this,a[this.parentVariableName])}else if(s.Type.isObject(a)){var r=new Qe;if(t.BG_URL_VAR in a){r.setUrl(a[t.BG_URL_VAR].replace(/url\(["']/i,"").replace(/['"]\)/i,""))}if(t.BG_URL_2X_VAR in a){r.setUrl2x(a[t.BG_URL_2X_VAR].replace(/url\(["']/i,"").replace(/['"]\)/i,""))}if(t.BG_SIZE_VAR in a){r.setSize(a[t.BG_SIZE_VAR])}if(t.BG_ATTACHMENT_VAR in a){r.setAttachment(a[t.BG_ATTACHMENT_VAR])}this.image.setValue(r);this.bigTabs.showTab("Image");this.activeControl=this.image;if(t.BG_OVERLAY_VAR in a){var n=new S(a[t.BG_OVERLAY_VAR]);this.overlay.setValue(n);this.overlayOpacity.setValue(n);this.imageTabs.showTab("Overlay")}}}},{key:"getValue",value:function e(){var a=this;return this.cache.remember("value",function(){if(a.activeControl===a.image){var e=a.image.getValue();var r=a.overlay.getValue();if(e!==null&&a.overlay.isActive()&&r!==null){r.setOpacity(a.overlayOpacity.getValue().getOpacity());e.setOverlay(r)}return e}else{return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getValue",a).call(a)}})}},{key:"getClassName",value:function e(){var t=this.getValue();if(t===null||t instanceof S||t instanceof se){return[this.parentClassName]}return[this.className]}},{key:"getStyle",value:function e(){var a;if(this.getValue()===null){var r;return r={},babelHelpers.defineProperty(r,this.parentVariableName,null),babelHelpers.defineProperty(r,t.BG_URL_VAR,null),babelHelpers.defineProperty(r,t.BG_URL_2X_VAR,null),babelHelpers.defineProperty(r,t.BG_OVERLAY_VAR,null),babelHelpers.defineProperty(r,t.BG_SIZE_VAR,null),babelHelpers.defineProperty(r,t.BG_ATTACHMENT_VAR,null),r}var n=this.getValue();var i=null;var s=null;var l=null;var o=null;var u=null;var c=null;if(n instanceof S||n instanceof se){i=n.getStyleString()}else{s="url('".concat(n.getUrl(),"')");l="url('".concat(n.getUrl2x(),"')");o=n.getOverlay()?n.getOverlay().getStyleString():"transparent";u=n.getSize();c=n.getAttachment()}return a={},babelHelpers.defineProperty(a,this.parentVariableName,i),babelHelpers.defineProperty(a,t.BG_URL_VAR,s),babelHelpers.defineProperty(a,t.BG_URL_2X_VAR,l),babelHelpers.defineProperty(a,t.BG_OVERLAY_VAR,o),babelHelpers.defineProperty(a,t.BG_SIZE_VAR,u),babelHelpers.defineProperty(a,t.BG_ATTACHMENT_VAR,c),a}}]);return t}($e);babelHelpers.defineProperty(rt,"BG_URL_VAR","--bg-url");babelHelpers.defineProperty(rt,"BG_URL_2X_VAR","--bg-url-2x");babelHelpers.defineProperty(rt,"BG_OVERLAY_VAR","--bg-overlay");babelHelpers.defineProperty(rt,"BG_SIZE_VAR","--bg-size");babelHelpers.defineProperty(rt,"BG_ATTACHMENT_VAR","--bg-attachment");var nt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.BorderColor");a.property="border-color";a.variableName="--border-color";a.className="g-border-color";return a}return t}(Fe);var it=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.BorderColorHover");a.property="border-color";a.variableName="--border-color--hover";a.className="g-border-color--hover";a.pseudoClass=":hover";return a}return t}(Fe);var st=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.BgColorHover");a.property=["background-image","background-color"];a.variableName="--bg-hover";a.className="g-bg--hover";a.pseudoClass=":hover";return a}return t}($e);var lt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.BgColorAfter");a.property=["background-image","background-color"];a.variableName="--bg--after";a.className="g-bg--after";a.pseudoClass=":after";var r=a.getValue()||new S;a.opacity.setValue(r.setOpacity(.5));a.tabs.showTab("Opacity");return a}return t}($e);var ot=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.BgColorBefore");a.property=["background-image","background-color"];a.variableName="--bg--before";a.className="g-bg--before";a.pseudoClass=":before";var r=a.getValue()||new S;a.opacity.setValue(r.setOpacity(.5));a.tabs.showTab("Opacity");return a}return t}($e);var ut=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColor");a.property="color";a.variableName="--navbar-color";a.className="u-navbar-color";return a}return t}(Fe);var ct=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColorHover");a.property="color";a.variableName="--navbar-color--hover";a.className="u-navbar-color--hover";a.pseudoClass=":hover";return a}return t}(Fe);var ht=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColorFixMoment");a.property="color";a.variableName="--navbar-color--fix-moment";a.className="u-navbar-color--fix-moment";return a}return t}(Fe);var gt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColorFixMomentHover");a.property="color";a.variableName="--navbar-color--fix-moment--hover";a.className="u-navbar-color--fix-moment--hover";a.pseudoClass=":hover";return a}return t}(Fe);var pt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarBgColor");a.property="background-color";a.variableName="--navbar-bg-color";a.className="u-navbar-bg";return a}return t}(Fe);var bt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarBgColorHover");a.property="background-color";a.variableName="--navbar-bg-color--hover";a.className="u-navbar-bg--hover";a.pseudoClass=":hover";return a}return t}(Fe);var dt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.BorderColorTop");a.property="border-top-color";a.variableName="--border-color-top";a.className="g-border-color-top";return a}return t}(Fe);var vt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.FillColor");a.property="fill";a.variableName="--fill-first";a.className="g-fill-first";return a}return t}(Fe);var ft=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.FillColorSecond");a.property="fill";a.variableName="--fill-second";a.className="g-fill-second";return a}return t}(Fe);var yt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.ButtonColor");a.property="background-color";a.variableName=[t.COLOR_CONTRAST_VAR,t.COLOR_HOVER_VAR,t.COLOR_LIGHT_VAR,t.COLOR_VAR];a.className="g-button-color";return a}babelHelpers.createClass(t,[{key:"getStyle",value:function e(){var a;if(this.getValue()===null){var r;return r={},babelHelpers.defineProperty(r,t.COLOR_CONTRAST_VAR,null),babelHelpers.defineProperty(r,t.COLOR_HOVER_VAR,null),babelHelpers.defineProperty(r,t.COLOR_LIGHT_VAR,null),babelHelpers.defineProperty(r,t.COLOR_VAR,null),r}var n=this.getValue();var i=n.getContrast().lighten(10);var s=new S(n).lighten(10);var l=n.getLighten();return a={},babelHelpers.defineProperty(a,t.COLOR_CONTRAST_VAR,i.getStyleString()),babelHelpers.defineProperty(a,t.COLOR_HOVER_VAR,s.getStyleString()),babelHelpers.defineProperty(a,t.COLOR_LIGHT_VAR,l.getStyleString()),babelHelpers.defineProperty(a,t.COLOR_VAR,n.getStyleString()),a}}]);return t}(Fe);babelHelpers.defineProperty(yt,"COLOR_CONTRAST_VAR","--button-color-contrast");babelHelpers.defineProperty(yt,"COLOR_HOVER_VAR","--button-color-hover");babelHelpers.defineProperty(yt,"COLOR_LIGHT_VAR","--button-color-light");babelHelpers.defineProperty(yt,"COLOR_VAR","--button-color");var mt=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarCollapseBgColor");a.property="background-color";a.variableName="--navbar-collapse-bg-color";a.className="u-navbar-collapse-bg";return a}return t}(Fe);var Ct=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));a.items="items"in e&&e.items?e.items:[];a.postfix=typeof e.postfix==="string"?e.postfix:"";a.frame=babelHelpers.typeof(e.frame)==="object"?e.frame:null;var r={block:e.block,styleNode:e.styleNode,selector:e.selector,contentRoot:a.contentRoot};a.changeHandler=typeof e.onChange==="function"?e.onChange:function(){};a.resetHandler=typeof e.onReset==="function"?e.onReset:function(){};switch(e.subtype){case"color":a.processor=new Fe(r);break;case"color-hover":a.processor=new Me(r);break;case"bg":a.processor=new rt(r);break;case"bg-color":a.processor=new $e(r);break;case"bg-color-hover":a.processor=new st(r);break;case"bg-color-after":a.processor=new lt(r);break;case"bg-color-before":a.processor=new ot(r);break;case"border-color":a.processor=new nt(r);break;case"border-color-hover":a.processor=new it(r);break;case"border-color-top":a.processor=new dt(r);break;case"navbar-color":a.processor=new ut(r);break;case"navbar-color-hover":a.processor=new ct(r);break;case"navbar-color-fix-moment":a.processor=new ht(r);break;case"navbar-color-fix-moment-hover":a.processor=new gt(r);break;case"navbar-bg-color":a.processor=new pt(r);break;case"navbar-bg-color-hover":a.processor=new bt(r);break;case"navbar-collapse-bg-color":a.processor=new mt(r);break;case"fill-color":a.processor=new vt(r);break;case"fill-color-second":a.processor=new ft(r);break;case"button-color":a.processor=new yt(r);break;default:break}a.property=a.processor.getProperty()[a.processor.getProperty().length-1];a.processor.getClassName().forEach(function(e){return a.items.push({name:e,value:e})});s.Dom.remove(a.input);a.layout.classList.add("landing-ui-field-color");s.Dom.append(a.processor.getLayout(),a.layout);a.processor.subscribe("onChange",a.onChange.bind(babelHelpers.assertThisInitialized(a)));a.processor.subscribe("onReset",a.onReset.bind(babelHelpers.assertThisInitialized(a)));return a}babelHelpers.createClass(t,[{key:"getInlineProperties",value:function e(){return this.processor.getVariableName()}},{key:"getComputedProperties",value:function e(){return this.processor.getProperty()}},{key:"getPseudoElement",value:function e(){return this.processor.getPseudoClass()}},{key:"onChange",value:function e(){this.changeHandler({className:this.processor.getClassName(),style:this.processor.getStyle()},this.items,this.postfix,this.property)}},{key:"onReset",value:function e(){this.resetHandler(this.items,this.postfix,this.property)}},{key:"getValue",value:function e(){return this.processor.getValue()}},{key:"setValue",value:function e(t){var a=this;var r=null;this.getInlineProperties().forEach(function(e){if(e in t&&!a.processor.isNullValue(t[e])){if(!s.Type.isObject(r)){r={}}r[e]=t[e]}});var n=null;this.getComputedProperties().forEach(function(e){if(e in t&&!a.processor.isNullValue(t[e])){if(!s.Type.isObject(n)){n={}}n[e]=t[e]}});if(r!==null){this.processor.setProcessorValue(r)}else{this.processor.setDefaultValue(n)}}},{key:"onFrameLoad",value:function e(){var t=this.data.styleNode.getValue(true);this.setValue(t.style)}}]);return t}(t.BaseField);e.ColorField=Ct})(this.BX.Landing.UI.Field=this.BX.Landing.UI.Field||{},BX.Landing.UI.Field,BX.Main,BX.Event,BX.Landing,BX.Landing,BX);
//# sourceMappingURL=color_field.bundle.map.js