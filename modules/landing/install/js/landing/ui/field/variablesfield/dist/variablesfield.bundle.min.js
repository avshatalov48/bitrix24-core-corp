this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};this.BX.Landing.UI=this.BX.Landing.UI||{};(function(t,e,n,i,a,l){"use strict";function o(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div \n\t\t\t\t\tclass="landing-ui-field-variables-button" \n\t\t\t\t\tonclick="','"\n\t\t\t\t></div>\n\t\t\t']);o=function e(){return t};return t}function s(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field landing-ui-field-variables">\n\t\t\t\t\t<div class="landing-ui-field-variables-left">','</div>\n\t\t\t\t\t<div class="landing-ui-field-variables-right">',"</div>\n\t\t\t\t</div>\n\t\t\t"]);s=function e(){return t};return t}var u=Symbol("instances");var r=function(t){babelHelpers.inherits(e,t);function e(t){var i;babelHelpers.classCallCheck(this,e);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,babelHelpers.objectSpread({},t,{textOnly:true})));i.setEventNamespace("BX.Landing.UI.Field.VariablesField");i.onButtonClick=i.onButtonClick.bind(babelHelpers.assertThisInitialized(i));i.onTopDocumentClick=i.onTopDocumentClick.bind(babelHelpers.assertThisInitialized(i));n.Event.bind(window.top.document,"click",i.onTopDocumentClick);n.Dom.append(i.getLayout(),i.layout);e[u].push(babelHelpers.assertThisInitialized(i));return i}babelHelpers.createClass(e,[{key:"onTopDocumentClick",value:function t(){}},{key:"onInputClick",value:function t(e){this.lastRange=this.input.ownerDocument.createRange(this.input.innerText.length,this.input.innerText.length);this.lastRange=this.input.ownerDocument.getSelection().getRangeAt(0)}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",function(){return n.Tag.render(s(),e.input,e.getButton())})}},{key:"getButton",value:function t(){var e=this;return this.cache.remember("button",function(){return n.Tag.render(o(),e.onButtonClick)})}},{key:"getMenu",value:function t(){var i=this;return this.cache.remember("menu",function(){var t=l.PageObject.getRootWindow();var a=new t.BX.Main.Menu({bindElement:i.getButton(),targetContainer:i.getLayout(),autoHide:true,items:i.options.variables.map(function(t){return{text:t.name,onclick:function e(){i.onVariableClick(t);a.close()}}}),events:{onPopupShow:function t(){e[u].forEach(function(t){if(t!==i){t.getMenu().close()}});setTimeout(function(){n.Dom.style(a.getMenuContainer(),{left:"auto",right:"0px",top:"30px"})})}}});return a})}},{key:"onInputInput",value:function t(){var n=this.getLayout().ownerDocument;this.lastRange=n.getSelection().getRangeAt(0);babelHelpers.get(babelHelpers.getPrototypeOf(e.prototype),"onInputInput",this).call(this)}},{key:"onVariableClick",value:function t(e){this.enableEdit();this.input.focus();var n=this.getLayout().ownerDocument;if(this.lastRange){n.getSelection().removeAllRanges();n.getSelection().addRange(this.lastRange)}n.execCommand("insertText",null," ".concat(e.value," "))}},{key:"onButtonClick",value:function t(e){e.preventDefault();e.stopPropagation();if(!this.lastRange&&this.input.innerText.length){var n=this.input.ownerDocument;n.getSelection().collapse(this.input.childNodes[0],this.input.innerText.length);this.lastRange=n.getSelection().getRangeAt(0)}var i=this.getMenu();if(i.getPopupWindow().isShown()){this.getMenu().close()}else{this.getMenu().show()}}},{key:"getValue",value:function t(){return this.input.innerText}}]);return e}(e.TextField);babelHelpers.defineProperty(r,u,[]);t.VariablesField=r})(this.BX.Landing.UI.Field=this.BX.Landing.UI.Field||{},BX.Landing.UI.Field,BX,BX.Landing.UI.Button,BX.Main,BX.Landing);
//# sourceMappingURL=variablesfield.bundle.map.js