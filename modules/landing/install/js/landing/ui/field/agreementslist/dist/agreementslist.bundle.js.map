{"version":3,"file":"agreementslist.bundle.js","sources":["../src/agreementslist.js"],"sourcesContent":["import 'ui.design-tokens';\n\nimport {Dom, Loc, Reflection, Runtime, Tag, Type} from 'main.core';\nimport {Menu} from 'main.popup';\nimport {BaseField} from 'landing.ui.field.basefield';\nimport {Draggable} from 'ui.draganddrop.draggable';\nimport {RadioButtonField} from 'landing.ui.field.radiobuttonfield';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {FormClient} from 'crm.form.client';\nimport {ListItem} from 'landing.ui.component.listitem';\nimport {ActionPanel} from 'landing.ui.component.actionpanel';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\nimport {Backend} from 'landing.backend';\nimport {FormSettingsPanel} from 'landing.ui.panel.formsettingspanel';\n\nimport './css/style.css';\n\ntype Agreement = {\n\tid: string,\n\tchecked: boolean,\n\tlabel: string,\n\tname: string,\n\trequired: boolean,\n\tvalue: 'Y' | 'N',\n\tcontent: {\n\t\ttext: string,\n\t\ttitle: string,\n\t\turl: ?string,\n\t},\n};\n\ntype AgreementsListItem = {\n\tid: string | number,\n\tname: string,\n\tlabelText: string,\n};\n\n/**\n * @memberOf BX.Landing.UI.Field\n */\nexport class AgreementsList extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Field.AgreementsList');\n\n\t\tthis.onSelectAgreementClick = this.onSelectAgreementClick.bind(this);\n\t\tthis.onCreateAgreementClick = this.onCreateAgreementClick.bind(this);\n\t\tthis.onUserConsentEditSave = this.onUserConsentEditSave.bind(this);\n\t\tthis.onUserConsentEditCancel = this.onUserConsentEditCancel.bind(this);\n\t\tthis.onItemRemoveClick = this.onItemRemoveClick.bind(this);\n\t\tthis.onDragEnd = this.onDragEnd.bind(this);\n\n\t\tthis.items = [];\n\n\t\tDom.replace(this.input, this.getListContainer());\n\t\tDom.append(this.getActionsContainer(), this.layout);\n\n\t\tvoid this.showAgreementLoader();\n\n\t\tFormClient\n\t\t\t.getInstance()\n\t\t\t.prepareOptions(this.options.formOptions, this.options.value)\n\t\t\t.then((result) => {\n\t\t\t\treturn result.data.agreements.map((item, index) => {\n\t\t\t\t\treturn Runtime.merge(item, this.options.value[index]);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then((agreements) => {\n\t\t\t\tvoid this.hideAgreementLoader();\n\t\t\t\tagreements.forEach((agreement) => {\n\t\t\t\t\tthis.addItem(agreement);\n\t\t\t\t});\n\t\t\t});\n\n\t\tthis.draggable = new Draggable({\n\t\t\tcontext: window.parent,\n\t\t\tcontainer: this.getListContainer(),\n\t\t\tdraggable: '.landing-ui-component-list-item',\n\t\t\tdragElement: '.landing-ui-button-icon-drag',\n\t\t\ttype: Draggable.MOVE,\n\t\t\toffset: {\n\t\t\t\ty: -62,\n\t\t\t},\n\t\t});\n\n\t\tthis.draggable\n\t\t\t.subscribe('end', this.onDragEnd);\n\n\t\tconst addCustomEvent = Reflection.getClass('top.BX.addCustomEvent');\n\t\taddCustomEvent(window.top, 'main-user-consent-to-list', this.onUserConsentEditCancel);\n\t\taddCustomEvent(window.top, 'main-user-consent-saved', this.onUserConsentEditSave);\n\t}\n\n\tgetAgreementsList(): Array<AgreementsListItem>\n\t{\n\t\treturn this.cache.remember('agreementsList', () => {\n\t\t\treturn this.options.agreementsList;\n\t\t});\n\t}\n\n\tsetAgreementsList(agreements: Array<AgreementsListItem>)\n\t{\n\t\tthis.cache.set('agreementsList', agreements);\n\t}\n\n\tloadAgreementsList(): Promise<Array<AgreementsListItem>>\n\t{\n\t\treturn Backend.getInstance()\n\t\t\t.action('Form::getAgreements')\n\t\t\t.then((agreements) => {\n\t\t\t\treturn Runtime.orderBy(agreements, ['id'], ['asc']);\n\t\t\t});\n\t}\n\n\tgetAgreementById(id: string | number): ?AgreementsListItem\n\t{\n\t\treturn this.getAgreementsList().find((agreement) => {\n\t\t\treturn String(id) === String(agreement.id);\n\t\t});\n\t}\n\n\taddItem(itemOptions)\n\t{\n\t\tconst item = this.createItem(itemOptions);\n\t\titem.appendTo(this.getListContainer());\n\n\t\tthis.items = this.items.filter((currentItem) => {\n\t\t\treturn String(currentItem.options.id) !== String(item.options.id);\n\t\t});\n\n\t\tthis.items.push(item);\n\t}\n\n\tgetListContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('listContainer', () => {\n\t\t\treturn Tag.render`<div class=\"landing-ui-field-agreements-list-container\"></div>`;\n\t\t});\n\t}\n\n\tgetActionsContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('actionsContainer', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-field-agreements-list-actions-container\">\n\t\t\t\t\t${this.getSelectAgreementButton()}\n\t\t\t\t\t${this.getCreateAgreementButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSelectAgreementButton(): HTMLSpanElement\n\t{\n\t\treturn this.cache.remember('selectAgreementButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"landing-ui-field-agreements-list-actions-button\" onclick=\"${this.onSelectAgreementClick}\">\n\t\t\t\t\t${Loc.getMessage('LANDING_AGREEMENT_LIST_SELECT_BUTTON_LABEL')}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetCreateAgreementButton(): HTMLSpanElement\n\t{\n\t\treturn this.cache.remember('createAgreementButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"landing-ui-field-agreements-list-actions-button\" onclick=\"${this.onCreateAgreementClick}\">\n\t\t\t\t\t${Loc.getMessage('LANDING_AGREEMENT_LIST_CREATE_BUTTON_LABEL')}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSelectedAgreements(): Array<number>\n\t{\n\t\treturn [...this.getListContainer().children].map((item) => {\n\t\t\treturn Dom.attr(item, 'data-value');\n\t\t});\n\t}\n\n\tgetAgreementsMenu(): Menu\n\t{\n\t\treturn this.cache.remember('agreementsMenu', () => {\n\t\t\tconst menu = new Menu({\n\t\t\t\tbindElement: this.getSelectAgreementButton(),\n\t\t\t\tautoHide: true,\n\t\t\t\tmaxWidth: 400,\n\t\t\t\tmaxHeight: 205,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: () => {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tDom.style(menu.getMenuContainer(), {\n\t\t\t\t\t\t\t\tleft: '0px',\n\t\t\t\t\t\t\t\tright: 'auto',\n\t\t\t\t\t\t\t\ttop: '30px',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.getAgreementsList()\n\t\t\t\t.filter((agreement) => {\n\t\t\t\t\treturn !this.items.some((item) => {\n\t\t\t\t\t\treturn String(item.options.id) === String(agreement.id);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.forEach((agreement) => {\n\t\t\t\t\tmenu.addMenuItem({\n\t\t\t\t\t\tid: agreement.id,\n\t\t\t\t\t\ttext: agreement.name,\n\t\t\t\t\t\tonclick: this.onAgreementsMenuItemClick.bind(this, agreement),\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\tDom.append(menu.getMenuContainer(), this.getActionsContainer());\n\n\t\t\treturn menu;\n\t\t});\n\t}\n\n\trefreshAgreementsMenu()\n\t{\n\t\tconst agreementsMenu = this.getAgreementsMenu();\n\t\tagreementsMenu.close();\n\t\tagreementsMenu.destroy();\n\t\tthis.cache.delete('agreementsMenu');\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tcreateItemForm(agreement: Agreement)\n\t{\n\t\treturn new FormSettingsForm({\n\t\t\tid: agreement.id,\n\t\t\ttitle: Loc.getMessage('LANDING_AGREEMENT_FORM_TITLE'),\n\t\t\tonChange: () => {\n\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t},\n\t\t\tserializeModifier(value) {\n\t\t\t\tif (value.type === 'type1')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tchecked: true,\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (value.type === 'type2')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tchecked: false,\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (value.type === 'type3')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tchecked: true,\n\t\t\t\t\t\trequired: false,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (value.type === 'type4')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tchecked: false,\n\t\t\t\t\t\trequired: false,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t},\n\t\t\tfields: [\n\t\t\t\tnew RadioButtonField({\n\t\t\t\t\tselector: 'type',\n\t\t\t\t\tvalue: (() => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tagreement.checked === true\n\t\t\t\t\t\t\t&& agreement.required === true\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 'type1';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tagreement.checked === false\n\t\t\t\t\t\t\t&& agreement.required === true\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 'type2';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tagreement.checked === true\n\t\t\t\t\t\t\t&& agreement.required === false\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 'type3';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tagreement.checked === false\n\t\t\t\t\t\t\t&& agreement.required === false\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 'type4';\n\t\t\t\t\t\t}\n\t\t\t\t\t})(),\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'type1',\n\t\t\t\t\t\t\ttitle: Loc.getMessage('LANDING_AGREEMENT_FORM_TYPE_FIELD_ITEM_1'),\n\t\t\t\t\t\t\ticon: 'landing-ui-agreement-type-1-icon',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'type2',\n\t\t\t\t\t\t\ttitle: Loc.getMessage('LANDING_AGREEMENT_FORM_TYPE_FIELD_ITEM_2'),\n\t\t\t\t\t\t\ticon: 'landing-ui-agreement-type-2-icon',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'type3',\n\t\t\t\t\t\t\ttitle: Loc.getMessage('LANDING_AGREEMENT_FORM_TYPE_FIELD_ITEM_3'),\n\t\t\t\t\t\t\ticon: 'landing-ui-agreement-type-3-icon',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'type4',\n\t\t\t\t\t\t\ttitle: Loc.getMessage('LANDING_AGREEMENT_FORM_TYPE_FIELD_ITEM_4'),\n\t\t\t\t\t\t\ticon: 'landing-ui-agreement-type-4-icon',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t\tnew ActionPanel({\n\t\t\t\t\tleft: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'edit',\n\t\t\t\t\t\t\ttext: Loc.getMessage('LANDING_AGREEMENT_EDIT_BUTTON_LABEL'),\n\t\t\t\t\t\t\tonClick: () => this.editAgreement(agreement),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'list',\n\t\t\t\t\t\t\ttext: Loc.getMessage('LANDING_AGREEMENT_CONSENTS_BUTTON_LABEL'),\n\t\t\t\t\t\t\tonClick: () => this.openConsentsList(agreement),\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\t}\n\n\tgetAgreementLoader(): Loader\n\t{\n\t\treturn this.cache.remember('agreementLoader', () => {\n\t\t\treturn new Loader({\n\t\t\t\tsize: 50,\n\t\t\t\tmode: 'inline',\n\t\t\t\toffset: {\n\t\t\t\t\ttop: '5px',\n\t\t\t\t\tleft: '225px',\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tshowAgreementLoader(): Promise\n\t{\n\t\tconst loader = this.getAgreementLoader();\n\t\tconst container = this.getListContainer();\n\t\tDom.append(loader.layout, container);\n\t\treturn loader.show(container);\n\t}\n\n\thideAgreementLoader(): Promise\n\t{\n\t\tconst loader = this.getAgreementLoader();\n\t\tDom.remove(loader.layout);\n\t\treturn loader.hide();\n\t}\n\n\tonAgreementsMenuItemClick(itemOptions)\n\t{\n\t\tvoid this.showAgreementLoader();\n\n\t\tFormClient\n\t\t\t.getInstance()\n\t\t\t.prepareOptions(this.options.formOptions, {agreements: [{id: itemOptions.id}]})\n\t\t\t.then((result) => {\n\t\t\t\tvoid this.hideAgreementLoader();\n\t\t\t\tthis.addItem(result.data.agreements[0]);\n\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t});\n\n\t\tthis.refreshAgreementsMenu();\n\t}\n\n\tonSelectAgreementClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst menu = this.getAgreementsMenu();\n\t\tif (!menu.getPopupWindow().isShown())\n\t\t{\n\t\t\tmenu.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\tonCreateAgreementClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.editAgreement({id: 0});\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonItemHeaderClick(agreement: Agreement, event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst {parentElement} = event.currentTarget;\n\n\t\tDom.toggleClass(parentElement, 'landing-ui-field-agreements-list-item-active');\n\t}\n\n\tcreateItem(options: Agreement): ListItem\n\t{\n\t\tconst agreementListItem = this.getAgreementById(options.id);\n\n\t\treturn new ListItem({\n\t\t\tid: options.id,\n\t\t\ttitle: agreementListItem.name,\n\t\t\tdescription: agreementListItem.labelText,\n\t\t\tsourceOptions: options,\n\t\t\tdraggable: true,\n\t\t\teditable: true,\n\t\t\tremovable: true,\n\t\t\tform: this.createItemForm(options),\n\t\t\tonRemove: this.onItemRemoveClick,\n\t\t});\n\t}\n\n\tsetCurrentlyEdited(agreement: Agreement)\n\t{\n\t\tthis.cache.set('setCurrentlyEdited', agreement);\n\t}\n\n\tgetCurrentlyEdited(): ?Agreement\n\t{\n\t\treturn this.cache.get('setCurrentlyEdited') || null;\n\t}\n\n\t// eslint-disable-next-line\n\tbuildEditPath(agreementId): string\n\t{\n\t\treturn `/settings/configs/userconsent/edit/${agreementId}/`;\n\t}\n\n\t// eslint-disable-next-line\n\tbuildConsentsListPath(agreementId)\n\t{\n\t\treturn `/settings/configs/userconsent/consents/${agreementId}/`;\n\t}\n\n\teditAgreement(agreement: Agreement)\n\t{\n\t\tthis.setCurrentlyEdited(agreement);\n\n\t\tconst editPath = this.buildEditPath(agreement.id);\n\t\tBX.SidePanel.Instance.open(\n\t\t\teditPath,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t},\n\t\t);\n\t}\n\n\tcloseEditAgreementSlider()\n\t{\n\t\tconst currentlyEdited = this.getCurrentlyEdited();\n\t\tif (Type.isPlainObject(currentlyEdited))\n\t\t{\n\t\t\tconst path = this.buildEditPath(currentlyEdited.id);\n\t\t\tconst slider = BX.SidePanel.Instance.getSlider(path);\n\t\t\tif (slider)\n\t\t\t{\n\t\t\t\tslider.close();\n\t\t\t}\n\t\t}\n\t}\n\n\topenConsentsList(agreement: Agreement)\n\t{\n\t\tconst editPath = this.buildConsentsListPath(agreement.id);\n\t\tBX.SidePanel.Instance.open(\n\t\t\teditPath,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t},\n\t\t);\n\t}\n\n\tonUserConsentEditCancel()\n\t{\n\t\tthis.closeEditAgreementSlider();\n\t}\n\n\tonUserConsentEditSave()\n\t{\n\t\tthis.closeEditAgreementSlider();\n\t\tvoid this.showAgreementLoader();\n\n\t\tconst value = this.getValue();\n\n\t\tthis.loadAgreementsList()\n\t\t\t.then((agreements) => {\n\t\t\t\tthis.setAgreementsList(agreements);\n\t\t\t\tFormSettingsPanel.getInstance().setAgreements(agreements);\n\n\t\t\t\tconst currentlyEdited = this.getCurrentlyEdited();\n\t\t\t\tif (currentlyEdited && currentlyEdited.id === 0)\n\t\t\t\t{\n\t\t\t\t\tconst lastAgreement = [...agreements].pop();\n\t\t\t\t\tFormClient\n\t\t\t\t\t\t.getInstance()\n\t\t\t\t\t\t.prepareOptions(this.options.formOptions, {agreements: [lastAgreement]})\n\t\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\t\tvoid this.hideAgreementLoader();\n\t\t\t\t\t\t\tthis.addItem(result.data.agreements[0]);\n\t\t\t\t\t\t\tthis.refreshAgreementsMenu();\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.clean(this.getListContainer());\n\t\t\t\t\tvoid this.showAgreementLoader();\n\n\t\t\t\t\tFormClient\n\t\t\t\t\t\t.getInstance()\n\t\t\t\t\t\t.prepareOptions(this.options.formOptions, {agreements: value})\n\t\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\t\tvoid this.hideAgreementLoader();\n\t\t\t\t\t\t\tthis.items = [];\n\t\t\t\t\t\t\tvalue.forEach((agreement) => {\n\t\t\t\t\t\t\t\tconst resultAgreement = result.data.agreements.find((currentAgreement) => {\n\t\t\t\t\t\t\t\t\treturn String(currentAgreement.id) === String(agreement.id);\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tif (resultAgreement)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.addItem({\n\t\t\t\t\t\t\t\t\t\t...resultAgreement,\n\t\t\t\t\t\t\t\t\t\tchecked: agreement.checked,\n\t\t\t\t\t\t\t\t\t\trequired: agreement.required,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.addItem(agreement);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.refreshAgreementsMenu();\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tonItemRemoveClick(event: BaseEvent)\n\t{\n\t\tconst value = event.getTarget().getValue();\n\n\t\tthis.items = this.items.filter((item) => {\n\t\t\treturn String(item.options.id) !== String(value.id);\n\t\t});\n\n\t\tthis.refreshAgreementsMenu();\n\t\tthis.emit('onItemRemove', {item: value});\n\t\tthis.emit('onChange', {skipPrepare: true});\n\t}\n\n\tonDragEnd()\n\t{\n\t\tconst items = this.items;\n\t\tthis.items = [];\n\n\t\t[...this.getListContainer().children].forEach((element) => {\n\t\t\tconst id = Dom.attr(element, 'data-id');\n\t\t\tconst item = items.find((currentItem) => {\n\t\t\t\treturn String(currentItem.options.id) === String(id);\n\t\t\t});\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tthis.items.push(item);\n\t\t\t}\n\t\t});\n\n\t\tthis.emit('onChange', {skipPrepare: true});\n\t}\n\n\tgetValue(): Array<Agreement>\n\t{\n\t\treturn this.items.map((item) => {\n\t\t\treturn item.getValue();\n\t\t});\n\t}\n}"],"names":["AgreementsList","options","setEventNamespace","onSelectAgreementClick","bind","onCreateAgreementClick","onUserConsentEditSave","onUserConsentEditCancel","onItemRemoveClick","onDragEnd","items","Dom","replace","input","getListContainer","append","getActionsContainer","layout","showAgreementLoader","FormClient","getInstance","prepareOptions","formOptions","value","then","result","data","agreements","map","item","index","Runtime","merge","hideAgreementLoader","forEach","agreement","addItem","draggable","Draggable","context","window","parent","container","dragElement","type","MOVE","offset","y","subscribe","addCustomEvent","Reflection","getClass","top","cache","remember","agreementsList","set","Backend","action","orderBy","id","getAgreementsList","find","String","itemOptions","createItem","appendTo","filter","currentItem","push","Tag","render","getSelectAgreementButton","getCreateAgreementButton","Loc","getMessage","children","attr","menu","Menu","bindElement","autoHide","maxWidth","maxHeight","events","onPopupShow","setTimeout","style","getMenuContainer","left","right","some","addMenuItem","text","name","onclick","onAgreementsMenuItemClick","agreementsMenu","getAgreementsMenu","close","destroy","FormSettingsForm","title","onChange","emit","skipPrepare","serializeModifier","checked","required","fields","RadioButtonField","selector","icon","ActionPanel","onClick","editAgreement","openConsentsList","Loader","size","mode","loader","getAgreementLoader","show","remove","hide","refreshAgreementsMenu","event","preventDefault","getPopupWindow","isShown","parentElement","currentTarget","toggleClass","agreementListItem","getAgreementById","ListItem","description","labelText","sourceOptions","editable","removable","form","createItemForm","onRemove","get","agreementId","setCurrentlyEdited","editPath","buildEditPath","BX","SidePanel","Instance","open","cacheable","allowChangeHistory","currentlyEdited","getCurrentlyEdited","Type","isPlainObject","path","slider","getSlider","buildConsentsListPath","closeEditAgreementSlider","getValue","loadAgreementsList","setAgreementsList","FormSettingsPanel","setAgreements","lastAgreement","pop","clean","resultAgreement","currentAgreement","getTarget","element","BaseField"],"mappings":"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"}