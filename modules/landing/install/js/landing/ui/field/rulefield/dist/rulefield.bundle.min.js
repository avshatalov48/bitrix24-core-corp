this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};this.BX.Landing.UI=this.BX.Landing.UI||{};(function(e,t,n,i,o,a,r,l,s,u,d,c){"use strict";function g(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-element-','">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="landing-ui-field-element-text">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);g=function t(){return e};return e}function p(){var e=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-field-element-text-title">',"</div>"]);p=function t(){return e};return e}function v(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-element-text-action">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"]);v=function t(){return e};return e}var f={removable:true,draggable:false,color:"blue"};var L=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));n.setEventNamespace("BX.Landing.UI.Field.RuleField.FieldElement");n.subscribeFromOptions(c.fetchEventsFromOptions(e));n.options=babelHelpers.objectSpread({},f,e);n.cache=new i.Cache.MemoryCache;return n}babelHelpers.createClass(t,[{key:"getDragButtonLayout",value:function e(){return this.cache.remember("dragButton",function(){var e=new a.IconButton({type:a.IconButton.Types.drag,style:{width:"20px"}});return e.getLayout()})}},{key:"getActionsDropdown",value:function e(){var t=this;return this.cache.remember("actionsDropdown",function(){var e=new window.top.BX.Landing.UI.Field.DropdownInline({title:t.options.actionsLabel,items:t.options.actionsList,content:t.options.actionsValue});e.subscribe("onChange",function(){t.emit("onChange")});return e})}},{key:"getActionsLayout",value:function e(){var t=this;return this.cache.remember("actionsLayout",function(){return i.Tag.render(v(),t.getActionsDropdown().getLayout())})}},{key:"getTitleLayout",value:function e(){var t=this;return this.cache.remember("titleLayout",function(){return i.Tag.render(p(),t.options.title)})}},{key:"getRemoveButtonLayout",value:function e(){var t=this;return this.cache.remember("removeButton",function(){var e=new a.IconButton({type:a.IconButton.Types.remove,onClick:function e(){return t.emit("onRemove")},iconSize:"9px",style:{width:"20px",marginLeft:"auto"}});return e.getLayout()})}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return i.Tag.render(g(),t.options.color,t.options.draggable?t.getDragButtonLayout():"",t.options.actionsLabel?t.getActionsLayout():"",t.getTitleLayout(),t.options.removable?t.getRemoveButtonLayout():"")})}}]);return t}(o.EventEmitter);babelHelpers.defineProperty(L,"Colors",{blue:"blue",green:"green",red:"red"});var h=[{value:"equal",label:d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_SETTINGS_EQUAL")},{value:"not-equal",label:d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_SETTINGS_NOT_EQUAL")}];function b(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-rule-entry">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);b=function t(){return e};return e}function m(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-rule-entry-expression">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"]);m=function t(){return e};return e}function y(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-rule-entry-expression-link">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass="landing-ui-rule-entry-expression-link-text"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t>\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="landing-ui-rule-entry-expression-link-sep"></div>\n\t\t\t\t</div>\n\t\t\t']);y=function t(){return e};return e}function E(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-rule-entry-condition">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"]);E=function t(){return e};return e}function C(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-rule-entry-condition-value">\n\t\t\t\t\t<div class="landing-ui-rule-entry-condition-value-text">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"]);C=function t(){return e};return e}function I(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div \n\t\t\t\t\tclass="landing-ui-rule-entry-condition-value-value-label"\n\t\t\t\t\tonclick="','"\n\t\t\t\t>\n\t\t\t\t\t',"\n\t\t\t\t</div>\t\t\t\n\t\t\t"]);I=function t(){return e};return e}function _(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-rule-entry-condition-value-operator">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"]);_=function t(){return e};return e}function D(){var e=babelHelpers.taggedTemplateLiteral(['<div class="value-settings-popup"></div>']);D=function t(){return e};return e}function T(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="value-settings-item value-settings-item-value">\n\t\t\t\t<input \n\t\t\t\t\ttype="radio" \n\t\t\t\t\tid="value_',"_",'" \n\t\t\t\t\tname="value_',"_",'"\n\t\t\t\t\tonchange="','"\n\t\t\t\t\t','\n\t\t\t\t>\n\t\t\t\t<label for="value_',"_",'">',"</label>\n\t\t\t</div>\n\t\t"]);T=function t(){return e};return e}function k(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="value-settings-item">\n\t\t\t\t<input \n\t\t\t\t\ttype="radio" \n\t\t\t\t\tid="operator_',"_",'" \n\t\t\t\t\tname="operator_',"_",'"\n\t\t\t\t\tonchange="','"\n\t\t\t\t\t','\n\t\t\t\t>\n\t\t\t\t<label for="operator_',"_",'">',"</label>\n\t\t\t</div>\n\t\t"]);k=function t(){return e};return e}function N(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="value-settings-item-separator"></div>\n\t\t']);N=function t(){return e};return e}var F=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));n.setEventNamespace("BX.Landing.UI.Field.RuleField.RuleEntry");n.subscribeFromOptions(c.fetchEventsFromOptions(e));n.options=babelHelpers.objectSpread({},e);n.cache=new i.Cache.MemoryCache;n.draggable=new l.Draggable({container:n.getExpressionContainer(),dragElement:".landing-ui-button-icon-drag",draggable:".landing-ui-field-element-green",type:l.Draggable.HEADLESS,context:window.parent,offset:{y:-62}});n.draggable.subscribe("end",n.onDragEnd.bind(babelHelpers.assertThisInitialized(n)));n.state={condition:{field:n.options.condition.field.id,value:n.options.condition.value,operator:n.options.condition.operator},expression:n.options.expression.map(function(e){return{field:e.field.id,action:e.action}})};n.options.expression.forEach(function(e){n.addExpressionItem({id:e.field.id,label:e.field.label,action:e.action,preventEvent:true})});return n}babelHelpers.createClass(t,[{key:"renderSeparator",value:function e(){return i.Tag.render(N())}},{key:"renderOperatorRadioButton",value:function e(t){var n=this;var o=t.label,a=t.value,r=t.id,l=t.checked,s=l===void 0?false:l;var u=function e(){if(a==="equal"){n.getOperatorLabelLayout().textContent=d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_EQUALS");n.state.condition.operator="="}else{n.getOperatorLabelLayout().textContent=d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_NOT_EQUALS");n.state.condition.operator="!="}n.emit("onChange")};return i.Tag.render(k(),r,a,r,this.options.condition.field.id,u,s?"checked":"",r,a,o)}},{key:"renderValueRadioButton",value:function e(t){var n=this;var o=t.label,a=t.value,r=t.id,l=t.checked;var s=function e(){n.setValueLabelText(o);n.state.condition.value=a;n.emit("onChange")};return i.Tag.render(T(),r,a,r,this.options.condition.field.id,s,l?"checked":"",r,a,o)}},{key:"getValueSettingsPopup",value:function e(){var t=this;return this.cache.remember("valueSettingsPopup",function(){var e=s.PageObject.getRootWindow();var n=i.Tag.render(D());var o=i.Text.getRandom();if(t.options.condition.field.type==="list"||t.options.condition.field.type==="checkbox"||t.options.condition.field.type==="radio"||t.options.condition.field.type==="bool"){h.forEach(function(e,a){i.Dom.append(t.renderOperatorRadioButton(babelHelpers.objectSpread({},e,{id:o,checked:a===0})),n)});i.Dom.append(t.renderSeparator(),n);var a=function(){if(t.options.condition.field.type==="bool"){return[{label:d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_YES"),value:"Y"},{label:d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_NO"),value:"N"}]}return t.options.condition.field.items}();a.forEach(function(e){var a=t.options.condition.field.value===e.value;i.Dom.append(i.Dom.append(t.renderValueRadioButton(babelHelpers.objectSpread({},e,{id:o,checked:a})),n),n)})}else{h.forEach(function(e,a){i.Dom.append(t.renderOperatorRadioButton(babelHelpers.objectSpread({},e,{id:o,checked:a===0})),n)});i.Dom.append(t.renderSeparator(),n);var r=new u.TextField({textOnly:true,onValueChange:function e(){var n=r.getValue()||d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_EMPTY");t.setValueLabelText(n);t.state.condition.value=r.getValue();t.emit("onChange")},content:t.options.condition.value});i.Dom.append(r.getLayout(),n)}return new e.BX.Main.Popup({bindElement:t.getConditionValueLayout(),content:n,width:228,autoHide:true,offsetLeft:8,offsetTop:1,maxHeight:200,events:{onShow:function e(){i.Dom.addClass(t.getConditionValueLayout(),"landing-ui-rule-entry-condition-value-active");t.getValueSettingsPopup().adjustPosition({forceBindPosition:true})},onClose:function e(){i.Dom.removeClass(t.getConditionValueLayout(),"landing-ui-rule-entry-condition-value-active")}}})})}},{key:"getOperatorLabelLayout",value:function e(){var t=this;return this.cache.remember("operatorLayout",function(){return i.Tag.render(_(),d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_".concat(t.options.condition.operator==="="?"EQUALS":"NOT_EQUALS")))})}},{key:"getValueLabel",value:function e(){var t=this;if(i.Type.isArray(this.options.condition.field.items)){var n=this.options.condition.field.items.find(function(e){return e.value===t.options.condition.value});if(n&&i.Type.isString(n.label)){return n.label}}if(i.Type.isStringFilled(this.options.condition.value)){if(this.options.condition.value==="Y"){return d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_YES")}if(this.options.condition.value==="N"){return d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_NO")}return this.options.condition.value}return d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_VALUE_EMPTY")}},{key:"getValueLabelLayout",value:function e(){var t=this;return this.cache.remember("valueLabelLayout",function(){return i.Tag.render(I(),t.onValueLabelClick.bind(t),t.getValueLabel())})}},{key:"setValueLabelText",value:function e(t){this.getValueLabelLayout().textContent=t}},{key:"onValueLabelClick",value:function e(t){t.preventDefault();var n=this.getValueSettingsPopup();if(!n.isShown()){n.show()}else{n.close()}}},{key:"getConditionValueLayout",value:function e(){var t=this;return this.cache.remember("conditionValueLayout",function(){return i.Tag.render(C(),t.getOperatorLabelLayout(),t.getValueLabelLayout())})}},{key:"getConditionContainer",value:function e(){var t=this;return this.cache.remember("conditionContainer",function(){return i.Tag.render(E(),t.getConditionValueLayout())})}},{key:"getFieldsListMenu",value:function e(){var t=this;return this.cache.remember("fieldsListMenu",function(){return new window.top.BX.Main.Menu({bindElement:t.getAddFieldLink(),maxHeight:205,items:t.options.fieldsList.filter(function(e){return e.type!=="page"&&e.type!=="layout"}).map(function(e){return{id:e.id,text:e.label,onclick:t.onAddExpressionField.bind(t,e)}})})})}},{key:"onExpressionItemRemove",value:function e(t){var n=t.getTarget();i.Dom.remove(n.getLayout());if(this.getExpressionContainer().children.length===1){i.Dom.removeClass(this.getLayout(),"landing-ui-rule-entry-with-expression")}this.state.expression=this.state.expression.filter(function(e){return e.field!==n.options.id});this.emit("onChange")}},{key:"onExpressionFieldChange",value:function e(t){var n=t.getTarget();var i=this.state.expression.find(function(e){return e.field===n.options.id});if(i){i.action=n.getActionsDropdown().getValue()}this.emit("onChange")}},{key:"addExpressionItem",value:function e(t){var n=babelHelpers.objectSpread({preventEvent:false,action:"show"},t);var o=new L({id:n.id,title:n.label,removable:true,color:L.Colors.green,actionsLabel:d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_FIELD_ACTION_LABEL"),actionsList:[{name:d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_FIELD_ACTION_SHOW_LABEL"),value:"show"},{name:d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_FIELD_ACTION_HIDE_LABEL"),value:"hide"}],actionsValue:n.action,onRemove:this.onExpressionItemRemove.bind(this),onChange:this.onExpressionFieldChange.bind(this)});i.Dom.insertBefore(o.getLayout(),this.getAddFieldLink());this.state.expression.push({field:n.id,action:"show"});this.state.expression=this.state.expression.reduce(function(e,t){if(!e.find(function(e){return e.field===t.field})){e.push(t)}return e},[]);this.adjustExpressionItems();i.Dom.addClass(this.getLayout(),"landing-ui-rule-entry-with-expression");if(!n.preventEvent){this.emit("onChange")}}},{key:"onAddExpressionField",value:function e(t){this.addExpressionItem(t);this.getFieldsListMenu().close()}},{key:"adjustExpressionItems",value:function e(){babelHelpers.toConsumableArray(this.getExpressionContainer().children).reverse().forEach(function(e,t){if(!i.Dom.hasClass(e,"landing-ui-rule-entry-expression-link")){i.Dom.style(e,"z-index",t+2)}})}},{key:"onAddFieldLinkClick",value:function e(t){t.preventDefault();var n=this.getFieldsListMenu();var o=this.state.expression;n.getMenuItems().forEach(function(e){var t=o.some(function(t){return t.field===e.getId()});if(t){i.Dom.addClass(e.getLayout().item,"landing-ui-disabled")}else{i.Dom.removeClass(e.getLayout().item,"landing-ui-disabled")}});this.getFieldsListMenu().show()}},{key:"getAddFieldLink",value:function e(){var t=this;return this.cache.remember("addFieldLink",function(){return i.Tag.render(y(),t.onAddFieldLinkClick.bind(t),d.Loc.getMessage("LANDING_RULE_FIELD_EXPRESSION_ADD_FIELD_LINK_LABEL"))})}},{key:"getExpressionContainer",value:function e(){var t=this;return this.cache.remember("expressionContainer",function(){return i.Tag.render(m(),t.getAddFieldLink())})}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return i.Tag.render(b(),t.getConditionContainer(),t.getExpressionContainer())})}},{key:"getValue",value:function e(){return this.state}},{key:"onDragEnd",value:function e(){this.adjustExpressionItems();this.emit("onChange")}}]);return t}(o.EventEmitter);function A(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-rule-field-row">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);A=function t(){return e};return e}function R(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-rule-field-row-list"></div>\n\t\t\t']);R=function t(){return e};return e}function H(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-rule-field-row-field-container">\n\t\t\t\t\t<div class="landing-ui-field-rule-field-row-field-container-title">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t\t",'\n\t\t\t\t\t<div class="landing-ui-field-rule-field-row-field-container-action-title">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"]);H=function t(){return e};return e}var O=function(e){babelHelpers.inherits(t,e);function t(){var e;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.setEventNamespace("BX.Landing.UI.Field.RuleField.FieldRow");e.options=babelHelpers.objectSpread({},n);e.cache=new i.Cache.MemoryCache;e.entries=[];e.onEntryChange=e.onEntryChange.bind(babelHelpers.assertThisInitialized(e));e.addRule(e.options);return e}babelHelpers.createClass(t,[{key:"addRule",value:function e(t){var n=new F(babelHelpers.objectSpread({},t,{fieldsList:this.options.fields}));this.entries.push(n);n.subscribe("onChange",this.onEntryChange);i.Dom.append(n.getLayout(),this.getListContainer());this.emit("onChange")}},{key:"onEntryChange",value:function e(){this.emit("onChange")}},{key:"getConditionFieldLayout",value:function e(){var t=this;return this.cache.remember("conditionField",function(){var e=new L({title:t.options.condition.field.label,removable:true,onRemove:t.onConditionFieldRemoveClick.bind(t)});return e.getLayout()})}},{key:"onConditionFieldRemoveClick",value:function e(t){t.preventDefault();i.Dom.remove(this.getLayout());this.entries=[];this.emit("onChange")}},{key:"getFieldContainer",value:function e(){var t=this;return this.cache.remember("fieldContainer",function(){return i.Tag.render(H(),d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_FIELD_TITLE"),t.getConditionFieldLayout(),d.Loc.getMessage("LANDING_RULE_FIELD_CONDITION_FIELD_SHOW_ACTION_TITLE"))})}},{key:"getListContainer",value:function e(){return this.cache.remember("listContainer",function(){return i.Tag.render(R())})}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return i.Tag.render(A(),t.getFieldContainer(),t.getListContainer())})}},{key:"getValue",value:function e(){return this.entries.map(function(e){return e.getValue()})}}]);return t}(o.EventEmitter);function x(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-rule-footer">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"]);x=function t(){return e};return e}function w(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-rule-body"></div>\n\t\t\t']);w=function t(){return e};return e}function B(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-rule-header">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);B=function t(){return e};return e}function U(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-field-rule-header-title">',"</div>\n\t\t\t"]);U=function t(){return e};return e}var V=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));n.setEventNamespace("BX.Landing.UI.Field.RuleField");n.subscribeFromOptions(c.fetchEventsFromOptions(e));n.setLayoutClass("landing-ui-field-rule");n.onRemoveClick=n.onRemoveClick.bind(babelHelpers.assertThisInitialized(n));n.onRowChange=n.onRowChange.bind(babelHelpers.assertThisInitialized(n));i.Dom.clean(n.layout);i.Dom.append(n.getHeaderLayout(),n.getLayout());i.Dom.append(n.getBodyLayout(),n.getLayout());i.Dom.append(n.getFooterLayout(),n.getLayout());n.rows=[];n.options.rules.forEach(function(e){n.addRule(e)});var o=n.options.rules.some(function(e){return e.expression.length>0});if(o){var a=n.rows[0].getFieldContainer().querySelector(".landing-ui-field-rule-field-row-field-container-action-title");i.Dom.hide(a)}return n}babelHelpers.createClass(t,[{key:"addRule",value:function e(t){var n=new O(babelHelpers.objectSpread({},t,{fields:this.options.fields}));this.rows.push(n);n.subscribe("onChange",this.onRowChange);i.Dom.append(n.getLayout(),this.getBodyLayout());this.emit("onChange")}},{key:"onRowChange",value:function e(t){this.emit("onChange");var n=t.getTarget().getValue().some(function(e){return e.expression.length>0});var o=this.rows[0].getFieldContainer().querySelector(".landing-ui-field-rule-field-row-field-container-action-title");if(n){i.Dom.hide(o)}else{i.Dom.show(o)}}},{key:"getHeaderTitleLayout",value:function e(){return this.cache.remember("headerTitleLayout",function(){return i.Tag.render(U(),d.Loc.getMessage("LANDING_FIELDS_RULES_TYPE_1"))})}},{key:"getRemoveButtonLayout",value:function e(){var t=this;return this.cache.remember("removeButtonLayout",function(){var e=new a.IconButton({type:a.IconButton.Types.remove,onClick:t.onRemoveClick,title:d.Loc.getMessage("LANDING_RULE_FIELD_REMOVE_BUTTON_TITLE"),style:{marginLeft:"auto"}});return e.getLayout()})}},{key:"getHeaderLayout",value:function e(){var t=this;return this.cache.remember("headerLayout",function(){return i.Tag.render(B(),t.getHeaderTitleLayout(),t.getRemoveButtonLayout())})}},{key:"getBodyLayout",value:function e(){return this.cache.remember("bodyLayout",function(){return i.Tag.render(w())})}},{key:"getFooterLayout",value:function e(){var t=this;return this.cache.remember("footerLayout",function(){return i.Tag.render(x(),t.getFooterActionPanel().getLayout())})}},{key:"onRemoveClick",value:function e(t){t.preventDefault();i.Dom.remove(this.getLayout());this.emit("onRemove");this.emit("onChange")}},{key:"getFooterActionPanel",value:function e(){var t=this;return this.cache.remember("footerActionPanel",function(){return new n.ActionPanel({left:[{id:"selectField",text:d.Loc.getMessage("LANDING_RULE_FIELD_EXPRESSION_ADD_FIELD_LINK_LABEL"),onClick:t.onAddFieldRulesLinkClick.bind(t)}]})})}},{key:"getFieldsListMenu",value:function e(){var t=this;return this.cache.remember("fieldsMenu",function(){return new window.top.BX.Main.Menu({bindElement:t.getFooterActionPanel().getLeftContainer().firstElementChild,maxHeight:205,items:t.options.fields.filter(function(e){return e.type!=="page"&&e.type!=="layout"}).map(function(e){return{id:e.id,text:e.label,onclick:function n(){t.onAddFieldRulesMenuItemClick(e)}}}),autoHide:true})})}},{key:"onAddFieldRulesLinkClick",value:function e(){this.getFieldsListMenu().show()}},{key:"onAddFieldRulesMenuItemClick",value:function e(t){this.addRule({condition:{field:t,value:"",operator:"="},expression:[]});this.getFieldsListMenu().close()}},{key:"getValue",value:function e(){return this.rows.map(function(e){return e.getValue()})}}]);return t}(t.BaseField);e.RuleField=V})(this.BX.Landing.UI.Field=this.BX.Landing.UI.Field||{},BX.Landing.UI.Field,BX.Landing.UI.Component,BX,BX.Event,BX.Landing.UI.Component,BX.Main,BX.UI.DragAndDrop,BX.Landing,BX.Landing.UI.Field,BX.Landing,BX.Landing.UI.Component);
//# sourceMappingURL=rulefield.bundle.map.js