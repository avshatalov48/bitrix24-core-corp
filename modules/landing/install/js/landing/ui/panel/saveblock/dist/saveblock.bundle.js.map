{"version":3,"file":"saveblock.bundle.js","sources":["../src/saveblock.js"],"sourcesContent":["import {Backend} from 'landing.backend';\nimport {Env} from 'landing.env';\nimport {ImageCompressor} from 'landing.imagecompressor';\nimport {Loc} from 'landing.loc';\nimport {Main} from 'landing.main';\nimport {Screenshoter} from 'landing.screenshoter';\nimport {MessageCard} from 'landing.ui.card.messagecard';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {Content} from 'landing.ui.panel.content';\nimport {Dom, Cache, Tag} from 'main.core';\n\nimport 'translit';\nimport './css/style.css';\n\n/**\n * @memberOf BX.Landing.UI.Panel\n */\nexport class SaveBlock extends Content\n{\n\tstatic getInstance(): SaveBlock\n\t{\n\t\tif (!SaveBlock.instance)\n\t\t{\n\t\t\tSaveBlock.instance = new SaveBlock('landing_save_block_panel');\n\t\t}\n\n\t\treturn SaveBlock.instance;\n\t}\n\n\tcache = new Cache.MemoryCache();\n\tbock = null;\n\tpreviewFileIds = [];\n\n\tconstructor(id, data)\n\t{\n\t\tdata = data || {};\n\t\tdata.title = Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_TITLE_MSGVER_1');\n\t\tdata.showFromRight = true;\n\n\t\tif (!data.block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsuper(id, data);\n\t\tthis.block = data.block;\n\t\tthis.mainInstance = Main.getInstance();\n\n\t\tDom.addClass(this.layout, 'landing-ui-panel-save-block');\n\t\tDom.addClass(this.overlay, 'landing-ui-panel-save-block');\n\n\t\tthis.setButtons();\n\t\tthis.renderTo(window.parent.document.body);\n\t}\n\n\tsetButtons()\n\t{\n\t\tthis.appendFooterButton(\n\t\t\tnew BX.Landing.UI.Button.BaseButton('save_block_content', {\n\t\t\t\ttext: Loc.getMessage('BLOCK_SAVE'),\n\t\t\t\tonClick: this.onSave.bind(this),\n\t\t\t\tclassName: 'landing-ui-button-content-save',\n\t\t\t}),\n\t\t);\n\t\tthis.appendFooterButton(\n\t\t\tnew BX.Landing.UI.Button.BaseButton('cancel_block_content', {\n\t\t\t\ttext: Loc.getMessage('BLOCK_CANCEL'),\n\t\t\t\tonClick: this.hide.bind(this),\n\t\t\t\tclassName: 'landing-ui-button-content-cancel',\n\t\t\t}),\n\t\t);\n\t}\n\n\tgetTitleField(): TextField\n\t{\n\t\treturn this.cache.remember('titleField', () => {\n\t\t\treturn new TextField({\n\t\t\t\ttitle: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_TITLE'),\n\t\t\t\ttextOnly: true\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSectionsField(): BX.Landing.UI.Field.MultiSelect\n\t{\n\t\treturn this.cache.remember('sectionsField', () => {\n\t\t\tconst items = [];\n\t\t\tconst { blocks } = Env.getInstance().getOptions();\n\t\t\tObject.keys(blocks).map(key => {\n\t\t\t\tif (key !== 'last' && key !== 'separator_apps' && key.indexOf('.') === -1)\n\t\t\t\t{\n\t\t\t\t\titems.push({value: key, name: blocks[key].name});\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn new BX.Landing.UI.Field.MultiSelect({\n\t\t\t\ttitle: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_SECTIONS'),\n\t\t\t\titems\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTemplateRefField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('templateRefField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\titems: [\n\t\t\t\t\t{value: 'N', name: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_TEMPLATE_REF')}\n\t\t\t\t]\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPreviewField()\n\t{\n\t\treturn this.cache.remember('preview', () => {\n\t\t\treturn new BX.Landing.UI.Field.Image({\n\t\t\t\ttitle: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_PREVIEW'),\n\t\t\t\tdisableLink: true,\n\t\t\t\tdisableAltField: true,\n\t\t\t\tuploadParams: {\n\t\t\t\t\taction: 'Block::uploadFile',\n\t\t\t\t\tblock: this.block.id\n\t\t\t\t},\n\t\t\t\tcontent: {\n\t\t\t\t\tsrc: '/bitrix/images/1.gif',\n\t\t\t\t\tid : -1,\n\t\t\t\t\talt : ''\n\t\t\t\t},\n\t\t\t\tdimensions: {\n\t\t\t\t\twidth: 1200,\n\t\t\t\t\theight: 600\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tgetMessage(): MessageCard\n\t{\n\t\treturn this.cache.remember('message', () => {\n\t\t\treturn new MessageCard({\n\t\t\t\tid: 'fieldsMessage',\n\t\t\t\theader: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_MESSAGE_TITLE_MSGVER_1'),\n\t\t\t\tdescription: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_MESSAGE_TEXT_MSGVER_1'),\n\t\t\t\t//icon: messageIcon,\n\t\t\t\trestoreState: true\n\t\t\t});\n\t\t});\n\t}\n\n\tgetForm(): BX.Landing.UI.Form.BaseForm\n\t{\n\t\treturn this.cache.remember('form', () => {\n\t\t\treturn new BX.Landing.UI.Form.BaseForm({\n\t\t\t\tfields: [\n\t\t\t\t\tthis.getTitleField(),\n\t\t\t\t\tthis.getSectionsField(),\n\t\t\t\t\tthis.mainInstance.getTemplateCode() ? this.getTemplateRefField() : null,\n\t\t\t\t\tthis.getPreviewField()\n\t\t\t\t]\n\t\t\t});\n\t\t});\n\t}\n\n\tmakeScreenshot()\n\t{\n\t\tthis.getPreviewField().showLoader();\n\n\t\tvoid Screenshoter\n\t\t\t.makeBlockScreenshot(this.block.id)\n\t\t\t.then((sourceFile) => {\n\t\t\t\treturn ImageCompressor.compress(sourceFile, {\n\t\t\t\t\tmaxWidth: 830,\n\t\t\t\t\tmaxHeight: 300,\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then((compressedFile) => {\n\t\t\t\treturn Backend\n\t\t\t\t\t.getInstance()\n\t\t\t\t\t.upload(compressedFile, {\n\t\t\t\t\t\tblock: this.block.id,\n\t\t\t\t\t\ttemp: true\n\t\t\t\t\t});\n\t\t\t})\n\t\t\t.then((response: {id: string, src: string}) => {\n\t\t\t\tthis.getPreviewField().setValue(response);\n\t\t\t\tthis.getPreviewField().hideLoader();\n\t\t\t});\n\t}\n\n\tshow(options?: any): Promise<any>\n\t{\n\t\tDom.style(this.footer, 'display', null);\n\n\t\tthis.getTitleField().setValue(this.block?.manifest?.block?.name);\n\t\tthis.getSectionsField().setValue(this.block?.manifest?.block?.section || []);\n\t\tthis.getTemplateRefField().setValue(['Y']);\n\t\tthis.getPreviewField().setValue({src: this.block?.manifest?.preview || this.block?.manifest?.block?.preview || ''});\n\n\t\tthis.makeScreenshot();\n\n\t\tthis.clear();\n\t\tDom.prepend(this.getMessage().getLayout(), this.content);\n\t\tthis.appendForm(this.getForm());\n\t\treturn super.show();\n\t}\n\n\tgetFailMessage()\n\t{\n\t\treturn this.cache.remember('failMessage', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-panel-save-block-fail\">\n\t\t\t\t\t<div class=\"landing-ui-panel-save-block-fail-header\">\n\t\t\t\t\t\t${Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FAIL_MESSAGE_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonSave()\n\t{\n\t\tconst backend = Backend.getInstance();\n\t\tconst title = this.getTitleField().getValue();\n\t\tconst templateRef = this.getTemplateRefField().getValue().length > 0;\n\t\tconst preview = this.getPreviewField().getValue();\n\t\tconst blockCode = this.block?.manifest?.code;\n\t\tlet sections = this.getSectionsField().getValue();\n\n\t\tthis.clear();\n\t\tthis.hide();\n\n\t\tif (!blockCode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tbackend.action(\n\t\t\t'Landing::favoriteBlock',\n\t\t\t{\n\t\t\t\tlid: this.block.lid,\n\t\t\t\tblock: this.block.id,\n\t\t\t\tmeta: {\n\t\t\t\t\tname: title,\n\t\t\t\t\tsection: sections,\n\t\t\t\t\tpreview: Math.max(preview.id, 0),\n\t\t\t\t\ttpl_code: templateRef ? this.mainInstance.getTemplateCode() : null\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tcode: blockCode\n\t\t\t}\n\t\t).then((newBlockId) => {\n\t\t\tif (newBlockId)\n\t\t\t{\n\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_SUCCESS')\n\t\t\t\t});\n\t\t\t\tsections.push('last');\n\t\t\t\tsections.map(section => {\n\t\t\t\t\tthis.mainInstance.addNewBlockToCategory(\n\t\t\t\t\t\tsection,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: blockCode,\n\t\t\t\t\t\t\tcodeOriginal: blockCode + '@' + newBlockId,\n\t\t\t\t\t\t\tname: title,\n\t\t\t\t\t\t\tpreview: preview.src,\n\t\t\t\t\t\t\tsection: sections,\n\t\t\t\t\t\t\tfavorite: true,\n\t\t\t\t\t\t\tfavoriteMy: true,\n\t\t\t\t\t\t\trepo_id: this.block.repoId,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.append(this.getFailMessage(), this.content);\n\t\t\t}\n\t\t});\n\t}\n}\n"],"names":["SaveBlock","instance","id","data","title","Loc","getMessage","showFromRight","block","Cache","MemoryCache","mainInstance","Main","getInstance","Dom","addClass","layout","overlay","setButtons","renderTo","window","parent","document","body","appendFooterButton","BX","Landing","UI","Button","BaseButton","text","onClick","onSave","bind","className","hide","cache","remember","TextField","textOnly","items","Env","getOptions","blocks","Object","keys","map","key","indexOf","push","value","name","Field","MultiSelect","Checkbox","Image","disableLink","disableAltField","uploadParams","action","content","src","alt","dimensions","width","height","MessageCard","header","description","restoreState","Form","BaseForm","fields","getTitleField","getSectionsField","getTemplateCode","getTemplateRefField","getPreviewField","showLoader","Screenshoter","makeBlockScreenshot","then","sourceFile","ImageCompressor","compress","maxWidth","maxHeight","compressedFile","Backend","upload","temp","response","setValue","hideLoader","options","style","footer","manifest","section","preview","makeScreenshot","clear","prepend","getLayout","appendForm","getForm","Tag","render","backend","getValue","templateRef","length","blockCode","code","sections","lid","meta","Math","max","tpl_code","newBlockId","top","Notification","Center","notify","addNewBlockToCategory","codeOriginal","favorite","favoriteMy","repo_id","repoId","append","getFailMessage","Content"],"mappings":";;;;;;;CAcA;CACA;CACA;;AACA,KAAaA,SAAb;CAAA;CAAA;CAAA;CAAA,kCAGC;CACC,UAAI,CAACA,SAAS,CAACC,QAAf,EACA;CACCD,QAAAA,SAAS,CAACC,QAAV,GAAqB,IAAID,SAAJ,CAAc,0BAAd,CAArB;CACA;;CAED,aAAOA,SAAS,CAACC,QAAjB;CACA;CAVF;;CAgBC,qBAAYC,EAAZ,EAAgBC,IAAhB,EACA;CAAA;;CAAA;CACCA,IAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;CACAA,IAAAA,IAAI,CAACC,KAAL,GAAaC,eAAG,CAACC,UAAJ,CAAe,yCAAf,CAAb;CACAH,IAAAA,IAAI,CAACI,aAAL,GAAqB,IAArB;;CAEA,QAAI,CAACJ,IAAI,CAACK,KAAV,EACA;CACC;CACA;;CAED,2GAAMN,EAAN,EAAUC,IAAV;CAVD,oFALQ,IAAIM,eAAK,CAACC,WAAV,EAKR;CAAA,mFAJO,IAIP;CAAA,6FAHiB,EAGjB;CAWC,UAAKF,KAAL,GAAaL,IAAI,CAACK,KAAlB;CACA,UAAKG,YAAL,GAAoBC,iBAAI,CAACC,WAAL,EAApB;CAEAC,IAAAA,aAAG,CAACC,QAAJ,CAAa,MAAKC,MAAlB,EAA0B,6BAA1B;CACAF,IAAAA,aAAG,CAACC,QAAJ,CAAa,MAAKE,OAAlB,EAA2B,6BAA3B;;CAEA,UAAKC,UAAL;;CACA,UAAKC,QAAL,CAAcC,MAAM,CAACC,MAAP,CAAcC,QAAd,CAAuBC,IAArC;;CAlBD;CAmBC;;CApCF;CAAA;CAAA,iCAuCC;CACC,WAAKC,kBAAL,CACC,IAAIC,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcC,MAAd,CAAqBC,UAAzB,CAAoC,oBAApC,EAA0D;CACzDC,QAAAA,IAAI,EAAEzB,eAAG,CAACC,UAAJ,CAAe,YAAf,CADmD;CAEzDyB,QAAAA,OAAO,EAAE,KAAKC,MAAL,CAAYC,IAAZ,CAAiB,IAAjB,CAFgD;CAGzDC,QAAAA,SAAS,EAAE;CAH8C,OAA1D,CADD;CAOA,WAAKV,kBAAL,CACC,IAAIC,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcC,MAAd,CAAqBC,UAAzB,CAAoC,sBAApC,EAA4D;CAC3DC,QAAAA,IAAI,EAAEzB,eAAG,CAACC,UAAJ,CAAe,cAAf,CADqD;CAE3DyB,QAAAA,OAAO,EAAE,KAAKI,IAAL,CAAUF,IAAV,CAAe,IAAf,CAFkD;CAG3DC,QAAAA,SAAS,EAAE;CAHgD,OAA5D,CADD;CAOA;CAtDF;CAAA;CAAA,oCAyDC;CACC,aAAO,KAAKE,KAAL,CAAWC,QAAX,CAAoB,YAApB,EAAkC,YAAM;CAC9C,eAAO,IAAIC,oCAAJ,CAAc;CACpBlC,UAAAA,KAAK,EAAEC,eAAG,CAACC,UAAJ,CAAe,sCAAf,CADa;CAEpBiC,UAAAA,QAAQ,EAAE;CAFU,SAAd,CAAP;CAIA,OALM,CAAP;CAMA;CAhEF;CAAA;CAAA,uCAmEC;CACC,aAAO,KAAKH,KAAL,CAAWC,QAAX,CAAoB,eAApB,EAAqC,YAAM;CACjD,YAAMG,KAAK,GAAG,EAAd;;CACA,oCAAmBC,eAAG,CAAC5B,WAAJ,GAAkB6B,UAAlB,EAAnB;CAAA,YAAQC,MAAR,yBAAQA,MAAR;;CACAC,QAAAA,MAAM,CAACC,IAAP,CAAYF,MAAZ,EAAoBG,GAApB,CAAwB,UAAAC,GAAG,EAAI;CAC9B,cAAIA,GAAG,KAAK,MAAR,IAAkBA,GAAG,KAAK,gBAA1B,IAA8CA,GAAG,CAACC,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAAxE,EACA;CACCR,YAAAA,KAAK,CAACS,IAAN,CAAW;CAACC,cAAAA,KAAK,EAAEH,GAAR;CAAaI,cAAAA,IAAI,EAAER,MAAM,CAACI,GAAD,CAAN,CAAYI;CAA/B,aAAX;CACA;CACD,SALD;CAMA,eAAO,IAAI1B,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcyB,KAAd,CAAoBC,WAAxB,CAAoC;CAC1CjD,UAAAA,KAAK,EAAEC,eAAG,CAACC,UAAJ,CAAe,yCAAf,CADmC;CAE1CkC,UAAAA,KAAK,EAALA;CAF0C,SAApC,CAAP;CAIA,OAbM,CAAP;CAcA;CAlFF;CAAA;CAAA,0CAqFC;CACC,aAAO,KAAKJ,KAAL,CAAWC,QAAX,CAAoB,kBAApB,EAAwC,YAAM;CACpD,eAAO,IAAIZ,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcyB,KAAd,CAAoBE,QAAxB,CAAiC;CACvCd,UAAAA,KAAK,EAAE,CACN;CAACU,YAAAA,KAAK,EAAE,GAAR;CAAaC,YAAAA,IAAI,EAAE9C,eAAG,CAACC,UAAJ,CAAe,6CAAf;CAAnB,WADM;CADgC,SAAjC,CAAP;CAKA,OANM,CAAP;CAOA;CA7FF;CAAA;CAAA,sCAgGC;CAAA;;CACC,aAAO,KAAK8B,KAAL,CAAWC,QAAX,CAAoB,SAApB,EAA+B,YAAM;CAC3C,eAAO,IAAIZ,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcyB,KAAd,CAAoBG,KAAxB,CAA8B;CACpCnD,UAAAA,KAAK,EAAEC,eAAG,CAACC,UAAJ,CAAe,wCAAf,CAD6B;CAEpCkD,UAAAA,WAAW,EAAE,IAFuB;CAGpCC,UAAAA,eAAe,EAAE,IAHmB;CAIpCC,UAAAA,YAAY,EAAE;CACbC,YAAAA,MAAM,EAAE,mBADK;CAEbnD,YAAAA,KAAK,EAAE,MAAI,CAACA,KAAL,CAAWN;CAFL,WAJsB;CAQpC0D,UAAAA,OAAO,EAAE;CACRC,YAAAA,GAAG,EAAE,sBADG;CAER3D,YAAAA,EAAE,EAAG,CAAC,CAFE;CAGR4D,YAAAA,GAAG,EAAG;CAHE,WAR2B;CAapCC,UAAAA,UAAU,EAAE;CACXC,YAAAA,KAAK,EAAE,IADI;CAEXC,YAAAA,MAAM,EAAE;CAFG;CAbwB,SAA9B,CAAP;CAkBA,OAnBM,CAAP;CAoBA;CArHF;CAAA;CAAA,iCAwHC;CACC,aAAO,KAAK7B,KAAL,CAAWC,QAAX,CAAoB,SAApB,EAA+B,YAAM;CAC3C,eAAO,IAAI6B,uCAAJ,CAAgB;CACtBhE,UAAAA,EAAE,EAAE,eADkB;CAEtBiE,UAAAA,MAAM,EAAE9D,eAAG,CAACC,UAAJ,CAAe,iDAAf,CAFc;CAGtB8D,UAAAA,WAAW,EAAE/D,eAAG,CAACC,UAAJ,CAAe,gDAAf,CAHS;CAItB;CACA+D,UAAAA,YAAY,EAAE;CALQ,SAAhB,CAAP;CAOA,OARM,CAAP;CASA;CAlIF;CAAA;CAAA,8BAqIC;CAAA;;CACC,aAAO,KAAKjC,KAAL,CAAWC,QAAX,CAAoB,MAApB,EAA4B,YAAM;CACxC,eAAO,IAAIZ,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAc2C,IAAd,CAAmBC,QAAvB,CAAgC;CACtCC,UAAAA,MAAM,EAAE,CACP,MAAI,CAACC,aAAL,EADO,EAEP,MAAI,CAACC,gBAAL,EAFO,EAGP,MAAI,CAAC/D,YAAL,CAAkBgE,eAAlB,KAAsC,MAAI,CAACC,mBAAL,EAAtC,GAAmE,IAH5D,EAIP,MAAI,CAACC,eAAL,EAJO;CAD8B,SAAhC,CAAP;CAQA,OATM,CAAP;CAUA;CAhJF;CAAA;CAAA,qCAmJC;CAAA;;CACC,WAAKA,eAAL,GAAuBC,UAAvB;CAEA,WAAKC,iCAAY,CACfC,mBADG,CACiB,KAAKxE,KAAL,CAAWN,EAD5B,EAEH+E,IAFG,CAEE,UAACC,UAAD,EAAgB;CACrB,eAAOC,uCAAe,CAACC,QAAhB,CAAyBF,UAAzB,EAAqC;CAC3CG,UAAAA,QAAQ,EAAE,GADiC;CAE3CC,UAAAA,SAAS,EAAE;CAFgC,SAArC,CAAP;CAIA,OAPG,EAQHL,IARG,CAQE,UAACM,cAAD,EAAoB;CACzB,eAAOC,uBAAO,CACZ3E,WADK,GAEL4E,MAFK,CAEEF,cAFF,EAEkB;CACvB/E,UAAAA,KAAK,EAAE,MAAI,CAACA,KAAL,CAAWN,EADK;CAEvBwF,UAAAA,IAAI,EAAE;CAFiB,SAFlB,CAAP;CAMA,OAfG,EAgBHT,IAhBG,CAgBE,UAACU,QAAD,EAAyC;CAC9C,QAAA,MAAI,CAACd,eAAL,GAAuBe,QAAvB,CAAgCD,QAAhC;;CACA,QAAA,MAAI,CAACd,eAAL,GAAuBgB,UAAvB;CACA,OAnBG,CAAL;CAoBA;CA1KF;CAAA;CAAA,yBA4KMC,OA5KN,EA6KC;CAAA;;CACChF,MAAAA,aAAG,CAACiF,KAAJ,CAAU,KAAKC,MAAf,EAAuB,SAAvB,EAAkC,IAAlC;CAEA,WAAKvB,aAAL,GAAqBmB,QAArB,gBAA8B,KAAKpF,KAAnC,wEAA8B,YAAYyF,QAA1C,kFAA8B,qBAAsBzF,KAApD,0DAA8B,sBAA6B2C,IAA3D;CACA,WAAKuB,gBAAL,GAAwBkB,QAAxB,CAAiC,sBAAKpF,KAAL,uFAAYyF,QAAZ,0GAAsBzF,KAAtB,kFAA6B0F,OAA7B,KAAwC,EAAzE;CACA,WAAKtB,mBAAL,GAA2BgB,QAA3B,CAAoC,CAAC,GAAD,CAApC;CACA,WAAKf,eAAL,GAAuBe,QAAvB,CAAgC;CAAC/B,QAAAA,GAAG,EAAE,sBAAKrD,KAAL,uFAAYyF,QAAZ,gFAAsBE,OAAtB,sBAAiC,KAAK3F,KAAtC,0EAAiC,aAAYyF,QAA7C,oFAAiC,sBAAsBzF,KAAvD,2DAAiC,uBAA6B2F,OAA9D,KAAyE;CAA/E,OAAhC;CAEA,WAAKC,cAAL;CAEA,WAAKC,KAAL;CACAvF,MAAAA,aAAG,CAACwF,OAAJ,CAAY,KAAKhG,UAAL,GAAkBiG,SAAlB,EAAZ,EAA2C,KAAK3C,OAAhD;CACA,WAAK4C,UAAL,CAAgB,KAAKC,OAAL,EAAhB;CACA;CACA;CA3LF;CAAA;CAAA,qCA8LC;CACC,aAAO,KAAKrE,KAAL,CAAWC,QAAX,CAAoB,aAApB,EAAmC,YAAM;CAC/C,eAAOqE,aAAG,CAACC,MAAX,2QAGKtG,eAAG,CAACC,UAAJ,CAAe,6CAAf,CAHL;CAOA,OARM,CAAP;CASA;CAxMF;CAAA;CAAA,6BA2MC;CAAA;CAAA;CAAA;;CACC,UAAMsG,OAAO,GAAGpB,uBAAO,CAAC3E,WAAR,EAAhB;CACA,UAAMT,KAAK,GAAG,KAAKqE,aAAL,GAAqBoC,QAArB,EAAd;CACA,UAAMC,WAAW,GAAG,KAAKlC,mBAAL,GAA2BiC,QAA3B,GAAsCE,MAAtC,GAA+C,CAAnE;CACA,UAAMZ,OAAO,GAAG,KAAKtB,eAAL,GAAuBgC,QAAvB,EAAhB;CACA,UAAMG,SAAS,mBAAG,KAAKxG,KAAR,0EAAG,aAAYyF,QAAf,0DAAG,sBAAsBgB,IAAxC;CACA,UAAIC,QAAQ,GAAG,KAAKxC,gBAAL,GAAwBmC,QAAxB,EAAf;CAEA,WAAKR,KAAL;CACA,WAAKlE,IAAL;;CAEA,UAAI,CAAC6E,SAAL,EACA;CACC;CACA;;CAEDJ,MAAAA,OAAO,CAACjD,MAAR,CACC,wBADD,EAEC;CACCwD,QAAAA,GAAG,EAAE,KAAK3G,KAAL,CAAW2G,GADjB;CAEC3G,QAAAA,KAAK,EAAE,KAAKA,KAAL,CAAWN,EAFnB;CAGCkH,QAAAA,IAAI,EAAE;CACLjE,UAAAA,IAAI,EAAE/C,KADD;CAEL8F,UAAAA,OAAO,EAAEgB,QAFJ;CAGLf,UAAAA,OAAO,EAAEkB,IAAI,CAACC,GAAL,CAASnB,OAAO,CAACjG,EAAjB,EAAqB,CAArB,CAHJ;CAILqH,UAAAA,QAAQ,EAAET,WAAW,GAAG,KAAKnG,YAAL,CAAkBgE,eAAlB,EAAH,GAAyC;CAJzD;CAHP,OAFD,EAYC;CACCsC,QAAAA,IAAI,EAAED;CADP,OAZD,EAeE/B,IAfF,CAeO,UAACuC,UAAD,EAAgB;CACtB,YAAIA,UAAJ,EACA;CACCC,UAAAA,GAAG,CAAChG,EAAJ,CAAOE,EAAP,CAAU+F,YAAV,CAAuBC,MAAvB,CAA8BC,MAA9B,CAAqC;CACpChE,YAAAA,OAAO,EAAEvD,eAAG,CAACC,UAAJ,CAAe,kCAAf;CAD2B,WAArC;CAGA4G,UAAAA,QAAQ,CAACjE,IAAT,CAAc,MAAd;CACAiE,UAAAA,QAAQ,CAACpE,GAAT,CAAa,UAAAoD,OAAO,EAAI;CACvB,YAAA,MAAI,CAACvF,YAAL,CAAkBkH,qBAAlB,CACC3B,OADD,EAEC;CACCe,cAAAA,IAAI,EAAED,SADP;CAECc,cAAAA,YAAY,EAAEd,SAAS,GAAG,GAAZ,GAAkBQ,UAFjC;CAGCrE,cAAAA,IAAI,EAAE/C,KAHP;CAIC+F,cAAAA,OAAO,EAAEA,OAAO,CAACtC,GAJlB;CAKCqC,cAAAA,OAAO,EAAEgB,QALV;CAMCa,cAAAA,QAAQ,EAAE,IANX;CAOCC,cAAAA,UAAU,EAAE,IAPb;CAQCC,cAAAA,OAAO,EAAE,MAAI,CAACzH,KAAL,CAAW0H;CARrB,aAFD;CAaA,WAdD;CAeA,SArBD,MAuBA;CACCpH,UAAAA,aAAG,CAACqH,MAAJ,CAAW,MAAI,CAACC,cAAL,EAAX,EAAkC,MAAI,CAACxE,OAAvC;CACA;CACD,OA1CD;CA2CA;CAtQF;CAAA;CAAA,EAA+ByE,gCAA/B;;;;;;;;"}