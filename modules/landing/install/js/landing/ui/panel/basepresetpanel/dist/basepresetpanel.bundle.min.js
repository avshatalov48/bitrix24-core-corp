this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};this.BX.Landing.UI=this.BX.Landing.UI||{};(function(e,t,n,i,a,r,s,o,l,c,u,d,g,p){"use strict";function h(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-presets-category">\n\t\t\t\t\t<div class="landing-ui-presets-category-title">',"</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);h=function t(){return e};return e}function b(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-presets-category-list"></div>\n\t\t\t']);b=function t(){return e};return e}var v=function(){function e(t){babelHelpers.classCallCheck(this,e);this.options=babelHelpers.objectSpread({},t);this.cache=new l.Cache.MemoryCache}babelHelpers.createClass(e,[{key:"setPresets",value:function e(t){this.presets=t;var n=this.getListContainer();l.Dom.clean(n);this.presets.forEach(function(e){l.Dom.append(e.getLayout(),n)})}},{key:"getListContainer",value:function e(){return this.cache.remember("listContainer",function(){return l.Tag.render(b())})}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){return l.Tag.render(h(),t.options.title,t.getListContainer())})}}]);return e}();function f(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-panel-preset',"",'" onclick="','">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="landing-ui-panel-preset-text">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);f=function t(){return e};return e}function C(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-panel-preset-soon-label">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"]);C=function t(){return e};return e}function y(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div \n\t\t\t\t\tclass="landing-ui-panel-preset-text-description"\n\t\t\t\t\ttitle="','"\n\t\t\t\t>',"</div>\n\t\t\t"]);y=function t(){return e};return e}function m(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div \n\t\t\t\t\tclass="landing-ui-panel-preset-text-title" \n\t\t\t\t\ttitle="','"\n\t\t\t\t>',"</div>\n\t\t\t"]);m=function t(){return e};return e}function k(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div \n\t\t\t\t\tclass="landing-ui-panel-preset-icon" \n\t\t\t\t\tstyle="background-image: url(',')"\n\t\t\t\t></div>\n\t\t\t']);k=function t(){return e};return e}var L={disabled:false,soon:false};var B=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));n.setEventNamespace("BX.Landing.UI.Panel.BasePresetPanel.Preset");n.options=babelHelpers.objectSpread({},L,e);if(s.Loc.getMessage("LANGUAGE_ID")!=="ru"){n.options.items=n.options.items.filter(function(e){return e!=="vk"})}n.cache=new l.Cache.MemoryCache;return n}babelHelpers.createClass(t,[{key:"getIconNode",value:function e(){var t=this;return this.cache.remember("iconNode",function(){return l.Tag.render(k(),t.options.icon)})}},{key:"getTitleNode",value:function e(){var t=this;return this.cache.remember("titleNode",function(){return l.Tag.render(m(),l.Text.encode(t.options.title),t.options.title)})}},{key:"getDescriptionNode",value:function e(){var t=this;return this.cache.remember("descriptionNode",function(){return l.Tag.render(y(),l.Text.encode(t.options.description),t.options.description)})}},{key:"activate",value:function e(){l.Dom.addClass(this.getLayout(),"landing-ui-panel-preset-active")}},{key:"deactivate",value:function e(){l.Dom.removeClass(this.getLayout(),"landing-ui-panel-preset-active")}},{key:"getSoonLabel",value:function e(){return this.cache.remember("soonLabel",function(){return l.Tag.render(C(),s.Loc.getMessage("LANDING_UI_BASE_PRESET_PANEL_SOON_LABEL"))})}},{key:"getLayout",value:function e(){var t=this;return this.cache.remember("layout",function(){var e=function e(n){n.preventDefault();t.activate();t.emit("onClick")};var n=t.options.active?" landing-ui-panel-preset-active":"";var i=t.options.disabled?" landing-ui-disabled":"";return l.Tag.render(f(),n,i,e,l.Type.isStringFilled(t.options.icon)&&t.getIconNode(),l.Type.isStringFilled(t.options.title)?t.getTitleNode():"",l.Type.isStringFilled(t.options.description)?t.getDescriptionNode():"",t.options.soon?t.getSoonLabel():"")})}}]);return t}(o.EventEmitter);function T(){var e=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-panel-form-settings-content-wrapper"></div>']);T=function t(){return e};return e}var H=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));n.setEventNamespace("BX.Landing.UI.Panel.FormSettingsPanel.ContentWrapper");n.options=babelHelpers.objectSpread({},e);n.cache=new l.Cache.MemoryCache;n.items=new g.BaseCollection;n.onChange=n.onChange.bind(babelHelpers.assertThisInitialized(n));return n}babelHelpers.createClass(t,[{key:"addItem",value:function e(t){if(!this.items.includes(t)){this.items.add(t);t.subscribe("onChange",this.onChange)}l.Dom.append(t.getLayout(),this.getLayout())}},{key:"insertBefore",value:function e(t,n){if(!this.items.includes(t)){this.items.add(t);t.subscribe("onChange",this.onChange)}l.Dom.insertBefore(t.getLayout(),n.getLayout())}},{key:"getLayout",value:function e(){return this.cache.remember("wrapper",function(){return l.Tag.render(T())})}},{key:"getValue",value:function e(){var t=this.items.reduce(function(e,t){if(t instanceof p.BaseForm&&t.getLayout().parentElement){return babelHelpers.objectSpread({},e,t.serialize())}return e},{});return this.valueReducer(t)}},{key:"valueReducer",value:function e(t){return t}},{key:"onChange",value:function e(t){this.emit("onChange",t.getData())}},{key:"clear",value:function e(){l.Dom.clean(this.getLayout())}}]);return t}(o.EventEmitter);function P(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-panel-base-preset-header-controls-left">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"]);P=function t(){return e};return e}function S(){var e=babelHelpers.taggedTemplateLiteral(['<div class="landing-ui-panel-base-preset-header-controls-right"></div>']);S=function t(){return e};return e}function I(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="landing-ui-panel-base-preset-header-controls">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);I=function t(){return e};return e}var E=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.setEventNamespace("BX.Landing.UI.Panel.BasePresetPanel");l.Dom.addClass(e.layout,"landing-ui-panel-base-preset");l.Dom.addClass(e.overlay,"landing-ui-panel-base-preset-overlay");e.cache=new l.Cache.MemoryCache;e.onSidebarButtonClick=e.onSidebarButtonClick.bind(babelHelpers.assertThisInitialized(e));e.onSaveClick=e.onSaveClick.bind(babelHelpers.assertThisInitialized(e));e.onCancelClick=e.onCancelClick.bind(babelHelpers.assertThisInitialized(e));e.onPresetFieldClick=e.onPresetFieldClick.bind(babelHelpers.assertThisInitialized(e));e.onPresetClick=e.onPresetClick.bind(babelHelpers.assertThisInitialized(e));e.onChange=e.onChange.bind(babelHelpers.assertThisInitialized(e));e.appendFooterButton(e.getSaveButton());e.appendFooterButton(e.getCancelButton());l.Dom.append(e.getHeaderControlsContainer(),e.header);return e}babelHelpers.createClass(t,[{key:"enableToggleMode",value:function e(){this.cache.set("toggleMode",true);this.renderTo(this.getViewContainer())}},{key:"isToggleModeEnabled",value:function e(){return this.cache.get("toggleMode")===true}},{key:"disableOverlay",value:function e(){l.Dom.addClass(this.overlay,"landing-ui-panel-base-preset-disable-overlay")}},{key:"getViewContainer",value:function e(){return this.cache.remember("viewContainer",function(){var e=a.PageObject.getRootWindow();return e.document.querySelector(".landing-ui-view-container")})}},{key:"getViewWrapper",value:function e(){var t=this;return this.cache.remember("viewWrapper",function(){return t.getViewContainer().querySelector(".landing-ui-view-wrapper")})}},{key:"getSaveButton",value:function e(){var t=this;return this.cache.remember("saveButton",function(){var e=new n.BaseButton("save_settings",{text:s.Loc.getMessage("BLOCK_SAVE"),onClick:t.onSaveClick,className:"ui-btn ui-btn-success",attrs:{title:s.Loc.getMessage("LANDING_TITLE_OF_SLIDER_SAVE")}});l.Dom.removeClass(e.layout,"landing-ui-button");return e})}},{key:"onSaveClick",value:function e(){}},{key:"getCancelButton",value:function e(){var t=this;return this.cache.remember("cancelButton",function(){return new n.BaseButton("cancel_settings",{text:s.Loc.getMessage("BLOCK_CANCEL"),onClick:t.onCancelClick,className:"landing-ui-button-content-cancel",attrs:{title:s.Loc.getMessage("LANDING_TITLE_OF_SLIDER_CANCEL")}})})}},{key:"onCancelClick",value:function e(){}},{key:"appendSidebarButton",value:function e(n){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"appendSidebarButton",this).call(this,n)}},{key:"onSidebarButtonClick",value:function e(t){this.sidebarButtons.getActive().deactivate();t.getTarget().activate();this.clearContent();var n=this.getContent(t.getTarget().id);if(n){n.subscribe("onChange",this.onChange);l.Dom.append(n.getLayout(),this.content)}}},{key:"onChange",value:function e(t){}},{key:"getContent",value:function e(t){throw new Error("Must be implemented in child class")}},{key:"getHeaderControlsContainer",value:function e(){var t=this;return this.cache.remember("headerControlsContainer",function(){return l.Tag.render(I(),t.getLeftHeaderControls(),t.getRightHeaderControls())})}},{key:"getRightHeaderControls",value:function e(){return this.cache.remember("rightHeaderControls",function(){return l.Tag.render(S())})}},{key:"getLeftHeaderControls",value:function e(){var t=this;return this.cache.remember("leftHeaderControls",function(){return l.Tag.render(P(),t.getPresetField().getNode())})}},{key:"getPresetField",value:function e(){var t=this;return this.cache.remember("presetField",function(){return new i.PresetField({events:{onClick:t.onPresetFieldClick}})})}},{key:"show",value:function e(n){if(this.isToggleModeEnabled()){var i=BX.Landing.UI.Panel.ContentEdit;if(i.showedPanel){i.showedPanel.hide()}var a=this.getViewWrapper();l.Dom.style(a,"transition","400ms margin ease");setTimeout(function(){l.Dom.style(a,"margin-left","880px")})}return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"show",this).call(this,n)}},{key:"hide",value:function e(){var n=this;var i=this.getViewWrapper();if(this.isToggleModeEnabled()){l.Dom.style(i,"margin-left",null)}return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"hide",this).call(this).then(function(){if(n.isToggleModeEnabled()){l.Dom.style(i,"transition",null)}})}},{key:"enableTransparentMode",value:function e(){l.Dom.addClass(this.layout,"landing-ui-panel-mode-transparent")}},{key:"disableTransparentMode",value:function e(){l.Dom.removeClass(this.layout,"landing-ui-panel-mode-transparent")}},{key:"setCategories",value:function e(t){this.cache.set("categories",t);this.cache.delete("renderedPresets")}},{key:"getCategories",value:function e(){return this.cache.get("categories")}},{key:"setPresets",value:function e(t){var n=this;t.forEach(function(e){e.unsubscribe("onClick",n.onPresetClick);e.subscribe("onClick",n.onPresetClick)});this.cache.set("presets",t);this.cache.delete("renderedPresets")}},{key:"getPresets",value:function e(){return this.cache.get("presets")}},{key:"setSidebarButtons",value:function e(t){var n=this;t.forEach(function(e){e.subscribe("onClick",n.onSidebarButtonClick)});this.cache.set("sidebarButtons",t)}},{key:"getSidebarButtons",value:function e(){return this.cache.get("sidebarButtons")}},{key:"onPresetFieldClick",value:function e(){var t=this;this.clear();this.enableTransparentMode();this.getCategories().forEach(function(e){var n=t.getPresets().filter(function(t){return t.options.category===e.options.id});e.setPresets(n);l.Dom.append(e.getLayout(),t.content)})}},{key:"onPresetClick",value:function e(t){this.disableTransparentMode();this.applyPreset(t.getTarget())}},{key:"activatePreset",value:function e(t){var n=this.getPresets().find(function(e){return e.options.id===t});var i=this.getPresetField();i.setLinkText(n.options.title);i.setIcon(n.options.icon);n.activate()}},{key:"applyPreset",value:function e(t){var n=this;this.clear();var i=this.getPresetField();i.setLinkText(t.options.title);i.setIcon(t.options.icon);var a=this.getSidebarButtons().filter(function(e){return t.options.items.includes(e.id)});a.forEach(function(e){e.deactivate();n.appendSidebarButton(e)});if(l.Type.isStringFilled(t.options.defaultSection)){var r=a.find(function(e){return e.id===t.options.defaultSection});if(r){r.activate();r.layout.click()}}else{var s=babelHelpers.slicedToArray(a,1),o=s[0];o.activate();o.layout.click()}}}]);return t}(t.Content);e.BasePresetPanel=E;e.PresetCategory=v;e.Preset=B;e.ContentWrapper=H})(this.BX.Landing.UI.Panel=this.BX.Landing.UI.Panel||{},BX.Landing.UI.Panel,BX.Landing.UI.Button,BX.Landing.UI.Field,BX.Landing,BX.Landing.UI.Button,BX.Landing,BX.Event,BX,BX.Landing.UI.Card,BX.Landing.UI.Card,BX.Landing.UI.Form,BX.Landing.Collection,BX.Landing.UI.Form);
//# sourceMappingURL=basepresetpanel.bundle.map.js