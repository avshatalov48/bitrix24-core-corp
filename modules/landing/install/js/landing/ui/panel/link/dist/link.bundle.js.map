{"version":3,"file":"link.bundle.js","sources":["../src/link.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {Content} from 'landing.ui.panel.content';\n\nexport class Link extends Content\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.instance = null;\n\n\t\tthis.attr = BX.Landing.Utils.attr;\n\t\tthis.join = BX.Landing.Utils.join;\n\t\tthis.random = BX.Landing.Utils.random;\n\t\tthis.setTextContent = BX.Landing.Utils.setTextContent;\n\t\tthis.isPlainObject = BX.Landing.Utils.isPlainObject;\n\t\tthis.isString = BX.Landing.Utils.isString;\n\t\tthis.textToPlaceholders = BX.Landing.Utils.textToPlaceholders;\n\t\tthis.findParent = BX.Landing.Utils.findParent;\n\t\tthis.escapeText = BX.Landing.Utils.escapeText;\n\n\t\tBX.Landing.UI.Panel.Content.apply(this, arguments);\n\t\tthis.layout.classList.add(\"landing-ui-panel-link\");\n\t\tthis.overlay.classList.add(\"landing-ui-panel-link\");\n\n\t\tthis.appendFooterButton(\n\t\t\tnew BX.Landing.UI.Button.BaseButton(\"save_block_content\", {\n\t\t\t\ttext: BX.Landing.Loc.getMessage(\"BLOCK_SAVE\"),\n\t\t\t\tonClick: this.save.bind(this),\n\t\t\t\tclassName: \"landing-ui-button-content-save\"\n\t\t\t})\n\t\t);\n\t\tthis.appendFooterButton(\n\t\t\tnew BX.Landing.UI.Button.BaseButton(\"cancel_block_content\", {\n\t\t\t\ttext: BX.Landing.Loc.getMessage(\"BLOCK_CANCEL\"),\n\t\t\t\tonClick: this.hide.bind(this),\n\t\t\t\tclassName: \"landing-ui-button-content-cancel\"\n\t\t\t})\n\t\t);\n\n\t\tdocument.body.appendChild(this.layout);\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new BX.Landing.UI.Panel.Link(\"link_panel\", {\n\t\t\t\ttitle: BX.Landing.Loc.getMessage(\"LANDING_EDIT_LINK\")\n\t\t\t});\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tshow(node)\n\t{\n\t\tvar form;\n\n\t\tthis.title.innerHTML = BX.Landing.Loc.getMessage(\"LANDING_EDIT_LINK\");\n\n\t\tif (!!node && node instanceof BX.Landing.Block.Node.Link)\n\t\t{\n\t\t\tthis.node = node;\n\t\t\tform = new BX.Landing.UI.Form.BaseForm({title: this.node.manifest.name});\n\t\t\tthis.field = this.node.getField();\n\t\t\tform.addField(this.field);\n\n\t\t\tthis.clear();\n\t\t\tthis.appendForm(form);\n\t\t\tBX.Landing.UI.Panel.Content.show.call(this);\n\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t}\n\n\t\tif (!!node && (node instanceof BX.Landing.Block.Node.Text || node instanceof BX.Landing.UI.Field.Text))\n\t\t{\n\t\t\tthis.range = document.getSelection().getRangeAt(0);\n\t\t\tthis.node = node;\n\t\t\tthis.textField = BX.Landing.UI.Field.BaseField.currentField;\n\n\t\t\tif (!!this.textField && this.textField.isEditable())\n\t\t\t{\n\t\t\t\tthis.node = this.textField;\n\t\t\t}\n\n\t\t\tvar link = this.range.cloneContents().querySelector(\"a\");\n\n\t\t\tif (!link)\n\t\t\t{\n\t\t\t\tlink = this.findParent(this.range.startContainer, {tagName: \"A\"});\n\t\t\t}\n\n\t\t\tvar href = \"\";\n\t\t\tvar target = \"\";\n\n\t\t\tif (link)\n\t\t\t{\n\t\t\t\thref = link.getAttribute(\"href\");\n\t\t\t\ttarget = link.getAttribute(\"target\") || \"_self\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.title.innerHTML = BX.Landing.Loc.getMessage(\"LANDING_CREATE_LINK\");\n\t\t\t}\n\n\t\t\tform = new BX.Landing.UI.Form.BaseForm({title: \"\"});\n\t\t\tBX.remove(form.header);\n\n\t\t\tvar allowedTypes = [\n\t\t\t\tBX.Landing.UI.Field.LinkURL.TYPE_BLOCK,\n\t\t\t\tBX.Landing.UI.Field.LinkURL.TYPE_PAGE\n\t\t\t];\n\n\t\t\tif (BX.Landing.Main.getInstance().options.params.type === 'STORE')\n\t\t\t{\n\t\t\t\tallowedTypes.push(BX.Landing.UI.Field.LinkURL.TYPE_CATALOG);\n\t\t\t}\n\n\t\t\tthis.field = new BX.Landing.UI.Field.Link({\n\t\t\t\ttitle: BX.Landing.Loc.getMessage(\"FIELD_LINK_TEXT_LABEL\"),\n\t\t\t\tcontent: {\n\t\t\t\t\ttext: this.textToPlaceholders(this.escapeText(link ? link.innerText : this.range.toString())),\n\t\t\t\t\thref: this.escapeText(href),\n\t\t\t\t\ttarget: this.escapeText(target)\n\t\t\t\t},\n\t\t\t\toptions: {\n\t\t\t\t\tsiteId: BX.Landing.Main.getInstance().options.site_id,\n\t\t\t\t\tlandingId: BX.Landing.Main.getInstance().id,\n\t\t\t\t\tfilter: {\n\t\t\t\t\t\t'=TYPE': BX.Landing.Main.getInstance().options.params.type\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tallowedTypes: allowedTypes\n\t\t\t});\n\t\t\tform.addField(this.field);\n\n\t\t\tthis.clear();\n\t\t\tthis.appendForm(form);\n\t\t\tBX.Landing.UI.Panel.Content.show.call(this);\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tif (this.field.isChanged())\n\t\t{\n\t\t\tif (!!this.node && this.node instanceof BX.Landing.Block.Node.Link)\n\t\t\t{\n\t\t\t\tthis.node.setValue(this.field.getValue());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvar value = this.field.getValue();\n\t\t\t\tdocument.getSelection().removeAllRanges();\n\t\t\t\tdocument.getSelection().addRange(this.range);\n\t\t\t\tthis.node.enableEdit();\n\n\t\t\t\tvar tmpHref = this.escapeText(this.join(value.href, this.random()));\n\t\t\t\tvar selection = document.getSelection();\n\n\t\t\t\tdocument.execCommand(\"createLink\", false, tmpHref);\n\n\t\t\t\tvar link = selection.anchorNode\n\t\t\t\t\t.parentElement\n\t\t\t\t\t.parentElement\n\t\t\t\t\t.parentElement\n\t\t\t\t\t.querySelector(this.join(\"[href=\\\"\", tmpHref, \"\\\"]\"));\n\n\t\t\t\tif (link)\n\t\t\t\t{\n\t\t\t\t\tthis.attr(link, \"href\", value.href);\n\t\t\t\t\tthis.attr(link, \"target\", value.target);\n\n\t\t\t\t\tif (this.isString(value.text))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (value.text.includes(\"{{name}}\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.field.hrefInput.getPlaceholderData(value.href)\n\t\t\t\t\t\t\t\t.then(function(placeholdersData) {\n\t\t\t\t\t\t\t\t\tlink.innerHTML = value.text.replace(\n\t\t\t\t\t\t\t\t\t\tnew RegExp(\"{{name}}\"),\n\t\t\t\t\t\t\t\t\t\t\"<span data-placeholder=\\\"name\\\">\"+placeholdersData.name+\"</span>\"\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}.bind(this));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setTextContent(link, value.text);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.isPlainObject(value.attrs))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.attr(link, value.attrs);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.hide();\n\t}\n}"],"names":["Link","Content","constructor","instance","attr","BX","Landing","Utils","join","random","setTextContent","isPlainObject","isString","textToPlaceholders","findParent","escapeText","UI","Panel","apply","arguments","layout","classList","add","overlay","appendFooterButton","Button","BaseButton","text","Loc","getMessage","onClick","save","bind","className","hide","document","body","appendChild","getInstance","title","show","node","form","innerHTML","Block","Node","Form","BaseForm","manifest","name","field","getField","addField","clear","appendForm","call","EditorPanel","Text","Field","range","getSelection","getRangeAt","textField","BaseField","currentField","isEditable","link","cloneContents","querySelector","startContainer","tagName","href","target","getAttribute","remove","header","allowedTypes","LinkURL","TYPE_BLOCK","TYPE_PAGE","Main","options","params","type","push","TYPE_CATALOG","content","innerText","toString","siteId","site_id","landingId","id","filter","isChanged","setValue","getValue","value","removeAllRanges","addRange","enableEdit","tmpHref","selection","execCommand","anchorNode","parentElement","includes","hrefInput","getPlaceholderData","then","placeholdersData","replace","RegExp","attrs"],"mappings":"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"}