{"version":3,"file":"stylepanel.bundle.js","sources":["../src/stylepanel.js"],"sourcesContent":["import {Cache, Dom, Runtime, Text} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {Content} from 'landing.ui.panel.content';\nimport {Loc} from 'landing.loc';\nimport {PageObject} from 'landing.pageobject';\nimport './css/style.css';\n\nconst showPseudoContent = Symbol('showPseudoContent');\nconst hidePseudoContent = Symbol('hidePseudoContent');\nconst disableEditorPointerEvents = Symbol('disableEditorPointerEvents');\nconst enableEditorPointerEvents = Symbol('enableEditorPointerEvents');\n\n/**\n * @memberOf BX.Landing.UI.Panel\n */\nexport class StylePanel extends Content\n{\n\tshouldAdjustTopPanelControls = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.StylePanel');\n\n\t\tthis.setTitle(Loc.getMessage('LANDING_DESIGN_PANEL_HEADER'));\n\t\tthis.pseudoContent = Runtime.clone(this.content);\n\t\tthis.loader = new Loader({\n\t\t\ttarget: this.pseudoContent,\n\t\t\toffset: {top: '-10%'},\n\t\t});\n\t\tthis.lsCache = new Cache.LocalStorageCache();\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.switcher = this.getSwitcher();\n\n\t\tDom.addClass(this.layout, 'landing-ui-panel-style');\n\t\tDom.addClass(this.overlay, 'landing-ui-panel-style-overlay');\n\t\tDom.attr(this.layout, 'hidden', 'true');\n\n\t\tDom.clean(this.pseudoContent);\n\t\tDom.style(this.pseudoContent, 'margin-left', '20px');\n\t\tDom.append(this.pseudoContent, this.body);\n\n\t\tDom.append(this.switcher.layout, this.footer);\n\t\tDom.prepend(this.layout, this.getViewContainer());\n\n\t\tif (window.localStorage)\n\t\t{\n\t\t\tconst state = window.localStorage.getItem('selectGroup') === 'true';\n\t\t\tthis.lsCache.set('selectGroup', state.toString());\n\t\t}\n\t}\n\n\tstatic getInstance(): StylePanel\n\t{\n\t\tconst rootWindow = PageObject.getRootWindow();\n\n\t\tif (!rootWindow.BX.Landing.UI.Panel.StylePanel.instance && !StylePanel.instance)\n\t\t{\n\t\t\trootWindow.BX.Landing.UI.Panel.StylePanel.instance = new StylePanel();\n\t\t}\n\n\t\treturn (rootWindow.BX.Landing.UI.Panel.StylePanel.instance || StylePanel.instance);\n\t}\n\n\tgetSwitcher(): BX.Landing.UI.Field.Switch\n\t{\n\t\treturn this.cache.remember('switcher', () => {\n\t\t\treturn new BX.Landing.UI.Field.Switch({\n\t\t\t\ttitle: Loc.getMessage('LANDING_STYLE_PANEL_SELECT_GROUP_SWITCH'),\n\t\t\t\tonValueChange: () => {\n\t\t\t\t\tif (window.localStorage)\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.localStorage.setItem('selectGroup', this.switcher.getValue().toString());\n\t\t\t\t\t}\n\t\t\t\t\tthis.lsCache.set('selectGroup', this.switcher.getValue().toString());\n\t\t\t\t},\n\t\t\t\tvalue: Text.toBoolean(this.lsCache.get('selectGroup')),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetViewContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('viewContainer', () => {\n\t\t\treturn PageObject.getRootWindow().document.querySelector('.landing-ui-view-container');\n\t\t});\n\t}\n\n\tgetViewWrapper(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('viewWrapper', () => {\n\t\t\treturn this.getViewContainer().querySelector('.landing-ui-view-wrapper');\n\t\t});\n\t}\n\n\t[showPseudoContent]()\n\t{\n\t\tDom.attr(this.content, 'hidden', true);\n\t\tDom.attr(this.pseudoContent, 'hidden', null);\n\t}\n\n\t[hidePseudoContent]()\n\t{\n\t\tDom.attr(this.content, 'hidden', null);\n\t\tDom.attr(this.pseudoContent, 'hidden', true);\n\t}\n\n\tstatic [enableEditorPointerEvents]()\n\t{\n\t\tDom.style(document.body, 'pointer-events', null);\n\t}\n\n\tstatic [disableEditorPointerEvents]()\n\t{\n\t\tDom.style(document.body, 'pointer-events', 'none');\n\t}\n\n\tshow(): Promise<StylePanel>\n\t{\n\t\tthis[showPseudoContent]();\n\t\tStylePanel[disableEditorPointerEvents]();\n\n\t\treturn super.show()\n\t\t\t.then(() => {\n\t\t\t\tthis.loader.show();\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis[hidePseudoContent]();\n\t\t\t\t\tStylePanel[enableEditorPointerEvents]();\n\t\t\t\t}, 300);\n\n\t\t\t\tDom.style(this.getViewWrapper(), 'width', 'calc(100% - 320px)');\n\t\t\t\tDom.addClass(document.body, 'landing-ui-collapsed');\n\n\t\t\t\tBX.onCustomEvent('BX.Landing.Style:enable', []);\n\t\t\t\tthis.emit('enable', {panel: this});\n\n\t\t\t\treturn this;\n\t\t\t});\n\t}\n\n\thide(): Promise<StylePanel>\n\t{\n\t\tStylePanel[disableEditorPointerEvents]();\n\t\tDom.style(this.getViewWrapper(), 'width', null);\n\n\t\treturn super.hide()\n\t\t\t.then(() => {\n\t\t\t\tStylePanel[enableEditorPointerEvents]();\n\t\t\t\tDom.addClass(document.body, 'landing-ui-collapsed');\n\n\t\t\t\tBX.onCustomEvent('BX.Landing.Style:disable', []);\n\t\t\t\tthis.emit('disable', {panel: this});\n\n\t\t\t\treturn this;\n\t\t\t});\n\t}\n}"],"names":["showPseudoContent","Symbol","hidePseudoContent","disableEditorPointerEvents","enableEditorPointerEvents","StylePanel","options","setEventNamespace","setTitle","Loc","getMessage","pseudoContent","Runtime","clone","content","loader","Loader","target","offset","top","lsCache","Cache","LocalStorageCache","cache","MemoryCache","switcher","getSwitcher","Dom","addClass","layout","overlay","attr","clean","style","append","body","footer","prepend","getViewContainer","window","localStorage","state","getItem","set","toString","remember","BX","Landing","UI","Field","Switch","title","onValueChange","setItem","getValue","value","Text","toBoolean","get","PageObject","getRootWindow","document","querySelector","then","show","setTimeout","getViewWrapper","onCustomEvent","emit","panel","rootWindow","Panel","instance","Content"],"mappings":"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"}