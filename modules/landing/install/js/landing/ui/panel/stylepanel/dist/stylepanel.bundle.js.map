{"version":3,"file":"stylepanel.bundle.js","sources":["../src/stylepanel.js"],"sourcesContent":["import {Cache, Dom, Runtime, Text} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {Content} from 'landing.ui.panel.content';\nimport {Loc} from 'landing.loc';\nimport {PageObject} from 'landing.pageobject';\n\nimport 'ui.fonts.opensans';\nimport './css/style.css';\n\nconst showPseudoContent = Symbol('showPseudoContent');\nconst hidePseudoContent = Symbol('hidePseudoContent');\nconst disableEditorPointerEvents = Symbol('disableEditorPointerEvents');\nconst enableEditorPointerEvents = Symbol('enableEditorPointerEvents');\n\n/**\n * @memberOf BX.Landing.UI.Panel\n */\nexport class StylePanel extends Content\n{\n\tshouldAdjustTopPanelControls = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.StylePanel');\n\n\t\tthis.setTitle(Loc.getMessage('LANDING_DESIGN_PANEL_HEADER'));\n\t\tthis.pseudoContent = Runtime.clone(this.content);\n\t\tthis.loader = new Loader({\n\t\t\ttarget: this.pseudoContent,\n\t\t\toffset: {top: '-10%'},\n\t\t});\n\t\tthis.lsCache = new Cache.LocalStorageCache();\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.switcher = this.getSwitcher();\n\n\t\tDom.addClass(this.layout, 'landing-ui-panel-style');\n\t\tDom.addClass(this.overlay, 'landing-ui-panel-style-overlay');\n\t\tDom.attr(this.layout, 'hidden', 'true');\n\n\t\tDom.clean(this.pseudoContent);\n\t\tDom.style(this.pseudoContent, 'margin-left', '20px');\n\t\tDom.append(this.pseudoContent, this.body);\n\n\t\tDom.append(this.switcher.layout, this.footer);\n\t\tDom.prepend(this.layout, this.getViewContainer());\n\n\t\tif (window.localStorage)\n\t\t{\n\t\t\tconst state = window.localStorage.getItem('selectGroup') === 'true';\n\t\t\tthis.lsCache.set('selectGroup', state.toString());\n\t\t}\n\t}\n\n\tstatic getInstance(): StylePanel\n\t{\n\t\tconst rootWindow = PageObject.getRootWindow();\n\n\t\tif (!rootWindow.BX.Landing.UI.Panel.StylePanel.instance && !StylePanel.instance)\n\t\t{\n\t\t\trootWindow.BX.Landing.UI.Panel.StylePanel.instance = new StylePanel();\n\t\t}\n\n\t\treturn (rootWindow.BX.Landing.UI.Panel.StylePanel.instance || StylePanel.instance);\n\t}\n\n\tgetSwitcher(): BX.Landing.UI.Field.Switch\n\t{\n\t\treturn this.cache.remember('switcher', () => {\n\t\t\treturn new BX.Landing.UI.Field.Switch({\n\t\t\t\ttitle: Loc.getMessage('LANDING_STYLE_PANEL_SELECT_GROUP_SWITCH'),\n\t\t\t\tonValueChange: () => {\n\t\t\t\t\tif (window.localStorage)\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.localStorage.setItem('selectGroup', this.switcher.getValue().toString());\n\t\t\t\t\t}\n\t\t\t\t\tthis.lsCache.set('selectGroup', this.switcher.getValue().toString());\n\t\t\t\t},\n\t\t\t\tvalue: Text.toBoolean(this.lsCache.get('selectGroup')),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetViewContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('viewContainer', () => {\n\t\t\treturn PageObject.getRootWindow().document.querySelector('.landing-ui-view-container');\n\t\t});\n\t}\n\n\tgetViewWrapper(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('viewWrapper', () => {\n\t\t\treturn this.getViewContainer().querySelector('.landing-ui-view-wrapper');\n\t\t});\n\t}\n\n\t[showPseudoContent]()\n\t{\n\t\tDom.attr(this.content, 'hidden', true);\n\t\tDom.attr(this.pseudoContent, 'hidden', null);\n\t}\n\n\t[hidePseudoContent]()\n\t{\n\t\tDom.attr(this.content, 'hidden', null);\n\t\tDom.attr(this.pseudoContent, 'hidden', true);\n\t}\n\n\tstatic [enableEditorPointerEvents]()\n\t{\n\t\tDom.style(document.body, 'pointer-events', null);\n\t}\n\n\tstatic [disableEditorPointerEvents]()\n\t{\n\t\tDom.style(document.body, 'pointer-events', 'none');\n\t}\n\n\tshow(formMode): Promise<StylePanel>\n\t{\n\t\tthis[showPseudoContent]();\n\t\tStylePanel[disableEditorPointerEvents]();\n\n\t\tif (formMode)\n\t\t{\n\t\t\tif (!Dom.hasClass(this.layout, 'landing-ui-style-form-mode'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.layout, 'landing-ui-style-form-mode');\n\n\t\t\t\tDom.style(this.overlay, {\n\t\t\t\t\t'z-index': 9998,\n\t\t\t\t\twidth: '880px',\n\t\t\t\t});\n\t\t\t\tDom.insertAfter(this.overlay, this.layout);\n\t\t\t\tDom.removeClass(this.overlay, 'landing-ui-panel-style-overlay');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.remove(this.overlay);\n\t\t\tDom.addClass(this.overlay, 'landing-ui-panel-style-overlay');\n\t\t\tDom.removeClass(this.layout, 'landing-ui-style-form-mode');\n\t\t}\n\n\t\treturn super.show()\n\t\t\t.then(() => {\n\t\t\t\tthis.loader.show();\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis[hidePseudoContent]();\n\t\t\t\t\tStylePanel[enableEditorPointerEvents]();\n\t\t\t\t}, 300);\n\n\t\t\t\tif (!formMode)\n\t\t\t\t{\n\t\t\t\t\tDom.style(this.getViewWrapper(), 'width', 'calc(100% - 320px)');\n\t\t\t\t\tDom.addClass(document.body, 'landing-ui-collapsed');\n\t\t\t\t}\n\n\t\t\t\tBX.onCustomEvent('BX.Landing.Style:enable', []);\n\t\t\t\tthis.emit('enable', {panel: this});\n\n\t\t\t\treturn this;\n\t\t\t});\n\t}\n\n\thide(): Promise<StylePanel>\n\t{\n\t\tStylePanel[disableEditorPointerEvents]();\n\t\tDom.style(this.getViewWrapper(), 'width', null);\n\n\t\treturn super.hide()\n\t\t\t.then(() => {\n\t\t\t\tStylePanel[enableEditorPointerEvents]();\n\t\t\t\tDom.addClass(document.body, 'landing-ui-collapsed');\n\n\t\t\t\tBX.onCustomEvent('BX.Landing.Style:disable', []);\n\t\t\t\tthis.emit('disable', {panel: this});\n\n\t\t\t\treturn this;\n\t\t\t});\n\t}\n}"],"names":["showPseudoContent","Symbol","hidePseudoContent","disableEditorPointerEvents","enableEditorPointerEvents","StylePanel","options","setEventNamespace","setTitle","Loc","getMessage","pseudoContent","Runtime","clone","content","loader","Loader","target","offset","top","lsCache","Cache","LocalStorageCache","cache","MemoryCache","switcher","getSwitcher","Dom","addClass","layout","overlay","attr","clean","style","append","body","footer","prepend","getViewContainer","window","localStorage","state","getItem","set","toString","remember","BX","Landing","UI","Field","Switch","title","onValueChange","setItem","getValue","value","Text","toBoolean","get","PageObject","getRootWindow","document","querySelector","formMode","hasClass","width","insertAfter","removeClass","remove","then","show","setTimeout","getViewWrapper","onCustomEvent","emit","panel","rootWindow","Panel","instance","Content"],"mappings":"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"}