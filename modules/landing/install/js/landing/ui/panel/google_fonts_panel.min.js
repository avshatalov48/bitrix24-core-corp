(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var e=BX.Landing.Utils.addClass;var n=BX.Landing.Utils.proxy;var t=BX.Landing.Utils.append;var i=BX.Landing.Utils.slice;var a=BX.Landing.Utils.clone;var s=BX.Landing.Utils.bind;var o=["A red flare silhouetted the jagged edge of a wing","I watched the storm, so beautiful yet terrific","Almost before we knew it, we had left the ground","Waves flung themselves at the blue evening","A shining crescent far beneath the flying vessel"];var r=["&#x0423;&#x0442;&#x0440;&#x0435;&#x043D;&#x043D;&#x0435;&#x0435; &#x0441;&#x043E;&#x043B;&#x043D;&#x0446;&#x0435; &#x044F;&#x0440;&#x043A;&#x043E; &#x043E;&#x0441;&#x0432;&#x0435;&#x0442;&#x0438;&#x043B;&#x043E; &#x043F;&#x043E;&#x043B;&#x044F;&#x043D;&#x0443; &#x0438; &#x043B;&#x0435;&#x0441;","&#x041F;&#x0440;&#x0438;&#x043B;&#x0435;&#x0442;&#x0435;&#x0432;&#x0448;&#x0438;&#x0435; &#x043F;&#x0442;&#x0438;&#x0446;&#x044B; &#x0437;&#x0430;&#x043D;&#x044F;&#x043B;&#x0438; &#x0432;&#x0435;&#x0441;&#x044C; &#x0441;&#x043A;&#x0430;&#x043B;&#x0438;&#x0441;&#x0442;&#x044B;&#x0439; &#x0431;&#x0435;&#x0440;&#x0435;&#x0433;","&#x0411;&#x043E;&#x0434;&#x0440;&#x044F;&#x0449;&#x0438;&#x0439; &#x043C;&#x043E;&#x0440;&#x0441;&#x043A;&#x043E;&#x0439; &#x0432;&#x043E;&#x0437;&#x0434;&#x0443;&#x0445; &#x0431;&#x044B;&#x043B; &#x043F;&#x0440;&#x043E;&#x0445;&#x043B;&#x0430;&#x0434;&#x0435;&#x043D; &#x0438; &#x0441;&#x0432;&#x0435;&#x0436;","&#x042D;&#x0442;&#x043E; &#x043B;&#x0443;&#x0447;&#x0448;&#x0435;&#x0435;, &#x0447;&#x0442;&#x043E; &#x043C;&#x043E;&#x0433;&#x043B;&#x043E; &#x0441; &#x043D;&#x0438;&#x043C; &#x043F;&#x0440;&#x043E;&#x0438;&#x0437;&#x043E;&#x0439;&#x0442;&#x0438; &#x0432; &#x043D;&#x043E;&#x0432;&#x043E;&#x043C; &#x0433;&#x043E;&#x0440;&#x043E;&#x0434;&#x0435;","&#x041D;&#x043E;&#x0432;&#x0430;&#x044F; &#x043A;&#x043D;&#x0438;&#x0433;&#x0430; &#x043E;&#x043A;&#x0430;&#x0437;&#x0430;&#x043B;&#x0430;&#x0441;&#x044C; &#x0438;&#x043D;&#x0442;&#x0435;&#x0440;&#x0435;&#x0441;&#x043D;&#x043E;&#x0439; &#x0438; &#x043F;&#x043E;&#x0437;&#x043D;&#x0430;&#x0432;&#x0430;&#x0442;&#x0435;&#x043B;&#x044C;&#x043D;&#x043E;&#x0439;"];var x="&#1576;&#1591;&#1575;&#1576;&#1593; &#1571;&#1581;&#1605;&#1585; &#1575;&#1585;&#1578;&#1587;&#1605;&#1578; &#1589;&#1608;&#1585;&#1577; &#1592;&#1604;&#1610;&#1617;&#1577; &#1604;&#1581;&#1583;&#1608;&#1583; &#1575;&#1604;&#1580;&#1606;&#1575;&#1581; &#1575;&#1604;&#1605;&#1587;&#1606;&#1606;&#1577;.";var l="&#1492;&#1496;&#1489;&#1506; &#1492;&#1488;&#1495;&#1491; &#1513;&#1500;&#1497; &#1493;&#1492;&#1496;&#1489;&#1506; &#1492;&#1488;&#1495;&#1512; &#1495;&#1500;&#1511;&#1493; &#1494;&#1497;&#1499;&#1512;&#1493;&#1503; &#1502;&#1513;&#1493;&#1514;&#1507;.";var g="&#45208;&#45716; &#54253;&#54413;&#51012; &#51648;&#53020;&#48372;&#50520;&#45796;. &#45320;&#47924;&#45208; &#50500;&#47492;&#45796;&#50864;&#47732;&#49436;&#46020; &#50628;&#52397;&#45212; &#54253;&#54413;&#51012;.";BX.Landing.UI.Panel.GoogleFonts=function(){BX.Landing.UI.Panel.Content.apply(this,["google-fonts-panel",{title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_TITLE")}]);this.pangramIndex=-1;e(this.layout,"landing-ui-panel-google-fonts");e(this.overlay,"landing-ui-panel-google-fonts-overlay");this.client=new BX.Landing.Client.GoogleFonts;var n=BX.Landing.PageObject.getRootWindow();var i=n.document.body.querySelector(".landing-ui-view-container");t(this.layout,i);t(this.overlay,i);this.categoryForm=this.createCategoryForm();this.languageForm=this.createLanguageForm();t(this.categoryForm.layout,this.sidebar);t(this.languageForm.layout,this.sidebar)};BX.Landing.UI.Panel.GoogleFonts.getInstance=function(){return BX.Landing.UI.Panel.GoogleFonts.instance||(BX.Landing.UI.Panel.GoogleFonts.instance=new BX.Landing.UI.Panel.GoogleFonts)};BX.Landing.UI.Panel.GoogleFonts.prototype={constructor:BX.Landing.UI.Panel.GoogleFonts,__proto__:BX.Landing.UI.Panel.Content.prototype,superclass:BX.Landing.UI.Panel.Content.prototype,show:function(){var e=this.superclass.show.call(this);if(this.isFontsLoaded()){return e.then(n(this.saveResolver,this))}return e.then(n(this.showLoader,this)).then(n(this.getFonts,this)).then(n(this.loadFonts,this)).then(n(this.renderList,this)).then(n(this.hideLoader,this)).then(n(this.saveResolver,this))},saveResolver:function(){var e=this;return new Promise(function(n){e.resolver=n})},getFonts:function(){if(this.response){return Promise.resolve(this.response)}return this.client.getList().then(n(this.saveResponse,this))},saveResponse:function(e){return this.response=e},isFontsLoaded:function(){return!!this.response},showLoader:function(){if(!this.loader){this.loader=new BX.Loader({target:this.content})}this.loader.show();return Promise.resolve()},hideLoader:function(){if(this.loader){this.loader.hide()}return Promise.resolve()},loadFonts:function(e){return new Promise(function(n){WebFont.load({google:{families:e.map(function(e){return e.family.replace(/ /g,"+")})},context:top,classes:false,active:function(){var t=BX.Landing.PageObject.getRootWindow();if(t.document.fonts){t.document.fonts.ready.then(function(){n(e)})}else{setTimeout(n,3e3,e)}}})})},applyFilter:function(e){var n=this.languageForm.fields[0].getValue();var t=this.categoryForm.fields[0].getValue();return e.filter(function(e){return n.every(function(n){return e.subsets.indexOf(n)!==-1})&&t.some(function(n){return n===e.category})})},createListItem:function(e){var n=this.languageForm.fields[0].getValue();var t="";var i="ltr";this.pangramIndex+=1;this.pangramIndex=this.pangramIndex>4?0:this.pangramIndex;if(n.includes("latin")){t=o[this.pangramIndex]}if(n.includes("cyrillic")){t=r[this.pangramIndex]}if(n.includes("arabic")){i="rtl";t=x}if(n.includes("hebrew")){i="rtl";t=l}if(n.includes("korean")){t=g}return'<div class="landing-ui-font-preview">'+'<div class="landing-ui-font-preview-font-name">'+e.family+"</div>"+'<div class="landing-ui-font-preview-font-button">'+'<span class="ui-btn ui-btn-xs ui-btn-light-border ui-btn-round">'+BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_SELECT_BUTTON")+"</span>"+"</div>"+'<div style="font-family: '+e.family+"; direction: "+i+';" class="landing-ui-font-preview-pangram" contenteditable="true">'+t+"</div>"+"</div>"},onFilterChange:function(){this.renderList()},renderList:function(){return this.getFonts().then(n(this.applyFilter,this)).then(n(this.renderItems,this))},renderItems:function(e){this.content.innerHTML=e.map(this.createListItem,this).join("");i(this.content.children).forEach(this.initItem(e),this)},initItem:function(e){return function(n,t){var i=n.querySelector(".landing-ui-font-preview-font-button");s(i,"click",this.onFontSelect.bind(this,e[t]))}},getListItems:function(){return i(this.content.querySelectorAll(".landing-ui-font-preview.cell"))},createLanguageForm:function(){var e=new BX.Landing.UI.Form.StyleForm({title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_FORM_TITLE")});var t=new BX.Landing.UI.Factory.FieldFactory({onValueChange:n(this.onFilterChange,this)});var i=window.location.host.includes(".ru");e.addField(t.create({type:"radio",items:[{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_CYRILLIC"),value:"cyrillic",checked:i},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_LATIN"),value:"latin",checked:!i},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_ARABIC"),value:"arabic"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_HEBREW"),value:"hebrew"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_KOREAN"),value:"korean"}]}));return e},createCategoryForm:function(){var e=new BX.Landing.UI.Form.StyleForm({title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_FORM_TITLE")});var t=new BX.Landing.UI.Factory.FieldFactory({onValueChange:n(this.onFilterChange,this)});e.addField(t.create({type:"checkbox",items:[{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_SANS_SERIF"),value:"sans-serif",checked:true},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_SERIF"),value:"serif",checked:true},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_DISPLAY"),value:"display",checked:true},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_HANDWRITING"),value:"handwriting",checked:true},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_MONOSPACE"),value:"monospace",checked:true}]}));return e},onFontSelect:function(e){this.selectedFont=e;this.onApply()},onApply:function(){if(this.resolver){var e=a(this.selectedFont);e.subset=this.languageForm.fields[0].getValue();this.hide().then(this.resolver.bind(null,e))}},onCancel:function(){this.hide()}}})();
//# sourceMappingURL=google_fonts_panel.map.js