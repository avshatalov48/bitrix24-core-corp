{"version":3,"file":"callback.bundle.js","sources":["../src/callback.js"],"sourcesContent":["import {Text} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loc} from 'landing.loc';\nimport {ContentWrapper} from 'landing.ui.panel.basepresetpanel';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {HeaderCard} from 'landing.ui.card.headercard';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {MessageCard} from 'landing.ui.card.messagecard';\n\nexport default class Callback extends ContentWrapper\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.FormSettingsPanel.Callback');\n\n\t\tthis.addItem(this.getHeader());\n\n\t\tif (!this.isAvailable())\n\t\t{\n\t\t\tthis.addItem(this.getWarningMessage());\n\t\t\tthis.getSettingsForm().disable();\n\t\t}\n\n\t\tthis.addItem(this.getSettingsForm());\n\t}\n\n\tgetHeader(): HeaderCard\n\t{\n\t\treturn this.cache.remember('header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_TITLE'),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetWarningMessage()\n\t{\n\t\treturn this.cache.remember('warningMessage', () => {\n\t\t\treturn new MessageCard({\n\t\t\t\theader: Loc.getMessage('LANDING_FORM_CALLBACK_WARNING_HEADER'),\n\t\t\t\tdescription: Loc.getMessage('LANDING_FORM_CALLBACK_WARNING_TEXT'),\n\t\t\t\tangle: false,\n\t\t\t\tcloseable: false,\n\t\t\t\thideActions: true,\n\t\t\t\tcontext: 'warning',\n\t\t\t});\n\t\t});\n\t}\n\n\tisAvailable(): boolean\n\t{\n\t\treturn this.cache.remember('isAvailable', () => {\n\t\t\treturn this.options.dictionary.callback.from.length > 0;\n\t\t});\n\t}\n\n\tgetSettingsForm(): FormSettingsForm\n\t{\n\t\treturn this.cache.remember('settingsForm', () => {\n\t\t\treturn new FormSettingsForm({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_USE_CHECKBOX_LABEL'),\n\t\t\t\ttoggleable: true,\n\t\t\t\ttoggleableType: FormSettingsForm.ToggleableType.Switch,\n\t\t\t\topened: this.isAvailable() && Text.toBoolean(this.options.formOptions.callback.use),\n\t\t\t\tfields: [\n\t\t\t\t\tthis.getPhoneListField(),\n\t\t\t\t\tthis.getTextField(),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUseCheckboxField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('useCheckboxField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'use',\n\t\t\t\tcompact: true,\n\t\t\t\tvalue: [Text.toBoolean(this.options.formOptions.callback.use)],\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_USE_CHECKBOX_LABEL'), value: true},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPhoneListField(): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn this.cache.remember('phoneListField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\t\tselector: 'from',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_PHONE_TITLE'),\n\t\t\t\tcontent: this.options.formOptions.callback.from,\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_DEFAULT_PHONE_NOT_SELECTED'), value: ''},\n\t\t\t\t\t...this.options.dictionary.callback.from.map((item) => {\n\t\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTextField()\n\t{\n\t\treturn this.cache.remember('textField', () => {\n\t\t\treturn new TextField({\n\t\t\t\tselector: 'text',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_TEXT_TITLE'),\n\t\t\t\tcontent: this.options.formOptions.callback.text,\n\t\t\t\ttextOnly: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tvalueReducer(value: {[key: string]: any}): {[key: string]: any}\n\t{\n\t\treturn {\n\t\t\tcallback: {\n\t\t\t\t...value,\n\t\t\t\tuse: this.getSettingsForm().isOpened(),\n\t\t\t},\n\t\t};\n\t}\n\n\tonChange(event: BaseEvent)\n\t{\n\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t}\n}"],"names":["Callback","options","setEventNamespace","addItem","getHeader","isAvailable","getWarningMessage","getSettingsForm","disable","cache","remember","HeaderCard","title","Loc","getMessage","MessageCard","header","description","angle","closeable","hideActions","context","dictionary","callback","from","length","FormSettingsForm","toggleable","toggleableType","ToggleableType","Switch","opened","Text","toBoolean","formOptions","use","fields","getPhoneListField","getTextField","BX","Landing","UI","Field","Checkbox","selector","compact","value","items","name","Dropdown","content","map","item","id","TextField","text","textOnly","isOpened","event","emit","getData","skipPrepare","ContentWrapper"],"mappings":"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"}