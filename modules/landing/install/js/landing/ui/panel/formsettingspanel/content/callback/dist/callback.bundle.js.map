{"version":3,"file":"callback.bundle.js","sources":["../src/callback.js"],"sourcesContent":["import {Text} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loc} from 'landing.loc';\nimport {ContentWrapper} from 'landing.ui.panel.basepresetpanel';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {HeaderCard} from 'landing.ui.card.headercard';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {MessageCard} from 'landing.ui.card.messagecard';\n\nexport default class Callback extends ContentWrapper\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.FormSettingsPanel.Callback');\n\n\t\tthis.addItem(this.getHeader());\n\n\t\tif (!this.isAvailable())\n\t\t{\n\t\t\tthis.addItem(this.getWarningMessage());\n\t\t\tthis.getSettingsForm().disable();\n\t\t}\n\n\t\tthis.addItem(this.getSettingsForm());\n\t}\n\n\tgetHeader(): HeaderCard\n\t{\n\t\treturn this.cache.remember('header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_TITLE'),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetWarningMessage()\n\t{\n\t\treturn this.cache.remember('warningMessage', () => {\n\t\t\treturn new MessageCard({\n\t\t\t\theader: Loc.getMessage('LANDING_FORM_CALLBACK_WARNING_HEADER'),\n\t\t\t\tdescription: Loc.getMessage('LANDING_FORM_CALLBACK_WARNING_TEXT'),\n\t\t\t\tangle: false,\n\t\t\t\tcloseable: false,\n\t\t\t\thideActions: true,\n\t\t\t\tcontext: 'warning',\n\t\t\t});\n\t\t});\n\t}\n\n\tisAvailable(): boolean\n\t{\n\t\treturn this.cache.remember('isAvailable', () => {\n\t\t\treturn this.options.dictionary.callback.from.length > 0;\n\t\t});\n\t}\n\n\tgetSettingsForm(): FormSettingsForm\n\t{\n\t\treturn this.cache.remember('settingsForm', () => {\n\t\t\treturn new FormSettingsForm({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_USE_CHECKBOX_LABEL'),\n\t\t\t\ttoggleable: true,\n\t\t\t\ttoggleableType: FormSettingsForm.ToggleableType.Switch,\n\t\t\t\topened: this.isAvailable() && Text.toBoolean(this.options.formOptions.callback.use),\n\t\t\t\tfields: [\n\t\t\t\t\tthis.getPhoneListField(),\n\t\t\t\t\tthis.getTextField(),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUseCheckboxField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('useCheckboxField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'use',\n\t\t\t\tcompact: true,\n\t\t\t\tvalue: [Text.toBoolean(this.options.formOptions.callback.use)],\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_USE_CHECKBOX_LABEL'), value: true},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPhoneListField(): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn this.cache.remember('phoneListField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\t\tselector: 'from',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_PHONE_TITLE'),\n\t\t\t\tcontent: this.options.formOptions.callback.from,\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_DEFAULT_PHONE_NOT_SELECTED'), value: ''},\n\t\t\t\t\t...this.options.dictionary.callback.from.map((item) => {\n\t\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTextField()\n\t{\n\t\treturn this.cache.remember('textField', () => {\n\t\t\treturn new TextField({\n\t\t\t\tselector: 'text',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_TEXT_TITLE'),\n\t\t\t\tcontent: this.options.formOptions.callback.text,\n\t\t\t\ttextOnly: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tvalueReducer(value: {[key: string]: any}): {[key: string]: any}\n\t{\n\t\treturn {\n\t\t\tcallback: {\n\t\t\t\t...value,\n\t\t\t\tuse: this.getSettingsForm().isOpened(),\n\t\t\t},\n\t\t};\n\t}\n\n\tonChange(event: BaseEvent)\n\t{\n\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t}\n}"],"names":["Callback","options","setEventNamespace","addItem","getHeader","isAvailable","getWarningMessage","getSettingsForm","disable","cache","remember","HeaderCard","title","Loc","getMessage","MessageCard","header","description","angle","closeable","hideActions","context","dictionary","callback","from","length","FormSettingsForm","toggleable","toggleableType","ToggleableType","Switch","opened","Text","toBoolean","formOptions","use","fields","getPhoneListField","getTextField","BX","Landing","UI","Field","Checkbox","selector","compact","value","items","name","Dropdown","content","map","item","id","TextField","text","textOnly","isOpened","event","emit","getData","skipPrepare","ContentWrapper"],"mappings":"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"}