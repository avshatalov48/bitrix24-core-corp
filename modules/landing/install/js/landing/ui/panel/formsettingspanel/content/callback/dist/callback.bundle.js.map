{"version":3,"file":"callback.bundle.js","sources":["../src/callback.js"],"sourcesContent":["import {Text} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loc} from 'landing.loc';\nimport {ContentWrapper} from 'landing.ui.panel.basepresetpanel';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {HeaderCard} from 'landing.ui.card.headercard';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {MessageCard} from 'landing.ui.card.messagecard';\n\nexport default class Callback extends ContentWrapper\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.FormSettingsPanel.Callback');\n\n\t\tthis.addItem(this.getHeader());\n\n\t\tif (!this.isAvailable())\n\t\t{\n\t\t\tthis.addItem(this.getWarningMessage());\n\t\t\tthis.getSettingsForm().disable();\n\t\t}\n\n\t\tthis.addItem(this.getSettingsForm());\n\t}\n\n\tgetHeader(): HeaderCard\n\t{\n\t\treturn this.cache.remember('header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_TITLE'),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetWarningMessage()\n\t{\n\t\treturn this.cache.remember('warningMessage', () => {\n\t\t\treturn new MessageCard({\n\t\t\t\theader: Loc.getMessage('LANDING_FORM_CALLBACK_WARNING_HEADER'),\n\t\t\t\tdescription: Loc.getMessage('LANDING_FORM_CALLBACK_WARNING_TEXT'),\n\t\t\t\tangle: false,\n\t\t\t\tcloseable: false,\n\t\t\t\thideActions: true,\n\t\t\t\tcontext: 'warning',\n\t\t\t});\n\t\t});\n\t}\n\n\tisAvailable(): boolean\n\t{\n\t\treturn this.cache.remember('isAvailable', () => {\n\t\t\treturn this.options.dictionary.callback.from.length > 0;\n\t\t});\n\t}\n\n\tgetSettingsForm(): FormSettingsForm\n\t{\n\t\treturn this.cache.remember('settingsForm', () => {\n\t\t\treturn new FormSettingsForm({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_USE_CHECKBOX_LABEL'),\n\t\t\t\ttoggleable: true,\n\t\t\t\ttoggleableType: FormSettingsForm.ToggleableType.Switch,\n\t\t\t\topened: this.isAvailable() && Text.toBoolean(this.options.formOptions.callback.use),\n\t\t\t\tfields: [\n\t\t\t\t\tthis.getPhoneListField(),\n\t\t\t\t\tthis.getTextField(),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUseCheckboxField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('useCheckboxField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'use',\n\t\t\t\tcompact: true,\n\t\t\t\tvalue: [Text.toBoolean(this.options.formOptions.callback.use)],\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_USE_CHECKBOX_LABEL'), value: true},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPhoneListField(): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn this.cache.remember('phoneListField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\t\tselector: 'from',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_PHONE_TITLE'),\n\t\t\t\tcontent: this.options.formOptions.callback.from,\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_DEFAULT_PHONE_NOT_SELECTED'), value: ''},\n\t\t\t\t\t...this.options.dictionary.callback.from.map((item) => {\n\t\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTextField()\n\t{\n\t\treturn this.cache.remember('textField', () => {\n\t\t\treturn new TextField({\n\t\t\t\tselector: 'text',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CALLBACK_TEXT_TITLE'),\n\t\t\t\tcontent: this.options.formOptions.callback.text,\n\t\t\t\ttextOnly: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tvalueReducer(value: {[key: string]: any}): {[key: string]: any}\n\t{\n\t\treturn {\n\t\t\tcallback: {\n\t\t\t\t...value,\n\t\t\t\tuse: this.getSettingsForm().isOpened(),\n\t\t\t},\n\t\t};\n\t}\n\n\tonChange(event: BaseEvent)\n\t{\n\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t}\n}"],"names":["Callback","options","setEventNamespace","addItem","getHeader","isAvailable","getWarningMessage","getSettingsForm","disable","cache","remember","HeaderCard","title","Loc","getMessage","MessageCard","header","description","angle","closeable","hideActions","context","dictionary","callback","from","length","FormSettingsForm","toggleable","toggleableType","ToggleableType","Switch","opened","Text","toBoolean","formOptions","use","fields","getPhoneListField","getTextField","BX","Landing","UI","Field","Checkbox","selector","compact","value","items","name","Dropdown","content","map","item","id","TextField","text","textOnly","isOpened","event","emit","getData","skipPrepare","ContentWrapper"],"mappings":"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"}