{"version":3,"file":"crm.bundle.js","sources":["../src/internal/stagefield/stagefield.js","../src/images/message-icon.svg","../src/crm.js"],"sourcesContent":["import {BaseField} from 'landing.ui.field.basefield';\nimport {Loc} from 'landing.loc';\nimport {Dom, Tag, Type} from 'main.core';\n\nimport './css/style.css';\n\nconst fetchId = (item) => {\n\treturn !Type.isNil(item.ID) ? item.ID : item.id;\n};\n\nconst fetchName = (item) => {\n\treturn !Type.isNil(item.NAME) ? item.NAME : item.name;\n};\n\nexport default class StageField extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tDom.replace(this.input, this.getInner());\n\t}\n\n\tgetInner()\n\t{\n\t\treturn this.cache.remember('inner', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-field-stages\">\n\t\t\t\t\t${this.getCategoriesDropdown().getLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetCategoriesDropdown(): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn this.cache.remember('categoriesDropdown', () => {\n\t\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\t\ttitle: this.options.listTitle || Loc.getMessage('LANDING_FORM_SETTINGS_CATEGORIES_FIELD_TITLE'),\n\t\t\t\tcontent: this.options.value.category,\n\t\t\t\titems: this.options.categories.map((category) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: fetchName(category),\n\t\t\t\t\t\tvalue: fetchId(category),\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t\t\tonChange: this.onCategoryChange.bind(this),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetCurrentCategory()\n\t{\n\t\tconst currentCategoryId = this.getCategoriesDropdown().getValue();\n\n\t\treturn this.options.categories.find((category) => {\n\t\t\treturn String(fetchId(category)) === String(currentCategoryId);\n\t\t});\n\t}\n\n\tonCategoryChange()\n\t{\n\t\tthis.emit('onChange');\n\t}\n\n\tgetValue()\n\t{\n\t\treturn {\n\t\t\tcategory: this.getCategoriesDropdown().getValue(),\n\t\t\tstage: '',\n\t\t};\n\t}\n\n\tsetValue(value, preventEvent = false)\n\t{\n\t\tthis.getCategoriesDropdown().setValue(value.category);\n\n\t\tif (!preventEvent)\n\t\t{\n\t\t\tthis.emit('onChange');\n\t\t}\n\t}\n}","export default \"/bitrix/js/landing/ui/panel/formsettingspanel/content/crm/dist/images/message-icon.svg\"","import {Loc} from 'landing.loc';\nimport {HeaderCard} from 'landing.ui.card.headercard';\nimport {ContentWrapper} from 'landing.ui.panel.basepresetpanel';\nimport {RadioButtonField} from 'landing.ui.field.radiobuttonfield';\nimport {BaseEvent} from 'main.core.events';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {MessageCard} from 'landing.ui.card.messagecard';\nimport {Text, Type} from 'main.core';\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\nimport StageField from './internal/stagefield/stagefield';\n\nimport messageIcon from './images/message-icon.svg';\n\nimport './css/style.css';\n\ntype CrmField = {\n\ttype: 'list' | 'string' | 'checkbox' | 'date' | 'text' | 'typed_string' | 'file',\n\tentity_field_name: string,\n\tentity_name: string,\n\tname: string,\n\tcaption: string,\n\tmultiple: boolean,\n\trequired: boolean,\n\thidden: boolean,\n\titems: Array<{ID: any, VALUE: any}>,\n};\n\nexport default class CrmContent extends ContentWrapper\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.FormSettingsPanel.CrmContent');\n\n\t\tthis.addItem(this.getHeader());\n\t\tthis.addItem(this.getTypesField());\n\t\tif (this.isDynamicAvailable())\n\t\t{\n\t\t\tthis.addItem(this.getDynamicEntitySettingsForm());\n\t\t}\n\n\t\tthis.addItem(this.getExpertSettingsForm());\n\t\tthis.addItem(this.getOrderSettingsForm());\n\n\t\tthis.setLastScheme(this.options.formOptions.document.scheme);\n\t\tthis.setLastDealCategory(this.options.formOptions.document.deal.category);\n\t}\n\n\tisDynamicAvailable(): boolean\n\t{\n\t\treturn Type.isArrayFilled(this.options.dictionary.document.dynamic);\n\t}\n\n\tgetHeader(): HeaderCard\n\t{\n\t\treturn this.cache.remember('header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TITLE'),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDuplicatesField(): BX.Landing.UI.Field.Radio\n\t{\n\t\treturn this.cache.remember('duplicatesField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Radio({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_DUPLICATES_FIELD_TITLE'),\n\t\t\t\tselector: 'duplicateMode',\n\t\t\t\tvalue: [this.options.formOptions.document.duplicateMode ? this.options.formOptions.document.duplicateMode : 'ALLOW'],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('LANDING_FORM_SETTINGS_DUPLICATES_ALLOW'),\n\t\t\t\t\t\tvalue: 'ALLOW',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('LANDING_FORM_SETTINGS_DUPLICATES_REPLACE'),\n\t\t\t\t\t\tvalue: 'REPLACE',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('LANDING_FORM_SETTINGS_DUPLICATES_MERGE'),\n\t\t\t\t\t\tvalue: 'MERGE',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPaymentField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('paymentField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'payment',\n\t\t\t\tvalue: [this.options.formOptions.payment.use],\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_SETTINGS_ORDER_SHOW_PAYMENT'), value: true},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetOrderSettingsForm(): FormSettingsForm\n\t{\n\t\treturn this.cache.remember('formSettingsForm', () => {\n\t\t\tconst scheme = this.getSchemeById(this.options.formOptions.document.scheme);\n\t\t\tconst isOpened = (() => {\n\t\t\t\tif (scheme && scheme.dynamic === true)\n\t\t\t\t{\n\t\t\t\t\treturn String(scheme.id).endsWith('1');\n\t\t\t\t}\n\n\t\t\t\treturn Text.toNumber(this.options.formOptions.document.scheme) > 4;\n\t\t\t})();\n\n\t\t\treturn new FormSettingsForm({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_ORDER_HEADER'),\n\t\t\t\ttoggleable: true,\n\t\t\t\topened: isOpened,\n\t\t\t\tfields: [\n\t\t\t\t\tthis.getPaymentField(),\n\t\t\t\t\tnew MessageCard({\n\t\t\t\t\t\tid: 'orderMessage',\n\t\t\t\t\t\theader: Loc.getMessage('LANDING_FORM_SETTINGS_ORDER_MESSAGE_HEADER'),\n\t\t\t\t\t\tdescription: Loc.getMessage('LANDING_FORM_SETTINGS_ORDER_MESSAGE_DESCRIPTION'),\n\t\t\t\t\t\tangle: false,\n\t\t\t\t\t\ticon: messageIcon,\n\t\t\t\t\t\trestoreState: true,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetType1Header(): HeaderCard\n\t{\n\t\treturn this.cache.remember('type1header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_1').replace('&nbsp;', ' '),\n\t\t\t\tlevel: 2,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetType2Header(): HeaderCard\n\t{\n\t\treturn this.cache.remember('type2header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_2').replace('&nbsp;', ' '),\n\t\t\t\tlevel: 2,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetType3Header(): HeaderCard\n\t{\n\t\treturn this.cache.remember('type3header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_3').replace('&nbsp;', ' '),\n\t\t\t\tlevel: 2,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetType4Header(): HeaderCard\n\t{\n\t\treturn this.cache.remember('type4header', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_4').replace('&nbsp;', ' '),\n\t\t\t\tlevel: 2,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDynamicHeader(headerText: string): HeaderCard\n\t{\n\t\tconst header = this.cache.remember('dynamicHeader', () => {\n\t\t\treturn new HeaderCard({\n\t\t\t\ttitle: '',\n\t\t\t\tlevel: 2,\n\t\t\t});\n\t\t});\n\n\t\tif (Type.isString(headerText))\n\t\t{\n\t\t\theader.setTitle(headerText);\n\t\t}\n\n\t\treturn header;\n\t}\n\n\tgetDynamicEntitiesField(): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn this.cache.remember('dynamicEntitiesField', () => {\n\t\t\tconst currentScheme = this.getSchemeById(this.options.formOptions.document.scheme);\n\n\t\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\t\tselector: 'dynamicScheme',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_SMART_ENTITY_LIST'),\n\t\t\t\titems: this.options.dictionary.document.dynamic.map((scheme) => {\n\t\t\t\t\treturn {name: scheme.name, value: scheme.id};\n\t\t\t\t}),\n\t\t\t\tcontent: currentScheme.mainEntity,\n\t\t\t\tonChange: () => {\n\t\t\t\t\tthis.onTypeChange(\n\t\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\titem: {\n\t\t\t\t\t\t\t\t\tid: this.getSelectedSchemeId(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDynamicEntitySettingsForm(): FormSettingsForm\n\t{\n\t\treturn this.cache.remember('dynamicEntitySettingsForm', () => {\n\t\t\treturn new FormSettingsForm({\n\t\t\t\topened: true,\n\t\t\t\thidden: true,\n\t\t\t\tfields: [\n\t\t\t\t\tthis.getDynamicEntitiesField(),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetExpertSettingsForm(): FormSettingsForm\n\t{\n\t\treturn this.cache.remember('expertSettingsForm', () => {\n\t\t\treturn new FormSettingsForm({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_EXPERT_MODE'),\n\t\t\t\ttoggleable: true,\n\t\t\t\ttoggleableType: FormSettingsForm.ToggleableType.Link,\n\t\t\t\topened: false,\n\t\t\t\tfields: [\n\t\t\t\t\tnew HeaderCard({\n\t\t\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_1').replace('&nbsp;', ' '),\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t}),\n\t\t\t\t\tthis.getDuplicatesField(),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTypesField(): RadioButtonField\n\t{\n\t\treturn this.cache.remember('typesField', () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.onTypeChange(\n\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\titem: {\n\t\t\t\t\t\t\t\tid: this.options.formOptions.document.scheme,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tconst items = [\n\t\t\t\t{\n\t\t\t\t\tid: '2',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_2'),\n\t\t\t\t\ticon: 'landing-ui-crm-entity-type2',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: '3',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_3'),\n\t\t\t\t\ticon: 'landing-ui-crm-entity-type3',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: '4',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_4'),\n\t\t\t\t\ticon: 'landing-ui-crm-entity-type4',\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tif (this.isDynamicAvailable())\n\t\t\t{\n\t\t\t\titems.push({\n\t\t\t\t\tid: 'smart',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_5'),\n\t\t\t\t\ticon: 'landing-ui-crm-entity-type5',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.options.isLeadEnabled)\n\t\t\t{\n\t\t\t\titems.unshift({\n\t\t\t\t\tid: '1',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_TYPE_1'),\n\t\t\t\t\ticon: 'landing-ui-crm-entity-type1',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn new RadioButtonField({\n\t\t\t\tselector: 'scheme',\n\t\t\t\tvalue: (() => {\n\t\t\t\t\tif (String(this.options.formOptions.document.scheme) === '8')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (String(this.options.formOptions.document.scheme) === '5')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (String(this.options.formOptions.document.scheme) === '6')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn 3;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (String(this.options.formOptions.document.scheme) === '7')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn 4;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst scheme = this.getSchemeById(this.options.formOptions.document.scheme);\n\t\t\t\t\tif (Type.isPlainObject(scheme) && scheme.dynamic === true)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn 'smart';\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.options.formOptions.document.scheme;\n\t\t\t\t})(),\n\t\t\t\titems,\n\t\t\t\tonChange: this.onTypeChange.bind(this),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDealCategoryField()\n\t{\n\t\treturn this.cache.remember('dealCategoryField', () => {\n\t\t\treturn new StageField({\n\t\t\t\tcategories: this.options.categories,\n\t\t\t\tvalue: {\n\t\t\t\t\tcategory: this.options.formOptions.document.deal.category,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDynamicCategoriesField(schemeId: string | number)\n\t{\n\t\treturn this.cache.remember(`dynamicCategories#${schemeId}`, () => {\n\t\t\tconst scheme = this.getDynamicSchemeById(schemeId);\n\t\t\treturn new StageField({\n\t\t\t\tlistTitle: Loc.getMessage('LANDING_FORM_SETTINGS_SMART_STAGES_FIELD_TITLE'),\n\t\t\t\tcategories: scheme.categories,\n\t\t\t\tvalue: {\n\t\t\t\t\tcategory: this.options.formOptions.document.dynamic.category,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDuplicatesEnabledField()\n\t{\n\t\treturn this.cache.remember('duplicatesEnabledField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'duplicatesEnabled',\n\t\t\t\tcompact: true,\n\t\t\t\tvalue: [this.options.formOptions.document.deal.duplicatesEnabled || 'Y'],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('LANDING_FORM_SETTINGS_CRM_DUPLICATES_ENABLED'),\n\t\t\t\t\t\tvalue: true,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSchemeById(id: number)\n\t{\n\t\treturn this.options.dictionary.document.schemes.find((scheme) => {\n\t\t\treturn (\n\t\t\t\t(String(scheme.id) === String(id))\n\t\t\t\t|| (\n\t\t\t\t\tid === 'smart'\n\t\t\t\t\t&& scheme.dynamic\n\t\t\t\t\t&& String(scheme.id) === String(this.getSelectedSchemeId())\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\n\tgetDynamicSchemeById(id: number)\n\t{\n\t\tconst {mainEntity} = this.getSchemeById(id);\n\t\treturn this.options.dictionary.document.dynamic.find((scheme) => {\n\t\t\treturn String(scheme.id) === String(mainEntity);\n\t\t});\n\t}\n\n\tsetLastScheme(schemeId: number)\n\t{\n\t\tthis.cache.set('lastScheme', schemeId);\n\t}\n\n\tgetLastScheme(): number\n\t{\n\t\treturn this.cache.get('lastScheme');\n\t}\n\n\tsetLastDealCategory(categoryId: number)\n\t{\n\t\tthis.cache.set('lastDealCategory', categoryId);\n\t}\n\n\tgetLastDealCategory(): ?number\n\t{\n\t\treturn this.cache.get('lastDealCategory', null);\n\t}\n\n\tonTypeChange(event: BaseEvent)\n\t{\n\t\tconst {item} = event.getData();\n\t\tconst scheme = this.getSchemeById(item.id);\n\n\t\tthis.clear();\n\n\t\tthis.addItem(this.getHeader());\n\t\tthis.addItem(this.getTypesField());\n\t\tif (this.isDynamicAvailable())\n\t\t{\n\t\t\tthis.addItem(this.getDynamicEntitySettingsForm());\n\t\t\tthis.getDynamicEntitySettingsForm().hide();\n\t\t}\n\n\t\tconst expertSettingsForm = this.getExpertSettingsForm();\n\t\texpertSettingsForm.clear();\n\n\t\tif (String(item.id) === '1' || String(item.id) === '8')\n\t\t{\n\t\t\texpertSettingsForm.addField(this.getType1Header());\n\t\t\texpertSettingsForm.addField(this.getDuplicatesField());\n\t\t}\n\n\t\tif (String(item.id) === '2' || String(item.id) === '5')\n\t\t{\n\t\t\texpertSettingsForm.addField(this.getType2Header());\n\t\t\texpertSettingsForm.addField(this.getDuplicatesField());\n\t\t}\n\n\t\tif (String(item.id) === '3' || String(item.id) === '6')\n\t\t{\n\t\t\texpertSettingsForm.addField(this.getType3Header());\n\t\t\texpertSettingsForm.addField(this.getDealCategoryField());\n\t\t\texpertSettingsForm.addField(this.getDuplicatesEnabledField());\n\t\t\texpertSettingsForm.addField(this.getDuplicatesField());\n\t\t}\n\n\t\tif (String(item.id) === '4' || String(item.id) === '7')\n\t\t{\n\t\t\texpertSettingsForm.addField(this.getType4Header());\n\t\t\texpertSettingsForm.addField(this.getDuplicatesField());\n\t\t}\n\n\t\tif (\n\t\t\t(\n\t\t\t\tText.toNumber(item.id) > 4\n\t\t\t\t&& Type.isPlainObject(scheme)\n\t\t\t\t&& scheme.dynamic !== true\n\t\t\t)\n\t\t\t|| this.getOrderSettingsForm().isOpened()\n\t\t)\n\t\t{\n\t\t\tthis.getOrderSettingsForm().onSwitchChange(true);\n\t\t}\n\n\t\tif (\n\t\t\tType.isPlainObject(scheme)\n\t\t\t&& (String(item.id) === 'smart' || scheme.dynamic === true)\n\t\t\t&& this.isDynamicAvailable()\n\t\t)\n\t\t{\n\t\t\texpertSettingsForm.addField(this.getDynamicHeader(scheme.name));\n\t\t\texpertSettingsForm.addField(this.getDynamicCategoriesField(scheme.id));\n\t\t\texpertSettingsForm.addField(this.getDuplicatesField());\n\n\t\t\tif (String(scheme.id).endsWith('1'))\n\t\t\t{\n\t\t\t\tthis.getOrderSettingsForm().onSwitchChange(true);\n\t\t\t}\n\n\t\t\tthis.getDynamicEntitySettingsForm().show();\n\t\t}\n\n\t\tthis.addItem(expertSettingsForm);\n\t\tthis.addItem(this.getOrderSettingsForm());\n\t}\n\n\tsetAdditionalValue(value: {[key: string]: any})\n\t{\n\t\tthis.cache.set('additionalValue', value);\n\t}\n\n\tgetAdditionalValue(): {[key: string]: any}\n\t{\n\t\treturn this.cache.get('additionalValue', {});\n\t}\n\n\tgetEntityChangeConfirm(): MessageBox\n\t{\n\t\treturn this.cache.remember('entityChangeConfirm', () => {\n\t\t\treturn new MessageBox({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_PANEL_CRM_SCHEME_CHANGE_CONFIRM_TITLE'),\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDealCategoryChangeConfirm(): MessageBox\n\t{\n\t\treturn this.cache.remember('dealCategoryChangeConfirm', () => {\n\t\t\treturn new MessageBox({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_PANEL_CRM_SCHEME_CHANGE_CONFIRM_TITLE'),\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t});\n\t\t});\n\t}\n\n\tonChange(event: BaseEvent)\n\t{\n\t\tconst value = this.getValue();\n\t\tconst scheme = this.getSchemeById(value.document.scheme);\n\n\t\tif (Type.isPlainObject(scheme))\n\t\t{\n\t\t\tconst allowedEntities = scheme.entities;\n\t\t\tconst removedFields = this.options.formOptions.presetFields\n\t\t\t\t.filter((presetField) => {\n\t\t\t\t\treturn !allowedEntities.includes(presetField.entityName);\n\t\t\t\t})\n\t\t\t\t.map((presetField) => {\n\t\t\t\t\treturn this.getCrmFieldById(\n\t\t\t\t\t\t`${presetField.entityName}_${presetField.fieldName}`,\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\tif (Type.isArrayFilled(removedFields))\n\t\t\t{\n\t\t\t\tconst itemTemplate = Loc.getMessage('LANDING_FORM_SETTINGS_PANEL_CRM_ITEM_TEMPLATE');\n\t\t\t\tconst entityName = Text.encode(itemTemplate.replace('{text}', scheme.name));\n\n\t\t\t\tconst messageText = (() => {\n\t\t\t\t\tconst fields = removedFields.map((field) => {\n\t\t\t\t\t\treturn itemTemplate.replace('{text}', Text.encode(field.caption));\n\t\t\t\t\t});\n\n\t\t\t\t\tif (removedFields.length > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst lastField = fields.pop();\n\n\t\t\t\t\t\treturn Loc\n\t\t\t\t\t\t\t.getMessage('LANDING_FORM_SETTINGS_PANEL_CRM_SCHEME_CHANGE_CONFIRM_TEXT')\n\t\t\t\t\t\t\t.replace('{fieldsList}', fields.join(', '))\n\t\t\t\t\t\t\t.replace('{lastField}', Text.encode(lastField))\n\t\t\t\t\t\t\t.replaceAll('{entityName}', entityName);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Loc\n\t\t\t\t\t\t.getMessage('LANDING_FORM_SETTINGS_PANEL_CRM_SCHEME_CHANGE_CONFIRM_TEXT_1')\n\t\t\t\t\t\t.replace('{fieldName}', fields.join(', '))\n\t\t\t\t\t\t.replaceAll('{entityName}', entityName);\n\t\t\t\t})();\n\n\t\t\t\tconst entityChangeConfirm = this.getEntityChangeConfirm();\n\n\t\t\t\tentityChangeConfirm.setOkCallback(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tentityChangeConfirm.close();\n\t\t\t\t\t\tentityChangeConfirm.getOkButton().setDisabled(false);\n\t\t\t\t\t\tentityChangeConfirm.getCancelButton().setDisabled(false);\n\n\t\t\t\t\t\tconst filteredFields = this.options.formOptions.presetFields.filter((presetField) => {\n\t\t\t\t\t\t\treturn allowedEntities.includes(presetField.entityName);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.setLastScheme(scheme.id);\n\t\t\t\t\t\tthis.setAdditionalValue({\n\t\t\t\t\t\t\tpresetFields: filteredFields,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.options.formOptions.presetFields = filteredFields;\n\n\t\t\t\t\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\n\t\t\t\t\t\tthis.setAdditionalValue({});\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tentityChangeConfirm.setCancelCallback(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tentityChangeConfirm.close();\n\t\t\t\t\t\tentityChangeConfirm.getOkButton().setDisabled(false);\n\t\t\t\t\t\tentityChangeConfirm.getCancelButton().setDisabled(false);\n\n\t\t\t\t\t\tconst lastScheme = this.getSchemeById(this.getLastScheme());\n\n\t\t\t\t\t\tif (lastScheme.dynamic)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.getTypesField().setValue('smart', true);\n\t\t\t\t\t\t\tthis.getDynamicEntitiesField().setValue(lastScheme.mainEntity, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.getTypesField().setValue(lastScheme.id);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.onTypeChange(\n\t\t\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\titem: {\n\t\t\t\t\t\t\t\t\t\tid: lastScheme.id,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tentityChangeConfirm.setMessage(messageText);\n\n\t\t\t\tentityChangeConfirm.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tString(scheme.id) === '3'\n\t\t\t\t|| String(scheme.id) === '6'\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst lastDealCategory = this.getLastDealCategory();\n\t\t\t\tif (Text.toNumber(value.document.deal.category) !== Text.toNumber(lastDealCategory))\n\t\t\t\t{\n\t\t\t\t\tconst dealStageField = this.options.formOptions.presetFields.find((presetField) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tpresetField.entityName === 'DEAL'\n\t\t\t\t\t\t\t&& presetField.fieldName === 'STAGE_ID'\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (dealStageField)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst crmField = this.getCrmFieldById('DEAL_STAGE_ID');\n\t\t\t\t\t\tconst dealCategoryChangeConfirm = this.getDealCategoryChangeConfirm();\n\n\t\t\t\t\t\tconst fieldName = Loc\n\t\t\t\t\t\t\t.getMessage('LANDING_FORM_SETTINGS_PANEL_CRM_ITEM_TEMPLATE')\n\t\t\t\t\t\t\t.replace('{text}', Text.encode(crmField.caption));\n\t\t\t\t\t\tconst messageText = Loc\n\t\t\t\t\t\t\t.getMessage('LANDING_FORM_SETTINGS_PANEL_CRM_CATEGORY_CHANGE_CONFIRM_TEXT')\n\t\t\t\t\t\t\t.replace('{fieldName}', fieldName);\n\n\t\t\t\t\t\tdealCategoryChangeConfirm.setMessage(messageText);\n\t\t\t\t\t\tdealCategoryChangeConfirm.setOkCallback(\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tdealCategoryChangeConfirm.close();\n\t\t\t\t\t\t\t\tdealCategoryChangeConfirm.getOkButton().setDisabled(false);\n\t\t\t\t\t\t\t\tdealCategoryChangeConfirm.getCancelButton().setDisabled(false);\n\n\t\t\t\t\t\t\t\tconst filteredFields = (\n\t\t\t\t\t\t\t\t\tthis.options.formOptions.presetFields.filter((presetField) => {\n\t\t\t\t\t\t\t\t\t\treturn presetField !== dealStageField;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tthis.options.formOptions.presetFields = filteredFields;\n\n\t\t\t\t\t\t\t\tthis.setLastDealCategory(value.document.deal.category);\n\t\t\t\t\t\t\t\tthis.setAdditionalValue({\n\t\t\t\t\t\t\t\t\tpresetFields: filteredFields,\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t\t\t\t\t\t\t\tthis.setAdditionalValue({});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t\tdealCategoryChangeConfirm.setCancelCallback(\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tdealCategoryChangeConfirm.close();\n\t\t\t\t\t\t\t\tdealCategoryChangeConfirm.getOkButton().setDisabled(false);\n\t\t\t\t\t\t\t\tdealCategoryChangeConfirm.getCancelButton().setDisabled(false);\n\n\t\t\t\t\t\t\t\tthis.getDealCategoryField().setValue({\n\t\t\t\t\t\t\t\t\tcategory: this.getLastDealCategory(),\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.setAdditionalValue({});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tdealCategoryChangeConfirm.show();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t}\n\n\tgetCrmFieldById(id: string): ?CrmField\n\t{\n\t\treturn Object.values(this.options.crmFields)\n\t\t\t.reduce((acc, category) => {\n\t\t\t\treturn [...acc, ...category.FIELDS];\n\t\t\t}, [])\n\t\t\t.find((currentField) => {\n\t\t\t\treturn currentField.name === id;\n\t\t\t});\n\t}\n\n\tgetSelectedSchemeId(): number\n\t{\n\t\tconst typeId = this.getTypesField().getValue();\n\t\tif (String(typeId) === 'smart')\n\t\t{\n\t\t\tconst entityId = this.getDynamicEntitiesField().getValue();\n\t\t\tif (this.getOrderSettingsForm().isOpened())\n\t\t\t{\n\t\t\t\treturn `${entityId}1`;\n\t\t\t}\n\n\t\t\treturn `${entityId}0`;\n\t\t}\n\n\t\treturn typeId;\n\t}\n\n\tvalueReducer(value: {[p: string]: any}): {[p: string]: any}\n\t{\n\t\tconst duplicateMode = this.getDuplicatesField().getValue()[0];\n\t\tconst reducedValue = {\n\t\t\tduplicateMode: duplicateMode === 'ALLOW' ? '' : duplicateMode,\n\t\t\tscheme: this.getSelectedSchemeId(),\n\t\t\tdeal: {\n\t\t\t\tduplicatesEnabled: Text.toBoolean(this.getDuplicatesEnabledField().getValue()[0]),\n\t\t\t},\n\t\t\tpayment: {\n\t\t\t\tuse: this.getPaymentField().getValue().length > 0,\n\t\t\t},\n\t\t\tdynamic: {\n\t\t\t\tcategory: null,\n\t\t\t},\n\t\t};\n\n\t\tif (this.getOrderSettingsForm().isOpened())\n\t\t{\n\t\t\tif (String(reducedValue.scheme) === '1')\n\t\t\t{\n\t\t\t\treducedValue.scheme = '8';\n\t\t\t}\n\n\t\t\tif (String(reducedValue.scheme) === '2')\n\t\t\t{\n\t\t\t\treducedValue.scheme = '5';\n\t\t\t}\n\n\t\t\tif (String(reducedValue.scheme) === '3')\n\t\t\t{\n\t\t\t\treducedValue.scheme = '6';\n\t\t\t}\n\n\t\t\tif (String(reducedValue.scheme) === '4')\n\t\t\t{\n\t\t\t\treducedValue.scheme = '7';\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tString(reducedValue.scheme) === '3'\n\t\t\t|| String(reducedValue.scheme) === '6'\n\t\t)\n\t\t{\n\t\t\treducedValue.deal.category = this.getDealCategoryField().getValue().category;\n\t\t}\n\n\t\tconst scheme = this.getSchemeById(reducedValue.scheme);\n\t\tif (Type.isPlainObject(scheme) && scheme.dynamic)\n\t\t{\n\t\t\treducedValue.dynamic.category = this.getDynamicCategoriesField(scheme.id).getValue().category;\n\t\t}\n\n\t\treturn {\n\t\t\tdocument: reducedValue,\n\t\t\t...this.getAdditionalValue(),\n\t\t};\n\t}\n}"],"names":["fetchId","item","Type","isNil","ID","id","fetchName","NAME","name","StageField","options","Dom","replace","input","getInner","cache","remember","Tag","render","getCategoriesDropdown","getLayout","BX","Landing","UI","Field","Dropdown","title","listTitle","Loc","getMessage","content","value","category","items","categories","map","onChange","onCategoryChange","bind","currentCategoryId","getValue","find","String","emit","stage","preventEvent","setValue","BaseField","CrmContent","setEventNamespace","addItem","getHeader","getTypesField","isDynamicAvailable","getDynamicEntitySettingsForm","getExpertSettingsForm","getOrderSettingsForm","setLastScheme","formOptions","document","scheme","setLastDealCategory","deal","isArrayFilled","dictionary","dynamic","HeaderCard","Radio","selector","duplicateMode","Checkbox","payment","use","getSchemeById","isOpened","endsWith","Text","toNumber","FormSettingsForm","toggleable","opened","fields","getPaymentField","MessageCard","header","description","angle","icon","messageIcon","restoreState","level","headerText","isString","setTitle","currentScheme","mainEntity","onTypeChange","BaseEvent","data","getSelectedSchemeId","hidden","getDynamicEntitiesField","toggleableType","ToggleableType","Link","getDuplicatesField","setTimeout","push","isLeadEnabled","unshift","RadioButtonField","isPlainObject","schemeId","getDynamicSchemeById","compact","duplicatesEnabled","schemes","set","get","categoryId","event","getData","clear","hide","expertSettingsForm","addField","getType1Header","getType2Header","getType3Header","getDealCategoryField","getDuplicatesEnabledField","getType4Header","onSwitchChange","getDynamicHeader","getDynamicCategoriesField","show","MessageBox","buttons","MessageBoxButtons","OK_CANCEL","allowedEntities","entities","removedFields","presetFields","filter","presetField","includes","entityName","getCrmFieldById","fieldName","itemTemplate","encode","messageText","field","caption","length","lastField","pop","join","replaceAll","entityChangeConfirm","getEntityChangeConfirm","setOkCallback","close","getOkButton","setDisabled","getCancelButton","filteredFields","setAdditionalValue","skipPrepare","setCancelCallback","lastScheme","getLastScheme","setMessage","lastDealCategory","getLastDealCategory","dealStageField","crmField","dealCategoryChangeConfirm","getDealCategoryChangeConfirm","Object","values","crmFields","reduce","acc","FIELDS","currentField","typeId","entityId","reducedValue","toBoolean","getAdditionalValue","ContentWrapper"],"mappings":";;;;;;;;;;CAMA,IAAMA,OAAO,GAAG,SAAVA,OAAU,CAACC,IAAD,EAAU;CACzB,SAAO,CAACC,cAAI,CAACC,KAAL,CAAWF,IAAI,CAACG,EAAhB,CAAD,GAAuBH,IAAI,CAACG,EAA5B,GAAiCH,IAAI,CAACI,EAA7C;CACA,CAFD;;CAIA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACL,IAAD,EAAU;CAC3B,SAAO,CAACC,cAAI,CAACC,KAAL,CAAWF,IAAI,CAACM,IAAhB,CAAD,GAAyBN,IAAI,CAACM,IAA9B,GAAqCN,IAAI,CAACO,IAAjD;CACA,CAFD;;KAIqBC;;;CAEpB,sBAAYC,OAAZ,EACA;CAAA;;CAAA;CACC,4GAAMA,OAAN;CACAC,IAAAA,aAAG,CAACC,OAAJ,CAAY,MAAKC,KAAjB,EAAwB,MAAKC,QAAL,EAAxB;CAFD;CAGC;;;;gCAGD;CAAA;;CACC,aAAO,KAAKC,KAAL,CAAWC,QAAX,CAAoB,OAApB,EAA6B,YAAM;CACzC,eAAOC,aAAG,CAACC,MAAX,2KAEI,MAAI,CAACC,qBAAL,GAA6BC,SAA7B,EAFJ;CAKA,OANM,CAAP;CAOA;;;6CAGD;CAAA;;CACC,aAAO,KAAKL,KAAL,CAAWC,QAAX,CAAoB,oBAApB,EAA0C,YAAM;CACtD,eAAO,IAAIK,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcC,KAAd,CAAoBC,QAAxB,CAAiC;CACvCC,UAAAA,KAAK,EAAE,MAAI,CAAChB,OAAL,CAAaiB,SAAb,IAA0BC,eAAG,CAACC,UAAJ,CAAe,8CAAf,CADM;CAEvCC,UAAAA,OAAO,EAAE,MAAI,CAACpB,OAAL,CAAaqB,KAAb,CAAmBC,QAFW;CAGvCC,UAAAA,KAAK,EAAE,MAAI,CAACvB,OAAL,CAAawB,UAAb,CAAwBC,GAAxB,CAA4B,UAACH,QAAD,EAAc;CAChD,mBAAO;CACNxB,cAAAA,IAAI,EAAEF,SAAS,CAAC0B,QAAD,CADT;CAEND,cAAAA,KAAK,EAAE/B,OAAO,CAACgC,QAAD;CAFR,aAAP;CAIA,WALM,CAHgC;CASvCI,UAAAA,QAAQ,EAAE,MAAI,CAACC,gBAAL,CAAsBC,IAAtB,CAA2B,MAA3B;CAT6B,SAAjC,CAAP;CAWA,OAZM,CAAP;CAaA;;;0CAGD;CACC,UAAMC,iBAAiB,GAAG,KAAKpB,qBAAL,GAA6BqB,QAA7B,EAA1B;CAEA,aAAO,KAAK9B,OAAL,CAAawB,UAAb,CAAwBO,IAAxB,CAA6B,UAACT,QAAD,EAAc;CACjD,eAAOU,MAAM,CAAC1C,OAAO,CAACgC,QAAD,CAAR,CAAN,KAA8BU,MAAM,CAACH,iBAAD,CAA3C;CACA,OAFM,CAAP;CAGA;;;wCAGD;CACC,WAAKI,IAAL,CAAU,UAAV;CACA;;;gCAGD;CACC,aAAO;CACNX,QAAAA,QAAQ,EAAE,KAAKb,qBAAL,GAA6BqB,QAA7B,EADJ;CAENI,QAAAA,KAAK,EAAE;CAFD,OAAP;CAIA;;;8BAEQb,OACT;CAAA,UADgBc,YAChB,uEAD+B,KAC/B;CACC,WAAK1B,qBAAL,GAA6B2B,QAA7B,CAAsCf,KAAK,CAACC,QAA5C;;CAEA,UAAI,CAACa,YAAL,EACA;CACC,aAAKF,IAAL,CAAU,UAAV;CACA;CACD;;;GAlEsCI;;ACdxC,mBAAe,wFAAf;;KC2BqBC;;;CAEpB,sBAAYtC,OAAZ,EACA;CAAA;;CAAA;CACC,4GAAMA,OAAN;;CACA,UAAKuC,iBAAL,CAAuB,kDAAvB;;CAEA,UAAKC,OAAL,CAAa,MAAKC,SAAL,EAAb;;CACA,UAAKD,OAAL,CAAa,MAAKE,aAAL,EAAb;;CACA,QAAI,MAAKC,kBAAL,EAAJ,EACA;CACC,YAAKH,OAAL,CAAa,MAAKI,4BAAL,EAAb;CACA;;CAED,UAAKJ,OAAL,CAAa,MAAKK,qBAAL,EAAb;;CACA,UAAKL,OAAL,CAAa,MAAKM,oBAAL,EAAb;;CAEA,UAAKC,aAAL,CAAmB,MAAK/C,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAArD;;CACA,UAAKC,mBAAL,CAAyB,MAAKnD,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCG,IAAlC,CAAuC9B,QAAhE;;CAfD;CAgBC;;;;0CAGD;CACC,aAAO9B,cAAI,CAAC6D,aAAL,CAAmB,KAAKrD,OAAL,CAAasD,UAAb,CAAwBL,QAAxB,CAAiCM,OAApD,CAAP;CACA;;;iCAGD;CACC,aAAO,KAAKlD,KAAL,CAAWC,QAAX,CAAoB,QAApB,EAA8B,YAAM;CAC1C,eAAO,IAAIkD,qCAAJ,CAAe;CACrBxC,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,iCAAf;CADc,SAAf,CAAP;CAGA,OAJM,CAAP;CAKA;;;0CAGD;CAAA;;CACC,aAAO,KAAKd,KAAL,CAAWC,QAAX,CAAoB,iBAApB,EAAuC,YAAM;CACnD,eAAO,IAAIK,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcC,KAAd,CAAoB2C,KAAxB,CAA8B;CACpCzC,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,8CAAf,CAD6B;CAEpCuC,UAAAA,QAAQ,EAAE,eAF0B;CAGpCrC,UAAAA,KAAK,EAAE,CAAC,MAAI,CAACrB,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCU,aAAlC,GAAkD,MAAI,CAAC3D,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCU,aAApF,GAAoG,OAArG,CAH6B;CAIpCpC,UAAAA,KAAK,EAAE,CACN;CACCzB,YAAAA,IAAI,EAAEoB,eAAG,CAACC,UAAJ,CAAe,wCAAf,CADP;CAECE,YAAAA,KAAK,EAAE;CAFR,WADM,EAKN;CACCvB,YAAAA,IAAI,EAAEoB,eAAG,CAACC,UAAJ,CAAe,0CAAf,CADP;CAECE,YAAAA,KAAK,EAAE;CAFR,WALM,EASN;CACCvB,YAAAA,IAAI,EAAEoB,eAAG,CAACC,UAAJ,CAAe,wCAAf,CADP;CAECE,YAAAA,KAAK,EAAE;CAFR,WATM;CAJ6B,SAA9B,CAAP;CAmBA,OApBM,CAAP;CAqBA;;;uCAGD;CAAA;;CACC,aAAO,KAAKhB,KAAL,CAAWC,QAAX,CAAoB,cAApB,EAAoC,YAAM;CAChD,eAAO,IAAIK,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcC,KAAd,CAAoB8C,QAAxB,CAAiC;CACvCF,UAAAA,QAAQ,EAAE,SAD6B;CAEvCrC,UAAAA,KAAK,EAAE,CAAC,MAAI,CAACrB,OAAL,CAAagD,WAAb,CAAyBa,OAAzB,CAAiCC,GAAlC,CAFgC;CAGvCvC,UAAAA,KAAK,EAAE,CACN;CAACzB,YAAAA,IAAI,EAAEoB,eAAG,CAACC,UAAJ,CAAe,0CAAf,CAAP;CAAmEE,YAAAA,KAAK,EAAE;CAA1E,WADM;CAHgC,SAAjC,CAAP;CAOA,OARM,CAAP;CASA;;;4CAGD;CAAA;;CACC,aAAO,KAAKhB,KAAL,CAAWC,QAAX,CAAoB,kBAApB,EAAwC,YAAM;CACpD,YAAM4C,MAAM,GAAG,MAAI,CAACa,aAAL,CAAmB,MAAI,CAAC/D,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAArD,CAAf;;CACA,YAAMc,QAAQ,GAAI,YAAM;CACvB,cAAId,MAAM,IAAIA,MAAM,CAACK,OAAP,KAAmB,IAAjC,EACA;CACC,mBAAOvB,MAAM,CAACkB,MAAM,CAACvD,EAAR,CAAN,CAAkBsE,QAAlB,CAA2B,GAA3B,CAAP;CACA;;CAED,iBAAOC,cAAI,CAACC,QAAL,CAAc,MAAI,CAACnE,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAAhD,IAA0D,CAAjE;CACA,SAPgB,EAAjB;;CASA,eAAO,IAAIkB,iDAAJ,CAAqB;CAC3BpD,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,oCAAf,CADoB;CAE3BkD,UAAAA,UAAU,EAAE,IAFe;CAG3BC,UAAAA,MAAM,EAAEN,QAHmB;CAI3BO,UAAAA,MAAM,EAAE,CACP,MAAI,CAACC,eAAL,EADO,EAEP,IAAIC,uCAAJ,CAAgB;CACf9E,YAAAA,EAAE,EAAE,cADW;CAEf+E,YAAAA,MAAM,EAAExD,eAAG,CAACC,UAAJ,CAAe,4CAAf,CAFO;CAGfwD,YAAAA,WAAW,EAAEzD,eAAG,CAACC,UAAJ,CAAe,iDAAf,CAHE;CAIfyD,YAAAA,KAAK,EAAE,KAJQ;CAKfC,YAAAA,IAAI,EAAEC,WALS;CAMfC,YAAAA,YAAY,EAAE;CANC,WAAhB,CAFO;CAJmB,SAArB,CAAP;CAgBA,OA3BM,CAAP;CA4BA;;;sCAGD;CACC,aAAO,KAAK1E,KAAL,CAAWC,QAAX,CAAoB,aAApB,EAAmC,YAAM;CAC/C,eAAO,IAAIkD,qCAAJ,CAAe;CACrBxC,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,EAAmDjB,OAAnD,CAA2D,QAA3D,EAAqE,GAArE,CADc;CAErB8E,UAAAA,KAAK,EAAE;CAFc,SAAf,CAAP;CAIA,OALM,CAAP;CAMA;;;sCAGD;CACC,aAAO,KAAK3E,KAAL,CAAWC,QAAX,CAAoB,aAApB,EAAmC,YAAM;CAC/C,eAAO,IAAIkD,qCAAJ,CAAe;CACrBxC,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,EAAmDjB,OAAnD,CAA2D,QAA3D,EAAqE,GAArE,CADc;CAErB8E,UAAAA,KAAK,EAAE;CAFc,SAAf,CAAP;CAIA,OALM,CAAP;CAMA;;;sCAGD;CACC,aAAO,KAAK3E,KAAL,CAAWC,QAAX,CAAoB,aAApB,EAAmC,YAAM;CAC/C,eAAO,IAAIkD,qCAAJ,CAAe;CACrBxC,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,EAAmDjB,OAAnD,CAA2D,QAA3D,EAAqE,GAArE,CADc;CAErB8E,UAAAA,KAAK,EAAE;CAFc,SAAf,CAAP;CAIA,OALM,CAAP;CAMA;;;sCAGD;CACC,aAAO,KAAK3E,KAAL,CAAWC,QAAX,CAAoB,aAApB,EAAmC,YAAM;CAC/C,eAAO,IAAIkD,qCAAJ,CAAe;CACrBxC,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,EAAmDjB,OAAnD,CAA2D,QAA3D,EAAqE,GAArE,CADc;CAErB8E,UAAAA,KAAK,EAAE;CAFc,SAAf,CAAP;CAIA,OALM,CAAP;CAMA;;;sCAEgBC,YACjB;CACC,UAAMP,MAAM,GAAG,KAAKrE,KAAL,CAAWC,QAAX,CAAoB,eAApB,EAAqC,YAAM;CACzD,eAAO,IAAIkD,qCAAJ,CAAe;CACrBxC,UAAAA,KAAK,EAAE,EADc;CAErBgE,UAAAA,KAAK,EAAE;CAFc,SAAf,CAAP;CAIA,OALc,CAAf;;CAOA,UAAIxF,cAAI,CAAC0F,QAAL,CAAcD,UAAd,CAAJ,EACA;CACCP,QAAAA,MAAM,CAACS,QAAP,CAAgBF,UAAhB;CACA;;CAED,aAAOP,MAAP;CACA;;;+CAGD;CAAA;;CACC,aAAO,KAAKrE,KAAL,CAAWC,QAAX,CAAoB,sBAApB,EAA4C,YAAM;CACxD,YAAM8E,aAAa,GAAG,MAAI,CAACrB,aAAL,CAAmB,MAAI,CAAC/D,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAArD,CAAtB;;CAEA,eAAO,IAAIvC,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcC,KAAd,CAAoBC,QAAxB,CAAiC;CACvC2C,UAAAA,QAAQ,EAAE,eAD6B;CAEvC1C,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,6CAAf,CAFgC;CAGvCI,UAAAA,KAAK,EAAE,MAAI,CAACvB,OAAL,CAAasD,UAAb,CAAwBL,QAAxB,CAAiCM,OAAjC,CAAyC9B,GAAzC,CAA6C,UAACyB,MAAD,EAAY;CAC/D,mBAAO;CAACpD,cAAAA,IAAI,EAAEoD,MAAM,CAACpD,IAAd;CAAoBuB,cAAAA,KAAK,EAAE6B,MAAM,CAACvD;CAAlC,aAAP;CACA,WAFM,CAHgC;CAMvCyB,UAAAA,OAAO,EAAEgE,aAAa,CAACC,UANgB;CAOvC3D,UAAAA,QAAQ,EAAE,oBAAM;CACf,YAAA,MAAI,CAAC4D,YAAL,CACC,IAAIC,0BAAJ,CAAc;CACbC,cAAAA,IAAI,EAAE;CACLjG,gBAAAA,IAAI,EAAE;CACLI,kBAAAA,EAAE,EAAE,MAAI,CAAC8F,mBAAL;CADC;CADD;CADO,aAAd,CADD;CASA;CAjBsC,SAAjC,CAAP;CAmBA,OAtBM,CAAP;CAuBA;;;oDAGD;CAAA;;CACC,aAAO,KAAKpF,KAAL,CAAWC,QAAX,CAAoB,2BAApB,EAAiD,YAAM;CAC7D,eAAO,IAAI8D,iDAAJ,CAAqB;CAC3BE,UAAAA,MAAM,EAAE,IADmB;CAE3BoB,UAAAA,MAAM,EAAE,IAFmB;CAG3BnB,UAAAA,MAAM,EAAE,CACP,MAAI,CAACoB,uBAAL,EADO;CAHmB,SAArB,CAAP;CAOA,OARM,CAAP;CASA;;;6CAGD;CAAA;;CACC,aAAO,KAAKtF,KAAL,CAAWC,QAAX,CAAoB,oBAApB,EAA0C,YAAM;CACtD,eAAO,IAAI8D,iDAAJ,CAAqB;CAC3BpD,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,mCAAf,CADoB;CAE3BkD,UAAAA,UAAU,EAAE,IAFe;CAG3BuB,UAAAA,cAAc,EAAExB,iDAAgB,CAACyB,cAAjB,CAAgCC,IAHrB;CAI3BxB,UAAAA,MAAM,EAAE,KAJmB;CAK3BC,UAAAA,MAAM,EAAE,CACP,IAAIf,qCAAJ,CAAe;CACdxC,YAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,EAAmDjB,OAAnD,CAA2D,QAA3D,EAAqE,GAArE,CADO;CAEd8E,YAAAA,KAAK,EAAE;CAFO,WAAf,CADO,EAKP,MAAI,CAACe,kBAAL,EALO;CALmB,SAArB,CAAP;CAaA,OAdM,CAAP;CAeA;;;qCAGD;CAAA;;CACC,aAAO,KAAK1F,KAAL,CAAWC,QAAX,CAAoB,YAApB,EAAkC,YAAM;CAC9C0F,QAAAA,UAAU,CAAC,YAAM;CAChB,UAAA,MAAI,CAACV,YAAL,CACC,IAAIC,0BAAJ,CAAc;CACbC,YAAAA,IAAI,EAAE;CACLjG,cAAAA,IAAI,EAAE;CACLI,gBAAAA,EAAE,EAAE,MAAI,CAACK,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC;CADjC;CADD;CADO,WAAd,CADD;CASA,SAVS,CAAV;CAYA,YAAM3B,KAAK,GAAG,CACb;CACC5B,UAAAA,EAAE,EAAE,GADL;CAECqB,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,CAFR;CAGC0D,UAAAA,IAAI,EAAE;CAHP,SADa,EAMb;CACClF,UAAAA,EAAE,EAAE,GADL;CAECqB,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,CAFR;CAGC0D,UAAAA,IAAI,EAAE;CAHP,SANa,EAWb;CACClF,UAAAA,EAAE,EAAE,GADL;CAECqB,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,CAFR;CAGC0D,UAAAA,IAAI,EAAE;CAHP,SAXa,CAAd;;CAkBA,YAAI,MAAI,CAAClC,kBAAL,EAAJ,EACA;CACCpB,UAAAA,KAAK,CAAC0E,IAAN,CAAW;CACVtG,YAAAA,EAAE,EAAE,OADM;CAEVqB,YAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,CAFG;CAGV0D,YAAAA,IAAI,EAAE;CAHI,WAAX;CAKA;;CAED,YAAI,MAAI,CAAC7E,OAAL,CAAakG,aAAjB,EACA;CACC3E,UAAAA,KAAK,CAAC4E,OAAN,CAAc;CACbxG,YAAAA,EAAE,EAAE,GADS;CAEbqB,YAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,kCAAf,CAFM;CAGb0D,YAAAA,IAAI,EAAE;CAHO,WAAd;CAKA;;CAED,eAAO,IAAIuB,kDAAJ,CAAqB;CAC3B1C,UAAAA,QAAQ,EAAE,QADiB;CAE3BrC,UAAAA,KAAK,EAAG,YAAM;CACb,gBAAIW,MAAM,CAAC,MAAI,CAAChC,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAAnC,CAAN,KAAqD,GAAzD,EACA;CACC,qBAAO,CAAP;CACA;;CAED,gBAAIlB,MAAM,CAAC,MAAI,CAAChC,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAAnC,CAAN,KAAqD,GAAzD,EACA;CACC,qBAAO,CAAP;CACA;;CAED,gBAAIlB,MAAM,CAAC,MAAI,CAAChC,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAAnC,CAAN,KAAqD,GAAzD,EACA;CACC,qBAAO,CAAP;CACA;;CAED,gBAAIlB,MAAM,CAAC,MAAI,CAAChC,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAAnC,CAAN,KAAqD,GAAzD,EACA;CACC,qBAAO,CAAP;CACA;;CAED,gBAAMA,MAAM,GAAG,MAAI,CAACa,aAAL,CAAmB,MAAI,CAAC/D,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAArD,CAAf;;CACA,gBAAI1D,cAAI,CAAC6G,aAAL,CAAmBnD,MAAnB,KAA8BA,MAAM,CAACK,OAAP,KAAmB,IAArD,EACA;CACC,qBAAO,OAAP;CACA;;CAED,mBAAO,MAAI,CAACvD,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCC,MAAzC;CACA,WA5BM,EAFoB;CA+B3B3B,UAAAA,KAAK,EAALA,KA/B2B;CAgC3BG,UAAAA,QAAQ,EAAE,MAAI,CAAC4D,YAAL,CAAkB1D,IAAlB,CAAuB,MAAvB;CAhCiB,SAArB,CAAP;CAkCA,OAnFM,CAAP;CAoFA;;;4CAGD;CAAA;;CACC,aAAO,KAAKvB,KAAL,CAAWC,QAAX,CAAoB,mBAApB,EAAyC,YAAM;CACrD,eAAO,IAAIP,UAAJ,CAAe;CACrByB,UAAAA,UAAU,EAAE,MAAI,CAACxB,OAAL,CAAawB,UADJ;CAErBH,UAAAA,KAAK,EAAE;CACNC,YAAAA,QAAQ,EAAE,MAAI,CAACtB,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCG,IAAlC,CAAuC9B;CAD3C;CAFc,SAAf,CAAP;CAMA,OAPM,CAAP;CAQA;;;+CAEyBgF,UAC1B;CAAA;;CACC,aAAO,KAAKjG,KAAL,CAAWC,QAAX,6BAAyCgG,QAAzC,GAAqD,YAAM;CACjE,YAAMpD,MAAM,GAAG,OAAI,CAACqD,oBAAL,CAA0BD,QAA1B,CAAf;;CACA,eAAO,IAAIvG,UAAJ,CAAe;CACrBkB,UAAAA,SAAS,EAAEC,eAAG,CAACC,UAAJ,CAAe,gDAAf,CADU;CAErBK,UAAAA,UAAU,EAAE0B,MAAM,CAAC1B,UAFE;CAGrBH,UAAAA,KAAK,EAAE;CACNC,YAAAA,QAAQ,EAAE,OAAI,CAACtB,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCM,OAAlC,CAA0CjC;CAD9C;CAHc,SAAf,CAAP;CAOA,OATM,CAAP;CAUA;;;iDAGD;CAAA;;CACC,aAAO,KAAKjB,KAAL,CAAWC,QAAX,CAAoB,wBAApB,EAA8C,YAAM;CAC1D,eAAO,IAAIK,EAAE,CAACC,OAAH,CAAWC,EAAX,CAAcC,KAAd,CAAoB8C,QAAxB,CAAiC;CACvCF,UAAAA,QAAQ,EAAE,mBAD6B;CAEvC8C,UAAAA,OAAO,EAAE,IAF8B;CAGvCnF,UAAAA,KAAK,EAAE,CAAC,OAAI,CAACrB,OAAL,CAAagD,WAAb,CAAyBC,QAAzB,CAAkCG,IAAlC,CAAuCqD,iBAAvC,IAA4D,GAA7D,CAHgC;CAIvClF,UAAAA,KAAK,EAAE,CACN;CACCzB,YAAAA,IAAI,EAAEoB,eAAG,CAACC,UAAJ,CAAe,8CAAf,CADP;CAECE,YAAAA,KAAK,EAAE;CAFR,WADM;CAJgC,SAAjC,CAAP;CAWA,OAZM,CAAP;CAaA;;;mCAEa1B,IACd;CAAA;;CACC,aAAO,KAAKK,OAAL,CAAasD,UAAb,CAAwBL,QAAxB,CAAiCyD,OAAjC,CAAyC3E,IAAzC,CAA8C,UAACmB,MAAD,EAAY;CAChE,eACElB,MAAM,CAACkB,MAAM,CAACvD,EAAR,CAAN,KAAsBqC,MAAM,CAACrC,EAAD,CAA7B,IAECA,EAAE,KAAK,OAAP,IACGuD,MAAM,CAACK,OADV,IAEGvB,MAAM,CAACkB,MAAM,CAACvD,EAAR,CAAN,KAAsBqC,MAAM,CAAC,OAAI,CAACyD,mBAAL,EAAD,CALjC;CAQA,OATM,CAAP;CAUA;;;0CAEoB9F,IACrB;CACC,gCAAqB,KAAKoE,aAAL,CAAmBpE,EAAnB,CAArB;CAAA,UAAO0F,UAAP,uBAAOA,UAAP;;CACA,aAAO,KAAKrF,OAAL,CAAasD,UAAb,CAAwBL,QAAxB,CAAiCM,OAAjC,CAAyCxB,IAAzC,CAA8C,UAACmB,MAAD,EAAY;CAChE,eAAOlB,MAAM,CAACkB,MAAM,CAACvD,EAAR,CAAN,KAAsBqC,MAAM,CAACqD,UAAD,CAAnC;CACA,OAFM,CAAP;CAGA;;;mCAEaiB,UACd;CACC,WAAKjG,KAAL,CAAWsG,GAAX,CAAe,YAAf,EAA6BL,QAA7B;CACA;;;qCAGD;CACC,aAAO,KAAKjG,KAAL,CAAWuG,GAAX,CAAe,YAAf,CAAP;CACA;;;yCAEmBC,YACpB;CACC,WAAKxG,KAAL,CAAWsG,GAAX,CAAe,kBAAf,EAAmCE,UAAnC;CACA;;;2CAGD;CACC,aAAO,KAAKxG,KAAL,CAAWuG,GAAX,CAAe,kBAAf,EAAmC,IAAnC,CAAP;CACA;;;kCAEYE,OACb;CACC,2BAAeA,KAAK,CAACC,OAAN,EAAf;CAAA,UAAOxH,IAAP,kBAAOA,IAAP;;CACA,UAAM2D,MAAM,GAAG,KAAKa,aAAL,CAAmBxE,IAAI,CAACI,EAAxB,CAAf;CAEA,WAAKqH,KAAL;CAEA,WAAKxE,OAAL,CAAa,KAAKC,SAAL,EAAb;CACA,WAAKD,OAAL,CAAa,KAAKE,aAAL,EAAb;;CACA,UAAI,KAAKC,kBAAL,EAAJ,EACA;CACC,aAAKH,OAAL,CAAa,KAAKI,4BAAL,EAAb;CACA,aAAKA,4BAAL,GAAoCqE,IAApC;CACA;;CAED,UAAMC,kBAAkB,GAAG,KAAKrE,qBAAL,EAA3B;CACAqE,MAAAA,kBAAkB,CAACF,KAAnB;;CAEA,UAAIhF,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAApB,IAA2BqC,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAAnD,EACA;CACCuH,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKC,cAAL,EAA5B;CACAF,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKpB,kBAAL,EAA5B;CACA;;CAED,UAAI/D,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAApB,IAA2BqC,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAAnD,EACA;CACCuH,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKE,cAAL,EAA5B;CACAH,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKpB,kBAAL,EAA5B;CACA;;CAED,UAAI/D,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAApB,IAA2BqC,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAAnD,EACA;CACCuH,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKG,cAAL,EAA5B;CACAJ,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKI,oBAAL,EAA5B;CACAL,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKK,yBAAL,EAA5B;CACAN,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKpB,kBAAL,EAA5B;CACA;;CAED,UAAI/D,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAApB,IAA2BqC,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,GAAnD,EACA;CACCuH,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKM,cAAL,EAA5B;CACAP,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKpB,kBAAL,EAA5B;CACA;;CAED,UAEE7B,cAAI,CAACC,QAAL,CAAc5E,IAAI,CAACI,EAAnB,IAAyB,CAAzB,IACGH,cAAI,CAAC6G,aAAL,CAAmBnD,MAAnB,CADH,IAEGA,MAAM,CAACK,OAAP,KAAmB,IAHvB,IAKG,KAAKT,oBAAL,GAA4BkB,QAA5B,EANJ,EAQA;CACC,aAAKlB,oBAAL,GAA4B4E,cAA5B,CAA2C,IAA3C;CACA;;CAED,UACClI,cAAI,CAAC6G,aAAL,CAAmBnD,MAAnB,MACIlB,MAAM,CAACzC,IAAI,CAACI,EAAN,CAAN,KAAoB,OAApB,IAA+BuD,MAAM,CAACK,OAAP,KAAmB,IADtD,KAEG,KAAKZ,kBAAL,EAHJ,EAKA;CACCuE,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKQ,gBAAL,CAAsBzE,MAAM,CAACpD,IAA7B,CAA5B;CACAoH,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKS,yBAAL,CAA+B1E,MAAM,CAACvD,EAAtC,CAA5B;CACAuH,QAAAA,kBAAkB,CAACC,QAAnB,CAA4B,KAAKpB,kBAAL,EAA5B;;CAEA,YAAI/D,MAAM,CAACkB,MAAM,CAACvD,EAAR,CAAN,CAAkBsE,QAAlB,CAA2B,GAA3B,CAAJ,EACA;CACC,eAAKnB,oBAAL,GAA4B4E,cAA5B,CAA2C,IAA3C;CACA;;CAED,aAAK9E,4BAAL,GAAoCiF,IAApC;CACA;;CAED,WAAKrF,OAAL,CAAa0E,kBAAb;CACA,WAAK1E,OAAL,CAAa,KAAKM,oBAAL,EAAb;CACA;;;wCAEkBzB,OACnB;CACC,WAAKhB,KAAL,CAAWsG,GAAX,CAAe,iBAAf,EAAkCtF,KAAlC;CACA;;;0CAGD;CACC,aAAO,KAAKhB,KAAL,CAAWuG,GAAX,CAAe,iBAAf,EAAkC,EAAlC,CAAP;CACA;;;8CAGD;CACC,aAAO,KAAKvG,KAAL,CAAWC,QAAX,CAAoB,qBAApB,EAA2C,YAAM;CACvD,eAAO,IAAIwH,gCAAJ,CAAe;CACrB9G,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,6DAAf,CADc;CAErB4G,UAAAA,OAAO,EAAEC,uCAAiB,CAACC;CAFN,SAAf,CAAP;CAIA,OALM,CAAP;CAMA;;;oDAGD;CACC,aAAO,KAAK5H,KAAL,CAAWC,QAAX,CAAoB,2BAApB,EAAiD,YAAM;CAC7D,eAAO,IAAIwH,gCAAJ,CAAe;CACrB9G,UAAAA,KAAK,EAAEE,eAAG,CAACC,UAAJ,CAAe,6DAAf,CADc;CAErB4G,UAAAA,OAAO,EAAEC,uCAAiB,CAACC;CAFN,SAAf,CAAP;CAIA,OALM,CAAP;CAMA;;;8BAEQnB,OACT;CAAA;;CACC,UAAMzF,KAAK,GAAG,KAAKS,QAAL,EAAd;CACA,UAAMoB,MAAM,GAAG,KAAKa,aAAL,CAAmB1C,KAAK,CAAC4B,QAAN,CAAeC,MAAlC,CAAf;;CAEA,UAAI1D,cAAI,CAAC6G,aAAL,CAAmBnD,MAAnB,CAAJ,EACA;CACC,YAAMgF,eAAe,GAAGhF,MAAM,CAACiF,QAA/B;CACA,YAAMC,aAAa,GAAG,KAAKpI,OAAL,CAAagD,WAAb,CAAyBqF,YAAzB,CACpBC,MADoB,CACb,UAACC,WAAD,EAAiB;CACxB,iBAAO,CAACL,eAAe,CAACM,QAAhB,CAAyBD,WAAW,CAACE,UAArC,CAAR;CACA,SAHoB,EAIpBhH,GAJoB,CAIhB,UAAC8G,WAAD,EAAiB;CACrB,iBAAO,OAAI,CAACG,eAAL,WACHH,WAAW,CAACE,UADT,cACuBF,WAAW,CAACI,SADnC,EAAP;CAGA,SARoB,CAAtB;;CAUA,YAAInJ,cAAI,CAAC6D,aAAL,CAAmB+E,aAAnB,CAAJ,EACA;CACC,cAAMQ,YAAY,GAAG1H,eAAG,CAACC,UAAJ,CAAe,+CAAf,CAArB;CACA,cAAMsH,UAAU,GAAGvE,cAAI,CAAC2E,MAAL,CAAYD,YAAY,CAAC1I,OAAb,CAAqB,QAArB,EAA+BgD,MAAM,CAACpD,IAAtC,CAAZ,CAAnB;;CAEA,cAAMgJ,WAAW,GAAI,YAAM;CAC1B,gBAAMvE,MAAM,GAAG6D,aAAa,CAAC3G,GAAd,CAAkB,UAACsH,KAAD,EAAW;CAC3C,qBAAOH,YAAY,CAAC1I,OAAb,CAAqB,QAArB,EAA+BgE,cAAI,CAAC2E,MAAL,CAAYE,KAAK,CAACC,OAAlB,CAA/B,CAAP;CACA,aAFc,CAAf;;CAIA,gBAAIZ,aAAa,CAACa,MAAd,GAAuB,CAA3B,EACA;CACC,kBAAMC,SAAS,GAAG3E,MAAM,CAAC4E,GAAP,EAAlB;CAEA,qBAAOjI,eAAG,CACRC,UADK,CACM,4DADN,EAELjB,OAFK,CAEG,cAFH,EAEmBqE,MAAM,CAAC6E,IAAP,CAAY,IAAZ,CAFnB,EAGLlJ,OAHK,CAGG,aAHH,EAGkBgE,cAAI,CAAC2E,MAAL,CAAYK,SAAZ,CAHlB,EAILG,UAJK,CAIM,cAJN,EAIsBZ,UAJtB,CAAP;CAKA;;CAED,mBAAOvH,eAAG,CACRC,UADK,CACM,8DADN,EAELjB,OAFK,CAEG,aAFH,EAEkBqE,MAAM,CAAC6E,IAAP,CAAY,IAAZ,CAFlB,EAGLC,UAHK,CAGM,cAHN,EAGsBZ,UAHtB,CAAP;CAIA,WApBmB,EAApB;;CAsBA,cAAMa,mBAAmB,GAAG,KAAKC,sBAAL,EAA5B;CAEAD,UAAAA,mBAAmB,CAACE,aAApB,CACC,YAAM;CACLF,YAAAA,mBAAmB,CAACG,KAApB;CACAH,YAAAA,mBAAmB,CAACI,WAApB,GAAkCC,WAAlC,CAA8C,KAA9C;CACAL,YAAAA,mBAAmB,CAACM,eAApB,GAAsCD,WAAtC,CAAkD,KAAlD;;CAEA,gBAAME,cAAc,GAAG,OAAI,CAAC7J,OAAL,CAAagD,WAAb,CAAyBqF,YAAzB,CAAsCC,MAAtC,CAA6C,UAACC,WAAD,EAAiB;CACpF,qBAAOL,eAAe,CAACM,QAAhB,CAAyBD,WAAW,CAACE,UAArC,CAAP;CACA,aAFsB,CAAvB;;CAIA,YAAA,OAAI,CAAC1F,aAAL,CAAmBG,MAAM,CAACvD,EAA1B;;CACA,YAAA,OAAI,CAACmK,kBAAL,CAAwB;CACvBzB,cAAAA,YAAY,EAAEwB;CADS,aAAxB;;CAIA,YAAA,OAAI,CAAC7J,OAAL,CAAagD,WAAb,CAAyBqF,YAAzB,GAAwCwB,cAAxC;;CAEA,YAAA,OAAI,CAAC5H,IAAL,CAAU,UAAV,gCAA0B6E,KAAK,CAACC,OAAN,EAA1B;CAA2CgD,cAAAA,WAAW,EAAE;CAAxD;;CAEA,YAAA,OAAI,CAACD,kBAAL,CAAwB,EAAxB;CACA,WApBF;CAuBAR,UAAAA,mBAAmB,CAACU,iBAApB,CACC,YAAM;CACLV,YAAAA,mBAAmB,CAACG,KAApB;CACAH,YAAAA,mBAAmB,CAACI,WAApB,GAAkCC,WAAlC,CAA8C,KAA9C;CACAL,YAAAA,mBAAmB,CAACM,eAApB,GAAsCD,WAAtC,CAAkD,KAAlD;;CAEA,gBAAMM,UAAU,GAAG,OAAI,CAAClG,aAAL,CAAmB,OAAI,CAACmG,aAAL,EAAnB,CAAnB;;CAEA,gBAAID,UAAU,CAAC1G,OAAf,EACA;CACC,cAAA,OAAI,CAACb,aAAL,GAAqBN,QAArB,CAA8B,OAA9B,EAAuC,IAAvC;;CACA,cAAA,OAAI,CAACuD,uBAAL,GAA+BvD,QAA/B,CAAwC6H,UAAU,CAAC5E,UAAnD,EAA+D,IAA/D;CACA,aAJD,MAMA;CACC,cAAA,OAAI,CAAC3C,aAAL,GAAqBN,QAArB,CAA8B6H,UAAU,CAACtK,EAAzC;CACA;;CAED,YAAA,OAAI,CAAC2F,YAAL,CACC,IAAIC,0BAAJ,CAAc;CACbC,cAAAA,IAAI,EAAE;CACLjG,gBAAAA,IAAI,EAAE;CACLI,kBAAAA,EAAE,EAAEsK,UAAU,CAACtK;CADV;CADD;CADO,aAAd,CADD;CASA,WA3BF;CA8BA2J,UAAAA,mBAAmB,CAACa,UAApB,CAA+BrB,WAA/B;CAEAQ,UAAAA,mBAAmB,CAACzB,IAApB;CAEA;CACA;;CAED,YACC7F,MAAM,CAACkB,MAAM,CAACvD,EAAR,CAAN,KAAsB,GAAtB,IACGqC,MAAM,CAACkB,MAAM,CAACvD,EAAR,CAAN,KAAsB,GAF1B,EAIA;CACC,cAAMyK,gBAAgB,GAAG,KAAKC,mBAAL,EAAzB;;CACA,cAAInG,cAAI,CAACC,QAAL,CAAc9C,KAAK,CAAC4B,QAAN,CAAeG,IAAf,CAAoB9B,QAAlC,MAAgD4C,cAAI,CAACC,QAAL,CAAciG,gBAAd,CAApD,EACA;CACC,gBAAME,cAAc,GAAG,KAAKtK,OAAL,CAAagD,WAAb,CAAyBqF,YAAzB,CAAsCtG,IAAtC,CAA2C,UAACwG,WAAD,EAAiB;CAClF,qBACCA,WAAW,CAACE,UAAZ,KAA2B,MAA3B,IACGF,WAAW,CAACI,SAAZ,KAA0B,UAF9B;CAIA,aALsB,CAAvB;;CAOA,gBAAI2B,cAAJ,EACA;CACC,kBAAMC,QAAQ,GAAG,KAAK7B,eAAL,CAAqB,eAArB,CAAjB;CACA,kBAAM8B,yBAAyB,GAAG,KAAKC,4BAAL,EAAlC;CAEA,kBAAM9B,SAAS,GAAGzH,eAAG,CACnBC,UADgB,CACL,+CADK,EAEhBjB,OAFgB,CAER,QAFQ,EAEEgE,cAAI,CAAC2E,MAAL,CAAY0B,QAAQ,CAACvB,OAArB,CAFF,CAAlB;;CAGA,kBAAMF,YAAW,GAAG5H,eAAG,CACrBC,UADkB,CACP,8DADO,EAElBjB,OAFkB,CAEV,aAFU,EAEKyI,SAFL,CAApB;;CAIA6B,cAAAA,yBAAyB,CAACL,UAA1B,CAAqCrB,YAArC;CACA0B,cAAAA,yBAAyB,CAAChB,aAA1B,CACC,YAAM;CACLgB,gBAAAA,yBAAyB,CAACf,KAA1B;CACAe,gBAAAA,yBAAyB,CAACd,WAA1B,GAAwCC,WAAxC,CAAoD,KAApD;CACAa,gBAAAA,yBAAyB,CAACZ,eAA1B,GAA4CD,WAA5C,CAAwD,KAAxD;;CAEA,oBAAME,cAAc,GACnB,OAAI,CAAC7J,OAAL,CAAagD,WAAb,CAAyBqF,YAAzB,CAAsCC,MAAtC,CAA6C,UAACC,WAAD,EAAiB;CAC7D,yBAAOA,WAAW,KAAK+B,cAAvB;CACA,iBAFD,CADD;;CAMA,gBAAA,OAAI,CAACtK,OAAL,CAAagD,WAAb,CAAyBqF,YAAzB,GAAwCwB,cAAxC;;CAEA,gBAAA,OAAI,CAAC1G,mBAAL,CAAyB9B,KAAK,CAAC4B,QAAN,CAAeG,IAAf,CAAoB9B,QAA7C;;CACA,gBAAA,OAAI,CAACwI,kBAAL,CAAwB;CACvBzB,kBAAAA,YAAY,EAAEwB;CADS,iBAAxB;;CAIA,gBAAA,OAAI,CAAC5H,IAAL,CAAU,UAAV,gCAA0B6E,KAAK,CAACC,OAAN,EAA1B;CAA2CgD,kBAAAA,WAAW,EAAE;CAAxD;;CACA,gBAAA,OAAI,CAACD,kBAAL,CAAwB,EAAxB;CACA,eArBF;CAuBAU,cAAAA,yBAAyB,CAACR,iBAA1B,CACC,YAAM;CACLQ,gBAAAA,yBAAyB,CAACf,KAA1B;CACAe,gBAAAA,yBAAyB,CAACd,WAA1B,GAAwCC,WAAxC,CAAoD,KAApD;CACAa,gBAAAA,yBAAyB,CAACZ,eAA1B,GAA4CD,WAA5C,CAAwD,KAAxD;;CAEA,gBAAA,OAAI,CAACpC,oBAAL,GAA4BnF,QAA5B,CAAqC;CACpCd,kBAAAA,QAAQ,EAAE,OAAI,CAAC+I,mBAAL;CAD0B,iBAArC;;CAGA,gBAAA,OAAI,CAACP,kBAAL,CAAwB,EAAxB;CACA,eAVF;CAaAU,cAAAA,yBAAyB,CAAC3C,IAA1B;CAEA;CACA;CACD;CACD;CACD;;CAED,WAAK5F,IAAL,CAAU,UAAV,gCAA0B6E,KAAK,CAACC,OAAN,EAA1B;CAA2CgD,QAAAA,WAAW,EAAE;CAAxD;CACA;;;qCAEepK,IAChB;CACC,aAAO+K,MAAM,CAACC,MAAP,CAAc,KAAK3K,OAAL,CAAa4K,SAA3B,EACLC,MADK,CACE,UAACC,GAAD,EAAMxJ,QAAN,EAAmB;CAC1B,wDAAWwJ,GAAX,kCAAmBxJ,QAAQ,CAACyJ,MAA5B;CACA,OAHK,EAGH,EAHG,EAILhJ,IAJK,CAIA,UAACiJ,YAAD,EAAkB;CACvB,eAAOA,YAAY,CAAClL,IAAb,KAAsBH,EAA7B;CACA,OANK,CAAP;CAOA;;;2CAGD;CACC,UAAMsL,MAAM,GAAG,KAAKvI,aAAL,GAAqBZ,QAArB,EAAf;;CACA,UAAIE,MAAM,CAACiJ,MAAD,CAAN,KAAmB,OAAvB,EACA;CACC,YAAMC,QAAQ,GAAG,KAAKvF,uBAAL,GAA+B7D,QAA/B,EAAjB;;CACA,YAAI,KAAKgB,oBAAL,GAA4BkB,QAA5B,EAAJ,EACA;CACC,2BAAUkH,QAAV;CACA;;CAED,yBAAUA,QAAV;CACA;;CAED,aAAOD,MAAP;CACA;;;kCAEY5J,OACb;CACC,UAAMsC,aAAa,GAAG,KAAKoC,kBAAL,GAA0BjE,QAA1B,GAAqC,CAArC,CAAtB;CACA,UAAMqJ,YAAY,GAAG;CACpBxH,QAAAA,aAAa,EAAEA,aAAa,KAAK,OAAlB,GAA4B,EAA5B,GAAiCA,aAD5B;CAEpBT,QAAAA,MAAM,EAAE,KAAKuC,mBAAL,EAFY;CAGpBrC,QAAAA,IAAI,EAAE;CACLqD,UAAAA,iBAAiB,EAAEvC,cAAI,CAACkH,SAAL,CAAe,KAAK5D,yBAAL,GAAiC1F,QAAjC,GAA4C,CAA5C,CAAf;CADd,SAHc;CAMpB+B,QAAAA,OAAO,EAAE;CACRC,UAAAA,GAAG,EAAE,KAAKU,eAAL,GAAuB1C,QAAvB,GAAkCmH,MAAlC,GAA2C;CADxC,SANW;CASpB1F,QAAAA,OAAO,EAAE;CACRjC,UAAAA,QAAQ,EAAE;CADF;CATW,OAArB;;CAcA,UAAI,KAAKwB,oBAAL,GAA4BkB,QAA5B,EAAJ,EACA;CACC,YAAIhC,MAAM,CAACmJ,YAAY,CAACjI,MAAd,CAAN,KAAgC,GAApC,EACA;CACCiI,UAAAA,YAAY,CAACjI,MAAb,GAAsB,GAAtB;CACA;;CAED,YAAIlB,MAAM,CAACmJ,YAAY,CAACjI,MAAd,CAAN,KAAgC,GAApC,EACA;CACCiI,UAAAA,YAAY,CAACjI,MAAb,GAAsB,GAAtB;CACA;;CAED,YAAIlB,MAAM,CAACmJ,YAAY,CAACjI,MAAd,CAAN,KAAgC,GAApC,EACA;CACCiI,UAAAA,YAAY,CAACjI,MAAb,GAAsB,GAAtB;CACA;;CAED,YAAIlB,MAAM,CAACmJ,YAAY,CAACjI,MAAd,CAAN,KAAgC,GAApC,EACA;CACCiI,UAAAA,YAAY,CAACjI,MAAb,GAAsB,GAAtB;CACA;CACD;;CAED,UACClB,MAAM,CAACmJ,YAAY,CAACjI,MAAd,CAAN,KAAgC,GAAhC,IACGlB,MAAM,CAACmJ,YAAY,CAACjI,MAAd,CAAN,KAAgC,GAFpC,EAIA;CACCiI,QAAAA,YAAY,CAAC/H,IAAb,CAAkB9B,QAAlB,GAA6B,KAAKiG,oBAAL,GAA4BzF,QAA5B,GAAuCR,QAApE;CACA;;CAED,UAAM4B,MAAM,GAAG,KAAKa,aAAL,CAAmBoH,YAAY,CAACjI,MAAhC,CAAf;;CACA,UAAI1D,cAAI,CAAC6G,aAAL,CAAmBnD,MAAnB,KAA8BA,MAAM,CAACK,OAAzC,EACA;CACC4H,QAAAA,YAAY,CAAC5H,OAAb,CAAqBjC,QAArB,GAAgC,KAAKsG,yBAAL,CAA+B1E,MAAM,CAACvD,EAAtC,EAA0CmC,QAA1C,GAAqDR,QAArF;CACA;;CAED;CACC2B,QAAAA,QAAQ,EAAEkI;CADX,SAEI,KAAKE,kBAAL,EAFJ;CAIA;;;GAlwBsCC;;;;;;;;"}