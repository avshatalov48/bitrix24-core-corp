this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};this.BX.Landing.Ui=this.BX.Landing.Ui||{};this.BX.Landing.Ui.Panel=this.BX.Landing.Ui.Panel||{};this.BX.Landing.Ui.Panel.Formsettingspanel=this.BX.Landing.Ui.Panel.Formsettingspanel||{};(function(e,t,n,s,a,i,o,r,l,u){"use strict";var c=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));n.setEventNamespace("BX.Landing.UI.Panel.FormSettingsPanel.Content.SpamProtection.KeysForm");o.Dom.addClass(n.layout,"landing-ui-form-form-keys-settings");n.getButton().renderTo(n.layout);n.value={};return n}babelHelpers.createClass(t,[{key:"getButton",value:function e(){var t=this;return this.cache.remember("button",function(){return new r.Button({text:t.options.buttonLabel,color:r.ButtonColor.LIGHT_BORDER,onclick:function e(){t.getButton().setWaiting(true);o.Runtime.loadExtension("crm.form.captcha").then(function(e){var n=e.Captcha;t.getButton().setWaiting(false);return n.open()}).then(function(e){t.value=babelHelpers.objectSpread({},e);var n=l.FormSettingsPanel.getInstance();n.getFormDictionary().captcha.hasKeys=o.Type.isStringFilled(e.key)&&o.Type.isStringFilled(e.secret);var s=n.getSidebarButtons().find(function(e){return e.isActive()});if(s){s.getLayout().click()}t.emit("onChange")})}})})}},{key:"serialize",value:function e(){return this.value}}]);return t}(i.FormSettingsForm);var g=function(e){babelHelpers.inherits(a,e);function a(e){var r;babelHelpers.classCallCheck(this,a);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(a).call(this,e));r.setEventNamespace("BX.Landing.UI.Panel.FormSettingsPanel.SpamProtection");var l=new t.HeaderCard({title:n.Loc.getMessage("LANDING_SPAM_PROTECTION_TITLE")});var c=new u.MessageCard({header:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_MESSAGE_TITLE"),description:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_MESSAGE_TEXT"),angle:false});var g=new i.FormSettingsForm({id:"type",description:null,fields:[new s.RadioButtonField({selector:"use",title:n.Loc.getMessage("LANDING_SPAM_PROTECTION_TABS_TITLE"),value:o.Text.toBoolean(r.options.formOptions.data.recaptcha.use)?"hidden":"disabled",items:[{id:"disabled",title:n.Loc.getMessage("LANDING_SPAM_PROTECTION_TAB_DISABLED"),icon:"landing-ui-spam-protection-icon-disabled"},{id:"hidden",title:n.Loc.getMessage("LANDING_SPAM_PROTECTION_TAB_HIDDEN"),icon:"landing-ui-spam-protection-icon-hidden"}]})]});r.addItem(l);r.addItem(c);r.addItem(g);g.subscribe("onChange",r.onTypeChange.bind(babelHelpers.assertThisInitialized(r)));r.onTypeChange();return r}babelHelpers.createClass(a,[{key:"hasDefaultsCaptchaKeys",value:function e(){return o.Text.toBoolean(this.options.formOptions.captcha.hasDefaults)}},{key:"hasCustomKeys",value:function e(){return o.Text.toBoolean(this.options.dictionary.captcha.hasKeys)}},{key:"onTypeChange",value:function e(){o.Dom.remove(this.getCustomKeysForm().getLayout());o.Dom.remove(this.getRequiredKeysForm().getLayout());o.Dom.remove(this.getKeysSettingsForm().getLayout());if(this.getValue().recaptcha.use){if(!this.hasDefaultsCaptchaKeys()&&!this.hasCustomKeys()){this.addItem(this.getRequiredKeysForm())}if(!this.hasDefaultsCaptchaKeys()&&this.hasCustomKeys()||this.hasDefaultsCaptchaKeys()&&this.hasCustomKeys()){this.addItem(this.getKeysSettingsForm())}if(this.hasDefaultsCaptchaKeys()&&!this.hasCustomKeys()){this.addItem(this.getCustomKeysForm())}}}},{key:"getCustomKeysForm",value:function e(){return this.cache.remember("customKeysForm",function(){return new c({title:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_KEYS_FORM_TITLE"),buttonLabel:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_KEYS_FORM_CUSTOM_BUTTON_LABEL")})})}},{key:"getRequiredKeysForm",value:function e(){return this.cache.remember("requiredKeysForm",function(){return new c({title:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_KEYS_FORM_TITLE"),buttonLabel:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_KEYS_FORM_BUTTON_LABEL"),description:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_KEYS_FORM_REQUIRED_DESCRIPTION")})})}},{key:"getKeysSettingsForm",value:function e(){return this.cache.remember("keysSettingsForm",function(){return new c({title:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_KEYS_FORM_TITLE"),buttonLabel:n.Loc.getMessage("LANDING_FORM_EDITOR_FORM_CAPTCHA_KEYS_FORM_CHANGE_BUTTON_LABEL")})})}},{key:"valueReducer",value:function e(t){return{recaptcha:babelHelpers.objectSpread({use:t.use==="hidden"},this.getKeysSettingsForm().serialize(),this.getCustomKeysForm().serialize(),this.getRequiredKeysForm().serialize())}}},{key:"onChange",value:function e(t){this.emit("onChange",babelHelpers.objectSpread({},t.getData(),{skipPrepare:true}))}}]);return a}(a.ContentWrapper);e.default=g})(this.BX.Landing.Ui.Panel.Formsettingspanel.Content=this.BX.Landing.Ui.Panel.Formsettingspanel.Content||{},BX.Landing.UI.Card,BX.Landing,BX.Landing.UI.Field,BX.Landing.UI.Panel,BX.Landing.UI.Form,BX,BX.UI,BX.Landing.UI.Panel,BX.Landing.UI.Card);
//# sourceMappingURL=spam-protection.bundle.map.js