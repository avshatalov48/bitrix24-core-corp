{"version":3,"file":"other.bundle.js","sources":["../src/internal/userselectorfield/userselectorfield.js","../src/other.js"],"sourcesContent":["import {BaseField} from 'landing.ui.field.basefield';\nimport {TagSelector} from 'ui.entity-selector';\nimport {PageObject} from 'landing.pageobject';\nimport {Dom} from 'main.core';\n\nexport default class UserSelectorField extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tDom.removeClass(this.input, 'landing-ui-field-input');\n\n\t\tthis.getTagSelector().renderTo(this.input);\n\t}\n\n\tgetTagSelector(): TagSelector\n\t{\n\t\treturn this.cache.remember('tagSelector', () => {\n\t\t\tconst root = PageObject.getRootWindow();\n\t\t\treturn new root.BX.UI.EntitySelector.TagSelector({\n\t\t\t\tid: 'user-selector',\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tid: 'user-selector',\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tactiveUsers: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tpreselectedItems: this.options.value,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': () => {\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': () => {\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetValue(): Array<number>\n\t{\n\t\treturn this.getTagSelector().getDialog().getSelectedItems().map((item) => {\n\t\t\treturn item.id;\n\t\t});\n\t}\n}","import 'ui.design-tokens';\n\nimport {HeaderCard} from 'landing.ui.card.headercard';\nimport {Loc} from 'landing.loc';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {ContentWrapper} from 'landing.ui.panel.basepresetpanel';\nimport {BaseEvent} from 'main.core.events';\nimport {Dom, Reflection, Type, Tag} from 'main.core';\nimport UserSelectorField from './internal/userselectorfield/userselectorfield';\nimport {BaseCard} from \"landing.ui.card.basecard\";\nimport './css/style.css';\n\n\nexport default class Other extends ContentWrapper\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.FormSettingsPanel.SpamProtection');\n\n\t\tconst header = new HeaderCard({\n\t\t\ttitle: Loc.getMessage('LANDING_FORM_OTHER_TITLE'),\n\t\t});\n\n\t\tconst otherForm = new FormSettingsForm({\n\t\t\tid: 'other',\n\t\t\tdescription: null,\n\t\t\tfields: [\n\t\t\t\tthis.getNameField(),\n\t\t\t\tthis.getUserSelectorField(),\n\t\t\t\tthis.getCheckWorkTimeField(),\n\t\t\t\tthis.getLanguageField(),\n\t\t\t\tthis.getUseSignField(),\n\t\t\t],\n\t\t});\n\n\t\tthis.addItem(header);\n\t\tthis.addItem(otherForm);\n\n\t\tconst idCard = new BaseCard();\n\t\tDom.style(idCard.getLayout(), {\n\t\t\tpadding: 0,\n\t\t\tmargin: 0,\n\t\t});\n\t\tconst id = this.options.formOptions.id;\n\t\tDom.append(\n\t\t\tTag.render`<div>${Loc.getMessage('LANDING_CRM_FORM_ID')}: ${id}</div>`,\n\t\t\tidCard.getBody()\n\t\t);\n\t\tthis.addItem(idCard);\n\t}\n\n\tcanRemoveCopyrights(): boolean\n\t{\n\t\treturn this.options.dictionary.sign.canRemove;\n\t}\n\n\tgetNameField(): TextField\n\t{\n\t\treturn this.cache.remember('nameField', () => {\n\t\t\treturn new TextField({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_OTHER_TITLE_NAME_TITLE'),\n\t\t\t\tselector: 'name',\n\t\t\t\ttextOnly: true,\n\t\t\t\tcontent: this.options.formOptions.name,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUseSignField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('useSignField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'useSign',\n\t\t\t\tvalue: this.options.formOptions.data.useSign ? ['useSign'] : [],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: 'useSign',\n\t\t\t\t\t\thtml: `${Loc.getMessage('LANDING_HEADER_AND_BUTTONS_SHOW_SIGN')}${this.createCopyRight()}`,\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tcompact: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUserSelectorField()\n\t{\n\t\treturn this.cache.remember('userSelectorField', () => {\n\t\t\treturn new UserSelectorField({\n\t\t\t\tselector: 'users',\n\t\t\t\ttitle: Loc.getMessage('LANDING_CRM_FORM_USER'),\n\t\t\t\tvalue: this.options.formOptions.responsible.users.reduce((acc, item) => {\n\t\t\t\t\tif (Type.isStringFilled(item) || Type.isNumber(item))\n\t\t\t\t\t{\n\t\t\t\t\t\tacc.push(['user', item]);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn acc;\n\t\t\t\t}, []),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetCheckWorkTimeField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('checkWorkTimeField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'checkWorkTime',\n\t\t\t\tcompact: true,\n\t\t\t\tvalue: [this.options.formOptions.responsible.checkWorkTime ? 'Y' : 'N'],\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_OTHER_CHECK_WORK_TIME'), value: 'Y'},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetLanguageField(): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn this.cache.remember('language', () => {\n\t\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\t\tselector: 'language',\n\t\t\t\ttitle: Loc.getMessage('LANDING_CRM_FORM_LANGUAGE'),\n\t\t\t\titems: this.options.dictionary.languages.map((item) => {\n\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t}),\n\t\t\t\tcontent: this.options.formOptions.data.language,\n\t\t\t});\n\t\t});\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tcreateCopyRight(): string\n\t{\n\t\treturn `\n\t\t\t<span class=\"landing-ui-signin\">\n\t\t\t\t<span class=\"landing-ui-sign\">${Loc.getMessage('LANDING_HEADER_AND_BUTTONS_BUTTONS_SIGN')}</span>\n\t\t\t\t<span class=\"landing-ui-sign-in\">${Loc.getMessage('LANDING_HEADER_AND_BUTTONS_BUTTONS_SIGN_BY')}</span>\n\t\t\t\t<span class=\"landing-ui-sign-24\">24</span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tvalueReducer(value: {[key: string]: any}): {[key: string]: any}\n\t{\n\t\treturn {\n\t\t\tname: value.name,\n\t\t\tdata: {\n\t\t\t\tlanguage: this.getLanguageField().getValue(),\n\t\t\t\tuseSign: value.useSign.includes('useSign'),\n\t\t\t},\n\t\t\tresponsible: {\n\t\t\t\tusers: value.users,\n\t\t\t\tcheckWorkTime: value.checkWorkTime[0] === 'Y',\n\t\t\t},\n\t\t};\n\t}\n\n\tonChange(event: BaseEvent)\n\t{\n\t\tif (!this.canRemoveCopyrights())\n\t\t{\n\t\t\tconst checkbox = this.getUseSignField();\n\n\t\t\tif (!checkbox.getValue().includes('useSign'))\n\t\t\t{\n\t\t\t\tcheckbox.setValue(['useSign']);\n\t\t\t\tif (Type.isStringFilled(this.options.dictionary.restriction.helper))\n\t\t\t\t{\n\t\t\t\t\tconst evalGlobal = Reflection.getClass('BX.evalGlobal');\n\t\t\t\t\tif (Type.isFunction(evalGlobal))\n\t\t\t\t\t{\n\t\t\t\t\t\tevalGlobal(this.options.dictionary.restriction.helper);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t}\n}"],"names":["UserSelectorField","options","Dom","removeClass","input","getTagSelector","renderTo","cache","remember","root","PageObject","getRootWindow","BX","UI","EntitySelector","TagSelector","id","dialogOptions","entities","activeUsers","preselectedItems","value","events","emit","skipPrepare","getDialog","getSelectedItems","map","item","BaseField","Other","setEventNamespace","header","HeaderCard","title","Loc","getMessage","otherForm","FormSettingsForm","description","fields","getNameField","getUserSelectorField","getCheckWorkTimeField","getLanguageField","getUseSignField","addItem","idCard","BaseCard","style","getLayout","padding","margin","formOptions","append","Tag","render","getBody","dictionary","sign","canRemove","TextField","selector","textOnly","content","name","Landing","Field","Checkbox","data","useSign","items","html","createCopyRight","compact","responsible","users","reduce","acc","Type","isStringFilled","isNumber","push","checkWorkTime","Dropdown","languages","language","getValue","includes","event","canRemoveCopyrights","checkbox","setValue","restriction","helper","evalGlobal","Reflection","getClass","isFunction","getData","ContentWrapper"],"mappings":"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"}