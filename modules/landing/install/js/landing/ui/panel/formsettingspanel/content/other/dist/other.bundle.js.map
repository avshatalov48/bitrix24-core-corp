{"version":3,"file":"other.bundle.js","sources":["../src/internal/userselectorfield/userselectorfield.js","../src/other.js"],"sourcesContent":["import {BaseField} from 'landing.ui.field.basefield';\nimport {TagSelector} from 'ui.entity-selector';\nimport {PageObject} from 'landing.pageobject';\nimport {Dom} from 'main.core';\n\nexport default class UserSelectorField extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tDom.removeClass(this.input, 'landing-ui-field-input');\n\n\t\tthis.getTagSelector().renderTo(this.input);\n\t}\n\n\tgetTagSelector(): TagSelector\n\t{\n\t\treturn this.cache.remember('tagSelector', () => {\n\t\t\tconst root = PageObject.getRootWindow();\n\t\t\treturn new root.BX.UI.EntitySelector.TagSelector({\n\t\t\t\tid: 'user-selector',\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tid: 'user-selector',\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tactiveUsers: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tpreselectedItems: this.options.value,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': () => {\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': () => {\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetValue(): Array<number>\n\t{\n\t\treturn this.getTagSelector().getDialog().getSelectedItems().map((item) => {\n\t\t\treturn item.id;\n\t\t});\n\t}\n}","import 'ui.design-tokens';\n\nimport {HeaderCard} from 'landing.ui.card.headercard';\nimport {Loc} from 'landing.loc';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {ContentWrapper} from 'landing.ui.panel.basepresetpanel';\nimport {BaseEvent} from 'main.core.events';\nimport {Dom, Reflection, Type, Tag} from 'main.core';\nimport UserSelectorField from './internal/userselectorfield/userselectorfield';\nimport {BaseCard} from \"landing.ui.card.basecard\";\nimport './css/style.css';\n\n\nexport default class Other extends ContentWrapper\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.FormSettingsPanel.SpamProtection');\n\n\t\tconst header = new HeaderCard({\n\t\t\ttitle: Loc.getMessage('LANDING_FORM_OTHER_TITLE'),\n\t\t});\n\n\t\tconst otherForm = new FormSettingsForm({\n\t\t\tid: 'other',\n\t\t\tdescription: null,\n\t\t\tfields: [\n\t\t\t\tthis.getNameField(),\n\t\t\t\tthis.getUserSelectorField(),\n\t\t\t\tthis.getCheckWorkTimeField(),\n\t\t\t\tthis.getLanguageField(),\n\t\t\t\tthis.getUseSignField(),\n\t\t\t],\n\t\t});\n\n\t\tthis.addItem(header);\n\t\tthis.addItem(otherForm);\n\n\t\tconst idCard = new BaseCard();\n\t\tDom.style(idCard.getLayout(), {\n\t\t\tpadding: 0,\n\t\t\tmargin: 0,\n\t\t});\n\t\tconst id = this.options.formOptions.id;\n\t\tDom.append(\n\t\t\tTag.render`<div>${Loc.getMessage('LANDING_CRM_FORM_ID')}: ${id}</div>`,\n\t\t\tidCard.getBody()\n\t\t);\n\t\tthis.addItem(idCard);\n\t}\n\n\tcanRemoveCopyrights(): boolean\n\t{\n\t\treturn this.options.dictionary.sign.canRemove;\n\t}\n\n\tgetNameField(): TextField\n\t{\n\t\treturn this.cache.remember('nameField', () => {\n\t\t\treturn new TextField({\n\t\t\t\ttitle: Loc.getMessage('LANDING_FORM_OTHER_TITLE_NAME_TITLE'),\n\t\t\t\tselector: 'name',\n\t\t\t\ttextOnly: true,\n\t\t\t\tcontent: this.options.formOptions.name,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUseSignField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('useSignField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'useSign',\n\t\t\t\tvalue: this.options.formOptions.data.useSign ? ['useSign'] : [],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: 'useSign',\n\t\t\t\t\t\thtml: `${Loc.getMessage('LANDING_HEADER_AND_BUTTONS_SHOW_SIGN')}${this.createCopyRight()}`,\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tcompact: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUserSelectorField()\n\t{\n\t\treturn this.cache.remember('userSelectorField', () => {\n\t\t\treturn new UserSelectorField({\n\t\t\t\tselector: 'users',\n\t\t\t\ttitle: Loc.getMessage('LANDING_CRM_FORM_USER'),\n\t\t\t\tvalue: this.options.formOptions.responsible.users.reduce((acc, item) => {\n\t\t\t\t\tif (Type.isStringFilled(item) || Type.isNumber(item))\n\t\t\t\t\t{\n\t\t\t\t\t\tacc.push(['user', item]);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn acc;\n\t\t\t\t}, []),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetCheckWorkTimeField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('checkWorkTimeField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'checkWorkTime',\n\t\t\t\tcompact: true,\n\t\t\t\tvalue: [this.options.formOptions.responsible.checkWorkTime ? 'Y' : 'N'],\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_FORM_OTHER_CHECK_WORK_TIME'), value: 'Y'},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetLanguageField(): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn this.cache.remember('language', () => {\n\t\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\t\tselector: 'language',\n\t\t\t\ttitle: Loc.getMessage('LANDING_CRM_FORM_LANGUAGE'),\n\t\t\t\titems: this.options.dictionary.languages.map((item) => {\n\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t}),\n\t\t\t\tcontent: this.options.formOptions.data.language,\n\t\t\t});\n\t\t});\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tcreateCopyRight(): string\n\t{\n\t\treturn `\n\t\t\t<span class=\"landing-ui-signin\">\n\t\t\t\t<span class=\"landing-ui-sign\">${Loc.getMessage('LANDING_HEADER_AND_BUTTONS_BUTTONS_SIGN')}</span>\n\t\t\t\t<span class=\"landing-ui-sign-in\">${Loc.getMessage('LANDING_HEADER_AND_BUTTONS_BUTTONS_SIGN_BY')}</span>\n\t\t\t\t<span class=\"landing-ui-sign-24\">24</span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tvalueReducer(value: {[key: string]: any}): {[key: string]: any}\n\t{\n\t\treturn {\n\t\t\tname: value.name,\n\t\t\tdata: {\n\t\t\t\tlanguage: this.getLanguageField().getValue(),\n\t\t\t\tuseSign: value.useSign.includes('useSign'),\n\t\t\t},\n\t\t\tresponsible: {\n\t\t\t\tusers: value.users,\n\t\t\t\tcheckWorkTime: value.checkWorkTime[0] === 'Y',\n\t\t\t},\n\t\t};\n\t}\n\n\tonChange(event: BaseEvent)\n\t{\n\t\tif (!this.canRemoveCopyrights())\n\t\t{\n\t\t\tconst checkbox = this.getUseSignField();\n\n\t\t\tif (!checkbox.getValue().includes('useSign'))\n\t\t\t{\n\t\t\t\tcheckbox.setValue(['useSign']);\n\t\t\t\tif (Type.isStringFilled(this.options.dictionary.restriction.helper))\n\t\t\t\t{\n\t\t\t\t\tconst evalGlobal = Reflection.getClass('BX.evalGlobal');\n\t\t\t\t\tif (Type.isFunction(evalGlobal))\n\t\t\t\t\t{\n\t\t\t\t\t\tevalGlobal(this.options.dictionary.restriction.helper);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t}\n}"],"names":["UserSelectorField","options","Dom","removeClass","input","getTagSelector","renderTo","cache","remember","root","PageObject","getRootWindow","BX","UI","EntitySelector","TagSelector","id","dialogOptions","entities","activeUsers","preselectedItems","value","events","emit","skipPrepare","getDialog","getSelectedItems","map","item","BaseField","Other","setEventNamespace","header","HeaderCard","title","Loc","getMessage","otherForm","FormSettingsForm","description","fields","getNameField","getUserSelectorField","getCheckWorkTimeField","getLanguageField","getUseSignField","addItem","idCard","BaseCard","style","getLayout","padding","margin","formOptions","append","Tag","render","getBody","dictionary","sign","canRemove","TextField","selector","textOnly","content","name","Landing","Field","Checkbox","data","useSign","items","html","createCopyRight","compact","responsible","users","reduce","acc","Type","isStringFilled","isNumber","push","checkWorkTime","Dropdown","languages","language","getValue","includes","event","canRemoveCopyrights","checkbox","setValue","restriction","helper","evalGlobal","Reflection","getClass","isFunction","getData","ContentWrapper"],"mappings":"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"}