{"version":3,"file":"default-values.bundle.js","sources":["../src/default-values.js"],"sourcesContent":["import {ContentWrapper} from 'landing.ui.panel.basepresetpanel';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {DefaultValueField} from 'landing.ui.field.defaultvaluefield';\nimport {HeaderCard} from 'landing.ui.card.headercard';\nimport {Loc} from 'landing.loc';\nimport {Dom, Type} from 'main.core';\nimport {MessageCard} from 'landing.ui.card.messagecard';\n\nimport './css/style.css';\n\nexport default class DefaultValues extends ContentWrapper\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.FormSettingsPanel.DefaultValues');\n\n\t\tconst header = new HeaderCard({\n\t\t\ttitle: Loc.getMessage('LANDING_FORM_SETTINGS_DEFAULT_VALUE_TITLE'),\n\t\t});\n\n\t\tconst message = new MessageCard({\n\t\t\tid: 'defaultValueMessage',\n\t\t\theader: Loc.getMessage('LANDING_FORM_SETTINGS_DEFAULT_VALUE_MESSAGE_TITLE'),\n\t\t\tdescription: Loc.getMessage('LANDING_FORM_SETTINGS_DEFAULT_VALUE_MESSAGE_DESCRIPTION'),\n\t\t\trestoreState: true,\n\t\t});\n\n\t\tconst fieldsForm = new FormSettingsForm({\n\t\t\tfields: [\n\t\t\t\tnew DefaultValueField({\n\t\t\t\t\tselector: 'presetFields',\n\t\t\t\t\tisLeadEnabled: this.options.isLeadEnabled,\n\t\t\t\t\tpersonalizationVariables: this.getPersonalizationVariables(),\n\t\t\t\t\tformOptions: {\n\t\t\t\t\t\t...this.options.formOptions,\n\t\t\t\t\t},\n\t\t\t\t\tcrmFields: {\n\t\t\t\t\t\t...this.options.crmFields,\n\t\t\t\t\t},\n\t\t\t\t\tdictionary: {\n\t\t\t\t\t\t...this.options.dictionary,\n\t\t\t\t\t},\n\t\t\t\t\titems: [\n\t\t\t\t\t\t...this.options.formOptions.presetFields,\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tif (!message.isShown())\n\t\t{\n\t\t\tfieldsForm.setOffsetTop(-36);\n\t\t}\n\n\t\tmessage.subscribe('onClose', () => {\n\t\t\tfieldsForm.setOffsetTop(-36);\n\t\t});\n\n\t\tthis.addItem(header);\n\t\tthis.addItem(message);\n\t\tthis.addItem(fieldsForm);\n\t}\n\n\tgetPersonalizationVariables(): Array<{name: string, value: string}>\n\t{\n\t\treturn this.cache.remember('personalizationVariables', () => {\n\t\t\tconst {properties} = this.options.dictionary;\n\t\t\tif (Type.isPlainObject(properties) && Type.isArrayFilled(properties.list))\n\t\t\t{\n\t\t\t\treturn properties.list\n\t\t\t\t\t.map((item) => {\n\t\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t\t})\n\t\t\t\t\t.concat([{delimiter: true}])\n\t\t\t\t\t.concat(\n\t\t\t\t\t\tthis.options.formOptions.data.fields\n\t\t\t\t\t\t\t.filter(field => {\n\t\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t\t'phone', 'email', 'date',\n\t\t\t\t\t\t\t\t\t'datetime', 'double', 'integer',\n\t\t\t\t\t\t\t\t\t'lastname', 'name', 'secondname',\n\t\t\t\t\t\t\t\t\t'string', 'text', 'money',\n\t\t\t\t\t\t\t\t].includes(field.type);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.map(field => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tname: field.label,\n\t\t\t\t\t\t\t\t\tvalue: `%${field.name.toLowerCase()}%`,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn [];\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\tconst layout = super.getLayout();\n\t\tDom.addClass(layout, 'landing-ui-default-fields-values');\n\n\t\treturn layout;\n\t}\n\n\tonChange(event: BaseEvent)\n\t{\n\t\tthis.emit('onChange', {...event.getData(), skipPrepare: true});\n\t}\n}"],"names":["DefaultValues","options","setEventNamespace","header","HeaderCard","title","Loc","getMessage","message","MessageCard","id","description","restoreState","fieldsForm","FormSettingsForm","fields","DefaultValueField","selector","isLeadEnabled","personalizationVariables","getPersonalizationVariables","formOptions","crmFields","dictionary","items","presetFields","isShown","setOffsetTop","subscribe","addItem","cache","remember","properties","Type","isPlainObject","isArrayFilled","list","map","item","name","value","concat","delimiter","data","filter","field","includes","type","label","toLowerCase","layout","Dom","addClass","event","emit","getData","skipPrepare","ContentWrapper"],"mappings":"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"}