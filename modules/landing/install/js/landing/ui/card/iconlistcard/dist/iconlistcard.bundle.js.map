{"version":3,"file":"iconlistcard.bundle.js","sources":["../src/iconlistcard.js"],"sourcesContent":["import {Dom, Event, Tag, Type} from 'main.core';\nimport {BaseEvent} from \"main.core.events\";\nimport {Loc} from 'landing.loc';\nimport {BaseCard} from 'landing.ui.card.basecard';\nimport {IconOptionsCard} from 'landing.ui.card.iconoptionscard';\n\nimport './css/style.css';\n\n/**\n * @memberOf BX.Landing.UI.Card\n */\nexport class IconListCard extends BaseCard\n{\n\titems: Map;\n\tactiveIcon: ?string;\n\titemsContainer: ?HTMLDivElement;\n\n\tconstructor(\n\t\toptions: {\n\t\t\tid?: string,\n\t\t\theader?: string,\n\t\t\tdescription?: string,\n\t\t\tcontext?: string,\n\t\t\ticon?: string,\n\t\t\tangle?: boolean,\n\t\t\tcloseable?: boolean,\n\t\t\thideActions?: boolean,\n\t\t\trestoreState?: boolean,\n\t\t\tmore?: string | () => {},\n\t\t},\n\t)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Card.IconListCard');\n\t\tthis.title = '';\n\t\tthis.items = new Map();\n\t\tthis.activeIcon = null;\n\n\t\tthis.previewOptionsCard = new IconOptionsCard();\n\t\tthis.previewOptionsCard.subscribe('onChange', this.onPreviewOptionClick.bind(this));\n\t\tDom.append(this.previewOptionsCard.getLayout(), this.getPreviewOptions());\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () =>\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-card landing-ui-card-icons\">\n\t\t\t\t\t<div class=\"landing-ui-card-header-wrapper\">\n\t\t\t\t\t\t${this.getHeader()}\n\t\t\t\t\t\t${this.getPreview()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"landing-ui-card-body-wrapper\">\n\t\t\t\t\t\t${this.getBody()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetPreview(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('preview', () =>\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-card-preview --hide\">\n\t\t\t\t\t<div class=\"landing-ui-card-preview-icon\"></div>\n\t\t\t\t\t<div class=\"landing-ui-card-preview-options\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetPreviewIcon(): HTMLElement\n\t{\n\t\treturn this.getPreview().querySelector('.landing-ui-card-preview-icon');\n\t}\n\n\tgetPreviewOptions(): HTMLElement\n\t{\n\t\treturn this.getPreview().querySelector('.landing-ui-card-preview-options');\n\t}\n\n\tsetPreviewIcon(className: string)\n\t{\n\t\tconst icon = Tag.render`<span class=\"${className}\"></span>`;\n\t\tDom.clean(this.getPreviewIcon());\n\t\tDom.append(icon, this.getPreviewIcon());\n\t}\n\n\taddItem(item: string, additional: ?{})\n\t{\n\t\tif (this.getBody().childElementCount === 0)\n\t\t{\n\t\t\tthis.itemsContainer = Tag.render`<div class=\"landing-ui-card-icons-container\"></div>`;\n\t\t\tDom.append(this.itemsContainer, this.getBody());\n\t\t}\n\n\t\tconst icon = Tag.render`\n\t\t\t<div class=\"landing-ui-card landing-ui-card-icon\">\n\t\t\t\t<span class=\"${item}\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tEvent.bind(icon, 'click', this.onItemClick.bind(this, icon, additional));\n\t\tDom.append(icon, this.itemsContainer);\n\n\t\t// todo: need?\n\t\t// duplicate control\n\t\tconst styles = getComputedStyle(icon.querySelector('span'), ':before');\n\t\trequestAnimationFrame(() => {\n\t\t\tconst content = styles.getPropertyValue('content');\n\t\t\tif (content === 'none')\n\t\t\t{\n\t\t\t\tconsole.warn('Attention, item \"' + item + '\" has no content');\n\t\t\t}\n\t\t\tif (this.items.has(content))\n\t\t\t{\n\t\t\t\ticon.hidden = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.items.set(content, true);\n\t\t\t}\n\t\t});\n\t}\n\n\tonItemClick(item: HTMLElement, additional: ?{}): void\n\t{\n\t\tconst prevActive = this.getBody().querySelector('.landing-ui-card-icon.--active');\n\t\tif (prevActive)\n\t\t{\n\t\t\tDom.removeClass(prevActive, '--active');\n\t\t}\n\t\tDom.addClass(item, '--active');\n\n\t\tthis.activeIcon = item.firstElementChild.className;\n\n\t\tif (Type.isObject(additional))\n\t\t{\n\t\t\tthis.setPreviewIcon(additional.defaultOption);\n\t\t\tthis.previewOptionsCard.setOptions(additional.options, additional.defaultOption);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setPreviewIcon(this.activeIcon);\n\t\t\tthis.previewOptionsCard.setOptions([this.activeIcon], this.activeIcon);\n\t\t}\n\t\tDom.removeClass(this.getPreview(), '--hide');\n\t}\n\n\tonPreviewOptionClick(event: BaseEvent)\n\t{\n\t\tconst option = event.getData().option;\n\t\tthis.activeIcon = option;\n\t\tthis.setPreviewIcon(option);\n\t}\n\n\tgetActiveIcon(): ?string\n\t{\n\t\treturn this.activeIcon;\n\t}\n\n\tgetActiveOptions(): [string]\n\t{\n\t\treturn this.previewOptionsCard.getOptions();\n\t}\n}\n"],"names":["IconListCard","options","setEventNamespace","title","items","Map","activeIcon","previewOptionsCard","IconOptionsCard","subscribe","onPreviewOptionClick","bind","Dom","append","getLayout","getPreviewOptions","cache","remember","Tag","render","getHeader","getPreview","getBody","querySelector","className","icon","clean","getPreviewIcon","item","additional","childElementCount","itemsContainer","Event","onItemClick","styles","getComputedStyle","requestAnimationFrame","content","getPropertyValue","console","warn","has","hidden","set","prevActive","removeClass","addClass","firstElementChild","Type","isObject","setPreviewIcon","defaultOption","setOptions","event","option","getData","getOptions","BaseCard"],"mappings":"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"}