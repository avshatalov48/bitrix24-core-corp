{"version":3,"file":"highlight.bundle.js","sources":["../src/highlight.js"],"sourcesContent":["import {Dom, Runtime, Type} from 'main.core';\nimport {PageObject} from 'landing.pageobject';\n\n/**\n * Implements interface for works with highlights\n * Implements singleton pattern\n * @memberOf BX.Landing.UI\n */\nexport class Highlight\n{\n\tconstructor()\n\t{\n\t\tthis.layout = Dom.create('div');\n\t\tDom.addClass(this.layout, 'landing-highlight-border');\n\n\t\tDom.style(this.layout, {\n\t\t\tposition: 'absolute',\n\t\t\tborder: '2px #fe541e dashed',\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t\t'z-index': 9999,\n\t\t\topacity: '.4',\n\t\t\t'pointer-events': 'none',\n\t\t\ttransform: 'translateZ(0)',\n\t\t});\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (!Highlight.instance)\n\t\t{\n\t\t\tHighlight.instance = new Highlight();\n\t\t}\n\n\t\treturn Highlight.instance;\n\t}\n\n\tstatic highlightsStore = null;\n\tstatic get highlights(): BX.Landing.Collection.BaseCollection\n\t{\n\t\tif (!Highlight.highlightsStore)\n\t\t{\n\t\t\tHighlight.highlightsStore = new BX.Landing.Collection.BaseCollection();\n\t\t}\n\n\t\treturn Highlight.highlightsStore;\n\t}\n\n\t/**\n\t * Shows highlight for node\n\t * @param {HTMLElement|HTMLElement[]} node\n\t * @param {object} [rect]\n\t */\n\tshow(node, rect)\n\t{\n\t\tthis.hide();\n\t\tif (Type.isArray(node))\n\t\t{\n\t\t\tnode.forEach((element) => {\n\t\t\t\tthis.highlightNode(element);\n\t\t\t});\n\t\t}\n\t\telse if (Type.isDomNode(node))\n\t\t{\n\t\t\tthis.highlightNode(node, rect);\n\t\t}\n\t}\n\n\t/**\n\t * Hides highlight for all nodes\n\t * @param force - if true - remove highlight immediately, without requestAnimationFrame\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\thide(force: boolean = false)\n\t{\n\t\tHighlight.highlights.forEach((item) => {\n\t\t\tif (force)\n\t\t\t{\n\t\t\t\tDom.remove(item.highlight);\n\t\t\t\titem.node.style.position = '';\n\t\t\t\titem.node.style.userSelect = '';\n\t\t\t\titem.node.style.cursor = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.DOM.write(() =>\n\t\t\t\t{\n\t\t\t\t\tDom.remove(item.highlight);\n\t\t\t\t\titem.node.style.position = '';\n\t\t\t\t\titem.node.style.userSelect = '';\n\t\t\t\t\titem.node.style.cursor = '';\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tHighlight.highlights.clear();\n\t}\n\n\t/**\n\t * @private\n\t * @param node\n\t * @param {object} rect\n\t */\n\thighlightNode(node, rect)\n\t{\n\t\tconst highlight = Runtime.clone(this.layout);\n\n\t\tif (rect)\n\t\t{\n\t\t\tBX.DOM.write(() => {\n\t\t\t\tDom.style(highlight, {\n\t\t\t\t\tposition: 'fixed',\n\t\t\t\t\twidth: `${rect.width}px`,\n\t\t\t\t\theight: `${rect.height}px`,\n\t\t\t\t\ttop: `${rect.top}px`,\n\t\t\t\t\tleft: `${rect.left}px`,\n\t\t\t\t\tright: `${rect.right}px`,\n\t\t\t\t\tbottom: `${rect.bottom}px`,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tPageObject.getInstance().view().then((frame) => {\n\t\t\t\tBX.DOM.write(() => {\n\t\t\t\t\tDom.append(highlight, frame.contentDocument.body);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.DOM.write(() => {\n\t\t\t\tDom.append(highlight, node);\n\t\t\t});\n\t\t}\n\n\t\tBX.DOM.write(() => {\n\t\t\tDom.style(node, {\n\t\t\t\tposition: 'relative',\n\t\t\t\tuserSelect: 'none',\n\t\t\t\tcursor: 'pointer',\n\t\t\t});\n\t\t});\n\n\t\tHighlight.highlights.add({node, highlight});\n\t}\n}"],"names":["Highlight","layout","Dom","create","addClass","style","position","border","top","left","right","bottom","opacity","transform","node","rect","hide","Type","isArray","forEach","element","highlightNode","isDomNode","force","highlights","item","remove","highlight","userSelect","cursor","BX","DOM","write","clear","Runtime","clone","width","height","PageObject","getInstance","view","then","frame","append","contentDocument","body","add","instance","highlightsStore","Landing","Collection","BaseCollection"],"mappings":";;;;;CAGA;CACA;CACA;CACA;CACA;;AACA,KAAaA,SAAb;CAEC,uBACA;CAAA;CACC,SAAKC,MAAL,GAAcC,aAAG,CAACC,MAAJ,CAAW,KAAX,CAAd;CACAD,IAAAA,aAAG,CAACE,QAAJ,CAAa,KAAKH,MAAlB,EAA0B,0BAA1B;CAEAC,IAAAA,aAAG,CAACG,KAAJ,CAAU,KAAKJ,MAAf,EAAuB;CACtBK,MAAAA,QAAQ,EAAE,UADY;CAEtBC,MAAAA,MAAM,EAAE,oBAFc;CAGtBC,MAAAA,GAAG,EAAE,CAHiB;CAItBC,MAAAA,IAAI,EAAE,CAJgB;CAKtBC,MAAAA,KAAK,EAAE,CALe;CAMtBC,MAAAA,MAAM,EAAE,CANc;CAOtB,iBAAW,IAPW;CAQtBC,MAAAA,OAAO,EAAE,IARa;CAStB,wBAAkB,MATI;CAUtBC,MAAAA,SAAS,EAAE;CAVW,KAAvB;CAYA;;CAnBF;CAAA;;CA0CC;CACD;CACA;CACA;CACA;CA9CA,yBA+CMC,IA/CN,EA+CYC,IA/CZ,EAgDC;CAAA;;CACC,WAAKC,IAAL;;CACA,UAAIC,cAAI,CAACC,OAAL,CAAaJ,IAAb,CAAJ,EACA;CACCA,QAAAA,IAAI,CAACK,OAAL,CAAa,UAACC,OAAD,EAAa;CACzB,UAAA,KAAI,CAACC,aAAL,CAAmBD,OAAnB;CACA,SAFD;CAGA,OALD,MAMK,IAAIH,cAAI,CAACK,SAAL,CAAeR,IAAf,CAAJ,EACL;CACC,aAAKO,aAAL,CAAmBP,IAAnB,EAAyBC,IAAzB;CACA;CACD;CAED;CACD;CACA;CACA;CACC;;CAlED;CAAA;CAAA,2BAoEC;CAAA,UADKQ,KACL,uEADsB,KACtB;CACCvB,MAAAA,SAAS,CAACwB,UAAV,CAAqBL,OAArB,CAA6B,UAACM,IAAD,EAAU;CACtC,YAAIF,KAAJ,EACA;CACCrB,UAAAA,aAAG,CAACwB,MAAJ,CAAWD,IAAI,CAACE,SAAhB;CACAF,UAAAA,IAAI,CAACX,IAAL,CAAUT,KAAV,CAAgBC,QAAhB,GAA2B,EAA3B;CACAmB,UAAAA,IAAI,CAACX,IAAL,CAAUT,KAAV,CAAgBuB,UAAhB,GAA6B,EAA7B;CACAH,UAAAA,IAAI,CAACX,IAAL,CAAUT,KAAV,CAAgBwB,MAAhB,GAAyB,EAAzB;CACA,SAND,MAQA;CACCC,UAAAA,EAAE,CAACC,GAAH,CAAOC,KAAP,CAAa,YACb;CACC9B,YAAAA,aAAG,CAACwB,MAAJ,CAAWD,IAAI,CAACE,SAAhB;CACAF,YAAAA,IAAI,CAACX,IAAL,CAAUT,KAAV,CAAgBC,QAAhB,GAA2B,EAA3B;CACAmB,YAAAA,IAAI,CAACX,IAAL,CAAUT,KAAV,CAAgBuB,UAAhB,GAA6B,EAA7B;CACAH,YAAAA,IAAI,CAACX,IAAL,CAAUT,KAAV,CAAgBwB,MAAhB,GAAyB,EAAzB;CACA,WAND;CAOA;CACD,OAlBD;CAoBA7B,MAAAA,SAAS,CAACwB,UAAV,CAAqBS,KAArB;CACA;CAED;CACD;CACA;CACA;CACA;;CAhGA;CAAA;CAAA,kCAiGenB,IAjGf,EAiGqBC,IAjGrB,EAkGC;CACC,UAAMY,SAAS,GAAGO,iBAAO,CAACC,KAAR,CAAc,KAAKlC,MAAnB,CAAlB;;CAEA,UAAIc,IAAJ,EACA;CACCe,QAAAA,EAAE,CAACC,GAAH,CAAOC,KAAP,CAAa,YAAM;CAClB9B,UAAAA,aAAG,CAACG,KAAJ,CAAUsB,SAAV,EAAqB;CACpBrB,YAAAA,QAAQ,EAAE,OADU;CAEpB8B,YAAAA,KAAK,YAAKrB,IAAI,CAACqB,KAAV,OAFe;CAGpBC,YAAAA,MAAM,YAAKtB,IAAI,CAACsB,MAAV,OAHc;CAIpB7B,YAAAA,GAAG,YAAKO,IAAI,CAACP,GAAV,OAJiB;CAKpBC,YAAAA,IAAI,YAAKM,IAAI,CAACN,IAAV,OALgB;CAMpBC,YAAAA,KAAK,YAAKK,IAAI,CAACL,KAAV,OANe;CAOpBC,YAAAA,MAAM,YAAKI,IAAI,CAACJ,MAAV;CAPc,WAArB;CASA,SAVD;CAYA2B,QAAAA,6BAAU,CAACC,WAAX,GAAyBC,IAAzB,GAAgCC,IAAhC,CAAqC,UAACC,KAAD,EAAW;CAC/CZ,UAAAA,EAAE,CAACC,GAAH,CAAOC,KAAP,CAAa,YAAM;CAClB9B,YAAAA,aAAG,CAACyC,MAAJ,CAAWhB,SAAX,EAAsBe,KAAK,CAACE,eAAN,CAAsBC,IAA5C;CACA,WAFD;CAGA,SAJD;CAKA,OAnBD,MAqBA;CACCf,QAAAA,EAAE,CAACC,GAAH,CAAOC,KAAP,CAAa,YAAM;CAClB9B,UAAAA,aAAG,CAACyC,MAAJ,CAAWhB,SAAX,EAAsBb,IAAtB;CACA,SAFD;CAGA;;CAEDgB,MAAAA,EAAE,CAACC,GAAH,CAAOC,KAAP,CAAa,YAAM;CAClB9B,QAAAA,aAAG,CAACG,KAAJ,CAAUS,IAAV,EAAgB;CACfR,UAAAA,QAAQ,EAAE,UADK;CAEfsB,UAAAA,UAAU,EAAE,MAFG;CAGfC,UAAAA,MAAM,EAAE;CAHO,SAAhB;CAKA,OAND;CAQA7B,MAAAA,SAAS,CAACwB,UAAV,CAAqBsB,GAArB,CAAyB;CAAChC,QAAAA,IAAI,EAAJA,IAAD;CAAOa,QAAAA,SAAS,EAATA;CAAP,OAAzB;CACA;CAzIF;CAAA;CAAA,kCAsBC;CACC,UAAI,CAAC3B,SAAS,CAAC+C,QAAf,EACA;CACC/C,QAAAA,SAAS,CAAC+C,QAAV,GAAqB,IAAI/C,SAAJ,EAArB;CACA;;CAED,aAAOA,SAAS,CAAC+C,QAAjB;CACA;CA7BF;CAAA;CAAA,wBAiCC;CACC,UAAI,CAAC/C,SAAS,CAACgD,eAAf,EACA;CACChD,QAAAA,SAAS,CAACgD,eAAV,GAA4B,IAAIlB,EAAE,CAACmB,OAAH,CAAWC,UAAX,CAAsBC,cAA1B,EAA5B;CACA;;CAED,aAAOnD,SAAS,CAACgD,eAAjB;CACA;CAxCF;CAAA;CAAA;6BAAahD,8BA+Ba;;;;;;;;"}