{"version":3,"file":"menu.bundle.js","sources":["../src/build-tree.js","../src/make-flat-tree.js","../src/get-node-class.js","../src/menu.js"],"sourcesContent":["export default function buildTree(root: HTMLElement, selector, parent = null, depth = 0)\n{\n\treturn [...root.querySelectorAll(selector)]\n\t\t.filter((element) => {\n\t\t\treturn element.parentElement.closest(selector) === parent;\n\t\t})\n\t\t.map((element) => {\n\t\t\tconst newDepth = depth + 1;\n\t\t\treturn {\n\t\t\t\tlayout: element,\n\t\t\t\tchildren: buildTree(element, selector, element, newDepth),\n\t\t\t\tdepth,\n\t\t\t};\n\t\t});\n}","import {MenuItem} from 'landing.menu.menuitem';\n\nexport default function makeFlatTree(tree: Array<MenuItem>, acc = []): Array<MenuItem>\n{\n\ttree.forEach((item) => {\n\t\tacc.push(item);\n\t\tmakeFlatTree(item.children, acc);\n\t});\n\n\treturn acc;\n}","export default function getNodeClass(type)\n{\n\tif (type === 'link')\n\t{\n\t\treturn BX.Landing.Block.Node.Link;\n\t}\n\n\tif (type === 'img')\n\t{\n\t\treturn BX.Landing.Block.Node.Img;\n\t}\n\n\tif (type === 'icon')\n\t{\n\t\treturn BX.Landing.Block.Node.Icon;\n\t}\n\n\tif (type === 'embed')\n\t{\n\t\treturn BX.Landing.Block.Node.Embed;\n\t}\n\n\tif (type === 'map')\n\t{\n\t\treturn BX.Landing.Block.Node.Map;\n\t}\n\n\tif (type === 'component')\n\t{\n\t\treturn BX.Landing.Block.Node.Component;\n\t}\n\n\treturn BX.Landing.Block.Node.Text;\n}","import {Event, Cache, Tag, Dom, Type, Text} from 'main.core';\nimport {Loc} from 'landing.loc';\nimport {Env} from 'landing.env';\nimport {Main} from 'landing.main';\nimport {Backend} from 'landing.backend';\nimport {MenuItem} from 'landing.menu.menuitem';\nimport {MenuForm} from 'landing.ui.form.menuform';\nimport {StylePanel} from 'landing.ui.panel.stylepanel';\nimport buildTree from './build-tree';\nimport makeFlatTree from './make-flat-tree';\nimport getNodeClass from './get-node-class';\n\nimport './css/style.css';\n\n/**\n * @memberOf BX.Landing.Menu\n */\nexport class Menu extends Event.EventEmitter\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.Menu.Menu');\n\n\t\tthis.code = options.code;\n\t\tthis.root = options.root;\n\t\tthis.block = options.block;\n\t\tthis.manifest = Object.freeze({...options.manifest});\n\t\tthis.cache = new Cache.MemoryCache();\n\n\t\tif (\n\t\t\tEnv.getInstance().getType() === 'KNOWLEDGE'\n\t\t\t|| Env.getInstance().getType() === 'GROUP'\n\t\t)\n\t\t{\n\t\t\tif (Dom.hasClass(this.root.nextElementSibling, 'landing-menu-add'))\n\t\t\t{\n\t\t\t\tDom.remove(this.root.nextElementSibling);\n\t\t\t}\n\n\t\t\tDom.addClass(this.root, 'landing-menu-root-list');\n\t\t\tDom.insertAfter(this.getAddPageLayout(), this.root);\n\t\t}\n\n\t\tEvent.bind(this.root, 'click', (event: MouseEvent) => {\n\t\t\tif (\n\t\t\t\t!StylePanel.getInstance().isShown()\n\t\t\t\t&& event.target.nodeName === 'A'\n\t\t\t)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst href = Dom.attr(event.target, 'href');\n\t\t\t\tif (href.startsWith('#landing'))\n\t\t\t\t{\n\t\t\t\t\tconst pageId = Text.toNumber(href.replace('#landing', ''));\n\t\t\t\t\tthis.reloadPage(pageId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateMenuItem(options): MenuItem\n\t{\n\t\tconst nodes = new BX.Landing.Collection.NodeCollection();\n\n\t\tObject.entries(this.manifest.nodes).forEach(([code, nodeManifest]) => {\n\t\t\tconst nodeElements = [\n\t\t\t\t...options.layout.querySelectorAll(code),\n\t\t\t].filter((nodeElement) => {\n\t\t\t\tconst elementParent = nodeElement.closest(this.manifest.item);\n\t\t\t\treturn elementParent === options.layout;\n\t\t\t});\n\n\t\t\tif (nodeElements.length > 0)\n\t\t\t{\n\t\t\t\tconst NodeClass = getNodeClass(nodeManifest.type);\n\n\t\t\t\tnodeElements.forEach((nodeElement) => {\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew NodeClass({\n\t\t\t\t\t\t\tnode: nodeElement,\n\t\t\t\t\t\t\tmanifest: {...nodeManifest, allowInlineEdit: false, menuMode: true},\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn new MenuItem({\n\t\t\tlayout: options.layout,\n\t\t\tchildren: options.children.map((itemOptions, index) => {\n\t\t\t\treturn this.createMenuItem({...itemOptions, index});\n\t\t\t}),\n\t\t\tselector: `${this.manifest.item}@${options.index}`,\n\t\t\tdepth: options.depth,\n\t\t\tnodes,\n\t\t});\n\t}\n\n\tgetTree()\n\t{\n\t\tconst {item} = this.manifest;\n\t\treturn buildTree(this.root, item)\n\t\t\t.map((options, index) => this.createMenuItem({...options, index}));\n\t}\n\n\tgetFlatTree()\n\t{\n\t\treturn makeFlatTree(this.getTree());\n\t}\n\n\tgetForm(): MenuForm\n\t{\n\t\treturn new MenuForm({\n\t\t\ttitle: 'Menu',\n\t\t\ttype: 'menu',\n\t\t\tcode: this.code,\n\t\t\tforms: this.getFlatTree().map((item) => {\n\t\t\t\treturn item.getForm();\n\t\t\t}),\n\t\t});\n\t}\n\n\tgetAddPageButton(): HTMLButtonElement\n\t{\n\t\treturn this.cache.remember('addPageButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-btn ui-btn-light-border ui-btn-icon-add ui-btn-round landing-ui-menu-add-button\"\n\t\t\t\t\tonclick=\"${this.onAddPageButtonClick.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('LANDING_MENU_CREATE_NEW_PAGE')}\n\t\t\t\t</button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageTextInputKeydown(event: KeyboardEvent)\n\t{\n\t\tif (event.keyCode === 13)\n\t\t{\n\t\t\tthis.addPage();\n\t\t}\n\t}\n\n\taddPage()\n\t{\n\t\tconst input = this.getAddPageInput();\n\t\tconst {value} = input;\n\n\t\tinput.value = '';\n\t\tinput.focus();\n\n\t\tif (Type.isStringFilled(value))\n\t\t{\n\t\t\tconst code = BX.translit(\n\t\t\t\tvalue,\n\t\t\t\t{\n\t\t\t\t\tchange_case: 'L',\n\t\t\t\t\treplace_space: '-',\n\t\t\t\t\treplace_other: '',\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tconst backend = Backend.getInstance();\n\n\t\t\tbackend\n\t\t\t\t.createPage({\n\t\t\t\t\ttitle: value,\n\t\t\t\t\tmenuCode: this.code,\n\t\t\t\t\tblockId: this.block,\n\t\t\t\t\tcode,\n\t\t\t\t})\n\t\t\t\t.then((id) => {\n\t\t\t\t\tconst li = this.createLi({\n\t\t\t\t\t\ttext: value,\n\t\t\t\t\t\thref: `#landing${id}`,\n\t\t\t\t\t\ttarget: '_self',\n\t\t\t\t\t\tchildren: [],\n\t\t\t\t\t});\n\n\t\t\t\t\tDom.append(li, this.root);\n\t\t\t\t\tDom.remove(this.getAddPageField());\n\t\t\t\t\tDom.removeClass(this.root, 'landing-menu-root-list-with-field');\n\t\t\t\t\tDom.removeClass(this.getAddPageLayout(), 'landing-menu-add-with-background');\n\n\t\t\t\t\tthis.reloadPage(id);\n\t\t\t\t});\n\t\t}\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\treloadPage(id: number)\n\t{\n\t\tconst main = Main.getInstance();\n\t\tconst url = Env.getInstance().getLandingEditorUrl({\n\t\t\tlanding: id,\n\t\t});\n\n\t\tvoid main.reloadSlider(url);\n\t}\n\n\tgetAddPageInput(): TextField\n\t{\n\t\treturn this.cache.remember('addPageTextInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"landing-menu-add-field-input\"\n\t\t\t\t\tplaceholder=\"${Loc.getMessage('LANDING_MENU_CREATE_NEW_PAGE')}\"\n\t\t\t\t\tonkeydown=\"${this.onAddPageTextInputKeydown.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageInputCloseButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst input = this.getAddPageInput();\n\n\t\tinput.value = '';\n\t\tDom.removeClass(this.root, 'landing-menu-root-list-with-field');\n\t\tDom.removeClass(this.getAddPageLayout(), 'landing-menu-add-with-background');\n\t\tDom.remove(this.getAddPageField());\n\t\tDom.append(this.getAddPageButton(), this.getAddPageLayout());\n\t}\n\n\tgetAddPageInputCloseButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInputCloseButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass=\"landing-menu-add-field-close\"\n\t\t\t\t\tonclick=\"${this.onAddPageInputCloseButtonClick.bind(this)}\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('LANDING_MENU_CLOSE_BUTTON_LABEL')}\"\n\t\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddPageInputApplyButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInputApplyButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass=\"landing-menu-add-field-apply\"\n\t\t\t\t\tonclick=\"${this.onAddPageInputApplyButtonClick.bind(this)}\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('LANDING_MENU_APPLY_BUTTON_LABEL')}\"\n\t\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageInputApplyButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.addPage();\n\t}\n\n\tgetAddPageField(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-menu-add-field\">\n\t\t\t\t\t${this.getAddPageInput()}\n\t\t\t\t\t${this.getAddPageInputApplyButton()}\n\t\t\t\t\t${this.getAddPageInputCloseButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddPageLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-menu-add\">\n\t\t\t\t\t${this.getAddPageButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tDom.addClass(this.root, 'landing-menu-root-list-with-field');\n\t\tDom.addClass(this.getAddPageLayout(), 'landing-menu-add-with-background');\n\t\tDom.prepend(this.getAddPageField(), this.getAddPageLayout());\n\t\tDom.remove(this.getAddPageButton());\n\t\tthis.getAddPageInput().focus();\n\t}\n\n\tcreateList(items, type = 'root')\n\t{\n\t\tconst {ulClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<ul class=\"${ulClassName}\">${items.map((item) => this.createLi(item, type))}</ul>\n\t\t`;\n\t}\n\n\tcreateA(item, type = 'root')\n\t{\n\t\tconst {aClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<a class=\"${aClassName}\" href=\"${item.href}\" target=\"${item.target}\">${Text.encode(item.text)}</a>\n\t\t`;\n\t}\n\n\tcreateLi(item, type = 'root')\n\t{\n\t\tconst {liClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<li class=\"${liClassName}\">\n\t\t\t\t${this.createA(item, type)}\n\t\t\t\t${item.children ? this.createList(item.children, 'children') : undefined}\n\t\t\t</li>\n\t\t`;\n\t}\n\n\trebuild(items)\n\t{\n\t\tconst newList = this.createList(items);\n\n\t\tDom.replace(this.root, newList);\n\t\tthis.root = newList;\n\t}\n}"],"names":["buildTree","root","selector","parent","depth","querySelectorAll","filter","element","parentElement","closest","map","newDepth","layout","children","makeFlatTree","tree","acc","forEach","item","push","getNodeClass","type","BX","Landing","Block","Node","Link","Img","Icon","Embed","Map","Component","Text","Menu","options","setEventNamespace","code","block","manifest","Object","freeze","cache","Cache","MemoryCache","Env","getInstance","getType","Dom","hasClass","nextElementSibling","remove","addClass","insertAfter","getAddPageLayout","Event","bind","event","StylePanel","isShown","target","nodeName","preventDefault","href","attr","startsWith","pageId","toNumber","replace","reloadPage","nodes","Collection","NodeCollection","entries","nodeManifest","nodeElements","nodeElement","elementParent","length","NodeClass","node","allowInlineEdit","menuMode","MenuItem","itemOptions","index","createMenuItem","getTree","MenuForm","title","forms","getFlatTree","getForm","remember","Tag","render","onAddPageButtonClick","Loc","getMessage","keyCode","addPage","input","getAddPageInput","value","focus","Type","isStringFilled","translit","change_case","replace_space","replace_other","backend","Backend","createPage","menuCode","blockId","then","id","li","createLi","text","append","getAddPageField","removeClass","main","Main","url","getLandingEditorUrl","landing","reloadSlider","onAddPageTextInputKeydown","getAddPageButton","onAddPageInputCloseButtonClick","onAddPageInputApplyButtonClick","getAddPageInputApplyButton","getAddPageInputCloseButton","prepend","items","ulClassName","aClassName","encode","liClassName","createA","createList","undefined","newList","EventEmitter"],"mappings":"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"}