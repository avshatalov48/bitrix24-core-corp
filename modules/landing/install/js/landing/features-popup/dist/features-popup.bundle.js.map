{"version":3,"file":"features-popup.bundle.js","sources":["../src/features-popup.js"],"sourcesContent":["import {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Cache, Dom, Event, Tag, Text, Type} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {PageObject} from 'landing.pageobject';\n\nimport 'ui.fonts.opensans';\nimport './css/style.css';\n\ntype FeaturesPopupItemOptions = {\n\tid: string,\n\ttitle?: string,\n\ttheme?: string,\n\ticon?: {\n\t\tclassName: string,\n\t\tonClick: (event: BaseEvent) => void,\n\t},\n\tlink?: {\n\t\tlabel: string,\n\t\tonClick: (event: BaseEvent) => void,\n\t},\n\tactionButton?: {\n\t\tlabel: string,\n\t\tonClick: (event: BaseEvent) => void,\n\t},\n\tonClick?: (event: BaseEvent) => void,\n};\n\ntype FeaturesPopupOptions = {\n\tbindElement: HTMLElement,\n\titems: Array<FeaturesPopupItemOptions>,\n\tevents: {\n\t\tonShow: (event: BaseEvent) => void,\n\t\tonClose: (event: BaseEvent) => void,\n\t},\n};\n\nexport class FeaturesPopup extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tstatic Themes = {\n\t\tHighlight: 'highlight',\n\t};\n\n\tconstructor(options: FeaturesPopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Landing.FeaturesPopup');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.setOptions(options);\n\n\t\tEvent.bind(PageObject.getEditorWindow().document, 'click', () => {\n\t\t\tthis.hide();\n\t\t});\n\t}\n\n\tsetOptions(options: FeaturesPopupOptions)\n\t{\n\t\tthis.#cache.set('options', {...options});\n\t}\n\n\tgetOptions(): FeaturesPopupOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new Popup({\n\t\t\t\tid: `landing-features-popup-${Text.getRandom()}`,\n\t\t\t\tbindElement: this.getOptions().bindElement,\n\t\t\t\tcontent: this.#getContent(),\n\t\t\t\tclassName: 'landing-features-popup',\n\t\t\t\twidth: 410,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tnoAllPaddings : true,\n\t\t\t\tangle: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\toffset: 115\n\t\t\t\t},\n\t\t\t\tminWidth: 410,\n\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\tbackground: '#E9EAED',\n\t\t\t});\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#getPopup().show();\n\t\tthis.emit('onShow');\n\t}\n\n\thide(): void\n\t{\n\t\tthis.#getPopup().close();\n\t\tthis.emit('onClose');\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.#getPopup().isShown();\n\t}\n\n\t#getContent(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-features-popup-content\">\n\t\t\t\t\t${this.getOptions().items.map((options) => {\n\t\t\t\t\t\treturn FeaturesPopup.createRow(options);\t\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tstatic createContentBlock(options: FeaturesPopupItemOptions | Array<FeaturesPopupItemOptions>): HTMLDivElement | Array<HTMLDivElement>\n\t{\n\t\tif (Type.isArray(options))\n\t\t{\n\t\t\treturn options.map((optionsItem) => {\n\t\t\t\treturn FeaturesPopup.createContentBlock(optionsItem);\n\t\t\t});\n\t\t}\n\n\t\tconst getTitle = () => {\n\t\t\tif (Type.isStringFilled(options.title))\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"landing-features-popup-content-block-text-title\">\n\t\t\t\t\t\t${Text.encode(options.title)}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t};\n\n\t\tconst getLink = () => {\n\t\t\tif (\n\t\t\t\tType.isPlainObject(options.link)\n\t\t\t\t&& Type.isStringFilled(options.link.label)\n\t\t\t\t&& Type.isFunction(options.link.onClick)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"landing-features-popup-content-block-text-link\"\n\t\t\t\t\t\tonclick=\"${options.link.onClick}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${Text.encode(options.link.label)}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t};\n\n\t\tconst getActionButton = () => {\n\t\t\tif (\n\t\t\t\tType.isPlainObject(options.actionButton)\n\t\t\t\t&& Type.isStringFilled(options.actionButton.label)\n\t\t\t\t&& Type.isFunction(options.actionButton.onClick)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"landing-features-popup-content-block-action\">\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tclass=\"ui-btn ui-btn-xs ui-btn-round ui-btn-no-caps ui-btn-light-border\"\n\t\t\t\t\t\t\tonclick=\"${options.actionButton.onClick}\"\n\t\t\t\t\t\t>${Text.encode(options.actionButton.label)}</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t};\n\n\t\tconst getTextBlock = () => {\n\t\t\tconst title = getTitle();\n\t\t\tconst link = getLink();\n\t\t\tif (title || link)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"landing-features-popup-content-block-text\">\n\t\t\t\t\t\t${getTitle()}\n\t\t\t\t\t\t${getLink()}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t};\n\n\t\tconst getIcon = () => {\n\t\t\tif (Type.isPlainObject(options.icon))\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"landing-features-popup-content-block-icon\">\n\t\t\t\t\t\t<div class=\"ui-icon ui-icon-md ${options.icon.className}\">\n\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t};\n\n\t\tconst blockClass = (() => {\n\t\t\tlet result = '';\n\t\t\tif (Type.isFunction(options.onClick))\n\t\t\t{\n\t\t\t\tresult += ' landing-features-popup-content-block-clickable';\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(options.theme))\n\t\t\t{\n\t\t\t\tresult += ` landing-features-popup-content-block-theme-${options.theme}`;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t})();\n\n\t\tconst block = Tag.render`\n\t\t\t<div \n\t\t\t\tclass=\"landing-features-popup-content-block${blockClass}\"\n\t\t\t\tdata-id=\"${Text.encode(options.id || Text.getRandom())}\"\n\t\t\t>\n\t\t\t\t${getIcon()}\n\t\t\t\t${getTextBlock()}\n\t\t\t\t${getActionButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (Type.isFunction(options.onClick))\n\t\t{\n\t\t\tEvent.bind(block, 'click', options.onClick);\n\t\t}\n\n\t\tif (Type.isStringFilled(options.backgroundColor))\n\t\t{\n\t\t\tDom.style(block, 'background-color', options.backgroundColor);\n\t\t}\n\n\t\treturn block;\n\t}\n\n\tstatic createRow(options: FeaturesPopupItemOptions): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-features-popup-content-row\">\n\t\t\t\t${FeaturesPopup.createContentBlock(options)}\n\t\t\t</div>\n\t\t`;\n\t}\n}"],"names":["FeaturesPopup","EventEmitter","constructor","options","Cache","MemoryCache","setEventNamespace","subscribeFromOptions","events","setOptions","Event","bind","PageObject","getEditorWindow","document","hide","set","getOptions","get","show","emit","close","isShown","createContentBlock","Type","isArray","map","optionsItem","getTitle","isStringFilled","title","Tag","render","Text","encode","getLink","isPlainObject","link","label","isFunction","onClick","getActionButton","actionButton","getTextBlock","getIcon","icon","className","blockClass","result","theme","block","id","getRandom","backgroundColor","Dom","style","createRow","remember","Popup","bindElement","content","width","autoHide","closeByEsc","noAllPaddings","angle","position","offset","minWidth","contentBackground","background","items","Themes","Highlight"],"mappings":";;;;;;;;;;;;;;;;;;;;AAoCA,CAAO,MAAMA,aAAN,SAA4BC,6BAA5B,CACP;CAOCC,EAAAA,WAAW,CAACC,QAAD,EACX;CACC;CADD;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA,aAPS,IAAIC,eAAK,CAACC,WAAV;CAOT;CAEC,SAAKC,iBAAL,CAAuB,0BAAvB;CACA,SAAKC,oBAAL,CAA0BJ,QAAO,CAACK,MAAlC;CACA,SAAKC,UAAL,CAAgBN,QAAhB;CAEAO,IAAAA,eAAK,CAACC,IAAN,CAAWC,6BAAU,CAACC,eAAX,GAA6BC,QAAxC,EAAkD,OAAlD,EAA2D,MAAM;CAChE,WAAKC,IAAL;CACA,KAFD;CAGA;;CAEDN,EAAAA,UAAU,CAACN,OAAD,EACV;CACC,kEAAYa,GAAZ,CAAgB,SAAhB,EAA2B,EAAC,GAAGb;CAAJ,KAA3B;CACA;;CAEDc,EAAAA,UAAU,GACV;CACC,WAAO,8DAAYC,GAAZ,CAAgB,SAAhB,EAA2B,EAA3B,CAAP;CACA;;CAyBDC,EAAAA,IAAI,GACJ;CACC,0EAAiBA,IAAjB;;CACA,SAAKC,IAAL,CAAU,QAAV;CACA;;CAEDL,EAAAA,IAAI,GACJ;CACC,0EAAiBM,KAAjB;;CACA,SAAKD,IAAL,CAAU,SAAV;CACA;;CAEDE,EAAAA,OAAO,GACP;CACC,WAAO,sEAAiBA,OAAjB,EAAP;CACA;;CAewB,SAAlBC,kBAAkB,CAACpB,OAAD,EACzB;CACC,QAAIqB,cAAI,CAACC,OAAL,CAAatB,OAAb,CAAJ,EACA;CACC,aAAOA,OAAO,CAACuB,GAAR,CAAaC,WAAD,IAAiB;CACnC,eAAO3B,aAAa,CAACuB,kBAAd,CAAiCI,WAAjC,CAAP;CACA,OAFM,CAAP;CAGA;;CAED,UAAMC,QAAQ,GAAG,MAAM;CACtB,UAAIJ,cAAI,CAACK,cAAL,CAAoB1B,OAAO,CAAC2B,KAA5B,CAAJ,EACA;CACC,eAAOC,aAAG,CAACC,MAAX,cAAkB;;QAAlB,CAE+B;;KAF/B,GAEIC,cAAI,CAACC,MAAL,CAAY/B,OAAO,CAAC2B,KAApB,CAFJ;CAKA;;CAED,aAAO,EAAP;CACA,KAXD;;CAaA,UAAMK,OAAO,GAAG,MAAM;CACrB,UACCX,cAAI,CAACY,aAAL,CAAmBjC,OAAO,CAACkC,IAA3B,KACGb,cAAI,CAACK,cAAL,CAAoB1B,OAAO,CAACkC,IAAR,CAAaC,KAAjC,CADH,IAEGd,cAAI,CAACe,UAAL,CAAgBpC,OAAO,CAACkC,IAAR,CAAaG,OAA7B,CAHJ,EAKA;CACC,eAAOT,aAAG,CAACC,MAAX,gBAAkB;;;iBAAlB,CAGkC;;QAHlC,CAKoC;;KALpC,GAGa7B,OAAO,CAACkC,IAAR,CAAaG,OAH1B,EAKIP,cAAI,CAACC,MAAL,CAAY/B,OAAO,CAACkC,IAAR,CAAaC,KAAzB,CALJ;CAQA;;CAED,aAAO,EAAP;CACA,KAlBD;;CAoBA,UAAMG,eAAe,GAAG,MAAM;CAC7B,UACCjB,cAAI,CAACY,aAAL,CAAmBjC,OAAO,CAACuC,YAA3B,KACGlB,cAAI,CAACK,cAAL,CAAoB1B,OAAO,CAACuC,YAAR,CAAqBJ,KAAzC,CADH,IAEGd,cAAI,CAACe,UAAL,CAAgBpC,OAAO,CAACuC,YAAR,CAAqBF,OAArC,CAHJ,EAKA;CACC,eAAOT,aAAG,CAACC,MAAX,gBAAkB;;;;kBAAlB,CAI2C;SAJ3C,CAK6C;;KAL7C,GAIc7B,OAAO,CAACuC,YAAR,CAAqBF,OAJnC,EAKKP,cAAI,CAACC,MAAL,CAAY/B,OAAO,CAACuC,YAAR,CAAqBJ,KAAjC,CALL;CAQA;;CAED,aAAO,EAAP;CACA,KAlBD;;CAoBA,UAAMK,YAAY,GAAG,MAAM;CAC1B,YAAMb,KAAK,GAAGF,QAAQ,EAAtB;CACA,YAAMS,IAAI,GAAGF,OAAO,EAApB;;CACA,UAAIL,KAAK,IAAIO,IAAb,EACA;CACC,eAAON,aAAG,CAACC,MAAX,gBAAkB;;QAAlB,CAEe;QAFf,CAGc;;KAHd,GAEIJ,QAAQ,EAFZ,EAGIO,OAAO,EAHX;CAMA;;CAED,aAAO,EAAP;CACA,KAdD;;CAgBA,UAAMS,OAAO,GAAG,MAAM;CACrB,UAAIpB,cAAI,CAACY,aAAL,CAAmBjC,OAAO,CAAC0C,IAA3B,CAAJ,EACA;CACC,eAAOd,aAAG,CAACC,MAAX,gBAAkB;;uCAAlB,CAE0D;;;;KAF1D,GAEmC7B,OAAO,CAAC0C,IAAR,CAAaC,SAFhD;CAOA;;CAED,aAAO,EAAP;CACA,KAbD;;CAeA,UAAMC,UAAU,GAAG,CAAC,MAAM;CACzB,UAAIC,MAAM,GAAG,EAAb;;CACA,UAAIxB,cAAI,CAACe,UAAL,CAAgBpC,OAAO,CAACqC,OAAxB,CAAJ,EACA;CACCQ,QAAAA,MAAM,IAAI,iDAAV;CACA;;CAED,UAAIxB,cAAI,CAACK,cAAL,CAAoB1B,OAAO,CAAC8C,KAA5B,CAAJ,EACA;CACCD,QAAAA,MAAM,IAAK,+CAA8C7C,OAAO,CAAC8C,KAAM,EAAvE;CACA;;CAED,aAAOD,MAAP;CACA,KAbkB,GAAnB;;CAeA,UAAME,KAAK,GAAGnB,aAAG,CAACC,MAAP,gBAAc;;iDAAd,CAE+C;eAF/C,CAG8C;;MAH9C,CAKG;MALH,CAMQ;MANR,CAOW;;GAPX,GAEoCe,UAFpC,EAGEd,cAAI,CAACC,MAAL,CAAY/B,OAAO,CAACgD,EAAR,IAAclB,cAAI,CAACmB,SAAL,EAA1B,CAHF,EAKPR,OAAO,EALA,EAMPD,YAAY,EANL,EAOPF,eAAe,EAPR,CAAX;;CAWA,QAAIjB,cAAI,CAACe,UAAL,CAAgBpC,OAAO,CAACqC,OAAxB,CAAJ,EACA;CACC9B,MAAAA,eAAK,CAACC,IAAN,CAAWuC,KAAX,EAAkB,OAAlB,EAA2B/C,OAAO,CAACqC,OAAnC;CACA;;CAED,QAAIhB,cAAI,CAACK,cAAL,CAAoB1B,OAAO,CAACkD,eAA5B,CAAJ,EACA;CACCC,MAAAA,aAAG,CAACC,KAAJ,CAAUL,KAAV,EAAiB,kBAAjB,EAAqC/C,OAAO,CAACkD,eAA7C;CACA;;CAED,WAAOH,KAAP;CACA;;CAEe,SAATM,SAAS,CAACrD,OAAD,EAChB;CACC,WAAO4B,aAAG,CAACC,MAAX,gBAAkB;;MAAlB,CAE8C;;GAF9C,GAEIhC,aAAa,CAACuB,kBAAd,CAAiCpB,OAAjC,CAFJ;CAKA;;CA7NF;;uBA8BC;CACC,SAAO,8DAAYsD,QAAZ,CAAqB,OAArB,EAA8B,MAAM;CAC1C,WAAO,IAAIC,gBAAJ,CAAU;CAChBP,MAAAA,EAAE,EAAG,0BAAyBlB,cAAI,CAACmB,SAAL,EAAiB,EAD/B;CAEhBO,MAAAA,WAAW,EAAE,KAAK1C,UAAL,GAAkB0C,WAFf;CAGhBC,MAAAA,OAAO,0CAAE,IAAF,6BAHS;CAIhBd,MAAAA,SAAS,EAAE,wBAJK;CAKhBe,MAAAA,KAAK,EAAE,GALS;CAMhBC,MAAAA,QAAQ,EAAE,IANM;CAOhBC,MAAAA,UAAU,EAAE,IAPI;CAQhBC,MAAAA,aAAa,EAAG,IARA;CAShBC,MAAAA,KAAK,EAAE;CACNC,QAAAA,QAAQ,EAAE,KADJ;CAENC,QAAAA,MAAM,EAAE;CAFF,OATS;CAahBC,MAAAA,QAAQ,EAAE,GAbM;CAchBC,MAAAA,iBAAiB,EAAE,aAdH;CAehBC,MAAAA,UAAU,EAAE;CAfI,KAAV,CAAP;CAiBA,GAlBM,CAAP;CAmBA;;yBAoBD;CACC,SAAO,8DAAYb,QAAZ,CAAqB,SAArB,EAAgC,MAAM;CAC5C,WAAO1B,aAAG,CAACC,MAAX,gBAAkB;;OAAlB,CAIK;;IAJL,GAEI,KAAKf,UAAL,GAAkBsD,KAAlB,CAAwB7C,GAAxB,CAA6BvB,OAAD,IAAa;CAC1C,aAAOH,aAAa,CAACwD,SAAd,CAAwBrD,OAAxB,CAAP;CACA,KAFC,CAFJ;CAOA,GARM,CAAP;CASA;;CAjFWH,cAILwE,SAAS;CACfC,EAAAA,SAAS,EAAE;CADI;;;;;;;;"}