{"version":3,"file":"text.bundle.js","sources":["../src/text.js"],"sourcesContent":["import { Node } from 'landing.node';\nimport TableEditor from 'landing.node.text.tableeditor';\n\nconst escapeText = BX.Landing.Utils.escapeText;\nconst headerTagMatcher = BX.Landing.Utils.Matchers.headerTag;\nconst changeTagName = BX.Landing.Utils.changeTagName;\nconst textToPlaceholders = BX.Landing.Utils.textToPlaceholders;\n\nexport class Text extends Node\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.type = 'text';\n\t\tthis.tableBaseFontSize = '22';\n\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.onPaste = this.onPaste.bind(this);\n\t\tthis.onDrop = this.onDrop.bind(this);\n\t\tthis.onInput = this.onInput.bind(this);\n\t\tthis.onKeyDown = this.onKeyDown.bind(this);\n\t\tthis.onMousedown = this.onMousedown.bind(this);\n\t\tthis.onMouseup = this.onMouseup.bind(this);\n\n\t\t// Bind on node events\n\t\tthis.node.addEventListener('mousedown', this.onMousedown);\n\t\tthis.node.addEventListener('click', this.onClick);\n\t\tthis.node.addEventListener('paste', this.onPaste);\n\t\tthis.node.addEventListener('drop', this.onDrop);\n\t\tthis.node.addEventListener('input', this.onInput);\n\t\tthis.node.addEventListener('keydown', this.onKeyDown);\n\n\t\tdocument.addEventListener('mouseup', this.onMouseup);\n\t}\n\n\t/**\n\t * Handles allow inline edit event\n\t */\n\tonAllowInlineEdit()\n\t{\n\t\t// Show title \"Click to edit\" for node\n\t\tthis.node.setAttribute('title', escapeText(BX.Landing.Loc.getMessage('LANDING_TITLE_OF_TEXT_NODE')));\n\t}\n\n\t/**\n\t * Handles change event\n\t * @param {boolean} [preventAdjustPosition]\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tonChange(preventAdjustPosition, preventHistory)\n\t{\n\t\tsuper.onChange.call(this, preventHistory);\n\t\tif (!preventAdjustPosition)\n\t\t{\n\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().adjustPosition(this.node);\n\t\t}\n\n\t\tif (!preventHistory)\n\t\t{\n\t\t\tBX.Landing.History.getInstance().push();\n\t\t}\n\t}\n\n\tonKeyDown(event)\n\t{\n\t\tif (event.code === 'Backspace')\n\t\t{\n\t\t\tthis.onBackspaceDown(event);\n\t\t}\n\t\tthis.onInput(event);\n\t}\n\n\tonInput(event)\n\t{\n\t\tclearTimeout(this.inputTimeout);\n\n\t\tconst key = event.keyCode || event.which;\n\n\t\tif (!(key === 90 && (/win/i.test(top.window.navigator.userAgent) ? event.ctrlKey : event.metaKey)))\n\t\t{\n\t\t\tthis.inputTimeout = setTimeout(() => {\n\t\t\t\tif (this.lastValue !== this.getValue())\n\t\t\t\t{\n\t\t\t\t\tthis.onChange(true);\n\t\t\t\t\tthis.lastValue = this.getValue();\n\t\t\t\t}\n\t\t\t}, 400);\n\t\t}\n\n\t\tif (this.isTable(event))\n\t\t{\n\t\t\tconst tableFontSize = parseInt(window.getComputedStyle(event.srcElement).getPropertyValue('font-size'), 10);\n\t\t\tif (\n\t\t\t\tevent.srcElement.textContent === ''\n\t\t\t\t&& BX.Dom.hasClass(event.srcElement, 'landing-table-td')\n\t\t\t\t&& tableFontSize < this.tableBaseFontSize\n\t\t\t)\n\t\t\t{\n\t\t\t\tBX.Dom.addClass(event.srcElement, 'landing-table-td-height');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Dom.removeClass(event.srcElement, 'landing-table-td-height');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Handles escape press event\n\t */\n\tonEscapePress()\n\t{\n\t\t// Hide editor by press on Escape button\n\t\tif (this.isEditable())\n\t\t{\n\t\t\tif (this === BX.Landing.Node.Text.currentNode)\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\n\t\t\tthis.disableEdit();\n\t\t}\n\t}\n\n\t/**\n\t * Handles drop event on this node\n\t *\n\t * @param {DragEvent} event\n\t */\n\tonDrop(event)\n\t{\n\t\t// Prevents drag and drop any content into editor area\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * Handles paste event on this node\n\t *\n\t * @param {ClipboardEvent} event\n\t * @param {function} event.preventDefault\n\t * @param {object} event.clipboardData\n\t */\n\tonPaste(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (event.clipboardData && event.clipboardData.getData)\n\t\t{\n\t\t\tconst sourceText = event.clipboardData.getData('text/plain');\n\t\t\tlet encodedText = BX.Text.encode(sourceText);\n\t\t\tif (this.isLinkPasted(sourceText))\n\t\t\t{\n\t\t\t\tencodedText = this.prepareToLink(encodedText);\n\t\t\t}\n\t\t\tconst formattedHtml = encodedText.replaceAll('\\n', '<br>');\n\t\t\tdocument.execCommand('insertHTML', false, formattedHtml);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// ie11\n\t\t\tconst text = window.clipboardData.getData('text');\n\t\t\tdocument.execCommand('paste', true, BX.Text.encode(text));\n\t\t}\n\n\t\tthis.onChange();\n\t}\n\n\t/**\n\t * Handles click on document\n\t */\n\tonDocumentClick(event)\n\t{\n\t\tif (this.isEditable() && !this.fromNode)\n\t\t{\n\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\tthis.disableEdit();\n\t\t}\n\n\t\tthis.fromNode = false;\n\t}\n\n\tonMousedown(event)\n\t{\n\t\tif (!this.manifest.group)\n\t\t{\n\t\t\tthis.fromNode = true;\n\n\t\t\tif (this.manifest.allowInlineEdit !== false\n\t\t\t\t&& BX.Landing.Main.getInstance().isControlsEnabled())\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.enableEdit();\n\t\t\t\tif (this.isTable(event))\n\t\t\t\t{\n\t\t\t\t\tthis.disableEdit();\n\t\t\t\t\tBX.Landing.Node.Text.currentNode.node.querySelectorAll('.landing-table-container')\n\t\t\t\t\t\t.forEach((table) => {\n\t\t\t\t\t\t\tif (!table.hasAttribute('table-prepare'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.prepareNewTable(table);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\tconst tableFontSize = parseInt(window.getComputedStyle(event.srcElement).getPropertyValue('font-size'), 10);\n\t\t\t\t\tif (\n\t\t\t\t\t\tevent.srcElement.textContent === ''\n\t\t\t\t\t\t&& BX.Dom.hasClass(event.srcElement, 'landing-table-td')\n\t\t\t\t\t\t&& tableFontSize < this.tableBaseFontSize\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Dom.addClass(event.srcElement, 'landing-table-td-height');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Dom.removeClass(event.srcElement, 'landing-table-td-height');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (!this.manifest.textOnly && !BX.Landing.UI.Panel.StylePanel.getInstance().isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(this.node, null, this.buttons);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (BX.Landing.Node.Text.nodeTableContainerList)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.Node.Text.nodeTableContainerList.forEach((tableContainer) => {\n\t\t\t\t\t\t\ttableContainer.tableEditor.unselect(tableContainer.tableEditor);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tBX.Landing.UI.Tool.ColorPicker.hideAll();\n\t\t\t}\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (event.target.nodeName === 'A'\n\t\t\t\t\t|| event.target.parentElement.nodeName === 'A')\n\t\t\t\t{\n\t\t\t\t\tconst range = document.createRange();\n\t\t\t\t\trange.selectNode(event.target);\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tonMouseup()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.fromNode = false;\n\t\t}, 10);\n\t}\n\n\t/**\n\t * Click on field - switch edit mode.\n\t */\n\tonClick(event)\n\t{\n\t\tif (this.isTable(event))\n\t\t{\n\t\t\tthis.addTableButtons(event);\n\t\t}\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tthis.fromNode = false;\n\n\t\tif (event.target.nodeName === 'A'\n\t\t\t|| event.target.parentElement.nodeName === 'A')\n\t\t{\n\t\t\tconst range = document.createRange();\n\t\t\trange.selectNode(event.target);\n\t\t\twindow.getSelection().removeAllRanges();\n\t\t\twindow.getSelection().addRange(range);\n\t\t}\n\t}\n\n\t/**\n\t * Checks that is editable\n\t * @return {boolean}\n\t */\n\tisEditable(): boolean\n\t{\n\t\treturn this.node.isContentEditable;\n\t}\n\n\t/**\n\t * Enables edit mode\n\t */\n\tenableEdit(): void\n\t{\n\t\tconst currentNode = BX.Landing.Node.Text.currentNode;\n\t\tif (currentNode)\n\t\t{\n\t\t\tconst node = BX.Landing.Node.Text.currentNode.node;\n\t\t\tconst nodeTableContainerList = node.querySelectorAll('.landing-table-container');\n\t\t\tif (nodeTableContainerList.length > 0)\n\t\t\t{\n\t\t\t\tnodeTableContainerList.forEach((nodeTableContainer) => {\n\t\t\t\t\tif (!nodeTableContainer.tableEditor)\n\t\t\t\t\t{\n\t\t\t\t\t\tnodeTableContainer.tableEditor = new TableEditor(nodeTableContainer);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tBX.Landing.Node.Text.nodeTableContainerList = nodeTableContainerList;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.isEditable() && !BX.Landing.UI.Panel.StylePanel.getInstance().isShown())\n\t\t{\n\t\t\tif (this !== BX.Landing.Node.Text.currentNode && BX.Landing.Node.Text.currentNode !== null)\n\t\t\t{\n\t\t\t\tBX.Landing.Node.Text.currentNode.disableEdit();\n\t\t\t}\n\n\t\t\tBX.Landing.Node.Text.currentNode = this;\n\n\t\t\tthis.buttons = [];\n\t\t\tthis.buttons.push(this.getDesignButton());\n\n\t\t\tif (BX.Landing.Main.getInstance().options.allow_ai_text)\n\t\t\t{\n\t\t\t\tthis.buttons.push(this.getAiTextButton());\n\t\t\t}\n\n\t\t\tif (this.isHeader())\n\t\t\t{\n\t\t\t\tthis.buttons.push(this.getChangeTagButton());\n\t\t\t\tthis.getChangeTagButton().onChangeHandler = this.onChangeTag.bind(this);\n\t\t\t}\n\n\t\t\tthis.lastValue = this.getValue();\n\t\t\tthis.node.contentEditable = true;\n\n\t\t\tthis.node.setAttribute('title', '');\n\t\t}\n\t}\n\n\t/**\n\t * Gets design button for editor\n\t * @return {BX.Landing.UI.Button.Design}\n\t */\n\tgetDesignButton(): BX.Landing.UI.Button.Design\n\t{\n\t\tif (!this.designButton)\n\t\t{\n\t\t\tthis.designButton = new BX.Landing.UI.Button.Design('design', {\n\t\t\t\thtml: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DESIGN'),\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DESIGN') },\n\t\t\t\tonClick: function() {\n\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t\t\tthis.disableEdit();\n\t\t\t\t\tthis.onDesignShow(this.manifest.code);\n\t\t\t\t}.bind(this),\n\t\t\t});\n\t\t}\n\n\t\treturn this.designButton;\n\t}\n\n\t/**\n\t * Gets AI (text) button for editor\n\t * @return {BX.Landing.UI.Button.AiText}\n\t */\n\tgetAiTextButton(): BX.Landing.UI.Button.AiText\n\t{\n\t\tif (!this.aiTextButton)\n\t\t{\n\t\t\tthis.aiTextButton = new BX.Landing.UI.Button.AiText.getInstance('ai_text', {\n\t\t\t\thtml: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_AI_TEXT'),\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_AI_TEXT') },\n\t\t\t\tsections: this.manifest.sections,\n\t\t\t\tonSelect: function(item) {\n\t\t\t\t\tthis.node.innerHTML = item.data.replaceAll(/(\\r\\n|\\r|\\n)/g, '<br>');\n\t\t\t\t\tthis.onChange();\n\t\t\t\t}.bind(this),\n\t\t\t});\n\t\t}\n\n\t\treturn this.aiTextButton;\n\t}\n\n\t/**\n\t * Disables edit mode\n\t */\n\tdisableEdit()\n\t{\n\t\tif (this.isEditable())\n\t\t{\n\t\t\tthis.node.contentEditable = false;\n\n\t\t\tif (this.lastValue !== this.getValue())\n\t\t\t{\n\t\t\t\tthis.onChange();\n\t\t\t\tthis.lastValue = this.getValue();\n\t\t\t}\n\n\t\t\tif (this.isAllowInlineEdit())\n\t\t\t{\n\t\t\t\tthis.node.setAttribute('title', escapeText(BX.Landing.Loc.getMessage('LANDING_TITLE_OF_TEXT_NODE')));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets form field\n\t * @return {BX.Landing.UI.Field.Text}\n\t */\n\tgetField(): BX.Landing.UI.Field.Text\n\t{\n\t\tif (this.field)\n\t\t{\n\t\t\tthis.field.setValue(this.node.innerHTML);\n\t\t\tthis.field.content = this.node.innerHTML;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.field = new BX.Landing.UI.Field.Text({\n\t\t\t\tselector: this.selector,\n\t\t\t\ttitle: this.manifest.name,\n\t\t\t\tcontent: this.node.innerHTML,\n\t\t\t\ttextOnly: this.manifest.textOnly,\n\t\t\t\tbind: this.node,\n\t\t\t});\n\n\t\t\tif (this.isHeader())\n\t\t\t{\n\t\t\t\tthis.field.changeTagButton = this.getChangeTagButton();\n\t\t\t}\n\t\t}\n\n\t\treturn this.field;\n\t}\n\n\t/**\n\t * Sets node value\n\t * @param value\n\t * @param {?boolean} [preventSave = false]\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tsetValue(value, preventSave, preventHistory)\n\t{\n\t\tthis.preventSave(preventSave);\n\t\tthis.lastValue = this.isSavePrevented() ? this.getValue() : this.lastValue;\n\t\tthis.node.innerHTML = value;\n\t\tthis.onChange(false, preventHistory);\n\t}\n\n\t/**\n\t * Gets node value\n\t * @return {string}\n\t */\n\tgetValue(): string\n\t{\n\t\tif (this.node.querySelector('.landing-table-container') !== null)\n\t\t{\n\t\t\tconst node = this.node.cloneNode(true);\n\t\t\tthis.prepareTable(node);\n\n\t\t\treturn textToPlaceholders(node.innerHTML);\n\t\t}\n\n\t\treturn textToPlaceholders(this.node.innerHTML);\n\t}\n\n\t/**\n\t * Checks that this node is header\n\t * @return {boolean}\n\t */\n\tisHeader(): boolean\n\t{\n\t\treturn headerTagMatcher.test(this.node.nodeName);\n\t}\n\n\t/**\n\t * Checks that this node is table\n\t * @return {boolean}\n\t */\n\tisTable(event): boolean\n\t{\n\t\tlet nodeIsTable = false;\n\t\tif (BX.Landing.Node.Text.currentNode && event)\n\t\t{\n\t\t\tBX.Landing.Node.Text.currentNode.node.querySelectorAll('.landing-table-container')\n\t\t\t\t.forEach((table) => {\n\t\t\t\t\tif (table.contains(event.srcElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tnodeIsTable = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\treturn nodeIsTable;\n\t}\n\n\t/**\n\t * Delete br tags in new table and add flag after this\n\t */\n\tprepareNewTable(table)\n\t{\n\t\ttable.querySelectorAll('br').forEach((tdTag) => {\n\t\t\ttdTag.remove();\n\t\t});\n\t\ttable.setAttribute('table-prepare', 'true');\n\t\tBX.Landing.Node.Text.currentNode.onChange(true);\n\t}\n\n\taddTableButtons(event)\n\t{\n\t\tconst buttons = [];\n\t\tlet neededButtons = [];\n\t\tlet setTd = [];\n\t\tconst tableButtons = this.getTableButtons();\n\t\tconst tableAlignButtons = [tableButtons[0], tableButtons[1], tableButtons[2], tableButtons[3]];\n\t\tconst node = BX.Landing.Node.Text.currentNode.node;\n\t\tlet table = null;\n\t\tlet isCell = false;\n\t\tlet isButtonAddRow = false;\n\t\tlet isButtonAddCol = false;\n\t\tlet isNeedTablePanel = true;\n\t\tif (\n\t\t\tBX.Dom.hasClass(event.srcElement, 'landing-table')\n\t\t\t|| BX.Dom.hasClass(event.srcElement, 'landing-table-col-dnd')\n\t\t)\n\t\t{\n\t\t\tisNeedTablePanel = false;\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-row-add'))\n\t\t{\n\t\t\tisButtonAddRow = true;\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-col-add'))\n\t\t{\n\t\t\tisButtonAddCol = true;\n\t\t}\n\t\tlet hideButtons = [];\n\t\tconst nodeTableList = node.querySelectorAll('.landing-table');\n\t\tif (nodeTableList.length > 0)\n\t\t{\n\t\t\tnodeTableList.forEach((nodeTable) => {\n\t\t\t\tif (nodeTable.contains(event.srcElement))\n\t\t\t\t{\n\t\t\t\t\ttable = nodeTable;\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\tlet isSelectedAll;\n\n\t\ttableButtons.forEach((tableButton) => {\n\t\t\ttableButton.options.srcElement = event.srcElement;\n\t\t\ttableButton.options.node = node;\n\t\t\ttableButton.options.table = table;\n\t\t});\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-row-dnd'))\n\t\t{\n\t\t\tsetTd = event.srcElement.parentNode.children;\n\t\t\tsetTd = [...setTd];\n\t\t\tneededButtons = this.getAmountTableRows(table) > 1 ? [0, 1, 2, 3, 4, 5, 6] : [0, 1, 2, 3, 4, 5];\n\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\ttableButtons[neededButton].options.target = 'row';\n\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t});\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement.parentNode, 'landing-table-col-dnd'))\n\t\t{\n\t\t\tconst childNodes = event.srcElement.parentElement.parentElement.childNodes;\n\t\t\tconst childNodesArray = [...childNodes];\n\t\t\tconst childNodesArrayPrepare = [];\n\t\t\tchildNodesArray.forEach((childNode) => {\n\t\t\t\tif (childNode.nodeType === 1)\n\t\t\t\t{\n\t\t\t\t\tchildNodesArrayPrepare.push(childNode);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst neededPosition = childNodesArrayPrepare.indexOf(event.srcElement.parentElement);\n\t\t\tconst rows = event.srcElement.parentElement.parentElement.parentElement.childNodes;\n\t\t\trows.forEach((row) => {\n\t\t\t\tif (row.nodeType === 1)\n\t\t\t\t{\n\t\t\t\t\tconst rowChildPrepare = [];\n\t\t\t\t\trow.childNodes.forEach((rowChildNode) => {\n\t\t\t\t\t\tif (rowChildNode.nodeType === 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trowChildPrepare.push(rowChildNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (rowChildPrepare[neededPosition])\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTd.push(rowChildPrepare[neededPosition]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tneededButtons = this.getAmountTableCols(table) > 1 ? [0, 1, 2, 3, 4, 5, 7] : [0, 1, 2, 3, 4, 5];\n\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\ttableButtons[neededButton].options.target = 'col';\n\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t});\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-th-select-all'))\n\t\t{\n\t\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-th-select-all-selected'))\n\t\t\t{\n\t\t\t\tisSelectedAll = true;\n\t\t\t\tconst rows = event.srcElement.parentElement.parentElement.childNodes;\n\t\t\t\trows.forEach((row) => {\n\t\t\t\t\trow.childNodes.forEach((th) => {\n\t\t\t\t\t\tsetTd.push(th);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tneededButtons = [0, 1, 2, 3, 4, 5, 8, 9, 10];\n\t\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\t\ttableButtons[neededButton].options.target = 'table';\n\t\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tisSelectedAll = false;\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tBX.Dom.hasClass(event.srcElement, 'landing-table-td')\n\t\t\t|| event.srcElement.closest('.landing-table-td') !== null\n\t\t)\n\t\t{\n\t\t\tsetTd.push(event.srcElement);\n\t\t\tneededButtons = [3, 2, 1, 0];\n\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\ttableButtons[neededButton].options.target = 'cell';\n\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\ttableButtons[neededButton].insertAfter = 'strikeThrough';\n\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t});\n\t\t\tisCell = true;\n\t\t\thideButtons = ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull', 'createTable', 'pasteTable'];\n\t\t}\n\n\t\tlet activeAlignButtonId = null;\n\t\tconst setActiveAlignButtonId = [];\n\t\tsetTd.forEach((th) => {\n\t\t\tif (th.nodeType === 1)\n\t\t\t{\n\t\t\t\tactiveAlignButtonId = undefined;\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-left'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignLeft';\n\t\t\t\t}\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-center'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignCenter';\n\t\t\t\t}\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-right'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignRight';\n\t\t\t\t}\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-justify'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignJustify';\n\t\t\t\t}\n\t\t\t\tsetActiveAlignButtonId.push(activeAlignButtonId);\n\t\t\t}\n\t\t});\n\t\tlet count = 0;\n\t\tlet isIdentical = true;\n\t\twhile (count < setActiveAlignButtonId.length && isIdentical)\n\t\t{\n\t\t\tif (count > 0 && setActiveAlignButtonId[count] !== setActiveAlignButtonId[count - 1])\n\t\t\t{\n\t\t\t\tisIdentical = false;\n\t\t\t}\n\t\t\tcount++;\n\t\t}\n\n\t\tactiveAlignButtonId = isIdentical ? setActiveAlignButtonId[0] : undefined;\n\t\tif (activeAlignButtonId)\n\t\t{\n\t\t\ttableAlignButtons.forEach((tableAlignButton) => {\n\t\t\t\tif (tableAlignButton.id === activeAlignButtonId)\n\t\t\t\t{\n\t\t\t\t\tBX.Dom.addClass(tableAlignButton.layout, 'landing-ui-active');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (buttons[0] && buttons[1] && buttons[2] && buttons[3])\n\t\t{\n\t\t\tbuttons[0].options.alignButtons = tableAlignButtons;\n\t\t\tbuttons[1].options.alignButtons = tableAlignButtons;\n\t\t\tbuttons[2].options.alignButtons = tableAlignButtons;\n\t\t\tbuttons[3].options.alignButtons = tableAlignButtons;\n\t\t}\n\n\t\tif (!this.manifest.textOnly)\n\t\t{\n\t\t\tif (isNeedTablePanel)\n\t\t\t{\n\t\t\t\tif (!isButtonAddRow && !isButtonAddCol && table)\n\t\t\t\t{\n\t\t\t\t\tif (isCell)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(table.parentNode, null, buttons, true, hideButtons);\n\t\t\t\t\t}\n\t\t\t\t\telse if (isSelectedAll === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(table.parentNode, null, buttons, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets change tag button\n\t * @return {BX.Landing.UI.Button.ChangeTag}\n\t */\n\tgetChangeTagButton(): BX.Landing.UI.Button.ChangeTag\n\t{\n\t\tif (!this.changeTagButton)\n\t\t{\n\t\t\tthis.changeTagButton = new BX.Landing.UI.Button.ChangeTag('changeTag', {\n\t\t\t\thtml: `<span class=\"landing-ui-icon-editor-${this.node.nodeName.toLowerCase()}\"></span>`,\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_CHANGE_TAG') },\n\t\t\t\tonChange: this.onChangeTag.bind(this),\n\t\t\t});\n\t\t}\n\n\t\tthis.changeTagButton.insertAfter = 'unlink';\n\n\t\tthis.changeTagButton.activateItem(this.node.nodeName);\n\n\t\treturn this.changeTagButton;\n\t}\n\n\tgetTableButtons(): []\n\t{\n\t\tthis.buttons = [];\n\t\tthis.buttons.push(\n\t\t\tnew BX.Landing.UI.Button.AlignTable('alignLeft', {\n\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-left\"></span>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_LEFT') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.AlignTable('alignCenter', {\n\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-center\"></span>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_CENTER') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.AlignTable('alignRight', {\n\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-right\"></span>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_RIGHT') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.AlignTable('alignJustify', {\n\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-justify\"></span>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_JUSTIFY') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.TableColorAction('tableTextColor', {\n\t\t\t\ttext: BX.Landing.Loc.getMessage('EDITOR_ACTION_SET_FORE_COLOR'),\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_COLOR') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.TableColorAction('tableBgColor', {\n\t\t\t\thtml: '<i class=\"landing-ui-icon-editor-fill-color\"></i>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_CELL_BG') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.DeleteElementTable('deleteRow', {\n\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-delete\"></span>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DELETE_ROW_TABLE') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.DeleteElementTable('deleteCol', {\n\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-delete\"></span>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DELETE_COL_TABLE') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.StyleTable('styleTable', {\n\t\t\t\thtml: `\n\t\t\t\t\t${BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE')}\n\t\t\t\t\t\t<i class=\"fas fa-chevron-down g-ml-8\"></i>\n\t\t\t\t`,\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.CopyTable('copyTable', {\n\t\t\t\ttext: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY'),\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY') },\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.DeleteTable('deleteTable', {\n\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-delete\"></span>',\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_DELETE') },\n\t\t\t}),\n\t\t);\n\n\t\treturn this.buttons;\n\t}\n\n\t/**\n\t * Handles change tag event\n\t * @param value\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tonChangeTag(value, preventHistory)\n\t{\n\t\tthis.node = changeTagName(this.node, value);\n\n\t\tthis.node.addEventListener('mousedown', this.onMousedown);\n\t\tthis.node.addEventListener('click', this.onClick);\n\t\tthis.node.addEventListener('paste', this.onPaste);\n\t\tthis.node.addEventListener('drop', this.onDrop);\n\t\tthis.node.addEventListener('input', this.onInput);\n\t\tthis.node.addEventListener('keydown', this.onInput);\n\n\t\tif (!this.getField().isEditable() && !preventHistory)\n\t\t{\n\t\t\tthis.disableEdit();\n\t\t\tthis.enableEdit();\n\t\t}\n\n\t\tconst data = {};\n\t\tdata[this.selector] = value;\n\n\t\tif (!preventHistory)\n\t\t{\n\t\t\tthis.changeOptionsHandler(data)\n\t\t\t\t.then(() => {\n\t\t\t\t\tBX.Landing.History.getInstance().push();\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t}\n\t}\n\n\tgetAmountTableCols(table): number\n\t{\n\t\treturn table.querySelectorAll('.landing-table-col-dnd').length;\n\t}\n\n\tgetAmountTableRows(table): number\n\t{\n\t\treturn table.querySelectorAll('.landing-table-row-dnd').length;\n\t}\n\n\tprepareTable(node): HTMLElement\n\t{\n\t\tconst setClassesForRemove = [\n\t\t\t'table-selected-all',\n\t\t\t'landing-table-th-select-all-selected',\n\t\t\t'landing-table-cell-selected',\n\t\t\t'landing-table-row-selected',\n\t\t\t'landing-table-th-selected',\n\t\t\t'landing-table-th-selected-cell',\n\t\t\t'landing-table-th-selected-top',\n\t\t\t'landing-table-th-selected-x',\n\t\t\t'landing-table-tr-selected-left',\n\t\t\t'landing-table-tr-selected-y',\n\t\t\t'landing-table-col-selected',\n\t\t\t'landing-table-tr-selected',\n\t\t\t'table-selected-all-right',\n\t\t\t'table-selected-all-bottom',\n\t\t];\n\t\tsetClassesForRemove.forEach((className) => {\n\t\t\tnode.querySelectorAll(`.${className}`).forEach((element) => {\n\t\t\t\tBX.Dom.removeClass(element, className);\n\t\t\t});\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tonBackspaceDown(event)\n\t{\n\t\tconst selection = window.getSelection();\n\t\tconst position = selection.getRangeAt(0).startOffset;\n\t\tif (position === 0)\n\t\t{\n\t\t\tlet focusNode = selection.focusNode;\n\t\t\tif (!BX.Type.isNil(focusNode) && focusNode.nodeType !== 3)\n\t\t\t{\n\t\t\t\tif (focusNode.firstChild.nodeType === 3 && focusNode.firstChild.firstChild.nodeType === 3)\n\t\t\t\t{\n\t\t\t\t\tfocusNode = focusNode.firstChild.firstChild;\n\t\t\t\t}\n\t\t\t\telse if (focusNode.firstChild.nodeType === 3)\n\t\t\t\t{\n\t\t\t\t\tfocusNode = null;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfocusNode = focusNode.firstChild;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (focusNode)\n\t\t\t{\n\t\t\t\tconst focusNodeParent = focusNode.parentNode;\n\t\t\t\tconst allowedNodeName = new Set(['BLOCKQUOTE', 'UL']);\n\t\t\t\tif (focusNodeParent && allowedNodeName.has(focusNodeParent.nodeName))\n\t\t\t\t{\n\t\t\t\t\tconst focusNodeContainer = document.createElement('div');\n\t\t\t\t\tfocusNodeContainer.append(focusNode);\n\t\t\t\t\tfocusNodeParent.append(focusNodeContainer);\n\t\t\t\t}\n\t\t\t\tlet contentNode = focusNode.parentNode.parentNode;\n\t\t\t\twhile (contentNode && !allowedNodeName.has(contentNode.nodeName))\n\t\t\t\t{\n\t\t\t\t\tcontentNode = contentNode.parentNode;\n\t\t\t\t}\n\n\t\t\t\tif (contentNode && contentNode.childNodes.length === 1)\n\t\t\t\t{\n\t\t\t\t\tcontentNode.after(focusNode.parentNode);\n\t\t\t\t\tcontentNode.remove();\n\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisLinkPasted(text): boolean\n\t{\n\t\tconst reg = /^https?:\\/\\/(?:www\\.)?[\\w#%+.:=@~-]{1,256}\\.[\\d()A-Za-z]{1,6}\\b[\\w#%&()+./:=?@~-]*$/;\n\n\t\treturn Boolean(reg.test(text));\n\t}\n\n\tprepareToLink(text): HTMLElement\n\t{\n\t\treturn `<a class='g-bg-transparent' href='${text}' target='_blank'> ${text} </a>`;\n\t}\n}\n\nBX.Landing.Node.Text = Text;\nBX.Landing.Node.Text.currentNode = null;\n"],"names":["escapeText","BX","Landing","Utils","headerTagMatcher","Matchers","headerTag","changeTagName","textToPlaceholders","Text","Node","constructor","options","type","tableBaseFontSize","onClick","bind","onPaste","onDrop","onInput","onKeyDown","onMousedown","onMouseup","node","addEventListener","document","onAllowInlineEdit","setAttribute","Loc","getMessage","onChange","preventAdjustPosition","preventHistory","call","UI","Panel","EditorPanel","getInstance","adjustPosition","History","push","event","code","onBackspaceDown","clearTimeout","inputTimeout","key","keyCode","which","test","top","window","navigator","userAgent","ctrlKey","metaKey","setTimeout","lastValue","getValue","isTable","tableFontSize","parseInt","getComputedStyle","srcElement","getPropertyValue","textContent","Dom","hasClass","addClass","removeClass","onEscapePress","isEditable","currentNode","hide","disableEdit","preventDefault","clipboardData","getData","sourceText","encodedText","encode","isLinkPasted","prepareToLink","formattedHtml","replaceAll","execCommand","text","onDocumentClick","fromNode","manifest","group","allowInlineEdit","Main","isControlsEnabled","stopPropagation","enableEdit","querySelectorAll","forEach","table","hasAttribute","prepareNewTable","textOnly","StylePanel","isShown","show","buttons","nodeTableContainerList","tableContainer","tableEditor","unselect","Tool","ColorPicker","hideAll","requestAnimationFrame","target","nodeName","parentElement","range","createRange","selectNode","getSelection","removeAllRanges","addRange","addTableButtons","isContentEditable","length","nodeTableContainer","TableEditor","getDesignButton","allow_ai_text","getAiTextButton","isHeader","getChangeTagButton","onChangeHandler","onChangeTag","contentEditable","designButton","Button","Design","html","attrs","title","onDesignShow","aiTextButton","AiText","sections","onSelect","item","innerHTML","data","isAllowInlineEdit","getField","field","setValue","content","Field","selector","name","changeTagButton","value","preventSave","isSavePrevented","querySelector","cloneNode","prepareTable","nodeIsTable","contains","tdTag","remove","neededButtons","setTd","tableButtons","getTableButtons","tableAlignButtons","isCell","isButtonAddRow","isButtonAddCol","isNeedTablePanel","hideButtons","nodeTableList","nodeTable","isSelectedAll","tableButton","parentNode","children","getAmountTableRows","neededButton","childNodes","childNodesArray","childNodesArrayPrepare","childNode","nodeType","neededPosition","indexOf","rows","row","rowChildPrepare","rowChildNode","getAmountTableCols","th","closest","insertAfter","activeAlignButtonId","setActiveAlignButtonId","undefined","count","isIdentical","tableAlignButton","id","layout","alignButtons","ChangeTag","toLowerCase","activateItem","AlignTable","TableColorAction","DeleteElementTable","StyleTable","CopyTable","DeleteTable","changeOptionsHandler","then","catch","setClassesForRemove","className","element","selection","position","getRangeAt","startOffset","focusNode","Type","isNil","firstChild","focusNodeParent","allowedNodeName","Set","has","focusNodeContainer","createElement","append","contentNode","after","reg","Boolean"],"mappings":"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"}