{"version":3,"file":"text.bundle.js","sources":["../src/text.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {Node} from 'landing.node';\n\nexport class Text extends Node\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.escapeText = BX.Landing.Utils.escapeText;\n\t\tthis.headerTagMatcher = BX.Landing.Utils.Matchers.headerTag;\n\t\tthis.changeTagName = BX.Landing.Utils.changeTagName;\n\t\tthis.textToPlaceholders = BX.Landing.Utils.textToPlaceholders;\n\n\t\tBX.Runtime.loadExtension('landing.node.text.tableeditor');\n\t\tBX.Landing.Block.Node.apply(this, arguments);\n\n\t\tthis.type = \"text\";\n\t\tthis.tableBaseFontSize = '22';\n\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.onPaste = this.onPaste.bind(this);\n\t\tthis.onDrop = this.onDrop.bind(this);\n\t\tthis.onInput = this.onInput.bind(this);\n\t\tthis.onKeyDown = this.onKeyDown.bind(this);\n\t\tthis.onMousedown = this.onMousedown.bind(this);\n\t\tthis.onMouseup = this.onMouseup.bind(this);\n\n\t\t// Bind on node events\n\t\tthis.node.addEventListener(\"mousedown\", this.onMousedown);\n\t\tthis.node.addEventListener(\"click\", this.onClick);\n\t\tthis.node.addEventListener(\"paste\", this.onPaste);\n\t\tthis.node.addEventListener(\"drop\", this.onDrop);\n\t\tthis.node.addEventListener(\"input\", this.onInput);\n\t\tthis.node.addEventListener(\"keydown\", this.onKeyDown);\n\n\t\tdocument.addEventListener(\"mouseup\", this.onMouseup);\n\t}\n\n\tstatic currentNode = [];\n\n\t/**\n\t * Handles allow inline edit event\n\t */\n\tonAllowInlineEdit()\n\t{\n\t\t// Show title \"Click to edit\" for node\n\t\tthis.node.setAttribute(\"title\", this.escapeText(BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_TEXT_NODE\")));\n\t}\n\n\t/**\n\t * Handles change event\n\t * @param {boolean} [preventAdjustPosition]\n\t * @param {boolean} [preventHistory]\n\t */\n\tonChange(preventAdjustPosition, preventHistory)\n\t{\n\t\tthis.superClass.onChange.call(this, arguments);\n\t\tif (!preventAdjustPosition)\n\t\t{\n\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().adjustPosition(this.node);\n\t\t}\n\t\tif (!preventHistory)\n\t\t{\n\t\t\tBX.Landing.History.getInstance().push(\n\t\t\t\tnew BX.Landing.History.Entry({\n\t\t\t\t\tblock: this.getBlock().id,\n\t\t\t\t\tselector: this.selector,\n\t\t\t\t\tcommand: \"editText\",\n\t\t\t\t\tundo: this.lastValue,\n\t\t\t\t\tredo: this.getValue()\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tonKeyDown()\n\t{\n\t\tif (event.code === 'Backspace')\n\t\t{\n\t\t\tthis.onBackspaceDown(event);\n\t\t}\n\t\tthis.onInput(event);\n\t}\n\n\tonInput(event)\n\t{\n\t\tclearTimeout(this.inputTimeout);\n\n\t\tvar key = event.keyCode || event.which;\n\n\t\tif (!(key === 90 && (top.window.navigator.userAgent.match(/win/i) ? event.ctrlKey : event.metaKey)))\n\t\t{\n\t\t\tthis.inputTimeout = setTimeout(function() {\n\t\t\t\tif (this.lastValue !== this.getValue())\n\t\t\t\t{\n\t\t\t\t\tthis.onChange(true);\n\t\t\t\t\tthis.lastValue = this.getValue();\n\t\t\t\t}\n\t\t\t}.bind(this), 400);\n\t\t}\n\n\t\tif (this.isTable(event))\n\t\t{\n\t\t\tvar tableFontSize = parseInt(window.getComputedStyle(event.srcElement).getPropertyValue('font-size'));\n\t\t\tif (event.srcElement.textContent === ''\n\t\t\t\t&& event.srcElement.classList.contains('landing-table-td')\n\t\t\t\t&& tableFontSize < this.tableBaseFontSize)\n\t\t\t{\n\t\t\t\tevent.srcElement.classList.add('landing-table-td-height');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tevent.srcElement.classList.remove('landing-table-td-height');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Handles escape press event\n\t */\n\tonEscapePress()\n\t{\n\t\t// Hide editor by press on Escape button\n\t\tif (this.isEditable())\n\t\t{\n\t\t\tif (this === BX.Landing.Block.Node.Text.currentNode)\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\n\t\t\tthis.disableEdit();\n\t\t}\n\t}\n\n\t/**\n\t * Handles drop event on this node\n\t *\n\t * @param {DragEvent} event\n\t */\n\tonDrop(event)\n\t{\n\t\t// Prevents drag and drop any content into editor area\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * Handles paste event on this node\n\t *\n\t * @param {ClipboardEvent} event\n\t * @param {function} event.preventDefault\n\t * @param {object} event.clipboardData\n\t */\n\tonPaste(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (event.clipboardData && event.clipboardData.getData)\n\t\t{\n\t\t\tvar sourceText = event.clipboardData.getData(\"text/plain\");\n\t\t\tvar encodedText = BX.Text.encode(sourceText);\n\t\t\tvar formattedHtml = encodedText.replace(new RegExp('\\n', 'g'), \"<br>\");\n\t\t\tdocument.execCommand(\"insertHTML\", false, formattedHtml);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// ie11\n\t\t\tvar text = window.clipboardData.getData(\"text\");\n\t\t\tdocument.execCommand(\"paste\", true, BX.Text.encode(text));\n\t\t}\n\n\t\tthis.onChange();\n\t}\n\n\t/**\n\t * Handles click on document\n\t */\n\tonDocumentClick(event)\n\t{\n\t\tif (this.isEditable() && !this.fromNode)\n\t\t{\n\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\tthis.disableEdit();\n\t\t}\n\n\t\tthis.fromNode = false;\n\t}\n\n\tonMousedown(event)\n\t{\n\t\tif (!this.manifest.group)\n\t\t{\n\t\t\tthis.fromNode = true;\n\n\t\t\tif (this.manifest.allowInlineEdit !== false &&\n\t\t\t\tBX.Landing.Main.getInstance().isControlsEnabled())\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.enableEdit();\n\t\t\t\tif (this.isTable(event))\n\t\t\t\t{\n\t\t\t\t\tthis.disableEdit();\n\t\t\t\t\tBX.Landing.Block.Node.Text.currentNode.node.querySelectorAll('.landing-table-container')\n\t\t\t\t\t\t.forEach(function(table) {\n\t\t\t\t\t\t\tif (!table.hasAttribute('table-prepare'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.Landing.Block.Node.Text.prototype.prepareNewTable(table);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\tvar tableFontSize = parseInt(window.getComputedStyle(event.srcElement).getPropertyValue('font-size'));\n\t\t\t\t\tif (event.srcElement.textContent === ''\n\t\t\t\t\t\t&& event.srcElement.classList.contains('landing-table-td')\n\t\t\t\t\t\t&& tableFontSize < this.tableBaseFontSize)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.srcElement.classList.add('landing-table-td-height');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.srcElement.classList.remove('landing-table-td-height');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (!this.manifest.textOnly && !BX.Landing.UI.Panel.StylePanel.getInstance().isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(this.node, null, this.buttons);\n\t\t\t\t\t}\n\t\t\t\t\tif (BX.Landing.Block.Node.Text.nodeTableContainerList)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.Block.Node.Text.nodeTableContainerList.forEach(function(tableContainer) {\n\t\t\t\t\t\t\ttableContainer.tableEditor.unselect(tableContainer.tableEditor);\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tBX.Landing.UI.Tool.ColorPicker.hideAll();\n\t\t\t\tBX.Landing.UI.Button.FontAction.hideAll();\n\t\t\t}\n\n\t\t\trequestAnimationFrame(function() {\n\t\t\t\tif (event.target.nodeName === \"A\" ||\n\t\t\t\t\tevent.target.parentElement.nodeName === \"A\")\n\t\t\t\t{\n\t\t\t\t\tvar range = document.createRange();\n\t\t\t\t\trange.selectNode(event.target);\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tonMouseup()\n\t{\n\t\tsetTimeout(function() {\n\t\t\tthis.fromNode = false;\n\t\t}.bind(this), 10);\n\t}\n\n\t/**\n\t * Click on field - switch edit mode.\n\t */\n\tonClick(event)\n\t{\n\t\tif (this.isTable(event))\n\t\t{\n\t\t\tthis.addTableButtons(event);\n\t\t}\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tthis.fromNode = false;\n\n\t\tif (event.target.nodeName === \"A\" ||\n\t\t\tevent.target.parentElement.nodeName === \"A\")\n\t\t{\n\t\t\tvar range = document.createRange();\n\t\t\trange.selectNode(event.target);\n\t\t\twindow.getSelection().removeAllRanges();\n\t\t\twindow.getSelection().addRange(range);\n\t\t}\n\t}\n\n\t/**\n\t * Checks that is editable\n\t * @return {boolean}\n\t */\n\tisEditable()\n\t{\n\t\treturn this.node.isContentEditable;\n\t}\n\n\t/**\n\t * Enables edit mode\n\t */\n\tenableEdit()\n\t{\n\t\tvar currentNode = BX.Landing.Block.Node.Text.currentNode;\n\t\tif (currentNode)\n\t\t{\n\t\t\tvar node = BX.Landing.Block.Node.Text.currentNode.node;\n\t\t\tvar nodeTableContainerList = node.querySelectorAll('.landing-table-container');\n\t\t\tif (nodeTableContainerList.length > 0)\n\t\t\t{\n\t\t\t\tnodeTableContainerList.forEach(function(nodeTableContainer) {\n\t\t\t\t\tif (!nodeTableContainer.tableEditor)\n\t\t\t\t\t{\n\t\t\t\t\t\tnodeTableContainer.tableEditor = new BX.Landing.Node.Text.TableEditor.default(nodeTableContainer);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tBX.Landing.Block.Node.Text.nodeTableContainerList = nodeTableContainerList;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.isEditable() && !BX.Landing.UI.Panel.StylePanel.getInstance().isShown())\n\t\t{\n\t\t\tif (this !== BX.Landing.Block.Node.Text.currentNode && BX.Landing.Block.Node.Text.currentNode !== null)\n\t\t\t{\n\t\t\t\tBX.Landing.Block.Node.Text.currentNode.disableEdit();\n\t\t\t}\n\n\t\t\tBX.Landing.Block.Node.Text.currentNode = this;\n\n\t\t\tthis.buttons = [];\n\t\t\tthis.buttons.push(this.getDesignButton());\n\n\t\t\tif (this.isHeader())\n\t\t\t{\n\t\t\t\tthis.buttons.push(this.getChangeTagButton());\n\t\t\t\tthis.getChangeTagButton().onChangeHandler = this.onChangeTag.bind(this);\n\t\t\t}\n\n\t\t\tthis.lastValue = this.getValue();\n\t\t\tthis.node.contentEditable = true;\n\n\t\t\tthis.node.setAttribute(\"title\", \"\");\n\t\t}\n\t}\n\n\t/**\n\t * Gets design button for editor\n\t * @return {BX.Landing.UI.Button.Design}\n\t */\n\tgetDesignButton()\n\t{\n\t\tif (!this.designButton)\n\t\t{\n\t\t\tthis.designButton = new BX.Landing.UI.Button.Design(\"design\", {\n\t\t\t\thtml: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_DESIGN\"),\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_DESIGN\")},\n\t\t\t\tonClick: function() {\n\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t\t\tthis.disableEdit();\n\t\t\t\t\tthis.onDesignShow(this.manifest.code);\n\t\t\t\t}.bind(this)\n\t\t\t});\n\t\t}\n\n\t\treturn this.designButton;\n\t}\n\n\t/**\n\t * Disables edit mode\n\t */\n\tdisableEdit()\n\t{\n\t\tif (this.isEditable())\n\t\t{\n\t\t\tthis.node.contentEditable = false;\n\n\t\t\tif (this.lastValue !== this.getValue())\n\t\t\t{\n\t\t\t\tthis.onChange();\n\t\t\t\tthis.lastValue = this.getValue();\n\t\t\t}\n\n\t\t\tif (this.isAllowInlineEdit())\n\t\t\t{\n\t\t\t\tthis.node.setAttribute(\"title\", this.escapeText(BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_TEXT_NODE\")));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets form field\n\t * @return {BX.Landing.UI.Field.Text}\n\t */\n\tgetField()\n\t{\n\t\tif (!this.field)\n\t\t{\n\t\t\tthis.field = new BX.Landing.UI.Field.Text({\n\t\t\t\tselector: this.selector,\n\t\t\t\ttitle: this.manifest.name,\n\t\t\t\tcontent: this.node.innerHTML,\n\t\t\t\ttextOnly: this.manifest.textOnly,\n\t\t\t\tbind: this.node\n\t\t\t});\n\n\t\t\tif (this.isHeader())\n\t\t\t{\n\t\t\t\tthis.field.changeTagButton = this.getChangeTagButton();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.field.setValue(this.node.innerHTML);\n\t\t\tthis.field.content = this.node.innerHTML;\n\t\t}\n\n\t\treturn this.field;\n\t}\n\n\t/**\n\t * Sets node value\n\t * @param value\n\t * @param {?boolean} [preventSave = false]\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tsetValue(value, preventSave, preventHistory)\n\t{\n\t\tthis.preventSave(preventSave);\n\t\tthis.lastValue = this.isSavePrevented() ? this.getValue() : this.lastValue;\n\t\tthis.node.innerHTML = value;\n\t\tthis.onChange(false, preventHistory);\n\t}\n\n\t/**\n\t * Gets node value\n\t * @return {string}\n\t */\n\tgetValue()\n\t{\n\t\tif (this.node.querySelector('.landing-table-container') !== null)\n\t\t{\n\t\t\tvar node = this.node.cloneNode(true);\n\t\t\tthis.prepareTable(node);\n\t\t\treturn this.textToPlaceholders(node.innerHTML);\n\t\t}\n\t\treturn this.textToPlaceholders(this.node.innerHTML);\n\t}\n\n\t/**\n\t * Checks that this node is header\n\t * @return {boolean}\n\t */\n\tisHeader()\n\t{\n\t\treturn this.headerTagMatcher.test(this.node.nodeName);\n\t}\n\n\t/**\n\t * Checks that this node is table\n\t * @return {boolean}\n\t */\n\tisTable(event)\n\t{\n\t\tvar nodeIsTable = false;\n\t\tif (BX.Landing.Block.Node.Text.currentNode && event)\n\t\t{\n\t\t\tBX.Landing.Block.Node.Text.currentNode.node.querySelectorAll('.landing-table-container')\n\t\t\t\t.forEach(function(table) {\n\t\t\t\t\tif (table.contains(event.srcElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tnodeIsTable = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t}\n\t\treturn nodeIsTable;\n\t}\n\n\t/**\n\t * Delete br tags in new table and add flag after this\n\t */\n\tprepareNewTable()\n\t{\n\t\ttable.querySelectorAll('br').forEach(function(tdTag) {\n\t\t\ttdTag.remove();\n\t\t})\n\t\ttable.setAttribute('table-prepare', 'true');\n\t\tBX.Landing.Block.Node.Text.currentNode.onChange(true);\n\t}\n\n\taddTableButtons(event)\n\t{\n\t\tvar buttons = [];\n\t\tvar neededButtons = [];\n\t\tvar setTd = [];\n\t\tvar tableButtons = this.getTableButtons();\n\t\tvar tableAlignButtons = [tableButtons[0], tableButtons[1], tableButtons[2], tableButtons[3]];\n\t\tvar node = BX.Landing.Block.Node.Text.currentNode.node;\n\t\tvar table = null;\n\t\tvar isCell = false;\n\t\tvar isButtonAddRow = false;\n\t\tvar isButtonAddCol = false;\n\t\tvar isNeedTablePanel = true;\n\t\tif (event.srcElement.classList.contains('landing-table')\n\t\t\t|| event.srcElement.classList.contains('landing-table-col-dnd'))\n\t\t{\n\t\t\tisNeedTablePanel = false;\n\t\t}\n\t\tif (event.srcElement.classList.contains('landing-table-row-add'))\n\t\t{\n\t\t\tisButtonAddRow = true;\n\t\t}\n\t\tif (event.srcElement.classList.contains('landing-table-col-add'))\n\t\t{\n\t\t\tisButtonAddCol = true;\n\t\t}\n\t\tvar hideButtons = [];\n\t\tvar nodeTableList = node.querySelectorAll('.landing-table');\n\t\tif (nodeTableList.length > 0)\n\t\t{\n\t\t\tnodeTableList.forEach(function(nodeTable) {\n\t\t\t\tif (nodeTable.contains(event.srcElement))\n\t\t\t\t{\n\t\t\t\t\ttable = nodeTable;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\ttableButtons.forEach(function(tableButton){\n\t\t\ttableButton['options']['srcElement'] = event.srcElement;\n\t\t\ttableButton['options']['node'] = node;\n\t\t\ttableButton['options']['table'] = table;\n\t\t})\n\n\t\tif (event.srcElement.classList.contains('landing-table-row-dnd'))\n\t\t{\n\t\t\tsetTd = event.srcElement.parentNode.children;\n\t\t\tsetTd = Array.from(setTd);\n\t\t\tif (this.getAmountTableRows(table) > 1)\n\t\t\t{\n\t\t\t\tneededButtons = [0, 1, 2, 3, 4, 5, 6];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tneededButtons = [0, 1, 2, 3, 4, 5];\n\t\t\t}\n\t\t\tneededButtons.forEach(function(neededButon) {\n\t\t\t\ttableButtons[neededButon]['options']['target'] = 'row';\n\t\t\t\ttableButtons[neededButon]['options']['setTd'] = setTd;\n\t\t\t\tbuttons.push(tableButtons[neededButon]);\n\t\t\t})\n\t\t}\n\n\t\tif (event.srcElement.parentNode.classList.contains('landing-table-col-dnd'))\n\t\t{\n\t\t\tvar childNodes = event.srcElement.parentElement.parentElement.childNodes;\n\t\t\tvar childNodesArray = Array.from(childNodes);\n\t\t\tvar childNodesArrayPrepare = [];\n\t\t\tchildNodesArray.forEach(function(childNode) {\n\t\t\t\tif (childNode.nodeType === 1)\n\t\t\t\t{\n\t\t\t\t\tchildNodesArrayPrepare.push(childNode);\n\t\t\t\t}\n\t\t\t})\n\t\t\tvar neededPosition = childNodesArrayPrepare.indexOf(event.srcElement.parentElement);\n\t\t\tvar rows = event.srcElement.parentElement.parentElement.parentElement.childNodes;\n\t\t\trows.forEach(function(row) {\n\t\t\t\tif (row.nodeType === 1)\n\t\t\t\t{\n\t\t\t\t\tvar rowChildPrepare = [];\n\t\t\t\t\trow.childNodes.forEach(function(rowChildNode) {\n\t\t\t\t\t\tif (rowChildNode.nodeType === 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trowChildPrepare.push(rowChildNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tif (rowChildPrepare[neededPosition])\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTd.push(rowChildPrepare[neededPosition]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\tif (this.getAmountTableCols(table) > 1)\n\t\t\t{\n\t\t\t\tneededButtons = [0, 1, 2, 3, 4, 5, 7];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tneededButtons = [0, 1, 2, 3, 4, 5];\n\t\t\t}\n\t\t\tneededButtons.forEach(function(neededButon) {\n\t\t\t\ttableButtons[neededButon]['options']['target'] = 'col';\n\t\t\t\ttableButtons[neededButon]['options']['setTd'] = setTd;\n\t\t\t\tbuttons.push(tableButtons[neededButon]);\n\t\t\t})\n\t\t}\n\n\t\tif (event.srcElement.classList.contains('landing-table-th-select-all'))\n\t\t{\n\t\t\tvar isSelectedAll;\n\t\t\tif (event.srcElement.classList.contains('landing-table-th-select-all-selected'))\n\t\t\t{\n\t\t\t\tisSelectedAll = true;\n\t\t\t\tvar rows = event.srcElement.parentElement.parentElement.childNodes;\n\t\t\t\trows.forEach(function(row) {\n\t\t\t\t\trow.childNodes.forEach(function(th) {\n\t\t\t\t\t\tsetTd.push(th);\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\tneededButtons = [0, 1, 2, 3, 4, 5, 8, 9, 10];\n\t\t\t\tneededButtons.forEach(function(neededButon) {\n\t\t\t\t\ttableButtons[neededButon]['options']['target'] = 'table';\n\t\t\t\t\ttableButtons[neededButon]['options']['setTd'] = setTd;\n\t\t\t\t\tbuttons.push(tableButtons[neededButon]);\n\t\t\t\t})\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tisSelectedAll = false;\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\t\t}\n\n\t\tif (event.srcElement.classList.contains('landing-table-td'))\n\t\t{\n\t\t\tsetTd.push(event.srcElement);\n\t\t\tneededButtons = [3, 2, 1, 0];\n\t\t\tneededButtons.forEach(function(neededButon) {\n\t\t\t\ttableButtons[neededButon]['options']['target'] = 'cell';\n\t\t\t\ttableButtons[neededButon]['options']['setTd'] = setTd;\n\t\t\t\ttableButtons[neededButon].insertAfter = 'strikeThrough';\n\t\t\t\tbuttons.push(tableButtons[neededButon]);\n\t\t\t})\n\t\t\tisCell = true;\n\t\t\thideButtons = ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull', 'createTable', 'pasteTable'];\n\t\t}\n\n\t\tvar activeAlignButtonId;\n\t\tvar setActiveAlignButtonId = [];\n\t\tsetTd.forEach(function(th) {\n\t\t\tif (th.nodeType === 1)\n\t\t\t{\n\t\t\t\tactiveAlignButtonId = undefined;\n\t\t\t\tif (th.classList.contains('text-left'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignLeft';\n\t\t\t\t}\n\t\t\t\tif (th.classList.contains('text-center'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignCenter';\n\t\t\t\t}\n\t\t\t\tif (th.classList.contains('text-right'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignRight';\n\t\t\t\t}\n\t\t\t\tif (th.classList.contains('text-justify'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignJustify';\n\t\t\t\t}\n\t\t\t\tsetActiveAlignButtonId.push(activeAlignButtonId);\n\t\t\t}\n\t\t})\n\t\tvar count = 0;\n\t\tvar isIdentical = true;\n\t\twhile (count < setActiveAlignButtonId.length && isIdentical) {\n\t\t\tif (count > 0)\n\t\t\t{\n\t\t\t\tif (setActiveAlignButtonId[count] !== setActiveAlignButtonId[count - 1])\n\t\t\t\t{\n\t\t\t\t\tisIdentical = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcount++;\n\t\t}\n\t\tif (isIdentical)\n\t\t{\n\t\t\tactiveAlignButtonId = setActiveAlignButtonId[0];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tactiveAlignButtonId = undefined;\n\t\t}\n\t\tif (activeAlignButtonId)\n\t\t{\n\t\t\ttableAlignButtons.forEach(function(tableAlignButton) {\n\t\t\t\tif (tableAlignButton.id === activeAlignButtonId)\n\t\t\t\t{\n\t\t\t\t\ttableAlignButton.layout.classList.add('landing-ui-active');\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (buttons[0] && buttons[1] && buttons[2] && buttons[3])\n\t\t{\n\t\t\tbuttons[0]['options']['alignButtons'] = tableAlignButtons;\n\t\t\tbuttons[1]['options']['alignButtons'] = tableAlignButtons;\n\t\t\tbuttons[2]['options']['alignButtons'] = tableAlignButtons;\n\t\t\tbuttons[3]['options']['alignButtons'] = tableAlignButtons;\n\t\t}\n\n\t\tif (!this.manifest.textOnly)\n\t\t{\n\t\t\tif (isNeedTablePanel)\n\t\t\t{\n\t\t\t\tif (!isButtonAddRow && !isButtonAddCol && table)\n\t\t\t\t{\n\t\t\t\t\tif (!isCell)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (isSelectedAll === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(table.parentNode, null, buttons, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tisSelectedAll = true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(table.parentNode, null, buttons, true, hideButtons);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets change tag button\n\t * @return {BX.Landing.UI.Button.ChangeTag}\n\t */\n\tgetChangeTagButton()\n\t{\n\t\tif (!this.changeTagButton)\n\t\t{\n\t\t\tthis.changeTagButton = new BX.Landing.UI.Button.ChangeTag(\"changeTag\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-\"+this.node.nodeName.toLowerCase()+\"\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_CHANGE_TAG\")},\n\t\t\t\tonChange: this.onChangeTag.bind(this)\n\t\t\t});\n\t\t}\n\n\t\tthis.changeTagButton.insertAfter = \"unlink\";\n\n\t\tthis.changeTagButton.activateItem(this.node.nodeName);\n\n\t\treturn this.changeTagButton;\n\t}\n\n\tgetTableButtons()\n\t{\n\t\tthis.buttons = [];\n\t\tthis.buttons.push(\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\"alignLeft\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-left\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_LEFT\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\"alignCenter\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-center\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_CENTER\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\"alignRight\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-right\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_RIGHT\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\"alignJustify\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-justify\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_JUSTIFY\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.ColorAction(\"tableTextColor\", {\n\t\t\t\ttext: BX.Landing.Loc.getMessage(\"EDITOR_ACTION_SET_FORE_COLOR\"),\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_COLOR\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.ColorAction(\"tableBgColor\", {\n\t\t\t\thtml: \"<i class=\\\"landing-ui-icon-editor-fill-color\\\"></i>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_TABLE_CELL_BG\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.DeleteElementTable(\"deleteRow\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-delete\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_DELETE_ROW_TABLE\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.DeleteElementTable(\"deleteCol\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-delete\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_DELETE_COL_TABLE\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.StyleTable(\"styleTable\", {\n\t\t\t\thtml: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE\")\n\t\t\t\t\t+ \"<i class=\\\"fas fa-chevron-down g-ml-8\\\"></i>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.CopyTable(\"copyTable\", {\n\t\t\t\ttext: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY\"),\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY\")},\n\t\t\t}),\n\t\t\tnew BX.Landing.UI.Button.DeleteTable(\"deleteTable\", {\n\t\t\t\thtml: \"<span class=\\\"landing-ui-icon-editor-delete\\\"></span>\",\n\t\t\t\tattrs: {title: BX.Landing.Loc.getMessage(\"LANDING_TITLE_OF_EDITOR_ACTION_TABLE_DELETE\")},\n\t\t\t})\n\t\t);\n\t\treturn this.buttons;\n\t}\n\n\t/**\n\t * Handles change tag event\n\t * @param value\n\t */\n\tonChangeTag(value)\n\t{\n\t\tthis.node = this.changeTagName(this.node, value);\n\n\t\tthis.node.addEventListener(\"mousedown\", this.onMousedown);\n\t\tthis.node.addEventListener(\"click\", this.onClick);\n\t\tthis.node.addEventListener(\"paste\", this.onPaste);\n\t\tthis.node.addEventListener(\"drop\", this.onDrop);\n\t\tthis.node.addEventListener(\"input\", this.onInput);\n\t\tthis.node.addEventListener(\"keydown\", this.onInput);\n\n\t\tif (!this.getField().isEditable())\n\t\t{\n\t\t\tthis.disableEdit();\n\t\t\tthis.enableEdit();\n\t\t}\n\n\t\tvar data = {};\n\t\tdata[this.selector] = value;\n\t\tthis.changeOptionsHandler(data);\n\t}\n\n\tgetAmountTableCols(table)\n\t{\n\t\treturn table.querySelectorAll('.landing-table-col-dnd').length;\n\t}\n\n\tgetAmountTableRows(table)\n\t{\n\t\treturn table.querySelectorAll('.landing-table-row-dnd').length;\n\t}\n\n\tprepareTable(node)\n\t{\n\t\tvar setClassesForRemove = [\n\t\t\t'table-selected-all',\n\t\t\t'landing-table-th-select-all-selected',\n\t\t\t'landing-table-cell-selected',\n\t\t\t'landing-table-row-selected',\n\t\t\t'landing-table-th-selected',\n\t\t\t'landing-table-th-selected-cell',\n\t\t\t'landing-table-th-selected-top',\n\t\t\t'landing-table-th-selected-x',\n\t\t\t'landing-table-tr-selected-left',\n\t\t\t'landing-table-tr-selected-y',\n\t\t\t'landing-table-col-selected',\n\t\t\t'landing-table-tr-selected',\n\t\t\t'table-selected-all-right',\n\t\t\t'table-selected-all-bottom',\n\t\t];\n\t\tsetClassesForRemove.forEach(function(className) {\n\t\t\tnode.querySelectorAll('.' + className).forEach(function(element){\n\t\t\t\telement.classList.remove(className);\n\t\t\t})\n\t\t})\n\t\treturn node;\n\t}\n\n\tonBackspaceDown()\n\t{\n\t\tvar selection = window.getSelection();\n\t\tvar position = selection.getRangeAt(0).startOffset;\n\t\tif (position === 0)\n\t\t{\n\t\t\tvar focusNode = selection.focusNode;\n\t\t\tif (!BX.Type.isNil(focusNode) && focusNode.nodeType !== 3)\n\t\t\t{\n\t\t\t\tif (focusNode.firstChild.nodeType === 3 && focusNode.firstChild.firstChild.nodeType === 3)\n\t\t\t\t{\n\t\t\t\t\tfocusNode = focusNode.firstChild.firstChild;\n\t\t\t\t}\n\t\t\t\telse if (focusNode.firstChild.nodeType !== 3)\n\t\t\t\t{\n\t\t\t\t\tfocusNode = focusNode.firstChild;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfocusNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (focusNode)\n\t\t\t{\n\t\t\t\tvar focusNodeParent = focusNode.parentNode;\n\t\t\t\tvar allowedNodeName = ['BLOCKQUOTE', 'UL'];\n\t\t\t\tif (focusNodeParent && allowedNodeName.includes(focusNodeParent.nodeName))\n\t\t\t\t{\n\t\t\t\t\tvar focusNodeContainer = document.createElement('div');\n\t\t\t\t\tfocusNodeContainer.append(focusNode);\n\t\t\t\t\tfocusNodeParent.append(focusNodeContainer);\n\t\t\t\t}\n\t\t\t\tvar contentNode = focusNode.parentNode.parentNode;\n\t\t\t\twhile (contentNode && !allowedNodeName.includes(contentNode.nodeName))\n\t\t\t\t{\n\t\t\t\t\tcontentNode = contentNode.parentNode;\n\t\t\t\t}\n\t\t\t\tif (contentNode && contentNode.childNodes.length === 1)\n\t\t\t\t{\n\t\t\t\t\tcontentNode.after(focusNode.parentNode);\n\t\t\t\t\tcontentNode.remove();\n\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["Text","Node","constructor","escapeText","BX","Landing","Utils","headerTagMatcher","Matchers","headerTag","changeTagName","textToPlaceholders","Runtime","loadExtension","Block","apply","arguments","type","tableBaseFontSize","onClick","bind","onPaste","onDrop","onInput","onKeyDown","onMousedown","onMouseup","node","addEventListener","document","onAllowInlineEdit","setAttribute","Loc","getMessage","onChange","preventAdjustPosition","preventHistory","superClass","call","UI","Panel","EditorPanel","getInstance","adjustPosition","History","push","Entry","block","getBlock","id","selector","command","undo","lastValue","redo","getValue","event","code","onBackspaceDown","clearTimeout","inputTimeout","key","keyCode","which","top","window","navigator","userAgent","match","ctrlKey","metaKey","setTimeout","isTable","tableFontSize","parseInt","getComputedStyle","srcElement","getPropertyValue","textContent","classList","contains","add","remove","onEscapePress","isEditable","currentNode","hide","disableEdit","preventDefault","clipboardData","getData","sourceText","encodedText","encode","formattedHtml","replace","RegExp","execCommand","text","onDocumentClick","fromNode","manifest","group","allowInlineEdit","Main","isControlsEnabled","stopPropagation","enableEdit","querySelectorAll","forEach","table","hasAttribute","prototype","prepareNewTable","textOnly","StylePanel","isShown","show","buttons","nodeTableContainerList","tableContainer","tableEditor","unselect","Tool","ColorPicker","hideAll","Button","FontAction","requestAnimationFrame","target","nodeName","parentElement","range","createRange","selectNode","getSelection","removeAllRanges","addRange","addTableButtons","isContentEditable","length","nodeTableContainer","TableEditor","default","getDesignButton","isHeader","getChangeTagButton","onChangeHandler","onChangeTag","contentEditable","designButton","Design","html","attrs","title","onDesignShow","isAllowInlineEdit","getField","field","Field","name","content","innerHTML","changeTagButton","setValue","value","preventSave","isSavePrevented","querySelector","cloneNode","prepareTable","test","nodeIsTable","tdTag","neededButtons","setTd","tableButtons","getTableButtons","tableAlignButtons","isCell","isButtonAddRow","isButtonAddCol","isNeedTablePanel","hideButtons","nodeTableList","nodeTable","tableButton","parentNode","children","Array","from","getAmountTableRows","neededButon","childNodes","childNodesArray","childNodesArrayPrepare","childNode","nodeType","neededPosition","indexOf","rows","row","rowChildPrepare","rowChildNode","getAmountTableCols","isSelectedAll","th","insertAfter","activeAlignButtonId","setActiveAlignButtonId","undefined","count","isIdentical","tableAlignButton","layout","ChangeTag","toLowerCase","activateItem","AlignTable","ColorAction","DeleteElementTable","StyleTable","CopyTable","DeleteTable","data","changeOptionsHandler","setClassesForRemove","className","element","selection","position","getRangeAt","startOffset","focusNode","Type","isNil","firstChild","focusNodeParent","allowedNodeName","includes","focusNodeContainer","createElement","append","contentNode","after"],"mappings":"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"}