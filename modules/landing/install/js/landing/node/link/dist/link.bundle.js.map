{"version":3,"file":"link.bundle.js","sources":["../src/link.js"],"sourcesContent":["import { Node } from 'landing.node';\nimport { Dom, Event } from 'main.core';\n\nconst trim = BX.Landing.Utils.trim;\nconst isPlainObject = BX.Landing.Utils.isPlainObject;\nconst isString = BX.Landing.Utils.isString;\nconst textToPlaceholders = BX.Landing.Utils.textToPlaceholders;\nconst create = BX.Landing.Utils.create;\nconst escapeText = BX.Landing.Utils.escapeText;\nconst decodeDataValue = BX.Landing.Utils.decodeDataValue;\n\nexport class Link extends Node\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.type = 'link';\n\n\t\tif (!this.isGrouped())\n\t\t{\n\t\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\t\t}\n\n\t\tif (this.isAllowInlineEdit())\n\t\t{\n\t\t\tDom.attr(this.node, 'title', BX.Landing.Loc.getMessage('LANDING_TITLE_OF_LINK_NODE'));\n\t\t}\n\n\t\tthis.onChange = BX.Runtime.debounce(this.onChange, 500);\n\t\tthis.onContentUpdate = BX.Runtime.debounce(this.onContentUpdate, 500);\n\t}\n\n\tonContentUpdate()\n\t{\n\t\tBX.Landing.History.getInstance().push();\n\t\tthis.getField().setValue(this.getValue());\n\t}\n\n\tisMenuMode(): boolean\n\t{\n\t\treturn this.manifest.menuMode === true;\n\t}\n\n\t/**\n\t * Handles click event\n\t * @param {MouseEvent} event\n\t */\n\tonClick(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (!this.isMenuMode())\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\n\t\tif (this.isAllowInlineEdit())\n\t\t{\n\t\t\tBX.Landing.UI.Button.ColorAction.hideAll();\n\n\t\t\tif (!BX.Landing.UI.Panel.StylePanel.getInstance().isShown())\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.Link.getInstance().show(this);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Sets node value\n\t * @param data\n\t * @param {?boolean} [preventSave = false]\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tsetValue(data, preventSave, preventHistory)\n\t{\n\t\tthis.startValue = this.startValue || this.getValue();\n\n\t\tthis.preventSave(preventSave);\n\n\t\tif (!this.containsImage() && this.isAllowInlineEdit())\n\t\t{\n\t\t\tconst field = this.getField(true).hrefInput;\n\n\t\t\tif (isString(data.text) && data.text.includes('{{name}}'))\n\t\t\t{\n\t\t\t\tfield.getPlaceholderData(data.href)\n\t\t\t\t\t.then((placeholdersData) => {\n\t\t\t\t\t\tthis.node.innerHTML = data.text.replace(\n\t\t\t\t\t\t\t/{{name}}/,\n\t\t\t\t\t\t\t`<span data-placeholder=\"name\">${placeholdersData.name}</span>`,\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {});\n\t\t\t}\n\t\t\telse if (!this.getField().containsHtml() && !this.manifest.skipContent)\n\t\t\t{\n\t\t\t\tthis.node.innerHTML = escapeText(data.text);\n\t\t\t}\n\t\t}\n\n\t\tthis.setAttrValue(data);\n\n\t\tthis.onChange(preventHistory);\n\n\t\tif (!preventHistory)\n\t\t{\n\t\t\tthis.onContentUpdate();\n\t\t}\n\t}\n\n\tsetAttrValue(data)\n\t{\n\t\tDom.attr(this.node, 'href', decodeDataValue(data.href));\n\t\tDom.attr(this.node, 'target', escapeText(data.target));\n\n\t\tif ('attrs' in data)\n\t\t{\n\t\t\tObject.keys(data.attrs).forEach((attr) => {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(data.attrs, attr))\n\t\t\t\t{\n\t\t\t\t\tDom.attr(this.node, attr, data.attrs[attr]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.attr(this.node, 'data-url', null);\n\t\t\tDom.attr(this.node, 'data-embed', null);\n\t\t}\n\t}\n\n\t/**\n\t * Checks that this node contains image node\n\t * @return {boolean}\n\t */\n\tcontainsImage(): boolean\n\t{\n\t\treturn Boolean(this.node.firstElementChild) && this.node.firstElementChild.tagName === 'IMG';\n\t}\n\n\t/**\n\t * Gets node value\n\t * @return {{text: string, href: string|*, target: string|*}}\n\t */\n\tgetValue(): {text: string, href: string | *, target: string | *}\n\t{\n\t\tconst value = {\n\t\t\ttext: textToPlaceholders(trim(this.node.innerHTML)),\n\t\t\thref: trim(this.node.getAttribute('href')),\n\t\t\ttarget: trim(this.node.getAttribute('target') || '_self'),\n\t\t};\n\n\t\tif (this.node.getAttribute('data-url'))\n\t\t{\n\t\t\tvalue.attrs = {\n\t\t\t\t'data-url': trim(this.node.getAttribute('data-url')),\n\t\t\t};\n\t\t}\n\n\t\tif (this.node.getAttribute('data-dynamic'))\n\t\t{\n\t\t\tif (!isPlainObject(value.attrs))\n\t\t\t{\n\t\t\t\tvalue.attrs = {};\n\t\t\t}\n\n\t\t\tvalue.attrs['data-dynamic'] = this.node.getAttribute('data-dynamic');\n\t\t}\n\n\t\tif (this.manifest.skipContent)\n\t\t{\n\t\t\tvalue.skipContent = true;\n\t\t\tdelete value.text;\n\t\t}\n\n\t\tif (value.href && value.href.startsWith('selectActions:'))\n\t\t{\n\t\t\tvalue.href = '#';\n\t\t}\n\n\t\treturn value;\n\t}\n\n\t/**\n\t * Gets field\n\t * @param {boolean} preventAdjustValue\n\t * @return {BX.Landing.UI.Field.BaseField}\n\t */\n\tgetField(preventAdjustValue): BX.Landing.UI.Field.BaseField\n\t{\n\t\tconst value = this.getValue();\n\t\tvalue.text = textToPlaceholders(create('div', { html: value.text }).innerHTML);\n\n\t\tif (!this.field)\n\t\t{\n\t\t\tconst allowedTypes = [\n\t\t\t\tBX.Landing.UI.Field.LinkUrl.TYPE_BLOCK,\n\t\t\t\tBX.Landing.UI.Field.LinkUrl.TYPE_PAGE,\n\t\t\t\tBX.Landing.UI.Field.LinkUrl.TYPE_CRM_FORM,\n\t\t\t\tBX.Landing.UI.Field.LinkUrl.TYPE_CRM_PHONE,\n\t\t\t];\n\n\t\t\tif (BX.Landing.Main.getInstance().options.params.type === BX.Landing.Main.TYPE_STORE)\n\t\t\t{\n\t\t\t\tallowedTypes.push(BX.Landing.UI.Field.LinkUrl.TYPE_CATALOG);\n\t\t\t}\n\n\t\t\tif (BX.Landing.Main.getInstance().options.features.includes('diskFile'))\n\t\t\t{\n\t\t\t\tallowedTypes.push(BX.Landing.UI.Field.LinkUrl.TYPE_DISK_FILE);\n\t\t\t}\n\n\t\t\tthis.field = new BX.Landing.UI.Field.Link({\n\t\t\t\ttitle: this.manifest.name,\n\t\t\t\tselector: this.selector,\n\t\t\t\tskipContent: this.manifest.skipContent,\n\t\t\t\tcontent: value,\n\t\t\t\toptions: {\n\t\t\t\t\tsiteId: BX.Landing.Main.getInstance().options.site_id,\n\t\t\t\t\tlandingId: BX.Landing.Main.getInstance().id,\n\t\t\t\t},\n\t\t\t\tallowedTypes,\n\t\t\t});\n\t\t}\n\t\telse if (!preventAdjustValue)\n\t\t{\n\t\t\tthis.field.setValue(value);\n\t\t\tthis.field.content = value;\n\t\t\tthis.field.hrefInput.content = value.href;\n\t\t\tthis.field.hrefInput.makeDisplayedHrefValue();\n\t\t\tthis.field.hrefInput.setHrefTypeSwitcherValue(\n\t\t\t\tthis.field.hrefInput.getHrefStringType(),\n\t\t\t);\n\t\t\tthis.field.hrefInput.removeHrefTypeFromHrefString();\n\t\t}\n\n\t\treturn this.field;\n\t}\n}\n\nBX.Landing.Node.Link = Link;\n"],"names":["trim","BX","Landing","Utils","isPlainObject","isString","textToPlaceholders","create","escapeText","decodeDataValue","Link","Node","constructor","options","type","isGrouped","Event","bind","node","onClick","isAllowInlineEdit","Dom","attr","Loc","getMessage","onChange","Runtime","debounce","onContentUpdate","History","getInstance","push","getField","setValue","getValue","isMenuMode","manifest","menuMode","event","preventDefault","stopPropagation","UI","Button","ColorAction","hideAll","Panel","StylePanel","isShown","show","data","preventSave","preventHistory","startValue","containsImage","field","hrefInput","text","includes","getPlaceholderData","href","then","placeholdersData","innerHTML","replace","name","catch","containsHtml","skipContent","setAttrValue","target","Object","keys","attrs","forEach","prototype","hasOwnProperty","call","Boolean","firstElementChild","tagName","value","getAttribute","startsWith","preventAdjustValue","html","allowedTypes","Field","LinkUrl","TYPE_BLOCK","TYPE_PAGE","TYPE_CRM_FORM","TYPE_CRM_PHONE","Main","params","TYPE_STORE","TYPE_CATALOG","features","TYPE_DISK_FILE","title","selector","content","siteId","site_id","landingId","id","makeDisplayedHrefValue","setHrefTypeSwitcherValue","getHrefStringType","removeHrefTypeFromHrefString"],"mappings":"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"}