{"version":3,"file":"backend.bundle.js","sources":["../src/backend.js"],"sourcesContent":["import {Uri, Cache, Loc, Reflection, Type, Http, ajax, Text} from 'main.core';\nimport {Env} from 'landing.env';\nimport type {Block, Landing, Site, Template, CreatePageOptions, SourceResponse, PreparedResponse} from './types';\n\nlet additionalRequestCompleted = true;\n\n/**\n * @memberOf BX.Landing\n */\nexport class Backend\n{\n\tstatic +instance: Backend = null;\n\tstatic getInstance(): Backend\n\t{\n\t\tif (!Backend.instance)\n\t\t{\n\t\t\tBackend.instance = new Backend();\n\t\t}\n\n\t\treturn Backend.instance;\n\t}\n\n\tstatic makeResponse(xhr: XMLHttpRequest, sourceResponse: SourceResponse = {}): PreparedResponse\n\t{\n\t\tconst type = (() => {\n\t\t\tif (Type.isStringFilled(sourceResponse.type))\n\t\t\t{\n\t\t\t\treturn sourceResponse.type;\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(sourceResponse) && Object.values(sourceResponse).length > 0)\n\t\t\t{\n\t\t\t\tconst allSuccess = Object.values(sourceResponse).every((item) => {\n\t\t\t\t\treturn item.type === 'success';\n\t\t\t\t});\n\n\t\t\t\tif (allSuccess)\n\t\t\t\t{\n\t\t\t\t\treturn 'success';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArray(sourceResponse))\n\t\t\t{\n\t\t\t\treturn 'other';\n\t\t\t}\n\n\t\t\treturn 'error';\n\t\t})();\n\n\t\tif (type === 'other')\n\t\t{\n\t\t\treturn sourceResponse;\n\t\t}\n\n\t\treturn {\n\t\t\tresult: null,\n\t\t\ttype,\n\t\t\t...sourceResponse,\n\t\t\tstatus: xhr.status,\n\t\t\tauthorized: xhr.getResponseHeader('X-Bitrix-Ajax-Status') !== 'Authorize',\n\t\t};\n\t}\n\n\tstatic request({url, data}): Promise<any, any>\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst fd = data instanceof FormData ? data : Http.Data.convertObjectToFormData(data);\n\t\t\tconst xhr = ajax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl,\n\t\t\t\tdata: fd,\n\t\t\t\tstart: false,\n\t\t\t\tpreparePost: false,\n\t\t\t\tonsuccess: (sourceResponse) => {\n\t\t\t\t\tconst response = Backend.makeResponse(xhr, sourceResponse);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isStringFilled(response.sessid) &&\n\t\t\t\t\t\tLoc.getMessage('bitrix_sessid') !== response.sessid &&\n\t\t\t\t\t\tadditionalRequestCompleted\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tLoc.setMessage('bitrix_sessid', response.sessid);\n\t\t\t\t\t\tadditionalRequestCompleted = false;\n\n\t\t\t\t\t\tconst newData = {...data, sessid: Loc.getMessage('bitrix_sessid')};\n\n\t\t\t\t\t\tBackend\n\t\t\t\t\t\t\t.request({url, data: newData})\n\t\t\t\t\t\t\t.then((newResponse) => {\n\t\t\t\t\t\t\t\tadditionalRequestCompleted = true;\n\t\t\t\t\t\t\t\tresolve(newResponse);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((newResponse) => {\n\t\t\t\t\t\t\t\tadditionalRequestCompleted = true;\n\t\t\t\t\t\t\t\treject(newResponse);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isPlainObject(response))\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tresponse.type === 'error'\n\t\t\t\t\t\t|| response.authorized === false\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (response.authorized === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttop.window.location.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treject(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(response);\n\t\t\t\t},\n\t\t\t\tonfailure: (sourceResponse) => {\n\t\t\t\t\tif (sourceResponse === 'auth')\n\t\t\t\t\t{\n\t\t\t\t\t\ttop.window.location.reload();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treject(\n\t\t\t\t\t\t\tBackend.makeResponse(xhr, sourceResponse),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\txhr.send(fd);\n\t\t});\n\t}\n\n\tcache = new Cache.MemoryCache();\n\n\tgetControllerUrl(): string\n\t{\n\t\treturn this.cache.remember('controllerUrl', () => {\n\t\t\tconst uri = new Uri('/bitrix/tools/landing/ajax.php');\n\t\t\turi.setQueryParams({\n\t\t\t\tsite: Loc.getMessage('SITE_ID') || undefined,\n\t\t\t\ttype: this.getSitesType(),\n\t\t\t});\n\t\t\treturn uri.toString();\n\t\t});\n\t}\n\n\tgetSiteId(): number\n\t{\n\t\treturn this.cache.remember('siteId', () => {\n\t\t\tconst landing = Reflection.getClass('BX.Landing.Main');\n\n\t\t\tif (landing)\n\t\t\t{\n\t\t\t\tconst instance = landing.getInstance();\n\n\t\t\t\tif (\n\t\t\t\t\t'options' in instance\n\t\t\t\t\t&& 'site_id' in instance.options\n\t\t\t\t\t&& !Type.isUndefined(instance.options.site_id)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn instance.options.site_id;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn -1;\n\t\t});\n\t}\n\n\tgetLandingId(): number\n\t{\n\t\treturn this.cache.remember('landingId', () => {\n\t\t\tconst landing = Reflection.getClass('BX.Landing.Main');\n\n\t\t\tif (landing)\n\t\t\t{\n\t\t\t\treturn landing.getInstance().id;\n\t\t\t}\n\n\t\t\treturn -1;\n\t\t});\n\t}\n\n\tgetSitesType(): 'PAGE' | 'STORE'\n\t{\n\t\treturn this.cache.remember('siteType', () => {\n\t\t\treturn Env.getInstance().getType();\n\t\t});\n\t}\n\n\taction(\n\t\taction: string,\n\t\tdata: {[key: string]: any} = {},\n\t\tqueryParams = {},\n\t\tuploadParams = {},\n\t): Promise<{[key: string]: any}, any>\n\t{\n\t\tif (!queryParams.site_id)\n\t\t{\n\t\t\tqueryParams.site_id = this.getSiteId();\n\t\t}\n\n\t\tconst requestBody = {\n\t\t\tsessid: Loc.getMessage('bitrix_sessid'),\n\t\t\taction: uploadParams.action || action.replace('Landing\\\\Block', 'Block'),\n\t\t\tdata: {...data, uploadParams, lid: data.lid || this.getLandingId()},\n\t\t};\n\n\t\tconst uri = new Uri(this.getControllerUrl());\n\t\turi.setQueryParams({\n\t\t\taction: requestBody.action,\n\t\t\t...queryParams,\n\t\t});\n\n\t\treturn Backend\n\t\t\t.request({\n\t\t\t\turl: uri.toString(),\n\t\t\t\tdata: requestBody,\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (\n\t\t\t\t\trequestBody.action === 'Block::updateNodes'\n\t\t\t\t\t|| requestBody.action === 'Block::removeCard'\n\t\t\t\t\t|| requestBody.action === 'Block::cloneCard'\n\t\t\t\t\t|| requestBody.action === 'Block::addCard'\n\t\t\t\t\t|| requestBody.action === 'Block::updateStyles'\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\tBX.Landing.UI.Panel.StatusPanel.getInstance().update();\n\t\t\t\t}\n\n\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\tBX.Landing.PageObject.getRootWindow(),\n\t\t\t\t\t'BX.Landing.Backend:action',\n\t\t\t\t\t[action, data]\n\t\t\t\t);\n\n\t\t\t\t/*if (!response.result) {\n\t\t\t\t\tBX.Landing.ErrorManager.getInstance().add({\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}*/\n\n\t\t\t\treturn response.result;\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tif (\n\t\t\t\t\trequestBody.action !== 'Landing::downBlock'\n\t\t\t\t\t&& requestBody.action !== 'Landing::upBlock'\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\trequestBody.action !== 'Block::getById'\n\t\t\t\t\t\t&& requestBody.action !== 'Block::publication'\n\t\t\t\t\t\t&& requestBody.action !== 'Landing::move'\n\t\t\t\t\t\t&& requestBody.action !== 'Landing::copy'\n\t\t\t\t\t\t&& requestBody.action !== 'Landing::publication'\n\t\t\t\t\t\t&& requestBody.action !== 'Site::publication'\n\t\t\t\t\t\t&& requestBody.action !== 'Site::moveFolder'\n\t\t\t\t\t\t&& requestBody.action !== 'Site::markDelete'\n\t\t\t\t\t\t&& requestBody.action !== 'Vk::getVideoInfo'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst error = Type.isString(err) ? {type: 'error'} : err;\n\t\t\t\t\t\terr.action = requestBody.action;\n\n\t\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\t\tBX.Landing.ErrorManager.getInstance().add(error);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tbatch(action, data = {}, queryParams = {}): Promise<{[key: string]: any}, any>\n\t{\n\t\tqueryParams.site_id = this.getSiteId();\n\n\t\tconst requestBody = {\n\t\t\tsessid: Loc.getMessage('bitrix_sessid'),\n\t\t\taction: action.replace('Landing\\\\Block', 'Block'),\n\t\t\tdata: {lid: data.lid || this.getLandingId()},\n\t\t\tbatch: data,\n\t\t};\n\n\t\tconst uri = new Uri(this.getControllerUrl());\n\t\turi.setQueryParams({\n\t\t\taction: requestBody.action,\n\t\t\t...queryParams,\n\t\t});\n\n\t\treturn Backend\n\t\t\t.request({\n\t\t\t\turl: uri.toString(),\n\t\t\t\tdata: requestBody,\n\t\t\t})\n\t\t\t.then((response) => {\n\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tBX.Landing.UI.Panel.StatusPanel.getInstance().update();\n\n\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\tBX.Landing.PageObject.getRootWindow(),\n\t\t\t\t\t'BX.Landing.Backend:batch',\n\t\t\t\t\t[action, data]\n\t\t\t\t);\n\n\t\t\t\t/*if (!response.result) {\n\t\t\t\t\tBX.Landing.ErrorManager.getInstance().add({\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}*/\n\n\t\t\t\treturn response;\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tif (\n\t\t\t\t\trequestBody.action !== 'Landing::downBlock'\n\t\t\t\t\t&& requestBody.action !== 'Landing::upBlock'\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif (requestBody.action !== 'Block::getById')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst error = Type.isString(err) ? {type: 'error'} : err;\n\t\t\t\t\t\terror.action = requestBody.action;\n\t\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\t\tBX.Landing.ErrorManager.getInstance().add(error);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tupload(file: File | Blob, uploadParams = {}): Promise<{[key: string]: any}, any>\n\t{\n\t\tconst formData = new FormData();\n\n\t\tformData.append('sessid', Loc.getMessage('bitrix_sessid'));\n\t\tformData.append('picture', file, file.name);\n\n\t\tif ('block' in uploadParams)\n\t\t{\n\t\t\tformData.append('action', 'Block::uploadFile');\n\t\t\tformData.append('data[block]', uploadParams.block);\n\t\t}\n\n\t\tif ('lid' in uploadParams)\n\t\t{\n\t\t\tformData.set('action', 'Landing::uploadFile');\n\t\t\tformData.append('data[lid]', uploadParams.lid);\n\t\t}\n\n\t\tif ('id' in uploadParams)\n\t\t{\n\t\t\tformData.set('action', 'Site::uploadFile');\n\t\t\tformData.append('data[id]', uploadParams.id);\n\t\t}\n\n\t\tif ('temp' in uploadParams)\n\t\t{\n\t\t\tformData.append('data[temp]', true);\n\t\t}\n\n\t\tconst uri = new Uri(this.getControllerUrl());\n\t\turi.setQueryParams({\n\t\t\taction: formData.get('action'),\n\t\t\tsite_id: this.getSiteId(),\n\t\t});\n\n\t\tif (uploadParams.context)\n\t\t{\n\t\t\turi.setQueryParam('context', uploadParams.context);\n\t\t}\n\n\t\treturn Backend\n\t\t\t.request({\n\t\t\t\turl: uri.toString(),\n\t\t\t\tdata: formData,\n\t\t\t})\n\t\t\t.then((response) => response.result)\n\t\t\t.catch((err) => {\n\t\t\t\tconst error = Type.isString(err) ? {type: 'error'} : err;\n\t\t\t\terror.action = 'Block::uploadFile';\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tBX.Landing.ErrorManager.getInstance().add(error);\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t}\n\n\tgetSites({filter = {}} = {}): Promise<Array<Site>>\n\t{\n\t\treturn this.cache.remember(`sites+${JSON.stringify(filter)}`, () => {\n\t\t\treturn this\n\t\t\t\t.action('Site::getList', {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tfilter,\n\t\t\t\t\t\torder: {ID: 'DESC'}\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.then((response) => response);\n\t\t});\n\t}\n\n\tgetLandings({siteId = []}: {siteId?: number | Array<number>} = {}, filter: {}): Promise<Array<Landing>>\n\t{\n\t\tlet skipFilter = false;\n\t\tif (!BX.Type.isPlainObject(filter))\n\t\t{\n\t\t\tfilter = {};\n\t\t\tskipFilter = true;\n\t\t}\n\n\t\tconst ids = Type.isArray(siteId) ? siteId : [siteId];\n\t\tfilter.SITE_ID = ids;\n\n\t\tconst getBathItem = (id) => ({\n\t\t\taction: 'Landing::getList',\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tfilter: (() => {\n\t\t\t\t\t\tif (skipFilter)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tSITE_ID: id,\n\t\t\t\t\t\t\t\tDELETED: 'N',\n\t\t\t\t\t\t\t\tFOLDER: 'N',\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn filter;\n\t\t\t\t\t})(),\n\t\t\t\t\torder: {ID: 'DESC'},\n\t\t\t\t\tget_preview: true,\n\t\t\t\t\tcheck_area: 1,\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tconst prepareResponse = (response) => {\n\t\t\treturn response.reduce((acc, item) => {\n\t\t\t\treturn [...acc, ...item.result];\n\t\t\t}, []);\n\t\t};\n\n\t\treturn this.cache.remember(`landings+${JSON.stringify(ids)}`, () => {\n\t\t\tif (ids.filter((id) => !Type.isNil(id)).length === 0)\n\t\t\t{\n\t\t\t\treturn this.getSites()\n\t\t\t\t\t.then((sites) => {\n\t\t\t\t\t\tconst data = sites.map((site) => getBathItem(site.ID));\n\t\t\t\t\t\treturn this.batch('Landing::getList', data);\n\t\t\t\t\t})\n\t\t\t\t\t.then((response) => prepareResponse(response))\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tresponse.forEach((landing) => {\n\t\t\t\t\t\t\tthis.cache.set(`landing+${landing.ID}`, Promise.resolve(landing));\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst data = ids.map((id) => getBathItem(id));\n\t\t\treturn this.batch('Landing::getList', data)\n\t\t\t\t.then((response) => prepareResponse(response))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tresponse.forEach((landing) => {\n\t\t\t\t\t\tthis.cache.set(`landing+${landing.ID}`, Promise.resolve(landing));\n\t\t\t\t\t});\n\t\t\t\t\treturn response;\n\t\t\t\t});\n\t\t});\n\t}\n\n\tgetLanding({landingId}: {landingId: string}): Promise<Landing>\n\t{\n\t\treturn this.cache.remember(`landing+${landingId}`, () => {\n\t\t\treturn this\n\t\t\t\t.action('Landing::getList', {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tfilter: {ID: landingId},\n\t\t\t\t\t\tget_preview: true,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (Type.isArray(response) && response.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn response[0];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\t\t});\n\t}\n\n\tgetBlocks({landingId}: {landingId: string}): Promise<Array<Block>>\n\t{\n\t\treturn this.cache.remember(`blocks+${landingId}`, () => {\n\t\t\treturn this\n\t\t\t\t.action('Block::getList', {\n\t\t\t\t\tlid: landingId,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tget_content: true,\n\t\t\t\t\t\tedit_mode: true,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.then((blocks) => {\n\t\t\t\t\tblocks.forEach((block) => {\n\t\t\t\t\t\tthis.cache.set(`block+${block.id}`, Promise.resolve(block));\n\t\t\t\t\t});\n\n\t\t\t\t\treturn blocks;\n\t\t\t\t});\n\t\t});\n\t}\n\n\tgetBlock({blockId}: {blockId: string}): Promise<Block>\n\t{\n\t\treturn this.cache.remember(`blockId+${blockId}`, () => {\n\t\t\treturn this.action('Block::getById', {\n\t\t\t\tblock: blockId,\n\t\t\t\tparams: {\n\t\t\t\t\tedit_mode: true,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTemplates({type = 'page', filter = {}} = {}): Promise<Array<Template>>\n\t{\n\t\treturn this.cache.remember(`templates+${JSON.stringify(filter)}`, () => {\n\t\t\treturn this\n\t\t\t\t.action('Demos::getPageList', {type, filter})\n\t\t\t\t.then((response) => Object.values(response));\n\t\t});\n\t}\n\n\tgetDynamicTemplates(sourceId: string = ''): Promise<Array<Template>>\n\t{\n\t\treturn this.cache.remember(`dynamicTemplates:${sourceId}`, () => {\n\t\t\treturn this.getTemplates({filter: {section: `dynamic${sourceId ? `:${sourceId}` : ''}`}});\n\t\t});\n\t}\n\n\tcreatePage(options: CreatePageOptions = {})\n\t{\n\t\tconst envOptions = Env.getInstance().getOptions();\n\t\tconst {\n\t\t\ttitle,\n\t\t\tsiteId = envOptions.site_id,\n\t\t\tsiteType = envOptions.params.type,\n\t\t\tcode = Text.getRandom(16),\n\t\t\tblockId,\n\t\t\tmenuCode,\n\t\t\tfolderId,\n\t\t} = options;\n\n\t\tconst templateCode = (() => {\n\t\t\tconst {theme} = envOptions;\n\t\t\tif (\n\t\t\t\tType.isPlainObject(theme)\n\t\t\t\t&& Type.isArray(theme.newPageTemplate)\n\t\t\t\t&& Type.isStringFilled(theme.newPageTemplate[0])\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn theme.newPageTemplate[0];\n\t\t\t}\n\n\t\t\treturn 'empty';\n\t\t})();\n\n\t\tconst requestBody = {\n\t\t\tsiteId,\n\t\t\tcode: templateCode,\n\t\t\tfields: {\n\t\t\t\tTITLE: title,\n\t\t\t\tCODE: code,\n\t\t\t\t//@todo: refactor\n\t\t\t\tADD_IN_MENU: (siteType === 'KNOWLEDGE' || siteType === 'GROUP') ? 'Y' : 'N'\n\t\t\t},\n\t\t};\n\n\t\tif (Type.isNumber(blockId) && Type.isString(menuCode))\n\t\t{\n\t\t\trequestBody.fields.BLOCK_ID = blockId;\n\t\t\trequestBody.fields.MENU_CODE = menuCode;\n\t\t}\n\n\t\tif (Type.isNumber(folderId))\n\t\t{\n\t\t\trequestBody.fields.FOLDER_ID = folderId;\n\t\t}\n\n\t\treturn this.action('Landing::addByTemplate', requestBody);\n\t}\n}"],"names":["additionalRequestCompleted","Backend","Cache","MemoryCache","cache","remember","uri","Uri","setQueryParams","site","Loc","getMessage","undefined","type","getSitesType","toString","landing","Reflection","getClass","instance","getInstance","options","Type","isUndefined","site_id","id","Env","getType","action","data","queryParams","uploadParams","getSiteId","requestBody","sessid","replace","lid","getLandingId","getControllerUrl","request","url","then","response","BX","Landing","UI","Panel","StatusPanel","update","onCustomEvent","PageObject","getRootWindow","result","err","error","isString","ErrorManager","add","Promise","reject","batch","file","formData","FormData","append","name","block","set","get","context","setQueryParam","filter","JSON","stringify","params","order","ID","siteId","skipFilter","isPlainObject","ids","isArray","SITE_ID","getBathItem","DELETED","FOLDER","get_preview","check_area","prepareResponse","reduce","acc","item","isNil","length","getSites","sites","map","forEach","resolve","landingId","get_content","edit_mode","blocks","blockId","Object","values","sourceId","getTemplates","section","envOptions","getOptions","title","siteType","code","Text","getRandom","menuCode","folderId","templateCode","theme","newPageTemplate","isStringFilled","fields","TITLE","CODE","ADD_IN_MENU","isNumber","BLOCK_ID","MENU_CODE","FOLDER_ID","xhr","sourceResponse","allSuccess","every","status","authorized","getResponseHeader","fd","Http","Data","convertObjectToFormData","ajax","method","dataType","start","preparePost","onsuccess","makeResponse","setMessage","newData","newResponse","top","window","location","reload","onfailure","send"],"mappings":"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"}