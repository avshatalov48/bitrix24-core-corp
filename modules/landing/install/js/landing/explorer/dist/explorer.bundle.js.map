{"version":3,"file":"explorer.bundle.js","sources":["../src/ui.js","../src/explorer.js"],"sourcesContent":["import { Loc, Tag, Text} from 'main.core';\n\nexport type DataType = {\n\tID: number,\n\tTITLE: string\n};\n\nexport type FolderType = {\n\tID: number,\n\tTITLE: string,\n\tPARENT_ID: ?number\n};\n\nimport 'ui.icons.disk';\n\nexport class ExplorerUI\n{\n\tstatic getLoader(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"landing-explorer-loader\">\n\t\t\t<div class=\"main-ui-loader\">\n\t\t\t\t<svg class=\"main-ui-loader-svg\" viewBox=\"25 25 50 50\">\n\t\t\t\t\t<circle class=\"main-ui-loader-svg-circle\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t</div>`;\n\t}\n\n\tstatic getActionButton(title: string, hadnler: () => {}): BX.UI.Button\n\t{\n\t\treturn new BX.UI.Button({\n\t\t\tid: 'landing-explorer-action',\n\t\t\tsize: BX.UI.Button.Size.MEDIUM,\n\t\t\tcolor: BX.UI.Button.Color.SUCCESS,\n\t\t\ttext: title,\n\t\t\tevents: {\n\t\t\t\tclick: hadnler\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getCancelButton(hadnler: () => {}): BX.UI.Button\n\t{\n\t\treturn new BX.UI.Button({\n\t\t\tid: 'landing-explorer-cancel',\n\t\t\tsize: BX.UI.Button.Size.MEDIUM,\n\t\t\tcolor: BX.UI.Button.Color.LINK,\n\t\t\ttext: Loc.getMessage('LANDING_EXT_EXPLORER_BUTTON_CANCEL'),\n\t\t\tevents: {\n\t\t\t\tclick: hadnler\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getSiteList(data: Array<DataType>, onClick: () => {}): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<ul class=\"landing-site-selector-list\">\n\t\t\t\t${data.map(item => {\n\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t<li class=\"landing-site-selector-item\" data-explorer-depth=\"0\" data-explorer-siteId=\"${item.ID}\" onclick=\"${() => onClick(item.ID)}\">\n\t\t\t\t\t\t\t<span class=\"ui-icon ui-icon-file-folder\"><i></i></span>\n\t\t\t\t\t\t\t<span class=\"landing-site-selector-item-value\">\n\t\t\t\t\t\t\t\t${Text.encode(item.TITLE)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t`;\n\t\t\t\t})}\n\t\t\t</ul>\n\t\t`;\n\t}\n\n\tstatic getFolderItem(item: DataType, depth: number, onClick: () => {}): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<li style=\"padding-left: ${30 * depth}px\" class=\"landing-site-selector-item landing-site-selector-item-lower\" data-explorer-depth=\"${depth}\" data-explorer-folderId=\"${item.ID}\" onclick=\"${() => onClick(item.ID)}\">\n\t\t\t\t<span class=\"ui-icon ui-icon-file-folder\"><i></i></span>\n\t\t\t\t<span class=\"landing-site-selector-item-value\"> \n\t\t\t\t\t${Text.encode(item.TITLE)}\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t`;\n\t}\n}\n","import { Backend } from 'landing.backend';\nimport { Loc } from 'landing.loc';\nimport { Dom } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nimport { ExplorerUI, DataType, FolderType } from './ui';\n\nimport './explorer.css';\n\ntype ExplorerOptions = {\n\ttype: string,\n\tsiteId: number,\n\tfolderId: ?number,\n\tstartBreadCrumbs: ?Array<FolderType>\n};\n\ntype ErrorType = {\n\terror: string,\n\terror_description: string\n};\n\nexport class Explorer\n{\n\t/** @var {Popup} */\n\tpopupWindow = null;\n\ttype: string;\n\tcurrentSiteId: number;\n\tcurrentFolderId: number;\n\tstartBreadCrumbs: ?Array<FolderType>;\n\n\tconstructor(options: ExplorerOptions)\n\t{\n\t\tthis.type = options.type;\n\t\tthis.currentSiteId = options.siteId;\n\t\tthis.currentFolderId = options.folderId;\n\t\tif (options.startBreadCrumbs)\n\t\t{\n\t\t\tthis.startBreadCrumbs = options.startBreadCrumbs;\n\t\t}\n\t\tthis.popupWindow = this.getPopupWindow();\n\t}\n\n\tgetPopupWindow()\n\t{\n\t\tif (this.popupWindow === null)\n\t\t{\n\t\t\tthis.popupWindow = new Popup({\n\t\t\t\tbindElement: null,\n\t\t\t\tclassName: 'ui-message-box landing-explorer--copy-page',\n\t\t\t\tcontent: null,\n\t\t\t\ttitleBar: '&nbsp;',\n\t\t\t\toverlay: { opacity: 30 },\n\t\t\t\tcloseIcon: false,\n\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\tpadding: 0\n\t\t\t});\n\t\t}\n\n\t\treturn this.popupWindow;\n\t}\n\n\topen()\n\t{\n\t\tthis.popupWindow.setContent(\n\t\t\tExplorerUI.getLoader()\n\t\t);\n\t\tthis.popupWindow.show();\n\t}\n\n\terrorAlert(errors: Array<ErrorType>)\n\t{\n\t\tMessageBox.alert(\n\t\t\terrors[0].error_description,\n\t\t\tLoc.getMessage('LANDING_EXT_EXPLORER_ALERT_TITLE')\n\t\t);\n\t}\n\n\tsetTitle(type: string, title: string)\n\t{\n\t\tthis.popupWindow.setTitleBar(\n\t\t\tLoc.getMessage('LANDING_EXT_EXPLORER_TITLE_' + type.toUpperCase())\n\t\t\t\t.replace('#title#', title)\n\t\t);\n\t}\n\n\tsetButtons(entityId: number, type: 'copy' | 'move' | 'moveFolder')\n\t{\n\t\tconst typeUpper = type.toUpperCase();\n\t\tlet action = null;\n\t\tlet data = null;\n\n\t\tthis.popupWindow.setButtons([\n\t\t\tExplorerUI.getActionButton(\n\t\t\t\t(type === 'moveFolder')\n\t\t\t\t? Loc.getMessage('LANDING_EXT_EXPLORER_BUTTON_MOVE')\n\t\t\t\t: Loc.getMessage('LANDING_EXT_EXPLORER_BUTTON_' + typeUpper),\n\t\t\t\t() => {\n\t\t\t\t\tswitch (type)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase 'copy':\n\t\t\t\t\t\t\taction = 'Landing::copy';\n\t\t\t\t\t\t\tdata = {\n\t\t\t\t\t\t\t\tlid: entityId,\n\t\t\t\t\t\t\t\ttoSiteId: this.currentSiteId,\n\t\t\t\t\t\t\t\ttoFolderId: this.currentFolderId\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'move':\n\t\t\t\t\t\t\taction = 'Landing::move';\n\t\t\t\t\t\t\tdata = {\n\t\t\t\t\t\t\t\tlid: entityId,\n\t\t\t\t\t\t\t\ttoSiteId: this.currentSiteId,\n\t\t\t\t\t\t\t\ttoFolderId: this.currentFolderId\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'moveFolder':\n\t\t\t\t\t\t\taction = 'Site::moveFolder';\n\t\t\t\t\t\t\tdata = {\n\t\t\t\t\t\t\t\tfolderId: entityId,\n\t\t\t\t\t\t\t\ttoFolderId: this.currentFolderId\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tBackend.getInstance()\n\t\t\t\t\t\t.action(\n\t\t\t\t\t\t\taction,\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsite_id: this.currentSiteId,\n\t\t\t\t\t\t\t\ttype: this.type\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis.popupWindow.setContent(\n\t\t\t\t\t\t\t\tExplorerUI.getLoader()\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.popupWindow.setContent(\n\t\t\t\t\t\t\t\tExplorerUI.getLoader()\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(reason => {\n\t\t\t\t\t\t\tthis.errorAlert(reason.result);\n\t\t\t\t\t\t\treturn Promise.reject(reason);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t),\n\t\t\tExplorerUI.getCancelButton(() => {\n\t\t\t\tthis.popupWindow.close();\n\t\t\t})\n\t\t]);\n\t}\n\n\t#loadBreadCrumbs(pos: number)\n\t{\n\t\tif (this.startBreadCrumbs[pos])\n\t\t{\n\t\t\tthis.#loadFolders(\n\t\t\t\tthis.currentSiteId,\n\t\t\t\tthis.startBreadCrumbs[pos].PARENT_ID,\n\t\t\t\t() => {\n\t\t\t\t\tif (this.startBreadCrumbs[pos + 1])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#loadBreadCrumbs(pos + 1);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#clickFolder(this.startBreadCrumbs[pos].ID);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t#loadSites()\n\t{\n\t\tBackend.getInstance()\n\t\t\t.action(\n\t\t\t\t'Site::getList',\n\t\t\t\t{\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tfilter: {\n\t\t\t\t\t\t\t'=TYPE': this.type,\n\t\t\t\t\t\t\t'=SPECIAL': 'N'\n\t\t\t\t\t\t},\n\t\t\t\t\t\torder: {\n\t\t\t\t\t\t\tDATE_MODIFY: 'desc'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: this.type\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then(result => {\n\t\t\t\tthis.popupWindow.setContent(\n\t\t\t\t\tExplorerUI.getSiteList(result, this.#clickSite.bind(this))\n\t\t\t\t);\n\t\t\t\tthis.popupWindow.adjustPosition();\n\t\t\t\tthis.#scrollToSite(this.currentSiteId);\n\t\t\t\tif (this.startBreadCrumbs.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.#selectSite(this.currentSiteId);\n\t\t\t\t\tthis.#loadBreadCrumbs(0);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#clickSite(this.currentSiteId);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\t#loadFolders(siteId: number, parentId: ?number, onLoad: ?() => {})\n\t{\n\t\tBackend.getInstance()\n\t\t\t.action(\n\t\t\t\t'Site::getFolders',\n\t\t\t\t{\n\t\t\t\t\tsiteId,\n\t\t\t\t\tfilter: {\n\t\t\t\t\t\tPARENT_ID: parentId ? parentId : 0\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tsite_id: siteId,\n\t\t\t\t\ttype: this.type\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then((result: Array<DataType>) => {\n\t\t\t\tif (result.length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst selectedItem = (parentId > 0)\n\t\t\t\t\t? this.#selectFolder(parentId)\n\t\t\t\t\t: this.#selectSite(siteId);\n\t\t\t\tresult.reverse().map((item: DataType) => {\n\t\t\t\t\tconst folderExist = document.querySelector('.landing-site-selector-item[data-explorer-folderId=\"' + item.ID + '\"]');\n\t\t\t\t\tif (!folderExist)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst depth = parseInt(Dom.attr(selectedItem, 'data-explorer-depth')) + 1;\n\t\t\t\t\t\tDom.insertAfter(\n\t\t\t\t\t\t\tExplorerUI.getFolderItem(item, depth, this.#clickFolder.bind(this)),\n\t\t\t\t\t\t\tselectedItem\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (onLoad)\n\t\t\t\t{\n\t\t\t\t\tonLoad();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\t#clickSite(siteId: number)\n\t{\n\t\tthis.currentFolderId = 0;\n\t\tthis.#selectSite(siteId);\n\t\tthis.#loadFolders(siteId);\n\t}\n\n\t#clickFolder(folderId: number)\n\t{\n\t\tthis.#selectFolder(folderId);\n\t\tthis.#loadFolders(this.currentSiteId, folderId);\n\t}\n\n\t#selectSite(siteId: number): HTMLElement\n\t{\n\t\tthis.currentSiteId = siteId;\n\t\treturn this.#selectItem(siteId, 'siteId')\n\t}\n\n\t#selectFolder(folderId: number): HTMLElement\n\t{\n\t\tthis.currentFolderId = folderId;\n\t\treturn this.#selectItem(folderId, 'folderId')\n\t}\n\n\t#selectItem(itemId: number, dataType: string): HTMLElement\n\t{\n\t\tconst currentSelect = document.querySelector('.landing-site-selector-item-selected');\n\t\tconst newSelect = document.querySelector('.landing-site-selector-item[data-explorer-' + dataType + '=\"' + itemId + '\"]');\n\t\tif (currentSelect)\n\t\t{\n\t\t\tDom.removeClass(currentSelect, 'landing-site-selector-item-selected');\n\t\t}\n\t\tif (newSelect)\n\t\t{\n\t\t\tDom.addClass(newSelect, 'landing-site-selector-item-selected');\n\t\t}\n\n\t\treturn newSelect;\n\t}\n\n\t#scrollToSite(siteId: number)\n\t{\n\t\tconst siteNode = document.querySelector('[data-explorer-siteId=\"' + siteId + '\"]');\n\t\tif (siteNode)\n\t\t{\n\t\t\t// const posY = siteNode.getBoundingClientRect().y;\n\t\t\t// document.querySelector('.landing-site-selector-list').scrollTo(0, posY);\n\t\t\tsiteNode.scrollIntoView(\n\t\t\t\t{\n\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\tblock: 'nearest',\n\t\t\t\t\tinline: 'start'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tcopy(landing: DataType)\n\t{\n\t\tthis.setTitle('copy', landing.TITLE);\n\t\tthis.setButtons(landing.ID, 'copy');\n\t\tthis.open();\n\t\tthis.#loadSites();\n\t}\n\n\tmove(landing: DataType)\n\t{\n\t\tthis.setTitle('move', landing.TITLE);\n\t\tthis.setButtons(landing.ID, 'move');\n\t\tthis.open();\n\t\tthis.#loadSites();\n\t}\n\n\tmoveFolder(folder: FolderType)\n\t{\n\t\tthis.setTitle('move', folder.TITLE);\n\t\tthis.setButtons(folder.ID, 'moveFolder');\n\t\tthis.open();\n\t\tthis.#loadSites();\n\t}\n}\n"],"names":["ExplorerUI","Tag","render","title","hadnler","BX","UI","Button","id","size","Size","MEDIUM","color","Color","SUCCESS","text","events","click","LINK","Loc","getMessage","data","onClick","map","item","ID","Text","encode","TITLE","depth","Explorer","options","type","currentSiteId","siteId","currentFolderId","folderId","startBreadCrumbs","popupWindow","getPopupWindow","Popup","bindElement","className","content","titleBar","overlay","opacity","closeIcon","contentBackground","padding","setContent","getLoader","show","errors","MessageBox","alert","error_description","setTitleBar","toUpperCase","replace","entityId","typeUpper","action","setButtons","getActionButton","lid","toSiteId","toFolderId","Backend","getInstance","site_id","then","window","location","reload","catch","reason","errorAlert","result","Promise","reject","getCancelButton","close","landing","setTitle","open","folder","pos","PARENT_ID","params","filter","order","DATE_MODIFY","getSiteList","bind","adjustPosition","length","parentId","onLoad","selectedItem","reverse","folderExist","document","querySelector","parseInt","Dom","attr","insertAfter","getFolderItem","itemId","dataType","currentSelect","newSelect","removeClass","addClass","siteNode","scrollIntoView","behavior","block","inline"],"mappings":"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"}