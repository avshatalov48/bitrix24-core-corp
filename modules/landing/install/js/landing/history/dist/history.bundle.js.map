{"version":3,"file":"history.bundle.js","sources":["../src/internal/constants.js","../src/action/edit-node.js","../src/action/edit-text.js","../src/action/edit-embed.js","../src/action/edit-map.js","../src/action/edit-image.js","../src/action/edit-icon.js","../src/action/edit-link.js","../src/action/change-node-name.js","../src/action/sort-block.js","../src/action/add-block.js","../src/action/remove-block.js","../src/action/add-card.js","../src/action/remove-card.js","../src/action/add-node.js","../src/action/remove-node.js","../src/action/edit-style.js","../src/action/edit-attributes.js","../src/action/update-content.js","../src/action/multiply.js","../src/action/replace-landing.js","../src/action/change-anchor.js","../src/history-command.js","../src/internal/register-base-commands.js","../src/internal/async-json-parse.js","../src/internal/async-json-stringify.js","../src/internal/remove-page-history.js","../src/internal/load-stack.js","../src/internal/clear.js","../src/internal/on-update.js","../src/internal/on-init.js","../src/history-entry.js","../src/history-highlight.js","../src/history.js"],"sourcesContent":["export const UNDO: string = 'undo';\nexport const REDO: string = 'redo';\nexport const INIT: string = 'init';\nexport const RESOLVED: string = 'resolved';\nexport const PENDING: string = 'pending';\nexport const MAX_ENTRIES_COUNT: number = 100;","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nconst editNode = function (entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tblock.forceInit();\n\t\t\tconst node = block.nodes.getBySelector(entry.selector);\n\n\t\t\tif (!node)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\treturn scrollTo(node.node)\n\t\t\t\t.then(highlight.bind(null, node.node, editNode.useRangeRect))\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn node.setValue(entry.params.value, false, true);\n\t\t\t\t});\n\t\t});\n}\neditNode.useRangeRect = true;\n\nexport default editNode;","import editNode from './edit-node';\n\nconst editText = editNode;\n\nexport default editText;","import editNode from './edit-node';\n\nconst editEmbed = editNode;\n\nexport default editEmbed;","import editNode from './edit-node';\n\nconst editMap = editNode;\n\nexport default editMap;","import editNode from './edit-node';\n\nconst editImage = editNode;\neditImage.useRangeRect = false;\n\nexport default editImage;","import editImage from './edit-image';\n\nconst editIcon = editImage;\n\nexport default editIcon;","import editNode from './edit-node';\n\nconst editLink = editNode;\neditLink.useRangeRect = false;\n\nexport default editLink;","import {Type} from 'main.core';\n\nconst {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function changeNodeName(entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\t\t\tblock.forceInit();\n\n\t\t\tconst node = block.nodes.getBySelector(entry.selector);\n\t\t\tif (!node)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\treturn scrollTo(node.node)\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn highlight(node.node);\n\t\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (node.onChangeTag)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.onChangeTag(entry.params.value, true);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t});\n}","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function sortBlock(entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\t\t\tblock.forceInit();\n\n\t\t\treturn scrollTo(block.node)\n\t\t\t\t.then(highlight.bind(null, block.node))\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn block[entry.params.direction](true);\n\t\t\t\t});\n\t\t});\n}","import {PageObject} from 'landing.pageobject';\n\nconst {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function addBlock(entry)\n{\n\treturn PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.params.currentBlock);\n\n\t\t\treturn new Promise(((resolve) => {\n\t\t\t\tif (block)\n\t\t\t\t{\n\t\t\t\t\tblock.forceInit();\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t}))\n\t\t\t.then(() => {\n\t\t\t\tconst landing = BX.Landing.Main.getInstance();\n\t\t\t\tlanding.currentBlock = block;\n\n\t\t\t\treturn PageObject.getInstance().view().then((iframe) => {\n\t\t\t\t\tlanding.currentArea = iframe.contentDocument.body.querySelector(`[data-landing=\"${entry.params.lid}\"]`);\n\t\t\t\t\tlanding.insertBefore = entry.params.insertBefore;\n\n\t\t\t\t\treturn landing.onAddBlock(entry.params.code, entry.block, true)\n\t\t\t\t\t\t.then(newBlock => {\n\t\t\t\t\t\t\treturn scrollTo(newBlock)\n\t\t\t\t\t\t\t\t.then(highlight.bind(null, newBlock, false, false));\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t});\n\t\t\t});\n\t\t});\n}","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function removeBlock(entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\t\t\tblock.forceInit();\n\n\t\t\treturn scrollTo(block.node)\n\t\t\t\t.then(() => {\n\t\t\t\t\thighlight(block.node);\n\t\t\t\t\treturn block.deleteBlock(true);\n\t\t\t\t});\n\t\t});\n}","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {string} state\n * @param {object} entry\n * @return {Promise}\n */\nexport default function addCard(entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\t\t\tif (block)\n\t\t\t{\n\t\t\t\tblock.forceInit();\n\t\t\t}\n\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tconst parentNode = block.node.querySelector(entry.params.selector).parentNode;\n\n\t\t\treturn scrollTo(parentNode)\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn block\n\t\t\t\t\t\t.addCard({\n\t\t\t\t\t\t\tindex: entry.params.position,\n\t\t\t\t\t\t\tcontainer: parentNode,\n\t\t\t\t\t\t\tcontent: entry.params.content,\n\t\t\t\t\t\t\tselector: entry.params.selector,\n\t\t\t\t\t\t}, true)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tconst cardSelector = entry.params.selector + '@' + entry.params.position;\n\t\t\t\t\t\t\tconst card = block.cards.getBySelector(cardSelector);\n\t\t\t\t\t\t\tif (!card)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn Promise.reject();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn highlight(card.node);\n\t\t\t\t\t\t})\n\t\t\t\t});\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(\"Error in history action addCard\", err);\n\t\t});\n}","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {string} state\n * @param {object} entry\n * @return {Promise}\n */\nexport default function removeCard(entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\t\t\tblock.forceInit();\n\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tconst relativeSelector = entry.params.selector + '@' + (entry.params.position + 1);\n\t\t\tconst card = block.cards.getBySelector(relativeSelector);\n\n\t\t\tif (!card)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\treturn scrollTo(card.node)\n\t\t\t\t.then(highlight.bind(null, card.node))\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn block.removeCard(relativeSelector, true);\n\t\t\t\t});\n\t\t});\n}","/**\n * History entry action for add node.\n * @param {object} entry History entry.\n * @return {Promise}\n */\nexport default function addNode(entry)\n{\n\t// entry.block === null >> designer mode\n\n\treturn new Promise((resolve, reject) => {\n\t\tconst tags = entry.params.tags || {};\n\t\ttop.BX.onCustomEvent(this, 'Landing:onHistoryAddNode', [tags]);\n\t\tresolve();\n\t});\n}","/**\n * History entry action for remove node.\n * @param {object} entry History entry.\n * @return {Promise}\n */\nexport default function removeNode(entry)\n{\n\t// entry.block === null >> designer mode\n\n\treturn new Promise((resolve, reject) => {\n\t\tconst tags = entry.params.tags || {};\n\t\ttop.BX.onCustomEvent(this, 'Landing:onHistoryRemoveNode', [tags]);\n\t\tresolve();\n\t});\n}","const {scrollTo, slice} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function editStyle(entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tblock.forceInit();\n\t\t\tblock.initStyles();\n\t\t\treturn block;\n\t\t})\n\t\t.then((block) => {\n\t\t\treturn scrollTo(block.node)\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn block;\n\t\t\t\t});\n\t\t})\n\t\t.then((block) => {\n\t\t\tlet elements = slice(block.node.querySelectorAll(entry.selector));\n\n\t\t\tif (entry.params.isWrapper)\n\t\t\t{\n\t\t\t\telements = [block.content];\n\t\t\t\tentry.selector += ' > :first-child';\n\t\t\t}\n\n\t\t\telements.forEach((element, pos) => {\n\t\t\t\tif (\n\t\t\t\t\tentry.params.position >= 0\n\t\t\t\t\t&& entry.params.position !== pos\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\telement.className = entry.params.value.className;\n\t\t\t\tif (entry.params.value.style && entry.params.value.style !== '')\n\t\t\t\t{\n\t\t\t\t\telement.style = entry.params.value.style;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\telement.removeAttribute('style');\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn block;\n\t\t})\n\t\t.then((block) => {\n\t\t\tconst form = block.forms.find((currentForm) => {\n\t\t\t\treturn (\n\t\t\t\t\tcurrentForm.selector === entry.selector\n\t\t\t\t\t|| currentForm.relativeSelector === entry.selector\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tif (form)\n\t\t\t{\n\t\t\t\tform.fields.forEach((field) => {\n\t\t\t\t\tfield.reset();\n\t\t\t\t\tfield.onFrameLoad();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// todo: relative selector? position?\n\t\t\tconst styleNode = block.styles.find((style) => {\n\t\t\t\treturn (\n\t\t\t\t\tstyle.selector === entry.selector\n\t\t\t\t\t|| style.relativeSelector === entry.selector\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tif (styleNode)\n\t\t\t{\n\t\t\t\tif (entry.params.affect && entry.params.affect.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstyleNode.setAffects(entry.params.affect);\n\t\t\t\t}\n\t\t\t\tblock.onStyleInputWithDebounce({\n\t\t\t\t\tnode: styleNode.node,\n\t\t\t\t\tdata: styleNode.getValue()\n\t\t\t\t}, true);\n\t\t\t}\n\t\t});\n}","import {PageObject} from 'landing.pageobject';\n\nconst {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function editAttributes(entry)\n{\n\treturn PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tif (block)\n\t\t\t\t{\n\t\t\t\t\tblock.forceInit();\n\t\t\t\t\tresolve(block);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(block => {\n\t\t\t\treturn scrollTo(block.node)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\treturn block.applyAttributeChanges({\n\t\t\t\t\t\t\t[entry.params.selector]: {\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t[entry.params.attribute]: entry.params.value,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.then(highlight.bind(null, block.node, false, false))\n\t\t\t\t;\n\t\t\t});\n\t\t});\n}","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function updateContent(entry)\n{\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.block);\n\t\t\tblock.forceInit();\n\n\t\t\treturn scrollTo(block.node)\n\t\t\t\t.then(() => {\n\t\t\t\t\tvoid highlight(block.node);\n\t\t\t\t\treturn block.updateContent(entry.params.content, true);\n\t\t\t\t});\n\t\t});\n}","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function multiply(entry)\n{\n\tlet blockId = null;\n\tconst updateBlockStateData = {};\n\tentry.params.forEach(singleAction => {\n\t\tif (!blockId && singleAction.params.block)\n\t\t{\n\t\t\tblockId = singleAction.params.block;\n\t\t}\n\n\t\tif (\n\t\t\tsingleAction.command === 'editText'\n\t\t\t|| singleAction.command === 'editImage'\n\t\t\t|| singleAction.command === 'editEmbed'\n\t\t\t|| singleAction.command === 'editMap'\n\t\t\t|| singleAction.command === 'editIcon'\n\t\t\t|| singleAction.command === 'editLink'\n\t\t)\n\t\t{\n\t\t\tupdateBlockStateData[singleAction.params.selector] = singleAction.params.value;\n\t\t}\n\n\t\tif (singleAction.command === 'updateDynamic')\n\t\t{\n\t\t\tupdateBlockStateData.dynamicParams = singleAction.params.dynamicParams;\n\t\t\tupdateBlockStateData.dynamicState = singleAction.params.dynamicState;\n\t\t}\n\n\t\tif (singleAction.command === 'changeAnchor')\n\t\t{\n\t\t\tupdateBlockStateData.settings = {id: singleAction.params.value};\n\t\t}\n\t});\n\n\treturn BX.Landing.PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(blockId);\n\t\t\tif (block)\n\t\t\t{\n\t\t\t\tblock.forceInit();\n\n\t\t\t\treturn scrollTo(block.node)\n\t\t\t\t\t.then(() =>\n\t\t\t\t\t{\n\t\t\t\t\t\tvoid highlight(block.node);\n\t\t\t\t\t\tif (Object.keys(updateBlockStateData).length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tblock.updateBlockState(updateBlockStateData, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n}","const {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function replaceLanding(entry)\n{\n\treturn new Promise((resolve, reject) => {\n\t\ttop.window.location.reload();\n\t\tresolve();\n\t});\n}","import {PageObject} from 'landing.pageobject';\n\nconst {scrollTo, highlight} = BX.Landing.Utils;\n\n/**\n * @param {object} entry\n * @return {Promise}\n */\nexport default function changeAnchor(entry)\n{\n\treturn PageObject.getInstance().blocks()\n\t\t.then((blocks) => {\n\t\t\tconst block = blocks.get(entry.params.currentBlock);\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tif (block)\n\t\t\t\t{\n\t\t\t\t\tblock.forceInit();\n\t\t\t\t\tresolve(block);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((block) => {\n\t\t\t\tscrollTo(block).then(highlight.bind(null, block, false, false));\n\t\t\t});\n\t\t});\n}","import {Type} from 'main.core';\n\n/**\n * Implements interface for works with command of history\n * @param {{id: string, undo: function, redo: function}} options\n */\nexport default class Command\n{\n\tid: string;\n\tcommand: () => {};\n\tonBeforeCommand: () => {};\n\n\tconstructor(options: {\n\t\tid: string,\n\t\tcommand: () => {},\n\t\tonBeforeCommand: () => {},\n\t})\n\t{\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : '#invalidCommand';\n\t\tthis.command = Type.isFunction(options.command) ? options.command : (() => {});\n\t\tthis.onBeforeCommand =\n\t\t\tType.isFunction(options.onBeforeCommand)\n\t\t\t\t? options.onBeforeCommand\n\t\t\t\t: () => {\n\t\t\t\t\treturn Promise.resolve()\n\t\t\t\t};\n\t}\n}","import {Runtime, Dom, Tag} from 'main.core';\n\nimport {PageObject} from 'landing.pageobject';\n\nimport editText from '../action/edit-text';\nimport editEmbed from '../action/edit-embed';\nimport editMap from '../action/edit-map';\nimport editImage from '../action/edit-image';\nimport editIcon from '../action/edit-icon';\nimport editLink from '../action/edit-link';\nimport changeNodeName from '../action/change-node-name';\nimport sortBlock from '../action/sort-block';\nimport addBlock from '../action/add-block';\nimport removeBlock from '../action/remove-block';\nimport addCard from '../action/add-card';\nimport removeCard from '../action/remove-card';\nimport addNode from '../action/add-node';\nimport removeNode from '../action/remove-node';\nimport editStyle from '../action/edit-style';\nimport editAttributes from '../action/edit-attributes';\nimport updateContent from '../action/update-content';\nimport multiply from '../action/multiply';\nimport replaceLanding from '../action/replace-landing';\nimport changeAnchor from '../action/change-anchor';\n\nimport Command from '../history-command';\n\nimport type {History} from '../history';\n\n/**\n * Registers base internal commands\n * @param {History} history\n * @return {Promise<History>}\n */\nexport default function registerBaseCommands(history: History)\n{\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'editText',\n\t\t\tcommand: editText,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'editImage',\n\t\t\tcommand: editImage,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'editEmbed',\n\t\t\tcommand: editEmbed,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'editMap',\n\t\t\tcommand: editMap,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'editIcon',\n\t\t\tcommand: editIcon,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'editLink',\n\t\t\tcommand: editLink,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'cnangeNodeName',\n\t\t\tcommand: changeNodeName,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'sortBlock',\n\t\t\tcommand: sortBlock,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'addBlock',\n\t\t\tcommand: addBlock,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'removeBlock',\n\t\t\tcommand: removeBlock,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'updateStyle',\n\t\t\tcommand: editStyle,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'addCard',\n\t\t\tcommand: addCard,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'removeCard',\n\t\t\tcommand: removeCard,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'addNode',\n\t\t\tcommand: addNode,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'removeNode',\n\t\t\tcommand: removeNode,\n\t\t}),\n\t);\n\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'updateContent',\n\t\t\tcommand: updateContent,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'replaceLanding',\n\t\t\tcommand: replaceLanding,\n\t\t\tonBeforeCommand: () => {\n\t\t\t\treturn Runtime.loadExtension('main.loader')\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tconst editor = BX.Landing.PageObject.getEditorWindow();\n\t\t\t\t\t\tif (editor)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst container = Tag.render`<div class=\"landing-ui-modal\"></div>`;\n\t\t\t\t\t\t\tDom.append(container, editor.document.body);\n\t\t\t\t\t\t\tconst loader = new BX.Loader({target: container});\n\t\t\t\t\t\t\tloader.show();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t\t});\n\t\t\t}\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'changeAnchor',\n\t\t\tcommand: changeAnchor,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'editAttributes',\n\t\t\tcommand: editAttributes,\n\t\t}),\n\t);\n\n\thistory.registerCommand(\n\t\tnew Command({\n\t\t\tid: 'multiply',\n\t\t\tcommand: multiply,\n\t\t}),\n\t);\n\n\treturn Promise.resolve(history);\n}","const worker = new Worker(\n\t'/bitrix/js/landing/history/src/worker/json-parse-worker.js',\n);\n\n/**\n * Parses json string\n * @param {string} str\n * @return {Promise<?Object|array>}\n */\nexport default function asyncJsonParse(str): Promise<{[key: string]: any} | Array<any>>\n{\n\treturn new Promise(((resolve) => {\n\t\tworker.postMessage(str);\n\t\tworker.addEventListener('message', (event) => {\n\t\t\tresolve(event.data);\n\t\t});\n\t}));\n}\n","const worker = new Worker(\n\t'/bitrix/js/landing/history/src/worker/json-stringify-worker.js',\n);\n\n/**\n * Serializes object\n * @param {Object|array} obj\n * @return {Promise<?String>}\n */\nexport default function asyncJsonStringify(obj: {[key: string]: any} | Array<any>): Promise<?string>\n{\n\treturn new Promise(((resolve) => {\n\t\tworker.postMessage(obj);\n\t\tworker.addEventListener('message', (event) => {\n\t\t\tresolve(event.data);\n\t\t});\n\t}));\n}","import {Type} from 'main.core';\nimport asyncJsonParse from './async-json-parse';\nimport asyncJsonStringify from './async-json-stringify';\nimport type {History} from '../history';\n\n/**\n * Removes page history from storage\n * @param {int} pageId\n * @param {History} history\n * @return {Promise<History>}\n */\nexport default function removePageHistory(pageId, history: History): Promise<History>\n{\n\treturn asyncJsonParse(window.localStorage.history)\n\t\t.then((historyData) => {\n\t\t\treturn Type.isPlainObject(historyData) ? historyData : {};\n\t\t})\n\t\t.then((all) => {\n\t\t\tif (pageId in all)\n\t\t\t{\n\t\t\t\tdelete all[pageId];\n\t\t\t}\n\n\t\t\treturn all;\n\t\t})\n\t\t.then(asyncJsonStringify)\n\t\t.then((allString) => {\n\t\t\twindow.localStorage.history = allString;\n\t\t\treturn history;\n\t\t});\n}\n","import {Type, Text} from 'main.core';\nimport {Main} from 'landing.main';\nimport type {History} from '../history';\n\n/**\n * Loads history from storage\n * @param {History} history\n * @return {Promise<History>}\n */\nexport default function loadStack(history: History): Promise<History>\n{\n\treturn BX.Landing.Backend.getInstance()\n\t\t.action(\n\t\t\thistory.getLoadBackendActionName(),\n\t\t\thistory.getLoadBackendParams(),\n\t\t)\n\t\t.then((data: {stack: {[number]: string}, stackCount: number, step: number}) => {\n\t\t\thistory.stack = Type.isObject(data.stack) ? data.stack : {};\n\t\t\thistory.stackCount = Text.toNumber(data.stackCount);\n\t\t\thistory.step = Math.min(Text.toNumber(data.step), history.stackCount);\n\n\t\t\treturn history;\n\t\t})\n\t\t.catch((e) => {\n\t\t\treturn history;\n\t\t});\n}","import {INIT, RESOLVED} from './constants';\nimport type {History} from '../history';\n\n/**\n * Clears history stack\n * @param {History} history\n * @return {Promise<History>}\n */\nexport default function clear(history: History): Promise<History>\n{\n\thistory.stack = {};\n\thistory.stackCount = 0;\n \thistory.step = 0;\n\thistory.commandState = RESOLVED;\n\n\treturn Promise.resolve(history);\n}","import type {History} from '../history';\n\n/**\n * Calls on update history stack\n * @param {History} history\n * @return {Promise<History>}\n */\nexport default function onUpdate(history: History): Promise<History>\n{\n\tconst rootWindow = BX.Landing.PageObject.getRootWindow();\n\tBX.onCustomEvent(rootWindow.window, 'BX.Landing.History:update', [history]);\n\n\treturn Promise.resolve(history);\n}","import type {History} from '../history';\n\n/**\n * Calls on init history object\n * @param history\n * @return {Promise<History>}\n */\nexport default function onInit(history: History): Promise<History>\n{\n\tconst rootWindow = BX.Landing.PageObject.getRootWindow();\n\tBX.onCustomEvent(rootWindow.window, 'BX.Landing.History:init', [history]);\n\n\treturn Promise.resolve(history);\n}","import {Type} from 'main.core';\n\nexport default class Entry\n{\n\tconstructor(options)\n\t{\n\t\tthis.block = options.block;\n\t\tthis.selector = options.selector;\n\t\tthis.command = Type.isStringFilled(options.command) ? options.command : '#invalidCommand';\n\t\tthis.params = options.params;\n\t}\n}","import {PageObject} from 'landing.pageobject';\nimport {Highlight as HighlightNode} from 'landing.ui.highlight';\n\nexport default class Highlight extends HighlightNode\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.layout.classList.add('landing-ui-highlight-animation');\n\t\tthis.animationDuration = 300;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tconst rootWindow = PageObject.getRootWindow();\n\t\tif (!rootWindow.BX.Landing.History.Highlight.instance)\n\t\t{\n\t\t\trootWindow.BX.Landing.History.Highlight.instance = new Highlight();\n\t\t}\n\n\t\treturn rootWindow.BX.Landing.History.Highlight.instance;\n\t}\n\n\tshow(element, rect): Promise<any>\n\t{\n\t\tBX.Landing.UI.Highlight.prototype.show.call(this, element, rect);\n\n\t\treturn new Promise(((resolve) => {\n\t\t\tsetTimeout(resolve, this.animationDuration);\n\t\t\tthis.hide();\n\t\t}));\n\t}\n}","import {Event} from 'main.core';\nimport {Main} from 'landing.main';\nimport {PageObject} from 'landing.pageobject';\nimport {RESOLVED, PENDING} from './internal/constants';\nimport registerBaseCommands from './internal/register-base-commands';\nimport removePageHistory from './internal/remove-page-history';\nimport loadStack from './internal/load-stack';\nimport clear from './internal/clear';\nimport onUpdate from './internal/on-update';\nimport onInit from './internal/on-init';\nimport Command from './history-command';\nimport Entry from './history-entry';\nimport Highlight from './history-highlight';    // not delete - just for export\n\nimport './css/style.css';\n\n/**\n * Implements interface for works with landing history\n * Implements singleton pattern use as BX.Landing.History.getInstance()\n * @memberOf BX.Landing\n */\nexport class History\n{\n\tstatic TYPE_LANDING = 'L';\n\tstatic TYPE_DESIGNER_BLOCK = 'D';\n\n\t/**\n\t * Stack of action commands. Key - is step, value - is a command name\n\t */\n\tstack: {[number]: string};\n\n\t/**\n\t * Lenght of stack\n\t */\n\tstackCount: number;\n\n\t/**\n\t * Key - is step, value - is a Command object\n\t */\n\tcommands: {[number]: Command};\n\n\t/**\n\t * From 1 to X. 0 - is state without any history\n\t * @type {number}\n\t */\n\tstep: number;\n\tcommandState: string;\n\tlandingId: number;\n\tdesignerBlockId: ?number = null;\n\n\tconstructor()\n\t{\n\t\tthis.type = History.TYPE_LANDING;\n\t\tthis.stack = {};\n\t\tthis.stackCount = 0;\n\t\tthis.step = 0;\n\t\tthis.commands = {};\n\t\tthis.commandState = RESOLVED;\n\t\tthis.onStorage = this.onStorage.bind(this);\n\n\t\ttry\n\t\t{\n\t\t\tthis.landingId = Main.getInstance().id;\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tthis.landingId = -1;\n\t\t}\n\n\t\tEvent.bind(window, 'storage', this.onStorage);\n\n\t\tregisterBaseCommands(this)\n\t\t\t.then(loadStack)\n\t\t\t.then(onInit);\n\t}\n\n\tstatic Command = Command;\n\tstatic Entry = Entry;\n\tstatic Highlight = Highlight; // not delete - just for export\n\n\tstatic getInstance(): History\n\t{\n\t\tconst rootWindow = PageObject.getRootWindow();\n\t\tif (!rootWindow.BX.Landing.History.instance)\n\t\t{\n\t\t\trootWindow.BX.Landing.History.instance = new BX.Landing.History();\n\t\t}\n\n\t\treturn rootWindow.BX.Landing.History.instance;\n\t}\n\n\t/**\n\t * Set special type for designer block\n\t * @param blockId\n\t * @return {Promise<BX.Landing.History>|*}\n\t */\n\tsetTypeDesignerBlock(blockId: number): Promise<History>\n\t{\n\t\tthis.type = History.TYPE_DESIGNER_BLOCK;\n\t\tthis.designerBlockId = blockId;\n\n\t\treturn loadStack(this);\n\t}\n\n\tgetLoadBackendActionName(): string\n\t{\n\t\tif (this.type === History.TYPE_DESIGNER_BLOCK)\n\t\t{\n\t\t\treturn \"History::getForDesignerBlock\";\n\t\t}\n\n\t\treturn \"History::getForLanding\";\n\t}\n\n\tgetLoadBackendParams(): string\n\t{\n\t\tif (this.type === History.TYPE_DESIGNER_BLOCK)\n\t\t{\n\t\t\treturn {blockId: this.designerBlockId};\n\t\t}\n\n\t\treturn {lid: this.landingId};\n\t}\n\n\tgetUndoBackendActionName(): string\n\t{\n\t\tif (this.type === History.TYPE_DESIGNER_BLOCK)\n\t\t{\n\t\t\treturn \"History::undoDesignerBlock\";\n\t\t}\n\n\t\treturn \"History::undoLanding\";\n\t}\n\n\tbeforeUndo(): Promise\n\t{\n\t\tconst step = this.step;\n\t\tif (\n\t\t\tthis.stack[step]\n\t\t\t&& this.commands[this.stack[step]]\n\t\t)\n\t\t{\n\t\t\tconst command = this.commands[this.stack[step]];\n\n\t\t\treturn command.onBeforeCommand();\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\tgetRedoBackendActionName(): string\n\t{\n\t\tif (this.type === History.TYPE_DESIGNER_BLOCK)\n\t\t{\n\t\t\treturn \"History::redoDesignerBlock\";\n\t\t}\n\n\t\treturn \"History::redoLanding\";\n\t}\n\n\tbeforeRedo(): Promise\n\t{\n\t\tconst step = this.step + 1;\n\t\tif (\n\t\t\tthis.stack[step]\n\t\t\t&& this.commands[this.stack[step]]\n\t\t)\n\t\t{\n\t\t\tconst command = this.commands[this.stack[step]];\n\n\t\t\treturn command.onBeforeCommand();\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\tgetBackendActionParams(): string\n\t{\n\t\tif (\n\t\t\tthis.type === History.TYPE_DESIGNER_BLOCK\n\t\t\t&& this.designerBlockId\n\t\t)\n\t\t{\n\t\t\treturn {\n\t\t\t\tblockId: this.designerBlockId,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tlid: this.landingId,\n\t\t};\n\t}\n\n\t/**\n\t * Applies preview history entry\n\t * @return {Promise}\n\t */\n\tundo(): Promise\n\t{\n\t\tif (this.canUndo())\n\t\t{\n\t\t\tthis.commandState = PENDING;\n\t\t\treturn this.beforeUndo()\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn BX.Landing.Backend.getInstance()\n\t\t\t\t\t\t.action(\n\t\t\t\t\t\t\tthis.getUndoBackendActionName(),\n\t\t\t\t\t\t\tthis.getBackendActionParams(),\n\t\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t.then(command => {\n\t\t\t\t\tif (command)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst params = command.params;\n\t\t\t\t\t\tconst entry = new Entry({\n\t\t\t\t\t\t\tblock: params.block,\n\t\t\t\t\t\t\tselector: params.selector,\n\t\t\t\t\t\t\tcommand: command.command,\n\t\t\t\t\t\t\tparams: params,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn this.runCommand(entry, -1);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.reject();\n\t\t\t\t})\n\t\t\t\t.then(res => {\n\t\t\t\t\treturn this.offset(-1).then(onUpdate);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\treturn Promise.resolve(this);\n\t}\n\n\n\t/**\n\t * Applies preview next history entry\n\t * @return {Promise}\n\t */\n\tredo(): Promise\n\t{\n\t\tif (this.canRedo())\n\t\t{\n\t\t\tthis.commandState = PENDING;\n\t\t\treturn this.beforeRedo()\n\t\t\t\t.then(() => {\n\t\t\t\t\treturn BX.Landing.Backend.getInstance()\n\t\t\t\t\t\t.action(\n\t\t\t\t\t\t\tthis.getRedoBackendActionName(),\n\t\t\t\t\t\t\tthis.getBackendActionParams(),\n\t\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t.then(command => {\n\t\t\t\t\tif (command)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst params = command.params;\n\t\t\t\t\t\tconst entry = new Entry({\n\t\t\t\t\t\t\tblock: params.block,\n\t\t\t\t\t\t\tselector: params.selector,\n\t\t\t\t\t\t\tcommand: command.command,\n\t\t\t\t\t\t\tparams: params,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn this.runCommand(entry, 1);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.reject();\n\t\t\t\t})\n\t\t\t\t.then(res => {\n\t\t\t\t\treturn this.offset(1).then(onUpdate);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\treturn Promise.resolve(this);\n\t}\n\n\trunCommand(entry: Entry, offsetValue: number)\n\t{\n\t\tif (entry)\n\t\t{\n\t\t\tconst command = this.commands[entry.command];\n\t\t\tif (command)\n\t\t\t{\n\t\t\t\tthis.commandState = PENDING;\n\n\t\t\t\treturn command.command(entry)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.commandState = RESOLVED;\n\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tthis.commandState = RESOLVED;\n\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\toffset(offsetValue: number): Promise<History>\n\t{\n\t\tif (this.commandState === PENDING)\n\t\t{\n\t\t\treturn Promise.resolve(this);\n\t\t}\n\n\t\tlet step = this.step + offsetValue;\n\n\t\tif (step >= 0 && step <= this.stackCount)\n\t\t{\n\t\t\tthis.step = step;\n\t\t}\n\n\t\treturn Promise.resolve(this);\n\t}\n\n\t/**\n\t * Check that there are actions to undo\n\t * @returns {boolean}\n\t */\n\tcanUndo()\n\t{\n\t\treturn (\n\t\t\tthis.commandState !== PENDING\n\t\t\t&& (this.step > 0 && this.stackCount > 0 && this.step <= this.stackCount)\n\t\t);\n\t}\n\n\n\t/**\n\t * Check that there are actions to redo\n\t * @returns {boolean}\n\t */\n\tcanRedo()\n\t{\n\t\treturn (\n\t\t\tthis.commandState !== PENDING\n\t\t\t&& (this.step < this.stackCount && this.step >= 0)\n\t\t);\n\t}\n\n\n\t/**\n\t * Adds entry to history stack\n\t * @param {BX.Landing.History.Entry} entry\n\t */\n\tpush(): Promise<History>\n\t{\n\t\tif (this.step < this.stackCount)\n\t\t{\n\t\t\tthis.stackCount = this.step;\n\t\t}\n\n\t\tthis.step++;\n\t\tthis.stackCount++;\n\n\t\treturn new Promise(resolve => {\n\t\t\tsetTimeout(resolve, 400);\n\t\t})\n\t\t\t.then(() => {return loadStack(this)})\n\t\t\t.then(onUpdate)\n\t\t;\n\t}\n\n\n\t/**\n\t * Registers unique history command\n\t * @param {Command} command\n\t */\n\tregisterCommand(command)\n\t{\n\t\tif (command instanceof Command)\n\t\t{\n\t\t\tthis.commands[command.id] = command;\n\t\t}\n\t}\n\n\n\t/**\n\t * Removes page history from storage\n\t * @param {int} pageId\n\t * @return {Promise<BX.Landing.History>}\n\t */\n\tremovePageHistory(pageId)\n\t{\n\t\t// todo: publication clear method\n\t\treturn removePageHistory(pageId, this)\n\t\t\t.then((history) => {\n\t\t\t\tlet currentPageId;\n\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tcurrentPageId = BX.Landing.Main.getInstance().id;\n\t\t\t\t}\n\t\t\t\tcatch (err)\n\t\t\t\t{\n\t\t\t\t\tcurrentPageId = -1;\n\t\t\t\t}\n\n\t\t\t\tif (currentPageId === pageId)\n\t\t\t\t{\n\t\t\t\t\treturn clear(history);\n\t\t\t\t}\n\n\t\t\t\treturn Promise.reject();\n\t\t\t})\n\t\t\t.then(onUpdate)\n\t\t\t.catch(() => {});\n\t}\n\n\n\t/**\n\t * Handles storage event\n\t * @param {StorageEvent} event\n\t */\n\tonStorage(event)\n\t{\n\t\tif (event.key === null)\n\t\t{\n\t\t\tif (!window.localStorage.history)\n\t\t\t{\n\t\t\t\tclear(this).then(onUpdate);\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["RESOLVED","PENDING","BX","Landing","Utils","scrollTo","highlight","editNode","entry","PageObject","getInstance","blocks","then","block","get","Promise","reject","forceInit","node","nodes","getBySelector","selector","bind","useRangeRect","setValue","params","value","editText","editEmbed","editMap","editImage","editIcon","editLink","changeNodeName","onChangeTag","sortBlock","direction","addBlock","currentBlock","resolve","landing","Main","view","iframe","currentArea","contentDocument","body","querySelector","lid","insertBefore","onAddBlock","code","newBlock","removeBlock","deleteBlock","addCard","parentNode","index","position","container","content","cardSelector","card","cards","err","console","log","removeCard","relativeSelector","addNode","tags","top","onCustomEvent","removeNode","slice","editStyle","initStyles","elements","querySelectorAll","isWrapper","forEach","element","pos","className","style","removeAttribute","form","forms","find","currentForm","fields","field","reset","onFrameLoad","styleNode","styles","affect","length","setAffects","onStyleInputWithDebounce","data","getValue","editAttributes","applyAttributeChanges","attrs","attribute","updateContent","multiply","blockId","updateBlockStateData","singleAction","command","dynamicParams","dynamicState","settings","id","Object","keys","updateBlockState","replaceLanding","window","location","reload","changeAnchor","Command","options","Type","isStringFilled","isFunction","onBeforeCommand","registerBaseCommands","history","registerCommand","Runtime","loadExtension","editor","getEditorWindow","Tag","render","Dom","append","document","loader","Loader","target","show","worker","Worker","asyncJsonParse","str","postMessage","addEventListener","event","asyncJsonStringify","obj","removePageHistory","pageId","localStorage","historyData","isPlainObject","all","allString","loadStack","Backend","action","getLoadBackendActionName","getLoadBackendParams","stack","isObject","stackCount","Text","toNumber","step","Math","min","e","clear","commandState","onUpdate","rootWindow","getRootWindow","onInit","Entry","Highlight","layout","classList","add","animationDuration","rect","UI","prototype","call","setTimeout","hide","History","instance","HighlightNode","type","TYPE_LANDING","commands","onStorage","landingId","Event","TYPE_DESIGNER_BLOCK","designerBlockId","canUndo","beforeUndo","getUndoBackendActionName","getBackendActionParams","runCommand","res","offset","canRedo","beforeRedo","getRedoBackendActionName","offsetValue","currentPageId","key"],"mappings":"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"}