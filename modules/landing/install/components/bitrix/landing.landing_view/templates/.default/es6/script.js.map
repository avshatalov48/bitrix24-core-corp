{"version":3,"file":"script.js","sources":["src/controls/controls.action.js","src/controls/controls.loc.js","src/controls/controls.ui.js","src/controls/controls.js","src/device/device.data.js","src/device/device.ui.js","src/device/device.js"],"sourcesContent":["import { Type } from 'main.core';\n\ntype ActionOptions = {\n\tiframe: HTMLIFrameElement,\n};\n\nexport class Action\n{\n\t#iframe: HTMLIFrameElement;\n\n\tconstructor(options: ActionOptions)\n\t{\n\t\tthis.#iframe = options.iframe;\n\n\t\tif (!Type.isDomNode(this.#iframe))\n\t\t{\n\t\t\tthrow new Error(\"Missed 'frame' option as iFrame Element.\");\n\t\t}\n\t}\n\n\t/**\n\t * Sends action with payload to child window.\n\t *\n\t * @param {string} action Command to internal iframe.\n\t * @param {Object} payload Command's payload.\n\t */\n\t#postInternalCommand(action, payload)\n\t{\n\t\tthis.#iframe.contentWindow.postMessage({action, payload}, window.location.origin);\n\t}\n\n\t/**\n\t * Handles on Designer click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonDesignerBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onDesignerBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Style Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonStyleBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onStyleBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Edit Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonEditBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onEditBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Down Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonSortDownBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onSortDownBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Up Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonSortUpBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onSortUpBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Remove Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonRemoveBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onRemoveBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Change State Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonChangeStateBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onChangeStateBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Cut Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonCutBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onCutBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Copy Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonCopyBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onCopyBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Paste Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonPasteBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onPasteBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Feedback click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonFeedbackClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onFeedbackClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Save In Library click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonSaveInLibraryClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onSaveInLibraryClick', {blockId});\n\t}\n\n\t/**\n\t * Hide opened editor panel.\n\t */\n\tonHideEditorPanel()\n\t{\n\t\tthis.#postInternalCommand('onHideEditorPanel');\n\t}\n}\n","\n\nexport class Loc\n{\n\tstatic messages: {[type: string]: string};\n\n\tstatic loadMessages(messages: {[type: string]: string})\n\t{\n\t\tLoc.messages = messages;\n\t}\n\n\tstatic getMessage(code: string): string\n\t{\n\t\treturn Loc.messages[code];\n\t}\n}\n","import { Event, Tag } from 'main.core';\nimport { Menu, MenuItem, MenuManager } from 'main.popup';\n\nimport { Loc } from './controls.loc';\n\ntype LeftContainerOptions = {\n\tdesignerBlockClick: ?() => {},\n\tstyleBlockClick: ?() => {},\n\teditBlockClick: ?() => {},\n};\n\ntype RightContainerOptions = {\n\tblockId: number,\n\tstate: boolean,\n\tsortDownBlockClick: ?() => {},\n\tsortUpBlockClick: ?() => {},\n\tremoveBlockClick: ?() => {},\n\tonOpenAdditionalMenu: ?() => {},\n\tchangeStateClick: ?() => {},\n\tcutClick: ?() => {},\n\tcopyClick: ?() => {},\n\tpasteClick: ?() => {},\n\tfeedbackClick: ?() => {},\n\tsaveInLibrary: ?() => {},\n};\n\ntype AdditionalActions = {\n\tstate: boolean,\n\tonOpenAdditionalMenu: ?() => {},\n\tchangeStateClick: ?() => {},\n\tcutClick: ?() => {},\n\tcopyClick: ?() => {},\n\tpasteClick: ?() => {},\n\tfeedbackClick: ?() => {},\n\tsaveInLibrary: ?() => {},\n};\n\nexport class UI\n{\n\tstatic pendingMenuItems = {};\n\n\t/**\n\t * Till Menu for this block not show, sets predefined prop value for menu item.\n\t *\n\t * @param {number} blockId\n\t * @param {string} itemCode\n\t * @param {string} itemProp\n\t * @param {mixed} value\n\t */\n\tstatic setPendingMenuItemValue(blockId: number, itemCode: string, itemProp: string, value)\n\t{\n\t\tif (!UI.pendingMenuItems[blockId])\n\t\t{\n\t\t\tUI.pendingMenuItems[blockId] = {};\n\t\t}\n\t\tif (!UI.pendingMenuItems[blockId][itemCode])\n\t\t{\n\t\t\tUI.pendingMenuItems[blockId][itemCode] = {};\n\t\t}\n\n\t\tUI.pendingMenuItems[blockId][itemCode][itemProp] = value;\n\t}\n\n\t/**\n\t * Returns predefined prop value for menu item (if exists).\n\t *\n\t * @param {number} blockId\n\t * @param {string} itemCode\n\t * @param {string} itemProp\n\t */\n\tstatic getPendingMenuItemValue(blockId: number, itemCode: string, itemProp: string)\n\t{\n\t\tif (UI.pendingMenuItems[blockId] && UI.pendingMenuItems[blockId][itemCode])\n\t\t{\n\t\t\treturn UI.pendingMenuItems[blockId][itemCode][itemProp] || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns Designer Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getDesignerBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_DESIGNER_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action --separate${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" title=\"${title}\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${title}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Style Block Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getStyleBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst label = Loc.getMessage('LANDING_TPL_EXT_BUTTON_STYLE_BLOCK');\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_STYLE_BLOCK_TITLE');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action --separate${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" title=\"${title}\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${label}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Edit Block Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getEditBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\t//data-id=\"content\"\n\t\tconst label = Loc.getMessage('LANDING_TPL_EXT_BUTTON_EDIT_BLOCK');\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_EDIT_BLOCK_TITLE');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action --separate${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" title=\"${title}\" data-id=\"content\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${label}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns left container for block's actions.\n\t *\n\t * @param {LeftContainerOptions} options Options for left container.\n\t * @return {HTMLDivElement}\n\t */\n\tstatic getLeftContainer(options: LeftContainerOptions): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-ui-external-left-container\">\n\t\t\t\t<div class=\"landing-ui-external-left-top-hr\"></div>\n\t\t\t\t<div class=\"landing-ui-external-body\">\n\t\t\t\t\t<div class=\"landing-ui-external-panel\">\n\t\t\t\t\t\t${UI.getDesignerBlockButton(options.designerBlockClick)}\n\t\t\t\t\t\t${UI.getStyleBlockButton(options.styleBlockClick)}\n\t\t\t\t\t\t${UI.getEditBlockButton(options.editBlockClick)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"landing-ui-external-left-bottom-hr\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t/**\n\t * Returns Sort Down Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getSortDownBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_DOWN_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" data-id=\"down\" title=\"${title}\"><span class=\"landing-ui-button-text\">&nbsp;</span></button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Sort Up Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getSortUpBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_UP_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" data-id=\"up\" title=\"${title}\"><span class=\"landing-ui-button-text\">&nbsp;</span></button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Additional Items Menu for Block.\n\t *\n\t * @param {number} blockId Block id.\n\t * @return {Menu}\n\t */\n\tstatic getBlockAdditionalMenu(blockId: number): Menu\n\t{\n\t\treturn MenuManager.getMenuById('block_actions_' + blockId);\n\t}\n\n\t/**\n\t * Closes Additional Items Menu for Block.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tstatic closeBlockAdditionalMenu(blockId: number)\n\t{\n\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\t/**\n\t * Change state for Additional Menu Item 'Activate'.\n\t *\n\t * @param {number} blockId Block id.\n\t * @param {boolean} state State.\n\t */\n\tstatic changeStateMenuItem(blockId: number, state: boolean)\n\t{\n\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\tconst title = Loc.getMessage(\n\t\t\t!state\n\t\t\t\t? 'LANDING_TPL_EXT_BUTTON_ACTIONS_SHOW'\n\t\t\t\t: 'LANDING_TPL_EXT_BUTTON_ACTIONS_HIDE'\n\t\t);\n\n\t\tif (menu)\n\t\t{\n\t\t\tBX.Landing.Utils.setTextContent(menu.getMenuItem('show_hide').getLayout()['text'], title);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tUI.setPendingMenuItemValue(blockId, 'show_hide', 'state', state);\n\t\t}\n\t}\n\n\t/**\n\t * Enables/disables paste-item.\n\t *\n\t * @param {number} blockId Block id.\n\t * @param {boolean} enablePaste Flag.\n\t */\n\tstatic changePasteMenuItem(blockId: number, enablePaste: boolean)\n\t{\n\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\tif (menu)\n\t\t{\n\t\t\tconst item = menu.getMenuItem('paste');\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tif (enablePaste)\n\t\t\t\t{\n\t\t\t\t\titem.enable();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titem.disable();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tUI.setPendingMenuItemValue(blockId, 'paste', 'disabled', !enablePaste);\n\t\t}\n\t}\n\n\t/**\n\t * Returns List of Actions for Block.\n\t *\n\t * @param {number} blockId Block id.\n\t * @param {AdditionalActions} actions Additional actions for Block.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getActionsList(blockId: number, actions: AdditionalActions): HTMLButtonElement\n\t{\n\t\tconst label = Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_BLOCK');\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_BLOCK_TITLE');\n\n\t\tconst actionButton = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action\" type=\"button\" data-id=\"actions\" title=\"${title}\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${label}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\t// when click is occurred open exists menu or create new one\n\t\tEvent.bind(actionButton, 'click', (event) => {\n\n\t\t\tif (actions.onOpenAdditionalMenu)\n\t\t\t{\n\t\t\t\tactions.onOpenAdditionalMenu(blockId);\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\n\t\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\t\tif (menu)\n\t\t\t{\n\t\t\t\tmenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tMenuManager.create({\n\t\t\t\tid: 'block_actions_' + blockId,\n\t\t\t\tbindElement: actionButton,\n\t\t\t\tclassName: 'landing-ui-block-actions-popup',\n\t\t\t\tangle: { position: 'top', offset: 95 },\n\t\t\t\toffsetTop: -6,\n\t\t\t\toffsetLeft: -26,\n\t\t\t\titems: [\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'show_hide',\n\t\t\t\t\t\tdisabled: !actions.changeStateClick,\n\t\t\t\t\t\ttext: Loc.getMessage(\n\t\t\t\t\t\t\t(actions.state || UI.getPendingMenuItemValue(blockId, 'show_hide', 'state'))\n\t\t\t\t\t\t\t\t? 'LANDING_TPL_EXT_BUTTON_ACTIONS_HIDE'\n\t\t\t\t\t\t\t\t: 'LANDING_TPL_EXT_BUTTON_ACTIONS_SHOW'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.changeStateClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'cut',\n\t\t\t\t\t\tdisabled: !actions.cutClick,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_CUT'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.cutClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'copy',\n\t\t\t\t\t\tdisabled: !actions.copyClick,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_COPY'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.copyClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'paste',\n\t\t\t\t\t\tdisabled: !actions.pasteClick || UI.getPendingMenuItemValue(blockId, 'paste', 'disabled'),\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_PASTE'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.pasteClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'feedback',\n\t\t\t\t\t\tdisabled: !actions.feedbackClick,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_FEEDBACK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.feedbackClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tactions.saveInLibrary\n\t\t\t\t\t\t? new MenuItem({ delimiter: true })\n\t\t\t\t\t\t: null,\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'save_in_library',\n\t\t\t\t\t\tdisabled: !actions.saveInLibrary,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_SAVE_IN_LIBRARY'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.saveInLibrary();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}).show();\n\t\t});\n\n\t\treturn actionButton;\n\t}\n\n\t/**\n\t * Returns Remove Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getRemoveBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_REMOVE_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" data-id=\"remove\" title=\"${title}\"><span class=\"landing-ui-button-text\">&nbsp;</span></button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns right container for block's actions.\n\t *\n\t * @param {RightContainerOptions} options Options for right container.\n\t * @return {HTMLDivElement}\n\t */\n\tstatic getRightContainer(options: RightContainerOptions): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-ui-external-right-container\">\n\t\t\t\t<div class=\"landing-ui-external-right-top-hr\"></div>\n\t\t\t\t<div class=\"landing-ui-external-body\">\n\t\t\t\t\t<div class=\"landing-ui-external-panel\">\n\t\t\t\t\t\t${UI.getSortDownBlockButton(options.sortDownBlockClick)}\n\t\t\t\t\t\t${UI.getSortUpBlockButton(options.sortUpBlockClick)}\n\t\t\t\t\t\t${UI.getActionsList(options.blockId, options)}\n\t\t\t\t\t\t${UI.getRemoveBlockButton(options.removeBlockClick)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"landing-ui-external-right-bottom-hr\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Dom, Type } from 'main.core';\n\nimport { Action } from './controls.action';\nimport { Loc } from './controls.loc';\nimport { UI } from './controls.ui';\n\ntype Block = {\n\tid: number,\n\tstate: boolean,\n\tpermissions: {\n\t\tallowDesignBlock: boolean,\n\t\tallowModifyStyles: boolean,\n\t\tallowEditContent: boolean,\n\t\tallowSorting: boolean,\n\t\tallowRemove: boolean,\n\t\tallowChangeState: boolean,\n\t\tallowPaste: boolean,\n\t\tallowSaveInLibrary: boolean,\n\t},\n\tleftContainer?: HTMLElement,\n\trightContainer?: HTMLElement,\n};\n\ntype ExternalControlsOptions = {\n\tcontainer: HTMLElement,\n\tiframeWrapper: HTMLElement,\n\tmessages: {[type: string]: string},\n};\n\nexport class ExternalControls\n{\n\n\t#action: Action;\n\t#externalBlocks: Map;\n\t#container: HTMLElement;\n\t#iframeWrapper: HTMLElement;\n\t#currentOpenBlockId: ?number;\n\t#currentOpenMenuBlock: ?number;\n\n\tconstructor(options: ExternalControlsOptions)\n\t{\n\t\toptions = options || {};\n\n\t\tthis.#container = options.container;\n\t\tthis.#iframeWrapper = options.iframeWrapper;\n\n\t\tif (!Type.isDomNode(this.#container))\n\t\t{\n\t\t\tthrow new Error(\"Missed 'container' option as Dom Node.\");\n\t\t}\n\t\tif (!Type.isDomNode(this.#iframeWrapper))\n\t\t{\n\t\t\tthrow new Error(\"Missed 'iframe' option as Dom Node.\");\n\t\t}\n\n\t\tthis.#externalBlocks = new Map();\n\t\tthis.#action = new Action({\n\t\t\tiframe: this.#iframeWrapper.querySelector('iframe'),\n\t\t});\n\n\t\tLoc.loadMessages(options.messages);\n\n\t\twindow.addEventListener('message', this.#listenChildFrame.bind(this));\n\n\t\tthis.#container.addEventListener('click', (event) => {\n\t\t\tthis.#action.onHideEditorPanel();\n\t\t});\n\n\t\twindow.addEventListener('storage', this.#onStorageChange.bind(this));\n\t}\n\n\t/**\n\t * Handler on listening child iframe commands.\n\t *\n\t * @param event\n\t */\n\t#listenChildFrame(event)\n\t{\n\t\tconst data = event.data || {};\n\n\t\tif (!data.payload)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.action === 'register')\n\t\t{\n\t\t\tthis.#registerBlocks(data.payload.blocks);\n\t\t}\n\t\telse if (data.action === 'showcontrols')\n\t\t{\n\t\t\tthis.#showControls(data.payload.blockId, data.payload.top, data.payload.height);\n\t\t}\n\t\telse if (data.action === 'changestate')\n\t\t{\n\t\t\tthis.#changeState(data.payload.blockId, data.payload.state);\n\t\t}\n\t\telse if (data.action === 'mode')\n\t\t{\n\t\t\tthis.#onChangeMode(data.payload);\n\t\t}\n\t\telse if (data.action === 'hideall')\n\t\t{\n\t\t\tthis.#hideAllControls();\n\t\t}\n\t\telse if (data.action === 'showblockcontrols')\n\t\t{\n\t\t\tthis.#hideAllControls();\n\t\t\tthis.#hideAndShowControls(data.payload.blockId);\n\t\t}\n\t}\n\n\t/**\n\t * Handler on listening Storage changing.\n\t */\n\t#onStorageChange()\n\t{\n\t\tconst blocks = this.#externalBlocks.values();\n\t\tconst allowPaste = !!window.localStorage.getItem('landingBlockId');\n\n\t\tfor (let i = 0, c = this.#externalBlocks.size; i < c; i++)\n\t\t{\n\t\t\tconst blockItem = blocks.next().value;\n\n\t\t\tUI.changePasteMenuItem(blockItem.id, allowPaste);\n\t\t\tthis.#updateBlock(\n\t\t\t\tblockItem.id,\n\t\t\t\t{...blockItem, permissions: {...blockItem.permissions, allowPaste}}\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Registers Block's controls for current page.\n\t *\n\t * @param {Array<Block>} blocks Array of Blocks.\n\t */\n\t#registerBlocks(blocks: Array<Block>)\n\t{\n\t\tblocks.map(block => {\n\n\t\t\tconst blockId = block.id;\n\n\t\t\t// left controls\n\t\t\tblock.leftContainer = UI.getLeftContainer({\n\t\t\t\tdesignerBlockClick: block.permissions.allowDesignBlock ? () => {\n\t\t\t\t\tthis.#action.onDesignerBlockClick(blockId);\n\t\t\t\t} : null,\n\t\t\t\tstyleBlockClick: block.permissions.allowModifyStyles ? () => {\n\t\t\t\t\tthis.#action.onStyleBlockClick(blockId);\n\t\t\t\t} : null,\n\t\t\t\teditBlockClick: block.permissions.allowEditContent ? () => {\n\t\t\t\t\tthis.#action.onEditBlockClick(blockId);\n\t\t\t\t} : null,\n\t\t\t});\n\n\t\t\t// right controls\n\t\t\tblock.rightContainer = UI.getRightContainer({\n\t\t\t\tblockId,\n\t\t\t\tstate: block.state,\n\t\t\t\tsortDownBlockClick: block.permissions.allowSorting ? () => {\n\t\t\t\t\tthis.#action.onSortDownBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t} : null,\n\t\t\t\tsortUpBlockClick: block.permissions.allowSorting ? () => {\n\t\t\t\t\tthis.#action.onSortUpBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t} : null,\n\t\t\t\tremoveBlockClick: block.permissions.allowRemove ? () => {\n\t\t\t\t\tthis.#action.onRemoveBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t}: null,\n\t\t\t\tonOpenAdditionalMenu: (blockId) => {\n\t\t\t\t\tthis.#currentOpenMenuBlock = blockId;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.#action.onHideEditorPanel();\n\t\t\t\t\t}, 0);\n\t\t\t\t},\n\t\t\t\tchangeStateClick: block.permissions.allowChangeState ? () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onChangeStateBlockClick(blockId);\n\t\t\t\t\tthis.#hideAndShowControls(blockId);\n\t\t\t\t}: null,\n\t\t\t\tcutClick: block.permissions.allowRemove ? () => {\n\t\t\t\t\tthis.#action.onCutBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t}: null,\n\t\t\t\tcopyClick: () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onCopyBlockClick(blockId);\n\t\t\t\t\tthis.#hideAndShowControls(blockId);\n\t\t\t\t},\n\t\t\t\tpasteClick: block.permissions.allowPaste ? () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onPasteBlockClick(blockId);\n\t\t\t\t\tthis.#hideAndShowControls(blockId);\n\t\t\t\t}: null,\n\t\t\t\tfeedbackClick: () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onFeedbackClick(blockId);\n\t\t\t\t},\n\t\t\t\tsaveInLibrary: block.permissions.allowSaveInLibrary ? () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onSaveInLibraryClick(blockId);\n\t\t\t\t}: null,\n\t\t\t});\n\n\t\t\tDom.append(block.leftContainer, this.#container);\n\t\t\tDom.append(block.rightContainer, this.#container);\n\n\t\t\tDom.hide(block.leftContainer);\n\t\t\tDom.hide(block.rightContainer);\n\n\t\t\tthis.#externalBlocks.set(blockId, block);\n\t\t});\n\t}\n\n\t/**\n\t * Creates new block or takes it from Map.\n\t *\n\t * @param {number} blockId Block id.\n\t * @return {Block}\n\t */\n\t#getBlock(blockId: number): ?Block\n\t{\n\t\treturn this.#externalBlocks.get(parseInt(blockId));\n\t}\n\n\t/**\n\t * Updates Block.\n\t *\n\t * @param blockId Block id.\n\t * @param {Block} data New Block data.\n\t */\n\t#updateBlock(blockId: number, data: Block)\n\t{\n\t\tthis.#externalBlocks.set(parseInt(blockId), data);\n\t}\n\n\t/**\n\t * Changes state for the Block.\n\t *\n\t * @param {number} blockId Block id\n\t * @param state\n\t */\n\t#changeState(blockId: number, state: boolean)\n\t{\n\t\tconst block = this.#getBlock(blockId);\n\t\tif (block)\n\t\t{\n\t\t\tUI.changeStateMenuItem(blockId, state);\n\t\t\tthis.#updateBlock(blockId, {...block, state});\n\t\t}\n\t}\n\n\t/**\n\t * Hides all controls.\n\t */\n\t#hideAllControls()\n\t{\n\t\tif (this.#currentOpenBlockId)\n\t\t{\n\t\t\tconst blockItem = this.#externalBlocks.get(this.#currentOpenBlockId);\n\t\t\tDom.hide(blockItem.leftContainer);\n\t\t\tDom.hide(blockItem.rightContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst blocks = this.#externalBlocks.values();\n\t\t\tfor (let i = 0, c = this.#externalBlocks.size; i < c; i++)\n\t\t\t{\n\t\t\t\tconst blockItem = blocks.next().value;\n\t\t\t\tDom.hide(blockItem.leftContainer);\n\t\t\t\tDom.hide(blockItem.rightContainer);\n\t\t\t}\n\t\t}\n\n\t\t// if some menu is opened, close it\n\t\tif (this.#currentOpenMenuBlock)\n\t\t{\n\t\t\tUI.closeBlockAdditionalMenu(this.#currentOpenMenuBlock);\n\t\t\tthis.#currentOpenMenuBlock = null;\n\t\t}\n\t}\n\n\t/**\n\t * Shows controls for block.\n\t *\n\t * @param {number} blockId Block's id.\n\t * @param {number} top Block's top position.\n\t * @param {number} height Block's height.\n\t */\n\t#showControls(blockId: number, top: number, height: number)\n\t{\n\t\tconst block = this.#getBlock(blockId);\n\n\t\tif (!block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst iframeRect = this.#iframeWrapper.getBoundingClientRect();\n\t\tthis.#hideAllControls();\n\t\tthis.#currentOpenBlockId = block.id;\n\t\tthis.#action.onHideEditorPanel();\n\t\ttop = parseInt(top);\n\n\t\t// adjust top and bottom borders\n\t\tif (top < 0 && height + top > 50)\n\t\t{\n\t\t\theight = height + top;\n\t\t\ttop = 0;\n\t\t\tDom.addClass(block.leftContainer, 'hide-top');\n\t\t\tDom.addClass(block.rightContainer, 'hide-top');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(block.leftContainer, 'hide-top');\n\t\t\tDom.removeClass(block.rightContainer, 'hide-top');\n\t\t}\n\n\t\tDom.show(block.leftContainer);\n\t\tDom.show(block.rightContainer);\n\n\t\t// adjust top and heights\n\t\tblock.leftContainer.style.width = iframeRect.left + 'px';\n\t\tblock.leftContainer.style.top = top + 'px';\n\t\tblock.leftContainer.style.height = height + 'px';\n\n\t\tblock.rightContainer.style.width = iframeRect.left + 'px';\n\t\tblock.rightContainer.style.left = iframeRect.left + iframeRect.width + 'px';\n\t\tblock.rightContainer.style.top = top + 'px';\n\t\tblock.rightContainer.style.height = height + 'px';\n\t}\n\n\t/**\n\t * Hides and shows controls (blink) for specific Block.\n\t *\n\t * @param {blockId} blockId Block id.\n\t */\n\t#hideAndShowControls(blockId: number)\n\t{\n\t\tconst block = this.#getBlock(blockId);\n\t\tif (block)\n\t\t{\n\t\t\tthis.#currentOpenBlockId = null;\n\t\t\tDom.hide(block.leftContainer);\n\t\t\tDom.hide(block.rightContainer);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.#currentOpenBlockId = block.id;\n\t\t\t\tDom.show(block.leftContainer);\n\t\t\t\tDom.show(block.rightContainer);\n\t\t\t}, 500);\n\t\t}\n\t}\n\n\t/**\n\t * When user toggles mode (internal vs external controls).\n\t *\n\t * @param {{[type: string]: string}} data New mode data.\n\t */\n\t#onChangeMode(data: {[type: string]: string})\n\t{\n\t\tif (data.type === 'internal')\n\t\t{\n\t\t\tthis.#hideAllControls();\n\t\t}\n\t}\n}\n","export type DeviceItem = {\n\tname: string,\n\tcode: string,\n\tclassName: string,\n\tlangCode?: string,\n};\n\nexport const Devices = {\n\tdefaultDevice: {\n\t\ttablet: 'iphone14pro',\n\t\tmobile: 'iphone14pro',\n\t},\n\tdevices: {\n\t\tdelimiter1: {\n\t\t\tcode: 'delimiter',\n\t\t\tlangCode: 'LANDING_PREVIEW_DEVICE_MOBILES',\n\t\t},\n\t\tiphone14pro: {\n\t\t\tname: 'iPhone 14 Pro',\n\t\t\tcode: 'iphone14pro',\n\t\t\tclassName: '--iphone-14-pro',\n\t\t\twidth: 393,\n\t\t\theight: 852\n\t\t},\n\t\tiPhoneXR: {\n\t\t\tname: 'iPhone XR',\n\t\t\tcode: 'iPhoneXR',\n\t\t\tclassName: '--iphone-xr',\n\t\t\twidth: 414,\n\t\t\theight: 896\n\t\t},\n\t\tiPhoneSE: {\n\t\t\tname: 'iPhone SE',\n\t\t\tcode: 'iPhoneSE',\n\t\t\tclassName: '--iphone-se',\n\t\t\twidth: 375,\n\t\t\theight: 667\n\t\t},\n\t\tSamsungGalaxyNote10: {\n\t\t\tname: 'Samsung Galaxy Note10',\n\t\t\tcode: 'SamsungGalaxyNote10',\n\t\t\tclassName: '--samsung-galaxy-note10',\n\t\t\twidth: 412,\n\t\t\theight: 896\n\t\t},\n\t\tSamsungGalaxyS8: {\n\t\t\tname: 'Samsung Galaxy S8+',\n\t\t\tcode: 'SamsungGalaxyS8',\n\t\t\tclassName: '--samsung-galaxy-s8-plus',\n\t\t\twidth: 360,\n\t\t\theight: 740\n\t\t},\n\t\tGooglePixel4: {\n\t\t\tname: 'Google Pixel 4',\n\t\t\tcode: 'GooglePixel4',\n\t\t\tclassName: '--google-pixel-4',\n\t\t\twidth: 353,\n\t\t\theight: 745\n\t\t},\n\t\tdelimiter2: {\n\t\t\tcode: 'delimiter',\n\t\t\tlangCode: 'LANDING_PREVIEW_DEVICE_TABLETS',\n\t\t},\n\t\tiPad: {\n\t\t\tname: 'iPad',\n\t\t\tcode: 'iPad',\n\t\t\tclassName: '--ipad',\n\t\t\twidth: 810,\n\t\t\theight: 1080\n\t\t},\n\t\tiPadMini: {\n\t\t\tname: 'iPad Mini',\n\t\t\tcode: 'iPadMini',\n\t\t\tclassName: '--ipad-mini',\n\t\t\twidth: 744,\n\t\t\theight: 1133\n\t\t},\n\t\tSamsungGalaxyTabS8: {\n\t\t\tname: 'Samsung Galaxy Tab S8',\n\t\t\tcode: 'SamsungGalaxyTabS8',\n\t\t\tclassName: '--samsung-galaxy-tab-s8',\n\t\t\twidth: 800,\n\t\t\theight: 1280\n\t\t},\n\t}\n}\n","import { Dom, Tag } from 'main.core';\nimport { MenuItem, MenuManager } from 'main.popup';\n\nimport { DeviceItem } from './device.data';\n\ntype Options = {\n\tframeUrl: string,\n\tclickHandler: () => {},\n\tmessages: {[type: string]: string},\n};\n\nclass DeviceUI\n{\n\tstatic messages: {[type: string]: string};\n\n\t/**\n\t * Returns Landing Preview Block above the screen.\n\t *\n\t * @param {Options} options Preview options.\n\t * @return {HTMLDivElement}\n\t */\n\tstatic getPreview(options: Options): HTMLDivElement\n\t{\n\t\tif (options.messages)\n\t\t{\n\t\t\tDeviceUI.messages = options.messages;\n\t\t}\n\n\t\tif (!localStorage.getItem('deviceOrientation'))\n\t\t{\n\t\t\tlocalStorage.setItem('deviceOrientation', 'portrait');\n\t\t}\n\n\t\tconst switcherClick = (event) => {\n\t\t\tlocalStorage.setItem('deviceHidden', !Dom.hasClass(layout.switcher, 'landing-switcher-hide'));\n\t\t\tDom.toggleClass(layout.switcher, 'landing-switcher-hide');\n\t\t\tDom.toggleClass(layout.wrapper, 'landing-device-wrapper-hidden');\n\t\t};\n\n\t\tconst rotateClick = (event) => {\n\t\t\tif (localStorage.getItem('deviceOrientation') === 'portrait')\n\t\t\t{\n\t\t\t\tlocalStorage.setItem('deviceOrientation', 'landscape');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocalStorage.setItem('deviceOrientation', 'portrait');\n\t\t\t}\n\n\t\t\tlayout.wrapper.style.setProperty(`width`, `${layout.wrapper.offsetHeight}px`);\n\t\t\tlayout.wrapper.style.setProperty(`height`, `${layout.wrapper.offsetWidth}px`);\n\t\t\tlayout.frame.style.setProperty(`width`, `${layout.frame.offsetHeight}px`);\n\t\t\tlayout.frame.style.setProperty(`height`, `${layout.frame.offsetWidth}px`);\n\t\t\tlayout.wrapper.querySelector('[data-role=\"device-orientation\"]').innerHTML = localStorage.getItem('deviceOrientation');\n\t\t};\n\n\t\tconst hidden = localStorage.getItem('deviceHidden') === 'true';\n\n\t\tconst layout = {\n\t\t\twrapper: Tag.render`\n\t\t\t\t<div class=\"landing-device-wrapper${hidden ? ' landing-device-wrapper-hidden' : ''}\">\n\t\t\t\t\t<div class=\"landing-device-name\" onclick=\"${options.clickHandler}\">\n\t\t\t\t\t\t<span data-role=\"device-name\">Device</span>\n\t\t\t\t\t\t<span data-role=\"device-orientation\" class=\"landing-device-orientation\">Orientation</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tswitcher: Tag.render`<div class=\"landing-device-switcher${hidden ? ' landing-switcher-hide' : ''}\" onclick=\"${switcherClick}\" data-role=\"landing-device-switcher\"></div>`,\n\t\t\trotate: Tag.render`<div class=\"landing-device-rotate\" onclick=\"${rotateClick}\" data-role=\"landing-device-rotate\"></div>`,\n\t\t\tframe: Tag.render`<iframe data-role=\"landing-device-preview-iframe\" src=\"${options.frameUrl}\"></iframe>`,\n\t\t\tframeWrapper: Tag.render`<div class=\"landing-device-preview\" data-role=\"landing-device-preview\"></div>`\n\t\t};\n\n\t\tlayout.wrapper.appendChild(layout.switcher);\n\t\tlayout.wrapper.appendChild(layout.rotate);\n\t\tlayout.wrapper.appendChild(layout.frameWrapper);\n\t\tlayout.frameWrapper.appendChild(layout.frame);\n\n\t\treturn layout.wrapper;\n\t}\n\n\t/**\n\t * Creates and open menu with list of devices.\n\t *\n\t * @param {HTMLElement} bindElement HTML element to bind position of menu.\n\t * @param {Array<DeviceItem>} devices List of devices.\n\t * @param {(device: DeviceItem) => {}} clickHandler Invokes when user clicked on the menu item.\n\t */\n\tstatic openDeviceMenu(bindElement: HTMLElement, devices: Array<DeviceItem>, clickHandler: (device: DeviceItem) => {})\n\t{\n\n\t\tconst menuId = 'device_selector';\n\t\tlet menu = MenuManager.getMenuById(menuId);\n\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.show();\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tdevices.map((device) => {\n\t\t\tif (device.code === 'delimiter')\n\t\t\t{\n\t\t\t\tmenuItems.push(new MenuItem({\n\t\t\t\t\tdelimiter: true,\n\t\t\t\t\ttext: device.langCode ? DeviceUI.messages[device.langCode] : '',\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmenuItems.push(new MenuItem({\n\t\t\t\tid: device.className,\n\t\t\t\thtml: `${device.name}`,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tMenuManager.getMenuById(menuId).close();\n\t\t\t\t\tclickHandler(device);\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\n\t\tif (bindElement)\n\t\t{\n\t\t\tbindElement = bindElement.parentNode;\n\t\t}\n\n\t\tmenu = MenuManager.create({\n\t\t\tid: menuId,\n\t\t\tbindElement,\n\t\t\tclassName: 'landing-ui-block-actions-popup',\n\t\t\titems: menuItems,\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 40,\n\t\t\tminWidth: bindElement.offsetWidth,\n\t\t\tanimation: 'fading-slide'\n\t\t});\n\n\t\tmenu.show();\n\t}\n}\n\nexport default DeviceUI;\n","import { Dom } from 'main.core';\n\nimport { Devices, DeviceItem } from './device.data';\nimport DeviceUI from './device.ui';\n\ntype Options = {\n\teditorFrameWrapper: HTMLElement,\n\tframeUrl: string,\n\tmessages: {[type: string]: string},\n};\n\nexport class Device\n{\n\t#frameUrl: string;\n\t#editorFrameWrapper: HTMLElement;\n\t#previewElement: HTMLDivElement;\n\t#previewWindow;// window object of iframe\n\t#currentDevice: ?DeviceItem = null;\n\t#editorEnabled: boolean = false;\n\t#pendingReload: boolean = false;\n\t#commandsToRefresh = [\n\t\t'Landing::upBlock',\n\t\t'Landing::downBlock',\n\t\t'Landing::showBlock',\n\t\t'Landing::hideBlock',\n\t\t'Landing::markDeletedBlock',\n\t\t'Landing::addBlock',\n\t\t'Landing::copyBlock',\n\t\t'Landing::moveBlock',\n\t\t'Block::changeNodeName',\n\t\t'Block::updateContent',\n\t\t'Block::getContent',\n\t\t'Landing\\\\Block::addCard',\n\t\t'Landing\\\\Block::cloneCard',\n\t\t'Landing\\\\Block::removeCard',\n\t\t'Landing\\\\Block::updateNodes',\n\t\t'Landing\\\\Block::updateStyles',\n\t\t'Landing\\\\Block::saveForm',// fake-action\n\t];\n\n\t/**\n\t * Device constructor.\n\t *\n\t * @param {Options} options Constructor options.\n\t */\n\tconstructor(options: Options)\n\t{\n\t\tthis.#frameUrl = options.frameUrl;\n\t\tthis.#editorFrameWrapper = options.editorFrameWrapper;\n\t\tthis.#registerListeners(options);\n\t\tthis.#buildPreview(options);\n\n\t\tthis.#showPreview();\n\t\tthis.#setDevice(this.#resolveDeviceByType('mobile'));\n\t}\n\n\t/**\n\t * Registers Handlers you need.\n\t *\n\t * @param {Options} options Constructor options.\n\t */\n\t#registerListeners(options: Options)\n\t{\n\t\t// when user click different window size\n\t\tBX.addCustomEvent('BX.Landing.Main:editorSizeChange', (deviceType: string) =>\n\t\t{\n\t\t\tthis.#setDevice(this.#resolveDeviceByType(deviceType));\n\t\t});\n\n\t\t// listen messages from editor frame\n\t\twindow.addEventListener('message', event => {\n\t\t\tconst data = event.data || {};\n\n\t\t\tif (data.action === 'editorenable')\n\t\t\t{\n\t\t\t\tif (!!data.payload.enable)\n\t\t\t\t{\n\t\t\t\t\tthis.#editorEnabled = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.#pendingReload)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#reloadPreviewWindow();\n\t\t\t\t\t}\n\t\t\t\t\tthis.#editorEnabled = false;\n\t\t\t\t\tthis.#pendingReload = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (data.action === 'backendaction')\n\t\t\t{\n\t\t\t\tthis.#backendAction(data.payload);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Invokes when backend request occurred.\n\t *\n\t * @param {{action: string, data: Object}} payload Payload data.\n\t */\n\t#backendAction(payload: {action: string, data: Object})\n\t{\n\t\tif (this.#commandsToRefresh.includes(payload.action))\n\t\t{\n\t\t\tif (this.#editorEnabled)\n\t\t\t{\n\t\t\t\tthis.#pendingReload = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet blockId = null;\n\n\t\t\t\tif (payload.data?.block)\n\t\t\t\t{\n\t\t\t\t\tblockId = payload.data?.block;\n\t\t\t\t}\n\n\t\t\t\tif (payload.data?.updateNodes?.data?.block)\n\t\t\t\t{\n\t\t\t\t\tblockId = payload.data?.updateNodes?.data?.block;\n\t\t\t\t}\n\n\t\t\t\tthis.#reloadPreviewWindow(blockId);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Reloads preview window.\n\t * @param {number} blockId\n\t */\n\t#reloadPreviewWindow(blockId: ?number)\n\t{\n\t\tif (this.#previewWindow)\n\t\t{\n\t\t\tconst blockIdPrefix = 'editor';\n\t\t\tconst timestamp = Date.now();\n\n\t\t\tthis.#previewWindow.location.href = this.#frameUrl + '?ts=' + timestamp + '&scrollTo=' + blockIdPrefix + blockId;\n\t\t}\n\t}\n\n\t/**\n\t * Scrolls preview window for some percent.\n\t *\n\t * @param {number} topInPercent Percent from top to scroll.\n\t */\n\t#scrollDevice(topInPercent: number)\n\t{\n\t\tif (this.#previewWindow)\n\t\t{\n\t\t\tconst document = this.#previewWindow.document;\n\n\t\t\tconst scrollHeight = Math.max(\n\t\t\t\tdocument.body.scrollHeight, document.documentElement.scrollHeight,\n\t\t\t\tdocument.body.offsetHeight, document.documentElement.offsetHeight,\n\t\t\t\tdocument.body.clientHeight, document.documentElement.clientHeight\n\t\t\t);\n\n\t\t\tthis.#previewWindow.scroll(0, scrollHeight * topInPercent / 100);\n\t\t}\n\t}\n\n\t/**\n\t * Resolves and returns Device by its code.\n\t *\n\t * @param {string} deviceType Device type.\n\t * @return {DeviceItem}\n\t */\n\t#resolveDeviceByType(deviceType: string): DeviceItem\n\t{\n\t\tlet deviceCode = localStorage.getItem('deviceCode');\n\t\tif (deviceCode && Devices.devices[deviceCode])\n\t\t{\n\t\t\treturn Devices.devices[deviceCode];\n\t\t}\n\n\t\tdeviceCode = Devices.defaultDevice?.[deviceType];\n\t\tif (!deviceCode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn Devices.devices[deviceCode];\n\t}\n\n\t/**\n\t * Sets new device.\n\t *\n\t * @param {DeviceItem|null} newDevice Device.\n\t */\n\t#setDevice(newDevice: ?DeviceItem)\n\t{\n\t\tif (!newDevice)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlocalStorage.setItem('deviceCode', newDevice.code);\n\n\t\t// remove old class within preview\n\t\tif (this.#currentDevice)\n\t\t{\n\t\t\tDom.removeClass(this.#previewElement, this.#currentDevice.className);\n\t\t\tthis.#previewElement.style.removeProperty(`top`);\n\t\t}\n\n\t\tthis.#currentDevice = newDevice;\n\t\tthis.#previewElement.querySelector('[data-role=\"device-name\"]').innerHTML = newDevice.name;\n\t\tthis.#previewElement.querySelector('[data-role=\"device-orientation\"]').innerHTML = localStorage.getItem('deviceOrientation');\n\t\tconst frame = this.#previewElement.querySelector('[data-role=\"landing-device-preview-iframe\"]');\n\t\tconst frameWrapper = this.#previewElement.querySelector('[data-role=\"landing-device-preview\"]');\n\n\t\t// scale for device\n\t\tif (frame\n\t\t\t&& frameWrapper\n\t\t\t&& this.#currentDevice.width\n\t\t\t&& this.#currentDevice.height)\n\t\t{\n\t\t\tconst scale = window.innerHeight / (this.#currentDevice.height + 300);\n\t\t\tconst padding = parseInt(window.getComputedStyle(frameWrapper).padding);\n\n\t\t\tlet param1 = this.#currentDevice.width;\n\t\t\tlet param2 = this.#currentDevice.height;\n\n\t\t\tif (localStorage.getItem('deviceOrientation') === 'landscape')\n\t\t\t{\n\t\t\t\tparam1 = this.#currentDevice.height;\n\t\t\t\tparam2 = this.#currentDevice.width;\n\t\t\t}\n\n\t\t\tframe.style.setProperty(`width`, `${param1}px`);\n\t\t\tframe.style.setProperty(`height`, `${param2}px`);\n\t\t\tframeWrapper.style.setProperty(`transform`, `scale(${scale})`);\n\t\t\tthis.#previewElement.style.setProperty(`width`, `${(param1 + (padding * 2)) * scale}px`);\n\t\t\tthis.#previewElement.style.setProperty(`height`, `${(param2 + (padding * 2)) * scale}px`);\n\t\t}\n\n\t\tDom.addClass(this.#previewElement, this.#currentDevice.className);\n\t}\n\n\t/**\n\t * Gets top scroll of editor window and adjusts device preview window.\n\t */\n\t#adjustPreviewScroll()\n\t{\n\t\tconst documentEditorFrame = this.#editorFrameWrapper.querySelector('iframe').contentWindow.document;\n\t\tconst scrollHeight = Math.max(\n\t\t\tdocumentEditorFrame.body.scrollHeight, documentEditorFrame.documentElement.scrollHeight,\n\t\t\tdocumentEditorFrame.body.offsetHeight, documentEditorFrame.documentElement.offsetHeight,\n\t\t\tdocumentEditorFrame.body.clientHeight, documentEditorFrame.documentElement.clientHeight\n\t\t);\n\t\tconst scrollTop = documentEditorFrame.documentElement.scrollTop || documentEditorFrame.body.scrollTop;\n\n\t\tthis.#scrollDevice(scrollTop / scrollHeight * 100);\n\t}\n\n\t/**\n\t * Creates Preview Popup.\n\t *\n\t * @param {Options} options Preview options.\n\t */\n\t#buildPreview(options: Options)\n\t{\n\t\tif (!this.#previewElement)\n\t\t{\n\t\t\tthis.#previewElement = DeviceUI.getPreview({\n\t\t\t\tframeUrl: options.frameUrl,\n\t\t\t\tclickHandler: this.#onClickDeviceSelector.bind(this),\n\t\t\t\tmessages: options.messages,\n\t\t\t});\n\t\t\tDom.hide(this.#previewElement);\n\t\t\tdocument.body.appendChild(this.#previewElement);\n\n\t\t\t//#170065\n\t\t\t//this.#previewElement.querySelector('iframe').contentWindow.addEventListener('load', () => {\n\t\t\t\tif (!this.#previewWindow)\n\t\t\t\t{\n\t\t\t\t\tthis.#previewWindow = this.#previewElement.querySelector('iframe').contentWindow;\n\t\t\t\t\tconst previewDocument = this.#previewElement.querySelector('iframe').contentWindow.document\n\t\t\t\t\tDom.removeClass(previewDocument.querySelector('html'), 'bx-no-touch');\n\t\t\t\t\tDom.addClass(previewDocument.querySelector('html'), 'bx-touch');\n\t\t\t\t}\n\t\t\t\tthis.#adjustPreviewScroll();\n\t\t\t//});\n\t\t}\n\t}\n\n\t/**\n\t * Invokes by clicking on device selector.\n\t */\n\t#onClickDeviceSelector()\n\t{\n\t\tDeviceUI.openDeviceMenu(\n\t\t\tthis.#previewElement.querySelector('[data-role=\"device-name\"]'),\n\t\t\tObject.values(Devices.devices),\n\t\t\tthis.#setDevice.bind(this)\n\t\t);\n\t}\n\n\t/**\n\t * Creates and Shows Preview Popup.\n\t */\n\t#showPreview()\n\t{\n\t\tDom.show(this.#previewElement);\n\t}\n\n\t/**\n\t * Hides Preview Popup.\n\t */\n\t#hidePreview()\n\t{\n\t\tDom.hide(this.#previewElement);\n\t}\n}\n"],"names":["Action","options","iframe","Type","isDomNode","Error","blockId","action","payload","contentWindow","postMessage","window","location","origin","Loc","messages","code","UI","itemCode","itemProp","value","pendingMenuItems","onClick","title","getMessage","button","Tag","render","Event","bind","label","getDesignerBlockButton","designerBlockClick","getStyleBlockButton","styleBlockClick","getEditBlockButton","editBlockClick","MenuManager","getMenuById","menu","getBlockAdditionalMenu","close","state","BX","Landing","Utils","setTextContent","getMenuItem","getLayout","setPendingMenuItemValue","enablePaste","item","enable","disable","actions","actionButton","event","onOpenAdditionalMenu","stopPropagation","show","create","id","bindElement","className","angle","position","offset","offsetTop","offsetLeft","items","MenuItem","disabled","changeStateClick","text","getPendingMenuItemValue","onclick","cutClick","copyClick","pasteClick","feedbackClick","saveInLibrary","delimiter","getSortDownBlockButton","sortDownBlockClick","getSortUpBlockButton","sortUpBlockClick","getActionsList","getRemoveBlockButton","removeBlockClick","ExternalControls","container","iframeWrapper","Map","querySelector","loadMessages","addEventListener","_classPrivateMethodGet","onHideEditorPanel","data","blocks","top","height","values","allowPaste","localStorage","getItem","i","c","size","blockItem","next","changePasteMenuItem","permissions","map","block","leftContainer","getLeftContainer","allowDesignBlock","onDesignerBlockClick","allowModifyStyles","onStyleBlockClick","allowEditContent","onEditBlockClick","rightContainer","getRightContainer","allowSorting","onSortDownBlockClick","onSortUpBlockClick","allowRemove","onRemoveBlockClick","setTimeout","allowChangeState","closeBlockAdditionalMenu","onChangeStateBlockClick","onCutBlockClick","onCopyBlockClick","onPasteBlockClick","onFeedbackClick","allowSaveInLibrary","onSaveInLibraryClick","Dom","append","hide","set","get","parseInt","changeStateMenuItem","iframeRect","getBoundingClientRect","addClass","removeClass","style","width","left","type","Devices","defaultDevice","tablet","mobile","devices","delimiter1","langCode","iphone14pro","name","iPhoneXR","iPhoneSE","SamsungGalaxyNote10","SamsungGalaxyS8","GooglePixel4","delimiter2","iPad","iPadMini","SamsungGalaxyTabS8","DeviceUI","setItem","switcherClick","hasClass","layout","switcher","toggleClass","wrapper","rotateClick","setProperty","offsetHeight","offsetWidth","frame","innerHTML","hidden","clickHandler","rotate","frameUrl","frameWrapper","appendChild","menuId","menuItems","device","push","html","parentNode","minWidth","animation","Device","editorFrameWrapper","addCustomEvent","deviceType","includes","updateNodes","blockIdPrefix","timestamp","Date","now","href","topInPercent","document","scrollHeight","Math","max","body","documentElement","clientHeight","scroll","deviceCode","newDevice","removeProperty","scale","innerHeight","padding","getComputedStyle","param1","param2","documentEditorFrame","scrollTop","getPreview","previewDocument","openDeviceMenu","Object"],"mappings":"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"}