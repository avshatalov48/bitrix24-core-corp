{"version":3,"file":"script.js","sources":["src/js/landing.pub.top.panel.js","src/js/landing.pub.search.result.js"],"sourcesContent":["import {Event, Cache, Dom, Type} from 'main.core';\nimport {SliderHacks} from 'landing.sliderhacks';\n\nconst onEditButtonClick = Symbol('onEditButtonClick');\nconst onBackButtonClick = Symbol('onBackButtonClick');\nconst onForwardButtonClick = Symbol('onForwardButtonClick');\n\nexport class TopPanel\n{\n\tstatic cache = new Cache.MemoryCache();\n\n\tconstructor()\n\t{\n\t\tEvent.bind(TopPanel.getEditButton(), 'click', this[onEditButtonClick]);\n\t\tEvent.bind(TopPanel.getBackButton(), 'click', this[onBackButtonClick]);\n\t\tEvent.bind(TopPanel.getForwardButton(), 'click', this[onForwardButtonClick]);\n\n\t\tTopPanel.pushHistory(window.location.toString());\n\t\tTopPanel.checkNavButtonsActivity();\n\t}\n\n\tstatic getLayout(): HTMLDivElement\n\t{\n\t\treturn TopPanel.cache.remember('layout', () => {\n\t\t\treturn document.querySelector('.landing-pub-top-panel');\n\t\t});\n\t}\n\n\tstatic getEditButton(): HTMLAnchorElement\n\t{\n\t\treturn TopPanel.cache.remember('editButton', () => {\n\t\t\treturn TopPanel.getLayout().querySelector('.landing-pub-top-panel-edit-button');\n\t\t});\n\t}\n\n\t[onEditButtonClick](event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst href = Dom.attr(event.currentTarget, 'href');\n\n\t\tif (Type.isString(href) && href !== '')\n\t\t{\n\t\t\tTopPanel.openSlider(href);\n\t\t}\n\t}\n\n\tstatic openSlider(url)\n\t{\n\t\tBX.SidePanel.Instance.open(url, {\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 240,\n\t\t\tallowChangeHistory: false,\n\t\t\tevents: {\n\t\t\t\tonClose() {\n\t\t\t\t\tvoid SliderHacks.reloadSlider(window.location.toString());\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t// HISTORY save\n\tstatic history = [];\n\tstatic historyState;\n\n\tstatic pushHistory(url)\n\t{\n\t\tif (!Type.isNumber(TopPanel.historyState))\n\t\t{\n\t\t\tTopPanel.historyState = -1; // will increase later\n\t\t}\n\n\t\tif (TopPanel.historyState < TopPanel.history.length - 1)\n\t\t{\n\t\t\tTopPanel.history.splice(TopPanel.historyState + 1);\n\t\t}\n\n\t\tTopPanel.history.push(url);\n\t\tTopPanel.historyState++;\n\t}\n\n\tstatic checkNavButtonsActivity()\n\t{\n\t\tDom.removeClass(TopPanel.getForwardButton(), 'ui-btn-disabled');\n\t\tDom.removeClass(TopPanel.getBackButton(), 'ui-btn-disabled');\n\n\t\tif (\n\t\t\t!Type.isArrayFilled(TopPanel.history)\n\t\t\t|| !Type.isNumber(TopPanel.historyState)\n\t\t\t|| TopPanel.history.length === 1\n\t\t)\n\t\t{\n\t\t\tDom.addClass(TopPanel.getForwardButton(), 'ui-btn-disabled');\n\t\t\tDom.addClass(TopPanel.getBackButton(), 'ui-btn-disabled');\n\t\t\treturn;\n\t\t}\n\n\t\tif (TopPanel.historyState === 0)\n\t\t{\n\t\t\tDom.addClass(TopPanel.getBackButton(), 'ui-btn-disabled');\n\t\t}\n\n\t\tif (TopPanel.historyState >= TopPanel.history.length - 1)\n\t\t{\n\t\t\tDom.addClass(TopPanel.getForwardButton(), 'ui-btn-disabled');\n\t\t}\n\t}\n\n\tstatic getBackButton(): HTMLAnchorElement\n\t{\n\t\treturn TopPanel.cache.remember('backButton', () => {\n\t\t\tconst layout = TopPanel.getLayout();\n\t\t\treturn layout ? layout.querySelector('.landing-pub-top-panel-back') : null;\n\t\t});\n\t}\n\n\tstatic getForwardButton(): HTMLAnchorElement\n\t{\n\t\treturn TopPanel.cache.remember('forwardButton', () => {\n\t\t\tconst layout = TopPanel.getLayout();\n\t\t\treturn layout ? layout.querySelector('.landing-pub-top-panel-forward') : null;\n\t\t});\n\t}\n\n\t[onBackButtonClick](event)\n\t{\n\t\tevent.preventDefault();\n\t\tif (\n\t\t\tType.isArrayFilled(TopPanel.history)\n\t\t\t&& Type.isNumber(TopPanel.historyState)\n\t\t\t&& TopPanel.historyState > 0\n\t\t)\n\t\t{\n\t\t\tvoid SliderHacks.reloadSlider(TopPanel.history[--TopPanel.historyState]);\n\t\t\tTopPanel.checkNavButtonsActivity();\n\t\t}\n\t}\n\n\t[onForwardButtonClick](event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (\n\t\t\tType.isArrayFilled(TopPanel.history)\n\t\t\t&& Type.isNumber(TopPanel.historyState)\n\t\t\t&& (TopPanel.historyState < TopPanel.history.length - 1)\n\t\t)\n\t\t{\n\t\t\tvoid SliderHacks.reloadSlider(TopPanel.history[++TopPanel.historyState]);\n\t\t\tTopPanel.checkNavButtonsActivity();\n\t\t}\n\t}\n}","\n\nexport class SearchResult\n{\n\t/**\n\t * Constructor.\n\t */\n\tconstructor()\n\t{\n\t\tthis.scrollToFirstBlock();\n\t}\n\n\t/**\n\t * Finds first highlight word and scroll to it.\n\t * @return {void}\n\t */\n\tscrollToFirstBlock()\n\t{\n\t\tvar result = document.querySelector('.landing-highlight');\n\t\tif (result)\n\t\t{\n\t\t\tvar parent = result.parentNode;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tif (parent.classList.contains('block-wrapper'))\n\t\t\t\t{\n\t\t\t\t\twindow.scrollTo({\n\t\t\t\t\t\ttop: parent.offsetTop,\n\t\t\t\t\t\tbehavior: 'smooth'\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tparent = parent.parentNode;\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["onEditButtonClick","Symbol","onBackButtonClick","onForwardButtonClick","TopPanel","Event","bind","getEditButton","getBackButton","getForwardButton","pushHistory","window","location","toString","checkNavButtonsActivity","event","preventDefault","href","Dom","attr","currentTarget","Type","isString","openSlider","isArrayFilled","history","isNumber","historyState","SliderHacks","reloadSlider","length","cache","remember","document","querySelector","getLayout","url","BX","SidePanel","Instance","open","cacheable","customLeftBoundary","allowChangeHistory","events","onClose","splice","push","removeClass","addClass","layout","Cache","MemoryCache","SearchResult","scrollToFirstBlock","result","parent","parentNode","classList","contains","scrollTo","top","offsetTop","behavior"],"mappings":"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"}