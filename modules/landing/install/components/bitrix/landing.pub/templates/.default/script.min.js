this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(e,t,n){"use strict";var i=function(){function e(){babelHelpers.classCallCheck(this,e);document.addEventListener("click",this.onClick.bind(this))}babelHelpers.createClass(e,[{key:"onClick",value:function e(t){var n=t.target;if(n.nodeName==="A"){if(n.getAttribute("data-viewer-type")){return}var i=n.getAttribute("href");if(i.indexOf("/bitrix/services/main/ajax.php?action=landing.api.diskFile.download")===0){BX.ajax.get(i.replace("landing.api.diskFile.download","landing.api.diskFile.view"),(function(e){if(typeof e==="string"){e=JSON.parse(e)}if(!e.data){return}Object.keys(e.data).map((function(t){n.setAttribute(t,e.data[t])}));n.click()}));t.preventDefault();t.stopPropagation();return false}}}}]);return e}();var a=function(){function e(){babelHelpers.classCallCheck(this,e);this.scrollToFirstBlock()}babelHelpers.createClass(e,[{key:"scrollToFirstBlock",value:function e(){var t=document.querySelector(".landing-highlight");if(t){var n=t.parentNode;while(n){if(n.classList.contains("block-wrapper")){window.scrollTo({top:n.offsetTop,behavior:"smooth"});break}n=n.parentNode}}}}]);return e}();var o=function(){function e(){babelHelpers.classCallCheck(this,e);this.removeTimestamp()}babelHelpers.createClass(e,[{key:"removeTimestamp",value:function e(){var t=window.location.toString();t=t.replace(/(ts=[\d]+[&]*)/,"");if(t.slice(-1)==="?"||t.slice(-1)==="&"){t=t.slice(0,-1)}window.history.replaceState({},document.title,t)}}]);return e}();var r=Symbol("onEditButtonClick");var l=Symbol("onBackButtonClick");var u=Symbol("onForwardButtonClick");var s=Symbol("onCopyLinkButtonClick");var c=Symbol("onUniqueViewIconClick");var p=function(){function e(n){babelHelpers.classCallCheck(this,e);this.userData=n.userData;t.Event.bind(e.getEditButton(),"click",this[r]);t.Event.bind(e.getBackButton(),"click",this[l]);t.Event.bind(e.getForwardButton(),"click",this[u]);t.Event.bind(e.getCopyLinkButton(),"click",this[s]);t.Event.bind(e.getUniqueViewIcon(),"click",this[c]);e.pushHistory(window.location.toString());e.checkNavButtonsActivity();e.checkHints();e.initUniqueViewPopup(this.userData)}babelHelpers.createClass(e,[{key:r,value:function n(i){i.preventDefault();var a=t.Dom.attr(i.currentTarget,"href");var o=t.Dom.attr(i.currentTarget,"data-landingId");if(t.Type.isString(a)&&a!==""){e.openSlider(a,o)}}},{key:s,value:function e(n){var i=this;n.preventDefault();var a=BX.util.remove_url_param(window.location.href,["IFRAME","IFRAME_TYPE"]);var o=n.target;navigator.clipboard.writeText(a).then((function(){i.timeoutIds=i.timeoutIds||[];var e={content:t.Loc.getMessage("LANDING_TPL_PUB_COPIED_LINK"),darkMode:true,autoHide:true,zIndex:1e3,angle:true,offsetLeft:20,bindOptions:{position:"top"}};var n=new BX.PopupWindow("landing_clipboard_copy",o,e);n.show();var a;while(a=i.timeoutIds.pop()){clearTimeout(a)}a=setTimeout((function(){n.close()}),2e3);i.timeoutIds.push(a)}))["catch"]((function(e){console.error(e)}))}},{key:c,value:function e(n){var i=document.querySelector(".landing-pub-top-panel-unique-view-popup");if(t.Dom.hasClass(i,"hide")){t.Dom.removeClass(i,"hide");setTimeout((function(){t.Dom.addClass(i,"hide")}),2e3)}else{t.Dom.addClass(i,"hide")}}},{key:l,value:function i(a){a.preventDefault();if(t.Type.isArrayFilled(e.history)&&t.Type.isNumber(e.historyState)&&e.historyState>0){void n.SliderHacks.reloadSlider(e.history[--e.historyState]);e.checkNavButtonsActivity()}}},{key:u,value:function i(a){a.preventDefault();if(t.Type.isArrayFilled(e.history)&&t.Type.isNumber(e.historyState)&&e.historyState<e.history.length-1){void n.SliderHacks.reloadSlider(e.history[++e.historyState]);e.checkNavButtonsActivity()}}}],[{key:"getLayout",value:function t(){return e.cache.remember("layout",(function(){return document.querySelector(".landing-pub-top-panel")}))}},{key:"getEditButton",value:function t(){return e.cache.remember("editButton",(function(){return e.getLayout().querySelector(".landing-pub-top-panel-edit-button")}))}},{key:"openSlider",value:function e(t,i){BX.SidePanel.Instance.open(t,{cacheable:false,customLeftBoundary:240,allowChangeHistory:false,events:{onClose:function e(){void n.SliderHacks.reloadSlider(window.location.toString().split("#")[0]+"#landingId"+i)}}})}},{key:"pushHistory",value:function n(i){if(!t.Type.isNumber(e.historyState)){e.historyState=-1}if(e.historyState<e.history.length-1){e.history.splice(e.historyState+1)}e.history.push(i);e.historyState++}},{key:"checkNavButtonsActivity",value:function n(){t.Dom.removeClass(e.getForwardButton(),"ui-btn-disabled");t.Dom.removeClass(e.getBackButton(),"ui-btn-disabled");if(!t.Type.isArrayFilled(e.history)||!t.Type.isNumber(e.historyState)||e.history.length===1){t.Dom.addClass(e.getForwardButton(),"ui-btn-disabled");t.Dom.addClass(e.getBackButton(),"ui-btn-disabled");return}if(e.historyState===0){t.Dom.addClass(e.getBackButton(),"ui-btn-disabled")}if(e.historyState>=e.history.length-1){t.Dom.addClass(e.getForwardButton(),"ui-btn-disabled")}}},{key:"getBackButton",value:function t(){return e.cache.remember("backButton",(function(){var t=e.getLayout();return t?t.querySelector(".landing-pub-top-panel-back"):null}))}},{key:"getForwardButton",value:function t(){return e.cache.remember("forwardButton",(function(){var t=e.getLayout();return t?t.querySelector(".landing-pub-top-panel-forward"):null}))}},{key:"getCopyLinkButton",value:function t(){return e.cache.remember("copyLinkButton",(function(){var t=e.getLayout();return t?t.querySelector(".landing-page-link-btn"):null}))}},{key:"getUniqueViewIcon",value:function t(){return e.cache.remember("uniqueViewIcon",(function(){var t=e.getLayout();return t?t.querySelector(".landing-pub-top-panel-unique-view"):null}))}},{key:"checkHints",value:function e(){var n=document.querySelector(".landing-pub-top-panel-chain-link-page");if(n){if(parseInt(window.getComputedStyle(n).width)<200){t.Dom.style(n,"pointer-events","none")}else{BX.UI.Hint.init(BX("landing-pub-top-panel-chain-link-page"))}}}},{key:"initUniqueViewPopup",value:function e(t){var n=t.id;var i=t.name;var a=t.avatar;if(n.length===i.length){for(var o=0;o<n.length;o++){this.createUserItem(n[o],i[o],a[o])}}}},{key:"createUserItem",value:function e(n,i,a){var o=document.querySelector(".landing-pub-top-panel-unique-view-popup-item-container");var r=window.location.origin+"/company/personal/user/"+n+"/";var l=BX.Dom.create({tag:"div",props:{classList:"landing-pub-top-panel-unique-view-popup-item"}});var u;if(a&&a!==""){u=BX.Dom.create({tag:"div",props:{classList:"landing-pub-top-panel-unique-view-popup-item-avatar"}});a="url('"+a+"')";t.Dom.style(u,"background-image",a)}else{u=BX.Dom.create({tag:"div",props:{classList:"landing-pub-top-panel-unique-view-popup-item-avatar landing-pub-top-panel-unique-view-popup-item-avatar-empty"}})}var s=BX.Dom.create({tag:"a",props:{classList:"landing-pub-top-panel-unique-view-popup-item-link"},text:i});t.Dom.attr(s,"href",r);t.Dom.attr(s,"target","_blank");t.Dom.append(u,l);t.Dom.append(s,l);t.Dom.append(l,o)}}]);return e}();babelHelpers.defineProperty(p,"cache",new t.Cache.MemoryCache);babelHelpers.defineProperty(p,"history",[]);var d=function(){function e(){babelHelpers.classCallCheck(this,e);this.init()}babelHelpers.createClass(e,[{key:"init",value:function e(){var t=new URL(window.location.href);if(t.searchParams.get("transition")==="true"){t.searchParams["delete"]("transition");window.history.replaceState({},"",t.toString())}else{BX.removeClass(document.body,"landing-page-transition")}document.addEventListener("DOMContentLoaded",(function(){setTimeout((function(){BX.removeClass(document.body,"landing-page-transition")}),300)}))}}]);return e}();e.DiskFile=i;e.SearchResult=a;e.TimeStamp=o;e.TopPanel=p;e.PageTransition=d})(this.BX.Landing.Pub=this.BX.Landing.Pub||{},BX,BX.Landing);
//# sourceMappingURL=script.map.js