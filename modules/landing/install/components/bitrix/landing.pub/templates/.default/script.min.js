this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(t,e,i){"use strict";var a=function(){function t(){babelHelpers.classCallCheck(this,t);document.addEventListener("click",this.onClick.bind(this))}babelHelpers.createClass(t,[{key:"onClick",value:function t(e){var i=e.target;if(i.nodeName==="A"){if(i.getAttribute("data-viewer-type")){return}var a=i.getAttribute("href");if(a.indexOf("/bitrix/services/main/ajax.php?action=landing.api.diskFile.download")===0){BX.ajax.get(a.replace("landing.api.diskFile.download","landing.api.diskFile.view"),function(t){if(typeof t==="string"){t=JSON.parse(t)}if(!t.data){return}Object.keys(t.data).map(function(e){i.setAttribute(e,t.data[e])});i.click()});e.preventDefault();e.stopPropagation();return false}}}}]);return t}();var n=function(){function t(){babelHelpers.classCallCheck(this,t);this.scrollToFirstBlock()}babelHelpers.createClass(t,[{key:"scrollToFirstBlock",value:function t(){var e=document.querySelector(".landing-highlight");if(e){var i=e.parentNode;while(i){if(i.classList.contains("block-wrapper")){window.scrollTo({top:i.offsetTop,behavior:"smooth"});break}i=i.parentNode}}}}]);return t}();var r=function(){function t(){babelHelpers.classCallCheck(this,t);this.removeTimestamp()}babelHelpers.createClass(t,[{key:"removeTimestamp",value:function t(){var e=window.location.toString();e=e.replace(/(ts=[\d]+[&]*)/,"");if(e.slice(-1)==="?"||e.slice(-1)==="&"){e=e.slice(0,-1)}window.history.replaceState({},document.title,e)}}]);return t}();var o=Symbol("onEditButtonClick");var l=Symbol("onBackButtonClick");var s=Symbol("onForwardButtonClick");var c=function(){function t(){babelHelpers.classCallCheck(this,t);e.Event.bind(t.getEditButton(),"click",this[o]);e.Event.bind(t.getBackButton(),"click",this[l]);e.Event.bind(t.getForwardButton(),"click",this[s]);t.pushHistory(window.location.toString());t.checkNavButtonsActivity()}babelHelpers.createClass(t,[{key:o,value:function i(a){a.preventDefault();var n=e.Dom.attr(a.currentTarget,"href");var r=e.Dom.attr(a.currentTarget,"data-landingId");if(e.Type.isString(n)&&n!==""){t.openSlider(n,r)}}},{key:l,value:function a(n){n.preventDefault();if(e.Type.isArrayFilled(t.history)&&e.Type.isNumber(t.historyState)&&t.historyState>0){void i.SliderHacks.reloadSlider(t.history[--t.historyState]);t.checkNavButtonsActivity()}}},{key:s,value:function a(n){n.preventDefault();if(e.Type.isArrayFilled(t.history)&&e.Type.isNumber(t.historyState)&&t.historyState<t.history.length-1){void i.SliderHacks.reloadSlider(t.history[++t.historyState]);t.checkNavButtonsActivity()}}}],[{key:"getLayout",value:function e(){return t.cache.remember("layout",function(){return document.querySelector(".landing-pub-top-panel")})}},{key:"getEditButton",value:function e(){return t.cache.remember("editButton",function(){return t.getLayout().querySelector(".landing-pub-top-panel-edit-button")})}},{key:"openSlider",value:function t(e,a){BX.SidePanel.Instance.open(e,{cacheable:false,customLeftBoundary:240,allowChangeHistory:false,events:{onClose:function t(){void i.SliderHacks.reloadSlider(window.location.toString().split("#")[0]+"#landingId"+a)}}})}},{key:"pushHistory",value:function i(a){if(!e.Type.isNumber(t.historyState)){t.historyState=-1}if(t.historyState<t.history.length-1){t.history.splice(t.historyState+1)}t.history.push(a);t.historyState++}},{key:"checkNavButtonsActivity",value:function i(){e.Dom.removeClass(t.getForwardButton(),"ui-btn-disabled");e.Dom.removeClass(t.getBackButton(),"ui-btn-disabled");if(!e.Type.isArrayFilled(t.history)||!e.Type.isNumber(t.historyState)||t.history.length===1){e.Dom.addClass(t.getForwardButton(),"ui-btn-disabled");e.Dom.addClass(t.getBackButton(),"ui-btn-disabled");return}if(t.historyState===0){e.Dom.addClass(t.getBackButton(),"ui-btn-disabled")}if(t.historyState>=t.history.length-1){e.Dom.addClass(t.getForwardButton(),"ui-btn-disabled")}}},{key:"getBackButton",value:function e(){return t.cache.remember("backButton",function(){var e=t.getLayout();return e?e.querySelector(".landing-pub-top-panel-back"):null})}},{key:"getForwardButton",value:function e(){return t.cache.remember("forwardButton",function(){var e=t.getLayout();return e?e.querySelector(".landing-pub-top-panel-forward"):null})}}]);return t}();babelHelpers.defineProperty(c,"cache",new e.Cache.MemoryCache);babelHelpers.defineProperty(c,"history",[]);t.DiskFile=a;t.SearchResult=n;t.TimeStamp=r;t.TopPanel=c})(this.BX.Landing.Pub=this.BX.Landing.Pub||{},BX,BX.Landing);
//# sourceMappingURL=script.map.js