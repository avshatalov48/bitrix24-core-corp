(function(){"use strict";BX.namespace("BX.Landing.TileGrid");BX.Landing.TileGrid=function(i){this.transferPopup="";if(typeof i==="object"){this.wrapper=i.wrapper;this.inner=i.inner;this.tiles=i.tiles;this.minTileWidth=0;this.maxTileWidth=0;this.tileRowLength=0;if(i.sizeSettings){this.minTileWidth=i.sizeSettings.minWidth;this.maxTileWidth=i.sizeSettings.maxWidth}else if(i.tileRowLength){this.tileRowLength=i.tileRowLength}else{this.minTileWidth=250;this.maxTileWidth=350}this.tileRatio=i.tileRatio||1.48;this.maxTileHeight=this.maxTileWidth/this.tileRatio}this.setTileWidth();BX.bind(window,"resize",this.setTileWidth.bind(this));requestAnimationFrame(function(){this.wrapper.classList.add("landing-ui-show")}.bind(this))};BX.Landing.TileGrid.prototype={setTileWidth:function(){var i=this.getTileCalculating();var e=i.width;var t=i.height;if(this.minTileWidth){e=e<=this.maxTileWidth?i.width:this.maxTileWidth;t=t<=this.maxTileHeight?i.height:this.maxTileHeight}requestAnimationFrame(function(){for(var n=0;n<this.tiles.length;n++){this.tiles[n].style.width=e+"px";this.tiles[n].style.height=t+"px";this.tiles[n].style.marginLeft=i.margin+"px";this.tiles[n].style.marginTop=i.margin+"px"}this.inner.style.marginLeft=i.margin*-1+"px";this.inner.style.marginTop=i.margin*-1+"px"}.bind(this))},getTileCalculating:function(){var i=this.wrapper.clientWidth-12;var e=i/100*6;var t=0,n=0;if(this.tileRowLength){n=this.tileRowLength;t=(i-e)/this.tileRowLength}else{t=this.minTileWidth;n=(i-e)/t;if(n>this.tiles.length){t=(i-e)/this.tiles.length;t=t>this.maxTileWidth?this.maxTileWidth:t}else if(n-Math.floor(n)>0){n=Math.floor(n);t=(i-e)/n}}return{width:t,margin:e/(n-1),height:t/this.tileRatio}},action:function(i,e,t,n){var a=BX.create("div",{attrs:{className:"landing-filter-loading-container"}});document.body.appendChild(a);var s=new BX.Loader({size:130,color:"#bfc3c8"});s.show(a);BX.ajax({url:BX.util.add_url_param(window.location.href,{action:i}),method:"POST",data:{data:e,sessid:BX.message("bitrix_sessid"),actionType:"rest",componentName:typeof n!=="undefined"?n:null},dataType:"json",onsuccess:function(i){s.hide();a.classList.add("landing-filter-loading-hide");if(typeof i.type!=="undefined"&&typeof i.result!=="undefined"){if(i.type==="error"){var e=BX.Landing.UI.Tool.ActionDialog.getInstance();if(typeof BX.Landing.PaymentAlertShow!=="undefined"&&i.error_type==="payment"){BX.Landing.PaymentAlertShow({message:i.result[0].error_description})}else{e.show({content:i.result[0].error_description,confirm:"OK",type:"alert"})}}else{if(typeof t==="function"){t(i)}else{if(top.window!==window){window.location.reload()}else{BX.onCustomEvent("BX.Landing.Filter:apply")}}}}}.bind(this)})},transfer:function(i,e){if(!BX.type.isPlainObject(e)){e={}}if(!this.transferPopup){this.transferPopup=new BX.PopupWindow("landing-domain-popup",null,{titleBar:BX.message("LANDING_ACTION_DIALOG_CONTENT"),content:BX("landing_domain_popup"),contentBackground:"#eef2f4",overlay:true,closeByEsc:true,zIndexAbsolute:1050,buttons:[new BX.PopupWindowButton({id:"landing-popup-window-button-accept",text:BX.message("BLOCK_CONTINUE"),className:"popup-window-button-accept",events:{click:function(){this.action("Site::update",{id:i,fields:{DOMAIN_ID:BX("new_domain_name").value,TYPE:e.type?e.type.toUpperCase():null}},function(){this.transferPopup.close();BX.onCustomEvent("BX.Landing.Filter:apply")}.bind(this))}.bind(this)}}),new BX.PopupWindowButton({text:BX.message("BLOCK_CANCEL"),className:"popup-window-button-link",events:{click:function(){this.transferPopup.close()}.bind(this)}})]})}BX("new_domain_name").value=e.domainName;BX("new_domain_name_title").textContent=e.domainName;BX("new_domain_name_id").value=e.domainId;BX("landing_domain_address_allow").style.display="none";BX("landing_domain_address_disallow").style.display="none";if(e.domainB24Name){BX("new_domain_name_own").value="";BX("new_domain_name_b24").value=e.domainB24Name}else{BX("new_domain_name_b24").value="";BX("new_domain_name_own").value=e.domainName}this.transferPopup.show();this.action("Domain::check",{domain:e.domainName,filter:{"!ID":e.domainId}},function(i){if(i.result&&i.result.available===true){BX("landing_domain_address_allow").style.display="block"}else{BX("landing_domain_address_disallow").style.display="block"}}.bind(this))}}})();
//# sourceMappingURL=script.map.js