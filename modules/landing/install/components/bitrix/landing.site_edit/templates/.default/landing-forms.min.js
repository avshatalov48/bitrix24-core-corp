function deleteAccessRow(e){landingAccessSelected[BX.data(BX(e),"id")]=false;BX.remove(BX.findParent(BX(e),{tag:"tr"},true))}(function(){"use strict";BX.namespace("BX.Landing");BX.Landing.EditTitleForm=function(e,t,i,n){this.btn=e.querySelector(".ui-title-input-btn-js");this.label=e.querySelector(".ui-editable-field-label-js");this.input=e.querySelector(".ui-editable-field-input-js");this.additionalWidth=t||0;this.input.IsWidthSet=false;this.display=n;this.hideInput=this.hideInput.bind(this);this.showInput=this.showInput.bind(this);if(i){BX.bind(e,"click",this.showInput)}else{BX.bind(this.btn,"click",this.showInput)}this.input.setAttribute("data-height",this.label.offsetHeight)};BX.Landing.EditTitleForm.prototype={showInput:function(e){e.stopPropagation();if(!this.input.IsWidthSet){this.input.style.width=this.label.offsetWidth+this.additionalWidth+17+"px"}if(this.input.tagName==="TEXTAREA"){this.input.style.height=this.input.getAttribute("data-height")+"px"}this.label.style.display="none";this.btn.style.display="none";this.input.style.display="block";this.input.focus();this.input.IsWidthSet=true;BX.bind(document,"mousedown",this.hideInput)},hideInput:function(e){if(e.target===this.input)return;this.label.textContent=this.input.value;if(this.display){this.label.style.display="inline-block"}else{this.label.style.display="inline"}this.input.style.display="none";this.btn.style.display="inline-block";this.input.IsWidthSet=false;this.input.setAttribute("data-height",this.label.offsetHeight);BX.unbind(document,"mousedown",this.hideInput)}};BX.Landing.ToggleFormFields=function(e){this.form=e;this.toggleBtn=e.querySelector(".landing-form-collapse-block-js");this.formInner=e.querySelector(".landing-form-inner-js");this.tableWparp=e.querySelector(".landing-form-table-wrap-js");this.sectionWrap=e.querySelector(".landing-additional-alt-promo-wrap");this.startHeight=0;this.endHeight=0;this.isHidden=true;this.clickHandler=this.clickHandler.bind(this);this.setHeightAuto=this.setHeightAuto.bind(this);this.removeClassName=this.removeClassName.bind(this);this.attributeMainOption="data-landing-main-option";this.attributeOption="data-landing-additional-option";this.attributeDetail="data-landing-additional-detail";var t=this.sectionWrap.children;t=BX.convert.nodeListToArray(t);t.forEach(this.initSection,this);BX.bind(this.toggleBtn,"click",this.clickHandler);if(window.location.hash){var i=window.location.hash.substr(1);t.forEach(function(e){var t=e.getAttribute(this.attributeOption);if(t===i){BX.fireEvent(e,"click")}},this);var n=this.formInner.querySelector("["+this.attributeMainOption+'="'+i+'"]');if(n){this.highlightSection(n)}}};BX.Landing.ToggleFormFields.prototype={showRows:function(){this.startHeight=this.formInner.offsetHeight;this.formInner.style.height=this.startHeight+"px";this.form.classList.add("landing-form-collapsed-open");this.endHeight=this.tableWparp.offsetHeight+parseInt(BX.style(this.tableWparp,"marginBottom"));this.formInner.style.height=this.endHeight+"px";BX.bind(this.formInner,"transitionend",this.setHeightAuto);this.isHidden=false},closeRows:function(){this.formInner.style.height=this.endHeight+"px";setTimeout(function(){this.formInner.style.height=this.startHeight+"px"}.bind(this),70);BX.bind(this.formInner,"transitionend",this.removeClassName);this.isHidden=true},clickHandler:function(){if(this.isHidden)this.showRows();else this.closeRows()},setHeightAuto:function(){this.formInner.style.height="auto";BX.unbind(this.formInner,"transitionend",this.setHeightAuto)},removeClassName:function(){this.form.classList.remove("landing-form-collapsed-open");BX.unbind(this.formInner,"transitionend",this.removeClassName)},initSection:function(e){BX.bind(e,"click",BX.delegate(function(t){t.stopPropagation();this.showSection(e)},this))},showSection:function(e){this.showRows();var t=e.getAttribute(this.attributeOption);var i=this.formInner.querySelector("["+this.attributeDetail+'="'+t+'"]');this.highlightSection(i)},highlightSection:function(e){BX.addClass(e,"landing-form-hidden-row-highlight");setTimeout(function(){var t=BX.pos(e);window.scrollTo({top:t.top,behavior:"smooth"})},300);setTimeout(function(){BX.removeClass(e,"landing-form-hidden-row-highlight")},1500)}};BX.Landing.ColorPicker=function(e){this.picker=new BX.ColorPicker({bindElement:e,popupOptions:{angle:false,offsetTop:5},onColorSelected:this.onColorSelected.bind(this),colors:this.setColors()});this.colorPickerNode=e;this.colorIcon=e.querySelector(".ui-colorpicker-color-js");this.clearBtn=e.querySelector(".ui-colorpicker-clear");this.input=e.querySelector(".landing-colorpicker-inp-js");BX.bind(this.colorPickerNode,"click",this.show.bind(this));BX.bind(this.clearBtn,"click",this.clear.bind(this))};BX.Landing.ColorPicker.prototype={onColorSelected:function(e){this.colorPickerNode.classList.add("ui-colorpicker-selected");this.colorIcon.style.backgroundColor=e;this.input.value=e},show:function(e){if(e.target==this.clearBtn)return;this.picker.open()},clear:function(){this.colorPickerNode.classList.remove("ui-colorpicker-selected");this.input.value="";this.picker.setSelectedColor(null)},setColors:function(){return[["#f5f5f5","#eeeeee","#e0e0e0","#9e9e9e","#757575","#616161","#212121"],["#cfd8dc","#b0bec5","#90a4ae","#607d8b","#546e7a","#455a64","#263238"],["#d7ccc8","#bcaaa4","#a1887f","#795548","#6d4c41","#5d4037","#3e2723"],["#ffccbc","#ffab91","#ff8a65","#ff5722","#f4511e","#e64a19","#bf360c"],["#ffe0b2","#ffcc80","#ffb74d","#ff9800","#fb8c00","#f57c00","#e65100"],["#ffecb3","#ffe082","#ffd54f","#ffc107","#ffb300","#ffa000","#ff6f00"],["#fff9c4","#fff59d","#fff176","#ffeb3b","#fdd835","#fbc02d","#f57f17"],["#f0f4c3","#e6ee9c","#dce775","#cddc39","#c0ca33","#afb42b","#827717"],["#dcedc8","#c5e1a5","#aed581","#8bc34a","#7cb342","#689f38","#33691e"],["#c8e6c9","#a5d6a7","#81c784","#4caf50","#43a047","#388e3c","#1b5e20"],["#b2dfdb","#80cbc4","#4db6ac","#009688","#00897b","#00796b","#004d40"],["#b2ebf2","#80deea","#4dd0e1","#00bcd4","#00acc1","#0097a7","#006064"],["#b3e5fc","#81d4fa","#4fc3f7","#03a9f4","#039be5","#0288d1","#01579b"],["#bbdefb","#90caf9","#64b5f6","#2196f3","#1e88e5","#1976d2","#0d47a1"],["#c5cae9","#9fa8da","#7986cb","#3f51b5","#3949ab","#303f9f","#1a237e"],["#d1c4e9","#b39ddb","#9575cd","#673ab7","#5e35b1","#512da8","#311b92"],["#e1bee7","#ce93d8","#ba68c8","#9c27b0","#8e24aa","#7b1fa2","#4a148c"],["#f8bbd0","#f48fb1","#f06292","#e91e63","#d81b60","#c2185b","#880e4f"],["#ffcdd2","#ef9a9a","#e57373","#f44336","#e53935","#d32f2f","#b71c1c"]].map(function(e,t,i){return i.map(function(e){return e[t]})})}};BX.Landing.CustomFields=function(e){e.forEach(function(e){BX.bind(e.field,"keyup",function(){if(e.length){if(e.field.value.length<=e.length){e.node.textContent=e.field.value}else{e.node.textContent=e.field.value.substring(0,e.length)}}else{e.node.textContent=e.field.value}})})};BX.Landing.Favicon=function(){var e=BX("landing-form-favicon-change");var t=BX("landing-form-favicon-input");var i=BX("landing-form-favicon-value");var n=BX("landing-form-favicon-form");var s=BX("landing-form-favicon-src");var o=BX("landing-form-favicon-error");if(!n||!t||!e){return}BX.bind(e,"click",function(e){BX.fireEvent(t,"click");BX.PreventDefault(e)});BX.bind(t,"change",function(e){BX.ajax.submitAjax(n,{method:"POST",dataType:"json",onsuccess:function(e){if(e.type==="success"&&typeof e.result!=="undefined"&&e.result!==false){i.value=e.result.id;s.setAttribute("src",e.result.src)}else{o.style.color="red"}}});BX.PreventDefault(e)})};BX.Landing.Custom404=function(){var e=BX("landing-form-404-select");BX.bind(e,"change",function(){if(this.value===""){this.parentNode.style.height=getComputedStyle(this.parentNode).height;BX("checkbox-404-use").checked=false}});BX.bind(BX("checkbox-404-use"),"change",function(){if(!this.checked){e.value=""}})};BX.Landing.Custom503=function(){var e=BX("landing-form-503-select");if(!e){return}BX.bind(e,"change",function(){if(this.value===""){this.parentNode.style.height=getComputedStyle(this.parentNode).height;BX("checkbox-503-use").checked=false}});BX.bind(BX("checkbox-503-use"),"change",function(){if(!this.checked){e.value=""}})};BX.Landing.Copyright=function(){BX.bind(BX("checkbox-copyright"),"change",function(){var e=BX("landing-site-set-form").getAttribute("action");e=e.replace(/&feature_copyright=[YN]/,"");e+="&feature_copyright="+(this.checked?"Y":"N");BX("landing-site-set-form").setAttribute("action",e)})};BX.Landing.Access=function(e){var t=landingAccessSelected;var i="RIGHTS";var n=BX("landing-"+i.toLowerCase()+"-table");var s=e.select;var o=e.inc;BX.Access.Init({other:{disabled_cr:true}});BX.Access.SetSelected(t,i);function a(){BX.Access.ShowForm({callback:function(e){for(var a in e){if(e.hasOwnProperty(a)){for(var l in e[a]){if(e[a].hasOwnProperty(l)){var c=n.rows.length;var r=n.insertRow(c-1);r.classList.add("landing-form-rights");t[l]=true;r.insertCell(-1);r.insertCell(-1);r.cells[0].innerHTML=BX.Access.GetProviderName(a)+" "+e[a][l].name+":"+'<input type="hidden" name="fields['+i+'][ACCESS_CODE][]" value="'+l+'">';r.cells[0].classList.add("landing-form-rights-right");r.cells[1].classList.add("landing-form-rights-left");r.cells[1].innerHTML=s.replace("#inc#",o++)+" "+'<a href="javascript:void(0);" onclick="deleteAccessRow(this);" data-id="'+l+'" class="landing-form-rights-delete"></a>'}}}}},bind:i})}BX("landing-rights-form").addEventListener("click",a.bind(this))};BX.Landing.Layout=function(e){var t=document.querySelector(".landing-form-layout-block-container");var i=[];var n=document.querySelectorAll(".landing-form-layout-item");var s=document.querySelector(".landing-form-layout-detail");var o=document.querySelector(".landing-form-page-layout");var a=document.getElementById("field-gacounter_send_click-use");var l=document.getElementById("field-gacounter_click_type-use");n=Array.prototype.slice.call(n,0);e.messages=e.messages||{};h(n[0].dataset.block);n.forEach(function(e){e.addEventListener("click",c.bind(this))});function c(e){var t=e.target.parentNode;var i=document.querySelector(".landing-form-layout-item-selected");if(i){i.classList.remove("landing-form-layout-item-selected")}r(t.dataset.block,t.dataset.layout)}function r(e,t){o.classList.remove("landing-form-page-layout-short");s.classList.remove("landing-form-layout-detail-hidden");h(e);if(typeof t!=="undefined"){d(t)}BX("layout-tplrefs").value=""}if(typeof e.areasCount!=="undefined"){r(e.areasCount,e.current)}function d(e){var t=document.querySelectorAll(".landing-form-layout-img");for(var i=0;i<t.length;i++){if(t[i].dataset.layout===e){t[i].style.display="block"}else{t[i].style.display="none"}}}function h(n){var s=BX("layout-tplrefs").value.split(",");i=[];t.innerHTML="";var o=function(){var e="";for(var t=0,n=i.length;t<n;t++){e+=t+1+":"+(i[t].getValue()?i[t].getValue().substr(8):0)+","}BX("layout-tplrefs").value=e};for(var a=0;a<n;a++){var l=BX.create("div",{attrs:{className:"landing-form-layout-block-item"}});var c=a+1;var r="";if(typeof s[a]!=="undefined"&&s[a].indexOf(":")!==-1){r=parseInt(s[a].split(":")[1]);if(r>0){r="#landing"+r}else{r=""}}var d=new BX.Landing.UI.Field.LinkURL({title:e.messages.area+" #"+c,content:r,textOnly:true,disableCustomURL:true,disableBlocks:true,disallowType:true,enableAreas:true,allowedTypes:[BX.Landing.UI.Field.LinkURL.TYPE_PAGE],options:{siteId:e.siteId,landingId:e.landingId,filter:{"=TYPE":e.type}},onInit:BX.delegate(o),onInput:BX.delegate(o)});i[a]=d;l.appendChild(d.layout);t.appendChild(l)}}var f=BX("layout-tplrefs-check");f.addEventListener("click",u.bind(this));function u(){BX("layout-tplrefs").value="";s.classList.add("landing-form-layout-detail--hidden");o.classList.add("landing-form-page-layout-short");var e=document.querySelectorAll(".layout-switcher");e=Array.prototype.slice.call(e,0);e.forEach(function(e){e.checked=false})}var g=document.querySelector(".landing-form-select-buttons");var p=document.querySelector(".landing-form-list-inner");g.addEventListener("click",b.bind(this));function b(e){if(e.target.classList.contains("landing-form-select-next")){p.classList.add("landing-form-list-inner-prev")}else{p.classList.remove("landing-form-list-inner-prev")}}function m(){var e=a.closest(".ui-checkbox-hidden-input-inner");if(a.checked){l.classList.add("ui-select-gacounter-show");e.classList.add("ui-checkbox-hidden-input-inner-gacounter")}else{l.classList.remove("ui-select-gacounter-show");e.classList.remove("ui-checkbox-hidden-input-inner-gacounter")}}if(a){a.addEventListener("click",function(){m()}.bind(this));m()}};BX.Landing.Metrika=function(){if(!BX("field-gacounter_counter-use")){return}var e=BX("field-gacounter_counter-use");var t=BX("field-gacounter_send_click-use");var i=BX("field-gacounter_send_show-use");if(e.value===""){t.disabled=true;i.disabled=true}e.addEventListener("input",n.bind(this));function n(){if(e.value===""){t.disabled=true;t.checked=false;i.disabled=true;i.checked=false}else{t.disabled=false;i.disabled=false}}};BX.Landing.SaveBtn=function(e){e.addEventListener("click",t.bind(this));function t(){e.classList.add("ui-btn-clock");e.style.cursor="default";e.style.pointerEvents="none"}};BX.Landing.IblockSelect=function(){this.section=BX("row_section_id");this.init(this.section)};BX.Landing.IblockSelect.prototype={init:function(e){if(!BX("settings_iblock_id").value){e.classList.add("landing-form-field-section-hidden")}else{e.classList.remove("landing-form-field-section-hidden")}}};BX.Landing.Cookies=function(e){this.bgPickerBtn=document.querySelector(".landing-form-cookies-color-bg");this.textPickerBtn=document.querySelector(".landing-form-cookies-color-text");this.simplePreview=document.querySelector(".landing-form-cookies-settings-type-simple");this.advancedPreview=document.querySelector(".landing-form-cookies-settings-type-advanced");this.positions=document.querySelectorAll(".landing-form-cookies-position-item");this.bgPicker=new BX.ColorPicker({bindElement:this.bgPickerBtn,popupOptions:{angle:false,offsetTop:5},onColorSelected:this.onBgColorSelected.bind(this),colors:BX.Landing.ColorPicker.prototype.setColors()});this.textPicker=new BX.ColorPicker({bindElement:this.textPickerBtn,popupOptions:{angle:false,offsetTop:5},onColorSelected:this.onTextColorSelected.bind(this),colors:BX.Landing.ColorPicker.prototype.setColors()});this.setSelectedBgColor(this.bgPickerBtn.value);this.setSelectedTextColor(this.textPickerBtn.value);this.bindEvents()};BX.Landing.Cookies.prototype={bindEvents:function(){this.positions.forEach(function(e){e.addEventListener("click",this.onSelectCookiesPosition.bind(this))}.bind(this));this.bgPickerBtn.addEventListener("click",this.showBgPicker.bind(this));this.textPickerBtn.addEventListener("click",this.showTextPicker.bind(this))},onBgColorSelected:function(){var e=this.bgPicker.getSelectedColor();this.setSelectedBgColor(e)},onTextColorSelected:function(){var e=this.textPicker.getSelectedColor();this.setSelectedTextColor(e)},onSelectCookiesPosition:function(e){this.positions.forEach(function(e){if(e.classList.contains("landing-form-cookies-position-item-selected")){e.classList.remove("landing-form-cookies-position-item-selected")}}.bind(this));e.currentTarget.classList.add("landing-form-cookies-position-item-selected")},showBgPicker:function(){this.bgPicker.open()},showTextPicker:function(){this.textPicker.open()},setSelectedBgColor:function(e){this.bgPickerBtn.style.background=e;this.bgPickerBtn.value=e;this.simplePreview.style.background=e;this.advancedPreview.style.background=e},setSelectedTextColor:function(e){this.textPickerBtn.style.background=e;this.textPickerBtn.value=e;this.advancedPreview.style.color=e;var t=document.querySelectorAll(".landing-form-cookies-settings-preview-svg");t.forEach(function(t){t.style.fill=e})}}})();
//# sourceMappingURL=landing-forms.map.js