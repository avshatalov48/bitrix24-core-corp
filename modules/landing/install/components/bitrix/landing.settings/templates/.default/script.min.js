this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(e,t,n){"use strict";var a;var i=function(){function e(i){var s=this;babelHelpers.classCallCheck(this,e);this.siteId=i.siteId;this.landingId=i.landingId;this.pages=i.pages;this.container=document.getElementById(i.containerId);this.loader=new n.Loader({target:this.container});for(var o in this.pages){this.pages[o].container=t.Tag.render(a||(a=babelHelpers.taggedTemplateLiteral(['<div class="landing-settings-page-container"></div>'])));t.Dom.append(this.pages[o].container,this.container)}this.loadingPages=[];this.links=document.getElementById(i.menuId).querySelectorAll("li a");var r=this.links[0];this.links.forEach((function(e){t.Event.bind(e,"click",(function(t){t.preventDefault();t.stopPropagation();s.onLinkClick(e)}));if(e.dataset.page&&s.pages[e.dataset.page]&&s.pages[e.dataset.page].current===true){r=e}}));if(r){this.onLinkClick(r)}this.saveButton=document.getElementById(i.saveButtonId);this.onSave=this.onSave.bind(this);t.Event.bind(this.saveButton,"click",this.onSave)}babelHelpers.createClass(e,[{key:"onLinkClick",value:function e(t){if(t.dataset.page){this.onPageChange(t.dataset.page)}else if(t.dataset.placement){if(typeof BX.rest!=="undefined"&&typeof BX.rest.Marketplace!=="undefined"){BX.rest.Marketplace.bindPageAnchors({})}BX.rest.AppLayout.openApplication(t.dataset.appId,{SITE_ID:this.siteId,LID:this.landingId},{PLACEMENT:t.dataset.placement,PLACEMENT_ID:t.dataset.placementId})}}},{key:"onPageChange",value:function e(n){var a=this;var i=this.pages[n];if(i){if(i.container.childNodes.length===0){this.loader.show();this.loadingPages.push(n);t.ajax.get(i.link,(function(e){i.container.innerHTML=e;a.loadingPages.splice(a.loadingPages.indexOf(n),1);if(a.loadingPages.length===0){a.loader.hide()}var t=i.container.querySelector("form.landing-form");if(t){i.form=t}}))}for(var s in this.pages){this.pages[s].container.hidden=true}i.container.hidden=false}}},{key:"onSave",value:function e(){var t=this;this.loader.show();var n=[];for(var a in this.pages){var i=this.pages[a];if(i.form){n.push(fetch(i.linkToSave,{method:"POST",body:new FormData(i.form),headers:{"Bx-ajax":true}}))}}Promise.all(n).then((function(e){var n=true;e.forEach((function(e){n=n&&e.ok}));if(n){top.window["landingSettingsSaved"]=true;top.BX.onCustomEvent("BX.Landing.Filter:apply");t.loader.hide();top.window.location.reload();BX.SidePanel.Instance.close()}}))["catch"]((function(e){console.error(e)}))}}]);return e}();e.LandingSettings=i})(this.BX.Landing.Component=this.BX.Landing.Component||{},BX,BX);
//# sourceMappingURL=script.map.js