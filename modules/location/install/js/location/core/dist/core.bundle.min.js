this.BX=this.BX||{};this.BX.Location=this.BX.Location||{};(function(e,t,r,a){"use strict";var n=new WeakMap;var l=function(){function e(t){babelHelpers.classCallCheck(this,e);n.set(this,{writable:true,value:void 0});if(typeof t.type==="undefined"){throw new Error("Field type must be defined")}babelHelpers.classPrivateFieldSet(this,n,parseInt(t.type))}babelHelpers.createClass(e,[{key:"type",get:function e(){return babelHelpers.classPrivateFieldGet(this,n)}}]);return e}();function i(e,t){var r;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(r=s(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var a=0;var n=function e(){};return{s:n,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,i=false,o;return{s:function t(){r=e[Symbol.iterator]()},n:function e(){var t=r.next();l=t.done;return t},e:function e(t){i=true;o=t},f:function e(){try{if(!l&&r.return!=null)r.return()}finally{if(i)throw o}}}}function s(e,t){if(!e)return;if(typeof e==="string")return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}function o(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,a=new Array(t);r<t;r++){a[r]=e[r]}return a}var u=new WeakMap;var c=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);u.set(this,{writable:true,value:{}});this.fields=t.fields?t.fields:[]}babelHelpers.createClass(e,[{key:"isFieldExists",value:function e(t){return typeof babelHelpers.classPrivateFieldGet(this,u)[t]!=="undefined"}},{key:"getField",value:function e(t){return this.isFieldExists(t)?babelHelpers.classPrivateFieldGet(this,u)[t]:null}},{key:"setField",value:function e(t){if(!(t instanceof l)){throw new Error("Argument field must be instance of Field!")}babelHelpers.classPrivateFieldGet(this,u)[t.type]=t;return this}},{key:"getMaxFieldType",value:function e(){var t=Object.keys(babelHelpers.classPrivateFieldGet(this,u)).sort(function(e,t){return parseInt(e)-parseInt(t)});var r=0;if(t.length>0){r=t[t.length-1]}return r}},{key:"fields",set:function e(t){if(!Array.isArray(t)){throw new Error("Items must be array!")}var r=i(t),a;try{for(r.s();!(a=r.n()).done;){var n=a.value;this.setField(n)}}catch(e){r.e(e)}finally{r.f()}return this},get:function e(){return babelHelpers.classPrivateFieldGet(this,u)}}]);return e}();var b=new WeakMap;var f=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));b.set(babelHelpers.assertThisInitialized(r),{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),b,e.value||"");return r}babelHelpers.createClass(t,[{key:"value",get:function e(){return babelHelpers.classPrivateFieldGet(this,b)},set:function e(t){babelHelpers.classPrivateFieldSet(this,b,t);return this}}]);return t}(l);var d=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getFieldValue",value:function e(t){var r=null;if(this.isFieldExists(t)){var a=this.getField(t);if(a){r=a.value}}return r}},{key:"setFieldValue",value:function e(t,r){this.setField(new f({type:t,value:r}));return this}}]);return t}(c);var p=new WeakMap;var v=new WeakMap;var h=function(){function e(t){babelHelpers.classCallCheck(this,e);p.set(this,{writable:true,value:void 0});v.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,p,t.entityId);babelHelpers.classPrivateFieldSet(this,v,t.entityType)}babelHelpers.createClass(e,[{key:"entityId",get:function e(){return babelHelpers.classPrivateFieldGet(this,p)}},{key:"entityType",get:function e(){return babelHelpers.classPrivateFieldGet(this,v)}}]);return e}();function y(e,t){var r;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(r=H(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var a=0;var n=function e(){};return{s:n,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,i=false,s;return{s:function t(){r=e[Symbol.iterator]()},n:function e(){var t=r.next();l=t.done;return t},e:function e(t){i=true;s=t},f:function e(){try{if(!l&&r.return!=null)r.return()}finally{if(i)throw s}}}}function H(e,t){if(!e)return;if(typeof e==="string")return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}function g(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,a=new Array(t);r<t;r++){a[r]=e[r]}return a}var w=new WeakMap;var k=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);w.set(this,{writable:true,value:[]});this.links=!!t.links?t.links:[]}babelHelpers.createClass(e,[{key:"addLink",value:function e(t){if(!(t instanceof h)){throw new Error("Argument link must be instance of Field!")}babelHelpers.classPrivateFieldGet(this,w).push(t)}},{key:"clearLinks",value:function e(){babelHelpers.classPrivateFieldSet(this,w,[])}},{key:"links",set:function e(t){if(!Array.isArray(t)){throw new Error("links must be array!")}var r=y(t),a;try{for(r.s();!(a=r.n()).done;){var n=a.value;this.addLink(n)}}catch(e){r.e(e)}finally{r.f()}},get:function e(){return babelHelpers.classPrivateFieldGet(this,w)}}]);return e}();var P=new WeakMap;var C=new WeakMap;var F=new WeakMap;var m=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));P.set(babelHelpers.assertThisInitialized(r),{writable:true,value:void 0});C.set(babelHelpers.assertThisInitialized(r),{writable:true,value:void 0});F.set(babelHelpers.assertThisInitialized(r),{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),P,parseInt(e.sort));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),C,e.name||"");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),F,e.description||"");return r}babelHelpers.createClass(t,[{key:"sort",get:function e(){return babelHelpers.classPrivateFieldGet(this,P)},set:function e(t){babelHelpers.classPrivateFieldSet(this,P,t)}},{key:"name",get:function e(){return babelHelpers.classPrivateFieldGet(this,C)},set:function e(t){babelHelpers.classPrivateFieldSet(this,C,t)}},{key:"description",get:function e(){return babelHelpers.classPrivateFieldGet(this,F)},set:function e(t){babelHelpers.classPrivateFieldSet(this,F,t)}}]);return t}(l);var T=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"initFields",value:function e(t){var r=this;if(Array.isArray(t)){t.forEach(function(e){var t=new m(e);if(t){r.setField(t)}})}}}]);return t}(c);var S=new WeakMap;var E=new WeakMap;var I=new WeakMap;var A=new WeakMap;var M=new WeakMap;var O=new WeakMap;var L=new WeakMap;var _=new WeakMap;var G=function(){function e(r){babelHelpers.classCallCheck(this,e);S.set(this,{writable:true,value:void 0});E.set(this,{writable:true,value:void 0});I.set(this,{writable:true,value:void 0});A.set(this,{writable:true,value:void 0});M.set(this,{writable:true,value:void 0});O.set(this,{writable:true,value:void 0});L.set(this,{writable:true,value:void 0});_.set(this,{writable:true,value:void 0});if(t.Type.isUndefined(r.languageId)){throw new TypeError("LanguageId must be defined")}babelHelpers.classPrivateFieldSet(this,A,r.languageId);babelHelpers.classPrivateFieldSet(this,S,r.code||"");babelHelpers.classPrivateFieldSet(this,E,r.name||"");babelHelpers.classPrivateFieldSet(this,M,r.template||"");babelHelpers.classPrivateFieldSet(this,I,r.description||"");babelHelpers.classPrivateFieldSet(this,L,r.delimiter||", ");babelHelpers.classPrivateFieldSet(this,_,r.fieldForUnRecognized||W.UNKNOWN);babelHelpers.classPrivateFieldSet(this,O,new T);if(t.Type.isObject(r.fieldCollection)){babelHelpers.classPrivateFieldGet(this,O).initFields(r.fieldCollection)}}babelHelpers.createClass(e,[{key:"getField",value:function e(t){return babelHelpers.classPrivateFieldGet(this,O).getField(t)}},{key:"isFieldExists",value:function e(t){return babelHelpers.classPrivateFieldGet(this,O).isFieldExists(t)}},{key:"languageId",get:function e(){return babelHelpers.classPrivateFieldGet(this,A)}},{key:"name",get:function e(){return babelHelpers.classPrivateFieldGet(this,E)}},{key:"description",get:function e(){return babelHelpers.classPrivateFieldGet(this,I)}},{key:"code",get:function e(){return babelHelpers.classPrivateFieldGet(this,S)}},{key:"fieldCollection",get:function e(){return babelHelpers.classPrivateFieldGet(this,O)}},{key:"template",get:function e(){return babelHelpers.classPrivateFieldGet(this,M)},set:function e(t){babelHelpers.classPrivateFieldSet(this,M,t)}},{key:"delimiter",get:function e(){return babelHelpers.classPrivateFieldGet(this,L)},set:function e(t){babelHelpers.classPrivateFieldSet(this,L,t)}},{key:"fieldForUnRecognized",get:function e(){return babelHelpers.classPrivateFieldGet(this,_)},set:function e(t){babelHelpers.classPrivateFieldSet(this,_,t)}}]);return e}();var R=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(R,"UNKNOWN",0);babelHelpers.defineProperty(R,"COUNTRY",100);babelHelpers.defineProperty(R,"ADM_LEVEL_1",200);babelHelpers.defineProperty(R,"ADM_LEVEL_2",210);babelHelpers.defineProperty(R,"ADM_LEVEL_3",220);babelHelpers.defineProperty(R,"ADM_LEVEL_4",230);babelHelpers.defineProperty(R,"LOCALITY",300);babelHelpers.defineProperty(R,"SUB_LOCALITY",310);babelHelpers.defineProperty(R,"SUB_LOCALITY_LEVEL_1",320);babelHelpers.defineProperty(R,"SUB_LOCALITY_LEVEL_2",330);babelHelpers.defineProperty(R,"STREET",340);babelHelpers.defineProperty(R,"BUILDING",400);babelHelpers.defineProperty(R,"ADDRESS_LINE_1",410);babelHelpers.defineProperty(R,"FLOOR",420);babelHelpers.defineProperty(R,"ROOM",430);var W=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(R);babelHelpers.defineProperty(W,"POSTAL_CODE",50);babelHelpers.defineProperty(W,"ADDRESS_LINE_2",600);babelHelpers.defineProperty(W,"RECIPIENT_COMPANY",700);babelHelpers.defineProperty(W,"RECIPIENT",710);babelHelpers.defineProperty(W,"PO_BOX",800);function N(e,t){var r;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(r=B(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var a=0;var n=function e(){};return{s:n,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,i=false,s;return{s:function t(){r=e[Symbol.iterator]()},n:function e(){var t=r.next();l=t.done;return t},e:function e(t){i=true;s=t},f:function e(){try{if(!l&&r.return!=null)r.return()}finally{if(i)throw s}}}}function B(e,t){if(!e)return;if(typeof e==="string")return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,t)}function j(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,a=new Array(t);r<t;r++){a[r]=e[r]}return a}var x=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"convertAddressToString",value:function t(r,a,n,l){var i;if(n===e.STRATEGY_TYPE_TEMPLATE){i=e.convertAddressToStringTemplate(r,a,l)}else if(n===e.STRATEGY_TYPE_FIELD_SORT){var s=function e(t,r){return t.sort-r.sort};i=e.convertAddressToStringByField(r,a,s,l)}else if(n===e.STRATEGY_TYPE_FIELD_TYPE){var o=function e(t,r){var a;if(t.type===0){a=1}else if(r.type===0){a=-1}else{a=t.type-r.type}return a};i=e.convertAddressToStringByField(r,a,o,l)}else{throw TypeError("Wrong strategyType")}return i}},{key:"convertAddressToStringTemplate",value:function r(a,n,l){var i=n.template;if(l===e.CONTENT_TYPE_HTML){i=i.replace(/\n/g,"<br/>")}var s=i.match(/{{[^]*?}}/gm);if(!t.Type.isArray(s)){return""}var o=N(s),u;try{for(o.s();!(u=o.n()).done;){var c=u.value;var b=c.match(/#([0-9A-Z_]*?)#/);if(!t.Type.isArray(b)||t.Type.isUndefined(b[1])){continue}if(t.Type.isUndefined(W[b[1]])){continue}var f=W[b[1]];var d=a.getFieldValue(f);if(d===null){continue}if(l===e.CONTENT_TYPE_HTML){d=t.Text.encode(d)}var p=c.replace(b[0],d);p=p.replace("{{","");p=p.replace("}}","");i=i.replace(c,p)}}catch(e){o.e(e)}finally{o.f()}i=i.replace(/({{[^]*?}})/gm,"");if(l===e.CONTENT_TYPE_HTML){i=i.replace(/(<br\/>)+/g,"<br/>")}else{i=i.replace(/(\n)+/g,"\n")}return i}},{key:"convertAddressToStringByField",value:function r(a,n,l,i){if(!(n instanceof G)){BX.debug("format must be instance of Format")}if(!(a instanceof re)){BX.debug("address must be instance of Address")}var s=n.fieldCollection;if(!s){return""}var o=Object.values(s.fields);o.sort(l);var u="";for(var c=0,b=o;c<b.length;c++){var f=b[c];var d=a.getFieldValue(f.type);if(d===null){continue}if(i===e.CONTENT_TYPE_HTML){d=t.Text.encode(d)}if(u!==""){u+=n.delimiter}u+=d}return u}}]);return e}();babelHelpers.defineProperty(x,"STRATEGY_TYPE_TEMPLATE","template");babelHelpers.defineProperty(x,"STRATEGY_TYPE_FIELD_SORT","field_sort");babelHelpers.defineProperty(x,"STRATEGY_TYPE_FIELD_TYPE","field_type");babelHelpers.defineProperty(x,"CONTENT_TYPE_HTML","html");babelHelpers.defineProperty(x,"CONTENT_TYPE_TEXT","text");function Y(e,t,r){if(e!==t){throw new TypeError("Private static access of wrong provenance")}return r}var J=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"convertJsonToAddress",value:function e(t){return new re(t)}},{key:"convertAddressToJson",value:function t(r){var a={id:r.id,languageId:r.languageId,latitude:r.latitude,longitude:r.longitude,fieldCollection:Y(e,e,V).call(e,r.fieldCollection),links:Y(e,e,D).call(e,r.links),location:null};if(r.location){a.location=JSON.parse(r.location.toJson())}return JSON.stringify(a)}}]);return e}();var D=function e(t){return t.map(function(e){return{entityId:e.entityId,entityType:e.entityType}})};var V=function e(t){var r={};Object.values(t.fields).forEach(function(e){r[e.type]=e.value});return r};function X(e,t){var r;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(r=U(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var a=0;var n=function e(){};return{s:n,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,i=false,s;return{s:function t(){r=e[Symbol.iterator]()},n:function e(){var t=r.next();l=t.done;return t},e:function e(t){i=true;s=t},f:function e(){try{if(!l&&r.return!=null)r.return()}finally{if(i)throw s}}}}function U(e,t){if(!e)return;if(typeof e==="string")return z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,t)}function z(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,a=new Array(t);r<t;r++){a[r]=e[r]}return a}var $=new WeakMap;var q=new WeakMap;var K=new WeakMap;var Z=new WeakMap;var Q=new WeakMap;var ee=new WeakMap;var te=new WeakMap;var re=function(){function e(r){babelHelpers.classCallCheck(this,e);$.set(this,{writable:true,value:void 0});q.set(this,{writable:true,value:void 0});K.set(this,{writable:true,value:void 0});Z.set(this,{writable:true,value:void 0});Q.set(this,{writable:true,value:void 0});ee.set(this,{writable:true,value:void 0});te.set(this,{writable:true,value:void 0});if(t.Type.isUndefined(r.languageId)){throw new TypeError("languageId must be defined")}babelHelpers.classPrivateFieldSet(this,q,r.languageId);babelHelpers.classPrivateFieldSet(this,$,r.id||0);babelHelpers.classPrivateFieldSet(this,K,r.latitude||0);babelHelpers.classPrivateFieldSet(this,Z,r.longitude||0);babelHelpers.classPrivateFieldSet(this,Q,new d);if(t.Type.isObject(r.fieldCollection)){for(var a=0,n=Object.entries(r.fieldCollection);a<n.length;a++){var l=babelHelpers.slicedToArray(n[a],2),i=l[0],s=l[1];this.setFieldValue(i,s)}}babelHelpers.classPrivateFieldSet(this,ee,new k);if(t.Type.isArray(r.links)){var o=X(r.links),u;try{for(o.s();!(u=o.n()).done;){var c=u.value;this.addLink(c.entityId,c.entityType)}}catch(e){o.e(e)}finally{o.f()}}babelHelpers.classPrivateFieldSet(this,te,null);if(r.location){if(r.location instanceof ke){babelHelpers.classPrivateFieldSet(this,te,r.location)}else if(t.Type.isObject(r.location)){babelHelpers.classPrivateFieldSet(this,te,new ke(r.location))}else{BX.debug("Wrong typeof props.location")}}}babelHelpers.createClass(e,[{key:"setFieldValue",value:function e(t,r){babelHelpers.classPrivateFieldGet(this,Q).setFieldValue(t,r)}},{key:"getFieldValue",value:function e(t){return babelHelpers.classPrivateFieldGet(this,Q).getFieldValue(t)}},{key:"isFieldExists",value:function e(t){return babelHelpers.classPrivateFieldGet(this,Q).isFieldExists(t)}},{key:"toJson",value:function e(){return J.convertAddressToJson(this)}},{key:"toString",value:function e(t,r,a){if(!(t instanceof G)){throw new TypeError("format must be instance of Format")}var n=r||x.STRATEGY_TYPE_TEMPLATE;var l=a||x.CONTENT_TYPE_HTML;var i=x.convertAddressToString(this,t,n,l);return i}},{key:"toLocation",value:function e(){var t=null;if(this.location){var r=JSON.parse(this.location.toJson());r.address=JSON.parse(this.toJson());t=new ke(r)}return t}},{key:"getType",value:function e(){return babelHelpers.classPrivateFieldGet(this,Q).getMaxFieldType()}},{key:"addLink",value:function e(t,r){babelHelpers.classPrivateFieldGet(this,ee).addLink(new h({entityId:t,entityType:r}))}},{key:"clearLinks",value:function e(){babelHelpers.classPrivateFieldGet(this,ee).clearLinks()}},{key:"id",get:function e(){return babelHelpers.classPrivateFieldGet(this,$)},set:function e(t){babelHelpers.classPrivateFieldSet(this,$,t)}},{key:"location",get:function e(){return babelHelpers.classPrivateFieldGet(this,te)},set:function e(t){babelHelpers.classPrivateFieldSet(this,te,t)}},{key:"languageId",get:function e(){return babelHelpers.classPrivateFieldGet(this,q)}},{key:"fieldCollection",get:function e(){return babelHelpers.classPrivateFieldGet(this,Q)}},{key:"latitude",get:function e(){return babelHelpers.classPrivateFieldGet(this,K)},set:function e(t){babelHelpers.classPrivateFieldSet(this,K,t)}},{key:"longitude",get:function e(){return babelHelpers.classPrivateFieldGet(this,Z)},set:function e(t){babelHelpers.classPrivateFieldSet(this,Z,t)}},{key:"links",get:function e(){return babelHelpers.classPrivateFieldGet(this,ee).links}}]);return e}();var ae=new WeakMap;var ne=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));ae.set(babelHelpers.assertThisInitialized(r),{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),ae,e.value||"");return r}babelHelpers.createClass(t,[{key:"value",get:function e(){return babelHelpers.classPrivateFieldGet(this,ae)},set:function e(t){babelHelpers.classPrivateFieldSet(this,ae,t)}}]);return t}(l);var le=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getFieldValue",value:function e(t){var r=null;if(this.isFieldExists(t)){var a=this.getField(t);if(a){r=a.value}}return r}},{key:"setFieldValue",value:function e(t,r){this.setField(new ne({type:t,value:r}));return this}}]);return t}(c);function ie(e,t,r){if(e!==t){throw new TypeError("Private static access of wrong provenance")}return r}var se=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"convertLocationToObject",value:function t(r){if(!(r instanceof ke)){throw new TypeError("location must be type of location")}var a={id:r.id,code:r.code,externalId:r.externalId,sourceCode:r.sourceCode,type:r.type,name:r.name,languageId:r.languageId,latitude:r.latitude,longitude:r.longitude,fieldCollection:ie(e,e,oe).call(e,r.fieldCollection),address:null};if(r.address){a.address=JSON.parse(r.address.toJson())}return a}}]);return e}();var oe=function e(t){var r={};Object.values(t.fields).forEach(function(e){r[e.type]=e.value});return r};var ue=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"convertJsonToLocation",value:function e(t){var r=babelHelpers.objectSpread({},t);if(t.address){r.address=new re(t.address)}return new ke(r)}},{key:"convertLocationToJson",value:function e(t){if(!(t instanceof ke)){throw new TypeError("location must be type of location")}var r=se.convertLocationToObject(t);return r?JSON.stringify(r):""}}]);return e}();var ce=new WeakMap;var be=new WeakMap;var fe=new WeakMap;var de=new WeakMap;var pe=new WeakMap;var ve=new WeakMap;var he=new WeakMap;var ye=new WeakMap;var He=new WeakMap;var ge=new WeakMap;var we=new WeakMap;var ke=function(){function e(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);ce.set(this,{writable:true,value:void 0});be.set(this,{writable:true,value:void 0});fe.set(this,{writable:true,value:void 0});de.set(this,{writable:true,value:void 0});pe.set(this,{writable:true,value:void 0});ve.set(this,{writable:true,value:void 0});he.set(this,{writable:true,value:void 0});ye.set(this,{writable:true,value:void 0});He.set(this,{writable:true,value:void 0});ge.set(this,{writable:true,value:void 0});we.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,ce,parseInt(r.id)||0);babelHelpers.classPrivateFieldSet(this,be,r.code||"");babelHelpers.classPrivateFieldSet(this,fe,r.externalId||"");babelHelpers.classPrivateFieldSet(this,de,r.sourceCode||"");babelHelpers.classPrivateFieldSet(this,pe,parseInt(r.type)||0);babelHelpers.classPrivateFieldSet(this,ve,r.name||"");babelHelpers.classPrivateFieldSet(this,he,r.languageId||"");babelHelpers.classPrivateFieldSet(this,ye,r.latitude||"");babelHelpers.classPrivateFieldSet(this,He,r.longitude||"");babelHelpers.classPrivateFieldSet(this,we,new le);if(t.Type.isObject(r.fieldCollection)){for(var a=0,n=Object.entries(r.fieldCollection);a<n.length;a++){var l=babelHelpers.slicedToArray(n[a],2),i=l[0],s=l[1];this.setFieldValue(i,s)}}babelHelpers.classPrivateFieldSet(this,ge,null);if(r.address){if(r.address instanceof re){babelHelpers.classPrivateFieldSet(this,ge,r.address)}else if(babelHelpers.typeof(r.address)==="object"){babelHelpers.classPrivateFieldSet(this,ge,new re(r.address))}else{BX.debug("Wrong typeof props.address")}}}babelHelpers.createClass(e,[{key:"toJson",value:function e(){return ue.convertLocationToJson(this)}},{key:"toAddress",value:function e(){var t=null;if(this.address){var r=JSON.parse(this.address.toJson());r.location=JSON.parse(this.toJson());t=new re(r)}return t}},{key:"setFieldValue",value:function e(t,r){babelHelpers.classPrivateFieldGet(this,we).setFieldValue(t,r)}},{key:"getFieldValue",value:function e(t){return babelHelpers.classPrivateFieldGet(this,we).getFieldValue(t)}},{key:"isFieldExists",value:function e(t){return babelHelpers.classPrivateFieldGet(this,we).isFieldExists(t)}},{key:"hasExternalRelation",value:function e(){return babelHelpers.classPrivateFieldGet(this,fe)&&babelHelpers.classPrivateFieldGet(this,de)}},{key:"id",get:function e(){return babelHelpers.classPrivateFieldGet(this,ce)},set:function e(t){babelHelpers.classPrivateFieldSet(this,ce,t)}},{key:"code",get:function e(){return babelHelpers.classPrivateFieldGet(this,be)},set:function e(t){babelHelpers.classPrivateFieldSet(this,be,t)}},{key:"externalId",get:function e(){return babelHelpers.classPrivateFieldGet(this,fe)},set:function e(t){babelHelpers.classPrivateFieldSet(this,fe,t)}},{key:"sourceCode",get:function e(){return babelHelpers.classPrivateFieldGet(this,de)},set:function e(t){babelHelpers.classPrivateFieldSet(this,de,t)}},{key:"type",get:function e(){return babelHelpers.classPrivateFieldGet(this,pe)},set:function e(t){babelHelpers.classPrivateFieldSet(this,pe,t)}},{key:"name",get:function e(){return babelHelpers.classPrivateFieldGet(this,ve)},set:function e(t){babelHelpers.classPrivateFieldSet(this,ve,t)}},{key:"languageId",get:function e(){return babelHelpers.classPrivateFieldGet(this,he)},set:function e(t){babelHelpers.classPrivateFieldSet(this,he,t)}},{key:"latitude",get:function e(){return babelHelpers.classPrivateFieldGet(this,ye)},set:function e(t){babelHelpers.classPrivateFieldSet(this,ye,t)}},{key:"longitude",get:function e(){return babelHelpers.classPrivateFieldGet(this,He)},set:function e(t){babelHelpers.classPrivateFieldSet(this,He,t)}},{key:"address",set:function e(t){babelHelpers.classPrivateFieldSet(this,ge,t)},get:function e(){return babelHelpers.classPrivateFieldGet(this,ge)}},{key:"fieldCollection",get:function e(){return babelHelpers.classPrivateFieldGet(this,we)}}]);return e}();var Pe=new WeakMap;var Ce=function(){function e(t){babelHelpers.classCallCheck(this,e);Pe.set(this,{writable:true,value:""});if(!t.path){throw new Error("props.path must not be empty!")}babelHelpers.classPrivateFieldSet(this,Pe,t.path)}babelHelpers.createClass(e,[{key:"run",value:function e(t,r){if(!t){throw new Error("action can not be empty!")}return BX.ajax.runAction("".concat(babelHelpers.classPrivateFieldGet(this,Pe),".").concat(t),{data:r})}}]);return e}();function Fe(e,t){var r;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(r=me(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var a=0;var n=function e(){};return{s:n,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,i=false,s;return{s:function t(){r=e[Symbol.iterator]()},n:function e(){var t=r.next();l=t.done;return t},e:function e(t){i=true;s=t},f:function e(){try{if(!l&&r.return!=null)r.return()}finally{if(i)throw s}}}}function me(e,t){if(!e)return;if(typeof e==="string")return Te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Te(e,t)}function Te(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,a=new Array(t);r<t;r++){a[r]=e[r]}return a}var Se=new WeakMap;var Ee=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);Se.set(this,{writable:true,value:null});this._path=t.path;if(t.actionRunner&&t.actionRunner instanceof Ce){babelHelpers.classPrivateFieldSet(this,Se,t.actionRunner)}else{babelHelpers.classPrivateFieldSet(this,Se,new Ce({path:this._path}))}}babelHelpers.createClass(e,[{key:"processResponse",value:function e(t){if(t.status!=="success"){BX.debug("Request was not successful");var r="";if(Array.isArray(t.errors)&&t.errors.length>0){var a=Fe(t.errors),n;try{for(a.s();!(n=a.n()).done;){var l=n.value;if(typeof l.message==="string"&&l.message!==""){r+="".concat(l,"\n")}}}catch(e){a.e(e)}finally{a.f()}}throw new Error(r)}return t.data?t.data:null}},{key:"path",get:function e(){return this._path}},{key:"actionRunner",get:function e(){return babelHelpers.classPrivateFieldGet(this,Se)}}]);return e}();function Ie(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var Ae=new WeakSet;var Me=new WeakSet;var Oe=function(e){babelHelpers.inherits(t,e);function t(){var e;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);r.path=r.path||"location.api.location";e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,r));Me.add(babelHelpers.assertThisInitialized(e));Ae.add(babelHelpers.assertThisInitialized(e));return e}babelHelpers.createClass(t,[{key:"findParents",value:function e(t){if(!(t instanceof ke)){throw new TypeError("location must be type of Location")}return this.actionRunner.run("findParents",{location:se.convertLocationToObject(t)}).then(this.processResponse.bind(this)).then(Ie(this,Ae,Le).bind(this))}},{key:"findByExternalId",value:function e(t,r,a){if(!t||!r||!a){throw new Error("externalId and sourceCode and languageId must be defined")}return this.actionRunner.run("findByExternalId",{externalId:t,sourceCode:r,languageId:a}).then(this.processResponse.bind(this)).then(Ie(this,Me,_e).bind(this))}},{key:"findById",value:function e(t,r){if(!t||!r){throw new Error("locationId and languageId must be defined")}return this.actionRunner.run("findById",{id:t,languageId:r}).then(this.processResponse.bind(this)).then(Ie(this,Me,_e).bind(this))}}]);return t}(Ee);var Le=function e(t){var r=this;if(!Array.isArray(t)){throw new Error("Can't convert location collection data")}var a=[];t.forEach(function(e){a.push(Ie(r,Me,_e).call(r,e))});return a};var _e=function e(t){if(!t){return null}if(babelHelpers.typeof(t)!=="object"){throw new Error("Can't convert location data")}return ue.convertJsonToLocation(t)};var Ge=function(e){babelHelpers.inherits(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e.path="location.api.address";return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e))}babelHelpers.createClass(t,[{key:"findById",value:function e(t){var r=this;if(t<=0){throw new Error("addressId must be more than zero")}return this.actionRunner.run("findById",{addressId:t}).then(this.processResponse).then(function(e){var t=null;if(e){t=r.convertJsonToAddress(e)}return t})}},{key:"save",value:function e(t){var r=this;if(!t){throw new Error("address must be defined")}return this.actionRunner.run("save",{address:t}).then(this.processResponse).then(function(e){var t=null;if(babelHelpers.typeof(e)==="object"){t=r.convertJsonToAddress(e)}return t})}},{key:"convertJsonToAddress",value:function e(t){return new r.Address(t)}}]);return t}(Ee);var Re=function(e){babelHelpers.inherits(r,e);function r(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,r);e.path="location.api.format";return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(r).call(this,e))}babelHelpers.createClass(r,[{key:"findAll",value:function e(r){var a=this;if(!t.Type.isString(r)){throw new TypeError("languageId must be type of string")}return this.actionRunner.run("findAll",{languageId:r}).then(this.processResponse).then(function(e){return a.convertFormatCollection(e)})}},{key:"findByCode",value:function e(r,a){if(!t.Type.isString(r)){throw new TypeError("formatCode must be type of string")}if(!t.Type.isString(a)){throw new TypeError("languageId must be type of string")}return this.actionRunner.run("findByCode",{formatCode:r,languageId:a}).then(this.processResponse).then(this.convertFormatData)}},{key:"findDefault",value:function e(r){if(!t.Type.isString(r)){throw new TypeError("languageId must be type of string")}return this.actionRunner.run("findDefault",{languageId:r}).then(this.processResponse).then(this.convertFormatData)}},{key:"convertFormatCollection",value:function e(r){var a=this;if(!t.Type.isArray(r)){throw new TypeError("Can't convert format collection data")}var n=[];r.forEach(function(e){n.push(a.convertFormatData(e))});return n}},{key:"convertFormatData",value:function e(r){if(!t.Type.isObject(r)){throw new TypeError("Can't convert format data")}return new G(r)}}]);return r}(Ee);var We=function(e){babelHelpers.inherits(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e.path="location.api.source";return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e))}babelHelpers.createClass(t,[{key:"getProps",value:function e(){return this.actionRunner.run("getProps",{}).then(this.processResponse)}}]);return t}(Ee);var Ne=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"autocomplete",value:function e(t,r){throw new Error("Method autocomplete() Must be implemented")}}]);return e}();var Be=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"requestPhotos",value:function e(t){throw new Error("Must be implemented")}}]);return e}();var je=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.setEventNamespace("BX.Location.Core.MapBase");return e}babelHelpers.createClass(t,[{key:"render",value:function e(t){throw new Error("Must be implemented")}},{key:"onLocationChangedEventSubscribe",value:function e(t){throw new Error("Must be implemented")}},{key:"onMapShow",value:function e(){}},{key:"destroy",value:function e(){}},{key:"location",set:function e(t){throw new Error("Must be implemented")}},{key:"mode",set:function e(t){throw new Error("Must be implemented")}},{key:"zoom",set:function e(t){throw new Error("Must be implemented")}}]);return t}(a.EventEmitter);var xe=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"sourceCode",get:function e(){throw new Error("Must be implemented")}},{key:"map",get:function e(){throw new Error("Must be implemented")}},{key:"autocompleteService",get:function e(){throw new Error("Must be implemented")}},{key:"photoService",get:function e(){throw new Error("Must be implemented")}},{key:"geocodingService",get:function e(){throw new Error("Must be implemented")}}]);return e}();var Ye=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"geocode",value:function e(t){if(!t){return Promise.resolve([])}return this.geocodeConcrete(t)}},{key:"geocodeConcrete",value:function e(t){throw new Error("Method geocodeConcrete() must be implemented")}}]);return e}();var Je=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"isValid",value:function t(r){return r===e.edit||r===e.view}},{key:"edit",get:function e(){return"edit"}},{key:"view",get:function e(){return"view"}}]);return e}();var De=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(De,"POSTAL_CODE",50);babelHelpers.defineProperty(De,"ISO_3166_1_ALPHA_2",1e3);var Ve=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(babelHelpers.wrapNativeSuper(Error));var Xe=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(babelHelpers.wrapNativeSuper(Error));function Ue(e,t,r,a){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(r.set){r.set.call(e,a)}else{if(!r.writable){throw new TypeError("attempted to set read only private field")}r.value=a}return a}function ze(e,t,r){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(r.get){return r.get.call(e)}return r.value}var $e=function(e){babelHelpers.inherits(t,e);babelHelpers.createClass(t,null,[{key:"getInstance",value:function e(){if(ze(t,t,qe)===null){Ue(t,t,qe,new t)}return ze(t,t,qe)}}]);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.setEventNamespace("BX.Location.Core.ErrorPublisher");return e}babelHelpers.createClass(t,[{key:"notify",value:function e(r){this.emit(ze(t,t,Ke),{errors:r})}},{key:"subscribe",value:function e(r){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"subscribe",this).call(this,ze(t,t,Ke),r)}}]);return t}(a.EventEmitter);var qe={writable:true,value:null};var Ke={writable:true,value:"onError"};var Ze=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"isAddressLimitReached",value:function e(){return BX.message("LOCATION_IS_ADDRESS_LIMIT_REACHED")}}]);return e}();var Qe=new WeakMap;var et=new WeakMap;var tt=function(){function e(t,r){babelHelpers.classCallCheck(this,e);Qe.set(this,{writable:true,value:void 0});et.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,Qe,t);babelHelpers.classPrivateFieldSet(this,et,r)}babelHelpers.createClass(e,[{key:"toArray",value:function e(){return[this.latitude,this.longitude]}},{key:"latitude",get:function e(){return babelHelpers.classPrivateFieldGet(this,Qe)}},{key:"longitude",get:function e(){return babelHelpers.classPrivateFieldGet(this,et)}}],[{key:"fromJson",value:function t(r){return new e(r.latitude,r.longitude)}}]);return e}();var rt=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getDistanceFromLatLonInKm",value:function t(r,a,n,l){var i=6371;var s=e.deg2rad(n-r);var o=e.deg2rad(l-a);var u=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e.deg2rad(r))*Math.cos(e.deg2rad(n))*Math.sin(o/2)*Math.sin(o/2);var c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return i*c}},{key:"deg2rad",value:function e(t){return t*(Math.PI/180)}}]);return e}();e.Location=ke;e.Address=re;e.Format=G;e.AddressType=W;e.LocationType=R;e.LocationFieldType=De;e.LocationRepository=Oe;e.AddressRepository=Ge;e.FormatRepository=Re;e.SourceRepository=We;e.AddressStringConverter=x;e.AutocompleteServiceBase=Ne;e.PhotoServiceBase=Be;e.BaseSource=xe;e.MapBase=je;e.GeocodingServiceBase=Ye;e.ControlMode=Je;e.SourceCreationError=Ve;e.MethodNotImplemented=Xe;e.ErrorPublisher=$e;e.Limit=Ze;e.Point=tt;e.DistanceCalculator=rt})(this.BX.Location.Core=this.BX.Location.Core||{},BX,BX.Location.Core,BX.Event);
//# sourceMappingURL=core.bundle.map.js