this.BX=this.BX||{};this.BX.Location=this.BX.Location||{};(function(e,t,s,a,i,l,r,n,d){"use strict";var b=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(b,"INITIAL","INITIAL");babelHelpers.defineProperty(b,"DATA_INPUTTING","DATA_INPUTTING");babelHelpers.defineProperty(b,"DATA_SELECTED","DATA_SELECTED");babelHelpers.defineProperty(b,"DATA_SUPPOSED","DATA_SUPPOSED");babelHelpers.defineProperty(b,"DATA_LOADING","DATA_LOADING");babelHelpers.defineProperty(b,"DATA_LOADED","DATA_LOADED");var o=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"render",value:function e(t){throw new l.MethodNotImplemented("Method render must be implemented")}},{key:"setAddressWidget",value:function e(t){throw new l.MethodNotImplemented("Method render must be implemented")}},{key:"setAddress",value:function e(t){throw new l.MethodNotImplemented("Method set address must be implemented")}},{key:"setMode",value:function e(t){}},{key:"destroy",value:function e(){}},{key:"resetView",value:function e(){}}]);return e}();function c(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=u(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function u(e,t){if(!e)return;if(typeof e==="string")return p(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return p(e,t)}function p(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function v(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var h=new WeakMap;var f=new WeakMap;var H=new WeakMap;var P=new WeakMap;var F=new WeakMap;var g=new WeakMap;var m=new WeakMap;var w=new WeakMap;var T=new WeakMap;var y=new WeakMap;var I=new WeakMap;var G=new WeakMap;var S=new WeakMap;var k=new WeakSet;var E=new WeakSet;var C=new WeakSet;var W=new WeakSet;var M=new WeakSet;var A=new WeakSet;var z=new WeakSet;var _=new WeakSet;var O=new WeakSet;var L=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));O.add(babelHelpers.assertThisInitialized(s));_.add(babelHelpers.assertThisInitialized(s));z.add(babelHelpers.assertThisInitialized(s));A.add(babelHelpers.assertThisInitialized(s));M.add(babelHelpers.assertThisInitialized(s));W.add(babelHelpers.assertThisInitialized(s));C.add(babelHelpers.assertThisInitialized(s));E.add(babelHelpers.assertThisInitialized(s));k.add(babelHelpers.assertThisInitialized(s));h.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});f.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});H.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});P.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});F.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});g.set(babelHelpers.assertThisInitialized(s),{writable:true,value:[]});m.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});w.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});T.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});y.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});I.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});G.set(babelHelpers.assertThisInitialized(s),{writable:true,value:true});S.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.Address");if(!(e.addressFormat instanceof l.Format)){BX.debug("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),P,e.addressFormat);if(e.address&&!(e.address instanceof l.Address)){BX.debug("address must be instance of Address")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),H,e.address||null);if(!l.ControlMode.isValid(e.mode)){BX.debug("mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),h,e.mode);if(!d.Type.isString(e.languageId)){throw new TypeError("props.languageId must be type of string")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),F,e.languageId);if(e.features){if(!d.Type.isArray(e.features)){throw new TypeError("features must be an array")}e.features.forEach(function(e){v(babelHelpers.assertThisInitialized(s),k,D).call(babelHelpers.assertThisInitialized(s),e)})}if(d.Type.isBoolean(e.needWarmBackendAfterAddressChanged)){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),G,e.needWarmBackendAfterAddressChanged)}if(e.locationRepository instanceof l.LocationRepository){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),S,e.locationRepository)}else if(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),G)){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),S,new l.LocationRepository)}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),f,b.INITIAL);return s}babelHelpers.createClass(t,[{key:"setAddressByFeature",value:function e(t,s){var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var i=babelHelpers.classPrivateFieldGet(this,H)?babelHelpers.classPrivateFieldGet(this,H).id:0;babelHelpers.classPrivateFieldSet(this,H,t);if(i>0){babelHelpers.classPrivateFieldGet(this,H).id=i}babelHelpers.classPrivateFieldSet(this,y,true);v(this,z,U).call(this,t);v(this,E,B).call(this,"setAddress",[t],s,a);if(babelHelpers.classPrivateFieldGet(this,f)!==b.DATA_INPUTTING){v(this,C,N).call(this)}}},{key:"emitFeatureEvent",value:function e(s){this.emit(t.onFeatureEvent,s)}},{key:"onInputKeyup",value:function e(t){switch(t.code){case"Tab":case"Esc":case"Enter":case"NumpadEnter":this.resetView();break;default:babelHelpers.classPrivateFieldSet(this,I,true)}}},{key:"resetView",value:function e(){v(this,E,B).call(this,"resetView")}},{key:"render",value:function e(t){if(!d.Type.isDomNode(t.controlWrapper)){BX.debug("props.controlWrapper  must be instance of Element")}babelHelpers.classPrivateFieldSet(this,w,t.controlWrapper);if(babelHelpers.classPrivateFieldGet(this,h)===l.ControlMode.edit){if(!d.Type.isDomNode(t.inputNode)){BX.debug("props.inputNode  must be instance of Element")}babelHelpers.classPrivateFieldSet(this,m,t.inputNode);v(this,z,U).call(this,babelHelpers.classPrivateFieldGet(this,H))}v(this,E,B).call(this,"render",[t]);if(babelHelpers.classPrivateFieldGet(this,h)===l.ControlMode.edit){d.Event.bind(babelHelpers.classPrivateFieldGet(this,m),"focus",v(this,M,R).bind(this));d.Event.bind(babelHelpers.classPrivateFieldGet(this,m),"focusout",v(this,_,Y).bind(this));d.Event.bind(babelHelpers.classPrivateFieldGet(this,m),"keyup",this.onInputKeyup.bind(this))}}},{key:"setStateByFeature",value:function e(s){babelHelpers.classPrivateFieldSet(this,f,s);this.emit(t.onStateChangedEvent,{state:s})}},{key:"subscribeOnStateChangedEvent",value:function e(s){this.subscribe(t.onStateChangedEvent,s)}},{key:"subscribeOnAddressChangedEvent",value:function e(s){this.subscribe(t.onAddressChangedEvent,s)}},{key:"subscribeOnFeatureEvent",value:function e(s){this.subscribe(t.onFeatureEvent,s)}},{key:"subscribeOnErrorEvent",value:function e(t){l.ErrorPublisher.getInstance().subscribe(t)}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,T)){return}d.Event.unbindAll(this);d.Event.unbind(babelHelpers.classPrivateFieldGet(this,m),"focus",v(this,M,R));d.Event.unbind(babelHelpers.classPrivateFieldGet(this,m),"focusout",v(this,_,Y));d.Event.unbind(babelHelpers.classPrivateFieldGet(this,m),"keyup",this.onInputKeyup);v(this,E,B).call(this,"destroy");v(this,O,V).call(this);babelHelpers.classPrivateFieldSet(this,T,true)}},{key:"isDestroyed",value:function e(){return babelHelpers.classPrivateFieldGet(this,T)}},{key:"features",get:function e(){return babelHelpers.classPrivateFieldGet(this,g)}},{key:"controlWrapper",get:function e(){return babelHelpers.classPrivateFieldGet(this,w)}},{key:"inputNode",get:function e(){return babelHelpers.classPrivateFieldGet(this,m)}},{key:"address",get:function e(){return babelHelpers.classPrivateFieldGet(this,H)},set:function e(t){if(t&&!(t instanceof l.Address)){BX.debug("address must be instance of Address")}babelHelpers.classPrivateFieldSet(this,H,t);v(this,E,B).call(this,"setAddress",[t]);babelHelpers.classPrivateFieldSet(this,I,false);babelHelpers.classPrivateFieldSet(this,y,false);v(this,z,U).call(this,t)}},{key:"mode",get:function e(){return babelHelpers.classPrivateFieldGet(this,h)},set:function e(t){if(!l.ControlMode.isValid(t)){BX.debug("mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(this,h,t);v(this,E,B).call(this,"setMode",[t])}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,f)}},{key:"addressFormat",get:function e(){return babelHelpers.classPrivateFieldGet(this,P)}}]);return t}(n.EventEmitter);babelHelpers.defineProperty(L,"onAddressChangedEvent","onAddressChanged");babelHelpers.defineProperty(L,"onStateChangedEvent","onStateChanged");babelHelpers.defineProperty(L,"onFeatureEvent","onFeatureEvent");var D=function e(t){if(!(t instanceof o)){BX.debug("feature must be instance of BaseFeature")}t.setAddressWidget(this);babelHelpers.classPrivateFieldGet(this,g).push(t)};var B=function e(t){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[];var l;var r=c(babelHelpers.classPrivateFieldGet(this,g)),n;try{for(r.s();!(n=r.n()).done;){var d=n.value;var b=false;var o=c(i),u;try{for(o.s();!(u=o.n()).done;){var p=u.value;if(d instanceof p){b=true;break}}}catch(e){o.e(e)}finally{o.f()}if(!b&&d!==a){l=d[t].apply(d,s)}}}catch(e){r.e(e)}finally{r.f()}return l};var N=function e(){this.emit(L.onAddressChangedEvent,{address:babelHelpers.classPrivateFieldGet(this,H)});if(babelHelpers.classPrivateFieldGet(this,H)&&babelHelpers.classPrivateFieldGet(this,G)){v(this,W,X).call(this,babelHelpers.classPrivateFieldGet(this,H))}};var X=function e(t){if(t.location!==null&&t.location.id<=0){babelHelpers.classPrivateFieldGet(this,S).findParents(t.location)}};var R=function e(t){var s=babelHelpers.classPrivateFieldGet(this,m).value;if(s.length>0){BX.setCaretPosition(babelHelpers.classPrivateFieldGet(this,m),s.length-1)}};var x=function e(t){if(!t){return""}return t.toString(babelHelpers.classPrivateFieldGet(this,P),l.AddressStringConverter.STRATEGY_TYPE_FIELD_TYPE,l.AddressStringConverter.CONTENT_TYPE_TEXT)};var U=function e(t){if(babelHelpers.classPrivateFieldGet(this,m)){var s=babelHelpers.classPrivateFieldGet(this,m).selectionStart;var a=babelHelpers.classPrivateFieldGet(this,m).selectionEnd;var i=v(this,A,x).call(this,t);babelHelpers.classPrivateFieldGet(this,m).value=i;babelHelpers.classPrivateFieldGet(this,m).title=i;babelHelpers.classPrivateFieldGet(this,m).setSelectionRange(s,a)}};var Y=function e(t){if(babelHelpers.classPrivateFieldGet(this,I)&&!babelHelpers.classPrivateFieldGet(this,y)){var s=babelHelpers.classPrivateFieldGet(this,m).value.trim();var a=new l.Address({languageId:babelHelpers.classPrivateFieldGet(this,F)});a.setFieldValue(babelHelpers.classPrivateFieldGet(this,P).fieldForUnRecognized,s);this.address=a;v(this,C,N).call(this)}babelHelpers.classPrivateFieldSet(this,I,false);babelHelpers.classPrivateFieldSet(this,y,false)};var V=function e(){babelHelpers.classPrivateFieldGet(this,g).splice(0,babelHelpers.classPrivateFieldGet(this,g).length)};var j=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"choseItemIdx",-1);var a=e.bindElement.getBoundingClientRect();s.popupWindow.setMaxWidth(a.width);return s}babelHelpers.createClass(t,[{key:"isMenuEmpty",value:function e(){return this.menuItems.length<=0}},{key:"isChoseLastItem",value:function e(){return this.choseItemIdx>=this.menuItems.length-1}},{key:"isChoseFirstItem",value:function e(){return this.choseItemIdx===0}},{key:"isItemChosen",value:function e(){return this.choseItemIdx>=0}},{key:"isDestroyed",value:function e(){return this.getPopupWindow().isDestroyed()}},{key:"isItemExist",value:function e(t){return typeof this.menuItems[this.choseItemIdx]!=="undefined"}},{key:"getChosenItem",value:function e(){var t=null;if(this.isItemChosen()&&this.isItemExist(this.choseItemIdx)){t=this.menuItems[this.choseItemIdx]}return t}},{key:"chooseNextItem",value:function e(){if(!this.isMenuEmpty()&&!this.isChoseLastItem()){this.chooseItem(this.choseItemIdx+1)}return this.getChosenItem()}},{key:"choosePrevItem",value:function e(){if(!this.isMenuEmpty()&&!this.isChoseFirstItem()){this.chooseItem(this.choseItemIdx-1)}return this.getChosenItem()}},{key:"highlightItem",value:function e(t){if(this.isItemExist(t)){var s=this.getChosenItem();if(s&&s.layout.item){s.layout.item.classList.add("highlighted")}}}},{key:"unHighlightItem",value:function e(t){if(this.isItemExist(t)){var s=this.getChosenItem();if(s&&s.layout.item){s.layout.item.classList.remove("highlighted")}}}},{key:"chooseItem",value:function e(t){this.unHighlightItem(this.choseItemIdx);this.choseItemIdx=t;this.highlightItem(this.choseItemIdx)}},{key:"clearItems",value:function e(){while(this.menuItems.length>0){this.removeMenuItem(this.menuItems[0].id)}}},{key:"isShown",value:function e(){return this.getPopupWindow().isShown()}}]);return t}(a.Menu);function K(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=q(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function q(e,t){if(!e)return;if(typeof e==="string")return J(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return J(e,t)}function J(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function $(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div data-show-on-map="" tabindex="-1" class="location-map-popup-item--show-on-map">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"]);$=function t(){return e};return e}function Z(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var Q=new WeakMap;var ee=new WeakMap;var te=new WeakMap;var se=new WeakMap;var ae=new WeakSet;var ie=new WeakSet;var le=new WeakSet;var re=new WeakSet;var ne=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));re.add(babelHelpers.assertThisInitialized(s));le.add(babelHelpers.assertThisInitialized(s));ie.add(babelHelpers.assertThisInitialized(s));ae.add(babelHelpers.assertThisInitialized(s));Q.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ee.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});te.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});se.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.Prompt");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Q,e.inputNode);if(e.menuNode){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ee,e.menuNode)}return s}babelHelpers.createClass(t,[{key:"getMenu",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,te)||babelHelpers.classPrivateFieldGet(this,te).isDestroyed()){babelHelpers.classPrivateFieldSet(this,te,Z(this,ae,de).call(this))}return babelHelpers.classPrivateFieldGet(this,te)}},{key:"show",value:function e(t,s){if(t.length>0){this.setMenuItems(t,s);this.getMenu().show()}}},{key:"close",value:function e(){this.getMenu().close()}},{key:"setMenuItems",value:function e(t,s){var a=this;this.getMenu().clearItems();if(Array.isArray(t)){babelHelpers.classPrivateFieldSet(this,se,t.slice());t.forEach(function(e){a.getMenu().addMenuItem(Z(a,ie,be).call(a,e,s))})}}},{key:"addShowOnMapMenuItem",value:function e(t,s){var a=this;var i=d.Tag.render($(),d.Loc.getMessage("LOCATION_WIDGET_SHOW_ON_MAP"));this.getMenu().addMenuItem({className:"location-map-popup-item--info",text:s,onclick:function e(s,l){if(s.target===i){t()}a.close();s.stopPropagation()}});this.getMenu().menuItems[this.getMenu().menuItems.length-1].getContainer().appendChild(i)}},{key:"choosePrevItem",value:function e(){var t=null;var s=this.getMenu().choosePrevItem();if(s){t=Z(this,re,ce).call(this,s.id)}return t}},{key:"chooseNextItem",value:function e(){var t=null;var s=this.getMenu().chooseNextItem();if(s){t=Z(this,re,ce).call(this,s.id)}return t}},{key:"isItemChosen",value:function e(){return babelHelpers.classPrivateFieldGet(this,te).isItemChosen()}},{key:"getChosenItem",value:function e(){var t=null;var s=babelHelpers.classPrivateFieldGet(this,te).getChosenItem();if(s&&s.id){t=Z(this,re,ce).call(this,s.id)}return t}},{key:"isShown",value:function e(){return this.getMenu().isShown()}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,te)){babelHelpers.classPrivateFieldGet(this,te).destroy();babelHelpers.classPrivateFieldSet(this,te,null)}babelHelpers.classPrivateFieldSet(this,se,null)}}],[{key:"createMenuItemText",value:function e(t,s){var a=t.slice();if(!s||s.length<=0){return a}var i=s.replace(/,+/gi,"").split(new RegExp(/\s+/g));var l=new RegExp(BX.util.escapeRegExp("(".concat(i.join("|"),")")),"gi");a=t.replace(l,function(e){return"<strong>".concat(e,"</strong>")});return a}}]);return t}(n.EventEmitter);babelHelpers.defineProperty(ne,"onItemSelectedEvent","onItemSelected");var de=function e(){return new j({bindElement:babelHelpers.classPrivateFieldGet(this,ee)?babelHelpers.classPrivateFieldGet(this,ee):babelHelpers.classPrivateFieldGet(this,Q),autoHide:false,closeByEsc:true,className:"location-widget-prompt-menu"})};var be=function e(t,s){var a=this;var i=t.externalId;return{id:i,title:t.name,html:ne.createMenuItemText(t.name,s),onclick:function e(t,s){Z(a,le,oe).call(a,i);a.close()}}};var oe=function e(t){var s=Z(this,re,ce).call(this,t);if(s){this.emit(ne.onItemSelectedEvent,{location:s})}};var ce=function e(t){var s=null;var a=K(babelHelpers.classPrivateFieldGet(this,se)),i;try{for(a.s();!(i=a.n()).done;){var l=i.value;if(l.externalId===t){s=l;break}}}catch(e){a.e(e)}finally{a.f()}if(!s){BX.debug("Location with externalId "+t+" was not found")}return s};function ue(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}return s}function pe(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function ve(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var he=new WeakMap;var fe=new WeakMap;var He=new WeakMap;var Pe=new WeakMap;var Fe=new WeakMap;var ge=new WeakMap;var me=new WeakMap;var we=new WeakMap;var Te=new WeakMap;var ye=new WeakMap;var Ie=new WeakMap;var Ge=new WeakMap;var Se=new WeakMap;var ke=new WeakMap;var Ee=new WeakMap;var Ce=new WeakMap;var We=new WeakMap;var Me=new WeakMap;var Ae=new WeakMap;var ze=new WeakMap;var _e=new WeakMap;var Oe=new WeakMap;var Le=new WeakSet;var De=new WeakSet;var Be=new WeakSet;var Ne=new WeakSet;var Xe=new WeakSet;var Re=new WeakSet;var xe=new WeakSet;var Ue=new WeakSet;var Ye=new WeakSet;var Ve=new WeakSet;var je=new WeakSet;var Ke=new WeakSet;var qe=new WeakSet;var Je=new WeakSet;var $e=new WeakSet;var Ze=new WeakSet;var Qe=new WeakSet;var et=new WeakSet;var tt=new WeakSet;var st=new WeakSet;var at=new WeakSet;var it=new WeakSet;var lt=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));it.add(babelHelpers.assertThisInitialized(s));at.add(babelHelpers.assertThisInitialized(s));st.add(babelHelpers.assertThisInitialized(s));tt.add(babelHelpers.assertThisInitialized(s));et.add(babelHelpers.assertThisInitialized(s));Qe.add(babelHelpers.assertThisInitialized(s));Ze.add(babelHelpers.assertThisInitialized(s));$e.add(babelHelpers.assertThisInitialized(s));Je.add(babelHelpers.assertThisInitialized(s));qe.add(babelHelpers.assertThisInitialized(s));Ke.add(babelHelpers.assertThisInitialized(s));je.add(babelHelpers.assertThisInitialized(s));Ve.add(babelHelpers.assertThisInitialized(s));Ye.add(babelHelpers.assertThisInitialized(s));Ue.add(babelHelpers.assertThisInitialized(s));xe.add(babelHelpers.assertThisInitialized(s));Re.add(babelHelpers.assertThisInitialized(s));Xe.add(babelHelpers.assertThisInitialized(s));Ne.add(babelHelpers.assertThisInitialized(s));Be.add(babelHelpers.assertThisInitialized(s));De.add(babelHelpers.assertThisInitialized(s));Le.add(babelHelpers.assertThisInitialized(s));he.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});fe.set(babelHelpers.assertThisInitialized(s),{writable:true,value:""});He.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Pe.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Fe.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ge.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});me.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});we.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Te.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ye.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ie.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ge.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Se.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ke.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Ee.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ce.set(babelHelpers.assertThisInitialized(s),{writable:true,value:{requested:"",current:"",dropped:""}});We.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Me.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});Ae.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ze.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});_e.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});Oe.set(babelHelpers.assertThisInitialized(s),{writable:true,value:100});s.setEventNamespace("BX.Location.Widget.Autocomplete");if(!(e.addressFormat instanceof l.Format)){throw new Error("props.addressFormat must be type of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Pe,e.addressFormat);if(!(e.autocompleteService instanceof l.AutocompleteServiceBase)){throw new Error("props.autocompleteService must be type of AutocompleteServiceBase")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ye,e.autocompleteService);if(!e.languageId){throw new Error("props.languageId must be defined")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),He,e.languageId);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Fe,e.sourceCode);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),he,e.address);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),we,e.presetLocationsProvider);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ge,e.locationRepository||new l.LocationRepository);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),me,e.userLocation);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ge,e.promptDelay||500);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Se,e.maxPromptDelay||1500);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ie,e.minCharsCountToAutocomplete||3);ve(babelHelpers.assertThisInitialized(s),qe,yt).call(babelHelpers.assertThisInitialized(s),b.INITIAL);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ze,babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Ge));return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,Ee,t.inputNode);babelHelpers.classPrivateFieldSet(this,fe,babelHelpers.classPrivateFieldGet(this,Ee).value);babelHelpers.classPrivateFieldSet(this,he,t.address);babelHelpers.classPrivateFieldGet(this,Ee).addEventListener("keyup",ve(this,tt,Ct).bind(this));babelHelpers.classPrivateFieldGet(this,Ee).addEventListener("focus",ve(this,Xe,ft).bind(this));babelHelpers.classPrivateFieldGet(this,Ee).addEventListener("focusout",ve(this,Ne,ht).bind(this));babelHelpers.classPrivateFieldGet(this,Ee).addEventListener("click",ve(this,De,pt).bind(this));babelHelpers.classPrivateFieldSet(this,Te,new ne({inputNode:t.inputNode,menuNode:t.menuNode}));babelHelpers.classPrivateFieldGet(this,Te).subscribe(ne.onItemSelectedEvent,ve(this,Ke,Tt).bind(this));document.addEventListener("click",ve(this,Ye,gt).bind(this))}},{key:"onAddressChangedEventSubscribe",value:function e(s){this.subscribe(pe(t,t,nt),s)}},{key:"onStateChangedEventSubscribe",value:function e(s){this.subscribe(pe(t,t,dt),s)}},{key:"onSearchStartedEventSubscribe",value:function e(s){this.subscribe(pe(t,t,bt),s)}},{key:"onSearchCompletedEventSubscribe",value:function e(s){this.subscribe(pe(t,t,ot),s)}},{key:"onShowOnMapClickedEventSubscribe",value:function e(s){this.subscribe(pe(t,t,ct),s)}},{key:"showPrompt",value:function e(t,s){babelHelpers.classPrivateFieldGet(this,Ce).requested=t;babelHelpers.classPrivateFieldGet(this,Ce).current=t;babelHelpers.classPrivateFieldGet(this,Ce).dropped="";ve(this,at,Mt).call(this,t,s,ve(this,st,Wt).call(this))}},{key:"closePrompt",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Te)){babelHelpers.classPrivateFieldGet(this,Te).close()}}},{key:"isPromptShown",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Te)){babelHelpers.classPrivateFieldGet(this,Te).isShown()}}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Me)){return}d.Event.unbindAll(this);if(babelHelpers.classPrivateFieldGet(this,Te)){babelHelpers.classPrivateFieldGet(this,Te).destroy();babelHelpers.classPrivateFieldSet(this,Te,null)}babelHelpers.classPrivateFieldSet(this,ke,null);if(babelHelpers.classPrivateFieldGet(this,Ee)){babelHelpers.classPrivateFieldGet(this,Ee).removeEventListener("keyup",ve(this,tt,Ct));babelHelpers.classPrivateFieldGet(this,Ee).removeEventListener("focus",ve(this,Xe,ft));babelHelpers.classPrivateFieldGet(this,Ee).removeEventListener("focusout",ve(this,Ne,ht));babelHelpers.classPrivateFieldGet(this,Ee).removeEventListener("click",ve(this,De,pt))}document.removeEventListener("click",ve(this,Ye,gt));babelHelpers.classPrivateFieldSet(this,Me,true)}},{key:"address",set:function e(t){babelHelpers.classPrivateFieldSet(this,he,t);if(babelHelpers.classPrivateFieldGet(this,Ee)){babelHelpers.classPrivateFieldSet(this,fe,babelHelpers.classPrivateFieldGet(this,Ee).value)}},get:function e(){return babelHelpers.classPrivateFieldGet(this,he)}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,We)}}]);return t}(n.EventEmitter);var rt=function e(t){t=t.trim();if(t.length<=0){return["",""]}var s=t.lastIndexOf(" ");if(s<=0){return["",""]}return[t.slice(0,s),t.slice(s+1)]};var nt={writable:true,value:"onAddressChanged"};var dt={writable:true,value:"onStateChanged"};var bt={writable:true,value:"onSearchStarted"};var ot={writable:true,value:"onSearchCompleted"};var ct={writable:true,value:"onShowOnMapClicked"};var ut=function e(t){if(!t){return""}return t.toString(babelHelpers.classPrivateFieldGet(this,Pe),l.AddressStringConverter.STRATEGY_TYPE_FIELD_TYPE,l.AddressStringConverter.CONTENT_TYPE_TEXT)};var pt=function e(t){var s=babelHelpers.classPrivateFieldGet(this,Ee).value;if(s.length===0){ve(this,Be,vt).call(this)}};var vt=function e(){var t=babelHelpers.classPrivateFieldGet(this,we).call(this);babelHelpers.classPrivateFieldGet(this,Te).setMenuItems(t,"");babelHelpers.classPrivateFieldGet(this,Te).addShowOnMapMenuItem(ve(this,je,wt).call(this,null),d.Loc.getMessage(t.length>0?"LOCATION_WIDGET_PICK_ADDRESS_OR_SHOW_ON_MAP":"LOCATION_WIDGET_START_PRINTING_OR_SHOW_ON_MAP"));babelHelpers.classPrivateFieldGet(this,Te).getMenu().show()};var ht=function e(t){var s=this;if(babelHelpers.classPrivateFieldGet(this,Me)){return}setTimeout(function(){if(babelHelpers.classPrivateFieldGet(s,We)===b.DATA_INPUTTING){ve(s,qe,yt).call(s,b.DATA_SUPPOSED);ve(s,Ue,Ft).call(s)}},200);if(babelHelpers.classPrivateFieldGet(this,Te)){babelHelpers.classPrivateFieldGet(this,Te).close()}t.stopImmediatePropagation()};var ft=function e(){if(babelHelpers.classPrivateFieldGet(this,Me)){return}if(babelHelpers.classPrivateFieldGet(this,he)&&(!babelHelpers.classPrivateFieldGet(this,he).location||!babelHelpers.classPrivateFieldGet(this,he).location.hasExternalRelation())&&babelHelpers.classPrivateFieldGet(this,Ee).value.length>0){this.showPrompt(babelHelpers.classPrivateFieldGet(this,Ee).value,ve(this,Re,Ht).call(this))}};var Ht=function e(){return{userCoordinates:babelHelpers.classPrivateFieldGet(this,me)?[babelHelpers.classPrivateFieldGet(this,me).latitude,babelHelpers.classPrivateFieldGet(this,me).longitude]:null}};var Pt=function e(){var t="";if(babelHelpers.classPrivateFieldGet(this,Ee)){t=babelHelpers.classPrivateFieldGet(this,Ee).value}return t};var Ft=function e(){babelHelpers.classPrivateFieldSet(this,he,ve(this,Qe,kt).call(this,ve(this,xe,Pt).call(this)));ve(this,$e,Gt).call(this)};var gt=function e(t){if(babelHelpers.classPrivateFieldGet(this,Me)){return}if(t.target===babelHelpers.classPrivateFieldGet(this,Ee)){return}if(babelHelpers.classPrivateFieldGet(this,Te).isShown()){babelHelpers.classPrivateFieldGet(this,Te).close()}};var mt=function e(t,s){var a=this;if(Array.isArray(t)&&t.length>0){babelHelpers.classPrivateFieldGet(this,Te).setMenuItems(t,babelHelpers.classPrivateFieldGet(this,Ce).requested);babelHelpers.classPrivateFieldGet(this,Te).addShowOnMapMenuItem(ve(this,je,wt).call(this,t[0]),d.Loc.getMessage("LOCATION_WIDGET_PICK_ADDRESS_OR_SHOW_ON_MAP"));babelHelpers.classPrivateFieldGet(this,Te).getMenu().show()}else{var i=ue(lt,lt,rt).call(lt,babelHelpers.classPrivateFieldGet(this,Ce).current);babelHelpers.classPrivateFieldGet(this,Ce).current=i[0];babelHelpers.classPrivateFieldGet(this,Ce).dropped=i[1]+" "+babelHelpers.classPrivateFieldGet(this,Ce).dropped;if(babelHelpers.classPrivateFieldGet(this,Ce).current.length>0){ve(this,at,Mt).call(this,babelHelpers.classPrivateFieldGet(this,Ce).current,s,1)}else{babelHelpers.classPrivateFieldGet(this,Te).getMenu().clearItems();babelHelpers.classPrivateFieldGet(this,Te).getMenu().addMenuItem({id:"notFound",html:"<span>".concat(d.Loc.getMessage("LOCATION_WIDGET_PROMPT_ADDRESS_NOT_FOUND"),"</span>"),onclick:function e(t,s){babelHelpers.classPrivateFieldGet(a,Te).close()}});babelHelpers.classPrivateFieldGet(this,Te).addShowOnMapMenuItem(ve(this,je,wt).call(this,null),d.Loc.getMessage("LOCATION_WIDGET_CHECK_ADDRESS_OR_SHOW_ON_MAP"));babelHelpers.classPrivateFieldGet(this,Te).getMenu().show()}}};var wt=function e(t){var s=this;return function(){if(t&&babelHelpers.classPrivateFieldGet(s,me)&&t.latitude&&t.longitude&&babelHelpers.classPrivateFieldGet(s,me).latitude&&babelHelpers.classPrivateFieldGet(s,me).longitude){var e=l.DistanceCalculator.getDistanceFromLatLonInKm(t.latitude,t.longitude,babelHelpers.classPrivateFieldGet(s,me).latitude,babelHelpers.classPrivateFieldGet(s,me).longitude);if(e<=babelHelpers.classPrivateFieldGet(s,Oe)){ve(s,Je,It).call(s,t);return}}s.emit(pe(lt,lt,ct))}};var Tt=function e(t){if(t.data.location){ve(this,Je,It).call(this,t.data.location)}};var yt=function e(t){babelHelpers.classPrivateFieldSet(this,We,t);this.emit(pe(lt,lt,dt),{state:babelHelpers.classPrivateFieldGet(this,We)})};var It=function e(t){var s=this;var a;ve(this,qe,yt).call(this,b.DATA_SELECTED);if(t){if(t.hasExternalRelation()&&babelHelpers.classPrivateFieldGet(this,Fe)===t.sourceCode){a=ve(this,Ze,St).call(this,t).then(function(e){ve(s,et,Et).call(s,e);return true},function(e){return l.ErrorPublisher.getInstance().notify(e.errors)})}else{a=new Promise(function(e){setTimeout(function(){ve(s,et,Et).call(s,t);e()},0)})}}else{a=new Promise(function(e){setTimeout(function(){ve(s,et,Et).call(s,null);e()},0)})}return a};var Gt=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];babelHelpers.classPrivateFieldSet(this,fe,babelHelpers.classPrivateFieldGet(this,he)?ve(this,Le,ut).call(this,babelHelpers.classPrivateFieldGet(this,he)):"");this.emit(pe(lt,lt,nt),{address:babelHelpers.classPrivateFieldGet(this,he),excludeSetAddressFeatures:t})};var St=function e(t){var s=this;ve(this,qe,yt).call(this,b.DATA_LOADING);return babelHelpers.classPrivateFieldGet(this,ge).findByExternalId(t.externalId,t.sourceCode,t.languageId).then(function(e){ve(s,qe,yt).call(s,b.DATA_LOADED);return e},function(e){l.ErrorPublisher.getInstance().notify(e.errors)})};var kt=function e(t){var s=new l.Address({languageId:babelHelpers.classPrivateFieldGet(this,He)});s.setFieldValue(babelHelpers.classPrivateFieldGet(this,Pe).fieldForUnRecognized,t);return s};var Et=function e(t){babelHelpers.classPrivateFieldSet(this,he,t?t.toAddress():null);if(babelHelpers.classPrivateFieldGet(this,he)&&babelHelpers.classPrivateFieldGet(this,Ce).dropped.length>0){babelHelpers.classPrivateFieldGet(this,he).setFieldValue(babelHelpers.classPrivateFieldGet(this,Pe).fieldForUnRecognized,babelHelpers.classPrivateFieldGet(this,Ce).dropped)}ve(this,$e,Gt).call(this)};var Ct=function e(t){var s=this;if(babelHelpers.classPrivateFieldGet(this,Me)){return}var a=Date.now();if(babelHelpers.classPrivateFieldGet(this,Ae)){var i=a-babelHelpers.classPrivateFieldGet(this,Ae);babelHelpers.classPrivateFieldSet(this,ze,(babelHelpers.classPrivateFieldGet(this,ze)+i)/2)}babelHelpers.classPrivateFieldSet(this,Ae,a);if(babelHelpers.classPrivateFieldGet(this,We)!==b.DATA_INPUTTING&&babelHelpers.classPrivateFieldGet(this,fe).trim()!==ve(this,xe,Pt).call(this).trim()){ve(this,qe,yt).call(this,b.DATA_INPUTTING)}if(babelHelpers.classPrivateFieldGet(this,Te).isShown()){switch(t.code){case"NumpadEnter":case"Enter":if(babelHelpers.classPrivateFieldGet(this,Te).isItemChosen()){ve(this,Je,It).call(this,babelHelpers.classPrivateFieldGet(this,Te).getChosenItem()).then(function(){babelHelpers.classPrivateFieldGet(s,Te).close()},function(e){return BX.debug(e)})}return;case"Tab":case"Escape":ve(this,qe,yt).call(this,b.DATA_SUPPOSED);ve(this,Ue,Ft).call(this);babelHelpers.classPrivateFieldGet(this,Te).close();return;case"ArrowUp":babelHelpers.classPrivateFieldGet(this,Te).choosePrevItem();return;case"ArrowDown":babelHelpers.classPrivateFieldGet(this,Te).chooseNextItem();return}}if(babelHelpers.classPrivateFieldGet(this,fe).trim()!==ve(this,xe,Pt).call(this).trim()){this.showPrompt(babelHelpers.classPrivateFieldGet(this,Ee).value,ve(this,Re,Ht).call(this))}if(babelHelpers.classPrivateFieldGet(this,Ee).value.length===0){ve(this,Be,vt).call(this)}};var Wt=function e(){var t=babelHelpers.classPrivateFieldGet(this,Ge)>babelHelpers.classPrivateFieldGet(this,ze)?babelHelpers.classPrivateFieldGet(this,Ge):babelHelpers.classPrivateFieldGet(this,ze)*1.5;return t>babelHelpers.classPrivateFieldGet(this,Se)?babelHelpers.classPrivateFieldGet(this,Se):t};var Mt=function e(t,s,a){if(t.length>babelHelpers.classPrivateFieldGet(this,Ie)){if(babelHelpers.classPrivateFieldGet(this,ke)!==null){clearTimeout(babelHelpers.classPrivateFieldGet(this,ke))}babelHelpers.classPrivateFieldSet(this,ke,ve(this,it,At).call(this,t,s,a))}};var At=function e(t,s,a){var i=this;return setTimeout(function(){if(babelHelpers.classPrivateFieldGet(i,_e)){clearTimeout(babelHelpers.classPrivateFieldGet(i,ke));babelHelpers.classPrivateFieldSet(i,ke,ve(i,it,e).call(i,t,s,a));return}i.emit(pe(lt,lt,bt));babelHelpers.classPrivateFieldSet(i,_e,true);babelHelpers.classPrivateFieldGet(i,ye).autocomplete(t,s).then(function(e){babelHelpers.classPrivateFieldSet(i,ke,null);ve(i,Ve,mt).call(i,e,s);i.emit(pe(lt,lt,ot));babelHelpers.classPrivateFieldSet(i,_e,false)},function(e){i.emit(pe(lt,lt,ot));babelHelpers.classPrivateFieldSet(i,_e,false);BX.debug(e)})},a)};function zt(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-address-container">\n\t\t\t\t<div class="location-map-address-icon"></div>\n\t\t\t\t',"\n\t\t\t</div>"]);zt=function t(){return e};return e}function _t(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-map-address-text">',"</div>"]);_t=function t(){return e};return e}function Ot(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var Lt=new WeakMap;var Dt=new WeakMap;var Bt=new WeakMap;var Nt=new WeakMap;var Xt=new WeakSet;var Rt=function(){function e(t){babelHelpers.classCallCheck(this,e);Xt.add(this);Lt.set(this,{writable:true,value:void 0});Dt.set(this,{writable:true,value:void 0});Bt.set(this,{writable:true,value:void 0});Nt.set(this,{writable:true,value:void 0});if(!(t.addressFormat instanceof l.Format)){throw new Error("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(this,Nt,t.addressFormat)}babelHelpers.createClass(e,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,Lt,t.address);var s=Ot(this,Xt,xt).call(this,babelHelpers.classPrivateFieldGet(this,Lt));babelHelpers.classPrivateFieldSet(this,Bt,d.Tag.render(_t(),s));babelHelpers.classPrivateFieldSet(this,Dt,d.Tag.render(zt(),babelHelpers.classPrivateFieldGet(this,Bt)));if(s===""){this.hide()}return babelHelpers.classPrivateFieldGet(this,Dt)}},{key:"show",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Dt)){babelHelpers.classPrivateFieldGet(this,Dt).style.display="block"}}},{key:"hide",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Dt)){babelHelpers.classPrivateFieldGet(this,Dt).style.display="none"}}},{key:"isHidden",value:function e(){return!babelHelpers.classPrivateFieldGet(this,Dt)||babelHelpers.classPrivateFieldGet(this,Dt).style.display==="none"}},{key:"address",set:function e(t){babelHelpers.classPrivateFieldSet(this,Lt,t);if(!babelHelpers.classPrivateFieldGet(this,Bt)){return}babelHelpers.classPrivateFieldGet(this,Bt).innerHTML=Ot(this,Xt,xt).call(this,t);if(!t&&!this.isHidden()){this.hide()}else if(t&&this.isHidden()){this.show()}}}]);return e}();var xt=function e(t){if(!t){return""}return t.toString(babelHelpers.classPrivateFieldGet(this,Nt),l.AddressStringConverter.STRATEGY_TYPE_FIELD_SORT)};function Ut(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var Yt=new WeakSet;var Vt=function(e){babelHelpers.inherits(t,e);function t(){var e;var s;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++){i[l]=arguments[l]}s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i)));Yt.add(babelHelpers.assertThisInitialized(s));return s}babelHelpers.createClass(t,[{key:"getBindElement",value:function e(){return this.bindElement}},{key:"adjustPosition",value:function e(s){var a,i;if(this.bindOptions.position&&this.bindOptions.position==="right"){a=true;i=Ut(this,Yt,jt).call(this)}if(!(a&&i)){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"adjustPosition",this).call(this,s)}}}]);return t}(a.Popup);var jt=function e(){var t=this.bindElement.getBoundingClientRect();var s=this.getPopupContainer().offsetHeight;var a=this.getPopupContainer().offsetWidth;if(t.left+t.width+a>document.documentElement.clientWidth){return false}var i=s/2;var l=t.left+t.width+10;var r=window.pageYOffset+t.top+t.height/2-s/2;if(r<window.pageYOffset){i-=window.pageYOffset-r;r=window.pageYOffset}else if(r>window.pageYOffset+document.body.clientHeight-s){i+=r-(window.pageYOffset+document.body.clientHeight-s);r=window.pageYOffset+document.body.clientHeight-s}this.setAngle({position:"left",offset:i});d.Dom.adjust(this.popupContainer,{style:{top:"".concat(r,"px"),left:"".concat(l,"px"),zIndex:this.getZindex()}});return true};function Kt(){var e=babelHelpers.taggedTemplateLiteral(['\t\t\t\t\n\t\t\t<div class="location-map-address-changed hidden">\n\t\t\t\t<div class="location-map-address-changed-inner">\n\t\t\t\t\t<div class="location-map-address-changed-title">\n\t\t\t\t\t\t',":\n\t\t\t\t\t</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t</div>"]);Kt=function t(){return e};return e}function qt(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<button type="button" class="location-map-address-changed-btn">\n\t\t\t\t',"\n\t\t\t</button>"]);qt=function t(){return e};return e}function Jt(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-address-changed-text">\n\t\t\t\t',"\n\t\t\t</div>"]);Jt=function t(){return e};return e}function $t(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function Zt(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var Qt=new WeakMap;var es=new WeakMap;var ts=new WeakMap;var ss=new WeakMap;var as=new WeakMap;var is=new WeakSet;var ls=new WeakSet;var rs=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));ls.add(babelHelpers.assertThisInitialized(s));is.add(babelHelpers.assertThisInitialized(s));Qt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});es.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ts.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ss.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});as.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.MapPopup.AddressRestorer");if(!(e.addressFormat instanceof l.Format)){throw new Error("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Qt,e.addressFormat);return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){this.address=t.address;babelHelpers.classPrivateFieldSet(this,ss,d.Tag.render(Jt(),Zt(this,ls,bs).call(this,babelHelpers.classPrivateFieldGet(this,es))));babelHelpers.classPrivateFieldSet(this,as,d.Tag.render(qt(),BX.message("LOCATION_WIDGET_AUI_ADDRESS_RESTORE")));babelHelpers.classPrivateFieldGet(this,as).addEventListener("click",Zt(this,is,ds).bind(this));babelHelpers.classPrivateFieldSet(this,ts,d.Tag.render(Kt(),BX.message("LOCATION_WIDGET_AUI_ADDRESS_CHANGED"),babelHelpers.classPrivateFieldGet(this,ss),babelHelpers.classPrivateFieldGet(this,as)));babelHelpers.classPrivateFieldGet(this,ts).style.display="none";return babelHelpers.classPrivateFieldGet(this,ts)}},{key:"show",value:function e(){if(babelHelpers.classPrivateFieldGet(this,ts)&&babelHelpers.classPrivateFieldGet(this,es)&&this.isHidden()){babelHelpers.classPrivateFieldGet(this,ts).style.display="flex";babelHelpers.classPrivateFieldGet(this,ts).classList.remove("hidden")}}},{key:"hide",value:function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,ts)&&!this.isHidden()){babelHelpers.classPrivateFieldGet(this,ts).classList.add("hidden");setTimeout(function(){babelHelpers.classPrivateFieldGet(t,ts).style.display="none"},600)}}},{key:"isHidden",value:function e(){var t=false;if(babelHelpers.classPrivateFieldGet(this,ts)){t=babelHelpers.classPrivateFieldGet(this,ts).classList.contains("hidden")}return t}},{key:"onRestoreEventSubscribe",value:function e(s){this.subscribe($t(t,t,ns),s)}},{key:"address",set:function e(t){babelHelpers.classPrivateFieldSet(this,es,t);if(!babelHelpers.classPrivateFieldGet(this,ss)||!babelHelpers.classPrivateFieldGet(this,es)){return}babelHelpers.classPrivateFieldGet(this,ss).innerHTML=Zt(this,ls,bs).call(this,babelHelpers.classPrivateFieldGet(this,es))}}]);return t}(n.EventEmitter);var ns={writable:true,value:"onRestore"};var ds=function e(t){this.emit($t(rs,rs,ns),{address:babelHelpers.classPrivateFieldGet(this,es)})};var bs=function e(t){if(!t){return""}return t.toString(babelHelpers.classPrivateFieldGet(this,Qt),l.AddressStringConverter.STRATEGY_TYPE_FIELD_SORT)};function os(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-wrapper">\n\t\t\t\t<div class="location-map-container">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>"]);os=function t(){return e};return e}function cs(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-map-inner"></div>']);cs=function t(){return e};return e}function us(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function ps(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var vs=new WeakMap;var hs=new WeakMap;var fs=new WeakMap;var Hs=new WeakMap;var Ps=new WeakMap;var Fs=new WeakMap;var gs=new WeakMap;var ms=new WeakMap;var ws=new WeakMap;var Ts=new WeakMap;var ys=new WeakMap;var Is=new WeakMap;var Gs=new WeakMap;var Ss=new WeakMap;var ks=new WeakMap;var Es=new WeakSet;var Cs=new WeakSet;var Ws=new WeakSet;var Ms=new WeakSet;var As=new WeakSet;var zs=new WeakSet;var _s=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));zs.add(babelHelpers.assertThisInitialized(s));As.add(babelHelpers.assertThisInitialized(s));Ms.add(babelHelpers.assertThisInitialized(s));Ws.add(babelHelpers.assertThisInitialized(s));Cs.add(babelHelpers.assertThisInitialized(s));Es.add(babelHelpers.assertThisInitialized(s));vs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});hs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});fs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Hs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ps.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Fs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});gs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ms.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ws.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ts.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});ys.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Is.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Gs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ss.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});ks.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.MapPopup");if(!(e.map instanceof l.MapBase)){BX.debug("map must be instance of Map")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),vs,e.map);if(e.geocodingService instanceof l.GeocodingServiceBase){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Is,e.geocodingService)}babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),vs).onLocationChangedEventSubscribe(ps(babelHelpers.assertThisInitialized(s),Es,Xs).bind(babelHelpers.assertThisInitialized(s)));if(!(e.popup instanceof Vt)){BX.debug("popup must be instance of Popup")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Hs,e.popup);if(!(e.addressFormat instanceof l.Format)){BX.debug("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),gs,e.addressFormat);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ps,new Rt({addressFormat:babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),gs)}));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Fs,new rs({addressFormat:babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),gs)}));babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Fs).onRestoreEventSubscribe(ps(babelHelpers.assertThisInitialized(s),Cs,Rs).bind(babelHelpers.assertThisInitialized(s)));if(e.gallery){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ms,e.gallery)}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ws,e.locationRepository);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ks,e.userLocation);return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,fs,t.address);babelHelpers.classPrivateFieldSet(this,Ss,true);babelHelpers.classPrivateFieldSet(this,hs,t.mode);babelHelpers.classPrivateFieldSet(this,Ts,false);babelHelpers.classPrivateFieldSet(this,ys,d.Tag.render(cs()));ps(this,Ws,xs).call(this,t.bindElement,babelHelpers.classPrivateFieldGet(this,ys))}},{key:"show",value:function e(){var s=this;ps(this,Ms,Us).call(this,babelHelpers.classPrivateFieldGet(this,fs)).then(function(e){if(!e){return}babelHelpers.classPrivateFieldGet(s,Hs).show();if(!babelHelpers.classPrivateFieldGet(s,Ts)){ps(s,zs,Vs).call(s,{location:e}).then(function(){if(babelHelpers.classPrivateFieldGet(s,ms)){babelHelpers.classPrivateFieldGet(s,ms).location=e}s.emit(us(t,t,Bs));babelHelpers.classPrivateFieldGet(s,vs).onMapShow()});babelHelpers.classPrivateFieldSet(s,Ts,true)}else{babelHelpers.classPrivateFieldGet(s,vs).location=e;if(babelHelpers.classPrivateFieldGet(s,ms)){babelHelpers.classPrivateFieldGet(s,ms).location=e}s.emit(us(t,t,Bs));babelHelpers.classPrivateFieldGet(s,vs).onMapShow()}})}},{key:"isShown",value:function e(){return babelHelpers.classPrivateFieldGet(this,Hs).isShown()}},{key:"close",value:function e(){babelHelpers.classPrivateFieldGet(this,Hs).close();babelHelpers.classPrivateFieldSet(this,Ss,false);if(!babelHelpers.classPrivateFieldGet(this,Fs).isHidden()){babelHelpers.classPrivateFieldGet(this,Fs).hide()}this.emit(us(t,t,Ns))}},{key:"onChangedEventSubscribe",value:function e(s){this.subscribe(us(t,t,Os),s)}},{key:"onMouseOverSubscribe",value:function e(s){this.subscribe(us(t,t,Ls),s)}},{key:"onMouseOutSubscribe",value:function e(s){this.subscribe(us(t,t,Ds),s)}},{key:"subscribeOnShowedEvent",value:function e(s){this.subscribe(us(t,t,Bs),s)}},{key:"subscribeOnClosedEvent",value:function e(s){this.subscribe(us(t,t,Ns),s)}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldSet(this,vs,null);babelHelpers.classPrivateFieldSet(this,ms,null);babelHelpers.classPrivateFieldSet(this,Ps,null);babelHelpers.classPrivateFieldSet(this,Fs,null);babelHelpers.classPrivateFieldGet(this,Hs).destroy();babelHelpers.classPrivateFieldSet(this,Hs,null);d.Dom.remove(babelHelpers.classPrivateFieldGet(this,Gs));babelHelpers.classPrivateFieldSet(this,Gs,null);d.Event.unbindAll(this)}},{key:"bindElement",get:function e(){return babelHelpers.classPrivateFieldGet(this,Hs).getBindElement()},set:function e(t){if(d.Type.isDomNode(t)){babelHelpers.classPrivateFieldGet(this,Hs).setBindElement(t)}else{BX.debug("bindElement must be type of dom node")}}},{key:"address",set:function e(t){var s=this;babelHelpers.classPrivateFieldSet(this,fs,t);babelHelpers.classPrivateFieldSet(this,Ss,true);babelHelpers.classPrivateFieldGet(this,Ps).address=t;babelHelpers.classPrivateFieldGet(this,Fs).address=t;ps(this,Ms,Us).call(this,t).then(function(e){ps(s,As,Ys).call(s,e)})}},{key:"mode",set:function e(t){babelHelpers.classPrivateFieldSet(this,hs,t);babelHelpers.classPrivateFieldGet(this,vs).mode=t}}]);return t}(n.EventEmitter);var Os={writable:true,value:"onChanged"};var Ls={writable:true,value:"onMouseOver"};var Ds={writable:true,value:"onMouseOut"};var Bs={writable:true,value:"onShow"};var Ns={writable:true,value:"onClose"};var Xs=function e(t){var s=t.getData(),a=s.location,i=a.toAddress();babelHelpers.classPrivateFieldSet(this,fs,i);babelHelpers.classPrivateFieldGet(this,Ps).address=i;if(babelHelpers.classPrivateFieldGet(this,Ss)){if(babelHelpers.classPrivateFieldGet(this,Fs).isHidden()){babelHelpers.classPrivateFieldGet(this,Fs).show()}}if(babelHelpers.classPrivateFieldGet(this,ms)){babelHelpers.classPrivateFieldGet(this,ms).location=a}this.emit(us(_s,_s,Os),{address:i})};var Rs=function e(t){var s=t.getData(),a=s.address;a.latitude=babelHelpers.classPrivateFieldGet(this,fs).latitude;a.longitude=babelHelpers.classPrivateFieldGet(this,fs).longitude;babelHelpers.classPrivateFieldSet(this,fs,a);babelHelpers.classPrivateFieldGet(this,Ps).address=a;babelHelpers.classPrivateFieldGet(this,Fs).hide();babelHelpers.classPrivateFieldSet(this,Ss,false);this.emit(us(_s,_s,Os),{address:a})};var xs=function e(t,s){var a=this;var i="";if(babelHelpers.classPrivateFieldGet(this,ms)){i=babelHelpers.classPrivateFieldGet(this,ms).render()}babelHelpers.classPrivateFieldSet(this,Gs,d.Tag.render(os(),s,i,babelHelpers.classPrivateFieldGet(this,hs)===l.ControlMode.edit?babelHelpers.classPrivateFieldGet(this,Ps).render({address:babelHelpers.classPrivateFieldGet(this,fs)}):"",babelHelpers.classPrivateFieldGet(this,hs)===l.ControlMode.edit?babelHelpers.classPrivateFieldGet(this,Fs).render({address:babelHelpers.classPrivateFieldGet(this,fs)}):""));d.Event.bind(babelHelpers.classPrivateFieldGet(this,Gs),"click",function(e){return e.stopPropagation()});d.Event.bind(babelHelpers.classPrivateFieldGet(this,Gs),"mouseover",function(e){return a.emit(us(_s,_s,Ls),e)});d.Event.bind(babelHelpers.classPrivateFieldGet(this,Gs),"mouseout",function(e){return a.emit(us(_s,_s,Ds),e)});this.bindElement=t;babelHelpers.classPrivateFieldGet(this,Hs).setContent(babelHelpers.classPrivateFieldGet(this,Gs))};var Us=function e(t){var s=this;return new Promise(function(e){if(t){var a;var i;if(t.latitude&&t.longitude){a=t.latitude;i=t.longitude}else if(t.location&&t.location.latitude&&t.location.longitude){a=t.location.latitude;i=t.location.longitude}if(a&&a!=="0"&&i&&i!=="0"){e(new l.Location({latitude:a,longitude:i,type:t.getType()}));return}var r=babelHelpers.classPrivateFieldGet(s,ks)&&babelHelpers.classPrivateFieldGet(s,hs)!==l.ControlMode.view?babelHelpers.classPrivateFieldGet(s,ks):null;if(babelHelpers.classPrivateFieldGet(s,Is)){var n=null;n=t.toString(babelHelpers.classPrivateFieldGet(s,gs),l.AddressStringConverter.STRATEGY_TYPE_FIELD_TYPE,l.AddressStringConverter.CONTENT_TYPE_TEXT);babelHelpers.classPrivateFieldGet(s,Is).geocode(n).then(function(t){if(t.length===1){r=t[0]}e(r)});return}}e(babelHelpers.classPrivateFieldGet(s,ks)&&babelHelpers.classPrivateFieldGet(s,hs)!==l.ControlMode.view?babelHelpers.classPrivateFieldGet(s,ks):null)})};var Ys=function e(t){babelHelpers.classPrivateFieldGet(this,vs).location=t;if(babelHelpers.classPrivateFieldGet(this,ms)){babelHelpers.classPrivateFieldGet(this,ms).location=t}};var Vs=function e(t){var s=t.location;return babelHelpers.classPrivateFieldGet(this,vs).render({mapContainer:babelHelpers.classPrivateFieldGet(this,ys),location:s,mode:babelHelpers.classPrivateFieldGet(this,hs)})};function js(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-photo-item-block">\n\t\t\t\t<span class="location-map-photo-item-block-image-block-inner">\n\t\t\t\t\t','\n\t\t\t\t\t<span \n\t\t\t\t\t\tdata-viewer data-viewer-type="image" \n\t\t\t\t\t\tdata-src="','" \n\t\t\t\t\t\tdata-title="','"\n\t\t\t\t\t\tclass="location-map-item-photo-image" \n\t\t\t\t\t\tdata-viewer-group-by="','"\n\t\t\t\t\t\tstyle="background-image: url(',');">\t\t\t\t\t\t\t\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>']);js=function t(){return e};return e}function Ks(){var e=babelHelpers.taggedTemplateLiteral(['<span class="location-map-item-description">',"</span>"]);Ks=function t(){return e};return e}var qs=new WeakMap;var Js=new WeakMap;var $s=new WeakMap;var Zs=new WeakMap;var Qs=new WeakMap;var ea=function(){function e(t){babelHelpers.classCallCheck(this,e);qs.set(this,{writable:true,value:void 0});Js.set(this,{writable:true,value:void 0});$s.set(this,{writable:true,value:void 0});Zs.set(this,{writable:true,value:void 0});Qs.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,Js,t.url);babelHelpers.classPrivateFieldSet(this,$s,t.link||"");babelHelpers.classPrivateFieldSet(this,qs,t.description||"");babelHelpers.classPrivateFieldSet(this,Zs,t.location);babelHelpers.classPrivateFieldSet(this,Qs,t.title||"")}babelHelpers.createClass(e,[{key:"render",value:function e(){var t="";if(babelHelpers.classPrivateFieldGet(this,qs)){t=d.Tag.render(Ks(),babelHelpers.classPrivateFieldGet(this,qs))}return d.Tag.render(js(),t,babelHelpers.classPrivateFieldGet(this,$s),babelHelpers.classPrivateFieldGet(this,Qs),babelHelpers.classPrivateFieldGet(this,Zs).externalId,babelHelpers.classPrivateFieldGet(this,Js))}}]);return e}();function ta(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=sa(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function sa(e,t){if(!e)return;if(typeof e==="string")return aa(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return aa(e,t)}function aa(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function ia(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-photo-container">\n\t\t\t\t',"\n\t\t\t</div>"]);ia=function t(){return e};return e}function la(){var e=babelHelpers.taggedTemplateLiteral(['\t\t\t\t\t\n\t\t\t\t<div class="location-map-photo-inner">\t\t\t\t\t\n\t\t\t\t</div>']);la=function t(){return e};return e}function ra(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var na=new WeakMap;var da=new WeakMap;var ba=new WeakMap;var oa=new WeakMap;var ca=new WeakMap;var ua=new WeakMap;var pa=new WeakMap;var va=new WeakMap;var ha=new WeakSet;var fa=new WeakSet;var Ha=function(){function e(t){babelHelpers.classCallCheck(this,e);fa.add(this);ha.add(this);na.set(this,{writable:true,value:[]});da.set(this,{writable:true,value:null});ba.set(this,{writable:true,value:null});oa.set(this,{writable:true,value:void 0});ca.set(this,{writable:true,value:void 0});ua.set(this,{writable:true,value:void 0});pa.set(this,{writable:true,value:void 0});va.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,oa,t.thumbnailHeight);babelHelpers.classPrivateFieldSet(this,ca,t.thumbnailWidth);babelHelpers.classPrivateFieldSet(this,pa,t.maxPhotoCount);babelHelpers.classPrivateFieldSet(this,ua,t.photoService)}babelHelpers.createClass(e,[{key:"refresh",value:function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,va)){babelHelpers.classPrivateFieldGet(this,ua).requestPhotos({location:babelHelpers.classPrivateFieldGet(this,va),thumbnailHeight:babelHelpers.classPrivateFieldGet(this,oa),thumbnailWidth:babelHelpers.classPrivateFieldGet(this,ca),maxPhotoCount:babelHelpers.classPrivateFieldGet(this,pa)}).then(function(e){if(Array.isArray(e)&&e.length>0){ra(t,ha,Pa).call(t,e);t.show()}else{t.hide()}})}else{this.hide()}}},{key:"hide",value:function e(){if(babelHelpers.classPrivateFieldGet(this,da)){babelHelpers.classPrivateFieldGet(this,da).style.display="none"}}},{key:"isHidden",value:function e(){return!babelHelpers.classPrivateFieldGet(this,da)||babelHelpers.classPrivateFieldGet(this,da).clientWidth<=0}},{key:"show",value:function e(){if(babelHelpers.classPrivateFieldGet(this,da)){babelHelpers.classPrivateFieldGet(this,da).style.display="block"}}},{key:"render",value:function e(){babelHelpers.classPrivateFieldSet(this,ba,d.Tag.render(la()));babelHelpers.classPrivateFieldSet(this,da,d.Tag.render(ia(),babelHelpers.classPrivateFieldGet(this,ba)));return babelHelpers.classPrivateFieldGet(this,da)}},{key:"location",set:function e(t){babelHelpers.classPrivateFieldSet(this,va,t);this.refresh()}}]);return e}();var Pa=function e(t){if(!babelHelpers.classPrivateFieldGet(this,va)){return}var s=[];var a=ta(t),i;try{for(a.s();!(i=a.n()).done;){var l=i.value;s.push(new ea({url:l.thumbnail.url,link:l.url,location:babelHelpers.classPrivateFieldGet(this,va),title:babelHelpers.classPrivateFieldGet(this,va).name+" ( "+BX.util.strip_tags(l.description)+" )"}))}}catch(e){a.e(e)}finally{a.f()}if(!Array.isArray(s)){BX.debug("Wrong type of photos. Must be array");return}babelHelpers.classPrivateFieldSet(this,na,[]);for(var r=0,n=s;r<n.length;r++){var d=n[r];babelHelpers.classPrivateFieldGet(this,na).push(d)}if(babelHelpers.classPrivateFieldGet(this,na).length>0&&babelHelpers.classPrivateFieldGet(this,ba)){var b=babelHelpers.classPrivateFieldGet(this,na)?ra(this,fa,Fa).call(this,babelHelpers.classPrivateFieldGet(this,na)):"";babelHelpers.classPrivateFieldGet(this,ba).innerHTML="";if(b.length>0){var o=ta(b),c;try{for(o.s();!(c=o.n()).done;){var u=c.value;babelHelpers.classPrivateFieldGet(this,ba).appendChild(u)}}catch(e){o.e(e)}finally{o.f()}}}};var Fa=function e(t){var s=[];var a=ta(t),i;try{for(a.s();!(i=a.n()).done;){var l=i.value;s.push(l.render())}}catch(e){a.e(e)}finally{a.f()}return s};function ga(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-title-6">\n\t\t\t\t',"\n\t\t\t</div>"]);ga=function t(){return e};return e}function ma(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-entity-editor-content-block">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t</div>"]);ma=function t(){return e};return e}function wa(){var e=babelHelpers.taggedTemplateLiteral(['<input type="text" class="ui-ctl-element" value="','">']);wa=function t(){return e};return e}function Ta(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-entity-editor-content-block ui-entity-editor-field-text">\n\t\t\t\t<div class="ui-entity-editor-block-title">\n\t\t\t\t\t<label class="ui-entity-editor-block-title-text">',":</label>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>"]);Ta=function t(){return e};return e}function ya(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}function Ia(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}var Ga=new WeakMap;var Sa=new WeakMap;var ka=new WeakMap;var Ea=new WeakMap;var Ca=new WeakMap;var Wa=new WeakMap;var Ma=new WeakMap;var Aa=new WeakMap;var za=new WeakMap;var _a=new WeakSet;var Oa=new WeakSet;var La=new WeakSet;var Da=new WeakSet;var Ba=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Da.add(babelHelpers.assertThisInitialized(s));La.add(babelHelpers.assertThisInitialized(s));Oa.add(babelHelpers.assertThisInitialized(s));_a.add(babelHelpers.assertThisInitialized(s));Ga.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Sa.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ka.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ea.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ca.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Wa.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ma.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Aa.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});za.set(babelHelpers.assertThisInitialized(s),{writable:true,value:b.INITIAL});s.setEventNamespace("BX.Location.Widget.Field");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ga,e.title);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ka,e.type);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ea,e.sort);return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,Sa,typeof t.value==="string"?t.value:"");if(!l.ControlMode.isValid(t.mode)){BX.debug("props.mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(this,Ca,t.mode);babelHelpers.classPrivateFieldSet(this,Aa,d.Tag.render(Ta(),babelHelpers.classPrivateFieldGet(this,Ga)));if(babelHelpers.classPrivateFieldGet(this,Ca)===l.ControlMode.edit){ya(this,Oa,xa).call(this,babelHelpers.classPrivateFieldGet(this,Aa))}else{ya(this,La,Ua).call(this,babelHelpers.classPrivateFieldGet(this,Aa))}return babelHelpers.classPrivateFieldGet(this,Aa)}},{key:"subscribeOnValueChangedEvent",value:function e(s){this.subscribe(Ia(t,t,Na),s)}},{key:"subscribeOnStateChangedEvent",value:function e(s){this.subscribe(Ia(t,t,Xa),s)}},{key:"destroy",value:function e(){d.Dom.remove(babelHelpers.classPrivateFieldGet(this,Aa));d.Event.unbindAll(this);babelHelpers.classPrivateFieldSet(this,Aa,null)}},{key:"container",get:function e(){return babelHelpers.classPrivateFieldGet(this,Aa)}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,za)}},{key:"type",set:function e(t){babelHelpers.classPrivateFieldSet(this,ka,t)},get:function e(){return babelHelpers.classPrivateFieldGet(this,ka)}},{key:"sort",set:function e(t){babelHelpers.classPrivateFieldSet(this,Ea,t)},get:function e(){return babelHelpers.classPrivateFieldGet(this,Ea)}},{key:"value",set:function e(t){babelHelpers.classPrivateFieldSet(this,Sa,typeof t==="string"?t:"");ya(this,Da,Ya).call(this)},get:function e(){return babelHelpers.classPrivateFieldGet(this,Sa)}}]);return t}(n.EventEmitter);var Na={writable:true,value:"onValueChanged"};var Xa={writable:true,value:"onStateChanged"};var Ra=function e(t){babelHelpers.classPrivateFieldSet(this,za,t);this.emit(Ia(Ba,Ba,Xa),{state:babelHelpers.classPrivateFieldGet(this,za)})};var xa=function e(t){var s=this;babelHelpers.classPrivateFieldSet(this,Wa,d.Tag.render(wa(),d.Text.encode(babelHelpers.classPrivateFieldGet(this,Sa))));babelHelpers.classPrivateFieldSet(this,Ma,null);d.Event.bind(babelHelpers.classPrivateFieldGet(this,Wa),"focus",function(e){ya(s,_a,Ra).call(s,b.DATA_INPUTTING)});d.Event.bind(babelHelpers.classPrivateFieldGet(this,Wa),"focusout",function(e){ya(s,_a,Ra).call(s,b.DATA_SELECTED)});d.Event.bind(babelHelpers.classPrivateFieldGet(this,Wa),"change",function(e){ya(s,_a,Ra).call(s,b.DATA_SELECTED);babelHelpers.classPrivateFieldSet(s,Sa,babelHelpers.classPrivateFieldGet(s,Wa).value);s.emit(Ia(Ba,Ba,Na),{value:s})});t.appendChild(d.Tag.render(ma(),babelHelpers.classPrivateFieldGet(this,Wa)))};var Ua=function e(t){babelHelpers.classPrivateFieldSet(this,Wa,null);babelHelpers.classPrivateFieldSet(this,Ma,d.Tag.render(ga(),d.Text.encode(babelHelpers.classPrivateFieldGet(this,Sa))));t.appendChild(babelHelpers.classPrivateFieldGet(this,Ma))};var Ya=function e(){if(babelHelpers.classPrivateFieldGet(this,Ca)===l.ControlMode.edit){babelHelpers.classPrivateFieldGet(this,Wa).value=babelHelpers.classPrivateFieldGet(this,Sa)}else{babelHelpers.classPrivateFieldGet(this,Ma).innerHTML=d.Text.encode(babelHelpers.classPrivateFieldGet(this,Sa))}};function Va(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=ja(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function ja(e,t){if(!e)return;if(typeof e==="string")return Ka(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Ka(e,t)}function Ka(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function qa(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function Ja(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var $a=new WeakMap;var Za=new WeakMap;var Qa=new WeakMap;var ei=new WeakMap;var ti=new WeakMap;var si=new WeakMap;var ai=new WeakMap;var ii=new WeakSet;var li=new WeakSet;var ri=new WeakSet;var ni=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));ri.add(babelHelpers.assertThisInitialized(s));li.add(babelHelpers.assertThisInitialized(s));ii.add(babelHelpers.assertThisInitialized(s));$a.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Za.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Qa.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ei.set(babelHelpers.assertThisInitialized(s),{writable:true,value:[]});ti.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});si.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ai.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.Fields");if(!(e.addressFormat instanceof l.Format)){BX.debug("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Za,e.addressFormat);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ti,e.languageId);Ja(babelHelpers.assertThisInitialized(s),ii,oi).call(babelHelpers.assertThisInitialized(s));return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){if(t.address&&!(t.address instanceof l.Address)){BX.debug("props.address must be instance of Address")}babelHelpers.classPrivateFieldSet(this,$a,t.address);if(!l.ControlMode.isValid(t.mode)){BX.debug("props.mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(this,Qa,t.mode);if(!d.Type.isDomNode(t.container)){BX.debug("props.container must be dom node")}babelHelpers.classPrivateFieldSet(this,si,t.container);var s=Va(babelHelpers.classPrivateFieldGet(this,ei)),a;try{for(s.s();!(a=s.n()).done;){var i=a.value;var r=babelHelpers.classPrivateFieldGet(this,$a)?babelHelpers.classPrivateFieldGet(this,$a).getFieldValue(i.type):"";if(babelHelpers.classPrivateFieldGet(this,Qa)===l.ControlMode.view&&!r){continue}var n=i.render({value:r,mode:babelHelpers.classPrivateFieldGet(this,Qa)});babelHelpers.classPrivateFieldGet(this,si).appendChild(n)}}catch(e){s.e(e)}finally{s.f()}}},{key:"subscribeOnAddressChangedEvent",value:function e(s){this.subscribe(qa(t,t,di),s)}},{key:"destroy",value:function e(){d.Event.unbindAll(this);var t=Va(babelHelpers.classPrivateFieldGet(this,ei)),s;try{for(t.s();!(s=t.n()).done;){var a=s.value;a.destroy()}}catch(e){t.e(e)}finally{t.f()}d.Dom.clean(babelHelpers.classPrivateFieldGet(this,si))}},{key:"subscribeOnStateChangedEvent",value:function e(s){this.subscribe(qa(t,t,bi),s)}},{key:"address",set:function e(t){if(t&&!(t instanceof l.Address)){BX.debug("address must be instance of Address")}babelHelpers.classPrivateFieldSet(this,$a,t);var s=Va(babelHelpers.classPrivateFieldGet(this,ei)),a;try{for(s.s();!(a=s.n()).done;){var i=a.value;i.value=babelHelpers.classPrivateFieldGet(this,$a)?babelHelpers.classPrivateFieldGet(this,$a).getFieldValue(i.type):""}}catch(e){s.e(e)}finally{s.f()}}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,ai)}}]);return t}(n.EventEmitter);var di={writable:true,value:"onAddressChanged"};var bi={writable:true,value:"onStateChanged"};var oi=function e(){var t=this;var s=function e(s){if(!babelHelpers.classPrivateFieldGet(t,Za).fieldCollection.fields.hasOwnProperty(s)){return"continue"}var a=babelHelpers.classPrivateFieldGet(t,Za).fieldCollection.fields[s];var i=new Ba({title:a.name,type:a.type,sort:a.sort});i.subscribeOnValueChangedEvent(function(e){Ja(t,li,ci).call(t,i)});i.subscribeOnStateChangedEvent(function(e){var s=e.getData();Ja(t,ri,ui).call(t,s.state)});babelHelpers.classPrivateFieldGet(t,ei).push(i)};for(var a in babelHelpers.classPrivateFieldGet(this,Za).fieldCollection.fields){var i=s(a);if(i==="continue")continue}babelHelpers.classPrivateFieldGet(this,ei).sort(function(e,t){return e.sort-t.sort})};var ci=function e(t){if(!babelHelpers.classPrivateFieldGet(this,$a)){babelHelpers.classPrivateFieldSet(this,$a,new l.Address({languageId:babelHelpers.classPrivateFieldGet(this,ti)}))}babelHelpers.classPrivateFieldGet(this,$a).setFieldValue(t.type,t.value);if(t.type!==babelHelpers.classPrivateFieldGet(this,Za).fieldForUnRecognized){babelHelpers.classPrivateFieldGet(this,$a).location=null;babelHelpers.classPrivateFieldGet(this,$a).latitude="";babelHelpers.classPrivateFieldGet(this,$a).longitude=""}this.emit(qa(ni,ni,di),{address:babelHelpers.classPrivateFieldGet(this,$a),changedField:t})};var ui=function e(t){babelHelpers.classPrivateFieldSet(this,ai,t);this.emit(qa(ni,ni,bi),{state:babelHelpers.classPrivateFieldGet(this,ai)})};var pi=new WeakMap;var vi=new WeakMap;var hi=new WeakMap;var fi=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));pi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});vi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});hi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});if(!(e.map instanceof _s)){BX.debug("props.map must be instance of MapPopup")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),pi,e.map);babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),pi).onChangedEventSubscribe(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),hi).setAddressByFeature(t.address,babelHelpers.assertThisInitialized(s))});return s}babelHelpers.createClass(t,[{key:"showMap",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,pi).isShown()){babelHelpers.classPrivateFieldGet(this,pi).show()}}},{key:"closeMap",value:function e(){if(babelHelpers.classPrivateFieldGet(this,pi).isShown()){babelHelpers.classPrivateFieldGet(this,pi).close()}babelHelpers.classPrivateFieldGet(this,pi).bindelement=babelHelpers.classPrivateFieldGet(this,vi)}},{key:"resetView",value:function e(){this.closeMap()}},{key:"render",value:function e(t){if(!d.Type.isDomNode(t.mapBindElement)){BX.debug("props.mapBindElement  must be instance of Element")}babelHelpers.classPrivateFieldSet(this,vi,t.mapBindElement);babelHelpers.classPrivateFieldGet(this,pi).render({bindElement:t.mapBindElement,address:babelHelpers.classPrivateFieldGet(this,hi).address,mode:babelHelpers.classPrivateFieldGet(this,hi).mode})}},{key:"setAddress",value:function e(t){if(this.addressWidget.state===b.DATA_INPUTTING){return}babelHelpers.classPrivateFieldGet(this,pi).address=t}},{key:"setAddressWidget",value:function e(t){babelHelpers.classPrivateFieldSet(this,hi,t)}},{key:"setMode",value:function e(t){babelHelpers.classPrivateFieldGet(this,pi).mode=t}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldGet(this,pi).destroy();babelHelpers.classPrivateFieldSet(this,pi,null)}},{key:"map",get:function e(){return babelHelpers.classPrivateFieldGet(this,pi)}},{key:"addressWidget",get:function e(){return babelHelpers.classPrivateFieldGet(this,hi)}},{key:"mapBindElement",get:function e(){return babelHelpers.classPrivateFieldGet(this,vi)}}]);return t}(o);var Hi=new WeakMap;var Pi=new WeakMap;var Fi=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));Hi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Pi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});if(!(e.autocomplete instanceof lt)){BX.debug("props.autocomplete  must be instance of Autocomplete")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Hi,e.autocomplete);babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Hi).onAddressChangedEventSubscribe(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Pi).setAddressByFeature(t.address,babelHelpers.assertThisInitialized(s),t.excludeSetAddressFeatures)});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Hi).onStateChangedEventSubscribe(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Pi).setStateByFeature(t.state)});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Hi).onSearchStartedEventSubscribe(function(e){var a=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Pi).emitFeatureEvent({feature:babelHelpers.assertThisInitialized(s),eventCode:t.searchStartedEvent,payload:a})});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Hi).onSearchCompletedEventSubscribe(function(e){var a=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Pi).emitFeatureEvent({feature:babelHelpers.assertThisInitialized(s),eventCode:t.searchCompletedEvent,payload:a})});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Hi).onShowOnMapClickedEventSubscribe(function(e){var a=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Pi).emitFeatureEvent({feature:babelHelpers.assertThisInitialized(s),eventCode:t.showOnMapClickedEvent,payload:a})});return s}babelHelpers.createClass(t,[{key:"resetView",value:function e(){babelHelpers.classPrivateFieldGet(this,Hi).closePrompt()}},{key:"render",value:function e(t){if(babelHelpers.classPrivateFieldGet(this,Pi).mode===l.ControlMode.edit){babelHelpers.classPrivateFieldGet(this,Hi).render({inputNode:babelHelpers.classPrivateFieldGet(this,Pi).inputNode,menuNode:t.autocompleteMenuElement,address:babelHelpers.classPrivateFieldGet(this,Pi).address,mode:babelHelpers.classPrivateFieldGet(this,Pi).mode})}}},{key:"setAddress",value:function e(t){babelHelpers.classPrivateFieldGet(this,Hi).address=t}},{key:"setAddressWidget",value:function e(t){babelHelpers.classPrivateFieldSet(this,Pi,t)}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldGet(this,Hi).destroy();babelHelpers.classPrivateFieldSet(this,Hi,null)}}]);return t}(o);babelHelpers.defineProperty(Fi,"searchStartedEvent","searchStarted");babelHelpers.defineProperty(Fi,"searchCompletedEvent","searchCompleted");babelHelpers.defineProperty(Fi,"showOnMapClickedEvent","showOnMapClicked");var gi=new WeakMap;var mi=new WeakMap;var wi=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));gi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});mi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});if(!(e.fields instanceof ni)){BX.debug("props.Fields must be instance of Fields")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),gi,e.fields);babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),gi).subscribeOnAddressChangedEvent(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),mi).setAddressByFeature(t.address,babelHelpers.assertThisInitialized(s))});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),gi).subscribeOnStateChangedEvent(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),mi).setStateByFeature(t.state)});return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){if(babelHelpers.classPrivateFieldGet(this,mi).mode===l.ControlMode.edit){if(!d.Type.isDomNode(t.fieldsContainer)){BX.debug("props.fieldsContainer  must be instance of Element")}babelHelpers.classPrivateFieldGet(this,gi).render({address:babelHelpers.classPrivateFieldGet(this,mi).address,mode:babelHelpers.classPrivateFieldGet(this,mi).mode,container:t.fieldsContainer})}}},{key:"setAddressWidget",value:function e(t){babelHelpers.classPrivateFieldSet(this,mi,t)}},{key:"setAddress",value:function e(t){babelHelpers.classPrivateFieldGet(this,gi).address=t}},{key:"setMode",value:function e(t){babelHelpers.classPrivateFieldGet(this,gi).mode=t}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldGet(this,gi).destroy();babelHelpers.classPrivateFieldSet(this,gi,null)}}]);return t}(o);function Ti(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var yi=new WeakMap;var Ii=new WeakMap;var Gi=new WeakMap;var Si=new WeakMap;var ki=new WeakMap;var Ei=new WeakMap;var Ci=new WeakSet;var Wi=new WeakSet;var Mi=new WeakSet;var Ai=new WeakSet;var zi=function(e){babelHelpers.inherits(t,e);function t(){var e;var s;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++){i[l]=arguments[l]}s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i)));Ai.add(babelHelpers.assertThisInitialized(s));Mi.add(babelHelpers.assertThisInitialized(s));Wi.add(babelHelpers.assertThisInitialized(s));Ci.add(babelHelpers.assertThisInitialized(s));yi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});Ii.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Gi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:700});Si.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});ki.set(babelHelpers.assertThisInitialized(s),{writable:true,value:800});Ei.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});return s}babelHelpers.createClass(t,[{key:"render",value:function e(s){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"render",this).call(this,s);this.addressWidget.controlWrapper.addEventListener("click",Ti(this,Ci,_i).bind(this));this.addressWidget.controlWrapper.addEventListener("mouseover",Ti(this,Mi,Li).bind(this));this.addressWidget.controlWrapper.addEventListener("mouseout",Ti(this,Ai,Di).bind(this));document.addEventListener("click",Ti(this,Wi,Oi).bind(this));this.map.onMouseOverSubscribe(Ti(this,Mi,Li).bind(this));this.map.onMouseOutSubscribe(Ti(this,Ai,Di).bind(this))}},{key:"setAddress",value:function e(t){if(this.addressWidget.state===b.DATA_INPUTTING){this.closeMap();return}if(!t){this.closeMap()}this.map.address=t;if(t&&this.addressWidget.state!==b.DATA_SUPPOSED){this.showMap()}}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Ei)){return}document.removeEventListener("click",Ti(this,Wi,Oi));if(this.addressWidget.controlWrapper){this.addressWidget.controlWrapper.removeEventListener("click",Ti(this,Ci,_i));this.addressWidget.controlWrapper.removeEventListener("mouseover",Ti(this,Mi,Li));this.addressWidget.controlWrapper.removeEventListener("mouseout",Ti(this,Ai,Di))}babelHelpers.classPrivateFieldSet(this,Ii,null);babelHelpers.classPrivateFieldSet(this,Si,null);babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",this).call(this);babelHelpers.classPrivateFieldSet(this,Ei,true)}}]);return t}(fi);var _i=function e(t){if(babelHelpers.classPrivateFieldGet(this,Ei)){return}if(this.addressWidget.mode===l.ControlMode.view){if(this.map.isShown()){this.closeMap()}else{clearTimeout(babelHelpers.classPrivateFieldGet(this,Ii))}}else{if(this.addressWidget.address&&!this.map.isShown()&&t.target===this.addressWidget.inputNode){this.showMap()}}};var Oi=function e(t){if(babelHelpers.classPrivateFieldGet(this,Ei)){return}if(this.addressWidget.inputNode!==t.target){this.closeMap()}};var Li=function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Ei)){return}clearTimeout(babelHelpers.classPrivateFieldGet(this,Ii));clearTimeout(babelHelpers.classPrivateFieldGet(this,Si));if(this.addressWidget.mode!==l.ControlMode.view){return}if(this.addressWidget.address&&!this.map.isShown()){babelHelpers.classPrivateFieldSet(this,Ii,setTimeout(function(){t.showMap()},babelHelpers.classPrivateFieldGet(this,Gi)))}};var Di=function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Ei)){return}clearTimeout(babelHelpers.classPrivateFieldGet(this,Ii));clearTimeout(babelHelpers.classPrivateFieldGet(this,Si));if(this.addressWidget.mode!==l.ControlMode.view){return}if(this.addressWidget.mode===l.ControlMode.view&&this.map.isShown()){babelHelpers.classPrivateFieldSet(this,Si,setTimeout(function(){t.closeMap()},babelHelpers.classPrivateFieldGet(this,ki)))}};var Bi=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"createAddressWidget",value:function e(t){var s=t.sourceCode||BX.message("LOCATION_WIDGET_SOURCE_CODE");var a=t.sourceParams||BX.message("LOCATION_WIDGET_SOURCE_PARAMS");var i=t.languageId||BX.message("LOCATION_WIDGET_LANGUAGE_ID");var r=t.sourceLanguageId||BX.message("LOCATION_WIDGET_SOURCE_LANGUAGE_ID");var n=new l.Location(JSON.parse(BX.message("LOCATION_WIDGET_USER_LOCATION")));var d=t.addressFormat||new l.Format(JSON.parse(BX.message("LOCATION_WIDGET_DEFAULT_FORMAT")));var b=t.presetLocationsProvider?t.presetLocationsProvider:function(){return t.presetLocationList?t.presetLocationList:[]};var o=[];if(!t.useFeatures||t.useFeatures.fields!==false){o.push(this.createFieldsFeature({addressFormat:d,languageId:i}))}var c=null;if(s&&a){try{c=this.createSource(s,a,i,r)}catch(e){if(e instanceof l.SourceCreationError){c=null}else{throw e}}}var u=null;if(c){if(!t.useFeatures||t.useFeatures.autocomplete!==false){o.push(this.createAutocompleteFeature({languageId:i,addressFormat:d,source:c,userLocation:n,presetLocationsProvider:b}))}if(!t.useFeatures||t.useFeatures.map!==false){var p=!!a.showPhotos;var v=!!a.useGeocodingService;var h=80;var f=150;var H=p?5:0;var P="auto";u=this.createMapFeature({addressFormat:d,source:c,useGeocodingService:v,popupOptions:t.popupOptions,popupBindOptions:t.popupBindOptions,thumbnailHeight:t.thumbnailHeight||h,thumbnailWidth:t.thumbnailWidth||f,maxPhotoCount:t.maxPhotoCount||H,mapBehavior:t.mapBehavior||P,userLocation:n});o.push(u)}}var F=new L({features:o,address:t.address,mode:t.mode,addressFormat:d,languageId:i});if(u){F.subscribeOnFeatureEvent(function(e){var t=e.getData();if(t.feature instanceof Fi&&t.eventCode===Fi.showOnMapClickedEvent){u.showMap()}})}return F}},{key:"createFieldsFeature",value:function e(t){var s=new ni({addressFormat:t.addressFormat,languageId:t.languageId});return new wi({fields:s})}},{key:"createAutocompleteFeature",value:function e(t){var s=new lt({sourceCode:t.source.sourceCode,languageId:t.languageId,addressFormat:t.addressFormat,autocompleteService:t.source.autocompleteService,userLocation:t.userLocation,presetLocationsProvider:t.presetLocationsProvider});return new Fi({autocomplete:s})}},{key:"createMapFeature",value:function e(t){var s={cacheable:true,closeByEsc:true,className:"location-popup-window location-source-".concat(t.source.sourceCode),animation:"fading",angle:true,bindOptions:t.popupBindOptions};if(t.popupOptions){s=Object.assign(s,t.popupOptions)}var a=new Vt(s);var i=null;if(t.maxPhotoCount>0){i=new Ha({photoService:t.source.photoService,thumbnailHeight:t.thumbnailHeight,thumbnailWidth:t.thumbnailWidth,maxPhotoCount:t.maxPhotoCount})}var r={map:new _s({addressFormat:t.addressFormat,map:t.source.map,popup:a,gallery:i,locationRepository:new l.LocationRepository,geocodingService:t.useGeocodingService?t.source.geocodingService:null,userLocation:t.userLocation})};var n;if(t.mapBehavior==="manual"){n=new fi(r)}else{n=new zi(r)}return n}},{key:"createSource",value:function e(a,i,l,r){var n=null;i.languageId=l;i.sourceLanguageId=r;if(a==="GOOGLE"){n=new s.Google(i)}else if(a==="OSM"){n=t.OSMFactory.createOSMSource(i)}else{throw new RangeError("Wrong source code")}return n}}]);return e}();function Ni(){var e=babelHelpers.taggedTemplateLiteral(['\t\t\t\n\t\t\t<span class="ui-link ui-link-secondary ui-entity-editor-block-title-link">\n\t\t\t\t',"\n\t\t\t</span>"]);Ni=function t(){return e};return e}function Xi(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function Ri(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var xi=new WeakMap;var Ui=new WeakMap;var Yi=new WeakMap;var Vi=new WeakSet;var ji=function(e){babelHelpers.inherits(t,e);function t(){var e;var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));Vi.add(babelHelpers.assertThisInitialized(e));xi.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});Ui.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});Yi.set(babelHelpers.assertThisInitialized(e),{writable:true,value:["on","off"]});e.setEventNamespace("BX.Location.Widget.Switch");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),xi,s.state);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),Yi,s.titles);return e}babelHelpers.createClass(t,[{key:"render",value:function e(s){var a=this;babelHelpers.classPrivateFieldSet(this,Ui,d.Tag.render(Ni(),Ri(this,Vi,qi).call(this)));babelHelpers.classPrivateFieldGet(this,Ui).addEventListener("click",function(e){a.state=babelHelpers.classPrivateFieldGet(a,xi)===t.STATE_OFF?t.STATE_ON:t.STATE_OFF;a.emit(Xi(t,t,Ki),{state:babelHelpers.classPrivateFieldGet(a,xi)});e.stopPropagation();return false});babelHelpers.classPrivateFieldGet(this,Ui).addEventListener("mouseover",function(e){e.stopPropagation()});return babelHelpers.classPrivateFieldGet(this,Ui)}},{key:"subscribeOnToggleEventSubscribe",value:function e(s){this.subscribe(Xi(t,t,Ki),s)}},{key:"state",set:function e(t){babelHelpers.classPrivateFieldSet(this,xi,t);if(babelHelpers.classPrivateFieldGet(this,Ui)){babelHelpers.classPrivateFieldGet(this,Ui).innerHTML=Ri(this,Vi,qi).call(this)}},get:function e(){return babelHelpers.classPrivateFieldGet(this,xi)}}]);return t}(n.EventEmitter);babelHelpers.defineProperty(ji,"STATE_OFF",0);babelHelpers.defineProperty(ji,"STATE_ON",1);var Ki={writable:true,value:"onToggleEvent"};var qi=function e(){return babelHelpers.classPrivateFieldGet(this,Yi)[babelHelpers.classPrivateFieldGet(this,xi)]};function Ji(){var e=babelHelpers.taggedTemplateLiteral(['<div class="','"></div>']);Ji=function t(){return e};return e}function $i(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function Zi(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var Qi=new WeakMap;var el=new WeakMap;var tl=new WeakSet;var sl=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));tl.add(babelHelpers.assertThisInitialized(e));Qi.set(babelHelpers.assertThisInitialized(e),{writable:true,value:t.TYPE_SEARCH});el.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});e.setEventNamespace("BX.Location.Widget.Icon");return e}babelHelpers.createClass(t,[{key:"render",value:function e(s){var a=this;babelHelpers.classPrivateFieldSet(this,Qi,s.type);babelHelpers.classPrivateFieldSet(this,el,d.Tag.render(Ji(),Zi(this,tl,il).call(this,babelHelpers.classPrivateFieldGet(this,Qi))));babelHelpers.classPrivateFieldGet(this,el).addEventListener("click",function(e){a.emit($i(t,t,al))});return babelHelpers.classPrivateFieldGet(this,el)}},{key:"subscribeOnClickEvent",value:function e(s){this.subscribe($i(t,t,al),s)}},{key:"type",set:function e(t){babelHelpers.classPrivateFieldSet(this,Qi,t);if(babelHelpers.classPrivateFieldGet(this,el)){babelHelpers.classPrivateFieldGet(this,el).className=Zi(this,tl,il).call(this,babelHelpers.classPrivateFieldGet(this,Qi))}}}]);return t}(n.EventEmitter);var al={writable:true,value:"onClick"};babelHelpers.defineProperty(sl,"TYPE_CLEAR","clear");babelHelpers.defineProperty(sl,"TYPE_SEARCH","search");babelHelpers.defineProperty(sl,"TYPE_LOADER","loader");var il=function e(t){var s="";if(t===sl.TYPE_CLEAR){s="ui-ctl-after ui-ctl-icon-btn ui-ctl-icon-clear"}else if(t===sl.TYPE_SEARCH){s="ui-ctl-after ui-ctl-icon-search"}else if(t===sl.TYPE_LOADER){s="ui-ctl-after ui-ctl-icon-loader"}else{BX.debug("Wrong icon type")}return s};function ll(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-search-control-block">\n\t\t\t\t\t',"\n\t\t\t\t</div>"]);ll=function t(){return e};return e}function rl(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="location-search-control-block">\n\t\t\t\t\t\t<div class="ui-entity-editor-content-block-text">\n\t\t\t\t\t\t\t',"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"]);rl=function t(){return e};return e}function nl(){var e=babelHelpers.taggedTemplateLiteral(['<span class="ui-link ui-link-dark ui-link-dotted">',"</span>"]);nl=function t(){return e};return e}function dl(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-fields-control-block"></div>']);dl=function t(){return e};return e}function bl(){var e=babelHelpers.taggedTemplateLiteral(['\t\t\t\t\t\t    \n\t\t\t\t<div class="location-search-control-block">\t\t\t\t\t\n\t\t\t\t\t',"\n\t\t\t\t</div>"]);bl=function t(){return e};return e}function ol(){var e=babelHelpers.taggedTemplateLiteral(["",""]);ol=function t(){return e};return e}function cl(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl ui-ctl-w100 ui-ctl-after-icon">',"","","</div>"]);cl=function t(){return e};return e}function ul(){var e=babelHelpers.taggedTemplateLiteral(["<input value='",'\' type="hidden" name="','">']);ul=function t(){return e};return e}function pl(){var e=babelHelpers.taggedTemplateLiteral(['<input class="ui-ctl-element ui-ctl-textbox" value="" type="text" autocomplete="off" name="','">']);pl=function t(){return e};return e}function vl(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}return s}function hl(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var fl=new WeakSet;var Hl=new WeakSet;var Pl=new WeakSet;var Fl=new WeakSet;var gl=new WeakSet;var ml=new WeakSet;var wl=new WeakSet;var Tl=new WeakSet;var yl=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Tl.add(babelHelpers.assertThisInitialized(s));wl.add(babelHelpers.assertThisInitialized(s));ml.add(babelHelpers.assertThisInitialized(s));gl.add(babelHelpers.assertThisInitialized(s));Fl.add(babelHelpers.assertThisInitialized(s));Pl.add(babelHelpers.assertThisInitialized(s));Hl.add(babelHelpers.assertThisInitialized(s));fl.add(babelHelpers.assertThisInitialized(s));s._input=null;s._inputIcon=null;s._hiddenInput=null;s._innerWrapper=null;s._addressWidget=null;s._addressFieldsContainer=null;return s}babelHelpers.createClass(t,[{key:"initialize",value:function e(s,a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initialize",this).call(this,s,a);var i=this.getValue();var r=null;if(d.Type.isStringFilled(i)){try{r=new l.Address(JSON.parse(i))}catch(e){BX.debug("Cant parse address value");return}}var n=new Bi;this._addressWidget=n.createAddressWidget({address:r,mode:this._mode===BX.UI.EntityEditorMode.edit?l.ControlMode.edit:l.ControlMode.view,popupBindOptions:{position:"right"}});this._addressWidget.subscribeOnStateChangedEvent(hl(this,gl,Cl).bind(this));this._addressWidget.subscribeOnAddressChangedEvent(hl(this,ml,Wl).bind(this));this._fieldsSwitch=new ji({state:ji.STATE_OFF,titles:[BX.message("LOCATION_WIDGET_AUI_MORE"),BX.message("LOCATION_WIDGET_AUI_BRIEFLY")]});this._fieldsSwitch.subscribeOnToggleEventSubscribe(hl(this,Hl,Sl).bind(this))}},{key:"focus",value:function e(){if(!this._input){return}BX.focus(this._input);BX.UI.EditorTextHelper.getCurrent().setPositionAtEnd(this._input)}},{key:"getModeSwitchType",value:function e(t){var s=BX.UI.EntityEditorModeSwitchType.common;if(t===BX.UI.EntityEditorMode.edit){s|=BX.UI.EntityEditorModeSwitchType.button|BX.UI.EntityEditorModeSwitchType.content}return s}},{key:"doSetMode",value:function e(t){this._addressWidget.mode=t===BX.UI.EntityEditorMode.edit?l.ControlMode.edit:l.ControlMode.view;this._fieldsSwitch.state=ji.STATE_OFF}},{key:"getContentWrapper",value:function e(){return this._innerWrapper}},{key:"save",value:function e(){if(!this.isEditable()){return}var t=hl(this,Tl,Al).call(this);this._model.setField(this.getName(),t?t.toJson():"");this._addressWidget.resetView()}},{key:"showError",value:function e(s,a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"showError",this).apply(this,[s,a]);if(this._input){BX.addClass(this._inputContainer,"ui-ctl-danger")}}},{key:"clearError",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"clearError",this).apply(this);if(this._input){BX.removeClass(this._inputContainer,"ui-ctl-danger")}}},{key:"doClearLayout",value:function e(t){this._input=null;this._innerWrapper=null;this._inputContainer=null;this._addressFieldsContainer=null;this._inputIcon=null;this._hiddenInput=null;d.Dom.clean(this._innerWrapper)}},{key:"validate",value:function e(t){if(!(this._mode===BX.UI.EntityEditorMode.edit&&this._input)){throw Error("BX.Location.UIAddress. Invalid validation context")}this.clearError();if(this.hasValidators()){return this.executeValidators(t)}var s=!this.isRequired()||BX.util.trim(this._input.value)!=="";if(!s){t.addError(BX.UI.EntityValidationError.create({field:this}));this.showRequiredFieldError(this._input)}return s}},{key:"getRuntimeValue",value:function e(){return this._mode===BX.UI.EntityEditorMode.edit?hl(this,Tl,Al).call(this):null}},{key:"layout",value:function e(s){if(this._hasLayout){return}this.ensureWrapperCreated({classNames:["ui-entity-card-content-block-field-phone"]});this.adjustWrapper();var a=this.getTitle();if(this.isDragEnabled()){this._wrapper.appendChild(this.createDragButton())}var i={};if(this._mode===BX.UI.EntityEditorMode.edit){this._wrapper.appendChild(this.createTitleNode(a));this._input=d.Tag.render(pl(),"".concat(this.getName(),"_STRING"));this._hiddenInput=d.Tag.render(ul(),this.getValue(),this.getName());this._inputIcon=new sl;this._inputIcon.subscribeOnClickEvent(hl(this,fl,Gl).bind(this));var l=this._inputIcon.render({type:vl(t,t,Il).call(t,hl(this,Tl,Al).call(this))});this._inputContainer=d.Tag.render(cl(),l,this._input,this._hiddenInput);this._titleWrapper.appendChild(d.Tag.render(ol(),this._fieldsSwitch.render(this._mode)));this._innerWrapper=d.Tag.render(bl(),this._inputContainer);i.inputNode=this._input;i.mapBindElement=l;this._addressFieldsContainer=d.Tag.render(dl());if(this._fieldsSwitch.state===ji.STATE_ON){this._addressFieldsContainer.classList.add("visible")}i.fieldsContainer=this._addressFieldsContainer;this._innerWrapper.appendChild(this._addressFieldsContainer)}else{this._wrapper.appendChild(this.createTitleNode(a));var r;if(this.hasContentToDisplay()){var n=hl(this,wl,Ml).call(this,hl(this,Tl,Al).call(this));r=d.Tag.render(nl(),n);this._innerWrapper=d.Tag.render(rl(),r);i.mapBindElement=r}else{this._innerWrapper=d.Tag.render(ll(),BX.message("UI_ENTITY_EDITOR_FIELD_EMPTY"));i.mapBindElement=this._innerWrapper}}i.controlWrapper=this._innerWrapper;this._addressWidget.render(i);this._wrapper.appendChild(this._innerWrapper);this._addressWidget.subscribeOnErrorEvent(this.errorListener.bind(this));if(this.isContextMenuEnabled()){this._wrapper.appendChild(this.createContextMenuButton())}if(this.isDragEnabled()){this.initializeDragDropAbilities()}this.registerLayout(s);this._hasLayout=true}},{key:"errorListener",value:function e(t){var s=this;var a=t.getData();var i=a.errors;if(this._inputIcon){this._inputIcon.type=sl.TYPE_CLEAR}if(!d.Type.isArray(i)){return}i.forEach(function(e){var t;if(e.message){t=e.message}else{t=BX.message("LOCATION_WIDGET_AUI_UNKNOWN_ERROR")}if(e.code){t+=" [".concat(e.code,"]")}s.showError(t)})}},{key:"processModelChange",value:function e(t){if(BX.prop.get(t,"originator",null)===this){return}if(!BX.prop.getBoolean(t,"forAll",false)&&BX.prop.getString(t,"name","")!==this.getName()){return}this.refreshLayout()}}],[{key:"create",value:function e(s,a){var i=new t;i.initialize(s,a);return i}},{key:"registerField",value:function e(){if(typeof BX.UI.EntityEditorControlFactory!=="undefined"){BX.UI.EntityEditorControlFactory.registerFactoryMethod("address",t.registerFieldMethod)}else{BX.addCustomEvent("BX.UI.EntityEditorControlFactory:onInitialize",function(e,s){s.methods.address=t.registerFieldMethod})}}},{key:"registerFieldMethod",value:function e(s,a,i){var l=null;if(s==="address"){l=t.create(a,i)}return l}}]);return t}(BX.UI.EntityEditorField);var Il=function e(t){return t?sl.TYPE_CLEAR:sl.TYPE_SEARCH};var Gl=function e(){if(this._input.value!==""){this._input.value="";this._addressWidget.address=null;this._inputIcon.type=sl.TYPE_SEARCH}if(this.hasError()){this.clearError()}};var Sl=function e(t){var s=t.getData();var a=s.state;if(a===ji.STATE_OFF){hl(this,Pl,kl).call(this)}else{hl(this,Fl,El).call(this)}this._addressWidget.resetView()};var kl=function e(){if(this._addressFieldsContainer){this._addressFieldsContainer.classList.remove("visible")}};var El=function e(){if(this._addressFieldsContainer){this._addressFieldsContainer.classList.add("visible")}};var Cl=function e(t){var s=t.getData();var a=s.state;var i;if(s.state===r.State.DATA_LOADING){i=sl.TYPE_LOADER}else{if(s.state===r.State.DATA_INPUTTING){this.markAsChanged()}i=vl(yl,yl,Il).call(yl,hl(this,Tl,Al).call(this))}this._inputIcon.type=i};var Wl=function e(t){var s=t.getData();var a=s.address;if(this._hiddenInput){this._hiddenInput.value=a?a.toJson():"";this.markAsChanged()}if(this._inputIcon){this._inputIcon.type=vl(yl,yl,Il).call(yl,a)}};var Ml=function e(t){if(!t){return""}return t.toString(this._addressWidget.addressFormat)};var Al=function e(){return this._addressWidget.address};yl.registerField();e.Address=L;e.BaseFeature=o;e.MapFeature=fi;e.AutocompleteFeature=Fi;e.FieldsFeature=wi;e.Factory=Bi;e.State=b;e.UIAddress=yl})(this.BX.Location.Widget=this.BX.Location.Widget||{},BX.Location.OSM,BX.Location.Google,BX.Main,BX,BX.Location.Core,BX.Location.Widget,BX.Event,BX);
//# sourceMappingURL=widget.bundle.map.js