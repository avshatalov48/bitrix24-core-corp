this.BX=this.BX||{};this.BX.Location=this.BX.Location||{};(function(e,t,s,a,i,l,r,n,d,o){"use strict";var b=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(b,"INITIAL","INITIAL");babelHelpers.defineProperty(b,"DATA_INPUTTING","DATA_INPUTTING");babelHelpers.defineProperty(b,"DATA_SELECTED","DATA_SELECTED");babelHelpers.defineProperty(b,"DATA_SUPPOSED","DATA_SUPPOSED");babelHelpers.defineProperty(b,"DATA_LOADING","DATA_LOADING");babelHelpers.defineProperty(b,"DATA_LOADED","DATA_LOADED");function c(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-address-container">\n\t\t\t\t<div class="location-map-address-icon"></div>\n\t\t\t\t',"\n\t\t\t</div>"]);c=function t(){return e};return e}function u(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-map-address-text">',"</div>"]);u=function t(){return e};return e}function p(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var v=new WeakMap;var h=new WeakMap;var f=new WeakMap;var H=new WeakMap;var F=new WeakSet;var P=function(){function e(t){babelHelpers.classCallCheck(this,e);F.add(this);v.set(this,{writable:true,value:void 0});h.set(this,{writable:true,value:void 0});f.set(this,{writable:true,value:void 0});H.set(this,{writable:true,value:void 0});if(!(t.addressFormat instanceof r.Format)){throw new Error("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(this,H,t.addressFormat)}babelHelpers.createClass(e,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,v,t.address);var s=p(this,F,m).call(this,babelHelpers.classPrivateFieldGet(this,v));babelHelpers.classPrivateFieldSet(this,f,o.Tag.render(u(),s));babelHelpers.classPrivateFieldSet(this,h,o.Tag.render(c(),babelHelpers.classPrivateFieldGet(this,f)));if(s===""){this.hide()}return babelHelpers.classPrivateFieldGet(this,h)}},{key:"show",value:function e(){if(babelHelpers.classPrivateFieldGet(this,h)){babelHelpers.classPrivateFieldGet(this,h).style.display="block"}}},{key:"hide",value:function e(){if(babelHelpers.classPrivateFieldGet(this,h)){babelHelpers.classPrivateFieldGet(this,h).style.display="none"}}},{key:"isHidden",value:function e(){return!babelHelpers.classPrivateFieldGet(this,h)||babelHelpers.classPrivateFieldGet(this,h).style.display==="none"}},{key:"address",set:function e(t){babelHelpers.classPrivateFieldSet(this,v,t);if(!babelHelpers.classPrivateFieldGet(this,f)){return}babelHelpers.classPrivateFieldGet(this,f).innerHTML=p(this,F,m).call(this,t);if(!t&&!this.isHidden()){this.hide()}else if(t&&this.isHidden()){this.show()}}}]);return e}();var m=function e(t){var s="";if(t){s=r.AddressStringConverter.convertAddressToStringTemplate(t,babelHelpers.classPrivateFieldGet(this,H).getTemplate(r.FormatTemplateType.DEFAULT),r.AddressStringConverter.CONTENT_TYPE_HTML,", ",babelHelpers.classPrivateFieldGet(this,H))}return s};var g=t.Vue.extend({props:{address:{required:true},addressFormat:{required:true},isHidden:{required:true}},methods:{handleApplyClick:function e(){this.$emit("apply",{address:this.address})},convertAddressToString:function e(t){if(!t){return""}return t.toString(this.addressFormat,r.AddressStringConverter.STRATEGY_TYPE_TEMPLATE_COMMA)}},computed:{addressString:function e(){if(!this.address){return""}return this.address.toString(this.addressFormat,r.AddressStringConverter.STRATEGY_TYPE_TEMPLATE_COMMA)},containerStyles:function e(){return{display:this.isHidden?"none":"flex"}},containerClasses:function e(){return this.isHidden?{hidden:true}:{}},localize:function e(){return t.Vue.getFilteredPhrases("LOCATION_WIDGET_")}},template:'\n\t\t<div\n\t\t\t:class="containerClasses"\n\t\t\t:style="containerStyles"\n\t\t\tclass="location-map-address-changed"\n\t\t>\n\t\t\t<div class="location-map-address-changed-inner">\n\t\t\t<div class="location-map-address-changed-title">\n\t\t\t\t{{localize.LOCATION_WIDGET_AUI_ADDRESS_CHANGED_NEW_ADDRESS}}\n\t\t\t</div>\n\t\t\t<div class="location-map-address-changed-text">{{addressString}}</div>\n\t\t\t</div>\n\t\t\t<button @click="handleApplyClick" type="button" class="location-map-address-apply-btn">\n\t\t\t\t{{localize.LOCATION_WIDGET_AUI_ADDRESS_APPLY}}\n\t\t\t</button>\n\t\t</div>\t\n\t'});function T(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var y=new WeakSet;var w=function(e){babelHelpers.inherits(t,e);function t(){var e;var s;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++){i[l]=arguments[l]}s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i)));y.add(babelHelpers.assertThisInitialized(s));return s}babelHelpers.createClass(t,[{key:"getBindElement",value:function e(){return this.bindElement}},{key:"adjustPosition",value:function e(s){var a,i;if(this.bindOptions.position&&this.bindOptions.position==="right"){a=true;i=T(this,y,I).call(this)}if(!(a&&i)){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"adjustPosition",this).call(this,s)}}}]);return t}(i.Popup);var I=function e(){var t=this.bindElement.getBoundingClientRect();var s=this.getPopupContainer().offsetHeight;var a=this.getPopupContainer().offsetWidth;if(t.left+t.width+a>document.documentElement.clientWidth){return false}var i=s/2;var l=t.left+t.width+10;var r=window.pageYOffset+t.top+t.height/2-s/2;if(r<window.pageYOffset){i-=window.pageYOffset-r;r=window.pageYOffset}else if(r>window.pageYOffset+document.body.clientHeight-s){i+=r-(window.pageYOffset+document.body.clientHeight-s);r=window.pageYOffset+document.body.clientHeight-s}this.setAngle({position:"left",offset:i});o.Dom.adjust(this.popupContainer,{style:{top:"".concat(r,"px"),left:"".concat(l,"px"),zIndex:this.getZindex()}});return true};function G(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-wrapper">\n\t\t\t\t<div class="location-map-container">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>"]);G=function t(){return e};return e}function S(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-map-inner"></div>']);S=function t(){return e};return e}function E(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function k(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var C=new WeakMap;var A=new WeakMap;var W=new WeakMap;var M=new WeakMap;var _=new WeakMap;var z=new WeakMap;var L=new WeakMap;var O=new WeakMap;var N=new WeakMap;var D=new WeakMap;var B=new WeakMap;var R=new WeakMap;var X=new WeakMap;var x=new WeakMap;var U=new WeakSet;var V=new WeakSet;var Y=new WeakSet;var j=new WeakSet;var K=new WeakSet;var $=new WeakSet;var q=new WeakSet;var J=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));q.add(babelHelpers.assertThisInitialized(s));$.add(babelHelpers.assertThisInitialized(s));K.add(babelHelpers.assertThisInitialized(s));j.add(babelHelpers.assertThisInitialized(s));Y.add(babelHelpers.assertThisInitialized(s));V.add(babelHelpers.assertThisInitialized(s));U.add(babelHelpers.assertThisInitialized(s));C.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});A.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});W.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});M.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});_.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});z.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});L.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});O.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});N.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});D.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});B.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});R.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});X.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});x.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.MapPopup");if(!(e.map instanceof r.MapBase)){BX.debug("map must be instance of Map")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),C,e.map);if(e.geocodingService instanceof r.GeocodingServiceBase){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),R,e.geocodingService)}babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),C).onLocationChangedEventSubscribe(k(babelHelpers.assertThisInitialized(s),V,ie).bind(babelHelpers.assertThisInitialized(s)));if(!(e.popup instanceof w)){BX.debug("popup must be instance of Popup")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),M,e.popup);if(!(e.addressFormat instanceof r.Format)){BX.debug("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),L,e.addressFormat);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),_,new P({addressFormat:babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),L)}));k(babelHelpers.assertThisInitialized(s),U,ae).call(babelHelpers.assertThisInitialized(s));if(e.gallery){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),O,e.gallery)}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),N,e.locationRepository);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),x,e.userLocationPoint);return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,W,t.address);babelHelpers.classPrivateFieldSet(this,A,t.mode);babelHelpers.classPrivateFieldSet(this,D,false);babelHelpers.classPrivateFieldSet(this,B,o.Tag.render(S()));k(this,Y,le).call(this,t.bindElement,babelHelpers.classPrivateFieldGet(this,B))}},{key:"show",value:function e(){var s=this;var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;k(this,K,ne).call(this,babelHelpers.classPrivateFieldGet(this,W),a).then(function(e){if(!e){return}babelHelpers.classPrivateFieldGet(s,M).show();if(!babelHelpers.classPrivateFieldGet(s,D)){k(s,q,oe).call(s,{location:e}).then(function(){if(babelHelpers.classPrivateFieldGet(s,O)){babelHelpers.classPrivateFieldGet(s,O).location=e}s.emit(E(t,t,te));babelHelpers.classPrivateFieldGet(s,C).onMapShow()});babelHelpers.classPrivateFieldSet(s,D,true)}else{babelHelpers.classPrivateFieldGet(s,C).location=e;if(babelHelpers.classPrivateFieldGet(s,O)){babelHelpers.classPrivateFieldGet(s,O).location=e}s.emit(E(t,t,te));babelHelpers.classPrivateFieldGet(s,C).onMapShow()}})}},{key:"isShown",value:function e(){return babelHelpers.classPrivateFieldGet(this,M).isShown()}},{key:"close",value:function e(){babelHelpers.classPrivateFieldGet(this,M).close();babelHelpers.classPrivateFieldGet(this,z).$props.isHidden=true;this.emit(E(t,t,se))}},{key:"onChangedEventSubscribe",value:function e(s){this.subscribe(E(t,t,Z),s)}},{key:"onMouseOverSubscribe",value:function e(s){this.subscribe(E(t,t,Q),s)}},{key:"onMouseOutSubscribe",value:function e(s){this.subscribe(E(t,t,ee),s)}},{key:"subscribeOnShowedEvent",value:function e(s){this.subscribe(E(t,t,te),s)}},{key:"subscribeOnClosedEvent",value:function e(s){this.subscribe(E(t,t,se),s)}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldSet(this,C,null);babelHelpers.classPrivateFieldSet(this,O,null);babelHelpers.classPrivateFieldSet(this,_,null);babelHelpers.classPrivateFieldSet(this,z,null);babelHelpers.classPrivateFieldGet(this,M).destroy();babelHelpers.classPrivateFieldSet(this,M,null);o.Dom.remove(babelHelpers.classPrivateFieldGet(this,X));babelHelpers.classPrivateFieldSet(this,X,null);o.Event.unbindAll(this)}},{key:"bindElement",get:function e(){return babelHelpers.classPrivateFieldGet(this,M).getBindElement()},set:function e(t){if(o.Type.isDomNode(t)){babelHelpers.classPrivateFieldGet(this,M).setBindElement(t)}else{BX.debug("bindElement must be type of dom node")}}},{key:"address",set:function e(t){var s=this;babelHelpers.classPrivateFieldSet(this,W,t);babelHelpers.classPrivateFieldGet(this,_).address=t;k(this,K,ne).call(this,t).then(function(e){k(s,$,de).call(s,e)})}},{key:"mode",set:function e(t){babelHelpers.classPrivateFieldSet(this,A,t);babelHelpers.classPrivateFieldGet(this,C).mode=t}}]);return t}(d.EventEmitter);var Z={writable:true,value:"onChanged"};var Q={writable:true,value:"onMouseOver"};var ee={writable:true,value:"onMouseOut"};var te={writable:true,value:"onShow"};var se={writable:true,value:"onClose"};var ae=function e(){var t=this;babelHelpers.classPrivateFieldSet(this,z,new g({propsData:{address:babelHelpers.classPrivateFieldGet(this,W),addressFormat:babelHelpers.classPrivateFieldGet(this,L),isHidden:true}}));babelHelpers.classPrivateFieldGet(this,z).$mount();babelHelpers.classPrivateFieldGet(this,z).$on("apply",function(e){var s=e.address;babelHelpers.classPrivateFieldSet(t,W,s);babelHelpers.classPrivateFieldGet(t,_).address=s;babelHelpers.classPrivateFieldGet(t,z).$props.isHidden=true;t.emit(E(J,J,Z),{address:s})})};var ie=function e(t){var s=t.getData();var a=s.location;var i=a.toAddress();if(!babelHelpers.classPrivateFieldGet(this,W)){babelHelpers.classPrivateFieldSet(this,W,i);babelHelpers.classPrivateFieldGet(this,_).address=i;this.emit(E(J,J,Z),{address:i})}else if(i.fieldCollection.isEqual(babelHelpers.classPrivateFieldGet(this,W).fieldCollection,r.LocationType.ADDRESS_LINE_1)){babelHelpers.classPrivateFieldGet(this,W).latitude=i.latitude;babelHelpers.classPrivateFieldGet(this,W).longitude=i.longitude;babelHelpers.classPrivateFieldGet(this,W).location.latitude=i.latitude;babelHelpers.classPrivateFieldGet(this,W).location.longitude=i.longitude;this.emit(E(J,J,Z),{address:babelHelpers.classPrivateFieldGet(this,W)});babelHelpers.classPrivateFieldGet(this,z).$props.isHidden=true}else{babelHelpers.classPrivateFieldGet(this,_).address=i;babelHelpers.classPrivateFieldGet(this,z).$props.address=i;babelHelpers.classPrivateFieldGet(this,z).$props.isHidden=false}if(babelHelpers.classPrivateFieldGet(this,O)){babelHelpers.classPrivateFieldGet(this,O).location=a}};var le=function e(t,s){var a=this;var i="";if(babelHelpers.classPrivateFieldGet(this,O)){i=babelHelpers.classPrivateFieldGet(this,O).render()}babelHelpers.classPrivateFieldSet(this,X,o.Tag.render(G(),s,i,babelHelpers.classPrivateFieldGet(this,A)===r.ControlMode.edit?babelHelpers.classPrivateFieldGet(this,_).render({address:babelHelpers.classPrivateFieldGet(this,W)}):"",babelHelpers.classPrivateFieldGet(this,A)===r.ControlMode.edit?babelHelpers.classPrivateFieldGet(this,z).$el:""));o.Event.bind(babelHelpers.classPrivateFieldGet(this,X),"click",function(e){return e.stopPropagation()});o.Event.bind(babelHelpers.classPrivateFieldGet(this,X),"mouseover",function(e){return a.emit(E(J,J,Q),e)});o.Event.bind(babelHelpers.classPrivateFieldGet(this,X),"mouseout",function(e){return a.emit(E(J,J,ee),e)});this.bindElement=t;babelHelpers.classPrivateFieldGet(this,M).setContent(babelHelpers.classPrivateFieldGet(this,X))};var re=function e(t){var s=null;var a;var i;if(t.latitude&&t.longitude){a=t.latitude;i=t.longitude}else if(t.location&&t.location.latitude&&t.location.longitude){a=t.location.latitude;i=t.location.longitude}if(a&&a!=="0"&&i&&i!=="0"){s=[a,i]}return s};var ne=function e(t){var s=this;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return new Promise(function(e){if(a){e(babelHelpers.classPrivateFieldGet(s,x)&&babelHelpers.classPrivateFieldGet(s,A)!==r.ControlMode.view?new r.Location({latitude:babelHelpers.classPrivateFieldGet(s,x).latitude,longitude:babelHelpers.classPrivateFieldGet(s,x).longitude}):null);return}if(t){var i=k(s,j,re).call(s,t);if(i){e(new r.Location({latitude:i[0],longitude:i[1],type:t.getType()}));return}}e(null)})};var de=function e(t){if(babelHelpers.classPrivateFieldGet(this,C)){babelHelpers.classPrivateFieldGet(this,C).location=t}if(babelHelpers.classPrivateFieldGet(this,O)){babelHelpers.classPrivateFieldGet(this,O).location=t}};var oe=function e(t){var s=t.location;return babelHelpers.classPrivateFieldGet(this,C).render({mapContainer:babelHelpers.classPrivateFieldGet(this,B),location:s,mode:babelHelpers.classPrivateFieldGet(this,A)})};var be=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"_saveResourceStrategy",false);this._saveResourceStrategy=t.saveResourceStrategy}babelHelpers.createClass(e,[{key:"render",value:function e(t){throw new r.MethodNotImplemented("Method render must be implemented")}},{key:"setAddressWidget",value:function e(t){throw new r.MethodNotImplemented("Method render must be implemented")}},{key:"setAddress",value:function e(t){throw new r.MethodNotImplemented("Method set address must be implemented")}},{key:"setMode",value:function e(t){}},{key:"destroy",value:function e(){}},{key:"resetView",value:function e(){}}]);return e}();function ce(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=ue(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function ue(e,t){if(!e)return;if(typeof e==="string")return pe(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return pe(e,t)}function pe(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function ve(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var he=new WeakMap;var fe=new WeakMap;var He=new WeakMap;var Fe=new WeakMap;var Pe=new WeakMap;var me=new WeakMap;var ge=new WeakMap;var Te=new WeakMap;var ye=new WeakMap;var we=new WeakMap;var Ie=new WeakMap;var Ge=new WeakMap;var Se=new WeakMap;var Ee=new WeakSet;var ke=new WeakSet;var Ce=new WeakSet;var Ae=new WeakSet;var We=new WeakSet;var Me=new WeakSet;var _e=new WeakSet;var ze=new WeakSet;var Le=new WeakSet;var Oe=new WeakSet;var Ne=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));Oe.add(babelHelpers.assertThisInitialized(s));Le.add(babelHelpers.assertThisInitialized(s));ze.add(babelHelpers.assertThisInitialized(s));_e.add(babelHelpers.assertThisInitialized(s));Me.add(babelHelpers.assertThisInitialized(s));We.add(babelHelpers.assertThisInitialized(s));Ae.add(babelHelpers.assertThisInitialized(s));Ce.add(babelHelpers.assertThisInitialized(s));ke.add(babelHelpers.assertThisInitialized(s));Ee.add(babelHelpers.assertThisInitialized(s));he.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});fe.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});He.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Fe.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Pe.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});me.set(babelHelpers.assertThisInitialized(s),{writable:true,value:[]});ge.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Te.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ye.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});we.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});Ie.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});Ge.set(babelHelpers.assertThisInitialized(s),{writable:true,value:true});Se.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.Address");if(!(e.addressFormat instanceof r.Format)){BX.debug("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Fe,e.addressFormat);if(e.address&&!(e.address instanceof r.Address)){BX.debug("address must be instance of Address")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),He,e.address||null);if(!r.ControlMode.isValid(e.mode)){BX.debug("mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),he,e.mode);if(!o.Type.isString(e.languageId)){throw new TypeError("props.languageId must be type of string")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Pe,e.languageId);if(e.features){if(!o.Type.isArray(e.features)){throw new TypeError("features must be an array")}e.features.forEach(function(e){ve(babelHelpers.assertThisInitialized(s),Ee,De).call(babelHelpers.assertThisInitialized(s),e)})}if(o.Type.isBoolean(e.needWarmBackendAfterAddressChanged)){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ge,e.needWarmBackendAfterAddressChanged)}if(e.locationRepository instanceof r.LocationRepository){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Se,e.locationRepository)}else if(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Ge)){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Se,new r.LocationRepository)}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),fe,b.INITIAL);return s}babelHelpers.createClass(t,[{key:"setAddressByFeature",value:function e(t,s){var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var l=babelHelpers.classPrivateFieldGet(this,He)?babelHelpers.classPrivateFieldGet(this,He).id:0;if(t&&!t.getFieldValue(r.AddressType.ADDRESS_LINE_1)&&babelHelpers.classPrivateFieldGet(this,Fe).isTemplateExists(r.FormatTemplateType.ADDRESS_LINE_1)){t.setFieldValue(r.AddressType.ADDRESS_LINE_1,r.AddressStringConverter.convertAddressToStringTemplate(t,babelHelpers.classPrivateFieldGet(this,Fe).getTemplate(r.FormatTemplateType.ADDRESS_LINE_1),r.AddressStringConverter.CONTENT_TYPE_TEXT,null,babelHelpers.classPrivateFieldGet(this,Fe)))}babelHelpers.classPrivateFieldSet(this,He,t);var n=i.hasOwnProperty("storeAsLastAddress")?i.storeAsLastAddress:true;if(n){ve(this,Le,je).call(this)}if(l>0){babelHelpers.classPrivateFieldGet(this,He).id=l}babelHelpers.classPrivateFieldSet(this,we,true);ve(this,_e,Ve).call(this,t);ve(this,ke,Be).call(this,"setAddress",[t],s,a);if(babelHelpers.classPrivateFieldGet(this,fe)!==b.DATA_INPUTTING){ve(this,Ce,Re).call(this)}}},{key:"emitFeatureEvent",value:function e(s){this.emit(t.onFeatureEvent,s)}},{key:"onInputKeyup",value:function e(t){switch(t.code){case"Tab":case"Esc":case"Enter":case"NumpadEnter":this.resetView();break;default:babelHelpers.classPrivateFieldSet(this,Ie,true)}}},{key:"resetView",value:function e(){ve(this,ke,Be).call(this,"resetView")}},{key:"render",value:function e(t){if(!o.Type.isDomNode(t.controlWrapper)){BX.debug("props.controlWrapper  must be instance of Element")}babelHelpers.classPrivateFieldSet(this,Te,t.controlWrapper);if(babelHelpers.classPrivateFieldGet(this,he)===r.ControlMode.edit){if(!o.Type.isDomNode(t.inputNode)){BX.debug("props.inputNode  must be instance of Element")}babelHelpers.classPrivateFieldSet(this,ge,t.inputNode);ve(this,_e,Ve).call(this,babelHelpers.classPrivateFieldGet(this,He))}ve(this,ke,Be).call(this,"render",[t]);if(babelHelpers.classPrivateFieldGet(this,he)===r.ControlMode.edit){o.Event.bind(babelHelpers.classPrivateFieldGet(this,ge),"focus",ve(this,We,xe).bind(this));o.Event.bind(babelHelpers.classPrivateFieldGet(this,ge),"focusout",ve(this,ze,Ye).bind(this));o.Event.bind(babelHelpers.classPrivateFieldGet(this,ge),"keyup",this.onInputKeyup.bind(this))}}},{key:"setStateByFeature",value:function e(s){babelHelpers.classPrivateFieldSet(this,fe,s);this.emit(t.onStateChangedEvent,{state:s})}},{key:"subscribeOnStateChangedEvent",value:function e(s){this.subscribe(t.onStateChangedEvent,s)}},{key:"subscribeOnAddressChangedEvent",value:function e(s){this.subscribe(t.onAddressChangedEvent,s)}},{key:"subscribeOnFeatureEvent",value:function e(s){this.subscribe(t.onFeatureEvent,s)}},{key:"subscribeOnErrorEvent",value:function e(t){r.ErrorPublisher.getInstance().subscribe(t)}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,ye)){return}o.Event.unbindAll(this);o.Event.unbind(babelHelpers.classPrivateFieldGet(this,ge),"focus",ve(this,We,xe));o.Event.unbind(babelHelpers.classPrivateFieldGet(this,ge),"focusout",ve(this,ze,Ye));o.Event.unbind(babelHelpers.classPrivateFieldGet(this,ge),"keyup",this.onInputKeyup);ve(this,ke,Be).call(this,"destroy");ve(this,Oe,Ke).call(this);babelHelpers.classPrivateFieldSet(this,ye,true)}},{key:"isDestroyed",value:function e(){return babelHelpers.classPrivateFieldGet(this,ye)}},{key:"features",get:function e(){return babelHelpers.classPrivateFieldGet(this,me)}},{key:"controlWrapper",get:function e(){return babelHelpers.classPrivateFieldGet(this,Te)}},{key:"inputNode",get:function e(){return babelHelpers.classPrivateFieldGet(this,ge)}},{key:"address",get:function e(){return babelHelpers.classPrivateFieldGet(this,He)},set:function e(t){if(t&&!(t instanceof r.Address)){BX.debug("address must be instance of Address")}babelHelpers.classPrivateFieldSet(this,He,t);ve(this,Le,je).call(this);ve(this,ke,Be).call(this,"setAddress",[t]);babelHelpers.classPrivateFieldSet(this,Ie,false);babelHelpers.classPrivateFieldSet(this,we,false);ve(this,_e,Ve).call(this,t)}},{key:"mode",get:function e(){return babelHelpers.classPrivateFieldGet(this,he)},set:function e(t){if(!r.ControlMode.isValid(t)){BX.debug("mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(this,he,t);ve(this,ke,Be).call(this,"setMode",[t])}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,fe)}},{key:"addressFormat",get:function e(){return babelHelpers.classPrivateFieldGet(this,Fe)}}]);return t}(d.EventEmitter);babelHelpers.defineProperty(Ne,"onAddressChangedEvent","onAddressChanged");babelHelpers.defineProperty(Ne,"onStateChangedEvent","onStateChanged");babelHelpers.defineProperty(Ne,"onFeatureEvent","onFeatureEvent");var De=function e(t){if(!(t instanceof be)){BX.debug("feature must be instance of BaseFeature")}t.setAddressWidget(this);babelHelpers.classPrivateFieldGet(this,me).push(t)};var Be=function e(t){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[];var l;var r=ce(babelHelpers.classPrivateFieldGet(this,me)),n;try{for(r.s();!(n=r.n()).done;){var d=n.value;var o=false;var b=ce(i),c;try{for(b.s();!(c=b.n()).done;){var u=c.value;if(d instanceof u){o=true;break}}}catch(e){b.e(e)}finally{b.f()}if(!o&&d!==a){l=d[t].apply(d,s)}}}catch(e){r.e(e)}finally{r.f()}return l};var Re=function e(){this.emit(Ne.onAddressChangedEvent,{address:babelHelpers.classPrivateFieldGet(this,He)});if(babelHelpers.classPrivateFieldGet(this,He)&&babelHelpers.classPrivateFieldGet(this,Ge)){ve(this,Ae,Xe).call(this,babelHelpers.classPrivateFieldGet(this,He))}};var Xe=function e(t){if(t.location!==null&&t.location.id<=0){babelHelpers.classPrivateFieldGet(this,Se).findParents(t.location)}};var xe=function e(t){var s=babelHelpers.classPrivateFieldGet(this,ge).value;if(s.length>0){BX.setCaretPosition(babelHelpers.classPrivateFieldGet(this,ge),s.length)}};var Ue=function e(t,s){var a="";if(t){if(!babelHelpers.classPrivateFieldGet(this,Fe).isTemplateExists(s)){console.error('Address format "'.concat(babelHelpers.classPrivateFieldGet(this,Fe).code,'" does not have a template "').concat(s,'"'));return""}a=r.AddressStringConverter.convertAddressToStringTemplate(t,babelHelpers.classPrivateFieldGet(this,Fe).getTemplate(s),r.AddressStringConverter.CONTENT_TYPE_TEXT,", ",babelHelpers.classPrivateFieldGet(this,Fe))}return a};var Ve=function e(t){if(babelHelpers.classPrivateFieldGet(this,ge)){var s=ve(this,Me,Ue).call(this,t,r.FormatTemplateType.AUTOCOMPLETE);var a=ve(this,Me,Ue).call(this,t,r.FormatTemplateType.DEFAULT);babelHelpers.classPrivateFieldGet(this,ge).value=s.trim()!==""?s:a;babelHelpers.classPrivateFieldGet(this,ge).title=a;var i=babelHelpers.classPrivateFieldGet(this,ge).selectionStart;var l=s.length;babelHelpers.classPrivateFieldGet(this,ge).setSelectionRange(i,l)}};var Ye=function e(t){if(babelHelpers.classPrivateFieldGet(this,Ie)&&!babelHelpers.classPrivateFieldGet(this,we)){var s=babelHelpers.classPrivateFieldGet(this,ge).value.trim();var a=new r.Address({languageId:babelHelpers.classPrivateFieldGet(this,Pe)});a.setFieldValue(babelHelpers.classPrivateFieldGet(this,Fe).fieldForUnRecognized,s);this.address=a;ve(this,Ce,Re).call(this)}babelHelpers.classPrivateFieldSet(this,Ie,false);babelHelpers.classPrivateFieldSet(this,we,false)};var je=function e(){if(babelHelpers.classPrivateFieldGet(this,He)&&babelHelpers.classPrivateFieldGet(this,He).fieldCollection&&babelHelpers.classPrivateFieldGet(this,He).fieldCollection.isFieldExists(r.AddressType.LOCALITY)){r.Storage.getInstance().lastAddress=babelHelpers.classPrivateFieldGet(this,He)}};var Ke=function e(){babelHelpers.classPrivateFieldGet(this,me).splice(0,babelHelpers.classPrivateFieldGet(this,me).length)};function $e(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div>\n\t\t\t\t<span class="location-map-popup-item--info"> \t\t\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</span>\t\t\t\n\t\t\t</div>\n\t\t"]);$e=function t(){return e};return e}function qe(){var e=babelHelpers.taggedTemplateLiteral(["<div></div>"]);qe=function t(){return e};return e}function Je(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-map-popup-item--info-left"></div>']);Je=function t(){return e};return e}var Ze=new WeakMap;var Qe=new WeakMap;var et=new WeakMap;var tt=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));Ze.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});Qe.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});et.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});e.setEventNamespace("BX.Location.Widget.Autocomplete.MenuBottom");return e}babelHelpers.createClass(t,[{key:"render",value:function e(){babelHelpers.classPrivateFieldSet(this,Qe,o.Tag.render(Je()));babelHelpers.classPrivateFieldSet(this,et,o.Tag.render(qe()));babelHelpers.classPrivateFieldSet(this,Ze,o.Tag.render($e(),babelHelpers.classPrivateFieldGet(this,Qe),babelHelpers.classPrivateFieldGet(this,et)));return babelHelpers.classPrivateFieldGet(this,Ze)}},{key:"setRightItemNode",value:function e(t){while(babelHelpers.classPrivateFieldGet(this,et).firstChild){babelHelpers.classPrivateFieldGet(this,et).removeChild(babelHelpers.classPrivateFieldGet(this,et).firstChild)}babelHelpers.classPrivateFieldGet(this,et).appendChild(t)}},{key:"setLeftItemNode",value:function e(t){while(babelHelpers.classPrivateFieldGet(this,Qe).firstChild){babelHelpers.classPrivateFieldGet(this,Qe).removeChild(babelHelpers.classPrivateFieldGet(this,Qe).firstChild)}babelHelpers.classPrivateFieldGet(this,Qe).appendChild(t)}}]);return t}(d.EventEmitter);var st=new WeakMap;var at=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"choseItemIdx",-1);st.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});var a=e.bindElement.getBoundingClientRect();s.popupWindow.setMaxWidth(a.width);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),st,new tt);s.layout.menuContainer.appendChild(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),st).render());return s}babelHelpers.createClass(t,[{key:"isMenuEmpty",value:function e(){return this.menuItems.length<=0}},{key:"isChoseLastItem",value:function e(){return this.choseItemIdx>=this.menuItems.length-1}},{key:"isChoseFirstItem",value:function e(){return this.choseItemIdx===0}},{key:"isItemChosen",value:function e(){return this.choseItemIdx>=0}},{key:"isDestroyed",value:function e(){return this.getPopupWindow().isDestroyed()}},{key:"isItemExist",value:function e(t){return typeof this.menuItems[t]!=="undefined"}},{key:"getChosenItem",value:function e(){var t=null;if(this.isItemChosen()&&this.isItemExist(this.choseItemIdx)){t=this.menuItems[this.choseItemIdx]}return t}},{key:"chooseNextItem",value:function e(){if(!this.isMenuEmpty()&&!this.isChoseLastItem()){this.chooseItem(this.choseItemIdx+1)}return this.getChosenItem()}},{key:"choosePrevItem",value:function e(){if(!this.isMenuEmpty()&&!this.isChoseFirstItem()){this.chooseItem(this.choseItemIdx-1)}return this.getChosenItem()}},{key:"highlightItem",value:function e(t){if(this.isItemExist(t)){var s=this.getChosenItem();if(s&&s.layout.item){s.layout.item.classList.add("highlighted")}}}},{key:"unHighlightItem",value:function e(t){if(this.isItemExist(t)){var s=this.getChosenItem();if(s&&s.layout.item){s.layout.item.classList.remove("highlighted")}}}},{key:"chooseItem",value:function e(t){var s=t;if(s<0){s=this.menuItems.length-1}else if(s>this.menuItems.length-1){s=0}this.unHighlightItem(this.choseItemIdx);this.choseItemIdx=s;this.highlightItem(this.choseItemIdx)}},{key:"clearItems",value:function e(){while(this.menuItems.length>0){this.removeMenuItem(this.menuItems[0].id)}}},{key:"isShown",value:function e(){return this.getPopupWindow().isShown()}},{key:"setBottomRightItemNode",value:function e(t){babelHelpers.classPrivateFieldGet(this,st).setRightItemNode(t)}},{key:"setBottomLeftItemNode",value:function e(t){babelHelpers.classPrivateFieldGet(this,st).setLeftItemNode(t)}}]);return t}(i.Menu);function it(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=lt(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function lt(e,t){if(!e)return;if(typeof e==="string")return rt(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return rt(e,t)}function rt(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function nt(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}return s}function dt(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var ot=new WeakMap;var bt=new WeakMap;var ct=new WeakMap;var ut=new WeakMap;var pt=new WeakSet;var vt=new WeakSet;var ht=new WeakSet;var ft=new WeakSet;var Ht=new WeakSet;var Ft=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Ht.add(babelHelpers.assertThisInitialized(s));ft.add(babelHelpers.assertThisInitialized(s));ht.add(babelHelpers.assertThisInitialized(s));vt.add(babelHelpers.assertThisInitialized(s));pt.add(babelHelpers.assertThisInitialized(s));ot.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});bt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ct.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ut.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.Prompt");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ot,e.inputNode);if(e.menuNode){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),bt,e.menuNode)}return s}babelHelpers.createClass(t,[{key:"getMenu",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,ct)||babelHelpers.classPrivateFieldGet(this,ct).isDestroyed()){babelHelpers.classPrivateFieldSet(this,ct,dt(this,pt,gt).call(this))}return babelHelpers.classPrivateFieldGet(this,ct)}},{key:"show",value:function e(t,s){if(t.length>0){this.setMenuItems(t,s);this.getMenu().show()}}},{key:"close",value:function e(){this.getMenu().close()}},{key:"setMenuItems",value:function e(s,a,i){var l=this;this.getMenu().clearItems();if(Array.isArray(s)){babelHelpers.classPrivateFieldSet(this,ut,s.slice());var n=!i||!i.getFieldValue(r.AddressType.LOCALITY)||!nt(t,t,Pt).call(t,babelHelpers.classPrivateFieldGet(this,ut));if(n){s.forEach(function(e,t){l.getMenu().addMenuItem(dt(l,ht,yt).call(l,t,e,a))})}else{s.forEach(function(e,t){if(dt(l,vt,Tt).call(l,i,e)){l.getMenu().addMenuItem(dt(l,ht,yt).call(l,t,e,a))}});var d=false;s.forEach(function(e,t){if(!dt(l,vt,Tt).call(l,i,e)){if(!d){l.getMenu().addMenuItem({html:o.Loc.getMessage("LOCATION_WIDGET_PROMPT_IN_OTHER_CITY"),delimiter:true})}l.getMenu().addMenuItem(dt(l,ht,yt).call(l,t,e,a));d=true}})}}}},{key:"choosePrevItem",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var s=null;var a=this.getMenu().choosePrevItem();if(a){if(a.delimiter&&a.delimiter===true){s=t?this.getMenu().chooseNextItem():this.choosePrevItem(true)}else{s=dt(this,Ht,It).call(this,this.getMenu().choseItemIdx)}}return s}},{key:"chooseNextItem",value:function e(){var t=null;var s=this.getMenu().chooseNextItem();if(s){if(s.delimiter&&s.delimiter===true){t=this.chooseNextItem()}else{t=dt(this,Ht,It).call(this,this.getMenu().choseItemIdx)}}return t}},{key:"isItemChosen",value:function e(){return this.getMenu().isItemChosen()}},{key:"getChosenItem",value:function e(){var t=null;var s=this.getMenu().getChosenItem();if(s&&s.id){t=dt(this,Ht,It).call(this,this.getMenu().choseItemIdx)}return t}},{key:"isShown",value:function e(){return this.getMenu().isShown()}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,ct)){babelHelpers.classPrivateFieldGet(this,ct).destroy();babelHelpers.classPrivateFieldSet(this,ct,null)}babelHelpers.classPrivateFieldSet(this,ut,null)}}],[{key:"createMenuItemText",value:function e(t,s,a){var i="\n\t\t<div>\n\t\t\t<strong>".concat(t,"</strong>\n\t\t</div>");var l;if(a.getFieldValue(r.LocationType.TMP_TYPE_CLARIFICATION)){l=a.getFieldValue(r.LocationType.TMP_TYPE_CLARIFICATION);if(l){if(a.getFieldValue(r.LocationType.TMP_TYPE_HINT)){l+=" <i>(".concat(a.getFieldValue(r.LocationType.TMP_TYPE_HINT),")</i>")}i+="<div>".concat(l,"</div>")}}return'<div data-role="location-widget-menu-item" tabindex="-1">'+i+"</div>"}}]);return t}(d.EventEmitter);var Pt=function e(t){var s=it(t),a;try{for(s.s();!(a=s.n()).done;){var i=a.value;if(i.address&&i.address.getFieldValue(r.AddressType.LOCALITY)){return true}}}catch(e){s.e(e)}finally{s.f()}return false};var mt=function e(t){var s=[];if(t.getFieldValue(r.AddressType.LOCALITY)){s.push(t.getFieldValue(r.AddressType.LOCALITY))}if(t.getFieldValue(r.AddressType.ADM_LEVEL_1)){s.push(t.getFieldValue(r.AddressType.ADM_LEVEL_1))}return s};babelHelpers.defineProperty(Ft,"onItemSelectedEvent","onItemSelected");var gt=function e(){return new at({bindElement:babelHelpers.classPrivateFieldGet(this,bt)?babelHelpers.classPrivateFieldGet(this,bt):babelHelpers.classPrivateFieldGet(this,ot),autoHide:false,closeByEsc:true,className:"location-widget-prompt-menu"})};var Tt=function e(t,s){return t&&t.getFieldValue(r.AddressType.LOCALITY)&&s&&s.address&&s.address.getFieldValue(r.AddressType.LOCALITY)&&nt(Ft,Ft,mt).call(Ft,s.address).includes(t.getFieldValue(r.AddressType.LOCALITY))};var yt=function e(t,s,a){var i=this;return{id:t,title:s.name,html:Ft.createMenuItemText(s.name,a,s),onclick:function e(s,a){dt(i,ft,wt).call(i,t);i.close()}}};var wt=function e(t){var s=dt(this,Ht,It).call(this,t);if(s){this.emit(Ft.onItemSelectedEvent,{location:s})}};var It=function e(t){var s=null;if(babelHelpers.classPrivateFieldGet(this,ut)[t]!==undefined){s=babelHelpers.classPrivateFieldGet(this,ut)[t]}if(!s){BX.debug("Location with index ".concat(t," was not found"))}return s};function Gt(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var St=new WeakMap;var Et=new WeakMap;var kt=new WeakMap;var Ct=new WeakMap;var At=new WeakSet;var Wt=new WeakSet;var Mt=new WeakSet;var _t=function(){function e(t,s,a){babelHelpers.classCallCheck(this,e);Mt.add(this);Wt.add(this);At.add(this);St.set(this,{writable:true,value:null});Et.set(this,{writable:true,value:""});kt.set(this,{writable:true,value:""});Ct.set(this,{writable:true,value:null});if(!(t instanceof HTMLInputElement)){throw new TypeError("Wrong input type")}babelHelpers.classPrivateFieldSet(this,St,t);if(!(s instanceof r.Format)){throw new TypeError("Wrong addressFormat type")}babelHelpers.classPrivateFieldSet(this,Ct,s);if(a&&!(a instanceof r.Address)){throw new TypeError("Wrong address type")}if(a){this.setValueFromAddress(a)}}babelHelpers.createClass(e,[{key:"setValue",value:function e(t){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;babelHelpers.classPrivateFieldSet(this,Et,t);babelHelpers.classPrivateFieldGet(this,St).value=t;if(s){babelHelpers.classPrivateFieldSet(this,kt,t)}Gt(this,At,zt).call(this)}},{key:"actualize",value:function e(){babelHelpers.classPrivateFieldSet(this,Et,babelHelpers.classPrivateFieldGet(this,St).value);Gt(this,At,zt).call(this)}},{key:"isChanged",value:function e(){return babelHelpers.classPrivateFieldGet(this,Et).trim()!==babelHelpers.classPrivateFieldGet(this,St).value.trim()}},{key:"hasPureAddressString",value:function e(){return babelHelpers.classPrivateFieldGet(this,kt)!==""}},{key:"setValueFromAddress",value:function e(t){var s="";if(t){s=Gt(this,Mt,Ot).call(this,t,r.FormatTemplateType.AUTOCOMPLETE);if(s.trim()===""){s=Gt(this,Mt,Ot).call(this,t,r.FormatTemplateType.DEFAULT)}}this.setValue(s,true)}},{key:"value",get:function e(){return babelHelpers.classPrivateFieldGet(this,Et)}},{key:"customTail",get:function e(){if(babelHelpers.classPrivateFieldGet(this,kt)===""){return babelHelpers.classPrivateFieldGet(this,Et)}var t;if(!Gt(this,Wt,Lt).call(this)){t=babelHelpers.classPrivateFieldGet(this,Et).slice(babelHelpers.classPrivateFieldGet(this,kt).length)}else{t=babelHelpers.classPrivateFieldGet(this,Et)}return t}}]);return e}();var zt=function e(){if(Gt(this,Wt,Lt).call(this)){babelHelpers.classPrivateFieldSet(this,kt,"")}};var Lt=function e(){return babelHelpers.classPrivateFieldGet(this,Et)===""||babelHelpers.classPrivateFieldGet(this,kt)===""||babelHelpers.classPrivateFieldGet(this,Et).indexOf(babelHelpers.classPrivateFieldGet(this,kt))!==0};var Ot=function e(t,s){if(!babelHelpers.classPrivateFieldGet(this,Ct).isTemplateExists(s)){console.error('Address format "'.concat(babelHelpers.classPrivateFieldGet(this,Ct).code,'" does not have a template "').concat(s,'"'));return""}return r.AddressStringConverter.convertAddressToStringTemplate(t,babelHelpers.classPrivateFieldGet(this,Ct).getTemplate(s),r.AddressStringConverter.CONTENT_TYPE_TEXT,", ",babelHelpers.classPrivateFieldGet(this,Ct))};function Nt(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span>\n\t\t\t\t\t<span class="menu-popup-item-icon"></span>\n\t\t\t\t\t<span class="menu-popup-item-text">',"</span>\n\t\t\t\t</span>\n\t\t"]);Nt=function t(){return e};return e}function Dt(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="location-map-popup-item--show-on-map">\n\t\t\t\t\t',"\n\t\t\t\t</span>\n\t\t"]);Dt=function t(){return e};return e}function Bt(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function Rt(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var Xt=new WeakMap;var xt=new WeakMap;var Ut=new WeakMap;var Vt=new WeakMap;var Yt=new WeakMap;var jt=new WeakMap;var Kt=new WeakMap;var $t=new WeakMap;var qt=new WeakMap;var Jt=new WeakMap;var Zt=new WeakMap;var Qt=new WeakMap;var es=new WeakMap;var ts=new WeakMap;var ss=new WeakMap;var as=new WeakMap;var is=new WeakMap;var ls=new WeakMap;var rs=new WeakMap;var ns=new WeakSet;var ds=new WeakSet;var os=new WeakSet;var bs=new WeakSet;var cs=new WeakSet;var us=new WeakSet;var ps=new WeakSet;var vs=new WeakSet;var hs=new WeakSet;var fs=new WeakSet;var Hs=new WeakSet;var Fs=new WeakSet;var Ps=new WeakSet;var ms=new WeakSet;var gs=new WeakSet;var Ts=new WeakSet;var ys=new WeakSet;var ws=new WeakSet;var Is=new WeakSet;var Gs=new WeakSet;var Ss=new WeakSet;var Es=new WeakSet;var ks=new WeakSet;var Cs=new WeakSet;var As=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Cs.add(babelHelpers.assertThisInitialized(s));ks.add(babelHelpers.assertThisInitialized(s));Es.add(babelHelpers.assertThisInitialized(s));Ss.add(babelHelpers.assertThisInitialized(s));Gs.add(babelHelpers.assertThisInitialized(s));Is.add(babelHelpers.assertThisInitialized(s));ws.add(babelHelpers.assertThisInitialized(s));ys.add(babelHelpers.assertThisInitialized(s));Ts.add(babelHelpers.assertThisInitialized(s));gs.add(babelHelpers.assertThisInitialized(s));ms.add(babelHelpers.assertThisInitialized(s));Ps.add(babelHelpers.assertThisInitialized(s));Fs.add(babelHelpers.assertThisInitialized(s));Hs.add(babelHelpers.assertThisInitialized(s));fs.add(babelHelpers.assertThisInitialized(s));hs.add(babelHelpers.assertThisInitialized(s));vs.add(babelHelpers.assertThisInitialized(s));ps.add(babelHelpers.assertThisInitialized(s));us.add(babelHelpers.assertThisInitialized(s));cs.add(babelHelpers.assertThisInitialized(s));bs.add(babelHelpers.assertThisInitialized(s));os.add(babelHelpers.assertThisInitialized(s));ds.add(babelHelpers.assertThisInitialized(s));ns.add(babelHelpers.assertThisInitialized(s));Xt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});xt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Ut.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Vt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Yt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});jt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Kt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});$t.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});qt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Jt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Zt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Qt.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});es.set(babelHelpers.assertThisInitialized(s),{writable:true,value:{requested:"",current:"",dropped:""}});ts.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ss.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});as.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});is.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});ls.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});rs.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});s.setEventNamespace("BX.Location.Widget.Autocomplete");if(!(e.addressFormat instanceof r.Format)){throw new Error("props.addressFormat must be type of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Vt,e.addressFormat);if(!(e.autocompleteService instanceof r.AutocompleteServiceBase)){throw new Error("props.autocompleteService must be type of AutocompleteServiceBase")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Jt,e.autocompleteService);if(!e.languageId){throw new Error("props.languageId must be defined")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ut,e.languageId);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Yt,e.sourceCode);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Xt,e.address);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),$t,e.presetLocationsProvider);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),jt,e.locationRepository||new r.LocationRepository);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Kt,e.userLocationPoint);Rt(babelHelpers.assertThisInitialized(s),Ps,$s).call(babelHelpers.assertThisInitialized(s),b.INITIAL);return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,Qt,t.inputNode);babelHelpers.classPrivateFieldSet(this,Xt,t.address);babelHelpers.classPrivateFieldSet(this,xt,new _t(babelHelpers.classPrivateFieldGet(this,Qt),babelHelpers.classPrivateFieldGet(this,Vt),babelHelpers.classPrivateFieldGet(this,Xt)));babelHelpers.classPrivateFieldGet(this,Qt).addEventListener("keydown",Rt(this,Is,ta).bind(this));babelHelpers.classPrivateFieldGet(this,Qt).addEventListener("keyup",Rt(this,Gs,sa).bind(this));babelHelpers.classPrivateFieldGet(this,Qt).addEventListener("focus",Rt(this,ps,xs).bind(this));babelHelpers.classPrivateFieldGet(this,Qt).addEventListener("focusout",Rt(this,us,Xs).bind(this));babelHelpers.classPrivateFieldGet(this,Qt).addEventListener("click",Rt(this,ns,Os).bind(this));babelHelpers.classPrivateFieldGet(this,Qt).addEventListener("paste",Rt(this,Ss,aa).bind(this));babelHelpers.classPrivateFieldSet(this,qt,new Ft({inputNode:t.inputNode,menuNode:t.menuNode}));babelHelpers.classPrivateFieldGet(this,qt).subscribe(Ft.onItemSelectedEvent,Rt(this,Fs,Ks).bind(this));document.addEventListener("click",Rt(this,hs,Vs).bind(this))}},{key:"onAddressChangedEventSubscribe",value:function e(s){this.subscribe(Bt(t,t,Ws),s)}},{key:"onStateChangedEventSubscribe",value:function e(s){this.subscribe(Bt(t,t,Ms),s)}},{key:"onSearchStartedEventSubscribe",value:function e(s){this.subscribe(Bt(t,t,_s),s)}},{key:"onSearchCompletedEventSubscribe",value:function e(s){this.subscribe(Bt(t,t,zs),s)}},{key:"onShowOnMapClickedEventSubscribe",value:function e(s){this.subscribe(Bt(t,t,Ls),s)}},{key:"showPrompt",value:function e(t){babelHelpers.classPrivateFieldGet(this,es).requested=t;babelHelpers.classPrivateFieldGet(this,es).current=t;babelHelpers.classPrivateFieldGet(this,es).dropped="";Rt(this,ks,la).call(this,t)}},{key:"closePrompt",value:function e(){if(babelHelpers.classPrivateFieldGet(this,qt)){babelHelpers.classPrivateFieldGet(this,qt).close()}}},{key:"isPromptShown",value:function e(){if(babelHelpers.classPrivateFieldGet(this,qt)){babelHelpers.classPrivateFieldGet(this,qt).isShown()}}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,as)){return}o.Event.unbindAll(this);if(babelHelpers.classPrivateFieldGet(this,qt)){babelHelpers.classPrivateFieldGet(this,qt).destroy();babelHelpers.classPrivateFieldSet(this,qt,null)}babelHelpers.classPrivateFieldSet(this,Zt,null);if(babelHelpers.classPrivateFieldGet(this,Qt)){babelHelpers.classPrivateFieldGet(this,Qt).removeEventListener("keydown",Rt(this,Is,ta));babelHelpers.classPrivateFieldGet(this,Qt).removeEventListener("keyup",Rt(this,Gs,sa));babelHelpers.classPrivateFieldGet(this,Qt).removeEventListener("focus",Rt(this,ps,xs));babelHelpers.classPrivateFieldGet(this,Qt).removeEventListener("focusout",Rt(this,us,Xs));babelHelpers.classPrivateFieldGet(this,Qt).removeEventListener("click",Rt(this,ns,Os));babelHelpers.classPrivateFieldGet(this,Qt).removeEventListener("paste",Rt(this,Ss,aa))}document.removeEventListener("click",Rt(this,hs,Vs));babelHelpers.classPrivateFieldSet(this,as,true)}},{key:"address",set:function e(t){babelHelpers.classPrivateFieldSet(this,Xt,t);if(babelHelpers.classPrivateFieldGet(this,xt)){babelHelpers.classPrivateFieldGet(this,xt).setValueFromAddress(babelHelpers.classPrivateFieldGet(this,Xt))}if(!t){babelHelpers.classPrivateFieldSet(this,ss,true)}},get:function e(){return babelHelpers.classPrivateFieldGet(this,Xt)}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,ts)}}]);return t}(d.EventEmitter);var Ws={writable:true,value:"onAddressChanged"};var Ms={writable:true,value:"onStateChanged"};var _s={writable:true,value:"onSearchStarted"};var zs={writable:true,value:"onSearchCompleted"};var Ls={writable:true,value:"onShowOnMapClicked"};var Os=function e(t){var s=babelHelpers.classPrivateFieldGet(this,xt).value;if(s.length===0){Rt(this,ds,Ns).call(this)}};var Ns=function e(){var t=babelHelpers.classPrivateFieldGet(this,$t).call(this);babelHelpers.classPrivateFieldGet(this,qt).setMenuItems(t,"");var s;if(t.length>0){s=o.Loc.getMessage("LOCATION_WIDGET_PICK_ADDRESS_OR_SHOW_ON_MAP")}else{s=o.Loc.getMessage("LOCATION_WIDGET_START_PRINTING_OR_SHOW_ON_MAP")}Rt(this,cs,Rs).call(this,s,null)};var Ds=function e(t){var s=o.Tag.render(Dt(),o.Loc.getMessage("LOCATION_WIDGET_SHOW_ON_MAP"));s.addEventListener("click",Rt(this,Hs,js).call(this,t));return s};var Bs=function e(t){return o.Tag.render(Nt(),t)};var Rs=function e(t,s){babelHelpers.classPrivateFieldGet(this,qt).getMenu().setBottomRightItemNode(Rt(this,os,Ds).call(this,s));babelHelpers.classPrivateFieldGet(this,qt).getMenu().setBottomLeftItemNode(Rt(this,bs,Bs).call(this,t));babelHelpers.classPrivateFieldGet(this,qt).getMenu().show()};var Xs=function e(t){if(babelHelpers.classPrivateFieldGet(this,as)){return}if(babelHelpers.classPrivateFieldGet(this,ts)===b.DATA_INPUTTING&&!(t.relatedTarget&&t.relatedTarget.getAttribute("data-role")==="location-widget-menu-item")){Rt(this,Ps,$s).call(this,b.DATA_SUPPOSED);var s=false;if(babelHelpers.classPrivateFieldGet(this,xt)){if(!babelHelpers.classPrivateFieldGet(this,Xt)||!babelHelpers.classPrivateFieldGet(this,xt).hasPureAddressString()){babelHelpers.classPrivateFieldSet(this,Xt,Rt(this,ys,Qs).call(this,babelHelpers.classPrivateFieldGet(this,xt).value));s=true}else if(babelHelpers.classPrivateFieldGet(this,xt).customTail!==""){babelHelpers.classPrivateFieldGet(this,Xt).setFieldValue(babelHelpers.classPrivateFieldGet(this,Vt).fieldForUnRecognized,babelHelpers.classPrivateFieldGet(this,xt).customTail);s=true}}if(s){Rt(this,gs,Js).call(this,[],{storeAsLastAddress:false})}}if(babelHelpers.classPrivateFieldGet(this,qt)){babelHelpers.classPrivateFieldGet(this,qt).close()}t.stopImmediatePropagation()};var xs=function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,as)){return}if(!babelHelpers.classPrivateFieldGet(this,Xt)){var s=r.Storage.getInstance().lastAddress;if(s&&s.fieldCollection.isFieldExists(r.AddressType.LOCALITY)&&!babelHelpers.classPrivateFieldGet(this,ss)){var a={};a[r.AddressType.LOCALITY]=s.fieldCollection.getFieldValue(r.AddressType.LOCALITY);if(s.fieldCollection.isFieldExists(r.AddressType.COUNTRY)){a[r.AddressType.COUNTRY]=s.fieldCollection.getFieldValue(r.AddressType.COUNTRY)}if(s.fieldCollection.isFieldExists(r.AddressType.ADM_LEVEL_1)){a[r.AddressType.ADM_LEVEL_1]=s.fieldCollection.getFieldValue(r.AddressType.ADM_LEVEL_1)}if(["RU","RU_2"].includes(babelHelpers.classPrivateFieldGet(this,Vt).code)){a[r.AddressType.ADDRESS_LINE_2]=", "}babelHelpers.classPrivateFieldSet(this,Xt,new r.Address({languageId:s.languageId,fieldCollection:a}));babelHelpers.classPrivateFieldGet(this,xt).setValueFromAddress(babelHelpers.classPrivateFieldGet(this,Xt));Rt(this,Ps,$s).call(this,b.DATA_SUPPOSED);Rt(this,gs,Js).call(this,[],{storeAsLastAddress:false});setTimeout(function(){BX.setCaretPosition(babelHelpers.classPrivateFieldGet(t,Qt),babelHelpers.classPrivateFieldGet(t,Qt).value.length)},0)}}else{if(babelHelpers.classPrivateFieldGet(this,Xt)&&(!babelHelpers.classPrivateFieldGet(this,Xt).location||!babelHelpers.classPrivateFieldGet(this,Xt).location.hasExternalRelation())&&babelHelpers.classPrivateFieldGet(this,xt).value.length>0){this.showPrompt(babelHelpers.classPrivateFieldGet(this,xt).value)}}};var Us=function e(){var t={};t.biasPoint=babelHelpers.classPrivateFieldGet(this,Kt);if(babelHelpers.classPrivateFieldGet(this,Xt)&&babelHelpers.classPrivateFieldGet(this,Xt).latitude&&babelHelpers.classPrivateFieldGet(this,Xt).longitude){t.biasPoint=new r.Point(babelHelpers.classPrivateFieldGet(this,Xt).latitude,babelHelpers.classPrivateFieldGet(this,Xt).longitude)}return t};var Vs=function e(t){if(babelHelpers.classPrivateFieldGet(this,as)){return}if(t.target===babelHelpers.classPrivateFieldGet(this,Qt)){return}if(babelHelpers.classPrivateFieldGet(this,qt).isShown()){babelHelpers.classPrivateFieldGet(this,qt).close()}};var Ys=function e(t,s){var a=this;if(Array.isArray(t)&&t.length>0){if(t.length===1&&babelHelpers.classPrivateFieldGet(this,Xt)&&babelHelpers.classPrivateFieldGet(this,Xt).location&&babelHelpers.classPrivateFieldGet(this,Xt).location.externalId&&babelHelpers.classPrivateFieldGet(this,Xt).location.externalId===t[0].externalId){this.closePrompt();return}babelHelpers.classPrivateFieldGet(this,qt).setMenuItems(t,babelHelpers.classPrivateFieldGet(this,es).requested,this.address);Rt(this,cs,Rs).call(this,o.Loc.getMessage("LOCATION_WIDGET_PICK_ADDRESS_OR_SHOW_ON_MAP"),t[0])}else{babelHelpers.classPrivateFieldGet(this,qt).getMenu().clearItems();babelHelpers.classPrivateFieldGet(this,qt).getMenu().addMenuItem({id:"notFound",html:"<span>".concat(o.Loc.getMessage("LOCATION_WIDGET_PROMPT_ADDRESS_NOT_FOUND"),"</span>"),onclick:function e(t,s){babelHelpers.classPrivateFieldGet(a,qt).close()}});Rt(this,cs,Rs).call(this,o.Loc.getMessage("LOCATION_WIDGET_CHECK_ADDRESS_OR_SHOW_ON_MAP"),null)}};var js=function e(t){var s=this;return function(){if(t){Rt(s,ms,qs).call(s,t);return}setTimeout(function(){s.emit(Bt(As,As,Ls))},1)}};var Ks=function e(t){if(t.data.location){Rt(this,ms,qs).call(this,t.data.location)}};var $s=function e(t){babelHelpers.classPrivateFieldSet(this,ts,t);this.emit(Bt(As,As,Ms),{state:babelHelpers.classPrivateFieldGet(this,ts)})};var qs=function e(t){var s=this;var a;Rt(this,Ps,$s).call(this,b.DATA_SELECTED);if(t){if(t.hasExternalRelation()&&babelHelpers.classPrivateFieldGet(this,Yt)===t.sourceCode){a=Rt(this,Ts,Zs).call(this,t).then(function(e){if(t.address&&t.address.getFieldValue(r.AddressType.ADDRESS_LINE_2)){var a="";if(e.address.getFieldValue(r.AddressType.ADDRESS_LINE_2)){a=e.address.getFieldValue(r.AddressType.ADDRESS_LINE_2);a+=", "}a+=t.address.getFieldValue(r.AddressType.ADDRESS_LINE_2);e.address.setFieldValue(r.AddressType.ADDRESS_LINE_2,a)}Rt(s,Es,ia).call(s,e,0);return true},function(e){return r.ErrorPublisher.getInstance().notify(e.errors)})}else{a=new Promise(function(e){setTimeout(function(){Rt(s,Es,ia).call(s,t,0);e()},0)})}}else{a=new Promise(function(e){setTimeout(function(){Rt(s,Es,ia).call(s,null,0);e()},0)})}return a};var Js=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.emit(Bt(As,As,Ws),{address:babelHelpers.classPrivateFieldGet(this,Xt),excludeSetAddressFeatures:t,options:s})};var Zs=function e(t){var s=this;Rt(this,Ps,$s).call(this,b.DATA_LOADING);return babelHelpers.classPrivateFieldGet(this,jt).findByExternalId(t.externalId,t.sourceCode,t.languageId).then(function(e){Rt(s,Ps,$s).call(s,b.DATA_LOADED);var a;if(e.latitude!=="0"&&e.longitude!=="0"&&e!==""){a=e;a.name=t.name}else{a=t}return a},function(e){r.ErrorPublisher.getInstance().notify(e.errors)})};var Qs=function e(t){var s=new r.Address({languageId:babelHelpers.classPrivateFieldGet(this,Ut)});s.setFieldValue(babelHelpers.classPrivateFieldGet(this,Vt).fieldForUnRecognized,t);return s};var ea=function e(t){babelHelpers.classPrivateFieldSet(this,Xt,t?t.toAddress():null);babelHelpers.classPrivateFieldGet(this,xt).setValueFromAddress(babelHelpers.classPrivateFieldGet(this,Xt));Rt(this,gs,Js).call(this)};var ta=function e(t){if(!(babelHelpers.classPrivateFieldGet(this,Qt)&&babelHelpers.classPrivateFieldGet(this,Qt).selectionStart===0&&babelHelpers.classPrivateFieldGet(this,Qt).selectionEnd===babelHelpers.classPrivateFieldGet(this,Qt).value.length)){return}if(t.code==="Backspace"||t.code==="Delete"||t.code==="KeyV"&&(t.ctrlKey||t.metaKey)||t.code==="KeyX"&&(t.ctrlKey||t.metaKey)||t.code==="Insert"&&t.shiftKey||!(t.ctrlKey||t.metaKey)&&babelHelpers.toConsumableArray(t.key).length===1){this.address=null;Rt(this,gs,Js).call(this)}};var sa=function e(t){var s=this;if(babelHelpers.classPrivateFieldGet(this,as)){return}if(babelHelpers.classPrivateFieldGet(this,ts)!==b.DATA_INPUTTING&&babelHelpers.classPrivateFieldGet(this,xt).isChanged()){Rt(this,Ps,$s).call(this,b.DATA_INPUTTING)}if(babelHelpers.classPrivateFieldGet(this,qt).isShown()){var a;var i=700;switch(t.code){case"NumpadEnter":case"Enter":if(babelHelpers.classPrivateFieldGet(this,qt).isItemChosen()){Rt(this,ms,qs).call(this,babelHelpers.classPrivateFieldGet(this,qt).getChosenItem()).then(function(){babelHelpers.classPrivateFieldGet(s,qt).close()},function(e){return BX.debug(e)})}return;case"Tab":case"Escape":Rt(this,Ps,$s).call(this,b.DATA_SUPPOSED);Rt(this,gs,Js).call(this);babelHelpers.classPrivateFieldGet(this,qt).close();return;case"ArrowUp":a=babelHelpers.classPrivateFieldGet(this,qt).choosePrevItem();if(a&&a.address){Rt(this,Es,ia).call(this,a,i)}return;case"ArrowDown":a=babelHelpers.classPrivateFieldGet(this,qt).chooseNextItem();if(a&&a.address){Rt(this,Es,ia).call(this,a,i)}return}}if(babelHelpers.classPrivateFieldGet(this,xt).isChanged()){babelHelpers.classPrivateFieldGet(this,xt).actualize();this.showPrompt(babelHelpers.classPrivateFieldGet(this,xt).value)}if(babelHelpers.classPrivateFieldGet(this,xt).value.length===0){Rt(this,ds,Ns).call(this)}};var aa=function e(){var t=this;setTimeout(function(){if(babelHelpers.classPrivateFieldGet(t,ts)!==b.DATA_INPUTTING&&babelHelpers.classPrivateFieldGet(t,xt).isChanged()){Rt(t,Ps,$s).call(t,b.DATA_INPUTTING)}if(babelHelpers.classPrivateFieldGet(t,xt).isChanged()){babelHelpers.classPrivateFieldGet(t,xt).actualize();t.showPrompt(babelHelpers.classPrivateFieldGet(t,xt).value)}},0)};var ia=function e(t,s){var a=this;if(babelHelpers.classPrivateFieldGet(this,rs)!==null){clearTimeout(babelHelpers.classPrivateFieldGet(this,rs))}babelHelpers.classPrivateFieldSet(this,rs,setTimeout(function(){Rt(a,ws,ea).call(a,t)},s))};var la=function e(t){if(t.length<=3){return}if(babelHelpers.classPrivateFieldGet(this,Zt)!==null){clearTimeout(babelHelpers.classPrivateFieldGet(this,Zt))}babelHelpers.classPrivateFieldSet(this,Zt,Rt(this,Cs,ra).call(this,t))};var ra=function e(t){var s=this;return setTimeout(function(){if(babelHelpers.classPrivateFieldGet(s,is)){clearTimeout(babelHelpers.classPrivateFieldGet(s,Zt));babelHelpers.classPrivateFieldSet(s,Zt,Rt(s,Cs,e).call(s,t));babelHelpers.classPrivateFieldSet(s,ls,true);return}babelHelpers.classPrivateFieldSet(s,ls,false);s.emit(Bt(As,As,_s));babelHelpers.classPrivateFieldSet(s,is,true);var a=Rt(s,vs,Us).call(s);babelHelpers.classPrivateFieldGet(s,Jt).autocomplete(t,a).then(function(e){babelHelpers.classPrivateFieldSet(s,Zt,null);if(!babelHelpers.classPrivateFieldGet(s,ls)){Rt(s,fs,Ys).call(s,e,a);s.emit(Bt(As,As,zs))}babelHelpers.classPrivateFieldSet(s,is,false)},function(e){if(!babelHelpers.classPrivateFieldGet(s,ls)){s.emit(Bt(As,As,zs))}babelHelpers.classPrivateFieldSet(s,is,false);BX.debug(e)})},300)};function na(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-photo-item-block">\n\t\t\t\t<span class="location-map-photo-item-block-image-block-inner">\n\t\t\t\t\t','\n\t\t\t\t\t<span \n\t\t\t\t\t\tdata-viewer data-viewer-type="image" \n\t\t\t\t\t\tdata-src="','" \n\t\t\t\t\t\tdata-title="','"\n\t\t\t\t\t\tclass="location-map-item-photo-image" \n\t\t\t\t\t\tdata-viewer-group-by="','"\n\t\t\t\t\t\tstyle="background-image: url(',');">\t\t\t\t\t\t\t\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>']);na=function t(){return e};return e}function da(){var e=babelHelpers.taggedTemplateLiteral(['<span class="location-map-item-description">',"</span>"]);da=function t(){return e};return e}var oa=new WeakMap;var ba=new WeakMap;var ca=new WeakMap;var ua=new WeakMap;var pa=new WeakMap;var va=function(){function e(t){babelHelpers.classCallCheck(this,e);oa.set(this,{writable:true,value:void 0});ba.set(this,{writable:true,value:void 0});ca.set(this,{writable:true,value:void 0});ua.set(this,{writable:true,value:void 0});pa.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,ba,t.url);babelHelpers.classPrivateFieldSet(this,ca,t.link||"");babelHelpers.classPrivateFieldSet(this,oa,t.description||"");babelHelpers.classPrivateFieldSet(this,ua,t.location);babelHelpers.classPrivateFieldSet(this,pa,t.title||"")}babelHelpers.createClass(e,[{key:"render",value:function e(){var t="";if(babelHelpers.classPrivateFieldGet(this,oa)){t=o.Tag.render(da(),babelHelpers.classPrivateFieldGet(this,oa))}return o.Tag.render(na(),t,babelHelpers.classPrivateFieldGet(this,ca),babelHelpers.classPrivateFieldGet(this,pa),babelHelpers.classPrivateFieldGet(this,ua).externalId,babelHelpers.classPrivateFieldGet(this,ba))}}]);return e}();function ha(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=fa(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function fa(e,t){if(!e)return;if(typeof e==="string")return Ha(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Ha(e,t)}function Ha(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function Fa(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="location-map-photo-container">\n\t\t\t\t',"\n\t\t\t</div>"]);Fa=function t(){return e};return e}function Pa(){var e=babelHelpers.taggedTemplateLiteral(['\t\t\t\t\t\n\t\t\t\t<div class="location-map-photo-inner">\t\t\t\t\t\n\t\t\t\t</div>']);Pa=function t(){return e};return e}function ma(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var ga=new WeakMap;var Ta=new WeakMap;var ya=new WeakMap;var wa=new WeakMap;var Ia=new WeakMap;var Ga=new WeakMap;var Sa=new WeakMap;var Ea=new WeakMap;var ka=new WeakSet;var Ca=new WeakSet;var Aa=function(){function e(t){babelHelpers.classCallCheck(this,e);Ca.add(this);ka.add(this);ga.set(this,{writable:true,value:[]});Ta.set(this,{writable:true,value:null});ya.set(this,{writable:true,value:null});wa.set(this,{writable:true,value:void 0});Ia.set(this,{writable:true,value:void 0});Ga.set(this,{writable:true,value:void 0});Sa.set(this,{writable:true,value:void 0});Ea.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,wa,t.thumbnailHeight);babelHelpers.classPrivateFieldSet(this,Ia,t.thumbnailWidth);babelHelpers.classPrivateFieldSet(this,Sa,t.maxPhotoCount);babelHelpers.classPrivateFieldSet(this,Ga,t.photoService)}babelHelpers.createClass(e,[{key:"refresh",value:function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Ea)){babelHelpers.classPrivateFieldGet(this,Ga).requestPhotos({location:babelHelpers.classPrivateFieldGet(this,Ea),thumbnailHeight:babelHelpers.classPrivateFieldGet(this,wa),thumbnailWidth:babelHelpers.classPrivateFieldGet(this,Ia),maxPhotoCount:babelHelpers.classPrivateFieldGet(this,Sa)}).then(function(e){if(Array.isArray(e)&&e.length>0){ma(t,ka,Wa).call(t,e);t.show()}else{t.hide()}})}else{this.hide()}}},{key:"hide",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Ta)){babelHelpers.classPrivateFieldGet(this,Ta).style.display="none"}}},{key:"isHidden",value:function e(){return!babelHelpers.classPrivateFieldGet(this,Ta)||babelHelpers.classPrivateFieldGet(this,Ta).clientWidth<=0}},{key:"show",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Ta)){babelHelpers.classPrivateFieldGet(this,Ta).style.display="block"}}},{key:"render",value:function e(){babelHelpers.classPrivateFieldSet(this,ya,o.Tag.render(Pa()));babelHelpers.classPrivateFieldSet(this,Ta,o.Tag.render(Fa(),babelHelpers.classPrivateFieldGet(this,ya)));return babelHelpers.classPrivateFieldGet(this,Ta)}},{key:"location",set:function e(t){babelHelpers.classPrivateFieldSet(this,Ea,t);this.refresh()}}]);return e}();var Wa=function e(t){if(!babelHelpers.classPrivateFieldGet(this,Ea)){return}var s=[];var a=ha(t),i;try{for(a.s();!(i=a.n()).done;){var l=i.value;s.push(new va({url:l.thumbnail.url,link:l.url,location:babelHelpers.classPrivateFieldGet(this,Ea),title:babelHelpers.classPrivateFieldGet(this,Ea).name+" ( "+BX.util.strip_tags(l.description)+" )"}))}}catch(e){a.e(e)}finally{a.f()}if(!Array.isArray(s)){BX.debug("Wrong type of photos. Must be array");return}babelHelpers.classPrivateFieldSet(this,ga,[]);for(var r=0,n=s;r<n.length;r++){var d=n[r];babelHelpers.classPrivateFieldGet(this,ga).push(d)}if(babelHelpers.classPrivateFieldGet(this,ga).length>0&&babelHelpers.classPrivateFieldGet(this,ya)){var o=babelHelpers.classPrivateFieldGet(this,ga)?ma(this,Ca,Ma).call(this,babelHelpers.classPrivateFieldGet(this,ga)):"";babelHelpers.classPrivateFieldGet(this,ya).innerHTML="";if(o.length>0){var b=ha(o),c;try{for(b.s();!(c=b.n()).done;){var u=c.value;babelHelpers.classPrivateFieldGet(this,ya).appendChild(u)}}catch(e){b.e(e)}finally{b.f()}}}};var Ma=function e(t){var s=[];var a=ha(t),i;try{for(a.s();!(i=a.n()).done;){var l=i.value;s.push(l.render())}}catch(e){a.e(e)}finally{a.f()}return s};function _a(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-title-6">\n\t\t\t\t',"\n\t\t\t</div>"]);_a=function t(){return e};return e}function za(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-entity-editor-content-block">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t</div>"]);za=function t(){return e};return e}function La(){var e=babelHelpers.taggedTemplateLiteral(['<input type="text" class="ui-ctl-element" value="','">']);La=function t(){return e};return e}function Oa(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-entity-editor-content-block ui-entity-editor-field-text">\n\t\t\t\t<div class="ui-entity-editor-block-title">\n\t\t\t\t\t<label class="ui-entity-editor-block-title-text">',":</label>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>"]);Oa=function t(){return e};return e}function Na(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}function Da(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}var Ba=new WeakMap;var Ra=new WeakMap;var Xa=new WeakMap;var xa=new WeakMap;var Ua=new WeakMap;var Va=new WeakMap;var Ya=new WeakMap;var ja=new WeakMap;var Ka=new WeakMap;var $a=new WeakSet;var qa=new WeakSet;var Ja=new WeakSet;var Za=new WeakSet;var Qa=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Za.add(babelHelpers.assertThisInitialized(s));Ja.add(babelHelpers.assertThisInitialized(s));qa.add(babelHelpers.assertThisInitialized(s));$a.add(babelHelpers.assertThisInitialized(s));Ba.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ra.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Xa.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});xa.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ua.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Va.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Ya.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ja.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Ka.set(babelHelpers.assertThisInitialized(s),{writable:true,value:b.INITIAL});s.setEventNamespace("BX.Location.Widget.Field");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ba,e.title);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Xa,e.type);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),xa,e.sort);return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){babelHelpers.classPrivateFieldSet(this,Ra,typeof t.value==="string"?t.value:"");if(!r.ControlMode.isValid(t.mode)){BX.debug("props.mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(this,Ua,t.mode);babelHelpers.classPrivateFieldSet(this,ja,o.Tag.render(Oa(),babelHelpers.classPrivateFieldGet(this,Ba)));if(babelHelpers.classPrivateFieldGet(this,Ua)===r.ControlMode.edit){Na(this,qa,ai).call(this,babelHelpers.classPrivateFieldGet(this,ja))}else{Na(this,Ja,ii).call(this,babelHelpers.classPrivateFieldGet(this,ja))}return babelHelpers.classPrivateFieldGet(this,ja)}},{key:"subscribeOnValueChangedEvent",value:function e(s){this.subscribe(Da(t,t,ei),s)}},{key:"subscribeOnStateChangedEvent",value:function e(s){this.subscribe(Da(t,t,ti),s)}},{key:"destroy",value:function e(){o.Dom.remove(babelHelpers.classPrivateFieldGet(this,ja));o.Event.unbindAll(this);babelHelpers.classPrivateFieldSet(this,ja,null)}},{key:"container",get:function e(){return babelHelpers.classPrivateFieldGet(this,ja)}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,Ka)}},{key:"type",set:function e(t){babelHelpers.classPrivateFieldSet(this,Xa,t)},get:function e(){return babelHelpers.classPrivateFieldGet(this,Xa)}},{key:"sort",set:function e(t){babelHelpers.classPrivateFieldSet(this,xa,t)},get:function e(){return babelHelpers.classPrivateFieldGet(this,xa)}},{key:"value",set:function e(t){babelHelpers.classPrivateFieldSet(this,Ra,typeof t==="string"?t:"");Na(this,Za,li).call(this)},get:function e(){return babelHelpers.classPrivateFieldGet(this,Ra)}}]);return t}(d.EventEmitter);var ei={writable:true,value:"onValueChanged"};var ti={writable:true,value:"onStateChanged"};var si=function e(t){babelHelpers.classPrivateFieldSet(this,Ka,t);this.emit(Da(Qa,Qa,ti),{state:babelHelpers.classPrivateFieldGet(this,Ka)})};var ai=function e(t){var s=this;babelHelpers.classPrivateFieldSet(this,Va,o.Tag.render(La(),o.Text.encode(babelHelpers.classPrivateFieldGet(this,Ra))));babelHelpers.classPrivateFieldSet(this,Ya,null);o.Event.bind(babelHelpers.classPrivateFieldGet(this,Va),"focus",function(e){Na(s,$a,si).call(s,b.DATA_INPUTTING)});o.Event.bind(babelHelpers.classPrivateFieldGet(this,Va),"focusout",function(e){Na(s,$a,si).call(s,b.DATA_SELECTED)});o.Event.bind(babelHelpers.classPrivateFieldGet(this,Va),"change",function(e){Na(s,$a,si).call(s,b.DATA_SELECTED);babelHelpers.classPrivateFieldSet(s,Ra,babelHelpers.classPrivateFieldGet(s,Va).value);s.emit(Da(Qa,Qa,ei),{value:s})});t.appendChild(o.Tag.render(za(),babelHelpers.classPrivateFieldGet(this,Va)))};var ii=function e(t){babelHelpers.classPrivateFieldSet(this,Va,null);babelHelpers.classPrivateFieldSet(this,Ya,o.Tag.render(_a(),o.Text.encode(babelHelpers.classPrivateFieldGet(this,Ra))));t.appendChild(babelHelpers.classPrivateFieldGet(this,Ya))};var li=function e(){if(babelHelpers.classPrivateFieldGet(this,Ua)===r.ControlMode.edit){babelHelpers.classPrivateFieldGet(this,Va).value=babelHelpers.classPrivateFieldGet(this,Ra)}else{babelHelpers.classPrivateFieldGet(this,Ya).innerHTML=o.Text.encode(babelHelpers.classPrivateFieldGet(this,Ra))}};function ri(e,t){var s;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=ni(e))||t&&e&&typeof e.length==="number"){if(s)e=s;var a=0;var i=function e(){};return{s:i,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,r=false,n;return{s:function t(){s=e[Symbol.iterator]()},n:function e(){var t=s.next();l=t.done;return t},e:function e(t){r=true;n=t},f:function e(){try{if(!l&&s.return!=null)s.return()}finally{if(r)throw n}}}}function ni(e,t){if(!e)return;if(typeof e==="string")return di(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor)s=e.constructor.name;if(s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return di(e,t)}function di(e,t){if(t==null||t>e.length)t=e.length;for(var s=0,a=new Array(t);s<t;s++){a[s]=e[s]}return a}function oi(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function bi(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var ci=new WeakMap;var ui=new WeakMap;var pi=new WeakMap;var vi=new WeakMap;var hi=new WeakMap;var fi=new WeakMap;var Hi=new WeakMap;var Fi=new WeakSet;var Pi=new WeakSet;var mi=new WeakSet;var gi=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));mi.add(babelHelpers.assertThisInitialized(s));Pi.add(babelHelpers.assertThisInitialized(s));Fi.add(babelHelpers.assertThisInitialized(s));ci.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});ui.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});pi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});vi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:[]});hi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});fi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Hi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});s.setEventNamespace("BX.Location.Widget.Fields");if(!(e.addressFormat instanceof r.Format)){BX.debug("addressFormat must be instance of Format")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),ui,e.addressFormat);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),hi,e.languageId);bi(babelHelpers.assertThisInitialized(s),Fi,wi).call(babelHelpers.assertThisInitialized(s));return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){if(t.address&&!(t.address instanceof r.Address)){BX.debug("props.address must be instance of Address")}babelHelpers.classPrivateFieldSet(this,ci,t.address);if(!r.ControlMode.isValid(t.mode)){BX.debug("props.mode must be valid ControlMode")}babelHelpers.classPrivateFieldSet(this,pi,t.mode);if(!o.Type.isDomNode(t.container)){BX.debug("props.container must be dom node")}babelHelpers.classPrivateFieldSet(this,fi,t.container);var s=ri(babelHelpers.classPrivateFieldGet(this,vi)),a;try{for(s.s();!(a=s.n()).done;){var i=a.value;var l=babelHelpers.classPrivateFieldGet(this,ci)?babelHelpers.classPrivateFieldGet(this,ci).getFieldValue(i.type):"";if(babelHelpers.classPrivateFieldGet(this,pi)===r.ControlMode.view&&!l){continue}var n=i.render({value:l,mode:babelHelpers.classPrivateFieldGet(this,pi)});babelHelpers.classPrivateFieldGet(this,fi).appendChild(n)}}catch(e){s.e(e)}finally{s.f()}}},{key:"subscribeOnAddressChangedEvent",value:function e(s){this.subscribe(oi(t,t,Ti),s)}},{key:"destroy",value:function e(){o.Event.unbindAll(this);var t=ri(babelHelpers.classPrivateFieldGet(this,vi)),s;try{for(t.s();!(s=t.n()).done;){var a=s.value;a.destroy()}}catch(e){t.e(e)}finally{t.f()}o.Dom.clean(babelHelpers.classPrivateFieldGet(this,fi))}},{key:"subscribeOnStateChangedEvent",value:function e(s){this.subscribe(oi(t,t,yi),s)}},{key:"address",set:function e(t){if(t&&!(t instanceof r.Address)){BX.debug("address must be instance of Address")}babelHelpers.classPrivateFieldSet(this,ci,t);var s=ri(babelHelpers.classPrivateFieldGet(this,vi)),a;try{for(s.s();!(a=s.n()).done;){var i=a.value;i.value=babelHelpers.classPrivateFieldGet(this,ci)?babelHelpers.classPrivateFieldGet(this,ci).getFieldValue(i.type):""}}catch(e){s.e(e)}finally{s.f()}}},{key:"state",get:function e(){return babelHelpers.classPrivateFieldGet(this,Hi)}}]);return t}(d.EventEmitter);var Ti={writable:true,value:"onAddressChanged"};var yi={writable:true,value:"onStateChanged"};var wi=function e(){var t=this;var s=function e(s){if(!babelHelpers.classPrivateFieldGet(t,ui).fieldCollection.fields.hasOwnProperty(s)){return"continue"}var a=babelHelpers.classPrivateFieldGet(t,ui).fieldCollection.fields[s];var i=new Qa({title:a.name,type:a.type,sort:a.sort});i.subscribeOnValueChangedEvent(function(e){bi(t,Pi,Ii).call(t,i)});i.subscribeOnStateChangedEvent(function(e){var s=e.getData();bi(t,mi,Gi).call(t,s.state)});babelHelpers.classPrivateFieldGet(t,vi).push(i)};for(var a in babelHelpers.classPrivateFieldGet(this,ui).fieldCollection.fields){var i=s(a);if(i==="continue")continue}babelHelpers.classPrivateFieldGet(this,vi).sort(function(e,t){return e.sort-t.sort})};var Ii=function e(t){if(!babelHelpers.classPrivateFieldGet(this,ci)){babelHelpers.classPrivateFieldSet(this,ci,new r.Address({languageId:babelHelpers.classPrivateFieldGet(this,hi)}))}babelHelpers.classPrivateFieldGet(this,ci).setFieldValue(t.type,t.value);if(t.type!==babelHelpers.classPrivateFieldGet(this,ui).fieldForUnRecognized){babelHelpers.classPrivateFieldGet(this,ci).location=null;babelHelpers.classPrivateFieldGet(this,ci).latitude="";babelHelpers.classPrivateFieldGet(this,ci).longitude=""}this.emit(oi(gi,gi,Ti),{address:babelHelpers.classPrivateFieldGet(this,ci),changedField:t})};var Gi=function e(t){babelHelpers.classPrivateFieldSet(this,Hi,t);this.emit(oi(gi,gi,yi),{state:babelHelpers.classPrivateFieldGet(this,Hi)})};var Si=new WeakMap;var Ei=new WeakMap;var ki=new WeakMap;var Ci=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Si.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Ei.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});ki.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});if(!(e.map instanceof J)){BX.debug("props.map must be instance of MapPopup")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Si,e.map);babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Si).onChangedEventSubscribe(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),ki).setAddressByFeature(t.address,babelHelpers.assertThisInitialized(s))});return s}babelHelpers.createClass(t,[{key:"showMap",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!babelHelpers.classPrivateFieldGet(this,Si).isShown()){babelHelpers.classPrivateFieldGet(this,Si).show(t)}}},{key:"closeMap",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Si).isShown()){babelHelpers.classPrivateFieldGet(this,Si).close()}babelHelpers.classPrivateFieldGet(this,Si).bindelement=babelHelpers.classPrivateFieldGet(this,Ei)}},{key:"resetView",value:function e(){this.closeMap()}},{key:"render",value:function e(t){if(!o.Type.isDomNode(t.mapBindElement)){BX.debug("props.mapBindElement  must be instance of Element")}babelHelpers.classPrivateFieldSet(this,Ei,t.mapBindElement);babelHelpers.classPrivateFieldGet(this,Si).render({bindElement:t.mapBindElement,address:babelHelpers.classPrivateFieldGet(this,ki).address,mode:babelHelpers.classPrivateFieldGet(this,ki).mode})}},{key:"setAddress",value:function e(t){if(this.addressWidget.state===b.DATA_INPUTTING){return}babelHelpers.classPrivateFieldGet(this,Si).address=t}},{key:"setAddressWidget",value:function e(t){babelHelpers.classPrivateFieldSet(this,ki,t)}},{key:"setMode",value:function e(t){babelHelpers.classPrivateFieldGet(this,Si).mode=t}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldGet(this,Si).destroy();babelHelpers.classPrivateFieldSet(this,Si,null)}},{key:"map",get:function e(){return babelHelpers.classPrivateFieldGet(this,Si)}},{key:"addressWidget",get:function e(){return babelHelpers.classPrivateFieldGet(this,ki)}},{key:"mapBindElement",get:function e(){return babelHelpers.classPrivateFieldGet(this,Ei)}}]);return t}(be);var Ai=new WeakMap;var Wi=new WeakMap;var Mi=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Ai.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});Wi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});if(!(e.autocomplete instanceof As)){BX.debug("props.autocomplete  must be instance of Autocomplete")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),Ai,e.autocomplete);babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Ai).onAddressChangedEventSubscribe(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Wi).setAddressByFeature(t.address,babelHelpers.assertThisInitialized(s),t.excludeSetAddressFeatures,t.options)});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Ai).onStateChangedEventSubscribe(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Wi).setStateByFeature(t.state)});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Ai).onSearchStartedEventSubscribe(function(e){var a=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Wi).emitFeatureEvent({feature:babelHelpers.assertThisInitialized(s),eventCode:t.searchStartedEvent,payload:a})});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Ai).onSearchCompletedEventSubscribe(function(e){var a=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Wi).emitFeatureEvent({feature:babelHelpers.assertThisInitialized(s),eventCode:t.searchCompletedEvent,payload:a})});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Ai).onShowOnMapClickedEventSubscribe(function(e){var a=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),Wi).emitFeatureEvent({feature:babelHelpers.assertThisInitialized(s),eventCode:t.showOnMapClickedEvent,payload:a})});return s}babelHelpers.createClass(t,[{key:"resetView",value:function e(){babelHelpers.classPrivateFieldGet(this,Ai).closePrompt()}},{key:"render",value:function e(t){if(babelHelpers.classPrivateFieldGet(this,Wi).mode===r.ControlMode.edit){babelHelpers.classPrivateFieldGet(this,Ai).render({inputNode:babelHelpers.classPrivateFieldGet(this,Wi).inputNode,menuNode:t.autocompleteMenuElement,address:babelHelpers.classPrivateFieldGet(this,Wi).address,mode:babelHelpers.classPrivateFieldGet(this,Wi).mode})}}},{key:"setAddress",value:function e(t){babelHelpers.classPrivateFieldGet(this,Ai).address=t}},{key:"setAddressWidget",value:function e(t){babelHelpers.classPrivateFieldSet(this,Wi,t)}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldGet(this,Ai).destroy();babelHelpers.classPrivateFieldSet(this,Ai,null)}}]);return t}(be);babelHelpers.defineProperty(Mi,"searchStartedEvent","searchStarted");babelHelpers.defineProperty(Mi,"searchCompletedEvent","searchCompleted");babelHelpers.defineProperty(Mi,"showOnMapClickedEvent","showOnMapClicked");var _i=new WeakMap;var zi=new WeakMap;var Li=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));_i.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});zi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});if(!(e.fields instanceof gi)){BX.debug("props.Fields must be instance of Fields")}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),_i,e.fields);babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),_i).subscribeOnAddressChangedEvent(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),zi).setAddressByFeature(t.address,babelHelpers.assertThisInitialized(s))});babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),_i).subscribeOnStateChangedEvent(function(e){var t=e.getData();babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),zi).setStateByFeature(t.state)});return s}babelHelpers.createClass(t,[{key:"render",value:function e(t){if(babelHelpers.classPrivateFieldGet(this,zi).mode===r.ControlMode.edit){if(!o.Type.isDomNode(t.fieldsContainer)){BX.debug("props.fieldsContainer  must be instance of Element")}babelHelpers.classPrivateFieldGet(this,_i).render({address:babelHelpers.classPrivateFieldGet(this,zi).address,mode:babelHelpers.classPrivateFieldGet(this,zi).mode,container:t.fieldsContainer})}}},{key:"setAddressWidget",value:function e(t){babelHelpers.classPrivateFieldSet(this,zi,t)}},{key:"setAddress",value:function e(t){babelHelpers.classPrivateFieldGet(this,_i).address=t}},{key:"setMode",value:function e(t){babelHelpers.classPrivateFieldGet(this,_i).mode=t}},{key:"destroy",value:function e(){babelHelpers.classPrivateFieldGet(this,_i).destroy();babelHelpers.classPrivateFieldSet(this,_i,null)}}]);return t}(be);function Oi(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var Ni=new WeakMap;var Di=new WeakMap;var Bi=new WeakMap;var Ri=new WeakMap;var Xi=new WeakMap;var xi=new WeakSet;var Ui=new WeakSet;var Vi=new WeakSet;var Yi=new WeakSet;var ji=function(e){babelHelpers.inherits(t,e);function t(){var e;var s;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++){i[l]=arguments[l]}s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i)));Yi.add(babelHelpers.assertThisInitialized(s));Vi.add(babelHelpers.assertThisInitialized(s));Ui.add(babelHelpers.assertThisInitialized(s));xi.add(babelHelpers.assertThisInitialized(s));Ni.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Di.set(babelHelpers.assertThisInitialized(s),{writable:true,value:700});Bi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:null});Ri.set(babelHelpers.assertThisInitialized(s),{writable:true,value:800});Xi.set(babelHelpers.assertThisInitialized(s),{writable:true,value:false});return s}babelHelpers.createClass(t,[{key:"render",value:function e(s){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"render",this).call(this,s);this.addressWidget.controlWrapper.addEventListener("click",Oi(this,xi,Ki).bind(this));this.addressWidget.controlWrapper.addEventListener("mouseover",Oi(this,Vi,qi).bind(this));this.addressWidget.controlWrapper.addEventListener("mouseout",Oi(this,Yi,Ji).bind(this));document.addEventListener("click",Oi(this,Ui,$i).bind(this));this.map.onMouseOverSubscribe(Oi(this,Vi,qi).bind(this));this.map.onMouseOutSubscribe(Oi(this,Yi,Ji).bind(this))}},{key:"setAddress",value:function e(t){if(!t){this.closeMap()}this.map.address=t;if(t&&this.addressWidget.state!==b.DATA_SUPPOSED){this.showMap()}}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Xi)){return}document.removeEventListener("click",Oi(this,Ui,$i));if(this.addressWidget.controlWrapper){this.addressWidget.controlWrapper.removeEventListener("click",Oi(this,xi,Ki));this.addressWidget.controlWrapper.removeEventListener("mouseover",Oi(this,Vi,qi));this.addressWidget.controlWrapper.removeEventListener("mouseout",Oi(this,Yi,Ji))}babelHelpers.classPrivateFieldSet(this,Ni,null);babelHelpers.classPrivateFieldSet(this,Bi,null);babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",this).call(this);babelHelpers.classPrivateFieldSet(this,Xi,true)}}]);return t}(Ci);var Ki=function e(t){if(babelHelpers.classPrivateFieldGet(this,Xi)){return}if(this.addressWidget.mode===r.ControlMode.view){if(this.map.isShown()){this.closeMap()}else{clearTimeout(babelHelpers.classPrivateFieldGet(this,Ni))}}else if(this.addressWidget.mode===r.ControlMode.edit&&this._saveResourceStrategy===false){if(this.addressWidget.address&&!this.map.isShown()&&t.target===this.addressWidget.inputNode){this.showMap()}}};var $i=function e(t){if(babelHelpers.classPrivateFieldGet(this,Xi)){return}if(this.addressWidget.inputNode!==t.target){this.closeMap()}};var qi=function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Xi)){return}clearTimeout(babelHelpers.classPrivateFieldGet(this,Ni));clearTimeout(babelHelpers.classPrivateFieldGet(this,Bi));if(this.addressWidget.mode!==r.ControlMode.view){return}if(this.addressWidget.address&&!this.map.isShown()){babelHelpers.classPrivateFieldSet(this,Ni,setTimeout(function(){t.showMap()},babelHelpers.classPrivateFieldGet(this,Di)))}};var Ji=function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Xi)){return}clearTimeout(babelHelpers.classPrivateFieldGet(this,Ni));clearTimeout(babelHelpers.classPrivateFieldGet(this,Bi));if(this.addressWidget.mode!==r.ControlMode.view){return}if(this.addressWidget.mode===r.ControlMode.view&&this.map.isShown()){babelHelpers.classPrivateFieldSet(this,Bi,setTimeout(function(){t.closeMap()},babelHelpers.classPrivateFieldGet(this,Ri)))}};var Zi=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"createAddressWidget",value:function e(t){var s=t.sourceCode||BX.message("LOCATION_WIDGET_SOURCE_CODE");var a=t.sourceParams||BX.message("LOCATION_WIDGET_SOURCE_PARAMS");var i=t.languageId||BX.message("LOCATION_WIDGET_LANGUAGE_ID");var l=t.sourceLanguageId||BX.message("LOCATION_WIDGET_SOURCE_LANGUAGE_ID");var n=new r.Location(JSON.parse(BX.message("LOCATION_WIDGET_USER_LOCATION_POINT")));var d=t.addressFormat||new r.Format(JSON.parse(BX.message("LOCATION_WIDGET_DEFAULT_FORMAT")));var o=t.presetLocationsProvider?t.presetLocationsProvider:function(){return t.presetLocationList?t.presetLocationList:[]};var b=[];if(!t.useFeatures||t.useFeatures.fields!==false){b.push(this.createFieldsFeature({addressFormat:d,languageId:i}))}var c=null;if(s&&a){try{c=this.createSource(s,a,i,l)}catch(e){if(e instanceof r.SourceCreationError){c=null}else{throw e}}}var u=null;if(c){if(!t.useFeatures||t.useFeatures.autocomplete!==false){b.push(this.createAutocompleteFeature({languageId:i,addressFormat:d,source:c,userLocationPoint:n,presetLocationsProvider:o}))}if(!t.useFeatures||t.useFeatures.map!==false){var p=!!a.showPhotos;var v=!!a.useGeocodingService;var h=80;var f=150;var H=p?5:0;var F="auto";u=this.createMapFeature({addressFormat:d,source:c,useGeocodingService:v,popupOptions:t.popupOptions,popupBindOptions:t.popupBindOptions,thumbnailHeight:t.thumbnailHeight||h,thumbnailWidth:t.thumbnailWidth||f,maxPhotoCount:t.maxPhotoCount||H,mapBehavior:t.mapBehavior||F,userLocationPoint:n});b.push(u)}}var P=new Ne({features:b,address:t.address,mode:t.mode,addressFormat:d,languageId:i});if(u){P.subscribeOnFeatureEvent(function(e){var t=e.getData();if(t.feature instanceof Mi&&t.eventCode===Mi.showOnMapClickedEvent){u.showMap(true)}})}return P}},{key:"createFieldsFeature",value:function e(t){var s=new gi({addressFormat:t.addressFormat,languageId:t.languageId});return new Li({fields:s})}},{key:"createAutocompleteFeature",value:function e(t){var s=new As({sourceCode:t.source.sourceCode,languageId:t.languageId,addressFormat:t.addressFormat,autocompleteService:t.source.autocompleteService,userLocationPoint:t.userLocationPoint,presetLocationsProvider:t.presetLocationsProvider});return new Mi({autocomplete:s})}},{key:"createMapFeature",value:function e(t){var s={cacheable:true,closeByEsc:true,className:"location-popup-window location-source-".concat(t.source.sourceCode),animation:"fading",angle:true,bindOptions:t.popupBindOptions};if(t.popupOptions){s=Object.assign(s,t.popupOptions)}var i=new w(s);var l=null;if(t.maxPhotoCount>0){l=new Aa({photoService:t.source.photoService,thumbnailHeight:t.thumbnailHeight,thumbnailWidth:t.thumbnailWidth,maxPhotoCount:t.maxPhotoCount})}var n={saveResourceStrategy:t.source.sourceCode===a.Google.code,map:new J({addressFormat:t.addressFormat,map:t.source.map,popup:i,gallery:l,locationRepository:new r.LocationRepository,geocodingService:t.useGeocodingService?t.source.geocodingService:null,userLocationPoint:t.userLocationPoint})};var d;if(t.mapBehavior==="manual"){d=new Ci(n)}else{d=new ji(n)}return d}},{key:"createSource",value:function e(t,i,l,r){var n=null;i.languageId=l;i.sourceLanguageId=r;if(t===a.Google.code){n=new a.Google(i)}else if(t===s.OSM.code){n=s.OSMFactory.createOSMSource(i)}else{throw new RangeError("Wrong source code")}return n}}]);return e}();function Qi(){var e=babelHelpers.taggedTemplateLiteral(['\t\t\t\n\t\t\t<span class="ui-link ui-link-secondary ui-entity-editor-block-title-link">\n\t\t\t\t',"\n\t\t\t</span>"]);Qi=function t(){return e};return e}function el(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function tl(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var sl=new WeakMap;var al=new WeakMap;var il=new WeakMap;var ll=new WeakSet;var rl=function(e){babelHelpers.inherits(t,e);function t(){var e;var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));ll.add(babelHelpers.assertThisInitialized(e));sl.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});al.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});il.set(babelHelpers.assertThisInitialized(e),{writable:true,value:["on","off"]});e.setEventNamespace("BX.Location.Widget.Switch");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),sl,s.state);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),il,s.titles);return e}babelHelpers.createClass(t,[{key:"render",value:function e(s){var a=this;babelHelpers.classPrivateFieldSet(this,al,o.Tag.render(Qi(),tl(this,ll,dl).call(this)));babelHelpers.classPrivateFieldGet(this,al).addEventListener("click",function(e){a.state=babelHelpers.classPrivateFieldGet(a,sl)===t.STATE_OFF?t.STATE_ON:t.STATE_OFF;a.emit(el(t,t,nl),{state:babelHelpers.classPrivateFieldGet(a,sl)});e.stopPropagation();return false});babelHelpers.classPrivateFieldGet(this,al).addEventListener("mouseover",function(e){e.stopPropagation()});return babelHelpers.classPrivateFieldGet(this,al)}},{key:"subscribeOnToggleEventSubscribe",value:function e(s){this.subscribe(el(t,t,nl),s)}},{key:"state",set:function e(t){babelHelpers.classPrivateFieldSet(this,sl,t);if(babelHelpers.classPrivateFieldGet(this,al)){babelHelpers.classPrivateFieldGet(this,al).innerHTML=tl(this,ll,dl).call(this)}},get:function e(){return babelHelpers.classPrivateFieldGet(this,sl)}}]);return t}(d.EventEmitter);babelHelpers.defineProperty(rl,"STATE_OFF",0);babelHelpers.defineProperty(rl,"STATE_ON",1);var nl={writable:true,value:"onToggleEvent"};var dl=function e(){return babelHelpers.classPrivateFieldGet(this,il)[babelHelpers.classPrivateFieldGet(this,sl)]};function ol(){var e=babelHelpers.taggedTemplateLiteral(['<div class="','"></div>']);ol=function t(){return e};return e}function bl(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}if(s.get){return s.get.call(e)}return s.value}function cl(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var ul=new WeakMap;var pl=new WeakMap;var vl=new WeakSet;var hl=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));vl.add(babelHelpers.assertThisInitialized(e));ul.set(babelHelpers.assertThisInitialized(e),{writable:true,value:t.TYPE_SEARCH});pl.set(babelHelpers.assertThisInitialized(e),{writable:true,value:void 0});e.setEventNamespace("BX.Location.Widget.Icon");return e}babelHelpers.createClass(t,[{key:"render",value:function e(s){var a=this;babelHelpers.classPrivateFieldSet(this,ul,s.type);babelHelpers.classPrivateFieldSet(this,pl,o.Tag.render(ol(),cl(this,vl,Hl).call(this,babelHelpers.classPrivateFieldGet(this,ul))));babelHelpers.classPrivateFieldGet(this,pl).addEventListener("click",function(e){a.emit(bl(t,t,fl))});return babelHelpers.classPrivateFieldGet(this,pl)}},{key:"subscribeOnClickEvent",value:function e(s){this.subscribe(bl(t,t,fl),s)}},{key:"type",set:function e(t){babelHelpers.classPrivateFieldSet(this,ul,t);if(babelHelpers.classPrivateFieldGet(this,pl)){babelHelpers.classPrivateFieldGet(this,pl).className=cl(this,vl,Hl).call(this,babelHelpers.classPrivateFieldGet(this,ul))}}}]);return t}(d.EventEmitter);var fl={writable:true,value:"onClick"};babelHelpers.defineProperty(hl,"TYPE_CLEAR","clear");babelHelpers.defineProperty(hl,"TYPE_SEARCH","search");babelHelpers.defineProperty(hl,"TYPE_LOADER","loader");var Hl=function e(t){var s="";if(t===hl.TYPE_CLEAR){s="ui-ctl-after ui-ctl-icon-btn ui-ctl-icon-clear"}else if(t===hl.TYPE_SEARCH){s="ui-ctl-after ui-ctl-icon-search"}else if(t===hl.TYPE_LOADER){s="ui-ctl-after ui-ctl-icon-loader"}else{BX.debug("Wrong icon type")}return s};function Fl(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-search-control-block">\n\t\t\t\t\t',"\n\t\t\t\t</div>"]);Fl=function t(){return e};return e}function Pl(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="location-search-control-block">\n\t\t\t\t\t\t<div class="ui-entity-editor-content-block-text">\n\t\t\t\t\t\t\t',"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"]);Pl=function t(){return e};return e}function ml(){var e=babelHelpers.taggedTemplateLiteral(['<span class="ui-link ui-link-dark ui-link-dotted">',"</span>"]);ml=function t(){return e};return e}function gl(){var e=babelHelpers.taggedTemplateLiteral(['<div class="location-fields-control-block"></div>']);gl=function t(){return e};return e}function Tl(){var e=babelHelpers.taggedTemplateLiteral(['\t\t\t\t\t\t    \n\t\t\t\t<div class="location-search-control-block">\t\t\t\t\t\n\t\t\t\t\t',"\n\t\t\t\t</div>"]);Tl=function t(){return e};return e}function yl(){var e=babelHelpers.taggedTemplateLiteral(["",""]);yl=function t(){return e};return e}function wl(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl ui-ctl-w100 ui-ctl-after-icon">',"","","</div>"]);wl=function t(){return e};return e}function Il(){var e=babelHelpers.taggedTemplateLiteral(["<input value='",'\' type="hidden" name="','">']);Il=function t(){return e};return e}function Gl(){var e=babelHelpers.taggedTemplateLiteral(['<input class="ui-ctl-element ui-ctl-textbox" value="" type="text" autocomplete="off" name="','">']);Gl=function t(){return e};return e}function Sl(e,t,s){if(e!==t){throw new TypeError("Private static access of wrong provenance")}return s}function El(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var kl=new WeakSet;var Cl=new WeakSet;var Al=new WeakSet;var Wl=new WeakSet;var Ml=new WeakSet;var _l=new WeakSet;var zl=new WeakSet;var Ll=new WeakSet;var Ol=function(e){babelHelpers.inherits(t,e);function t(e){var s;babelHelpers.classCallCheck(this,t);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Ll.add(babelHelpers.assertThisInitialized(s));zl.add(babelHelpers.assertThisInitialized(s));_l.add(babelHelpers.assertThisInitialized(s));Ml.add(babelHelpers.assertThisInitialized(s));Wl.add(babelHelpers.assertThisInitialized(s));Al.add(babelHelpers.assertThisInitialized(s));Cl.add(babelHelpers.assertThisInitialized(s));kl.add(babelHelpers.assertThisInitialized(s));s._input=null;s._inputIcon=null;s._hiddenInput=null;s._innerWrapper=null;s._addressWidget=null;s._addressFieldsContainer=null;return s}babelHelpers.createClass(t,[{key:"initialize",value:function e(s,a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initialize",this).call(this,s,a);var i=this.getValue();var l=null;if(o.Type.isStringFilled(i)){try{l=new r.Address(JSON.parse(i))}catch(e){BX.debug("Cant parse address value");return}}var n=new Zi;this._addressWidget=n.createAddressWidget({address:l,mode:this._mode===BX.UI.EntityEditorMode.edit?r.ControlMode.edit:r.ControlMode.view,popupBindOptions:{position:"right"}});this._addressWidget.subscribeOnStateChangedEvent(El(this,Ml,xl).bind(this));this._addressWidget.subscribeOnAddressChangedEvent(El(this,_l,Ul).bind(this));this._fieldsSwitch=new rl({state:rl.STATE_OFF,titles:[BX.message("LOCATION_WIDGET_AUI_MORE"),BX.message("LOCATION_WIDGET_AUI_BRIEFLY")]});this._fieldsSwitch.subscribeOnToggleEventSubscribe(El(this,Cl,Bl).bind(this))}},{key:"focus",value:function e(){if(!this._input){return}BX.focus(this._input);BX.UI.EditorTextHelper.getCurrent().setPositionAtEnd(this._input)}},{key:"getModeSwitchType",value:function e(t){var s=BX.UI.EntityEditorModeSwitchType.common;if(t===BX.UI.EntityEditorMode.edit){s|=BX.UI.EntityEditorModeSwitchType.button|BX.UI.EntityEditorModeSwitchType.content}return s}},{key:"doSetMode",value:function e(t){this._addressWidget.mode=t===BX.UI.EntityEditorMode.edit?r.ControlMode.edit:r.ControlMode.view;this._fieldsSwitch.state=rl.STATE_OFF}},{key:"getContentWrapper",value:function e(){return this._innerWrapper}},{key:"save",value:function e(){if(!this.isEditable()){return}var t=El(this,Ll,Yl).call(this);this._model.setField(this.getName(),t?t.toJson():"");this._addressWidget.resetView()}},{key:"showError",value:function e(s,a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"showError",this).apply(this,[s,a]);if(this._input){BX.addClass(this._inputContainer,"ui-ctl-danger")}}},{key:"clearError",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"clearError",this).apply(this);if(this._input){BX.removeClass(this._inputContainer,"ui-ctl-danger")}}},{key:"doClearLayout",value:function e(t){this._input=null;this._innerWrapper=null;this._inputContainer=null;this._addressFieldsContainer=null;this._inputIcon=null;this._hiddenInput=null;o.Dom.clean(this._innerWrapper)}},{key:"validate",value:function e(t){if(!(this._mode===BX.UI.EntityEditorMode.edit&&this._input)){throw Error("BX.Location.UIAddress. Invalid validation context")}this.clearError();if(this.hasValidators()){return this.executeValidators(t)}var s=!this.isRequired()||BX.util.trim(this._input.value)!=="";if(!s){t.addError(BX.UI.EntityValidationError.create({field:this}));this.showRequiredFieldError(this._input)}return s}},{key:"getRuntimeValue",value:function e(){return this._mode===BX.UI.EntityEditorMode.edit?El(this,Ll,Yl).call(this):null}},{key:"layout",value:function e(s){if(this._hasLayout){return}this.ensureWrapperCreated({classNames:["ui-entity-card-content-block-field-phone"]});this.adjustWrapper();var a=this.getTitle();if(this.isDragEnabled()){this._wrapper.appendChild(this.createDragButton())}var i={};if(this._mode===BX.UI.EntityEditorMode.edit){this._wrapper.appendChild(this.createTitleNode(a));this._input=o.Tag.render(Gl(),"".concat(this.getName(),"_STRING"));this._hiddenInput=o.Tag.render(Il(),this.getValue(),this.getName());this._inputIcon=new hl;this._inputIcon.subscribeOnClickEvent(El(this,kl,Dl).bind(this));var l=this._inputIcon.render({type:Sl(t,t,Nl).call(t,El(this,Ll,Yl).call(this))});this._inputContainer=o.Tag.render(wl(),l,this._input,this._hiddenInput);this._titleWrapper.appendChild(o.Tag.render(yl(),this._fieldsSwitch.render(this._mode)));this._innerWrapper=o.Tag.render(Tl(),this._inputContainer);i.inputNode=this._input;i.mapBindElement=l;this._addressFieldsContainer=o.Tag.render(gl());if(this._fieldsSwitch.state===rl.STATE_ON){this._addressFieldsContainer.classList.add("visible")}i.fieldsContainer=this._addressFieldsContainer;this._innerWrapper.appendChild(this._addressFieldsContainer)}else{this._wrapper.appendChild(this.createTitleNode(a));var r;if(this.hasContentToDisplay()){var n=El(this,zl,Vl).call(this,El(this,Ll,Yl).call(this));r=o.Tag.render(ml(),n);this._innerWrapper=o.Tag.render(Pl(),r);i.mapBindElement=r}else{this._innerWrapper=o.Tag.render(Fl(),BX.message("UI_ENTITY_EDITOR_FIELD_EMPTY"));i.mapBindElement=this._innerWrapper}}i.controlWrapper=this._innerWrapper;this._addressWidget.render(i);this._wrapper.appendChild(this._innerWrapper);this._addressWidget.subscribeOnErrorEvent(this.errorListener.bind(this));if(this.isContextMenuEnabled()){this._wrapper.appendChild(this.createContextMenuButton())}if(this.isDragEnabled()){this.initializeDragDropAbilities()}this.registerLayout(s);this._hasLayout=true}},{key:"errorListener",value:function e(t){var s=this;var a=t.getData();var i=a.errors;if(this._inputIcon){this._inputIcon.type=hl.TYPE_CLEAR}if(!o.Type.isArray(i)){return}i.forEach(function(e){var t;if(e.message){t=e.message}else{t=BX.message("LOCATION_WIDGET_AUI_UNKNOWN_ERROR")}if(e.code){t+=" [".concat(e.code,"]")}s.showError(t)})}},{key:"processModelChange",value:function e(t){if(BX.prop.get(t,"originator",null)===this){return}if(!BX.prop.getBoolean(t,"forAll",false)&&BX.prop.getString(t,"name","")!==this.getName()){return}this.refreshLayout()}}],[{key:"create",value:function e(s,a){var i=new t;i.initialize(s,a);return i}},{key:"registerField",value:function e(){if(typeof BX.UI.EntityEditorControlFactory!=="undefined"){BX.UI.EntityEditorControlFactory.registerFactoryMethod("address",t.registerFieldMethod)}else{BX.addCustomEvent("BX.UI.EntityEditorControlFactory:onInitialize",function(e,s){s.methods.address=t.registerFieldMethod})}}},{key:"registerFieldMethod",value:function e(s,a,i){var l=null;if(s==="address"){l=t.create(a,i)}return l}}]);return t}(BX.UI.EntityEditorField);var Nl=function e(t){return t?hl.TYPE_CLEAR:hl.TYPE_SEARCH};var Dl=function e(){if(this._input.value!==""){this._input.value="";this._addressWidget.address=null;this._inputIcon.type=hl.TYPE_SEARCH}if(this.hasError()){this.clearError()}};var Bl=function e(t){var s=t.getData();var a=s.state;if(a===rl.STATE_OFF){El(this,Al,Rl).call(this)}else{El(this,Wl,Xl).call(this)}this._addressWidget.resetView()};var Rl=function e(){if(this._addressFieldsContainer){this._addressFieldsContainer.classList.remove("visible")}};var Xl=function e(){if(this._addressFieldsContainer){this._addressFieldsContainer.classList.add("visible")}};var xl=function e(t){var s=t.getData();var a=s.state;var i;if(s.state===n.State.DATA_LOADING){i=hl.TYPE_LOADER}else{if(s.state===n.State.DATA_INPUTTING){this.markAsChanged()}i=Sl(Ol,Ol,Nl).call(Ol,El(this,Ll,Yl).call(this))}this._inputIcon.type=i};var Ul=function e(t){var s=t.getData();var a=s.address;if(this._hiddenInput){this._hiddenInput.value=a?a.toJson():"";this.markAsChanged()}if(this._inputIcon){this._inputIcon.type=Sl(Ol,Ol,Nl).call(Ol,a)}};var Vl=function e(t){if(!t){return""}return t.toString(this._addressWidget.addressFormat)};var Yl=function e(){return this._addressWidget.address};Ol.registerField();e.Address=Ne;e.BaseFeature=be;e.MapFeature=Ci;e.AutocompleteFeature=Mi;e.FieldsFeature=Li;e.Factory=Zi;e.State=b;e.UIAddress=Ol})(this.BX.Location.Widget=this.BX.Location.Widget||{},BX,BX.Location.OSM,BX.Location.Google,BX.Main,BX,BX.Location.Core,BX.Location.Widget,BX.Event,BX);
//# sourceMappingURL=widget.bundle.map.js