this.BX=this.BX||{};(function(e,t){"use strict";var n=function(){function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.input=n.input;this.callback=n.callback;this.currency=n.currency;this.value=n.value||"";this.valueEditHandler=this.valueEdit.bind(this);t.Event.ready(this.init.bind(this))}babelHelpers.createClass(e,[{key:"init",value:function e(){this.formatValue();t.Event.bind(this.input,"bxchange",this.valueEditHandler);t.Event.unbind(this.input,"change",this.valueEditHandler)}},{key:"clean",value:function e(){t.Event.unbind(this.input,"bxchange",this.valueEditHandler);this.input=null}},{key:"valueEdit",value:function e(t){if(!!t&&t.type==="keyup"&&t.code==="Tab"){return}this.formatValue()}},{key:"setCurrency",value:function t(n){this.value=e.getUnFormattedValue(this.input.value,this.currency);this.currency=n;this.input.value=e.getFormattedValue(this.value,this.currency);this.callValueChangeCallback()}},{key:"formatValue",value:function e(){var t=BX.getCaretPosition(this.input);var n=this.input.value;this.changeValue();if(n.length>0){BX.setCaretPosition(this.input,t-n.length+this.input.value.length)}}},{key:"changeValue",value:function t(){this.value=e.getUnFormattedValue(this.input.value,this.currency);this.input.value=e.getFormattedValue(this.value,this.currency);this.callValueChangeCallback()}},{key:"callValueChangeCallback",value:function e(){if(!!this.callback){this.callback.apply(this,[this.value])}BX.onCustomEvent(this,"Currency::Editor::change",[this.value])}}],[{key:"getCurrencyFormat",value:function e(t){var n=this.getCurrencyList();if(typeof n[t]!=="undefined"){return n[t]}return this.defaultFormat}},{key:"getCurrencyList",value:function e(){if(this.currencyList===null){this.currencyList=t.Loc.getMessage("CURRENCY")}return this.currencyList}},{key:"getBaseCurrencyId",value:function e(){var t=this.getCurrencyList();for(var n in t){if(!t.hasOwnProperty(n)){continue}if(BX.prop.getString(t[n],"BASE","N")==="Y"){return n}}return""}},{key:"trimTrailingZeros",value:function e(t,n){t=String(t);var i=this.getCurrencyFormat(n);var r=BX.prop.getString(i,"DEC_POINT","");return r!==""?t.replace(new RegExp("\\"+r+"0+$"),""):t}},{key:"escapeRegExp",value:function e(t){t=String(t);return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}},{key:"getUnFormattedValue",value:function e(t,n){t=String(t);var i=this.getCurrencyFormat(n);if(i["SEPARATOR"].length===1){return t.replace(new RegExp("["+i["SEPARATOR"]+"]","g"),"").replace(i["DEC_POINT"],".").replace(new RegExp("[^0-9.]","g"),"")}else if(i["SEPARATOR"].length>1){return t.replace(new RegExp(this.escapeRegExp(i["SEPARATOR"]),"g"),"").replace(i["DEC_POINT"],".").replace(new RegExp("[^0-9.]","g"),"")}else{return t.replace(i["DEC_POINT"],".").replace(new RegExp("[^0-9.]","g"),"")}}},{key:"getFormattedValue",value:function e(t,n){t=String(t);var i=t.length,r="",a=this.getCurrencyFormat(n),l,u,c,s;if(i>0){t=t.replace(/^0+/,"");if(t.length<=0){t="0"}else if(t.charAt(0)==="."){t="0"+t}i=t.length}if(a["SEPARATOR"]===","||a["SEPARATOR"]==="."){l=new RegExp("[.,]")}else{l=new RegExp("["+a["DEC_POINT"]+",.]")}u=t.match(l);u=u===null?t.length:u.index;c=0;for(s=0;s<t.length;s++){var h=t.length-1-s;var g=t.charAt(h);var f="0123456789".indexOf(g)>=0;if(f){c++}if(h===u){c=0}if(h>=u){if(a["DEC_POINT"]==="."&&g===","){g=a["DEC_POINT"]}if(a["DEC_POINT"]===","&&g==="."){g=a["DEC_POINT"]}if(f||h===u&&g===a["DEC_POINT"]){r=g+r}else if(i>h){i--}}else{if(f){r=g+r}else if(i>h){i--}if(f&&c%3===0&&c!==0&&h!==0){r=a["SEPARATOR"]+r;if(i>=h){i++}}}}if(a["DECIMALS"]>0){u=r.match(new RegExp("["+a["DEC_POINT"]+"]"));u=u===null?r.length:u.index;while(r.length-1-u>a["DECIMALS"]){if(i>=r.length-1){i--}r=r.substr(0,r.length-1)}}return r}}]);return e}();babelHelpers.defineProperty(n,"currencyList",null);babelHelpers.defineProperty(n,"defaultFormat",{CURRENCY:"",NAME:"",FORMAT_STRING:"#",DEC_POINT:".",THOUSANDS_VARIANT:null,THOUSANDS_SEP:" ",DECIMALS:2,HIDE_ZERO:"N",BASE:"N",SEPARATOR:" "});t.Reflection.namespace("BX.Currency").Editor=n;e.MoneyEditor=n})(this.BX.Currency=this.BX.Currency||{},BX);
//# sourceMappingURL=money-editor.bundle.map.js