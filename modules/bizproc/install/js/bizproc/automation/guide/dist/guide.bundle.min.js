this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,s,t,a,i){"use strict";var o=babelHelpers.classPrivateFieldLooseKey("IS_SHOWN_SUCCESS_AUTOMATION");var l=babelHelpers.classPrivateFieldLooseKey("SHOW_SUCCESS_AUTOMATION");var r=babelHelpers.classPrivateFieldLooseKey("SHOW_CHECK_AUTOMATION");var c=babelHelpers.classPrivateFieldLooseKey("SHOW_HOW_CHECK_TRIIGGER");var n=babelHelpers.classPrivateFieldLooseKey("SHOW_HOW_CHECK_ROBOT");var b=babelHelpers.classPrivateFieldLooseKey("TRIGGER_ADDED");var u=babelHelpers.classPrivateFieldLooseKey("ROBOT_ADDED");var d=babelHelpers.classPrivateFieldLooseKey("subscribeOnStartCheckAutomationEvents");var p=babelHelpers.classPrivateFieldLooseKey("getStartCheckAutomationHandlers");var v=babelHelpers.classPrivateFieldLooseKey("isSuccessAutomationStepShown");var P=babelHelpers.classPrivateFieldLooseKey("isTargetDocumentType");var _=babelHelpers.classPrivateFieldLooseKey("isCorrectDocumentType");var h=babelHelpers.classPrivateFieldLooseKey("isNeedShowSuccessAutomationStep");var B=babelHelpers.classPrivateFieldLooseKey("isNeedShowCheckAutomationStep");var H=babelHelpers.classPrivateFieldLooseKey("saveUserOption");var O=babelHelpers.classPrivateFieldLooseKey("sendUserOption");var L=babelHelpers.classPrivateFieldLooseKey("deleteUserOption");var m=babelHelpers.classPrivateFieldLooseKey("getGuide");var g=babelHelpers.classPrivateFieldLooseKey("isTargetExist");class F{static startCheckAutomationTour(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,_)[_](e)||!t.Type.isNumber(s)){return}babelHelpers.classPrivateFieldLooseBase(this,d)[d](e,s)}static showHowCheckAutomationGuide(e,s,a){var i;if(babelHelpers.classPrivateFieldLooseBase(this,v)[v](a)||!babelHelpers.classPrivateFieldLooseBase(this,P)[P](e,s,a)||babelHelpers.classPrivateFieldLooseBase(this,h)[h](a)||babelHelpers.classPrivateFieldLooseBase(this,B)[B](a)){return}const o=a[babelHelpers.classPrivateFieldLooseBase(this,c)[c]]===true;const l=a[babelHelpers.classPrivateFieldLooseBase(this,n)[n]]===true;if(!o&&!l){return}const r=o?t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_HOW_CHECK_TRIGGER_TITLE"):t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_HOW_CHECK_ROBOT_TITLE");const b=o?t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_HOW_CHECK_TRIGGER_TEXT"):t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_HOW_CHECK_ROBOT_TEXT");const u=(i=document.querySelector(".main-kanban-item"))!=null?i:document.querySelector(".main-grid-row.main-grid-row-body:not(.main-grid-not-count) .main-grid-cell.main-grid-cell-left");const d=babelHelpers.classPrivateFieldLooseBase(this,m)[m]({target:u,title:r,text:b});if(!babelHelpers.classPrivateFieldLooseBase(this,g)[g](d.getCurrentStep().getTarget())){return}d.showNextStep()}static showCheckAutomation(e,s,a){if(babelHelpers.classPrivateFieldLooseBase(this,v)[v](a)||!babelHelpers.classPrivateFieldLooseBase(this,P)[P](e,s,a)||babelHelpers.classPrivateFieldLooseBase(this,h)[h](a)||!babelHelpers.classPrivateFieldLooseBase(this,B)[B](a)){return}babelHelpers.classPrivateFieldLooseBase(this,H)[H](babelHelpers.classPrivateFieldLooseBase(this,r)[r],"N");babelHelpers.classPrivateFieldLooseBase(this,H)[H](babelHelpers.classPrivateFieldLooseBase(this,l)[l],"Y");babelHelpers.classPrivateFieldLooseBase(this,O)[O]();const i=babelHelpers.classPrivateFieldLooseBase(this,m)[m]({target:'[data-id="tab_automation"]',title:t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_CHECK_AUTOMATION_TITLE"),text:t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_CHECK_AUTOMATION_TEXT"),condition:{top:true,bottom:false,color:"primary"}});if(!babelHelpers.classPrivateFieldLooseBase(this,g)[g](i.getCurrentStep().getTarget())||i.getCurrentStep().getTarget().offsetTop>0){i.getCurrentStep().setTarget(".main-buttons-item.main-buttons-item-more-default.main-buttons-item-more.--has-menu");if(!babelHelpers.classPrivateFieldLooseBase(this,g)[g](i.getCurrentStep().getTarget())){return}}i.showNextStep()}static showSuccessAutomation(e,s,a){var i;if(babelHelpers.classPrivateFieldLooseBase(this,v)[v](a)||!babelHelpers.classPrivateFieldLooseBase(this,P)[P](e,s,a)||!babelHelpers.classPrivateFieldLooseBase(this,h)[h](a)){return}let l=(i=document.querySelector(".bizproc-automation-trigger-item.--complete"))!=null?i:document.querySelector(".bizproc-automation-robot-container.--complete");if(!babelHelpers.classPrivateFieldLooseBase(this,g)[g](l)){var r;l=(r=document.querySelector(".bizproc-automation-trigger-item"))!=null?r:document.querySelector(".bizproc-automation-robot-container");if(!babelHelpers.classPrivateFieldLooseBase(this,g)[g](l)){return}}babelHelpers.classPrivateFieldLooseBase(this,L)[L]();babelHelpers.classPrivateFieldLooseBase(this,H)[H](babelHelpers.classPrivateFieldLooseBase(this,o)[o],"Y");const c=babelHelpers.classPrivateFieldLooseBase(this,m)[m]({target:l,title:t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_SUCCESS_AUTOMATION_TITLE"),text:t.Loc.getMessage("BIZPROC_JS_WOW_MOMENT_CRM_SUCCESS_AUTOMATION_TEXT"),article:"6908975",position:"top"});c.showNextStep()}}function C(e,s){const t=babelHelpers.classPrivateFieldLooseBase(this,p)[p]();for(const e of Object.keys(t)){a.EventEmitter.subscribe(e,t[e])}const o=BX.SidePanel.Instance.getSliderByWindow(window);let l={};if(o){const b=new i.Settings("aut-guide-crm-check-automation");a.EventEmitter.subscribeOnce(o,"SidePanel.Slider:onCloseComplete",(()=>{for(const e of Object.keys(t)){a.EventEmitter.unsubscribe(e,t[e])}if(b.get(babelHelpers.classPrivateFieldLooseBase(this,c)[c])===true||b.get(babelHelpers.classPrivateFieldLooseBase(this,n)[n])===true){babelHelpers.classPrivateFieldLooseBase(this,H)[H]("document_type",e);babelHelpers.classPrivateFieldLooseBase(this,H)[H]("category_id",s);babelHelpers.classPrivateFieldLooseBase(this,H)[H](babelHelpers.classPrivateFieldLooseBase(this,r)[r],"Y");l=Object.assign({document_type:e,category_id:s},b.getAll());babelHelpers.classPrivateFieldLooseBase(this,O)[O]()}b.deleteAll()}))}const b=window.top;const u=()=>{if(b.BX.SidePanel.Instance.getOpenSlidersCount()<=0){b.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onCloseComplete",u);b.BX.Runtime.loadExtension("bizproc.automation.guide").then((t=>{const{CrmCheckAutomationGuide:a}=t;a.showHowCheckAutomationGuide(e,s,l)}));return true}return false};b.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onCloseComplete",u)}function S(){const e=new i.Settings("aut-guide-crm-check-automation");e.set(babelHelpers.classPrivateFieldLooseBase(this,b)[b],false);e.set(babelHelpers.classPrivateFieldLooseBase(this,c)[c],false);e.set(babelHelpers.classPrivateFieldLooseBase(this,u)[u],false);e.set(babelHelpers.classPrivateFieldLooseBase(this,n)[n],false);const s={};s["BX.Bizproc.Automation:TriggerManager:trigger:add"]=()=>{e.set(babelHelpers.classPrivateFieldLooseBase(this,b)[b],true)};s["BX.Bizproc.Automation:Template:robot:add"]=()=>{e.set(babelHelpers.classPrivateFieldLooseBase(this,u)[u],true)};s["BX.Bizproc.Component.Automation.Component:onSuccessAutomationSave"]=s=>{const t=s.getData()["analyticsLabel"]["triggers_count"];e.set(babelHelpers.classPrivateFieldLooseBase(this,c)[c],t>0&&e.get(babelHelpers.classPrivateFieldLooseBase(this,b)[b])===true);const a=s.getData()["analyticsLabel"]["robots_count"];e.set(babelHelpers.classPrivateFieldLooseBase(this,n)[n],a>0&&e.get(babelHelpers.classPrivateFieldLooseBase(this,u)[u])===true);e.set(babelHelpers.classPrivateFieldLooseBase(this,b)[b],false);e.set(babelHelpers.classPrivateFieldLooseBase(this,u)[u],false)};return s}function T(e){return e[babelHelpers.classPrivateFieldLooseBase(this,o)[o]]==="Y"}function y(e,s,a){return babelHelpers.classPrivateFieldLooseBase(this,_)[_](e)&&t.Type.isStringFilled(a["document_type"])&&a["document_type"]===e&&Number(a["category_id"])===Number(s)}function f(e){return t.Type.isStringFilled(e)&&(["LEAD","DEAL","SMART_INVOICE","QUOTE","ORDER"].includes(e)||e.startsWith("DYNAMIC_"))}function E(e){return e[babelHelpers.classPrivateFieldLooseBase(this,l)[l]]==="Y"}function M(e){return e[babelHelpers.classPrivateFieldLooseBase(this,r)[r]]==="Y"}function A(e,s){BX.userOptions.save("bizproc.automation.guide","crm_check_automation",e,s,false)}function w(){BX.userOptions.send(null)}function R(){BX.userOptions.del("bizproc.automation.guide","crm_check_automation")}function I(e){var a;return new s.Guide({steps:[{target:e.target,title:e.title,text:e.text,position:e.position|"bottom",condition:t.Type.isPlainObject(e.condition)?e.condition:null,article:(a=e.article)!=null?a:null}],onEvents:true})}function W(e){return t.Type.isElementNode(e)}Object.defineProperty(F,g,{value:W});Object.defineProperty(F,m,{value:I});Object.defineProperty(F,L,{value:R});Object.defineProperty(F,O,{value:w});Object.defineProperty(F,H,{value:A});Object.defineProperty(F,B,{value:M});Object.defineProperty(F,h,{value:E});Object.defineProperty(F,_,{value:f});Object.defineProperty(F,P,{value:y});Object.defineProperty(F,v,{value:T});Object.defineProperty(F,p,{value:S});Object.defineProperty(F,d,{value:C});Object.defineProperty(F,o,{writable:true,value:"success_automation_shown"});Object.defineProperty(F,l,{writable:true,value:"show_success_automation"});Object.defineProperty(F,r,{writable:true,value:"show_check_automation"});Object.defineProperty(F,c,{writable:true,value:"show_how_check_trigger"});Object.defineProperty(F,n,{writable:true,value:"show_how_check_robot"});Object.defineProperty(F,b,{writable:true,value:"is_trigger_added"});Object.defineProperty(F,u,{writable:true,value:"is_robot_added"});e.CrmCheckAutomationGuide=F})(this.BX.Bizproc.Automation=this.BX.Bizproc.Automation||{},BX.UI.Tour,BX,BX.Event,BX.Bizproc.LocalSettings);
//# sourceMappingURL=guide.bundle.map.js