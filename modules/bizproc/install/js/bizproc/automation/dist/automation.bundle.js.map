{"version":3,"file":"automation.bundle.js","sources":["../src/template-scope.js","../src/templates-scheme.js","../src/view-mode.js","../src/trigger.js","../src/help-hint.js","../src/helper.js","../src/designer.js","../src/trigger-manager.js","../src/document/document.js","../src/delay-interval.js","../src/workflow/types.js","../src/tracker/tracking-entry.js","../src/tracker/types.js","../src/tracker/robot-entry.js","../src/tracker/trigger-entry.js","../src/tracker/tracking-entry-builder.js","../src/tracker/tracker.js","../src/robot.js","../src/user-options.js","../src/template.js","../src/condition/condition.js","../src/condition/condition-group.js","../src/selectors/condition-selector.js","../src/selectors/condition-group-selector.js","../src/selectors/manager.js","../src/selectors/inline-selector.js","../src/selectors/inline-selector-condition.js","../src/selectors/inline-selector-html.js","../src/selectors/save-state-checkbox.js","../src/selectors/user-selector.js","../src/selectors/file-selector.js","../src/selectors/time-selector.js","../src/delay-interval-selector.js","../src/context/base-context.js","../src/context/selector-context.js","../src/context/context.js","../src/automation.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { DocumentType, DocumentCategory, DocumentStatus } from './document/types';\n\nexport class TemplateScope\n{\n\t#documentType: DocumentType;\n\t#category: DocumentCategory | null;\n\t#status: DocumentStatus;\n\n\tconstructor(rawTemplateScope: {\n\t\tDocumentType: {\n\t\t\tType: string,\n\t\t\tName: string,\n\t\t},\n\t\tCategory: {\n\t\t\tId: string | null,\n\t\t\tName: string | null,\n\t\t},\n\t\tStatus: {\n\t\t\tId: string,\n\t\t\tName: string,\n\t\t\tColor: string,\n\t\t}\n\t})\n\t{\n\t\tthis.#documentType = rawTemplateScope.DocumentType;\n\t\tthis.#category = !Type.isNil(rawTemplateScope.Category.Id) ? rawTemplateScope.Category : null;\n\t\tthis.#status = rawTemplateScope.Status;\n\t}\n\n\tgetId()\n\t{\n\t\tif (this.hasCategory())\n\t\t{\n\t\t\treturn `${this.#documentType.Type}_${this.#category.Id}_${this.#status.Id}`;\n\t\t}\n\n\t\treturn `${this.#documentType.Type}_${this.#status.Id}`;\n\t}\n\n\tgetDocumentType(): DocumentType\n\t{\n\t\treturn this.#documentType;\n\t}\n\n\tgetDocumentCategory(): DocumentCategory\n\t{\n\t\treturn this.#category;\n\t}\n\n\tgetDocumentStatus(): DocumentStatus\n\t{\n\t\treturn this.#status;\n\t}\n\n\thasCategory(): boolean\n\t{\n\t\treturn !Type.isNull(this.#category);\n\t}\n}","import {Type} from 'main.core';\nimport {DocumentType, DocumentCategory, DocumentStatus} from './document/types';\nimport {TemplateScope} from './template-scope';\n\nexport default class TemplatesScheme\n{\n\t#scheme: Array<TemplateScope>;\n\n\tconstructor(scheme: Array<TemplateScope>)\n\t{\n\t\tthis.#scheme = [];\n\n\t\tif (Type.isArray(scheme))\n\t\t{\n\t\t\tscheme.forEach(rawScope => {\n\t\t\t\tconst scope = new TemplateScope(rawScope);\n\t\t\t\tthis.#scheme.push(scope);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetDocumentTypes(): Array<DocumentType>\n\t{\n\t\tconst documentTypes = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tdocumentTypes.set(scope.getDocumentType().Type, scope.getDocumentType());\n\t\t}\n\n\t\treturn Array.from(documentTypes.values());\n\t}\n\n\tgetTypeCategories(documentType: DocumentType): Array<DocumentCategory>\n\t{\n\t\tconst documentCategories = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tif (scope.hasCategory() && scope.getDocumentType().Type === documentType.Type)\n\t\t\t{\n\t\t\t\tconst category = scope.getDocumentCategory();\n\t\t\t\tdocumentCategories.set(category.Id, category);\n\t\t\t}\n\t\t}\n\n\t\treturn Array.from(documentCategories.values());\n\t}\n\n\tgetTypeStatuses(documentType: DocumentType, documentCategory: DocumentCategory | null): Array<DocumentStatus>\n\t{\n\t\tconst takenStatuses = new Set();\n\t\tif (Type.isNil(documentCategory))\n\t\t{\n\t\t\tdocumentCategory = {Id: null};\n\t\t}\n\n\t\tconst predicate = scope => {\n\t\t\tconst shouldBeTaken = (\n\t\t\t\tscope.getDocumentType().Type === documentType.Type\n\t\t\t\t&& (scope.hasCategory() ? scope.getDocumentCategory().Id === documentCategory.Id : true)\n\t\t\t\t&& !takenStatuses.has(scope.getDocumentStatus().Id)\n\t\t\t);\n\n\t\t\tif (shouldBeTaken)\n\t\t\t{\n\t\t\t\ttakenStatuses.add(scope.getDocumentStatus().Id);\n\t\t\t}\n\n\t\t\treturn shouldBeTaken;\n\t\t};\n\n\t\treturn Array.from(this.#filterBy(predicate)).map(scope => scope.getDocumentStatus());\n\t}\n\n\t#filterBy(predicate: (TemplateScope) => boolean): Iterable<TemplateScope>\n\t{\n\t\tconst generator = function*(scheme)\n\t\t{\n\t\t\tfor (const scope of scheme)\n\t\t\t{\n\t\t\t\tif (predicate(scope))\n\t\t\t\t{\n\t\t\t\t\tyield scope;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn generator(this.#scheme);\n\t}\n}","export class ViewMode\n{\n\t#mode: number;\n\t#properties: Object;\n\n\tstatic #none = 0;\n\tstatic #view = 1;\n\tstatic #edit = 2;\n\tstatic #manage = 3;\n\n\tconstructor(mode: number)\n\t{\n\t\tthis.#mode = mode;\n\t\tthis.#properties = {};\n\t}\n\n\tstatic none(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#none)\n\t}\n\n\tisNone(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#none;\n\t}\n\n\tstatic view(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#view);\n\t}\n\n\tisView(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#view;\n\t}\n\n\tstatic edit(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#edit);\n\t}\n\n\tisEdit(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#edit;\n\t}\n\n\tstatic manage(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#manage);\n\t}\n\n\tisManage(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#manage;\n\t}\n\n\tsetProperty(name: string, value: any): ViewMode\n\t{\n\t\tthis.#properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetProperty(name: string, defaultValue: any = null): ?any\n\t{\n\t\tif (this.#properties.hasOwnProperty(name))\n\t\t{\n\t\t\treturn this.#properties[name];\n\t\t}\n\n\t\treturn defaultValue;\n\t}\n\n\tstatic fromRaw(mode: number): ViewMode\n\t{\n\t\tif (ViewMode.getAll().includes(mode))\n\t\t{\n\t\t\treturn new ViewMode(mode);\n\t\t}\n\n\t\treturn ViewMode.none();\n\t}\n\n\tintoRaw(): number\n\t{\n\t\treturn this.#mode;\n\t}\n\n\tstatic getAll(): Array<number>\n\t{\n\t\treturn [\n\t\t\tthis.#none,\n\t\t\tthis.#view,\n\t\t\tthis.#edit,\n\t\t\tthis.#manage,\n\t\t];\n\t}\n}\n","import { clone, Type, Dom, Loc, Event } from \"main.core\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { getGlobalContext, ConditionGroup, TrackingStatus, HelpHint } from \"bizproc.automation\";\n\nexport class Trigger extends EventEmitter\n{\n\tdraft: boolean;\n\n\t#data: Object<string, any>;\n\t#deleted: boolean;\n\t#viewMode: ViewMode;\n\t#condition: ConditionGroup;\n\t#node: ?HTMLDivElement;\n\t#draggableItem: ?HTMLElement;\n\t#droppableItem: ?HTMLElement;\n\t#droppableColumn: ?HTMLElement;\n\t#stub: ?HTMLElement;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.draft = false;\n\t\tthis.#data = {};\n\t\tthis.#deleted = false;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#condition = new ConditionGroup();\n\t}\n\n\tget node(): HTMLDivElement\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget deleted(): boolean\n\t{\n\t\treturn this.#deleted;\n\t}\n\n\tget documentStatus(): string\n\t{\n\t\treturn this.#data['DOCUMENT_STATUS'] ?? '';\n\t}\n\n\tinit(data: Object<string, any>, viewMode: ?ViewMode): void\n\t{\n\t\tthis.#data = clone(data);\n\n\t\tif (!Type.isPlainObject(this.#data['APPLY_RULES']))\n\t\t{\n\t\t\tthis.#data['APPLY_RULES'] = {};\n\t\t}\n\n\t\tif (this.#data['APPLY_RULES'].Condition)\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup(this.#data['APPLY_RULES'].Condition);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup();\n\t\t}\n\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tthis.#node = this.createNode();\n\t}\n\n\treInit(data: Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.#data['ID'] || 0;\n\t}\n\n\tgetStatusId(): string\n\t{\n\t\treturn this.#data['DOCUMENT_STATUS'] || '';\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.#data['CODE'] ?? '';\n\t}\n\n\tgetName(): string\n\t{\n\t\tlet triggerName = this.#data['NAME'];\n\t\tif (!triggerName)\n\t\t{\n\t\t\tconst code = this.getCode();\n\t\t\tconst trigger = getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE']);\n\t\t\ttriggerName = trigger?.NAME ?? code;\n\t\t}\n\n\t\treturn triggerName;\n\t}\n\n\tsetName(name: string): this\n\t{\n\t\tif (Type.isString(name))\n\t\t{\n\t\t\tthis.#data['NAME'] = name;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetApplyRules()\n\t{\n\t\treturn this.#data['APPLY_RULES'];\n\t}\n\n\tsetApplyRules(rules: Object): this\n\t{\n\t\tthis.#data['APPLY_RULES'] = rules;\n\n\t\treturn this;\n\t}\n\n\tgetLogStatus()\n\t{\n\t\tconst log = getGlobalContext().tracker.getTriggerLog(this.getId());\n\t\treturn log ? log.status : null;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition: ConditionGroup): this\n\t{\n\t\tthis.#condition = condition;\n\t\treturn this;\n\t}\n\n\tisBackwardsAllowed(): boolean\n\t{\n\t\treturn this.#data['APPLY_RULES']['ALLOW_BACKWARDS'] === 'Y';\n\t}\n\n\tsetAllowBackwards(flag: boolean): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ALLOW_BACKWARDS'] = flag ? 'Y' : 'N';\n\n\t\treturn this;\n\t}\n\n\tgetExecuteBy(): string\n\t{\n\t\treturn this.#data['APPLY_RULES']['ExecuteBy'] || '';\n\t}\n\n\tsetExecuteBy(userId: number): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ExecuteBy'] = userId;\n\n\t\treturn this;\n\t}\n\n\tcreateNode()\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-trigger-item-wrapper';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-draggable';\n\t\t}\n\n\t\tlet settingsBtn = null;\n\t\tlet copyBtn = null;\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tsettingsBtn = Dom.create(\"div\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-trigger-item-wrapper-edit\"\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tcopyBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-trigger-btn-copy'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY') || 'copy'\n\t\t\t});\n\n\t\t\tEvent.bind(copyBtn, 'click', this.onCopyButtonClick.bind(this, copyBtn));\n\t\t}\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete';\n\t\t}\n\t\telse if (getGlobalContext().document.getPreviousStatusIdList().includes(this.getStatusId()))\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete-light';\n\t\t}\n\n\t\tconst triggerName = this.getName();\n\n\t\tlet containerClass = 'bizproc-automation-trigger-item';\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\tcontainerClass += ' --complete';\n\t\t}\n\n\t\tconst div = Dom.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'trigger-container',\n\t\t\t\t'className': containerClass,\n\t\t\t\t'data-type': 'item-trigger'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-trigger-item-wrapper-text\" },\n\t\t\t\t\t\t\ttext: triggerName\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\tcopyBtn,\n\t\t\t\tsettingsBtn\n\t\t\t]\n\t\t});\n\n\t\tif (!this.#viewMode.isEdit())\n\t\t{\n\t\t\treturn div;\n\t\t}\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'btn-delete-trigger',\n\t\t\t\t'className': 'bizproc-automation-trigger-btn-delete',\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\n\t\tdiv.appendChild(deleteBtn);\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\t\t}\n\n\t\treturn div;\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.emit('Trigger:onSettingsOpen', {trigger: this});\n\t\t}\n\t}\n\n\tonCopyButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = this.serialize();\n\t\t\tdelete initData['ID'];\n\t\t\t//TODO: refactoring\n\t\t\tif (initData['CODE'] === 'WEBHOOK')\n\t\t\t{\n\t\t\t\tinitData['APPLY_RULES'] = {};\n\t\t\t}\n\t\t\ttrigger.init(initData, this.#viewMode);\n\t\t\tthis.emit('Trigger:copied', {trigger});\n\t\t}\n\t}\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getName().toLowerCase().indexOf(query) >= 0;\n\n\t\tDom[match ? 'removeClass' : 'addClass'](this.#node, '--search-mismatch');\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.#draggableItem = BX.proxy_context;\n\n\t\tif (!this.#draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#stub)\n\t\t{\n\t\t\tconst itemWidth = this.#draggableItem.offsetWidth;\n\t\t\tthis.#stub = this.#draggableItem.cloneNode(true);\n\t\t\tthis.#stub.style.position = \"absolute\";\n\t\t\tthis.#stub.classList.add(\"bizproc-automation-trigger-item-drag\");\n\t\t\tthis.#stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.#stub);\n\t\t}\n\t}\n\n\tdragMove(x, y)\n\t{\n\t\tthis.#stub.style.left = x + \"px\";\n\t\tthis.#stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-trigger\")\n\t\t{\n\t\t\tthis.#droppableItem = destination;\n\t\t\tthis.#droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-trigger\")\n\t\t{\n\t\t\tthis.#droppableColumn = destination.querySelector('[data-role=\"trigger-list\"]');\n\t\t\tthis.#droppableItem = null;\n\t\t}\n\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.add(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.add(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tlet trigger = null;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\t\tconst copyTrigger = (parent, statusId) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = parent.serialize();\n\t\t\tdelete initData['ID'];\n\t\t\t//TODO: refactoring\n\t\t\tif (initData['CODE'] === 'WEBHOOK')\n\t\t\t{\n\t\t\t\tinitData['APPLY_RULES'] = {};\n\t\t\t}\n\t\t\tinitData['DOCUMENT_STATUS'] = statusId;\n\t\t\ttrigger.init(initData, parent.#viewMode);\n\n\t\t\treturn trigger;\n\t\t};\n\n\t\tif (this.#draggableItem)\n\t\t{\n\t\t\tif (this.#droppableItem)\n\t\t\t{\n\t\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t\t\tconst thisColumn = this.#droppableItem.parentNode;\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthisColumn.insertBefore(this.#draggableItem, this.#droppableItem);\n\t\t\t\t\tthis.moveTo(thisColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, thisColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthisColumn.insertBefore(trigger.#node, this.#droppableItem);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.#droppableColumn)\n\t\t\t{\n\t\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthis.#droppableColumn.appendChild(this.#draggableItem);\n\t\t\t\t\tthis.moveTo(this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthis.#droppableColumn.appendChild(trigger.#node);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (trigger)\n\t\t\t{\n\t\t\t\tthis.emit('Trigger:copied', {\n\t\t\t\t\ttrigger,\n\t\t\t\t\tskipInsert: true,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.#stub.parentNode.removeChild(this.#stub);\n\t\tthis.#stub = null;\n\t\tthis.#draggableItem = null;\n\t\tthis.#droppableItem = null;\n\t}\n\n\tonDeleteButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(button.parentNode);\n\t\t\tthis.emit('Trigger:deleted', {trigger: this});\n\t\t}\n\t}\n\n\tupdateData(data: Object<string, any>): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tmarkDeleted(): this\n\t{\n\t\tthis.#deleted = true;\n\n\t\treturn this;\n\t}\n\n\tserialize(): Object<string, any>\n\t{\n\t\tconst data = clone(this.#data);\n\t\tif (this.#deleted)\n\t\t{\n\t\t\tdata['DELETED'] = 'Y';\n\t\t}\n\n\t\tif (!Type.isPlainObject(data.APPLY_RULES))\n\t\t{\n\t\t\tdata.APPLY_RULES = {};\n\t\t}\n\n\t\tif (!this.#condition.items.length)\n\t\t{\n\t\t\tdelete data.APPLY_RULES.Condition;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdata.APPLY_RULES.Condition = this.#condition.serialize();\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tmoveTo(statusId)\n\t{\n\t\tthis.#data['DOCUMENT_STATUS'] = statusId;\n\t\tthis.emit('Trigger:modified', {trigger: this});\n\t}\n\n\tgetReturnProperties()\n\t{\n\t\tconst triggerData = getGlobalContext().availableTriggers.find(trigger => trigger['CODE'] === this.getCode());\n\n\t\treturn triggerData && Type.isArray(triggerData.RETURN) ? triggerData.RETURN : [];\n\t}\n}","import { Event, Text, Type, Dom, Loc } from 'main.core';\n\nexport class HelpHint\n{\n\tstatic popupHint;\n\tstatic timeout;\n\n\tstatic bindAll(node)\n\t{\n\t\tnode.querySelectorAll('[data-text]').forEach((element) => HelpHint.bindToNode(element));\n\t}\n\n\tstatic bindToNode(node)\n\t{\n\t\tEvent.bind(node, 'mouseover', this.showHint.bind(this, node));\n\t\tEvent.bind(node, 'mouseout', this.hideHint.bind(this));\n\t}\n\n\tstatic isBindedToNode(node): boolean\n\t{\n\t\treturn !!this.popupHint?.bindElement?.isSameNode(node);\n\t}\n\n\tstatic showHint(node)\n\t{\n\t\tconst rawText = node.getAttribute('data-text');\n\t\tif (!rawText)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet text = Text.encode(rawText);\n\t\ttext = BX.util.nl2br(text);\n\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.hideHint();\n\n\t\tthis.popupHint = new BX.PopupWindow('bizproc-automation-help-tip', node, {\n\t\t\tlightShadow: true,\n\t\t\tautoHide: false,\n\t\t\tdarkMode: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 2,\n\t\t\tbindOptions: {position: \"top\"},\n\t\t\tevents : {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent : Dom.create('div', {\n\t\t\t\tattrs : {\n\t\t\t\t\tstyle : 'padding-right: 5px; width: 250px;'\n\t\t\t\t},\n\t\t\t\thtml: text\n\t\t\t}),\n\t\t});\n\t\tthis.popupHint.setAngle({offset: 32, position: 'bottom'});\n\t\tthis.popupHint.show();\n\n\t\treturn true;\n\t}\n\n\tstatic showNoPermissionsHint(node)\n\t{\n\t\tthis.showAngleHint(node, Loc.getMessage('BIZPROC_AUTOMATION_RIGHTS_ERROR'));\n\t}\n\n\tstatic showAngleHint(node, text)\n\t{\n\t\tif (this.timeout)\n\t\t{\n\t\t\tclearTimeout(this.timeout);\n\t\t}\n\n\t\tthis.popupHint = BX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {\n\t\t\t\twidth: 334,\n\t\t\t\theight: 104,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tangle: {offset: Dom.getPosition(node).width / 2},\n\t\t\t\tbindOptions: {position: 'top'},\n\t\t\t}\n\t\t});\n\n\t\tthis.popupHint.close = function ()\n\t\t{\n\t\t\tthis.hide();\n\t\t};\n\t\tthis.popupHint.show(node, text);\n\t\tthis.timeout = setTimeout(this.hideHint.bind(this), 5000);\n\t}\n\n\tstatic hideHint()\n\t{\n\t\tif (this.popupHint)\n\t\t{\n\t\t\tthis.popupHint.close();\n\t\t}\n\t\tthis.popupHint = null;\n\t}\n}","import { Type } from \"main.core\";\n\nexport class Helper\n{\n\tstatic #idIncrement = 0;\n\n\tstatic generateUniqueId()\n\t{\n\t\t++Helper.#idIncrement;\n\t\treturn 'bizproc-automation-cmp-' + Helper.#idIncrement;\n\t}\n\n\tstatic toJsonString(data)\n\t{\n\t\treturn JSON.stringify(data, function (i, v)\n\t\t{\n\t\t\tif (typeof(v) == 'boolean')\n\t\t\t{\n\t\t\t\treturn v ? '1' : '0';\n\t\t\t}\n\t\t\treturn v;\n\t\t});\n\t}\n\n\tstatic getResponsibleUserExpression(fields: Array<Object>): ?string\n\t{\n\t\tif (Type.isArray(fields))\n\t\t{\n\t\t\tfor (const field of fields)\n\t\t\t{\n\t\t\t\tif (field['Id'] === 'ASSIGNED_BY_ID' || field['Id'] === 'RESPONSIBLE_ID')\n\t\t\t\t{\n\t\t\t\t\treturn '{{'+field['Name']+'}}';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n}","export class Designer\n{\n\tstatic #instance;\n\n\trobotSettingsDialog;\n\tcomponent;\n\trobot;\n\ttriggerSettingsDialog;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Designer.#instance)\n\t\t{\n\t\t\tDesigner.#instance = new Designer();\n\t\t}\n\n\t\treturn Designer.#instance;\n\t}\n\n\tsetRobotSettingsDialog(dialog)\n\t{\n\t\tthis.robotSettingsDialog = dialog;\n\t\tthis.robot = dialog ? dialog.robot : null;\n\t}\n\n\tgetRobotSettingsDialog()\n\t{\n\t\treturn this.robotSettingsDialog;\n\t}\n\n\tsetTriggerSettingsDialog(dialog)\n\t{\n\t\tthis.triggerSettingsDialog = dialog;\n\t}\n\n\tgetTriggerSettingsDialog()\n\t{\n\t\treturn this.triggerSettingsDialog;\n\t}\n}","import { Type, Event, Loc, Dom, Text, Reflection, Uri, ajax } from \"main.core\";\nimport { MenuManager } from \"main.popup\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { Trigger } from \"./trigger\";\nimport { HelpHint } from \"./help-hint\";\nimport { Helper } from \"./helper\";\nimport { Designer } from \"./designer\";\nimport { getGlobalContext, ConditionGroup, ConditionGroupSelector } from \"bizproc.automation\";\n\nexport class TriggerManager extends EventEmitter\n{\n\t#triggersContainerNode: HTMLElement;\n\t#viewMode: ViewMode;\n\t#triggers: Array<Trigger>;\n\t#triggersData: Array<Object<string, any>>;\n\t#columnNodes: NodeList;\n\t#listNodes: NodeList;\n\t#buttonsNodes: NodeList;\n\t#modified: boolean;\n\n\tconstructor(triggersContainerNode: HTMLElement)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#triggersContainerNode = triggersContainerNode;\n\t}\n\n\tinit(data: ?Object<string, any>, viewMode: ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode.isNone() ? ViewMode.edit() : viewMode;\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\t\tthis.#columnNodes = document.querySelectorAll('[data-type=\"column-trigger\"]');\n\t\tthis.#listNodes = this.#triggersContainerNode.querySelectorAll('[data-role=\"trigger-list\"]');\n\t\tthis.#buttonsNodes = this.#triggersContainerNode.querySelectorAll('[data-role=\"trigger-buttons\"]');\n\t\tthis.#modified = false;\n\t\tthis.initButtons();\n\t\tthis.initTriggers();\n\n\t\tthis.markModified(false);\n\n\t\t//register DD\n\t\tthis.#columnNodes.forEach(columnNode => jsDD.registerDest(columnNode, 10));\n\n\t\ttop.BX.addCustomEvent(\n\t\t\ttop,\n\t\t\t'Rest:AppLayout:ApplicationInstall',\n\t\t\tthis.onRestAppInstall.bind(this)\n\t\t);\n\t}\n\n\treInit(data: ?Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode || ViewMode.none();\n\t\tthis.#listNodes.forEach(node => Dom.clean(node));\n\t\tthis.#buttonsNodes.forEach(node => Dom.clean(node));\n\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\n\t\tthis.initTriggers();\n\t\tthis.initButtons();\n\n\t\tthis.markModified(false);\n\t}\n\n\tinitTriggers()\n\t{\n\t\tthis.#triggers = [];\n\t\tthis.#triggersData.forEach((triggerData) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\ttrigger.init(triggerData, this.#viewMode);\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\tthis.#triggers.push(trigger);\n\t\t});\n\t}\n\n\tsubscribeTriggerEvents(trigger: Trigger)\n\t{\n\t\ttrigger.subscribe('Trigger:copied', (event) => {\n\t\t\tconst trigger = event.data.trigger;\n\n\t\t\tthis.#triggers.push(trigger);\n\t\t\tif (!event.data.skipInsert)\n\t\t\t{\n\t\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\t}\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.markModified();\n\t\t});\n\t\ttrigger.subscribe('Trigger:modified', () => this.markModified());\n\t\ttrigger.subscribe('Trigger:onSettingsOpen', (event) => {\n\t\t\tthis.openTriggerSettingsDialog(event.data.trigger);\n\t\t});\n\t\ttrigger.subscribe('Trigger:deleted', (event) => this.deleteTrigger(event.data.trigger));\n\n\t}\n\n\tonSearch(event)\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.onSearch(event));\n\t}\n\n\tinitButtons()\n\t{\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tthis.#buttonsNodes.forEach(node => this.createAddButton(node));\n\t\t}\n\t}\n\n\tenableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.manage();\n\t\tconst deleteButtons = document.querySelectorAll('[data-role=\"btn-delete-trigger\"]');\n\t\tdeleteButtons.forEach(node => Dom.hide(node));\n\n\t\tthis.#triggers.forEach(trigger => Dom.addClass(trigger.node, '--locked-node'));\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tconst deleteButtons = document.querySelectorAll('[data-role=\"btn-delete-trigger\"]');\n\t\tdeleteButtons.forEach(node => Dom.show(node));\n\n\t\tthis.#triggers.forEach(trigger => Dom.removeClass(trigger.node, '--locked-node'));\n\t}\n\n\tcreateAddButton(containerNode: HTMLElement)\n\t{\n\t\tconst self = this;\n\t\tconst div = Dom.create('span', {\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tif (!self.canEdit())\n\t\t\t\t\t{\n\t\t\t\t\t\tHelpHint.showNoPermissionsHint(this);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!self.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onAddButtonClick(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-btn-add',\n\t\t\t\t'data-status-id': containerNode.getAttribute('data-status-id'),\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-btn-add-text',\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ADD'),\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tcontainerNode.appendChild(div);\n\t}\n\n\tonAddButtonClick(button: HTMLElement, context: Object<string, any>)\n\t{\n\t\tconst self = this;\n\t\tconst onMenuClick = function(event, item)\n\t\t{\n\t\t\tself.addTrigger(item.triggerData, function(trigger)\n\t\t\t{\n\t\t\t\tthis.openTriggerSettingsDialog(trigger, context);\n\t\t\t});\n\n\t\t\tthis.popupWindow.close();\n\t\t};\n\n\t\tconst menuItems = [];\n\t\tgetGlobalContext().availableTriggers.forEach((availableTrigger) => {\n\t\t\tif (availableTrigger.CODE === 'APP')\n\t\t\t{\n\t\t\t\tmenuItems.push(this.createAppTriggerMenuItem(\n\t\t\t\t\tbutton.getAttribute('data-status-id'),\n\t\t\t\t\tavailableTrigger,\n\t\t\t\t));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: availableTrigger.NAME,\n\t\t\t\t\ttriggerData: {\n\t\t\t\t\t\tDOCUMENT_STATUS: button.getAttribute('data-status-id') || context.statusId,\n\t\t\t\t\t\tCODE: availableTrigger.CODE\n\t\t\t\t\t},\n\t\t\t\t\tonclick: onMenuClick\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tMenuManager.show(\n\t\t\tHelper.generateUniqueId(),\n\t\t\tbutton,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (Dom.getPosition(button)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\tevents : {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonChangeTriggerClick(statusId: string, event)\n\t{\n\t\tthis.onAddButtonClick(event.target, {changeTrigger: true, statusId: statusId});\n\t}\n\n\tcreateAppTriggerMenuItem(status, triggerData)\n\t{\n\t\tconst self = this;\n\t\tconst onMenuClick = function(e, item)\n\t\t{\n\t\t\tself.addTrigger(item.triggerData, function(trigger)\n\t\t\t{\n\t\t\t\tthis.openTriggerSettingsDialog(trigger);\n\t\t\t});\n\n\t\t\tthis.getRootMenuWindow().close();\n\t\t};\n\n\t\tconst menuItems = [];\n\t\tfor (let i = 0; i < triggerData['APP_LIST'].length; ++i)\n\t\t{\n\t\t\tconst item = triggerData['APP_LIST'][i];\n\t\t\tconst itemName = '[' + item['APP_NAME'] + '] ' + item['NAME'];\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Text.encode(itemName),\n\t\t\t\ttriggerData: {\n\t\t\t\t\tDOCUMENT_STATUS: status,\n\t\t\t\t\tNAME: itemName,\n\t\t\t\t\tCODE: triggerData.CODE,\n\t\t\t\t\tAPPLY_RULES: {\n\t\t\t\t\t\tAPP_ID: item['APP_ID'],\n\t\t\t\t\t\tCODE: item['CODE']\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonclick: onMenuClick\n\t\t\t});\n\t\t}\n\n\t\tif (Reflection.getClass('BX.rest.Marketplace'))\n\t\t{\n\t\t\tif (menuItems.length)\n\t\t\t{\n\t\t\t\tmenuItems.push({ delimiter: true });\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER_MARKETPLACE_2'),\n\t\t\t\tonclick: function()\n\t\t\t\t{\n\t\t\t\t\tBX.rest.Marketplace.open({PLACEMENT: getGlobalContext().get('marketplaceRobotCategory')});\n\t\t\t\t\tthis.getRootMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\ttext: triggerData.NAME,\n\t\t\titems: menuItems\n\t\t}\n\t}\n\n\taddTrigger(triggerData: ?Object<string, any>, callback)\n\t{\n\t\tconst trigger = new Trigger();\n\t\ttrigger.init(triggerData, this.#viewMode);\n\t\tthis.subscribeTriggerEvents(trigger);\n\t\ttrigger.draft = true;\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, trigger);\n\t\t}\n\t}\n\n\tdeleteTrigger(trigger: Trigger, callback)\n\t{\n\t\tif (trigger.getId() > 0)\n\t\t{\n\t\t\ttrigger.markDeleted();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(let i = 0; i < this.#triggers.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#triggers[i] === trigger)\n\t\t\t\t{\n\t\t\t\t\tthis.#triggers.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback(trigger);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.registerItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.addClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.unregisterItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tinsertTriggerNode(documentStatus: string, triggerNode)\n\t{\n\t\tconst listNode = this.#triggersContainerNode.querySelector('[data-role=\"trigger-list\"][data-status-id=\"'+documentStatus+'\"]');\n\t\tif (listNode)\n\t\t{\n\t\t\tlistNode.appendChild(triggerNode);\n\t\t}\n\t}\n\n\tserialize(): Array<Object<string, any>>\n\t{\n\t\treturn this.#triggers.map(trigger => trigger.serialize());\n\t}\n\n\tcountAllTriggers(): number\n\t{\n\t\treturn this.#triggers.filter(trigger => !trigger.deleted).length;\n\t}\n\n\tgetTriggerName(code: string)\n\t{\n\t\treturn getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE'])?.NAME ?? code;\n\t}\n\n\tgetAvailableTrigger(code): ?Object\n\t{\n\t\tconst availableTriggers = getGlobalContext().availableTriggers;\n\t\tfor (let i = 0; i < availableTriggers.length; ++i)\n\t\t{\n\t\t\tif (code === availableTriggers[i]['CODE'])\n\t\t\t{\n\t\t\t\treturn availableTriggers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tcanSetExecuteBy(): boolean\n\t{\n\t\treturn getGlobalContext().get('TRIGGER_CAN_SET_EXECUTE_BY') ?? false;\n\t}\n\n\tneedSave()\n\t{\n\t\treturn this.#modified;\n\t}\n\n\tmarkModified(modified: boolean)\n\t{\n\t\tthis.#modified = modified !== false;\n\t\tif (this.#modified)\n\t\t{\n\t\t\tthis.emit('TriggerManager:dataModified');\n\t\t}\n\t}\n\n\topenTriggerSettingsDialog(trigger, context)\n\t{\n\t\tif (Designer.getInstance().getTriggerSettingsDialog())\n\t\t{\n\t\t\tif (context && context.changeTrigger)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getTriggerSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_trigger_dialog';\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tform.appendChild(this.renderConditionSettings(trigger));\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {click: (event) => this.emit('TriggerManager:onHelpClick', event)}\n\t\t});\n\t\tform.appendChild(iconHelp);\n\n\t\tconst title = this.getTriggerName(trigger.getCode());\n\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_NAME') + ':'\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: trigger.getName() || title\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t],\n\t\t}));\n\n\t\t//TODO: refactoring\n\t\tconst triggerData = this.getAvailableTrigger(trigger.getCode());\n\t\tif (trigger.getCode() === 'WEBHOOK')\n\t\t{\n\t\t\tif (!trigger.getApplyRules()['code'])\n\t\t\t{\n\t\t\t\ttrigger.getApplyRules()['code'] = Text.getRandom(5);\n\t\t\t}\n\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: \"URL:\"\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create('input', {\n\t\t\t\tprops: {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tvalue: trigger.getApplyRules()['code'],\n\t\t\t\t\tname: 'code'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tconst hookLinkTextarea = Dom.create(\"textarea\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-textarea\",\n\t\t\t\t\tplaceholder: \"...\",\n\t\t\t\t\treadonly: 'readonly',\n\t\t\t\t\tname: 'webhook_handler'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [hookLinkTextarea]\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_WEBHOOK_ID'),\n\t\t\t}));\n\n\t\t\tif (triggerData && triggerData['HANDLER'])\n\t\t\t{\n\t\t\t\tlet url = window.location.protocol + '//' + window.location.host + triggerData['HANDLER'];\n\t\t\t\turl = Uri.addParam(url, {code: trigger.getApplyRules()['code']});\n\t\t\t\turl = url.replace('{{DOCUMENT_TYPE}}', getGlobalContext().document.getRawType()[2]);\n\t\t\t\thookLinkTextarea.value = url;\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'EMAIL_LINK')\n\t\t{\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_EMAIL_LINK_URL') + ':',\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create(\"textarea\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tclassName: \"bizproc-automation-popup-textarea\",\n\t\t\t\t\t\t\tplaceholder: \"https://example.com\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprops: {name: 'url'},\n\t\t\t\t\t\ttext: trigger.getApplyRules()['url'] || ''\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}));\n\t\t}\n\t\telse if (trigger.getCode() === 'WEBFORM')\n\t\t{\n\t\t\tif (triggerData && triggerData['WEBFORM_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'form_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY')\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['WEBFORM_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['WEBFORM_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['form_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['form_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'CALLBACK')\n\t\t{\n\t\t\tif (triggerData && triggerData['WEBFORM_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'form_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['WEBFORM_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['WEBFORM_LIST'][i];\n\t\t\t\t\tselect.appendChild(\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['form_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['form_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_LABEL') + ':'}),\n\t\t\t\t\t\tselect\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'STATUS')\n\t\t{\n\t\t\tif (triggerData && triggerData['STATUS_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'STATUS',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_STATUS_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['STATUS_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['STATUS_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['STATUS'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['STATUS'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: triggerData['STATUS_LABEL'] + ':'}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tselect\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() == 'CALL')\n\t\t{\n\t\t\tif (triggerData && triggerData['LINES'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'LINE_NUMBER',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['LINES'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['LINES'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['LINE_NUMBER']},\n\t\t\t\t\t\ttext: item['SHORT_NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (trigger.getApplyRules()['LINE_NUMBER'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['LINE_NUMBER'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_CALL_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() == 'OPENLINE' || trigger.getCode() == 'OPENLINE_MSG')\n\t\t{\n\t\t\tif (triggerData && triggerData['CONFIG_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'config_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY')\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['CONFIG_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['CONFIG_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['config_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['config_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_OPENLINE_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\n\t\tBX.onCustomEvent(\n\t\t\t'BX.Bizproc.Automation.TriggerManager:onOpenSettingsDialog-' + trigger.getCode(),\n\t\t\t[trigger, form]\n\t\t);\n\n\t\tif (this.canSetExecuteBy())\n\t\t{\n\t\t\tthis.renderExecuteByControl(trigger, form);\n\t\t}\n\n\t\tthis.renderAllowBackwardsControl(trigger, form);\n\n\t\tDom.addClass(this.#triggersContainerNode, 'automation-base-blocked');\n\n\t\tDesigner.getInstance().setTriggerSettingsDialog({\n\t\t\ttriggerManager: this,\n\t\t\ttrigger: trigger,\n\t\t\tform: form\n\t\t});\n\n\t\tconst titleBar = trigger.draft ? this.createChangeTriggerTitleBar(title, trigger.documentStatus) : null;\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: titleBar || title,\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function(popup)\n\t\t\t\t{\n\t\t\t\t\tDesigner.getInstance().setTriggerSettingsDialog(null);\n\t\t\t\t\tself.destroySettingsDialogControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tDom.removeClass(self.#triggersContainerNode, 'automation-base-blocked');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick() {\n\t\t\t\t\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\t\t\t\t\ttrigger.setName(formData['data']['name']);\n\n\t\t\t\t\t\t\t//TODO: refactoring\n\t\t\t\t\t\t\tif (trigger.getCode() === 'WEBFORM')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({form_id:  formData['data']['form_id']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'CALLBACK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({form_id: formData['data']['form_id']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'STATUS')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({STATUS: formData['data']['STATUS']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'CALL' && 'LINE_NUMBER' in formData['data'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({LINE_NUMBER: formData['data']['LINE_NUMBER']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'OPENLINE' || trigger.getCode() === 'OPENLINE_MSG')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({config_id: formData['data']['config_id']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.getCode() === 'WEBHOOK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({code: formData['data']['code']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.getCode() === 'EMAIL_LINK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({url: formData['data']['url']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\t\t\t\t'BX.Bizproc.Automation.TriggerManager:onSaveSettings-'+trigger.getCode(),\n\t\t\t\t\t\t\t\t[trigger, formData]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tself.setConditionSettingsFromForm(formData['data'], trigger);\n\t\t\t\t\t\t\ttrigger.setAllowBackwards(formData['data']['allow_backwards'] === 'Y');\n\n\t\t\t\t\t\t\tif (self.canSetExecuteBy())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setExecuteBy(formData['data']['execute_by']);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.draft)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#triggers.push(trigger);\n\t\t\t\t\t\t\t\tself.insertTriggerNode(trigger.getStatusId(), trigger.node)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//analytics\n\t\t\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t\t\t'bizproc.analytics.push',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tanalyticsLabel: `automation_trigger${trigger.draft ? '_draft' : ''}_save_${trigger.getCode().toLowerCase()}`\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tdelete trigger.draft;\n\n\t\t\t\t\t\t\ttrigger.reInit();\n\t\t\t\t\t\t\tself.markModified();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tDesigner.getInstance().getTriggerSettingsDialog().popup = popup;\n\t\tpopup.show();\n\n\t\t//analytics\n\t\tajax.runAction(\n\t\t\t'bizproc.analytics.push',\n\t\t\t{\n\t\t\t\tanalyticsLabel: `automation_trigger${trigger.draft ? '_draft' : ''}_settings_${trigger.getCode().toLowerCase()}`\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateChangeTriggerTitleBar(title, statusId)\n\t{\n\t\treturn {\n\t\t\tcontent: Dom.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'popup-window-titlebar-text bizproc-automation-popup-titlebar-with-link'\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tdocument.createTextNode(title),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-titlebar-link'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHANGE_TRIGGER'),\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: this.onChangeTriggerClick.bind(this, statusId)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t};\n\t}\n\n\trenderConditionSettings(trigger: Trigger)\n\t{\n\t\tconst conditionGroup = trigger.getCondition().clone();\n\n\t\tthis.conditionSelector = new ConditionGroupSelector(\n\t\t\tconditionGroup,\n\t\t\t{fields: getGlobalContext().document.getFields()},\n\t\t);\n\t\tconst selector = this.conditionSelector;\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\",\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselector.createNode(),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\trenderExecuteByControl(trigger, form)\n\t{\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-top bizproc-automation-popup-settings-title-autocomplete\",\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_EXECUTE_BY') + ':',\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tBX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tgetGlobalContext().document.getRawType(),\n\t\t\t\t\t{\n\t\t\t\t\t\tType: 'user'\n\t\t\t\t\t},\n\t\t\t\t\t'execute_by',\n\t\t\t\t\ttrigger.draft\n\t\t\t\t\t\t? Helper.getResponsibleUserExpression(getGlobalContext().document.getFields())\n\t\t\t\t\t\t: trigger.getExecuteBy()\n\t\t\t\t),\n\t\t\t],\n\t\t}));\n\t}\n\n\trenderAllowBackwardsControl(trigger, form)\n\t{\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox-item\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-chk-label\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-chk',\n\t\t\t\t\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\t\t\t\t\tname: \"allow_backwards\",\n\t\t\t\t\t\t\t\t\t\tvalue: 'Y'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tchecked: trigger.isBackwardsAllowed()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdocument.createTextNode(Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_ALLOW_REVERSE')),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t}));\n\t}\n\n\tsetConditionSettingsFromForm(formFields: Object,  trigger: Trigger): this\n\t{\n\t\ttrigger.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\tonRestAppInstall(installed, eventResult)\n\t{\n\t\teventResult.redirect = false;\n\t\tconst self = this;\n\n\t\tsetTimeout(function()\n\t\t{\n\t\t\tBX.ajax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: getGlobalContext().ajaxUrl,\n\t\t\t\tdata: {\n\t\t\t\t\tajax_action: 'get_available_triggers',\n\t\t\t\t\tdocument_signed: getGlobalContext().signedDocument\n\t\t\t\t},\n\t\t\t\tonsuccess(response)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isArray(response['DATA']))\n\t\t\t\t\t{\n\t\t\t\t\t\tgetGlobalContext().set('availableTriggers', response['DATA']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}, 1500);\n\t}\n\n\tinitSettingsDialogControls(node)\n\t{\n\t\tif (!Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tthis.settingsDialogControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tlet control = null;\n\t\t\tconst role = controlNodes[i].getAttribute('data-role');\n\n\t\t\tif (role === 'user-selector')\n\t\t\t{\n\t\t\t\tcontrol = BX.Bizproc.UserSelector.decorateNode(controlNodes[i]);\n\t\t\t}\n\n\t\t\tBX.UI.Hint.init(controlNodes[i]);\n\n\t\t\tif (control)\n\t\t\t{\n\t\t\t\tthis.settingsDialogControls.push(control);\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroySettingsDialogControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.settingsDialogControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.settingsDialogControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.settingsDialogControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.settingsDialogControls = null;\n\t}\n\n\tgetListByDocumentStatus(statusId): Array<Trigger>\n\t{\n\t\tconst result = [];\n\t\tthis.#triggers.forEach((trigger) => {\n\t\t\tif (trigger.getStatusId() === statusId)\n\t\t\t{\n\t\t\t\tresult.push(trigger);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperties(statusId): Array<Object>\n\t{\n\t\tconst result = [];\n\t\tconst exists = {};\n\t\tconst triggers = this.getListByDocumentStatus(statusId);\n\n\t\ttriggers.forEach((trigger) => {\n\t\t\tconst props = trigger.deleted ? [] : trigger.getReturnProperties();\n\t\t\tif (props.length)\n\t\t\t{\n\t\t\t\tprops.forEach((property) => {\n\t\t\t\t\tif (!exists[property.Id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tId: property.Id,\n\t\t\t\t\t\t\tObjectId: 'Template',\n\t\t\t\t\t\t\tName: property.Name,\n\t\t\t\t\t\t\tObjectName: trigger.getName(),\n\t\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\t\tExpression: '{{~*:'+property.Id+'}}',\n\t\t\t\t\t\t\tSystemExpression: '{=Template:'+property.Id+'}'\n\t\t\t\t\t\t});\n\t\t\t\t\t\texists[property.Id] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperty(statusId, propertyId): ?Object\n\t{\n\t\tconst properties = this.getReturnProperties(statusId);\n\t\tfor (let i = 0; i < properties.length; ++i)\n\t\t{\n\t\t\tif (properties[i].Id === propertyId)\n\t\t\t{\n\t\t\t\treturn properties[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { Type, Runtime } from 'main.core';\n\nexport class Document\n{\n\t#rawType: Array<string>;\n\t#id: number;\n\t#title: ?string;\n\t#categoryId: ?number;\n\t#statusList: ?Array<Object>;\n\t#currentStatusIndex: number;\n\n\t#fields: ?Array<Object>;\n\n\tconstructor(options: {\n\t\trawDocumentType: Array<string>,\n\t\tdocumentId: number,\n\t\tcategoryId?: number,\n\t\tstatusId?: string,\n\n\t\tstatusList: Array<Object>,\n\n\t\tdocumentFields?: Array<Object>;\n\t\ttitle?: string,\n\t})\n\t{\n\t\tthis.#rawType = options.rawDocumentType;\n\t\tthis.#id = options.documentId;\n\t\tthis.#title = options.title;\n\t\tthis.#categoryId = options.categoryId;\n\n\t\tthis.#statusList = [];\n\t\tthis.#currentStatusIndex = 0;\n\t\tif (Type.isArray(options.statusList))\n\t\t{\n\t\t\tthis.#statusList = options.statusList\n\t\t\tthis.#currentStatusIndex = this.#statusList.findIndex(status => status.STATUS_ID === options.statusId)\n\t\t}\n\t\telse if (Type.isStringFilled(options.statusId))\n\t\t{\n\t\t\tthis.#statusList.push(options.statusId);\n\t\t}\n\n\t\tif (this.#currentStatusIndex < 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = 0;\n\t\t}\n\n\t\tthis.#fields = Type.isArray(options.documentFields) ? options.documentFields : [];\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new Document({\n\t\t\trawDocumentType: Runtime.clone(this.#rawType),\n\t\t\tdocumentId: this.#id,\n\t\t\tcategoryId: this.#categoryId,\n\t\t\tstatusId: this.getCurrentStatusId(),\n\n\t\t\tstatusList: Runtime.clone(this.#statusList),\n\n\t\t\tdocumentFields: Runtime.clone(this.#fields),\n\t\t\ttitle: this.#title,\n\t\t});\n\t}\n\n\tget title(): ?string\n\t{\n\t\treturn this.#title;\n\t}\n\n\tgetRawType(): Array<string>\n\t{\n\t\treturn this.#rawType;\n\t}\n\n\tgetCategoryId(): ?number\n\t{\n\t\treturn this.#categoryId;\n\t}\n\n\tgetCurrentStatusId(): ?string\n\t{\n\t\treturn this.#statusList[this.#currentStatusIndex]?.STATUS_ID;\n\t}\n\n\tgetSortedStatusId(index: number): ?string\n\t{\n\t\tif (index >= 0 && index < this.#statusList.length)\n\t\t{\n\t\t\treturn this.#statusList[index].STATUS_ID;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetNextStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(this.#currentStatusIndex + 1).map(status => status.STATUS_ID);\n\t}\n\n\tgetPreviousStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(0, this.#currentStatusIndex).map(status => status.STATUS_ID);\n\t}\n\n\tsetStatus(statusId: string): Document\n\t{\n\t\tconst newStatusId = this.#statusList.findIndex(status => status.STATUS_ID === statusId);\n\t\tif (newStatusId >= 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = newStatusId;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetFields(): Array<Object>\n\t{\n\t\treturn this.#fields;\n\t}\n\n\tsetFields(documentFields: Array<object>): this\n\t{\n\t\tthis.#fields = documentFields;\n\n\t\treturn this;\n\t}\n\n\tsetStatusList(statusList: Array<Object>): this\n\t{\n\t\tif (Type.isArrayFilled(statusList))\n\t\t{\n\t\t\tthis.#statusList = statusList;\n\t\t}\n\n\t\treturn this;\n\t}\n}","import { Type, Loc } from 'main.core';\n\nexport class DelayInterval\n{\n\tstatic BASIS_TYPE = {\n\t\tCurrentDate: '{=System:Date}',\n\t\tCurrentDateTime: '{=System:Now}',\n\t\tCurrentDateTimeLocal: '{=System:NowLocal}',\n\t};\n\n\tstatic DELAY_TYPE = {\n\t\tAfter: 'after',\n\t\tBefore: 'before',\n\t\tIn: 'in',\n\t};\n\n\t#basis: string;\n\t#type: string;\n\t#value: number;\n\t#valueType: string;\n\t#workTime: boolean;\n\t#localTime: boolean;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tthis.#basis = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t\tthis.#type = DelayInterval.DELAY_TYPE.After;\n\t\tthis.#value = 0;\n\t\tthis.#valueType = 'i';\n\t\tthis.#workTime = false;\n\t\tthis.#localTime = false;\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.setType(params['type']);\n\t\t\t}\n\t\t\tif (params['value'])\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t\tif (params['valueType'])\n\t\t\t{\n\t\t\t\tthis.setValueType(params['valueType']);\n\t\t\t}\n\t\t\tif (params['basis'])\n\t\t\t{\n\t\t\t\tthis.setBasis(params['basis']);\n\t\t\t}\n\t\t\tif (params['workTime'])\n\t\t\t{\n\t\t\t\tthis.setWorkTime(params['workTime']);\n\t\t\t}\n\t\t\tif (params['localTime'])\n\t\t\t{\n\t\t\t\tthis.setLocalTime(params['localTime']);\n\t\t\t}\n\t\t}\n\t}\n\n\tget basis()\n\t{\n\t\treturn this.#basis;\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tget valueType()\n\t{\n\t\treturn this.#valueType;\n\t}\n\n\tget workTime()\n\t{\n\t\treturn this.#workTime;\n\t}\n\n\tget localTime()\n\t{\n\t\treturn this.#localTime;\n\t}\n\n\tclone()\n\t{\n\t\treturn new DelayInterval({\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime,\n\t\t\tlocalTime: this.#localTime,\n\t\t});\n\t}\n\n\tstatic isSystemBasis(basis: string): boolean\n\t{\n\t\treturn (\n\t\t\tbasis === this.BASIS_TYPE.CurrentDate\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTime\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTimeLocal\n\t\t);\n\t}\n\n\tstatic fromString(intervalString, basisFields): this\n\t{\n\t\tintervalString = intervalString.toString();\n\t\tconst params = {\n\t\t\tbasis: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\ti: 0,\n\t\t\th: 0,\n\t\t\td: 0,\n\t\t\tworkTime: false,\n\t\t\tlocalTime: false\n\t\t};\n\n\t\tif (intervalString.indexOf('=dateadd(') === 0 || intervalString.indexOf('=workdateadd(') === 0)\n\t\t{\n\t\t\tif (intervalString.indexOf('=workdateadd(') === 0)\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(13);\n\t\t\t\tparams['workTime'] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(9);\n\t\t\t}\n\n\t\t\tconst fnArgs = intervalString.split(',');\n\t\t\tparams['basis'] = fnArgs[0].trim();\n\t\t\tfnArgs[1] = fnArgs[1].replace(/['\")]+/g, '');\n\t\t\tparams['type'] = fnArgs[1].indexOf('-') === 0 ? DelayInterval.DELAY_TYPE.Before : DelayInterval.DELAY_TYPE.After;\n\n\t\t\tlet match;\n\t\t\tconst re = /s*([\\d]+)\\s*(i|h|d)\\s*/ig;\n\t\t\twhile (match = re.exec(fnArgs[1]))\n\t\t\t{\n\t\t\t\tparams[match[2]] = parseInt(match[1]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['basis'] = intervalString;\n\t\t}\n\n\t\tif (!DelayInterval.isSystemBasis(params['basis']) && BX.type.isArray(basisFields))\n\t\t{\n\t\t\tlet found = false;\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (params['basis'] === basisFields[i].SystemExpression || params['basis'] === basisFields[i].Expression)\n\t\t\t\t{\n\t\t\t\t\tparams['basis'] = basisFields[i].SystemExpression;\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\tparams['basis'] = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t\t\t}\n\t\t}\n\n\t\tconst minutes = params['i'] + params['h'] * 60 + params['d'] * 60 * 24;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 1440;\n\t\t\tparams['valueType'] = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 60;\n\t\t\tparams['valueType'] = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['value'] = minutes;\n\t\t\tparams['valueType'] = 'i';\n\t\t}\n\n\t\tif (!params['value'] && params['basis'] !== DelayInterval.BASIS_TYPE.CurrentDateTime && params['basis'])\n\t\t{\n\t\t\tparams['type'] = DelayInterval.DELAY_TYPE.In;\n\t\t}\n\n\t\treturn new DelayInterval(params);\n\t};\n\n\tstatic fromMinutes(minutes): Array<string>\n\t{\n\t\tlet value;\n\t\tlet type;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tvalue = minutes / 1440;\n\t\t\ttype = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tvalue = minutes / 60;\n\t\t\ttype = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalue = minutes;\n\t\t\ttype = 'i';\n\t\t}\n\n\t\treturn [value, type];\n\t}\n\n\tstatic toMinutes(value, valueType): number\n\t{\n\t\tlet result = 0;\n\n\t\tswitch (valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tresult = value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\tresult = value * 60;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tresult = value * 60 * 24;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetType(type): this\n\t{\n\t\tif (\n\t\t\ttype !== DelayInterval.DELAY_TYPE.After\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.Before\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.In\n\t\t)\n\t\t{\n\t\t\ttype = DelayInterval.DELAY_TYPE.After;\n\t\t}\n\t\tthis.#type = type;\n\n\t\treturn this;\n\t}\n\n\tsetValue(value): this\n\t{\n\t\tvalue = parseInt(value);\n\t\tthis.#value = value >= 0 ? value : 0;\n\n\t\treturn this;\n\t}\n\n\tsetValueType(valueType: string): this\n\t{\n\t\tif (valueType !== 'i' && valueType !== 'h' && valueType !== 'd')\n\t\t{\n\t\t\tvalueType = 'i';\n\t\t}\n\n\t\tthis.#valueType = valueType;\n\n\t\treturn this;\n\t}\n\n\tsetBasis(basis: string): this\n\t{\n\t\tif (Type.isString(basis) && basis !== '')\n\t\t{\n\t\t\tthis.#basis = basis;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetWorkTime(flag): this\n\t{\n\t\tthis.#workTime = !!flag;\n\n\t\treturn this;\n\t}\n\n\tsetLocalTime(flag): this\n\t{\n\t\tthis.#localTime = !!flag;\n\n\t\treturn this;\n\t}\n\n\tisNow(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t&& this.#basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t&& !this.#value\n\t\t);\n\t}\n\n\tsetNow(): void\n\t{\n\t\tthis.setType(DelayInterval.DELAY_TYPE.After);\n\t\tthis.setValue(0);\n\t\tthis.setValueType('i');\n\t\tthis.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime ? 1 : 0\n\t\t}\n\t}\n\n\ttoExpression(basisFields, workerExpression): string\n\t{\n\t\tlet basis = this.#basis ? this.#basis : DelayInterval.BASIS_TYPE.CurrentDate;\n\n\t\tif (!DelayInterval.isSystemBasis(basis) && Type.isArray(basisFields))\n\t\t{\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (basis === basisFields[i].SystemExpression)\n\t\t\t\t{\n\t\t\t\t\tbasis = basisFields[i].Expression;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this.#workTime && (this.#type === DelayInterval.DELAY_TYPE.In || this.isNow()))\n\t\t{\n\t\t\treturn basis;\n\t\t}\n\n\t\tlet days = 0;\n\t\tlet hours = 0;\n\t\tlet minutes = 0;\n\n\t\tswitch (this.#valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tminutes = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\thours = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tdays = this.#value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet add = '';\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tadd = '-';\n\t\t}\n\n\t\tif (days > 0)\n\t\t{\n\t\t\tadd += days + 'd';\n\t\t}\n\t\tif (hours > 0)\n\t\t{\n\t\t\tadd += hours + 'h';\n\t\t}\n\t\tif (minutes > 0)\n\t\t{\n\t\t\tadd += minutes + 'i';\n\t\t}\n\n\t\tconst fn = this.#workTime ? 'workdateadd' : 'dateadd';\n\n\t\tif (fn === 'workdateadd' && add === '')\n\t\t{\n\t\t\tadd = '0d';\n\t\t}\n\n\t\tlet worker = '';\n\t\tif (fn === 'workdateadd' && workerExpression)\n\t\t{\n\t\t\tworker = workerExpression;\n\t\t}\n\n\t\treturn '='+ fn + '(' + basis + ',\"' + add + '\"' + (worker ? ',' + worker : '') + ')';\n\t}\n\n\tformat(emptyText, fields)\n\t{\n\t\tlet str = emptyText;\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tstr = Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME');\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.#value)\n\t\t{\n\t\t\tconst prefix = (\n\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH')\n\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_1')\n\t\t\t);\n\n\t\t\tstr = prefix + ' ' + this.getFormattedPeriodLabel(this.#value, this.#valueType);\n\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tconst fieldSuffix = (\n\t\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t);\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fieldSuffix + ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.#workTime)\n\t\t{\n\t\t\tstr += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_WORKTIME');\n\t\t}\n\n\t\treturn str;\n\t}\n\n\tgetFormattedPeriodLabel(value, type)\n\t{\n\t\tconst label = value + ' ';\n\t\tlet labelIndex = 0;\n\t\tif (value > 20)\n\t\t{\n\t\t\tvalue = (value % 10);\n\t\t}\n\n\t\tif (value === 1)\n\t\t{\n\t\t\tlabelIndex = 0;\n\t\t}\n\t\telse if (value > 1 && value < 5)\n\t\t{\n\t\t\tlabelIndex = 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabelIndex = 2;\n\t\t}\n\n\t\tconst labels = DelayInterval.getPeriodLabels(type);\n\n\t\treturn label + (labels ? labels[labelIndex] : '');\n\t}\n\n\tstatic getPeriodLabels(period)\n\t{\n\t\tlet labels = [];\n\t\tif (period === 'i')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'h')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'd')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY3')\n\t\t\t];\n\t\t}\n\n\t\treturn labels;\n\t}\n}","export class WorkflowStatus\n{\n\tstatic CREATED = 0;\n\tstatic RUNNING = 1;\n\tstatic COMPLETED = 2;\n\tstatic SUSPENDED = 3;\n\tstatic TERMINATED = 4;\n}","import {WorkflowStatus} from \"../workflow/types\";\n\nexport class TrackingEntry\n{\n\tstatic UNKNOWN_ACTIVITY_TYPE = 0;\n\tstatic EXECUTE_ACTIVITY_TYPE = 1;\n\tstatic CLOSE_ACTIVITY_TYPE = 2;\n\tstatic CANCEL_ACTIVITY_TYPE = 3;\n\tstatic FAULT_ACTIVITY_TYPE = 4;\n\tstatic CUSTOM_ACTIVITY_TYPE = 5;\n\tstatic REPORT_ACTIVITY_TYPE = 6;\n\tstatic ATTACHED_ENTITY_TYPE = 7;\n\tstatic TRIGGER_ACTIVITY_TYPE = 8;\n\tstatic ERROR_ACTIVITY_TYPE = 9;\n\tstatic DEBUG_ACTIVITY_TYPE = 10;\n\tstatic DEBUG_AUTOMATION_TYPE = 11;\n\tstatic DEBUG_DESIGNER_TYPE = 12;\n\tstatic DEBUG_LINK_TYPE = 13;\n\n\tid: number;\n\tworkflowId: string;\n\t#type: number;\n\tname: string;\n\ttitle: string;\n\tnote: string;\n\t// TODO - convert string to Date\n\tdatetime: string;\n\t#workflowStatus: number;\n\n\tget type(): number\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget workflowStatus(): number\n\t{\n\t\treturn this.#workflowStatus;\n\t}\n\n\tset type(entryType: number)\n\t{\n\t\tif (TrackingEntry.getAllActivityTypes().includes(entryType))\n\t\t{\n\t\t\tthis.#type = entryType;\n\t\t}\n\t}\n\n\tset workflowStatus(entryWorkflowStatus: number)\n\t{\n\t\tif (TrackingEntry.getAllWorkflowStatuses().includes(entryWorkflowStatus))\n\t\t{\n\t\t\tthis.#workflowStatus = entryWorkflowStatus;\n\t\t}\n\t}\n\n\tisTriggerEntry(): boolean\n\t{\n\t\treturn this.type === TrackingEntry.TRIGGER_ACTIVITY_TYPE;\n\t}\n\n\tstatic getAllActivityTypes(): Array<number>\n\t{\n\t\treturn [\n\t\t\tTrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CLOSE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CANCEL_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.FAULT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CUSTOM_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.REPORT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ATTACHED_ENTITY_TYPE,\n\t\t\tTrackingEntry.TRIGGER_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ERROR_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_AUTOMATION_TYPE,\n\t\t\tTrackingEntry.DEBUG_DESIGNER_TYPE,\n\t\t\tTrackingEntry.DEBUG_LINK_TYPE,\n\t\t];\n\t}\n\n\tstatic isKnownActivityType(typeId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllActivityTypes().includes(typeId);\n\t}\n\n\tstatic getAllWorkflowStatuses(): Array<number>\n\t{\n\t\treturn [\n\t\t\tWorkflowStatus.CREATED,\n\t\t\tWorkflowStatus.RUNNING,\n\t\t\tWorkflowStatus.COMPLETED,\n\t\t\tWorkflowStatus.SUSPENDED,\n\t\t\tWorkflowStatus.TERMINATED,\n\t\t];\n\t}\n\n\tstatic isKnownWorkflowStatus(statusId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllWorkflowStatuses().includes(statusId);\n\t}\n}","export class TrackingStatus\n{\n\tstatic WAITING = 0;\n\tstatic RUNNING = 1;\n\tstatic COMPLETED = 2;\n\tstatic AUTOCOMPLETED = 3;\n}","import {Type} from 'main.core';\nimport { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport {WorkflowStatus} from \"../workflow/types\";\n\nexport class RobotEntry\n{\n\tid: string = '';\n\tstatus: string = TrackingStatus.WAITING;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\tnotes: Array<string> = [];\n\terrors: Array<string> = [];\n\t#entryId: number = -1;\n\tworkflowStatus: number = WorkflowStatus.CREATED;\n\n\tconstructor(entries: ?Array<TrackingEntry>)\n\t{\n\t\tif (Type.isArray(entries))\n\t\t{\n\t\t\tfor (const entry of entries)\n\t\t\t{\n\t\t\t\tthis.addEntry(entry);\n\t\t\t}\n\t\t}\n\t}\n\n\taddEntry(entry: TrackingEntry)\n\t{\n\t\tthis.id = entry.name;\n\n\t\tif (this.#entryId < entry.id)\n\t\t{\n\t\t\tthis.#entryId = entry.id;\n\t\t\tthis.modified = entry.datetime;\n\t\t\tthis.workflowStatus = entry.workflowStatus;\n\n\t\t\tif (entry.type === TrackingEntry.CLOSE_ACTIVITY_TYPE)\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.COMPLETED;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\tif (entry.type === TrackingEntry.ERROR_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.errors.push(entry.note);\n\t\t}\n\t\telse if (entry.type === TrackingEntry.CUSTOM_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.notes.push(entry.note);\n\t\t}\n\t}\n}","import { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\n\nexport class TriggerEntry\n{\n\tid: string = '';\n\tstatus: number = TrackingStatus.COMPLETED;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\n\tconstructor(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.id = entry.note;\n\t\t\tthis.modified = entry.datetime;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport class TrackingEntryBuilder\n{\n\t#defaultSettings = {\n\t\tid: TrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\tworkflowId: '',\n\t\ttype: TrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\tname: '',\n\t\ttitle: '',\n\t\tdatetime: '',\n\t\tnote: '',\n\t\tworkflowStatus: WorkflowStatus.CREATED,\n\t};\n\t#entrySettings: Object<string, string | number>;\n\n\tconstructor()\n\t{\n\t\tthis.#entrySettings = this.#defaultSettings;\n\t}\n\n\tsetLogEntry(logEntry: Object<string, any>): this\n\t{\n\t\tthis.#entrySettings = Object.assign({}, this.#defaultSettings);\n\t\tlogEntry = Object.assign({}, logEntry);\n\n\t\tif (Type.isStringFilled(logEntry['ID']))\n\t\t{\n\t\t\tlogEntry['ID'] = parseInt(logEntry['ID']);\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['TYPE']))\n\t\t{\n\t\t\tlogEntry['TYPE'] = parseInt(logEntry['TYPE']);\n\t\t}\n\n\t\tif (Type.isNumber(logEntry['ID']))\n\t\t{\n\t\t\tthis.#entrySettings.id = logEntry['ID'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['WORKFLOW_ID']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowId = logEntry['WORKFLOW_ID'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['TYPE']) && TrackingEntry.isKnownActivityType(logEntry['TYPE']))\n\t\t{\n\t\t\tthis.#entrySettings.type = logEntry['TYPE'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['MODIFIED']))\n\t\t{\n\t\t\tthis.#entrySettings.datetime = logEntry['MODIFIED'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['WORKFLOW_STATUS']) && TrackingEntry.isKnownWorkflowStatus(logEntry['WORKFLOW_STATUS']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowStatus = logEntry['WORKFLOW_STATUS'];\n\t\t}\n\n\t\tthis.#entrySettings.name = String(logEntry['ACTION_NAME']);\n\t\tthis.#entrySettings.title = String(logEntry['ACTION_TITLE']);\n\t\tthis.#entrySettings.note = String(logEntry['ACTION_NOTE']);\n\n\t\treturn this;\n\t}\n\n\tsetStatus(status: string): this\n\t{\n\t\tthis.#entrySettings.status = status;\n\n\t\treturn this;\n\t}\n\n\tbuild(): TrackingEntry\n\t{\n\t\tconst entry = new TrackingEntry();\n\n\t\tentry.id = this.#entrySettings.id;\n\t\tentry.workflowId = this.#entrySettings.workflowId;\n\t\tentry.type = this.#entrySettings.type;\n\t\tentry.name = this.#entrySettings.name;\n\t\tentry.title = this.#entrySettings.title;\n\t\tentry.note = this.#entrySettings.note;\n\t\tentry.datetime = this.#entrySettings.datetime;\n\t\tentry.workflowStatus = this.#entrySettings.workflowStatus;\n\n\t\treturn entry;\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { RobotEntry } from './robot-entry';\nimport { TriggerEntry } from './trigger-entry';\nimport { TrackingEntryBuilder } from './tracking-entry-builder';\nimport { Document } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport {\n\tRobotEntry,\n\tTriggerEntry,\n\tTrackingEntryBuilder,\n\tTrackingEntry,\n\tTrackingStatus,\n}\n\nexport class Tracker\n{\n\t#ajaxUrl: string;\n\t#document: ?Document;\n\n\t#triggerLogs: Object<string, TrackingEntry>;\n\t#robotLogs: Object<string, RobotEntry>;\n\n\tconstructor(document: ?Document, ajaxUrl: string)\n\t{\n\t\tthis.#ajaxUrl = ajaxUrl;\n\t\tthis.#document = document;\n\t}\n\n\tinit(log)\n\t{\n\t\tthis.#triggerLogs = {};\n\t\tthis.#robotLogs = {};\n\n\t\tthis.addLogs(log);\n\t}\n\n\treInit(log)\n\t{\n\t\tthis.init(log);\n\t}\n\n\taddLogs(log: Object<string, Array<Object<string, any>>>)\n\t{\n\t\tif (!Type.isPlainObject(log))\n\t\t{\n\t\t\tlog = {};\n\t\t}\n\n\t\tconst logEntryBuilder = new TrackingEntryBuilder();\n\n\t\tfor (const [statusId, entries] of Object.entries(log))\n\t\t{\n\t\t\tif (!Type.isArray(entries))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const rawEntry of entries)\n\t\t\t{\n\t\t\t\tconst entry = logEntryBuilder.setLogEntry(rawEntry).build();\n\n\t\t\t\tif (entry.isTriggerEntry())\n\t\t\t\t{\n\t\t\t\t\tthis.addTriggerEntry(entry);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.addRobotEntry(entry);\n\t\t\t\t\tconst robotEntry = this.#robotLogs[entry.name];\n\n\t\t\t\t\tif (!Type.isNil(this.#document))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isRobotRunning = (robotEntry.status === TrackingStatus.RUNNING);\n\t\t\t\t\t\tconst isWorkflowCompleted =\n\t\t\t\t\t\t\t(robotEntry.workflowStatus === WorkflowStatus.COMPLETED)\n\t\t\t\t\t\t;\n\t\t\t\t\t\tconst isCurrentStatus = (this.#document.getCurrentStatusId() === statusId);\n\n\t\t\t\t\t\tconst isRobotRunningAtAnotherStatus = isRobotRunning && !isCurrentStatus;\n\t\t\t\t\t\tconst isRobotRunningAndCurrentWorkflowCompleted =\n\t\t\t\t\t\t\tisRobotRunning && isWorkflowCompleted && isCurrentStatus\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tif (isRobotRunningAtAnotherStatus || isRobotRunningAndCurrentWorkflowCompleted)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trobotEntry.status = TrackingStatus.COMPLETED;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddTriggerEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.#triggerLogs[entry.note] = new TriggerEntry(entry);\n\t\t}\n\t}\n\n\taddRobotEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#robotLogs[entry.name])\n\t\t{\n\t\t\tthis.#robotLogs[entry.name] = new RobotEntry([entry]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robotLogs[entry.name].addEntry(entry);\n\t\t}\n\t}\n\n\tgetRobotLog(id: string): ?RobotEntry\n\t{\n\t\treturn this.#robotLogs[id] || null;\n\t}\n\n\tgetTriggerLog(id: string): ?TriggerEntry\n\t{\n\t\treturn this.#triggerLogs[id] || null;\n\t}\n\n\tupdate(documentSigned: string)\n\t{\n\t\treturn BX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: this.#ajaxUrl,\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_log',\n\t\t\t\tdocument_signed: documentSigned\n\t\t\t},\n\t\t\tonsuccess: (response) => {\n\t\t\t\tif (response.DATA && response.DATA.LOG)\n\t\t\t\t{\n\t\t\t\t\tthis.reInit(response.DATA.LOG);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","import { Dom, Type, Event, Text, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Document } from './document/document';\nimport { Template } from './template';\nimport { DelayInterval } from './delay-interval';\nimport { ViewMode } from './view-mode';\nimport { HelpHint } from './help-hint';\nimport { ConditionGroup, Helper } from 'bizproc.automation';\nimport { Tracker } from './tracker/tracker'\nimport { TrackingStatus } from './tracker/types';\n\nexport class Robot extends EventEmitter\n{\n\tSYSTEM_EXPRESSION_PATTERN = '\\\\{=\\\\s*(?<object>[a-z0-9_]+)\\\\s*\\\\:\\\\s*(?<field>[a-z0-9_\\\\.]+)(\\\\s*>\\\\s*(?<mod1>[a-z0-9_\\\\:]+)(\\\\s*,\\\\s*(?<mod2>[a-z0-9_]+))?)?\\\\s*\\\\}';\n\n\t#data: Object<string, any>;\n\t#document: Document;\n\t#template: ?Template;\n\t#tracker: ?Object;\n\t#delay: DelayInterval;\n\t#node: HTMLElement;\n\t#condition: ConditionGroup;\n\t#isDraft: boolean;\n\n\t#isFrameMode: boolean;\n\t#viewMode: ViewMode;\n\n\tconstructor(params: {\n\t\tdocument: Document,\n\t\ttemplate: ?Template,\n\t\tisFrameMode: boolean,\n\t\ttracker: Tracker,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#document = params.document;\n\t\tif (!Type.isNil(params.template))\n\t\t{\n\t\t\tthis.#template = params.template;\n\t\t}\n\t\tthis.#isFrameMode = params.isFrameMode;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#tracker = params.tracker;\n\t\tthis.#isDraft = false;\n\n\t\tthis.#delay = new DelayInterval();\n\t}\n\n\tget node()\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget data()\n\t{\n\t\treturn this.#data;\n\t}\n\n\tget draft()\n\t{\n\t\treturn this.#isDraft;\n\t}\n\n\tset draft(draft: boolean)\n\t{\n\t\tthis.#isDraft = draft;\n\t}\n\n\tget template()\n\t{\n\t\treturn this.#template;\n\t}\n\n\thasTemplate(): boolean\n\t{\n\t\treturn !Type.isNil(this.#template);\n\t}\n\n\tgetTemplate(): ?Template\n\t{\n\t\treturn this.#template;\n\t}\n\n\tgetDocument(): Document\n\t{\n\t\treturn this.#document;\n\t}\n\n\tstatic generateName(): string\n\t{\n\t\treturn (\n\t\t\t'A' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t);\n\t}\n\n\tclone(): Robot\n\t{\n\t\tconst clonedRobot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate: this.#template,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = {\n\t\t\tName: Robot.generateName(),\n\t\t\tDelay: this.getDelayInterval().clone(),\n\t\t\tCondition: this.getCondition().clone(),\n\t\t\t...BX.clone(this.#data)\n\t\t};\n\t\tclonedRobot.init(robotData, this.#viewMode);\n\n\t\treturn clonedRobot;\n\t}\n\n\tisEqual(other: Robot): boolean\n\t{\n\t\treturn this.#data.Name === other.#data.Name;\n\t}\n\n\tinit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\tif (!this.#data.Name)\n\t\t{\n\t\t\tthis.#data.Name = Robot.generateName();\n\t\t}\n\n\t\tthis.#delay = new DelayInterval(this.#data.Delay);\n\t\tthis.#condition = new ConditionGroup(this.#data.Condition);\n\t\tif (!this.#data.Condition)\n\t\t{\n\t\t\tthis.#condition.type = ConditionGroup.CONDITION_TYPE.Mixed;\n\t\t}\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#node = this.createNode();\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isNil(viewMode) && this.#viewMode.isNone())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.emit('Robot:destroyed');\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn this.#template.canEdit();\n\t}\n\n\tgetProperties(): Object\n\t{\n\t\tif (this.#data && Type.isPlainObject(this.#data.Properties))\n\t\t{\n\t\t\treturn this.#data.Properties;\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tgetProperty(name: string): ?Object\n\t{\n\t\treturn this.getProperties()[name] || null;\n\t}\n\n\thasProperty(name: string): boolean\n\t{\n\t\treturn this.getProperties().hasOwnProperty(name);\n\t}\n\n\tsetProperty(name: string, value: any): Robot\n\t{\n\t\tthis.#data.Properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetId(): ?string\n\t{\n\t\treturn this.#data.Name || null;\n\t}\n\n\tgetLogStatus(): number\n\t{\n\t\tlet status = TrackingStatus.WAITING;\n\t\tlet log = this.#tracker.getRobotLog(this.getId());\n\n\t\tif (log)\n\t\t{\n\t\t\tstatus = log.status;\n\t\t}\n\t\telse if (this.#data.DelayName)\n\t\t{\n\t\t\tlog = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\tstatus = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t}\n\n\tgetLogErrors(): Array<string>\n\t{\n\t\tlet errors = [];\n\t\tconst log = this.#tracker.getRobotLog(this.getId());\n\t\tif (log && log.errors)\n\t\t{\n\t\t\terrors = log.errors;\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\tgetDelayNotes(): Array<string>\n\t{\n\t\tif (this.#data.DelayName)\n\t\t{\n\t\t\tconst log = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\treturn log.notes;\n\t\t\t}\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tselectNode(): void\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--selected');\n\t\t\tthis.emit('Robot:selected');\n\t\t}\n\t}\n\n\tunselectNode()\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--selected');\n\t\t\tthis.emit('Robot:unselected');\n\t\t}\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#node && Dom.hasClass(this.#node, '--selected');\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\tif (!isActive)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--locked-node');\n\t\t}\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.hide(deleteButton);\n\n\t\tthis.#node.onclick = () => {\n\t\t\tif (!this.#viewMode.isManage() || !this.#viewMode.getProperty('isActive', false))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isSelected())\n\t\t\t{\n\t\t\t\tthis.selectNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unselectNode();\n\t\t\t}\n\t\t};\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tthis.unselectNode();\n\t\tDom.removeClass(this.#node, '--locked-node');\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.show(deleteButton);\n\n\t\tthis.#node.onclick = undefined;\n\t}\n\n\tcreateNode(): HTMLElement\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-robot-container-wrapper';\n\t\tlet containerClass = 'bizproc-automation-robot-container';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-robot-container-wrapper-draggable';\n\t\t}\n\n\t\tconst targetLabel = Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO');\n\t\tconst targetNode = Dom.create(\"a\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-settings-name \" + (this.#viewMode.isView() ? '--mode-view' : ''),\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t});\n\n\t\tif (Type.isPlainObject(this.#data.viewData) && this.#data.viewData.responsibleLabel)\n\t\t{\n\t\t\tlet labelText =\n\t\t\t\tthis.#data.viewData.responsibleLabel\n\t\t\t\t\t.replace('{=Document:ASSIGNED_BY_ID}', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace('author', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace(/\\{=Constant\\:Constant[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{\\{~&\\:Constant[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{=Template\\:Parameter[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t\t\t.replace(/\\{\\{~&:\\:Parameter[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t;\n\n\t\t\tif (labelText.indexOf('{=Document') >= 0)\n\t\t\t{\n\t\t\t\tthis.#document.getFields().forEach(field => {\n\t\t\t\t\tlabelText = labelText.replace(field['SystemExpression'], field['Name']);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (labelText.indexOf('{=A') >= 0)\n\t\t\t{\n\t\t\t\tthis.#template.robots.forEach(robot => {\n\t\t\t\t\trobot.getReturnFieldsDescription().forEach(field => {\n\t\t\t\t\t\tif (field['Type'] === 'user')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabelText = labelText.replace(\n\t\t\t\t\t\t\t\tfield['SystemExpression'],\n\t\t\t\t\t\t\t\trobot.getTitle() + ': ' + field['Name']\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttargetNode.textContent = labelText;\n\t\t\ttargetNode.setAttribute('title', labelText);\n\n\t\t\tif (this.#data.viewData.responsibleUrl)\n\t\t\t{\n\t\t\t\ttargetNode.href = this.#data.viewData.responsibleUrl;\n\t\t\t\tif (this.#isFrameMode)\n\t\t\t\t{\n\t\t\t\t\ttargetNode.setAttribute('target', '_blank');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.#viewMode.isEdit() && parseInt(this.#data.viewData.responsibleId) > 0)\n\t\t\t{\n\t\t\t\ttargetNode.setAttribute('bx-tooltip-user-id', this.#data.viewData.responsibleId);\n\t\t\t}\n\t\t}\n\n\t\tlet delayLabel = this.getDelayInterval().format(\n\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\tthis.#document.getFields()\n\t\t);\n\n\t\tif (this.isExecuteAfterPrevious())\n\t\t{\n\t\t\tdelayLabel = (delayLabel !== Loc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE')) ? delayLabel + ', ' : '';\n\t\t\tdelayLabel += Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS');\n\t\t}\n\n\t\tif (this.getCondition().items.length > 0)\n\t\t{\n\t\t\tdelayLabel += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_BY_CONDITION');\n\t\t}\n\n\t\tconst delayNode = Dom.create(\n\t\t\tthis.#viewMode.isEdit() ? \"a\" : \"span\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: this.#viewMode.isEdit() ? 'bizproc-automation-robot-link' : 'bizproc-automation-robot-text',\n\t\t\t\t\ttitle: delayLabel\n\t\t\t\t},\n\t\t\t\ttext: delayLabel,\n\t\t\t}\n\t\t);\n\n\t\tconst statusNode = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-information\"\n\t\t\t}\n\t\t});\n\t\tthis.subscribeOnce('Robot:destroyed', () => {\n\t\t\tif (HelpHint.isBindedToNode(statusNode))\n\t\t\t{\n\t\t\t\tHelpHint.hideHint();\n\t\t\t}\n\t\t})\n\n\t\tswitch (this.getLogStatus())\n\t\t{\n\t\t\tcase TrackingStatus.RUNNING:\n\t\t\t\tif (this.#document.getCurrentStatusId() === this.#template.getStatusId())\n\t\t\t\t{\n\t\t\t\t\tstatusNode.classList.add('--loader');\n\n\t\t\t\t\tconst delayNotes = this.getDelayNotes();\n\t\t\t\t\tif (delayNotes.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tstatusNode.setAttribute('data-text', delayNotes.join('\\n'));\n\t\t\t\t\t\tHelpHint.bindToNode(statusNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase TrackingStatus.COMPLETED:\n\t\t\tcase TrackingStatus.AUTOCOMPLETED:\n\t\t\t\tcontainerClass += ' --complete';\n\t\t\t\tstatusNode.classList.add('--complete');\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst errors = this.getLogErrors();\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tstatusNode.classList.add('--errors');\n\t\t\tstatusNode.setAttribute('data-text', errors.join('\\n'));\n\t\t\tHelpHint.bindToNode(statusNode);\n\t\t}\n\n\t\tlet titleClassName = 'bizproc-automation-robot-title-text';\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\ttitleClassName += ' bizproc-automation-robot-title-text-editable';\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: containerClass,\n\t\t\t\t'data-role': 'robot-container',\n\t\t\t\t'data-type': 'item-robot',\n\t\t\t\t'data-id': this.getId()\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-robot-container-checkbox\"\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" },\n\t\t\t\t\t\t\tchildren: [delayNode]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"bizproc-automation-robot-title\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: titleClassName\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\thtml: this.clipTitle(this.getTitle()),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: event => {\n\t\t\t\t\t\t\t\t\t\t\tif (this.#viewMode.isEdit() && this.canEdit() && !this.#viewMode.isManage())\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tthis.onTitleEditClick(event);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings-title\" },\n\t\t\t\t\t\t\t\t\ttext: targetLabel + ':'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\ttargetNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tstatusNode,\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\t\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\n\t\t\tconst copyBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-copy'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY') || 'copy'\n\t\t\t});\n\t\t\tEvent.bind(copyBtn, 'click', this.onCopyButtonClick.bind(this, copyBtn));\n\t\t\tdiv.appendChild(copyBtn);\n\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\n\t\t\tdiv.appendChild(settingsBtn);\n\t\t}\n\n\t\treturn div;\n\t}\n\n\tonDeleteButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(this.#node);\n\t\t\tthis.#template.deleteRobot(this);\n\t\t}\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.#template.openRobotSettingsDialog(this);\n\t\t}\n\t}\n\n\tonCopyButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst copiedRobot = this.clone();\n\t\t\tconst robotTitle = copiedRobot.getProperty('Title');\n\t\t\tif (!Type.isNil(robotTitle))\n\t\t\t{\n\t\t\t\tconst newTitle = robotTitle + ' ' + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY_CAPTION');\n\t\t\t\tcopiedRobot.setProperty('Title', newTitle);\n\t\t\t\tcopiedRobot.reInit();\n\t\t\t}\n\n\t\t\tTemplate.copyRobotTo(this.#template, copiedRobot, this.#template.getNextRobot(this));\n\t\t}\n\t}\n\n\tonTitleEditClick(e)\n\t{\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tconst formName = 'bizproc_automation_robot_title_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME') + ':'\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [BX.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\tvalue: this.getTitle()\n\t\t\t\t}\n\t\t\t})]\n\t\t}));\n\n\t\tthis.emit('Robot:title:editStart');\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME'),\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose(popup)\n\t\t\t\t{\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tself.emit('Robot:title:editCompleted');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nameNode = form.elements.name;\n\t\t\t\t\t\t\tself.setProperty('Title', nameNode.value);\n\t\t\t\t\t\t\tself.reInit();\n\t\t\t\t\t\t\tself.#template.markModified();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getTitle().toLowerCase().indexOf(query) >= 0;\n\n\t\tif (match)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--search-mismatch');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#node, '--search-mismatch');\n\t\t}\n\t}\n\n\tclipTitle(fullTitle: string)\n\t{\n\t\tlet title = Text.encode(fullTitle);\n\t\tconst arrTitle = title.split(\" \");\n\t\tconst lastWord = \"<span>\" + arrTitle[arrTitle.length - 1] + \"</span>\";\n\n\t\tarrTitle.splice(arrTitle.length - 1);\n\n\t\ttitle = arrTitle.join(\" \") + \" \" + lastWord;\n\n\t\treturn title;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tserialize()\n\t{\n\t\tconst result = BX.clone(this.#data);\n\t\tdelete result['viewData'];\n\t\tresult.Delay = this.#delay.serialize();\n\t\tresult.Condition = this.#condition.serialize();\n\n\t\treturn result;\n\t}\n\n\tgetDelayInterval(): DelayInterval\n\t{\n\t\treturn this.#delay;\n\t}\n\n\tsetDelayInterval(delay): Robot\n\t{\n\t\tthis.#delay = delay;\n\n\t\treturn this;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition)\n\t{\n\t\tthis.#condition = condition;\n\n\t\treturn this;\n\t}\n\n\tsetExecuteAfterPrevious(flag)\n\t{\n\t\tthis.#data.ExecuteAfterPrevious = flag ? 1 : 0;\n\n\t\treturn this;\n\t}\n\n\tisExecuteAfterPrevious()\n\t{\n\t\treturn (this.#data.ExecuteAfterPrevious === 1 || this.#data.ExecuteAfterPrevious === '1')\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.draggableItem = BX.proxy_context;\n\n\t\tif (!this.draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.stub)\n\t\t{\n\t\t\tconst itemWidth = this.draggableItem.offsetWidth;\n\t\t\tthis.stub = this.draggableItem.cloneNode(true);\n\t\t\tthis.stub.style.position = \"absolute\";\n\t\t\tthis.stub.classList.add(\"bizproc-automation-robot-container-drag\");\n\t\t\tthis.stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.stub);\n\t\t}\n\t}\n\n\tdragMove(x,y)\n\t{\n\t\tthis.stub.style.left = x + \"px\";\n\t\tthis.stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-robot\")\n\t\t{\n\t\t\tthis.droppableItem = destination;\n\t\t\tthis.droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-robot\")\n\t\t{\n\t\t\tthis.droppableColumn = destination.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.droppableItem = null;\n\t\t}\n\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.add(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.add(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\n\t\tif (this.draggableItem)\n\t\t{\n\t\t\tif (this.droppableItem)\n\t\t\t{\n\t\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableItem.parentNode,\n\t\t\t\t\tisCopy,\n\t\t\t\t\tdroppableItem: this.droppableItem,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.droppableColumn)\n\t\t\t{\n\t\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableColumn,\n\t\t\t\t\tisCopy,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.stub.parentNode.removeChild(this.stub);\n\t\tthis.stub = null;\n\t\tthis.draggableItem = null;\n\t\tthis.droppableItem = null;\n\t}\n\n\tmoveTo(template, beforeRobot)\n\t{\n\t\tDom.remove(this.#node);\n\t\tthis.#template.deleteRobot(this);\n\t\tthis.#template = template;\n\n\t\tthis.#template.insertRobot(this, beforeRobot);\n\t\tthis.#node = this.createNode();\n\t\tthis.#template.insertRobotNode(this.#node, beforeRobot ? beforeRobot.node : null);\n\t}\n\n\tcopyTo(template, beforeRobot)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = this.serialize();\n\t\tdelete robotData['Name'];\n\t\tdelete robotData['DelayName'];\n\n\t\trobot.init(robotData, this.#viewMode);\n\n\t\ttemplate.insertRobot(robot, beforeRobot);\n\t\ttemplate.insertRobotNode(robot.node, beforeRobot ? beforeRobot.node : null);\n\n\t\treturn robot;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getProperty('Title') || this.getDescriptionTitle();\n\t}\n\n\tgetDescriptionTitle()\n\t{\n\t\tlet name = 'untitled';\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\t\tif (description['NAME'])\n\t\t{\n\t\t\tname = description['NAME'];\n\t\t}\n\t\tif (description['ROBOT_SETTINGS'] && description['ROBOT_SETTINGS']['TITLE'])\n\t\t{\n\t\t\tname = description['ROBOT_SETTINGS']['TITLE'];\n\t\t}\n\n\t\treturn name;\n\t}\n\n\thasTitle(): boolean\n\t{\n\t\treturn this.getTitle() !== 'untitled';\n\t}\n\n\thasReturnFields(): boolean\n\t{\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\t\tconst props = this.#data['Properties'];\n\n\t\tif (!Type.isObject(description))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst hasReturnProperties = () => (\n\t\t\tType.isObject(description['RETURN'])\n\t\t\t&& Type.isArrayFilled(Object.values(description['RETURN']))\n\t\t);\n\n\t\tconst hasAdditionalResultProperties = () => (\n\t\t\tType.isArray(description['ADDITIONAL_RESULT'])\n\t\t\t&& description['ADDITIONAL_RESULT'].some(addProperty => Object.values(props[addProperty].length > 0))\n\t\t);\n\n\t\treturn hasReturnProperties() || hasAdditionalResultProperties();\n\t}\n\n\tgetReturnFieldsDescription()\n\t{\n\t\tconst fields = [];\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\n\t\tif (description && description['RETURN'])\n\t\t{\n\t\t\tfor (const fieldId in description['RETURN'])\n\t\t\t{\n\t\t\t\tif (description['RETURN'].hasOwnProperty(fieldId))\n\t\t\t\t{\n\t\t\t\t\tconst field = description['RETURN'][fieldId];\n\t\t\t\t\tfields.push({\n\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\tObjectName: this.getTitle(),\n\t\t\t\t\t\tName: field['NAME'],\n\t\t\t\t\t\tType: field['TYPE'],\n\t\t\t\t\t\tExpression: '{{~'+this.getId()+':'+fieldId+' # '+this.getTitle()+': '+field['NAME']+'}}',\n\t\t\t\t\t\tSystemExpression: '{='+this.getId()+':'+fieldId+'}'\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!this.appendPropertyMods)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t//generate printable version\n\t\t\t\t\tif (\n\t\t\t\t\t\tfield['TYPE'] === 'user'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'bool'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'file'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst printableTag = (field['TYPE'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\tName: field['NAME'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['NAME']}}}`,\n\t\t\t\t\t\t\tSystemExpression: `{=${this.getId()}:${fieldId}>${printableTag}}`,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (description && Type.isArray(description['ADDITIONAL_RESULT']))\n\t\t{\n\t\t\tconst props = this.#data['Properties'];\n\n\t\t\tdescription['ADDITIONAL_RESULT'].forEach((addProperty) => {\n\t\t\t\tif (props[addProperty])\n\t\t\t\t{\n\t\t\t\t\tfor (const fieldId in props[addProperty])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (props[addProperty].hasOwnProperty(fieldId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst field = props[addProperty][fieldId];\n\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\tName: field['Name'],\n\t\t\t\t\t\t\t\tType: field['Type'],\n\t\t\t\t\t\t\t\tOptions: field['Options'] || null,\n\t\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} # ${this.getTitle()}: ${field['Name']}}}`,\n\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '}',\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t//generate printable version\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tfield['Type'] === 'user'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'bool'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'file'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst printableTag = (field['Type'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\t\t\tconst expression = `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['Name']}}}`;\n\t\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\t\tName: field['Name'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\t\t\tExpression: expression,\n\t\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '>' + printableTag + '}',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tgetReturnProperty(id): Array<Object>\n\t{\n\t\tconst fields = this.getReturnFieldsDescription();\n\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t{\n\t\t\tif (fields[i]['Id'] === id)\n\t\t\t{\n\t\t\t\treturn fields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst properties = this.getProperties();\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tObject.values(properties).forEach(property => this.collectExpressions(property, usages));\n\n\t\tconst conditions = this.getCondition().serialize();\n\t\tconditions.items.forEach(item => this.collectParsedExpressions(item[0], usages));\n\n\t\treturn usages;\n\t}\n\n\tcollectExpressions(value, usages)\n\t{\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue.forEach(v => this.collectExpressions(v, usages));\n\t\t}\n\t\telse if (Type.isPlainObject(value))\n\t\t{\n\t\t\tObject.values(value).forEach(value => this.collectExpressions(value, usages));\n\t\t}\n\t\telse if (Type.isStringFilled(value))\n\t\t{\n\t\t\tlet found;\n\t\t\tconst systemExpressionRegExp = new RegExp(this.SYSTEM_EXPRESSION_PATTERN, 'ig');\n\t\t\twhile ((found = systemExpressionRegExp.exec(value)) !== null)\n\t\t\t{\n\t\t\t\tthis.collectParsedExpressions(found.groups, usages);\n\t\t\t}\n\t\t}\n\t}\n\n\tcollectParsedExpressions(parsedUsage, usages)\n\t{\n\t\tif (Type.isPlainObject(parsedUsage) && parsedUsage['object'] && parsedUsage['field'])\n\t\t{\n\t\t\tswitch (parsedUsage['object'])\n\t\t\t{\n\t\t\t\tcase 'Document':\n\t\t\t\t\tusages.Document.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Constant':\n\t\t\t\t\tusages.Constant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Variable':\n\t\t\t\t\tusages.Variable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Template':\n\t\t\t\t\tusages.Parameter.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalConst':\n\t\t\t\t\tusages.GlobalConstant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalVar':\n\t\t\t\t\tusages.GlobalVariable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst activityRegExp = new RegExp(/^A[_0-9]+$/, 'ig');\n\t\t\tif (activityRegExp.exec(parsedUsage['object']))\n\t\t\t{\n\t\t\t\tusages.Activity.add([parsedUsage['object'], parsedUsage['field']]);\n\t\t\t}\n\t\t}\n\t}\n\n\thasBrokenLink()\n\t{\n\t\tconst usages = BX.clone(this.collectUsages());\n\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst objectsData = {\n\t\t\tDocument: this.#document.getFields(),\n\t\t\tConstant: this.#template.getConstants(),\n\t\t\tVariable: this.#template.getVariables(),\n\t\t\tGlobalConstant: this.#template.globalConstants,\n\t\t\tGlobalVariable: this.#template.globalVariables,\n\t\t\tParameter: this.#template.getParameters(),\n\t\t\tActivity: this.#template.getSerializedRobots()\n\t\t};\n\n\t\tfor (const object in usages)\n\t\t{\n\t\t\tif (usages[object].size > 0)\n\t\t\t{\n\t\t\t\tconst source = new Set();\n\n\t\t\t\tfor (const key in objectsData[object])\n\t\t\t\t{\n\t\t\t\t\tif (objectsData[object][key]['Id'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Id']);\n\t\t\t\t\t}\n\t\t\t\t\telse if (objectsData[object][key]['Name'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Name']);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (const value of usages[object].values())\n\t\t\t\t{\n\t\t\t\t\tlet searchInSource = value;\n\t\t\t\t\tlet id = value;\n\n\t\t\t\t\tif (Type.isArray(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\tsearchInSource = value[0];\n\t\t\t\t\t\tid = value[1];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!source.has(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (object === 'Activity')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst robot = this.#template.getRobotById(searchInSource);\n\t\t\t\t\t\tif (!robot.getReturnProperty(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n}","import { Type, Runtime } from 'main.core';\n\nexport class UserOptions\n{\n\t#options: Object<string, any>;\n\n\tconstructor(options: Object<string, any>)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new UserOptions(Runtime.clone(this.#options));\n\t}\n\n\tset(category: string, key: string, value: any): UserOptions\n\t{\n\t\tif (!Type.isPlainObject(this.#options[category]))\n\t\t{\n\t\t\tthis.#options[category] = {};\n\t\t}\n\t\tconst storedValue = this.#options[category][key];\n\n\t\tif (storedValue !== value)\n\t\t{\n\t\t\tBX.userOptions.save(\n\t\t\t\t'bizproc.automation',\n\t\t\t\tcategory,\n\t\t\t\tkey,\n\t\t\t\tvalue,\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget(category: string, key: string, defaultValue: any): any\n\t{\n\t\tlet result = defaultValue;\n\t\tif (this.has(category, key))\n\t\t{\n\t\t\tresult = this.#options[category][key];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thas(category: string, key: string): boolean\n\t{\n\t\treturn Type.isPlainObject(this.#options[category]) && Type.isPlainObject(this.#options[category][key]);\n\t}\n}","import {Type, Dom, Loc, Reflection, Event, Runtime, Uri} from 'main.core';\nimport { MenuManager } from 'main.popup';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport {\n\tContext,\n\tSelectorContext,\n\tgetGlobalContext,\n\tTracker,\n\tDesigner,\n\tConditionGroupSelector,\n\tConditionGroup,\n\tDelayIntervalSelector,\n\tSelectorManager,\n} from 'bizproc.automation';\nimport { Robot } from './robot'\nimport { UserOptions } from './user-options';\nimport { ViewMode } from './view-mode';\nimport { Helper } from './helper';\nimport { HelpHint } from './help-hint';\nimport { DelayInterval } from './delay-interval';\n\nexport class Template extends EventEmitter\n{\n\t#context: Context;\n\n\tconstants: Object<string, any>;\n\tglobalConstants: Array<Object>;\n\tvariables: Object<string, any>;\n\tglobalVariables: Array<Object>;\n\trobotSettingsControls;\n\n\t#delayMinLimitM: number;\n\t#userOptions: UserOptions | null;\n\t#tracker: Tracker;\n\t#viewMode: ViewMode;\n\n\t#templateContainerNode: Element;\n\t#templateNode: ?Element;\n\t#listNode: Element | undefined;\n\t#buttonsNode: Element | undefined;\n\t#topButtonsNode: Element | undefined;\n\n\t#robots: Array<Robot>;\n\t#data: Object;\n\n\tconstructor(params: {\n\t\tcontext: ?Context,\n\t\ttemplateContainerNode: Element,\n\t\tconstants: Object<string, any>,\n\t\tglobalConstants: Array<Object>,\n\t\tvariables: Object<string, any>,\n\t\tglobalVariables: Array<Object>,\n\t\tuserOptions: ?UserOptions,\n\t\tdelayMinLimitM: number,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#context = params.context ?? getGlobalContext();\n\t\tthis.constants = params.constants;\n\t\tthis.globalConstants = params.globalConstants;\n\t\tthis.variables = params.variables;\n\t\tthis.globalVariables = params.globalVariables;\n\n\t\tthis.#templateContainerNode = params.templateContainerNode;\n\t\tthis.#delayMinLimitM = params.delayMinLimitM;\n\t\tthis.#userOptions = params.userOptions;\n\t\tthis.#tracker = this.#context.tracker;\n\t\tthis.#data = {};\n\t\tthis.#robots = [];\n\t\tthis.#viewMode = ViewMode.none();\n\t}\n\n\tinit(data: Object, viewMode: number)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t\tif (!Type.isPlainObject(this.#data.CONSTANTS))\n\t\t\t{\n\t\t\t\tthis.#data.CONSTANTS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.PARAMETERS))\n\t\t\t{\n\t\t\t\tthis.#data.PARAMETERS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.VARIABLES))\n\t\t\t{\n\t\t\t\tthis.#data.VARIABLES = {};\n\t\t\t}\n\n\t\t\tthis.markExternalModified(this.#data['IS_EXTERNAL_MODIFIED']);\n\t\t\tthis.markModified(false);\n\t\t}\n\n\t\tthis.#viewMode = ViewMode.fromRaw(viewMode);\n\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#templateNode = this.#templateContainerNode.querySelector(\n\t\t\t\t'[data-role=\"automation-template\"][data-status-id=\"' + this.#data.DOCUMENT_STATUS + '\"]'\n\t\t\t);\n\t\t\tthis.#listNode = this.#templateNode.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.#buttonsNode = this.#templateNode.querySelector('[data-role=\"buttons\"]');\n\t\t\tthis.#topButtonsNode = this.#templateNode.querySelector('[data-role=\"top-buttons\"]');\n\n\t\t\tthis.initRobots();\n\t\t\tthis.initButtons();\n\t\t\tthis.updateTopButtonsVisibility();\n\n\t\t\tif (!this.isExternalModified() && this.canEdit())\n\t\t\t{\n\t\t\t\t//register DD\n\t\t\t\tjsDD.registerDest(this.#templateNode, 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjsDD.unregisterDest(this.#templateNode);\n\t\t\t}\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: number)\n\t{\n\t\tDom.clean(this.#listNode);\n\t\tDom.clean(this.#buttonsNode);\n\t\tDom.clean(this.#topButtonsNode);\n\n\t\tthis.destroy();\n\t\tthis.init(data, viewMode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#robots.forEach(robot => robot.destroy());\n\t}\n\n\tstatic copyRobotTo(dstTemplate: Template, robot: Robot, beforeRobot: ?Robot): Robot\n\t{\n\t\tconst copiedRobot = robot.copyTo(dstTemplate, beforeRobot);\n\t\tdstTemplate.emit('Template:robot:add', {robot: copiedRobot});\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn this.#context.canEdit;\n\t}\n\n\tinitRobots()\n\t{\n\t\tthis.#robots = [];\n\n\t\tif (Type.isArray(this.#data.ROBOTS))\n\t\t{\n\t\t\tfor (let i = 0; i < this.#data.ROBOTS.length; ++i)\n\t\t\t{\n\t\t\t\tconst robot = new Robot({\n\t\t\t\t\tdocument: this.#context.document,\n\t\t\t\t\ttemplate: this,\n\t\t\t\t\tisFrameMode: this.#context.get('isFrameMode'),\n\t\t\t\t\ttracker: this.#tracker,\n\t\t\t\t});\n\t\t\t\trobot.init(this.#data.ROBOTS[i], this.#viewMode);\n\t\t\t\tthis.insertRobotNode(robot.node);\n\t\t\t\tthis.#robots.push(robot);\n\t\t\t}\n\t\t}\n\t}\n\n\tget robots(): Array<Robot>\n\t{\n\t\treturn this.#robots;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.#userOptions;\n\t}\n\n\tgetSelectedRobotNames(): Array<Robot>\n\t{\n\t\tconst selectedRobots = [];\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tif (robot.isSelected())\n\t\t\t{\n\t\t\t\tselectedRobots.push(robot.data.Name);\n\t\t\t}\n\t\t});\n\n\t\treturn selectedRobots;\n\t}\n\n\tgetSerializedRobots()\n\t{\n\t\tconst serialized = [];\n\t\tthis.#robots.forEach(robot => serialized.push(robot.serialize()));\n\n\t\treturn serialized;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.#data.ID;\n\t}\n\n\tgetStatusId(): ?string\n\t{\n\t\treturn this.#data.DOCUMENT_STATUS;\n\t}\n\n\tgetTemplateId()\n\t{\n\t\tconst id = parseInt(this.#data.ID);\n\n\t\treturn !isNaN(id) ? id : 0;\n\t}\n\n\tinitButtons()\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.createExternalLocker();\n\t\t}\n\t\telse if (this.#viewMode.isEdit())\n\t\t{\n\t\t\tthis.createAddButton();\n\n\t\t\tif (this.getTemplateId() > 0)\n\t\t\t{\n\t\t\t\tthis.createConstantsEditButton();\n\t\t\t\tthis.createParametersEditButton();\n\t\t\t\tthis.createExternalEditTemplateButton();\n\t\t\t\tthis.createManageModeButton();\n\t\t\t}\n\t\t}\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\t\tif (isActive)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--multiselect-mode');\n\t\t\t}\n\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.enableManageMode(isActive));\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.edit();\n\t\t\tDom.removeClass(this.#listNode, '--multiselect-mode');\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.disableManageMode());\n\t\t\t}\n\n\t\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t\t});\n\t\t}\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.registerItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.unregisterItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tcreateAddButton()\n\t{\n\t\tconst anchor = () => Dom.create('span', {\n\t\t\tevents: {\n\t\t\t\tclick: event => {\n\t\t\t\t\tif (!this.canEdit())\n\t\t\t\t\t{\n\t\t\t\t\t\tHelpHint.showNoPermissionsHint(event.target);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!this.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onAddButtonClick(event.target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-robot-btn-add'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-btn-add-text',\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ADD'),\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.#topButtonsNode)\n\t\t{\n\t\t\tthis.#topButtonsNode.appendChild(anchor());\n\t\t}\n\n\t\tif (this.#buttonsNode)\n\t\t{\n\t\t\tthis.#buttonsNode.appendChild(anchor());\n\t\t}\n\t}\n\n\tupdateTopButtonsVisibility()\n\t{\n\t\tif (this.#topButtonsNode)\n\t\t{\n\t\t\tlet fn = (this.#robots && this.#robots.length < 1) ? 'hide' : 'show';\n\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tfn = 'show';\n\t\t\t}\n\n\t\t\tBX[fn](this.#topButtonsNode);\n\t\t}\n\t}\n\n\tcreateExternalEditTemplateButton(): undefined | boolean\n\t{\n\t\tif (Type.isNil(this.#context.bizprocEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst self = this;\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: '#'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top'\n\t\t\t}\n\t\t});\n\n\t\tif (!this.#context.bizprocEditorUrl.length)\n\t\t{\n\t\t\tDom.addClass(anchor, 'bizproc-automation-robot-btn-set-locked');\n\t\t}\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateManageModeButton()\n\t{\n\t\tif (!this.#context.canManage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst manageButton = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_MANAGE_ROBOTS'),\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top',\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tcursor: 'pointer',\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: event => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.onManageModeButtonClick(manageButton);\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(manageButton);\n\t}\n\n\tonManageModeButtonClick(manageButtonNode: HTMLElement)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(manageButtonNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('Template:enableManageMode', {\n\t\t\t\tdocumentStatus: this.#data.DOCUMENT_STATUS,\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateConstantsEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(this.#context.constantsEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url =\n\t\t\t!this.#viewMode.isManage()\n\t\t\t\t? this.#context.constantsEditorUrl.replace('#ID#', this.getTemplateId())\n\t\t\t\t: '#'\n\t\t;\n\n\t\tif (!url.length)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CONSTANTS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateParametersEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(this.#context.parametersEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url = this.#context.parametersEditorUrl.replace('#ID#', this.getTemplateId());\n\n\t\tif (!url.length || this.#viewMode.isManage())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_PARAMETERS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateExternalLocker()\n\t{\n\t\tif (this.#topButtonsNode)\n\t\t{\n\t\t\tthis.#topButtonsNode.appendChild(\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: { className: 'bizproc-automation-robot-btn-prohibit' }\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-container\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-robot-container-wrapper bizproc-automation-robot-container-wrapper-lock'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" }\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT_TEXT')\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tEvent.bind(div, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.appendChild(settingsBtn);\n\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEvent.bind(deleteBtn, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onUnsetExternalModifiedClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\t\t}\n\n\t\tthis.#listNode.appendChild(div);\n\t\tthis.#templateNode = div;\n\t}\n\n\tonSearch(event: BaseEvent)\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.onExternalModifiedSearch(event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.forEach(robot => robot.onSearch(event));\n\t\t}\n\t}\n\n\tonExternalModifiedSearch(event)\n\t{\n\t\tif (this.#templateNode)\n\t\t{\n\t\t\tconst query = event.getData().queryString;\n\t\t\tBX[!query ? 'removeClass' : 'addClass'](this.#templateNode, '--search-mismatch');\n\t\t}\n\t}\n\n\tonAddButtonClick(button, context)\n\t{\n\t\tconst menuItems = {\n\t\t\temployee: [],\n\t\t\tclient: [],\n\t\t\tads: [],\n\t\t\tother: []\n\t\t};\n\t\tconst availableRobots = this.#context.availableRobots;\n\n\t\tif (!Type.isPlainObject(context))\n\t\t{\n\t\t\tcontext = {};\n\t\t}\n\n\t\tconst self = this;\n\t\tconst menuItemClickHandler = function (event, item)\n\t\t{\n\t\t\tconst robotData = BX.clone(item.robotData);\n\n\t\t\tif (\n\t\t\t\trobotData['ROBOT_SETTINGS']\n\t\t\t\t&& robotData['ROBOT_SETTINGS']['TITLE_CATEGORY']\n\t\t\t\t&& robotData['ROBOT_SETTINGS']['TITLE_CATEGORY'][item.category]\n\t\t\t)\n\t\t\t{\n\t\t\t\trobotData['NAME'] = robotData['ROBOT_SETTINGS']['TITLE_CATEGORY'][item.category];\n\t\t\t}\n\t\t\telse if (robotData['ROBOT_SETTINGS'] && robotData['ROBOT_SETTINGS']['TITLE'])\n\t\t\t{\n\t\t\t\trobotData['NAME'] = robotData['ROBOT_SETTINGS']['TITLE'];\n\t\t\t}\n\n\t\t\tself.addRobot(robotData, function(robot)\n\t\t\t{\n\t\t\t\tcontext.ADD_MENU_CATEGORY = item.category;\n\t\t\t\tthis.openRobotSettingsDialog(robot, context);\n\t\t\t});\n\n\t\t\tthis.getRootMenuWindow().close();\n\t\t};\n\n\t\tfor (let i = 0; i < availableRobots.length; ++i)\n\t\t{\n\t\t\tif (availableRobots[i]['EXCLUDED'])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst settings =\n\t\t\t\tType.isPlainObject(availableRobots[i]['ROBOT_SETTINGS'])\n\t\t\t\t\t? availableRobots[i]['ROBOT_SETTINGS']\n\t\t\t\t\t: {}\n\t\t\t;\n\n\t\t\tlet title = availableRobots[i].NAME;\n\t\t\tif (settings['TITLE'])\n\t\t\t{\n\t\t\t\ttitle = settings['TITLE'];\n\t\t\t}\n\n\t\t\tlet categories = [];\n\t\t\tif (settings['CATEGORY'])\n\t\t\t{\n\t\t\t\tcategories = Type.isArray(settings['CATEGORY']) ? settings['CATEGORY'] : [settings['CATEGORY']];\n\t\t\t}\n\n\t\t\tif (!categories.length)\n\t\t\t{\n\t\t\t\tcategories.push('other');\n\t\t\t}\n\n\t\t\tfor (let j = 0; j < categories.length; ++j)\n\t\t\t{\n\t\t\t\tif (!menuItems[categories[j]])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tmenuItems[categories[j]].push({\n\t\t\t\t\ttext: title,\n\t\t\t\t\trobotData: availableRobots[i],\n\t\t\t\t\tcategory: categories[j],\n\t\t\t\t\tonclick: menuItemClickHandler,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (menuItems['other'].length > 0)\n\t\t{\n\t\t\tmenuItems['other'].push({delimiter: true});\n\t\t}\n\n\t\tif (Reflection.getClass('BX.rest.Marketplace'))\n\t\t{\n\t\t\tmenuItems['other'].push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER_MARKETPLACE_2'),\n\t\t\t\tonclick()\n\t\t\t\t{\n\t\t\t\t\tBX.rest.Marketplace.open({}, this.#context.get('marketplaceRobotCategory'));\n\t\t\t\t\tthis.getRootMenuWindow().close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenuItems['other'].push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER_MARKETPLACE_2'),\n\t\t\t\thref:\n\t\t\t\t\t'/marketplace/category/%category%/'\n\t\t\t\t\t\t.replace('%category%', this.#context.get('marketplaceRobotCategory')),\n\t\t\t\ttarget: '_blank'\n\t\t\t});\n\t\t}\n\n\t\tlet menuId = button.getAttribute('data-menu-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tbutton.setAttribute('data-menu-id', menuId);\n\t\t}\n\n\t\tconst rootMenuItems = [];\n\t\tif (menuItems['employee'].length > 0)\n\t\t{\n\t\t\trootMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_EMPLOYEE'),\n\t\t\t\titems: menuItems['employee']\n\t\t\t});\n\t\t}\n\t\tif (menuItems['client'].length > 0)\n\t\t{\n\t\t\trootMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_CLIENT'),\n\t\t\t\titems: menuItems['client']\n\t\t\t});\n\t\t}\n\t\tif (menuItems['ads'].length > 0)\n\t\t{\n\t\t\trootMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_ADS'),\n\t\t\t\titems: menuItems['ads']\n\t\t\t});\n\t\t}\n\t\trootMenuItems.push({\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER'),\n\t\t\titems: menuItems['other']\n\t\t});\n\n\t\tMenuManager.show(\n\t\t\tmenuId,\n\t\t\tbutton,\n\t\t\trootMenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (BX.pos(button)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\tmaxHeight: 550\n\t\t\t}\n\t\t);\n\t}\n\n\tonChangeRobotClick(event)\n\t{\n\t\tthis.onAddButtonClick(event.target, {changeRobot: true});\n\t}\n\n\tonExternalEditTemplateButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.#context.bizprocEditorUrl.length)\n\t\t{\n\t\t\tif (top.BX.UI && top.BX.UI.InfoHelper)\n\t\t\t{\n\t\t\t\ttop.BX.UI.InfoHelper.show('limit_office_bp_designer');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst templateId = this.getTemplateId();\n\t\tif (templateId > 0)\n\t\t{\n\t\t\tthis.openBizprocEditor(templateId);\n\t\t}\n\t}\n\n\tonUnsetExternalModifiedClick(button)\n\t{\n\t\tthis.#templateNode = null;\n\n\t\tthis.markExternalModified(false);\n\t\tthis.markModified();\n\t\tthis.reInit(null, this.#viewMode.intoRaw());\n\t}\n\n\topenBizprocEditor(templateId)\n\t{\n\t\ttop.window.location.href = this.#context.bizprocEditorUrl.replace('#ID#', templateId)\n\t}\n\n\taddRobot(robotData, callback)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: this.#context.document,\n\t\t\ttemplate: this,\n\t\t\tisFrameMode: this.#context.get('isFrameMode'),\n\t\t\ttracker: this.#tracker,\n\t\t});\n\t\tconst initData = {\n\t\t\tType: robotData['CLASS'],\n\t\t\tProperties: {\n\t\t\t\tTitle: robotData['NAME']\n\t\t\t}\n\t\t};\n\n\t\tif (this.#robots.length > 0)\n\t\t{\n\t\t\tconst parentRobot = this.#robots[this.#robots.length - 1];\n\t\t\tif (!parentRobot.getDelayInterval().isNow() || parentRobot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\tinitData['Delay'] = parentRobot.getDelayInterval().serialize();\n\t\t\t\tinitData['ExecuteAfterPrevious'] =  1;\n\t\t\t}\n\t\t}\n\n\t\trobot.init(initData, this.#viewMode);\n\t\trobot.draft = true;\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, robot);\n\t\t}\n\t}\n\n\tinsertRobot(robot, beforeRobot)\n\t{\n\t\tif (beforeRobot)\n\t\t{\n\t\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#robots[i] !== beforeRobot)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis.#robots.splice(i, 0, robot);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.push(robot);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tgetNextRobot(robot)\n\t{\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i] === robot)\n\t\t\t{\n\t\t\t\treturn (this.#robots[i + 1] || null);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tdeleteRobot(robot, callback)\n\t{\n\t\tfor(let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i].isEqual(robot))\n\t\t\t{\n\t\t\t\tthis.#robots.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback(robot);\n\t\t}\n\n\t\tthis.markModified();\n\t\tthis.updateTopButtonsVisibility();\n\t}\n\n\tinsertRobotNode(robotNode, beforeNode)\n\t{\n\t\tif (beforeNode)\n\t\t{\n\t\t\tthis.#listNode.insertBefore(robotNode, beforeNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#listNode.appendChild(robotNode);\n\t\t}\n\n\t\tthis.updateTopButtonsVisibility();\n\t}\n\n\topenRobotSettingsDialog(robot: Robot, context?: Object, saveCallback: (Robot) => void)\n\t{\n\t\tif (!Type.isPlainObject(context))\n\t\t{\n\t\t\tcontext = {};\n\t\t}\n\n\t\tif (Designer.getInstance().getRobotSettingsDialog())\n\t\t{\n\t\t\tif (context.changeRobot)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getRobotSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_robot_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t}\n\t\t});\n\n\t\tDesigner.getInstance().setRobotSettingsDialog({\n\t\t\ttemplate: this,\n\t\t\tcontext: context,\n\t\t\trobot: robot,\n\t\t\tform: form\n\t\t});\n\n\t\tform.appendChild(this.renderDelaySettings(robot));\n\t\tform.appendChild(this.renderConditionSettings(robot));\n\t\tif (robot.hasBrokenLink())\n\t\t{\n\t\t\tform.appendChild(this.renderBrokenLinkAlert());\n\t\t}\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {\n\t\t\t\tclick: (event) => this.emit('Template:help:show', event)\n\t\t\t},\n\t\t});\n\t\tform.appendChild(iconHelp);\n\t\tcontext['DOCUMENT_CATEGORY_ID'] = this.#context.document.getCategoryId();\n\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'html',\n\t\t\turl: Uri.addParam(\n\t\t\t\tthis.#context.ajaxUrl,\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: `automation_robot${robot.draft ? '_draft' : ''}_settings_${robot.data.Type.toLowerCase()}`\n\t\t\t\t}\n\t\t\t),\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_robot_dialog',\n\t\t\t\tdocument_signed: this.#context.signedDocument,\n\t\t\t\tdocument_status: this.#context.document.getCurrentStatusId(),\n\t\t\t\tcontext: context,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_name: formName\n\t\t\t},\n\t\t\tonsuccess: html => {\n\t\t\t\tif (html)\n\t\t\t\t{\n\t\t\t\t\tconst dialogRows = Dom.create('div', {\n\t\t\t\t\t\thtml: html\n\t\t\t\t\t});\n\t\t\t\t\tform.appendChild(dialogRows);\n\t\t\t\t}\n\n\t\t\t\tthis.showRobotSettingsPopup(robot, form, saveCallback);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowRobotSettingsPopup(robot: Robot, form: HTMLFormElement, saveCallback: (Robot) => void)\n\t{\n\t\tlet popupMinWidth = 580;\n\t\tlet popupWidth = popupMinWidth;\n\n\t\tif (this.#userOptions)\n\t\t{\n\t\t\t// TODO move from if?\n\t\t\tthis.emit('Template:robot:showSettings');\n\t\t\tpopupWidth = parseInt(\n\t\t\t\tthis.#userOptions.get('defaults', 'robot_settings_popup_width', 580)\n\t\t\t);\n\t\t}\n\n\t\tthis.initRobotSettingsControls(robot, form);\n\n\t\tif (\n\t\t\trobot.data.Type === 'CrmSendEmailActivity'\n\t\t\t|| robot.data.Type === 'MailActivity'\n\t\t\t|| robot.data.Type === 'RpaApproveActivity'\n\t\t)\n\t\t{\n\t\t\tpopupMinWidth += 170;\n\t\t\tif (popupWidth < popupMinWidth)\n\t\t\t{\n\t\t\t\tpopupWidth = popupMinWidth;\n\t\t\t}\n\t\t}\n\n\t\tlet titleBar;\n\t\tconst robotTitle =\n\t\t\trobot.hasTitle()\n\t\t\t\t? robot.getTitle()\n\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_SETTINGS_TITLE')\n\t\t;\n\n\t\tif (robot.draft)\n\t\t{\n\t\t\ttitleBar = this.createChangeRobotTitleBar(robotTitle);\n\t\t}\n\n\t\tconst me = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: titleBar || robotTitle,\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\twidth: popupWidth,\n\t\t\tresizable: {\n\t\t\t\tminWidth: popupMinWidth,\n\t\t\t\tminHeight: 100\n\t\t\t},\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\tevents: {\n\t\t\t\tonPopupClose: (popup) => {\n\t\t\t\t\tDesigner.getInstance().setRobotSettingsDialog(null);\n\t\t\t\t\tthis.destroyRobotSettingsControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tthis.emit('Template:robot:closeSettings');\n\t\t\t\t},\n\t\t\t\tonPopupResize: () => {\n\t\t\t\t\tthis.onResizeRobotSettings();\n\t\t\t\t},\n\t\t\t\tonPopupResizeEnd: function() {\n\t\t\t\t\tif (me.#userOptions)\n\t\t\t\t\t{\n\t\t\t\t\t\tme.#userOptions.set(\n\t\t\t\t\t\t\t'defaults',\n\t\t\t\t\t\t\t'robot_settings_popup_width',\n\t\t\t\t\t\t\tthis.getWidth()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst isNewRobot = robot.draft;\n\n\t\t\t\t\t\t\tme.saveRobotSettings(form, robot, BX.delegate(function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t\t\tif (isNewRobot)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tme.emit('Template:robot:add', { robot });\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (saveCallback)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsaveCallback(robot);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, this), this.buttonNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick: function(){\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tDesigner.getInstance().getRobotSettingsDialog().popup = popup;\n\t\tpopup.show();\n\t}\n\n\tcreateChangeRobotTitleBar(title)\n\t{\n\t\treturn {\n\t\t\tcontent: BX.Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'popup-window-titlebar-text bizproc-automation-popup-titlebar-with-link'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tdocument.createTextNode(title),\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-titlebar-link'\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHANGE_ROBOT'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: this.onChangeRobotClick.bind(this)\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t]\n\t\t\t})\n\t\t};\n\t}\n\n\tinitRobotSettingsControls(robot, node)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tthis.initRobotSettingsControl(robot, controlNodes[i]);\n\t\t}\n\t}\n\n\tinitRobotSettingsControl(robot, controlNode)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tconst role = controlNode.getAttribute('data-role');\n\n\t\tconst controlProps = {\n\t\t\tcontext: new SelectorContext({\n\t\t\t\tfields: Runtime.clone(this.#context.document.getFields()),\n\t\t\t\tuseSwitcherMenu: this.#context.get('showTemplatePropertiesMenuOnSelecting'),\n\t\t\t\trootGroupTitle: this.#context.document.title,\n\t\t\t\tuserOptions: this.#context.userOptions,\n\t\t\t}),\n\t\t\tneedSync: robot.draft,\n\t\t\tcheckbox: controlNode,\n\t\t};\n\n\t\tif (role === SelectorManager.SELECTOR_ROLE_USER)\n\t\t{\n\t\t\tconst fieldProperty = JSON.parse(controlNode.getAttribute('data-property'));\n\t\t\tcontrolProps.context.set('additionalUserFields', this.#getUserSelectorAdditionalFields(fieldProperty));\n\t\t}\n\t\telse if (role === SelectorManager.SELECTOR_ROLE_FILE)\n\t\t{\n\t\t\tthis.robots.forEach((robot) => {\n\t\t\t\tcontrolProps.context.fields.push(\n\t\t\t\t\t...robot\n\t\t\t\t\t\t.getReturnFieldsDescription()\n\t\t\t\t\t\t.filter(field => field['Type'] === 'file')\n\t\t\t\t\t\t.map((field) => ({\n\t\t\t\t\t\t\tId: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t\tName: `${robot.getTitle()}: ${field['Name']}`,\n\t\t\t\t\t\t\tType: 'file',\n\t\t\t\t\t\t\tExpression: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t}))\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst control = SelectorManager.createSelectorByRole(role, controlProps);\n\n\t\tif (control && role !== SelectorManager.SELECTOR_ROLE_SAVE_STATE)\n\t\t{\n\t\t\tcontrol.renderTo(controlNode);\n\n\t\t\tcontrol.subscribe('onAskConstant', (event) => {\n\t\t\t\tconst {fieldProperty} = event.getData();\n\t\t\t\tcontrol.onFieldSelect(this.addConstant(fieldProperty));\n\t\t\t});\n\t\t\tcontrol.subscribe('onAskParameter', (event) => {\n\t\t\t\tconst {fieldProperty} = event.getData();\n\t\t\t\tcontrol.onFieldSelect(this.addParameter(fieldProperty));\n\t\t\t});\n\t\t\tcontrol.subscribe('onOpenMenu', (event) => {\n\t\t\t\tthis.#addRobotReturnFieldsToSelector(event, robot);\n\n\t\t\t\tthis.emit(\n\t\t\t\t\t'Template:onSelectorMenuOpen',\n\t\t\t\t\t{\n\t\t\t\t\t\ttemplate: this,\n\t\t\t\t\t\trobot,\n\t\t\t\t\t\t...event.getData()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tBX.UI.Hint.init(controlNode);\n\n\t\tif (control)\n\t\t{\n\t\t\tthis.robotSettingsControls.push(control);\n\t\t}\n\t}\n\n\t#getUserSelectorAdditionalFields(fieldProperty): Array<object>\n\t{\n\t\tconst additionalFields = (\n\t\t\tthis\n\t\t\t\t.#getRobotsWithReturnFields()\n\t\t\t\t.map((robot) => (\n\t\t\t\t\trobot\n\t\t\t\t\t\t.getReturnFieldsDescription()\n\t\t\t\t\t\t.filter(field => field['Type'] === 'user')\n\t\t\t\t\t\t.map((field) => ({\n\t\t\t\t\t\t\tid: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t\ttitle: `${robot.getTitle()}: ${field['Name']}`,\n\t\t\t\t\t\t}))\n\t\t\t\t))\n\t\t\t\t.flat()\n\t\t);\n\n\t\tif (this.#context.get('showTemplatePropertiesMenuOnSelecting') && fieldProperty)\n\t\t{\n\t\t\tconst ask = this.addConstant(Runtime.clone(fieldProperty));\n\n\t\t\tadditionalFields.push({\n\t\t\t\tid: ask.Expression,\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'),\n\t\t\t\ttabs: ['recents', 'bpuserroles'],\n\t\t\t\tsort: 1,\n\t\t\t});\n\n\t\t\tconst param = this.addParameter(Runtime.clone(fieldProperty));\n\n\t\t\tadditionalFields.push({\n\t\t\t\tid: param.Expression,\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'),\n\t\t\t\ttabs: ['recents', 'bpuserroles'],\n\t\t\t\tsort: 2,\n\t\t\t});\n\t\t}\n\n\t\treturn additionalFields;\n\t}\n\n\t#addRobotReturnFieldsToSelector(event: BaseEvent, skipRobot: ?Robot)\n\t{\n\t\tconst selector = event.getData().selector;\n\t\tconst isMixedCondition = event.getData().isMixedCondition;\n\n\t\tif (Type.isBoolean(isMixedCondition) && !isMixedCondition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst robotMenuItems = (\n\t\t\tthis\n\t\t\t\t.#getRobotsWithReturnFields(skipRobot)\n\t\t\t\t.map((robot) => ({\n\t\t\t\t\tid: robot.getId(),\n\t\t\t\t\ttitle: robot.getTitle(),\n\t\t\t\t\tchildren: robot.getReturnFieldsDescription().map((field) => ({\n\t\t\t\t\t\tid: field.Expression,\n\t\t\t\t\t\ttitle: field.Name,\n\t\t\t\t\t\tcustomData: { field },\n\t\t\t\t\t}))\n\t\t\t\t}))\n\t\t);\n\n\t\tif (robotMenuItems.length > 0)\n\t\t{\n\t\t\tselector.addGroup('__RESULT', {\n\t\t\t\tid: '__RESULT',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_LIST'),\n\t\t\t\tchildren: robotMenuItems\n\t\t\t});\n\t\t}\n\t}\n\n\t#getRobotsWithReturnFields(skipRobot: ?Robot = undefined): Array<Robot>\n\t{\n\t\tconst skipId = skipRobot?.getId() || '';\n\n\t\treturn this\n\t\t\t.robots\n\t\t\t.filter((templateRobot) => (\n\t\t\t\ttemplateRobot.getId() !== skipId && templateRobot.hasReturnFields()\n\t\t\t))\n\t\t;\n\t}\n\n\tdestroyRobotSettingsControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.robotSettingsControls = null;\n\t}\n\n\tonBeforeSaveRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onBeforeSave))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onBeforeSave();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonResizeRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onPopupResize))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onPopupResize();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trenderDelaySettings(robot)\n\t{\n\t\tconst delay = robot.getDelayInterval().clone();\n\t\tconst idSalt = Helper.generateUniqueId();\n\n\t\tconst delayTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_type\",\n\t\t\t\tvalue: delay.type\n\t\t\t}\n\t\t});\n\t\tconst delayValueNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value\",\n\t\t\t\tvalue: delay.value\n\t\t\t}\n\t\t});\n\t\tconst delayValueTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value_type\",\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\t\tconst delayBasisNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_basis\",\n\t\t\t\tvalue: delay.basis\n\t\t\t}\n\t\t});\n\t\tconst delayWorkTimeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_worktime\",\n\t\t\t\tvalue: delay.workTime ? 1 : 0\n\t\t\t}\n\t\t});\n\n\t\tconst delayIntervalLabelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t}\n\t\t});\n\n\t\tconst basisFields = [];\n\n\t\tconst docFields = this.#context.document.getFields();\n\t\tconst minLimitM = this.#delayMinLimitM;\n\n\t\tif (Type.isArray(docFields))\n\t\t{\n\t\t\tfor (let i = 0; i < docFields.length; ++i)\n\t\t\t{\n\t\t\t\tconst field = docFields[i];\n\t\t\t\tif (field['Type'] == 'date' || field['Type'] == 'datetime')\n\t\t\t\t{\n\t\t\t\t\tbasisFields.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst delayIntervalSelector = new DelayIntervalSelector({\n\t\t\tlabelNode: delayIntervalLabelNode,\n\t\t\tonchange(delay) {\n\t\t\t\tdelayTypeNode.value = delay.type;\n\t\t\t\tdelayValueNode.value = delay.value;\n\t\t\t\tdelayValueTypeNode.value = delay.valueType;\n\t\t\t\tdelayBasisNode.value = delay.basis;\n\t\t\t\tdelayWorkTimeNode.value = delay.workTime ? 1 : 0;\n\t\t\t},\n\t\t\tbasisFields: basisFields,\n\t\t\tminLimitM: minLimitM,\n\t\t\tuseAfterBasis: true\n\t\t});\n\n\t\tlet executeAfterPreviousBlock = null;\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\tconst executeAfterPreviousCheckbox = Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tid: \"param-group-3-1\" + idSalt,\n\t\t\t\t\tname: \"execute_after_previous\",\n\t\t\t\t\tvalue: '1',\n\t\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (robot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\texecuteAfterPreviousCheckbox.setAttribute('checked', 'checked');\n\t\t\t}\n\t\t\texecuteAfterPreviousBlock = Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\tchildren: [\n\t\t\t\t\texecuteAfterPreviousCheckbox,\n\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tfor: \"param-group-3-1\" + idSalt,\n\t\t\t\t\t\t\tstyle: 'color: #535C69'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS_WIDE')\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings bizproc-automation-popup-settings-flex\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block bizproc-automation-popup-settings-block-flex\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title-wrapper\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tdelayTypeNode,\n\t\t\t\t\t\t\t\tdelayValueNode,\n\t\t\t\t\t\t\t\tdelayValueTypeNode,\n\t\t\t\t\t\t\t\tdelayBasisNode,\n\t\t\t\t\t\t\t\tdelayWorkTimeNode,\n\t\t\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-left\" },\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO_EXECUTE') + \":\"\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdelayIntervalLabelNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\texecuteAfterPreviousBlock\n\t\t\t]\n\t\t});\n\n\t\tdelayIntervalSelector.init(delay);\n\n\t\treturn div;\n\t}\n\n\tsetDelaySettingsFromForm(formFields,  robot)\n\t{\n\t\tconst delay = new DelayInterval();\n\t\tdelay.setType(formFields['delay_type']);\n\t\tdelay.setValue(formFields['delay_value']);\n\t\tdelay.setValueType(formFields['delay_value_type']);\n\t\tdelay.setBasis(formFields['delay_basis']);\n\t\tdelay.setWorkTime(formFields['delay_worktime'] === '1');\n\t\trobot.setDelayInterval(delay);\n\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\trobot.setExecuteAfterPrevious(\n\t\t\t\tformFields['execute_after_previous'] && (formFields['execute_after_previous']) === '1'\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trenderConditionSettings(robot)\n\t{\n\t\tconst conditionGroup = robot.getCondition();\n\t\tthis.conditionSelector = new ConditionGroupSelector(conditionGroup, {\n\t\t\tfields: this.#context.document.getFields(),\n\t\t\tonOpenMenu: (event) => {\n\t\t\t\tthis.#addRobotReturnFieldsToSelector(event, robot);\n\n\t\t\t\tthis.emit(\n\t\t\t\t\t'Template:onSelectorMenuOpen',\n\t\t\t\t\t{\n\t\t\t\t\t\ttemplate: this,\n\t\t\t\t\t\trobot,\n\t\t\t\t\t\t...event.getData()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\"\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tthis.conditionSelector.createNode(),\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tsetConditionSettingsFromForm(formFields, robot)\n\t{\n\t\trobot.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\trenderBrokenLinkAlert()\n\t{\n\t\tconst alert = Dom.create('div', {\n\t\t\tattrs: {className:'ui-alert ui-alert-warning ui-alert-icon-info ui-alert-xs'}\n\t\t});\n\n\t\tconst message = Dom.create('span', {\n\t\t\tattrs: {className: 'ui-alert-message'},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_BROKEN_LINK_MESSAGE_ERROR')\n\t\t});\n\n\t\talert.appendChild(message);\n\t\talert.appendChild(Dom.create('span', {\n\t\t\tattrs: {className: 'ui-alert-close-btn'},\n\t\t\tevents: {\n\t\t\t\tclick() {\n\t\t\t\t\talert.style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\treturn alert;\n\t}\n\n\tsaveRobotSettings(form, robot, callback, btnNode)\n\t{\n\t\tif (btnNode)\n\t\t{\n\t\t\tbtnNode.classList.add('popup-window-button-wait');\n\t\t}\n\n\t\tthis.onBeforeSaveRobotSettings();\n\t\tconst formData = BX.ajax.prepareForm(form);\n\n\t\tconst ajaxUrl = this.#context.ajaxUrl;\n\t\tconst documentSigned = this.#context.signedDocument;\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: Uri.addParam(\n\t\t\t\tajaxUrl,\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: `automation_robot${robot.draft ? '_draft' : ''}_save_${robot.data.Type.toLowerCase()}`\n\t\t\t\t}\n\t\t\t),\n\t\t\tdata: {\n\t\t\t\tajax_action: 'save_robot_settings',\n\t\t\t\tdocument_signed: documentSigned,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_data_json: Helper.toJsonString(formData['data']),\n\t\t\t\tform_data: formData['data'], /** @bug 0135641 */\n\t\t\t},\n\t\t\tonsuccess: response => {\n\t\t\t\tif (btnNode)\n\t\t\t\t{\n\t\t\t\t\tbtnNode.classList.remove('popup-window-button-wait');\n\t\t\t\t}\n\n\t\t\t\tif (response.SUCCESS)\n\t\t\t\t{\n\t\t\t\t\trobot.updateData(response.DATA.robot);\n\t\t\t\t\tthis.setDelaySettingsFromForm(formData['data'], robot);\n\t\t\t\t\tthis.setConditionSettingsFromForm(formData['data'], robot);\n\n\t\t\t\t\tif (robot.draft)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#robots.push(robot);\n\t\t\t\t\t\tthis.insertRobotNode(robot.node);\n\t\t\t\t\t}\n\t\t\t\t\trobot.draft = false;\n\n\t\t\t\t\trobot.reInit();\n\t\t\t\t\tthis.markModified();\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(response.DATA)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\talert(response.ERRORS[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tserialize()\n\t{\n\t\tconst data = BX.clone(this.#data);\n\t\tdata['IS_EXTERNAL_MODIFIED'] = this.isExternalModified() ? 1 : 0;\n\t\tdata['ROBOTS'] = [];\n\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tdata['ROBOTS'].push(this.#robots[i].serialize());\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tisExternalModified()\n\t{\n\t\treturn (this.externalModified === true);\n\t}\n\n\tmarkExternalModified(modified)\n\t{\n\t\tthis.externalModified = modified !== false;\n\t}\n\n\tgetRobotById(id)\n\t{\n\t\treturn this.#robots.find(robot => robot.getId() === id);\n\t}\n\n\tisModified()\n\t{\n\t\treturn this.modified;\n\t}\n\n\tmarkModified(modified)\n\t{\n\t\tthis.modified = modified !== false;\n\n\t\tif (this.modified)\n\t\t{\n\t\t\tthis.emit('Template:modified');\n\t\t}\n\t}\n\n\tgetConstants()\n\t{\n\t\tconst constants = [];\n\n\t\tObject.keys(this.#data.CONSTANTS).forEach(id => {\n\t\t\tconst constant = BX.clone(this.#data.CONSTANTS[id]);\n\n\t\t\tconstant.Id = id;\n\t\t\tconstant.ObjectId = 'Constant';\n\t\t\tconstant.SystemExpression = '{=Constant:' + id + '}';\n\t\t\tconstant.Expression = '{{~&:' + id + '}}';\n\n\t\t\tconstants.push(constant);\n\t\t});\n\n\t\treturn constants;\n\t}\n\n\tgetConstant(id)\n\t{\n\t\tconst constants = this.getConstants();\n\n\t\tfor (let i = 0; i < constants.length; ++i)\n\t\t{\n\t\t\tif (constants[i].Id === id)\n\t\t\t{\n\t\t\t\treturn constants[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddConstant(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Constant', this.#data.CONSTANTS);\n\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.CONSTANTS[id] = property;\n\n\t\tthis.emit('Template:constant:add');\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantAdd', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tupdateConstant(id, property)\n\t{\n\t\tif (!this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.CONSTANTS[id].Description = property.Description;\n\n\t\tthis.emit('Template:constant:update', {constant: this.getConstant(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantUpdate', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tdeleteConstant(id)\n\t{\n\t\tdelete this.#data.CONSTANTS[id];\n\n\t\treturn true;\n\t}\n\n\tsetConstantValue(id, value)\n\t{\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthis.#data.CONSTANTS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetParameters()\n\t{\n\t\tconst params = [];\n\n\t\tObject.keys(this.#data.PARAMETERS).forEach(id => {\n\t\t\tconst param = BX.clone(this.#data.PARAMETERS[id]);\n\n\t\t\tparam.Id = id;\n\t\t\tparam.ObjectId = 'Template';\n\t\t\tparam.SystemExpression = '{=Template:' + id + '}';\n\t\t\tparam.Expression = '{{~*:' + id + '}}';\n\n\t\t\tparams.push(param);\n\t\t});\n\n\t\treturn params;\n\t}\n\n\tgetParameter(id)\n\t{\n\t\tconst params = this.getParameters();\n\n\t\tfor (let i = 0; i < params.length; ++i)\n\t\t{\n\t\t\tif (params[i].Id === id)\n\t\t\t{\n\t\t\t\treturn params[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddParameter(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Parameter', this.#data.PARAMETERS);\n\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.PARAMETERS[id] = property;\n\n\t\tthis.emit('Template:parameter:add', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterAdd', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tupdateParameter(id, property)\n\t{\n\t\tif (!this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.PARAMETERS[id].Description = property.Description;\n\n\t\tthis.emit('Template:parameter:update', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterUpdate', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tdeleteParameter(id)\n\t{\n\t\tdelete this.#data.PARAMETERS[id];\n\n\t\treturn true;\n\t}\n\n\tsetParameterValue(id, value)\n\t{\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthis.#data.PARAMETERS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetVariables()\n\t{\n\t\tconst variables = [];\n\n\t\tObject.keys(this.#data.VARIABLES).forEach(id => {\n\t\t\tconst variable = BX.clone(this.#data.VARIABLES[id]);\n\n\t\t\tvariable.Id = id;\n\t\t\tvariable.ObjectId = 'Variable';\n\t\t\tvariable.SystemExpression = '{=Variable:' + id + '}';\n\t\t\tvariable.Expression = '{=Variable:' + id + '}';\n\n\t\t\tvariables.push(variable);\n\t\t});\n\n\t\treturn variables;\n\t}\n\n\tgeneratePropertyId(prefix, existsList)\n\t{\n\t\tlet index;\n\t\tfor(index = 1; index <= 1000; ++index)\n\t\t{\n\t\t\tif (!existsList[prefix + index])\n\t\t\t{\n\t\t\t\tbreak; //found\n\t\t\t}\n\t\t}\n\n\t\treturn prefix + index;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tconst robotUsages = robot.collectUsages();\n\n\t\t\tObject.keys(usages).forEach(key => {\n\t\t\t\trobotUsages[key].forEach(usage => {\n\t\t\t\t\tif (!usages[key].has(usage))\n\t\t\t\t\t{\n\t\t\t\t\t\tusages[key].add(usage);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn usages;\n\t}\n\n\tsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.#robots.forEach(robot => robot.subscribe(eventName, listener))\n\n\t\treturn this;\n\t}\n\n\tunsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void)\n\t{\n\t\tthis.#robots.forEach(robot => robot.unsubscribe(eventName, listener));\n\n\t\treturn this;\n\t}\n\n\tgetRobotDescription(type: string): ?object\n\t{\n\t\treturn this.#context.availableRobots.find(item => item['CLASS'] === type);\n\t}\n\n\tsetGlobalVariables(globalVariables: Array = []): this\n\t{\n\t\tthis.globalVariables = globalVariables;\n\n\t\treturn this;\n\t}\n\n\tsetGlobalConstants(globalConstants: Array = []): this\n\t{\n\t\tthis.globalConstants = globalConstants;\n\n\t\treturn this;\n\t}\n}","import { Type } from 'main.core';\n\nexport class Condition\n{\n\t#object: string;\n\t#field: string;\n\t#operator: string;\n\t#value: string;\n\n\tparentGroup;\n\n\tconstructor(params: ?Object, group)\n\t{\n\t\tthis.#object = 'Document';\n\t\tthis.#field = '';\n\t\tthis.#operator = '!empty';\n\t\tthis.#value = '';\n\n\t\tthis.parentGroup = null;\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['object'])\n\t\t\t{\n\t\t\t\tthis.setObject(params['object']);\n\t\t\t}\n\t\t\tif (params['field'])\n\t\t\t{\n\t\t\t\tthis.setField(params['field']);\n\t\t\t}\n\t\t\tif (params['operator'])\n\t\t\t{\n\t\t\t\tthis.setOperator(params['operator']);\n\t\t\t}\n\t\t\tif ('value' in params)\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t}\n\t\tif (group)\n\t\t{\n\t\t\tthis.parentGroup = group;\n\t\t}\n\t}\n\n\tclone(): Condition\n\t{\n\t\treturn new Condition(\n\t\t\t{\n\t\t\t\tobject: this.#object,\n\t\t\t\tfield: this.#field,\n\t\t\t\toperator: this.#operator,\n\t\t\t\tvalue: this.#value,\n\t\t\t},\n\t\t\tthis.parentGroup,\n\t\t);\n\t}\n\n\tsetObject(object)\n\t{\n\t\tif (Type.isStringFilled(object))\n\t\t{\n\t\t\tthis.#object = object;\n\t\t}\n\t}\n\n\tget object()\n\t{\n\t\treturn this.#object;\n\t}\n\n\tsetField(field)\n\t{\n\t\tif (Type.isStringFilled(field))\n\t\t{\n\t\t\tthis.#field = field;\n\t\t}\n\t}\n\n\tget field()\n\t{\n\t\treturn this.#field;\n\t}\n\n\tsetOperator(operator)\n\t{\n\t\tif (!operator)\n\t\t{\n\t\t\toperator = '=';\n\t\t}\n\n\t\tthis.#operator = operator;\n\t}\n\n\tget operator(): string\n\t{\n\t\treturn this.#operator;\n\t}\n\n\tsetValue(value)\n\t{\n\t\tthis.#value = value;\n\t\tif (this.#operator === '=' && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = 'empty';\n\t\t}\n\t\telse if (this.#operator === '!=' && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = '!empty';\n\t\t}\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\tobject: this.#object,\n\t\t\tfield: this.#field,\n\t\t\toperator: this.#operator,\n\t\t\tvalue: this.#value\n\t\t}\n\t}\n}","import { Type, Loc } from 'main.core';\nimport { Condition } from './condition';\n\nexport class ConditionGroup\n{\n\tstatic CONDITION_TYPE = {\n\t\tField: 'field',\n\t\tMixed: 'mixed',\n\t}\n\tstatic JOINER = {\n\t\tAnd: 'AND',\n\t\tOr: 'OR',\n\n\t\tmessage(type)\n\t\t{\n\t\t\tif (type === this.Or)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_OR');\n\t\t\t}\n\n\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_AND');\n\t\t}\n\t}\n\n\t#type: string;\n\t#items: Array<[Condition, string]>;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tthis.#type = ConditionGroup.CONDITION_TYPE.field;\n\t\tthis.#items = [];\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.#type = params['type'];\n\t\t\t}\n\t\t\tif (Type.isArray(params['items']))\n\t\t\t{\n\t\t\t\tparams['items'].forEach(item => {\n\t\t\t\t\tconst condition = new Condition(item[0], this);\n\t\t\t\t\tthis.addItem(condition, item[1]);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tclone()\n\t{\n\t\tconst clonedGroup = new ConditionGroup({type: this.#type});\n\t\tthis.#items.forEach(([condition, joiner]) => {\n\t\t\tconst clonedCondition = condition.clone();\n\t\t\tclonedCondition.parentGroup = clonedGroup;\n\n\t\t\tclonedGroup.addItem(clonedCondition, joiner);\n\t\t});\n\n\t\treturn clonedGroup;\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tset type(type: string)\n\t{\n\t\tif (Object.values(ConditionGroup.CONDITION_TYPE).includes(type))\n\t\t{\n\t\t\tthis.#type = type;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget items()\n\t{\n\t\treturn this.#items;\n\t}\n\n\tstatic createFromForm(formFields, prefix)\n\t{\n\t\tconst conditionGroup = new ConditionGroup();\n\t\tif (!prefix)\n\t\t{\n\t\t\tprefix = 'condition_';\n\t\t}\n\n\t\tif (Type.isArray(formFields[prefix + 'field']))\n\t\t{\n\t\t\tfor (let i = 0; i < formFields[prefix + 'field'].length; ++i)\n\t\t\t{\n\t\t\t\tif (formFields[prefix + 'field'][i] === '')\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst condition = new Condition({}, conditionGroup);\n\t\t\t\tcondition.setObject(formFields[prefix + 'object'][i]);\n\t\t\t\tcondition.setField(formFields[prefix + 'field'][i]);\n\t\t\t\tcondition.setOperator(formFields[prefix + 'operator'][i]);\n\t\t\t\tcondition.setValue(formFields[prefix + 'value'][i]);\n\n\t\t\t\tlet joiner = ConditionGroup.JOINER.And;\n\t\t\t\tif (formFields[prefix + 'joiner'] && formFields[prefix + 'joiner'][i] === ConditionGroup.JOINER.Or)\n\t\t\t\t{\n\t\t\t\t\tjoiner = ConditionGroup.JOINER.Or;\n\t\t\t\t}\n\n\t\t\t\tconditionGroup.addItem(condition, joiner);\n\t\t\t}\n\t\t}\n\n\t\treturn conditionGroup;\n\t}\n\n\taddItem(condition, joiner)\n\t{\n\t\tthis.#items.push([condition, joiner]);\n\t}\n\n\tgetItems(): Array<Array<Condition, string>>\n\t{\n\t\treturn this.#items;\n\t}\n\n\tserialize()\n\t{\n\t\tconst itemsArray = [];\n\n\t\tthis.#items.forEach(item => {\n\t\t\tif (item.field !== '')\n\t\t\t{\n\t\t\t\titemsArray.push([item[0].serialize(), item[1]]);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\titems: itemsArray\n\t\t};\n\t}\n}","import { Condition, ConditionGroup, Designer, getGlobalContext, InlineSelectorCondition, SelectorContext } from 'bizproc.automation';\nimport { Dom, Type, Event, Loc, Runtime } from 'main.core';\n\nimport type { ConditionSelectorOptions } from './types';\n\nexport class ConditionSelector\n{\n\t#condition: ?Condition;\n\t#fields: Array<Object>;\n\t#joiner: string;\n\t#fieldPrefix: string;\n\t#onOpenMenu;\n\n\tnode: ?HTMLElement;\n\tobjectNode: ?HTMLElement;\n\tfieldNode: ?HTMLElement;\n\tjoinerNode: ?HTMLElement;\n\tlabelNode: ?HTMLElement;\n\n\tpopup: BX.PopupWindow;\n\tfieldDialog: ?InlineSelectorCondition;\n\n\tconstructor(condition, options: ?ConditionSelectorOptions)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.#fields = [];\n\t\tthis.#joiner = ConditionGroup.JOINER.And;\n\t\tthis.#fieldPrefix = 'condition_';\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields.map(field => {\n\t\t\t\t\tfield.ObjectId = 'Document';\n\n\t\t\t\t\treturn field;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (options.joiner && options.joiner === ConditionGroup.JOINER.Or)\n\t\t\t{\n\t\t\t\tthis.#joiner = ConditionGroup.JOINER.Or;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\n\t\t\tthis.#onOpenMenu = options.onOpenMenu;\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst conditionObjectNode = this.objectNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"object[]\",\n\t\t\t\tvalue: this.#condition.object\n\t\t\t}\n\t\t});\n\t\tconst conditionFieldNode = this.fieldNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"field[]\",\n\t\t\t\tvalue: this.#condition.field\n\t\t\t}\n\t\t});\n\t\tconst conditionOperatorNode = this.operatorNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"operator[]\",\n\t\t\t\tvalue: this.#condition.operator\n\t\t\t}\n\t\t});\n\t\tconst conditionValueNode = this.valueNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"value[]\",\n\t\t\t\tvalue: this.#condition.value\n\t\t\t}\n\t\t});\n\n\t\tconst conditionJoinerNode = this.joinerNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"joiner[]\",\n\t\t\t\tvalue: this.#joiner\n\t\t\t}\n\t\t});\n\n\t\tconst labelNode = this.labelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-wrapper\"\n\t\t\t}\n\t\t});\n\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\n\t\tconst removeButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-remove\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: this.removeCondition.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst joinerButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-condition-joiner\"\n\t\t\t},\n\t\t\ttext: ConditionGroup.JOINER.message(this.#joiner),\n\t\t});\n\n\t\tEvent.bind(joinerButtonNode, 'click', this.changeJoiner.bind(this, joinerButtonNode));\n\n\t\tthis.node = Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper bizproc-automation-condition-wrapper\" },\n\t\t\tchildren: [\n\t\t\t\tconditionObjectNode,\n\t\t\t\tconditionFieldNode,\n\t\t\t\tconditionOperatorNode,\n\t\t\t\tconditionValueNode,\n\t\t\t\tconditionJoinerNode,\n\t\t\t\tlabelNode,\n\t\t\t\tremoveButtonNode,\n\t\t\t\tjoinerButtonNode\n\t\t\t]\n\t\t});\n\n\t\treturn this.node;\n\t}\n\n\tinit(condition: Condition)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (!this.labelNode || !this.#condition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.labelNode);\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\tconst field = this.getField(this.#condition.object, this.#condition.field) || '?';\n\t\t\tconst valueLabel =\n\t\t\t\t(this.#condition.operator.indexOf('empty') < 0)\n\t\t\t\t\t? BX.Bizproc.FieldType.formatValuePrintable(field, this.#condition.value)\n\t\t\t\t\t: null\n\t\t\t;\n\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: field.Name\n\t\t\t}));\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: this.getOperatorLabel(this.#condition.operator)\n\t\t\t}));\n\t\t\tif (valueLabel)\n\t\t\t{\n\t\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: valueLabel\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY')\n\t\t\t}));\n\t\t}\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', this.onLabelClick.bind(this));\n\t\t}\n\t}\n\n\tonLabelClick()\n\t{\n\t\tthis.showPopup();\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.show();\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = this.filterFields();\n\n\t\tconst objectSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelectLabel = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown',\n\t\t\t\treadonly: 'readonly'\n\t\t\t},\n\t\t\tchildren: [fieldSelect]\n\t\t});\n\n\t\tEvent.bind(\n\t\t\tfieldSelectLabel,\n\t\t\t'click',\n\t\t\tthis.onFieldSelectorClick.bind(this, fieldSelectLabel, fieldSelect, fields, objectSelect)\n\t\t);\n\n\t\tlet selectedField = this.getField(this.#condition.object, this.#condition.field);\n\t\tif (!this.#condition.field)\n\t\t{\n\t\t\tselectedField = fields[0];\n\t\t}\n\t\tfieldSelect.value = selectedField.Id;\n\t\tobjectSelect.value = selectedField.ObjectId;\n\t\tfieldSelectLabel.textContent = selectedField.Name;\n\n\t\tconst valueInput = (this.#condition.operator.indexOf('empty') < 0)\n\t\t\t? this.createValueNode(selectedField, this.#condition.value) : null;\n\n\t\tconst valueWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [valueInput]\n\t\t});\n\n\t\tconst operatorSelect = this.createOperatorNode(selectedField, valueWrapper);\n\t\tconst operatorWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [operatorSelect]\n\t\t});\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\toperatorSelect.value = this.#condition.operator;\n\t\t}\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [fieldSelectLabel]\n\t\t\t\t}),\n\t\t\t\toperatorWrapper,\n\t\t\t\tvalueWrapper\n\t\t\t]\n\t\t});\n\n\t\tEvent.bind(fieldSelect, 'change', this.onFieldChange.bind(\n\t\t\tthis,\n\t\t\tfieldSelect,\n\t\t\toperatorWrapper,\n\t\t\tvalueWrapper,\n\t\t\tobjectSelect\n\t\t));\n\n\t\tconst self = this;\n\t\tthis.popup = new BX.PopupWindow('bizproc-automation-popup-set', this.labelNode, {\n\t\t\tclassName: 'bizproc-automation-popup-set',\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 45,\n\t\t\toverlay: { backgroundColor: 'transparent' },\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: \"webform-button webform-button-create\" ,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.#condition.setObject(objectSelect.value);\n\t\t\t\t\t\t\tself.#condition.setField(fieldSelect.value);\n\t\t\t\t\t\t\tself.#condition.setOperator(operatorWrapper.firstChild.value);\n\n\t\t\t\t\t\t\tconst valueInput = valueWrapper.querySelector('[name^=\"' + self.#fieldPrefix + 'value\"]');\n\n\t\t\t\t\t\t\tif (valueInput)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#condition.setValue(valueInput.value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#condition.setValue('');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.setLabelText();\n\t\t\t\t\t\t\tself.updateValueNode();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t\tif (self.fieldDialog)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldDialog.destroy();\n\t\t\t\t\t\tdelete(self.fieldDialog);\n\t\t\t\t\t}\n\t\t\t\t\tdelete(self.popup);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.popup.show();\n\t}\n\n\tonFieldSelectorClick(fieldSelectLabel, fieldSelect, fields, objectSelect, event)\n\t{\n\t\tif (!this.fieldDialog)\n\t\t{\n\t\t\tconst globalContext = getGlobalContext();\n\t\t\tconst fields = Runtime.clone(\n\t\t\t\tType.isArrayFilled(this.#fields) ? this.#fields : globalContext.document.getFields()\n\t\t\t);\n\n\t\t\tthis.fieldDialog = new InlineSelectorCondition({\n\t\t\t\tcontext: new SelectorContext({\n\t\t\t\t\tfields,\n\t\t\t\t\trootGroupTitle: globalContext.document.title,\n\t\t\t\t}),\n\t\t\t\tcondition: this.#condition,\n\t\t\t});\n\n\t\t\tif (Type.isFunction(this.#onOpenMenu))\n\t\t\t{\n\t\t\t\tthis.fieldDialog.subscribe('onOpenMenu', this.#onOpenMenu);\n\t\t\t}\n\n\t\t\tthis.fieldDialog.subscribe('change', (event) => {\n\t\t\t\tconst property = event.getData().field;\n\t\t\t\tfieldSelectLabel.textContent = property.Name\n\t\t\t\tfieldSelect.value = property.Id;\n\t\t\t\tobjectSelect.value = property.ObjectId;\n\t\t\t\tBX.fireEvent(fieldSelect, 'change');\n\t\t\t});\n\n\t\t\tthis.fieldDialog.renderTo(fieldSelectLabel);\n\t\t}\n\n\t\tthis.fieldDialog.openMenu(event);\n\t}\n\n\tupdateValueNode()\n\t{\n\t\tif (this.#condition)\n\t\t{\n\t\t\tif (this.objectNode)\n\t\t\t{\n\t\t\t\tthis.objectNode.value = this.#condition.object;\n\t\t\t}\n\t\t\tif (this.fieldNode)\n\t\t\t{\n\t\t\t\tthis.fieldNode.value = this.#condition.field;\n\t\t\t}\n\t\t\tif (this.operatorNode)\n\t\t\t{\n\t\t\t\tthis.operatorNode.value = this.#condition.operator;\n\t\t\t}\n\t\t\tif (this.valueNode)\n\t\t\t{\n\t\t\t\tthis.valueNode.value = this.#condition.value;\n\t\t\t}\n\t\t}\n\t}\n\n\tonFieldChange(selectNode: Node, conditionWrapper: Node, valueWrapper: Node, objectSelect)\n\t{\n\t\tconst field = this.getField(objectSelect.value, selectNode.value);\n\t\tconst operatorNode = this.createOperatorNode(field, valueWrapper);\n\t\tconditionWrapper.replaceChild(operatorNode, conditionWrapper.firstChild);\n\t\tthis.onOperatorChange(operatorNode, field, valueWrapper);\n\t}\n\n\tonOperatorChange(selectNode: Node, field: Object, valueWrapper: Node)\n\t{\n\t\tDom.clean(valueWrapper);\n\n\t\tif (selectNode.value.indexOf('empty') < 0)\n\t\t{\n\t\t\tconst valueNode = this.createValueNode(field);\n\t\t\tvalueWrapper.appendChild(valueNode);\n\t\t}\n\t}\n\n\t// TODO - fix this method\n\tgetField(object, id)\n\t{\n\t\tlet field;\n\t\tconst robot = Designer.getInstance().robot;\n\t\tconst component = Designer.getInstance().component;\n\t\tconst tpl = robot? robot.getTemplate() : null;\n\n\t\tswitch (object)\n\t\t{\n\t\t\tcase 'Document':\n\t\t\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (id === this.#fields[i].Id)\n\t\t\t\t\t{\n\t\t\t\t\t\tfield = this.#fields[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Template':\n\t\t\t\tif (tpl && component && component.triggerManager)\n\t\t\t\t{\n\t\t\t\t\tfield = component.triggerManager.getReturnProperty(tpl.getStatusId(), id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Constant':\n\t\t\t\tif (tpl)\n\t\t\t\t{\n\t\t\t\t\tfield = tpl.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalConst':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalVar':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getGVariable(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tvar foundRobot = tpl? tpl.getRobotById(object) : null;\n\t\t\t\tif (foundRobot)\n\t\t\t\t{\n\t\t\t\t\tfield = foundRobot.getReturnProperty(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn field || {\n\t\t\tId: id,\n\t\t\tObjectId: object,\n\t\t\tName: id,\n\t\t\tType: 'string',\n\t\t\tExpression: id,\n\t\t\tSystemExpression: '{='+object+':'+id+'}'\n\t\t};\n\t}\n\n\tgetOperators(fieldType, multiple)\n\t{\n\t\tlet list = {\n\t\t\t'!empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_EMPTY'),\n\t\t\t'empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY'),\n\t\t\t'=': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EQ'),\n\t\t\t'!=': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NE')\n\t\t};\n\t\tswitch (fieldType)\n\t\t{\n\t\t\tcase 'file':\n\t\t\tcase 'UF:crm':\n\t\t\tcase 'UF:resourcebooking':\n\t\t\t\tlist = {\n\t\t\t\t\t'!empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_EMPTY'),\n\t\t\t\t\t'empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY')\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'bool':\n\t\t\tcase 'select':\n\t\t\t\tif (multiple)\n\t\t\t\t{\n\t\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//TODO: render multiple select in value selector\n\t\t\t\t\t//list['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'user':\n\t\t\t\tlist['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\tlist['!in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_IN');\n\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlist['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\tlist['!in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_IN');\n\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\tlist['>'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_GT');\n\t\t\t\tlist['>='] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_GTE');\n\t\t\t\tlist['<'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_LT');\n\t\t\t\tlist['<='] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_LTE');\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetOperatorLabel(id)\n\t{\n\t\treturn this.getOperators()[id];\n\t}\n\n\tfilterFields()\n\t{\n\t\tconst filtered = [];\n\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t{\n\t\t\tconst type = this.#fields[i]['Type'];\n\n\t\t\tif (\n\t\t\t\ttype === 'bool'\n\t\t\t\t|| type === 'date'\n\t\t\t\t|| type === 'datetime'\n\t\t\t\t|| type === 'double'\n\t\t\t\t|| type === 'file'\n\t\t\t\t|| type === 'int'\n\t\t\t\t|| type === 'select'\n\t\t\t\t|| type === 'string'\n\t\t\t\t|| type === 'text'\n\t\t\t\t|| type === 'user'\n\t\t\t\t|| type === 'UF:money'\n\t\t\t\t|| type === 'UF:crm'\n\t\t\t\t|| type === 'UF:resourcebooking'\n\t\t\t\t|| type === 'UF:url'\n\t\t\t)\n\t\t\t{\n\t\t\t\tfiltered.push(this.#fields[i]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//TODO add support of custom types\n\t\t\t}\n\t\t}\n\n\t\treturn filtered;\n\t}\n\n\tcreateValueNode(docField, value)\n\t{\n\t\tconst docType = (\n\t\t\tDesigner.getInstance().component\n\t\t\t\t? Designer.getInstance().component.document.getRawType()\n\t\t\t\t: getGlobalContext().document.getRawType()\n\t\t);\n\t\tconst field = BX.clone(docField);\n\t\tfield.Multiple = false;\n\n\t\treturn BX.Bizproc.FieldType.renderControl(\n\t\t\tdocType,\n\t\t\tfield,\n\t\t\tthis.#fieldPrefix + 'value',\n\t\t\tvalue\n\t\t);\n\t}\n\n\tcreateOperatorNode(field, valueWrapper)\n\t{\n\t\tconst select = Dom.create('select', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'}\n\t\t});\n\n\t\tconst operatorList = this.getOperators(field['Type'], field['Multiple']);\n\t\tfor (var operatorId in operatorList)\n\t\t{\n\t\t\tif (!operatorList.hasOwnProperty(operatorId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\tprops: {value: operatorId},\n\t\t\t\ttext: operatorList[operatorId]\n\t\t\t}));\n\t\t}\n\n\t\tEvent.bind(select, 'change', this.onOperatorChange.bind(\n\t\t\tthis,\n\t\t\tselect,\n\t\t\tfield,\n\t\t\tvalueWrapper\n\t\t));\n\n\t\treturn select;\n\t}\n\n\tremoveCondition(event: Event)\n\t{\n\t\tthis.#condition = null;\n\t\tDom.remove(this.node);\n\t\tthis.labelNode = this.fieldNode = this.operatorNode = this.valueNode = this.node = null;\n\n\t\tevent.stopPropagation();\n\t}\n\n\tchangeJoiner(btn: Element, event: Event)\n\t{\n\t\tthis.#joiner = (this.#joiner === ConditionGroup.JOINER.Or ? ConditionGroup.JOINER.And : ConditionGroup.JOINER.Or);\n\t\tbtn.textContent = ConditionGroup.JOINER.message(this.#joiner);\n\n\t\tif (this.joinerNode)\n\t\t{\n\t\t\tthis.joinerNode.value = this.#joiner;\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n}","import { Type, Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport { ConditionGroup } from 'bizproc.automation';\nimport { ConditionSelector } from './condition-selector';\nimport { Condition } from 'bizproc.automation';\n\nexport class ConditionGroupSelector\n{\n\t#conditionGroup: ConditionGroup;\n\t#fields: Array<Object>;\n\t#fieldPrefix: string;\n\t#itemSelectors: Array<ConditionSelector>;\n\t#onOpenMenu: ?(BaseEvent) => void;\n\n\tconstructor(conditionGroup: ConditionGroup, options: Object)\n\t{\n\t\tthis.#conditionGroup = conditionGroup;\n\t\tthis.#fields = [];\n\t\tthis.#fieldPrefix = 'condition_';\n\t\tthis.#itemSelectors = [];\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\n\t\t\tthis.#onOpenMenu = options.onOpenMenu;\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst me = this;\n\t\tconst conditionNodes = [];\n\t\tconst fields = this.#fields;\n\n\t\tthis.#conditionGroup.getItems().forEach(function(item)\n\t\t{\n\t\t\tconst conditionSelector = new ConditionSelector(item[0], {\n\t\t\t\tfields: fields,\n\t\t\t\tjoiner: item[1],\n\t\t\t\tfieldPrefix: me.#fieldPrefix,\n\t\t\t\tonOpenMenu: this.#onOpenMenu,\n\t\t\t});\n\n\t\t\tthis.#itemSelectors.push(conditionSelector);\n\t\t\tconditionNodes.push(conditionSelector.createNode());\n\t\t}, this);\n\n\t\tconditionNodes.push(Dom.create(\"a\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link\" },\n\t\t\ttext: '[+]',\n\t\t\tevents: {\n\t\t\t\tclick()\n\t\t\t\t{\n\t\t\t\t\tme.addItem(this);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\treturn Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper\" },\n\t\t\tchildren: conditionNodes\n\t\t});\n\t}\n\n\taddItem(buttonNode)\n\t{\n\t\tconst conditionSelector = new ConditionSelector(new Condition({}, this.#conditionGroup), {\n\t\t\tfields: this.#fields,\n\t\t\tfieldPrefix: this.#fieldPrefix,\n\t\t\tonOpenMenu: this.#onOpenMenu,\n\t\t});\n\t\tthis.#itemSelectors.push(conditionSelector);\n\n\t\tbuttonNode.parentNode.insertBefore(conditionSelector.createNode(), buttonNode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#itemSelectors.forEach(selector => selector.destroy());\n\t\tthis.#itemSelectors = [];\n\t}\n}","import {\n\tFileSelector,\n\tInlineSelector,\n\tInlineSelectorHtml,\n\tSaveStateCheckbox,\n\tTimeSelector,\n\tUserSelector,\n} from 'bizproc.automation';\n\nexport class Manager\n{\n\tstatic SELECTOR_ROLE_USER = 'user-selector';\n\tstatic SELECTOR_ROLE_FILE = 'file-selector';\n\tstatic SELECTOR_ROLE_INLINE = 'inline-selector-target';\n\tstatic SELECTOR_ROLE_INLINE_HTML = 'inline-selector-html';\n\tstatic SELECTOR_ROLE_TIME = 'time-selector';\n\tstatic SELECTOR_ROLE_SAVE_STATE = 'save-state-checkbox';\n\n\tstatic createSelectorByRole(role: string, selectorProps: object): InlineSelector | SaveStateCheckbox\n\t{\n\t\tif (role === this.SELECTOR_ROLE_USER)\n\t\t{\n\t\t\treturn new UserSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_FILE)\n\t\t{\n\t\t\treturn new FileSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_INLINE)\n\t\t{\n\t\t\treturn new InlineSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_INLINE_HTML)\n\t\t{\n\t\t\treturn new InlineSelectorHtml(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_TIME)\n\t\t{\n\t\t\treturn new TimeSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_SAVE_STATE)\n\t\t{\n\t\t\treturn new SaveStateCheckbox(selectorProps);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn undefined;\n\t\t}\n\t}\n}","import { SelectorContext, DelayIntervalSelector, Helper, DelayInterval } from 'bizproc.automation';\nimport { Dom, Event, Type, Loc, Tag, Runtime } from \"main.core\";\nimport { EventEmitter } from \"main.core.events\";\n\nimport { Field, MenuGroupItem }  from \"./types\";\nimport { MenuManager, Menu } from 'main.popup';\nimport { Dialog } from 'ui.entity-selector';\n\nexport class InlineSelector extends EventEmitter\n{\n\tcontext: SelectorContext;\n\tfieldProperty: ?Field = null;\n\treplaceOnWrite: boolean = false;\n\tmenuButton: ?HTMLSpanElement = null;\n\ttargetInput: ?HTMLElement = null;\n\t#menuGroups: Object<string, MenuGroupItem> = {};\n\tbasisFields: Array<Object> = [];\n\t#dialog: ?Dialog = null;\n\t#switcherDialog: ?Menu = null;\n\n\tconstructor(props: { context: SelectorContext })\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation.Selector');\n\n\t\tthis.context = props.context;\n\t\tthis.basisFields = this.context.fields;\n\t}\n\n\thasGroup(groupId: string): boolean\n\t{\n\t\treturn this.#menuGroups.hasOwnProperty(groupId);\n\t}\n\n\taddGroup(groupId: string, group: MenuGroupItem)\n\t{\n\t\tthis.#menuGroups[groupId] = this.#normalizeGroup(group);\n\t}\n\n\taddGroupItem(groupId: string, item: MenuGroupItem)\n\t{\n\t\tif (this.hasGroup(groupId))\n\t\t{\n\t\t\tthis.#menuGroups[groupId].children.push(this.#normalizeGroup(item));\n\t\t}\n\t}\n\n\t#normalizeGroup(group: MenuGroupItem)\n\t{\n\t\tif (!Type.isArray(group.children))\n\t\t{\n\t\t\tgroup.children = [];\n\t\t}\n\n\t\tgroup.children = (\n\t\t\tgroup\n\t\t\t\t.children\n\t\t\t\t.filter(item => item.customData?.field ? this.#shouldShowField(item.customData.field) : true)\n\t\t\t\t.map(childGroup => this.#normalizeGroup(childGroup))\n\t\t);\n\n\t\treturn {\n\t\t\tentityId: 'bp',\n\t\t\ttabs: 'recents',\n\t\t\t...group\n\t\t};\n\t}\n\n\trenderWith(targetInput: Element): HTMLDivElement\n\t{\n\t\tthis.targetInput = Runtime.clone(targetInput);\n\t\tthis.targetInput.setAttribute('autocomplete', 'off');\n\n\t\tthis.menuButton = Tag.render`\n\t\t\t<span \n\t\t\t\tonclick=\"${this.openMenu.bind(this)}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-dotted\"\n\t\t\t></span>\n\t\t`;\n\n\t\tthis.parseTargetProperties();\n\n\t\tthis.replaceOnWrite |= (this.targetInput.getAttribute('data-select-mode') === 'replace');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-select\">\n\t\t\t\t${this.targetInput}\n\t\t\t\t${this.menuButton}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderTo(targetInput: Element): void\n\t{\n\t\ttargetInput.parentNode.replaceChild(this.renderWith(targetInput), targetInput);\n\t}\n\n\tbindTargetEvents(): void\n\t{\n\t\tEvent.bind(this.targetInput, 'keydown', this.#onKeyDown.bind(this));\n\t}\n\n\tparseTargetProperties(): void\n\t{\n\t\tthis.fieldProperty = JSON.parse(this.targetInput.getAttribute('data-property'));\n\t\tconst propertyType = this.targetInput.getAttribute('data-selector-type');\n\n\t\tif (!this.fieldProperty && propertyType)\n\t\t{\n\t\t\tthis.fieldProperty = {Type: propertyType};\n\t\t}\n\n\t\tif (this.fieldProperty)\n\t\t{\n\t\t\tthis.fieldProperty.Type = this.fieldProperty.Type || propertyType;\n\t\t\tthis.#prepareSelectorUsingFieldType();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.context.useSwitcherMenu = false;\n\t\t}\n\n\t\tthis.replaceOnWrite |= (this.targetInput.getAttribute('data-select-mode') === 'replace');\n\t}\n\n\t#prepareSelectorUsingFieldType(): void\n\t{\n\t\tthis.basisFields = this.basisFields.filter(field => this.#shouldShowField(field));\n\n\t\tconst type = this.fieldProperty?.Type;\n\t\tif (type === 'file')\n\t\t{\n\t\t\tthis.replaceOnWrite = true;\n\t\t}\n\t\telse if (type === 'date' || type === 'datetime')\n\t\t{\n\t\t\tthis.replaceOnWrite = true;\n\n\t\t\tconst delayIntervalSelector = new DelayIntervalSelector({\n\t\t\t\tlabelNode: this.targetInput,\n\t\t\t\tbasisFields: this.basisFields,\n\t\t\t\tuseAfterBasis: true,\n\t\t\t\tonchange: (function(delay)\n\t\t\t\t{\n\t\t\t\t\tthis.targetInput.value = delay.toExpression(\n\t\t\t\t\t\tthis.basisFields,\n\t\t\t\t\t\tHelper.getResponsibleUserExpression(this.context.fields)\n\t\t\t\t\t);\n\t\t\t\t}).bind(this)\n\t\t\t});\n\n\t\t\tdelayIntervalSelector.init(DelayInterval.fromString(this.targetInput.value, this.basisFields));\n\t\t}\n\t}\n\n\t#shouldShowField(field: Field): boolean\n\t{\n\t\tconst fieldType = this.fieldProperty?.Type;\n\t\tif (fieldType === 'file')\n\t\t{\n\t\t\treturn field.Type === 'file';\n\t\t}\n\t\telse if (fieldType === 'date' || fieldType === 'datetime')\n\t\t{\n\t\t\treturn field.Type === 'date' || field.Type === 'datetime';\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#onKeyDown(event: KeyboardEvent)\n\t{\n\t\tif (event.keyCode === 45 && event.altKey === false && event.ctrlKey === false && event.shiftKey === false)\n\t\t{\n\t\t\tthis.openMenu(event);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\topenMenu(event: KeyboardEvent, skipPropertiesSwitcher: boolean = false)\n\t{\n\t\tif (!skipPropertiesSwitcher && this.context.useSwitcherMenu && !this.targetInput.value)\n\t\t{\n\t\t\treturn this.openPropertiesSwitcherMenu();\n\t\t}\n\n\t\tif (this.#dialog)\n\t\t{\n\t\t\tthis.#dialog.show();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.fillGroups();\n\t\tthis.onMenuOpen();\n\n\t\tlet menuItems = [];\n\t\tfor (const group of Object.values(this.#menuGroups))\n\t\t{\n\t\t\tif (group.children.length > 0)\n\t\t\t{\n\t\t\t\tmenuItems.push(group);\n\t\t\t}\n\t\t}\n\n\t\tif (menuItems.length === 1)\n\t\t{\n\t\t\tmenuItems = menuItems[0].children;\n\t\t}\n\n\t\tlet menuId = this.menuButton.getAttribute('data-selector-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tthis.menuButton.setAttribute('data-selector-id', menuId);\n\t\t}\n\n\t\tthis.#dialog = new Dialog({\n\t\t\ttargetNode: this.menuButton,\n\t\t\twidth: 500,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\titems: this.injectDialogMenuTitles(menuItems),\n\t\t\tshowAvatars: false,\n\t\t\tevents: {\n\t\t\t\t'Item:onBeforeSelect': (event) => {\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tconst item = event.getData().item;\n\t\t\t\t\tthis.onFieldSelect(item.getCustomData().get('field'));\n\t\t\t\t}\n\t\t\t},\n\t\t\tcompactView: true,\n\t\t});\n\n\t\tthis.#dialog.show();\n\t}\n\n\tfillGroups(): void\n\t{\n\t\tthis.fillFieldsGroups();\n\t\tthis.fillFileGroup();\n\t}\n\n\tfillFieldsGroups(): void\n\t{\n\t\tthis.addGroup('ROOT', {\n\t\t\tid: 'ROOT',\n\t\t\ttitle: this.context.rootGroupTitle,\n\t\t\tsearchable: false,\n\t\t});\n\n\t\tthis.getFields().forEach((field) => {\n\t\t\tlet groupKey = field.Id.indexOf('.') < 0 ? 'ROOT' : field.Id.split('.')[0];\n\t\t\tlet groupName = '';\n\n\t\t\tif (field.Name && groupKey !== 'ROOT' && field.Name.indexOf(': ') >= 0)\n\t\t\t{\n\t\t\t\tconst names = field.Name.split(': ');\n\t\t\t\tgroupName = names.shift();\n\t\t\t\tfield.Name = names.join(': ');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tfield['Id'].indexOf('ASSIGNED_BY_') === 0\n\t\t\t\t&& field['Id'] !== 'ASSIGNED_BY_ID'\n\t\t\t\t&& field['Id'] !== 'ASSIGNED_BY_PRINTABLE'\n\t\t\t)\n\t\t\t{\n\t\t\t\tgroupKey = 'ASSIGNED_BY';\n\t\t\t\tconst names = field.Name.split(' ');\n\t\t\t\tgroupName = names.shift();\n\t\t\t\tfield.Name = names.join(' ').replace('(', '').replace(')', '');\n\t\t\t}\n\n\t\t\tif (!this.hasGroup(groupKey))\n\t\t\t{\n\t\t\t\tthis.addGroup(groupKey, {\n\t\t\t\t\tid: groupKey,\n\t\t\t\t\ttitle: groupName,\n\t\t\t\t\tsearchable: false,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.addGroupItem(groupKey, {\n\t\t\t\tid: field.SystemExpression,\n\t\t\t\ttitle: field.Name || field.Id,\n\t\t\t\tcustomData: {field},\n\t\t\t});\n\t\t});\n\t}\n\n\tfillFileGroup(): void\n\t{\n\t\tconst fileFields = this.getFields().filter((field) => field.Type === 'file');\n\n\t\tif (fileFields.length > 0)\n\t\t{\n\t\t\tthis.addGroup('__FILES', {\n\t\t\t\tid: '__FILES',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FILES_LINKS'),\n\t\t\t\tchildren: this.#prepareFilesMenu(fileFields),\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\t}\n\n\t#prepareFilesMenu(fileFields: Array<Field>): Array<MenuGroupItem>\n\t{\n\t\treturn fileFields.map((field) => {\n\t\t\tconst exp = (\n\t\t\t\tfield['ObjectId'] === 'Document'\n\t\t\t\t\t? '{{'+field['Name']+' > shortlink}}'\n\t\t\t\t\t: '{{~'+field['ObjectId']+':'+field['Id']+' > shortlink}}'\n\t\t\t);\n\n\t\t\tlet title = field.Name || field.Id;\n\n\t\t\tif (field.ObjectName)\n\t\t\t{\n\t\t\t\ttitle = field.ObjectName + ': ' + title;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: title,\n\t\t\t\tcustomData: {\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tId: field['Id'] + '_shortlink',\n\t\t\t\t\t\tObjectId: field['ObjectId'],\n\t\t\t\t\t\tName: field['Name'],\n\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\tExpression: exp,\n\t\t\t\t\t\tSystemExpression: '{='+field['ObjectId']+':'+field['Id']+' > shortlink}'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tid: exp,\n\t\t\t};\n\t\t});\n\t}\n\n\tonMenuOpen(): void\n\t{\n\t\tthis.emit('onOpenMenu', { selector: this });\n\t}\n\n\topenPropertiesSwitcherMenu()\n\t{\n\t\tconst self = this;\n\n\t\tMenuManager.show(\n\t\t\tHelper.generateUniqueId(),\n\t\t\tthis.menuButton,\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.emit('onAskConstant', {fieldProperty: self.fieldProperty});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.emit('onAskParameter', {fieldProperty: self.fieldProperty});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_MANUAL'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.openMenu(event, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 20,\n\t\t\t\tangle: { position: 'top'},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.#switcherDialog = MenuManager.currentItem;\n\n\t\treturn true;\n\t}\n\n\tinjectDialogMenuTitles(items)\n\t{\n\t\titems.forEach((parent) => {\n\t\t\tif (Type.isArray(parent.children))\n\t\t\t{\n\t\t\t\tthis.injectDialogMenuSupertitles(parent.title, parent.children);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tinjectDialogMenuSupertitles(title: string, children)\n\t{\n\t\tchildren.forEach((child) => {\n\t\t\tif (!child.supertitle)\n\t\t\t{\n\t\t\t\tchild.supertitle = title;\n\t\t\t}\n\t\t\tif (Type.isArrayFilled(child.children))\n\t\t\t{\n\t\t\t\tthis.injectDialogMenuSupertitles(child.title, child.children);\n\t\t\t}\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field): void\n\t{\n\t\tif (!field)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputType = this.targetInput.tagName.toLowerCase();\n\n\t\tif (inputType === 'select')\n\t\t{\n\t\t\tlet expressionOption = this.targetInput.querySelector('[data-role=\"expression\"]');\n\t\t\tif (!expressionOption)\n\t\t\t{\n\t\t\t\texpressionOption = (\n\t\t\t\t\tthis.targetInput.appendChild(\n\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t'option',\n\t\t\t\t\t\t\t{attrs: {'data-role': 'expression'}}\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\texpressionOption.setAttribute('value', field.Expression);\n\t\t\texpressionOption.textContent = field['Expression'];\n\n\t\t\texpressionOption.selected = true;\n\t\t}\n\t\telse if (inputType === 'label')\n\t\t{\n\t\t\tthis.targetInput.textContent = field.Expression;\n\t\t\tconst hiddenInput = document.getElementById(this.targetInput.getAttribute('for'));\n\t\t\tif (hiddenInput)\n\t\t\t{\n\t\t\t\thiddenInput.value = field.Expression;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.replaceOnWrite)\n\t\t\t{\n\t\t\t\tthis.targetInput.value = field.Expression;\n\t\t\t\tthis.targetInput.selectionEnd = this.targetInput.value.length;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst beforePart = this.targetInput.value.substr(0, this.targetInput.selectionEnd);\n\t\t\t\tconst middlePart = field.Expression;\n\t\t\t\tconst afterPart = this.targetInput.value.substr(this.targetInput.selectionEnd);\n\n\t\t\t\tthis.targetInput.value = beforePart + middlePart + afterPart;\n\t\t\t\tthis.targetInput.selectionEnd = beforePart.length + middlePart.length;\n\t\t\t}\n\t\t}\n\n\t\tBX.fireEvent(this.targetInput, 'change');\n\t\tthis.emit('change', { field });\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.#dialog)\n\t\t{\n\t\t\tthis.#dialog.destroy();\n\t\t}\n\t\tif (this.#switcherDialog)\n\t\t{\n\t\t\tthis.#switcherDialog.destroy();\n\t\t}\n\t}\n\n\tgetFields(): Array<Field>\n\t{\n\t\tconst printablePrefix = Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX');\n\t\tconst names = this.context.fields.map(field => field.Name).join('\\n');\n\n\t\tconst fields = [];\n\t\tthis.basisFields.forEach((field) => {\n\t\t\tfield.ObjectId = 'Document';\n\n\t\t\tconst custom = (field['BaseType'] === 'string' && field['Type'] !== 'string');\n\n\t\t\tif (!custom)\n\t\t\t{\n\t\t\t\tfields.push(field);\n\t\t\t}\n\n\t\t\t//generate printable version\n\t\t\tif (\n\t\t\t\tfield['Type'] === 'user'\n\t\t\t\t||\n\t\t\t\tfield['Type'] === 'bool'\n\t\t\t\t||\n\t\t\t\tfield['Type'] === 'file'\n\t\t\t\t||\n\t\t\t\tcustom\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst printableName = field['Name'] + ' ' + printablePrefix;\n\n\t\t\t\tif (names.indexOf(printableName) < 0)\n\t\t\t\t{\n\t\t\t\t\tconst printableField = BX.clone(field);\n\t\t\t\t\tconst printableTag = (field['Type'] === 'user') ? 'friendly' : 'printable';\n\n\t\t\t\t\tprintableField['Name'] = printableName;\n\t\t\t\t\tprintableField['Type'] = 'string';\n\t\t\t\t\tprintableField['SystemExpression'] = '{=Document:'+printableField['Id']+' > '+printableTag+'}';\n\t\t\t\t\tprintableField['Expression'] = '{{'+field['Name']+' > '+printableTag+'}}';\n\n\t\t\t\t\tfields.push(printableField);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (field['BaseType'] === 'date' || field['BaseType'] === 'datetime')\n\t\t\t{\n\t\t\t\tconst serverField = BX.clone(field);\n\t\t\t\tserverField['Name'] += ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_DATE_BY_SERVER');\n\t\t\t\tserverField['Type'] = 'string';\n\t\t\t\tserverField['SystemExpression'] = `{=Document:${serverField['Id']} > server}`;\n\t\t\t\tserverField['Expression'] = `{{${field['Name']} > server}}`;\n\n\t\t\t\tfields.push(serverField);\n\n\t\t\t\tconst responsibleField = BX.clone(field);\n\t\t\t\tresponsibleField['Name'] += ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_DATE_BY_RESPONSIBLE');\n\t\t\t\tresponsibleField['Type'] = 'string';\n\t\t\t\tresponsibleField['SystemExpression'] = `{=Document:${serverField['Id']} > responsible}`;\n\t\t\t\tresponsibleField['Expression'] = `{{${field['Name']} > responsible}}`;\n\n\t\t\t\tfields.push(responsibleField);\n\t\t\t}\n\t\t});\n\n\t\treturn fields;\n\t}\n}","import { SelectorContext, Condition, ConditionGroup } from 'bizproc.automation';\nimport { InlineSelector } from './inline-selector';\nimport { Field } from './types';\n\nexport class InlineSelectorCondition extends InlineSelector\n{\n\t#condition: Condition;\n\n\tconstructor(props: {\n\t\tcontext: SelectorContext,\n\t\tcondition: Condition,\n\t})\n\t{\n\t\tsuper(props);\n\n\t\tthis.#condition = props.condition;\n\t}\n\n\trenderTo(target: Element)\n\t{\n\t\tthis.targetInput = target;\n\t\tthis.menuButton = target;\n\n\t\tthis.parseTargetProperties();\n\t\tthis.bindTargetEvents();\n\t}\n\n\tfillGroups(): void\n\t{\n\t\tthis.fillFieldsGroups();\n\t}\n\n\tonMenuOpen(): void\n\t{\n\t\tthis.emit('onOpenMenu', {\n\t\t\tselector: this,\n\t\t\t// TODO - rename\n\t\t\tisMixedCondition: this.#isMixedConditionGroup(),\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field)\n\t{\n\t\tthis.emit('change', { field });\n\t}\n\n\t#isMixedConditionGroup(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.#condition\n\t\t\t&& this.#condition.parentGroup\n\t\t\t&& this.#condition.parentGroup.type === ConditionGroup.CONDITION_TYPE.Mixed\n\t\t);\n\t}\n\n\tgetFields(): Array<Field>\n\t{\n\t\treturn this.context.fields.map((field) => ({\n\t\t\t...field,\n\t\t\tObjectId: 'Document',\n\t\t}));\n\t}\n}","import { Tag } from 'main.core';\nimport { Field } from './types';\nimport { InlineSelector } from './inline-selector';\n\nexport class InlineSelectorHtml extends InlineSelector\n{\n\t#editorNode: ?BXHtmlEditor;\n\t#eventHandlers = {\n\t\t'OnEditorInitedAfter': this.#bindEditorHooks.bind(this),\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#unbindEvents();\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\t\tthis.#editorNode = targetInput.querySelector('.bx-html-editor');\n\t\tthis.menuButton = Tag.render`\n\t\t\t<span\n\t\t\t\tonclick=\"${this.openMenu.bind(this)}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-dotted\"\n\t\t\t></span>\n\t\t`;\n\n\t\tthis.parseTargetProperties();\n\t\tthis.bindTargetEvents()\n\n\t\ttargetInput.firstElementChild.appendChild(this.menuButton);\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tfor (const [name, handler] of Object.entries(this.#eventHandlers))\n\t\t{\n\t\t\tBX.addCustomEvent(name, handler);\n\t\t}\n\t}\n\n\t#unbindEvents(): void\n\t{\n\t\tfor (const [name, handler] of Object.entries(this.#eventHandlers))\n\t\t{\n\t\t\tBX.removeCustomEvent(name, handler);\n\t\t}\n\t}\n\n\t#bindEditorHooks(editor): void\n\t{\n\t\tif (editor.dom.cont !== this.#editorNode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet header = '';\n\t\tlet footer = '';\n\n\t\tconst cutHeader = (content: string, shouldSaveHeader: boolean = false) => {\n\t\t\treturn content.replace(/(^[\\s\\S]*?)(<body.*?>)/i, (str) => {\n\t\t\t\tif (shouldSaveHeader)\n\t\t\t\t{\n\t\t\t\t\theader = str;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t});\n\t\t};\n\n\t\tconst cutFooter = (content: string, shouldSaveFooter: boolean = false) => {\n\t\t\treturn content.replace(/(<\\/body>[\\s\\S]*?$)/i, (str) => {\n\t\t\t\tif (shouldSaveFooter)\n\t\t\t\t{\n\t\t\t\t\tfooter = str;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t});\n\t\t}\n\n\t\tBX.addCustomEvent(editor, 'OnParse', function (mode)\n\t\t{\n\t\t\tif (!mode)\n\t\t\t{\n\t\t\t\tthis.content = cutFooter(cutHeader(this.content, true), true);\n\t\t\t}\n\t\t});\n\n\t\tBX.addCustomEvent(editor, 'OnAfterParse', function (mode)\n\t\t{\n\t\t\tif (mode)\n\t\t\t{\n\t\t\t\tlet content = cutFooter(cutHeader(this.content));\n\n\t\t\t\tif (header !== '' && footer !== '')\n\t\t\t\t{\n\t\t\t\t\tcontent = header + content + footer;\n\t\t\t\t}\n\n\t\t\t\tthis.content = content;\n\t\t\t}\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field): void\n\t{\n\t\tconst insertText = field.Expression;\n\t\tconst editor = this.#getEditor();\n\n\t\tif (editor && editor.InsertHtml)\n\t\t{\n\t\t\tif (editor.synchro.IsFocusedOnTextarea())\n\t\t\t{\n\t\t\t\teditor.textareaView.Focus();\n\t\t\t\teditor.textareaView.WrapWith('', '', insertText);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\teditor.InsertHtml(insertText);\n\t\t\t}\n\t\t\teditor.synchro.Sync();\n\t\t}\n\t}\n\n\tonBeforeSave(): void\n\t{\n\t\tconst editor = this.#getEditor();\n\t\tif (editor && editor.SaveContent)\n\t\t{\n\t\t\teditor.SaveContent();\n\t\t}\n\t}\n\n\tonPopupResize()\n\t{\n\t\tconst editor = this.#getEditor();\n\t\tif (editor && editor.ResizeSceleton)\n\t\t{\n\t\t\teditor.ResizeSceleton();\n\t\t}\n\t}\n\n\t#getEditor(): ?BXHtmlEditor\n\t{\n\t\tif (this.#editorNode)\n\t\t{\n\t\t\tconst editorId = this.#editorNode.id.split('-');\n\t\t\treturn BXHtmlEditor.Get(editorId[editorId.length - 1]);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { SelectorContext } from 'bizproc.automation';\n\nexport class SaveStateCheckbox\n{\n\t#context: SelectorContext;\n\t#checkbox: Element;\n\t#needSync: boolean;\n\n\tconstructor(props: {\n\t\tcontext: SelectorContext,\n\t\tcheckbox: Element,\n\t\tneedSync: boolean,\n\t})\n\t{\n\t\tthis.#context = props.context;\n\t\tthis.#checkbox = props.checkbox;\n\t\tthis.#needSync = props.needSync;\n\n\t\tif (props.needSync)\n\t\t{\n\t\t\tconst category = 'save_state_checkbox';\n\t\t\tconst savedState = this.#context.get('userOptions').get(category, this.#getKey(), 'N');\n\t\t\tif (savedState === 'Y')\n\t\t\t{\n\t\t\t\tthis.#checkbox.checked = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.#needSync)\n\t\t{\n\t\t\tthis.#context.get('userOptions').set('save_state_checkboxes', this.#getKey(), this.#getValue());\n\t\t}\n\t}\n\n\t#getKey(): ?string\n\t{\n\t\treturn this.#checkbox.getAttribute('data-save-state-key');\n\t}\n\n\t#getValue(): string\n\t{\n\t\treturn this.#checkbox.checked ? 'Y'\t : 'N';\n\t}\n}","import { Type } from 'main.core';\nimport { InlineSelector } from './inline-selector';\n\nexport class UserSelector extends InlineSelector\n{\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\t\tthis.menuButton = targetInput;\n\n\t\tthis.fieldProperty = JSON.parse(targetInput.getAttribute('data-property'));\n\t\tif (!this.fieldProperty)\n\t\t{\n\t\t\tthis.context.useSwitcherMenu = false;\n\t\t}\n\n\t\tconst additionalUserFields = this.context.get('additionalUserFields');\n\t\tthis.userSelector = BX.Bizproc.UserSelector.decorateNode(\n\t\t\ttargetInput,\n\t\t\t{\n\t\t\t\tadditionalFields: Type.isArray(additionalUserFields) ? additionalUserFields : [],\n\t\t\t},\n\t\t);\n\t}\n\n\tdestroy()\n\t{\n\t\tsuper.destroy();\n\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.destroy();\n\t\t\tthis.userSelector = null;\n\t\t}\n\t}\n}","import { Type, Runtime, Tag, Dom, Event, Text, Loc } from 'main.core';\nimport { MenuManager } from 'main.popup';\nimport { SelectorContext, Helper } from 'bizproc.automation';\nimport { InlineSelector } from './inline-selector';\n\nexport class FileSelector extends InlineSelector\n{\n\tstatic TYPE = {\n\t\tNone: '',\n\t\tDisk: 'disk',\n\t\tFile: 'file',\n\t}\n\n\t#type: string = FileSelector.TYPE.None;\n\t#multiple: boolean = false;\n\t#required: boolean = false;\n\t#valueInputName: string = '';\n\t#typeInputName: string = '';\n\t#useDisk: boolean = false;\n\t#label: string = '';\n\t#labelFile: string = '';\n\t#labelDisk: string = '';\n\n\t#diskUploader: ?BX.Bizproc.Automation.DiskUploader = null;\n\n\t#diskControllerNode: ?HTMLDivElement = null;\n\t#fileItemsNode: ?HTMLSpanElement = null;\n\t#fileControllerNode: ?HTMLDivElement = null;\n\n\t#menuId: ?string;\n\n\tconstructor(props: { context: SelectorContext })\n\t{\n\t\tsuper(props);\n\n\t\tthis.context.set(\n\t\t\t'fileFields',\n\t\t\tthis.context.fields.filter(field => field.Type === 'file'),\n\t\t);\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.menu)\n\t\t{\n\t\t\tthis.menu.popupWindow.close();\n\t\t}\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\n\t\tconst selected = this.parseTargetProperties();\n\n\t\tthis.targetInput.appendChild(this.#createBaseNode());\n\t\tthis.#showTypeControlLayout(selected);\n\t\t// this.setFileFields()\n\t\t// this.createDom\n\t}\n\n\tparseTargetProperties()\n\t{\n\t\tlet config = JSON.parse(this.targetInput.getAttribute('data-config'));\n\t\tif (!Type.isPlainObject(config))\n\t\t{\n\t\t\tconfig = {};\n\t\t}\n\n\t\tthis.#type = config.type || FileSelector.TYPE.File;\n\t\tif (config.selected && !config.selected.length)\n\t\t{\n\t\t\tthis.#type = FileSelector.TYPE.None;\n\t\t}\n\n\t\tthis.#multiple = config.multiple || false;\n\t\tthis.#required = config.required || false;\n\t\tthis.#valueInputName = config.valueInputName || '';\n\t\tthis.#typeInputName = config.typeInputName || '';\n\t\tthis.#useDisk = config.useDisk || false;\n\t\tthis.#label = config.label || 'Attachment';\n\t\tthis.#labelFile = config.labelFile || 'File';\n\t\tthis.#labelDisk = config.labelDisk || 'Disk';\n\n\t\tif (config.selected && config.selected.length > 0)\n\t\t{\n\t\t\treturn Runtime.clone(config.selected);\n\t\t}\n\t}\n\n\t#createBaseNode(): HTMLDivElement\n\t{\n\t\tconst idSalt = Helper.generateUniqueId();\n\t\tlet fileRadio = null;\n\n\t\tconst fileTypeOptions = [];\n\n\t\tif (this.context.get('fileFields').length > 0)\n\t\t{\n\t\t\tfileRadio = Tag.render`\n\t\t\t\t<input\n\t\t\t\t\tid=\"type-1${idSalt}\"\n\t\t\t\t\tclass=\"bizproc-automation-popup-select-input\"\n\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\tname=\"${this.#typeInputName}\"\n\t\t\t\t\tvalue=\"${FileSelector.TYPE.File}\"\n\t\t\t\t\t${this.#type === FileSelector.TYPE.File ? 'checked' : ''}\n\t\t\t\t/>\n\t\t\t`;\n\t\t}\n\n\t\tconst diskFileRadio = Tag.render`\n\t\t\t<input\n\t\t\t\tid=\"type-2${idSalt}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-input\"\n\t\t\t\ttype=\"radio\"\n\t\t\t\tname=\"${this.#typeInputName}\"\n\t\t\t\tvalue=\"${FileSelector.TYPE.Disk}\"\n\t\t\t\t${this.#type === FileSelector.TYPE.Disk ? 'checked' : ''}\n\t\t\t/>\n\t\t`;\n\n\t\tfileTypeOptions.push(Tag.render`\n\t\t\t<span class=\"bizproc-automation-popup-settings-title\">${this.#label}:</span>\n\t\t`);\n\n\t\tif (fileRadio)\n\t\t{\n\t\t\tfileTypeOptions.push(fileRadio, Tag.render`\n\t\t\t\t<label\n\t\t\t\t\tclass=\"bizproc-automation-popup-settings-link\"\n\t\t\t\t\tfor=\"type-1${idSalt}\"\n\t\t\t\t\tonclick=\"${this.#onTypeChange.bind(this, FileSelector.TYPE.File)}\"\n\t\t\t\t>\n\t\t\t\t${this.#labelFile}\n\t\t\t\t</label>\n\t\t\t`);\n\t\t}\n\n\t\tfileTypeOptions.push(diskFileRadio, Tag.render`\n\t\t\t<label\n\t\t\t\tclass=\"bizproc-automation-popup-settings-link\"\n\t\t\t\tfor=\"type-2${idSalt}\"\n\t\t\t\tonclick=\"${this.#onTypeChange.bind(this, FileSelector.TYPE.Disk)}\"\n\t\t\t>\n\t\t\t${this.#labelDisk}\n\t\t\t</label>\n\t\t`);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-settings-block\">\n\t\t\t\t${fileTypeOptions}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#showTypeControlLayout(selected: Array): void\n\t{\n\t\tif (this.#type === FileSelector.TYPE.Disk)\n\t\t{\n\t\t\tthis.#hideFileControllerLayout();\n\t\t\tthis.#showDiskControllerLayout(selected);\n\t\t}\n\t\telse if (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tthis.#hideDiskControllerLayout();\n\t\t\tthis.#showFileControllerLayout(selected);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#hideFileControllerLayout();\n\t\t\tthis.#hideDiskControllerLayout();\n\t\t}\n\t}\n\n\t#showDiskControllerLayout(selected: Array): void\n\t{\n\t\tif (!this.#diskControllerNode)\n\t\t{\n\t\t\tthis.#diskControllerNode = Dom.create('div');\n\n\t\t\tthis.targetInput.appendChild(this.#diskControllerNode);\n\n\t\t\tconst diskUploader = this.#getDiskUploader();\n\t\t\tdiskUploader.layout(this.#diskControllerNode);\n\t\t\tdiskUploader.show(true);\n\n\t\t\tif (selected)\n\t\t\t{\n\t\t\t\tthis.addItems(selected);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.#diskControllerNode);\n\t\t}\n\t}\n\n\t#hideDiskControllerLayout(): void\n\t{\n\t\tif (this.#diskControllerNode)\n\t\t{\n\t\t\tDom.hide(this.#diskControllerNode);\n\t\t}\n\t}\n\n\t#showFileControllerLayout(selected: Array): void\n\t{\n\t\tif (!this.#fileControllerNode)\n\t\t{\n\t\t\tthis.#fileItemsNode = Dom.create('span');\n\t\t\tthis.#fileControllerNode = Dom.create('div', {children: [this.#fileItemsNode]});\n\t\t\tthis.targetInput.appendChild(this.#fileControllerNode);\n\t\t\tconst addButtonNode = Dom.create('a', {\n\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-link bizproc-automation-popup-settings-link-thin'},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ADD')\n\t\t\t});\n\n\t\t\tthis.#fileControllerNode.appendChild(addButtonNode);\n\n\t\t\tEvent.bind(addButtonNode, 'click', this.#onFileFieldAddClick.bind(this, addButtonNode));\n\n\t\t\tif (selected)\n\t\t\t{\n\t\t\t\tthis.addItems(selected);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.#fileControllerNode);\n\t\t}\n\t}\n\n\t#hideFileControllerLayout(): void\n\t{\n\t\tif (this.#fileControllerNode)\n\t\t{\n\t\t\tDom.hide(this.#fileControllerNode);\n\t\t}\n\t}\n\n\t#getDiskUploader(): BX.Bizproc.Automation.DiskUploader\n\t{\n\t\tif (!this.#diskUploader)\n\t\t{\n\t\t\tthis.#diskUploader = BX.Bizproc.Automation.DiskUploader.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\tmsg: {\n\t\t\t\t\t\t'diskAttachFiles' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_ATTACH_FILE'),\n\t\t\t\t\t\t'diskAttachedFiles' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_ATTACHED_FILES'),\n\t\t\t\t\t\t'diskSelectFile' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_SELECT_FILE'),\n\t\t\t\t\t\t'diskSelectFileLegend' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_SELECT_FILE_LEGEND'),\n\t\t\t\t\t\t'diskUploadFile' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_UPLOAD_FILE'),\n\t\t\t\t\t\t'diskUploadFileLegend' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_UPLOAD_FILE_LEGEND')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.#diskUploader.setMode(1);\n\t\t}\n\n\t\treturn this.#diskUploader;\n\t}\n\n\t#onTypeChange(newType: string): void\n\t{\n\t\tif (this.#type !== newType)\n\t\t{\n\t\t\tthis.#type = newType;\n\t\t\tthis.#showTypeControlLayout();\n\t\t}\n\t}\n\n\t#addFileItem(item)\n\t{\n\t\tif (this.#isFileItemSelected(item))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst node = this.#createFileItemNode(item);\n\t\tif (!this.#multiple)\n\t\t{\n\t\t\tDom.clean(this.#fileItemsNode)\n\t\t}\n\n\t\tthis.#fileItemsNode.appendChild(node);\n\t}\n\n\t#isFileItemSelected(item: object)\n\t{\n\t\treturn !!this.#fileItemsNode.querySelector(`[data-file-id=\"${item.id}\"]`);\n\t}\n\n\taddItems(items: Array<object>)\n\t{\n\t\tif (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tfor(const fileItem of items)\n\t\t\t{\n\t\t\t\tthis.#addFileItem(fileItem)\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis\n\t\t\t\t.#getDiskUploader()\n\t\t\t\t.setValues(\n\t\t\t\t\tFileSelector.#convertToDiskItems(items)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tstatic #convertToDiskItems(items: Array<object>)\n\t{\n\t\treturn items.map((item) => ({\n\t\t\tID: item['id'],\n\t\t\tNAME: item['name'],\n\t\t\tSIZE: item['size'],\n\t\t\tVIEW_URL: '',\n\t\t}));\n\t}\n\n\t#removeFileItem(item)\n\t{\n\t\tconst itemNode = this.#fileItemsNode.querySelector(`[data-file-id=\"${item.id}\"]`);\n\t\tif (itemNode)\n\t\t{\n\t\t\tthis.#fileItemsNode.removeChild(itemNode);\n\t\t}\n\t}\n\n\t#onFileFieldAddClick(addButtonNode, event)\n\t{\n\t\tconst self = this;\n\n\t\tif (!this.#menuId)\n\t\t{\n\t\t\tthis.#menuId = Helper.generateUniqueId();\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tthis.#menuId,\n\t\t\taddButtonNode,\n\t\t\tthis.context.get('fileFields').map((field) => ({\n\t\t\t\ttext: Text.encode(field.Name),\n\t\t\t\tfield,\n\t\t\t\tonclick(event, item)\n\t\t\t\t{\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\tself.onFieldSelect(field);\n\t\t\t\t}\n\t\t\t})),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: Dom.getPosition(addButtonNode)['width'] / 2,\n\t\t\t\tangle: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\toffset: 0,\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\t// this.#menu = MenuManager.currentItem;\n\t\tevent.preventDefault();\n\t}\n\n\tonFieldSelect(field)\n\t{\n\t\tthis.#addFileItem({\n\t\t\tid: field.Id,\n\t\t\texpression: field.Expression,\n\t\t\tname: field.Name,\n\t\t\ttype: FileSelector.TYPE.File\n\t\t});\n\t}\n\n\t#createFileItemNode(item)\n\t{\n\t\tconst itemField = this.context.get('fileFields').find(field => field.Expression === item.expression);\n\t\tconst label = itemField?.Name || '';\n\n\t\treturn Tag.render`\n\t\t\t<span\n\t\t\t\tclass=\"bizproc-automation-popup-autocomplete-item\"\n\t\t\t\tdata-file-id=\"${item.id}\"\n\t\t\t\tdata-file-expression=\"${item.expression}\"\n\t\t\t>\n\t\t\t\t<span class=\"bizproc-automation-popup-autocomplete-name\">${label}</span>\n\t\t\t\t<span\n\t\t\t\t\tclass=\"bizproc-automation-popup-autocomplete-delete\"\n\t\t\t\t\tonclick=\"${this.#removeFileItem.bind(this, item)}\"\n\t\t\t\t></span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonBeforeSave()\n\t{\n\t\tlet ids = [];\n\t\tif (this.#type === FileSelector.TYPE.Disk)\n\t\t{\n\t\t\tids = this.#getDiskUploader().getValues();\n\t\t}\n\t\telse if (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tids = (\n\t\t\t\tArray.from(this.#fileItemsNode.childNodes)\n\t\t\t\t\t.map(node => node.getAttribute('data-file-expression'))\n\t\t\t\t\t.filter(id => id !== '')\n\t\t\t);\n\t\t}\n\n\t\tfor (const id of ids)\n\t\t{\n\t\t\tthis.targetInput.appendChild(Tag.render`\n\t\t\t\t<input\n\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\tname=\"${this.#valueInputName + (this.#multiple ? '[]' : '')}\"\n\t\t\t\t\tvalue=\"${id}\"\n\t\t\t\t/>\n\t\t\t`);\n\t\t}\n\t}\n}\n","import { Event, Loc } from 'main.core';\nimport { InlineSelector } from './inline-selector';\n\nexport class TimeSelector extends InlineSelector\n{\n\t#clockInstance;\n\n\tdestroy()\n\t{\n\t\tif (this.#clockInstance)\n\t\t{\n\t\t\tthis.#clockInstance.closeWnd();\n\t\t}\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput; //this.targetInput = Runtime.clone(targetInput);\n\n\t\tconst datetime = new Date();\n\t\tdatetime.setHours(0, 0, 0, 0);\n\t\tdatetime.setTime(datetime.getTime() + this.#getCurrentTime() * 1000);\n\n\t\tthis.targetInput.value = this.constructor.#formatTime(datetime);\n\n\t\tEvent.bind(targetInput, 'click', this.showClock.bind(this));\n\t}\n\n\tshowClock(): void\n\t{\n\t\tif (!this.#clockInstance)\n\t\t{\n\t\t\tthis.#clockInstance = new BX.CClockSelector({\n\t\t\t\tstart_time: this.#getCurrentTime(),\n\t\t\t\tnode: this.targetInput,\n\t\t\t\tcallback: this.#onTimeSelect.bind(this),\n\t\t\t});\n\t\t}\n\n\t\tthis.#clockInstance.Show();\n\t}\n\n\t#onTimeSelect(time): void\n\t{\n\t\tthis.targetInput.value = time;\n\t\tBX.fireEvent(this.targetInput, 'change');\n\t\tthis.#clockInstance.closeWnd();\n\t}\n\n\t#getCurrentTime(): number\n\t{\n\t\treturn this.#convertTimeToSeconds(this.targetInput.value);\n\t}\n\n\t#convertTimeToSeconds(time: string): number\n\t{\n\t\tconst timeParts = time.split(/[\\s:]+/).map(part => parseInt(part));\n\n\t\tlet [hours, minutes] = timeParts;\n\t\tif (timeParts.length === 3)\n\t\t{\n\t\t\tconst period = timeParts[2];\n\n\t\t\tif (period === 'pm' && hours < 12)\n\t\t\t{\n\t\t\t\thours += 12;\n\t\t\t}\n\t\t\telse if (period === 'am' && hours === 12)\n\t\t\t{\n\t\t\t\thours = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn hours * 3600 + minutes * 60;\n\t}\n\n\tstatic #formatTime(datetime: Date): string\n\t{\n\t\tconst getFormat = (formatId) => (\n\t\t\tBX.date.convertBitrixFormat(Loc.getMessage(formatId)).replace(/:?\\s*s/, '')\n\t\t);\n\n\t\tconst dateFormat = getFormat('FORMAT_DATE');\n\t\tconst timeFormat = getFormat('FORMAT_DATETIME').replace(dateFormat, '').trim();\n\n\t\treturn BX.date.format(timeFormat, datetime);\n\t}\n}","import { Type, Loc, Event, Dom, Text } from 'main.core';\nimport { Helper } from './helper';\nimport { DelayInterval } from './delay-interval';\nimport { MenuManager } from 'main.popup';\n\nexport class DelayIntervalSelector\n{\n\tbasisFields: Array;\n\tonchange: () => void;\n\tlabelNode;\n\tuseAfterBasis;\n\tminLimitH;\n\n\tdelay;\n\n\tconstructor(options)\n\t{\n\t\tthis.basisFields = [];\n\t\tthis.onchange = null;\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.labelNode = options.labelNode;\n\t\t\tthis.useAfterBasis = options.useAfterBasis;\n\n\t\t\tif (Type.isArray(options.basisFields))\n\t\t\t{\n\t\t\t\tthis.basisFields = options.basisFields;\n\t\t\t}\n\t\t\tthis.onchange = options.onchange;\n\t\t\tthis.minLimitM = options.minLimitM;\n\t\t}\n\t}\n\n\tinit(delay)\n\t{\n\t\tthis.delay = delay;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t\tthis.prepareBasisFields();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (this.delay && this.labelNode)\n\t\t{\n\t\t\tthis.labelNode.textContent = this.delay.format(\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\t\tthis.basisFields\n\t\t\t);\n\t\t}\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', BX.delegate(this.onLabelClick, this));\n\t\t}\n\t}\n\n\tonLabelClick(event)\n\t{\n\t\tthis.showDelayIntervalPopup();\n\t\tevent.preventDefault();\n\t}\n\n\tshowDelayIntervalPopup()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" }\n\t\t});\n\n\t\tconst radioNow = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid + \"now\",\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: 'now',\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.isNow())\n\t\t{\n\t\t\tradioNow.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst labelNow = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid + \"now\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_BASIS_NOW' : 'BIZPROC_AUTOMATION_CMP_AT_ONCE_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tconst labelNowHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP_2' : 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP')\n\t\t\t}\n\t\t});\n\t\tlabelNow.appendChild(labelNowHelpNode);\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioNow, labelNow]\n\t\t}));\n\n\t\tform.appendChild(this.createAfterControlNode());\n\n\t\tif (this.basisFields.length > 0)\n\t\t{\n\t\t\tform.appendChild(this.createBeforeControlNode());\n\t\t\tform.appendChild(this.createInControlNode());\n\t\t}\n\n\t\tconst workTimeRadio = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\",\n\t\t\t\tid: uid + \"worktime\",\n\t\t\t\tname: \"worktime\",\n\t\t\t\tvalue: '1',\n\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tchecked: delay.workTime\n\t\t\t}\n\t\t});\n\n\t\tconst workTimeHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_WORKTIME_HELP_2')\n\t\t\t}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\tchildren: [\n\t\t\t\tworkTimeRadio,\n\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-lbl\",\n\t\t\t\t\t\tfor: uid + \"worktime\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_WORK_TIME')\n\t\t\t\t}),\n\t\t\t\tworkTimeHelpNode\n\t\t\t]\n\t\t}));\n\n\t\tconst self = this;\n\t\t//init modern Help tips\n\t\tBX.UI.Hint.init(form);\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), this.labelNode, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 20,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: 'webform-button webform-button-create bizproc-automation-button-left',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\t\t\t\t\tself.saveFormData(formData['data']);\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tif (self.fieldsMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldsMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tif (self.valueTypeMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.valueTypeMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tsaveFormData(formData)\n\t{\n\t\tif (formData['type'] === 'now')\n\t\t{\n\t\t\tthis.delay.setNow();\n\t\t}\n\t\telse if (formData['type'] === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tthis.delay.setType(DelayInterval.DELAY_TYPE.In);\n\t\t\tthis.delay.setValue(0);\n\t\t\tthis.delay.setValueType('i');\n\t\t\tthis.delay.setBasis(formData['basis_in']);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.delay.setType(formData['type']);\n\t\t\tthis.delay.setValue(formData['value_' + formData['type']]);\n\t\t\tthis.delay.setValueType(formData['value_type_'+formData['type']]);\n\n\t\t\tif (formData['type'] === DelayInterval.DELAY_TYPE.After)\n\t\t\t{\n\t\t\t\tif (this.useAfterBasis)\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(formData['basis_after']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis.minLimitM > 0\n\t\t\t\t\t&& this.delay.basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t\t\t&& this.delay.valueType === 'i'\n\t\t\t\t\t&& this.delay.value < this.minLimitM\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('BIZPROC_AUTOMATION_DELAY_MIN_LIMIT_LABEL')\n\t\t\t\t\t});\n\t\t\t\t\tthis.delay.setValue(this.minLimitM);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.delay.setBasis(formData['basis_before']);\n\t\t\t}\n\t\t}\n\n\t\tthis.delay.setWorkTime(formData['worktime']);\n\t\tthis.setLabelText();\n\n\t\tif (this.onchange)\n\t\t{\n\t\t\tthis.onchange(this.delay);\n\t\t}\n\t}\n\n\tcreateAfterControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioAfter = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.After,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.After && delay.value > 0)\n\t\t{\n\t\t\tradioAfter.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_after',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.After && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelAfter = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_after')\n\t\t\t]\n\t\t});\n\n\t\tif (this.useAfterBasis)\n\t\t{\n\t\t\tlabelAfter.appendChild(Dom.create('span', {\n\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t}));\n\n\t\t\tlet basisField = this.getBasisField(delay.basis, true);\n\t\t\tlet basisValue = delay.basis;\n\t\t\tif (!basisField)\n\t\t\t{\n\t\t\t\tbasisField = this.getBasisField(DelayInterval.BASIS_TYPE.CurrentDateTime, true);\n\t\t\t\tbasisValue = basisField.SystemExpression;\n\t\t\t}\n\n\t\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: \"basis_after\",\n\t\t\t\t\tvalue: basisValue\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t\t},\n\t\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick(event)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onBasisClick(event, this, function(field)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t}, DelayInterval.DELAY_TYPE.After);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(beforeBasisValueNode);\n\t\t\tlabelAfter.appendChild(beforeBasisNode);\n\t\t}\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst afterHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_AFTER_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(afterHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioAfter, labelAfter]\n\t\t});\n\t}\n\n\tcreateBeforeControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioBefore = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.Before,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tradioBefore.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_before',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.Before && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelBefore = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_before'),\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_before\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t(field) => {\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tDelayInterval.DELAY_TYPE.Before\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tlabelBefore.appendChild(beforeBasisValueNode);\n\t\tlabelBefore.appendChild(beforeBasisNode);\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst beforeHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_BEFORE_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelBefore.appendChild(beforeHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioBefore, labelBefore]\n\t\t});\n\t}\n\n\tcreateInControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioIn = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.In,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tradioIn.setAttribute('checked', 'checked');\n\t\t}\n\n\n\t\tconst labelIn = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst inBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_in\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst inBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tfield => {\n\t\t\t\t\t\t\tinBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tinBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tlabelIn.appendChild(inBasisValueNode);\n\t\tlabelIn.appendChild(inBasisNode);\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst helpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_IN_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelIn.appendChild(helpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioIn, labelIn]\n\t\t});\n\t}\n\n\tcreateValueTypeSelector(name)\n\t{\n\t\tconst delay = this.delay;\n\t\tconst labelTexts = {\n\t\t\ti: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\th: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\td: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D')\n\t\t};\n\n\t\tconst label = Dom.create('label', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-link'},\n\t\t\ttext: labelTexts[delay.valueType],\n\t\t});\n\n\t\tconst input = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tname: name\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(label, 'click', this.onValueTypeSelectorClick.bind(this, label, input));\n\n\t\treturn Dom.create('span', {\n\t\t\tchildren: [label, input]\n\t\t});\n\t}\n\n\tonValueTypeSelectorClick(label, input)\n\t{\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst handler = function(event, item)\n\t\t{\n\t\t\tthis.popupWindow.close();\n\t\t\tinput.value = item.valueId;\n\t\t\tlabel.textContent = item.text;\n\t\t};\n\n\t\tconst menuItems = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\t\tvalueId: 'i',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\t\tvalueId: 'h',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D'),\n\t\t\t\tvalueId: 'd',\n\t\t\t\tonclick: handler\n\t\t\t}\n\t\t];\n\n\t\tMenuManager.show(\n\t\t\tuid,\n\t\t\tlabel,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 25,\n\t\t\t\tangle: { position: 'top'},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.valueTypeMenu = MenuManager.currentItem;\n\t}\n\n\tonBasisClick(event, labelNode, callback, delayType)\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (delayType === DelayInterval.DELAY_TYPE.After)\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (\n\t\t\t\tdelayType !== DelayInterval.DELAY_TYPE.After\n\t\t\t\t&& this.basisFields[i]['Id'].indexOf('DATE_CREATE') > -1\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Text.encode(this.basisFields[i].Name),\n\t\t\t\tfield: this.basisFields[i],\n\t\t\t\tonclick(e, item)\n\t\t\t\t{\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(item.field || item.options.field);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tlet menuId = labelNode.getAttribute('data-menu-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tlabelNode.setAttribute('data-menu-id', menuId);\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tmenuId,\n\t\t\tlabelNode,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (BX.pos(labelNode)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.fieldsMenu = MenuManager.currentItem;\n\t}\n\n\tgetBasisField(basis, system)\n\t{\n\t\tif (system && (basis === DelayInterval.BASIS_TYPE.CurrentDateTime || basis === DelayInterval.BASIS_TYPE.CurrentDateTimeLocal))\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t};\n\t\t}\n\t\tif (system && basis === DelayInterval.BASIS_TYPE.CurrentDate)\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t};\n\t\t}\n\n\t\tlet field = null;\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (basis === this.basisFields[i].SystemExpression)\n\t\t\t{\n\t\t\t\tfield = this.basisFields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn field;\n\t}\n\n\tprepareBasisFields()\n\t{\n\t\tconst fields = [];\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tconst fld = this.basisFields[i];\n\t\t\tif (\n\t\t\t\tfld['Id'].indexOf('DATE_MODIFY') < 0\n\t\t\t\t&& fld['Id'].indexOf('EVENT_DATE') < 0\n\t\t\t\t&& fld['Id'].indexOf('BIRTHDATE') < 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tfields.push(fld);\n\t\t\t}\n\t\t}\n\n\t\tthis.basisFields = fields;\n\t}\n}","import { Type, clone } from \"main.core\";\nimport { EventEmitter, BaseEvent } from \"main.core.events\";\n\nexport class BaseContext extends EventEmitter\n{\n\t#values: Object<string, any>;\n\n\tconstructor(defaultValue: Object<string, any>)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Bizproc.Automation.Context');\n\t\tif (Type.isPlainObject(defaultValue))\n\t\t{\n\t\t\tthis.#values = defaultValue;\n\t\t}\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new BaseContext(clone(this.#values));\n\t}\n\n\tgetValues(): object\n\t{\n\t\treturn this.#values;\n\t}\n\n\tset(name: string, value: any): this\n\t{\n\t\tconst isValueChanged = this.has(name);\n\t\tthis.#values[name] = value;\n\t\tthis.emit(isValueChanged ? 'valueChanged' : 'valueAdded', {name, value})\n\n\t\treturn this;\n\t}\n\n\tget(name: string): any\n\t{\n\t\treturn this.#values[name];\n\t}\n\n\thas(name: string): boolean\n\t{\n\t\treturn this.#values.hasOwnProperty(name);\n\t}\n\n\tsubsribeValueChanges(name: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.subscribe('valueChanged', (event) => {\n\t\t\tif (event.data.name === name)\n\t\t\t{\n\t\t\t\tlistener(event);\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n}","import { Type } from 'main.core';\nimport { BaseContext } from './base-context';\nimport { Field } from '../selectors/types';\n\nexport class SelectorContext extends BaseContext\n{\n\tconstructor(props: {\n\t\tfields: Array<Field>,\n\t\tuseSwitcherMenu: boolean,\n\t\trootGroupTitle: string,\n\t})\n\t{\n\t\tsuper(props);\n\t}\n\n\tget fields(): Array<Field>\n\t{\n\t\tconst fields = this.get('fields');\n\n\t\treturn Type.isArray(fields) ? fields : [];\n\t}\n\n\tget useSwitcherMenu(): boolean\n\t{\n\t\treturn Type.isBoolean(this.get('useSwitcherMenu')) ? this.get('useSwitcherMenu') : false;\n\t}\n\n\tset useSwitcherMenu(value: boolean)\n\t{\n\t\tthis.set('useSwitcherMenu', value);\n\t}\n\n\tget rootGroupTitle(): string\n\t{\n\t\treturn this.get('rootGroupTitle') ?? '';\n\t}\n}","import { Type, Runtime } from \"main.core\";\nimport { BaseContext } from \"./base-context\";\nimport { Document, UserOptions, Tracker } from \"bizproc.automation\";\n\nexport class Context extends BaseContext\n{\n\tconstructor(props: {\n\t\tdocument: Document,\n\t\tsignedDocument: string,\n\t\tajaxUrl: string,\n\t\tavailableRobots?: Array<Object>,\n\t\tavailableTriggers?: Array<Object>,\n\t\tcanManage?: boolean,\n\t\tcanEdit?: boolean,\n\t\tuserOptions?: UserOptions,\n\t\ttracker?: Tracker,\n\n\t\tbizprocEditorUrl?: string,\n\t\tconstantsEditorUrl?: string,\n\t\tparametersEditorUrl?: string,\n\n\t\tmarketplaceRobotCategory?: string,\n\t})\n\t{\n\t\tsuper(props);\n\t}\n\n\tclone(): this\n\t{\n\t\t// TODO - clone Tracker object when the corresponding method appears\n\t\treturn (new Context(Runtime.clone(this.getValues())))\n\t\t\t.set('document', this.document.clone())\n\t\t\t.set('userOptions', this.userOptions?.clone())\n\t\t;\n\t}\n\n\tget document(): ?Document\n\t{\n\t\treturn this.get('document');\n\t}\n\n\tget signedDocument(): string\n\t{\n\t\treturn this.get('signedDocument') ?? '';\n\t}\n\n\tget ajaxUrl(): string\n\t{\n\t\treturn this.get('ajaxUrl') ?? '';\n\t}\n\n\tget availableRobots(): Array<Object>\n\t{\n\t\tconst availableRobots = this.get('availableRobots');\n\t\tif (Type.isArray(availableRobots))\n\t\t{\n\t\t\treturn availableRobots;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget availableTriggers(): Array<Object>\n\t{\n\t\tconst availableTriggers = this.get('availableTriggers');\n\t\tif (Type.isArray(availableTriggers))\n\t\t{\n\t\t\treturn availableTriggers;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget canManage(): boolean\n\t{\n\t\tconst canManage = this.get('canManage');\n\n\t\treturn Type.isBoolean(canManage) && canManage;\n\t}\n\n\tget canEdit(): boolean\n\t{\n\t\tconst canEdit = this.get('canEdit');\n\n\t\treturn Type.isBoolean(canEdit) && canEdit;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.get('userOptions');\n\t}\n\n\tget tracker(): ?Tracker\n\t{\n\t\treturn this.get('tracker');\n\t}\n\n\tset tracker(tracker: Tracker)\n\t{\n\t\tthis.set('tracker', tracker);\n\t}\n\n\tget bizprocEditorUrl(): ?string\n\t{\n\t\treturn this.get('bizprocEditorUrl');\n\t}\n\n\tget constantsEditorUrl(): ?string\n\t{\n\t\treturn this.get('constantsEditorUrl');\n\t}\n\n\tget parametersEditorUrl(): ?string\n\t{\n\t\treturn this.get('parametersEditorUrl');\n\t}\n\n\tgetAvailableTrigger(code: string): ?Object\n\t{\n\t\treturn this.availableTriggers.find(trigger => trigger['CODE'] === code);\n\t}\n}","import TemplatesScheme from './templates-scheme';\nexport { TemplateScope } from './template-scope';\nexport { TriggerManager } from './trigger-manager';\nexport { Trigger } from './trigger';\nexport { Template } from './template';\nexport { Robot } from './robot';\nexport { UserOptions } from './user-options';\nexport { Document } from './document/document';\nexport { ViewMode } from './view-mode';\nexport { ConditionGroup } from './condition/condition-group';\nexport { ConditionGroupSelector } from './selectors/condition-group-selector';\nexport { Condition } from './condition/condition';\nexport { Designer } from './designer';\nexport * from './tracker/tracker';\nexport * from './workflow/types';\nexport { Manager as SelectorManager} from './selectors/manager';\nexport { InlineSelector } from './selectors/inline-selector';\nexport { InlineSelectorCondition } from './selectors/inline-selector-condition';\nexport { InlineSelectorHtml } from './selectors/inline-selector-html';\nexport { SaveStateCheckbox } from './selectors/save-state-checkbox';\nexport { UserSelector } from './selectors/user-selector';\nexport { FileSelector } from './selectors/file-selector';\nexport { TimeSelector } from './selectors/time-selector';\nexport { DelayInterval } from './delay-interval';\nexport { DelayIntervalSelector } from './delay-interval-selector';\nexport { HelpHint } from './help-hint';\nexport { SelectorContext } from './context/selector-context';\nimport { Context } from './context/context';\n\nexport { Helper } from './helper';\n\nimport { Reflection } from \"main.core\";\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport './css/style.css'\n\nexport {\n\tTemplatesScheme,\n\tContext,\n}\n\nlet contextInstance: ?Context;\n\nexport function getGlobalContext(): Context\n{\n\tif (contextInstance instanceof Context)\n\t{\n\t\treturn contextInstance;\n\t}\n\n\tthrow new Error('Context is not initialized yet');\n}\n\nexport function tryGetGlobalContext(): ?Context\n{\n\ttry\n\t{\n\t\treturn getGlobalContext();\n\t}\n\tcatch (error)\n\t{\n\t\treturn null;\n\t}\n}\n\nexport function setGlobalContext(context: Context): Context\n{\n\tif (context instanceof Context)\n\t{\n\t\tcontextInstance = context;\n\t}\n\telse\n\t{\n\t\tthrow new Error('Unsupported Context');\n\t}\n\n\treturn context;\n}"],"names":["TemplateScope","rawTemplateScope","DocumentType","Type","isNil","Category","Id","Status","hasCategory","isNull","TemplatesScheme","scheme","isArray","forEach","rawScope","scope","push","documentTypes","Map","set","getDocumentType","Array","from","values","documentType","documentCategories","category","getDocumentCategory","documentCategory","takenStatuses","Set","predicate","shouldBeTaken","has","getDocumentStatus","add","map","generator","ViewMode","mode","name","value","defaultValue","hasOwnProperty","getAll","includes","none","Trigger","setEventNamespace","draft","ConditionGroup","data","viewMode","clone","isPlainObject","Condition","edit","createNode","node","parentNode","replaceChild","getGlobalContext","canEdit","triggerName","code","getCode","trigger","availableTriggers","find","NAME","isString","rules","log","tracker","getTriggerLog","getId","status","condition","flag","userId","wrapperClass","isEdit","settingsBtn","copyBtn","Dom","create","attrs","className","text","Loc","getMessage","Event","bind","onCopyButtonClick","getLogStatus","TrackingStatus","COMPLETED","document","getPreviousStatusIdList","getStatusId","getName","containerClass","div","children","registerItem","deleteBtn","onDeleteButtonClick","appendChild","onSettingsButtonClick","button","HelpHint","showNoPermissionsHint","isManage","emit","event","stopPropagation","initData","serialize","init","query","getData","queryString","match","toLowerCase","indexOf","object","onbxdragstart","BX","proxy","dragStart","onbxdrag","dragMove","onbxdragstop","dragStop","onbxdraghover","dragOver","jsDD","registerObject","registerDest","undefined","unregisterObject","unregisterDest","proxy_context","stopCurrentDrag","itemWidth","offsetWidth","cloneNode","style","position","classList","width","body","x","y","left","top","destination","remove","type","getAttribute","querySelector","window","isCopy","ctrlKey","metaKey","copyTrigger","parent","statusId","thisColumn","insertBefore","moveTo","skipInsert","removeChild","APPLY_RULES","items","length","triggerData","RETURN","EventEmitter","querySelectorAll","element","bindToNode","showHint","hideHint","popupHint","bindElement","isSameNode","rawText","Text","encode","util","nl2br","isStringFilled","PopupWindow","lightShadow","autoHide","darkMode","offsetLeft","offsetTop","bindOptions","events","onPopupClose","destroy","content","html","setAngle","offset","show","showAngleHint","timeout","clearTimeout","UI","Hint","createInstance","popupParameters","height","closeByEsc","angle","getPosition","close","hide","setTimeout","Helper","JSON","stringify","i","v","fields","field","Designer","dialog","robotSettingsDialog","robot","triggerSettingsDialog","TriggerManager","triggersContainerNode","isNone","TRIGGERS","initButtons","initTriggers","markModified","columnNode","addCustomEvent","onRestAppInstall","clean","subscribeTriggerEvents","insertTriggerNode","subscribe","openTriggerSettingsDialog","deleteTrigger","onSearch","createAddButton","manage","deleteButtons","addClass","removeClass","containerNode","self","click","onAddButtonClick","context","onMenuClick","item","addTrigger","popupWindow","menuItems","availableTrigger","CODE","createAppTriggerMenuItem","DOCUMENT_STATUS","onclick","MenuManager","generateUniqueId","target","changeTrigger","e","getRootMenuWindow","itemName","APP_ID","Reflection","getClass","delimiter","rest","Marketplace","open","PLACEMENT","get","callback","call","markDeleted","splice","unregisterItem","documentStatus","triggerNode","listNode","filter","deleted","modified","getInstance","getTriggerSettingsDialog","popup","formName","form","props","renderConditionSettings","iconHelp","title","getTriggerName","getAvailableTrigger","getApplyRules","getRandom","hookLinkTextarea","placeholder","readonly","select","url","location","protocol","host","Uri","addParam","replace","getRawType","onCustomEvent","canSetExecuteBy","renderExecuteByControl","renderAllowBackwardsControl","setTriggerSettingsDialog","triggerManager","titleBar","createChangeTriggerTitleBar","closeIcon","draggable","restrict","overlay","destroySettingsDialogControls","buttons","PopupWindowButton","formData","ajax","prepareForm","setName","setApplyRules","form_id","STATUS","LINE_NUMBER","config_id","setConditionSettingsFromForm","setAllowBackwards","setExecuteBy","runAction","analyticsLabel","reInit","PopupWindowButtonLink","createTextNode","onChangeTriggerClick","conditionGroup","getCondition","conditionSelector","ConditionGroupSelector","getFields","selector","Bizproc","FieldType","renderControl","getResponsibleUserExpression","getExecuteBy","checked","isBackwardsAllowed","formFields","setCondition","createFromForm","installed","eventResult","redirect","method","dataType","ajaxUrl","ajax_action","document_signed","signedDocument","onsuccess","response","settingsDialogControls","controlNodes","control","role","UserSelector","decorateNode","isFunction","result","exists","triggers","getListByDocumentStatus","getReturnProperties","property","ObjectId","Name","ObjectName","Expression","SystemExpression","propertyId","properties","Document","options","rawDocumentType","documentId","categoryId","statusList","findIndex","STATUS_ID","documentFields","Runtime","getCurrentStatusId","index","slice","newStatusId","isArrayFilled","DelayInterval","params","BASIS_TYPE","CurrentDateTime","DELAY_TYPE","After","setType","setValue","setValueType","setBasis","setWorkTime","setLocalTime","valueType","basis","workTime","localTime","Before","In","parseInt","basisFields","workerExpression","CurrentDate","isSystemBasis","s","isNow","days","hours","minutes","fn","worker","emptyText","str","prefix","getFormattedPeriodLabel","fieldSuffix","label","labelIndex","labels","getPeriodLabels","CurrentDateTimeLocal","intervalString","toString","h","d","substring","fnArgs","split","trim","re","exec","found","period","WorkflowStatus","TrackingEntry","TRIGGER_ACTIVITY_TYPE","entryType","getAllActivityTypes","entryWorkflowStatus","getAllWorkflowStatuses","UNKNOWN_ACTIVITY_TYPE","EXECUTE_ACTIVITY_TYPE","CLOSE_ACTIVITY_TYPE","CANCEL_ACTIVITY_TYPE","FAULT_ACTIVITY_TYPE","CUSTOM_ACTIVITY_TYPE","REPORT_ACTIVITY_TYPE","ATTACHED_ENTITY_TYPE","ERROR_ACTIVITY_TYPE","DEBUG_ACTIVITY_TYPE","DEBUG_AUTOMATION_TYPE","DEBUG_DESIGNER_TYPE","DEBUG_LINK_TYPE","typeId","CREATED","RUNNING","SUSPENDED","TERMINATED","RobotEntry","entries","WAITING","entry","addEntry","id","datetime","workflowStatus","errors","note","notes","TriggerEntry","isTriggerEntry","TrackingEntryBuilder","workflowId","logEntry","Object","assign","isNumber","isKnownActivityType","isKnownWorkflowStatus","String","Tracker","addLogs","logEntryBuilder","rawEntry","setLogEntry","build","addTriggerEntry","addRobotEntry","robotEntry","isRobotRunning","isWorkflowCompleted","isCurrentStatus","isRobotRunningAtAnotherStatus","isRobotRunningAndCurrentWorkflowCompleted","documentSigned","DATA","LOG","Robot","template","isFrameMode","clonedRobot","robotData","generateName","Delay","getDelayInterval","other","CONDITION_TYPE","Mixed","Properties","getProperties","getRobotLog","DelayName","hasClass","isActive","setProperty","deleteButton","getProperty","isSelected","selectNode","unselectNode","targetLabel","targetNode","isView","viewData","responsibleLabel","labelText","robots","getReturnFieldsDescription","getTitle","textContent","setAttribute","responsibleUrl","href","responsibleId","delayLabel","format","isExecuteAfterPrevious","delayNode","statusNode","subscribeOnce","isBindedToNode","delayNotes","getDelayNotes","join","AUTOCOMPLETED","getLogErrors","titleClassName","clipTitle","onTitleEditClick","lastChild","deleteRobot","openRobotSettingsDialog","copiedRobot","robotTitle","newTitle","Template","copyRobotTo","getNextRobot","preventDefault","nameNode","elements","fullTitle","arrTitle","lastWord","delay","ExecuteAfterPrevious","draggableItem","stub","droppableItem","droppableColumn","templateNode","beforeRobot","insertRobot","insertRobotNode","getDescriptionTitle","description","getRobotDescription","isObject","hasReturnProperties","hasAdditionalResultProperties","some","addProperty","fieldId","appendPropertyMods","printableTag","Options","expression","usages","Constant","Variable","Parameter","GlobalConstant","GlobalVariable","Activity","collectExpressions","conditions","collectParsedExpressions","systemExpressionRegExp","RegExp","SYSTEM_EXPRESSION_PATTERN","groups","parsedUsage","activityRegExp","collectUsages","objectsData","getConstants","getVariables","globalConstants","globalVariables","getParameters","getSerializedRobots","size","source","key","searchInSource","getRobotById","getReturnProperty","Math","random","UserOptions","storedValue","userOptions","save","constants","variables","templateContainerNode","delayMinLimitM","CONSTANTS","PARAMETERS","VARIABLES","markExternalModified","fromRaw","initRobots","updateTopButtonsVisibility","isExternalModified","ROBOTS","selectedRobots","serialized","ID","isNaN","createExternalLocker","getTemplateId","createConstantsEditButton","createParametersEditButton","createExternalEditTemplateButton","createManageModeButton","enableManageMode","disableManageMode","anchor","bizprocEditorUrl","onExternalEditTemplateButtonClick","canManage","manageButton","cursor","onManageModeButtonClick","manageButtonNode","constantsEditorUrl","parametersEditorUrl","onUnsetExternalModifiedClick","onExternalModifiedSearch","employee","client","ads","availableRobots","menuItemClickHandler","addRobot","ADD_MENU_CATEGORY","settings","categories","j","menuId","rootMenuItems","pos","maxHeight","changeRobot","InfoHelper","templateId","openBizprocEditor","intoRaw","Title","parentRobot","isEqual","robotNode","beforeNode","saveCallback","getRobotSettingsDialog","setRobotSettingsDialog","renderDelaySettings","hasBrokenLink","renderBrokenLinkAlert","getCategoryId","document_status","robot_json","toJsonString","form_name","dialogRows","showRobotSettingsPopup","popupMinWidth","popupWidth","initRobotSettingsControls","hasTitle","createChangeRobotTitleBar","me","resizable","minWidth","minHeight","destroyRobotSettingsControls","onPopupResize","onResizeRobotSettings","onPopupResizeEnd","getWidth","isNewRobot","saveRobotSettings","delegate","buttonNode","onChangeRobotClick","robotSettingsControls","initRobotSettingsControl","controlNode","controlProps","SelectorContext","useSwitcherMenu","rootGroupTitle","needSync","checkbox","SelectorManager","SELECTOR_ROLE_USER","fieldProperty","parse","SELECTOR_ROLE_FILE","createSelectorByRole","SELECTOR_ROLE_SAVE_STATE","renderTo","onFieldSelect","addConstant","addParameter","onBeforeSave","idSalt","delayTypeNode","delayValueNode","delayValueTypeNode","delayBasisNode","delayWorkTimeNode","delayIntervalLabelNode","docFields","minLimitM","delayIntervalSelector","DelayIntervalSelector","labelNode","onchange","useAfterBasis","executeAfterPreviousBlock","hasTemplate","executeAfterPreviousCheckbox","setDelayInterval","setExecuteAfterPrevious","onOpenMenu","alert","message","display","btnNode","onBeforeSaveRobotSettings","form_data_json","form_data","SUCCESS","updateData","setDelaySettingsFromForm","ERRORS","externalModified","keys","constant","generatePropertyId","getConstant","Description","param","parameter","getParameter","variable","existsList","robotUsages","usage","eventName","listener","unsubscribe","dstTemplate","copyTo","additionalFields","_classPrivateMethodGet","flat","ask","tabs","sort","skipRobot","isMixedCondition","isBoolean","robotMenuItems","customData","addGroup","skipId","templateRobot","hasReturnFields","group","parentGroup","setObject","setField","setOperator","operator","addItem","clonedGroup","joiner","clonedCondition","itemsArray","JOINER","And","Or","Field","ConditionSelector","fieldPrefix","conditionObjectNode","objectNode","conditionFieldNode","fieldNode","conditionOperatorNode","operatorNode","conditionValueNode","valueNode","conditionJoinerNode","joinerNode","setLabelText","bindLabelNode","removeButtonNode","removeCondition","joinerButtonNode","changeJoiner","getField","valueLabel","formatValuePrintable","getOperatorLabel","onLabelClick","showPopup","filterFields","objectSelect","fieldSelect","fieldSelectLabel","onFieldSelectorClick","selectedField","valueInput","createValueNode","valueWrapper","operatorSelect","createOperatorNode","operatorWrapper","onFieldChange","backgroundColor","firstChild","updateValueNode","fieldDialog","globalContext","InlineSelectorCondition","fireEvent","openMenu","conditionWrapper","onOperatorChange","component","tpl","getTemplate","getGVariable","foundRobot","fieldType","multiple","list","getOperators","filtered","docField","docType","Multiple","operatorList","operatorId","btn","conditionNodes","getItems","Manager","selectorProps","FileSelector","SELECTOR_ROLE_INLINE","InlineSelector","SELECTOR_ROLE_INLINE_HTML","InlineSelectorHtml","SELECTOR_ROLE_TIME","TimeSelector","SaveStateCheckbox","groupId","hasGroup","targetInput","menuButton","Tag","render","parseTargetProperties","replaceOnWrite","renderWith","propertyType","skipPropertiesSwitcher","openPropertiesSwitcherMenu","fillGroups","onMenuOpen","Dialog","dropdownMode","enableSearch","injectDialogMenuTitles","showAvatars","getCustomData","compactView","fillFieldsGroups","fillFileGroup","searchable","groupKey","groupName","names","shift","addGroupItem","fileFields","currentItem","injectDialogMenuSupertitles","child","supertitle","inputType","tagName","expressionOption","selected","hiddenInput","getElementById","selectionEnd","beforePart","substr","middlePart","afterPart","printablePrefix","custom","printableName","printableField","serverField","responsibleField","childGroup","entityId","toExpression","fromString","keyCode","altKey","shiftKey","exp","bindTargetEvents","firstElementChild","insertText","editor","InsertHtml","synchro","IsFocusedOnTextarea","textareaView","Focus","WrapWith","Sync","SaveContent","ResizeSceleton","handler","removeCustomEvent","dom","cont","header","footer","cutHeader","shouldSaveHeader","cutFooter","shouldSaveFooter","editorId","BXHtmlEditor","Get","savedState","additionalUserFields","userSelector","TYPE","None","menu","config","File","required","valueInputName","typeInputName","useDisk","labelFile","labelDisk","fileItem","setValues","ids","Disk","getValues","childNodes","fileRadio","fileTypeOptions","diskFileRadio","diskUploader","layout","addItems","addButtonNode","Automation","DiskUploader","msg","setMode","newType","SIZE","VIEW_URL","itemNode","itemField","closeWnd","Date","setHours","setTime","getTime","constructor","showClock","CClockSelector","start_time","Show","time","timeParts","part","getFormat","formatId","date","convertBitrixFormat","dateFormat","timeFormat","prepareBasisFields","showDelayIntervalPopup","uid","radioNow","labelNow","labelNowHelpNode","createAfterControlNode","createBeforeControlNode","createInControlNode","workTimeRadio","workTimeHelpNode","saveFormData","fieldsMenu","valueTypeMenu","setNow","Notification","Center","notify","radioAfter","labelAfter","createValueTypeSelector","basisField","getBasisField","basisValue","beforeBasisValueNode","beforeBasisNode","onBasisClick","afterHelpNode","radioBefore","labelBefore","beforeHelpNode","radioIn","labelIn","inBasisValueNode","inBasisNode","helpNode","labelTexts","input","onValueTypeSelectorClick","valueId","delayType","system","fld","BaseContext","isValueChanged","Context","contextInstance","Error","tryGetGlobalContext","error","setGlobalContext"],"mappings":";;;;;;;;;;;;;;;AAGA,KAAaA,aAAb;CAMC,yBAAYC,gBAAZ,EAeA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,2DAAqBA,gBAAgB,CAACC,YAAtC;CACA,uDAAiB,CAACC,cAAI,CAACC,KAAL,CAAWH,gBAAgB,CAACI,QAAjB,CAA0BC,EAArC,CAAD,GAA4CL,gBAAgB,CAACI,QAA7D,GAAwE,IAAzF;CACA,qDAAeJ,gBAAgB,CAACM,MAAhC;CACA;;CAzBF;CAAA;CAAA,4BA4BC;CACC,UAAI,KAAKC,WAAL,EAAJ,EACA;CACC,yBAAU,uDAAmBL,IAA7B,cAAqC,mDAAeG,EAApD,cAA0D,iDAAaA,EAAvE;CACA;;CAED,uBAAU,uDAAmBH,IAA7B,cAAqC,iDAAaG,EAAlD;CACA;CAnCF;CAAA;CAAA,sCAsCC;CACC,+CAAO,IAAP;CACA;CAxCF;CAAA;CAAA,0CA2CC;CACC,+CAAO,IAAP;CACA;CA7CF;CAAA;CAAA,wCAgDC;CACC,+CAAO,IAAP;CACA;CAlDF;CAAA;CAAA,kCAqDC;CACC,aAAO,CAACH,cAAI,CAACM,MAAL,mCAAY,IAAZ,aAAR;CACA;CAvDF;CAAA;CAAA;;;;;;;;;;;;;;;;;;;;KCCqBC;CAIpB,2BAAYC,QAAZ,EACA;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,qDAAe,EAAf;;CAEA,QAAIR,cAAI,CAACS,OAAL,CAAaD,QAAb,CAAJ,EACA;CACCA,MAAAA,QAAM,CAACE,OAAP,CAAe,UAAAC,QAAQ,EAAI;CAC1B,YAAMC,KAAK,GAAG,IAAIf,aAAJ,CAAkBc,QAAlB,CAAd;CACA,0CAAA,KAAI,UAAJ,CAAaE,IAAb,CAAkBD,KAAlB;CACA,OAHD;CAIA;CACD;;;;wCAGD;CACC,UAAME,aAAa,GAAG,IAAIC,GAAJ,EAAtB;;CADD,mFAGqB,IAHrB;CAAA;;CAAA;CAGC,4DACA;CAAA,cADWH,KACX;CACCE,UAAAA,aAAa,CAACE,GAAd,CAAkBJ,KAAK,CAACK,eAAN,GAAwBjB,IAA1C,EAAgDY,KAAK,CAACK,eAAN,EAAhD;CACA;CANF;CAAA;CAAA;CAAA;CAAA;;CAQC,aAAOC,KAAK,CAACC,IAAN,CAAWL,aAAa,CAACM,MAAd,EAAX,CAAP;CACA;;;uCAEiBC,cAClB;CACC,UAAMC,kBAAkB,GAAG,IAAIP,GAAJ,EAA3B;;CADD,oFAGqB,IAHrB;CAAA;;CAAA;CAGC,+DACA;CAAA,cADWH,KACX;;CACC,cAAIA,KAAK,CAACP,WAAN,MAAuBO,KAAK,CAACK,eAAN,GAAwBjB,IAAxB,KAAiCqB,YAAY,CAACrB,IAAzE,EACA;CACC,gBAAMuB,QAAQ,GAAGX,KAAK,CAACY,mBAAN,EAAjB;CACAF,YAAAA,kBAAkB,CAACN,GAAnB,CAAuBO,QAAQ,CAACpB,EAAhC,EAAoCoB,QAApC;CACA;CACD;CAVF;CAAA;CAAA;CAAA;CAAA;;CAYC,aAAOL,KAAK,CAACC,IAAN,CAAWG,kBAAkB,CAACF,MAAnB,EAAX,CAAP;CACA;;;qCAEeC,cAA4BI,kBAC5C;CACC,UAAMC,aAAa,GAAG,IAAIC,GAAJ,EAAtB;;CACA,UAAI3B,cAAI,CAACC,KAAL,CAAWwB,gBAAX,CAAJ,EACA;CACCA,QAAAA,gBAAgB,GAAG;CAACtB,UAAAA,EAAE,EAAE;CAAL,SAAnB;CACA;;CAED,UAAMyB,SAAS,GAAG,SAAZA,SAAY,CAAAhB,KAAK,EAAI;CAC1B,YAAMiB,aAAa,GAClBjB,KAAK,CAACK,eAAN,GAAwBjB,IAAxB,KAAiCqB,YAAY,CAACrB,IAA9C,KACIY,KAAK,CAACP,WAAN,KAAsBO,KAAK,CAACY,mBAAN,GAA4BrB,EAA5B,KAAmCsB,gBAAgB,CAACtB,EAA1E,GAA+E,IADnF,KAEG,CAACuB,aAAa,CAACI,GAAd,CAAkBlB,KAAK,CAACmB,iBAAN,GAA0B5B,EAA5C,CAHL;;CAMA,YAAI0B,aAAJ,EACA;CACCH,UAAAA,aAAa,CAACM,GAAd,CAAkBpB,KAAK,CAACmB,iBAAN,GAA0B5B,EAA5C;CACA;;CAED,eAAO0B,aAAP;CACA,OAbD;;CAeA,aAAOX,KAAK,CAACC,IAAN,wBAAW,IAAX,8BAAW,IAAX,EAA0BS,SAA1B,GAAsCK,GAAtC,CAA0C,UAAArB,KAAK;CAAA,eAAIA,KAAK,CAACmB,iBAAN,EAAJ;CAAA,OAA/C,CAAP;CACA;;;;;qBAESH,WACV;CACC,MAAMM,SAAS,wCAAG,SAAZA,SAAY,CAAU1B,MAAV;CAAA;;CAAA;CAAA;CAAA;CAAA;CAAA,oDAEGA,MAFH;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;CAAA;;CAENI,YAAAA,KAFM;;CAAA,iBAIZgB,SAAS,CAAChB,KAAD,CAJG;CAAA;CAAA;CAAA;;CAAA;CAMf,mBAAMA,KAAN;;CANe;CAAA;CAAA;;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;;CAAA;;CAAA;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA,OAAZsB,SAAY;CAAA,GAAH,CAAf;CAWA,SAAOA,SAAS,mCAAC,IAAD,WAAhB;CACA;;;;;;;;;;;;;;;;;;ACzFF,KAAaC,QAAb;CAUC,oBAAYC,IAAZ,EACA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,mDAAaA,IAAb;CACA,yDAAmB,EAAnB;CACA;;CAdF;CAAA;CAAA,6BAsBC;CACC,aAAO,mFAAeD,QAAf,EAvBIA,QAuBJ,QAAP;CACA;CAxBF;CAAA;CAAA,6BAgCC;CACC,aAAO,mFAAeA,QAAf,EAjCIA,QAiCJ,QAAP;CACA;CAlCF;CAAA;CAAA,6BA0CC;CACC,aAAO,mFAAeA,QAAf,EA3CIA,QA2CJ,QAAP;CACA;CA5CF;CAAA;CAAA,+BAoDC;CACC,aAAO,mFAAeA,QAAf,EArDIA,QAqDJ,UAAP;CACA;CAtDF;CAAA;CAAA,gCAwDaE,IAxDb,EAwD2BC,KAxD3B,EAyDC;CACC,2DAAiBD,IAAjB,IAAyBC,KAAzB;CAEA,aAAO,IAAP;CACA;CA7DF;CAAA;CAAA,gCA+DaD,IA/Db,EAgEC;CAAA,UAD0BE,YAC1B,uEAD8C,IAC9C;;CACC,UAAI,qDAAiBC,cAAjB,CAAgCH,IAAhC,CAAJ,EACA;CACC,eAAO,qDAAiBA,IAAjB,CAAP;CACA;;CAED,aAAOE,YAAP;CACA;CAvEF;CAAA;CAAA,8BAoFC;CACC,+CAAO,IAAP;CACA;CAtFF;CAAA;CAAA,2BAiBC;CACC,aAAO,IAAIJ,QAAJ,iCAAaA,QAAb,EAlBIA,QAkBJ,SAAP;CACA;CAnBF;CAAA;CAAA,2BA2BC;CACC,aAAO,IAAIA,QAAJ,iCAAaA,QAAb,EA5BIA,QA4BJ,SAAP;CACA;CA7BF;CAAA;CAAA,2BAqCC;CACC,aAAO,IAAIA,QAAJ,iCAAaA,QAAb,EAtCIA,QAsCJ,SAAP;CACA;CAvCF;CAAA;CAAA,6BA+CC;CACC,aAAO,IAAIA,QAAJ,iCAAaA,QAAb,EAhDIA,QAgDJ,WAAP;CACA;CAjDF;CAAA;CAAA,4BAyEgBC,IAzEhB,EA0EC;CACC,UAAID,QAAQ,CAACM,MAAT,GAAkBC,QAAlB,CAA2BN,IAA3B,CAAJ,EACA;CACC,eAAO,IAAID,QAAJ,CAAaC,IAAb,CAAP;CACA;;CAED,aAAOD,QAAQ,CAACQ,IAAT,EAAP;CACA;CAjFF;CAAA;CAAA,6BAyFC;CACC,aAAO,iCACN,IADM,EA1FIR,QA0FJ,0CAEN,IAFM,EA1FIA,QA0FJ,0CAGN,IAHM,EA1FIA,QA0FJ,0CAIN,IAJM,EA1FIA,QA0FJ,WAAP;CAMA;CAhGF;CAAA;CAAA;;;UAKgB;;;;UACA;;;;UACA;;;;UACE;;;;;;;;;;;;;;;;;;;;;;;;;ACHlB,KAAaS,OAAb;CAAA;;CAcC,qBACA;CAAA;;CAAA;CACC;;CADD;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAEC,UAAKC,iBAAL,CAAuB,uBAAvB;;CAEA,UAAKC,KAAL,GAAa,KAAb;CACA,wFAAa,EAAb;CACA,2FAAgB,KAAhB;CACA,4FAAiBX,QAAQ,CAACQ,IAAT,EAAjB;CACA,6FAAkB,IAAII,iCAAJ,EAAlB;CARD;CASC;;CAxBF;CAAA;CAAA,yBAyCMC,IAzCN,EAyCiCC,QAzCjC,EA0CC;CACC,qDAAaC,eAAK,CAACF,IAAD,CAAlB;;CAEA,UAAI,CAAChD,cAAI,CAACmD,aAAL,CAAmB,+CAAW,aAAX,CAAnB,CAAL,EACA;CACC,uDAAW,aAAX,IAA4B,EAA5B;CACA;;CAED,UAAI,+CAAW,aAAX,EAA0BC,SAA9B,EACA;CACC,4DAAkB,IAAIL,iCAAJ,CAAmB,+CAAW,aAAX,EAA0BK,SAA7C,CAAlB;CACA,OAHD,MAKA;CACC,4DAAkB,IAAIL,iCAAJ,EAAlB;CACA;;CAED,yDAAiB/C,cAAI,CAACC,KAAL,CAAWgD,QAAX,IAAuBd,QAAQ,CAACkB,IAAT,EAAvB,GAAyCJ,QAA1D;CACA,qDAAa,KAAKK,UAAL,EAAb;CACA;CA7DF;CAAA;CAAA,2BA+DQN,IA/DR,EA+DmCC,QA/DnC,EAgEC;CACC,UAAMM,IAAI,qCAAG,IAAH,QAAV;CACA,qDAAa,KAAKD,UAAL,EAAb;;CACA,UAAIC,IAAI,CAACC,UAAT,EACA;CACCD,QAAAA,IAAI,CAACC,UAAL,CAAgBC,YAAhB,mCAA6B,IAA7B,UAAyCF,IAAzC;CACA;CACD;CAvEF;CAAA;CAAA,8BA0EC;CACC,aAAOG,mCAAgB,GAAGC,OAA1B;CACA;CA5EF;CAAA;CAAA,4BA+EC;CACC,aAAO,+CAAW,IAAX,KAAoB,CAA3B;CACA;CAjFF;CAAA;CAAA,kCAoFC;CACC,aAAO,+CAAW,iBAAX,KAAiC,EAAxC;CACA;CAtFF;CAAA;CAAA,8BAyFC;CAAA;;CACC,sCAAO,+CAAW,MAAX,CAAP,yEAA6B,EAA7B;CACA;CA3FF;CAAA;CAAA,8BA8FC;CACC,UAAIC,WAAW,GAAG,+CAAW,MAAX,CAAlB;;CACA,UAAI,CAACA,WAAL,EACA;CAAA;;CACC,YAAMC,IAAI,GAAG,KAAKC,OAAL,EAAb;CACA,YAAMC,OAAO,GAAGL,mCAAgB,GAAGM,iBAAnB,CAAqCC,IAArC,CAA0C,UAACF,OAAD;CAAA,iBAAaF,IAAI,KAAKE,OAAO,CAAC,MAAD,CAA7B;CAAA,SAA1C,CAAhB;CACAH,QAAAA,WAAW,oBAAGG,OAAH,aAAGA,OAAH,uBAAGA,OAAO,CAAEG,IAAZ,yDAAoBL,IAA/B;CACA;;CAED,aAAOD,WAAP;CACA;CAxGF;CAAA;CAAA,4BA0GSvB,IA1GT,EA2GC;CACC,UAAIrC,cAAI,CAACmE,QAAL,CAAc9B,IAAd,CAAJ,EACA;CACC,uDAAW,MAAX,IAAqBA,IAArB;CACA;;CAED,aAAO,IAAP;CACA;CAlHF;CAAA;CAAA,oCAqHC;CACC,aAAO,+CAAW,aAAX,CAAP;CACA;CAvHF;CAAA;CAAA,kCAyHe+B,KAzHf,EA0HC;CACC,qDAAW,aAAX,IAA4BA,KAA5B;CAEA,aAAO,IAAP;CACA;CA9HF;CAAA;CAAA,mCAiIC;CACC,UAAMC,GAAG,GAAGX,mCAAgB,GAAGY,OAAnB,CAA2BC,aAA3B,CAAyC,KAAKC,KAAL,EAAzC,CAAZ;CACA,aAAOH,GAAG,GAAGA,GAAG,CAACI,MAAP,GAAgB,IAA1B;CACA;CApIF;CAAA;CAAA,mCAuIC;CACC,+CAAO,IAAP;CACA;CAzIF;CAAA;CAAA,iCA2IcC,SA3Id,EA4IC;CACC,0DAAkBA,SAAlB;CACA,aAAO,IAAP;CACA;CA/IF;CAAA;CAAA,yCAkJC;CACC,aAAO,+CAAW,aAAX,EAA0B,iBAA1B,MAAiD,GAAxD;CACA;CApJF;CAAA;CAAA,sCAsJmBC,IAtJnB,EAuJC;CACC,qDAAW,aAAX,EAA0B,iBAA1B,IAA+CA,IAAI,GAAG,GAAH,GAAS,GAA5D;CAEA,aAAO,IAAP;CACA;CA3JF;CAAA;CAAA,mCA8JC;CACC,aAAO,+CAAW,aAAX,EAA0B,WAA1B,KAA0C,EAAjD;CACA;CAhKF;CAAA;CAAA,iCAkKcC,MAlKd,EAmKC;CACC,qDAAW,aAAX,EAA0B,WAA1B,IAAyCA,MAAzC;CAEA,aAAO,IAAP;CACA;CAvKF;CAAA;CAAA,iCA0KC;CACC,UAAIC,YAAY,GAAG,yCAAnB;;CAEA,UAAI,mDAAeC,MAAf,MAA2B,KAAKnB,OAAL,EAA/B,EACA;CACCkB,QAAAA,YAAY,IAAI,oDAAhB;CACA;;CAED,UAAIE,WAAW,GAAG,IAAlB;CACA,UAAIC,OAAO,GAAG,IAAd;;CACA,UAAI,mDAAeF,MAAf,EAAJ,EACA;CACCC,QAAAA,WAAW,GAAGE,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC/BC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADwB;CAI/BC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,6BAAf;CAJyB,SAAlB,CAAd;CAOAP,QAAAA,OAAO,GAAGC,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC3BC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADoB;CAI3BC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,6BAAf,KAAiD;CAJ5B,SAAlB,CAAV;CAOAC,QAAAA,eAAK,CAACC,IAAN,CAAWT,OAAX,EAAoB,OAApB,EAA6B,KAAKU,iBAAL,CAAuBD,IAAvB,CAA4B,IAA5B,EAAkCT,OAAlC,CAA7B;CACA;;CAED,UAAI,KAAKW,YAAL,OAAwBC,iCAAc,CAACC,SAA3C,EACA;CACChB,QAAAA,YAAY,IAAI,mDAAhB;CACA,OAHD,MAIK,IAAInB,mCAAgB,GAAGoC,QAAnB,CAA4BC,uBAA5B,GAAsDrD,QAAtD,CAA+D,KAAKsD,WAAL,EAA/D,CAAJ,EACL;CACCnB,QAAAA,YAAY,IAAI,yDAAhB;CACA;;CAED,UAAMjB,WAAW,GAAG,KAAKqC,OAAL,EAApB;CAEA,UAAIC,cAAc,GAAG,iCAArB;;CAEA,UAAI,KAAKP,YAAL,OAAwBC,iCAAc,CAACC,SAA3C,EACA;CACCK,QAAAA,cAAc,IAAI,aAAlB;CACA;;CAED,UAAMC,GAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,QAAAA,KAAK,EAAE;CACN,uBAAa,mBADP;CAEN,uBAAae,cAFP;CAGN,uBAAa;CAHP,SADsB;CAM7BE,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAEP;CADL,WADU;CAIjBuB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADU;CAEjBC,YAAAA,IAAI,EAAEzB;CAFW,WAAlB,CADS;CAJO,SAAlB,CADS,EAYToB,OAZS,EAaTD,WAbS;CANmB,OAAlB,CAAZ;;CAuBA,UAAI,CAAC,mDAAeD,MAAf,EAAL,EACA;CACC,eAAOqB,GAAP;CACA;;CAED,UAAI,KAAKxC,OAAL,EAAJ,EACA;CACC,aAAK0C,YAAL,CAAkBF,GAAlB;CACA;;CAED,UAAMG,SAAS,GAAGrB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACpCC,QAAAA,KAAK,EAAE;CACN,uBAAa,oBADP;CAEN,uBAAa;CAFP;CAD6B,OAAnB,CAAlB;CAOAK,MAAAA,eAAK,CAACC,IAAN,CAAWa,SAAX,EAAsB,OAAtB,EAA+B,KAAKC,mBAAL,CAAyBd,IAAzB,CAA8B,IAA9B,EAAoCa,SAApC,CAA/B;CAEAH,MAAAA,GAAG,CAACK,WAAJ,CAAgBF,SAAhB;;CAEA,UAAI,mDAAexB,MAAf,EAAJ,EACA;CACCU,QAAAA,eAAK,CAACC,IAAN,CAAWU,GAAX,EAAgB,OAAhB,EAAyB,KAAKM,qBAAL,CAA2BhB,IAA3B,CAAgC,IAAhC,EAAsCU,GAAtC,CAAzB;CACA;;CAED,aAAOA,GAAP;CACA;CA3QF;CAAA;CAAA,0CA6QuBO,MA7QvB,EA8QC;CACC,UAAI,CAAC,KAAK/C,OAAL,EAAL,EACA;CACCgD,QAAAA,2BAAQ,CAACC,qBAAT,CAA+BF,MAA/B;CACA,OAHD,MAIK,IAAI,CAAC,mDAAeG,QAAf,EAAL,EACL;CACC,aAAKC,IAAL,CAAU,wBAAV,EAAoC;CAAC/C,UAAAA,OAAO,EAAE;CAAV,SAApC;CACA;CACD;CAvRF;CAAA;CAAA,sCAyRmB2C,MAzRnB,EAyRwCK,KAzRxC,EA0RC;CACCA,MAAAA,KAAK,CAACC,eAAN;;CAEA,UAAI,CAAC,KAAKrD,OAAL,EAAL,EACA;CACCgD,QAAAA,2BAAQ,CAACC,qBAAT,CAA+BF,MAA/B;CACA,OAHD,MAIK,IAAI,CAAC,mDAAeG,QAAf,EAAL,EACL;CACC,YAAM9C,OAAO,GAAG,IAAInB,OAAJ,EAAhB;CACA,YAAMqE,QAAQ,GAAG,KAAKC,SAAL,EAAjB;CACA,eAAOD,QAAQ,CAAC,IAAD,CAAf,CAHD;;CAKC,YAAIA,QAAQ,CAAC,MAAD,CAAR,KAAqB,SAAzB,EACA;CACCA,UAAAA,QAAQ,CAAC,aAAD,CAAR,GAA0B,EAA1B;CACA;;CACDlD,QAAAA,OAAO,CAACoD,IAAR,CAAaF,QAAb,oCAAuB,IAAvB;CACA,aAAKH,IAAL,CAAU,gBAAV,EAA4B;CAAC/C,UAAAA,OAAO,EAAPA;CAAD,SAA5B;CACA;CACD;CA9SF;CAAA;CAAA,6BA+SUgD,KA/SV,EAgTC;CACC,UAAI,mCAAC,IAAD,QAAJ,EACA;CACC;CACA;;CAED,UAAMK,KAAK,GAAGL,KAAK,CAACM,OAAN,GAAgBC,WAA9B;CACA,UAAMC,KAAK,GAAG,CAACH,KAAD,IAAU,KAAKnB,OAAL,GAAeuB,WAAf,GAA6BC,OAA7B,CAAqCL,KAArC,KAA+C,CAAvE;CAEAnC,MAAAA,aAAG,CAACsC,KAAK,GAAG,aAAH,GAAmB,UAAzB,CAAH,mCAAwC,IAAxC,UAAoD,mBAApD;CACA;CA1TF;CAAA;CAAA,iCA4TcG,MA5Td,EA6TC;CACC,UAAI1H,cAAI,CAACC,KAAL,CAAWyH,MAAM,CAAC,UAAD,CAAjB,CAAJ,EACA;CACCA,QAAAA,MAAM,CAACC,aAAP,GAAuBC,EAAE,CAACC,KAAH,CAAS,KAAKC,SAAd,EAAyB,IAAzB,CAAvB;CACAJ,QAAAA,MAAM,CAACK,QAAP,GAAkBH,EAAE,CAACC,KAAH,CAAS,KAAKG,QAAd,EAAwB,IAAxB,CAAlB;CACAN,QAAAA,MAAM,CAACO,YAAP,GAAsBL,EAAE,CAACC,KAAH,CAAS,KAAKK,QAAd,EAAwB,IAAxB,CAAtB;CACAR,QAAAA,MAAM,CAACS,aAAP,GAAuBP,EAAE,CAACC,KAAH,CAAS,KAAKO,QAAd,EAAwB,IAAxB,CAAvB;CACAC,QAAAA,IAAI,CAACC,cAAL,CAAoBZ,MAApB;CACAW,QAAAA,IAAI,CAACE,YAAL,CAAkBb,MAAlB,EAA0B,CAA1B;CACA;CACD;CAvUF;CAAA;CAAA,mCAyUgBA,MAzUhB,EA0UC;CACCA,MAAAA,MAAM,CAACC,aAAP,GAAuBa,SAAvB;CACAd,MAAAA,MAAM,CAACK,QAAP,GAAkBS,SAAlB;CACAd,MAAAA,MAAM,CAACO,YAAP,GAAsBO,SAAtB;CACAd,MAAAA,MAAM,CAACS,aAAP,GAAuBK,SAAvB;CACAH,MAAAA,IAAI,CAACI,gBAAL,CAAsBf,MAAtB;CACAW,MAAAA,IAAI,CAACK,cAAL,CAAoBhB,MAApB;CACA;CAjVF;CAAA;CAAA,gCAoVC;CACC,8DAAsBE,EAAE,CAACe,aAAzB;;CAEA,UAAI,mCAAC,IAAD,iBAAJ,EACA;CACCN,QAAAA,IAAI,CAACO,eAAL;CACA;CACA;;CAED,UAAI,mCAAC,IAAD,QAAJ,EACA;CACC,YAAMC,SAAS,GAAG,wDAAoBC,WAAtC;CACA,uDAAa,wDAAoBC,SAApB,CAA8B,IAA9B,CAAb;CACA,uDAAWC,KAAX,CAAiBC,QAAjB,GAA4B,UAA5B;CACA,uDAAWC,SAAX,CAAqBlH,GAArB,CAAyB,sCAAzB;CACA,uDAAWgH,KAAX,CAAiBG,KAAjB,GAAyBN,SAAS,GAAG,IAArC;CACA/C,QAAAA,QAAQ,CAACsD,IAAT,CAAc5C,WAAd,mCAA0B,IAA1B;CACA;CACD;CAtWF;CAAA;CAAA,6BAwWU6C,CAxWV,EAwWaC,CAxWb,EAyWC;CACC,qDAAWN,KAAX,CAAiBO,IAAjB,GAAwBF,CAAC,GAAG,IAA5B;CACA,qDAAWL,KAAX,CAAiBQ,GAAjB,GAAuBF,CAAC,GAAG,IAA3B;CACA;CA5WF;CAAA;CAAA,6BA8WUG,WA9WV,EA8WuBJ,CA9WvB,EA8W0BC,CA9W1B,EA+WC;CACC,4CAAI,IAAJ,mBACA;CACC,gEAAoBJ,SAApB,CAA8BQ,MAA9B,CAAqC,qCAArC;CACA;;CAED,4CAAI,IAAJ,qBACA;CACC,kEAAsBR,SAAtB,CAAgCQ,MAAhC,CAAuC,qCAAvC;CACA;;CAED,UAAMC,IAAI,GAAGF,WAAW,CAACG,YAAZ,CAAyB,WAAzB,CAAb;;CAEA,UAAID,IAAI,KAAK,cAAb,EACA;CACC,gEAAsBF,WAAtB;CACA,kEAAwB,IAAxB;CACA;;CAED,UAAIE,IAAI,KAAK,gBAAb,EACA;CACC,kEAAwBF,WAAW,CAACI,aAAZ,CAA0B,4BAA1B,CAAxB;CACA,gEAAsB,IAAtB;CACA;;CAED,4CAAI,IAAJ,mBACA;CACC,gEAAoBX,SAApB,CAA8BlH,GAA9B,CAAkC,qCAAlC;CACA;;CAED,4CAAI,IAAJ,qBACA;CACC,kEAAsBkH,SAAtB,CAAgClH,GAAhC,CAAoC,qCAApC;CACA;CACD;CAjZF;CAAA;CAAA,6BAmZUqH,CAnZV,EAmZaC,CAnZb,EAmZgBvC,KAnZhB,EAoZC;CACCA,MAAAA,KAAK,GAAGA,KAAK,IAAI+C,MAAM,CAAC/C,KAAxB;CACA,UAAIhD,OAAO,GAAG,IAAd;CACA,UAAMgG,MAAM,GAAGhD,KAAK,KAAKA,KAAK,CAACiD,OAAN,IAAiBjD,KAAK,CAACkD,OAA5B,CAApB;;CACA,UAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,MAAD,EAASC,QAAT,EAAsB;CACzC,YAAMrG,OAAO,GAAG,IAAInB,OAAJ,EAAhB;CACA,YAAMqE,QAAQ,GAAGkD,MAAM,CAACjD,SAAP,EAAjB;CACA,eAAOD,QAAQ,CAAC,IAAD,CAAf,CAHyC;;CAKzC,YAAIA,QAAQ,CAAC,MAAD,CAAR,KAAqB,SAAzB,EACA;CACCA,UAAAA,QAAQ,CAAC,aAAD,CAAR,GAA0B,EAA1B;CACA;;CACDA,QAAAA,QAAQ,CAAC,iBAAD,CAAR,GAA8BmD,QAA9B;CACArG,QAAAA,OAAO,CAACoD,IAAR,CAAaF,QAAb,oCAAuBkD,MAAvB;CAEA,eAAOpG,OAAP;CACA,OAbD;;CAeA,4CAAI,IAAJ,mBACA;CACC,8CAAI,IAAJ,mBACA;CACC,kEAAoBmF,SAApB,CAA8BQ,MAA9B,CAAqC,qCAArC;CACA,cAAMW,UAAU,GAAG,wDAAoB7G,UAAvC;;CACA,cAAI,CAACuG,MAAL,EACA;CACCM,YAAAA,UAAU,CAACC,YAAX,mCAAwB,IAAxB,qDAA6C,IAA7C;CACA,iBAAKC,MAAL,CAAYF,UAAU,CAACT,YAAX,CAAwB,gBAAxB,CAAZ;CACA,WAJD,MAMA;CACC7F,YAAAA,OAAO,GAAGmG,WAAW,CAAC,IAAD,EAAOG,UAAU,CAACT,YAAX,CAAwB,gBAAxB,CAAP,CAArB;CACAS,YAAAA,UAAU,CAACC,YAAX,mCAAwBvG,OAAxB,4CAAuC,IAAvC;CACA;CACD,SAdD,MAeK,sCAAI,IAAJ,qBACL;CACC,oEAAsBmF,SAAtB,CAAgCQ,MAAhC,CAAuC,qCAAvC;;CACA,cAAI,CAACK,MAAL,EACA;CACC,sEAAsBvD,WAAtB,mCAAkC,IAAlC;CACA,iBAAK+D,MAAL,CAAY,0DAAsBX,YAAtB,CAAmC,gBAAnC,CAAZ;CACA,WAJD,MAMA;CACC7F,YAAAA,OAAO,GAAGmG,WAAW,CAAC,IAAD,EAAO,0DAAsBN,YAAtB,CAAmC,gBAAnC,CAAP,CAArB;CACA,sEAAsBpD,WAAtB,mCAAkCzC,OAAlC;CACA;CACD;;CAED,YAAIA,OAAJ,EACA;CACC,eAAK+C,IAAL,CAAU,gBAAV,EAA4B;CAC3B/C,YAAAA,OAAO,EAAPA,OAD2B;CAE3ByG,YAAAA,UAAU,EAAE;CAFe,WAA5B;CAIA;CACD;;CAED,qDAAWhH,UAAX,CAAsBiH,WAAtB,mCAAkC,IAAlC;CACA,qDAAa,IAAb;CACA,8DAAsB,IAAtB;CACA,8DAAsB,IAAtB;CACA;CApdF;CAAA;CAAA,wCAsdqB/D,MAtdrB,EAsd0CK,KAtd1C,EAudC;CACCA,MAAAA,KAAK,CAACC,eAAN;;CAEA,UAAI,CAAC,KAAKrD,OAAL,EAAL,EACA;CACCgD,QAAAA,2BAAQ,CAACC,qBAAT,CAA+BF,MAA/B;CACA,OAHD,MAIK,IAAI,CAAC,mDAAeG,QAAf,EAAL,EACL;CACC5B,QAAAA,aAAG,CAACyE,MAAJ,CAAWhD,MAAM,CAAClD,UAAlB;CACA,aAAKsD,IAAL,CAAU,iBAAV,EAA6B;CAAC/C,UAAAA,OAAO,EAAE;CAAV,SAA7B;CACA;CACD;CAneF;CAAA;CAAA,+BAqeYf,IAreZ,EAseC;CACC,UAAIhD,cAAI,CAACmD,aAAL,CAAmBH,IAAnB,CAAJ,EACA;CACC,uDAAaA,IAAb;CACA,OAHD,MAKA;CACC,cAAM,cAAN;CACA;CACD;CA/eF;CAAA;CAAA,kCAkfC;CACC,wDAAgB,IAAhB;CAEA,aAAO,IAAP;CACA;CAtfF;CAAA;CAAA,gCAyfC;CACC,UAAMA,IAAI,GAAGE,eAAK,mCAAC,IAAD,SAAlB;;CACA,4CAAI,IAAJ,aACA;CACCF,QAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkB,GAAlB;CACA;;CAED,UAAI,CAAChD,cAAI,CAACmD,aAAL,CAAmBH,IAAI,CAAC0H,WAAxB,CAAL,EACA;CACC1H,QAAAA,IAAI,CAAC0H,WAAL,GAAmB,EAAnB;CACA;;CAED,UAAI,CAAC,oDAAgBC,KAAhB,CAAsBC,MAA3B,EACA;CACC,eAAO5H,IAAI,CAAC0H,WAAL,CAAiBtH,SAAxB;CACA,OAHD,MAKA;CACCJ,QAAAA,IAAI,CAAC0H,WAAL,CAAiBtH,SAAjB,GAA6B,oDAAgB8D,SAAhB,EAA7B;CACA;;CAED,aAAOlE,IAAP;CACA;CA/gBF;CAAA;CAAA,2BAihBQoH,QAjhBR,EAkhBC;CACC,qDAAW,iBAAX,IAAgCA,QAAhC;CACA,WAAKtD,IAAL,CAAU,kBAAV,EAA8B;CAAC/C,QAAAA,OAAO,EAAE;CAAV,OAA9B;CACA;CArhBF;CAAA;CAAA,0CAwhBC;CAAA;;CACC,UAAM8G,WAAW,GAAGnH,mCAAgB,GAAGM,iBAAnB,CAAqCC,IAArC,CAA0C,UAAAF,OAAO;CAAA,eAAIA,OAAO,CAAC,MAAD,CAAP,KAAoB,MAAI,CAACD,OAAL,EAAxB;CAAA,OAAjD,CAApB;CAEA,aAAO+G,WAAW,IAAI7K,cAAI,CAACS,OAAL,CAAaoK,WAAW,CAACC,MAAzB,CAAf,GAAkDD,WAAW,CAACC,MAA9D,GAAuE,EAA9E;CACA;CA5hBF;CAAA;CAAA,wBA2BC;CACC,+CAAO,IAAP;CACA;CA7BF;CAAA;CAAA,wBAgCC;CACC,+CAAO,IAAP;CACA;CAlCF;CAAA;CAAA,wBAqCC;CAAA;;CACC,uCAAO,+CAAW,iBAAX,CAAP,2EAAwC,EAAxC;CACA;CAvCF;CAAA;CAAA,EAA6BC,6BAA7B;;KCHapE,QAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,4BAKgBpD,IALhB,EAMC;CACCA,MAAAA,IAAI,CAACyH,gBAAL,CAAsB,aAAtB,EAAqCtK,OAArC,CAA6C,UAACuK,OAAD;CAAA,eAAatE,QAAQ,CAACuE,UAAT,CAAoBD,OAApB,CAAb;CAAA,OAA7C;CACA;CARF;CAAA;CAAA,+BAUmB1H,IAVnB,EAWC;CACCiC,MAAAA,eAAK,CAACC,IAAN,CAAWlC,IAAX,EAAiB,WAAjB,EAA8B,KAAK4H,QAAL,CAAc1F,IAAd,CAAmB,IAAnB,EAAyBlC,IAAzB,CAA9B;CACAiC,MAAAA,eAAK,CAACC,IAAN,CAAWlC,IAAX,EAAiB,UAAjB,EAA6B,KAAK6H,QAAL,CAAc3F,IAAd,CAAmB,IAAnB,CAA7B;CACA;CAdF;CAAA;CAAA,mCAgBuBlC,IAhBvB,EAiBC;CAAA;;CACC,aAAO,CAAC,qBAAC,KAAK8H,SAAN,qEAAC,gBAAgBC,WAAjB,kDAAC,sBAA6BC,UAA7B,CAAwChI,IAAxC,CAAD,CAAR;CACA;CAnBF;CAAA;CAAA,6BAqBiBA,IArBjB,EAsBC;CACC,UAAMiI,OAAO,GAAGjI,IAAI,CAACqG,YAAL,CAAkB,WAAlB,CAAhB;;CACA,UAAI,CAAC4B,OAAL,EACA;CACC;CACA;;CACD,UAAInG,IAAI,GAAGoG,cAAI,CAACC,MAAL,CAAYF,OAAZ,CAAX;CACAnG,MAAAA,IAAI,GAAGuC,EAAE,CAAC+D,IAAH,CAAQC,KAAR,CAAcvG,IAAd,CAAP;;CAEA,UAAI,CAACrF,cAAI,CAAC6L,cAAL,CAAoBxG,IAApB,CAAL,EACA;CACC;CACA;;CACD,WAAK+F,QAAL;CAEA,WAAKC,SAAL,GAAiB,IAAIzD,EAAE,CAACkE,WAAP,CAAmB,6BAAnB,EAAkDvI,IAAlD,EAAwD;CACxEwI,QAAAA,WAAW,EAAE,IAD2D;CAExEC,QAAAA,QAAQ,EAAE,KAF8D;CAGxEC,QAAAA,QAAQ,EAAE,IAH8D;CAIxEC,QAAAA,UAAU,EAAE,CAJ4D;CAKxEC,QAAAA,SAAS,EAAE,CAL6D;CAMxEC,QAAAA,WAAW,EAAE;CAACnD,UAAAA,QAAQ,EAAE;CAAX,SAN2D;CAOxEoD,QAAAA,MAAM,EAAG;CACRC,UAAAA,YADQ,0BAER;CACC,iBAAKC,OAAL;CACA;CAJO,SAP+D;CAaxEC,QAAAA,OAAO,EAAGvH,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC3BC,UAAAA,KAAK,EAAG;CACP6D,YAAAA,KAAK,EAAG;CADD,WADmB;CAI3ByD,UAAAA,IAAI,EAAEpH;CAJqB,SAAlB;CAb8D,OAAxD,CAAjB;CAoBA,WAAKgG,SAAL,CAAeqB,QAAf,CAAwB;CAACC,QAAAA,MAAM,EAAE,EAAT;CAAa1D,QAAAA,QAAQ,EAAE;CAAvB,OAAxB;CACA,WAAKoC,SAAL,CAAeuB,IAAf;CAEA,aAAO,IAAP;CACA;CA7DF;CAAA;CAAA,0CA+D8BrJ,IA/D9B,EAgEC;CACC,WAAKsJ,aAAL,CAAmBtJ,IAAnB,EAAyB+B,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAAzB;CACA;CAlEF;CAAA;CAAA,kCAoEsBhC,IApEtB,EAoE4B8B,IApE5B,EAqEC;CACC,UAAI,KAAKyH,OAAT,EACA;CACCC,QAAAA,YAAY,CAAC,KAAKD,OAAN,CAAZ;CACA;;CAED,WAAKzB,SAAL,GAAiBzD,EAAE,CAACoF,EAAH,CAAMC,IAAN,CAAWC,cAAX,CAA0B;CAC1CC,QAAAA,eAAe,EAAE;CAChBhE,UAAAA,KAAK,EAAE,GADS;CAEhBiE,UAAAA,MAAM,EAAE,GAFQ;CAGhBC,UAAAA,UAAU,EAAE,IAHI;CAIhBrB,UAAAA,QAAQ,EAAE,IAJM;CAKhBsB,UAAAA,KAAK,EAAE;CAACX,YAAAA,MAAM,EAAE1H,aAAG,CAACsI,WAAJ,CAAgBhK,IAAhB,EAAsB4F,KAAtB,GAA8B;CAAvC,WALS;CAMhBiD,UAAAA,WAAW,EAAE;CAACnD,YAAAA,QAAQ,EAAE;CAAX;CANG;CADyB,OAA1B,CAAjB;;CAWA,WAAKoC,SAAL,CAAemC,KAAf,GAAuB,YACvB;CACC,aAAKC,IAAL;CACA,OAHD;;CAIA,WAAKpC,SAAL,CAAeuB,IAAf,CAAoBrJ,IAApB,EAA0B8B,IAA1B;CACA,WAAKyH,OAAL,GAAeY,UAAU,CAAC,KAAKtC,QAAL,CAAc3F,IAAd,CAAmB,IAAnB,CAAD,EAA2B,IAA3B,CAAzB;CACA;CA5FF;CAAA;CAAA,+BA+FC;CACC,UAAI,KAAK4F,SAAT,EACA;CACC,aAAKA,SAAL,CAAemC,KAAf;CACA;;CACD,WAAKnC,SAAL,GAAiB,IAAjB;CACA;CArGF;CAAA;CAAA;;;;;;;;;;;;;;;;;;;KCAasC,MAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,uCAKC;CACC,sCAAEA,MAAF,EANWA,MAMX,mDAAEA,MAAF,EANWA,MAMX;;CACA,aAAO,8DAA4BA,MAA5B,EAPIA,MAOJ,eAAP;CACA;CARF;CAAA;CAAA,iCAUqB3K,IAVrB,EAWC;CACC,aAAO4K,IAAI,CAACC,SAAL,CAAe7K,IAAf,EAAqB,UAAU8K,CAAV,EAAaC,CAAb,EAC5B;CACC,YAAI,OAAOA,CAAP,IAAa,SAAjB,EACA;CACC,iBAAOA,CAAC,GAAG,GAAH,GAAS,GAAjB;CACA;;CACD,eAAOA,CAAP;CACA,OAPM,CAAP;CAQA;CApBF;CAAA;CAAA,iDAsBqCC,MAtBrC,EAuBC;CACC,UAAIhO,cAAI,CAACS,OAAL,CAAauN,MAAb,CAAJ,EACA;CAAA,qDACqBA,MADrB;CAAA;;CAAA;CACC,8DACA;CAAA,gBADWC,KACX;;CACC,gBAAIA,KAAK,CAAC,IAAD,CAAL,KAAgB,gBAAhB,IAAoCA,KAAK,CAAC,IAAD,CAAL,KAAgB,gBAAxD,EACA;CACC,qBAAO,OAAKA,KAAK,CAAC,MAAD,CAAV,GAAmB,IAA1B;CACA;CACD;CAPF;CAAA;CAAA;CAAA;CAAA;CAQC;;CAED,aAAO,IAAP;CACA;CApCF;CAAA;CAAA;;;UAEuB;;;;;;;;;;;;;;;ACJvB,KAAaC,QAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,2CAmBwBC,MAnBxB,EAoBC;CACC,WAAKC,mBAAL,GAA2BD,MAA3B;CACA,WAAKE,KAAL,GAAaF,MAAM,GAAGA,MAAM,CAACE,KAAV,GAAkB,IAArC;CACA;CAvBF;CAAA;CAAA,6CA0BC;CACC,aAAO,KAAKD,mBAAZ;CACA;CA5BF;CAAA;CAAA,6CA8B0BD,MA9B1B,EA+BC;CACC,WAAKG,qBAAL,GAA6BH,MAA7B;CACA;CAjCF;CAAA;CAAA,+CAoCC;CACC,aAAO,KAAKG,qBAAZ;CACA;CAtCF;CAAA;CAAA,kCAUC;CACC,UAAI,mCAACJ,QAAD,EAXOA,QAWP,YAAJ,EACA;CACC,0CAAAA,QAAQ,EAbEA,QAaF,aAAa,IAAIA,QAAJ,EAAb,CAAR;CACA;;CAED,+CAAOA,QAAP,EAhBWA,QAgBX;CACA;CAjBF;CAAA;CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;ACUA,KAAaK,cAAb;CAAA;;CAWC,0BAAYC,qBAAZ,EACA;CAAA;;CAAA;CACC;;CADD;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAEC,UAAK3L,iBAAL,CAAuB,uBAAvB;;CAEA,yGAA8B2L,qBAA9B;CAJD;CAKC;;CAjBF;CAAA;CAAA,yBAmBMxL,IAnBN,EAmBkCC,QAnBlC,EAoBC;CACC,UAAI,CAACjD,cAAI,CAACmD,aAAL,CAAmBH,IAAnB,CAAL,EACA;CACCA,QAAAA,IAAI,GAAG,EAAP;CACA;;CAED,2DAAiBC,QAAQ,CAACwL,MAAT,KAAoBtM,QAAQ,CAACkB,IAAT,EAApB,GAAsCJ,QAAvD;CACA,6DAAqBjD,cAAI,CAACS,OAAL,CAAauC,IAAI,CAAC0L,QAAlB,IAA8B1L,IAAI,CAAC0L,QAAnC,GAA8C,EAAnE;CACA,4DAAoB5I,QAAQ,CAACkF,gBAAT,CAA0B,8BAA1B,CAApB;CACA,0DAAkB,gEAA4BA,gBAA5B,CAA6C,4BAA7C,CAAlB;CACA,6DAAqB,gEAA4BA,gBAA5B,CAA6C,+BAA7C,CAArB;CACA,yDAAiB,KAAjB;CACA,WAAK2D,WAAL;CACA,WAAKC,YAAL;CAEA,WAAKC,YAAL,CAAkB,KAAlB,EAfD;;CAkBC,4DAAkBnO,OAAlB,CAA0B,UAAAoO,UAAU;CAAA,eAAIzG,IAAI,CAACE,YAAL,CAAkBuG,UAAlB,EAA8B,EAA9B,CAAJ;CAAA,OAApC;CAEAtF,MAAAA,GAAG,CAAC5B,EAAJ,CAAOmH,cAAP,CACCvF,GADD,EAEC,mCAFD,EAGC,KAAKwF,gBAAL,CAAsBvJ,IAAtB,CAA2B,IAA3B,CAHD;CAKA;CA7CF;CAAA;CAAA,2BA+CQzC,IA/CR,EA+CoCC,QA/CpC,EAgDC;CACC,UAAI,CAACjD,cAAI,CAACmD,aAAL,CAAmBH,IAAnB,CAAL,EACA;CACCA,QAAAA,IAAI,GAAG,EAAP;CACA;;CAED,2DAAiBC,QAAQ,IAAId,QAAQ,CAACQ,IAAT,EAA7B;CACA,0DAAgBjC,OAAhB,CAAwB,UAAA6C,IAAI;CAAA,eAAI0B,aAAG,CAACgK,KAAJ,CAAU1L,IAAV,CAAJ;CAAA,OAA5B;CACA,6DAAmB7C,OAAnB,CAA2B,UAAA6C,IAAI;CAAA,eAAI0B,aAAG,CAACgK,KAAJ,CAAU1L,IAAV,CAAJ;CAAA,OAA/B;CAEA,6DAAqBvD,cAAI,CAACS,OAAL,CAAauC,IAAI,CAAC0L,QAAlB,IAA8B1L,IAAI,CAAC0L,QAAnC,GAA8C,EAAnE;CAEA,WAAKE,YAAL;CACA,WAAKD,WAAL;CAEA,WAAKE,YAAL,CAAkB,KAAlB;CACA;CAhEF;CAAA;CAAA,mCAmEC;CAAA;;CACC,yDAAiB,EAAjB;CACA,6DAAmBnO,OAAnB,CAA2B,UAACmK,WAAD,EAAiB;CAC3C,YAAM9G,OAAO,GAAG,IAAInB,OAAJ,EAAhB;CACAmB,QAAAA,OAAO,CAACoD,IAAR,CAAa0D,WAAb,oCAA0B,MAA1B;;CACA,QAAA,MAAI,CAACqE,sBAAL,CAA4BnL,OAA5B;;CACA,QAAA,MAAI,CAACoL,iBAAL,CAAuBpL,OAAO,CAACiC,WAAR,EAAvB,EAA8CjC,OAAO,CAACR,IAAtD;;CACA,0CAAA,MAAI,YAAJ,CAAe1C,IAAf,CAAoBkD,OAApB;CACA,OAND;CAOA;CA5EF;CAAA;CAAA,2CA8EwBA,OA9ExB,EA+EC;CAAA;;CACCA,MAAAA,OAAO,CAACqL,SAAR,CAAkB,gBAAlB,EAAoC,UAACrI,KAAD,EAAW;CAC9C,YAAMhD,OAAO,GAAGgD,KAAK,CAAC/D,IAAN,CAAWe,OAA3B;CAEA,0CAAA,MAAI,YAAJ,CAAelD,IAAf,CAAoBkD,OAApB;;CACA,YAAI,CAACgD,KAAK,CAAC/D,IAAN,CAAWwH,UAAhB,EACA;CACC,UAAA,MAAI,CAAC2E,iBAAL,CAAuBpL,OAAO,CAACiC,WAAR,EAAvB,EAA8CjC,OAAO,CAACR,IAAtD;CACA;;CACD,QAAA,MAAI,CAAC2L,sBAAL,CAA4BnL,OAA5B;;CACA,QAAA,MAAI,CAAC8K,YAAL;CACA,OAVD;CAWA9K,MAAAA,OAAO,CAACqL,SAAR,CAAkB,kBAAlB,EAAsC;CAAA,eAAM,MAAI,CAACP,YAAL,EAAN;CAAA,OAAtC;CACA9K,MAAAA,OAAO,CAACqL,SAAR,CAAkB,wBAAlB,EAA4C,UAACrI,KAAD,EAAW;CACtD,QAAA,MAAI,CAACsI,yBAAL,CAA+BtI,KAAK,CAAC/D,IAAN,CAAWe,OAA1C;CACA,OAFD;CAGAA,MAAAA,OAAO,CAACqL,SAAR,CAAkB,iBAAlB,EAAqC,UAACrI,KAAD;CAAA,eAAW,MAAI,CAACuI,aAAL,CAAmBvI,KAAK,CAAC/D,IAAN,CAAWe,OAA9B,CAAX;CAAA,OAArC;CAEA;CAjGF;CAAA;CAAA,6BAmGUgD,KAnGV,EAoGC;CACC,yDAAerG,OAAf,CAAuB,UAAAqD,OAAO;CAAA,eAAIA,OAAO,CAACwL,QAAR,CAAiBxI,KAAjB,CAAJ;CAAA,OAA9B;CACA;CAtGF;CAAA;CAAA,kCAyGC;CAAA;;CACC,UAAI,qDAAejC,MAAf,EAAJ,EACA;CACC,+DAAmBpE,OAAnB,CAA2B,UAAA6C,IAAI;CAAA,iBAAI,MAAI,CAACiM,eAAL,CAAqBjM,IAArB,CAAJ;CAAA,SAA/B;CACA;CACD;CA9GF;CAAA;CAAA,uCAiHC;CACC,2DAAiBpB,QAAQ,CAACsN,MAAT,EAAjB;CACA,UAAMC,aAAa,GAAG5J,QAAQ,CAACkF,gBAAT,CAA0B,kCAA1B,CAAtB;CACA0E,MAAAA,aAAa,CAAChP,OAAd,CAAsB,UAAA6C,IAAI;CAAA,eAAI0B,aAAG,CAACwI,IAAJ,CAASlK,IAAT,CAAJ;CAAA,OAA1B;CAEA,yDAAe7C,OAAf,CAAuB,UAAAqD,OAAO;CAAA,eAAIkB,aAAG,CAAC0K,QAAJ,CAAa5L,OAAO,CAACR,IAArB,EAA2B,eAA3B,CAAJ;CAAA,OAA9B;CACA;CAvHF;CAAA;CAAA,wCA0HC;CACC,2DAAiBpB,QAAQ,CAACkB,IAAT,EAAjB;CACA,UAAMqM,aAAa,GAAG5J,QAAQ,CAACkF,gBAAT,CAA0B,kCAA1B,CAAtB;CACA0E,MAAAA,aAAa,CAAChP,OAAd,CAAsB,UAAA6C,IAAI;CAAA,eAAI0B,aAAG,CAAC2H,IAAJ,CAASrJ,IAAT,CAAJ;CAAA,OAA1B;CAEA,yDAAe7C,OAAf,CAAuB,UAAAqD,OAAO;CAAA,eAAIkB,aAAG,CAAC2K,WAAJ,CAAgB7L,OAAO,CAACR,IAAxB,EAA8B,eAA9B,CAAJ;CAAA,OAA9B;CACA;CAhIF;CAAA;CAAA,oCAkIiBsM,aAlIjB,EAmIC;CACC,UAAMC,IAAI,GAAG,IAAb;CACA,UAAM3J,GAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC9BmH,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KADO,iBACDhJ,KADC,EAEP;CACC,gBAAI,CAAC+I,IAAI,CAACnM,OAAL,EAAL,EACA;CACCgD,cAAAA,QAAQ,CAACC,qBAAT,CAA+B,IAA/B;CACA,aAHD,MAIK,IAAI,CAAC,kCAAAkJ,IAAI,cAAJ,CAAejJ,QAAf,EAAL,EACL;CACCiJ,cAAAA,IAAI,CAACE,gBAAL,CAAsB,IAAtB;CACA;CACD;CAXM,SADsB;CAc9B7K,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,4BADL;CAEN,4BAAkByK,aAAa,CAACjG,YAAd,CAA2B,gBAA3B;CAFZ,SAduB;CAkB9BxD,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADW;CAIlBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,4BAAf;CAJY,SAAnB,CADS;CAlBoB,OAAnB,CAAZ;CA4BAsK,MAAAA,aAAa,CAACrJ,WAAd,CAA0BL,GAA1B;CACA;CAlKF;CAAA;CAAA,qCAoKkBO,MApKlB,EAoKuCuJ,OApKvC,EAqKC;CAAA;;CACC,UAAMH,IAAI,GAAG,IAAb;;CACA,UAAMI,WAAW,GAAG,SAAdA,WAAc,CAASnJ,KAAT,EAAgBoJ,IAAhB,EACpB;CACCL,QAAAA,IAAI,CAACM,UAAL,CAAgBD,IAAI,CAACtF,WAArB,EAAkC,UAAS9G,OAAT,EAClC;CACC,eAAKsL,yBAAL,CAA+BtL,OAA/B,EAAwCkM,OAAxC;CACA,SAHD;CAKA,aAAKI,WAAL,CAAiB7C,KAAjB;CACA,OARD;;CAUA,UAAM8C,SAAS,GAAG,EAAlB;CACA5M,MAAAA,mCAAgB,GAAGM,iBAAnB,CAAqCtD,OAArC,CAA6C,UAAC6P,gBAAD,EAAsB;CAClE,YAAIA,gBAAgB,CAACC,IAAjB,KAA0B,KAA9B,EACA;CACCF,UAAAA,SAAS,CAACzP,IAAV,CAAe,MAAI,CAAC4P,wBAAL,CACd/J,MAAM,CAACkD,YAAP,CAAoB,gBAApB,CADc,EAEd2G,gBAFc,CAAf;CAIA,SAND,MAQA;CACCD,UAAAA,SAAS,CAACzP,IAAV,CAAe;CACdwE,YAAAA,IAAI,EAAEkL,gBAAgB,CAACrM,IADT;CAEd2G,YAAAA,WAAW,EAAE;CACZ6F,cAAAA,eAAe,EAAEhK,MAAM,CAACkD,YAAP,CAAoB,gBAApB,KAAyCqG,OAAO,CAAC7F,QADtD;CAEZoG,cAAAA,IAAI,EAAED,gBAAgB,CAACC;CAFX,aAFC;CAMdG,YAAAA,OAAO,EAAET;CANK,WAAf;CAQA;CACD,OAnBD;CAqBAU,MAAAA,sBAAW,CAAChE,IAAZ,CACCe,MAAM,CAACkD,gBAAP,EADD,EAECnK,MAFD,EAGC4J,SAHD,EAIC;CACCtE,QAAAA,QAAQ,EAAE,IADX;CAECE,QAAAA,UAAU,EAAGjH,aAAG,CAACsI,WAAJ,CAAgB7G,MAAhB,EAAwB,OAAxB,IAAmC,CAFjD;CAGC4G,QAAAA,KAAK,EAAE;CAAErE,UAAAA,QAAQ,EAAE,KAAZ;CAAmB0D,UAAAA,MAAM,EAAE;CAA3B,SAHR;CAICN,QAAAA,MAAM,EAAG;CACRC,UAAAA,YADQ,0BAER;CACC,iBAAKC,OAAL;CACA;CAJO;CAJV,OAJD;CAgBA;CAvNF;CAAA;CAAA,yCAyNsBnC,QAzNtB,EAyNwCrD,KAzNxC,EA0NC;CACC,WAAKiJ,gBAAL,CAAsBjJ,KAAK,CAAC+J,MAA5B,EAAoC;CAACC,QAAAA,aAAa,EAAE,IAAhB;CAAsB3G,QAAAA,QAAQ,EAAEA;CAAhC,OAApC;CACA;CA5NF;CAAA;CAAA,6CA8N0B3F,MA9N1B,EA8NkCoG,WA9NlC,EA+NC;CACC,UAAMiF,IAAI,GAAG,IAAb;;CACA,UAAMI,WAAW,GAAG,SAAdA,WAAc,CAASc,CAAT,EAAYb,IAAZ,EACpB;CACCL,QAAAA,IAAI,CAACM,UAAL,CAAgBD,IAAI,CAACtF,WAArB,EAAkC,UAAS9G,OAAT,EAClC;CACC,eAAKsL,yBAAL,CAA+BtL,OAA/B;CACA,SAHD;CAKA,aAAKkN,iBAAL,GAAyBzD,KAAzB;CACA,OARD;;CAUA,UAAM8C,SAAS,GAAG,EAAlB;;CACA,WAAK,IAAIxC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjD,WAAW,CAAC,UAAD,CAAX,CAAwBD,MAA5C,EAAoD,EAAEkD,CAAtD,EACA;CACC,YAAMqC,IAAI,GAAGtF,WAAW,CAAC,UAAD,CAAX,CAAwBiD,CAAxB,CAAb;CACA,YAAMoD,QAAQ,GAAG,MAAMf,IAAI,CAAC,UAAD,CAAV,GAAyB,IAAzB,GAAgCA,IAAI,CAAC,MAAD,CAArD;CACAG,QAAAA,SAAS,CAACzP,IAAV,CAAe;CACdwE,UAAAA,IAAI,EAAEoG,cAAI,CAACC,MAAL,CAAYwF,QAAZ,CADQ;CAEdrG,UAAAA,WAAW,EAAE;CACZ6F,YAAAA,eAAe,EAAEjM,MADL;CAEZP,YAAAA,IAAI,EAAEgN,QAFM;CAGZV,YAAAA,IAAI,EAAE3F,WAAW,CAAC2F,IAHN;CAIZ9F,YAAAA,WAAW,EAAE;CACZyG,cAAAA,MAAM,EAAEhB,IAAI,CAAC,QAAD,CADA;CAEZK,cAAAA,IAAI,EAAEL,IAAI,CAAC,MAAD;CAFE;CAJD,WAFC;CAWdQ,UAAAA,OAAO,EAAET;CAXK,SAAf;CAaA;;CAED,UAAIkB,oBAAU,CAACC,QAAX,CAAoB,qBAApB,CAAJ,EACA;CACC,YAAIf,SAAS,CAAC1F,MAAd,EACA;CACC0F,UAAAA,SAAS,CAACzP,IAAV,CAAe;CAAEyQ,YAAAA,SAAS,EAAE;CAAb,WAAf;CACA;;CAEDhB,QAAAA,SAAS,CAACzP,IAAV,CAAe;CACdwE,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uDAAf,CADQ;CAEdoL,UAAAA,OAAO,EAAE,mBACT;CACC/I,YAAAA,EAAE,CAAC2J,IAAH,CAAQC,WAAR,CAAoBC,IAApB,CAAyB;CAACC,cAAAA,SAAS,EAAEhO,mCAAgB,GAAGiO,GAAnB,CAAuB,0BAAvB;CAAZ,aAAzB;CACA,iBAAKV,iBAAL,GAAyBzD,KAAzB;CACA;CANa,SAAf;CAQA;;CAED,aAAO;CACNnI,QAAAA,IAAI,EAAEwF,WAAW,CAAC3G,IADZ;CAENyG,QAAAA,KAAK,EAAE2F;CAFD,OAAP;CAIA;CApRF;CAAA;CAAA,+BAsRYzF,WAtRZ,EAsR+C+G,QAtR/C,EAuRC;CACC,UAAM7N,OAAO,GAAG,IAAInB,OAAJ,EAAhB;CACAmB,MAAAA,OAAO,CAACoD,IAAR,CAAa0D,WAAb,oCAA0B,IAA1B;CACA,WAAKqE,sBAAL,CAA4BnL,OAA5B;CACAA,MAAAA,OAAO,CAACjB,KAAR,GAAgB,IAAhB;;CACA,UAAI8O,QAAJ,EACA;CACCA,QAAAA,QAAQ,CAACC,IAAT,CAAc,IAAd,EAAoB9N,OAApB;CACA;CACD;CAhSF;CAAA;CAAA,kCAkSeA,OAlSf,EAkSiC6N,QAlSjC,EAmSC;CACC,UAAI7N,OAAO,CAACS,KAAR,KAAkB,CAAtB,EACA;CACCT,QAAAA,OAAO,CAAC+N,WAAR;CACA,OAHD,MAKA;CACC,aAAI,IAAIhE,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,mDAAelD,MAAlC,EAA0C,EAAEkD,CAA5C,EACA;CACC,cAAI,mDAAeA,CAAf,MAAsB/J,OAA1B,EACA;CACC,+DAAegO,MAAf,CAAsBjE,CAAtB,EAAyB,CAAzB;CACA;CACD;CACD;;CAED,UAAI8D,QAAJ,EACA;CACCA,QAAAA,QAAQ,CAAC7N,OAAD,CAAR;CACA;;CAED,WAAK8K,YAAL;CACA;CAzTF;CAAA;CAAA,wCA4TC;CACC,yDAAenO,OAAf,CAAuB,UAAAqD,OAAO;CAAA,eAAIA,OAAO,CAACsC,YAAR,CAAqBtC,OAAO,CAACR,IAA7B,CAAJ;CAAA,OAA9B;CACA,sEAA4ByH,gBAA5B,CAA6C,0CAA7C,EAAyFtK,OAAzF,CAAiG,UAAC6C,IAAD,EAAU;CAC1G0B,QAAAA,aAAG,CAAC0K,QAAJ,CAAapM,IAAb,EAAmB,mDAAnB;CACA,OAFD;CAGA;CAjUF;CAAA;CAAA,yCAoUC;CACC,yDAAe7C,OAAf,CAAuB,UAAAqD,OAAO;CAAA,eAAIA,OAAO,CAACiO,cAAR,CAAuBjO,OAAO,CAACR,IAA/B,CAAJ;CAAA,OAA9B;CACA,sEAA4ByH,gBAA5B,CAA6C,0CAA7C,EAAyFtK,OAAzF,CAAiG,UAAC6C,IAAD,EAAU;CAC1G0B,QAAAA,aAAG,CAAC2K,WAAJ,CAAgBrM,IAAhB,EAAsB,mDAAtB;CACA,OAFD;CAGA;CAzUF;CAAA;CAAA,sCA2UmB0O,cA3UnB,EA2U2CC,WA3U3C,EA4UC;CACC,UAAMC,QAAQ,GAAG,gEAA4BtI,aAA5B,CAA0C,gDAA8CoI,cAA9C,GAA6D,IAAvG,CAAjB;;CACA,UAAIE,QAAJ,EACA;CACCA,QAAAA,QAAQ,CAAC3L,WAAT,CAAqB0L,WAArB;CACA;CACD;CAlVF;CAAA;CAAA,gCAqVC;CACC,aAAO,mDAAejQ,GAAf,CAAmB,UAAA8B,OAAO;CAAA,eAAIA,OAAO,CAACmD,SAAR,EAAJ;CAAA,OAA1B,CAAP;CACA;CAvVF;CAAA;CAAA,uCA0VC;CACC,aAAO,mDAAekL,MAAf,CAAsB,UAAArO,OAAO;CAAA,eAAI,CAACA,OAAO,CAACsO,OAAb;CAAA,OAA7B,EAAmDzH,MAA1D;CACA;CA5VF;CAAA;CAAA,mCA8VgB/G,IA9VhB,EA+VC;CAAA;;CACC,gEAAOH,mCAAgB,GAAGM,iBAAnB,CAAqCC,IAArC,CAA0C,UAACF,OAAD;CAAA,eAAaF,IAAI,KAAKE,OAAO,CAAC,MAAD,CAA7B;CAAA,OAA1C,CAAP,2DAAO,uBAAkFG,IAAzF,yEAAiGL,IAAjG;CACA;CAjWF;CAAA;CAAA,wCAmWqBA,IAnWrB,EAoWC;CACC,UAAMG,iBAAiB,GAAGN,mCAAgB,GAAGM,iBAA7C;;CACA,WAAK,IAAI8J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG9J,iBAAiB,CAAC4G,MAAtC,EAA8C,EAAEkD,CAAhD,EACA;CACC,YAAIjK,IAAI,KAAKG,iBAAiB,CAAC8J,CAAD,CAAjB,CAAqB,MAArB,CAAb,EACA;CACC,iBAAO9J,iBAAiB,CAAC8J,CAAD,CAAxB;CACA;CACD;;CAED,aAAO,IAAP;CACA;CA/WF;CAAA;CAAA,8BAkXC;CACC,aAAOpK,mCAAgB,GAAGC,OAA1B;CACA;CApXF;CAAA;CAAA,sCAuXC;CAAA;;CACC,sCAAOD,mCAAgB,GAAGiO,GAAnB,CAAuB,4BAAvB,CAAP,yEAA+D,KAA/D;CACA;CAzXF;CAAA;CAAA,+BA4XC;CACC,+CAAO,IAAP;CACA;CA9XF;CAAA;CAAA,iCAgYcW,QAhYd,EAiYC;CACC,yDAAiBA,QAAQ,KAAK,KAA9B;;CACA,4CAAI,IAAJ,cACA;CACC,aAAKxL,IAAL,CAAU,6BAAV;CACA;CACD;CAvYF;CAAA;CAAA,8CAyY2B/C,OAzY3B,EAyYoCkM,OAzYpC,EA0YC;CAAA;;CACC,UAAI/B,QAAQ,CAACqE,WAAT,GAAuBC,wBAAvB,EAAJ,EACA;CACC,YAAIvC,OAAO,IAAIA,OAAO,CAACc,aAAvB,EACA;CACC7C,UAAAA,QAAQ,CAACqE,WAAT,GAAuBC,wBAAvB,GAAkDC,KAAlD,CAAwDjF,KAAxD;CACA,SAHD,MAKA;CACC;CACA;CACD;;CAED,UAAMkF,QAAQ,GAAG,mCAAjB;CACA,UAAMC,IAAI,GAAG1N,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC/B0N,QAAAA,KAAK,EAAE;CACNvQ,UAAAA,IAAI,EAAEqQ;CADA,SADwB;CAI/B1J,QAAAA,KAAK,EAAE;CAAC,uBAAa;CAAd;CAJwB,OAAnB,CAAb;CAOA2J,MAAAA,IAAI,CAACnM,WAAL,CAAiB,KAAKqM,uBAAL,CAA6B9O,OAA7B,CAAjB;CAEA,UAAM+O,QAAQ,GAAG7N,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCiH,QAAAA,MAAM,EAAE;CAAC0D,UAAAA,KAAK,EAAE,eAAChJ,KAAD;CAAA,mBAAW,MAAI,CAACD,IAAL,CAAU,4BAAV,EAAwCC,KAAxC,CAAX;CAAA;CAAR;CAF0B,OAAlB,CAAjB;CAIA4L,MAAAA,IAAI,CAACnM,WAAL,CAAiBsM,QAAjB;CAEA,UAAMC,KAAK,GAAG,KAAKC,cAAL,CAAoBjP,OAAO,CAACD,OAAR,EAApB,CAAd;CAEA6O,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACnCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD4B;CAEnCC,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,qCAAf,IAAwD;CAF3B,OAAnB,CAAjB;CAKAoN,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCgB,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACnBC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE,gCADL;CAENuE,YAAAA,IAAI,EAAE,MAFA;CAGNtH,YAAAA,IAAI,EAAE,MAHA;CAINC,YAAAA,KAAK,EAAEyB,OAAO,CAACkC,OAAR,MAAqB8M;CAJtB;CADY,SAApB,CADS;CAFwB,OAAlB,CAAjB,EApCD;;CAmDC,UAAMlI,WAAW,GAAG,KAAKoI,mBAAL,CAAyBlP,OAAO,CAACD,OAAR,EAAzB,CAApB;;CACA,UAAIC,OAAO,CAACD,OAAR,OAAsB,SAA1B,EACA;CACC,YAAI,CAACC,OAAO,CAACmP,aAAR,GAAwB,MAAxB,CAAL,EACA;CACCnP,UAAAA,OAAO,CAACmP,aAAR,GAAwB,MAAxB,IAAkCzH,cAAI,CAAC0H,SAAL,CAAe,CAAf,CAAlC;CACA;;CAEDR,QAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACnCC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WAD4B;CAEnCC,UAAAA,IAAI,EAAE;CAF6B,SAAnB,CAAjB;CAKAsN,QAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACpC0N,UAAAA,KAAK,EAAE;CACNjJ,YAAAA,IAAI,EAAE,QADA;CAENrH,YAAAA,KAAK,EAAEyB,OAAO,CAACmP,aAAR,GAAwB,MAAxB,CAFD;CAGN7Q,YAAAA,IAAI,EAAE;CAHA;CAD6B,SAApB,CAAjB;CAQA,YAAM+Q,gBAAgB,GAAGnO,aAAG,CAACC,MAAJ,CAAW,UAAX,EAAuB;CAC/CC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE,mCADL;CAENiO,YAAAA,WAAW,EAAE,KAFP;CAGNC,YAAAA,QAAQ,EAAE,UAHJ;CAINjR,YAAAA,IAAI,EAAE;CAJA,WADwC;CAO/CgK,UAAAA,MAAM,EAAE;CACP0D,YAAAA,KADO,iBACDiB,CADC,EAEP;CACC,mBAAKuC,MAAL;CACA;CAJM;CAPuC,SAAvB,CAAzB;CAeAZ,QAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WAD2B;CAElCgB,UAAAA,QAAQ,EAAE,CAACgN,gBAAD;CAFwB,SAAlB,CAAjB;CAKAT,QAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACnCC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WAD4B;CAEnCC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf;CAF6B,SAAnB,CAAjB;;CAKA,YAAIsF,WAAW,IAAIA,WAAW,CAAC,SAAD,CAA9B,EACA;CACC,cAAI2I,GAAG,GAAG1J,MAAM,CAAC2J,QAAP,CAAgBC,QAAhB,GAA2B,IAA3B,GAAkC5J,MAAM,CAAC2J,QAAP,CAAgBE,IAAlD,GAAyD9I,WAAW,CAAC,SAAD,CAA9E;CACA2I,UAAAA,GAAG,GAAGI,aAAG,CAACC,QAAJ,CAAaL,GAAb,EAAkB;CAAC3P,YAAAA,IAAI,EAAEE,OAAO,CAACmP,aAAR,GAAwB,MAAxB;CAAP,WAAlB,CAAN;CACAM,UAAAA,GAAG,GAAGA,GAAG,CAACM,OAAJ,CAAY,mBAAZ,EAAiCpQ,mCAAgB,GAAGoC,QAAnB,CAA4BiO,UAA5B,GAAyC,CAAzC,CAAjC,CAAN;CACAX,UAAAA,gBAAgB,CAAC9Q,KAAjB,GAAyBkR,GAAzB;CACA;CACD,OApDD,MAqDK,IAAIzP,OAAO,CAACD,OAAR,OAAsB,YAA1B,EACL;CACC6O,QAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACnCC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WAD4B;CAEnCC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,2CAAf,IAA8D;CAFjC,SAAnB,CAAjB;CAKAoN,QAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WAD2B;CAElCgB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,UAAX,EAAuB;CACtBC,YAAAA,KAAK,EAAE;CACNC,cAAAA,SAAS,EAAE,mCADL;CAENiO,cAAAA,WAAW,EAAE;CAFP,aADe;CAKtBT,YAAAA,KAAK,EAAE;CAACvQ,cAAAA,IAAI,EAAE;CAAP,aALe;CAMtBgD,YAAAA,IAAI,EAAEtB,OAAO,CAACmP,aAAR,GAAwB,KAAxB,KAAkC;CANlB,WAAvB,CADS;CAFwB,SAAlB,CAAjB;CAaA,OApBI,MAqBA,IAAInP,OAAO,CAACD,OAAR,OAAsB,SAA1B,EACL;CACC,YAAI+G,WAAW,IAAIA,WAAW,CAAC,cAAD,CAA9B,EACA;CACC,cAAM0I,MAAM,GAAGtO,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACnCC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aAD4B;CAEnCwN,YAAAA,KAAK,EAAE;CACNvQ,cAAAA,IAAI,EAAE,SADA;CAENC,cAAAA,KAAK,EAAE;CAFD,aAF4B;CAMnC8D,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACpB0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE;CAAR,eADa;CAEpB+C,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,wCAAf;CAFc,aAArB,CADS;CANyB,WAArB,CAAf;;CAcA,eAAK,IAAIuI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjD,WAAW,CAAC,cAAD,CAAX,CAA4BD,MAAhD,EAAwD,EAAEkD,CAA1D,EACA;CACC,gBAAMqC,IAAI,GAAGtF,WAAW,CAAC,cAAD,CAAX,CAA4BiD,CAA5B,CAAb;CACAyF,YAAAA,MAAM,CAAC/M,WAAP,CAAmBvB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACvC0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE6N,IAAI,CAAC,IAAD;CAAZ,eADgC;CAEvC9K,cAAAA,IAAI,EAAE8K,IAAI,CAAC,MAAD;CAF6B,aAArB,CAAnB;CAIA;;CACD,cAAInQ,cAAI,CAACmD,aAAL,CAAmBY,OAAO,CAACmP,aAAR,EAAnB,KAA+CnP,OAAO,CAACmP,aAAR,GAAwB,SAAxB,CAAnD,EACA;CACCK,YAAAA,MAAM,CAACjR,KAAP,GAAeyB,OAAO,CAACmP,aAAR,GAAwB,SAAxB,CAAf;CACA;;CAED,cAAM/M,GAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,YAAAA,KAAK,EAAE;CACNC,cAAAA,SAAS,EAAE;CADL,aADsB;CAI7BgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,cAAAA,KAAK,EAAE;CACNC,gBAAAA,SAAS,EAAE;CADL,eADW;CAIlBC,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,0CAAf,IAA6D;CAJjD,aAAnB,CADS,EAOTgO,MAPS;CAJmB,WAAlB,CAAZ;CAcAZ,UAAAA,IAAI,CAACnM,WAAL,CAAiBL,GAAjB;CACA;CACD,OA/CI,MAgDA,IAAIpC,OAAO,CAACD,OAAR,OAAsB,UAA1B,EACL;CACC,YAAI+G,WAAW,IAAIA,WAAW,CAAC,cAAD,CAA9B,EACA;CACC,cAAM0I,OAAM,GAAGtO,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACnCC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aAD4B;CAEnCwN,YAAAA,KAAK,EAAE;CACNvQ,cAAAA,IAAI,EAAE,SADA;CAENC,cAAAA,KAAK,EAAE;CAFD,aAF4B;CAMnC8D,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACpB0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE;CAAR,eADa;CAEpB+C,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,wCAAf;CAFc,aAArB,CADS;CANyB,WAArB,CAAf;;CAcA,eAAK,IAAIuI,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAGjD,WAAW,CAAC,cAAD,CAAX,CAA4BD,MAAhD,EAAwD,EAAEkD,EAA1D,EACA;CACC,gBAAMqC,KAAI,GAAGtF,WAAW,CAAC,cAAD,CAAX,CAA4BiD,EAA5B,CAAb;;CACAyF,YAAAA,OAAM,CAAC/M,WAAP,CACCvB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACpB0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE6N,KAAI,CAAC,IAAD;CAAZ,eADa;CAEpB9K,cAAAA,IAAI,EAAE8K,KAAI,CAAC,MAAD;CAFU,aAArB,CADD;CAMA;;CACD,cAAInQ,cAAI,CAACmD,aAAL,CAAmBY,OAAO,CAACmP,aAAR,EAAnB,KAA+CnP,OAAO,CAACmP,aAAR,GAAwB,SAAxB,CAAnD,EACA;CACCK,YAAAA,OAAM,CAACjR,KAAP,GAAeyB,OAAO,CAACmP,aAAR,GAAwB,SAAxB,CAAf;CACA;;CAED,cAAM/M,IAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,YAAAA,KAAK,EAAE;CACNC,cAAAA,SAAS,EAAE;CADL,aADsB;CAI7BgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,cAAAA,KAAK,EAAE;CACNC,gBAAAA,SAAS,EAAE;CADL,eADW;CAIlBC,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,0CAAf,IAA6D;CAJjD,aAAnB,CADS,EAMTgO,OANS;CAJmB,WAAlB,CAAZ;;CAaAZ,UAAAA,IAAI,CAACnM,WAAL,CAAiBL,IAAjB;CACA;CACD,OAhDI,MAiDA,IAAIpC,OAAO,CAACD,OAAR,OAAsB,QAA1B,EACL;CACC,YAAI+G,WAAW,IAAIA,WAAW,CAAC,aAAD,CAA9B,EACA;CACC,cAAM0I,QAAM,GAAGtO,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACnCC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aAD4B;CAEnCwN,YAAAA,KAAK,EAAE;CACNvQ,cAAAA,IAAI,EAAE,QADA;CAENC,cAAAA,KAAK,EAAE;CAFD,aAF4B;CAMnC8D,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACpB0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE;CAAR,eADa;CAEpB+C,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uCAAf;CAFc,aAArB,CADS;CANyB,WAArB,CAAf;;CAcA,eAAK,IAAIuI,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGjD,WAAW,CAAC,aAAD,CAAX,CAA2BD,MAA/C,EAAuD,EAAEkD,GAAzD,EACA;CACC,gBAAMqC,MAAI,GAAGtF,WAAW,CAAC,aAAD,CAAX,CAA2BiD,GAA3B,CAAb;;CACAyF,YAAAA,QAAM,CAAC/M,WAAP,CAAmBvB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACvC0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE6N,MAAI,CAAC,IAAD;CAAZ,eADgC;CAEvC9K,cAAAA,IAAI,EAAE8K,MAAI,CAAC,MAAD;CAF6B,aAArB,CAAnB;CAIA;;CACD,cAAInQ,cAAI,CAACmD,aAAL,CAAmBY,OAAO,CAACmP,aAAR,EAAnB,KAA+CnP,OAAO,CAACmP,aAAR,GAAwB,QAAxB,CAAnD,EACA;CACCK,YAAAA,QAAM,CAACjR,KAAP,GAAeyB,OAAO,CAACmP,aAAR,GAAwB,QAAxB,CAAf;CACA;;CAED,cAAM/M,KAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aADsB;CAE7BgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,cAAAA,KAAK,EAAE;CACNC,gBAAAA,SAAS,EAAE;CADL,eADW;CAIlBC,cAAAA,IAAI,EAAEwF,WAAW,CAAC,cAAD,CAAX,GAA8B;CAJlB,aAAnB,CADS,EAOT0I,QAPS;CAFmB,WAAlB,CAAZ;;CAYAZ,UAAAA,IAAI,CAACnM,WAAL,CAAiBL,KAAjB;CACA;CACD,OA7CI,MA8CA,IAAIpC,OAAO,CAACD,OAAR,MAAqB,MAAzB,EACL;CACC,YAAI+G,WAAW,IAAIA,WAAW,CAAC,OAAD,CAA9B,EACA;CACC,cAAM0I,QAAM,GAAGtO,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACnCC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aAD4B;CAEnCwN,YAAAA,KAAK,EAAE;CACNvQ,cAAAA,IAAI,EAAE,aADA;CAENC,cAAAA,KAAK,EAAE;CAFD,aAF4B;CAMnC8D,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACpB0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE;CAAR,eADa;CAEpB+C,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,wCAAf;CAFc,aAArB,CADS;CANyB,WAArB,CAAf;;CAcA,eAAK,IAAIuI,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGjD,WAAW,CAAC,OAAD,CAAX,CAAqBD,MAAzC,EAAiD,EAAEkD,GAAnD,EACA;CACC,gBAAMqC,MAAI,GAAGtF,WAAW,CAAC,OAAD,CAAX,CAAqBiD,GAArB,CAAb;;CACAyF,YAAAA,QAAM,CAAC/M,WAAP,CAAmBvB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACvC0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE6N,MAAI,CAAC,aAAD;CAAZ,eADgC;CAEvC9K,cAAAA,IAAI,EAAE8K,MAAI,CAAC,YAAD;CAF6B,aAArB,CAAnB;CAIA;;CACD,cAAIpM,OAAO,CAACmP,aAAR,GAAwB,aAAxB,CAAJ,EACA;CACCK,YAAAA,QAAM,CAACjR,KAAP,GAAeyB,OAAO,CAACmP,aAAR,GAAwB,aAAxB,CAAf;CACA;;CAED,cAAM/M,KAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aADsB;CAE7BgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,cAAAA,KAAK,EAAE;CACNC,gBAAAA,SAAS,EAAE;CADL,eADW;CAIlBC,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uCAAf,IAA0D;CAJ9C,aAAnB,CADS,EAOTgO,QAPS;CAFmB,WAAlB,CAAZ;;CAYAZ,UAAAA,IAAI,CAACnM,WAAL,CAAiBL,KAAjB;CACA;CACD,OA7CI,MA8CA,IAAIpC,OAAO,CAACD,OAAR,MAAqB,UAArB,IAAmCC,OAAO,CAACD,OAAR,MAAqB,cAA5D,EACL;CACC,YAAI+G,WAAW,IAAIA,WAAW,CAAC,aAAD,CAA9B,EACA;CACC,cAAM0I,QAAM,GAAGtO,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACnCC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aAD4B;CAEnCwN,YAAAA,KAAK,EAAE;CACNvQ,cAAAA,IAAI,EAAE,WADA;CAENC,cAAAA,KAAK,EAAE;CAFD,aAF4B;CAMnC8D,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACpB0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE;CAAR,eADa;CAEpB+C,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,wCAAf;CAFc,aAArB,CADS;CANyB,WAArB,CAAf;;CAcA,eAAK,IAAIuI,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGjD,WAAW,CAAC,aAAD,CAAX,CAA2BD,MAA/C,EAAuD,EAAEkD,GAAzD,EACA;CACC,gBAAMqC,MAAI,GAAGtF,WAAW,CAAC,aAAD,CAAX,CAA2BiD,GAA3B,CAAb;;CACAyF,YAAAA,QAAM,CAAC/M,WAAP,CAAmBvB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACvC0N,cAAAA,KAAK,EAAE;CAACtQ,gBAAAA,KAAK,EAAE6N,MAAI,CAAC,IAAD;CAAZ,eADgC;CAEvC9K,cAAAA,IAAI,EAAE8K,MAAI,CAAC,MAAD;CAF6B,aAArB,CAAnB;CAIA;;CACD,cAAInQ,cAAI,CAACmD,aAAL,CAAmBY,OAAO,CAACmP,aAAR,EAAnB,KAA+CnP,OAAO,CAACmP,aAAR,GAAwB,WAAxB,CAAnD,EACA;CACCK,YAAAA,QAAM,CAACjR,KAAP,GAAeyB,OAAO,CAACmP,aAAR,GAAwB,WAAxB,CAAf;CACA;;CAED,cAAM/M,KAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,YAAAA,KAAK,EAAE;CAACC,cAAAA,SAAS,EAAE;CAAZ,aADsB;CAE7BgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,cAAAA,KAAK,EAAE;CACNC,gBAAAA,SAAS,EAAE;CADL,eADW;CAIlBC,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,2CAAf,IAA8D;CAJlD,aAAnB,CADS,EAOTgO,QAPS;CAFmB,WAAlB,CAAZ;;CAYAZ,UAAAA,IAAI,CAACnM,WAAL,CAAiBL,KAAjB;CACA;CACD;;CAEDyB,MAAAA,EAAE,CAACoM,aAAH,CACC,+DAA+DjQ,OAAO,CAACD,OAAR,EADhE,EAEC,CAACC,OAAD,EAAU4O,IAAV,CAFD;;CAKA,UAAI,KAAKsB,eAAL,EAAJ,EACA;CACC,aAAKC,sBAAL,CAA4BnQ,OAA5B,EAAqC4O,IAArC;CACA;;CAED,WAAKwB,2BAAL,CAAiCpQ,OAAjC,EAA0C4O,IAA1C;CAEA1N,MAAAA,aAAG,CAAC0K,QAAJ,mCAAa,IAAb,2BAA0C,yBAA1C;CAEAzB,MAAAA,QAAQ,CAACqE,WAAT,GAAuB6B,wBAAvB,CAAgD;CAC/CC,QAAAA,cAAc,EAAE,IAD+B;CAE/CtQ,QAAAA,OAAO,EAAEA,OAFsC;CAG/C4O,QAAAA,IAAI,EAAEA;CAHyC,OAAhD;CAMA,UAAM2B,QAAQ,GAAGvQ,OAAO,CAACjB,KAAR,GAAgB,KAAKyR,2BAAL,CAAiCxB,KAAjC,EAAwChP,OAAO,CAACkO,cAAhD,CAAhB,GAAkF,IAAnG;CAEA,UAAMnC,IAAI,GAAG,IAAb;CACA,UAAM2C,KAAK,GAAG,IAAI7K,EAAE,CAACkE,WAAP,CAAmB6B,MAAM,CAACkD,gBAAP,EAAnB,EAA8C,IAA9C,EAAoD;CACjEyD,QAAAA,QAAQ,EAAEA,QAAQ,IAAIvB,KAD2C;CAEjEvG,QAAAA,OAAO,EAAEmG,IAFwD;CAGjE6B,QAAAA,SAAS,EAAE,IAHsD;CAIjEtI,QAAAA,UAAU,EAAE,CAJqD;CAKjEC,QAAAA,SAAS,EAAE,CALsD;CAMjEkB,QAAAA,UAAU,EAAE,IANqD;CAOjEoH,QAAAA,SAAS,EAAE;CAACC,UAAAA,QAAQ,EAAE;CAAX,SAPsD;CAQjEC,QAAAA,OAAO,EAAE,KARwD;CASjEtI,QAAAA,MAAM,EAAE;CACPC,UAAAA,YAAY,EAAE,sBAASmG,KAAT,EACd;CACCvE,YAAAA,QAAQ,CAACqE,WAAT,GAAuB6B,wBAAvB,CAAgD,IAAhD;CACAtE,YAAAA,IAAI,CAAC8E,6BAAL;CACAnC,YAAAA,KAAK,CAAClG,OAAN;CACAtH,YAAAA,aAAG,CAAC2K,WAAJ,mCAAgBE,IAAhB,2BAA6C,yBAA7C;CACA;CAPM,SATyD;CAkBjE+E,QAAAA,OAAO,EAAE,CACR,IAAIjN,EAAE,CAACkN,iBAAP,CAAyB;CACxBzP,UAAAA,IAAI,EAAGC,aAAG,CAACC,UAAJ,CAAe,qBAAf,CADiB;CAExBH,UAAAA,SAAS,EAAG,4BAFY;CAGxBiH,UAAAA,MAAM,EAAG;CACR0D,YAAAA,KADQ,mBACA;CACP,kBAAMgF,QAAQ,GAAGnN,EAAE,CAACoN,IAAH,CAAQC,WAAR,CAAoBtC,IAApB,CAAjB;CACA5O,cAAAA,OAAO,CAACmR,OAAR,CAAgBH,QAAQ,CAAC,MAAD,CAAR,CAAiB,MAAjB,CAAhB,EAFO;;CAKP,kBAAIhR,OAAO,CAACD,OAAR,OAAsB,SAA1B,EACA;CACCC,gBAAAA,OAAO,CAACoR,aAAR,CAAsB;CAACC,kBAAAA,OAAO,EAAGL,QAAQ,CAAC,MAAD,CAAR,CAAiB,SAAjB;CAAX,iBAAtB;CACA;;CACD,kBAAIhR,OAAO,CAACD,OAAR,OAAsB,UAA1B,EACA;CACCC,gBAAAA,OAAO,CAACoR,aAAR,CAAsB;CAACC,kBAAAA,OAAO,EAAEL,QAAQ,CAAC,MAAD,CAAR,CAAiB,SAAjB;CAAV,iBAAtB;CACA;;CACD,kBAAIhR,OAAO,CAACD,OAAR,OAAsB,QAA1B,EACA;CACCC,gBAAAA,OAAO,CAACoR,aAAR,CAAsB;CAACE,kBAAAA,MAAM,EAAEN,QAAQ,CAAC,MAAD,CAAR,CAAiB,QAAjB;CAAT,iBAAtB;CACA;;CACD,kBAAIhR,OAAO,CAACD,OAAR,OAAsB,MAAtB,IAAgC,iBAAiBiR,QAAQ,CAAC,MAAD,CAA7D,EACA;CACChR,gBAAAA,OAAO,CAACoR,aAAR,CAAsB;CAACG,kBAAAA,WAAW,EAAEP,QAAQ,CAAC,MAAD,CAAR,CAAiB,aAAjB;CAAd,iBAAtB;CACA;;CACD,kBAAIhR,OAAO,CAACD,OAAR,OAAsB,UAAtB,IAAoCC,OAAO,CAACD,OAAR,OAAsB,cAA9D,EACA;CACCC,gBAAAA,OAAO,CAACoR,aAAR,CAAsB;CAACI,kBAAAA,SAAS,EAAER,QAAQ,CAAC,MAAD,CAAR,CAAiB,WAAjB;CAAZ,iBAAtB;CACA;;CAED,kBAAIhR,OAAO,CAACD,OAAR,OAAsB,SAA1B,EACA;CACCC,gBAAAA,OAAO,CAACoR,aAAR,CAAsB;CAACtR,kBAAAA,IAAI,EAAEkR,QAAQ,CAAC,MAAD,CAAR,CAAiB,MAAjB;CAAP,iBAAtB;CACA;;CAED,kBAAIhR,OAAO,CAACD,OAAR,OAAsB,YAA1B,EACA;CACCC,gBAAAA,OAAO,CAACoR,aAAR,CAAsB;CAAC3B,kBAAAA,GAAG,EAAEuB,QAAQ,CAAC,MAAD,CAAR,CAAiB,KAAjB;CAAN,iBAAtB;CACA;;CAEDnN,cAAAA,EAAE,CAACoM,aAAH,CACC,yDAAuDjQ,OAAO,CAACD,OAAR,EADxD,EAEC,CAACC,OAAD,EAAUgR,QAAV,CAFD;CAKAjF,cAAAA,IAAI,CAAC0F,4BAAL,CAAkCT,QAAQ,CAAC,MAAD,CAA1C,EAAoDhR,OAApD;CACAA,cAAAA,OAAO,CAAC0R,iBAAR,CAA0BV,QAAQ,CAAC,MAAD,CAAR,CAAiB,iBAAjB,MAAwC,GAAlE;;CAEA,kBAAIjF,IAAI,CAACmE,eAAL,EAAJ,EACA;CACClQ,gBAAAA,OAAO,CAAC2R,YAAR,CAAqBX,QAAQ,CAAC,MAAD,CAAR,CAAiB,YAAjB,CAArB;CACA;;CAED,kBAAIhR,OAAO,CAACjB,KAAZ,EACA;CACC,kDAAAgN,IAAI,YAAJ,CAAejP,IAAf,CAAoBkD,OAApB;CACA+L,gBAAAA,IAAI,CAACX,iBAAL,CAAuBpL,OAAO,CAACiC,WAAR,EAAvB,EAA8CjC,OAAO,CAACR,IAAtD;CACA,eArDM;;;CAwDPyR,cAAAA,cAAI,CAACW,SAAL,CACC,wBADD,EAEC;CACCC,gBAAAA,cAAc,8BAAuB7R,OAAO,CAACjB,KAAR,GAAgB,QAAhB,GAA2B,EAAlD,mBAA6DiB,OAAO,CAACD,OAAR,GAAkB0D,WAAlB,EAA7D;CADf,eAFD;CAOA,qBAAOzD,OAAO,CAACjB,KAAf;CAEAiB,cAAAA,OAAO,CAAC8R,MAAR;CACA/F,cAAAA,IAAI,CAACjB,YAAL;CACA,mBAAKwB,WAAL,CAAiB7C,KAAjB;CACA;CArEO;CAHe,SAAzB,CADQ,EA4ER,IAAI5F,EAAE,CAACkO,qBAAP,CAA6B;CAC5BzQ,UAAAA,IAAI,EAAGC,aAAG,CAACC,UAAJ,CAAe,uBAAf,CADqB;CAE5BH,UAAAA,SAAS,EAAG,iCAFgB;CAG5BiH,UAAAA,MAAM,EAAG;CACR0D,YAAAA,KADQ,mBAER;CACC,mBAAKM,WAAL,CAAiB7C,KAAjB;CACA;CAJO;CAHmB,SAA7B,CA5EQ;CAlBwD,OAApD,CAAd;CA2GAU,MAAAA,QAAQ,CAACqE,WAAT,GAAuBC,wBAAvB,GAAkDC,KAAlD,GAA0DA,KAA1D;CACAA,MAAAA,KAAK,CAAC7F,IAAN,GA7eD;;CAgfCoI,MAAAA,cAAI,CAACW,SAAL,CACC,wBADD,EAEC;CACCC,QAAAA,cAAc,8BAAuB7R,OAAO,CAACjB,KAAR,GAAgB,QAAhB,GAA2B,EAAlD,uBAAiEiB,OAAO,CAACD,OAAR,GAAkB0D,WAAlB,EAAjE;CADf,OAFD;CAMA;CAh4BF;CAAA;CAAA,gDAk4B6BuL,KAl4B7B,EAk4BoC3I,QAl4BpC,EAm4BC;CACC,aAAO;CACNoC,QAAAA,OAAO,EAAEvH,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC1B0N,UAAAA,KAAK,EAAE;CACNxN,YAAAA,SAAS,EAAE;CADL,WADmB;CAI1BgB,UAAAA,QAAQ,EAAE,CACTN,QAAQ,CAACiQ,cAAT,CAAwBhD,KAAxB,CADS,EAET9N,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClB0N,YAAAA,KAAK,EAAE;CACNxN,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBC,YAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAJY;CAKlB8G,YAAAA,MAAM,EAAE;CACP0D,cAAAA,KAAK,EAAE,KAAKiG,oBAAL,CAA0BvQ,IAA1B,CAA+B,IAA/B,EAAqC2E,QAArC;CADA;CALU,WAAnB,CAFS;CAJgB,SAAlB;CADH,OAAP;CAmBA;CAv5BF;CAAA;CAAA,4CAy5ByBrG,OAz5BzB,EA05BC;CACC,UAAMkS,cAAc,GAAGlS,OAAO,CAACmS,YAAR,GAAuBhT,KAAvB,EAAvB;CAEA,WAAKiT,iBAAL,GAAyB,IAAIC,yCAAJ,CACxBH,cADwB,EAExB;CAACjI,QAAAA,MAAM,EAAEtK,mCAAgB,GAAGoC,QAAnB,CAA4BuQ,SAA5B;CAAT,OAFwB,CAAzB;CAIA,UAAMC,QAAQ,GAAG,KAAKH,iBAAtB;CAEA,aAAOlR,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACxBC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SADiB;CAExBgB,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WADU;CAEjBgB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADW;CAElBC,YAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,oCAAf,IAAuD;CAF3C,WAAnB,CADS,EAKT+Q,QAAQ,CAAChT,UAAT,EALS;CAFO,SAAlB,CADS;CAFc,OAAlB,CAAP;CAeA;CAl7BF;CAAA;CAAA,2CAo7BwBS,OAp7BxB,EAo7BiC4O,IAp7BjC,EAq7BC;CACCA,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACnCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SAD4B;CAInCC,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,2CAAf,IAA8D;CAJjC,OAAnB,CAAjB;CAOAoN,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCgB,QAAAA,QAAQ,EAAE,CACTwB,EAAE,CAAC2O,OAAH,CAAWC,SAAX,CAAqBC,aAArB,CACC/S,mCAAgB,GAAGoC,QAAnB,CAA4BiO,UAA5B,EADD,EAEC;CACC/T,UAAAA,IAAI,EAAE;CADP,SAFD,EAKC,YALD,EAMC+D,OAAO,CAACjB,KAAR,GACG6K,MAAM,CAAC+I,4BAAP,CAAoChT,mCAAgB,GAAGoC,QAAnB,CAA4BuQ,SAA5B,EAApC,CADH,GAEGtS,OAAO,CAAC4S,YAAR,EARJ,CADS;CAFwB,OAAlB,CAAjB;CAeA;CA58BF;CAAA;CAAA,gDA88B6B5S,OA98B7B,EA88BsC4O,IA98BtC,EA+8BC;CACCA,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCgB,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WADU;CAEjBgB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACnBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADY;CAEnBgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACnBC,cAAAA,KAAK,EAAE;CACNC,gBAAAA,SAAS,EAAE,8BADL;CAENuE,gBAAAA,IAAI,EAAE,UAFA;CAGNtH,gBAAAA,IAAI,EAAE,iBAHA;CAINC,gBAAAA,KAAK,EAAE;CAJD,eADY;CAOnBsQ,cAAAA,KAAK,EAAE;CACNgE,gBAAAA,OAAO,EAAE7S,OAAO,CAAC8S,kBAAR;CADH;CAPY,aAApB,CADS,EAYT/Q,QAAQ,CAACiQ,cAAT,CAAwBzQ,aAAG,CAACC,UAAJ,CAAe,8CAAf,CAAxB,CAZS;CAFS,WAApB,CADS;CAFO,SAAlB,CADS;CAFwB,OAAlB,CAAjB;CA2BA;CA3+BF;CAAA;CAAA,iDA6+B8BuR,UA7+B9B,EA6+BmD/S,OA7+BnD,EA8+BC;CACCA,MAAAA,OAAO,CAACgT,YAAR,CAAqBhU,iCAAc,CAACiU,cAAf,CAA8BF,UAA9B,CAArB;CAEA,aAAO,IAAP;CACA;CAl/BF;CAAA;CAAA,qCAo/BkBG,SAp/BlB,EAo/B6BC,WAp/B7B,EAq/BC;CACCA,MAAAA,WAAW,CAACC,QAAZ,GAAuB,KAAvB;AACA,CAEAzJ,MAAAA,UAAU,CAAC,YACX;CACC9F,QAAAA,EAAE,CAACoN,IAAH,CAAQ;CACPoC,UAAAA,MAAM,EAAE,MADD;CAEPC,UAAAA,QAAQ,EAAE,MAFH;CAGP7D,UAAAA,GAAG,EAAE9P,mCAAgB,GAAG4T,OAHjB;CAIPtU,UAAAA,IAAI,EAAE;CACLuU,YAAAA,WAAW,EAAE,wBADR;CAELC,YAAAA,eAAe,EAAE9T,mCAAgB,GAAG+T;CAF/B,WAJC;CAQPC,UAAAA,SARO,qBAQGC,QARH,EASP;CACC,gBAAI3X,cAAI,CAACS,OAAL,CAAakX,QAAQ,CAAC,MAAD,CAArB,CAAJ,EACA;CACCjU,cAAAA,mCAAgB,GAAG1C,GAAnB,CAAuB,mBAAvB,EAA4C2W,QAAQ,CAAC,MAAD,CAApD;CACA;CACD;CAdM,SAAR;CAgBA,OAlBS,EAkBP,IAlBO,CAAV;CAmBA;CA5gCF;CAAA;CAAA,+CA8gC4BpU,IA9gC5B,EA+gCC;CACC,UAAI,CAACvD,cAAI,CAACS,OAAL,CAAa,KAAKmX,sBAAlB,CAAL,EACA;CACC,aAAKA,sBAAL,GAA8B,EAA9B;CACA;;CAED,UAAMC,YAAY,GAAGtU,IAAI,CAACyH,gBAAL,CAAsB,aAAtB,CAArB;;CACA,WAAK,IAAI8C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+J,YAAY,CAACjN,MAAjC,EAAyC,EAAEkD,CAA3C,EACA;CACC,YAAIgK,OAAO,GAAG,IAAd;CACA,YAAMC,IAAI,GAAGF,YAAY,CAAC/J,CAAD,CAAZ,CAAgBlE,YAAhB,CAA6B,WAA7B,CAAb;;CAEA,YAAImO,IAAI,KAAK,eAAb,EACA;CACCD,UAAAA,OAAO,GAAGlQ,EAAE,CAAC2O,OAAH,CAAWyB,YAAX,CAAwBC,YAAxB,CAAqCJ,YAAY,CAAC/J,CAAD,CAAjD,CAAV;CACA;;CAEDlG,QAAAA,EAAE,CAACoF,EAAH,CAAMC,IAAN,CAAW9F,IAAX,CAAgB0Q,YAAY,CAAC/J,CAAD,CAA5B;;CAEA,YAAIgK,OAAJ,EACA;CACC,eAAKF,sBAAL,CAA4B/W,IAA5B,CAAiCiX,OAAjC;CACA;CACD;CACD;CAviCF;CAAA;CAAA,oDA0iCC;CACC,UAAI,KAAK3B,iBAAT,EACA;CACC,aAAKA,iBAAL,CAAuB5J,OAAvB;CACA,aAAK4J,iBAAL,GAAyB,IAAzB;CACA;;CAED,UAAInW,cAAI,CAACS,OAAL,CAAa,KAAKmX,sBAAlB,CAAJ,EACA;CACC,aAAK,IAAI9J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK8J,sBAAL,CAA4BhN,MAAhD,EAAwD,EAAEkD,CAA1D,EACA;CACC,cAAI9N,cAAI,CAACkY,UAAL,CAAgB,KAAKN,sBAAL,CAA4B9J,CAA5B,EAA+BvB,OAA/C,CAAJ,EACA;CACC,iBAAKqL,sBAAL,CAA4B9J,CAA5B,EAA+BvB,OAA/B;CACA;CACD;CACD;;CACD,WAAKqL,sBAAL,GAA8B,IAA9B;CACA;CA5jCF;CAAA;CAAA,4CA8jCyBxN,QA9jCzB,EA+jCC;CACC,UAAM+N,MAAM,GAAG,EAAf;CACA,yDAAezX,OAAf,CAAuB,UAACqD,OAAD,EAAa;CACnC,YAAIA,OAAO,CAACiC,WAAR,OAA0BoE,QAA9B,EACA;CACC+N,UAAAA,MAAM,CAACtX,IAAP,CAAYkD,OAAZ;CACA;CACD,OALD;CAOA,aAAOoU,MAAP;CACA;CAzkCF;CAAA;CAAA,wCA2kCqB/N,QA3kCrB,EA4kCC;CACC,UAAM+N,MAAM,GAAG,EAAf;CACA,UAAMC,MAAM,GAAG,EAAf;CACA,UAAMC,QAAQ,GAAG,KAAKC,uBAAL,CAA6BlO,QAA7B,CAAjB;CAEAiO,MAAAA,QAAQ,CAAC3X,OAAT,CAAiB,UAACqD,OAAD,EAAa;CAC7B,YAAM6O,KAAK,GAAG7O,OAAO,CAACsO,OAAR,GAAkB,EAAlB,GAAuBtO,OAAO,CAACwU,mBAAR,EAArC;;CACA,YAAI3F,KAAK,CAAChI,MAAV,EACA;CACCgI,UAAAA,KAAK,CAAClS,OAAN,CAAc,UAAC8X,QAAD,EAAc;CAC3B,gBAAI,CAACJ,MAAM,CAACI,QAAQ,CAACrY,EAAV,CAAX,EACA;CACCgY,cAAAA,MAAM,CAACtX,IAAP,CAAY;CACXV,gBAAAA,EAAE,EAAEqY,QAAQ,CAACrY,EADF;CAEXsY,gBAAAA,QAAQ,EAAE,UAFC;CAGXC,gBAAAA,IAAI,EAAEF,QAAQ,CAACE,IAHJ;CAIXC,gBAAAA,UAAU,EAAE5U,OAAO,CAACkC,OAAR,EAJD;CAKXjG,gBAAAA,IAAI,EAAEwY,QAAQ,CAACxY,IALJ;CAMX4Y,gBAAAA,UAAU,EAAE,UAAQJ,QAAQ,CAACrY,EAAjB,GAAoB,IANrB;CAOX0Y,gBAAAA,gBAAgB,EAAE,gBAAcL,QAAQ,CAACrY,EAAvB,GAA0B;CAPjC,eAAZ;CASAiY,cAAAA,MAAM,CAACI,QAAQ,CAACrY,EAAV,CAAN,GAAsB,IAAtB;CACA;CACD,WAdD;CAeA;CACD,OApBD;CAsBA,aAAOgY,MAAP;CACA;CAxmCF;CAAA;CAAA,sCA0mCmB/N,QA1mCnB,EA0mC6B0O,UA1mC7B,EA2mCC;CACC,UAAMC,UAAU,GAAG,KAAKR,mBAAL,CAAyBnO,QAAzB,CAAnB;;CACA,WAAK,IAAI0D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiL,UAAU,CAACnO,MAA/B,EAAuC,EAAEkD,CAAzC,EACA;CACC,YAAIiL,UAAU,CAACjL,CAAD,CAAV,CAAc3N,EAAd,KAAqB2Y,UAAzB,EACA;CACC,iBAAOC,UAAU,CAACjL,CAAD,CAAjB;CACA;CACD;;CAED,aAAO,IAAP;CACA;CAtnCF;CAAA;CAAA,EAAoC/C,6BAApC;;;;;;;;;;;;;;;;;;;;ACRA,KAAaiO,QAAb;CAWC,oBAAYC,OAAZ,EAWA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,sDAAgBA,OAAO,CAACC,eAAxB;CACA,iDAAWD,OAAO,CAACE,UAAnB;CACA,oDAAcF,OAAO,CAAClG,KAAtB;CACA,yDAAmBkG,OAAO,CAACG,UAA3B;CAEA,yDAAmB,EAAnB;CACA,iEAA2B,CAA3B;;CACA,QAAIpZ,cAAI,CAACS,OAAL,CAAawY,OAAO,CAACI,UAArB,CAAJ,EACA;CACC,2DAAmBJ,OAAO,CAACI,UAA3B;CACA,mEAA2B,qDAAiBC,SAAjB,CAA2B,UAAA7U,MAAM;CAAA,eAAIA,MAAM,CAAC8U,SAAP,KAAqBN,OAAO,CAAC7O,QAAjC;CAAA,OAAjC,CAA3B;CACA,KAJD,MAKK,IAAIpK,cAAI,CAAC6L,cAAL,CAAoBoN,OAAO,CAAC7O,QAA5B,CAAJ,EACL;CACC,2DAAiBvJ,IAAjB,CAAsBoY,OAAO,CAAC7O,QAA9B;CACA;;CAED,QAAI,+DAA2B,CAA/B,EACA;CACC,mEAA2B,CAA3B;CACA;;CAED,qDAAepK,cAAI,CAACS,OAAL,CAAawY,OAAO,CAACO,cAArB,IAAuCP,OAAO,CAACO,cAA/C,GAAgE,EAA/E;CACA;;CA9CF;CAAA;CAAA,4BAiDC;CACC,aAAO,IAAIR,QAAJ,CAAa;CACnBE,QAAAA,eAAe,EAAEO,iBAAO,CAACvW,KAAR,mCAAc,IAAd,YADE;CAEnBiW,QAAAA,UAAU,oCAAE,IAAF,MAFS;CAGnBC,QAAAA,UAAU,oCAAE,IAAF,cAHS;CAInBhP,QAAAA,QAAQ,EAAE,KAAKsP,kBAAL,EAJS;CAMnBL,QAAAA,UAAU,EAAEI,iBAAO,CAACvW,KAAR,mCAAc,IAAd,eANO;CAQnBsW,QAAAA,cAAc,EAAEC,iBAAO,CAACvW,KAAR,mCAAc,IAAd,WARG;CASnB6P,QAAAA,KAAK,oCAAE,IAAF;CATc,OAAb,CAAP;CAWA;CA7DF;CAAA;CAAA,iCAqEC;CACC,+CAAO,IAAP;CACA;CAvEF;CAAA;CAAA,oCA0EC;CACC,+CAAO,IAAP;CACA;CA5EF;CAAA;CAAA,yCA+EC;CAAA;;CACC,sCAAO,uFAAiB,IAAjB,uBAAP,0DAAO,sBAA4CwG,SAAnD;CACA;CAjFF;CAAA;CAAA,sCAmFmBI,KAnFnB,EAoFC;CACC,UAAIA,KAAK,IAAI,CAAT,IAAcA,KAAK,GAAG,qDAAiB/O,MAA3C,EACA;CACC,eAAO,qDAAiB+O,KAAjB,EAAwBJ,SAA/B;CACA;;CAED,aAAO,IAAP;CACA;CA3FF;CAAA;CAAA,0CA8FC;CACC,aAAO,qDAAiBK,KAAjB,CAAuB,+DAA2B,CAAlD,EAAqD3X,GAArD,CAAyD,UAAAwC,MAAM;CAAA,eAAIA,MAAM,CAAC8U,SAAX;CAAA,OAA/D,CAAP;CACA;CAhGF;CAAA;CAAA,8CAmGC;CACC,aAAO,qDAAiBK,KAAjB,CAAuB,CAAvB,oCAA0B,IAA1B,wBAAoD3X,GAApD,CAAwD,UAAAwC,MAAM;CAAA,eAAIA,MAAM,CAAC8U,SAAX;CAAA,OAA9D,CAAP;CACA;CArGF;CAAA;CAAA,8BAuGWnP,QAvGX,EAwGC;CACC,UAAMyP,WAAW,GAAG,qDAAiBP,SAAjB,CAA2B,UAAA7U,MAAM;CAAA,eAAIA,MAAM,CAAC8U,SAAP,KAAqBnP,QAAzB;CAAA,OAAjC,CAApB;;CACA,UAAIyP,WAAW,IAAI,CAAnB,EACA;CACC,qEAA2BA,WAA3B;CACA;;CAED,aAAO,IAAP;CACA;CAhHF;CAAA;CAAA,gCAmHC;CACC,+CAAO,IAAP;CACA;CArHF;CAAA;CAAA,8BAuHWL,cAvHX,EAwHC;CACC,uDAAeA,cAAf;CAEA,aAAO,IAAP;CACA;CA5HF;CAAA;CAAA,kCA8HeH,UA9Hf,EA+HC;CACC,UAAIrZ,cAAI,CAAC8Z,aAAL,CAAmBT,UAAnB,CAAJ,EACA;CACC,6DAAmBA,UAAnB;CACA;;CAED,aAAO,IAAP;CACA;CAtIF;CAAA;CAAA,wBAgEC;CACC,+CAAO,IAAP;CACA;CAlEF;CAAA;CAAA;;;;;;;;;;;;;;;;;;ACAA,KAAaU,aAAb;CAqBC,yBAAYC,MAAZ,EACA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,oDAAcD,aAAa,CAACE,UAAd,CAAyBC,eAAvC;CACA,mDAAaH,aAAa,CAACI,UAAd,CAAyBC,KAAtC;CACA,oDAAc,CAAd;CACA,wDAAkB,GAAlB;CACA,uDAAiB,KAAjB;CACA,wDAAkB,KAAlB;;CAEA,QAAIpa,cAAI,CAACmD,aAAL,CAAmB6W,MAAnB,CAAJ,EACA;CACC,UAAIA,MAAM,CAAC,MAAD,CAAV,EACA;CACC,aAAKK,OAAL,CAAaL,MAAM,CAAC,MAAD,CAAnB;CACA;;CACD,UAAIA,MAAM,CAAC,OAAD,CAAV,EACA;CACC,aAAKM,QAAL,CAAcN,MAAM,CAAC,OAAD,CAApB;CACA;;CACD,UAAIA,MAAM,CAAC,WAAD,CAAV,EACA;CACC,aAAKO,YAAL,CAAkBP,MAAM,CAAC,WAAD,CAAxB;CACA;;CACD,UAAIA,MAAM,CAAC,OAAD,CAAV,EACA;CACC,aAAKQ,QAAL,CAAcR,MAAM,CAAC,OAAD,CAApB;CACA;;CACD,UAAIA,MAAM,CAAC,UAAD,CAAV,EACA;CACC,aAAKS,WAAL,CAAiBT,MAAM,CAAC,UAAD,CAAvB;CACA;;CACD,UAAIA,MAAM,CAAC,WAAD,CAAV,EACA;CACC,aAAKU,YAAL,CAAkBV,MAAM,CAAC,WAAD,CAAxB;CACA;CACD;CACD;;CAzDF;CAAA;CAAA,4BA0FC;CACC,aAAO,IAAID,aAAJ,CAAkB;CACxBpQ,QAAAA,IAAI,oCAAE,IAAF,QADoB;CAExBrH,QAAAA,KAAK,oCAAE,IAAF,SAFmB;CAGxBqY,QAAAA,SAAS,oCAAE,IAAF,aAHe;CAIxBC,QAAAA,KAAK,oCAAE,IAAF,SAJmB;CAKxBC,QAAAA,QAAQ,oCAAE,IAAF,YALgB;CAMxBC,QAAAA,SAAS,oCAAE,IAAF;CANe,OAAlB,CAAP;CAQA;CAnGF;CAAA;CAAA,4BA+OSnR,IA/OT,EAgPC;CACC,UACCA,IAAI,KAAKoQ,aAAa,CAACI,UAAd,CAAyBC,KAAlC,IACGzQ,IAAI,KAAKoQ,aAAa,CAACI,UAAd,CAAyBY,MADrC,IAEGpR,IAAI,KAAKoQ,aAAa,CAACI,UAAd,CAAyBa,EAHtC,EAKA;CACCrR,QAAAA,IAAI,GAAGoQ,aAAa,CAACI,UAAd,CAAyBC,KAAhC;CACA;;CACD,qDAAazQ,IAAb;CAEA,aAAO,IAAP;CACA;CA5PF;CAAA;CAAA,6BA8PUrH,KA9PV,EA+PC;CACCA,MAAAA,KAAK,GAAG2Y,QAAQ,CAAC3Y,KAAD,CAAhB;CACA,sDAAcA,KAAK,IAAI,CAAT,GAAaA,KAAb,GAAqB,CAAnC;CAEA,aAAO,IAAP;CACA;CApQF;CAAA;CAAA,iCAsQcqY,SAtQd,EAuQC;CACC,UAAIA,SAAS,KAAK,GAAd,IAAqBA,SAAS,KAAK,GAAnC,IAA0CA,SAAS,KAAK,GAA5D,EACA;CACCA,QAAAA,SAAS,GAAG,GAAZ;CACA;;CAED,0DAAkBA,SAAlB;CAEA,aAAO,IAAP;CACA;CAhRF;CAAA;CAAA,6BAkRUC,KAlRV,EAmRC;CACC,UAAI5a,cAAI,CAACmE,QAAL,CAAcyW,KAAd,KAAwBA,KAAK,KAAK,EAAtC,EACA;CACC,wDAAcA,KAAd;CACA;;CAED,aAAO,IAAP;CACA;CA1RF;CAAA;CAAA,gCA4RajW,IA5Rb,EA6RC;CACC,yDAAiB,CAAC,CAACA,IAAnB;CAEA,aAAO,IAAP;CACA;CAjSF;CAAA;CAAA,iCAmScA,IAnSd,EAoSC;CACC,0DAAkB,CAAC,CAACA,IAApB;CAEA,aAAO,IAAP;CACA;CAxSF;CAAA;CAAA,4BA2SC;CACC,aACC,mDAAeoV,aAAa,CAACI,UAAd,CAAyBC,KAAxC,IACG,oDAAgBL,aAAa,CAACE,UAAd,CAAyBC,eAD5C,IAEG,mCAAC,IAAD,SAHJ;CAKA;CAjTF;CAAA;CAAA,6BAoTC;CACC,WAAKG,OAAL,CAAaN,aAAa,CAACI,UAAd,CAAyBC,KAAtC;CACA,WAAKE,QAAL,CAAc,CAAd;CACA,WAAKC,YAAL,CAAkB,GAAlB;CACA,WAAKC,QAAL,CAAcT,aAAa,CAACE,UAAd,CAAyBC,eAAvC;CACA;CAzTF;CAAA;CAAA,gCA4TC;CACC,aAAO;CACNvQ,QAAAA,IAAI,oCAAE,IAAF,QADE;CAENrH,QAAAA,KAAK,oCAAE,IAAF,SAFC;CAGNqY,QAAAA,SAAS,oCAAE,IAAF,aAHH;CAINC,QAAAA,KAAK,oCAAE,IAAF,SAJC;CAKNC,QAAAA,QAAQ,EAAE,qDAAiB,CAAjB,GAAqB;CALzB,OAAP;CAOA;CApUF;CAAA;CAAA,iCAsUcK,WAtUd,EAsU2BC,gBAtU3B,EAuUC;CACC,UAAIP,KAAK,GAAG,oFAAc,IAAd,YAA4Bb,aAAa,CAACE,UAAd,CAAyBmB,WAAjE;;CAEA,UAAI,CAACrB,aAAa,CAACsB,aAAd,CAA4BT,KAA5B,CAAD,IAAuC5a,cAAI,CAACS,OAAL,CAAaya,WAAb,CAA3C,EACA;CACC,aAAK,IAAIpN,CAAC,GAAG,CAAR,EAAWwN,CAAC,GAAGJ,WAAW,CAACtQ,MAAhC,EAAwCkD,CAAC,GAAGwN,CAA5C,EAA+C,EAAExN,CAAjD,EACA;CACC,cAAI8M,KAAK,KAAKM,WAAW,CAACpN,CAAD,CAAX,CAAe+K,gBAA7B,EACA;CACC+B,YAAAA,KAAK,GAAGM,WAAW,CAACpN,CAAD,CAAX,CAAe8K,UAAvB;CACA;CACA;CACD;CACD;;CAED,UAAI,mCAAC,IAAD,iBAAoB,mDAAemB,aAAa,CAACI,UAAd,CAAyBa,EAAxC,IAA8C,KAAKO,KAAL,EAAlE,CAAJ,EACA;CACC,eAAOX,KAAP;CACA;;CAED,UAAIY,IAAI,GAAG,CAAX;CACA,UAAIC,KAAK,GAAG,CAAZ;CACA,UAAIC,OAAO,GAAG,CAAd;;CAEA,gDAAQ,IAAR;CAEC,aAAK,GAAL;CACCA,UAAAA,OAAO,qCAAG,IAAH,SAAP;CACA;;CACD,aAAK,GAAL;CACCD,UAAAA,KAAK,qCAAG,IAAH,SAAL;CACA;;CACD,aAAK,GAAL;CACCD,UAAAA,IAAI,qCAAG,IAAH,SAAJ;CACA;CAVF;;CAaA,UAAIxZ,GAAG,GAAG,EAAV;;CAEA,UAAI,mDAAe+X,aAAa,CAACI,UAAd,CAAyBY,MAA5C,EACA;CACC/Y,QAAAA,GAAG,GAAG,GAAN;CACA;;CAED,UAAIwZ,IAAI,GAAG,CAAX,EACA;CACCxZ,QAAAA,GAAG,IAAIwZ,IAAI,GAAG,GAAd;CACA;;CACD,UAAIC,KAAK,GAAG,CAAZ,EACA;CACCzZ,QAAAA,GAAG,IAAIyZ,KAAK,GAAG,GAAf;CACA;;CACD,UAAIC,OAAO,GAAG,CAAd,EACA;CACC1Z,QAAAA,GAAG,IAAI0Z,OAAO,GAAG,GAAjB;CACA;;CAED,UAAMC,EAAE,GAAG,qDAAiB,aAAjB,GAAiC,SAA5C;;CAEA,UAAIA,EAAE,KAAK,aAAP,IAAwB3Z,GAAG,KAAK,EAApC,EACA;CACCA,QAAAA,GAAG,GAAG,IAAN;CACA;;CAED,UAAI4Z,MAAM,GAAG,EAAb;;CACA,UAAID,EAAE,KAAK,aAAP,IAAwBR,gBAA5B,EACA;CACCS,QAAAA,MAAM,GAAGT,gBAAT;CACA;;CAED,aAAO,MAAKQ,EAAL,GAAU,GAAV,GAAgBf,KAAhB,GAAwB,IAAxB,GAA+B5Y,GAA/B,GAAqC,GAArC,IAA4C4Z,MAAM,GAAG,MAAMA,MAAT,GAAkB,EAApE,IAA0E,GAAjF;CACA;CA9YF;CAAA;CAAA,2BAgZQC,SAhZR,EAgZmB7N,MAhZnB,EAiZC;CACC,UAAI8N,GAAG,GAAGD,SAAV;;CAEA,UAAI,mDAAe9B,aAAa,CAACI,UAAd,CAAyBa,EAA5C,EACA;CACCc,QAAAA,GAAG,GAAGxW,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAAN;;CACA,YAAIvF,cAAI,CAACS,OAAL,CAAauN,MAAb,CAAJ,EACA;CACC,eAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGE,MAAM,CAACpD,MAA3B,EAAmC,EAAEkD,CAArC,EACA;CACC,gBAAI,oDAAgBE,MAAM,CAACF,CAAD,CAAN,CAAU+K,gBAA9B,EACA;CACCiD,cAAAA,GAAG,IAAI,MAAM9N,MAAM,CAACF,CAAD,CAAN,CAAU4K,IAAvB;CACA;CACA;CACD;CACD;CACD,OAdD,MAeK,sCAAI,IAAJ,WACL;CACC,YAAMqD,MAAM,GACX,mDAAehC,aAAa,CAACI,UAAd,CAAyBC,KAAxC,GACG9U,aAAG,CAACC,UAAJ,CAAe,gCAAf,CADH,GAEGD,aAAG,CAACC,UAAJ,CAAe,mCAAf,CAHJ;CAMAuW,QAAAA,GAAG,GAAGC,MAAM,GAAG,GAAT,GAAe,KAAKC,uBAAL,mCAA6B,IAA7B,6CAA0C,IAA1C,cAArB;;CAEA,YAAIhc,cAAI,CAACS,OAAL,CAAauN,MAAb,CAAJ,EACA;CACC,cAAMiO,WAAW,GAChB,mDAAelC,aAAa,CAACI,UAAd,CAAyBC,KAAxC,GACG9U,aAAG,CAACC,UAAJ,CAAe,8BAAf,CADH,GAEGD,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAHJ;;CAKA,eAAK,IAAIuI,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAGE,MAAM,CAACpD,MAA3B,EAAmC,EAAEkD,EAArC,EACA;CACC,gBAAI,oDAAgBE,MAAM,CAACF,EAAD,CAAN,CAAU+K,gBAA9B,EACA;CACCiD,cAAAA,GAAG,IAAI,MAAMG,WAAN,GAAoB,GAApB,GAA0BjO,MAAM,CAACF,EAAD,CAAN,CAAU4K,IAA3C;CACA;CACA;CACD;CACD;CACD;;CAED,4CAAI,IAAJ,cACA;CACCoD,QAAAA,GAAG,IAAI,OAAOxW,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAAd;CACA;;CAED,aAAOuW,GAAP;CACA;CArcF;CAAA;CAAA,4CAucyBxZ,KAvczB,EAucgCqH,IAvchC,EAwcC;CACC,UAAMuS,KAAK,GAAG5Z,KAAK,GAAG,GAAtB;CACA,UAAI6Z,UAAU,GAAG,CAAjB;;CACA,UAAI7Z,KAAK,GAAG,EAAZ,EACA;CACCA,QAAAA,KAAK,GAAIA,KAAK,GAAG,EAAjB;CACA;;CAED,UAAIA,KAAK,KAAK,CAAd,EACA;CACC6Z,QAAAA,UAAU,GAAG,CAAb;CACA,OAHD,MAIK,IAAI7Z,KAAK,GAAG,CAAR,IAAaA,KAAK,GAAG,CAAzB,EACL;CACC6Z,QAAAA,UAAU,GAAG,CAAb;CACA,OAHI,MAKL;CACCA,QAAAA,UAAU,GAAG,CAAb;CACA;;CAED,UAAMC,MAAM,GAAGrC,aAAa,CAACsC,eAAd,CAA8B1S,IAA9B,CAAf;CAEA,aAAOuS,KAAK,IAAIE,MAAM,GAAGA,MAAM,CAACD,UAAD,CAAT,GAAwB,EAAlC,CAAZ;CACA;CAheF;CAAA;CAAA,wBA4DC;CACC,+CAAO,IAAP;CACA;CA9DF;CAAA;CAAA,wBAiEC;CACC,+CAAO,IAAP;CACA;CAnEF;CAAA;CAAA,wBAsEC;CACC,+CAAO,IAAP;CACA;CAxEF;CAAA;CAAA,wBA2EC;CACC,+CAAO,IAAP;CACA;CA7EF;CAAA;CAAA,wBAgFC;CACC,+CAAO,IAAP;CACA;CAlFF;CAAA;CAAA,wBAqFC;CACC,+CAAO,IAAP;CACA;CAvFF;CAAA;CAAA,kCAqGsBvB,KArGtB,EAsGC;CACC,aACCA,KAAK,KAAK,KAAKX,UAAL,CAAgBmB,WAA1B,IACGR,KAAK,KAAK,KAAKX,UAAL,CAAgBC,eAD7B,IAEGU,KAAK,KAAK,KAAKX,UAAL,CAAgBqC,oBAH9B;CAKA;CA5GF;CAAA;CAAA,+BA8GmBC,cA9GnB,EA8GmCrB,WA9GnC,EA+GC;CACCqB,MAAAA,cAAc,GAAGA,cAAc,CAACC,QAAf,EAAjB;CACA,UAAMxC,MAAM,GAAG;CACdY,QAAAA,KAAK,EAAEb,aAAa,CAACE,UAAd,CAAyBC,eADlB;CAEdpM,QAAAA,CAAC,EAAE,CAFW;CAGd2O,QAAAA,CAAC,EAAE,CAHW;CAIdC,QAAAA,CAAC,EAAE,CAJW;CAKd7B,QAAAA,QAAQ,EAAE,KALI;CAMdC,QAAAA,SAAS,EAAE;CANG,OAAf;;CASA,UAAIyB,cAAc,CAAC9U,OAAf,CAAuB,WAAvB,MAAwC,CAAxC,IAA6C8U,cAAc,CAAC9U,OAAf,CAAuB,eAAvB,MAA4C,CAA7F,EACA;CACC,YAAI8U,cAAc,CAAC9U,OAAf,CAAuB,eAAvB,MAA4C,CAAhD,EACA;CACC8U,UAAAA,cAAc,GAAGA,cAAc,CAACI,SAAf,CAAyB,EAAzB,CAAjB;CACA3C,UAAAA,MAAM,CAAC,UAAD,CAAN,GAAqB,IAArB;CACA,SAJD,MAMA;CACCuC,UAAAA,cAAc,GAAGA,cAAc,CAACI,SAAf,CAAyB,CAAzB,CAAjB;CACA;;CAED,YAAMC,MAAM,GAAGL,cAAc,CAACM,KAAf,CAAqB,GAArB,CAAf;CACA7C,QAAAA,MAAM,CAAC,OAAD,CAAN,GAAkB4C,MAAM,CAAC,CAAD,CAAN,CAAUE,IAAV,EAAlB;CACAF,QAAAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAN,CAAU9I,OAAV,CAAkB,SAAlB,EAA6B,EAA7B,CAAZ;CACAkG,QAAAA,MAAM,CAAC,MAAD,CAAN,GAAiB4C,MAAM,CAAC,CAAD,CAAN,CAAUnV,OAAV,CAAkB,GAAlB,MAA2B,CAA3B,GAA+BsS,aAAa,CAACI,UAAd,CAAyBY,MAAxD,GAAiEhB,aAAa,CAACI,UAAd,CAAyBC,KAA3G;CAEA,YAAI7S,KAAJ;CACA,YAAMwV,EAAE,GAAG,0BAAX;;CACA,eAAOxV,KAAK,GAAGwV,EAAE,CAACC,IAAH,CAAQJ,MAAM,CAAC,CAAD,CAAd,CAAf,EACA;CACC5C,UAAAA,MAAM,CAACzS,KAAK,CAAC,CAAD,CAAN,CAAN,GAAmB0T,QAAQ,CAAC1T,KAAK,CAAC,CAAD,CAAN,CAA3B;CACA;CACD,OAvBD,MAyBA;CACCyS,QAAAA,MAAM,CAAC,OAAD,CAAN,GAAkBuC,cAAlB;CACA;;CAED,UAAI,CAACxC,aAAa,CAACsB,aAAd,CAA4BrB,MAAM,CAAC,OAAD,CAAlC,CAAD,IAAiDpS,EAAE,CAAC+B,IAAH,CAAQlJ,OAAR,CAAgBya,WAAhB,CAArD,EACA;CACC,YAAI+B,KAAK,GAAG,KAAZ;;CACA,aAAK,IAAInP,CAAC,GAAG,CAAR,EAAWwN,CAAC,GAAGJ,WAAW,CAACtQ,MAAhC,EAAwCkD,CAAC,GAAGwN,CAA5C,EAA+C,EAAExN,CAAjD,EACA;CACC,cAAIkM,MAAM,CAAC,OAAD,CAAN,KAAoBkB,WAAW,CAACpN,CAAD,CAAX,CAAe+K,gBAAnC,IAAuDmB,MAAM,CAAC,OAAD,CAAN,KAAoBkB,WAAW,CAACpN,CAAD,CAAX,CAAe8K,UAA9F,EACA;CACCoB,YAAAA,MAAM,CAAC,OAAD,CAAN,GAAkBkB,WAAW,CAACpN,CAAD,CAAX,CAAe+K,gBAAjC;CACAoE,YAAAA,KAAK,GAAG,IAAR;CACA;CACA;CACD;;CACD,YAAI,CAACA,KAAL,EACA;CACCjD,UAAAA,MAAM,CAAC,OAAD,CAAN,GAAkBD,aAAa,CAACE,UAAd,CAAyBC,eAA3C;CACA;CACD;;CAED,UAAMwB,OAAO,GAAG1B,MAAM,CAAC,GAAD,CAAN,GAAcA,MAAM,CAAC,GAAD,CAAN,GAAc,EAA5B,GAAiCA,MAAM,CAAC,GAAD,CAAN,GAAc,EAAd,GAAmB,EAApE;;CAEA,UAAI0B,OAAO,GAAG,IAAV,KAAmB,CAAvB,EACA;CACC1B,QAAAA,MAAM,CAAC,OAAD,CAAN,GAAkB0B,OAAO,GAAG,IAA5B;CACA1B,QAAAA,MAAM,CAAC,WAAD,CAAN,GAAsB,GAAtB;CACA,OAJD,MAKK,IAAI0B,OAAO,GAAG,EAAV,KAAiB,CAArB,EACL;CACC1B,QAAAA,MAAM,CAAC,OAAD,CAAN,GAAkB0B,OAAO,GAAG,EAA5B;CACA1B,QAAAA,MAAM,CAAC,WAAD,CAAN,GAAsB,GAAtB;CACA,OAJI,MAML;CACCA,QAAAA,MAAM,CAAC,OAAD,CAAN,GAAkB0B,OAAlB;CACA1B,QAAAA,MAAM,CAAC,WAAD,CAAN,GAAsB,GAAtB;CACA;;CAED,UAAI,CAACA,MAAM,CAAC,OAAD,CAAP,IAAoBA,MAAM,CAAC,OAAD,CAAN,KAAoBD,aAAa,CAACE,UAAd,CAAyBC,eAAjE,IAAoFF,MAAM,CAAC,OAAD,CAA9F,EACA;CACCA,QAAAA,MAAM,CAAC,MAAD,CAAN,GAAiBD,aAAa,CAACI,UAAd,CAAyBa,EAA1C;CACA;;CAED,aAAO,IAAIjB,aAAJ,CAAkBC,MAAlB,CAAP;CACA;CAjMF;CAAA;CAAA,gCAmMoB0B,OAnMpB,EAoMC;CACC,UAAIpZ,KAAJ;CACA,UAAIqH,IAAJ;;CAEA,UAAI+R,OAAO,GAAG,IAAV,KAAmB,CAAvB,EACA;CACCpZ,QAAAA,KAAK,GAAGoZ,OAAO,GAAG,IAAlB;CACA/R,QAAAA,IAAI,GAAG,GAAP;CACA,OAJD,MAKK,IAAI+R,OAAO,GAAG,EAAV,KAAiB,CAArB,EACL;CACCpZ,QAAAA,KAAK,GAAGoZ,OAAO,GAAG,EAAlB;CACA/R,QAAAA,IAAI,GAAG,GAAP;CACA,OAJI,MAML;CACCrH,QAAAA,KAAK,GAAGoZ,OAAR;CACA/R,QAAAA,IAAI,GAAG,GAAP;CACA;;CAED,aAAO,CAACrH,KAAD,EAAQqH,IAAR,CAAP;CACA;CAzNF;CAAA;CAAA,8BA2NkBrH,KA3NlB,EA2NyBqY,SA3NzB,EA4NC;CACC,UAAIxC,MAAM,GAAG,CAAb;;CAEA,cAAQwC,SAAR;CAEC,aAAK,GAAL;CACCxC,UAAAA,MAAM,GAAG7V,KAAT;CACA;;CACD,aAAK,GAAL;CACC6V,UAAAA,MAAM,GAAG7V,KAAK,GAAG,EAAjB;CACA;;CACD,aAAK,GAAL;CACC6V,UAAAA,MAAM,GAAG7V,KAAK,GAAG,EAAR,GAAa,EAAtB;CACA;CAVF;;CAaA,aAAO6V,MAAP;CACA;CA7OF;CAAA;CAAA,oCAkewB+E,MAlexB,EAmeC;CACC,UAAId,MAAM,GAAG,EAAb;;CACA,UAAIc,MAAM,KAAK,GAAf,EACA;CACCd,QAAAA,MAAM,GAAG,CACR9W,aAAG,CAACC,UAAJ,CAAe,6BAAf,CADQ,EAERD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAFQ,EAGRD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAHQ,CAAT;CAKA,OAPD,MAQK,IAAI2X,MAAM,KAAK,GAAf,EACL;CACCd,QAAAA,MAAM,GAAG,CACR9W,aAAG,CAACC,UAAJ,CAAe,8BAAf,CADQ,EAERD,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAFQ,EAGRD,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAHQ,CAAT;CAKA,OAPI,MAQA,IAAI2X,MAAM,KAAK,GAAf,EACL;CACCd,QAAAA,MAAM,GAAG,CACR9W,aAAG,CAACC,UAAJ,CAAe,6BAAf,CADQ,EAERD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAFQ,EAGRD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAHQ,CAAT;CAKA;;CAED,aAAO6W,MAAP;CACA;CA/fF;CAAA;CAAA;6BAAarC,6BAEQ;CACnBqB,EAAAA,WAAW,EAAE,gBADM;CAEnBlB,EAAAA,eAAe,EAAE,eAFE;CAGnBoC,EAAAA,oBAAoB,EAAE;CAHH;6BAFRvC,6BAQQ;CACnBK,EAAAA,KAAK,EAAE,OADY;CAEnBW,EAAAA,MAAM,EAAE,QAFW;CAGnBC,EAAAA,EAAE,EAAE;CAHe;;KCVRmC,cAAb;CAAA;CAAA;6BAAaA,2BAEK;6BAFLA,2BAGK;6BAHLA,6BAIO;6BAJPA,6BAKO;6BALPA,8BAMQ;;;;;;;;;;ACJrB,KAAaC,aAAb;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,qCAsDC;CACC,aAAO,KAAKzT,IAAL,KAAcyT,aAAa,CAACC,qBAAnC;CACA;CAxDF;CAAA;CAAA,wBA4BC;CACC,+CAAO,IAAP;CACA,KA9BF;CAAA,sBAqCUC,SArCV,EAsCC;CACC,UAAIF,aAAa,CAACG,mBAAd,GAAoC7a,QAApC,CAA6C4a,SAA7C,CAAJ,EACA;CACC,yDAAaA,SAAb;CACA;CACD;CA3CF;CAAA;CAAA,wBAiCC;CACC,+CAAO,IAAP;CACA,KAnCF;CAAA,sBA6CoBE,mBA7CpB,EA8CC;CACC,UAAIJ,aAAa,CAACK,sBAAd,GAAuC/a,QAAvC,CAAgD8a,mBAAhD,CAAJ,EACA;CACC,iEAAuBA,mBAAvB;CACA;CACD;CAnDF;CAAA;CAAA,0CA2DC;CACC,aAAO,CACNJ,aAAa,CAACM,qBADR,EAENN,aAAa,CAACO,qBAFR,EAGNP,aAAa,CAACQ,mBAHR,EAINR,aAAa,CAACS,oBAJR,EAKNT,aAAa,CAACU,mBALR,EAMNV,aAAa,CAACW,oBANR,EAONX,aAAa,CAACY,oBAPR,EAQNZ,aAAa,CAACa,oBARR,EASNb,aAAa,CAACC,qBATR,EAUND,aAAa,CAACc,mBAVR,EAWNd,aAAa,CAACe,mBAXR,EAYNf,aAAa,CAACgB,qBAZR,EAaNhB,aAAa,CAACiB,mBAbR,EAcNjB,aAAa,CAACkB,eAdR,CAAP;CAgBA;CA5EF;CAAA;CAAA,wCA8E4BC,MA9E5B,EA+EC;CACC,aAAOnB,aAAa,CAACG,mBAAd,GAAoC7a,QAApC,CAA6C6b,MAA7C,CAAP;CACA;CAjFF;CAAA;CAAA,6CAoFC;CACC,aAAO,CACNpB,cAAc,CAACqB,OADT,EAENrB,cAAc,CAACsB,OAFT,EAGNtB,cAAc,CAACtX,SAHT,EAINsX,cAAc,CAACuB,SAJT,EAKNvB,cAAc,CAACwB,UALT,CAAP;CAOA;CA5FF;CAAA;CAAA,0CA8F8BvU,QA9F9B,EA+FC;CACC,aAAOgT,aAAa,CAACK,sBAAd,GAAuC/a,QAAvC,CAAgD0H,QAAhD,CAAP;CACA;CAjGF;CAAA;CAAA;6BAAagT,wCAEmB;6BAFnBA,wCAGmB;6BAHnBA,sCAIiB;6BAJjBA,uCAKkB;6BALlBA,sCAMiB;6BANjBA,uCAOkB;6BAPlBA,uCAQkB;6BARlBA,uCASkB;6BATlBA,wCAUmB;6BAVnBA,sCAWiB;6BAXjBA,sCAYiB;6BAZjBA,wCAamB;6BAbnBA,sCAciB;6BAdjBA,kCAea;;KCjBbxX,cAAb;CAAA;CAAA;6BAAaA,2BAEK;6BAFLA,2BAGK;6BAHLA,6BAIO;6BAJPA,iCAKW;;;;;;;;;;;;;;ACAxB,KAAagZ,UAAb;CAIC;CAOA,sBAAYC,OAAZ,EACA;CAAA;CAAA,4CAVa,EAUb;CAAA,gDATiBjZ,cAAc,CAACkZ,OAShC;CAAA,kDAPoBtW,SAOpB;CAAA,+CANuB,EAMvB;CAAA,gDALwB,EAKxB;;CAAA;CAAA;CAAA,aAJmB,CAAC;CAIpB;;CAAA,wDAHyB2U,cAAc,CAACqB,OAGxC;;CACC,QAAIxe,cAAI,CAACS,OAAL,CAAaoe,OAAb,CAAJ,EACA;CAAA,mDACqBA,OADrB;CAAA;;CAAA;CACC,4DACA;CAAA,cADWE,KACX;CACC,eAAKC,QAAL,CAAcD,KAAd;CACA;CAJF;CAAA;CAAA;CAAA;CAAA;CAKC;CACD;;CApBF;CAAA;CAAA,6BAsBUA,KAtBV,EAuBC;CACC,WAAKE,EAAL,GAAUF,KAAK,CAAC1c,IAAhB;;CAEA,UAAI,oDAAgB0c,KAAK,CAACE,EAA1B,EACA;CACC,0DAAgBF,KAAK,CAACE,EAAtB;CACA,aAAK3M,QAAL,GAAgByM,KAAK,CAACG,QAAtB;CACA,aAAKC,cAAL,GAAsBJ,KAAK,CAACI,cAA5B;;CAEA,YAAIJ,KAAK,CAACpV,IAAN,KAAeyT,gCAAa,CAACQ,mBAAjC,EACA;CACC,eAAKnZ,MAAL,GAAcmB,cAAc,CAACC,SAA7B;CACA,SAHD,MAKA;CACC,eAAKpB,MAAL,GAAcmB,cAAc,CAAC6Y,OAA7B;CACA;CACD;;CAED,UAAIM,KAAK,CAACpV,IAAN,KAAeyT,gCAAa,CAACc,mBAAjC,EACA;CACC,aAAKkB,MAAL,CAAYve,IAAZ,CAAiBke,KAAK,CAACM,IAAvB;CACA,OAHD,MAIK,IAAIN,KAAK,CAACpV,IAAN,KAAeyT,gCAAa,CAACW,oBAAjC,EACL;CACC,aAAKuB,KAAL,CAAWze,IAAX,CAAgBke,KAAK,CAACM,IAAtB;CACA;CACD;CAlDF;CAAA;CAAA;;KCFaE,YAAb;CAOC,sBAAYR,KAAZ,EACA;CAAA;CAAA,0CANa,EAMb;CAAA,8CALiBnZ,cAAc,CAACC,SAKhC;CAAA,gDAHoB2C,SAGpB;;CACC,MAAIuW,KAAK,CAACS,cAAN,EAAJ,EACA;CACC,SAAKP,EAAL,GAAUF,KAAK,CAACM,IAAhB;CACA,SAAK/M,QAAL,GAAgByM,KAAK,CAACG,QAAtB;CACA;CACD,CAdF;;;;;;;;;;ACCA,KAAaO,oBAAb;CAcC,kCACA;CAAA;;CAAA;CAAA;CAAA,aAbmB;CAClBR,QAAAA,EAAE,EAAE7B,aAAa,CAACM,qBADA;CAElBgC,QAAAA,UAAU,EAAE,EAFM;CAGlB/V,QAAAA,IAAI,EAAEyT,aAAa,CAACO,qBAHF;CAIlBtb,QAAAA,IAAI,EAAE,EAJY;CAKlB0Q,QAAAA,KAAK,EAAE,EALW;CAMlBmM,QAAAA,QAAQ,EAAE,EANQ;CAOlBG,QAAAA,IAAI,EAAE,EAPY;CAQlBF,QAAAA,cAAc,EAAEhC,cAAc,CAACqB;CARb;CAanB;;CAAA;CAAA;CAAA;CAAA;;CACC,8FAAsB,IAAtB;CACA;;CAjBF;CAAA;CAAA,gCAmBamB,QAnBb,EAoBC;CACC,8DAAsBC,MAAM,CAACC,MAAP,CAAc,EAAd,oCAAkB,IAAlB,oBAAtB;CACAF,MAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,QAAlB,CAAX;;CAEA,UAAI3f,cAAI,CAAC6L,cAAL,CAAoB8T,QAAQ,CAAC,IAAD,CAA5B,CAAJ,EACA;CACCA,QAAAA,QAAQ,CAAC,IAAD,CAAR,GAAiB1E,QAAQ,CAAC0E,QAAQ,CAAC,IAAD,CAAT,CAAzB;CACA;;CACD,UAAI3f,cAAI,CAAC6L,cAAL,CAAoB8T,QAAQ,CAAC,MAAD,CAA5B,CAAJ,EACA;CACCA,QAAAA,QAAQ,CAAC,MAAD,CAAR,GAAmB1E,QAAQ,CAAC0E,QAAQ,CAAC,MAAD,CAAT,CAA3B;CACA;;CAED,UAAI3f,cAAI,CAAC8f,QAAL,CAAcH,QAAQ,CAAC,IAAD,CAAtB,CAAJ,EACA;CACC,gEAAoBV,EAApB,GAAyBU,QAAQ,CAAC,IAAD,CAAjC;CACA;;CACD,UAAI3f,cAAI,CAAC6L,cAAL,CAAoB8T,QAAQ,CAAC,aAAD,CAA5B,CAAJ,EACA;CACC,gEAAoBD,UAApB,GAAiCC,QAAQ,CAAC,aAAD,CAAzC;CACA;;CACD,UAAI3f,cAAI,CAAC8f,QAAL,CAAcH,QAAQ,CAAC,MAAD,CAAtB,KAAmCvC,aAAa,CAAC2C,mBAAd,CAAkCJ,QAAQ,CAAC,MAAD,CAA1C,CAAvC,EACA;CACC,gEAAoBhW,IAApB,GAA2BgW,QAAQ,CAAC,MAAD,CAAnC;CACA;;CACD,UAAI3f,cAAI,CAAC6L,cAAL,CAAoB8T,QAAQ,CAAC,UAAD,CAA5B,CAAJ,EACA;CACC,gEAAoBT,QAApB,GAA+BS,QAAQ,CAAC,UAAD,CAAvC;CACA;;CACD,UAAI3f,cAAI,CAAC8f,QAAL,CAAcH,QAAQ,CAAC,iBAAD,CAAtB,KAA8CvC,aAAa,CAAC4C,qBAAd,CAAoCL,QAAQ,CAAC,iBAAD,CAA5C,CAAlD,EACA;CACC,gEAAoBR,cAApB,GAAqCQ,QAAQ,CAAC,iBAAD,CAA7C;CACA;;CAED,8DAAoBtd,IAApB,GAA2B4d,MAAM,CAACN,QAAQ,CAAC,aAAD,CAAT,CAAjC;CACA,8DAAoB5M,KAApB,GAA4BkN,MAAM,CAACN,QAAQ,CAAC,cAAD,CAAT,CAAlC;CACA,8DAAoBN,IAApB,GAA2BY,MAAM,CAACN,QAAQ,CAAC,aAAD,CAAT,CAAjC;CAEA,aAAO,IAAP;CACA;CA3DF;CAAA;CAAA,8BA6DWlb,MA7DX,EA8DC;CACC,8DAAoBA,MAApB,GAA6BA,MAA7B;CAEA,aAAO,IAAP;CACA;CAlEF;CAAA;CAAA,4BAqEC;CACC,UAAMsa,KAAK,GAAG,IAAI3B,aAAJ,EAAd;CAEA2B,MAAAA,KAAK,CAACE,EAAN,GAAW,wDAAoBA,EAA/B;CACAF,MAAAA,KAAK,CAACW,UAAN,GAAmB,wDAAoBA,UAAvC;CACAX,MAAAA,KAAK,CAACpV,IAAN,GAAa,wDAAoBA,IAAjC;CACAoV,MAAAA,KAAK,CAAC1c,IAAN,GAAa,wDAAoBA,IAAjC;CACA0c,MAAAA,KAAK,CAAChM,KAAN,GAAc,wDAAoBA,KAAlC;CACAgM,MAAAA,KAAK,CAACM,IAAN,GAAa,wDAAoBA,IAAjC;CACAN,MAAAA,KAAK,CAACG,QAAN,GAAiB,wDAAoBA,QAArC;CACAH,MAAAA,KAAK,CAACI,cAAN,GAAuB,wDAAoBA,cAA3C;CAEA,aAAOJ,KAAP;CACA;CAlFF;CAAA;CAAA;;;;;;;;;;;;;;;;;;;;ACaA,KAAamB,OAAb;CAQC,mBAAYpa,QAAZ,EAAiCwR,OAAjC,EACA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,sDAAgBA,OAAhB;CACA,uDAAiBxR,QAAjB;CACA;;CAZF;CAAA;CAAA,yBAcMzB,GAdN,EAeC;CACC,4DAAoB,EAApB;CACA,0DAAkB,EAAlB;CAEA,WAAK8b,OAAL,CAAa9b,GAAb;CACA;CApBF;CAAA;CAAA,2BAsBQA,GAtBR,EAuBC;CACC,WAAK8C,IAAL,CAAU9C,GAAV;CACA;CAzBF;CAAA;CAAA,4BA2BSA,GA3BT,EA4BC;CACC,UAAI,CAACrE,cAAI,CAACmD,aAAL,CAAmBkB,GAAnB,CAAL,EACA;CACCA,QAAAA,GAAG,GAAG,EAAN;CACA;;CAED,UAAM+b,eAAe,GAAG,IAAIX,oBAAJ,EAAxB;;CAEA,yCAAkCG,MAAM,CAACf,OAAP,CAAexa,GAAf,CAAlC,qCACA;CADK;CAAA,YAAO+F,QAAP;CAAA,YAAiByU,OAAjB;;CAEJ,YAAI,CAAC7e,cAAI,CAACS,OAAL,CAAaoe,OAAb,CAAL,EACA;CACC;CACA;;CAJF,qDAMwBA,OANxB;CAAA;;CAAA;CAMC,8DACA;CAAA,gBADWwB,QACX;CACC,gBAAMtB,KAAK,GAAGqB,eAAe,CAACE,WAAhB,CAA4BD,QAA5B,EAAsCE,KAAtC,EAAd;;CAEA,gBAAIxB,KAAK,CAACS,cAAN,EAAJ,EACA;CACC,mBAAKgB,eAAL,CAAqBzB,KAArB;CACA,aAHD,MAKA;CACC,mBAAK0B,aAAL,CAAmB1B,KAAnB;CACA,kBAAM2B,UAAU,GAAG,oDAAgB3B,KAAK,CAAC1c,IAAtB,CAAnB;;CAEA,kBAAI,CAACrC,cAAI,CAACC,KAAL,mCAAW,IAAX,aAAL,EACA;CACC,oBAAM0gB,cAAc,GAAID,UAAU,CAACjc,MAAX,KAAsBmB,cAAc,CAAC6Y,OAA7D;CACA,oBAAMmC,mBAAmB,GACvBF,UAAU,CAACvB,cAAX,KAA8BhC,cAAc,CAACtX,SAD/C;CAGA,oBAAMgb,eAAe,GAAI,mDAAenH,kBAAf,OAAwCtP,QAAjE;CAEA,oBAAM0W,6BAA6B,GAAGH,cAAc,IAAI,CAACE,eAAzD;CACA,oBAAME,yCAAyC,GAC9CJ,cAAc,IAAIC,mBAAlB,IAAyCC,eAD1C;;CAIA,oBAAIC,6BAA6B,IAAIC,yCAArC,EACA;CACCL,kBAAAA,UAAU,CAACjc,MAAX,GAAoBmB,cAAc,CAACC,SAAnC;CACA;CACD;CACD;CACD;CAtCF;CAAA;CAAA;CAAA;CAAA;CAuCC;CACD;CA7EF;CAAA;CAAA,oCA+EiBkZ,KA/EjB,EAgFC;CACC,UAAIA,KAAK,CAACS,cAAN,EAAJ,EACA;CACC,8DAAkBT,KAAK,CAACM,IAAxB,IAAgC,IAAIE,YAAJ,CAAiBR,KAAjB,CAAhC;CACA;CACD;CArFF;CAAA;CAAA,kCAuFeA,KAvFf,EAwFC;CACC,UAAIA,KAAK,CAACS,cAAN,EAAJ,EACA;CACC;CACA;;CAED,UAAI,CAAC,oDAAgBT,KAAK,CAAC1c,IAAtB,CAAL,EACA;CACC,4DAAgB0c,KAAK,CAAC1c,IAAtB,IAA8B,IAAIuc,UAAJ,CAAe,CAACG,KAAD,CAAf,CAA9B;CACA,OAHD,MAKA;CACC,4DAAgBA,KAAK,CAAC1c,IAAtB,EAA4B2c,QAA5B,CAAqCD,KAArC;CACA;CACD;CAtGF;CAAA;CAAA,gCAwGaE,EAxGb,EAyGC;CACC,aAAO,oDAAgBA,EAAhB,KAAuB,IAA9B;CACA;CA3GF;CAAA;CAAA,kCA6GeA,EA7Gf,EA8GC;CACC,aAAO,sDAAkBA,EAAlB,KAAyB,IAAhC;CACA;CAhHF;CAAA;CAAA,2BAkHQ+B,cAlHR,EAmHC;CAAA;;CACC,aAAOpZ,EAAE,CAACoN,IAAH,CAAQ;CACdoC,QAAAA,MAAM,EAAE,MADM;CAEdC,QAAAA,QAAQ,EAAE,MAFI;CAGd7D,QAAAA,GAAG,oCAAE,IAAF,WAHW;CAIdxQ,QAAAA,IAAI,EAAE;CACLuU,UAAAA,WAAW,EAAE,SADR;CAELC,UAAAA,eAAe,EAAEwJ;CAFZ,SAJQ;CAQdtJ,QAAAA,SAAS,EAAE,mBAACC,QAAD,EAAc;CACxB,cAAIA,QAAQ,CAACsJ,IAAT,IAAiBtJ,QAAQ,CAACsJ,IAAT,CAAcC,GAAnC,EACA;CACC,YAAA,KAAI,CAACrL,MAAL,CAAY8B,QAAQ,CAACsJ,IAAT,CAAcC,GAA1B;CACA;CACD;CAba,OAAR,CAAP;CAeA;CAnIF;CAAA;CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNA,KAAaC,KAAb;CAAA;;CAgBC,iBAAYnH,MAAZ,EAMA;CAAA;;CAAA;CACC;CADD,wGApB4B,yIAoB5B;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAEC,UAAKnX,iBAAL,CAAuB,uBAAvB;;CAEA,8FAAiBmX,MAAM,CAAClU,QAAxB;;CACA,QAAI,CAAC9F,cAAI,CAACC,KAAL,CAAW+Z,MAAM,CAACoH,QAAlB,CAAL,EACA;CACC,8FAAiBpH,MAAM,CAACoH,QAAxB;CACA;;CACD,+FAAoBpH,MAAM,CAACqH,WAA3B;CACA,8FAAiBlf,QAAQ,CAACQ,IAAT,EAAjB;CACA,2FAAgBqX,MAAM,CAAC1V,OAAvB;CACA,2FAAgB,KAAhB;CAEA,yFAAc,IAAIyV,aAAJ,EAAd;CAdD;CAeC;;CArCF;CAAA;CAAA,kCAiEC;CACC,aAAO,CAAC/Z,cAAI,CAACC,KAAL,mCAAW,IAAX,aAAR;CACA;CAnEF;CAAA;CAAA,kCAsEC;CACC,+CAAO,IAAP;CACA;CAxEF;CAAA;CAAA,kCA2EC;CACC,+CAAO,IAAP;CACA;CA7EF;CAAA;CAAA,4BA0FC;CACC,UAAMqhB,WAAW,GAAG,IAAIH,KAAJ,CAAU;CAC7Brb,QAAAA,QAAQ,oCAAE,IAAF,cADqB;CAE7Bsb,QAAAA,QAAQ,oCAAE,IAAF,YAFqB;CAG7BC,QAAAA,WAAW,oCAAE,IAAF,eAHkB;CAI7B/c,QAAAA,OAAO,oCAAE,IAAF;CAJsB,OAAV,CAApB;;CAOA,UAAMid,SAAS;CACd7I,QAAAA,IAAI,EAAEyI,KAAK,CAACK,YAAN,EADQ;CAEdC,QAAAA,KAAK,EAAE,KAAKC,gBAAL,GAAwBxe,KAAxB,EAFO;CAGdE,QAAAA,SAAS,EAAE,KAAK8S,YAAL,GAAoBhT,KAApB;CAHG,SAIX0E,EAAE,CAAC1E,KAAH,mCAAS,IAAT,WAJW,CAAf;;CAMAoe,MAAAA,WAAW,CAACna,IAAZ,CAAiBoa,SAAjB,oCAA4B,IAA5B;CAEA,aAAOD,WAAP;CACA;CA3GF;CAAA;CAAA,4BA6GSK,KA7GT,EA8GC;CACC,aAAO,iDAAWjJ,IAAX,KAAoB,kCAAAiJ,KAAK,UAAL,CAAYjJ,IAAvC;CACA;CAhHF;CAAA;CAAA,yBAkHM1V,IAlHN,EAkHoBC,QAlHpB,EAmHC;CACC,UAAIjD,cAAI,CAACmD,aAAL,CAAmBH,IAAnB,CAAJ,EACA;CACC,yDAAaA,IAAb;CACA;;CACD,UAAI,CAAC,iDAAW0V,IAAhB,EACA;CACC,yDAAWA,IAAX,GAAkByI,KAAK,CAACK,YAAN,EAAlB;CACA;;CAED,sDAAc,IAAIzH,aAAJ,CAAkB,iDAAW0H,KAA7B,CAAd;CACA,4DAAkB,IAAI1e,iCAAJ,CAAmB,iDAAWK,SAA9B,CAAlB;;CACA,UAAI,CAAC,iDAAWA,SAAhB,EACA;CACC,8DAAgBuG,IAAhB,GAAuB5G,iCAAc,CAAC6e,cAAf,CAA8BC,KAArD;CACA;;CACD,2DAAiB7hB,cAAI,CAACC,KAAL,CAAWgD,QAAX,IAAuBd,QAAQ,CAACkB,IAAT,EAAvB,GAAyCJ,QAA1D;;CACA,UAAI,CAAC,qDAAewL,MAAf,EAAL,EACA;CACC,yDAAa,KAAKnL,UAAL,EAAb;CACA;CACD;CAxIF;CAAA;CAAA,2BA0IQN,IA1IR,EA0IsBC,QA1ItB,EA2IC;CACC,UAAIjD,cAAI,CAACC,KAAL,CAAWgD,QAAX,KAAwB,qDAAewL,MAAf,EAA5B,EACA;CACC;CACA;;CAED,UAAMlL,IAAI,qCAAG,IAAH,UAAV;CACA,uDAAa,KAAKD,UAAL,EAAb;;CACA,UAAIC,IAAI,CAACC,UAAT,EACA;CACCD,QAAAA,IAAI,CAACC,UAAL,CAAgBC,YAAhB,mCAA6B,IAA7B,YAAyCF,IAAzC;CACA;CACD;CAvJF;CAAA;CAAA,8BA0JC;CACC,WAAKuD,IAAL,CAAU,iBAAV;CACA;CA5JF;CAAA;CAAA,8BA+JC;CACC,aAAO,mDAAenD,OAAf,EAAP;CACA;CAjKF;CAAA;CAAA,oCAoKC;CACC,UAAI,oDAAc3D,cAAI,CAACmD,aAAL,CAAmB,iDAAW2e,UAA9B,CAAlB,EACA;CACC,eAAO,iDAAWA,UAAlB;CACA;;CAED,aAAO,EAAP;CACA;CA3KF;CAAA;CAAA,gCA6Kazf,IA7Kb,EA8KC;CACC,aAAO,KAAK0f,aAAL,GAAqB1f,IAArB,KAA8B,IAArC;CACA;CAhLF;CAAA;CAAA,gCAkLaA,IAlLb,EAmLC;CACC,aAAO,KAAK0f,aAAL,GAAqBvf,cAArB,CAAoCH,IAApC,CAAP;CACA;CArLF;CAAA;CAAA,gCAuLaA,IAvLb,EAuL2BC,KAvL3B,EAwLC;CACC,uDAAWwf,UAAX,CAAsBzf,IAAtB,IAA8BC,KAA9B;CAEA,aAAO,IAAP;CACA;CA5LF;CAAA;CAAA,4BA+LC;CACC,aAAO,iDAAWoW,IAAX,IAAmB,IAA1B;CACA;CAjMF;CAAA;CAAA,mCAoMC;CACC,UAAIjU,MAAM,GAAGmB,cAAc,CAACkZ,OAA5B;CACA,UAAIza,GAAG,GAAG,kDAAc2d,WAAd,CAA0B,KAAKxd,KAAL,EAA1B,CAAV;;CAEA,UAAIH,GAAJ,EACA;CACCI,QAAAA,MAAM,GAAGJ,GAAG,CAACI,MAAb;CACA,OAHD,MAIK,IAAI,iDAAWwd,SAAf,EACL;CACC5d,QAAAA,GAAG,GAAG,kDAAc2d,WAAd,CAA0B,iDAAWC,SAArC,CAAN;;CACA,YAAI5d,GAAG,IAAIA,GAAG,CAACI,MAAJ,KAAemB,cAAc,CAAC6Y,OAAzC,EACA;CACCha,UAAAA,MAAM,GAAGmB,cAAc,CAAC6Y,OAAxB;CACA;CACD;;CAED,aAAOha,MAAP;CACA;CAtNF;CAAA;CAAA,mCAyNC;CACC,UAAI2a,MAAM,GAAG,EAAb;CACA,UAAM/a,GAAG,GAAG,kDAAc2d,WAAd,CAA0B,KAAKxd,KAAL,EAA1B,CAAZ;;CACA,UAAIH,GAAG,IAAIA,GAAG,CAAC+a,MAAf,EACA;CACCA,QAAAA,MAAM,GAAG/a,GAAG,CAAC+a,MAAb;CACA;;CAED,aAAOA,MAAP;CACA;CAlOF;CAAA;CAAA,oCAqOC;CACC,UAAI,iDAAW6C,SAAf,EACA;CACC,YAAM5d,GAAG,GAAG,kDAAc2d,WAAd,CAA0B,iDAAWC,SAArC,CAAZ;;CACA,YAAI5d,GAAG,IAAIA,GAAG,CAACI,MAAJ,KAAemB,cAAc,CAAC6Y,OAAzC,EACA;CACC,iBAAOpa,GAAG,CAACib,KAAX;CACA;CACD;;CAED,aAAO,EAAP;CACA;CAhPF;CAAA;CAAA,iCAmPC;CACC,4CAAI,IAAJ,YACA;CACCra,QAAAA,aAAG,CAAC0K,QAAJ,mCAAa,IAAb,YAAyB,YAAzB;CACA,aAAK7I,IAAL,CAAU,gBAAV;CACA;CACD;CAzPF;CAAA;CAAA,mCA4PC;CACC,4CAAI,IAAJ,YACA;CACC7B,QAAAA,aAAG,CAAC2K,WAAJ,mCAAgB,IAAhB,YAA4B,YAA5B;CACA,aAAK9I,IAAL,CAAU,kBAAV;CACA;CACD;CAlQF;CAAA;CAAA,iCAqQC;CACC,aAAO,oDAAc7B,aAAG,CAACid,QAAJ,mCAAa,IAAb,YAAyB,YAAzB,CAArB;CACA;CAvQF;CAAA;CAAA,qCAyQkBC,QAzQlB,EA0QC;CAAA;;CACC,2DAAiBhgB,QAAQ,CAACsN,MAAT,GAAkB2S,WAAlB,CAA8B,UAA9B,EAA0CD,QAA1C,CAAjB;;CAEA,UAAI,CAACA,QAAL,EACA;CACCld,QAAAA,aAAG,CAAC0K,QAAJ,mCAAa,IAAb,YAAyB,eAAzB;CACA;;CAED,UAAM0S,YAAY,GAAG,iDAAWxY,aAAX,CAAyB,sCAAzB,CAArB;CACA5E,MAAAA,aAAG,CAACwI,IAAJ,CAAS4U,YAAT;;CAEA,uDAAW1R,OAAX,GAAqB,YAAM;CAC1B,YAAI,CAAC,kCAAA,MAAI,cAAJ,CAAe9J,QAAf,EAAD,IAA8B,CAAC,kCAAA,MAAI,cAAJ,CAAeyb,WAAf,CAA2B,UAA3B,EAAuC,KAAvC,CAAnC,EACA;CACC;CACA;;CAED,YAAI,CAAC,MAAI,CAACC,UAAL,EAAL,EACA;CACC,UAAA,MAAI,CAACC,UAAL;CACA,SAHD,MAKA;CACC,UAAA,MAAI,CAACC,YAAL;CACA;CACD,OAdD;CAeA;CApSF;CAAA;CAAA,wCAuSC;CACC,2DAAiBtgB,QAAQ,CAACkB,IAAT,EAAjB;CACA,WAAKof,YAAL;CACAxd,MAAAA,aAAG,CAAC2K,WAAJ,mCAAgB,IAAhB,YAA4B,eAA5B;CAEA,UAAMyS,YAAY,GAAG,iDAAWxY,aAAX,CAAyB,sCAAzB,CAArB;CACA5E,MAAAA,aAAG,CAAC2H,IAAJ,CAASyV,YAAT;CAEA,uDAAW1R,OAAX,GAAqBnI,SAArB;CACA;CAhTF;CAAA;CAAA,iCAmTC;CAAA;;CACC,UAAI3D,YAAY,GAAG,4CAAnB;CACA,UAAIqB,cAAc,GAAG,oCAArB;;CAEA,UAAI,qDAAepB,MAAf,MAA2B,KAAKnB,OAAL,EAA/B,EACA;CACCkB,QAAAA,YAAY,IAAI,uDAAhB;CACA;;CAED,UAAM6d,WAAW,GAAGpd,aAAG,CAACC,UAAJ,CAAe,2BAAf,CAApB;CACA,UAAMod,UAAU,GAAG1d,aAAG,CAACC,MAAJ,CAAW,GAAX,EAAgB;CAClCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,6CAA6C,qDAAewd,MAAf,KAA0B,aAA1B,GAA0C,EAAvF,CADL;CAEN7P,UAAAA,KAAK,EAAEzN,aAAG,CAACC,UAAJ,CAAe,sCAAf;CAFD,SAD2B;CAKlCF,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,sCAAf;CAL4B,OAAhB,CAAnB;;CAQA,UAAIvF,cAAI,CAACmD,aAAL,CAAmB,iDAAW0f,QAA9B,KAA2C,iDAAWA,QAAX,CAAoBC,gBAAnE,EACA;CACC,YAAIC,SAAS,GACZ,iDAAWF,QAAX,CAAoBC,gBAApB,CACEhP,OADF,CACU,4BADV,EACwCxO,aAAG,CAACC,UAAJ,CAAe,oCAAf,CADxC,EAEEuO,OAFF,CAEU,QAFV,EAEoBxO,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAFpB,EAGEuO,OAHF,CAGU,+BAHV,EAG2CxO,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAH3C,EAIEuO,OAJF,CAIU,4BAJV,EAIwCxO,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAJxC,EAKEuO,OALF,CAKU,gCALV,EAK4CxO,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAL5C,EAMEuO,OANF,CAMU,8BANV,EAM0CxO,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAN1C,CADD;;CAUA,YAAIwd,SAAS,CAACtb,OAAV,CAAkB,YAAlB,KAAmC,CAAvC,EACA;CACC,+DAAe4O,SAAf,GAA2B3V,OAA3B,CAAmC,UAAAuN,KAAK,EAAI;CAC3C8U,YAAAA,SAAS,GAAGA,SAAS,CAACjP,OAAV,CAAkB7F,KAAK,CAAC,kBAAD,CAAvB,EAA6CA,KAAK,CAAC,MAAD,CAAlD,CAAZ;CACA,WAFD;CAGA;;CAED,YAAI8U,SAAS,CAACtb,OAAV,CAAkB,KAAlB,KAA4B,CAAhC,EACA;CACC,6DAAeub,MAAf,CAAsBtiB,OAAtB,CAA8B,UAAA2N,KAAK,EAAI;CACtCA,YAAAA,KAAK,CAAC4U,0BAAN,GAAmCviB,OAAnC,CAA2C,UAAAuN,KAAK,EAAI;CACnD,kBAAIA,KAAK,CAAC,MAAD,CAAL,KAAkB,MAAtB,EACA;CACC8U,gBAAAA,SAAS,GAAGA,SAAS,CAACjP,OAAV,CACX7F,KAAK,CAAC,kBAAD,CADM,EAEXI,KAAK,CAAC6U,QAAN,KAAmB,IAAnB,GAA0BjV,KAAK,CAAC,MAAD,CAFpB,CAAZ;CAIA;CACD,aARD;CASA,WAVD;CAWA;;CAED0U,QAAAA,UAAU,CAACQ,WAAX,GAAyBJ,SAAzB;CACAJ,QAAAA,UAAU,CAACS,YAAX,CAAwB,OAAxB,EAAiCL,SAAjC;;CAEA,YAAI,iDAAWF,QAAX,CAAoBQ,cAAxB,EACA;CACCV,UAAAA,UAAU,CAACW,IAAX,GAAkB,iDAAWT,QAAX,CAAoBQ,cAAtC;;CACA,gDAAI,IAAJ,iBACA;CACCV,YAAAA,UAAU,CAACS,YAAX,CAAwB,QAAxB,EAAkC,QAAlC;CACA;CACD;;CAED,YAAI,qDAAete,MAAf,MAA2BmW,QAAQ,CAAC,iDAAW4H,QAAX,CAAoBU,aAArB,CAAR,GAA8C,CAA7E,EACA;CACCZ,UAAAA,UAAU,CAACS,YAAX,CAAwB,oBAAxB,EAA8C,iDAAWP,QAAX,CAAoBU,aAAlE;CACA;CACD;;CAED,UAAIC,UAAU,GAAG,KAAK9B,gBAAL,GAAwB+B,MAAxB,CAChBne,aAAG,CAACC,UAAJ,CAAe,gCAAf,CADgB,EAEhB,qDAAe8Q,SAAf,EAFgB,CAAjB;;CAKA,UAAI,KAAKqN,sBAAL,EAAJ,EACA;CACCF,QAAAA,UAAU,GAAIA,UAAU,KAAKle,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAAhB,GAAoEie,UAAU,GAAG,IAAjF,GAAwF,EAArG;CACAA,QAAAA,UAAU,IAAIle,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAAd;CACA;;CAED,UAAI,KAAK2Q,YAAL,GAAoBvL,KAApB,CAA0BC,MAA1B,GAAmC,CAAvC,EACA;CACC4Y,QAAAA,UAAU,IAAI,OAAOle,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAArB;CACA;;CAED,UAAMoe,SAAS,GAAG1e,aAAG,CAACC,MAAJ,CACjB,qDAAeJ,MAAf,KAA0B,GAA1B,GAAgC,MADf,EAEjB;CACCK,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,qDAAeN,MAAf,KAA0B,+BAA1B,GAA4D,+BADjE;CAENiO,UAAAA,KAAK,EAAEyQ;CAFD,SADR;CAKCne,QAAAA,IAAI,EAAEme;CALP,OAFiB,CAAlB;CAWA,UAAMI,UAAU,GAAG3e,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACpCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL;CAD6B,OAAlB,CAAnB;CAKA,WAAKye,aAAL,CAAmB,iBAAnB,EAAsC,YAAM;CAC3C,YAAIld,QAAQ,CAACmd,cAAT,CAAwBF,UAAxB,CAAJ,EACA;CACCjd,UAAAA,QAAQ,CAACyE,QAAT;CACA;CACD,OALD;;CAOA,cAAQ,KAAKzF,YAAL,EAAR;CAEC,aAAKC,cAAc,CAAC6Y,OAApB;CACC,cAAI,qDAAe/E,kBAAf,OAAwC,mDAAe1T,WAAf,EAA5C,EACA;CACC4d,YAAAA,UAAU,CAAC1a,SAAX,CAAqBlH,GAArB,CAAyB,UAAzB;CAEA,gBAAM+hB,UAAU,GAAG,KAAKC,aAAL,EAAnB;;CACA,gBAAID,UAAU,CAACnZ,MAAf,EACA;CACCgZ,cAAAA,UAAU,CAACR,YAAX,CAAwB,WAAxB,EAAqCW,UAAU,CAACE,IAAX,CAAgB,IAAhB,CAArC;CACAtd,cAAAA,QAAQ,CAACuE,UAAT,CAAoB0Y,UAApB;CACA;CACD;;CACD;;CACD,aAAKhe,cAAc,CAACC,SAApB;CACA,aAAKD,cAAc,CAACse,aAApB;CACChe,UAAAA,cAAc,IAAI,aAAlB;CACA0d,UAAAA,UAAU,CAAC1a,SAAX,CAAqBlH,GAArB,CAAyB,YAAzB;CACA;CAnBF;;CAsBA,UAAMod,MAAM,GAAG,KAAK+E,YAAL,EAAf;;CACA,UAAI/E,MAAM,CAACxU,MAAP,GAAgB,CAApB,EACA;CACCgZ,QAAAA,UAAU,CAAC1a,SAAX,CAAqBlH,GAArB,CAAyB,UAAzB;CACA4hB,QAAAA,UAAU,CAACR,YAAX,CAAwB,WAAxB,EAAqChE,MAAM,CAAC6E,IAAP,CAAY,IAAZ,CAArC;CACAtd,QAAAA,QAAQ,CAACuE,UAAT,CAAoB0Y,UAApB;CACA;;CAED,UAAIQ,cAAc,GAAG,qCAArB;;CACA,UAAI,qDAAetf,MAAf,MAA2B,KAAKnB,OAAL,EAA/B,EACA;CACCygB,QAAAA,cAAc,IAAI,+CAAlB;CACA;;CAED,UAAMje,GAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAEc,cADL;CAEN,uBAAa,iBAFP;CAGN,uBAAa,YAHP;CAIN,qBAAW,KAAK1B,KAAL;CAJL,SADsB;CAO7B4B,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjB0N,UAAAA,KAAK,EAAE;CACNxN,YAAAA,SAAS,EAAE;CADL;CADU,SAAlB,CADS,EAMTH,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAEP;CADL,WADU;CAIjBuB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADU;CAEjBgB,YAAAA,QAAQ,EAAE,CAACud,SAAD;CAFO,WAAlB,CADS,EAKT1e,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,YAAAA,KAAK,EAAE;CACNC,cAAAA,SAAS,EAAE;CADL,aADU;CAIjBgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,cAAAA,KAAK,EAAE;CACNC,gBAAAA,SAAS,EAAEgf;CADL,eADU;CAIjB3X,cAAAA,IAAI,EAAE,KAAK4X,SAAL,CAAe,KAAKnB,QAAL,EAAf,CAJW;CAKjB7W,cAAAA,MAAM,EAAE;CACP0D,gBAAAA,KAAK,EAAE,eAAAhJ,KAAK,EAAI;CACf,sBAAI,kCAAA,MAAI,cAAJ,CAAejC,MAAf,MAA2B,MAAI,CAACnB,OAAL,EAA3B,IAA6C,CAAC,kCAAA,MAAI,cAAJ,CAAekD,QAAf,EAAlD,EACA;CACC,oBAAA,MAAI,CAACyd,gBAAL,CAAsBvd,KAAtB;CACA;CACD;CANM;CALS,aAAlB,CADS;CAJO,WAAlB,CALS,EA0BT9B,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADU;CAEjBgB,YAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,cAAAA,KAAK,EAAE;CAAEC,gBAAAA,SAAS,EAAE;CAAb,eADU;CAEjBC,cAAAA,IAAI,EAAEqd,WAAW,GAAG;CAFH,aAAlB,CADS,EAKTC,UALS;CAFO,WAAlB,CA1BS,EAoCTiB,UApCS;CAJO,SAAlB,CANS;CAPmB,OAAlB,CAAZ;;CA2DA,UAAI,KAAKjgB,OAAL,EAAJ,EACA;CACC,aAAK0C,YAAL,CAAkBF,GAAlB;CACA;;CAED,UAAI,qDAAerB,MAAf,EAAJ,EACA;CACC,YAAMwB,SAAS,GAAGrB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACpCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL;CAD6B,SAAnB,CAAlB;CAKAI,QAAAA,eAAK,CAACC,IAAN,CAAWa,SAAX,EAAsB,OAAtB,EAA+B,KAAKC,mBAAL,CAAyBd,IAAzB,CAA8B,IAA9B,EAAoCa,SAApC,CAA/B;CACAH,QAAAA,GAAG,CAACoe,SAAJ,CAAc/d,WAAd,CAA0BF,SAA1B;CAEA,YAAMtB,OAAO,GAAGC,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WAD0B;CAIjCC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,6BAAf,KAAiD;CAJtB,SAAlB,CAAhB;CAMAC,QAAAA,eAAK,CAACC,IAAN,CAAWT,OAAX,EAAoB,OAApB,EAA6B,KAAKU,iBAAL,CAAuBD,IAAvB,CAA4B,IAA5B,EAAkCT,OAAlC,CAA7B;CACAmB,QAAAA,GAAG,CAACK,WAAJ,CAAgBxB,OAAhB;CAEA,YAAMD,WAAW,GAAGE,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACrCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WAD8B;CAIrCC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,6BAAf;CAJ+B,SAAlB,CAApB;CAMAC,QAAAA,eAAK,CAACC,IAAN,CAAWU,GAAX,EAAgB,OAAhB,EAAyB,KAAKM,qBAAL,CAA2BhB,IAA3B,CAAgC,IAAhC,EAAsCU,GAAtC,CAAzB;CAEAA,QAAAA,GAAG,CAACK,WAAJ,CAAgBzB,WAAhB;CACA;;CAED,aAAOoB,GAAP;CACA;CAniBF;CAAA;CAAA,wCAqiBqBO,MAriBrB,EAqiB6BK,KAriB7B,EAsiBC;CACCA,MAAAA,KAAK,CAACC,eAAN;;CAEA,UAAI,CAAC,KAAKrD,OAAL,EAAL,EACA;CACCgD,QAAAA,QAAQ,CAACC,qBAAT,CAA+BF,MAA/B;CACA,OAHD,MAIK,IAAI,CAAC,qDAAeG,QAAf,EAAL,EACL;CACC5B,QAAAA,aAAG,CAACyE,MAAJ,mCAAW,IAAX;CACA,2DAAe8a,WAAf,CAA2B,IAA3B;CACA;CACD;CAljBF;CAAA;CAAA,0CAojBuB9d,MApjBvB,EAqjBC;CACC,UAAI,CAAC,KAAK/C,OAAL,EAAL,EACA;CACCgD,QAAAA,QAAQ,CAACC,qBAAT,CAA+BF,MAA/B;CACA,OAHD,MAIK,IAAI,CAAC,qDAAeG,QAAf,EAAL,EACL;CACC,2DAAe4d,uBAAf,CAAuC,IAAvC;CACA;CACD;CA9jBF;CAAA;CAAA,sCAgkBmB/d,MAhkBnB,EAgkB2BK,KAhkB3B,EAikBC;CACCA,MAAAA,KAAK,CAACC,eAAN;;CAEA,UAAI,CAAC,KAAKrD,OAAL,EAAL,EACA;CACCgD,QAAAA,QAAQ,CAACC,qBAAT,CAA+BF,MAA/B;CACA,OAHD,MAIK,IAAI,CAAC,qDAAeG,QAAf,EAAL,EACL;CACC,YAAM6d,WAAW,GAAG,KAAKxhB,KAAL,EAApB;CACA,YAAMyhB,UAAU,GAAGD,WAAW,CAACpC,WAAZ,CAAwB,OAAxB,CAAnB;;CACA,YAAI,CAACtiB,cAAI,CAACC,KAAL,CAAW0kB,UAAX,CAAL,EACA;CACC,cAAMC,QAAQ,GAAGD,UAAU,GAAG,GAAb,GAAmB,GAAnB,GAAyBrf,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAA1C;CACAmf,UAAAA,WAAW,CAACtC,WAAZ,CAAwB,OAAxB,EAAiCwC,QAAjC;CACAF,UAAAA,WAAW,CAAC7O,MAAZ;CACA;;CAEDgP,QAAAA,QAAQ,CAACC,WAAT,mCAAqB,IAArB,cAAqCJ,WAArC,EAAkD,mDAAeK,YAAf,CAA4B,IAA5B,CAAlD;CACA;CACD;CArlBF;CAAA;CAAA,qCAulBkB/T,CAvlBlB,EAwlBC;CACCA,MAAAA,CAAC,CAACgU,cAAF;CACAhU,MAAAA,CAAC,CAAChK,eAAF;CAEA,UAAM0L,QAAQ,GAAG,uCAAjB;CAEA,UAAMC,IAAI,GAAG1N,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC/B0N,QAAAA,KAAK,EAAE;CACNvQ,UAAAA,IAAI,EAAEqQ;CADA,SADwB;CAI/B1J,QAAAA,KAAK,EAAE;CAAC,uBAAa;CAAd;CAJwB,OAAnB,CAAb;CAOA2J,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACnCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD4B;CAEnCC,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf,IAAsD;CAFzB,OAAnB,CAAjB;CAKAoN,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCgB,QAAAA,QAAQ,EAAE,CAACwB,EAAE,CAAC1C,MAAH,CAAU,OAAV,EAAmB;CAC7BC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE,gCADL;CAENuE,YAAAA,IAAI,EAAE,MAFA;CAGNtH,YAAAA,IAAI,EAAE,MAHA;CAINC,YAAAA,KAAK,EAAE,KAAK4gB,QAAL;CAJD;CADsB,SAAnB,CAAD;CAFwB,OAAlB,CAAjB;CAYA,WAAKpc,IAAL,CAAU,uBAAV;CAEA,UAAMgJ,IAAI,GAAG,IAAb;CACA,UAAM2C,KAAK,GAAG,IAAI7K,EAAE,CAACkE,WAAP,CAAmB6B,yBAAM,CAACkD,gBAAP,EAAnB,EAA8C,IAA9C,EAAoD;CACjEyD,QAAAA,QAAQ,EAAEhP,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADuD;CAEjEiH,QAAAA,OAAO,EAAEmG,IAFwD;CAGjE6B,QAAAA,SAAS,EAAE,IAHsD;CAIjEtI,QAAAA,UAAU,EAAE,CAJqD;CAKjEC,QAAAA,SAAS,EAAE,CALsD;CAMjEkB,QAAAA,UAAU,EAAE,IANqD;CAOjEoH,QAAAA,SAAS,EAAE;CAACC,UAAAA,QAAQ,EAAE;CAAX,SAPsD;CAQjEC,QAAAA,OAAO,EAAE,KARwD;CASjEtI,QAAAA,MAAM,EAAE;CACPC,UAAAA,YADO,wBACMmG,KADN,EAEP;CACCA,YAAAA,KAAK,CAAClG,OAAN;CACAuD,YAAAA,IAAI,CAAChJ,IAAL,CAAU,2BAAV;CACA;CALM,SATyD;CAgBjE+N,QAAAA,OAAO,EAAE,CACR,IAAIjN,EAAE,CAACkN,iBAAP,CAAyB;CACxBzP,UAAAA,IAAI,EAAGC,aAAG,CAACC,UAAJ,CAAe,qBAAf,CADiB;CAExBH,UAAAA,SAAS,EAAG,4BAFY;CAGxBiH,UAAAA,MAAM,EAAG;CACR0D,YAAAA,KADQ,mBAER;CACC,kBAAMkV,QAAQ,GAAGtS,IAAI,CAACuS,QAAL,CAAc7iB,IAA/B;CACAyN,cAAAA,IAAI,CAACsS,WAAL,CAAiB,OAAjB,EAA0B6C,QAAQ,CAAC3iB,KAAnC;CACAwN,cAAAA,IAAI,CAAC+F,MAAL;CACA,gDAAA/F,IAAI,YAAJ,CAAejB,YAAf;CACA,mBAAKwB,WAAL,CAAiB7C,KAAjB;CACA;CARO;CAHe,SAAzB,CADQ,EAeR,IAAI5F,EAAE,CAACkO,qBAAP,CAA6B;CAC5BzQ,UAAAA,IAAI,EAAGC,aAAG,CAACC,UAAJ,CAAe,uBAAf,CADqB;CAE5BH,UAAAA,SAAS,EAAG,iCAFgB;CAG5BiH,UAAAA,MAAM,EAAG;CACR0D,YAAAA,KADQ,mBAER;CACC,mBAAKM,WAAL,CAAiB7C,KAAjB;CACA;CAJO;CAHmB,SAA7B,CAfQ;CAhBwD,OAApD,CAAd;CA4CAiF,MAAAA,KAAK,CAAC7F,IAAN;CACA;CAtqBF;CAAA;CAAA,6BAwqBU7F,KAxqBV,EAyqBC;CACC,UAAI,mCAAC,IAAD,UAAJ,EACA;CACC;CACA;;CAED,UAAMK,KAAK,GAAGL,KAAK,CAACM,OAAN,GAAgBC,WAA9B;CACA,UAAMC,KAAK,GAAG,CAACH,KAAD,IAAU,KAAK8b,QAAL,GAAgB1b,WAAhB,GAA8BC,OAA9B,CAAsCL,KAAtC,KAAgD,CAAxE;;CAEA,UAAIG,KAAJ,EACA;CACCtC,QAAAA,aAAG,CAAC2K,WAAJ,mCAAgB,IAAhB,YAA4B,mBAA5B;CACA,OAHD,MAKA;CACC3K,QAAAA,aAAG,CAAC0K,QAAJ,mCAAa,IAAb,YAAyB,mBAAzB;CACA;CACD;CA1rBF;CAAA;CAAA,8BA4rBWwV,SA5rBX,EA6rBC;CACC,UAAIpS,KAAK,GAAGtH,cAAI,CAACC,MAAL,CAAYyZ,SAAZ,CAAZ;CACA,UAAMC,QAAQ,GAAGrS,KAAK,CAAC8J,KAAN,CAAY,GAAZ,CAAjB;CACA,UAAMwI,QAAQ,GAAG,WAAWD,QAAQ,CAACA,QAAQ,CAACxa,MAAT,GAAkB,CAAnB,CAAnB,GAA2C,SAA5D;CAEAwa,MAAAA,QAAQ,CAACrT,MAAT,CAAgBqT,QAAQ,CAACxa,MAAT,GAAkB,CAAlC;CAEAmI,MAAAA,KAAK,GAAGqS,QAAQ,CAACnB,IAAT,CAAc,GAAd,IAAqB,GAArB,GAA2BoB,QAAnC;CAEA,aAAOtS,KAAP;CACA;CAvsBF;CAAA;CAAA,+BAysBY/P,IAzsBZ,EA0sBC;CACC,UAAIhD,cAAI,CAACmD,aAAL,CAAmBH,IAAnB,CAAJ,EACA;CACC,yDAAaA,IAAb;CACA,OAHD,MAKA;CACC,cAAM,cAAN;CACA;CACD;CAntBF;CAAA;CAAA,gCAstBC;CACC,UAAMmV,MAAM,GAAGvQ,EAAE,CAAC1E,KAAH,mCAAS,IAAT,WAAf;CACA,aAAOiV,MAAM,CAAC,UAAD,CAAb;CACAA,MAAAA,MAAM,CAACsJ,KAAP,GAAe,gDAAYva,SAAZ,EAAf;CACAiR,MAAAA,MAAM,CAAC/U,SAAP,GAAmB,sDAAgB8D,SAAhB,EAAnB;CAEA,aAAOiR,MAAP;CACA;CA7tBF;CAAA;CAAA,uCAguBC;CACC,+CAAO,IAAP;CACA;CAluBF;CAAA;CAAA,qCAouBkBmN,KApuBlB,EAquBC;CACC,sDAAcA,KAAd;CAEA,aAAO,IAAP;CACA;CAzuBF;CAAA;CAAA,mCA4uBC;CACC,+CAAO,IAAP;CACA;CA9uBF;CAAA;CAAA,iCAgvBc5gB,SAhvBd,EAivBC;CACC,4DAAkBA,SAAlB;CAEA,aAAO,IAAP;CACA;CArvBF;CAAA;CAAA,4CAuvByBC,IAvvBzB,EAwvBC;CACC,uDAAW4gB,oBAAX,GAAkC5gB,IAAI,GAAG,CAAH,GAAO,CAA7C;CAEA,aAAO,IAAP;CACA;CA5vBF;CAAA;CAAA,6CA+vBC;CACC,aAAQ,iDAAW4gB,oBAAX,KAAoC,CAApC,IAAyC,iDAAWA,oBAAX,KAAoC,GAArF;CACA;CAjwBF;CAAA;CAAA,iCAmwBc7d,MAnwBd,EAowBC;CACC,UAAI1H,cAAI,CAACC,KAAL,CAAWyH,MAAM,CAAC,UAAD,CAAjB,CAAJ,EACA;CACCA,QAAAA,MAAM,CAACC,aAAP,GAAuBC,EAAE,CAACC,KAAH,CAAS,KAAKC,SAAd,EAAyB,IAAzB,CAAvB;CACAJ,QAAAA,MAAM,CAACK,QAAP,GAAkBH,EAAE,CAACC,KAAH,CAAS,KAAKG,QAAd,EAAwB,IAAxB,CAAlB;CACAN,QAAAA,MAAM,CAACO,YAAP,GAAsBL,EAAE,CAACC,KAAH,CAAS,KAAKK,QAAd,EAAwB,IAAxB,CAAtB;CACAR,QAAAA,MAAM,CAACS,aAAP,GAAuBP,EAAE,CAACC,KAAH,CAAS,KAAKO,QAAd,EAAwB,IAAxB,CAAvB;CACAC,QAAAA,IAAI,CAACC,cAAL,CAAoBZ,MAApB;CACAW,QAAAA,IAAI,CAACE,YAAL,CAAkBb,MAAlB,EAA0B,CAA1B;CACA;CACD;CA9wBF;CAAA;CAAA,mCAgxBgBA,MAhxBhB,EAixBC;CACCA,MAAAA,MAAM,CAACC,aAAP,GAAuBa,SAAvB;CACAd,MAAAA,MAAM,CAACK,QAAP,GAAkBS,SAAlB;CACAd,MAAAA,MAAM,CAACO,YAAP,GAAsBO,SAAtB;CACAd,MAAAA,MAAM,CAACS,aAAP,GAAuBK,SAAvB;CACAH,MAAAA,IAAI,CAACI,gBAAL,CAAsBf,MAAtB;CACAW,MAAAA,IAAI,CAACK,cAAL,CAAoBhB,MAApB;CACA;CAxxBF;CAAA;CAAA,gCA2xBC;CACC,WAAK8d,aAAL,GAAqB5d,EAAE,CAACe,aAAxB;;CAEA,UAAI,CAAC,KAAK6c,aAAV,EACA;CACCnd,QAAAA,IAAI,CAACO,eAAL;CACA;CACA;;CAED,UAAI,CAAC,KAAK6c,IAAV,EACA;CACC,YAAM5c,SAAS,GAAG,KAAK2c,aAAL,CAAmB1c,WAArC;CACA,aAAK2c,IAAL,GAAY,KAAKD,aAAL,CAAmBzc,SAAnB,CAA6B,IAA7B,CAAZ;CACA,aAAK0c,IAAL,CAAUzc,KAAV,CAAgBC,QAAhB,GAA2B,UAA3B;CACA,aAAKwc,IAAL,CAAUvc,SAAV,CAAoBlH,GAApB,CAAwB,yCAAxB;CACA,aAAKyjB,IAAL,CAAUzc,KAAV,CAAgBG,KAAhB,GAAwBN,SAAS,GAAG,IAApC;CACA/C,QAAAA,QAAQ,CAACsD,IAAT,CAAc5C,WAAd,CAA0B,KAAKif,IAA/B;CACA;CACD;CA7yBF;CAAA;CAAA,6BA+yBUpc,CA/yBV,EA+yBYC,CA/yBZ,EAgzBC;CACC,WAAKmc,IAAL,CAAUzc,KAAV,CAAgBO,IAAhB,GAAuBF,CAAC,GAAG,IAA3B;CACA,WAAKoc,IAAL,CAAUzc,KAAV,CAAgBQ,GAAhB,GAAsBF,CAAC,GAAG,IAA1B;CACA;CAnzBF;CAAA;CAAA,6BAqzBUG,WArzBV,EAqzBuBJ,CArzBvB,EAqzB0BC,CArzB1B,EAszBC;CACC,UAAI,KAAKoc,aAAT,EACA;CACC,aAAKA,aAAL,CAAmBxc,SAAnB,CAA6BQ,MAA7B,CAAoC,wCAApC;CACA;;CAED,UAAI,KAAKic,eAAT,EACA;CACC,aAAKA,eAAL,CAAqBzc,SAArB,CAA+BQ,MAA/B,CAAsC,mCAAtC;CACA;;CAED,UAAMC,IAAI,GAAGF,WAAW,CAACG,YAAZ,CAAyB,WAAzB,CAAb;;CAEA,UAAID,IAAI,KAAK,YAAb,EACA;CACC,aAAK+b,aAAL,GAAqBjc,WAArB;CACA,aAAKkc,eAAL,GAAuB,IAAvB;CACA;;CAED,UAAIhc,IAAI,KAAK,cAAb,EACA;CACC,aAAKgc,eAAL,GAAuBlc,WAAW,CAACI,aAAZ,CAA0B,0BAA1B,CAAvB;CACA,aAAK6b,aAAL,GAAqB,IAArB;CACA;;CAED,UAAI,KAAKA,aAAT,EACA;CACC,aAAKA,aAAL,CAAmBxc,SAAnB,CAA6BlH,GAA7B,CAAiC,wCAAjC;CACA;;CAED,UAAI,KAAK2jB,eAAT,EACA;CACC,aAAKA,eAAL,CAAqBzc,SAArB,CAA+BlH,GAA/B,CAAmC,mCAAnC;CACA;CACD;CAx1BF;CAAA;CAAA,6BA01BUqH,CA11BV,EA01BaC,CA11Bb,EA01BgBvC,KA11BhB,EA21BC;CACCA,MAAAA,KAAK,GAAGA,KAAK,IAAI+C,MAAM,CAAC/C,KAAxB;CACA,UAAMgD,MAAM,GAAGhD,KAAK,KAAKA,KAAK,CAACiD,OAAN,IAAiBjD,KAAK,CAACkD,OAA5B,CAApB;;CAEA,UAAI,KAAKub,aAAT,EACA;CACC,YAAI,KAAKE,aAAT,EACA;CACC,eAAKA,aAAL,CAAmBxc,SAAnB,CAA6BQ,MAA7B,CAAoC,wCAApC;CACA,eAAK5C,IAAL,CAAU,cAAV,EAA0B;CACzB8e,YAAAA,YAAY,EAAE,KAAKF,aAAL,CAAmBliB,UADR;CAEzBuG,YAAAA,MAAM,EAANA,MAFyB;CAGzB2b,YAAAA,aAAa,EAAE,KAAKA,aAHK;CAIzBrX,YAAAA,KAAK,EAAE;CAJkB,WAA1B;CAMA,SATD,MAUK,IAAI,KAAKsX,eAAT,EACL;CACC,eAAKA,eAAL,CAAqBzc,SAArB,CAA+BQ,MAA/B,CAAsC,mCAAtC;CACA,eAAK5C,IAAL,CAAU,cAAV,EAA0B;CACzB8e,YAAAA,YAAY,EAAE,KAAKD,eADM;CAEzB5b,YAAAA,MAAM,EAANA,MAFyB;CAGzBsE,YAAAA,KAAK,EAAE;CAHkB,WAA1B;CAKA;CACD;;CAED,WAAKoX,IAAL,CAAUjiB,UAAV,CAAqBiH,WAArB,CAAiC,KAAKgb,IAAtC;CACA,WAAKA,IAAL,GAAY,IAAZ;CACA,WAAKD,aAAL,GAAqB,IAArB;CACA,WAAKE,aAAL,GAAqB,IAArB;CACA;CA13BF;CAAA;CAAA,2BA43BQtE,QA53BR,EA43BkByE,WA53BlB,EA63BC;CACC5gB,MAAAA,aAAG,CAACyE,MAAJ,mCAAW,IAAX;CACA,yDAAe8a,WAAf,CAA2B,IAA3B;CACA,yDAAiBpD,QAAjB;CAEA,yDAAe0E,WAAf,CAA2B,IAA3B,EAAiCD,WAAjC;CACA,uDAAa,KAAKviB,UAAL,EAAb;CACA,yDAAeyiB,eAAf,mCAA+B,IAA/B,YAA2CF,WAAW,GAAGA,WAAW,CAACtiB,IAAf,GAAsB,IAA5E;CACA;CAr4BF;CAAA;CAAA,2BAu4BQ6d,QAv4BR,EAu4BkByE,WAv4BlB,EAw4BC;CACC,UAAMxX,KAAK,GAAG,IAAI8S,KAAJ,CAAU;CACvBrb,QAAAA,QAAQ,oCAAE,IAAF,cADe;CAEvBsb,QAAAA,QAAQ,EAARA,QAFuB;CAGvBC,QAAAA,WAAW,oCAAE,IAAF,eAHY;CAIvB/c,QAAAA,OAAO,oCAAE,IAAF;CAJgB,OAAV,CAAd;CAOA,UAAMid,SAAS,GAAG,KAAKra,SAAL,EAAlB;CACA,aAAOqa,SAAS,CAAC,MAAD,CAAhB;CACA,aAAOA,SAAS,CAAC,WAAD,CAAhB;CAEAlT,MAAAA,KAAK,CAAClH,IAAN,CAAWoa,SAAX,oCAAsB,IAAtB;CAEAH,MAAAA,QAAQ,CAAC0E,WAAT,CAAqBzX,KAArB,EAA4BwX,WAA5B;CACAzE,MAAAA,QAAQ,CAAC2E,eAAT,CAAyB1X,KAAK,CAAC9K,IAA/B,EAAqCsiB,WAAW,GAAGA,WAAW,CAACtiB,IAAf,GAAsB,IAAtE;CAEA,aAAO8K,KAAP;CACA;CA15BF;CAAA;CAAA,+BA65BC;CACC,aAAO,KAAKiU,WAAL,CAAiB,OAAjB,KAA6B,KAAK0D,mBAAL,EAApC;CACA;CA/5BF;CAAA;CAAA,0CAk6BC;CACC,UAAI3jB,IAAI,GAAG,UAAX;CACA,UAAM4jB,WAAW,GAAG,KAAK7E,QAAL,CAAc8E,mBAAd,CAAkC,iDAAW,MAAX,CAAlC,CAApB;;CACA,UAAID,WAAW,CAAC,MAAD,CAAf,EACA;CACC5jB,QAAAA,IAAI,GAAG4jB,WAAW,CAAC,MAAD,CAAlB;CACA;;CACD,UAAIA,WAAW,CAAC,gBAAD,CAAX,IAAiCA,WAAW,CAAC,gBAAD,CAAX,CAA8B,OAA9B,CAArC,EACA;CACC5jB,QAAAA,IAAI,GAAG4jB,WAAW,CAAC,gBAAD,CAAX,CAA8B,OAA9B,CAAP;CACA;;CAED,aAAO5jB,IAAP;CACA;CA/6BF;CAAA;CAAA,+BAk7BC;CACC,aAAO,KAAK6gB,QAAL,OAAoB,UAA3B;CACA;CAp7BF;CAAA;CAAA,sCAu7BC;CACC,UAAM+C,WAAW,GAAG,KAAK7E,QAAL,CAAc8E,mBAAd,CAAkC,iDAAW,MAAX,CAAlC,CAApB;CACA,UAAMtT,KAAK,GAAG,iDAAW,YAAX,CAAd;;CAEA,UAAI,CAAC5S,cAAI,CAACmmB,QAAL,CAAcF,WAAd,CAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAMG,mBAAmB,GAAG,SAAtBA,mBAAsB;CAAA,eAC3BpmB,cAAI,CAACmmB,QAAL,CAAcF,WAAW,CAAC,QAAD,CAAzB,KACGjmB,cAAI,CAAC8Z,aAAL,CAAmB8F,MAAM,CAACxe,MAAP,CAAc6kB,WAAW,CAAC,QAAD,CAAzB,CAAnB,CAFwB;CAAA,OAA5B;;CAKA,UAAMI,6BAA6B,GAAG,SAAhCA,6BAAgC;CAAA,eACrCrmB,cAAI,CAACS,OAAL,CAAawlB,WAAW,CAAC,mBAAD,CAAxB,KACGA,WAAW,CAAC,mBAAD,CAAX,CAAiCK,IAAjC,CAAsC,UAAAC,WAAW;CAAA,iBAAI3G,MAAM,CAACxe,MAAP,CAAcwR,KAAK,CAAC2T,WAAD,CAAL,CAAmB3b,MAAnB,GAA4B,CAA1C,CAAJ;CAAA,SAAjD,CAFkC;CAAA,OAAtC;;CAKA,aAAOwb,mBAAmB,MAAMC,6BAA6B,EAA7D;CACA;CA38BF;CAAA;CAAA,iDA88BC;CAAA;;CACC,UAAMrY,MAAM,GAAG,EAAf;CACA,UAAMiY,WAAW,GAAG,KAAK7E,QAAL,CAAc8E,mBAAd,CAAkC,iDAAW,MAAX,CAAlC,CAApB;;CAEA,UAAID,WAAW,IAAIA,WAAW,CAAC,QAAD,CAA9B,EACA;CACC,aAAK,IAAMO,OAAX,IAAsBP,WAAW,CAAC,QAAD,CAAjC,EACA;CACC,cAAIA,WAAW,CAAC,QAAD,CAAX,CAAsBzjB,cAAtB,CAAqCgkB,OAArC,CAAJ,EACA;CACC,gBAAMvY,KAAK,GAAGgY,WAAW,CAAC,QAAD,CAAX,CAAsBO,OAAtB,CAAd;CACAxY,YAAAA,MAAM,CAACnN,IAAP,CAAY;CACXV,cAAAA,EAAE,EAAEqmB,OADO;CAEX/N,cAAAA,QAAQ,EAAE,KAAKjU,KAAL,EAFC;CAGXmU,cAAAA,UAAU,EAAE,KAAKuK,QAAL,EAHD;CAIXxK,cAAAA,IAAI,EAAEzK,KAAK,CAAC,MAAD,CAJA;CAKXjO,cAAAA,IAAI,EAAEiO,KAAK,CAAC,MAAD,CALA;CAMX2K,cAAAA,UAAU,EAAE,QAAM,KAAKpU,KAAL,EAAN,GAAmB,GAAnB,GAAuBgiB,OAAvB,GAA+B,KAA/B,GAAqC,KAAKtD,QAAL,EAArC,GAAqD,IAArD,GAA0DjV,KAAK,CAAC,MAAD,CAA/D,GAAwE,IANzE;CAOX4K,cAAAA,gBAAgB,EAAE,OAAK,KAAKrU,KAAL,EAAL,GAAkB,GAAlB,GAAsBgiB,OAAtB,GAA8B;CAPrC,aAAZ;;CAUA,gBAAI,CAAC,KAAKC,kBAAV,EACA;CACC;CACA,aAfF;;;CAkBC,gBACCxY,KAAK,CAAC,MAAD,CAAL,KAAkB,MAAlB,IAEAA,KAAK,CAAC,MAAD,CAAL,KAAkB,MAFlB,IAIAA,KAAK,CAAC,MAAD,CAAL,KAAkB,MALnB,EAOA;CACC,kBAAMyY,YAAY,GAAIzY,KAAK,CAAC,MAAD,CAAL,KAAkB,MAAnB,GAA6B,UAA7B,GAA0C,WAA/D;CACAD,cAAAA,MAAM,CAACnN,IAAP,CAAY;CACXV,gBAAAA,EAAE,EAAEqmB,OAAO,GAAG,YADH;CAEX/N,gBAAAA,QAAQ,EAAE,KAAKjU,KAAL,EAFC;CAGXkU,gBAAAA,IAAI,EAAEzK,KAAK,CAAC,MAAD,CAAL,GAAgB,GAAhB,GAAsB3I,aAAG,CAACC,UAAJ,CAAe,6CAAf,CAHjB;CAIXvF,gBAAAA,IAAI,EAAE,QAJK;CAKX4Y,gBAAAA,UAAU,eAAQ,KAAKpU,KAAL,EAAR,cAAwBgiB,OAAxB,gBAAqCE,YAArC,gBAAuD,KAAKxD,QAAL,EAAvD,eAA2EjV,KAAK,CAAC,MAAD,CAAhF,OALC;CAMX4K,gBAAAA,gBAAgB,cAAO,KAAKrU,KAAL,EAAP,cAAuBgiB,OAAvB,cAAkCE,YAAlC;CANL,eAAZ;CAQA;CACD;CACD;CACD;;CAED,UAAIT,WAAW,IAAIjmB,cAAI,CAACS,OAAL,CAAawlB,WAAW,CAAC,mBAAD,CAAxB,CAAnB,EACA;CACC,YAAMrT,KAAK,GAAG,iDAAW,YAAX,CAAd;CAEAqT,QAAAA,WAAW,CAAC,mBAAD,CAAX,CAAiCvlB,OAAjC,CAAyC,UAAC6lB,WAAD,EAAiB;CACzD,cAAI3T,KAAK,CAAC2T,WAAD,CAAT,EACA;CACC,iBAAK,IAAMC,QAAX,IAAsB5T,KAAK,CAAC2T,WAAD,CAA3B,EACA;CACC,kBAAI3T,KAAK,CAAC2T,WAAD,CAAL,CAAmB/jB,cAAnB,CAAkCgkB,QAAlC,CAAJ,EACA;CACC,oBAAMvY,MAAK,GAAG2E,KAAK,CAAC2T,WAAD,CAAL,CAAmBC,QAAnB,CAAd;CACAxY,gBAAAA,MAAM,CAACnN,IAAP,CAAY;CACXV,kBAAAA,EAAE,EAAEqmB,QADO;CAEX/N,kBAAAA,QAAQ,EAAE,MAAI,CAACjU,KAAL,EAFC;CAGXkU,kBAAAA,IAAI,EAAEzK,MAAK,CAAC,MAAD,CAHA;CAIXjO,kBAAAA,IAAI,EAAEiO,MAAK,CAAC,MAAD,CAJA;CAKX0Y,kBAAAA,OAAO,EAAE1Y,MAAK,CAAC,SAAD,CAAL,IAAoB,IALlB;CAMX2K,kBAAAA,UAAU,eAAQ,MAAI,CAACpU,KAAL,EAAR,cAAwBgiB,QAAxB,gBAAqC,MAAI,CAACtD,QAAL,EAArC,eAAyDjV,MAAK,CAAC,MAAD,CAA9D,OANC;CAOX4K,kBAAAA,gBAAgB,EAAE,OAAO,MAAI,CAACrU,KAAL,EAAP,GAAsB,GAAtB,GAA4BgiB,QAA5B,GAAsC;CAP7C,iBAAZ,EAFD;;CAaC,oBACCvY,MAAK,CAAC,MAAD,CAAL,KAAkB,MAAlB,IAEAA,MAAK,CAAC,MAAD,CAAL,KAAkB,MAFlB,IAIAA,MAAK,CAAC,MAAD,CAAL,KAAkB,MALnB,EAOA;CACC,sBAAMyY,aAAY,GAAIzY,MAAK,CAAC,MAAD,CAAL,KAAkB,MAAnB,GAA6B,UAA7B,GAA0C,WAA/D;;CACA,sBAAM2Y,UAAU,gBAAS,MAAI,CAACpiB,KAAL,EAAT,cAAyBgiB,QAAzB,gBAAsCE,aAAtC,gBAAwD,MAAI,CAACxD,QAAL,EAAxD,eAA4EjV,MAAK,CAAC,MAAD,CAAjF,OAAhB;CACAD,kBAAAA,MAAM,CAACnN,IAAP,CAAY;CACXV,oBAAAA,EAAE,EAAEqmB,QAAO,GAAG,YADH;CAEX/N,oBAAAA,QAAQ,EAAE,MAAI,CAACjU,KAAL,EAFC;CAGXkU,oBAAAA,IAAI,EAAEzK,MAAK,CAAC,MAAD,CAAL,GAAgB,GAAhB,GAAsB3I,aAAG,CAACC,UAAJ,CAAe,6CAAf,CAHjB;CAIXvF,oBAAAA,IAAI,EAAE,QAJK;CAKX4Y,oBAAAA,UAAU,EAAEgO,UALD;CAMX/N,oBAAAA,gBAAgB,EAAE,OAAO,MAAI,CAACrU,KAAL,EAAP,GAAsB,GAAtB,GAA4BgiB,QAA5B,GAAsC,GAAtC,GAA4CE,aAA5C,GAA2D;CANlE,mBAAZ;CAQA;CACD;CACD;CACD;CACD,SAzCD;CA0CA;;CAED,aAAO1Y,MAAP;CACA;CAhjCF;CAAA;CAAA,sCAkjCmBiR,EAljCnB,EAmjCC;CACC,UAAMjR,MAAM,GAAG,KAAKiV,0BAAL,EAAf;;CACA,WAAK,IAAInV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGE,MAAM,CAACpD,MAA3B,EAAmC,EAAEkD,CAArC,EACA;CACC,YAAIE,MAAM,CAACF,CAAD,CAAN,CAAU,IAAV,MAAoBmR,EAAxB,EACA;CACC,iBAAOjR,MAAM,CAACF,CAAD,CAAb;CACA;CACD;;CAED,aAAO,IAAP;CACA;CA9jCF;CAAA;CAAA,oCAikCC;CAAA;;CACC,UAAMiL,UAAU,GAAG,KAAKgJ,aAAL,EAAnB;CACA,UAAM8E,MAAM,GAAG;CACd7N,QAAAA,QAAQ,EAAE,IAAIrX,GAAJ,EADI;CAEdmlB,QAAAA,QAAQ,EAAE,IAAInlB,GAAJ,EAFI;CAGdolB,QAAAA,QAAQ,EAAE,IAAIplB,GAAJ,EAHI;CAIdqlB,QAAAA,SAAS,EAAE,IAAIrlB,GAAJ,EAJG;CAKdslB,QAAAA,cAAc,EAAE,IAAItlB,GAAJ,EALF;CAMdulB,QAAAA,cAAc,EAAE,IAAIvlB,GAAJ,EANF;CAOdwlB,QAAAA,QAAQ,EAAE,IAAIxlB,GAAJ;CAPI,OAAf;CAUAie,MAAAA,MAAM,CAACxe,MAAP,CAAc2X,UAAd,EAA0BrY,OAA1B,CAAkC,UAAA8X,QAAQ;CAAA,eAAI,MAAI,CAAC4O,kBAAL,CAAwB5O,QAAxB,EAAkCqO,MAAlC,CAAJ;CAAA,OAA1C;CAEA,UAAMQ,UAAU,GAAG,KAAKnR,YAAL,GAAoBhP,SAApB,EAAnB;CACAmgB,MAAAA,UAAU,CAAC1c,KAAX,CAAiBjK,OAAjB,CAAyB,UAAAyP,IAAI;CAAA,eAAI,MAAI,CAACmX,wBAAL,CAA8BnX,IAAI,CAAC,CAAD,CAAlC,EAAuC0W,MAAvC,CAAJ;CAAA,OAA7B;CAEA,aAAOA,MAAP;CACA;CAnlCF;CAAA;CAAA,uCAqlCoBvkB,KArlCpB,EAqlC2BukB,MArlC3B,EAslCC;CAAA;;CACC,UAAI7mB,cAAI,CAACS,OAAL,CAAa6B,KAAb,CAAJ,EACA;CACCA,QAAAA,KAAK,CAAC5B,OAAN,CAAc,UAAAqN,CAAC;CAAA,iBAAI,MAAI,CAACqZ,kBAAL,CAAwBrZ,CAAxB,EAA2B8Y,MAA3B,CAAJ;CAAA,SAAf;CACA,OAHD,MAIK,IAAI7mB,cAAI,CAACmD,aAAL,CAAmBb,KAAnB,CAAJ,EACL;CACCsd,QAAAA,MAAM,CAACxe,MAAP,CAAckB,KAAd,EAAqB5B,OAArB,CAA6B,UAAA4B,KAAK;CAAA,iBAAI,MAAI,CAAC8kB,kBAAL,CAAwB9kB,KAAxB,EAA+BukB,MAA/B,CAAJ;CAAA,SAAlC;CACA,OAHI,MAIA,IAAI7mB,cAAI,CAAC6L,cAAL,CAAoBvJ,KAApB,CAAJ,EACL;CACC,YAAI2a,KAAJ;CACA,YAAMsK,sBAAsB,GAAG,IAAIC,MAAJ,CAAW,KAAKC,yBAAhB,EAA2C,IAA3C,CAA/B;;CACA,eAAO,CAACxK,KAAK,GAAGsK,sBAAsB,CAACvK,IAAvB,CAA4B1a,KAA5B,CAAT,MAAiD,IAAxD,EACA;CACC,eAAKglB,wBAAL,CAA8BrK,KAAK,CAACyK,MAApC,EAA4Cb,MAA5C;CACA;CACD;CACD;CAxmCF;CAAA;CAAA,6CA0mC0Bc,WA1mC1B,EA0mCuCd,MA1mCvC,EA2mCC;CACC,UAAI7mB,cAAI,CAACmD,aAAL,CAAmBwkB,WAAnB,KAAmCA,WAAW,CAAC,QAAD,CAA9C,IAA4DA,WAAW,CAAC,OAAD,CAA3E,EACA;CACC,gBAAQA,WAAW,CAAC,QAAD,CAAnB;CAEC,eAAK,UAAL;CACCd,YAAAA,MAAM,CAAC7N,QAAP,CAAgBhX,GAAhB,CAAoB2lB,WAAW,CAAC,OAAD,CAA/B;CACA;;CAED,eAAK,UAAL;CACCd,YAAAA,MAAM,CAACC,QAAP,CAAgB9kB,GAAhB,CAAoB2lB,WAAW,CAAC,OAAD,CAA/B;CACA;;CAED,eAAK,UAAL;CACCd,YAAAA,MAAM,CAACE,QAAP,CAAgB/kB,GAAhB,CAAoB2lB,WAAW,CAAC,OAAD,CAA/B;CACA;;CAED,eAAK,UAAL;CACCd,YAAAA,MAAM,CAACG,SAAP,CAAiBhlB,GAAjB,CAAqB2lB,WAAW,CAAC,OAAD,CAAhC;CACA;;CAED,eAAK,aAAL;CACCd,YAAAA,MAAM,CAACI,cAAP,CAAsBjlB,GAAtB,CAA0B2lB,WAAW,CAAC,OAAD,CAArC;CACA;;CAED,eAAK,WAAL;CACCd,YAAAA,MAAM,CAACK,cAAP,CAAsBllB,GAAtB,CAA0B2lB,WAAW,CAAC,OAAD,CAArC;CACA;CAxBF;;CA2BA,YAAMC,cAAc,GAAG,IAAIJ,MAAJ,CAAW,YAAX,EAAyB,IAAzB,CAAvB;;CACA,YAAII,cAAc,CAAC5K,IAAf,CAAoB2K,WAAW,CAAC,QAAD,CAA/B,CAAJ,EACA;CACCd,UAAAA,MAAM,CAACM,QAAP,CAAgBnlB,GAAhB,CAAoB,CAAC2lB,WAAW,CAAC,QAAD,CAAZ,EAAwBA,WAAW,CAAC,OAAD,CAAnC,CAApB;CACA;CACD;CACD;CA/oCF;CAAA;CAAA,oCAkpCC;CACC,UAAMd,MAAM,GAAGjf,EAAE,CAAC1E,KAAH,CAAS,KAAK2kB,aAAL,EAAT,CAAf;;CAEA,UAAI,CAAC,KAAKzG,QAAV,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM0G,WAAW,GAAG;CACnB9O,QAAAA,QAAQ,EAAE,qDAAe3C,SAAf,EADS;CAEnByQ,QAAAA,QAAQ,EAAE,mDAAeiB,YAAf,EAFS;CAGnBhB,QAAAA,QAAQ,EAAE,mDAAeiB,YAAf,EAHS;CAInBf,QAAAA,cAAc,EAAE,mDAAegB,eAJZ;CAKnBf,QAAAA,cAAc,EAAE,mDAAegB,eALZ;CAMnBlB,QAAAA,SAAS,EAAE,mDAAemB,aAAf,EANQ;CAOnBhB,QAAAA,QAAQ,EAAE,mDAAeiB,mBAAf;CAPS,OAApB;;CAUA,WAAK,IAAM1gB,MAAX,IAAqBmf,MAArB,EACA;CACC,YAAIA,MAAM,CAACnf,MAAD,CAAN,CAAe2gB,IAAf,GAAsB,CAA1B,EACA;CACC,cAAMC,MAAM,GAAG,IAAI3mB,GAAJ,EAAf;;CAEA,eAAK,IAAM4mB,GAAX,IAAkBT,WAAW,CAACpgB,MAAD,CAA7B,EACA;CACC,gBAAIogB,WAAW,CAACpgB,MAAD,CAAX,CAAoB6gB,GAApB,EAAyB,IAAzB,CAAJ,EACA;CACCD,cAAAA,MAAM,CAACtmB,GAAP,CAAW8lB,WAAW,CAACpgB,MAAD,CAAX,CAAoB6gB,GAApB,EAAyB,IAAzB,CAAX;CACA,aAHD,MAIK,IAAIT,WAAW,CAACpgB,MAAD,CAAX,CAAoB6gB,GAApB,EAAyB,MAAzB,CAAJ,EACL;CACCD,cAAAA,MAAM,CAACtmB,GAAP,CAAW8lB,WAAW,CAACpgB,MAAD,CAAX,CAAoB6gB,GAApB,EAAyB,MAAzB,CAAX;CACA;CACD;;CAbF,uDAeqB1B,MAAM,CAACnf,MAAD,CAAN,CAAetG,MAAf,EAfrB;CAAA;;CAAA;CAeC,gEACA;CAAA,kBADWkB,KACX;CACC,kBAAIkmB,cAAc,GAAGlmB,KAArB;CACA,kBAAI2c,EAAE,GAAG3c,KAAT;;CAEA,kBAAItC,cAAI,CAACS,OAAL,CAAa+nB,cAAb,CAAJ,EACA;CACCA,gBAAAA,cAAc,GAAGlmB,KAAK,CAAC,CAAD,CAAtB;CACA2c,gBAAAA,EAAE,GAAG3c,KAAK,CAAC,CAAD,CAAV;CACA;;CAED,kBAAI,CAACgmB,MAAM,CAACxmB,GAAP,CAAW0mB,cAAX,CAAL,EACA;CACC,uBAAO,IAAP;CACA;;CAED,kBAAI9gB,MAAM,KAAK,UAAf,EACA;CACC,oBAAM2G,KAAK,GAAG,mDAAeoa,YAAf,CAA4BD,cAA5B,CAAd;;CACA,oBAAI,CAACna,KAAK,CAACqa,iBAAN,CAAwBzJ,EAAxB,CAAL,EACA;CACC,yBAAO,IAAP;CACA;CACD;CACD;CAvCF;CAAA;CAAA;CAAA;CAAA;CAwCC;CACD;;CAED,aAAO,KAAP;CACA;CAntCF;CAAA;CAAA,wBAwCC;CACC,+CAAO,IAAP;CACA;CA1CF;CAAA;CAAA,wBA6CC;CACC,+CAAO,IAAP;CACA;CA/CF;CAAA;CAAA,wBAkDC;CACC,+CAAO,IAAP;CACA,KApDF;CAAA,sBAsDWnc,KAtDX,EAuDC;CACC,wDAAgBA,KAAhB;CACA;CAzDF;CAAA;CAAA,wBA4DC;CACC,+CAAO,IAAP;CACA;CA9DF;CAAA;CAAA,mCAgFC;CACC,aACC,MAAMmY,QAAQ,CAAC0N,IAAI,CAACC,MAAL,KAAgB,MAAjB,CAAd,GACE,GADF,GACQ3N,QAAQ,CAAC0N,IAAI,CAACC,MAAL,KAAgB,MAAjB,CADhB,GAEE,GAFF,GAEQ3N,QAAQ,CAAC0N,IAAI,CAACC,MAAL,KAAgB,MAAjB,CAFhB,GAGE,GAHF,GAGQ3N,QAAQ,CAAC0N,IAAI,CAACC,MAAL,KAAgB,MAAjB,CAJjB;CAMA;CAvFF;CAAA;CAAA,EAA2B7d,6BAA3B;;;;;;;;ACTA,KAAa8d,WAAb;CAIC,uBAAY5P,OAAZ,EACA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,sDAAgBA,OAAhB;CACA;;CAPF;CAAA;CAAA,4BAUC;CACC,aAAO,IAAI4P,WAAJ,CAAgBpP,iBAAO,CAACvW,KAAR,mCAAc,IAAd,YAAhB,CAAP;CACA;CAZF;CAAA;CAAA,wBAcK3B,QAdL,EAcuBgnB,GAdvB,EAcoCjmB,KAdpC,EAeC;CACC,UAAI,CAACtC,cAAI,CAACmD,aAAL,CAAmB,kDAAc5B,QAAd,CAAnB,CAAL,EACA;CACC,0DAAcA,QAAd,IAA0B,EAA1B;CACA;;CACD,UAAMunB,WAAW,GAAG,kDAAcvnB,QAAd,EAAwBgnB,GAAxB,CAApB;;CAEA,UAAIO,WAAW,KAAKxmB,KAApB,EACA;CACCsF,QAAAA,EAAE,CAACmhB,WAAH,CAAeC,IAAf,CACC,oBADD,EAECznB,QAFD,EAGCgnB,GAHD,EAICjmB,KAJD,EAKC,KALD;CAOA;;CAED,aAAO,IAAP;CACA;CAlCF;CAAA;CAAA,wBAoCKf,QApCL,EAoCuBgnB,GApCvB,EAoCoChmB,YApCpC,EAqCC;CACC,UAAI4V,MAAM,GAAG5V,YAAb;;CACA,UAAI,KAAKT,GAAL,CAASP,QAAT,EAAmBgnB,GAAnB,CAAJ,EACA;CACCpQ,QAAAA,MAAM,GAAG,kDAAc5W,QAAd,EAAwBgnB,GAAxB,CAAT;CACA;;CAED,aAAOpQ,MAAP;CACA;CA7CF;CAAA;CAAA,wBA+CK5W,QA/CL,EA+CuBgnB,GA/CvB,EAgDC;CACC,aAAOvoB,cAAI,CAACmD,aAAL,CAAmB,kDAAc5B,QAAd,CAAnB,KAA+CvB,cAAI,CAACmD,aAAL,CAAmB,kDAAc5B,QAAd,EAAwBgnB,GAAxB,CAAnB,CAAtD;CACA;CAlDF;CAAA;CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmBA,KAAa1D,QAAb;CAAA;;CAwBC,oBAAY7K,MAAZ,EAUA;CAAA;;CAAA;;CAAA;CACC;;CADD;;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAEC,UAAKnX,iBAAL,CAAuB,uBAAvB;;CAEA,8GAAgBmX,MAAM,CAAC/J,OAAvB,6DAAkCvM,mCAAgB,EAAlD;CACA,UAAKulB,SAAL,GAAiBjP,MAAM,CAACiP,SAAxB;CACA,UAAKhB,eAAL,GAAuBjO,MAAM,CAACiO,eAA9B;CACA,UAAKiB,SAAL,GAAiBlP,MAAM,CAACkP,SAAxB;CACA,UAAKhB,eAAL,GAAuBlO,MAAM,CAACkO,eAA9B;CAEA,yGAA8BlO,MAAM,CAACmP,qBAArC;CACA,kGAAuBnP,MAAM,CAACoP,cAA9B;CACA,+FAAoBpP,MAAM,CAAC+O,WAA3B;CACA,6FAAgB,uFAAczkB,OAA9B;CACA,0FAAa,EAAb;CACA,0FAAe,EAAf;CACA,8FAAiBnC,QAAQ,CAACQ,IAAT,EAAjB;CAhBD;CAiBC;;CAnDF;CAAA;CAAA,yBAqDMK,IArDN,EAqDoBC,QArDpB,EAsDC;CACC,UAAIjD,cAAI,CAACmD,aAAL,CAAmBH,IAAnB,CAAJ,EACA;CACC,yDAAaA,IAAb;;CACA,YAAI,CAAChD,cAAI,CAACmD,aAAL,CAAmB,iDAAWkmB,SAA9B,CAAL,EACA;CACC,2DAAWA,SAAX,GAAuB,EAAvB;CACA;;CACD,YAAI,CAACrpB,cAAI,CAACmD,aAAL,CAAmB,iDAAWmmB,UAA9B,CAAL,EACA;CACC,2DAAWA,UAAX,GAAwB,EAAxB;CACA;;CACD,YAAI,CAACtpB,cAAI,CAACmD,aAAL,CAAmB,iDAAWomB,SAA9B,CAAL,EACA;CACC,2DAAWA,SAAX,GAAuB,EAAvB;CACA;;CAED,aAAKC,oBAAL,CAA0B,iDAAW,sBAAX,CAA1B;CACA,aAAK3a,YAAL,CAAkB,KAAlB;CACA;;CAED,2DAAiB1M,QAAQ,CAACsnB,OAAT,CAAiBxmB,QAAjB,CAAjB;;CAEA,UAAI,CAAC,qDAAewL,MAAf,EAAL,EACA;CACC,+DAAqB,gEAA4B5E,aAA5B,CACpB,uDAAuD,iDAAW6G,eAAlE,GAAoF,IADhE,CAArB;CAGA,2DAAiB,uDAAmB7G,aAAnB,CAAiC,0BAAjC,CAAjB;CACA,8DAAoB,uDAAmBA,aAAnB,CAAiC,uBAAjC,CAApB;CACA,iEAAuB,uDAAmBA,aAAnB,CAAiC,2BAAjC,CAAvB;CAEA,aAAK6f,UAAL;CACA,aAAK/a,WAAL;CACA,aAAKgb,0BAAL;;CAEA,YAAI,CAAC,KAAKC,kBAAL,EAAD,IAA8B,KAAKjmB,OAAL,EAAlC,EACA;CACC;CACA0E,UAAAA,IAAI,CAACE,YAAL,mCAAkB,IAAlB,kBAAsC,EAAtC;CACA,SAJD,MAMA;CACCF,UAAAA,IAAI,CAACK,cAAL,mCAAoB,IAApB;CACA;CACD;CACD;CApGF;CAAA;CAAA,2BAsGQ1F,IAtGR,EAsGsBC,QAtGtB,EAuGC;CACCgC,MAAAA,aAAG,CAACgK,KAAJ,mCAAU,IAAV;CACAhK,MAAAA,aAAG,CAACgK,KAAJ,mCAAU,IAAV;CACAhK,MAAAA,aAAG,CAACgK,KAAJ,mCAAU,IAAV;CAEA,WAAK1C,OAAL;CACA,WAAKpF,IAAL,CAAUnE,IAAV,EAAgBC,QAAhB;CACA;CA9GF;CAAA;CAAA,8BAiHC;CACC,uDAAavC,OAAb,CAAqB,UAAA2N,KAAK;CAAA,eAAIA,KAAK,CAAC9B,OAAN,EAAJ;CAAA,OAA1B;CACA;CAnHF;CAAA;CAAA,8BA4HC;CACC,aAAO,kDAAc5I,OAArB;CACA;CA9HF;CAAA;CAAA,iCAiIC;CACC,uDAAe,EAAf;;CAEA,UAAI3D,cAAI,CAACS,OAAL,CAAa,iDAAWopB,MAAxB,CAAJ,EACA;CACC,aAAK,IAAI/b,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,iDAAW+b,MAAX,CAAkBjf,MAAtC,EAA8C,EAAEkD,CAAhD,EACA;CACC,cAAMO,KAAK,GAAG,IAAI8S,KAAJ,CAAU;CACvBrb,YAAAA,QAAQ,EAAE,kDAAcA,QADD;CAEvBsb,YAAAA,QAAQ,EAAE,IAFa;CAGvBC,YAAAA,WAAW,EAAE,kDAAc1P,GAAd,CAAkB,aAAlB,CAHU;CAIvBrN,YAAAA,OAAO,oCAAE,IAAF;CAJgB,WAAV,CAAd;CAMA+J,UAAAA,KAAK,CAAClH,IAAN,CAAW,iDAAW0iB,MAAX,CAAkB/b,CAAlB,CAAX,oCAAiC,IAAjC;CACA,eAAKiY,eAAL,CAAqB1X,KAAK,CAAC9K,IAA3B;CACA,2DAAa1C,IAAb,CAAkBwN,KAAlB;CACA;CACD;CACD;CAnJF;CAAA;CAAA,4CAgKC;CACC,UAAMyb,cAAc,GAAG,EAAvB;CAEA,uDAAappB,OAAb,CAAqB,UAAA2N,KAAK,EAAI;CAC7B,YAAIA,KAAK,CAACkU,UAAN,EAAJ,EACA;CACCuH,UAAAA,cAAc,CAACjpB,IAAf,CAAoBwN,KAAK,CAACrL,IAAN,CAAW0V,IAA/B;CACA;CACD,OALD;CAOA,aAAOoR,cAAP;CACA;CA3KF;CAAA;CAAA,0CA8KC;CACC,UAAMC,UAAU,GAAG,EAAnB;CACA,uDAAarpB,OAAb,CAAqB,UAAA2N,KAAK;CAAA,eAAI0b,UAAU,CAAClpB,IAAX,CAAgBwN,KAAK,CAACnH,SAAN,EAAhB,CAAJ;CAAA,OAA1B;CAEA,aAAO6iB,UAAP;CACA;CAnLF;CAAA;CAAA,4BAsLC;CACC,aAAO,iDAAWC,EAAlB;CACA;CAxLF;CAAA;CAAA,kCA2LC;CACC,aAAO,iDAAWtZ,eAAlB;CACA;CA7LF;CAAA;CAAA,oCAgMC;CACC,UAAMuO,EAAE,GAAGhE,QAAQ,CAAC,iDAAW+O,EAAZ,CAAnB;CAEA,aAAO,CAACC,KAAK,CAAChL,EAAD,CAAN,GAAaA,EAAb,GAAkB,CAAzB;CACA;CApMF;CAAA;CAAA,kCAuMC;CACC,UAAI,KAAK2K,kBAAL,EAAJ,EACA;CACC,aAAKM,oBAAL;CACA,OAHD,MAIK,IAAI,qDAAeplB,MAAf,EAAJ,EACL;CACC,aAAK0K,eAAL;;CAEA,YAAI,KAAK2a,aAAL,KAAuB,CAA3B,EACA;CACC,eAAKC,yBAAL;CACA,eAAKC,0BAAL;CACA,eAAKC,gCAAL;CACA,eAAKC,sBAAL;CACA;CACD;CACD;CAxNF;CAAA;CAAA,qCA0NkBpI,QA1NlB,EA2NC;CACC,4CAAI,IAAJ,cACA;CACC,6DAAiBhgB,QAAQ,CAACsN,MAAT,GAAkB2S,WAAlB,CAA8B,UAA9B,EAA0CD,QAA1C,CAAjB;;CAEA,YAAIA,QAAJ,EACA;CACCld,UAAAA,aAAG,CAAC0K,QAAJ,mCAAa,IAAb,cAA6B,oBAA7B;CACA;;CAED,YAAI,KAAKia,kBAAL,EAAJ,EACA;CACC3kB,UAAAA,aAAG,CAAC0K,QAAJ,mCAAa,IAAb,cAA6B,eAA7B;CACA,SAHD,MAKA;CACC,2DAAajP,OAAb,CAAqB,UAAA2N,KAAK;CAAA,mBAAIA,KAAK,CAACmc,gBAAN,CAAuBrI,QAAvB,CAAJ;CAAA,WAA1B;CACA;CACD;CACD;CA9OF;CAAA;CAAA,wCAiPC;CACC,4CAAI,IAAJ,cACA;CACC,6DAAiBhgB,QAAQ,CAACkB,IAAT,EAAjB;CACA4B,QAAAA,aAAG,CAAC2K,WAAJ,mCAAgB,IAAhB,cAAgC,oBAAhC;;CACA,YAAI,KAAKga,kBAAL,EAAJ,EACA;CACC3kB,UAAAA,aAAG,CAAC2K,WAAJ,mCAAgB,IAAhB,cAAgC,eAAhC;CACA,SAHD,MAKA;CACC,2DAAalP,OAAb,CAAqB,UAAA2N,KAAK;CAAA,mBAAIA,KAAK,CAACoc,iBAAN,EAAJ;CAAA,WAA1B;CACA;;CAED,+DAAmBzf,gBAAnB,CAAoC,6CAApC,EAAmFtK,OAAnF,CAA2F,UAAA6C,IAAI,EAAI;CAClG0B,UAAAA,aAAG,CAAC0K,QAAJ,CAAapM,IAAb,EAAmB,sDAAnB;CACA,SAFD;CAGA;CACD;CAnQF;CAAA;CAAA,wCAsQC;CACC,uDAAa7C,OAAb,CAAqB,UAAA2N,KAAK;CAAA,eAAIA,KAAK,CAAChI,YAAN,CAAmBgI,KAAK,CAAC9K,IAAzB,CAAJ;CAAA,OAA1B;CAEA,6DAAmByH,gBAAnB,CAAoC,6CAApC,EAAmFtK,OAAnF,CAA2F,UAAA6C,IAAI,EAAI;CAClG0B,QAAAA,aAAG,CAAC0K,QAAJ,CAAapM,IAAb,EAAmB,sDAAnB;CACA,OAFD;CAGA;CA5QF;CAAA;CAAA,yCA+QC;CACC,uDAAa7C,OAAb,CAAqB,UAAA2N,KAAK;CAAA,eAAIA,KAAK,CAAC2D,cAAN,CAAqB3D,KAAK,CAAC9K,IAA3B,CAAJ;CAAA,OAA1B;CAEA,6DAAmByH,gBAAnB,CAAoC,6CAApC,EAAmFtK,OAAnF,CAA2F,UAAA6C,IAAI,EAAI;CAClG0B,QAAAA,aAAG,CAAC2K,WAAJ,CAAgBrM,IAAhB,EAAsB,sDAAtB;CACA,OAFD;CAGA;CArRF;CAAA;CAAA,sCAwRC;CAAA;;CACC,UAAMmnB,MAAM,GAAG,SAATA,MAAS;CAAA,eAAMzlB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACvCmH,UAAAA,MAAM,EAAE;CACP0D,YAAAA,KAAK,EAAE,eAAAhJ,KAAK,EAAI;CACf,kBAAI,CAAC,MAAI,CAACpD,OAAL,EAAL,EACA;CACCgD,gBAAAA,QAAQ,CAACC,qBAAT,CAA+BG,KAAK,CAAC+J,MAArC;CACA,eAHD,MAIK,IAAI,CAAC,kCAAA,MAAI,cAAJ,CAAejK,QAAf,EAAL,EACL;CACC,gBAAA,MAAI,CAACmJ,gBAAL,CAAsBjJ,KAAK,CAAC+J,MAA5B;CACA;CACD;CAVM,WAD+B;CAavC3L,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WAbgC;CAgBvCgB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNC,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBC,YAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,4BAAf;CAJY,WAAnB,CADS;CAhB6B,SAAnB,CAAN;CAAA,OAAf;;CA0BA,4CAAI,IAAJ,oBACA;CACC,iEAAqBiB,WAArB,CAAiCkkB,MAAM,EAAvC;CACA;;CAED,4CAAI,IAAJ,iBACA;CACC,8DAAkBlkB,WAAlB,CAA8BkkB,MAAM,EAApC;CACA;CACD;CA5TF;CAAA;CAAA,iDA+TC;CACC,4CAAI,IAAJ,oBACA;CACC,YAAI/O,EAAE,GAAI,oDAAgB,iDAAa/Q,MAAb,GAAsB,CAAvC,GAA4C,MAA5C,GAAqD,MAA9D;;CAEA,YAAI,KAAKgf,kBAAL,EAAJ,EACA;CACCjO,UAAAA,EAAE,GAAG,MAAL;CACA;;CAED/T,QAAAA,EAAE,CAAC+T,EAAD,CAAF,mCAAO,IAAP;CACA;CACD;CA3UF;CAAA;CAAA,uDA8UC;CACC,UAAI3b,cAAI,CAACC,KAAL,CAAW,kDAAc0qB,gBAAzB,CAAJ,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM7a,IAAI,GAAG,IAAb;CACA,UAAM4a,MAAM,GAAGzlB,aAAG,CAACC,MAAJ,CAAW,GAAX,EAAgB;CAC9BG,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,sCAAf,CADwB;CAE9BqN,QAAAA,KAAK,EAAE;CACN0Q,UAAAA,IAAI,EAAE;CADA,SAFuB;CAK9BjX,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KADO,iBACDhJ,KADC,EAEP;CACCA,YAAAA,KAAK,CAACie,cAAN;;CAEA,gBAAI,CAAC,kCAAAlV,IAAI,cAAJ,CAAejJ,QAAf,EAAL,EACA;CACCiJ,cAAAA,IAAI,CAAC8a,iCAAL,CAAuC,IAAvC;CACA;CACD;CATM,SALsB;CAgB9BzlB,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,kCADL;CAEN0L,UAAAA,MAAM,EAAE;CAFF;CAhBuB,OAAhB,CAAf;;CAsBA,UAAI,CAAC,kDAAc6Z,gBAAd,CAA+B/f,MAApC,EACA;CACC3F,QAAAA,aAAG,CAAC0K,QAAJ,CAAa+a,MAAb,EAAqB,yCAArB;CACA;;CAED,4DAAkBlkB,WAAlB,CAA8BkkB,MAA9B;CACA;CAjXF;CAAA;CAAA,6CAoXC;CAAA;;CACC,UAAI,CAAC,kDAAcG,SAAnB,EACA;CACC;CACA;;CAED,UAAMC,YAAY,GAAG7lB,aAAG,CAACC,MAAJ,CAAW,GAAX,EAAgB;CACpCG,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,sCAAf,CAD8B;CAEpCJ,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,kCADL;CAEN0L,UAAAA,MAAM,EAAE;CAFF,SAF6B;CAMpC9H,QAAAA,KAAK,EAAE;CACN+hB,UAAAA,MAAM,EAAE;CADF,SAN6B;CASpC1e,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KAAK,EAAE,eAAAhJ,KAAK,EAAI;CACfA,YAAAA,KAAK,CAACie,cAAN;;CACA,YAAA,MAAI,CAACgG,uBAAL,CAA6BF,YAA7B;CACA;CAJM;CAT4B,OAAhB,CAArB;CAiBA,4DAAkBtkB,WAAlB,CAA8BskB,YAA9B;CACA;CA5YF;CAAA;CAAA,4CA8YyBG,gBA9YzB,EA+YC;CACC,UAAI,CAAC,KAAKtnB,OAAL,EAAL,EACA;CACCgD,QAAAA,QAAQ,CAACC,qBAAT,CAA+BqkB,gBAA/B;CACA,OAHD,MAKA;CACC,aAAKnkB,IAAL,CAAU,2BAAV,EAAuC;CACtCmL,UAAAA,cAAc,EAAE,iDAAWvB;CADW,SAAvC;CAGA;CACD;CA1ZF;CAAA;CAAA,gDA6ZC;CACC,UAAI1Q,cAAI,CAACC,KAAL,CAAW,kDAAcirB,kBAAzB,CAAJ,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM1X,GAAG,GACR,CAAC,qDAAe3M,QAAf,EAAD,GACG,kDAAcqkB,kBAAd,CAAiCpX,OAAjC,CAAyC,MAAzC,EAAiD,KAAKqW,aAAL,EAAjD,CADH,GAEG,GAHJ;;CAMA,UAAI,CAAC3W,GAAG,CAAC5I,MAAT,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM8f,MAAM,GAAGzlB,aAAG,CAACC,MAAJ,CAAW,GAAX,EAAgB;CAC9BG,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uCAAf,CADwB;CAE9BqN,QAAAA,KAAK,EAAE;CACN0Q,UAAAA,IAAI,EAAE9P;CADA,SAFuB;CAK9BrO,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb;CALuB,OAAhB,CAAf;CAQA,4DAAkBoB,WAAlB,CAA8BkkB,MAA9B;CACA;CAvbF;CAAA;CAAA,iDA0bC;CACC,UAAI1qB,cAAI,CAACC,KAAL,CAAW,kDAAckrB,mBAAzB,CAAJ,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM3X,GAAG,GAAG,kDAAc2X,mBAAd,CAAkCrX,OAAlC,CAA0C,MAA1C,EAAkD,KAAKqW,aAAL,EAAlD,CAAZ;;CAEA,UAAI,CAAC3W,GAAG,CAAC5I,MAAL,IAAe,qDAAe/D,QAAf,EAAnB,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM6jB,MAAM,GAAGzlB,aAAG,CAACC,MAAJ,CAAW,GAAX,EAAgB;CAC9BG,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,wCAAf,CADwB;CAE9BqN,QAAAA,KAAK,EAAE;CACN0Q,UAAAA,IAAI,EAAE9P;CADA,SAFuB;CAK9BrO,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb;CALuB,OAAhB,CAAf;CAQA,4DAAkBoB,WAAlB,CAA8BkkB,MAA9B;CACA;CAhdF;CAAA;CAAA,2CAmdC;CACC,4CAAI,IAAJ,oBACA;CACC,iEAAqBlkB,WAArB,CACCvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb;CADW,SAAnB,CADD;CAKA;;CAED,UAAMe,GAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SADsB;CAI7BgB,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADU;CAIjBgB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb;CADU,WAAlB,CADS,EAITH,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADU;CAEjBC,YAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,2CAAf;CAFW,WAAlB,CAJS;CAJO,SAAlB,CADS;CAJmB,OAAlB,CAAZ;;CAsBA,UAAI,qDAAeT,MAAf,EAAJ,EACA;CACC,YAAMC,WAAW,GAAGE,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACrCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WAD8B;CAIrCC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,6BAAf;CAJ+B,SAAlB,CAApB;CAOA,YAAMuK,IAAI,GAAG,IAAb;CACAtK,QAAAA,eAAK,CAACC,IAAN,CAAWU,GAAX,EAAgB,OAAhB,EAAyB,UAAUY,KAAV,EAAiB;CACzCA,UAAAA,KAAK,CAACC,eAAN;;CACA,cAAI,CAAC,kCAAA8I,IAAI,cAAJ,CAAejJ,QAAf,EAAL,EACA;CACCiJ,YAAAA,IAAI,CAAC8a,iCAAL,CAAuC,IAAvC;CACA;CACD,SAND;CAOAzkB,QAAAA,GAAG,CAACK,WAAJ,CAAgBzB,WAAhB;CAEA,YAAMuB,SAAS,GAAGrB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACpCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL;CAD6B,SAAnB,CAAlB;CAMAI,QAAAA,eAAK,CAACC,IAAN,CAAWa,SAAX,EAAsB,OAAtB,EAA+B,UAAUS,KAAV,EAAiB;CAC/CA,UAAAA,KAAK,CAACC,eAAN;;CAEA,cAAI,CAAC,kCAAA8I,IAAI,cAAJ,CAAejJ,QAAf,EAAL,EACA;CACCiJ,YAAAA,IAAI,CAACsb,4BAAL,CAAkC,IAAlC;CACA;CACD,SAPD;CAQAjlB,QAAAA,GAAG,CAACoe,SAAJ,CAAc/d,WAAd,CAA0BF,SAA1B;CACA;;CAED,yDAAeE,WAAf,CAA2BL,GAA3B;CACA,6DAAqBA,GAArB;CACA;CAzhBF;CAAA;CAAA,6BA2hBUY,KA3hBV,EA4hBC;CACC,UAAI,KAAK6iB,kBAAL,EAAJ,EACA;CACC,aAAKyB,wBAAL,CAA8BtkB,KAA9B;CACA,OAHD,MAKA;CACC,yDAAarG,OAAb,CAAqB,UAAA2N,KAAK;CAAA,iBAAIA,KAAK,CAACkB,QAAN,CAAexI,KAAf,CAAJ;CAAA,SAA1B;CACA;CACD;CAriBF;CAAA;CAAA,6CAuiB0BA,KAviB1B,EAwiBC;CACC,4CAAI,IAAJ,kBACA;CACC,YAAMK,KAAK,GAAGL,KAAK,CAACM,OAAN,GAAgBC,WAA9B;CACAM,QAAAA,EAAE,CAAC,CAACR,KAAD,GAAS,aAAT,GAAyB,UAA1B,CAAF,mCAAwC,IAAxC,kBAA4D,mBAA5D;CACA;CACD;CA9iBF;CAAA;CAAA,qCAgjBkBV,MAhjBlB,EAgjB0BuJ,OAhjB1B,EAijBC;CACC,UAAMK,SAAS,GAAG;CACjBgb,QAAAA,QAAQ,EAAE,EADO;CAEjBC,QAAAA,MAAM,EAAE,EAFS;CAGjBC,QAAAA,GAAG,EAAE,EAHY;CAIjB7J,QAAAA,KAAK,EAAE;CAJU,OAAlB;CAMA,UAAM8J,eAAe,GAAG,kDAAcA,eAAtC;;CAEA,UAAI,CAACzrB,cAAI,CAACmD,aAAL,CAAmB8M,OAAnB,CAAL,EACA;CACCA,QAAAA,OAAO,GAAG,EAAV;CACA;;CAED,UAAMH,IAAI,GAAG,IAAb;;CACA,UAAM4b,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAU3kB,KAAV,EAAiBoJ,IAAjB,EAC7B;CACC,YAAMoR,SAAS,GAAG3Z,EAAE,CAAC1E,KAAH,CAASiN,IAAI,CAACoR,SAAd,CAAlB;;CAEA,YACCA,SAAS,CAAC,gBAAD,CAAT,IACGA,SAAS,CAAC,gBAAD,CAAT,CAA4B,gBAA5B,CADH,IAEGA,SAAS,CAAC,gBAAD,CAAT,CAA4B,gBAA5B,EAA8CpR,IAAI,CAAC5O,QAAnD,CAHJ,EAKA;CACCggB,UAAAA,SAAS,CAAC,MAAD,CAAT,GAAoBA,SAAS,CAAC,gBAAD,CAAT,CAA4B,gBAA5B,EAA8CpR,IAAI,CAAC5O,QAAnD,CAApB;CACA,SAPD,MAQK,IAAIggB,SAAS,CAAC,gBAAD,CAAT,IAA+BA,SAAS,CAAC,gBAAD,CAAT,CAA4B,OAA5B,CAAnC,EACL;CACCA,UAAAA,SAAS,CAAC,MAAD,CAAT,GAAoBA,SAAS,CAAC,gBAAD,CAAT,CAA4B,OAA5B,CAApB;CACA;;CAEDzR,QAAAA,IAAI,CAAC6b,QAAL,CAAcpK,SAAd,EAAyB,UAASlT,KAAT,EACzB;CACC4B,UAAAA,OAAO,CAAC2b,iBAAR,GAA4Bzb,IAAI,CAAC5O,QAAjC;CACA,eAAKkjB,uBAAL,CAA6BpW,KAA7B,EAAoC4B,OAApC;CACA,SAJD;CAMA,aAAKgB,iBAAL,GAAyBzD,KAAzB;CACA,OAxBD;;CA0BA,WAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2d,eAAe,CAAC7gB,MAApC,EAA4C,EAAEkD,CAA9C,EACA;CACC,YAAI2d,eAAe,CAAC3d,CAAD,CAAf,CAAmB,UAAnB,CAAJ,EACA;CACC;CACA;;CACD,YAAM+d,QAAQ,GACb7rB,cAAI,CAACmD,aAAL,CAAmBsoB,eAAe,CAAC3d,CAAD,CAAf,CAAmB,gBAAnB,CAAnB,IACG2d,eAAe,CAAC3d,CAAD,CAAf,CAAmB,gBAAnB,CADH,GAEG,EAHJ;CAMA,YAAIiF,KAAK,GAAG0Y,eAAe,CAAC3d,CAAD,CAAf,CAAmB5J,IAA/B;;CACA,YAAI2nB,QAAQ,CAAC,OAAD,CAAZ,EACA;CACC9Y,UAAAA,KAAK,GAAG8Y,QAAQ,CAAC,OAAD,CAAhB;CACA;;CAED,YAAIC,UAAU,GAAG,EAAjB;;CACA,YAAID,QAAQ,CAAC,UAAD,CAAZ,EACA;CACCC,UAAAA,UAAU,GAAG9rB,cAAI,CAACS,OAAL,CAAaorB,QAAQ,CAAC,UAAD,CAArB,IAAqCA,QAAQ,CAAC,UAAD,CAA7C,GAA4D,CAACA,QAAQ,CAAC,UAAD,CAAT,CAAzE;CACA;;CAED,YAAI,CAACC,UAAU,CAAClhB,MAAhB,EACA;CACCkhB,UAAAA,UAAU,CAACjrB,IAAX,CAAgB,OAAhB;CACA;;CAED,aAAK,IAAIkrB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,UAAU,CAAClhB,MAA/B,EAAuC,EAAEmhB,CAAzC,EACA;CACC,cAAI,CAACzb,SAAS,CAACwb,UAAU,CAACC,CAAD,CAAX,CAAd,EACA;CACC;CACA;;CAEDzb,UAAAA,SAAS,CAACwb,UAAU,CAACC,CAAD,CAAX,CAAT,CAAyBlrB,IAAzB,CAA8B;CAC7BwE,YAAAA,IAAI,EAAE0N,KADuB;CAE7BwO,YAAAA,SAAS,EAAEkK,eAAe,CAAC3d,CAAD,CAFG;CAG7BvM,YAAAA,QAAQ,EAAEuqB,UAAU,CAACC,CAAD,CAHS;CAI7Bpb,YAAAA,OAAO,EAAE+a;CAJoB,WAA9B;CAMA;CACD;;CAED,UAAIpb,SAAS,CAAC,OAAD,CAAT,CAAmB1F,MAAnB,GAA4B,CAAhC,EACA;CACC0F,QAAAA,SAAS,CAAC,OAAD,CAAT,CAAmBzP,IAAnB,CAAwB;CAACyQ,UAAAA,SAAS,EAAE;CAAZ,SAAxB;CACA;;CAED,UAAIF,oBAAU,CAACC,QAAX,CAAoB,qBAApB,CAAJ,EACA;CACCf,QAAAA,SAAS,CAAC,OAAD,CAAT,CAAmBzP,IAAnB,CAAwB;CACvBwE,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uDAAf,CADiB;CAEvBoL,UAAAA,OAFuB,qBAGvB;CACC/I,YAAAA,EAAE,CAAC2J,IAAH,CAAQC,WAAR,CAAoBC,IAApB,CAAyB,EAAzB,EAA6B,kDAAcE,GAAd,CAAkB,0BAAlB,CAA7B;CACA,iBAAKV,iBAAL,GAAyBzD,KAAzB;CACA;CANsB,SAAxB;CAQA,OAVD,MAYA;CACC8C,QAAAA,SAAS,CAAC,OAAD,CAAT,CAAmBzP,IAAnB,CAAwB;CACvBwE,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uDAAf,CADiB;CAEvB+d,UAAAA,IAAI,EACH,oCACExP,OADF,CACU,YADV,EACwB,kDAAcnC,GAAd,CAAkB,0BAAlB,CADxB,CAHsB;CAKvBb,UAAAA,MAAM,EAAE;CALe,SAAxB;CAOA;;CAED,UAAIkb,MAAM,GAAGtlB,MAAM,CAACkD,YAAP,CAAoB,cAApB,CAAb;;CACA,UAAI,CAACoiB,MAAL,EACA;CACCA,QAAAA,MAAM,GAAGre,MAAM,CAACkD,gBAAP,EAAT;CACAnK,QAAAA,MAAM,CAAC0c,YAAP,CAAoB,cAApB,EAAoC4I,MAApC;CACA;;CAED,UAAMC,aAAa,GAAG,EAAtB;;CACA,UAAI3b,SAAS,CAAC,UAAD,CAAT,CAAsB1F,MAAtB,GAA+B,CAAnC,EACA;CACCqhB,QAAAA,aAAa,CAACprB,IAAd,CAAmB;CAClBwE,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,4CAAf,CADY;CAElBoF,UAAAA,KAAK,EAAE2F,SAAS,CAAC,UAAD;CAFE,SAAnB;CAIA;;CACD,UAAIA,SAAS,CAAC,QAAD,CAAT,CAAoB1F,MAApB,GAA6B,CAAjC,EACA;CACCqhB,QAAAA,aAAa,CAACprB,IAAd,CAAmB;CAClBwE,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,0CAAf,CADY;CAElBoF,UAAAA,KAAK,EAAE2F,SAAS,CAAC,QAAD;CAFE,SAAnB;CAIA;;CACD,UAAIA,SAAS,CAAC,KAAD,CAAT,CAAiB1F,MAAjB,GAA0B,CAA9B,EACA;CACCqhB,QAAAA,aAAa,CAACprB,IAAd,CAAmB;CAClBwE,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,uCAAf,CADY;CAElBoF,UAAAA,KAAK,EAAE2F,SAAS,CAAC,KAAD;CAFE,SAAnB;CAIA;;CACD2b,MAAAA,aAAa,CAACprB,IAAd,CAAmB;CAClBwE,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,yCAAf,CADY;CAElBoF,QAAAA,KAAK,EAAE2F,SAAS,CAAC,OAAD;CAFE,OAAnB;CAKAM,MAAAA,sBAAW,CAAChE,IAAZ,CACCof,MADD,EAECtlB,MAFD,EAGCulB,aAHD,EAIC;CACCjgB,QAAAA,QAAQ,EAAE,IADX;CAECE,QAAAA,UAAU,EAAGtE,EAAE,CAACskB,GAAH,CAAOxlB,MAAP,EAAe,OAAf,IAA0B,CAFxC;CAGC4G,QAAAA,KAAK,EAAE;CAAErE,UAAAA,QAAQ,EAAE,KAAZ;CAAmB0D,UAAAA,MAAM,EAAE;CAA3B,SAHR;CAICwf,QAAAA,SAAS,EAAE;CAJZ,OAJD;CAWA;CA/sBF;CAAA;CAAA,uCAitBoBplB,KAjtBpB,EAktBC;CACC,WAAKiJ,gBAAL,CAAsBjJ,KAAK,CAAC+J,MAA5B,EAAoC;CAACsb,QAAAA,WAAW,EAAE;CAAd,OAApC;CACA;CAptBF;CAAA;CAAA,sDAstBmC1lB,MAttBnC,EAutBC;CACC,UAAI,CAAC,KAAK/C,OAAL,EAAL,EACA;CACCgD,QAAAA,QAAQ,CAACC,qBAAT,CAA+BF,MAA/B;CACA;CACA;;CACD,UAAI,CAAC,kDAAcikB,gBAAd,CAA+B/f,MAApC,EACA;CACC,YAAIpB,GAAG,CAAC5B,EAAJ,CAAOoF,EAAP,IAAaxD,GAAG,CAAC5B,EAAJ,CAAOoF,EAAP,CAAUqf,UAA3B,EACA;CACC7iB,UAAAA,GAAG,CAAC5B,EAAJ,CAAOoF,EAAP,CAAUqf,UAAV,CAAqBzf,IAArB,CAA0B,0BAA1B;CACA;;CAED;CACA;;CAED,UAAM0f,UAAU,GAAG,KAAKnC,aAAL,EAAnB;;CACA,UAAImC,UAAU,GAAG,CAAjB,EACA;CACC,aAAKC,iBAAL,CAAuBD,UAAvB;CACA;CACD;CA5uBF;CAAA;CAAA,iDA8uB8B5lB,MA9uB9B,EA+uBC;CACC,6DAAqB,IAArB;CAEA,WAAK8iB,oBAAL,CAA0B,KAA1B;CACA,WAAK3a,YAAL;CACA,WAAKgH,MAAL,CAAY,IAAZ,EAAkB,qDAAe2W,OAAf,EAAlB;CACA;CArvBF;CAAA;CAAA,sCAuvBmBF,UAvvBnB,EAwvBC;CACC9iB,MAAAA,GAAG,CAACM,MAAJ,CAAW2J,QAAX,CAAoB6P,IAApB,GAA2B,kDAAcqH,gBAAd,CAA+B7W,OAA/B,CAAuC,MAAvC,EAA+CwY,UAA/C,CAA3B;CACA;CA1vBF;CAAA;CAAA,6BA4vBU/K,SA5vBV,EA4vBqB3P,QA5vBrB,EA6vBC;CACC,UAAMvD,KAAK,GAAG,IAAI8S,KAAJ,CAAU;CACvBrb,QAAAA,QAAQ,EAAE,kDAAcA,QADD;CAEvBsb,QAAAA,QAAQ,EAAE,IAFa;CAGvBC,QAAAA,WAAW,EAAE,kDAAc1P,GAAd,CAAkB,aAAlB,CAHU;CAIvBrN,QAAAA,OAAO,oCAAE,IAAF;CAJgB,OAAV,CAAd;CAMA,UAAM2C,QAAQ,GAAG;CAChBjH,QAAAA,IAAI,EAAEuhB,SAAS,CAAC,OAAD,CADC;CAEhBO,QAAAA,UAAU,EAAE;CACX2K,UAAAA,KAAK,EAAElL,SAAS,CAAC,MAAD;CADL;CAFI,OAAjB;;CAOA,UAAI,iDAAa3W,MAAb,GAAsB,CAA1B,EACA;CACC,YAAM8hB,WAAW,GAAG,iDAAa,iDAAa9hB,MAAb,GAAsB,CAAnC,CAApB;;CACA,YAAI,CAAC8hB,WAAW,CAAChL,gBAAZ,GAA+BnG,KAA/B,EAAD,IAA2CmR,WAAW,CAAChJ,sBAAZ,EAA/C,EACA;CACCzc,UAAAA,QAAQ,CAAC,OAAD,CAAR,GAAoBylB,WAAW,CAAChL,gBAAZ,GAA+Bxa,SAA/B,EAApB;CACAD,UAAAA,QAAQ,CAAC,sBAAD,CAAR,GAAoC,CAApC;CACA;CACD;;CAEDoH,MAAAA,KAAK,CAAClH,IAAN,CAAWF,QAAX,oCAAqB,IAArB;CACAoH,MAAAA,KAAK,CAACvL,KAAN,GAAc,IAAd;;CACA,UAAI8O,QAAJ,EACA;CACCA,QAAAA,QAAQ,CAACC,IAAT,CAAc,IAAd,EAAoBxD,KAApB;CACA;CACD;CA3xBF;CAAA;CAAA,gCA6xBaA,KA7xBb,EA6xBoBwX,WA7xBpB,EA8xBC;CACC,UAAIA,WAAJ,EACA;CACC,aAAK,IAAI/X,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,iDAAalD,MAAjC,EAAyC,EAAEkD,CAA3C,EACA;CACC,cAAI,iDAAaA,CAAb,MAAoB+X,WAAxB,EACA;CACC;CACA;;CAED,2DAAa9T,MAAb,CAAoBjE,CAApB,EAAuB,CAAvB,EAA0BO,KAA1B;CACA;CACA;CACD,OAZD,MAcA;CACC,yDAAaxN,IAAb,CAAkBwN,KAAlB;CACA;;CAED,WAAKQ,YAAL;CACA;CAlzBF;CAAA;CAAA,iCAozBcR,KApzBd,EAqzBC;CACC,WAAK,IAAIP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,iDAAalD,MAAjC,EAAyC,EAAEkD,CAA3C,EACA;CACC,YAAI,iDAAaA,CAAb,MAAoBO,KAAxB,EACA;CACC,iBAAQ,iDAAaP,CAAC,GAAG,CAAjB,KAAuB,IAA/B;CACA;CACD;;CAED,aAAO,IAAP;CACA;CA/zBF;CAAA;CAAA,gCAi0BaO,KAj0Bb,EAi0BoBuD,QAj0BpB,EAk0BC;CACC,WAAI,IAAI9D,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,iDAAalD,MAAhC,EAAwC,EAAEkD,CAA1C,EACA;CACC,YAAI,iDAAaA,CAAb,EAAgB6e,OAAhB,CAAwBte,KAAxB,CAAJ,EACA;CACC,2DAAa0D,MAAb,CAAoBjE,CAApB,EAAuB,CAAvB;CACA;CACA;CACD;;CAED,UAAI8D,QAAJ,EACA;CACCA,QAAAA,QAAQ,CAACvD,KAAD,CAAR;CACA;;CAED,WAAKQ,YAAL;CACA,WAAK8a,0BAAL;CACA;CAn1BF;CAAA;CAAA,oCAq1BiBiD,SAr1BjB,EAq1B4BC,UAr1B5B,EAs1BC;CACC,UAAIA,UAAJ,EACA;CACC,2DAAeviB,YAAf,CAA4BsiB,SAA5B,EAAuCC,UAAvC;CACA,OAHD,MAKA;CACC,2DAAermB,WAAf,CAA2BomB,SAA3B;CACA;;CAED,WAAKjD,0BAAL;CACA;CAj2BF;CAAA;CAAA,4CAm2ByBtb,KAn2BzB,EAm2BuC4B,OAn2BvC,EAm2ByD6c,YAn2BzD,EAo2BC;CAAA;;CACC,UAAI,CAAC9sB,cAAI,CAACmD,aAAL,CAAmB8M,OAAnB,CAAL,EACA;CACCA,QAAAA,OAAO,GAAG,EAAV;CACA;;CAED,UAAI/B,2BAAQ,CAACqE,WAAT,GAAuBwa,sBAAvB,EAAJ,EACA;CACC,YAAI9c,OAAO,CAACmc,WAAZ,EACA;CACCle,UAAAA,2BAAQ,CAACqE,WAAT,GAAuBwa,sBAAvB,GAAgDta,KAAhD,CAAsDjF,KAAtD;CACA,SAHD,MAKA;CACC;CACA;CACD;;CAED,UAAMkF,QAAQ,GAAG,iCAAjB;CAEA,UAAMC,IAAI,GAAG1N,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC/B0N,QAAAA,KAAK,EAAE;CACNvQ,UAAAA,IAAI,EAAEqQ;CADA;CADwB,OAAnB,CAAb;CAMAxE,MAAAA,2BAAQ,CAACqE,WAAT,GAAuBya,sBAAvB,CAA8C;CAC7C5L,QAAAA,QAAQ,EAAE,IADmC;CAE7CnR,QAAAA,OAAO,EAAEA,OAFoC;CAG7C5B,QAAAA,KAAK,EAAEA,KAHsC;CAI7CsE,QAAAA,IAAI,EAAEA;CAJuC,OAA9C;CAOAA,MAAAA,IAAI,CAACnM,WAAL,CAAiB,KAAKymB,mBAAL,CAAyB5e,KAAzB,CAAjB;CACAsE,MAAAA,IAAI,CAACnM,WAAL,CAAiB,KAAKqM,uBAAL,CAA6BxE,KAA7B,CAAjB;;CACA,UAAIA,KAAK,CAAC6e,aAAN,EAAJ,EACA;CACCva,QAAAA,IAAI,CAACnM,WAAL,CAAiB,KAAK2mB,qBAAL,EAAjB;CACA;;CAED,UAAMra,QAAQ,GAAG7N,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCiH,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KAAK,EAAE,eAAChJ,KAAD;CAAA,mBAAW,MAAI,CAACD,IAAL,CAAU,oBAAV,EAAgCC,KAAhC,CAAX;CAAA;CADA;CAF0B,OAAlB,CAAjB;CAMA4L,MAAAA,IAAI,CAACnM,WAAL,CAAiBsM,QAAjB;CACA7C,MAAAA,OAAO,CAAC,sBAAD,CAAP,GAAkC,kDAAcnK,QAAd,CAAuBsnB,aAAvB,EAAlC;CAEAxlB,MAAAA,EAAE,CAACoN,IAAH,CAAQ;CACPoC,QAAAA,MAAM,EAAE,MADD;CAEPC,QAAAA,QAAQ,EAAE,MAFH;CAGP7D,QAAAA,GAAG,EAAEI,aAAG,CAACC,QAAJ,CACJ,kDAAcyD,OADV,EAEJ;CACC1B,UAAAA,cAAc,4BAAqBvH,KAAK,CAACvL,KAAN,GAAc,QAAd,GAAyB,EAA9C,uBAA6DuL,KAAK,CAACrL,IAAN,CAAWhD,IAAX,CAAgBwH,WAAhB,EAA7D;CADf,SAFI,CAHE;CASPxE,QAAAA,IAAI,EAAE;CACLuU,UAAAA,WAAW,EAAE,kBADR;CAELC,UAAAA,eAAe,EAAE,kDAAcC,cAF1B;CAGL4V,UAAAA,eAAe,EAAE,kDAAcvnB,QAAd,CAAuB4T,kBAAvB,EAHZ;CAILzJ,UAAAA,OAAO,EAAEA,OAJJ;CAKLqd,UAAAA,UAAU,EAAE3f,MAAM,CAAC4f,YAAP,CAAoBlf,KAAK,CAACnH,SAAN,EAApB,CALP;CAMLsmB,UAAAA,SAAS,EAAE9a;CANN,SATC;CAiBPgF,QAAAA,SAAS,EAAE,mBAAAjL,IAAI,EAAI;CAClB,cAAIA,IAAJ,EACA;CACC,gBAAMghB,UAAU,GAAGxoB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACpCuH,cAAAA,IAAI,EAAEA;CAD8B,aAAlB,CAAnB;CAGAkG,YAAAA,IAAI,CAACnM,WAAL,CAAiBinB,UAAjB;CACA;;CAED,UAAA,MAAI,CAACC,sBAAL,CAA4Brf,KAA5B,EAAmCsE,IAAnC,EAAyCma,YAAzC;CACA;CA3BM,OAAR;CA6BA;CAl7BF;CAAA;CAAA,2CAo7BwBze,KAp7BxB,EAo7BsCsE,IAp7BtC,EAo7B6Dma,YAp7B7D,EAq7BC;CAAA;;CACC,UAAIa,aAAa,GAAG,GAApB;CACA,UAAIC,UAAU,GAAGD,aAAjB;;CAEA,4CAAI,IAAJ,iBACA;CACC;CACA,aAAK7mB,IAAL,CAAU,6BAAV;CACA8mB,QAAAA,UAAU,GAAG3S,QAAQ,CACpB,sDAAkBtJ,GAAlB,CAAsB,UAAtB,EAAkC,4BAAlC,EAAgE,GAAhE,CADoB,CAArB;CAGA;;CAED,WAAKkc,yBAAL,CAA+Bxf,KAA/B,EAAsCsE,IAAtC;;CAEA,UACCtE,KAAK,CAACrL,IAAN,CAAWhD,IAAX,KAAoB,sBAApB,IACGqO,KAAK,CAACrL,IAAN,CAAWhD,IAAX,KAAoB,cADvB,IAEGqO,KAAK,CAACrL,IAAN,CAAWhD,IAAX,KAAoB,oBAHxB,EAKA;CACC2tB,QAAAA,aAAa,IAAI,GAAjB;;CACA,YAAIC,UAAU,GAAGD,aAAjB,EACA;CACCC,UAAAA,UAAU,GAAGD,aAAb;CACA;CACD;;CAED,UAAIrZ,QAAJ;CACA,UAAMqQ,UAAU,GACftW,KAAK,CAACyf,QAAN,KACGzf,KAAK,CAAC6U,QAAN,EADH,GAEG5d,aAAG,CAACC,UAAJ,CAAe,yCAAf,CAHJ;;CAMA,UAAI8I,KAAK,CAACvL,KAAV,EACA;CACCwR,QAAAA,QAAQ,GAAG,KAAKyZ,yBAAL,CAA+BpJ,UAA/B,CAAX;CACA;;CAED,UAAMqJ,EAAE,GAAG,IAAX;CACA,UAAMvb,KAAK,GAAG,IAAI7K,EAAE,CAACkE,WAAP,CAAmB6B,MAAM,CAACkD,gBAAP,EAAnB,EAA8C,IAA9C,EAAoD;CACjEyD,QAAAA,QAAQ,EAAEA,QAAQ,IAAIqQ,UAD2C;CAEjEnY,QAAAA,OAAO,EAAEmG,IAFwD;CAGjE6B,QAAAA,SAAS,EAAE,IAHsD;CAIjErL,QAAAA,KAAK,EAAEykB,UAJ0D;CAKjEK,QAAAA,SAAS,EAAE;CACVC,UAAAA,QAAQ,EAAEP,aADA;CAEVQ,UAAAA,SAAS,EAAE;CAFD,SALsD;CASjEjiB,QAAAA,UAAU,EAAE,CATqD;CAUjEC,QAAAA,SAAS,EAAE,CAVsD;CAWjEkB,QAAAA,UAAU,EAAE,IAXqD;CAYjEoH,QAAAA,SAAS,EAAE;CAACC,UAAAA,QAAQ,EAAE;CAAX,SAZsD;CAajErI,QAAAA,MAAM,EAAE;CACPC,UAAAA,YAAY,EAAE,sBAACmG,KAAD,EAAW;CACxBvE,YAAAA,2BAAQ,CAACqE,WAAT,GAAuBya,sBAAvB,CAA8C,IAA9C;;CACA,YAAA,MAAI,CAACoB,4BAAL;;CACA3b,YAAAA,KAAK,CAAClG,OAAN;;CACA,YAAA,MAAI,CAACzF,IAAL,CAAU,8BAAV;CACA,WANM;CAOPunB,UAAAA,aAAa,EAAE,yBAAM;CACpB,YAAA,MAAI,CAACC,qBAAL;CACA,WATM;CAUPC,UAAAA,gBAAgB,EAAE,4BAAW;CAC5B,kDAAIP,EAAJ,iBACA;CACC,gDAAAA,EAAE,eAAF,CAAgBhtB,GAAhB,CACC,UADD,EAEC,4BAFD,EAGC,KAAKwtB,QAAL,EAHD;CAKA;CACD;CAnBM,SAbyD;CAkCjE3Z,QAAAA,OAAO,EAAE,CACR,IAAIjN,EAAE,CAACkN,iBAAP,CAAyB;CACxBzP,UAAAA,IAAI,EAAGC,aAAG,CAACC,UAAJ,CAAe,qBAAf,CADiB;CAExBH,UAAAA,SAAS,EAAG,4BAFY;CAGxBiH,UAAAA,MAAM,EAAG;CACR0D,YAAAA,KADQ,mBAER;CACC,kBAAM0e,UAAU,GAAGpgB,KAAK,CAACvL,KAAzB;CAEAkrB,cAAAA,EAAE,CAACU,iBAAH,CAAqB/b,IAArB,EAA2BtE,KAA3B,EAAkCzG,EAAE,CAAC+mB,QAAH,CAAY,YAC9C;CACC,qBAAKte,WAAL,CAAiB7C,KAAjB;;CACA,oBAAIihB,UAAJ,EACA;CACCT,kBAAAA,EAAE,CAAClnB,IAAH,CAAQ,oBAAR,EAA8B;CAAEuH,oBAAAA,KAAK,EAALA;CAAF,mBAA9B;CACA;;CACD,oBAAIye,YAAJ,EACA;CACCA,kBAAAA,YAAY,CAACze,KAAD,CAAZ;CACA;CACD,eAXiC,EAW/B,IAX+B,CAAlC,EAWU,KAAKugB,UAXf;CAYA;CAjBO;CAHe,SAAzB,CADQ,EAwBR,IAAIhnB,EAAE,CAACkO,qBAAP,CAA6B;CAC5BzQ,UAAAA,IAAI,EAAGC,aAAG,CAACC,UAAJ,CAAe,uBAAf,CADqB;CAE5BH,UAAAA,SAAS,EAAG,iCAFgB;CAG5BiH,UAAAA,MAAM,EAAG;CACR0D,YAAAA,KAAK,EAAE,iBAAU;CAChB,mBAAKM,WAAL,CAAiB7C,KAAjB;CACA;CAHO;CAHmB,SAA7B,CAxBQ;CAlCwD,OAApD,CAAd;CAsEAU,MAAAA,2BAAQ,CAACqE,WAAT,GAAuBwa,sBAAvB,GAAgDta,KAAhD,GAAwDA,KAAxD;CACAA,MAAAA,KAAK,CAAC7F,IAAN;CACA;CAtiCF;CAAA;CAAA,8CAwiC2BmG,KAxiC3B,EAyiCC;CACC,aAAO;CACNvG,QAAAA,OAAO,EAAE5E,EAAE,CAAC3C,GAAH,CAAOC,MAAP,CAAc,KAAd,EAAqB;CAC9B0N,UAAAA,KAAK,EAAE;CACNxN,YAAAA,SAAS,EAAE;CADL,WADuB;CAI9BgB,UAAAA,QAAQ,EAAE,CACTN,QAAQ,CAACiQ,cAAT,CAAwBhD,KAAxB,CADS,EAET9N,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClB0N,YAAAA,KAAK,EAAE;CACNxN,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBC,YAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAJY;CAKlB8G,YAAAA,MAAM,EAAE;CACP0D,cAAAA,KAAK,EAAE,KAAK8e,kBAAL,CAAwBppB,IAAxB,CAA6B,IAA7B;CADA;CALU,WAAnB,CAFS;CAJoB,SAArB;CADH,OAAP;CAmBA;CA7jCF;CAAA;CAAA,8CA+jC2B4I,KA/jC3B,EA+jCkC9K,IA/jClC,EAgkCC;CACC,UAAI,CAACvD,cAAI,CAACS,OAAL,CAAa,KAAKquB,qBAAlB,CAAL,EACA;CACC,aAAKA,qBAAL,GAA6B,EAA7B;CACA;;CAED,UAAMjX,YAAY,GAAGtU,IAAI,CAACyH,gBAAL,CAAsB,aAAtB,CAArB;;CACA,WAAK,IAAI8C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+J,YAAY,CAACjN,MAAjC,EAAyC,EAAEkD,CAA3C,EACA;CACC,aAAKihB,wBAAL,CAA8B1gB,KAA9B,EAAqCwJ,YAAY,CAAC/J,CAAD,CAAjD;CACA;CACD;CA3kCF;CAAA;CAAA,6CA6kC0BO,KA7kC1B,EA6kCiC2gB,WA7kCjC,EA8kCC;CAAA;;CACC,UAAI,CAAChvB,cAAI,CAACS,OAAL,CAAa,KAAKquB,qBAAlB,CAAL,EACA;CACC,aAAKA,qBAAL,GAA6B,EAA7B;CACA;;CAED,UAAM/W,IAAI,GAAGiX,WAAW,CAACplB,YAAZ,CAAyB,WAAzB,CAAb;CAEA,UAAMqlB,YAAY,GAAG;CACpBhf,QAAAA,OAAO,EAAE,IAAIif,kCAAJ,CAAoB;CAC5BlhB,UAAAA,MAAM,EAAEyL,iBAAO,CAACvW,KAAR,CAAc,kDAAc4C,QAAd,CAAuBuQ,SAAvB,EAAd,CADoB;CAE5B8Y,UAAAA,eAAe,EAAE,kDAAcxd,GAAd,CAAkB,uCAAlB,CAFW;CAG5Byd,UAAAA,cAAc,EAAE,kDAActpB,QAAd,CAAuBiN,KAHX;CAI5BgW,UAAAA,WAAW,EAAE,kDAAcA;CAJC,SAApB,CADW;CAOpBsG,QAAAA,QAAQ,EAAEhhB,KAAK,CAACvL,KAPI;CAQpBwsB,QAAAA,QAAQ,EAAEN;CARU,OAArB;;CAWA,UAAIjX,IAAI,KAAKwX,kCAAe,CAACC,kBAA7B,EACA;CACC,YAAMC,aAAa,GAAG7hB,IAAI,CAAC8hB,KAAL,CAAWV,WAAW,CAACplB,YAAZ,CAAyB,eAAzB,CAAX,CAAtB;CACAqlB,QAAAA,YAAY,CAAChf,OAAb,CAAqBjP,GAArB,CAAyB,sBAAzB,2BAAiD,IAAjD,4EAAiD,IAAjD,EAAuFyuB,aAAvF;CACA,OAJD,MAKK,IAAI1X,IAAI,KAAKwX,kCAAe,CAACI,kBAA7B,EACL;CACC,aAAK3M,MAAL,CAAYtiB,OAAZ,CAAoB,UAAC2N,KAAD,EAAW;CAAA;;CAC9B,mCAAA4gB,YAAY,CAAChf,OAAb,CAAqBjC,MAArB,EAA4BnN,IAA5B,6DACIwN,KAAK,CACN4U,0BADC,GAED7Q,MAFC,CAEM,UAAAnE,KAAK;CAAA,mBAAIA,KAAK,CAAC,MAAD,CAAL,KAAkB,MAAtB;CAAA,WAFX,EAGDhM,GAHC,CAGG,UAACgM,KAAD;CAAA,mBAAY;CAChB9N,cAAAA,EAAE,eAAQkO,KAAK,CAAC7J,KAAN,EAAR,cAAyByJ,KAAK,CAAC,IAAD,CAA9B,OADc;CAEhByK,cAAAA,IAAI,YAAKrK,KAAK,CAAC6U,QAAN,EAAL,eAA0BjV,KAAK,CAAC,MAAD,CAA/B,CAFY;CAGhBjO,cAAAA,IAAI,EAAE,MAHU;CAIhB4Y,cAAAA,UAAU,eAAQvK,KAAK,CAAC7J,KAAN,EAAR,cAAyByJ,KAAK,CAAC,IAAD,CAA9B;CAJM,aAAZ;CAAA,WAHH,CADJ;CAWA,SAZD;CAaA;;CAED,UAAM6J,OAAO,GAAGyX,kCAAe,CAACK,oBAAhB,CAAqC7X,IAArC,EAA2CkX,YAA3C,CAAhB;;CAEA,UAAInX,OAAO,IAAIC,IAAI,KAAKwX,kCAAe,CAACM,wBAAxC,EACA;CACC/X,QAAAA,OAAO,CAACgY,QAAR,CAAiBd,WAAjB;CAEAlX,QAAAA,OAAO,CAAC1I,SAAR,CAAkB,eAAlB,EAAmC,UAACrI,KAAD,EAAW;CAC7C,+BAAwBA,KAAK,CAACM,OAAN,EAAxB;CAAA,cAAOooB,aAAP,kBAAOA,aAAP;;CACA3X,UAAAA,OAAO,CAACiY,aAAR,CAAsB,MAAI,CAACC,WAAL,CAAiBP,aAAjB,CAAtB;CACA,SAHD;CAIA3X,QAAAA,OAAO,CAAC1I,SAAR,CAAkB,gBAAlB,EAAoC,UAACrI,KAAD,EAAW;CAC9C,gCAAwBA,KAAK,CAACM,OAAN,EAAxB;CAAA,cAAOooB,aAAP,mBAAOA,aAAP;;CACA3X,UAAAA,OAAO,CAACiY,aAAR,CAAsB,MAAI,CAACE,YAAL,CAAkBR,aAAlB,CAAtB;CACA,SAHD;CAIA3X,QAAAA,OAAO,CAAC1I,SAAR,CAAkB,YAAlB,EAAgC,UAACrI,KAAD,EAAW;CAC1C,mCAAA,MAAI,oEAAJ,MAAA,MAAI,EAAiCA,KAAjC,EAAwCsH,KAAxC,CAAJ;;CAEA,UAAA,MAAI,CAACvH,IAAL,CACC,6BADD;CAGEsa,YAAAA,QAAQ,EAAE,MAHZ;CAIE/S,YAAAA,KAAK,EAALA;CAJF,aAKKtH,KAAK,CAACM,OAAN,EALL;CAQA,SAXD;CAYA;;CAEDO,MAAAA,EAAE,CAACoF,EAAH,CAAMC,IAAN,CAAW9F,IAAX,CAAgB6nB,WAAhB;;CAEA,UAAIlX,OAAJ,EACA;CACC,aAAKgX,qBAAL,CAA2BjuB,IAA3B,CAAgCiX,OAAhC;CACA;CACD;CAzpCF;CAAA;CAAA,mDAmvCC;CACC,UAAI,KAAK3B,iBAAT,EACA;CACC,aAAKA,iBAAL,CAAuB5J,OAAvB;CACA,aAAK4J,iBAAL,GAAyB,IAAzB;CACA;;CAED,UAAInW,cAAI,CAACS,OAAL,CAAa,KAAKquB,qBAAlB,CAAJ,EACA;CACC,aAAK,IAAIhhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKghB,qBAAL,CAA2BlkB,MAA/C,EAAuD,EAAEkD,CAAzD,EACA;CACC,cAAI9N,cAAI,CAACkY,UAAL,CAAgB,KAAK4W,qBAAL,CAA2BhhB,CAA3B,EAA8BvB,OAA9C,CAAJ,EACA;CACC,iBAAKuiB,qBAAL,CAA2BhhB,CAA3B,EAA8BvB,OAA9B;CACA;CACD;CACD;;CAED,WAAKuiB,qBAAL,GAA6B,IAA7B;CACA;CAtwCF;CAAA;CAAA,gDAywCC;CACC,UAAI9uB,cAAI,CAACS,OAAL,CAAa,KAAKquB,qBAAlB,CAAJ,EACA;CACC,aAAK,IAAIhhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKghB,qBAAL,CAA2BlkB,MAA/C,EAAuD,EAAEkD,CAAzD,EACA;CACC,cAAI9N,cAAI,CAACkY,UAAL,CAAgB,KAAK4W,qBAAL,CAA2BhhB,CAA3B,EAA8BoiB,YAA9C,CAAJ,EACA;CACC,iBAAKpB,qBAAL,CAA2BhhB,CAA3B,EAA8BoiB,YAA9B;CACA;CACD;CACD;CACD;CApxCF;CAAA;CAAA,4CAuxCC;CACC,UAAIlwB,cAAI,CAACS,OAAL,CAAa,KAAKquB,qBAAlB,CAAJ,EACA;CACC,aAAK,IAAIhhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKghB,qBAAL,CAA2BlkB,MAA/C,EAAuD,EAAEkD,CAAzD,EACA;CACC,cAAI9N,cAAI,CAACkY,UAAL,CAAgB,KAAK4W,qBAAL,CAA2BhhB,CAA3B,EAA8BugB,aAA9C,CAAJ,EACA;CACC,iBAAKS,qBAAL,CAA2BhhB,CAA3B,EAA8BugB,aAA9B;CACA;CACD;CACD;CACD;CAlyCF;CAAA;CAAA,wCAoyCqBhgB,KApyCrB,EAqyCC;CACC,UAAMiX,KAAK,GAAGjX,KAAK,CAACqT,gBAAN,GAAyBxe,KAAzB,EAAd;CACA,UAAMitB,MAAM,GAAGxiB,MAAM,CAACkD,gBAAP,EAAf;CAEA,UAAMuf,aAAa,GAAGnrB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACzCC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,YAFA;CAGNC,UAAAA,KAAK,EAAEgjB,KAAK,CAAC3b;CAHP;CADkC,OAApB,CAAtB;CAOA,UAAM0mB,cAAc,GAAGprB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAC1CC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,aAFA;CAGNC,UAAAA,KAAK,EAAEgjB,KAAK,CAAChjB;CAHP;CADmC,OAApB,CAAvB;CAOA,UAAMguB,kBAAkB,GAAGrrB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAC9CC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,kBAFA;CAGNC,UAAAA,KAAK,EAAEgjB,KAAK,CAAC3K;CAHP;CADuC,OAApB,CAA3B;CAOA,UAAM4V,cAAc,GAAGtrB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAC1CC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,aAFA;CAGNC,UAAAA,KAAK,EAAEgjB,KAAK,CAAC1K;CAHP;CADmC,OAApB,CAAvB;CAOA,UAAM4V,iBAAiB,GAAGvrB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAC7CC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,gBAFA;CAGNC,UAAAA,KAAK,EAAEgjB,KAAK,CAACzK,QAAN,GAAiB,CAAjB,GAAqB;CAHtB;CADsC,OAApB,CAA1B;CAQA,UAAM4V,sBAAsB,GAAGxrB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACjDC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL;CAD0C,OAAnB,CAA/B;CAMA,UAAM8V,WAAW,GAAG,EAApB;CAEA,UAAMwV,SAAS,GAAG,kDAAc5qB,QAAd,CAAuBuQ,SAAvB,EAAlB;CACA,UAAMsa,SAAS,qCAAG,IAAH,kBAAf;;CAEA,UAAI3wB,cAAI,CAACS,OAAL,CAAaiwB,SAAb,CAAJ,EACA;CACC,aAAK,IAAI5iB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4iB,SAAS,CAAC9lB,MAA9B,EAAsC,EAAEkD,CAAxC,EACA;CACC,cAAMG,KAAK,GAAGyiB,SAAS,CAAC5iB,CAAD,CAAvB;;CACA,cAAIG,KAAK,CAAC,MAAD,CAAL,IAAiB,MAAjB,IAA2BA,KAAK,CAAC,MAAD,CAAL,IAAiB,UAAhD,EACA;CACCiN,YAAAA,WAAW,CAACra,IAAZ,CAAiBoN,KAAjB;CACA;CACD;CACD;;CAED,UAAM2iB,qBAAqB,GAAG,IAAIC,wCAAJ,CAA0B;CACvDC,QAAAA,SAAS,EAAEL,sBAD4C;CAEvDM,QAAAA,QAFuD,oBAE9CzL,KAF8C,EAEvC;CACf8K,UAAAA,aAAa,CAAC9tB,KAAd,GAAsBgjB,KAAK,CAAC3b,IAA5B;CACA0mB,UAAAA,cAAc,CAAC/tB,KAAf,GAAuBgjB,KAAK,CAAChjB,KAA7B;CACAguB,UAAAA,kBAAkB,CAAChuB,KAAnB,GAA2BgjB,KAAK,CAAC3K,SAAjC;CACA4V,UAAAA,cAAc,CAACjuB,KAAf,GAAuBgjB,KAAK,CAAC1K,KAA7B;CACA4V,UAAAA,iBAAiB,CAACluB,KAAlB,GAA0BgjB,KAAK,CAACzK,QAAN,GAAiB,CAAjB,GAAqB,CAA/C;CACA,SARsD;CASvDK,QAAAA,WAAW,EAAEA,WAT0C;CAUvDyV,QAAAA,SAAS,EAAEA,SAV4C;CAWvDK,QAAAA,aAAa,EAAE;CAXwC,OAA1B,CAA9B;CAcA,UAAIC,yBAAyB,GAAG,IAAhC;;CACA,UAAI5iB,KAAK,CAAC6iB,WAAN,EAAJ,EACA;CACC,YAAMC,4BAA4B,GAAGlsB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACxDC,UAAAA,KAAK,EAAE;CACNwE,YAAAA,IAAI,EAAE,UADA;CAENsV,YAAAA,EAAE,EAAE,oBAAoBkR,MAFlB;CAGN9tB,YAAAA,IAAI,EAAE,wBAHA;CAINC,YAAAA,KAAK,EAAE,GAJD;CAKN0G,YAAAA,KAAK,EAAE;CALD;CADiD,SAApB,CAArC;;CASA,YAAIqF,KAAK,CAACqV,sBAAN,EAAJ,EACA;CACCyN,UAAAA,4BAA4B,CAAC/N,YAA7B,CAA0C,SAA1C,EAAqD,SAArD;CACA;;CACD6N,QAAAA,yBAAyB,GAAGhsB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7CC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WADsC;CAE7CgB,UAAAA,QAAQ,EAAE,CACT+qB,4BADS,EAETlsB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACnBC,YAAAA,KAAK,EAAE;CACN,qBAAK,oBAAoBgrB,MADnB;CAENnnB,cAAAA,KAAK,EAAE;CAFD,aADY;CAKnB3D,YAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,4CAAf;CALa,WAApB,CAFS;CAFmC,SAAlB,CAA5B;CAaA;;CAED,UAAMY,GAAG,GAAGlB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC7BC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SADsB;CAE7BgB,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WADU;CAEjBgB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADW;CAElBgB,YAAAA,QAAQ,EAAE,CACTgqB,aADS,EAETC,cAFS,EAGTC,kBAHS,EAITC,cAJS,EAKTC,iBALS,EAMTvrB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,cAAAA,KAAK,EAAE;CAAEC,gBAAAA,SAAS,EAAE;CAAb,eADW;CAElBC,cAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf,IAAsD;CAF1C,aAAnB,CANS,EAUTkrB,sBAVS;CAFQ,WAAnB,CADS;CAFO,SAAlB,CADS,EAqBTQ,yBArBS;CAFmB,OAAlB,CAAZ;CA2BAL,MAAAA,qBAAqB,CAACzpB,IAAtB,CAA2Bme,KAA3B;CAEA,aAAOnf,GAAP;CACA;CA/6CF;CAAA;CAAA,6CAi7C0B2Q,UAj7C1B,EAi7CuCzI,KAj7CvC,EAk7CC;CACC,UAAMiX,KAAK,GAAG,IAAIvL,aAAJ,EAAd;CACAuL,MAAAA,KAAK,CAACjL,OAAN,CAAcvD,UAAU,CAAC,YAAD,CAAxB;CACAwO,MAAAA,KAAK,CAAChL,QAAN,CAAexD,UAAU,CAAC,aAAD,CAAzB;CACAwO,MAAAA,KAAK,CAAC/K,YAAN,CAAmBzD,UAAU,CAAC,kBAAD,CAA7B;CACAwO,MAAAA,KAAK,CAAC9K,QAAN,CAAe1D,UAAU,CAAC,aAAD,CAAzB;CACAwO,MAAAA,KAAK,CAAC7K,WAAN,CAAkB3D,UAAU,CAAC,gBAAD,CAAV,KAAiC,GAAnD;CACAzI,MAAAA,KAAK,CAAC+iB,gBAAN,CAAuB9L,KAAvB;;CAEA,UAAIjX,KAAK,CAAC6iB,WAAN,EAAJ,EACA;CACC7iB,QAAAA,KAAK,CAACgjB,uBAAN,CACCva,UAAU,CAAC,wBAAD,CAAV,IAAyCA,UAAU,CAAC,wBAAD,CAAX,KAA2C,GADpF;CAGA;;CAED,aAAO,IAAP;CACA;CAn8CF;CAAA;CAAA,4CAq8CyBzI,KAr8CzB,EAs8CC;CAAA;;CACC,UAAM4H,cAAc,GAAG5H,KAAK,CAAC6H,YAAN,EAAvB;CACA,WAAKC,iBAAL,GAAyB,IAAIC,yCAAJ,CAA2BH,cAA3B,EAA2C;CACnEjI,QAAAA,MAAM,EAAE,kDAAclI,QAAd,CAAuBuQ,SAAvB,EAD2D;CAEnEib,QAAAA,UAAU,EAAE,oBAACvqB,KAAD,EAAW;CACtB,mCAAA,MAAI,oEAAJ,MAAA,MAAI,EAAiCA,KAAjC,EAAwCsH,KAAxC,CAAJ;;CAEA,UAAA,MAAI,CAACvH,IAAL,CACC,6BADD;CAGEsa,YAAAA,QAAQ,EAAE,MAHZ;CAIE/S,YAAAA,KAAK,EAALA;CAJF,aAKKtH,KAAK,CAACM,OAAN,EALL;CAQA;CAbkE,OAA3C,CAAzB;CAgBA,aAAOpC,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACxBC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SADiB;CAExBgB,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CAAEC,YAAAA,SAAS,EAAE;CAAb,WADU;CAEjBgB,UAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CAAEC,cAAAA,SAAS,EAAE;CAAb,aADW;CAElBC,YAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,oCAAf,IAAuD;CAF3C,WAAnB,CADS,EAKT,KAAK4Q,iBAAL,CAAuB7S,UAAvB,EALS;CAFO,SAAlB,CADS;CAFc,OAAlB,CAAP;CAeA;CAv+CF;CAAA;CAAA,iDAy+C8BwT,UAz+C9B,EAy+C0CzI,KAz+C1C,EA0+CC;CACCA,MAAAA,KAAK,CAAC0I,YAAN,CAAmBhU,iCAAc,CAACiU,cAAf,CAA8BF,UAA9B,CAAnB;CAEA,aAAO,IAAP;CACA;CA9+CF;CAAA;CAAA,4CAi/CC;CACC,UAAMya,KAAK,GAAGtsB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC/BC,QAAAA,KAAK,EAAE;CAACC,UAAAA,SAAS,EAAC;CAAX;CADwB,OAAlB,CAAd;CAIA,UAAMosB,OAAO,GAAGvsB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClCC,QAAAA,KAAK,EAAE;CAACC,UAAAA,SAAS,EAAE;CAAZ,SAD2B;CAElCC,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,8CAAf;CAF4B,OAAnB,CAAhB;CAKAgsB,MAAAA,KAAK,CAAC/qB,WAAN,CAAkBgrB,OAAlB;CACAD,MAAAA,KAAK,CAAC/qB,WAAN,CAAkBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACpCC,QAAAA,KAAK,EAAE;CAACC,UAAAA,SAAS,EAAE;CAAZ,SAD6B;CAEpCiH,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KADO,mBACC;CACPwhB,YAAAA,KAAK,CAACvoB,KAAN,CAAYyoB,OAAZ,GAAsB,MAAtB;CACA;CAHM;CAF4B,OAAnB,CAAlB;CASA,aAAOF,KAAP;CACA;CAtgDF;CAAA;CAAA,sCAwgDmB5e,IAxgDnB,EAwgDyBtE,KAxgDzB,EAwgDgCuD,QAxgDhC,EAwgD0C8f,OAxgD1C,EAygDC;CAAA;;CACC,UAAIA,OAAJ,EACA;CACCA,QAAAA,OAAO,CAACxoB,SAAR,CAAkBlH,GAAlB,CAAsB,0BAAtB;CACA;;CAED,WAAK2vB,yBAAL;CACA,UAAM5c,QAAQ,GAAGnN,EAAE,CAACoN,IAAH,CAAQC,WAAR,CAAoBtC,IAApB,CAAjB;CAEA,UAAM2E,OAAO,GAAG,kDAAcA,OAA9B;CACA,UAAM0J,cAAc,GAAG,kDAAcvJ,cAArC;CACA7P,MAAAA,EAAE,CAACoN,IAAH,CAAQ;CACPoC,QAAAA,MAAM,EAAE,MADD;CAEPC,QAAAA,QAAQ,EAAE,MAFH;CAGP7D,QAAAA,GAAG,EAAEI,aAAG,CAACC,QAAJ,CACJyD,OADI,EAEJ;CACC1B,UAAAA,cAAc,4BAAqBvH,KAAK,CAACvL,KAAN,GAAc,QAAd,GAAyB,EAA9C,mBAAyDuL,KAAK,CAACrL,IAAN,CAAWhD,IAAX,CAAgBwH,WAAhB,EAAzD;CADf,SAFI,CAHE;CASPxE,QAAAA,IAAI,EAAE;CACLuU,UAAAA,WAAW,EAAE,qBADR;CAELC,UAAAA,eAAe,EAAEwJ,cAFZ;CAGLsM,UAAAA,UAAU,EAAE3f,MAAM,CAAC4f,YAAP,CAAoBlf,KAAK,CAACnH,SAAN,EAApB,CAHP;CAIL0qB,UAAAA,cAAc,EAAEjkB,MAAM,CAAC4f,YAAP,CAAoBxY,QAAQ,CAAC,MAAD,CAA5B,CAJX;CAKL8c,UAAAA,SAAS,EAAE9c,QAAQ,CAAC,MAAD;CAAU;;CALxB,SATC;CAgBP2C,QAAAA,SAAS,EAAE,mBAAAC,QAAQ,EAAI;CACtB,cAAI+Z,OAAJ,EACA;CACCA,YAAAA,OAAO,CAACxoB,SAAR,CAAkBQ,MAAlB,CAAyB,0BAAzB;CACA;;CAED,cAAIiO,QAAQ,CAACma,OAAb,EACA;CACCzjB,YAAAA,KAAK,CAAC0jB,UAAN,CAAiBpa,QAAQ,CAACsJ,IAAT,CAAc5S,KAA/B;;CACA,YAAA,MAAI,CAAC2jB,wBAAL,CAA8Bjd,QAAQ,CAAC,MAAD,CAAtC,EAAgD1G,KAAhD;;CACA,YAAA,MAAI,CAACmH,4BAAL,CAAkCT,QAAQ,CAAC,MAAD,CAA1C,EAAoD1G,KAApD;;CAEA,gBAAIA,KAAK,CAACvL,KAAV,EACA;CACC,gDAAA,MAAI,UAAJ,CAAajC,IAAb,CAAkBwN,KAAlB;;CACA,cAAA,MAAI,CAAC0X,eAAL,CAAqB1X,KAAK,CAAC9K,IAA3B;CACA;;CACD8K,YAAAA,KAAK,CAACvL,KAAN,GAAc,KAAd;CAEAuL,YAAAA,KAAK,CAACwH,MAAN;;CACA,YAAA,MAAI,CAAChH,YAAL;;CACA,gBAAI+C,QAAJ,EACA;CACCA,cAAAA,QAAQ,CAAC+F,QAAQ,CAACsJ,IAAV,CAAR;CACA;CACD,WAnBD,MAqBA;CACCsQ,YAAAA,KAAK,CAAC5Z,QAAQ,CAACsa,MAAT,CAAgB,CAAhB,CAAD,CAAL;CACA;CACD;CA9CM,OAAR;CAgDA;CApkDF;CAAA;CAAA,gCAukDC;CACC,UAAMjvB,IAAI,GAAG4E,EAAE,CAAC1E,KAAH,mCAAS,IAAT,WAAb;CACAF,MAAAA,IAAI,CAAC,sBAAD,CAAJ,GAA+B,KAAK4mB,kBAAL,KAA4B,CAA5B,GAAgC,CAA/D;CACA5mB,MAAAA,IAAI,CAAC,QAAD,CAAJ,GAAiB,EAAjB;;CAEA,WAAK,IAAI8K,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,iDAAalD,MAAjC,EAAyC,EAAEkD,CAA3C,EACA;CACC9K,QAAAA,IAAI,CAAC,QAAD,CAAJ,CAAenC,IAAf,CAAoB,iDAAaiN,CAAb,EAAgB5G,SAAhB,EAApB;CACA;;CAED,aAAOlE,IAAP;CACA;CAllDF;CAAA;CAAA,yCAqlDC;CACC,aAAQ,KAAKkvB,gBAAL,KAA0B,IAAlC;CACA;CAvlDF;CAAA;CAAA,yCAylDsB5f,QAzlDtB,EA0lDC;CACC,WAAK4f,gBAAL,GAAwB5f,QAAQ,KAAK,KAArC;CACA;CA5lDF;CAAA;CAAA,iCA8lDc2M,EA9lDd,EA+lDC;CACC,aAAO,iDAAahb,IAAb,CAAkB,UAAAoK,KAAK;CAAA,eAAIA,KAAK,CAAC7J,KAAN,OAAkBya,EAAtB;CAAA,OAAvB,CAAP;CACA;CAjmDF;CAAA;CAAA,iCAomDC;CACC,aAAO,KAAK3M,QAAZ;CACA;CAtmDF;CAAA;CAAA,iCAwmDcA,QAxmDd,EAymDC;CACC,WAAKA,QAAL,GAAgBA,QAAQ,KAAK,KAA7B;;CAEA,UAAI,KAAKA,QAAT,EACA;CACC,aAAKxL,IAAL,CAAU,mBAAV;CACA;CACD;CAhnDF;CAAA;CAAA,mCAmnDC;CAAA;;CACC,UAAMmiB,SAAS,GAAG,EAAlB;CAEArJ,MAAAA,MAAM,CAACuS,IAAP,CAAY,iDAAW9I,SAAvB,EAAkC3oB,OAAlC,CAA0C,UAAAue,EAAE,EAAI;CAC/C,YAAMmT,QAAQ,GAAGxqB,EAAE,CAAC1E,KAAH,CAAS,kCAAA,MAAI,UAAJ,CAAWmmB,SAAX,CAAqBpK,EAArB,CAAT,CAAjB;CAEAmT,QAAAA,QAAQ,CAACjyB,EAAT,GAAc8e,EAAd;CACAmT,QAAAA,QAAQ,CAAC3Z,QAAT,GAAoB,UAApB;CACA2Z,QAAAA,QAAQ,CAACvZ,gBAAT,GAA4B,gBAAgBoG,EAAhB,GAAqB,GAAjD;CACAmT,QAAAA,QAAQ,CAACxZ,UAAT,GAAsB,UAAUqG,EAAV,GAAe,IAArC;CAEAgK,QAAAA,SAAS,CAACpoB,IAAV,CAAeuxB,QAAf;CACA,OATD;CAWA,aAAOnJ,SAAP;CACA;CAloDF;CAAA;CAAA,gCAooDahK,EApoDb,EAqoDC;CACC,UAAMgK,SAAS,GAAG,KAAKlB,YAAL,EAAlB;;CAEA,WAAK,IAAIja,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmb,SAAS,CAACre,MAA9B,EAAsC,EAAEkD,CAAxC,EACA;CACC,YAAImb,SAAS,CAACnb,CAAD,CAAT,CAAa3N,EAAb,KAAoB8e,EAAxB,EACA;CACC,iBAAOgK,SAAS,CAACnb,CAAD,CAAhB;CACA;CACD;;CAED,aAAO,IAAP;CACA;CAjpDF;CAAA;CAAA,gCAmpDa0K,QAnpDb,EAopDC;CACC,UAAMyG,EAAE,GAAGzG,QAAQ,CAACrY,EAAT,IAAe,KAAKkyB,kBAAL,CAAwB,UAAxB,EAAoC,iDAAWhJ,SAA/C,CAA1B;;CAEA,UAAI,iDAAWA,SAAX,CAAqBpK,EAArB,CAAJ,EACA;CACC,2CAA2BA,EAA3B;CACA;;CAED,uDAAWoK,SAAX,CAAqBpK,EAArB,IAA2BzG,QAA3B;CAEA,WAAK1R,IAAL,CAAU,uBAAV,EAVD;CAYC;CACA;CACA;;CAEA,aAAO,KAAKwrB,WAAL,CAAiBrT,EAAjB,CAAP;CACA;CArqDF;CAAA;CAAA,mCAuqDgBA,EAvqDhB,EAuqDoBzG,QAvqDpB,EAwqDC;CACC,UAAI,CAAC,iDAAW6Q,SAAX,CAAqBpK,EAArB,CAAL,EACA;CACC,2CAA2BA,EAA3B;CACA,OAJF;;;CAOC,uDAAWoK,SAAX,CAAqBpK,EAArB,EAAyBsT,WAAzB,GAAuC/Z,QAAQ,CAAC+Z,WAAhD;CAEA,WAAKzrB,IAAL,CAAU,0BAAV,EAAsC;CAACsrB,QAAAA,QAAQ,EAAE,KAAKE,WAAL,CAAiBrT,EAAjB;CAAX,OAAtC,EATD;CAWC;CACA;CACA;;CAEA,aAAO,KAAKqT,WAAL,CAAiBrT,EAAjB,CAAP;CACA;CAxrDF;CAAA;CAAA,mCA0rDgBA,EA1rDhB,EA2rDC;CACC,aAAO,iDAAWoK,SAAX,CAAqBpK,EAArB,CAAP;CAEA,aAAO,IAAP;CACA;CA/rDF;CAAA;CAAA,qCAisDkBA,EAjsDlB,EAisDsB3c,KAjsDtB,EAksDC;CACC,UAAI,iDAAW+mB,SAAX,CAAqBpK,EAArB,CAAJ,EACA;CACC,yDAAWoK,SAAX,CAAqBpK,EAArB,EAAyB,SAAzB,IAAsC3c,KAAtC;CAEA,eAAO,IAAP;CACA;;CAED,aAAO,KAAP;CACA;CA3sDF;CAAA;CAAA,oCA8sDC;CAAA;;CACC,UAAM0X,MAAM,GAAG,EAAf;CAEA4F,MAAAA,MAAM,CAACuS,IAAP,CAAY,iDAAW7I,UAAvB,EAAmC5oB,OAAnC,CAA2C,UAAAue,EAAE,EAAI;CAChD,YAAMuT,KAAK,GAAG5qB,EAAE,CAAC1E,KAAH,CAAS,kCAAA,OAAI,UAAJ,CAAWomB,UAAX,CAAsBrK,EAAtB,CAAT,CAAd;CAEAuT,QAAAA,KAAK,CAACryB,EAAN,GAAW8e,EAAX;CACAuT,QAAAA,KAAK,CAAC/Z,QAAN,GAAiB,UAAjB;CACA+Z,QAAAA,KAAK,CAAC3Z,gBAAN,GAAyB,gBAAgBoG,EAAhB,GAAqB,GAA9C;CACAuT,QAAAA,KAAK,CAAC5Z,UAAN,GAAmB,UAAUqG,EAAV,GAAe,IAAlC;CAEAjF,QAAAA,MAAM,CAACnZ,IAAP,CAAY2xB,KAAZ;CACA,OATD;CAWA,aAAOxY,MAAP;CACA;CA7tDF;CAAA;CAAA,iCA+tDciF,EA/tDd,EAguDC;CACC,UAAMjF,MAAM,GAAG,KAAKmO,aAAL,EAAf;;CAEA,WAAK,IAAIra,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkM,MAAM,CAACpP,MAA3B,EAAmC,EAAEkD,CAArC,EACA;CACC,YAAIkM,MAAM,CAAClM,CAAD,CAAN,CAAU3N,EAAV,KAAiB8e,EAArB,EACA;CACC,iBAAOjF,MAAM,CAAClM,CAAD,CAAb;CACA;CACD;;CAED,aAAO,IAAP;CACA;CA5uDF;CAAA;CAAA,iCA8uDc0K,QA9uDd,EA+uDC;CACC,UAAMyG,EAAE,GAAGzG,QAAQ,CAACrY,EAAT,IAAe,KAAKkyB,kBAAL,CAAwB,WAAxB,EAAqC,iDAAW/I,UAAhD,CAA1B;;CAEA,UAAI,iDAAWA,UAAX,CAAsBrK,EAAtB,CAAJ,EACA;CACC,4CAA4BA,EAA5B;CACA;;CAED,uDAAWqK,UAAX,CAAsBrK,EAAtB,IAA4BzG,QAA5B;CAEA,WAAK1R,IAAL,CAAU,wBAAV,EAAoC;CAAC2rB,QAAAA,SAAS,EAAE,KAAKC,YAAL,CAAkBzT,EAAlB;CAAZ,OAApC,EAVD;CAYC;CACA;CACA;;CAEA,aAAO,KAAKyT,YAAL,CAAkBzT,EAAlB,CAAP;CACA;CAhwDF;CAAA;CAAA,oCAkwDiBA,EAlwDjB,EAkwDqBzG,QAlwDrB,EAmwDC;CACC,UAAI,CAAC,iDAAW8Q,UAAX,CAAsBrK,EAAtB,CAAL,EACA;CACC,4CAA4BA,EAA5B;CACA,OAJF;;;CAOC,uDAAWqK,UAAX,CAAsBrK,EAAtB,EAA0BsT,WAA1B,GAAwC/Z,QAAQ,CAAC+Z,WAAjD;CAEA,WAAKzrB,IAAL,CAAU,2BAAV,EAAuC;CAAC2rB,QAAAA,SAAS,EAAE,KAAKC,YAAL,CAAkBzT,EAAlB;CAAZ,OAAvC,EATD;CAWC;CACA;CACA;;CAEA,aAAO,KAAKyT,YAAL,CAAkBzT,EAAlB,CAAP;CACA;CAnxDF;CAAA;CAAA,oCAqxDiBA,EArxDjB,EAsxDC;CACC,aAAO,iDAAWqK,UAAX,CAAsBrK,EAAtB,CAAP;CAEA,aAAO,IAAP;CACA;CA1xDF;CAAA;CAAA,sCA4xDmBA,EA5xDnB,EA4xDuB3c,KA5xDvB,EA6xDC;CACC,UAAI,iDAAWgnB,UAAX,CAAsBrK,EAAtB,CAAJ,EACA;CACC,yDAAWqK,UAAX,CAAsBrK,EAAtB,EAA0B,SAA1B,IAAuC3c,KAAvC;CAEA,eAAO,IAAP;CACA;;CAED,aAAO,KAAP;CACA;CAtyDF;CAAA;CAAA,mCAyyDC;CAAA;;CACC,UAAM4mB,SAAS,GAAG,EAAlB;CAEAtJ,MAAAA,MAAM,CAACuS,IAAP,CAAY,iDAAW5I,SAAvB,EAAkC7oB,OAAlC,CAA0C,UAAAue,EAAE,EAAI;CAC/C,YAAM0T,QAAQ,GAAG/qB,EAAE,CAAC1E,KAAH,CAAS,kCAAA,OAAI,UAAJ,CAAWqmB,SAAX,CAAqBtK,EAArB,CAAT,CAAjB;CAEA0T,QAAAA,QAAQ,CAACxyB,EAAT,GAAc8e,EAAd;CACA0T,QAAAA,QAAQ,CAACla,QAAT,GAAoB,UAApB;CACAka,QAAAA,QAAQ,CAAC9Z,gBAAT,GAA4B,gBAAgBoG,EAAhB,GAAqB,GAAjD;CACA0T,QAAAA,QAAQ,CAAC/Z,UAAT,GAAsB,gBAAgBqG,EAAhB,GAAqB,GAA3C;CAEAiK,QAAAA,SAAS,CAACroB,IAAV,CAAe8xB,QAAf;CACA,OATD;CAWA,aAAOzJ,SAAP;CACA;CAxzDF;CAAA;CAAA,uCA0zDoBnN,MA1zDpB,EA0zD4B6W,UA1zD5B,EA2zDC;CACC,UAAIjZ,KAAJ;;CACA,WAAIA,KAAK,GAAG,CAAZ,EAAeA,KAAK,IAAI,IAAxB,EAA8B,EAAEA,KAAhC,EACA;CACC,YAAI,CAACiZ,UAAU,CAAC7W,MAAM,GAAGpC,KAAV,CAAf,EACA;CACC,gBADD;CAEC;CACD;;CAED,aAAOoC,MAAM,GAAGpC,KAAhB;CACA;CAt0DF;CAAA;CAAA,oCAy0DC;CACC,UAAMkN,MAAM,GAAG;CACd7N,QAAAA,QAAQ,EAAE,IAAIrX,GAAJ,EADI;CAEdmlB,QAAAA,QAAQ,EAAE,IAAInlB,GAAJ,EAFI;CAGdolB,QAAAA,QAAQ,EAAE,IAAIplB,GAAJ,EAHI;CAIdqlB,QAAAA,SAAS,EAAE,IAAIrlB,GAAJ,EAJG;CAKdslB,QAAAA,cAAc,EAAE,IAAItlB,GAAJ,EALF;CAMdulB,QAAAA,cAAc,EAAE,IAAIvlB,GAAJ,EANF;CAOdwlB,QAAAA,QAAQ,EAAE,IAAIxlB,GAAJ;CAPI,OAAf;CAUA,uDAAajB,OAAb,CAAqB,UAAA2N,KAAK,EAAI;CAC7B,YAAMwkB,WAAW,GAAGxkB,KAAK,CAACwZ,aAAN,EAApB;CAEAjI,QAAAA,MAAM,CAACuS,IAAP,CAAYtL,MAAZ,EAAoBnmB,OAApB,CAA4B,UAAA6nB,GAAG,EAAI;CAClCsK,UAAAA,WAAW,CAACtK,GAAD,CAAX,CAAiB7nB,OAAjB,CAAyB,UAAAoyB,KAAK,EAAI;CACjC,gBAAI,CAACjM,MAAM,CAAC0B,GAAD,CAAN,CAAYzmB,GAAZ,CAAgBgxB,KAAhB,CAAL,EACA;CACCjM,cAAAA,MAAM,CAAC0B,GAAD,CAAN,CAAYvmB,GAAZ,CAAgB8wB,KAAhB;CACA;CACD,WALD;CAMA,SAPD;CAQA,OAXD;CAaA,aAAOjM,MAAP;CACA;CAl2DF;CAAA;CAAA,yCAo2DsBkM,SAp2DtB,EAo2DyCC,QAp2DzC,EAq2DC;CACC,uDAAatyB,OAAb,CAAqB,UAAA2N,KAAK;CAAA,eAAIA,KAAK,CAACe,SAAN,CAAgB2jB,SAAhB,EAA2BC,QAA3B,CAAJ;CAAA,OAA1B;CAEA,aAAO,IAAP;CACA;CAz2DF;CAAA;CAAA,2CA22DwBD,SA32DxB,EA22D2CC,QA32D3C,EA42DC;CACC,uDAAatyB,OAAb,CAAqB,UAAA2N,KAAK;CAAA,eAAIA,KAAK,CAAC4kB,WAAN,CAAkBF,SAAlB,EAA6BC,QAA7B,CAAJ;CAAA,OAA1B;CAEA,aAAO,IAAP;CACA;CAh3DF;CAAA;CAAA,wCAk3DqBrpB,IAl3DrB,EAm3DC;CACC,aAAO,kDAAc8hB,eAAd,CAA8BxnB,IAA9B,CAAmC,UAAAkM,IAAI;CAAA,eAAIA,IAAI,CAAC,OAAD,CAAJ,KAAkBxG,IAAtB;CAAA,OAAvC,CAAP;CACA;CAr3DF;CAAA;CAAA,yCAw3DC;CAAA,UADmBue,eACnB,uEAD4C,EAC5C;CACC,WAAKA,eAAL,GAAuBA,eAAvB;CAEA,aAAO,IAAP;CACA;CA53DF;CAAA;CAAA,yCA+3DC;CAAA,UADmBD,eACnB,uEAD4C,EAC5C;CACC,WAAKA,eAAL,GAAuBA,eAAvB;CAEA,aAAO,IAAP;CACA;CAn4DF;CAAA;CAAA,wBAsJC;CACC,+CAAO,IAAP;CACA;CAxJF;CAAA;CAAA,wBA2JC;CACC,+CAAO,IAAP;CACA;CA7JF;CAAA;CAAA,gCAqHoBiL,WArHpB,EAqH2C7kB,KArH3C,EAqHyDwX,WArHzD,EAsHC;CACC,UAAMnB,WAAW,GAAGrW,KAAK,CAAC8kB,MAAN,CAAaD,WAAb,EAA0BrN,WAA1B,CAApB;CACAqN,MAAAA,WAAW,CAACpsB,IAAZ,CAAiB,oBAAjB,EAAuC;CAACuH,QAAAA,KAAK,EAAEqW;CAAR,OAAvC;CACA;CAzHF;CAAA;CAAA,EAA8B3Z,6BAA9B;;4CA2pCkC0kB,eACjC;CACC,MAAM2D,gBAAgB,GACrBC,mGAEEpxB,GAFF,CAEM,UAACoM,KAAD;CAAA,WACJA,KAAK,CACH4U,0BADF,GAEE7Q,MAFF,CAES,UAAAnE,KAAK;CAAA,aAAIA,KAAK,CAAC,MAAD,CAAL,KAAkB,MAAtB;CAAA,KAFd,EAGEhM,GAHF,CAGM,UAACgM,KAAD;CAAA,aAAY;CAChBgR,QAAAA,EAAE,eAAQ5Q,KAAK,CAAC7J,KAAN,EAAR,cAAyByJ,KAAK,CAAC,IAAD,CAA9B,OADc;CAEhB8E,QAAAA,KAAK,YAAK1E,KAAK,CAAC6U,QAAN,EAAL,eAA0BjV,KAAK,CAAC,MAAD,CAA/B;CAFW,OAAZ;CAAA,KAHN,CADI;CAAA,GAFN,EAWEqlB,IAXF,EADD;;CAeA,MAAI,kDAAc3hB,GAAd,CAAkB,uCAAlB,KAA8D8d,aAAlE,EACA;CACC,QAAM8D,GAAG,GAAG,KAAKvD,WAAL,CAAiBvW,iBAAO,CAACvW,KAAR,CAAcusB,aAAd,CAAjB,CAAZ;CAEA2D,IAAAA,gBAAgB,CAACvyB,IAAjB,CAAsB;CACrBoe,MAAAA,EAAE,EAAEsU,GAAG,CAAC3a,UADa;CAErB7F,MAAAA,KAAK,EAAEzN,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAFc;CAGrBiuB,MAAAA,IAAI,EAAE,CAAC,SAAD,EAAY,aAAZ,CAHe;CAIrBC,MAAAA,IAAI,EAAE;CAJe,KAAtB;CAOA,QAAMjB,KAAK,GAAG,KAAKvC,YAAL,CAAkBxW,iBAAO,CAACvW,KAAR,CAAcusB,aAAd,CAAlB,CAAd;CAEA2D,IAAAA,gBAAgB,CAACvyB,IAAjB,CAAsB;CACrBoe,MAAAA,EAAE,EAAEuT,KAAK,CAAC5Z,UADW;CAErB7F,MAAAA,KAAK,EAAEzN,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAFc;CAGrBiuB,MAAAA,IAAI,EAAE,CAAC,SAAD,EAAY,aAAZ,CAHe;CAIrBC,MAAAA,IAAI,EAAE;CAJe,KAAtB;CAMA;;CAED,SAAOL,gBAAP;CACA;;2CAE+BrsB,OAAkB2sB,WAClD;CACC,MAAMpd,QAAQ,GAAGvP,KAAK,CAACM,OAAN,GAAgBiP,QAAjC;CACA,MAAMqd,gBAAgB,GAAG5sB,KAAK,CAACM,OAAN,GAAgBssB,gBAAzC;;CAEA,MAAI3zB,cAAI,CAAC4zB,SAAL,CAAeD,gBAAf,KAAoC,CAACA,gBAAzC,EACA;CACC;CACA;;CAED,MAAME,cAAc,GACnBR,mGAC6BK,SAD7B,EAEEzxB,GAFF,CAEM,UAACoM,KAAD;CAAA,WAAY;CAChB4Q,MAAAA,EAAE,EAAE5Q,KAAK,CAAC7J,KAAN,EADY;CAEhBuO,MAAAA,KAAK,EAAE1E,KAAK,CAAC6U,QAAN,EAFS;CAGhB9c,MAAAA,QAAQ,EAAEiI,KAAK,CAAC4U,0BAAN,GAAmChhB,GAAnC,CAAuC,UAACgM,KAAD;CAAA,eAAY;CAC5DgR,UAAAA,EAAE,EAAEhR,KAAK,CAAC2K,UADkD;CAE5D7F,UAAAA,KAAK,EAAE9E,KAAK,CAACyK,IAF+C;CAG5Dob,UAAAA,UAAU,EAAE;CAAE7lB,YAAAA,KAAK,EAALA;CAAF;CAHgD,SAAZ;CAAA,OAAvC;CAHM,KAAZ;CAAA,GAFN,CADD;;CAcA,MAAI4lB,cAAc,CAACjpB,MAAf,GAAwB,CAA5B,EACA;CACC0L,IAAAA,QAAQ,CAACyd,QAAT,CAAkB,UAAlB,EAA8B;CAC7B9U,MAAAA,EAAE,EAAE,UADyB;CAE7BlM,MAAAA,KAAK,EAAEzN,aAAG,CAACC,UAAJ,CAAe,mCAAf,CAFsB;CAG7Ba,MAAAA,QAAQ,EAAEytB;CAHmB,KAA9B;CAKA;CACD;;wCAGD;CAAA,MAD2BH,SAC3B,uEAD+ClrB,SAC/C;CACC,MAAMwrB,MAAM,GAAG,CAAAN,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAElvB,KAAX,OAAsB,EAArC;CAEA,SAAO,KACLwe,MADK,CAEL5Q,MAFK,CAEE,UAAC6hB,aAAD;CAAA,WACPA,aAAa,CAACzvB,KAAd,OAA0BwvB,MAA1B,IAAoCC,aAAa,CAACC,eAAd,EAD7B;CAAA,GAFF,CAAP;CAMA;;;;;;;;;;;;;;ACnwCF,KAAa9wB,SAAb;CASC,qBAAY4W,MAAZ,EAA6Bma,KAA7B,EACA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,qDAAe,UAAf;CACA,oDAAc,EAAd;CACA,uDAAiB,QAAjB;CACA,sDAAc,EAAd;CAEA,SAAKC,WAAL,GAAmB,IAAnB;;CAEA,QAAIp0B,cAAI,CAACmD,aAAL,CAAmB6W,MAAnB,CAAJ,EACA;CACC,UAAIA,MAAM,CAAC,QAAD,CAAV,EACA;CACC,aAAKqa,SAAL,CAAera,MAAM,CAAC,QAAD,CAArB;CACA;;CACD,UAAIA,MAAM,CAAC,OAAD,CAAV,EACA;CACC,aAAKsa,QAAL,CAActa,MAAM,CAAC,OAAD,CAApB;CACA;;CACD,UAAIA,MAAM,CAAC,UAAD,CAAV,EACA;CACC,aAAKua,WAAL,CAAiBva,MAAM,CAAC,UAAD,CAAvB;CACA;;CACD,UAAI,WAAWA,MAAf,EACA;CACC,aAAKM,QAAL,CAAcN,MAAM,CAAC,OAAD,CAApB;CACA;CACD;;CACD,QAAIma,KAAJ,EACA;CACC,WAAKC,WAAL,GAAmBD,KAAnB;CACA;CACD;;CAzCF;CAAA;CAAA,4BA4CC;CACC,aAAO,IAAI/wB,SAAJ,CACN;CACCsE,QAAAA,MAAM,oCAAE,IAAF,UADP;CAECuG,QAAAA,KAAK,oCAAE,IAAF,SAFN;CAGCumB,QAAAA,QAAQ,oCAAE,IAAF,YAHT;CAIClyB,QAAAA,KAAK,oCAAE,IAAF;CAJN,OADM,EAON,KAAK8xB,WAPC,CAAP;CASA;CAtDF;CAAA;CAAA,8BAwDW1sB,MAxDX,EAyDC;CACC,UAAI1H,cAAI,CAAC6L,cAAL,CAAoBnE,MAApB,CAAJ,EACA;CACC,yDAAeA,MAAf;CACA;CACD;CA9DF;CAAA;CAAA,6BAqEUuG,KArEV,EAsEC;CACC,UAAIjO,cAAI,CAAC6L,cAAL,CAAoBoC,KAApB,CAAJ,EACA;CACC,wDAAcA,KAAd;CACA;CACD;CA3EF;CAAA;CAAA,gCAkFaumB,QAlFb,EAmFC;CACC,UAAI,CAACA,QAAL,EACA;CACCA,QAAAA,QAAQ,GAAG,GAAX;CACA;;CAED,yDAAiBA,QAAjB;CACA;CA1FF;CAAA;CAAA,6BAiGUlyB,KAjGV,EAkGC;CACC,wDAAcA,KAAd;;CACA,UAAI,uDAAmB,GAAnB,IAA0B,sDAAgB,EAA9C,EACA;CACC,2DAAiB,OAAjB;CACA,OAHD,MAIK,IAAI,uDAAmB,IAAnB,IAA2B,sDAAgB,EAA/C,EACL;CACC,2DAAiB,QAAjB;CACA;CACD;CA5GF;CAAA;CAAA,gCAoHC;CACC,aAAO;CACNoF,QAAAA,MAAM,oCAAE,IAAF,UADA;CAENuG,QAAAA,KAAK,oCAAE,IAAF,SAFC;CAGNumB,QAAAA,QAAQ,oCAAE,IAAF,YAHF;CAINlyB,QAAAA,KAAK,oCAAE,IAAF;CAJC,OAAP;CAMA;CA3HF;CAAA;CAAA,wBAiEC;CACC,+CAAO,IAAP;CACA;CAnEF;CAAA;CAAA,wBA8EC;CACC,+CAAO,IAAP;CACA;CAhFF;CAAA;CAAA,wBA6FC;CACC,+CAAO,IAAP;CACA;CA/FF;CAAA;CAAA,wBA+GC;CACC,+CAAO,IAAP;CACA;CAjHF;CAAA;CAAA;;;;;;;;;;ACCA,KAAaS,cAAb;CAwBC,0BAAYiX,MAAZ,EACA;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,qDAAajX,cAAc,CAAC6e,cAAf,CAA8B3T,KAA3C;CACA,oDAAc,EAAd;;CAEA,QAAIjO,cAAI,CAACmD,aAAL,CAAmB6W,MAAnB,CAAJ,EACA;CACC,UAAIA,MAAM,CAAC,MAAD,CAAV,EACA;CACC,yDAAaA,MAAM,CAAC,MAAD,CAAnB;CACA;;CACD,UAAIha,cAAI,CAACS,OAAL,CAAauZ,MAAM,CAAC,OAAD,CAAnB,CAAJ,EACA;CACCA,QAAAA,MAAM,CAAC,OAAD,CAAN,CAAgBtZ,OAAhB,CAAwB,UAAAyP,IAAI,EAAI;CAC/B,cAAMzL,SAAS,GAAG,IAAItB,SAAJ,CAAc+M,IAAI,CAAC,CAAD,CAAlB,EAAuB,KAAvB,CAAlB;;CACA,UAAA,KAAI,CAACskB,OAAL,CAAa/vB,SAAb,EAAwByL,IAAI,CAAC,CAAD,CAA5B;CACA,SAHD;CAIA;CACD;CACD;;CA3CF;CAAA;CAAA,4BA8CC;CACC,UAAMukB,WAAW,GAAG,IAAI3xB,cAAJ,CAAmB;CAAC4G,QAAAA,IAAI,oCAAE,IAAF;CAAL,OAAnB,CAApB;CACA,sDAAYjJ,OAAZ,CAAoB,gBAAyB;CAAA;CAAA,YAAvBgE,SAAuB;CAAA,YAAZiwB,MAAY;;CAC5C,YAAMC,eAAe,GAAGlwB,SAAS,CAACxB,KAAV,EAAxB;CACA0xB,QAAAA,eAAe,CAACR,WAAhB,GAA8BM,WAA9B;CAEAA,QAAAA,WAAW,CAACD,OAAZ,CAAoBG,eAApB,EAAqCD,MAArC;CACA,OALD;CAOA,aAAOD,WAAP;CACA;CAxDF;CAAA;CAAA,4BAkHShwB,SAlHT,EAkHoBiwB,MAlHpB,EAmHC;CACC,sDAAY9zB,IAAZ,CAAiB,CAAC6D,SAAD,EAAYiwB,MAAZ,CAAjB;CACA;CArHF;CAAA;CAAA,+BAwHC;CACC,+CAAO,IAAP;CACA;CA1HF;CAAA;CAAA,gCA6HC;CACC,UAAME,UAAU,GAAG,EAAnB;CAEA,sDAAYn0B,OAAZ,CAAoB,UAAAyP,IAAI,EAAI;CAC3B,YAAIA,IAAI,CAAClC,KAAL,KAAe,EAAnB,EACA;CACC4mB,UAAAA,UAAU,CAACh0B,IAAX,CAAgB,CAACsP,IAAI,CAAC,CAAD,CAAJ,CAAQjJ,SAAR,EAAD,EAAsBiJ,IAAI,CAAC,CAAD,CAA1B,CAAhB;CACA;CACD,OALD;CAOA,aAAO;CACNxG,QAAAA,IAAI,oCAAE,IAAF,UADE;CAENgB,QAAAA,KAAK,EAAEkqB;CAFD,OAAP;CAIA;CA3IF;CAAA;CAAA,wBA2DC;CACC,+CAAO,IAAP;CACA,KA7DF;CAAA,sBA+DUlrB,IA/DV,EAgEC;CACC,UAAIiW,MAAM,CAACxe,MAAP,CAAc2B,cAAc,CAAC6e,cAA7B,EAA6Clf,QAA7C,CAAsDiH,IAAtD,CAAJ,EACA;CACC,yDAAaA,IAAb;CACA;;CAED,aAAO,IAAP;CACA;CAvEF;CAAA;CAAA,wBA0EC;CACC,+CAAO,IAAP;CACA;CA5EF;CAAA;CAAA,mCA8EuBmN,UA9EvB,EA8EmCiF,MA9EnC,EA+EC;CACC,UAAM9F,cAAc,GAAG,IAAIlT,cAAJ,EAAvB;;CACA,UAAI,CAACgZ,MAAL,EACA;CACCA,QAAAA,MAAM,GAAG,YAAT;CACA;;CAED,UAAI/b,cAAI,CAACS,OAAL,CAAaqW,UAAU,CAACiF,MAAM,GAAG,OAAV,CAAvB,CAAJ,EACA;CACC,aAAK,IAAIjO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgJ,UAAU,CAACiF,MAAM,GAAG,OAAV,CAAV,CAA6BnR,MAAjD,EAAyD,EAAEkD,CAA3D,EACA;CACC,cAAIgJ,UAAU,CAACiF,MAAM,GAAG,OAAV,CAAV,CAA6BjO,CAA7B,MAAoC,EAAxC,EACA;CACC;CACA;;CAED,cAAMpJ,SAAS,GAAG,IAAItB,SAAJ,CAAc,EAAd,EAAkB6S,cAAlB,CAAlB;CACAvR,UAAAA,SAAS,CAAC2vB,SAAV,CAAoBvd,UAAU,CAACiF,MAAM,GAAG,QAAV,CAAV,CAA8BjO,CAA9B,CAApB;CACApJ,UAAAA,SAAS,CAAC4vB,QAAV,CAAmBxd,UAAU,CAACiF,MAAM,GAAG,OAAV,CAAV,CAA6BjO,CAA7B,CAAnB;CACApJ,UAAAA,SAAS,CAAC6vB,WAAV,CAAsBzd,UAAU,CAACiF,MAAM,GAAG,UAAV,CAAV,CAAgCjO,CAAhC,CAAtB;CACApJ,UAAAA,SAAS,CAAC4V,QAAV,CAAmBxD,UAAU,CAACiF,MAAM,GAAG,OAAV,CAAV,CAA6BjO,CAA7B,CAAnB;CAEA,cAAI6mB,MAAM,GAAG5xB,cAAc,CAAC+xB,MAAf,CAAsBC,GAAnC;;CACA,cAAIje,UAAU,CAACiF,MAAM,GAAG,QAAV,CAAV,IAAiCjF,UAAU,CAACiF,MAAM,GAAG,QAAV,CAAV,CAA8BjO,CAA9B,MAAqC/K,cAAc,CAAC+xB,MAAf,CAAsBE,EAAhG,EACA;CACCL,YAAAA,MAAM,GAAG5xB,cAAc,CAAC+xB,MAAf,CAAsBE,EAA/B;CACA;;CAED/e,UAAAA,cAAc,CAACwe,OAAf,CAAuB/vB,SAAvB,EAAkCiwB,MAAlC;CACA;CACD;;CAED,aAAO1e,cAAP;CACA;CAhHF;CAAA;CAAA;6BAAalT,kCAEY;CACvBkyB,EAAAA,KAAK,EAAE,OADgB;CAEvBpT,EAAAA,KAAK,EAAE;CAFgB;6BAFZ9e,0BAMI;CACfgyB,EAAAA,GAAG,EAAE,KADU;CAEfC,EAAAA,EAAE,EAAE,IAFW;CAIfxD,EAAAA,OAJe,mBAIP7nB,IAJO,EAKf;CACC,QAAIA,IAAI,KAAK,KAAKqrB,EAAlB,EACA;CACC,aAAO1vB,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAAP;CACA;;CAED,WAAOD,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAAP;CACA;CAZc;;;;;;;;;;;;;;;;ACJjB,KAAa2vB,iBAAb;CAiBC,6BAAYxwB,SAAZ,EAAuBuU,OAAvB,EACA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,0DAAkBvU,SAAlB;CACA,uDAAe,EAAf;CACA,qDAAe3B,iCAAc,CAAC+xB,MAAf,CAAsBC,GAArC;CACA,0DAAoB,YAApB;;CAEA,QAAI/0B,cAAI,CAACmD,aAAL,CAAmB8V,OAAnB,CAAJ,EACA;CACC,UAAIjZ,cAAI,CAACS,OAAL,CAAawY,OAAO,CAACjL,MAArB,CAAJ,EACA;CACC,2DAAeiL,OAAO,CAACjL,MAAR,CAAe/L,GAAf,CAAmB,UAAAgM,KAAK,EAAI;CAC1CA,UAAAA,KAAK,CAACwK,QAAN,GAAiB,UAAjB;CAEA,iBAAOxK,KAAP;CACA,SAJc,CAAf;CAKA;;CAED,UAAIgL,OAAO,CAAC0b,MAAR,IAAkB1b,OAAO,CAAC0b,MAAR,KAAmB5xB,iCAAc,CAAC+xB,MAAf,CAAsBE,EAA/D,EACA;CACC,yDAAejyB,iCAAc,CAAC+xB,MAAf,CAAsBE,EAArC;CACA;;CACD,UAAI/b,OAAO,CAACkc,WAAZ,EACA;CACC,8DAAoBlc,OAAO,CAACkc,WAA5B;CACA;;CAED,2DAAmBlc,OAAO,CAACqY,UAA3B;CACA;CACD;;CA9CF;CAAA;CAAA,iCAiDC;CACC,UAAM8D,mBAAmB,GAAG,KAAKC,UAAL,GAAkBpwB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACjEC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,wDAAoB,UAFpB;CAGNC,UAAAA,KAAK,EAAE,sDAAgBoF;CAHjB;CAD0D,OAApB,CAA9C;CAOA,UAAM4tB,kBAAkB,GAAG,KAAKC,SAAL,GAAiBtwB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAC/DC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,wDAAoB,SAFpB;CAGNC,UAAAA,KAAK,EAAE,sDAAgB2L;CAHjB;CADwD,OAApB,CAA5C;CAOA,UAAMunB,qBAAqB,GAAG,KAAKC,YAAL,GAAoBxwB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACrEC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,wDAAoB,YAFpB;CAGNC,UAAAA,KAAK,EAAE,sDAAgBkyB;CAHjB;CAD8D,OAApB,CAAlD;CAOA,UAAMkB,kBAAkB,GAAG,KAAKC,SAAL,GAAiB1wB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAC/DC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,wDAAoB,SAFpB;CAGNC,UAAAA,KAAK,EAAE,sDAAgBA;CAHjB;CADwD,OAApB,CAA5C;CAQA,UAAMszB,mBAAmB,GAAG,KAAKC,UAAL,GAAkB5wB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACjEC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,wDAAoB,UAFpB;CAGNC,UAAAA,KAAK,oCAAE,IAAF;CAHC;CAD0D,OAApB,CAA9C;CAQA,UAAMwuB,SAAS,GAAG,KAAKA,SAAL,GAAiB7rB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACrDC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL;CAD8C,OAAnB,CAAnC;CAMA,WAAK0wB,YAAL;CACA,WAAKC,aAAL;CAEA,UAAMC,gBAAgB,GAAG/wB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC3CC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SADoC;CAI3CiH,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KAAK,EAAE,KAAKkmB,eAAL,CAAqBxwB,IAArB,CAA0B,IAA1B;CADA;CAJmC,OAAnB,CAAzB;CASA,UAAMywB,gBAAgB,GAAGjxB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC3CC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SADoC;CAI3CC,QAAAA,IAAI,EAAEtC,iCAAc,CAAC+xB,MAAf,CAAsBtD,OAAtB,mCAA8B,IAA9B;CAJqC,OAAnB,CAAzB;CAOAhsB,MAAAA,eAAK,CAACC,IAAN,CAAWywB,gBAAX,EAA6B,OAA7B,EAAsC,KAAKC,YAAL,CAAkB1wB,IAAlB,CAAuB,IAAvB,EAA6BywB,gBAA7B,CAAtC;CAEA,WAAK3yB,IAAL,GAAY0B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC9BC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SADuB;CAE9BgB,QAAAA,QAAQ,EAAE,CACTgvB,mBADS,EAETE,kBAFS,EAGTE,qBAHS,EAITE,kBAJS,EAKTE,mBALS,EAMT9E,SANS,EAOTkF,gBAPS,EAQTE,gBARS;CAFoB,OAAnB,CAAZ;CAcA,aAAO,KAAK3yB,IAAZ;CACA;CAjIF;CAAA;CAAA,yBAmIMmB,SAnIN,EAoIC;CACC,4DAAkBA,SAAlB;CACA,WAAKoxB,YAAL;CACA,WAAKC,aAAL;CACA;CAxIF;CAAA;CAAA,mCA2IC;CACC,UAAI,CAAC,KAAKjF,SAAN,IAAmB,mCAAC,IAAD,eAAvB,EACA;CACC;CACA;;CAED7rB,MAAAA,aAAG,CAACgK,KAAJ,CAAU,KAAK6hB,SAAf;;CAEA,UAAI,sDAAgB7iB,KAAhB,KAA0B,EAA9B,EACA;CACC,YAAMA,KAAK,GAAG,KAAKmoB,QAAL,CAAc,sDAAgB1uB,MAA9B,EAAsC,sDAAgBuG,KAAtD,KAAgE,GAA9E;CACA,YAAMooB,UAAU,GACd,sDAAgB7B,QAAhB,CAAyB/sB,OAAzB,CAAiC,OAAjC,IAA4C,CAA7C,GACGG,EAAE,CAAC2O,OAAH,CAAWC,SAAX,CAAqB8f,oBAArB,CAA0CroB,KAA1C,EAAiD,sDAAgB3L,KAAjE,CADH,GAEG,IAHJ;CAMA,aAAKwuB,SAAL,CAAetqB,WAAf,CAA2BvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC7CC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADsC;CAI7CC,UAAAA,IAAI,EAAE4I,KAAK,CAACyK;CAJiC,SAAnB,CAA3B;CAMA,aAAKoY,SAAL,CAAetqB,WAAf,CAA2BvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC7CC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADsC;CAI7CC,UAAAA,IAAI,EAAE,KAAKkxB,gBAAL,CAAsB,sDAAgB/B,QAAtC;CAJuC,SAAnB,CAA3B;;CAMA,YAAI6B,UAAJ,EACA;CACC,eAAKvF,SAAL,CAAetqB,WAAf,CAA2BvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC7CC,YAAAA,KAAK,EAAE;CACNC,cAAAA,SAAS,EAAE;CADL,aADsC;CAI7CC,YAAAA,IAAI,EAAEgxB;CAJuC,WAAnB,CAA3B;CAMA;CACD,OA9BD,MAgCA;CACC,aAAKvF,SAAL,CAAetqB,WAAf,CAA2BvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC7CC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADsC;CAI7CC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,0CAAf;CAJuC,SAAnB,CAA3B;CAMA;CACD;CA3LF;CAAA;CAAA,oCA8LC;CACC,UAAI,KAAKurB,SAAT,EACA;CACCtrB,QAAAA,eAAK,CAACC,IAAN,CAAW,KAAKqrB,SAAhB,EAA2B,OAA3B,EAAoC,KAAK0F,YAAL,CAAkB/wB,IAAlB,CAAuB,IAAvB,CAApC;CACA;CACD;CAnMF;CAAA;CAAA,mCAsMC;CACC,WAAKgxB,SAAL;CACA;CAxMF;CAAA;CAAA,gCA2MC;CACC,UAAI,KAAKhkB,KAAT,EACA;CACC,aAAKA,KAAL,CAAW7F,IAAX;CACA;CACA;;CAED,UAAMoB,MAAM,GAAG,KAAK0oB,YAAL,EAAf;CAEA,UAAMC,YAAY,GAAG1xB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACxCC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENvE,UAAAA,SAAS,EAAE;CAFL;CADiC,OAApB,CAArB;CAMA,UAAMwxB,WAAW,GAAG3xB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACvCC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENvE,UAAAA,SAAS,EAAE;CAFL;CADgC,OAApB,CAApB;CAMA,UAAMyxB,gBAAgB,GAAG5xB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAC1CC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,4CADL;CAENkO,UAAAA,QAAQ,EAAE;CAFJ,SADmC;CAK1ClN,QAAAA,QAAQ,EAAE,CAACwwB,WAAD;CALgC,OAAlB,CAAzB;CAQApxB,MAAAA,eAAK,CAACC,IAAN,CACCoxB,gBADD,EAEC,OAFD,EAGC,KAAKC,oBAAL,CAA0BrxB,IAA1B,CAA+B,IAA/B,EAAqCoxB,gBAArC,EAAuDD,WAAvD,EAAoE5oB,MAApE,EAA4E2oB,YAA5E,CAHD;CAMA,UAAII,aAAa,GAAG,KAAKX,QAAL,CAAc,sDAAgB1uB,MAA9B,EAAsC,sDAAgBuG,KAAtD,CAApB;;CACA,UAAI,CAAC,sDAAgBA,KAArB,EACA;CACC8oB,QAAAA,aAAa,GAAG/oB,MAAM,CAAC,CAAD,CAAtB;CACA;;CACD4oB,MAAAA,WAAW,CAACt0B,KAAZ,GAAoBy0B,aAAa,CAAC52B,EAAlC;CACAw2B,MAAAA,YAAY,CAACr0B,KAAb,GAAqBy0B,aAAa,CAACte,QAAnC;CACAoe,MAAAA,gBAAgB,CAAC1T,WAAjB,GAA+B4T,aAAa,CAACre,IAA7C;CAEA,UAAMse,UAAU,GAAI,sDAAgBxC,QAAhB,CAAyB/sB,OAAzB,CAAiC,OAAjC,IAA4C,CAA7C,GAChB,KAAKwvB,eAAL,CAAqBF,aAArB,EAAoC,sDAAgBz0B,KAApD,CADgB,GAC6C,IADhE;CAGA,UAAM40B,YAAY,GAAGjyB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACtCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SAD+B;CAItCgB,QAAAA,QAAQ,EAAE,CAAC4wB,UAAD;CAJ4B,OAAlB,CAArB;CAOA,UAAMG,cAAc,GAAG,KAAKC,kBAAL,CAAwBL,aAAxB,EAAuCG,YAAvC,CAAvB;CACA,UAAMG,eAAe,GAAGpyB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACzCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SADkC;CAIzCgB,QAAAA,QAAQ,EAAE,CAAC+wB,cAAD;CAJ+B,OAAlB,CAAxB;;CAOA,UAAI,sDAAgBlpB,KAAhB,KAA0B,EAA9B,EACA;CACCkpB,QAAAA,cAAc,CAAC70B,KAAf,GAAuB,sDAAgBkyB,QAAvC;CACA;;CAED,UAAM7hB,IAAI,GAAG1N,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC/BC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SADwB;CAE/BgB,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACjBC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADU;CAIjBgB,UAAAA,QAAQ,EAAE,CAACywB,gBAAD;CAJO,SAAlB,CADS,EAOTQ,eAPS,EAQTH,YARS;CAFqB,OAAnB,CAAb;CAcA1xB,MAAAA,eAAK,CAACC,IAAN,CAAWmxB,WAAX,EAAwB,QAAxB,EAAkC,KAAKU,aAAL,CAAmB7xB,IAAnB,CACjC,IADiC,EAEjCmxB,WAFiC,EAGjCS,eAHiC,EAIjCH,YAJiC,EAKjCP,YALiC,CAAlC;CAQA,UAAM7mB,IAAI,GAAG,IAAb;CACA,WAAK2C,KAAL,GAAa,IAAI7K,EAAE,CAACkE,WAAP,CAAmB,8BAAnB,EAAmD,KAAKglB,SAAxD,EAAmE;CAC/E1rB,QAAAA,SAAS,EAAE,8BADoE;CAE/E4G,QAAAA,QAAQ,EAAE,KAFqE;CAG/EqB,QAAAA,UAAU,EAAE,IAHmE;CAI/EmH,QAAAA,SAAS,EAAE,KAJoE;CAK/EF,QAAAA,QAAQ,EAAE,KALqE;CAM/EhH,QAAAA,KAAK,EAAE,IANwE;CAO/EpB,QAAAA,UAAU,EAAE,EAPmE;CAQ/EyI,QAAAA,OAAO,EAAE;CAAE4iB,UAAAA,eAAe,EAAE;CAAnB,SARsE;CAS/E/qB,QAAAA,OAAO,EAAEmG,IATsE;CAU/EkC,QAAAA,OAAO,EAAE,CACR,IAAIjN,EAAE,CAACkN,iBAAP,CAAyB;CACxBzP,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,+BAAf,CADkB;CAExBH,UAAAA,SAAS,EAAE,sCAFa;CAGxBiH,UAAAA,MAAM,EAAE;CACP0D,YAAAA,KADO,mBAEP;CACC,gDAAAD,IAAI,eAAJ,CAAgBukB,SAAhB,CAA0BsC,YAAY,CAACr0B,KAAvC;CACA,gDAAAwN,IAAI,eAAJ,CAAgBwkB,QAAhB,CAAyBsC,WAAW,CAACt0B,KAArC;CACA,gDAAAwN,IAAI,eAAJ,CAAgBykB,WAAhB,CAA4B8C,eAAe,CAACG,UAAhB,CAA2Bl1B,KAAvD;CAEA,kBAAM00B,UAAU,GAAGE,YAAY,CAACrtB,aAAb,CAA2B,+CAAaiG,IAAb,kBAAiC,SAA5D,CAAnB;;CAEA,kBAAIknB,UAAJ,EACA;CACC,kDAAAlnB,IAAI,eAAJ,CAAgBwK,QAAhB,CAAyB0c,UAAU,CAAC10B,KAApC;CACA,eAHD,MAKA;CACC,kDAAAwN,IAAI,eAAJ,CAAgBwK,QAAhB,CAAyB,EAAzB;CACA;;CAEDxK,cAAAA,IAAI,CAACgmB,YAAL;CACAhmB,cAAAA,IAAI,CAAC2nB,eAAL;CACA,mBAAKpnB,WAAL,CAAiB7C,KAAjB;CACA;CArBM;CAHgB,SAAzB,CADQ,EA4BR,IAAI5F,EAAE,CAACkO,qBAAP,CAA6B;CAC5BzQ,UAAAA,IAAI,EAAGC,aAAG,CAACC,UAAJ,CAAe,uBAAf,CADqB;CAE5BH,UAAAA,SAAS,EAAG,iCAFgB;CAG5BiH,UAAAA,MAAM,EAAG;CACR0D,YAAAA,KADQ,mBAER;CACC,mBAAKM,WAAL,CAAiB7C,KAAjB;CACA;CAJO;CAHmB,SAA7B,CA5BQ,CAVsE;CAiD/EnB,QAAAA,MAAM,EAAE;CACPC,UAAAA,YADO,0BAEP;CACC,iBAAKC,OAAL;;CACA,gBAAIuD,IAAI,CAAC4nB,WAAT,EACA;CACC5nB,cAAAA,IAAI,CAAC4nB,WAAL,CAAiBnrB,OAAjB;CACA,qBAAOuD,IAAI,CAAC4nB,WAAZ;CACA;;CACD,mBAAO5nB,IAAI,CAAC2C,KAAZ;CACA;CAVM;CAjDuE,OAAnE,CAAb;CA+DA,WAAKA,KAAL,CAAW7F,IAAX;CACA;CArWF;CAAA;CAAA,yCAuWsBiqB,gBAvWtB,EAuWwCD,WAvWxC,EAuWqD5oB,MAvWrD,EAuW6D2oB,YAvW7D,EAuW2E5vB,KAvW3E,EAwWC;CACC,UAAI,CAAC,KAAK2wB,WAAV,EACA;CACC,YAAMC,aAAa,GAAGj0B,mCAAgB,EAAtC;;CACA,YAAMsK,QAAM,GAAGyL,iBAAO,CAACvW,KAAR,CACdlD,cAAI,CAAC8Z,aAAL,mCAAmB,IAAnB,kDAAmC,IAAnC,eAAkD6d,aAAa,CAAC7xB,QAAd,CAAuBuQ,SAAvB,EADpC,CAAf;;CAIA,aAAKqhB,WAAL,GAAmB,IAAIE,0CAAJ,CAA4B;CAC9C3nB,UAAAA,OAAO,EAAE,IAAIif,kCAAJ,CAAoB;CAC5BlhB,YAAAA,MAAM,EAANA,QAD4B;CAE5BohB,YAAAA,cAAc,EAAEuI,aAAa,CAAC7xB,QAAd,CAAuBiN;CAFX,WAApB,CADqC;CAK9CrO,UAAAA,SAAS,oCAAE,IAAF;CALqC,SAA5B,CAAnB;;CAQA,YAAI1E,cAAI,CAACkY,UAAL,mCAAgB,IAAhB,eAAJ,EACA;CACC,eAAKwf,WAAL,CAAiBtoB,SAAjB,CAA2B,YAA3B,oCAAyC,IAAzC;CACA;;CAED,aAAKsoB,WAAL,CAAiBtoB,SAAjB,CAA2B,QAA3B,EAAqC,UAACrI,KAAD,EAAW;CAC/C,cAAMyR,QAAQ,GAAGzR,KAAK,CAACM,OAAN,GAAgB4G,KAAjC;CACA4oB,UAAAA,gBAAgB,CAAC1T,WAAjB,GAA+B3K,QAAQ,CAACE,IAAxC;CACAke,UAAAA,WAAW,CAACt0B,KAAZ,GAAoBkW,QAAQ,CAACrY,EAA7B;CACAw2B,UAAAA,YAAY,CAACr0B,KAAb,GAAqBkW,QAAQ,CAACC,QAA9B;CACA7Q,UAAAA,EAAE,CAACiwB,SAAH,CAAajB,WAAb,EAA0B,QAA1B;CACA,SAND;CAQA,aAAKc,WAAL,CAAiB5H,QAAjB,CAA0B+G,gBAA1B;CACA;;CAED,WAAKa,WAAL,CAAiBI,QAAjB,CAA0B/wB,KAA1B;CACA;CAzYF;CAAA;CAAA,sCA4YC;CACC,4CAAI,IAAJ,iBACA;CACC,YAAI,KAAKsuB,UAAT,EACA;CACC,eAAKA,UAAL,CAAgB/yB,KAAhB,GAAwB,sDAAgBoF,MAAxC;CACA;;CACD,YAAI,KAAK6tB,SAAT,EACA;CACC,eAAKA,SAAL,CAAejzB,KAAf,GAAuB,sDAAgB2L,KAAvC;CACA;;CACD,YAAI,KAAKwnB,YAAT,EACA;CACC,eAAKA,YAAL,CAAkBnzB,KAAlB,GAA0B,sDAAgBkyB,QAA1C;CACA;;CACD,YAAI,KAAKmB,SAAT,EACA;CACC,eAAKA,SAAL,CAAerzB,KAAf,GAAuB,sDAAgBA,KAAvC;CACA;CACD;CACD;CAhaF;CAAA;CAAA,kCAkaekgB,UAlaf,EAkaiCuV,gBAlajC,EAkayDb,YAlazD,EAka6EP,YAla7E,EAmaC;CACC,UAAM1oB,KAAK,GAAG,KAAKmoB,QAAL,CAAcO,YAAY,CAACr0B,KAA3B,EAAkCkgB,UAAU,CAAClgB,KAA7C,CAAd;CACA,UAAMmzB,YAAY,GAAG,KAAK2B,kBAAL,CAAwBnpB,KAAxB,EAA+BipB,YAA/B,CAArB;CACAa,MAAAA,gBAAgB,CAACt0B,YAAjB,CAA8BgyB,YAA9B,EAA4CsC,gBAAgB,CAACP,UAA7D;CACA,WAAKQ,gBAAL,CAAsBvC,YAAtB,EAAoCxnB,KAApC,EAA2CipB,YAA3C;CACA;CAxaF;CAAA;CAAA,qCA0akB1U,UA1alB,EA0aoCvU,KA1apC,EA0amDipB,YA1anD,EA2aC;CACCjyB,MAAAA,aAAG,CAACgK,KAAJ,CAAUioB,YAAV;;CAEA,UAAI1U,UAAU,CAAClgB,KAAX,CAAiBmF,OAAjB,CAAyB,OAAzB,IAAoC,CAAxC,EACA;CACC,YAAMkuB,SAAS,GAAG,KAAKsB,eAAL,CAAqBhpB,KAArB,CAAlB;CACAipB,QAAAA,YAAY,CAAC1wB,WAAb,CAAyBmvB,SAAzB;CACA;CACD,KAnbF;;CAAA;CAAA;CAAA,6BAsbUjuB,MAtbV,EAsbkBuX,EAtblB,EAubC;CACC,UAAIhR,KAAJ;CACA,UAAMI,KAAK,GAAGH,2BAAQ,CAACqE,WAAT,GAAuBlE,KAArC;CACA,UAAM4pB,SAAS,GAAG/pB,2BAAQ,CAACqE,WAAT,GAAuB0lB,SAAzC;CACA,UAAMC,GAAG,GAAG7pB,KAAK,GAAEA,KAAK,CAAC8pB,WAAN,EAAF,GAAwB,IAAzC;;CAEA,cAAQzwB,MAAR;CAEC,aAAK,UAAL;CACC,eAAK,IAAIoG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,mDAAalD,MAAjC,EAAyC,EAAEkD,CAA3C,EACA;CACC,gBAAImR,EAAE,KAAK,mDAAanR,CAAb,EAAgB3N,EAA3B,EACA;CACC8N,cAAAA,KAAK,GAAG,mDAAaH,CAAb,CAAR;CACA;CACD;;CACD;;CACD,aAAK,UAAL;CACC,cAAIoqB,GAAG,IAAID,SAAP,IAAoBA,SAAS,CAAC5jB,cAAlC,EACA;CACCpG,YAAAA,KAAK,GAAGgqB,SAAS,CAAC5jB,cAAV,CAAyBqU,iBAAzB,CAA2CwP,GAAG,CAAClyB,WAAJ,EAA3C,EAA8DiZ,EAA9D,CAAR;CACA;;CACD;;CACD,aAAK,UAAL;CACC,cAAIiZ,GAAJ,EACA;CACCjqB,YAAAA,KAAK,GAAGiqB,GAAG,CAAC5F,WAAJ,CAAgBrT,EAAhB,CAAR;CACA;;CACD;;CACD,aAAK,aAAL;CACC,cAAIgZ,SAAJ,EACA;CACChqB,YAAAA,KAAK,GAAGgqB,SAAS,CAAC3F,WAAV,CAAsBrT,EAAtB,CAAR;CACA;;CACD;;CACD,aAAK,WAAL;CACC,cAAIgZ,SAAJ,EACA;CACChqB,YAAAA,KAAK,GAAGgqB,SAAS,CAACG,YAAV,CAAuBnZ,EAAvB,CAAR;CACA;;CACD;;CACD;CACC,cAAIoZ,UAAU,GAAGH,GAAG,GAAEA,GAAG,CAACzP,YAAJ,CAAiB/gB,MAAjB,CAAF,GAA6B,IAAjD;;CACA,cAAI2wB,UAAJ,EACA;CACCpqB,YAAAA,KAAK,GAAGoqB,UAAU,CAAC3P,iBAAX,CAA6BzJ,EAA7B,CAAR;CACA;;CACD;CAzCF;;CA4CA,aAAOhR,KAAK,IAAI;CACf9N,QAAAA,EAAE,EAAE8e,EADW;CAEfxG,QAAAA,QAAQ,EAAE/Q,MAFK;CAGfgR,QAAAA,IAAI,EAAEuG,EAHS;CAIfjf,QAAAA,IAAI,EAAE,QAJS;CAKf4Y,QAAAA,UAAU,EAAEqG,EALG;CAMfpG,QAAAA,gBAAgB,EAAE,OAAKnR,MAAL,GAAY,GAAZ,GAAgBuX,EAAhB,GAAmB;CANtB,OAAhB;CAQA;CAjfF;CAAA;CAAA,iCAmfcqZ,SAnfd,EAmfyBC,QAnfzB,EAofC;CACC,UAAIC,IAAI,GAAG;CACV,kBAAUlzB,aAAG,CAACC,UAAJ,CAAe,8CAAf,CADA;CAEV,iBAASD,aAAG,CAACC,UAAJ,CAAe,0CAAf,CAFC;CAGV,aAAKD,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAHK;CAIV,cAAMD,aAAG,CAACC,UAAJ,CAAe,uCAAf;CAJI,OAAX;;CAMA,cAAQ+yB,SAAR;CAEC,aAAK,MAAL;CACA,aAAK,QAAL;CACA,aAAK,oBAAL;CACCE,UAAAA,IAAI,GAAG;CACN,sBAAUlzB,aAAG,CAACC,UAAJ,CAAe,8CAAf,CADJ;CAEN,qBAASD,aAAG,CAACC,UAAJ,CAAe,0CAAf;CAFH,WAAP;CAIA;;CACD,aAAK,MAAL;CACA,aAAK,QAAL;CACC,cAAIgzB,QAAJ,EACA;CACCC,YAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkBlzB,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAAlB;CACAizB,YAAAA,IAAI,CAAC,UAAD,CAAJ,GAAmBlzB,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAAnB;CACA,WAJD;;CAUA;;CACD,aAAK,MAAL;CACCizB,UAAAA,IAAI,CAAC,IAAD,CAAJ,GAAalzB,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAAb;CACAizB,UAAAA,IAAI,CAAC,KAAD,CAAJ,GAAclzB,aAAG,CAACC,UAAJ,CAAe,2CAAf,CAAd;CACAizB,UAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkBlzB,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAAlB;CACAizB,UAAAA,IAAI,CAAC,UAAD,CAAJ,GAAmBlzB,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAAnB;CACA;;CACD;CACCizB,UAAAA,IAAI,CAAC,IAAD,CAAJ,GAAalzB,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAAb;CACAizB,UAAAA,IAAI,CAAC,KAAD,CAAJ,GAAclzB,aAAG,CAACC,UAAJ,CAAe,2CAAf,CAAd;CACAizB,UAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkBlzB,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAAlB;CACAizB,UAAAA,IAAI,CAAC,UAAD,CAAJ,GAAmBlzB,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAAnB;CACAizB,UAAAA,IAAI,CAAC,GAAD,CAAJ,GAAYlzB,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAAZ;CACAizB,UAAAA,IAAI,CAAC,IAAD,CAAJ,GAAalzB,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAAb;CACAizB,UAAAA,IAAI,CAAC,GAAD,CAAJ,GAAYlzB,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAAZ;CACAizB,UAAAA,IAAI,CAAC,IAAD,CAAJ,GAAalzB,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAAb;CArCF;;CAwCA,aAAOizB,IAAP;CACA;CApiBF;CAAA;CAAA,qCAsiBkBvZ,EAtiBlB,EAuiBC;CACC,aAAO,KAAKwZ,YAAL,GAAoBxZ,EAApB,CAAP;CACA;CAziBF;CAAA;CAAA,mCA4iBC;CACC,UAAMyZ,QAAQ,GAAG,EAAjB;;CACA,WAAK,IAAI5qB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,mDAAalD,MAAjC,EAAyC,EAAEkD,CAA3C,EACA;CACC,YAAMnE,IAAI,GAAG,mDAAamE,CAAb,EAAgB,MAAhB,CAAb;;CAEA,YACCnE,IAAI,KAAK,MAAT,IACGA,IAAI,KAAK,MADZ,IAEGA,IAAI,KAAK,UAFZ,IAGGA,IAAI,KAAK,QAHZ,IAIGA,IAAI,KAAK,MAJZ,IAKGA,IAAI,KAAK,KALZ,IAMGA,IAAI,KAAK,QANZ,IAOGA,IAAI,KAAK,QAPZ,IAQGA,IAAI,KAAK,MARZ,IASGA,IAAI,KAAK,MATZ,IAUGA,IAAI,KAAK,UAVZ,IAWGA,IAAI,KAAK,QAXZ,IAYGA,IAAI,KAAK,oBAZZ,IAaGA,IAAI,KAAK,QAdb,EAgBA;CACC+uB,UAAAA,QAAQ,CAAC73B,IAAT,CAAc,mDAAaiN,CAAb,CAAd;CACA,SAlBD;CAuBA;;CAED,aAAO4qB,QAAP;CACA;CA5kBF;CAAA;CAAA,oCA8kBiBC,QA9kBjB,EA8kB2Br2B,KA9kB3B,EA+kBC;CACC,UAAMs2B,OAAO,GACZ1qB,2BAAQ,CAACqE,WAAT,GAAuB0lB,SAAvB,GACG/pB,2BAAQ,CAACqE,WAAT,GAAuB0lB,SAAvB,CAAiCnyB,QAAjC,CAA0CiO,UAA1C,EADH,GAEGrQ,mCAAgB,GAAGoC,QAAnB,CAA4BiO,UAA5B,EAHJ;CAKA,UAAM9F,KAAK,GAAGrG,EAAE,CAAC1E,KAAH,CAASy1B,QAAT,CAAd;CACA1qB,MAAAA,KAAK,CAAC4qB,QAAN,GAAiB,KAAjB;CAEA,aAAOjxB,EAAE,CAAC2O,OAAH,CAAWC,SAAX,CAAqBC,aAArB,CACNmiB,OADM,EAEN3qB,KAFM,EAGN,wDAAoB,OAHd,EAIN3L,KAJM,CAAP;CAMA;CA9lBF;CAAA;CAAA,uCAgmBoB2L,KAhmBpB,EAgmB2BipB,YAhmB3B,EAimBC;CACC,UAAM3jB,MAAM,GAAGtO,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACnCC,QAAAA,KAAK,EAAE;CAACC,UAAAA,SAAS,EAAE;CAAZ;CAD4B,OAArB,CAAf;CAIA,UAAM0zB,YAAY,GAAG,KAAKL,YAAL,CAAkBxqB,KAAK,CAAC,MAAD,CAAvB,EAAiCA,KAAK,CAAC,UAAD,CAAtC,CAArB;;CACA,WAAK,IAAI8qB,UAAT,IAAuBD,YAAvB,EACA;CACC,YAAI,CAACA,YAAY,CAACt2B,cAAb,CAA4Bu2B,UAA5B,CAAL,EACA;CACC;CACA;;CAEDxlB,QAAAA,MAAM,CAAC/M,WAAP,CAAmBvB,aAAG,CAACC,MAAJ,CAAW,QAAX,EAAqB;CACvC0N,UAAAA,KAAK,EAAE;CAACtQ,YAAAA,KAAK,EAAEy2B;CAAR,WADgC;CAEvC1zB,UAAAA,IAAI,EAAEyzB,YAAY,CAACC,UAAD;CAFqB,SAArB,CAAnB;CAIA;;CAEDvzB,MAAAA,eAAK,CAACC,IAAN,CAAW8N,MAAX,EAAmB,QAAnB,EAA6B,KAAKykB,gBAAL,CAAsBvyB,IAAtB,CAC5B,IAD4B,EAE5B8N,MAF4B,EAG5BtF,KAH4B,EAI5BipB,YAJ4B,CAA7B;CAOA,aAAO3jB,MAAP;CACA;CA5nBF;CAAA;CAAA,oCA8nBiBxM,KA9nBjB,EA+nBC;CACC,4DAAkB,IAAlB;CACA9B,MAAAA,aAAG,CAACyE,MAAJ,CAAW,KAAKnG,IAAhB;CACA,WAAKutB,SAAL,GAAiB,KAAKyE,SAAL,GAAiB,KAAKE,YAAL,GAAoB,KAAKE,SAAL,GAAiB,KAAKpyB,IAAL,GAAY,IAAnF;CAEAwD,MAAAA,KAAK,CAACC,eAAN;CACA;CAroBF;CAAA;CAAA,iCAuoBcgyB,GAvoBd,EAuoB4BjyB,KAvoB5B,EAwoBC;CACC,uDAAgB,qDAAiBhE,iCAAc,CAAC+xB,MAAf,CAAsBE,EAAvC,GAA4CjyB,iCAAc,CAAC+xB,MAAf,CAAsBC,GAAlE,GAAwEhyB,iCAAc,CAAC+xB,MAAf,CAAsBE,EAA9G;CACAgE,MAAAA,GAAG,CAAC7V,WAAJ,GAAkBpgB,iCAAc,CAAC+xB,MAAf,CAAsBtD,OAAtB,mCAA8B,IAA9B,WAAlB;;CAEA,UAAI,KAAKqE,UAAT,EACA;CACC,aAAKA,UAAL,CAAgBvzB,KAAhB,qCAAwB,IAAxB;CACA;;CAEDyE,MAAAA,KAAK,CAACie,cAAN;CACA;CAlpBF;CAAA;CAAA,8BAqpBC;CACC,UAAI,KAAKvS,KAAT,EACA;CACC,aAAKA,KAAL,CAAWjF,KAAX;CACA;CACD;CA1pBF;CAAA;CAAA;;;;;;;;;;;;;;;;ACEA,KAAa4I,sBAAb;CAQC,kCAAYH,cAAZ,EAA4CgD,OAA5C,EACA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,6DAAuBhD,cAAvB;CACA,uDAAe,EAAf;CACA,4DAAoB,YAApB;CACA,4DAAsB,EAAtB;;CAEA,QAAIjW,cAAI,CAACmD,aAAL,CAAmB8V,OAAnB,CAAJ,EACA;CACC,UAAIjZ,cAAI,CAACS,OAAL,CAAawY,OAAO,CAACjL,MAArB,CAAJ,EACA;CACC,2DAAeiL,OAAO,CAACjL,MAAvB;CACA;;CACD,UAAIiL,OAAO,CAACkc,WAAZ,EACA;CACC,gEAAoBlc,OAAO,CAACkc,WAA5B;CACA;;CAED,6DAAmBlc,OAAO,CAACqY,UAA3B;CACA;CACD;;CA5BF;CAAA;CAAA,iCA+BC;CACC,UAAMtD,EAAE,GAAG,IAAX;CACA,UAAMiL,cAAc,GAAG,EAAvB;CACA,UAAMjrB,MAAM,qCAAG,IAAH,YAAZ;CAEA,+DAAqBkrB,QAArB,GAAgCx4B,OAAhC,CAAwC,UAASyP,IAAT,EACxC;CACC,YAAMgG,iBAAiB,GAAG,IAAI+e,iBAAJ,CAAsB/kB,IAAI,CAAC,CAAD,CAA1B,EAA+B;CACxDnC,UAAAA,MAAM,EAAEA,MADgD;CAExD2mB,UAAAA,MAAM,EAAExkB,IAAI,CAAC,CAAD,CAF4C;CAGxDglB,UAAAA,WAAW,oCAAEnH,EAAF,iBAH6C;CAIxDsD,UAAAA,UAAU,oCAAE,IAAF;CAJ8C,SAA/B,CAA1B;CAOA,gEAAoBzwB,IAApB,CAAyBsV,iBAAzB;CACA8iB,QAAAA,cAAc,CAACp4B,IAAf,CAAoBsV,iBAAiB,CAAC7S,UAAlB,EAApB;CACA,OAXD,EAWG,IAXH;CAaA21B,MAAAA,cAAc,CAACp4B,IAAf,CAAoBoE,aAAG,CAACC,MAAJ,CAAW,GAAX,EAAgB;CACnCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD4B;CAEnCC,QAAAA,IAAI,EAAE,KAF6B;CAGnCgH,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KADO,mBAEP;CACCie,YAAAA,EAAE,CAACyG,OAAH,CAAW,IAAX;CACA;CAJM;CAH2B,OAAhB,CAApB;CAWA,aAAOxvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACzBC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SADkB;CAEzBgB,QAAAA,QAAQ,EAAE6yB;CAFe,OAAnB,CAAP;CAIA;CAhEF;CAAA;CAAA,4BAkESrK,UAlET,EAmEC;CACC,UAAMzY,iBAAiB,GAAG,IAAI+e,iBAAJ,CAAsB,IAAI9xB,4BAAJ,CAAc,EAAd,oCAAkB,IAAlB,mBAAtB,EAA+D;CACxF4K,QAAAA,MAAM,oCAAE,IAAF,YADkF;CAExFmnB,QAAAA,WAAW,oCAAE,IAAF,iBAF6E;CAGxF7D,QAAAA,UAAU,oCAAE,IAAF;CAH8E,OAA/D,CAA1B;CAKA,8DAAoBzwB,IAApB,CAAyBsV,iBAAzB;CAEAyY,MAAAA,UAAU,CAACprB,UAAX,CAAsB8G,YAAtB,CAAmC6L,iBAAiB,CAAC7S,UAAlB,EAAnC,EAAmEsrB,UAAnE;CACA;CA5EF;CAAA;CAAA,8BA+EC;CACC,8DAAoBluB,OAApB,CAA4B,UAAA4V,QAAQ;CAAA,eAAIA,QAAQ,CAAC/J,OAAT,EAAJ;CAAA,OAApC;CACA,8DAAsB,EAAtB;CACA;CAlFF;CAAA;CAAA;;KCEa4sB,OAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,yCAS6BphB,IAT7B,EAS2CqhB,aAT3C,EAUC;CACC,UAAIrhB,IAAI,KAAK,KAAKyX,kBAAlB,EACA;CACC,eAAO,IAAIxX,+BAAJ,CAAiBohB,aAAjB,CAAP;CACA,OAHD,MAIK,IAAIrhB,IAAI,KAAK,KAAK4X,kBAAlB,EACL;CACC,eAAO,IAAI0J,+BAAJ,CAAiBD,aAAjB,CAAP;CACA,OAHI,MAIA,IAAIrhB,IAAI,KAAK,KAAKuhB,oBAAlB,EACL;CACC,eAAO,IAAIC,iCAAJ,CAAmBH,aAAnB,CAAP;CACA,OAHI,MAIA,IAAIrhB,IAAI,KAAK,KAAKyhB,yBAAlB,EACL;CACC,eAAO,IAAIC,qCAAJ,CAAuBL,aAAvB,CAAP;CACA,OAHI,MAIA,IAAIrhB,IAAI,KAAK,KAAK2hB,kBAAlB,EACL;CACC,eAAO,IAAIC,+BAAJ,CAAiBP,aAAjB,CAAP;CACA,OAHI,MAIA,IAAIrhB,IAAI,KAAK,KAAK8X,wBAAlB,EACL;CACC,eAAO,IAAI+J,oCAAJ,CAAsBR,aAAtB,CAAP;CACA,OAHI,MAKL;CACC,eAAO5wB,SAAP;CACA;CACD;CAvCF;CAAA;CAAA;6BAAa2wB,+BAEgB;6BAFhBA,+BAGgB;6BAHhBA,iCAIkB;6BAJlBA,sCAKuB;6BALvBA,+BAMgB;6BANhBA,qCAOsB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRnC,KAAaI,cAAb;CAAA;;CAYC,0BAAY3mB,KAAZ,EACA;CAAA;;CAAA;CACC;;CADD;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA,4FAVwB,IAUxB;CAAA,6FAT0B,KAS1B;CAAA,yFAR+B,IAQ/B;CAAA,0FAP4B,IAO5B;;CAAA;CAAA;CAAA,aAN6C;CAM7C;;CAAA,0FAL6B,EAK7B;;CAAA;CAAA;CAAA,aAJmB;CAInB;;CAAA;CAAA;CAAA,aAHyB;CAGzB;;CAEC,UAAK/P,iBAAL,CAAuB,gCAAvB;;CAEA,UAAKoN,OAAL,GAAe2C,KAAK,CAAC3C,OAArB;CACA,UAAKiL,WAAL,GAAmB,MAAKjL,OAAL,CAAajC,MAAhC;CALD;CAMC;;CAnBF;CAAA;CAAA,6BAqBU6rB,OArBV,EAsBC;CACC,aAAO,qDAAiBr3B,cAAjB,CAAgCq3B,OAAhC,CAAP;CACA;CAxBF;CAAA;CAAA,6BA0BUA,OA1BV,EA0B2B1F,KA1B3B,EA2BC;CACC,2DAAiB0F,OAAjB,6BAA4B,IAA5B,0CAA4B,IAA5B,EAAiD1F,KAAjD;CACA;CA7BF;CAAA;CAAA,iCA+Bc0F,OA/Bd,EA+B+B1pB,IA/B/B,EAgCC;CACC,UAAI,KAAK2pB,QAAL,CAAcD,OAAd,CAAJ,EACA;CACC,6DAAiBA,OAAjB,EAA0BzzB,QAA1B,CAAmCvF,IAAnC,0BAAwC,IAAxC,0CAAwC,IAAxC,EAA6DsP,IAA7D;CACA;CACD;CArCF;CAAA;CAAA,+BA4DY4pB,WA5DZ,EA6DC;CACC,WAAKA,WAAL,GAAmBtgB,iBAAO,CAACvW,KAAR,CAAc62B,WAAd,CAAnB;CACA,WAAKA,WAAL,CAAiB3W,YAAjB,CAA8B,cAA9B,EAA8C,KAA9C;CAEA,WAAK4W,UAAL,GAAkBC,aAAG,CAACC,MAAtB,0MAEa,KAAKpC,QAAL,CAAcryB,IAAd,CAAmB,IAAnB,CAFb;CAOA,WAAK00B,qBAAL;CAEA,WAAKC,cAAL,IAAwB,KAAKL,WAAL,CAAiBnwB,YAAjB,CAA8B,kBAA9B,MAAsD,SAA9E;CAEA,aAAOqwB,aAAG,CAACC,MAAX,2LAEI,KAAKH,WAFT,EAGI,KAAKC,UAHT;CAMA;CAlFF;CAAA;CAAA,6BAoFUD,WApFV,EAqFC;CACCA,MAAAA,WAAW,CAACv2B,UAAZ,CAAuBC,YAAvB,CAAoC,KAAK42B,UAAL,CAAgBN,WAAhB,CAApC,EAAkEA,WAAlE;CACA;CAvFF;CAAA;CAAA,uCA0FC;CACCv0B,MAAAA,eAAK,CAACC,IAAN,CAAW,KAAKs0B,WAAhB,EAA6B,SAA7B,EAAwC1G,wDAAgB5tB,IAAhB,CAAqB,IAArB,CAAxC;CACA;CA5FF;CAAA;CAAA,4CA+FC;CACC,WAAKgqB,aAAL,GAAqB7hB,IAAI,CAAC8hB,KAAL,CAAW,KAAKqK,WAAL,CAAiBnwB,YAAjB,CAA8B,eAA9B,CAAX,CAArB;CACA,UAAM0wB,YAAY,GAAG,KAAKP,WAAL,CAAiBnwB,YAAjB,CAA8B,oBAA9B,CAArB;;CAEA,UAAI,CAAC,KAAK6lB,aAAN,IAAuB6K,YAA3B,EACA;CACC,aAAK7K,aAAL,GAAqB;CAACzvB,UAAAA,IAAI,EAAEs6B;CAAP,SAArB;CACA;;CAED,UAAI,KAAK7K,aAAT,EACA;CACC,aAAKA,aAAL,CAAmBzvB,IAAnB,GAA0B,KAAKyvB,aAAL,CAAmBzvB,IAAnB,IAA2Bs6B,YAArD;;CACA;CACA,OAJD,MAMA;CACC,aAAKrqB,OAAL,CAAakf,eAAb,GAA+B,KAA/B;CACA;;CAED,WAAKiL,cAAL,IAAwB,KAAKL,WAAL,CAAiBnwB,YAAjB,CAA8B,kBAA9B,MAAsD,SAA9E;CACA;CAnHF;CAAA;CAAA,6BA2KU7C,KA3KV,EA4KC;CAAA;;CAAA,UAD+BwzB,sBAC/B,uEADiE,KACjE;;CACC,UAAI,CAACA,sBAAD,IAA2B,KAAKtqB,OAAL,CAAakf,eAAxC,IAA2D,CAAC,KAAK4K,WAAL,CAAiBz3B,KAAjF,EACA;CACC,eAAO,KAAKk4B,0BAAL,EAAP;CACA;;CAED,4CAAI,IAAJ,YACA;CACC,yDAAa5tB,IAAb;CACA;CACA;;CAED,WAAK6tB,UAAL;CACA,WAAKC,UAAL;CAEA,UAAIpqB,SAAS,GAAG,EAAhB;;CACA,wCAAoBsP,MAAM,CAACxe,MAAP,mCAAc,IAAd,eAApB,oCACA;CADK,YAAM+yB,KAAK,qBAAX;;CAEJ,YAAIA,KAAK,CAAC/tB,QAAN,CAAewE,MAAf,GAAwB,CAA5B,EACA;CACC0F,UAAAA,SAAS,CAACzP,IAAV,CAAeszB,KAAf;CACA;CACD;;CAED,UAAI7jB,SAAS,CAAC1F,MAAV,KAAqB,CAAzB,EACA;CACC0F,QAAAA,SAAS,GAAGA,SAAS,CAAC,CAAD,CAAT,CAAalK,QAAzB;CACA;;CAED,UAAI4lB,MAAM,GAAG,KAAKgO,UAAL,CAAgBpwB,YAAhB,CAA6B,kBAA7B,CAAb;;CACA,UAAI,CAACoiB,MAAL,EACA;CACCA,QAAAA,MAAM,GAAGre,yBAAM,CAACkD,gBAAP,EAAT;CACA,aAAKmpB,UAAL,CAAgB5W,YAAhB,CAA6B,kBAA7B,EAAiD4I,MAAjD;CACA;;CAED,uDAAe,IAAI2O,wBAAJ,CAAW;CACzBhY,QAAAA,UAAU,EAAE,KAAKqX,UADQ;CAEzB7wB,QAAAA,KAAK,EAAE,GAFkB;CAGzBiE,QAAAA,MAAM,EAAE,GAHiB;CAIzBmrB,QAAAA,QAAQ,EAAE,KAJe;CAKzBqC,QAAAA,YAAY,EAAE,IALW;CAMzBC,QAAAA,YAAY,EAAE,IANW;CAOzBlwB,QAAAA,KAAK,EAAE,KAAKmwB,sBAAL,CAA4BxqB,SAA5B,CAPkB;CAQzByqB,QAAAA,WAAW,EAAE,KARY;CASzB1uB,QAAAA,MAAM,EAAE;CACP,iCAAuB,4BAACtF,KAAD,EAAW;CACjCA,YAAAA,KAAK,CAACie,cAAN;CAEA,gBAAM7U,IAAI,GAAGpJ,KAAK,CAACM,OAAN,GAAgB8I,IAA7B;;CACA,YAAA,MAAI,CAAC4f,aAAL,CAAmB5f,IAAI,CAAC6qB,aAAL,GAAqBrpB,GAArB,CAAyB,OAAzB,CAAnB;CACA;CANM,SATiB;CAiBzBspB,QAAAA,WAAW,EAAE;CAjBY,OAAX,CAAf;CAoBA,uDAAaruB,IAAb;CACA;CArOF;CAAA;CAAA,iCAwOC;CACC,WAAKsuB,gBAAL;CACA,WAAKC,aAAL;CACA;CA3OF;CAAA;CAAA,uCA8OC;CAAA;;CACC,WAAKpH,QAAL,CAAc,MAAd,EAAsB;CACrB9U,QAAAA,EAAE,EAAE,MADiB;CAErBlM,QAAAA,KAAK,EAAE,KAAK9C,OAAL,CAAamf,cAFC;CAGrBgM,QAAAA,UAAU,EAAE;CAHS,OAAtB;CAMA,WAAK/kB,SAAL,GAAiB3V,OAAjB,CAAyB,UAACuN,KAAD,EAAW;CACnC,YAAIotB,QAAQ,GAAGptB,KAAK,CAAC9N,EAAN,CAASsH,OAAT,CAAiB,GAAjB,IAAwB,CAAxB,GAA4B,MAA5B,GAAqCwG,KAAK,CAAC9N,EAAN,CAAS0c,KAAT,CAAe,GAAf,EAAoB,CAApB,CAApD;CACA,YAAIye,SAAS,GAAG,EAAhB;;CAEA,YAAIrtB,KAAK,CAACyK,IAAN,IAAc2iB,QAAQ,KAAK,MAA3B,IAAqCptB,KAAK,CAACyK,IAAN,CAAWjR,OAAX,CAAmB,IAAnB,KAA4B,CAArE,EACA;CACC,cAAM8zB,KAAK,GAAGttB,KAAK,CAACyK,IAAN,CAAWmE,KAAX,CAAiB,IAAjB,CAAd;CACAye,UAAAA,SAAS,GAAGC,KAAK,CAACC,KAAN,EAAZ;CACAvtB,UAAAA,KAAK,CAACyK,IAAN,GAAa6iB,KAAK,CAACtX,IAAN,CAAW,IAAX,CAAb;CACA;;CAED,YACChW,KAAK,CAAC,IAAD,CAAL,CAAYxG,OAAZ,CAAoB,cAApB,MAAwC,CAAxC,IACGwG,KAAK,CAAC,IAAD,CAAL,KAAgB,gBADnB,IAEGA,KAAK,CAAC,IAAD,CAAL,KAAgB,uBAHpB,EAKA;CACCotB,UAAAA,QAAQ,GAAG,aAAX;;CACA,cAAME,MAAK,GAAGttB,KAAK,CAACyK,IAAN,CAAWmE,KAAX,CAAiB,GAAjB,CAAd;;CACAye,UAAAA,SAAS,GAAGC,MAAK,CAACC,KAAN,EAAZ;CACAvtB,UAAAA,KAAK,CAACyK,IAAN,GAAa6iB,MAAK,CAACtX,IAAN,CAAW,GAAX,EAAgBnQ,OAAhB,CAAwB,GAAxB,EAA6B,EAA7B,EAAiCA,OAAjC,CAAyC,GAAzC,EAA8C,EAA9C,CAAb;CACA;;CAED,YAAI,CAAC,MAAI,CAACgmB,QAAL,CAAcuB,QAAd,CAAL,EACA;CACC,UAAA,MAAI,CAACtH,QAAL,CAAcsH,QAAd,EAAwB;CACvBpc,YAAAA,EAAE,EAAEoc,QADmB;CAEvBtoB,YAAAA,KAAK,EAAEuoB,SAFgB;CAGvBF,YAAAA,UAAU,EAAE;CAHW,WAAxB;CAKA;;CAED,QAAA,MAAI,CAACK,YAAL,CAAkBJ,QAAlB,EAA4B;CAC3Bpc,UAAAA,EAAE,EAAEhR,KAAK,CAAC4K,gBADiB;CAE3B9F,UAAAA,KAAK,EAAE9E,KAAK,CAACyK,IAAN,IAAczK,KAAK,CAAC9N,EAFA;CAG3B2zB,UAAAA,UAAU,EAAE;CAAC7lB,YAAAA,KAAK,EAALA;CAAD;CAHe,SAA5B;CAKA,OArCD;CAsCA;CA3RF;CAAA;CAAA,oCA8RC;CACC,UAAMytB,UAAU,GAAG,KAAKrlB,SAAL,GAAiBjE,MAAjB,CAAwB,UAACnE,KAAD;CAAA,eAAWA,KAAK,CAACjO,IAAN,KAAe,MAA1B;CAAA,OAAxB,CAAnB;;CAEA,UAAI07B,UAAU,CAAC9wB,MAAX,GAAoB,CAAxB,EACA;CACC,aAAKmpB,QAAL,CAAc,SAAd,EAAyB;CACxB9U,UAAAA,EAAE,EAAE,SADoB;CAExBlM,UAAAA,KAAK,EAAEzN,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAFiB;CAGxBa,UAAAA,QAAQ,2BAAE,IAAF,8CAAE,IAAF,EAAyBs1B,UAAzB,CAHgB;CAIxBN,UAAAA,UAAU,EAAE;CAJY,SAAzB;CAMA;CACD;CA1SF;CAAA;CAAA,iCA8UC;CACC,WAAKt0B,IAAL,CAAU,YAAV,EAAwB;CAAEwP,QAAAA,QAAQ,EAAE;CAAZ,OAAxB;CACA;CAhVF;CAAA;CAAA,iDAmVC;CACC,UAAMxG,IAAI,GAAG,IAAb;CAEAc,MAAAA,sBAAW,CAAChE,IAAZ,CACCe,yBAAM,CAACkD,gBAAP,EADD,EAEC,KAAKmpB,UAFN,EAGC,CACC;CACC30B,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,iCAAf,CADP;CAECoL,QAAAA,OAFD,mBAES5J,KAFT,EAEgB;CACd,eAAKsJ,WAAL,CAAiB7C,KAAjB;CACAsC,UAAAA,IAAI,CAAChJ,IAAL,CAAU,eAAV,EAA2B;CAAC2oB,YAAAA,aAAa,EAAE3f,IAAI,CAAC2f;CAArB,WAA3B;CACA;CALF,OADD,EAQC;CACCpqB,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,kCAAf,CADP;CAECoL,QAAAA,OAFD,mBAES5J,KAFT,EAEgB;CACd,eAAKsJ,WAAL,CAAiB7C,KAAjB;CACAsC,UAAAA,IAAI,CAAChJ,IAAL,CAAU,gBAAV,EAA4B;CAAC2oB,YAAAA,aAAa,EAAE3f,IAAI,CAAC2f;CAArB,WAA5B;CACA;CALF,OARD,EAeC;CACCpqB,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,+BAAf,CADP;CAECoL,QAAAA,OAFD,mBAES5J,KAFT,EAEgB;CACd,eAAKsJ,WAAL,CAAiB7C,KAAjB;CACAsC,UAAAA,IAAI,CAACgoB,QAAL,CAAc/wB,KAAd,EAAqB,IAArB;CACA;CALF,OAfD,CAHD,EA0BC;CACCiF,QAAAA,QAAQ,EAAE,IADX;CAECE,QAAAA,UAAU,EAAE,EAFb;CAGCoB,QAAAA,KAAK,EAAE;CAAErE,UAAAA,QAAQ,EAAE;CAAZ,SAHR;CAICoD,QAAAA,MAAM,EAAE;CACPC,UAAAA,YADO,0BAEP;CACC,iBAAKC,OAAL;CACA;CAJM;CAJT,OA1BD;CAsCA,+DAAuBqE,sBAAW,CAAC+qB,WAAnC;CAEA,aAAO,IAAP;CACA;CA/XF;CAAA;CAAA,2CAiYwBhxB,KAjYxB,EAkYC;CAAA;;CACCA,MAAAA,KAAK,CAACjK,OAAN,CAAc,UAACyJ,MAAD,EAAY;CACzB,YAAInK,cAAI,CAACS,OAAL,CAAa0J,MAAM,CAAC/D,QAApB,CAAJ,EACA;CACC,UAAA,MAAI,CAACw1B,2BAAL,CAAiCzxB,MAAM,CAAC4I,KAAxC,EAA+C5I,MAAM,CAAC/D,QAAtD;CACA;CACD,OALD;CAOA,aAAOuE,KAAP;CACA;CA3YF;CAAA;CAAA,gDA6Y6BoI,KA7Y7B,EA6Y4C3M,QA7Y5C,EA8YC;CAAA;;CACCA,MAAAA,QAAQ,CAAC1F,OAAT,CAAiB,UAACm7B,KAAD,EAAW;CAC3B,YAAI,CAACA,KAAK,CAACC,UAAX,EACA;CACCD,UAAAA,KAAK,CAACC,UAAN,GAAmB/oB,KAAnB;CACA;;CACD,YAAI/S,cAAI,CAAC8Z,aAAL,CAAmB+hB,KAAK,CAACz1B,QAAzB,CAAJ,EACA;CACC,UAAA,MAAI,CAACw1B,2BAAL,CAAiCC,KAAK,CAAC9oB,KAAvC,EAA8C8oB,KAAK,CAACz1B,QAApD;CACA;CACD,OATD;CAUA;CAzZF;CAAA;CAAA,kCA2Ze6H,KA3Zf,EA4ZC;CACC,UAAI,CAACA,KAAL,EACA;CACC;CACA;;CAED,UAAM8tB,SAAS,GAAG,KAAKhC,WAAL,CAAiBiC,OAAjB,CAAyBx0B,WAAzB,EAAlB;;CAEA,UAAIu0B,SAAS,KAAK,QAAlB,EACA;CACC,YAAIE,gBAAgB,GAAG,KAAKlC,WAAL,CAAiBlwB,aAAjB,CAA+B,0BAA/B,CAAvB;;CACA,YAAI,CAACoyB,gBAAL,EACA;CACCA,UAAAA,gBAAgB,GACf,KAAKlC,WAAL,CAAiBvzB,WAAjB,CACCvB,aAAG,CAACC,MAAJ,CACC,QADD,EAEC;CAACC,YAAAA,KAAK,EAAE;CAAC,2BAAa;CAAd;CAAR,WAFD,CADD,CADD;CAQA;;CACD82B,QAAAA,gBAAgB,CAAC7Y,YAAjB,CAA8B,OAA9B,EAAuCnV,KAAK,CAAC2K,UAA7C;CACAqjB,QAAAA,gBAAgB,CAAC9Y,WAAjB,GAA+BlV,KAAK,CAAC,YAAD,CAApC;CAEAguB,QAAAA,gBAAgB,CAACC,QAAjB,GAA4B,IAA5B;CACA,OAlBD,MAmBK,IAAIH,SAAS,KAAK,OAAlB,EACL;CACC,aAAKhC,WAAL,CAAiB5W,WAAjB,GAA+BlV,KAAK,CAAC2K,UAArC;CACA,YAAMujB,WAAW,GAAGr2B,QAAQ,CAACs2B,cAAT,CAAwB,KAAKrC,WAAL,CAAiBnwB,YAAjB,CAA8B,KAA9B,CAAxB,CAApB;;CACA,YAAIuyB,WAAJ,EACA;CACCA,UAAAA,WAAW,CAAC75B,KAAZ,GAAoB2L,KAAK,CAAC2K,UAA1B;CACA;CACD,OARI,MAUL;CACC,YAAI,KAAKwhB,cAAT,EACA;CACC,eAAKL,WAAL,CAAiBz3B,KAAjB,GAAyB2L,KAAK,CAAC2K,UAA/B;CACA,eAAKmhB,WAAL,CAAiBsC,YAAjB,GAAgC,KAAKtC,WAAL,CAAiBz3B,KAAjB,CAAuBsI,MAAvD;CACA,SAJD,MAMA;CACC,cAAM0xB,UAAU,GAAG,KAAKvC,WAAL,CAAiBz3B,KAAjB,CAAuBi6B,MAAvB,CAA8B,CAA9B,EAAiC,KAAKxC,WAAL,CAAiBsC,YAAlD,CAAnB;CACA,cAAMG,UAAU,GAAGvuB,KAAK,CAAC2K,UAAzB;CACA,cAAM6jB,SAAS,GAAG,KAAK1C,WAAL,CAAiBz3B,KAAjB,CAAuBi6B,MAAvB,CAA8B,KAAKxC,WAAL,CAAiBsC,YAA/C,CAAlB;CAEA,eAAKtC,WAAL,CAAiBz3B,KAAjB,GAAyBg6B,UAAU,GAAGE,UAAb,GAA0BC,SAAnD;CACA,eAAK1C,WAAL,CAAiBsC,YAAjB,GAAgCC,UAAU,CAAC1xB,MAAX,GAAoB4xB,UAAU,CAAC5xB,MAA/D;CACA;CACD;;CAEDhD,MAAAA,EAAE,CAACiwB,SAAH,CAAa,KAAKkC,WAAlB,EAA+B,QAA/B;CACA,WAAKjzB,IAAL,CAAU,QAAV,EAAoB;CAAEmH,QAAAA,KAAK,EAALA;CAAF,OAApB;CACA;CApdF;CAAA;CAAA,8BAudC;CACC,4CAAI,IAAJ,YACA;CACC,yDAAa1B,OAAb;CACA;;CACD,4CAAI,IAAJ,oBACA;CACC,iEAAqBA,OAArB;CACA;CACD;CAheF;CAAA;CAAA,gCAmeC;CACC,UAAMmwB,eAAe,GAAGp3B,aAAG,CAACC,UAAJ,CAAe,6CAAf,CAAxB;CACA,UAAMg2B,KAAK,GAAG,KAAKtrB,OAAL,CAAajC,MAAb,CAAoB/L,GAApB,CAAwB,UAAAgM,KAAK;CAAA,eAAIA,KAAK,CAACyK,IAAV;CAAA,OAA7B,EAA6CuL,IAA7C,CAAkD,IAAlD,CAAd;CAEA,UAAMjW,MAAM,GAAG,EAAf;CACA,WAAKkN,WAAL,CAAiBxa,OAAjB,CAAyB,UAACuN,KAAD,EAAW;CACnCA,QAAAA,KAAK,CAACwK,QAAN,GAAiB,UAAjB;CAEA,YAAMkkB,MAAM,GAAI1uB,KAAK,CAAC,UAAD,CAAL,KAAsB,QAAtB,IAAkCA,KAAK,CAAC,MAAD,CAAL,KAAkB,QAApE;;CAEA,YAAI,CAAC0uB,MAAL,EACA;CACC3uB,UAAAA,MAAM,CAACnN,IAAP,CAAYoN,KAAZ;CACA,SARkC;;;CAWnC,YACCA,KAAK,CAAC,MAAD,CAAL,KAAkB,MAAlB,IAEAA,KAAK,CAAC,MAAD,CAAL,KAAkB,MAFlB,IAIAA,KAAK,CAAC,MAAD,CAAL,KAAkB,MAJlB,IAMA0uB,MAPD,EASA;CACC,cAAMC,aAAa,GAAG3uB,KAAK,CAAC,MAAD,CAAL,GAAgB,GAAhB,GAAsByuB,eAA5C;;CAEA,cAAInB,KAAK,CAAC9zB,OAAN,CAAcm1B,aAAd,IAA+B,CAAnC,EACA;CACC,gBAAMC,cAAc,GAAGj1B,EAAE,CAAC1E,KAAH,CAAS+K,KAAT,CAAvB;CACA,gBAAMyY,YAAY,GAAIzY,KAAK,CAAC,MAAD,CAAL,KAAkB,MAAnB,GAA6B,UAA7B,GAA0C,WAA/D;CAEA4uB,YAAAA,cAAc,CAAC,MAAD,CAAd,GAAyBD,aAAzB;CACAC,YAAAA,cAAc,CAAC,MAAD,CAAd,GAAyB,QAAzB;CACAA,YAAAA,cAAc,CAAC,kBAAD,CAAd,GAAqC,gBAAcA,cAAc,CAAC,IAAD,CAA5B,GAAmC,KAAnC,GAAyCnW,YAAzC,GAAsD,GAA3F;CACAmW,YAAAA,cAAc,CAAC,YAAD,CAAd,GAA+B,OAAK5uB,KAAK,CAAC,MAAD,CAAV,GAAmB,KAAnB,GAAyByY,YAAzB,GAAsC,IAArE;CAEA1Y,YAAAA,MAAM,CAACnN,IAAP,CAAYg8B,cAAZ;CACA;CACD;;CACD,YAAI5uB,KAAK,CAAC,UAAD,CAAL,KAAsB,MAAtB,IAAgCA,KAAK,CAAC,UAAD,CAAL,KAAsB,UAA1D,EACA;CACC,cAAM6uB,WAAW,GAAGl1B,EAAE,CAAC1E,KAAH,CAAS+K,KAAT,CAApB;CACA6uB,UAAAA,WAAW,CAAC,MAAD,CAAX,IAAuB,MAAMx3B,aAAG,CAACC,UAAJ,CAAe,2CAAf,CAA7B;CACAu3B,UAAAA,WAAW,CAAC,MAAD,CAAX,GAAsB,QAAtB;CACAA,UAAAA,WAAW,CAAC,kBAAD,CAAX,wBAAgDA,WAAW,CAAC,IAAD,CAA3D;CACAA,UAAAA,WAAW,CAAC,YAAD,CAAX,eAAiC7uB,KAAK,CAAC,MAAD,CAAtC;CAEAD,UAAAA,MAAM,CAACnN,IAAP,CAAYi8B,WAAZ;CAEA,cAAMC,gBAAgB,GAAGn1B,EAAE,CAAC1E,KAAH,CAAS+K,KAAT,CAAzB;CACA8uB,UAAAA,gBAAgB,CAAC,MAAD,CAAhB,IAA4B,MAAMz3B,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAAlC;CACAw3B,UAAAA,gBAAgB,CAAC,MAAD,CAAhB,GAA2B,QAA3B;CACAA,UAAAA,gBAAgB,CAAC,kBAAD,CAAhB,wBAAqDD,WAAW,CAAC,IAAD,CAAhE;CACAC,UAAAA,gBAAgB,CAAC,YAAD,CAAhB,eAAsC9uB,KAAK,CAAC,MAAD,CAA3C;CAEAD,UAAAA,MAAM,CAACnN,IAAP,CAAYk8B,gBAAZ;CACA;CACD,OAtDD;CAwDA,aAAO/uB,MAAP;CACA;CAjiBF;CAAA;CAAA,EAAoCjD,6BAApC;;2BAuCiBopB,OAChB;CAAA;;CACC,MAAI,CAACn0B,cAAI,CAACS,OAAL,CAAa0zB,KAAK,CAAC/tB,QAAnB,CAAL,EACA;CACC+tB,IAAAA,KAAK,CAAC/tB,QAAN,GAAiB,EAAjB;CACA;;CAED+tB,EAAAA,KAAK,CAAC/tB,QAAN,GACC+tB,KAAK,CACH/tB,QADF,CAEEgM,MAFF,CAES,UAAAjC,IAAI;CAAA;;CAAA,WAAI,oBAAAA,IAAI,CAAC2jB,UAAL,8DAAiB7lB,KAAjB,4BAAyB,MAAzB,4CAAyB,MAAzB,EAA+CkC,IAAI,CAAC2jB,UAAL,CAAgB7lB,KAA/D,IAAwE,IAA5E;CAAA,GAFb,EAGEhM,GAHF,CAGM,UAAA+6B,UAAU;CAAA,oCAAI,MAAJ,0CAAI,MAAJ,EAAyBA,UAAzB;CAAA,GAHhB,CADD;CAOA;CACCC,IAAAA,QAAQ,EAAE,IADX;CAECzJ,IAAAA,IAAI,EAAE;CAFP,KAGIW,KAHJ;CAKA;;4CA4DD;CAAA;CAAA;;CACC,OAAKjZ,WAAL,GAAmB,KAAKA,WAAL,CAAiB9I,MAAjB,CAAwB,UAAAnE,KAAK;CAAA,oCAAI,MAAJ,4CAAI,MAAJ,EAA0BA,KAA1B;CAAA,GAA7B,CAAnB;CAEA,MAAMtE,IAAI,0BAAG,KAAK8lB,aAAR,wDAAG,oBAAoBzvB,IAAjC;;CACA,MAAI2J,IAAI,KAAK,MAAb,EACA;CACC,SAAKywB,cAAL,GAAsB,IAAtB;CACA,GAHD,MAIK,IAAIzwB,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,UAAhC,EACL;CACC,SAAKywB,cAAL,GAAsB,IAAtB;CAEA,QAAMxJ,qBAAqB,GAAG,IAAIC,wCAAJ,CAA0B;CACvDC,MAAAA,SAAS,EAAE,KAAKiJ,WADuC;CAEvD7e,MAAAA,WAAW,EAAE,KAAKA,WAFqC;CAGvD8V,MAAAA,aAAa,EAAE,IAHwC;CAIvDD,MAAAA,QAAQ,EAAG,UAASzL,KAAT,EACX;CACC,aAAKyU,WAAL,CAAiBz3B,KAAjB,GAAyBgjB,KAAK,CAAC4X,YAAN,CACxB,KAAKhiB,WADmB,EAExBvN,yBAAM,CAAC+I,4BAAP,CAAoC,KAAKzG,OAAL,CAAajC,MAAjD,CAFwB,CAAzB;CAIA,OANS,CAMPvI,IANO,CAMF,IANE;CAJ6C,KAA1B,CAA9B;CAaAmrB,IAAAA,qBAAqB,CAACzpB,IAAtB,CAA2B4S,gCAAa,CAACojB,UAAd,CAAyB,KAAKpD,WAAL,CAAiBz3B,KAA1C,EAAiD,KAAK4Y,WAAtD,CAA3B;CACA;CACD;;4BAEgBjN,OACjB;CAAA;;CACC,MAAMqqB,SAAS,2BAAG,KAAK7I,aAAR,yDAAG,qBAAoBzvB,IAAtC;;CACA,MAAIs4B,SAAS,KAAK,MAAlB,EACA;CACC,WAAOrqB,KAAK,CAACjO,IAAN,KAAe,MAAtB;CACA,GAHD,MAIK,IAAIs4B,SAAS,KAAK,MAAd,IAAwBA,SAAS,KAAK,UAA1C,EACL;CACC,WAAOrqB,KAAK,CAACjO,IAAN,KAAe,MAAf,IAAyBiO,KAAK,CAACjO,IAAN,KAAe,UAA/C;CACA;;CAED,SAAO,IAAP;CACA;;sBAEU+G,OACX;CACC,MAAIA,KAAK,CAACq2B,OAAN,KAAkB,EAAlB,IAAwBr2B,KAAK,CAACs2B,MAAN,KAAiB,KAAzC,IAAkDt2B,KAAK,CAACiD,OAAN,KAAkB,KAApE,IAA6EjD,KAAK,CAACu2B,QAAN,KAAmB,KAApG,EACA;CACC,SAAKxF,QAAL,CAAc/wB,KAAd;CACAA,IAAAA,KAAK,CAACie,cAAN;CACA;CACD;;6BAmIiB0W,YAClB;CACC,SAAOA,UAAU,CAACz5B,GAAX,CAAe,UAACgM,KAAD,EAAW;CAChC,QAAMsvB,GAAG,GACRtvB,KAAK,CAAC,UAAD,CAAL,KAAsB,UAAtB,GACG,OAAKA,KAAK,CAAC,MAAD,CAAV,GAAmB,gBADtB,GAEG,QAAMA,KAAK,CAAC,UAAD,CAAX,GAAwB,GAAxB,GAA4BA,KAAK,CAAC,IAAD,CAAjC,GAAwC,gBAH5C;CAMA,QAAI8E,KAAK,GAAG9E,KAAK,CAACyK,IAAN,IAAczK,KAAK,CAAC9N,EAAhC;;CAEA,QAAI8N,KAAK,CAAC0K,UAAV,EACA;CACC5F,MAAAA,KAAK,GAAG9E,KAAK,CAAC0K,UAAN,GAAmB,IAAnB,GAA0B5F,KAAlC;CACA;;CAED,WAAO;CACNA,MAAAA,KAAK,EAAEA,KADD;CAEN+gB,MAAAA,UAAU,EAAE;CACX7lB,QAAAA,KAAK,EAAE;CACN9N,UAAAA,EAAE,EAAE8N,KAAK,CAAC,IAAD,CAAL,GAAc,YADZ;CAENwK,UAAAA,QAAQ,EAAExK,KAAK,CAAC,UAAD,CAFT;CAGNyK,UAAAA,IAAI,EAAEzK,KAAK,CAAC,MAAD,CAHL;CAINjO,UAAAA,IAAI,EAAE,QAJA;CAKN4Y,UAAAA,UAAU,EAAE2kB,GALN;CAMN1kB,UAAAA,gBAAgB,EAAE,OAAK5K,KAAK,CAAC,UAAD,CAAV,GAAuB,GAAvB,GAA2BA,KAAK,CAAC,IAAD,CAAhC,GAAuC;CANnD;CADI,OAFN;CAYNgR,MAAAA,EAAE,EAAEse;CAZE,KAAP;CAcA,GA5BM,CAAP;CA6BA;;;;;;;;;;;;;;;;;;AC/UF,KAAa3F,uBAAb;CAAA;;CAIC,mCAAYhlB,KAAZ,EAIA;CAAA;;CAAA;CACC,yHAAMA,KAAN;;CADD;;CAAA;CAAA;CAAA;CAAA;;CAGC,+FAAkBA,KAAK,CAAClO,SAAxB;CAHD;CAIC;;CAZF;CAAA;CAAA,6BAcUoM,MAdV,EAeC;CACC,WAAKipB,WAAL,GAAmBjpB,MAAnB;CACA,WAAKkpB,UAAL,GAAkBlpB,MAAlB;CAEA,WAAKqpB,qBAAL;CACA,WAAKqD,gBAAL;CACA;CArBF;CAAA;CAAA,iCAwBC;CACC,WAAKtC,gBAAL;CACA;CA1BF;CAAA;CAAA,iCA6BC;CACC,WAAKp0B,IAAL,CAAU,YAAV,EAAwB;CACvBwP,QAAAA,QAAQ,EAAE,IADa;CAEvB;CACAqd,QAAAA,gBAAgB,2BAAE,IAAF,wDAAE,IAAF;CAHO,OAAxB;CAKA;CAnCF;CAAA;CAAA,kCAqCe1lB,KArCf,EAsCC;CACC,WAAKnH,IAAL,CAAU,QAAV,EAAoB;CAAEmH,QAAAA,KAAK,EAALA;CAAF,OAApB;CACA;CAxCF;CAAA;CAAA,gCAoDC;CACC,aAAO,KAAKgC,OAAL,CAAajC,MAAb,CAAoB/L,GAApB,CAAwB,UAACgM,KAAD;CAAA,mDAC3BA,KAD2B;CAE9BwK,UAAAA,QAAQ,EAAE;CAFoB;CAAA,OAAxB,CAAP;CAIA;CAzDF;CAAA;CAAA,EAA6C8gB,cAA7C;;oCA2CC;CACC,SACC,yDACG,sDAAgBnF,WADnB,IAEG,sDAAgBA,WAAhB,CAA4BzqB,IAA5B,KAAqC5G,iCAAc,CAAC6e,cAAf,CAA8BC,KAHvE;CAKA;;;;;;;;;;;;;;;;;;;;;;;;ACjDF,KAAa4X,kBAAb;CAAA;;CAAA;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,aAGkB;CAChB,+BAAuBpG,yGAAsB5tB,IAAtB;CADP;CAHlB;;CAAA;CAAA;;CAAA;CAAA;CAAA,8BAQC;CACC;CACA;CAVF;CAAA;CAAA,6BAYUs0B,WAZV,EAaC;CACC,WAAKA,WAAL,GAAmBA,WAAnB;CACA,2DAAmBA,WAAW,CAAClwB,aAAZ,CAA0B,iBAA1B,CAAnB;CACA,WAAKmwB,UAAL,GAAkBC,aAAG,CAACC,MAAtB,6MAEa,KAAKpC,QAAL,CAAcryB,IAAd,CAAmB,IAAnB,CAFb;CAOA,WAAK00B,qBAAL;CACA,WAAKqD,gBAAL;CAEAzD,MAAAA,WAAW,CAAC0D,iBAAZ,CAA8Bj3B,WAA9B,CAA0C,KAAKwzB,UAA/C;;CAEA;CACA;CA7BF;CAAA;CAAA,kCAuGe/rB,KAvGf,EAwGC;CACC,UAAMyvB,UAAU,GAAGzvB,KAAK,CAAC2K,UAAzB;;CACA,UAAM+kB,MAAM,4BAAG,IAAH,gCAAG,IAAH,CAAZ;;CAEA,UAAIA,MAAM,IAAIA,MAAM,CAACC,UAArB,EACA;CACC,YAAID,MAAM,CAACE,OAAP,CAAeC,mBAAf,EAAJ,EACA;CACCH,UAAAA,MAAM,CAACI,YAAP,CAAoBC,KAApB;CACAL,UAAAA,MAAM,CAACI,YAAP,CAAoBE,QAApB,CAA6B,EAA7B,EAAiC,EAAjC,EAAqCP,UAArC;CACA,SAJD,MAMA;CACCC,UAAAA,MAAM,CAACC,UAAP,CAAkBF,UAAlB;CACA;;CACDC,QAAAA,MAAM,CAACE,OAAP,CAAeK,IAAf;CACA;CACD;CAzHF;CAAA;CAAA,mCA4HC;CACC,UAAMP,MAAM,4BAAG,IAAH,gCAAG,IAAH,CAAZ;;CACA,UAAIA,MAAM,IAAIA,MAAM,CAACQ,WAArB,EACA;CACCR,QAAAA,MAAM,CAACQ,WAAP;CACA;CACD;CAlIF;CAAA;CAAA,oCAqIC;CACC,UAAMR,MAAM,4BAAG,IAAH,gCAAG,IAAH,CAAZ;;CACA,UAAIA,MAAM,IAAIA,MAAM,CAACS,cAArB,EACA;CACCT,QAAAA,MAAM,CAACS,cAAP;CACA;CACD;CA3IF;CAAA;CAAA,EAAwC7E,cAAxC;;yBAgCC;CACC,qCAA8B3Z,MAAM,CAACf,OAAP,mCAAe,IAAf,kBAA9B,qCACA;CADK;CAAA,QAAOxc,IAAP;CAAA,QAAag8B,OAAb;;CAEJz2B,IAAAA,EAAE,CAACmH,cAAH,CAAkB1M,IAAlB,EAAwBg8B,OAAxB;CACA;CACD;;2BAGD;CACC,uCAA8Bze,MAAM,CAACf,OAAP,mCAAe,IAAf,kBAA9B,wCACA;CADK;CAAA,QAAOxc,IAAP;CAAA,QAAag8B,OAAb;;CAEJz2B,IAAAA,EAAE,CAAC02B,iBAAH,CAAqBj8B,IAArB,EAA2Bg8B,OAA3B;CACA;CACD;;4BAEgBV,QACjB;CACC,MAAIA,MAAM,CAACY,GAAP,CAAWC,IAAX,uCAAoB,IAApB,cAAJ,EACA;CACC,WAAO,KAAP;CACA;;CAED,MAAIC,MAAM,GAAG,EAAb;CACA,MAAIC,MAAM,GAAG,EAAb;;CAEA,MAAMC,SAAS,GAAG,SAAZA,SAAY,CAACnyB,OAAD,EAAwD;CAAA,QAAtCoyB,gBAAsC,uEAAV,KAAU;CACzE,WAAOpyB,OAAO,CAACsH,OAAR,CAAgB,yBAAhB,EAA2C,UAACgI,GAAD,EAAS;CAC1D,UAAI8iB,gBAAJ,EACA;CACCH,QAAAA,MAAM,GAAG3iB,GAAT;CACA;;CAED,aAAO,EAAP;CACA,KAPM,CAAP;CAQA,GATD;;CAWA,MAAM+iB,SAAS,GAAG,SAAZA,SAAY,CAACryB,OAAD,EAAwD;CAAA,QAAtCsyB,gBAAsC,uEAAV,KAAU;CACzE,WAAOtyB,OAAO,CAACsH,OAAR,CAAgB,sBAAhB,EAAwC,UAACgI,GAAD,EAAS;CACvD,UAAIgjB,gBAAJ,EACA;CACCJ,QAAAA,MAAM,GAAG5iB,GAAT;CACA;;CAED,aAAO,EAAP;CACA,KAPM,CAAP;CAQA,GATD;;CAWAlU,EAAAA,EAAE,CAACmH,cAAH,CAAkB4uB,MAAlB,EAA0B,SAA1B,EAAqC,UAAUv7B,IAAV,EACrC;CACC,QAAI,CAACA,IAAL,EACA;CACC,WAAKoK,OAAL,GAAeqyB,SAAS,CAACF,SAAS,CAAC,KAAKnyB,OAAN,EAAe,IAAf,CAAV,EAAgC,IAAhC,CAAxB;CACA;CACD,GAND;CAQA5E,EAAAA,EAAE,CAACmH,cAAH,CAAkB4uB,MAAlB,EAA0B,cAA1B,EAA0C,UAAUv7B,IAAV,EAC1C;CACC,QAAIA,IAAJ,EACA;CACC,UAAIoK,OAAO,GAAGqyB,SAAS,CAACF,SAAS,CAAC,KAAKnyB,OAAN,CAAV,CAAvB;;CAEA,UAAIiyB,MAAM,KAAK,EAAX,IAAiBC,MAAM,KAAK,EAAhC,EACA;CACClyB,QAAAA,OAAO,GAAGiyB,MAAM,GAAGjyB,OAAT,GAAmBkyB,MAA7B;CACA;;CAED,WAAKlyB,OAAL,GAAeA,OAAf;CACA;CACD,GAbD;CAcA;;wBAyCD;CACC,wCAAI,IAAJ,gBACA;CACC,QAAMuyB,QAAQ,GAAG,qDAAiB9f,EAAjB,CAAoBpC,KAApB,CAA0B,GAA1B,CAAjB;CACA,WAAOmiB,YAAY,CAACC,GAAb,CAAiBF,QAAQ,CAACA,QAAQ,CAACn0B,MAAT,GAAkB,CAAnB,CAAzB,CAAP;CACA;;CAED,SAAO,IAAP;CACA;;;;;;;;;;;;;;;;;;;;ACxJF,KAAagvB,iBAAb;CAMC,6BAAYhnB,KAAZ,EAKA;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA;CAAA;;CACC,wDAAgBA,KAAK,CAAC3C,OAAtB;CACA,uDAAiB2C,KAAK,CAAC0c,QAAvB;CACA,uDAAiB1c,KAAK,CAACyc,QAAvB;;CAEA,QAAIzc,KAAK,CAACyc,QAAV,EACA;CACC,UAAM9tB,QAAQ,GAAG,qBAAjB;CACA,UAAM29B,UAAU,GAAG,oDAAcvtB,GAAd,CAAkB,aAAlB,EAAiCA,GAAjC,CAAqCpQ,QAArC,2BAA+C,IAA/C,0BAA+C,IAA/C,GAA+D,GAA/D,CAAnB;;CACA,UAAI29B,UAAU,KAAK,GAAnB,EACA;CACC,2DAAetoB,OAAf,GAAyB,IAAzB;CACA;CACD;CACD;;CAzBF;CAAA;CAAA,8BA4BC;CACC,4CAAI,IAAJ,cACA;CACC,4DAAcjF,GAAd,CAAkB,aAAlB,EAAiC3Q,GAAjC,CAAqC,uBAArC,2BAA8D,IAA9D,0BAA8D,IAA9D,4BAA8E,IAA9E,8BAA8E,IAA9E;CACA;CACD;CAjCF;CAAA;CAAA;;qBAoCC;CACC,SAAO,mDAAe4I,YAAf,CAA4B,qBAA5B,CAAP;CACA;;uBAGD;CACC,SAAO,mDAAegN,OAAf,GAAyB,GAAzB,GAAgC,GAAvC;CACA;;KC1CWoB,YAAb;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,6BAEU+hB,WAFV,EAGC;CACC,WAAKA,WAAL,GAAmBA,WAAnB;CACA,WAAKC,UAAL,GAAkBD,WAAlB;CAEA,WAAKtK,aAAL,GAAqB7hB,IAAI,CAAC8hB,KAAL,CAAWqK,WAAW,CAACnwB,YAAZ,CAAyB,eAAzB,CAAX,CAArB;;CACA,UAAI,CAAC,KAAK6lB,aAAV,EACA;CACC,aAAKxf,OAAL,CAAakf,eAAb,GAA+B,KAA/B;CACA;;CAED,UAAMgQ,oBAAoB,GAAG,KAAKlvB,OAAL,CAAa0B,GAAb,CAAiB,sBAAjB,CAA7B;CACA,WAAKytB,YAAL,GAAoBx3B,EAAE,CAAC2O,OAAH,CAAWyB,YAAX,CAAwBC,YAAxB,CACnB8hB,WADmB,EAEnB;CACC3G,QAAAA,gBAAgB,EAAEpzB,cAAI,CAACS,OAAL,CAAa0+B,oBAAb,IAAqCA,oBAArC,GAA4D;CAD/E,OAFmB,CAApB;CAMA;CApBF;CAAA;CAAA,8BAuBC;CACC;;CAEA,UAAI,KAAKC,YAAT,EACA;CACC,aAAKA,YAAL,CAAkB7yB,OAAlB;CACA,aAAK6yB,YAAL,GAAoB,IAApB;CACA;CACD;CA/BF;CAAA;CAAA,EAAkC7F,cAAlC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEA,KAAaF,YAAb;CAAA;;CA0BC,wBAAYzmB,KAAZ,EACA;CAAA;;CAAA;CACC,8GAAMA,KAAN;;CADD;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA,aAnBgBymB,YAAY,CAACgG,IAAb,CAAkBC;CAmBlC;;CAAA;CAAA;CAAA,aAlBqB;CAkBrB;;CAAA;CAAA;CAAA,aAjBqB;CAiBrB;;CAAA;CAAA;CAAA,aAhB0B;CAgB1B;;CAAA;CAAA;CAAA,aAfyB;CAezB;;CAAA;CAAA;CAAA,aAdoB;CAcpB;;CAAA;CAAA;CAAA,aAbiB;CAajB;;CAAA;CAAA;CAAA,aAZqB;CAYrB;;CAAA;CAAA;CAAA,aAXqB;CAWrB;;CAAA;CAAA;CAAA,aATqD;CASrD;;CAAA;CAAA;CAAA,aAPuC;CAOvC;;CAAA;CAAA;CAAA,aANmC;CAMnC;;CAAA;CAAA;CAAA,aALuC;CAKvC;;CAAA;CAAA;CAAA;CAAA;;CAGC,UAAKrvB,OAAL,CAAajP,GAAb,CACC,YADD,EAEC,MAAKiP,OAAL,CAAajC,MAAb,CAAoBoE,MAApB,CAA2B,UAAAnE,KAAK;CAAA,aAAIA,KAAK,CAACjO,IAAN,KAAe,MAAnB;CAAA,KAAhC,CAFD;;CAHD;CAOC;;CAlCF;CAAA;CAAA,8BAqCC;CACC,UAAI,KAAKu/B,IAAT,EACA;CACC,aAAKA,IAAL,CAAUlvB,WAAV,CAAsB7C,KAAtB;CACA;CACD;CA1CF;CAAA;CAAA,6BA4CUusB,WA5CV,EA6CC;CACC,WAAKA,WAAL,GAAmBA,WAAnB;CAEA,UAAMmC,QAAQ,GAAG,KAAK/B,qBAAL,EAAjB;CAEA,WAAKJ,WAAL,CAAiBvzB,WAAjB,0BAA6B,IAA7B,0CAA6B,IAA7B;;CACA,iGAA4B01B,QAA5B,EAND;CAQC;;CACA;CAtDF;CAAA;CAAA,4CAyDC;CACC,UAAIsD,MAAM,GAAG5xB,IAAI,CAAC8hB,KAAL,CAAW,KAAKqK,WAAL,CAAiBnwB,YAAjB,CAA8B,aAA9B,CAAX,CAAb;;CACA,UAAI,CAAC5J,cAAI,CAACmD,aAAL,CAAmBq8B,MAAnB,CAAL,EACA;CACCA,QAAAA,MAAM,GAAG,EAAT;CACA;;CAED,uDAAaA,MAAM,CAAC71B,IAAP,IAAe0vB,YAAY,CAACgG,IAAb,CAAkBI,IAA9C;;CACA,UAAID,MAAM,CAACtD,QAAP,IAAmB,CAACsD,MAAM,CAACtD,QAAP,CAAgBtxB,MAAxC,EACA;CACC,yDAAayuB,YAAY,CAACgG,IAAb,CAAkBC,IAA/B;CACA;;CAED,yDAAiBE,MAAM,CAACjH,QAAP,IAAmB,KAApC;CACA,yDAAiBiH,MAAM,CAACE,QAAP,IAAmB,KAApC;CACA,+DAAuBF,MAAM,CAACG,cAAP,IAAyB,EAAhD;CACA,8DAAsBH,MAAM,CAACI,aAAP,IAAwB,EAA9C;CACA,wDAAgBJ,MAAM,CAACK,OAAP,IAAkB,KAAlC;CACA,sDAAcL,MAAM,CAACtjB,KAAP,IAAgB,YAA9B;CACA,0DAAkBsjB,MAAM,CAACM,SAAP,IAAoB,MAAtC;CACA,0DAAkBN,MAAM,CAACO,SAAP,IAAoB,MAAtC;;CAEA,UAAIP,MAAM,CAACtD,QAAP,IAAmBsD,MAAM,CAACtD,QAAP,CAAgBtxB,MAAhB,GAAyB,CAAhD,EACA;CACC,eAAO6O,iBAAO,CAACvW,KAAR,CAAcs8B,MAAM,CAACtD,QAArB,CAAP;CACA;CACD;CAnFF;CAAA;CAAA,6BAkSUvxB,KAlSV,EAmSC;CACC,UAAI,qDAAe0uB,YAAY,CAACgG,IAAb,CAAkBI,IAArC,EACA;CAAA,qDACuB90B,KADvB;CAAA;;CAAA;CACC,8DACA;CAAA,gBADUq1B,QACV;;CACC,mFAAkBA,QAAlB;CACA;CAJF;CAAA;CAAA;CAAA;CAAA;CAKC,OAND,MAQA;CACC,uFAEEC,SAFF,8BAGE5G,YAHF,EA7SUA,YA6SV,4BAGEA,YAHF,EAGmC1uB,KAHnC;CAKA;CACD;CAnTF;CAAA;CAAA,kCA2WesD,KA3Wf,EA4WC;CACC,6EAAkB;CACjBgR,QAAAA,EAAE,EAAEhR,KAAK,CAAC9N,EADO;CAEjBymB,QAAAA,UAAU,EAAE3Y,KAAK,CAAC2K,UAFD;CAGjBvW,QAAAA,IAAI,EAAE4L,KAAK,CAACyK,IAHK;CAIjB/O,QAAAA,IAAI,EAAE0vB,YAAY,CAACgG,IAAb,CAAkBI;CAJP,OAAlB;CAMA;CAnXF;CAAA;CAAA,mCA0YC;CACC,UAAIS,GAAG,GAAG,EAAV;;CACA,UAAI,qDAAe7G,YAAY,CAACgG,IAAb,CAAkBc,IAArC,EACA;CACCD,QAAAA,GAAG,GAAG7M,+EAAwB+M,SAAxB,EAAN;CACA,OAHD,MAIK,IAAI,qDAAe/G,YAAY,CAACgG,IAAb,CAAkBI,IAArC,EACL;CACCS,QAAAA,GAAG,GACFh/B,KAAK,CAACC,IAAN,CAAW,wDAAoBk/B,UAA/B,EACEp+B,GADF,CACM,UAAAsB,IAAI;CAAA,iBAAIA,IAAI,CAACqG,YAAL,CAAkB,sBAAlB,CAAJ;CAAA,SADV,EAEEwI,MAFF,CAES,UAAA6M,EAAE;CAAA,iBAAIA,EAAE,KAAK,EAAX;CAAA,SAFX,CADD;CAKA;;CAbF,oDAekBihB,GAflB;CAAA;;CAAA;CAeC,+DACA;CAAA,cADWjhB,EACX;CACC,eAAK8a,WAAL,CAAiBvzB,WAAjB,CAA6ByzB,aAAG,CAACC,MAAjC,wMAGU,4DAAwB,qDAAiB,IAAjB,GAAwB,EAAhD,CAHV,EAIWjb,EAJX;CAOA;CAxBF;CAAA;CAAA;CAAA;CAAA;CAyBC;CAnaF;CAAA;CAAA,EAAkCsa,cAAlC;;6BAsFC;CACC,MAAMpJ,MAAM,GAAGxiB,yBAAM,CAACkD,gBAAP,EAAf;CACA,MAAIyvB,SAAS,GAAG,IAAhB;CAEA,MAAMC,eAAe,GAAG,EAAxB;;CAEA,MAAI,KAAKtwB,OAAL,CAAa0B,GAAb,CAAiB,YAAjB,EAA+B/G,MAA/B,GAAwC,CAA5C,EACA;CACC01B,IAAAA,SAAS,GAAGrG,aAAG,CAACC,MAAP,iTAEK/J,MAFL,oCAKC,IALD,mBAMEkJ,YAAY,CAACgG,IAAb,CAAkBI,IANpB,EAOL,qDAAepG,YAAY,CAACgG,IAAb,CAAkBI,IAAjC,GAAwC,SAAxC,GAAoD,EAP/C,CAAT;CAUA;;CAED,MAAMe,aAAa,GAAGvG,aAAG,CAACC,MAAP,2RAEL/J,MAFK,oCAKT,IALS,mBAMRkJ,YAAY,CAACgG,IAAb,CAAkBc,IANV,EAOf,qDAAe9G,YAAY,CAACgG,IAAb,CAAkBc,IAAjC,GAAwC,SAAxC,GAAoD,EAPrC,CAAnB;CAWAI,EAAAA,eAAe,CAAC1/B,IAAhB,CAAqBo5B,aAAG,CAACC,MAAzB,wMACyD,IADzD;;CAIA,MAAIoG,SAAJ,EACA;CACCC,IAAAA,eAAe,CAAC1/B,IAAhB,CAAqBy/B,SAArB,EAAgCrG,aAAG,CAACC,MAApC,6QAGe/J,MAHf,EAIakD,8DAAmB5tB,IAAnB,CAAwB,IAAxB,EAA8B4zB,YAAY,CAACgG,IAAb,CAAkBI,IAAhD,CAJb,oCAMG,IANH;CASA;;CAEDc,EAAAA,eAAe,CAAC1/B,IAAhB,CAAqB2/B,aAArB,EAAoCvG,aAAG,CAACC,MAAxC,6PAGe/J,MAHf,EAIakD,8DAAmB5tB,IAAnB,CAAwB,IAAxB,EAA8B4zB,YAAY,CAACgG,IAAb,CAAkBc,IAAhD,CAJb,oCAMG,IANH;CAUA,SAAOlG,aAAG,CAACC,MAAX,qLAEIqG,eAFJ;CAKA;;kCAEsBrE,UACvB;CACC,MAAI,qDAAe7C,YAAY,CAACgG,IAAb,CAAkBc,IAArC,EACA;CACC;;CACA,qGAA+BjE,QAA/B;CACA,GAJD,MAKK,IAAI,qDAAe7C,YAAY,CAACgG,IAAb,CAAkBI,IAArC,EACL;CACC;;CACA,qGAA+BvD,QAA/B;CACA,GAJI,MAML;CACC;;CACA;CACA;CACD;;qCAEyBA,UAC1B;CACC,MAAI,mCAAC,IAAD,sBAAJ,EACA;CACC,iEAA2Bj3B,aAAG,CAACC,MAAJ,CAAW,KAAX,CAA3B;CAEA,SAAK60B,WAAL,CAAiBvzB,WAAjB,mCAA6B,IAA7B;;CAEA,QAAMi6B,YAAY,4BAAG,IAAH,4CAAG,IAAH,CAAlB;;CACAA,IAAAA,YAAY,CAACC,MAAb,mCAAoB,IAApB;CACAD,IAAAA,YAAY,CAAC7zB,IAAb,CAAkB,IAAlB;;CAEA,QAAIsvB,QAAJ,EACA;CACC,WAAKyE,QAAL,CAAczE,QAAd;CACA;CACD,GAdD,MAgBA;CACCj3B,IAAAA,aAAG,CAAC2H,IAAJ,mCAAS,IAAT;CACA;CACD;;uCAGD;CACC,wCAAI,IAAJ,wBACA;CACC3H,IAAAA,aAAG,CAACwI,IAAJ,mCAAS,IAAT;CACA;CACD;;qCAEyByuB,UAC1B;CACC,MAAI,mCAAC,IAAD,sBAAJ,EACA;CACC,4DAAsBj3B,aAAG,CAACC,MAAJ,CAAW,MAAX,CAAtB;CACA,iEAA2BD,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAACkB,MAAAA,QAAQ,EAAE,mCAAC,IAAD;CAAX,KAAlB,CAA3B;CACA,SAAK2zB,WAAL,CAAiBvzB,WAAjB,mCAA6B,IAA7B;CACA,QAAMo6B,aAAa,GAAG37B,aAAG,CAACC,MAAJ,CAAW,GAAX,EAAgB;CACrCC,MAAAA,KAAK,EAAE;CAACC,QAAAA,SAAS,EAAE;CAAZ,OAD8B;CAErCC,MAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,4BAAf;CAF+B,KAAhB,CAAtB;CAKA,iEAAyBiB,WAAzB,CAAqCo6B,aAArC;CAEAp7B,IAAAA,eAAK,CAACC,IAAN,CAAWm7B,aAAX,EAA0B,OAA1B,EAAmCvN,4EAA0B5tB,IAA1B,CAA+B,IAA/B,EAAqCm7B,aAArC,CAAnC;;CAEA,QAAI1E,QAAJ,EACA;CACC,WAAKyE,QAAL,CAAczE,QAAd;CACA;CACD,GAlBD,MAoBA;CACCj3B,IAAAA,aAAG,CAAC2H,IAAJ,mCAAS,IAAT;CACA;CACD;;uCAGD;CACC,wCAAI,IAAJ,wBACA;CACC3H,IAAAA,aAAG,CAACwI,IAAJ,mCAAS,IAAT;CACA;CACD;;8BAGD;CACC,MAAI,mCAAC,IAAD,gBAAJ,EACA;CACC,2DAAqB7F,EAAE,CAAC2O,OAAH,CAAWsqB,UAAX,CAAsBC,YAAtB,CAAmC57B,MAAnC,CACpB,EADoB,EAEpB;CACC67B,MAAAA,GAAG,EAAE;CACJ,2BAAoBz7B,aAAG,CAACC,UAAJ,CAAe,yCAAf,CADhB;CAEJ,6BAAsBD,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAFlB;CAGJ,0BAAmBD,aAAG,CAACC,UAAJ,CAAe,yCAAf,CAHf;CAIJ,gCAAyBD,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAJrB;CAKJ,0BAAmBD,aAAG,CAACC,UAAJ,CAAe,yCAAf,CALf;CAMJ,gCAAyBD,aAAG,CAACC,UAAJ,CAAe,gDAAf;CANrB;CADN,KAFoB,CAArB;CAcA,2DAAmBy7B,OAAnB,CAA2B,CAA3B;CACA;;CAED,2CAAO,IAAP;CACA;;yBAEaC,SACd;CACC,MAAI,qDAAeA,OAAnB,EACA;CACC,qDAAaA,OAAb;;CACA;CACA;CACD;;wBAEY9wB,MACb;CACC,+BAAI,IAAJ,kDAAI,IAAJ,EAA6BA,IAA7B,GACA;CACC,WAAO,KAAP;CACA;;CAED,MAAM5M,IAAI,4BAAG,IAAH,kDAAG,IAAH,EAA4B4M,IAA5B,CAAV;;CACA,MAAI,mCAAC,IAAD,YAAJ,EACA;CACClL,IAAAA,aAAG,CAACgK,KAAJ,mCAAU,IAAV;CACA;;CAED,0DAAoBzI,WAApB,CAAgCjD,IAAhC;CACA;;+BAEmB4M,MACpB;CACC,SAAO,CAAC,CAAC,wDAAoBtG,aAApB,2BAAoDsG,IAAI,CAAC8O,EAAzD,SAAT;CACA;;8BAqB0BtU,OAC3B;CACC,SAAOA,KAAK,CAAC1I,GAAN,CAAU,UAACkO,IAAD;CAAA,WAAW;CAC3B6Z,MAAAA,EAAE,EAAE7Z,IAAI,CAAC,IAAD,CADmB;CAE3BjM,MAAAA,IAAI,EAAEiM,IAAI,CAAC,MAAD,CAFiB;CAG3B+wB,MAAAA,IAAI,EAAE/wB,IAAI,CAAC,MAAD,CAHiB;CAI3BgxB,MAAAA,QAAQ,EAAE;CAJiB,KAAX;CAAA,GAAV,CAAP;CAMA;;2BAEehxB,MAChB;CACC,MAAMixB,QAAQ,GAAG,wDAAoBv3B,aAApB,2BAAoDsG,IAAI,CAAC8O,EAAzD,SAAjB;;CACA,MAAImiB,QAAJ,EACA;CACC,4DAAoB32B,WAApB,CAAgC22B,QAAhC;CACA;CACD;;gCAEoBR,eAAe75B,OACpC;CACC,MAAM+I,IAAI,GAAG,IAAb;;CAEA,MAAI,mCAAC,IAAD,UAAJ,EACA;CACC,qDAAenC,yBAAM,CAACkD,gBAAP,EAAf;CACA;;CAEDD,EAAAA,sBAAW,CAAChE,IAAZ,mCACC,IADD,YAECg0B,aAFD,EAGC,KAAK3wB,OAAL,CAAa0B,GAAb,CAAiB,YAAjB,EAA+B1P,GAA/B,CAAmC,UAACgM,KAAD;CAAA,WAAY;CAC9C5I,MAAAA,IAAI,EAAEoG,cAAI,CAACC,MAAL,CAAYuC,KAAK,CAACyK,IAAlB,CADwC;CAE9CzK,MAAAA,KAAK,EAALA,KAF8C;CAG9C0C,MAAAA,OAH8C,mBAGtC5J,KAHsC,EAG/BoJ,IAH+B,EAI9C;CACC,aAAKE,WAAL,CAAiB7C,KAAjB;CACAsC,QAAAA,IAAI,CAACigB,aAAL,CAAmB9hB,KAAnB;CACA;CAP6C,KAAZ;CAAA,GAAnC,CAHD,EAYC;CACCjC,IAAAA,QAAQ,EAAE,IADX;CAECE,IAAAA,UAAU,EAAEjH,aAAG,CAACsI,WAAJ,CAAgBqzB,aAAhB,EAA+B,OAA/B,IAA0C,CAFvD;CAGCtzB,IAAAA,KAAK,EAAE;CACNrE,MAAAA,QAAQ,EAAE,KADJ;CAEN0D,MAAAA,MAAM,EAAE;CAFF;CAHR,GAZD,EARD;;CA+BC5F,EAAAA,KAAK,CAACie,cAAN;CACA;;+BAYmB7U,MACpB;CACC,MAAMkxB,SAAS,GAAG,KAAKpxB,OAAL,CAAa0B,GAAb,CAAiB,YAAjB,EAA+B1N,IAA/B,CAAoC,UAAAgK,KAAK;CAAA,WAAIA,KAAK,CAAC2K,UAAN,KAAqBzI,IAAI,CAACyW,UAA9B;CAAA,GAAzC,CAAlB;CACA,MAAM1K,KAAK,GAAG,CAAAmlB,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAE3oB,IAAX,KAAmB,EAAjC;CAEA,SAAOuhB,aAAG,CAACC,MAAX,kdAGkB/pB,IAAI,CAAC8O,EAHvB,EAI0B9O,IAAI,CAACyW,UAJ/B,EAM6D1K,KAN7D,EAScmX,kEAAqB5tB,IAArB,CAA0B,IAA1B,EAAgC0K,IAAhC,CATd;CAaA;;6BAvYWkpB,sBAEE;CACbiG,EAAAA,IAAI,EAAE,EADO;CAEba,EAAAA,IAAI,EAAE,MAFO;CAGbV,EAAAA,IAAI,EAAE;CAHO;;;;;;;;;;;;;;;;;;;;;;ACJf,KAAa9F,YAAb;CAAA;;CAAA;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;;CAAA;CAAA;CAAA,8BAKC;CACC,4CAAI,IAAJ,mBACA;CACC,gEAAoB2H,QAApB;CACA;CACD;CAVF;CAAA;CAAA,6BAYUvH,WAZV,EAaC;CAAA;;CACC,WAAKA,WAAL,GAAmBA,WAAnB,CADD;;CAGC,UAAM7a,QAAQ,GAAG,IAAIqiB,IAAJ,EAAjB;CACAriB,MAAAA,QAAQ,CAACsiB,QAAT,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B;CACAtiB,MAAAA,QAAQ,CAACuiB,OAAT,CAAiBviB,QAAQ,CAACwiB,OAAT,KAAqBrO,+EAAyB,IAA/D;CAEA,WAAK0G,WAAL,CAAiBz3B,KAAjB,sDAAyB,KAAKq/B,WAA9B,EApBWhI,YAoBX,uCAAsDza,QAAtD;CAEA1Z,MAAAA,eAAK,CAACC,IAAN,CAAWs0B,WAAX,EAAwB,OAAxB,EAAiC,KAAK6H,SAAL,CAAen8B,IAAf,CAAoB,IAApB,CAAjC;CACA;CAvBF;CAAA;CAAA,gCA0BC;CACC,UAAI,mCAAC,IAAD,iBAAJ,EACA;CACC,gEAAsB,IAAImC,EAAE,CAACi6B,cAAP,CAAsB;CAC3CC,UAAAA,UAAU,2BAAE,IAAF,0CAAE,IAAF,CADiC;CAE3Cv+B,UAAAA,IAAI,EAAE,KAAKw2B,WAFgC;CAG3CnoB,UAAAA,QAAQ,EAAEyhB,8DAAmB5tB,IAAnB,CAAwB,IAAxB;CAHiC,SAAtB,CAAtB;CAKA;;CAED,8DAAoBs8B,IAApB;CACA;CArCF;CAAA;CAAA,EAAkCxI,cAAlC;;yBAuCeyI,MACd;CACC,OAAKjI,WAAL,CAAiBz3B,KAAjB,GAAyB0/B,IAAzB;CACAp6B,EAAAA,EAAE,CAACiwB,SAAH,CAAa,KAAKkC,WAAlB,EAA+B,QAA/B;CACA,0DAAoBuH,QAApB;CACA;;6BAGD;CACC,kCAAO,IAAP,sDAAO,IAAP,EAAkC,KAAKvH,WAAL,CAAiBz3B,KAAnD;CACA;;iCAEqB0/B,MACtB;CACC,MAAMC,SAAS,GAAGD,IAAI,CAACnlB,KAAL,CAAW,QAAX,EAAqB5a,GAArB,CAAyB,UAAAigC,IAAI;CAAA,WAAIjnB,QAAQ,CAACinB,IAAD,CAAZ;CAAA,GAA7B,CAAlB;;CAEA,8CAAuBD,SAAvB;CAAA,MAAKxmB,KAAL;CAAA,MAAYC,OAAZ;;CACA,MAAIumB,SAAS,CAACr3B,MAAV,KAAqB,CAAzB,EACA;CACC,QAAMsS,MAAM,GAAG+kB,SAAS,CAAC,CAAD,CAAxB;;CAEA,QAAI/kB,MAAM,KAAK,IAAX,IAAmBzB,KAAK,GAAG,EAA/B,EACA;CACCA,MAAAA,KAAK,IAAI,EAAT;CACA,KAHD,MAIK,IAAIyB,MAAM,KAAK,IAAX,IAAmBzB,KAAK,KAAK,EAAjC,EACL;CACCA,MAAAA,KAAK,GAAG,CAAR;CACA;CACD;;CAED,SAAOA,KAAK,GAAG,IAAR,GAAeC,OAAO,GAAG,EAAhC;CACA;;sBAEkBwD,UACnB;CACC,MAAMijB,SAAS,GAAG,SAAZA,SAAY,CAACC,QAAD;CAAA,WACjBx6B,EAAE,CAACy6B,IAAH,CAAQC,mBAAR,CAA4Bh9B,aAAG,CAACC,UAAJ,CAAe68B,QAAf,CAA5B,EAAsDtuB,OAAtD,CAA8D,QAA9D,EAAwE,EAAxE,CADiB;CAAA,GAAlB;;CAIA,MAAMyuB,UAAU,GAAGJ,SAAS,CAAC,aAAD,CAA5B;CACA,MAAMK,UAAU,GAAGL,SAAS,CAAC,iBAAD,CAAT,CAA6BruB,OAA7B,CAAqCyuB,UAArC,EAAiD,EAAjD,EAAqDzlB,IAArD,EAAnB;CAEA,SAAOlV,EAAE,CAACy6B,IAAH,CAAQ5e,MAAR,CAAe+e,UAAf,EAA2BtjB,QAA3B,CAAP;CACA;;KCjFW2R,qBAAb;CAUC,iCAAY5X,OAAZ,EACA;CAAA;CACC,SAAKiC,WAAL,GAAmB,EAAnB;CACA,SAAK6V,QAAL,GAAgB,IAAhB;;CAEA,QAAI/wB,cAAI,CAACmD,aAAL,CAAmB8V,OAAnB,CAAJ,EACA;CACC,WAAK6X,SAAL,GAAiB7X,OAAO,CAAC6X,SAAzB;CACA,WAAKE,aAAL,GAAqB/X,OAAO,CAAC+X,aAA7B;;CAEA,UAAIhxB,cAAI,CAACS,OAAL,CAAawY,OAAO,CAACiC,WAArB,CAAJ,EACA;CACC,aAAKA,WAAL,GAAmBjC,OAAO,CAACiC,WAA3B;CACA;;CACD,WAAK6V,QAAL,GAAgB9X,OAAO,CAAC8X,QAAxB;CACA,WAAKJ,SAAL,GAAiB1X,OAAO,CAAC0X,SAAzB;CACA;CACD;;CA3BF;CAAA;CAAA,yBA6BMrL,KA7BN,EA8BC;CACC,WAAKA,KAAL,GAAaA,KAAb;CACA,WAAKwQ,YAAL;CACA,WAAKC,aAAL;CACA,WAAK0M,kBAAL;CACA;CAnCF;CAAA;CAAA,mCAsCC;CACC,UAAI,KAAKnd,KAAL,IAAc,KAAKwL,SAAvB,EACA;CACC,aAAKA,SAAL,CAAe3N,WAAf,GAA6B,KAAKmC,KAAL,CAAW7B,MAAX,CAC5Bne,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAD4B,EAE5B,KAAK2V,WAFuB,CAA7B;CAIA;CACD;CA9CF;CAAA;CAAA,oCAiDC;CACC,UAAI,KAAK4V,SAAT,EACA;CACCtrB,QAAAA,eAAK,CAACC,IAAN,CAAW,KAAKqrB,SAAhB,EAA2B,OAA3B,EAAoClpB,EAAE,CAAC+mB,QAAH,CAAY,KAAK6H,YAAjB,EAA+B,IAA/B,CAApC;CACA;CACD;CAtDF;CAAA;CAAA,iCAwDczvB,KAxDd,EAyDC;CACC,WAAK27B,sBAAL;CACA37B,MAAAA,KAAK,CAACie,cAAN;CACA;CA5DF;CAAA;CAAA,6CA+DC;CACC,UAAMM,KAAK,GAAG,KAAKA,KAAnB;CACA,UAAMqd,GAAG,GAAGh1B,MAAM,CAACkD,gBAAP,EAAZ;CAEA,UAAM8B,IAAI,GAAG1N,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC/BC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb;CADwB,OAAnB,CAAb;CAIA,UAAMw9B,QAAQ,GAAG39B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACpCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,uCADL;CAEN6Z,UAAAA,EAAE,EAAE0jB,GAAG,GAAG,KAFJ;CAGNh5B,UAAAA,IAAI,EAAE,OAHA;CAINrH,UAAAA,KAAK,EAAE,KAJD;CAKND,UAAAA,IAAI,EAAE;CALA;CAD6B,OAApB,CAAjB;;CASA,UAAIijB,KAAK,CAAC/J,KAAN,EAAJ,EACA;CACCqnB,QAAAA,QAAQ,CAACxf,YAAT,CAAsB,SAAtB,EAAiC,SAAjC;CACA;;CAED,UAAMyf,QAAQ,GAAG59B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACpCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,yCADL;CAEN,iBAAKu9B,GAAG,GAAG;CAFL,SAD6B;CAKpCv8B,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CAACC,YAAAA,SAAS,EAAE;CAAZ,WADW;CAElBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,KAAKyrB,aAAL,GAAqB,kCAArB,GAA0D,kCAAzE;CAFY,SAAnB,CADS;CAL0B,OAApB,CAAjB;CAaA,UAAM8R,gBAAgB,GAAG79B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC3CC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,qEADL;CAEN,uBAAaE,aAAG,CAACC,UAAJ,CAAe,KAAKyrB,aAAL,GAAqB,yCAArB,GAAiE,uCAAhF;CAFP;CADoC,OAAnB,CAAzB;CAMA6R,MAAAA,QAAQ,CAACr8B,WAAT,CAAqBs8B,gBAArB;CAEAnwB,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCgB,QAAAA,QAAQ,EAAE,CAACw8B,QAAD,EAAWC,QAAX;CAFwB,OAAlB,CAAjB;CAKAlwB,MAAAA,IAAI,CAACnM,WAAL,CAAiB,KAAKu8B,sBAAL,EAAjB;;CAEA,UAAI,KAAK7nB,WAAL,CAAiBtQ,MAAjB,GAA0B,CAA9B,EACA;CACC+H,QAAAA,IAAI,CAACnM,WAAL,CAAiB,KAAKw8B,uBAAL,EAAjB;CACArwB,QAAAA,IAAI,CAACnM,WAAL,CAAiB,KAAKy8B,mBAAL,EAAjB;CACA;;CAED,UAAMC,aAAa,GAAGj+B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACzCC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,UADA;CAENsV,UAAAA,EAAE,EAAE0jB,GAAG,GAAG,UAFJ;CAGNtgC,UAAAA,IAAI,EAAE,UAHA;CAINC,UAAAA,KAAK,EAAE,GAJD;CAKN0G,UAAAA,KAAK,EAAE;CALD,SADkC;CAQzC4J,QAAAA,KAAK,EAAE;CACNgE,UAAAA,OAAO,EAAE0O,KAAK,CAACzK;CADT;CARkC,OAApB,CAAtB;CAaA,UAAMsoB,gBAAgB,GAAGl+B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC3CC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,qEADL;CAEN,uBAAaE,aAAG,CAACC,UAAJ,CAAe,8CAAf;CAFP;CADoC,OAAnB,CAAzB;CAOAoN,MAAAA,IAAI,CAACnM,WAAL,CAAiBvB,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CAClCC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SAD2B;CAElCgB,QAAAA,QAAQ,EAAE,CACT88B,aADS,EAETj+B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACnBC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE,uCADL;CAEN,mBAAKu9B,GAAG,GAAG;CAFL,WADY;CAKnBt9B,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,kCAAf;CALa,SAApB,CAFS,EAST49B,gBATS;CAFwB,OAAlB,CAAjB;CAeA,UAAMrzB,IAAI,GAAG,IAAb,CA3FD;;CA6FClI,MAAAA,EAAE,CAACoF,EAAH,CAAMC,IAAN,CAAW9F,IAAX,CAAgBwL,IAAhB;CACA,UAAMF,KAAK,GAAG,IAAI7K,EAAE,CAACkE,WAAP,CAAmB6B,MAAM,CAACkD,gBAAP,EAAnB,EAA8C,KAAKigB,SAAnD,EAA8D;CAC3E9kB,QAAAA,QAAQ,EAAE,IADiE;CAE3EqB,QAAAA,UAAU,EAAE,IAF+D;CAG3EmH,QAAAA,SAAS,EAAE,KAHgE;CAI3EF,QAAAA,QAAQ,EAAE,KAJiE;CAK3EhH,QAAAA,KAAK,EAAE,IALoE;CAM3EpB,QAAAA,UAAU,EAAE,EAN+D;CAO3EM,QAAAA,OAAO,EAAEmG,IAPkE;CAQ3EkC,QAAAA,OAAO,EAAE,CACR,IAAIjN,EAAE,CAACkN,iBAAP,CAAyB;CACxBzP,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,+BAAf,CADkB;CAExBH,UAAAA,SAAS,EAAE,qEAFa;CAGxBiH,UAAAA,MAAM,EAAE;CACP0D,YAAAA,KADO,mBAEP;CACC,kBAAMgF,QAAQ,GAAGnN,EAAE,CAACoN,IAAH,CAAQC,WAAR,CAAoBtC,IAApB,CAAjB;CACA7C,cAAAA,IAAI,CAACszB,YAAL,CAAkBruB,QAAQ,CAAC,MAAD,CAA1B;CACA,mBAAK1E,WAAL,CAAiB7C,KAAjB;CACA;CANM;CAHgB,SAAzB,CADQ,CARkE;CAqB3EnB,QAAAA,MAAM,EAAE;CACPC,UAAAA,YADO,0BAEP;CACC,gBAAIwD,IAAI,CAACuzB,UAAT,EACA;CACCvzB,cAAAA,IAAI,CAACuzB,UAAL,CAAgBhzB,WAAhB,CAA4B7C,KAA5B;CACA;;CACD,gBAAIsC,IAAI,CAACwzB,aAAT,EACA;CACCxzB,cAAAA,IAAI,CAACwzB,aAAL,CAAmBjzB,WAAnB,CAA+B7C,KAA/B;CACA;;CACD,iBAAKjB,OAAL;CACA;CAZM,SArBmE;CAmC3EoI,QAAAA,OAAO,EAAE;CAAE4iB,UAAAA,eAAe,EAAE;CAAnB;CAnCkE,OAA9D,CAAd;CAsCA9kB,MAAAA,KAAK,CAAC7F,IAAN;CACA;CApMF;CAAA;CAAA,iCAsMcmI,QAtMd,EAuMC;CACC,UAAIA,QAAQ,CAAC,MAAD,CAAR,KAAqB,KAAzB,EACA;CACC,aAAKuQ,KAAL,CAAWie,MAAX;CACA,OAHD,MAIK,IAAIxuB,QAAQ,CAAC,MAAD,CAAR,KAAqBgF,aAAa,CAACI,UAAd,CAAyBa,EAAlD,EACL;CACC,aAAKsK,KAAL,CAAWjL,OAAX,CAAmBN,aAAa,CAACI,UAAd,CAAyBa,EAA5C;CACA,aAAKsK,KAAL,CAAWhL,QAAX,CAAoB,CAApB;CACA,aAAKgL,KAAL,CAAW/K,YAAX,CAAwB,GAAxB;CACA,aAAK+K,KAAL,CAAW9K,QAAX,CAAoBzF,QAAQ,CAAC,UAAD,CAA5B;CACA,OANI,MAQL;CACC,aAAKuQ,KAAL,CAAWjL,OAAX,CAAmBtF,QAAQ,CAAC,MAAD,CAA3B;CACA,aAAKuQ,KAAL,CAAWhL,QAAX,CAAoBvF,QAAQ,CAAC,WAAWA,QAAQ,CAAC,MAAD,CAApB,CAA5B;CACA,aAAKuQ,KAAL,CAAW/K,YAAX,CAAwBxF,QAAQ,CAAC,gBAAcA,QAAQ,CAAC,MAAD,CAAvB,CAAhC;;CAEA,YAAIA,QAAQ,CAAC,MAAD,CAAR,KAAqBgF,aAAa,CAACI,UAAd,CAAyBC,KAAlD,EACA;CACC,cAAI,KAAK4W,aAAT,EACA;CACC,iBAAK1L,KAAL,CAAW9K,QAAX,CAAoBzF,QAAQ,CAAC,aAAD,CAA5B;CACA,WAHD,MAKA;CACC,iBAAKuQ,KAAL,CAAW9K,QAAX,CAAoBT,aAAa,CAACE,UAAd,CAAyBC,eAA7C;CACA;;CACD,cACC,KAAKyW,SAAL,GAAiB,CAAjB,IACG,KAAKrL,KAAL,CAAW1K,KAAX,KAAqBb,aAAa,CAACE,UAAd,CAAyBC,eADjD,IAEG,KAAKoL,KAAL,CAAW3K,SAAX,KAAyB,GAF5B,IAGG,KAAK2K,KAAL,CAAWhjB,KAAX,GAAmB,KAAKquB,SAJ5B,EAMA;CACC/oB,YAAAA,EAAE,CAACoF,EAAH,CAAMw2B,YAAN,CAAmBC,MAAnB,CAA0BC,MAA1B,CAAiC;CAChCl3B,cAAAA,OAAO,EAAElH,aAAG,CAACC,UAAJ,CAAe,0CAAf;CADuB,aAAjC;CAGA,iBAAK+f,KAAL,CAAWhL,QAAX,CAAoB,KAAKqW,SAAzB;CACA;CACD,SAtBD,MAwBA;CACC,eAAKrL,KAAL,CAAW9K,QAAX,CAAoBzF,QAAQ,CAAC,cAAD,CAA5B;CACA;CACD;;CAED,WAAKuQ,KAAL,CAAW7K,WAAX,CAAuB1F,QAAQ,CAAC,UAAD,CAA/B;CACA,WAAK+gB,YAAL;;CAEA,UAAI,KAAK/E,QAAT,EACA;CACC,aAAKA,QAAL,CAAc,KAAKzL,KAAnB;CACA;CACD;CA7PF;CAAA;CAAA,6CAgQC;CACC,UAAMA,KAAK,GAAG,KAAKA,KAAnB;CACA,UAAMqd,GAAG,GAAGh1B,MAAM,CAACkD,gBAAP,EAAZ;CAEA,UAAM8yB,UAAU,GAAG1+B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACtCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,uCADL;CAEN6Z,UAAAA,EAAE,EAAE0jB,GAFE;CAGNh5B,UAAAA,IAAI,EAAE,OAHA;CAINrH,UAAAA,KAAK,EAAEyX,aAAa,CAACI,UAAd,CAAyBC,KAJ1B;CAKN/X,UAAAA,IAAI,EAAE;CALA;CAD+B,OAApB,CAAnB;;CASA,UAAIijB,KAAK,CAAC3b,IAAN,KAAeoQ,aAAa,CAACI,UAAd,CAAyBC,KAAxC,IAAiDkL,KAAK,CAAChjB,KAAN,GAAc,CAAnE,EACA;CACCqhC,QAAAA,UAAU,CAACvgB,YAAX,CAAwB,SAAxB,EAAmC,SAAnC;CACA;;CAED,UAAMuS,SAAS,GAAG1wB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACrCC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,MADA;CAENtH,UAAAA,IAAI,EAAE,aAFA;CAIN+C,UAAAA,SAAS,EAAE;CAJL,SAD8B;CAOrCwN,QAAAA,KAAK,EAAE;CACNtQ,UAAAA,KAAK,EAAEgjB,KAAK,CAAC3b,IAAN,KAAeoQ,aAAa,CAACI,UAAd,CAAyBC,KAAxC,IAAiDkL,KAAK,CAAChjB,KAAvD,GAA+DgjB,KAAK,CAAChjB,KAArE,GAA8E,KAAKquB,SAAL,IAAkB;CADjG;CAP8B,OAApB,CAAlB;CAYA,UAAMiT,UAAU,GAAG3+B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACtCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,yCADL;CAEN,iBAAKu9B;CAFC,SAD+B;CAKtCv8B,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CAACC,YAAAA,SAAS,EAAE;CAAZ,WADW;CAElBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,kCAAf;CAFY,SAAnB,CADS,EAKTowB,SALS,EAMT,KAAKkO,uBAAL,CAA6B,kBAA7B,CANS;CAL4B,OAApB,CAAnB;;CAeA,UAAI,KAAK7S,aAAT,EACA;CACC4S,QAAAA,UAAU,CAACp9B,WAAX,CAAuBvB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACzCC,UAAAA,KAAK,EAAE;CAACC,YAAAA,SAAS,EAAE;CAAZ,WADkC;CAEzCC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,8BAAf;CAFmC,SAAnB,CAAvB;CAKA,YAAIu+B,UAAU,GAAG,KAAKC,aAAL,CAAmBze,KAAK,CAAC1K,KAAzB,EAAgC,IAAhC,CAAjB;CACA,YAAIopB,UAAU,GAAG1e,KAAK,CAAC1K,KAAvB;;CACA,YAAI,CAACkpB,UAAL,EACA;CACCA,UAAAA,UAAU,GAAG,KAAKC,aAAL,CAAmBhqB,aAAa,CAACE,UAAd,CAAyBC,eAA5C,EAA6D,IAA7D,CAAb;CACA8pB,UAAAA,UAAU,GAAGF,UAAU,CAACjrB,gBAAxB;CACA;;CAED,YAAMorB,oBAAoB,GAAGh/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAChDC,UAAAA,KAAK,EAAE;CACNwE,YAAAA,IAAI,EAAE,QADA;CAENtH,YAAAA,IAAI,EAAE,aAFA;CAGNC,YAAAA,KAAK,EAAE0hC;CAHD;CADyC,SAApB,CAA7B;CAQA,YAAMl0B,IAAI,GAAG,IAAb;CACA,YAAMo0B,eAAe,GAAGj/B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC1CC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE;CADL,WADmC;CAI1CC,UAAAA,IAAI,EAAEy+B,UAAU,GAAGA,UAAU,CAACprB,IAAd,GAAqBpT,aAAG,CAACC,UAAJ,CAAe,0CAAf,CAJK;CAK1C8G,UAAAA,MAAM,EAAE;CACP0D,YAAAA,KADO,iBACDhJ,KADC,EAEP;CACC+I,cAAAA,IAAI,CAACq0B,YAAL,CAAkBp9B,KAAlB,EAAyB,IAAzB,EAA+B,UAASkH,KAAT,EAC/B;CACCi2B,gBAAAA,eAAe,CAAC/gB,WAAhB,GAA8BlV,KAAK,CAACyK,IAApC;CACAurB,gBAAAA,oBAAoB,CAAC3hC,KAArB,GAA6B2L,KAAK,CAAC4K,gBAAnC;CACA,eAJD,EAIGkB,aAAa,CAACI,UAAd,CAAyBC,KAJ5B;CAKA;CARM;CALkC,SAAnB,CAAxB;CAgBAwpB,QAAAA,UAAU,CAACp9B,WAAX,CAAuBy9B,oBAAvB;CACAL,QAAAA,UAAU,CAACp9B,WAAX,CAAuB09B,eAAvB;CACA;;CAED,UAAI,CAAC,KAAKlT,aAAV,EACA;CACC,YAAMoT,aAAa,GAAGn/B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACxCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE,qEADL;CAEN,yBAAaE,aAAG,CAACC,UAAJ,CAAe,yCAAf;CAFP;CADiC,SAAnB,CAAtB;CAMAq+B,QAAAA,UAAU,CAACp9B,WAAX,CAAuB49B,aAAvB;CACA;;CAED,aAAOn/B,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACxBC,QAAAA,KAAK,EAAE;CAAEC,UAAAA,SAAS,EAAE;CAAb,SADiB;CAExBgB,QAAAA,QAAQ,EAAE,CAACu9B,UAAD,EAAaC,UAAb;CAFc,OAAlB,CAAP;CAIA;CAxWF;CAAA;CAAA,8CA2WC;CACC,UAAMte,KAAK,GAAG,KAAKA,KAAnB;CACA,UAAMqd,GAAG,GAAGh1B,MAAM,CAACkD,gBAAP,EAAZ;CAEA,UAAMwzB,WAAW,GAAGp/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACvCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,uCADL;CAEN6Z,UAAAA,EAAE,EAAE0jB,GAFE;CAGNh5B,UAAAA,IAAI,EAAE,OAHA;CAINrH,UAAAA,KAAK,EAAEyX,aAAa,CAACI,UAAd,CAAyBY,MAJ1B;CAKN1Y,UAAAA,IAAI,EAAE;CALA;CADgC,OAApB,CAApB;;CAUA,UAAIijB,KAAK,CAAC3b,IAAN,KAAeoQ,aAAa,CAACI,UAAd,CAAyBY,MAA5C,EACA;CACCspB,QAAAA,WAAW,CAACjhB,YAAZ,CAAyB,SAAzB,EAAoC,SAApC;CACA;;CAED,UAAMuS,SAAS,GAAG1wB,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACrCC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,MADA;CAENtH,UAAAA,IAAI,EAAE,cAFA;CAIN+C,UAAAA,SAAS,EAAE;CAJL,SAD8B;CAOrCwN,QAAAA,KAAK,EAAE;CACNtQ,UAAAA,KAAK,EAAEgjB,KAAK,CAAC3b,IAAN,KAAeoQ,aAAa,CAACI,UAAd,CAAyBY,MAAxC,IAAkDuK,KAAK,CAAChjB,KAAxD,GAAgEgjB,KAAK,CAAChjB,KAAtE,GAA+E,KAAKquB,SAAL,IAAkB;CADlG;CAP8B,OAApB,CAAlB;CAYA,UAAM2T,WAAW,GAAGr/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACvCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,yCADL;CAEN,iBAAKu9B;CAFC,SADgC;CAKvCv8B,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CAACC,YAAAA,SAAS,EAAE;CAAZ,WADW;CAElBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf;CAFY,SAAnB,CADS,EAKTowB,SALS,EAMT,KAAKkO,uBAAL,CAA6B,mBAA7B,CANS,EAOT5+B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CAACC,YAAAA,SAAS,EAAE;CAAZ,WADW;CAElBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,iCAAf;CAFY,SAAnB,CAPS;CAL6B,OAApB,CAApB;CAmBA,UAAIu+B,UAAU,GAAG,KAAKC,aAAL,CAAmBze,KAAK,CAAC1K,KAAzB,CAAjB;CACA,UAAIopB,UAAU,GAAG1e,KAAK,CAAC1K,KAAvB;;CACA,UAAI,CAACkpB,UAAL,EACA;CACCA,QAAAA,UAAU,GAAG,KAAK5oB,WAAL,CAAiB,CAAjB,CAAb;CACA8oB,QAAAA,UAAU,GAAGF,UAAU,CAACjrB,gBAAxB;CACA;;CAED,UAAMorB,oBAAoB,GAAGh/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAChDC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,cAFA;CAGNC,UAAAA,KAAK,EAAE0hC;CAHD;CADyC,OAApB,CAA7B;CAQA,UAAMl0B,IAAI,GAAG,IAAb;CACA,UAAMo0B,eAAe,GAAGj/B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAC1CC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SADmC;CAI1CC,QAAAA,IAAI,EAAEy+B,UAAU,GAAGA,UAAU,CAACprB,IAAd,GAAqBpT,aAAG,CAACC,UAAJ,CAAe,0CAAf,CAJK;CAK1C8G,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KADO,iBACDhJ,KADC,EAEP;CACC+I,YAAAA,IAAI,CAACq0B,YAAL,CACCp9B,KADD,EAEC,IAFD,EAGC,UAACkH,KAAD,EAAW;CACVi2B,cAAAA,eAAe,CAAC/gB,WAAhB,GAA8BlV,KAAK,CAACyK,IAApC;CACAurB,cAAAA,oBAAoB,CAAC3hC,KAArB,GAA6B2L,KAAK,CAAC4K,gBAAnC;CACA,aANF,EAOCkB,aAAa,CAACI,UAAd,CAAyBY,MAP1B;CASA;CAZM;CALkC,OAAnB,CAAxB;CAoBAupB,MAAAA,WAAW,CAAC99B,WAAZ,CAAwBy9B,oBAAxB;CACAK,MAAAA,WAAW,CAAC99B,WAAZ,CAAwB09B,eAAxB;;CAEA,UAAI,CAAC,KAAKlT,aAAV,EACA;CACC,YAAMuT,cAAc,GAAGt/B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACzCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE,qEADL;CAEN,yBAAaE,aAAG,CAACC,UAAJ,CAAe,0CAAf;CAFP;CADkC,SAAnB,CAAvB;CAMA++B,QAAAA,WAAW,CAAC99B,WAAZ,CAAwB+9B,cAAxB;CACA;;CAED,aAAOt/B,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACxBC,QAAAA,KAAK,EAAE;CAACC,UAAAA,SAAS,EAAE;CAAZ,SADiB;CAExBgB,QAAAA,QAAQ,EAAE,CAACi+B,WAAD,EAAcC,WAAd;CAFc,OAAlB,CAAP;CAIA;CApdF;CAAA;CAAA,0CAudC;CACC,UAAMhf,KAAK,GAAG,KAAKA,KAAnB;CACA,UAAMqd,GAAG,GAAGh1B,MAAM,CAACkD,gBAAP,EAAZ;CAEA,UAAM2zB,OAAO,GAAGv/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACnCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,uCADL;CAEN6Z,UAAAA,EAAE,EAAE0jB,GAFE;CAGNh5B,UAAAA,IAAI,EAAE,OAHA;CAINrH,UAAAA,KAAK,EAAEyX,aAAa,CAACI,UAAd,CAAyBa,EAJ1B;CAKN3Y,UAAAA,IAAI,EAAE;CALA;CAD4B,OAApB,CAAhB;;CAUA,UAAIijB,KAAK,CAAC3b,IAAN,KAAeoQ,aAAa,CAACI,UAAd,CAAyBa,EAA5C,EACA;CACCwpB,QAAAA,OAAO,CAACphB,YAAR,CAAqB,SAArB,EAAgC,SAAhC;CACA;;CAGD,UAAMqhB,OAAO,GAAGx/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACnCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE,yCADL;CAEN,iBAAKu9B;CAFC,SAD4B;CAKnCv8B,QAAAA,QAAQ,EAAE,CACTnB,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CAACC,YAAAA,SAAS,EAAE;CAAZ,WADW;CAElBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,kCAAf;CAFY,SAAnB,CADS;CALyB,OAApB,CAAhB;CAaA,UAAIu+B,UAAU,GAAG,KAAKC,aAAL,CAAmBze,KAAK,CAAC1K,KAAzB,CAAjB;CACA,UAAIopB,UAAU,GAAG1e,KAAK,CAAC1K,KAAvB;;CACA,UAAI,CAACkpB,UAAL,EACA;CACCA,QAAAA,UAAU,GAAG,KAAK5oB,WAAL,CAAiB,CAAjB,CAAb;CACA8oB,QAAAA,UAAU,GAAGF,UAAU,CAACjrB,gBAAxB;CACA;;CAED,UAAM6rB,gBAAgB,GAAGz/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CAC5CC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAE,UAFA;CAGNC,UAAAA,KAAK,EAAE0hC;CAHD;CADqC,OAApB,CAAzB;CAQA,UAAMl0B,IAAI,GAAG,IAAb;CACA,UAAM60B,WAAW,GAAG1/B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACtCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,SAAS,EAAE;CADL,SAD+B;CAItCC,QAAAA,IAAI,EAAEy+B,UAAU,GAAGA,UAAU,CAACprB,IAAd,GAAqBpT,aAAG,CAACC,UAAJ,CAAe,0CAAf,CAJC;CAKtC8G,QAAAA,MAAM,EAAE;CACP0D,UAAAA,KADO,iBACDhJ,KADC,EAEP;CACC+I,YAAAA,IAAI,CAACq0B,YAAL,CACCp9B,KADD,EAEC,IAFD,EAGC,UAAAkH,KAAK,EAAI;CACR02B,cAAAA,WAAW,CAACxhB,WAAZ,GAA0BlV,KAAK,CAACyK,IAAhC;CACAgsB,cAAAA,gBAAgB,CAACpiC,KAAjB,GAAyB2L,KAAK,CAAC4K,gBAA/B;CACA,aANF;CAQA;CAXM;CAL8B,OAAnB,CAApB;CAmBA4rB,MAAAA,OAAO,CAACj+B,WAAR,CAAoBk+B,gBAApB;CACAD,MAAAA,OAAO,CAACj+B,WAAR,CAAoBm+B,WAApB;;CACA,UAAI,CAAC,KAAK3T,aAAV,EACA;CACC,YAAM4T,QAAQ,GAAG3/B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACnCC,UAAAA,KAAK,EAAE;CACNC,YAAAA,SAAS,EAAE,qEADL;CAEN,yBAAaE,aAAG,CAACC,UAAJ,CAAe,sCAAf;CAFP;CAD4B,SAAnB,CAAjB;CAMAk/B,QAAAA,OAAO,CAACj+B,WAAR,CAAoBo+B,QAApB;CACA;;CAED,aAAO3/B,aAAG,CAACC,MAAJ,CAAW,KAAX,EAAkB;CACxBC,QAAAA,KAAK,EAAE;CAACC,UAAAA,SAAS,EAAE;CAAZ,SADiB;CAExBgB,QAAAA,QAAQ,EAAE,CAACo+B,OAAD,EAAUC,OAAV;CAFc,OAAlB,CAAP;CAIA;CA7iBF;CAAA;CAAA,4CA+iByBpiC,IA/iBzB,EAgjBC;CACC,UAAMijB,KAAK,GAAG,KAAKA,KAAnB;CACA,UAAMuf,UAAU,GAAG;CAClB/2B,QAAAA,CAAC,EAAExI,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADe;CAElBkX,QAAAA,CAAC,EAAEnX,aAAG,CAACC,UAAJ,CAAe,mCAAf,CAFe;CAGlBmX,QAAAA,CAAC,EAAEpX,aAAG,CAACC,UAAJ,CAAe,mCAAf;CAHe,OAAnB;CAMA,UAAM2W,KAAK,GAAGjX,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACjCC,QAAAA,KAAK,EAAE;CAACC,UAAAA,SAAS,EAAE;CAAZ,SAD0B;CAEjCC,QAAAA,IAAI,EAAEw/B,UAAU,CAACvf,KAAK,CAAC3K,SAAP;CAFiB,OAApB,CAAd;CAKA,UAAMmqB,KAAK,GAAG7/B,aAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;CACjCC,QAAAA,KAAK,EAAE;CACNwE,UAAAA,IAAI,EAAE,QADA;CAENtH,UAAAA,IAAI,EAAEA;CAFA,SAD0B;CAKjCuQ,QAAAA,KAAK,EAAE;CACNtQ,UAAAA,KAAK,EAAEgjB,KAAK,CAAC3K;CADP;CAL0B,OAApB,CAAd;CAUAnV,MAAAA,eAAK,CAACC,IAAN,CAAWyW,KAAX,EAAkB,OAAlB,EAA2B,KAAK6oB,wBAAL,CAA8Bt/B,IAA9B,CAAmC,IAAnC,EAAyCyW,KAAzC,EAAgD4oB,KAAhD,CAA3B;CAEA,aAAO7/B,aAAG,CAACC,MAAJ,CAAW,MAAX,EAAmB;CACzBkB,QAAAA,QAAQ,EAAE,CAAC8V,KAAD,EAAQ4oB,KAAR;CADe,OAAnB,CAAP;CAGA;CA5kBF;CAAA;CAAA,6CA8kB0B5oB,KA9kB1B,EA8kBiC4oB,KA9kBjC,EA+kBC;CACC,UAAMnC,GAAG,GAAGh1B,MAAM,CAACkD,gBAAP,EAAZ;;CAEA,UAAMwtB,OAAO,GAAG,SAAVA,OAAU,CAASt3B,KAAT,EAAgBoJ,IAAhB,EAChB;CACC,aAAKE,WAAL,CAAiB7C,KAAjB;CACAs3B,QAAAA,KAAK,CAACxiC,KAAN,GAAc6N,IAAI,CAAC60B,OAAnB;CACA9oB,QAAAA,KAAK,CAACiH,WAAN,GAAoBhT,IAAI,CAAC9K,IAAzB;CACA,OALD;;CAOA,UAAMiL,SAAS,GAAG,CACjB;CACCjL,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADP;CAECy/B,QAAAA,OAAO,EAAE,GAFV;CAGCr0B,QAAAA,OAAO,EAAE0tB;CAHV,OADiB,EAMjB;CACCh5B,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADP;CAECy/B,QAAAA,OAAO,EAAE,GAFV;CAGCr0B,QAAAA,OAAO,EAAE0tB;CAHV,OANiB,EAWjB;CACCh5B,QAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADP;CAECy/B,QAAAA,OAAO,EAAE,GAFV;CAGCr0B,QAAAA,OAAO,EAAE0tB;CAHV,OAXiB,CAAlB;CAkBAztB,MAAAA,sBAAW,CAAChE,IAAZ,CACC+1B,GADD,EAECzmB,KAFD,EAGC5L,SAHD,EAIC;CACCtE,QAAAA,QAAQ,EAAE,IADX;CAECE,QAAAA,UAAU,EAAE,EAFb;CAGCoB,QAAAA,KAAK,EAAE;CAAErE,UAAAA,QAAQ,EAAE;CAAZ,SAHR;CAICoD,QAAAA,MAAM,EAAE;CACPC,UAAAA,YADO,0BAEP;CACC,iBAAKC,OAAL;CACA;CAJM,SAJT;CAUCoI,QAAAA,OAAO,EAAE;CAAE4iB,UAAAA,eAAe,EAAE;CAAnB;CAVV,OAJD;CAkBA,WAAK+L,aAAL,GAAqB1yB,sBAAW,CAAC+qB,WAAjC;CACA;CA9nBF;CAAA;CAAA,iCAgoBc50B,KAhoBd,EAgoBqB+pB,SAhoBrB,EAgoBgClf,QAhoBhC,EAgoB0CqzB,SAhoB1C,EAioBC;CACC,UAAM30B,SAAS,GAAG,EAAlB;;CAEA,UAAI20B,SAAS,KAAKlrB,aAAa,CAACI,UAAd,CAAyBC,KAA3C,EACA;CACC9J,QAAAA,SAAS,CAACzP,IAAV,CACC;CACCwE,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,kCAAf,CADP;CAEC0I,UAAAA,KAAK,EAAE;CACNyK,YAAAA,IAAI,EAAEpT,aAAG,CAACC,UAAJ,CAAe,kCAAf,CADA;CAENsT,YAAAA,gBAAgB,EAAEkB,aAAa,CAACE,UAAd,CAAyBC;CAFrC,WAFR;CAMCvJ,UAAAA,OAND,mBAMS5J,KANT,EAMgBoJ,IANhB,EAOC;CACC,gBAAIyB,QAAJ,EACA;CACCA,cAAAA,QAAQ,CAACzB,IAAI,CAAClC,KAAN,CAAR;CACA;;CAED,iBAAKoC,WAAL,CAAiB7C,KAAjB;CACA;CAdF,SADD,EAiBC;CACCnI,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADP;CAEC0I,UAAAA,KAAK,EAAE;CACNyK,YAAAA,IAAI,EAAEpT,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADA;CAENsT,YAAAA,gBAAgB,EAAEkB,aAAa,CAACE,UAAd,CAAyBmB;CAFrC,WAFR;CAMCzK,UAAAA,OAND,mBAMS5J,KANT,EAMgBoJ,IANhB,EAOC;CACC,gBAAIyB,QAAJ,EACA;CACCA,cAAAA,QAAQ,CAACzB,IAAI,CAAClC,KAAN,CAAR;CACA;;CAED,iBAAKoC,WAAL,CAAiB7C,KAAjB;CACA;CAdF,SAjBD,EAiCC;CACC8D,UAAAA,SAAS,EAAE;CADZ,SAjCD;CAqCA;;CAED,WAAK,IAAIxD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKoN,WAAL,CAAiBtQ,MAArC,EAA6C,EAAEkD,CAA/C,EACA;CACC,YACCm3B,SAAS,KAAKlrB,aAAa,CAACI,UAAd,CAAyBC,KAAvC,IACG,KAAKc,WAAL,CAAiBpN,CAAjB,EAAoB,IAApB,EAA0BrG,OAA1B,CAAkC,aAAlC,IAAmD,CAAC,CAFxD,EAIA;CACC;CACA;;CAED6I,QAAAA,SAAS,CAACzP,IAAV,CAAe;CACdwE,UAAAA,IAAI,EAAEoG,cAAI,CAACC,MAAL,CAAY,KAAKwP,WAAL,CAAiBpN,CAAjB,EAAoB4K,IAAhC,CADQ;CAEdzK,UAAAA,KAAK,EAAE,KAAKiN,WAAL,CAAiBpN,CAAjB,CAFO;CAGd6C,UAAAA,OAHc,mBAGNK,CAHM,EAGHb,IAHG,EAId;CACC,gBAAIyB,QAAJ,EACA;CACCA,cAAAA,QAAQ,CAACzB,IAAI,CAAClC,KAAL,IAAckC,IAAI,CAAC8I,OAAL,CAAahL,KAA5B,CAAR;CACA;;CAED,iBAAKoC,WAAL,CAAiB7C,KAAjB;CACA;CAXa,SAAf;CAaA;;CAED,UAAIwe,MAAM,GAAG8E,SAAS,CAAClnB,YAAV,CAAuB,cAAvB,CAAb;;CACA,UAAI,CAACoiB,MAAL,EACA;CACCA,QAAAA,MAAM,GAAGre,MAAM,CAACkD,gBAAP,EAAT;CACAigB,QAAAA,SAAS,CAAC1N,YAAV,CAAuB,cAAvB,EAAuC4I,MAAvC;CACA;;CAEDpb,MAAAA,sBAAW,CAAChE,IAAZ,CACCof,MADD,EAEC8E,SAFD,EAGCxgB,SAHD,EAIC;CACCtE,QAAAA,QAAQ,EAAE,IADX;CAECE,QAAAA,UAAU,EAAGtE,EAAE,CAACskB,GAAH,CAAO4E,SAAP,EAAkB,OAAlB,IAA6B,CAF3C;CAGCxjB,QAAAA,KAAK,EAAE;CAAErE,UAAAA,QAAQ,EAAE,KAAZ;CAAmB0D,UAAAA,MAAM,EAAE;CAA3B,SAHR;CAICgI,QAAAA,OAAO,EAAE;CAAE4iB,UAAAA,eAAe,EAAE;CAAnB;CAJV,OAJD;CAYA,WAAK8L,UAAL,GAAkBzyB,sBAAW,CAAC+qB,WAA9B;CACA;CA1tBF;CAAA;CAAA,kCA4tBe/gB,KA5tBf,EA4tBsBsqB,MA5tBtB,EA6tBC;CACC,UAAIA,MAAM,KAAKtqB,KAAK,KAAKb,aAAa,CAACE,UAAd,CAAyBC,eAAnC,IAAsDU,KAAK,KAAKb,aAAa,CAACE,UAAd,CAAyBqC,oBAA9F,CAAV,EACA;CACC,eAAO;CACN5D,UAAAA,IAAI,EAAEpT,aAAG,CAACC,UAAJ,CAAe,kCAAf,CADA;CAENsT,UAAAA,gBAAgB,EAAEkB,aAAa,CAACE,UAAd,CAAyBC;CAFrC,SAAP;CAIA;;CACD,UAAIgrB,MAAM,IAAItqB,KAAK,KAAKb,aAAa,CAACE,UAAd,CAAyBmB,WAAjD,EACA;CACC,eAAO;CACN1C,UAAAA,IAAI,EAAEpT,aAAG,CAACC,UAAJ,CAAe,mCAAf,CADA;CAENsT,UAAAA,gBAAgB,EAAEkB,aAAa,CAACE,UAAd,CAAyBmB;CAFrC,SAAP;CAIA;;CAED,UAAInN,KAAK,GAAG,IAAZ;;CACA,WAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKoN,WAAL,CAAiBtQ,MAArC,EAA6C,EAAEkD,CAA/C,EACA;CACC,YAAI8M,KAAK,KAAK,KAAKM,WAAL,CAAiBpN,CAAjB,EAAoB+K,gBAAlC,EACA;CACC5K,UAAAA,KAAK,GAAG,KAAKiN,WAAL,CAAiBpN,CAAjB,CAAR;CACA;CACD;;CAED,aAAOG,KAAP;CACA;CAvvBF;CAAA;CAAA,yCA0vBC;CACC,UAAMD,MAAM,GAAG,EAAf;;CACA,WAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKoN,WAAL,CAAiBtQ,MAArC,EAA6C,EAAEkD,CAA/C,EACA;CACC,YAAMq3B,GAAG,GAAG,KAAKjqB,WAAL,CAAiBpN,CAAjB,CAAZ;;CACA,YACCq3B,GAAG,CAAC,IAAD,CAAH,CAAU19B,OAAV,CAAkB,aAAlB,IAAmC,CAAnC,IACG09B,GAAG,CAAC,IAAD,CAAH,CAAU19B,OAAV,CAAkB,YAAlB,IAAkC,CADrC,IAEG09B,GAAG,CAAC,IAAD,CAAH,CAAU19B,OAAV,CAAkB,WAAlB,IAAiC,CAHrC,EAKA;CACCuG,UAAAA,MAAM,CAACnN,IAAP,CAAYskC,GAAZ;CACA;CACD;;CAED,WAAKjqB,WAAL,GAAmBlN,MAAnB;CACA;CA1wBF;CAAA;CAAA;;;;;;;;ACFA,KAAao3B,WAAb;CAAA;;CAIC,uBAAY7iC,YAAZ,EACA;CAAA;;CAAA;CACC;;CADD;CAAA;CAAA;CAAA;;CAGC,UAAKM,iBAAL,CAAuB,+BAAvB;;CACA,QAAI7C,cAAI,CAACmD,aAAL,CAAmBZ,YAAnB,CAAJ,EACA;CACC,4FAAeA,YAAf;CACA;;CAPF;CAQC;;CAbF;CAAA;CAAA,4BAgBC;CACC,aAAO,IAAI6iC,WAAJ,CAAgBliC,eAAK,mCAAC,IAAD,WAArB,CAAP;CACA;CAlBF;CAAA;CAAA,gCAqBC;CACC,+CAAO,IAAP;CACA;CAvBF;CAAA;CAAA,wBAyBKb,IAzBL,EAyBmBC,KAzBnB,EA0BC;CACC,UAAM+iC,cAAc,GAAG,KAAKvjC,GAAL,CAASO,IAAT,CAAvB;CACA,uDAAaA,IAAb,IAAqBC,KAArB;CACA,WAAKwE,IAAL,CAAUu+B,cAAc,GAAG,cAAH,GAAoB,YAA5C,EAA0D;CAAChjC,QAAAA,IAAI,EAAJA,IAAD;CAAOC,QAAAA,KAAK,EAALA;CAAP,OAA1D;CAEA,aAAO,IAAP;CACA;CAhCF;CAAA;CAAA,wBAkCKD,IAlCL,EAmCC;CACC,aAAO,iDAAaA,IAAb,CAAP;CACA;CArCF;CAAA;CAAA,wBAuCKA,IAvCL,EAwCC;CACC,aAAO,iDAAaG,cAAb,CAA4BH,IAA5B,CAAP;CACA;CA1CF;CAAA;CAAA,yCA4CsBA,IA5CtB,EA4CoC2wB,QA5CpC,EA6CC;CACC,WAAK5jB,SAAL,CAAe,cAAf,EAA+B,UAACrI,KAAD,EAAW;CACzC,YAAIA,KAAK,CAAC/D,IAAN,CAAWX,IAAX,KAAoBA,IAAxB,EACA;CACC2wB,UAAAA,QAAQ,CAACjsB,KAAD,CAAR;CACA;CACD,OALD;CAOA,aAAO,IAAP;CACA;CAtDF;CAAA;CAAA,EAAiCgE,6BAAjC;;KCCamkB,eAAb;CAAA;;CAEC,2BAAYtc,KAAZ,EAKA;CAAA;CAAA,gHACOA,KADP;CAEC;;CATF;CAAA;CAAA,wBAYC;CACC,UAAM5E,MAAM,GAAG,KAAK2D,GAAL,CAAS,QAAT,CAAf;CAEA,aAAO3R,cAAI,CAACS,OAAL,CAAauN,MAAb,IAAuBA,MAAvB,GAAgC,EAAvC;CACA;CAhBF;CAAA;CAAA,wBAmBC;CACC,aAAOhO,cAAI,CAAC4zB,SAAL,CAAe,KAAKjiB,GAAL,CAAS,iBAAT,CAAf,IAA8C,KAAKA,GAAL,CAAS,iBAAT,CAA9C,GAA4E,KAAnF;CACA,KArBF;CAAA,sBAuBqBrP,KAvBrB,EAwBC;CACC,WAAKtB,GAAL,CAAS,iBAAT,EAA4BsB,KAA5B;CACA;CA1BF;CAAA;CAAA,wBA6BC;CAAA;;CACC,0BAAO,KAAKqP,GAAL,CAAS,gBAAT,CAAP,iDAAqC,EAArC;CACA;CA/BF;CAAA;CAAA,EAAqCyzB,WAArC;;KCAaE,OAAb;CAAA;;CAEC,mBAAY1yB,KAAZ,EAiBA;CAAA;CAAA,wGACOA,KADP;CAEC;;CArBF;CAAA;CAAA,4BAwBC;CAAA;;CACC;CACA,aAAQ,IAAI0yB,OAAJ,CAAY7rB,iBAAO,CAACvW,KAAR,CAAc,KAAKk9B,SAAL,EAAd,CAAZ,CAAD,CACLp/B,GADK,CACD,UADC,EACW,KAAK8E,QAAL,CAAc5C,KAAd,EADX,EAELlC,GAFK,CAED,aAFC,uBAEc,KAAK+nB,WAFnB,sDAEc,kBAAkB7lB,KAAlB,EAFd,CAAP;CAIA;CA9BF;CAAA;CAAA,wCAiHqBW,IAjHrB,EAkHC;CACC,aAAO,KAAKG,iBAAL,CAAuBC,IAAvB,CAA4B,UAAAF,OAAO;CAAA,eAAIA,OAAO,CAAC,MAAD,CAAP,KAAoBF,IAAxB;CAAA,OAAnC,CAAP;CACA;CApHF;CAAA;CAAA,wBAiCC;CACC,aAAO,KAAK8N,GAAL,CAAS,UAAT,CAAP;CACA;CAnCF;CAAA;CAAA,wBAsCC;CAAA;;CACC,0BAAO,KAAKA,GAAL,CAAS,gBAAT,CAAP,iDAAqC,EAArC;CACA;CAxCF;CAAA;CAAA,wBA2CC;CAAA;;CACC,2BAAO,KAAKA,GAAL,CAAS,SAAT,CAAP,mDAA8B,EAA9B;CACA;CA7CF;CAAA;CAAA,wBAgDC;CACC,UAAM8Z,eAAe,GAAG,KAAK9Z,GAAL,CAAS,iBAAT,CAAxB;;CACA,UAAI3R,cAAI,CAACS,OAAL,CAAagrB,eAAb,CAAJ,EACA;CACC,eAAOA,eAAP;CACA;;CAED,aAAO,EAAP;CACA;CAxDF;CAAA;CAAA,wBA2DC;CACC,UAAMznB,iBAAiB,GAAG,KAAK2N,GAAL,CAAS,mBAAT,CAA1B;;CACA,UAAI3R,cAAI,CAACS,OAAL,CAAauD,iBAAb,CAAJ,EACA;CACC,eAAOA,iBAAP;CACA;;CAED,aAAO,EAAP;CACA;CAnEF;CAAA;CAAA,wBAsEC;CACC,UAAM6mB,SAAS,GAAG,KAAKlZ,GAAL,CAAS,WAAT,CAAlB;CAEA,aAAO3R,cAAI,CAAC4zB,SAAL,CAAe/I,SAAf,KAA6BA,SAApC;CACA;CA1EF;CAAA;CAAA,wBA6EC;CACC,UAAMlnB,OAAO,GAAG,KAAKgO,GAAL,CAAS,SAAT,CAAhB;CAEA,aAAO3R,cAAI,CAAC4zB,SAAL,CAAejwB,OAAf,KAA2BA,OAAlC;CACA;CAjFF;CAAA;CAAA,wBAoFC;CACC,aAAO,KAAKgO,GAAL,CAAS,aAAT,CAAP;CACA;CAtFF;CAAA;CAAA,wBAyFC;CACC,aAAO,KAAKA,GAAL,CAAS,SAAT,CAAP;CACA,KA3FF;CAAA,sBA6FarN,OA7Fb,EA8FC;CACC,WAAKtD,GAAL,CAAS,SAAT,EAAoBsD,OAApB;CACA;CAhGF;CAAA;CAAA,wBAmGC;CACC,aAAO,KAAKqN,GAAL,CAAS,kBAAT,CAAP;CACA;CArGF;CAAA;CAAA,wBAwGC;CACC,aAAO,KAAKA,GAAL,CAAS,oBAAT,CAAP;CACA;CA1GF;CAAA;CAAA,wBA6GC;CACC,aAAO,KAAKA,GAAL,CAAS,qBAAT,CAAP;CACA;CA/GF;CAAA;CAAA,EAA6ByzB,WAA7B;;CCsCA,IAAIG,eAAJ;AAEA,CAAO,SAAS7hC,gBAAT,GACP;CACC,MAAI6hC,eAAe,YAAYD,OAA/B,EACA;CACC,WAAOC,eAAP;CACA;;CAED,QAAM,IAAIC,KAAJ,CAAU,gCAAV,CAAN;CACA;AAED,CAAO,SAASC,mBAAT,GACP;CACC,MACA;CACC,WAAO/hC,gBAAgB,EAAvB;CACA,GAHD,CAIA,OAAOgiC,KAAP,EACA;CACC,WAAO,IAAP;CACA;CACD;AAED,CAAO,SAASC,gBAAT,CAA0B11B,OAA1B,EACP;CACC,MAAIA,OAAO,YAAYq1B,OAAvB,EACA;CACCC,IAAAA,eAAe,GAAGt1B,OAAlB;CACA,GAHD,MAKA;CACC,UAAM,IAAIu1B,KAAJ,CAAU,qBAAV,CAAN;CACA;;CAED,SAAOv1B,OAAP;CACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}