{"version":3,"file":"automation.bundle.js","sources":["../src/template-scope.js","../src/templates-scheme.js","../src/context/base-context.js","../src/context/context.js","../src/view-mode.js","../src/trigger.js","../src/helper.js","../src/designer.js","../src/trigger-manager.js","../src/document/document.js","../src/delay-interval.js","../src/help-hint.js","../src/workflow/types.js","../src/tracker/tracking-entry.js","../src/tracker/types.js","../src/tracker/robot-entry.js","../src/tracker/trigger-entry.js","../src/tracker/tracking-entry-builder.js","../src/tracker/tracker.js","../src/robot.js","../src/user-options.js","../src/template.js","../src/condition/condition.js","../src/condition/condition-group.js","../src/selectors/condition-selector.js","../src/selectors/condition-group-selector.js","../src/selectors/manager.js","../src/selectors/inline-time-selector.js","../src/selectors/inline-selector.js","../src/selectors/inline-selector-condition.js","../src/selectors/inline-selector-html.js","../src/selectors/save-state-checkbox.js","../src/selectors/user-selector.js","../src/selectors/file-selector.js","../src/selectors/time-selector.js","../src/delay-interval-selector.js","../src/context/selector-context.js","../src/automation-globals.js","../src/statuses.js","../src/tourguide/beginning-guide.js","../src/tourguide/automation-guide.js","../src/automation.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { DocumentType, DocumentCategory, DocumentStatus } from './document/types';\n\nexport class TemplateScope\n{\n\t#documentType: DocumentType;\n\t#category: DocumentCategory | null;\n\t#status: DocumentStatus;\n\n\tconstructor(rawTemplateScope: {\n\t\tDocumentType: {\n\t\t\tType: string,\n\t\t\tName: string,\n\t\t},\n\t\tCategory: {\n\t\t\tId: string | null,\n\t\t\tName: string | null,\n\t\t},\n\t\tStatus: {\n\t\t\tId: string,\n\t\t\tName: string,\n\t\t\tColor: string,\n\t\t}\n\t})\n\t{\n\t\tthis.#documentType = rawTemplateScope.DocumentType;\n\t\tthis.#category = !Type.isNil(rawTemplateScope.Category.Id) ? rawTemplateScope.Category : null;\n\t\tthis.#status = rawTemplateScope.Status;\n\t}\n\n\tgetId()\n\t{\n\t\tif (this.hasCategory())\n\t\t{\n\t\t\treturn `${this.#documentType.Type}_${this.#category.Id}_${this.#status.Id}`;\n\t\t}\n\n\t\treturn `${this.#documentType.Type}_${this.#status.Id}`;\n\t}\n\n\tgetDocumentType(): DocumentType\n\t{\n\t\treturn this.#documentType;\n\t}\n\n\tgetDocumentCategory(): DocumentCategory\n\t{\n\t\treturn this.#category;\n\t}\n\n\tgetDocumentStatus(): DocumentStatus\n\t{\n\t\treturn this.#status;\n\t}\n\n\thasCategory(): boolean\n\t{\n\t\treturn !Type.isNull(this.#category);\n\t}\n}","import {Type} from 'main.core';\nimport {DocumentType, DocumentCategory, DocumentStatus} from './document/types';\nimport {TemplateScope} from './template-scope';\n\nexport default class TemplatesScheme\n{\n\t#scheme: Array<TemplateScope>;\n\n\tconstructor(scheme: Array<TemplateScope>)\n\t{\n\t\tthis.#scheme = [];\n\n\t\tif (Type.isArray(scheme))\n\t\t{\n\t\t\tscheme.forEach(rawScope => {\n\t\t\t\tconst scope = new TemplateScope(rawScope);\n\t\t\t\tthis.#scheme.push(scope);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetDocumentTypes(): Array<DocumentType>\n\t{\n\t\tconst documentTypes = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tdocumentTypes.set(scope.getDocumentType().Type, scope.getDocumentType());\n\t\t}\n\n\t\treturn Array.from(documentTypes.values());\n\t}\n\n\tgetTypeCategories(documentType: DocumentType): Array<DocumentCategory>\n\t{\n\t\tconst documentCategories = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tif (scope.hasCategory() && scope.getDocumentType().Type === documentType.Type)\n\t\t\t{\n\t\t\t\tconst category = scope.getDocumentCategory();\n\t\t\t\tdocumentCategories.set(category.Id, category);\n\t\t\t}\n\t\t}\n\n\t\treturn Array.from(documentCategories.values());\n\t}\n\n\tgetTypeStatuses(documentType: DocumentType, documentCategory: DocumentCategory | null): Array<DocumentStatus>\n\t{\n\t\tconst takenStatuses = new Set();\n\t\tif (Type.isNil(documentCategory))\n\t\t{\n\t\t\tdocumentCategory = {Id: null};\n\t\t}\n\n\t\tconst predicate = scope => {\n\t\t\tconst shouldBeTaken = (\n\t\t\t\tscope.getDocumentType().Type === documentType.Type\n\t\t\t\t&& (scope.hasCategory() ? scope.getDocumentCategory().Id === documentCategory.Id : true)\n\t\t\t\t&& !takenStatuses.has(scope.getDocumentStatus().Id)\n\t\t\t);\n\n\t\t\tif (shouldBeTaken)\n\t\t\t{\n\t\t\t\ttakenStatuses.add(scope.getDocumentStatus().Id);\n\t\t\t}\n\n\t\t\treturn shouldBeTaken;\n\t\t};\n\n\t\treturn Array.from(this.#filterBy(predicate)).map(scope => scope.getDocumentStatus());\n\t}\n\n\t#filterBy(predicate: (TemplateScope) => boolean): Iterable<TemplateScope>\n\t{\n\t\tconst generator = function*(scheme)\n\t\t{\n\t\t\tfor (const scope of scheme)\n\t\t\t{\n\t\t\t\tif (predicate(scope))\n\t\t\t\t{\n\t\t\t\t\tyield scope;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn generator(this.#scheme);\n\t}\n}","import { Type, clone } from \"main.core\";\nimport { EventEmitter, BaseEvent } from \"main.core.events\";\n\nexport class BaseContext extends EventEmitter\n{\n\t#values: Object<string, any>;\n\n\tconstructor(defaultValue: Object<string, any>)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Bizproc.Automation.Context');\n\t\tif (Type.isPlainObject(defaultValue))\n\t\t{\n\t\t\tthis.#values = defaultValue;\n\t\t}\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new BaseContext(clone(this.#values));\n\t}\n\n\tgetValues(): object\n\t{\n\t\treturn this.#values;\n\t}\n\n\tset(name: string, value: any): this\n\t{\n\t\tconst isValueChanged = this.has(name);\n\t\tthis.#values[name] = value;\n\t\tthis.emit(isValueChanged ? 'valueChanged' : 'valueAdded', {name, value})\n\n\t\treturn this;\n\t}\n\n\tget(name: string): any\n\t{\n\t\treturn this.#values[name];\n\t}\n\n\thas(name: string): boolean\n\t{\n\t\treturn this.#values.hasOwnProperty(name);\n\t}\n\n\tsubsribeValueChanges(name: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.subscribe('valueChanged', (event) => {\n\t\t\tif (event.data.name === name)\n\t\t\t{\n\t\t\t\tlistener(event);\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n}","import { Type, Runtime } from \"main.core\";\nimport { BaseContext } from \"./base-context\";\nimport {Document, UserOptions, Tracker, AutomationGlobals} from \"bizproc.automation\";\nexport class Context extends BaseContext\n{\n\tconstructor(props: {\n\t\tdocument: Document,\n\t\tsignedDocument: string,\n\t\tajaxUrl: string,\n\t\tavailableRobots?: Array<Object>,\n\t\tavailableTriggers?: Array<Object>,\n\t\tcanManage?: boolean,\n\t\tcanEdit?: boolean,\n\t\tuserOptions?: UserOptions,\n\t\ttracker?: Tracker,\n\n\t\tbizprocEditorUrl?: string,\n\t\tconstantsEditorUrl?: string,\n\t\tparametersEditorUrl?: string,\n\n\t\tmarketplaceRobotCategory?: string,\n\t})\n\t{\n\t\tsuper(props);\n\t}\n\n\tclone(): this\n\t{\n\t\t// TODO - clone Tracker object when the corresponding method appears\n\t\treturn (new Context(Runtime.clone(this.getValues())))\n\t\t\t.set('document', this.document.clone())\n\t\t\t.set('userOptions', this.userOptions?.clone())\n\t\t;\n\t}\n\n\tget document(): ?Document\n\t{\n\t\treturn this.get('document');\n\t}\n\n\tget signedDocument(): string\n\t{\n\t\treturn this.get('signedDocument') ?? '';\n\t}\n\n\tget ajaxUrl(): string\n\t{\n\t\treturn this.get('ajaxUrl') ?? '';\n\t}\n\n\tget availableRobots(): Array<Object>\n\t{\n\t\tconst availableRobots = this.get('availableRobots');\n\t\tif (Type.isArray(availableRobots))\n\t\t{\n\t\t\treturn availableRobots;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget availableTriggers(): Array<Object>\n\t{\n\t\tconst availableTriggers = this.get('availableTriggers');\n\t\tif (Type.isArray(availableTriggers))\n\t\t{\n\t\t\treturn availableTriggers;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget canManage(): boolean\n\t{\n\t\tconst canManage = this.get('canManage');\n\n\t\treturn Type.isBoolean(canManage) && canManage;\n\t}\n\n\tget canEdit(): boolean\n\t{\n\t\tconst canEdit = this.get('canEdit');\n\n\t\treturn Type.isBoolean(canEdit) && canEdit;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.get('userOptions');\n\t}\n\n\tget tracker(): ?Tracker\n\t{\n\t\treturn this.get('tracker');\n\t}\n\n\tset tracker(tracker: Tracker)\n\t{\n\t\tthis.set('tracker', tracker);\n\t}\n\n\tget bizprocEditorUrl(): ?string\n\t{\n\t\treturn this.get('bizprocEditorUrl');\n\t}\n\n\tget constantsEditorUrl(): ?string\n\t{\n\t\treturn this.get('constantsEditorUrl');\n\t}\n\n\tget parametersEditorUrl(): ?string\n\t{\n\t\treturn this.get('parametersEditorUrl');\n\t}\n\n\tgetAvailableTrigger(code: string): ?Object\n\t{\n\t\treturn this.availableTriggers.find(trigger => trigger['CODE'] === code);\n\t}\n\n\tget automationGlobals(): ?AutomationGlobals\n\t{\n\t\treturn this.get('automationGlobals');\n\t}\n}\n","export class ViewMode\n{\n\t#mode: number;\n\t#properties: Object;\n\n\tstatic #none = 0;\n\tstatic #view = 1;\n\tstatic #edit = 2;\n\tstatic #manage = 3;\n\n\tconstructor(mode: number)\n\t{\n\t\tthis.#mode = mode;\n\t\tthis.#properties = {};\n\t}\n\n\tstatic none(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#none)\n\t}\n\n\tisNone(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#none;\n\t}\n\n\tstatic view(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#view);\n\t}\n\n\tisView(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#view;\n\t}\n\n\tstatic edit(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#edit);\n\t}\n\n\tisEdit(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#edit;\n\t}\n\n\tstatic manage(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#manage);\n\t}\n\n\tisManage(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#manage;\n\t}\n\n\tsetProperty(name: string, value: any): ViewMode\n\t{\n\t\tthis.#properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetProperty(name: string, defaultValue: any = null): ?any\n\t{\n\t\tif (this.#properties.hasOwnProperty(name))\n\t\t{\n\t\t\treturn this.#properties[name];\n\t\t}\n\n\t\treturn defaultValue;\n\t}\n\n\tstatic fromRaw(mode: number): ViewMode\n\t{\n\t\tif (ViewMode.getAll().includes(mode))\n\t\t{\n\t\t\treturn new ViewMode(mode);\n\t\t}\n\n\t\treturn ViewMode.none();\n\t}\n\n\tintoRaw(): number\n\t{\n\t\treturn this.#mode;\n\t}\n\n\tstatic getAll(): Array<number>\n\t{\n\t\treturn [\n\t\t\tthis.#none,\n\t\t\tthis.#view,\n\t\t\tthis.#edit,\n\t\t\tthis.#manage,\n\t\t];\n\t}\n}\n","import {clone, Type, Dom, Loc, Event, Tag} from \"main.core\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { getGlobalContext, ConditionGroup, TrackingStatus, HelpHint } from \"bizproc.automation\";\n\nexport class Trigger extends EventEmitter\n{\n\tdraft: boolean;\n\n\t#data: Object<string, any>;\n\t#deleted: boolean;\n\t#viewMode: ViewMode;\n\t#condition: ConditionGroup;\n\t#node: ?HTMLDivElement;\n\t#draggableItem: ?HTMLElement;\n\t#droppableItem: ?HTMLElement;\n\t#droppableColumn: ?HTMLElement;\n\t#stub: ?HTMLElement;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.draft = false;\n\t\tthis.#data = {};\n\t\tthis.#deleted = false;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#condition = new ConditionGroup();\n\t}\n\n\tget node(): HTMLDivElement\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget deleted(): boolean\n\t{\n\t\treturn this.#deleted;\n\t}\n\n\tget documentStatus(): string\n\t{\n\t\treturn this.#data['DOCUMENT_STATUS'] ?? '';\n\t}\n\n\tinit(data: Object<string, any>, viewMode: ?ViewMode): void\n\t{\n\t\tthis.#data = clone(data);\n\n\t\tif (Type.isString(this.#data['ID']))\n\t\t{\n\t\t\tconst id = parseInt(this.#data['ID']);\n\t\t\tthis.#data['ID'] = Type.isNumber(id) ? id : 0;\n\t\t}\n\t\tif (!Type.isPlainObject(this.#data['APPLY_RULES']))\n\t\t{\n\t\t\tthis.#data['APPLY_RULES'] = {};\n\t\t}\n\n\t\tif (this.#data['APPLY_RULES'].Condition)\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup(this.#data['APPLY_RULES'].Condition);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup();\n\t\t}\n\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tthis.#node = this.createNode();\n\t}\n\n\treInit(data: Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.#data['ID'] || 0;\n\t}\n\n\tgetStatusId(): string\n\t{\n\t\treturn String(this.#data['DOCUMENT_STATUS'] || '');\n\t}\n\n\tgetStatus(): ?object\n\t{\n\t\treturn getGlobalContext().document.statusList.find(status => String(status.STATUS_ID) === this.getStatusId());\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.#data['CODE'] ?? '';\n\t}\n\n\tgetName(): string\n\t{\n\t\tlet triggerName = this.#data['NAME'];\n\t\tif (!triggerName)\n\t\t{\n\t\t\tconst code = this.getCode();\n\t\t\tconst trigger = getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE']);\n\t\t\ttriggerName = trigger?.NAME ?? code;\n\t\t}\n\n\t\treturn triggerName;\n\t}\n\n\tsetName(name: string): this\n\t{\n\t\tif (Type.isString(name))\n\t\t{\n\t\t\tthis.#data['NAME'] = name;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetApplyRules()\n\t{\n\t\treturn this.#data['APPLY_RULES'];\n\t}\n\n\tsetApplyRules(rules: Object): this\n\t{\n\t\tthis.#data['APPLY_RULES'] = rules;\n\n\t\treturn this;\n\t}\n\n\tgetLogStatus()\n\t{\n\t\tconst log = getGlobalContext().tracker.getTriggerLog(this.getId());\n\t\treturn log ? log.status : null;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition: ConditionGroup): this\n\t{\n\t\tthis.#condition = condition;\n\t\treturn this;\n\t}\n\n\tisBackwardsAllowed(): boolean\n\t{\n\t\treturn this.#data['APPLY_RULES']['ALLOW_BACKWARDS'] === 'Y';\n\t}\n\n\tsetAllowBackwards(flag: boolean): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ALLOW_BACKWARDS'] = flag ? 'Y' : 'N';\n\n\t\treturn this;\n\t}\n\n\tgetExecuteBy(): string\n\t{\n\t\treturn this.#data['APPLY_RULES']['ExecuteBy'] || '';\n\t}\n\n\tsetExecuteBy(userId: number): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ExecuteBy'] = userId;\n\n\t\treturn this;\n\t}\n\n\tenableManageMode(isActive: boolean): void\n\t{\n\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\t// const checkboxNode = Tag.render`<div class=\"bizproc-automation-trigger-checkbox\"></div>`\n\t\tconst checkboxNode = Tag.render`<div class=\"ui-ctl ui-ctl-inline bizproc-automation-trigger-checkbox\">\n\t\t\t<input class=\"ui-ctl-checkbox\" type=\"checkbox\" name=\"name\">\n\t\t</div>`;\n\t\tconst deleteButton = this.#node.querySelector('[data-role=\"btn-delete-trigger\"]');\n\t\tDom.hide(deleteButton);\n\n\t\tif (isActive && deleteButton)\n\t\t{\n\t\t\tDom.append(checkboxNode, this.#node);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#node, '--locked-node');\n\t\t}\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\n\t\tconst checkboxNode = this.#node.querySelector('.bizproc-automation-trigger-checkbox');\n\t\tconst deleteButton = this.#node.querySelector('[data-role=\"btn-delete-trigger\"]');\n\n\t\tthis.#node.onclick = undefined;\n\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tthis.unselectNode();\n\n\t\tDom.removeClass(this.#node, '--locked-node');\n\t\tDom.remove(checkboxNode);\n\t\tDom.show(deleteButton);\n\t}\n\n\tselectNode()\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--selected');\n\n\t\t\tconst checkboxNode = this.#node.querySelector('input');\n\t\t\tif (checkboxNode)\n\t\t\t{\n\t\t\t\tcheckboxNode.checked = true;\n\t\t\t}\n\n\t\t\tthis.emit('Trigger:selected');\n\t\t}\n\t}\n\n\tunselectNode()\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--selected');\n\n\t\t\tconst checkboxNode = this.#node.querySelector('input');\n\t\t\tif (checkboxNode)\n\t\t\t{\n\t\t\t\tcheckboxNode.checked = false;\n\t\t\t}\n\n\t\t\tthis.emit('Trigger:unselected');\n\t\t}\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.#viewMode.isManage() && Dom.hasClass(this.node, '--selected');\n\t}\n\n\tcreateNode()\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-trigger-item-wrapper';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-draggable';\n\t\t}\n\n\t\tlet settingsBtn = null;\n\t\tlet copyBtn = null;\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tsettingsBtn = Dom.create(\"div\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-trigger-item-wrapper-edit\"\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tcopyBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-trigger-btn-copy'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY') || 'copy'\n\t\t\t});\n\n\t\t\tEvent.bind(copyBtn, 'click', this.onCopyButtonClick.bind(this, copyBtn));\n\t\t}\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete';\n\t\t}\n\t\telse if (getGlobalContext().document.getPreviousStatusIdList().includes(this.getStatusId()))\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete-light';\n\t\t}\n\n\t\tconst triggerName = this.getName();\n\n\t\tlet containerClass = 'bizproc-automation-trigger-item';\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\tcontainerClass += ' --complete';\n\t\t}\n\t\telse if (this.draft)\n\t\t{\n\t\t\tcontainerClass += ' --draft';\n\t\t}\n\n\t\tconst div = Dom.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'trigger-container',\n\t\t\t\t'className': containerClass,\n\t\t\t\t'data-type': 'item-trigger'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"bizproc-automation-trigger-item-wrapper-text\",\n\t\t\t\t\t\t\t\ttitle: triggerName,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: triggerName\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\tcopyBtn,\n\t\t\t\tsettingsBtn,\n\t\t\t]\n\t\t});\n\n\t\tif (!this.#viewMode.isEdit())\n\t\t{\n\t\t\treturn div;\n\t\t}\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'btn-delete-trigger',\n\t\t\t\t'className': 'bizproc-automation-trigger-btn-delete',\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\n\t\tdiv.appendChild(deleteBtn);\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\t\t}\n\n\t\tEvent.bind(div, 'click', () => {\n\t\t\tif (this.#viewMode.isManage() && this.#viewMode.getProperty('isActive', false))\n\t\t\t{\n\t\t\t\tif (!this.isSelected())\n\t\t\t\t{\n\t\t\t\t\tthis.selectNode();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unselectNode();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn div;\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.emit('Trigger:onSettingsOpen', {trigger: this});\n\t\t}\n\t}\n\n\tonCopyButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = this.serialize();\n\t\t\tdelete initData['ID'];\n\n\t\t\tconst clearRules = this.getSettingProperties()\n\t\t\t\t.filter((property) => property.Copyable === false)\n\t\t\t\t.map((property) => property.Id)\n\t\t\t;\n\n\t\t\tclearRules.forEach(key => delete initData['APPLY_RULES'][key]);\n\n\t\t\ttrigger.init(initData, this.#viewMode);\n\t\t\tthis.emit('Trigger:copied', {trigger});\n\t\t}\n\t}\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getName().toLowerCase().indexOf(query) >= 0;\n\n\t\tDom[match ? 'removeClass' : 'addClass'](this.#node, '--search-mismatch');\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.#draggableItem = BX.proxy_context;\n\n\t\tif (!this.#draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#stub)\n\t\t{\n\t\t\tconst itemWidth = this.#draggableItem.offsetWidth;\n\t\t\tthis.#stub = this.#draggableItem.cloneNode(true);\n\t\t\tthis.#stub.style.position = \"absolute\";\n\t\t\tthis.#stub.classList.add(\"bizproc-automation-trigger-item-drag\");\n\t\t\tthis.#stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.#stub);\n\t\t}\n\t}\n\n\tdragMove(x, y)\n\t{\n\t\tthis.#stub.style.left = x + \"px\";\n\t\tthis.#stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-trigger\")\n\t\t{\n\t\t\tthis.#droppableItem = destination;\n\t\t\tthis.#droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-trigger\")\n\t\t{\n\t\t\tthis.#droppableColumn = destination.querySelector('[data-role=\"trigger-list\"]');\n\t\t\tthis.#droppableItem = null;\n\t\t}\n\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.add(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.add(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tlet trigger = null;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\t\tconst copyTrigger = (parent, statusId) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = parent.serialize();\n\t\t\tdelete initData['ID'];\n\n\t\t\tconst clearRules = this.getSettingProperties()\n\t\t\t\t.filter((property) => property.Copyable === false)\n\t\t\t\t.map((property) => property.Id)\n\t\t\t;\n\n\t\t\tclearRules.forEach(key => delete initData['APPLY_RULES'][key]);\n\n\t\t\tinitData['DOCUMENT_STATUS'] = statusId;\n\t\t\ttrigger.init(initData, parent.#viewMode);\n\n\t\t\treturn trigger;\n\t\t};\n\n\t\tif (this.#draggableItem)\n\t\t{\n\t\t\tif (this.#droppableItem)\n\t\t\t{\n\t\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t\t\tconst thisColumn = this.#droppableItem.parentNode;\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthisColumn.insertBefore(this.#draggableItem, this.#droppableItem);\n\t\t\t\t\tthis.moveTo(thisColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, thisColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthisColumn.insertBefore(trigger.#node, this.#droppableItem);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.#droppableColumn)\n\t\t\t{\n\t\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthis.#droppableColumn.appendChild(this.#draggableItem);\n\t\t\t\t\tthis.moveTo(this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthis.#droppableColumn.appendChild(trigger.#node);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (trigger)\n\t\t\t{\n\t\t\t\tthis.emit('Trigger:copied', {\n\t\t\t\t\ttrigger,\n\t\t\t\t\tskipInsert: true,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.#stub.parentNode.removeChild(this.#stub);\n\t\tthis.#stub = null;\n\t\tthis.#draggableItem = null;\n\t\tthis.#droppableItem = null;\n\t}\n\n\tonDeleteButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(button.parentNode);\n\t\t\tthis.emit('Trigger:deleted', {trigger: this});\n\t\t}\n\t}\n\n\tupdateData(data: Object<string, any>): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tmarkDeleted(): this\n\t{\n\t\tthis.#deleted = true;\n\n\t\treturn this;\n\t}\n\n\tserialize(): Object<string, any>\n\t{\n\t\tconst data = clone(this.#data);\n\t\tif (this.#deleted)\n\t\t{\n\t\t\tdata['DELETED'] = 'Y';\n\t\t}\n\n\t\tif (!Type.isPlainObject(data.APPLY_RULES))\n\t\t{\n\t\t\tdata.APPLY_RULES = {};\n\t\t}\n\n\t\tif (!this.#condition.items.length)\n\t\t{\n\t\t\tdelete data.APPLY_RULES.Condition;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdata.APPLY_RULES.Condition = this.#condition.serialize();\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tmoveTo(statusId)\n\t{\n\t\tthis.#data['DOCUMENT_STATUS'] = statusId;\n\t\tthis.emit('Trigger:modified', {trigger: this});\n\t}\n\n\tgetReturnProperties()\n\t{\n\t\tconst triggerData = getGlobalContext().availableTriggers.find(trigger => trigger['CODE'] === this.getCode());\n\n\t\treturn triggerData && Type.isArray(triggerData.RETURN) ? triggerData.RETURN : [];\n\t}\n\n\tgetSettingProperties(): Array\n\t{\n\t\tconst triggerData = getGlobalContext().availableTriggers.find(trigger => trigger['CODE'] === this.getCode());\n\n\t\tif (triggerData.SETTINGS && triggerData.SETTINGS.Properties)\n\t\t{\n\t\t\treturn triggerData.SETTINGS.Properties;\n\t\t}\n\n\t\treturn [];\n\t}\n}","import { Type } from \"main.core\";\n\nexport class Helper\n{\n\tstatic #idIncrement = 0;\n\n\tstatic generateUniqueId()\n\t{\n\t\t++Helper.#idIncrement;\n\t\treturn 'bizproc-automation-cmp-' + Helper.#idIncrement;\n\t}\n\n\tstatic toJsonString(data)\n\t{\n\t\treturn JSON.stringify(data, function (i, v)\n\t\t{\n\t\t\tif (typeof(v) == 'boolean')\n\t\t\t{\n\t\t\t\treturn v ? '1' : '0';\n\t\t\t}\n\t\t\treturn v;\n\t\t});\n\t}\n\n\tstatic getResponsibleUserExpression(fields: Array<Object>): ?string\n\t{\n\t\tif (Type.isArray(fields))\n\t\t{\n\t\t\tfor (const field of fields)\n\t\t\t{\n\t\t\t\tif (field['Id'] === 'ASSIGNED_BY_ID' || field['Id'] === 'RESPONSIBLE_ID')\n\t\t\t\t{\n\t\t\t\t\treturn '{{'+field['Name']+'}}';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n}","export class Designer\n{\n\tstatic #instance;\n\n\trobotSettingsDialog;\n\tcomponent;\n\trobot;\n\ttriggerSettingsDialog;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Designer.#instance)\n\t\t{\n\t\t\tDesigner.#instance = new Designer();\n\t\t}\n\n\t\treturn Designer.#instance;\n\t}\n\n\tsetRobotSettingsDialog(dialog)\n\t{\n\t\tthis.robotSettingsDialog = dialog;\n\t\tthis.robot = dialog ? dialog.robot : null;\n\t}\n\n\tgetRobotSettingsDialog()\n\t{\n\t\treturn this.robotSettingsDialog;\n\t}\n\n\tsetTriggerSettingsDialog(dialog)\n\t{\n\t\tthis.triggerSettingsDialog = dialog;\n\t}\n\n\tgetTriggerSettingsDialog()\n\t{\n\t\treturn this.triggerSettingsDialog;\n\t}\n}","import { Type, Event, Loc, Dom, Text, Uri, ajax } from \"main.core\";\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { Trigger } from \"./trigger\";\nimport { Helper } from \"./helper\";\nimport { Designer } from \"./designer\";\nimport { getGlobalContext, ConditionGroup, ConditionGroupSelector } from \"bizproc.automation\";\nimport { Alert, AlertColor, AlertIcon } from \"ui.alerts\";\n\nexport class TriggerManager extends EventEmitter\n{\n\t#triggersContainerNode: HTMLElement;\n\t#viewMode: ViewMode;\n\t#triggers: Array<Trigger>;\n\t#triggersData: Array<Object<string, any>>;\n\t#columnNodes: NodeList;\n\t#listNodes: NodeList;\n\t#modified: boolean;\n\t#triggerEventsListeners: Object<string, (event: BaseEvent) => void> = {};\n\n\tconstructor(triggersContainerNode: HTMLElement)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#triggersContainerNode = triggersContainerNode;\n\t}\n\n\tasync fetchTriggers()\n\t{\n\t\tconst self = this;\n\n\t\treturn new Promise((resolve, reject) => ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: getGlobalContext().ajaxUrl,\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_triggers',\n\t\t\t\tdocument_signed: getGlobalContext().signedDocument,\n\t\t\t},\n\t\t\tonsuccess(response)\n\t\t\t{\n\t\t\t\tif (response.SUCCESS)\n\t\t\t\t{\n\t\t\t\t\tself.reInit({TRIGGERS: response.DATA.triggers}, self.#viewMode);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonerror()\n\t\t\t{\n\t\t\t\treject();\n\t\t\t}\n\t\t}));\n\t}\n\n\tinit(data: ?Object<string, any>, viewMode: ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode.isNone() ? ViewMode.edit() : viewMode;\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\t\tthis.#columnNodes = document.querySelectorAll('[data-type=\"column-trigger\"]');\n\t\tthis.#listNodes = this.#triggersContainerNode.querySelectorAll('[data-role=\"trigger-list\"]');\n\t\tthis.#modified = false;\n\t\tthis.initTriggers();\n\n\t\tthis.markModified(false);\n\n\t\t//register DD\n\t\tthis.#columnNodes.forEach(columnNode => jsDD.registerDest(columnNode, 10));\n\n\t\ttop.BX.addCustomEvent(\n\t\t\ttop,\n\t\t\t'Rest:AppLayout:ApplicationInstall',\n\t\t\tthis.onRestAppInstall.bind(this)\n\t\t);\n\t}\n\n\treInit(data: ?Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode || ViewMode.none();\n\t\tthis.#listNodes.forEach(node => Dom.clean(node));\n\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\n\t\tthis.initTriggers();\n\n\t\tthis.markModified(false);\n\t}\n\n\tinitTriggers()\n\t{\n\t\tthis.#triggers = [];\n\t\tthis.#triggersData.forEach((triggerData) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\ttrigger.init(triggerData, this.#viewMode);\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\tthis.#triggers.push(trigger);\n\t\t});\n\t}\n\n\tsubscribeTriggerEvents(trigger: Trigger)\n\t{\n\t\ttrigger.subscribe('Trigger:copied', (event) => {\n\t\t\tconst trigger = event.data.trigger;\n\n\t\t\tthis.#triggers.push(trigger);\n\t\t\tif (!event.data.skipInsert)\n\t\t\t{\n\t\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\t}\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.markModified();\n\t\t});\n\t\ttrigger.subscribe('Trigger:modified', () => this.markModified());\n\t\ttrigger.subscribe('Trigger:onSettingsOpen', (event) => {\n\t\t\tthis.openTriggerSettingsDialog(event.data.trigger);\n\t\t});\n\t\ttrigger.subscribe('Trigger:deleted', (event) => this.deleteTrigger(event.data.trigger));\n\n\t\tObject\n\t\t\t.entries(this.#triggerEventsListeners)\n\t\t\t.forEach(([eventName, listener]) => trigger.subscribe(eventName, listener));\n\t}\n\n\tonTriggerEvent(eventName: string, listener: (event: BaseEvent, trigger: Trigger) => void)\n\t{\n\t\tthis.#triggerEventsListeners[eventName] = listener;\n\n\t\tthis.#triggers.forEach((trigger: Trigger) => {\n\t\t\ttrigger.subscribe(eventName, (event) => listener(event, trigger))\n\t\t});\n\t}\n\n\tgetSelectedTriggers(): Array<Trigger>\n\t{\n\t\treturn this.#triggers.filter(trigger => trigger.isSelected());\n\t}\n\n\tonSearch(event)\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.onSearch(event));\n\t}\n\n\tenableManageMode(status)\n\t{\n\t\tthis.#viewMode = ViewMode.manage();\n\n\t\tdocument.querySelectorAll('[data-role=\"trigger-list\"]').forEach((listNode) => {\n\t\t\tif (listNode.dataset.statusId === status)\n\t\t\t{\n\t\t\t\tDom.addClass(listNode, '--multiselect-mode');\n\t\t\t}\n\t\t});\n\t\tthis.#triggers.forEach((trigger) => {\n\t\t\ttrigger.enableManageMode(trigger.documentStatus === status)\n\t\t});\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\n\t\tdocument.querySelectorAll('[data-role=\"trigger-list\"]').forEach((listNode) => {\n\t\t\tDom.removeClass(listNode, '--multiselect-mode');\n\t\t});\n\n\t\tthis.#triggers.forEach(trigger => trigger.disableManageMode());\n\t}\n\n\taddTrigger(triggerData: ?Object<string, any>, callback)\n\t{\n\t\tconst trigger = new Trigger();\n\t\ttrigger.draft = true;\n\t\ttrigger.init(triggerData, this.#viewMode);\n\t\tthis.subscribeTriggerEvents(trigger);\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, trigger);\n\t\t}\n\t\tthis.emit('TriggerManager:trigger:add', {trigger});\n\t}\n\n\tdeleteTrigger(trigger: Trigger, callback)\n\t{\n\t\tif (trigger.getId() > 0)\n\t\t{\n\t\t\ttrigger.markDeleted();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(let i = 0; i < this.#triggers.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#triggers[i] === trigger)\n\t\t\t\t{\n\t\t\t\t\tthis.#triggers.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback(trigger);\n\t\t}\n\n\t\tthis.emit('TriggerManager:trigger:delete', { trigger });\n\n\t\tthis.markModified();\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.registerItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.addClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.unregisterItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tinsertTrigger(trigger)\n\t{\n\t\tthis.#triggers.push(trigger);\n\t\tthis.markModified(true);\n\t}\n\n\tinsertTriggerNode(documentStatus: string, triggerNode)\n\t{\n\t\tconst listNode = this.#triggersContainerNode.querySelector('[data-role=\"trigger-list\"][data-status-id=\"'+documentStatus+'\"]');\n\t\tif (listNode)\n\t\t{\n\t\t\tDom.append(triggerNode, listNode);\n\t\t}\n\t}\n\n\tserialize(): Array<Object<string, any>>\n\t{\n\t\treturn this.#triggers.map(trigger => trigger.serialize());\n\t}\n\n\tcountAllTriggers(): number\n\t{\n\t\treturn this.#triggers.filter(trigger => !trigger.deleted).length;\n\t}\n\n\tfindTriggerById(id: number): Trigger | undefined\n\t{\n\t\treturn this.#triggers.find(trigger => trigger.getId() === id);\n\t}\n\n\tfindTriggersByDocumentStatus(statusId: string): Array<Trigger>\n\t{\n\t\treturn this.#triggers.filter(trigger => trigger.getStatusId() === statusId);\n\t}\n\n\tgetTriggerName(code: string)\n\t{\n\t\treturn getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE'])?.NAME ?? code;\n\t}\n\n\tgetAvailableTrigger(code): ?Object\n\t{\n\t\tconst availableTriggers = getGlobalContext().availableTriggers;\n\t\tfor (let i = 0; i < availableTriggers.length; ++i)\n\t\t{\n\t\t\tif (code === availableTriggers[i]['CODE'])\n\t\t\t{\n\t\t\t\treturn availableTriggers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tcanSetExecuteBy(): boolean\n\t{\n\t\treturn getGlobalContext().get('TRIGGER_CAN_SET_EXECUTE_BY') ?? false;\n\t}\n\n\tneedSave()\n\t{\n\t\treturn this.#modified;\n\t}\n\n\tmarkModified(modified: boolean)\n\t{\n\t\tthis.#modified = modified !== false;\n\t\tif (this.#modified)\n\t\t{\n\t\t\tthis.emit('TriggerManager:dataModified');\n\t\t}\n\t}\n\n\topenTriggerSettingsDialog(trigger, context)\n\t{\n\t\tif (Designer.getInstance().getTriggerSettingsDialog())\n\t\t{\n\t\t\tif (context && context.changeTrigger)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getTriggerSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_trigger_dialog';\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tDom.append(this.renderConditionSettings(trigger), form);\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {click: (event) => this.emit('TriggerManager:onHelpClick', event)}\n\t\t});\n\t\tDom.append(iconHelp, form);\n\n\t\tconst title = this.getTriggerName(trigger.getCode());\n\n\t\tDom.append(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_NAME') + ':'\n\t\t}), form);\n\n\t\tDom.append(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: trigger.getName() || title\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t],\n\t\t}), form);\n\n\t\tconst triggerData = this.getAvailableTrigger(trigger.getCode());\n\n\t\tif (triggerData && triggerData['SETTINGS'])\n\t\t{\n\t\t\tthis.#renderTriggerProperties(trigger, triggerData['SETTINGS']['Properties'], form);\n\t\t}\n\n\t\tBX.onCustomEvent(\n\t\t\t'BX.Bizproc.Automation.TriggerManager:onOpenSettingsDialog-' + trigger.getCode(),\n\t\t\t[trigger, form]\n\t\t);\n\n\t\tif (this.canSetExecuteBy())\n\t\t{\n\t\t\tthis.renderExecuteByControl(trigger, form);\n\t\t}\n\n\t\tthis.renderAllowBackwardsControl(trigger, form);\n\n\t\tDom.addClass(this.#triggersContainerNode, 'automation-base-blocked');\n\n\t\tDesigner.getInstance().setTriggerSettingsDialog({\n\t\t\ttriggerManager: this,\n\t\t\ttrigger: trigger,\n\t\t\tform: form\n\t\t});\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: title,\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function(popup)\n\t\t\t\t{\n\t\t\t\t\tDesigner.getInstance().setTriggerSettingsDialog(null);\n\t\t\t\t\tself.destroySettingsDialogControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tDom.removeClass(self.#triggersContainerNode, 'automation-base-blocked');\n\t\t\t\t\tself.emit('TriggerManager:onCloseTriggerSettingsDialog')\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\t\t\t\t\ttrigger.setName(formData['data']['name']);\n\n\t\t\t\t\t\t\tif (triggerData['SETTINGS'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#setTriggerProperties(trigger, triggerData['SETTINGS']['Properties'], form);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\t\t\t\t'BX.Bizproc.Automation.TriggerManager:onSaveSettings-'+trigger.getCode(),\n\t\t\t\t\t\t\t\t[trigger, formData]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tself.setConditionSettingsFromForm(formData['data'], trigger);\n\t\t\t\t\t\t\ttrigger.setAllowBackwards(formData['data']['allow_backwards'] === 'Y');\n\n\t\t\t\t\t\t\tif (self.canSetExecuteBy())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setExecuteBy(formData['data']['execute_by']);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.draft)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// remove orange/yellow color\n\n\t\t\t\t\t\t\t\t//self.#triggers.push(trigger);\n\t\t\t\t\t\t\t\t//self.insertTriggerNode(trigger.getStatusId(), trigger.node)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//analytics\n\t\t\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t\t\t'bizproc.analytics.push',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tanalyticsLabel: `automation_trigger${trigger.draft ? '_draft' : ''}_save_${trigger.getCode().toLowerCase()}`\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tdelete trigger.draft;\n\n\t\t\t\t\t\t\ttrigger.reInit();\n\t\t\t\t\t\t\tself.markModified();\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tDesigner.getInstance().getTriggerSettingsDialog().popup = popup;\n\t\tpopup.show();\n\n\t\t//analytics\n\t\tajax.runAction(\n\t\t\t'bizproc.analytics.push',\n\t\t\t{\n\t\t\t\tanalyticsLabel: `automation_trigger${trigger.draft ? '_draft' : ''}_settings_${trigger.getCode().toLowerCase()}`\n\t\t\t}\n\t\t);\n\t}\n\n\t#renderTriggerProperties(trigger: Trigger, properties: [], form: Element)\n\t{\n\t\tproperties.forEach((property) => {\n\n\t\t\tconst value = trigger.getApplyRules()[property.Id];\n\n\t\t\tif (property.Type === '@condition-group-selector')\n\t\t\t{\n\t\t\t\tthis.#renderConditionGroupSelector(property, value, form);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (property.Type === '@webhook-code')\n\t\t\t{\n\t\t\t\tthis.#renderWebhookCodeProperty(property, value, form);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (property.Type === '@field-selector')\n\t\t\t{\n\t\t\t\tthis.#renderFieldSelectorProperty(property, value, form);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst toRenderProperty = {AllowSelection: false, ...property};\n\n\t\t\tif (toRenderProperty.Type === '@robot-select')\n\t\t\t{\n\t\t\t\tthis.#prepareRobotSelectProperty(toRenderProperty);\n\t\t\t}\n\n\t\t\tDom.append(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-top bizproc-automation-popup-settings-title-autocomplete\",\n\t\t\t\t},\n\t\t\t\ttext: property.Name + ':',\n\t\t\t}), form);\n\n\t\t\tDom.append(Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.Bizproc.FieldType.renderControl(\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t...getGlobalContext().document.getRawType(),\n\t\t\t\t\t\t\tgetGlobalContext().document.getCategoryId(),\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttoRenderProperty,\n\t\t\t\t\t\tproperty.Id,\n\t\t\t\t\t\tvalue || ''\n\t\t\t\t\t)\n\t\t\t\t],\n\t\t\t}), form);\n\t\t});\n\t}\n\n\t#prepareRobotSelectProperty(property)\n\t{\n\t\tconst cmp = Designer.getInstance().component;\n\t\tproperty.Options = [];\n\t\tconst filter = property.Settings.Filter;\n\t\tconst check = (robot) =>\n\t\t{\n\t\t\tfor (const field in filter)\n\t\t\t{\n\t\t\t\tif (robot.data[field] !== filter[field])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t};\n\n\t\tcmp.templateManager.templates.forEach((template) => {\n\t\t\ttemplate.robots.forEach((robot) => {\n\t\t\t\tif (check(robot))\n\t\t\t\t{\n\t\t\t\t\tproperty.Options.push(\n\t\t\t\t\t\t{value: robot.getId(), name: robot.getProperty(property.Settings.OptionNameProperty)}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tdelete property.Settings;\n\t\tproperty.Type = 'select';\n\t}\n\n\t#setTriggerProperties(trigger: Trigger, properties: [], form: Element)\n\t{\n\t\tconst values = {};\n\n\t\tproperties.forEach((property) => {\n\n\t\t\tif (property.Type === '@condition-group-selector')\n\t\t\t{\n\t\t\t\tvalues[property.Id] = this.#setConditionGroupValue(property, form);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\tvalues[property.Id] = formData.data[property.Id];\n\t\t});\n\n\t\ttrigger.setApplyRules(values);\n\t}\n\n\trenderConditionSettings(trigger: Trigger)\n\t{\n\t\tconst conditionGroup = trigger.getCondition().clone();\n\n\t\tthis.conditionSelector = new ConditionGroupSelector(\n\t\t\tconditionGroup,\n\t\t\t{\n\t\t\t\tfields: getGlobalContext().document.getFields(),\n\t\t\t\tshowValuesSelector: false,\n\t\t\t},\n\t\t);\n\t\tconst selector = this.conditionSelector;\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\",\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselector.createNode(),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\t#renderConditionGroupSelector(property, value, form)\n\t{\n\t\tconst selector = new ConditionGroupSelector(new ConditionGroup(value), {\n\t\t\tfields: property.Settings.Fields,\n\t\t\tfieldPrefix: property.Id,\n\t\t\tshowValuesSelector: false,\n\t\t});\n\n\t\tDom.append(\n\t\t\tDom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\t\ttext: property.Name + \":\"\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tselector.createNode()\n\t\t\t\t\t\t]\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t}),\n\t\t\tform\n\t\t);\n\t}\n\n\t#setConditionGroupValue(property, form)\n\t{\n\t\tconst formData = BX.ajax.prepareForm(form);\n\t\tconst conditionGroup = ConditionGroup.createFromForm(\n\t\t\tformData['data'],\n\t\t\tproperty.Id\n\t\t);\n\n\t\treturn conditionGroup.serialize();\n\t}\n\n\t#renderWebhookCodeProperty(property, value, form)\n\t{\n\t\tif (!value)\n\t\t{\n\t\t\tvalue = Text.getRandom(5);\n\t\t}\n\n\t\tDom.append(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: property.Name + ':'\n\t\t}), form);\n\n\t\tDom.append(Dom.create('input', {\n\t\t\tprops: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tvalue: value,\n\t\t\t\tname: 'code'\n\t\t\t}\n\t\t}), form);\n\n\t\tconst hookLinkTextarea = Dom.create(\"textarea\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-textarea\",\n\t\t\t\tplaceholder: \"...\",\n\t\t\t\treadonly: 'readonly',\n\t\t\t\tname: 'webhook_handler'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick()\n\t\t\t\t{\n\t\t\t\t\tthis.select();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tDom.append(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [hookLinkTextarea]\n\t\t}), form);\n\n\t\tDom.append(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_WEBHOOK_ID'),\n\t\t}), form);\n\n\t\tif (property.Settings.Handler)\n\t\t{\n\t\t\tlet url = window.location.protocol + '//' + window.location.host + property.Settings.Handler;\n\t\t\turl = Uri.addParam(url, {code: value});\n\t\t\turl = url.replace('{{DOCUMENT_TYPE}}', getGlobalContext().document.getRawType()[2]);\n\t\t\turl = url.replace('{{USER_ID}}', Loc.getMessage('USER_ID'));\n\n\t\t\tif (property.Settings.Password)\n\t\t\t{\n\t\t\t\turl = url.replace('{{PASSWORD}}', property.Settings.Password);\n\t\t\t}\n\n\t\t\thookLinkTextarea.value = url;\n\t\t}\n\n\t\tif (!property.Settings.Password && property.Settings.PasswordLoader)\n\t\t{\n\t\t\tconst myAlertText =\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_WEBHOOK_PASSWORD_ALERT')\n\t\t\t\t\t.replace(\n\t\t\t\t\t\t'#A1#',\n\t\t\t\t\t\t'<a class=\"bizproc-automation-popup-settings-link '\n\t\t\t\t\t\t+ 'bizproc-automation-popup-settings-link-light\" data-role=\"token-gen\">'\n\t\t\t\t\t)\n\t\t\t\t\t.replace('#A2#', '</a>')\n\t\t\t;\n\n\t\t\tconst passwordAlert = new Alert({\n\t\t\t\tcolor: AlertColor.WARNING,\n\t\t\t\ticon: AlertIcon.WARNING,\n\t\t\t\ttext: myAlertText\n\t\t\t});\n\n\t\t\tEvent.bind(\n\t\t\t\tpasswordAlert.getTextContainer().querySelector('[data-role=\"token-gen\"]'),\n\t\t\t\t'click',\n\t\t\t\t() =>\n\t\t\t\t{\n\t\t\t\t\tconst loaderConfig = property.Settings.PasswordLoader;\n\n\t\t\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t\t\tloaderConfig.component,\n\t\t\t\t\t\tloaderConfig.action,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmode: loaderConfig.mode || undefined,\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tdocumentType: [\n\t\t\t\t\t\t\t\t\t...getGlobalContext().document.getRawType(),\n\t\t\t\t\t\t\t\t\tgetGlobalContext().document.getCategoryId(),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t).then(\n\t\t\t\t\t\tfunction(response)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (response.data.error)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twindow.alert(response.data.error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (response.data.password)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tproperty.Settings.Password = response.data.password;\n\t\t\t\t\t\t\t\thookLinkTextarea.value = hookLinkTextarea\n\t\t\t\t\t\t\t\t\t.value.replace('{{PASSWORD}}', property.Settings.Password)\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\tpasswordAlert.handleCloseBtnClick();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tDom.append(passwordAlert.getContainer(), form);\n\t\t}\n\t}\n\n\t#renderFieldSelectorProperty(property, value, form)\n\t{\n\t\tconst menuId = '@field-selector' + Math.random();\n\t\tconst fieldName = property.Id + '[]';\n\n\t\tconst fieldsList = property.Settings.Fields;\n\n\t\tconst renderFieldCheckbox = function(field, listNode)\n\t\t{\n\t\t\tconst exists = listNode.querySelector('[data-field=\"' + field['Id'] + '\"]');\n\t\t\tif (exists)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.append(\n\t\t\t\tDom.create(\n\t\t\t\t\t'div',\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-checkbox-item',\n\t\t\t\t\t\t\t'data-field': field['Id']\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t\t'label',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-chk-label'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t\t\t\t\t'input', {\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-chk',\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: fieldName,\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: field['Id'],\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tchecked: true\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\tdocument.createTextNode(field['Name']),\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\tlistNode\n\t\t\t);\n\t\t}\n\n\t\tconst fieldSelectorHandler = function(targetNode, listNode)\n\t\t{\n\t\t\tif (BX.Main.MenuManager.getMenuById(menuId))\n\t\t\t{\n\t\t\t\treturn BX.Main.MenuManager.getMenuById(menuId).show();\n\t\t\t}\n\n\t\t\tconst menuItems = [];\n\n\t\t\tfieldsList.forEach(function(field)\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: BX.Text.encode(field['Name']),\n\t\t\t\t\tfield: field,\n\t\t\t\t\tonclick: function(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\trenderFieldCheckbox(item.field, listNode);\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tBX.Main.MenuManager.show(\n\t\t\t\tmenuId,\n\t\t\t\ttargetNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetLeft: (BX.pos(this)['width'] / 2),\n\t\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\t\tzIndex: 200,\n\t\t\t\t\tclassName: 'bizproc-automation-inline-selector-menu',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupClose: function(popup)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tDom.append(\n\t\t\tDom.create(\n\t\t\t\t'span',\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: property.Name + ':',\n\t\t\t\t}\n\t\t\t),\n\t\t\tform\n\t\t);\n\n\t\tconst fieldListNode = Dom.create(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-popup-checkbox',\n\t\t\t\t},\n\t\t\t\tchildren: [],\n\t\t\t}\n\t\t);\n\t\tDom.append(fieldListNode, form);\n\n\t\tDom.append(\n\t\t\tDom.create(\n\t\t\t\t'div',\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings bizproc-automation-popup-settings-text',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t'span',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: property.Settings.ChooseFieldLabel,\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tclick: function()\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfieldSelectorHandler(this, fieldListNode);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t),\n\t\t\tform\n\t\t);\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue.forEach(function(field)\n\t\t\t{\n\t\t\t\tconst foundField = fieldsList.find((fld) => fld.Id === field);\n\t\t\t\tif (foundField)\n\t\t\t\t{\n\t\t\t\t\trenderFieldCheckbox(foundField, fieldListNode);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\trenderExecuteByControl(trigger, form)\n\t{\n\t\tDom.append(Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-top bizproc-automation-popup-settings-title-autocomplete\",\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_EXECUTE_BY') + ':',\n\t\t}), form);\n\n\t\tDom.append(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tBX.Bizproc.FieldType.renderControl(\n\t\t\t\t\t[\n\t\t\t\t\t\t...getGlobalContext().document.getRawType(),\n\t\t\t\t\t\tgetGlobalContext().document.getCategoryId(),\n\t\t\t\t\t],\n\t\t\t\t\t{\n\t\t\t\t\t\tType: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t'execute_by',\n\t\t\t\t\ttrigger.draft\n\t\t\t\t\t\t? Helper.getResponsibleUserExpression(getGlobalContext().document.getFields())\n\t\t\t\t\t\t: trigger.getExecuteBy(),\n\t\t\t\t),\n\t\t\t],\n\t\t}), form);\n\t}\n\n\trenderAllowBackwardsControl(trigger, form)\n\t{\n\t\tDom.append(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox-item\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-chk-label\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-chk',\n\t\t\t\t\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\t\t\t\t\tname: \"allow_backwards\",\n\t\t\t\t\t\t\t\t\t\tvalue: 'Y'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tchecked: trigger.isBackwardsAllowed()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdocument.createTextNode(Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_ALLOW_REVERSE')),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t}), form);\n\t}\n\n\tsetConditionSettingsFromForm(formFields: Object,  trigger: Trigger): this\n\t{\n\t\ttrigger.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\tonRestAppInstall(installed, eventResult)\n\t{\n\t\teventResult.redirect = false;\n\t\tconst self = this;\n\n\t\tsetTimeout(function()\n\t\t{\n\t\t\tBX.ajax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: getGlobalContext().ajaxUrl,\n\t\t\t\tdata: {\n\t\t\t\t\tajax_action: 'get_available_triggers',\n\t\t\t\t\tdocument_signed: getGlobalContext().signedDocument\n\t\t\t\t},\n\t\t\t\tonsuccess(response)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isArray(response['DATA']))\n\t\t\t\t\t{\n\t\t\t\t\t\tgetGlobalContext().set('availableTriggers', response['DATA']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}, 1500);\n\t}\n\n\tinitSettingsDialogControls(node)\n\t{\n\t\tif (!Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tthis.settingsDialogControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tlet control = null;\n\t\t\tconst role = controlNodes[i].getAttribute('data-role');\n\n\t\t\tif (role === 'user-selector')\n\t\t\t{\n\t\t\t\tcontrol = BX.Bizproc.UserSelector.decorateNode(controlNodes[i]);\n\t\t\t}\n\n\t\t\tBX.UI.Hint.init(controlNodes[i]);\n\n\t\t\tif (control)\n\t\t\t{\n\t\t\t\tthis.settingsDialogControls.push(control);\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroySettingsDialogControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.settingsDialogControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.settingsDialogControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.settingsDialogControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.settingsDialogControls = null;\n\t}\n\n\tgetListByDocumentStatus(statusId): Array<Trigger>\n\t{\n\t\tconst result = [];\n\t\tthis.#triggers.forEach((trigger) => {\n\t\t\tif (trigger.getStatusId() === statusId)\n\t\t\t{\n\t\t\t\tresult.push(trigger);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperties(statusId): Array<Object>\n\t{\n\t\tconst result = [];\n\t\tconst exists = {};\n\t\tconst triggers = this.getListByDocumentStatus(statusId);\n\n\t\ttriggers.forEach((trigger) => {\n\t\t\tconst props = trigger.deleted ? [] : trigger.getReturnProperties();\n\t\t\tif (props.length)\n\t\t\t{\n\t\t\t\tprops.forEach((property) => {\n\t\t\t\t\tif (!exists[property.Id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tId: property.Id,\n\t\t\t\t\t\t\tObjectId: 'Template',\n\t\t\t\t\t\t\tName: property.Name,\n\t\t\t\t\t\t\tObjectName: trigger.getName(),\n\t\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\t\tExpression: '{{~*:'+property.Id+'}}',\n\t\t\t\t\t\t\tSystemExpression: '{=Template:'+property.Id+'}'\n\t\t\t\t\t\t});\n\t\t\t\t\t\texists[property.Id] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperty(statusId, propertyId): ?Object\n\t{\n\t\tconst properties = this.getReturnProperties(statusId);\n\t\tfor (let i = 0; i < properties.length; ++i)\n\t\t{\n\t\t\tif (properties[i].Id === propertyId)\n\t\t\t{\n\t\t\t\treturn properties[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { Type, Runtime } from 'main.core';\n\nexport class Document\n{\n\t#rawType: Array<string>;\n\t#id: number;\n\t#title: ?string;\n\t#categoryId: ?number;\n\t#statusList: ?Array<Object>;\n\t#currentStatusIndex: number;\n\n\t#fields: ?Array<Object>;\n\n\tconstructor(options: {\n\t\trawDocumentType: Array<string>,\n\t\tdocumentId: number,\n\t\tcategoryId?: number,\n\t\tstatusId?: string,\n\n\t\tstatusList: Array<Object>,\n\n\t\tdocumentFields?: Array<Object>;\n\t\ttitle?: string,\n\t})\n\t{\n\t\tthis.#rawType = options.rawDocumentType;\n\t\tthis.#id = options.documentId;\n\t\tthis.#title = options.title;\n\t\tthis.#categoryId = options.categoryId;\n\n\t\tthis.#statusList = [];\n\t\tthis.#currentStatusIndex = 0;\n\t\tif (Type.isArray(options.statusList))\n\t\t{\n\t\t\tthis.#statusList = options.statusList.map((status) => {\n\t\t\t\tstatus.STATUS_ID = String(status.STATUS_ID);\n\n\t\t\t\treturn status;\n\t\t\t})\n\t\t\tthis.#currentStatusIndex = this.#statusList.findIndex(status => status.STATUS_ID === options.statusId)\n\t\t}\n\t\telse if (Type.isStringFilled(options.statusId))\n\t\t{\n\t\t\tthis.#statusList.push(options.statusId);\n\t\t}\n\n\t\tif (this.#currentStatusIndex < 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = 0;\n\t\t}\n\n\t\tthis.#fields = Type.isArray(options.documentFields) ? options.documentFields : [];\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new Document({\n\t\t\trawDocumentType: Runtime.clone(this.#rawType),\n\t\t\tdocumentId: this.#id,\n\t\t\tcategoryId: this.#categoryId,\n\t\t\tstatusId: this.getCurrentStatusId(),\n\n\t\t\tstatusList: Runtime.clone(this.#statusList),\n\n\t\t\tdocumentFields: Runtime.clone(this.#fields),\n\t\t\ttitle: this.#title,\n\t\t});\n\t}\n\n\tget title(): ?string\n\t{\n\t\treturn this.#title;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetRawType(): Array<string>\n\t{\n\t\treturn this.#rawType;\n\t}\n\n\tgetCategoryId(): ?number\n\t{\n\t\treturn this.#categoryId;\n\t}\n\n\tgetCurrentStatusId(): ?string\n\t{\n\t\tconst documentStatus = this.#statusList[this.#currentStatusIndex]?.STATUS_ID;\n\n\t\treturn !Type.isNil(documentStatus) ? String(documentStatus) : documentStatus;\n\t}\n\n\tgetSortedStatusId(index: number): ?string\n\t{\n\t\tif (index >= 0 && index < this.#statusList.length)\n\t\t{\n\t\t\treturn this.#statusList[index].STATUS_ID;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetNextStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(this.#currentStatusIndex + 1).map(status => status.STATUS_ID);\n\t}\n\n\tgetPreviousStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(0, this.#currentStatusIndex).map(status => status.STATUS_ID);\n\t}\n\n\tsetStatus(statusId: string): Document\n\t{\n\t\tconst newStatusId = this.#statusList.findIndex(status => status.STATUS_ID === statusId);\n\t\tif (newStatusId >= 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = newStatusId;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetFields(): Array<Object>\n\t{\n\t\treturn this.#fields;\n\t}\n\n\tsetFields(documentFields: Array<object>): this\n\t{\n\t\tthis.#fields = documentFields;\n\n\t\treturn this;\n\t}\n\n\tsetStatusList(statusList: Array<Object>): this\n\t{\n\t\tif (Type.isArrayFilled(statusList))\n\t\t{\n\t\t\tthis.#statusList = statusList;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget statusList(): ?Array<Object>\n\t{\n\t\treturn this.#statusList;\n\t}\n}","import { Type, Loc } from 'main.core';\n\nexport class DelayInterval\n{\n\tstatic BASIS_TYPE = {\n\t\tCurrentDate: '{=System:Date}',\n\t\tCurrentDateTime: '{=System:Now}',\n\t\tCurrentDateTimeLocal: '{=System:NowLocal}',\n\t};\n\n\tstatic DELAY_TYPE = {\n\t\tAfter: 'after',\n\t\tBefore: 'before',\n\t\tIn: 'in',\n\t};\n\n\t#basis: string = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t#type: string = DelayInterval.DELAY_TYPE.After;\n\t#value: number = 0;\n\t#valueType: string = 'i';\n\t#workTime: boolean = false;\n\t#waitWorkDay: boolean = false;\n\t#inTime: ?Array<[number, number]>;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.setType(params['type']);\n\t\t\t}\n\t\t\tif (params['value'])\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t\tif (params['valueType'])\n\t\t\t{\n\t\t\t\tthis.setValueType(params['valueType']);\n\t\t\t}\n\t\t\tif (params['basis'])\n\t\t\t{\n\t\t\t\tthis.setBasis(params['basis']);\n\t\t\t}\n\t\t\tif (params['workTime'])\n\t\t\t{\n\t\t\t\tthis.setWorkTime(params['workTime']);\n\t\t\t}\n\t\t\tif (params['waitWorkDay'])\n\t\t\t{\n\t\t\t\tthis.setWaitWorkDay(params['waitWorkDay']);\n\t\t\t}\n\t\t\tif (params['inTime'])\n\t\t\t{\n\t\t\t\tthis.setInTime(params['inTime']);\n\t\t\t}\n\t\t}\n\t}\n\n\tget basis()\n\t{\n\t\treturn this.#basis;\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tget valueType()\n\t{\n\t\treturn this.#valueType;\n\t}\n\n\tget workTime()\n\t{\n\t\treturn this.#workTime;\n\t}\n\n\tget waitWorkDay()\n\t{\n\t\treturn this.#waitWorkDay;\n\t}\n\n\tget inTime()\n\t{\n\t\treturn this.#inTime;\n\t}\n\n\tget inTimeString(): string\n\t{\n\t\tif (!this.#inTime)\n\t\t{\n\t\t\treturn ''\n\t\t}\n\n\t\treturn ('0' + this.#inTime[0]).slice(-2) + ':' + ('0' + this.#inTime[1]).slice(-2);\n\t}\n\n\tclone()\n\t{\n\t\treturn new DelayInterval({\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime,\n\t\t\twaitWorkDay: this.#waitWorkDay,\n\t\t\tinTime: this.#inTime,\n\t\t});\n\t}\n\n\tstatic isSystemBasis(basis: string): boolean\n\t{\n\t\treturn (\n\t\t\tbasis === this.BASIS_TYPE.CurrentDate\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTime\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTimeLocal\n\t\t);\n\t}\n\n\tstatic fromString(intervalString, basisFields): this\n\t{\n\t\tif (!intervalString)\n\t\t{\n\t\t\treturn new DelayInterval();\n\t\t}\n\n\t\tintervalString = intervalString.toString().trimStart().replace(/^=/, '');\n\t\tconst params = {\n\t\t\tbasis: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\tworkTime: false,\n\t\t\tinTime: null,\n\t\t};\n\n\t\tconst values = {\n\t\t\ti: 0,\n\t\t\th: 0,\n\t\t\td: 0,\n\t\t};\n\n\t\tif (intervalString.indexOf('settime(') === 0)\n\t\t{\n\t\t\tintervalString = intervalString.substring(8, intervalString.length - 1);\n\n\t\t\tconst setTimeArgs = intervalString.split(',');\n\t\t\tconst minute = parseInt(setTimeArgs.pop().trim());\n\t\t\tconst hour = parseInt(setTimeArgs.pop().trim());\n\n\t\t\tparams.inTime = [hour || 0, minute || 0];\n\t\t\tintervalString = setTimeArgs.join(',');\n\t\t}\n\n\t\tif (intervalString.indexOf('dateadd(') === 0 || intervalString.indexOf('workdateadd(') === 0)\n\t\t{\n\t\t\tif (intervalString.indexOf('workdateadd(') === 0)\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(12, intervalString.length - 1);\n\t\t\t\tparams['workTime'] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(8, intervalString.length - 1);\n\t\t\t}\n\n\t\t\tconst fnArgs = intervalString.split(',');\n\t\t\tparams['basis'] = fnArgs[0].trim();\n\t\t\tfnArgs[1] = (fnArgs[1] || '').replace(/['\")]+/g, '');\n\t\t\tparams['type'] = fnArgs[1].indexOf('-') === 0 ? DelayInterval.DELAY_TYPE.Before : DelayInterval.DELAY_TYPE.After;\n\n\t\t\tlet match;\n\t\t\tconst re = /s*([\\d]+)\\s*(i|h|d)\\s*/ig;\n\t\t\twhile (match = re.exec(fnArgs[1]))\n\t\t\t{\n\t\t\t\tvalues[match[2]] = parseInt(match[1]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['basis'] = intervalString;\n\t\t}\n\n\t\tif (!DelayInterval.isSystemBasis(params['basis']) && BX.type.isArray(basisFields))\n\t\t{\n\t\t\tlet found = false;\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (params['basis'] === basisFields[i].SystemExpression || params['basis'] === basisFields[i].Expression)\n\t\t\t\t{\n\t\t\t\t\tparams['basis'] = basisFields[i].SystemExpression;\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\tparams['basis'] = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t\t\t}\n\t\t}\n\n\t\tconst minutes = values['i'] + values['h'] * 60 + values['d'] * 60 * 24;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 1440;\n\t\t\tparams['valueType'] = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 60;\n\t\t\tparams['valueType'] = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['value'] = minutes;\n\t\t\tparams['valueType'] = 'i';\n\t\t}\n\n\t\tif (\n\t\t\t!params['value']\n\t\t\t&& (\n\t\t\t\tparams['basis'] !== DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t\t|| params.inTime\n\t\t\t)\n\t\t\t&& params['basis']\n\t\t)\n\t\t{\n\t\t\tparams['type'] = DelayInterval.DELAY_TYPE.In;\n\t\t}\n\n\t\treturn new DelayInterval(params);\n\t};\n\n\tstatic fromMinutes(minutes): Array<string>\n\t{\n\t\tlet value;\n\t\tlet type;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tvalue = minutes / 1440;\n\t\t\ttype = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tvalue = minutes / 60;\n\t\t\ttype = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalue = minutes;\n\t\t\ttype = 'i';\n\t\t}\n\n\t\treturn [value, type];\n\t}\n\n\tstatic toMinutes(value, valueType): number\n\t{\n\t\tlet result = 0;\n\n\t\tswitch (valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tresult = value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\tresult = value * 60;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tresult = value * 60 * 24;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetType(type): this\n\t{\n\t\tif (\n\t\t\ttype !== DelayInterval.DELAY_TYPE.After\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.Before\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.In\n\t\t)\n\t\t{\n\t\t\ttype = DelayInterval.DELAY_TYPE.After;\n\t\t}\n\t\tthis.#type = type;\n\n\t\treturn this;\n\t}\n\n\tsetValue(value): this\n\t{\n\t\tvalue = parseInt(value);\n\t\tthis.#value = value >= 0 ? value : 0;\n\n\t\treturn this;\n\t}\n\n\tsetValueType(valueType: string): this\n\t{\n\t\tif (valueType !== 'i' && valueType !== 'h' && valueType !== 'd')\n\t\t{\n\t\t\tvalueType = 'i';\n\t\t}\n\n\t\tthis.#valueType = valueType;\n\n\t\treturn this;\n\t}\n\n\tsetBasis(basis: string): this\n\t{\n\t\tif (Type.isString(basis) && basis !== '')\n\t\t{\n\t\t\tthis.#basis = basis;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetWorkTime(flag): this\n\t{\n\t\tthis.#workTime = !!flag;\n\n\t\treturn this;\n\t}\n\n\tsetWaitWorkDay(flag): this\n\t{\n\t\tthis.#waitWorkDay = !!flag;\n\n\t\treturn this;\n\t}\n\n\tsetInTime(value: ?Array<[number, number]>): this\n\t{\n\t\tthis.#inTime = value;\n\n\t\treturn this;\n\t}\n\n\tisNow(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t&& this.#basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t&& !this.#value\n\t\t\t&& !this.workTime\n\t\t\t&& !this.inTime\n\t\t);\n\t}\n\n\tsetNow(): void\n\t{\n\t\tthis.setType(DelayInterval.DELAY_TYPE.After);\n\t\tthis.setValue(0);\n\t\tthis.setValueType('i');\n\t\tthis.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t\tthis.setInTime(null);\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime ? 1 : 0,\n\t\t\twaitWorkDay: this.#waitWorkDay ? 1 : 0,\n\t\t\tinTime: this.#inTime || null,\n\t\t}\n\t}\n\n\ttoExpression(basisFields, workerExpression): string\n\t{\n\t\tlet basis = this.#basis ? this.#basis : DelayInterval.BASIS_TYPE.CurrentDate;\n\n\t\tif (!DelayInterval.isSystemBasis(basis) && Type.isArray(basisFields))\n\t\t{\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (basis === basisFields[i].SystemExpression)\n\t\t\t\t{\n\t\t\t\t\tbasis = basisFields[i].Expression;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.isNow() || this.#type === DelayInterval.DELAY_TYPE.In && !this.#workTime && !this.#inTime)\n\t\t{\n\t\t\treturn basis;\n\t\t}\n\n\t\tlet days = 0;\n\t\tlet hours = 0;\n\t\tlet minutes = 0;\n\n\t\tswitch (this.#valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tminutes = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\thours = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tdays = this.#value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet add = '';\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tadd = '-';\n\t\t}\n\n\t\tif (days > 0)\n\t\t{\n\t\t\tadd += days + 'd';\n\t\t}\n\t\tif (hours > 0)\n\t\t{\n\t\t\tadd += hours + 'h';\n\t\t}\n\t\tif (minutes > 0)\n\t\t{\n\t\t\tadd += minutes + 'i';\n\t\t}\n\n\t\tconst fn = this.#workTime ? 'workdateadd' : 'dateadd';\n\n\t\tif (fn === 'workdateadd' && add === '')\n\t\t{\n\t\t\tadd = '0d';\n\t\t}\n\n\t\tlet worker = '';\n\t\tif (fn === 'workdateadd' && workerExpression)\n\t\t{\n\t\t\tworker = workerExpression;\n\t\t}\n\n\t\tlet result = fn + '(' + basis + ',\"' + add + '\"' + (worker ? ',' + worker : '') + ')'\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.In && this.#inTime)\n\t\t{\n\t\t\tif (!this.#workTime)\n\t\t\t{\n\t\t\t\tresult = basis;\n\t\t\t}\n\n\t\t\tresult = `settime(${result}, ${this.#inTime[0] || 0}, ${this.#inTime[1] || 0})`;\n\t\t}\n\n\t\treturn '=' + result;\n\t}\n\n\tformat(emptyText, fields)\n\t{\n\t\tlet str = emptyText;\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tstr = Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME');\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.inTime)\n\t\t\t{\n\t\t\t\tstr += ' ' + this.inTimeString;\n\t\t\t}\n\t\t}\n\t\telse if (this.#value)\n\t\t{\n\t\t\tconst prefix = (\n\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH')\n\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_1')\n\t\t\t);\n\n\t\t\tstr = prefix + ' ' + this.getFormattedPeriodLabel(this.#value, this.#valueType);\n\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tconst fieldSuffix = (\n\t\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t);\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fieldSuffix + ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.#workTime)\n\t\t{\n\t\t\tstr += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_WORKTIME');\n\t\t}\n\n\t\treturn str;\n\t}\n\n\tgetFormattedPeriodLabel(value, type)\n\t{\n\t\tconst label = value + ' ';\n\t\tlet labelIndex = 0;\n\t\tif (value > 20)\n\t\t{\n\t\t\tvalue = (value % 10);\n\t\t}\n\n\t\tif (value === 1)\n\t\t{\n\t\t\tlabelIndex = 0;\n\t\t}\n\t\telse if (value > 1 && value < 5)\n\t\t{\n\t\t\tlabelIndex = 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabelIndex = 2;\n\t\t}\n\n\t\tconst labels = DelayInterval.getPeriodLabels(type);\n\n\t\treturn label + (labels ? labels[labelIndex] : '');\n\t}\n\n\tstatic getPeriodLabels(period)\n\t{\n\t\tlet labels = [];\n\t\tif (period === 'i')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'h')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'd')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY3')\n\t\t\t];\n\t\t}\n\n\t\treturn labels;\n\t}\n}","import { Event, Text, Type, Dom, Loc } from 'main.core';\n\nexport class HelpHint\n{\n\tstatic popupHint;\n\tstatic timeout;\n\n\tstatic bindAll(node)\n\t{\n\t\tnode.querySelectorAll('[data-text]').forEach((element) => HelpHint.bindToNode(element));\n\t}\n\n\tstatic bindToNode(node)\n\t{\n\t\tEvent.bind(node, 'mouseover', this.showHint.bind(this, node));\n\t\tEvent.bind(node, 'mouseout', this.hideHint.bind(this));\n\t}\n\n\tstatic isBindedToNode(node): boolean\n\t{\n\t\treturn !!this.popupHint?.bindElement?.isSameNode(node);\n\t}\n\n\tstatic showHint(node)\n\t{\n\t\tconst rawText = node.getAttribute('data-text');\n\t\tif (!rawText)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet text = Text.encode(rawText);\n\t\ttext = BX.util.nl2br(text);\n\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.hideHint();\n\n\t\tthis.popupHint = new BX.PopupWindow('bizproc-automation-help-tip', node, {\n\t\t\tlightShadow: true,\n\t\t\tautoHide: false,\n\t\t\tdarkMode: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 2,\n\t\t\tbindOptions: {position: \"top\"},\n\t\t\tevents : {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent : Dom.create('div', {\n\t\t\t\tattrs : {\n\t\t\t\t\tstyle : 'padding-right: 5px; width: 250px;'\n\t\t\t\t},\n\t\t\t\thtml: text\n\t\t\t}),\n\t\t});\n\t\tthis.popupHint.setAngle({offset: 32, position: 'bottom'});\n\t\tthis.popupHint.show();\n\n\t\treturn true;\n\t}\n\n\tstatic showNoPermissionsHint(node)\n\t{\n\t\tthis.showAngleHint(node, Loc.getMessage('BIZPROC_AUTOMATION_RIGHTS_ERROR'));\n\t}\n\n\tstatic showAngleHint(node, text)\n\t{\n\t\tif (this.timeout)\n\t\t{\n\t\t\tclearTimeout(this.timeout);\n\t\t}\n\n\t\tthis.popupHint = BX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {\n\t\t\t\twidth: 334,\n\t\t\t\theight: 104,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tangle: {offset: Dom.getPosition(node).width / 2},\n\t\t\t\tbindOptions: {position: 'top'},\n\t\t\t}\n\t\t});\n\n\t\tthis.popupHint.close = function ()\n\t\t{\n\t\t\tthis.hide();\n\t\t};\n\t\tthis.popupHint.show(node, text);\n\t\tthis.timeout = setTimeout(this.hideHint.bind(this), 5000);\n\t}\n\n\tstatic hideHint()\n\t{\n\t\tif (this.popupHint)\n\t\t{\n\t\t\tthis.popupHint.close();\n\t\t}\n\t\tthis.popupHint = null;\n\t}\n}","export class WorkflowStatus\n{\n\tstatic CREATED = 0;\n\tstatic RUNNING = 1;\n\tstatic COMPLETED = 2;\n\tstatic SUSPENDED = 3;\n\tstatic TERMINATED = 4;\n}","import {WorkflowStatus} from \"../workflow/types\";\n\nexport class TrackingEntry\n{\n\tstatic UNKNOWN_ACTIVITY_TYPE = 0;\n\tstatic EXECUTE_ACTIVITY_TYPE = 1;\n\tstatic CLOSE_ACTIVITY_TYPE = 2;\n\tstatic CANCEL_ACTIVITY_TYPE = 3;\n\tstatic FAULT_ACTIVITY_TYPE = 4;\n\tstatic CUSTOM_ACTIVITY_TYPE = 5;\n\tstatic REPORT_ACTIVITY_TYPE = 6;\n\tstatic ATTACHED_ENTITY_TYPE = 7;\n\tstatic TRIGGER_ACTIVITY_TYPE = 8;\n\tstatic ERROR_ACTIVITY_TYPE = 9;\n\tstatic DEBUG_ACTIVITY_TYPE = 10;\n\tstatic DEBUG_AUTOMATION_TYPE = 11;\n\tstatic DEBUG_DESIGNER_TYPE = 12;\n\tstatic DEBUG_LINK_TYPE = 13;\n\n\tid: number;\n\tworkflowId: string;\n\t#type: number;\n\tname: string;\n\ttitle: string;\n\tnote: string;\n\t// TODO - convert string to Date\n\tdatetime: string;\n\t#workflowStatus: number;\n\n\tget type(): number\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget workflowStatus(): number\n\t{\n\t\treturn this.#workflowStatus;\n\t}\n\n\tset type(entryType: number)\n\t{\n\t\tif (TrackingEntry.getAllActivityTypes().includes(entryType))\n\t\t{\n\t\t\tthis.#type = entryType;\n\t\t}\n\t}\n\n\tset workflowStatus(entryWorkflowStatus: number)\n\t{\n\t\tif (TrackingEntry.getAllWorkflowStatuses().includes(entryWorkflowStatus))\n\t\t{\n\t\t\tthis.#workflowStatus = entryWorkflowStatus;\n\t\t}\n\t}\n\n\tisTriggerEntry(): boolean\n\t{\n\t\treturn this.type === TrackingEntry.TRIGGER_ACTIVITY_TYPE;\n\t}\n\n\tstatic getAllActivityTypes(): Array<number>\n\t{\n\t\treturn [\n\t\t\tTrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CLOSE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CANCEL_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.FAULT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CUSTOM_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.REPORT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ATTACHED_ENTITY_TYPE,\n\t\t\tTrackingEntry.TRIGGER_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ERROR_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_AUTOMATION_TYPE,\n\t\t\tTrackingEntry.DEBUG_DESIGNER_TYPE,\n\t\t\tTrackingEntry.DEBUG_LINK_TYPE,\n\t\t];\n\t}\n\n\tstatic isKnownActivityType(typeId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllActivityTypes().includes(typeId);\n\t}\n\n\tstatic getAllWorkflowStatuses(): Array<number>\n\t{\n\t\treturn [\n\t\t\tWorkflowStatus.CREATED,\n\t\t\tWorkflowStatus.RUNNING,\n\t\t\tWorkflowStatus.COMPLETED,\n\t\t\tWorkflowStatus.SUSPENDED,\n\t\t\tWorkflowStatus.TERMINATED,\n\t\t];\n\t}\n\n\tstatic isKnownWorkflowStatus(statusId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllWorkflowStatuses().includes(statusId);\n\t}\n}","export class TrackingStatus\n{\n\tstatic WAITING = 0;\n\tstatic RUNNING = 1;\n\tstatic COMPLETED = 2;\n\tstatic AUTOCOMPLETED = 3;\n}","import {Type} from 'main.core';\nimport { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport {WorkflowStatus} from \"../workflow/types\";\n\nexport class RobotEntry\n{\n\tid: string = '';\n\tstatus: string = TrackingStatus.WAITING;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\tnotes: Array<string> = [];\n\terrors: Array<string> = [];\n\t#entryId: number = -1;\n\tworkflowStatus: number = WorkflowStatus.CREATED;\n\n\tconstructor(entries: ?Array<TrackingEntry>)\n\t{\n\t\tif (Type.isArray(entries))\n\t\t{\n\t\t\tfor (const entry of entries)\n\t\t\t{\n\t\t\t\tthis.addEntry(entry);\n\t\t\t}\n\t\t}\n\t}\n\n\taddEntry(entry: TrackingEntry)\n\t{\n\t\tthis.id = entry.name;\n\n\t\tif (this.#entryId < entry.id)\n\t\t{\n\t\t\tthis.#entryId = entry.id;\n\t\t\tthis.modified = entry.datetime;\n\t\t\tthis.workflowStatus = entry.workflowStatus;\n\n\t\t\tif (entry.type === TrackingEntry.CLOSE_ACTIVITY_TYPE)\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.COMPLETED;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\tif (entry.type === TrackingEntry.ERROR_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.errors.push(entry.note);\n\t\t}\n\t\telse if (entry.type === TrackingEntry.CUSTOM_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.notes.push(entry.note);\n\t\t}\n\t}\n}","import { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\n\nexport class TriggerEntry\n{\n\tid: string = '';\n\tstatus: number = TrackingStatus.COMPLETED;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\n\tconstructor(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.id = entry.note;\n\t\t\tthis.modified = entry.datetime;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport class TrackingEntryBuilder\n{\n\t#defaultSettings = {\n\t\tid: TrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\tworkflowId: '',\n\t\ttype: TrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\tname: '',\n\t\ttitle: '',\n\t\tdatetime: '',\n\t\tnote: '',\n\t\tworkflowStatus: WorkflowStatus.CREATED,\n\t};\n\t#entrySettings: Object<string, string | number>;\n\n\tconstructor()\n\t{\n\t\tthis.#entrySettings = this.#defaultSettings;\n\t}\n\n\tsetLogEntry(logEntry: Object<string, any>): this\n\t{\n\t\tthis.#entrySettings = Object.assign({}, this.#defaultSettings);\n\t\tlogEntry = Object.assign({}, logEntry);\n\n\t\tif (Type.isStringFilled(logEntry['ID']))\n\t\t{\n\t\t\tlogEntry['ID'] = parseInt(logEntry['ID']);\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['TYPE']))\n\t\t{\n\t\t\tlogEntry['TYPE'] = parseInt(logEntry['TYPE']);\n\t\t}\n\n\t\tif (Type.isNumber(logEntry['ID']))\n\t\t{\n\t\t\tthis.#entrySettings.id = logEntry['ID'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['WORKFLOW_ID']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowId = logEntry['WORKFLOW_ID'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['TYPE']) && TrackingEntry.isKnownActivityType(logEntry['TYPE']))\n\t\t{\n\t\t\tthis.#entrySettings.type = logEntry['TYPE'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['MODIFIED']))\n\t\t{\n\t\t\tthis.#entrySettings.datetime = logEntry['MODIFIED'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['WORKFLOW_STATUS']) && TrackingEntry.isKnownWorkflowStatus(logEntry['WORKFLOW_STATUS']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowStatus = logEntry['WORKFLOW_STATUS'];\n\t\t}\n\n\t\tthis.#entrySettings.name = String(logEntry['ACTION_NAME']);\n\t\tthis.#entrySettings.title = String(logEntry['ACTION_TITLE']);\n\t\tthis.#entrySettings.note = String(logEntry['ACTION_NOTE']);\n\n\t\treturn this;\n\t}\n\n\tsetStatus(status: string): this\n\t{\n\t\tthis.#entrySettings.status = status;\n\n\t\treturn this;\n\t}\n\n\tbuild(): TrackingEntry\n\t{\n\t\tconst entry = new TrackingEntry();\n\n\t\tentry.id = this.#entrySettings.id;\n\t\tentry.workflowId = this.#entrySettings.workflowId;\n\t\tentry.type = this.#entrySettings.type;\n\t\tentry.name = this.#entrySettings.name;\n\t\tentry.title = this.#entrySettings.title;\n\t\tentry.note = this.#entrySettings.note;\n\t\tentry.datetime = this.#entrySettings.datetime;\n\t\tentry.workflowStatus = this.#entrySettings.workflowStatus;\n\n\t\treturn entry;\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { RobotEntry } from './robot-entry';\nimport { TriggerEntry } from './trigger-entry';\nimport { TrackingEntryBuilder } from './tracking-entry-builder';\nimport { Document } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport {\n\tRobotEntry,\n\tTriggerEntry,\n\tTrackingEntryBuilder,\n\tTrackingEntry,\n\tTrackingStatus,\n}\n\nexport class Tracker\n{\n\t#ajaxUrl: string;\n\t#document: ?Document;\n\n\t#triggerLogs: Object<string, TrackingEntry>;\n\t#robotLogs: Object<string, RobotEntry>;\n\n\tconstructor(document: ?Document, ajaxUrl: string)\n\t{\n\t\tthis.#ajaxUrl = ajaxUrl;\n\t\tthis.#document = document;\n\t}\n\n\tinit(log)\n\t{\n\t\tthis.#triggerLogs = {};\n\t\tthis.#robotLogs = {};\n\n\t\tthis.addLogs(log);\n\t}\n\n\treInit(log)\n\t{\n\t\tthis.init(log);\n\t}\n\n\taddLogs(log: Object<string, Array<Object<string, any>>>)\n\t{\n\t\tif (!Type.isPlainObject(log))\n\t\t{\n\t\t\tlog = {};\n\t\t}\n\n\t\tconst logEntryBuilder = new TrackingEntryBuilder();\n\n\t\tfor (const [statusId, entries] of Object.entries(log))\n\t\t{\n\t\t\tif (!Type.isArray(entries))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const rawEntry of entries)\n\t\t\t{\n\t\t\t\tconst entry = logEntryBuilder.setLogEntry(rawEntry).build();\n\n\t\t\t\tif (entry.isTriggerEntry())\n\t\t\t\t{\n\t\t\t\t\tthis.addTriggerEntry(entry);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.addRobotEntry(entry);\n\t\t\t\t\tconst robotEntry = this.#robotLogs[entry.name];\n\n\t\t\t\t\tif (!Type.isNil(this.#document))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isRobotRunning = (robotEntry.status === TrackingStatus.RUNNING);\n\t\t\t\t\t\tconst isWorkflowCompleted =\n\t\t\t\t\t\t\t(robotEntry.workflowStatus === WorkflowStatus.COMPLETED)\n\t\t\t\t\t\t;\n\t\t\t\t\t\tconst isCurrentStatus = (this.#document.getCurrentStatusId() === statusId);\n\n\t\t\t\t\t\tconst isRobotRunningAtAnotherStatus = isRobotRunning && !isCurrentStatus;\n\t\t\t\t\t\tconst isRobotRunningAndCurrentWorkflowCompleted =\n\t\t\t\t\t\t\tisRobotRunning && isWorkflowCompleted && isCurrentStatus\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tif (isRobotRunningAtAnotherStatus || isRobotRunningAndCurrentWorkflowCompleted)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trobotEntry.status = TrackingStatus.COMPLETED;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddTriggerEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.#triggerLogs[entry.note] = new TriggerEntry(entry);\n\t\t}\n\t}\n\n\taddRobotEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#robotLogs[entry.name])\n\t\t{\n\t\t\tthis.#robotLogs[entry.name] = new RobotEntry([entry]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robotLogs[entry.name].addEntry(entry);\n\t\t}\n\t}\n\n\tgetRobotLog(id: string): ?RobotEntry\n\t{\n\t\treturn this.#robotLogs[id] || null;\n\t}\n\n\tgetTriggerLog(id: string): ?TriggerEntry\n\t{\n\t\treturn this.#triggerLogs[id] || null;\n\t}\n\n\tupdate(documentSigned: string)\n\t{\n\t\treturn BX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: this.#ajaxUrl,\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_log',\n\t\t\t\tdocument_signed: documentSigned\n\t\t\t},\n\t\t\tonsuccess: (response) => {\n\t\t\t\tif (response.DATA && response.DATA.LOG)\n\t\t\t\t{\n\t\t\t\t\tthis.reInit(response.DATA.LOG);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","import { Dom, Type, Event, Text, Loc, Runtime, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Document } from './document/document';\nimport { Template } from './template';\nimport { DelayInterval } from './delay-interval';\nimport { ViewMode } from './view-mode';\nimport { HelpHint } from './help-hint';\nimport { ConditionGroup, Helper } from 'bizproc.automation';\nimport { Tracker } from './tracker/tracker'\nimport { TrackingStatus } from './tracker/types';\nimport { Menu, MenuItem } from 'main.popup';\n\nexport class Robot extends EventEmitter\n{\n\tSYSTEM_EXPRESSION_PATTERN = '\\\\{=\\\\s*(?<object>[a-z0-9_]+)\\\\s*\\\\:\\\\s*(?<field>[a-z0-9_\\\\.]+)(\\\\s*>\\\\s*(?<mod1>[a-z0-9_\\\\:]+)(\\\\s*,\\\\s*(?<mod2>[a-z0-9_]+))?)?\\\\s*\\\\}';\n\n\t#data: Object<string, any>;\n\t#document: Document;\n\t#template: ?Template;\n\t#tracker: ?Object;\n\t#delay: DelayInterval;\n\t#node: HTMLElement;\n\t#condition: ConditionGroup;\n\t#isDraft: boolean;\n\n\t#isFrameMode: boolean;\n\t#viewMode: ViewMode;\n\n\tconstructor(params: {\n\t\tdocument: Document,\n\t\ttemplate: ?Template,\n\t\tisFrameMode: boolean,\n\t\ttracker: Tracker,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#document = params.document;\n\t\tif (!Type.isNil(params.template))\n\t\t{\n\t\t\tthis.#template = params.template;\n\t\t}\n\t\tthis.#isFrameMode = params.isFrameMode;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#tracker = params.tracker;\n\t\tthis.#isDraft = false;\n\n\t\tthis.#delay = new DelayInterval();\n\t}\n\n\tget node()\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget data()\n\t{\n\t\treturn {\n\t\t\t...this.#data,\n\t\t\tCondition: this.#condition.serialize(),\n\t\t\tDelay: this.#delay.serialize(),\n\t\t};\n\t}\n\n\tget draft()\n\t{\n\t\treturn this.#isDraft;\n\t}\n\n\tset draft(draft: boolean)\n\t{\n\t\tthis.#isDraft = draft;\n\t}\n\n\tget template()\n\t{\n\t\treturn this.#template;\n\t}\n\n\thasTemplate(): boolean\n\t{\n\t\treturn !Type.isNil(this.#template);\n\t}\n\n\tgetTemplate(): ?Template\n\t{\n\t\treturn this.#template;\n\t}\n\n\tgetDocument(): Document\n\t{\n\t\treturn this.#document;\n\t}\n\n\tstatic generateName(): string\n\t{\n\t\treturn (\n\t\t\t'A' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t);\n\t}\n\n\tclone(): Robot\n\t{\n\t\tconst clonedRobot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate: this.#template,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = {\n\t\t\t...BX.clone(this.#data),\n\t\t\tName: Robot.generateName(),\n\t\t\tDelay: this.getDelayInterval().serialize(),\n\t\t\tCondition: this.getCondition().serialize(),\n\t\t};\n\t\tclonedRobot.init(robotData, this.#viewMode);\n\n\t\treturn clonedRobot;\n\t}\n\n\tisEqual(other: Robot): boolean\n\t{\n\t\treturn this.#data.Name === other.#data.Name;\n\t}\n\n\tinit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = Object.assign({}, data);\n\t\t}\n\t\tif (!this.#data.Name)\n\t\t{\n\t\t\tthis.#data.Name = Robot.generateName();\n\t\t}\n\t\tthis.#data.Activated = !Type.isNil(this.#data.Activated) ? Text.toBoolean(this.#data.Activated) : true;\n\n\t\tthis.#delay = new DelayInterval(this.#data.Delay);\n\t\tthis.#condition = new ConditionGroup(this.#data.Condition);\n\t\tif (!this.#data.Condition)\n\t\t{\n\t\t\tthis.#condition.type = ConditionGroup.CONDITION_TYPE.Mixed;\n\t\t}\n\n\t\tdelete this.#data.Condition;\n\t\tdelete this.#data.Delay;\n\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#node = this.createNode();\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isNil(viewMode) && this.#viewMode.isNone())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(this.#node);\n\t\tthis.emit('Robot:destroyed');\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn this.#template.canEdit();\n\t}\n\n\tgetProperties(): Object\n\t{\n\t\tif (this.#data && Type.isPlainObject(this.#data.Properties))\n\t\t{\n\t\t\treturn this.#data.Properties;\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tgetProperty(name: string): ?Object\n\t{\n\t\treturn this.getProperties()[name] || null;\n\t}\n\n\thasProperty(name: string): boolean\n\t{\n\t\treturn this.getProperties().hasOwnProperty(name);\n\t}\n\n\tsetProperty(name: string, value: any): Robot\n\t{\n\t\tthis.#data.Properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetId(): ?string\n\t{\n\t\treturn this.#data.Name || null;\n\t}\n\n\tgetLogStatus(): number\n\t{\n\t\tlet status = TrackingStatus.WAITING;\n\t\tlet log = this.#tracker.getRobotLog(this.getId());\n\n\t\tif (log)\n\t\t{\n\t\t\tstatus = log.status;\n\t\t}\n\t\telse if (this.#data.DelayName)\n\t\t{\n\t\t\tlog = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\tstatus = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t}\n\n\tgetLogErrors(): Array<string>\n\t{\n\t\tlet errors = [];\n\t\tconst log = this.#tracker.getRobotLog(this.getId());\n\t\tif (log && log.errors)\n\t\t{\n\t\t\terrors = log.errors;\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\tgetDelayNotes(): Array<string>\n\t{\n\t\tif (this.#data.DelayName)\n\t\t{\n\t\t\tconst log = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\treturn log.notes;\n\t\t\t}\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tselectNode(): void\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--selected');\n\n\t\t\tconst checkboxNode = this.#node.querySelector('input');\n\t\t\tif (checkboxNode)\n\t\t\t{\n\t\t\t\tcheckboxNode.checked = true;\n\t\t\t}\n\n\t\t\tthis.emit('Robot:selected');\n\t\t}\n\t}\n\n\tunselectNode()\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--selected');\n\n\t\t\tconst checkboxNode = this.#node.querySelector('input');\n\t\t\tif (checkboxNode)\n\t\t\t{\n\t\t\t\tcheckboxNode.checked = false;\n\t\t\t}\n\n\t\t\tthis.emit('Robot:unselected');\n\t\t}\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#node && Dom.hasClass(this.#node, '--selected');\n\t}\n\n\tisActivated(): boolean\n\t{\n\t\treturn Text.toBoolean(this.#data.Activated);\n\t}\n\n\tsetActivated(activated: boolean): this\n\t{\n\t\tthis.#data.Activated = Text.toBoolean(activated);\n\t\tthis.emit(this.#data.Activated === true ? 'Robot:onAfterActivated' : 'Robot:onAfterDeactivated');\n\n\t\treturn this;\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\tif (!isActive)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--locked-node');\n\t\t}\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.hide(deleteButton);\n\n\t\tthis.#node.onclick = () => {\n\t\t\tif (!this.#viewMode.isManage() || !this.#viewMode.getProperty('isActive', false))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isSelected())\n\t\t\t{\n\t\t\t\tthis.selectNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unselectNode();\n\t\t\t}\n\t\t};\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tthis.unselectNode();\n\t\tDom.removeClass(this.#node, '--locked-node');\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.show(deleteButton);\n\n\t\tthis.#node.onclick = undefined;\n\t}\n\n\tcreateNode(): HTMLElement\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-robot-container-wrapper';\n\t\tlet containerClass = 'bizproc-automation-robot-container';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-robot-container-wrapper-draggable';\n\t\t}\n\t\tif (this.#data.Activated === false)\n\t\t{\n\t\t\tcontainerClass += ' --deactivated';\n\t\t\twrapperClass += ' --deactivated';\n\t\t}\n\n\t\tif (this.draft)\n\t\t{\n\t\t\tcontainerClass += ' --draft';\n\t\t}\n\n\t\tconst targetLabel = Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO');\n\t\tconst targetNode = Dom.create(\"a\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-settings-name \" + (this.#viewMode.isView() ? '--mode-view' : ''),\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t});\n\n\t\tif (Type.isPlainObject(this.#data.viewData) && this.#data.viewData.responsibleLabel)\n\t\t{\n\t\t\tlet labelText =\n\t\t\t\tthis.#data.viewData.responsibleLabel\n\t\t\t\t\t.replace('{=Document:ASSIGNED_BY_ID}', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace('author', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace(/\\{=Constant\\:Constant[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{\\{~&\\:Constant[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{=Template\\:Parameter[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t\t\t.replace(/\\{\\{~&:\\:Parameter[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t;\n\n\t\t\tif (labelText.indexOf('{=Document') >= 0)\n\t\t\t{\n\t\t\t\tthis.#document.getFields().forEach(field => {\n\t\t\t\t\tlabelText = labelText.replace(field['SystemExpression'], field['Name']);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (labelText.indexOf('{=A') >= 0)\n\t\t\t{\n\t\t\t\tthis.#template.robots.forEach(robot => {\n\t\t\t\t\trobot.getReturnFieldsDescription().forEach(field => {\n\t\t\t\t\t\tif (field['Type'] === 'user')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabelText = labelText.replace(\n\t\t\t\t\t\t\t\tfield['SystemExpression'],\n\t\t\t\t\t\t\t\trobot.getTitle() + ': ' + field['Name']\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (labelText.indexOf('{=GlobalVar:') >= 0 && Type.isArrayFilled(this.#template.globalVariables))\n\t\t\t{\n\t\t\t\tthis.#template.globalVariables.forEach(variable => {\n\t\t\t\t\tlabelText = labelText.replace(variable.SystemExpression, variable.Name);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (labelText.indexOf('{=GlobalConst:') >= 0 && Type.isArrayFilled(this.#template.globalConstants))\n\t\t\t{\n\t\t\t\tthis.#template.globalConstants.forEach(constant => {\n\t\t\t\t\tlabelText = labelText.replace(constant.SystemExpression, constant.Name);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttargetNode.textContent = labelText;\n\t\t\ttargetNode.setAttribute('title', labelText);\n\n\t\t\tif (this.#data.viewData.responsibleUrl)\n\t\t\t{\n\t\t\t\ttargetNode.href = this.#data.viewData.responsibleUrl;\n\t\t\t\tif (this.#isFrameMode)\n\t\t\t\t{\n\t\t\t\t\ttargetNode.setAttribute('target', '_blank');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.#viewMode.isEdit() && parseInt(this.#data.viewData.responsibleId) > 0)\n\t\t\t{\n\t\t\t\ttargetNode.setAttribute('bx-tooltip-user-id', this.#data.viewData.responsibleId);\n\t\t\t}\n\t\t}\n\n\t\tlet delayLabel = this.getDelayInterval().format(\n\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\tthis.#document.getFields()\n\t\t);\n\n\t\tif (this.isExecuteAfterPrevious())\n\t\t{\n\t\t\tdelayLabel = (delayLabel !== Loc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE')) ? delayLabel + ', ' : '';\n\t\t\tdelayLabel += Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS');\n\t\t}\n\n\t\tif (this.getCondition().items.length > 0)\n\t\t{\n\t\t\tdelayLabel += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_BY_CONDITION');\n\t\t}\n\n\t\tconst delayNode = Dom.create(\n\t\t\tthis.#viewMode.isEdit() ? \"a\" : \"span\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: this.#viewMode.isEdit() ? 'bizproc-automation-robot-link' : 'bizproc-automation-robot-text',\n\t\t\t\t\ttitle: delayLabel\n\t\t\t\t},\n\t\t\t\ttext: delayLabel,\n\t\t\t}\n\t\t);\n\n\t\tconst statusNode = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-information\"\n\t\t\t}\n\t\t});\n\t\tthis.subscribeOnce('Robot:destroyed', () => {\n\t\t\tif (HelpHint.isBindedToNode(statusNode))\n\t\t\t{\n\t\t\t\tHelpHint.hideHint();\n\t\t\t}\n\t\t})\n\n\t\tswitch (this.getLogStatus())\n\t\t{\n\t\t\tcase TrackingStatus.RUNNING:\n\t\t\t\tif (this.#document.getCurrentStatusId() === this.#template.getStatusId())\n\t\t\t\t{\n\t\t\t\t\tstatusNode.classList.add('--loader');\n\n\t\t\t\t\tconst delayNotes = this.getDelayNotes();\n\t\t\t\t\tif (delayNotes.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tstatusNode.setAttribute('data-text', delayNotes.join('\\n'));\n\t\t\t\t\t\tHelpHint.bindToNode(statusNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase TrackingStatus.COMPLETED:\n\t\t\tcase TrackingStatus.AUTOCOMPLETED:\n\t\t\t\tcontainerClass += ' --complete';\n\t\t\t\tstatusNode.classList.add('--complete');\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst errors = this.getLogErrors();\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tstatusNode.classList.add('--errors');\n\t\t\tstatusNode.setAttribute('data-text', errors.join('\\n'));\n\t\t\tHelpHint.bindToNode(statusNode);\n\t\t}\n\n\t\tlet titleClassName = 'bizproc-automation-robot-title-text';\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\ttitleClassName += ' bizproc-automation-robot-title-text-editable';\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: containerClass,\n\t\t\t\t'data-role': 'robot-container',\n\t\t\t\t'data-type': 'item-robot',\n\t\t\t\t'data-id': this.getId()\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"ui-ctl ui-ctl-inline bizproc-automation-robot-container-checkbox\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: ' ui-ctl-checkbox',\n\t\t\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t\tthis.#renderDeactivatedInfoBlock(),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" },\n\t\t\t\t\t\t\tchildren: [delayNode]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"bizproc-automation-robot-title\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: titleClassName,\n\t\t\t\t\t\t\t\t\t\ttitle: this.getTitle(),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\thtml: this.clipTitle(this.getTitle()),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: event => {\n\t\t\t\t\t\t\t\t\t\t\tif (this.#viewMode.isEdit() && this.canEdit() && !this.#viewMode.isManage())\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tthis.onTitleEditClick(event);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings-title\" },\n\t\t\t\t\t\t\t\t\ttext: targetLabel + ':'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\ttargetNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tstatusNode,\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\t\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\n\t\t\tconst actionsButton = Tag.render`\n\t\t\t\t<div class=\"bizproc-automation-robot-btn-copy\">\n\t\t\t\t\t${Loc.getMessage('BIZPROC_AUTOMATION_ACTIONS_BUTTON_TEXT')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tEvent.bind(actionsButton, 'click', this.#onActionsButtonClick.bind(this, actionsButton));\n\t\t\tDom.append(actionsButton, div);\n\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\n\t\t\tdiv.appendChild(settingsBtn);\n\t\t}\n\n\t\treturn div;\n\t}\n\n\t#renderDeactivatedInfoBlock()\n\t{\n\t\tif (this.#data.Activated === true)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-automation-robot-deactivated\" data-role=\"deactivate-robot\">\n\t\t\t\t${Loc.getMessage('BIZPROC_AUTOMATION_DEACTIVATED_ROBOT_BLOCK_TITLE')}\n\t\t\t</div>\n\t`;\n\t}\n\n\tonDeleteButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(this.#node);\n\t\t\tthis.#template.deleteRobot(this);\n\t\t}\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.#template.openRobotSettingsDialog(this, this.#data.DialogContext ?? null);\n\t\t}\n\t}\n\n\t#onActionsButtonClick(button, event)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#viewMode.isManage())\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t\tconst buttonText = (\n\t\t\t\tthis.#data.Activated\n\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_ACTIONS_DEACTIVATE_BUTTON_TEXT')\n\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_ACTIONS_ACTIVATE_BUTTON_TEXT')\n\t\t\t);\n\n\t\t\tconst menu = new Menu({\n\t\t\t\tbindElement: button,\n\t\t\t\twidth: 150,\n\t\t\t\theight: 90,\n\t\t\t\tautoHide: true,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: (Dom.getPosition(button).width / 2) + 23,\n\t\t\t\t},\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ACTIONS_COPY_BUTTON_TEXT'),\n\t\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_ACTIONS_COPY_BUTTON_TEXT'),\n\t\t\t\t\t\tonclick: (e: PointerEvent, menuItem: MenuItem) => {\n\t\t\t\t\t\t\tthis.onCopyButtonClick(menuItem, e);\n\t\t\t\t\t\t\tmenu.destroy();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: buttonText,\n\t\t\t\t\t\ttitle: buttonText,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.#onDeactivateButtonClick();\n\t\t\t\t\t\t\tmenu.destroy();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tmenu.show();\n\t\t}\n\t}\n\n\tonCopyButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst copiedRobot = this.clone();\n\t\t\tconst robotTitle = copiedRobot.getProperty('Title');\n\t\t\tif (!Type.isNil(robotTitle))\n\t\t\t{\n\t\t\t\tconst newTitle = robotTitle + ' ' + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY_CAPTION');\n\t\t\t\tcopiedRobot.setProperty('Title', newTitle);\n\t\t\t\tcopiedRobot.reInit();\n\t\t\t}\n\n\t\t\tTemplate.copyRobotTo(this.#template, copiedRobot, this.#template.getNextRobot(this));\n\t\t}\n\t}\n\n\t#onDeactivateButtonClick()\n\t{\n\t\tthis.setActivated(!this.isActivated());\n\t\tthis.reInit();\n\t}\n\n\tonTitleEditClick(e)\n\t{\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tconst formName = 'bizproc_automation_robot_title_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME') + ':'\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [BX.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\tvalue: this.getTitle()\n\t\t\t\t}\n\t\t\t})]\n\t\t}));\n\n\t\tthis.emit('Robot:title:editStart');\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME'),\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose(popup)\n\t\t\t\t{\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tself.emit('Robot:title:editCompleted');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nameNode = form.elements.name;\n\t\t\t\t\t\t\tself.setProperty('Title', nameNode.value);\n\t\t\t\t\t\t\tself.reInit();\n\t\t\t\t\t\t\tself.#template.markModified();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getTitle().toLowerCase().indexOf(query) >= 0;\n\n\t\tif (match)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--search-mismatch');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#node, '--search-mismatch');\n\t\t}\n\t}\n\n\tclipTitle(fullTitle: string)\n\t{\n\t\tlet title = Text.encode(fullTitle);\n\t\tconst arrTitle = title.split(\" \");\n\t\tconst lastWord = \"<span>\" + arrTitle[arrTitle.length - 1] + \"</span>\";\n\n\t\tarrTitle.splice(arrTitle.length - 1);\n\n\t\ttitle = arrTitle.join(\" \") + \" \" + lastWord;\n\n\t\treturn title;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t\tthis.#data.Activated = !Type.isNil(this.#data.Activated) ? Text.toBoolean(this.#data.Activated) : true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tserialize()\n\t{\n\t\tconst result = BX.clone(this.#data);\n\t\tdelete result['viewData'];\n\t\tdelete result['DialogContext'];\n\t\tresult.Delay = this.#delay.serialize();\n\t\tresult.Condition = this.#condition.serialize();\n\t\tresult.Activated = result.Activated ? 'Y' : 'N';\n\n\t\treturn result;\n\t}\n\n\tgetDelayInterval(): DelayInterval\n\t{\n\t\treturn this.#delay;\n\t}\n\n\tsetDelayInterval(delay): Robot\n\t{\n\t\tthis.#delay = delay;\n\n\t\treturn this;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition)\n\t{\n\t\tthis.#condition = condition;\n\n\t\treturn this;\n\t}\n\n\tsetExecuteAfterPrevious(flag)\n\t{\n\t\tthis.#data.ExecuteAfterPrevious = flag ? 1 : 0;\n\n\t\treturn this;\n\t}\n\n\tisExecuteAfterPrevious()\n\t{\n\t\treturn (this.#data.ExecuteAfterPrevious === 1 || this.#data.ExecuteAfterPrevious === '1')\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.draggableItem = BX.proxy_context;\n\n\t\tif (!this.draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.stub)\n\t\t{\n\t\t\tconst itemWidth = this.draggableItem.offsetWidth;\n\t\t\tthis.stub = this.draggableItem.cloneNode(true);\n\t\t\tthis.stub.style.position = \"absolute\";\n\t\t\tthis.stub.classList.add(\"bizproc-automation-robot-container-drag\");\n\t\t\tthis.stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.stub);\n\t\t}\n\t}\n\n\tdragMove(x,y)\n\t{\n\t\tthis.stub.style.left = x + \"px\";\n\t\tthis.stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-robot\")\n\t\t{\n\t\t\tthis.droppableItem = destination;\n\t\t\tthis.droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-robot\")\n\t\t{\n\t\t\tthis.droppableColumn = destination.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.droppableItem = null;\n\t\t}\n\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.add(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.add(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\n\t\tif (this.draggableItem)\n\t\t{\n\t\t\tif (this.droppableItem)\n\t\t\t{\n\t\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableItem.parentNode,\n\t\t\t\t\tisCopy,\n\t\t\t\t\tdroppableItem: this.droppableItem,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.droppableColumn)\n\t\t\t{\n\t\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableColumn,\n\t\t\t\t\tisCopy,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.stub.parentNode.removeChild(this.stub);\n\t\tthis.stub = null;\n\t\tthis.draggableItem = null;\n\t\tthis.droppableItem = null;\n\t}\n\n\tmoveTo(template, beforeRobot)\n\t{\n\t\tDom.remove(this.#node);\n\t\tthis.#template.deleteRobot(this);\n\t\tthis.#template = template;\n\n\t\tthis.#template.insertRobot(this, beforeRobot);\n\t\tthis.#node = this.createNode();\n\t\tthis.#template.insertRobotNode(this.#node, beforeRobot ? beforeRobot.node : null);\n\t}\n\n\tcopyTo(template, beforeRobot)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = this.serialize();\n\t\tdelete robotData['Name'];\n\t\tdelete robotData['DelayName'];\n\n\t\trobot.init(robotData, this.#viewMode);\n\n\t\ttemplate.insertRobot(robot, beforeRobot);\n\t\ttemplate.insertRobotNode(robot.node, beforeRobot ? beforeRobot.node : null);\n\n\t\treturn robot;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getProperty('Title') || this.getDescriptionTitle();\n\t}\n\n\tgetDescriptionTitle()\n\t{\n\t\tlet name = 'untitled';\n\t\tconst description = this.template?.getRobotDescription(this.#data['Type']) ?? {};\n\t\tif (description['NAME'])\n\t\t{\n\t\t\tname = description['NAME'];\n\t\t}\n\t\tif (description['ROBOT_SETTINGS'] && description['ROBOT_SETTINGS']['TITLE'])\n\t\t{\n\t\t\tname = description['ROBOT_SETTINGS']['TITLE'];\n\t\t}\n\n\t\treturn name;\n\t}\n\n\thasTitle(): boolean\n\t{\n\t\treturn this.getTitle() !== 'untitled';\n\t}\n\n\thasReturnFields(): boolean\n\t{\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\t\tconst props = this.#data['Properties'];\n\n\t\tif (!Type.isObject(description))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst hasReturnProperties = () => (\n\t\t\tType.isObject(description['RETURN'])\n\t\t\t&& Type.isArrayFilled(Object.values(description['RETURN']))\n\t\t);\n\n\t\tconst hasAdditionalResultProperties = () => (\n\t\t\tType.isArray(description['ADDITIONAL_RESULT'])\n\t\t\t&& description['ADDITIONAL_RESULT'].some(addProperty => Object.values(props[addProperty] ?? []).length > 0)\n\t\t);\n\n\t\treturn hasReturnProperties() || hasAdditionalResultProperties();\n\t}\n\n\tgetReturnFieldsDescription()\n\t{\n\t\tconst fields = [];\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\n\t\tif (description && description['RETURN'])\n\t\t{\n\t\t\tfor (const fieldId in description['RETURN'])\n\t\t\t{\n\t\t\t\tif (description['RETURN'].hasOwnProperty(fieldId))\n\t\t\t\t{\n\t\t\t\t\tconst field = description['RETURN'][fieldId];\n\t\t\t\t\tfields.push({\n\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\tObjectName: this.getTitle(),\n\t\t\t\t\t\tName: field['NAME'],\n\t\t\t\t\t\tType: field['TYPE'],\n\t\t\t\t\t\tOptions: field['OPTIONS'] || null,\n\t\t\t\t\t\tExpression: '{{~'+this.getId()+':'+fieldId+' # '+this.getTitle()+': '+field['NAME']+'}}',\n\t\t\t\t\t\tSystemExpression: '{='+this.getId()+':'+fieldId+'}'\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!this.appendPropertyMods)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t//generate printable version\n\t\t\t\t\tif (\n\t\t\t\t\t\tfield['TYPE'] === 'user'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'bool'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'file'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst printableTag = (field['TYPE'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\tName: field['NAME'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['NAME']}}}`,\n\t\t\t\t\t\t\tSystemExpression: `{=${this.getId()}:${fieldId}>${printableTag}}`,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (description && Type.isArray(description['ADDITIONAL_RESULT']))\n\t\t{\n\t\t\tconst props = this.#data['Properties'];\n\n\t\t\tdescription['ADDITIONAL_RESULT'].forEach((addProperty) => {\n\t\t\t\tif (props[addProperty])\n\t\t\t\t{\n\t\t\t\t\tfor (const fieldId in props[addProperty])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (props[addProperty].hasOwnProperty(fieldId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst field = props[addProperty][fieldId];\n\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\tName: field['Name'],\n\t\t\t\t\t\t\t\tType: field['Type'],\n\t\t\t\t\t\t\t\tOptions: field['Options'] || null,\n\t\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} # ${this.getTitle()}: ${field['Name']}}}`,\n\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '}',\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t//generate printable version\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tfield['Type'] === 'user'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'bool'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'file'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst printableTag = (field['Type'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\t\t\tconst expression = `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['Name']}}}`;\n\t\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\t\tName: field['Name'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\t\t\tExpression: expression,\n\t\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '>' + printableTag + '}',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tgetReturnProperty(id): Array<Object>\n\t{\n\t\tconst fields = this.getReturnFieldsDescription();\n\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t{\n\t\t\tif (fields[i]['Id'] === id)\n\t\t\t{\n\t\t\t\treturn fields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst properties = this.getProperties();\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tObject.values(properties).forEach(property => this.collectExpressions(property, usages));\n\n\t\tconst conditions = this.getCondition().serialize();\n\t\tconditions.items.forEach(item => this.collectParsedExpressions(item[0], usages));\n\n\t\treturn usages;\n\t}\n\n\tcollectExpressions(value, usages)\n\t{\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue.forEach(v => this.collectExpressions(v, usages));\n\t\t}\n\t\telse if (Type.isPlainObject(value))\n\t\t{\n\t\t\tObject.values(value).forEach(value => this.collectExpressions(value, usages));\n\t\t}\n\t\telse if (Type.isStringFilled(value))\n\t\t{\n\t\t\tlet found;\n\t\t\tconst systemExpressionRegExp = new RegExp(this.SYSTEM_EXPRESSION_PATTERN, 'ig');\n\t\t\twhile ((found = systemExpressionRegExp.exec(value)) !== null)\n\t\t\t{\n\t\t\t\tthis.collectParsedExpressions(found.groups, usages);\n\t\t\t}\n\t\t}\n\t}\n\n\tcollectParsedExpressions(parsedUsage, usages)\n\t{\n\t\tif (Type.isPlainObject(parsedUsage) && parsedUsage['object'] && parsedUsage['field'])\n\t\t{\n\t\t\tswitch (parsedUsage['object'])\n\t\t\t{\n\t\t\t\tcase 'Document':\n\t\t\t\t\tusages.Document.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Constant':\n\t\t\t\t\tusages.Constant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Variable':\n\t\t\t\t\tusages.Variable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Template':\n\t\t\t\t\tusages.Parameter.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalConst':\n\t\t\t\t\tusages.GlobalConstant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalVar':\n\t\t\t\t\tusages.GlobalVariable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst activityRegExp = new RegExp(/^A[_0-9]+$/, 'ig');\n\t\t\tif (activityRegExp.exec(parsedUsage['object']))\n\t\t\t{\n\t\t\t\tusages.Activity.add([parsedUsage['object'], parsedUsage['field']]);\n\t\t\t}\n\t\t}\n\t}\n\n\thasBrokenLink(): boolean\n\t{\n\t\treturn this.getBrokenLinks().length > 0;\n\t}\n\n\tgetBrokenLinks(): []\n\t{\n\t\tconst usages = Runtime.clone(this.collectUsages());\n\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst objectsData = {\n\t\t\tDocument: this.#document.getFields(),\n\t\t\tConstant: this.#template.getConstants(),\n\t\t\tVariable: this.#template.getVariables(),\n\t\t\tGlobalConstant: this.#template.globalConstants,\n\t\t\tGlobalVariable: this.#template.globalVariables,\n\t\t\tParameter: this.#template.getParameters(),\n\t\t\tActivity: this.#template.getSerializedRobots()\n\t\t};\n\n\t\tconst brokenLinks = [];\n\t\tfor (const object in usages)\n\t\t{\n\t\t\tif (usages[object].size > 0)\n\t\t\t{\n\t\t\t\tconst source = new Set();\n\n\t\t\t\tfor (const key in objectsData[object])\n\t\t\t\t{\n\t\t\t\t\tif (objectsData[object][key]['Id'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Id']);\n\t\t\t\t\t}\n\t\t\t\t\telse if (objectsData[object][key]['Name'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Name']);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (const value of usages[object].values())\n\t\t\t\t{\n\t\t\t\t\tlet searchInSource = value;\n\t\t\t\t\tlet id = value;\n\n\t\t\t\t\tif (Type.isArray(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\tsearchInSource = value[0];\n\t\t\t\t\t\tid = value[1];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!source.has(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (object === 'Activity')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbrokenLinks.push('{=' + searchInSource + ':' + id + '}');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet brokenLinkObject = object;\n\n\t\t\t\t\t\t\tif (brokenLinkObject === 'GlobalVariable')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbrokenLinkObject = 'GlobalVar';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (brokenLinkObject === 'GlobalConstant')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbrokenLinkObject = 'GlobalConst';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (brokenLinkObject === 'Parameter')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbrokenLinkObject = 'Template';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbrokenLinks.push('{=' + brokenLinkObject + ':' + searchInSource + '}');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (object === 'Activity')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst robot = this.#template.getRobotById(searchInSource);\n\t\t\t\t\t\tif (!robot.getReturnProperty(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbrokenLinks.push('{=' + searchInSource + ':' + id + '}');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn brokenLinks;\n\t}\n}\n","import { Type, Runtime } from 'main.core';\n\nexport class UserOptions\n{\n\t#options: Object<string, any>;\n\n\tconstructor(options: Object<string, any>)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new UserOptions(Runtime.clone(this.#options));\n\t}\n\n\tset(category: string, key: string, value: any): UserOptions\n\t{\n\t\tif (!Type.isPlainObject(this.#options[category]))\n\t\t{\n\t\t\tthis.#options[category] = {};\n\t\t}\n\t\tconst storedValue = this.#options[category][key];\n\n\t\tif (storedValue !== value)\n\t\t{\n\t\t\tBX.userOptions.save(\n\t\t\t\t'bizproc.automation',\n\t\t\t\tcategory,\n\t\t\t\tkey,\n\t\t\t\tvalue,\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget(category: string, key: string, defaultValue: any): any\n\t{\n\t\tlet result = defaultValue;\n\t\tif (this.has(category, key))\n\t\t{\n\t\t\tresult = this.#options[category][key];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thas(category: string, key: string): boolean\n\t{\n\t\treturn Type.isPlainObject(this.#options[category]) && Type.isPlainObject(this.#options[category][key]);\n\t}\n}","import {Type, Dom, Loc, Event, Runtime, Uri, Text, Tag} from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport {\n\tContext,\n\tSelectorContext,\n\tgetGlobalContext,\n\tTracker,\n\tDesigner,\n\tConditionGroupSelector,\n\tConditionGroup,\n\tDelayIntervalSelector,\n\tSelectorManager,\n} from 'bizproc.automation';\nimport { Robot } from './robot'\nimport { UserOptions } from './user-options';\nimport { ViewMode } from './view-mode';\nimport { Helper } from './helper';\nimport { HelpHint } from './help-hint';\nimport { DelayInterval } from './delay-interval';\nimport 'ui.hint';\n\nexport class Template extends EventEmitter\n{\n\t#context: Context;\n\n\tconstants: Object<string, any>;\n\tvariables: Object<string, any>;\n\trobotSettingsControls;\n\n\t#delayMinLimitM: number;\n\t#userOptions: UserOptions | null;\n\t#tracker: Tracker;\n\t#viewMode: ViewMode;\n\n\t#templateContainerNode: Element;\n\t#templateNode: ?Element;\n\t#listNode: Element | undefined;\n\t#buttonsNode: Element | undefined;\n\n\t#robots: Array<Robot>;\n\t#data: Object;\n\n\tconstructor(params: {\n\t\tcontext: ?Context,\n\t\ttemplateContainerNode: Element,\n\t\tconstants: Object<string, any>,\n\t\tvariables: Object<string, any>,\n\t\tuserOptions: ?UserOptions,\n\t\tdelayMinLimitM: number,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#context = params.context ?? getGlobalContext();\n\t\tthis.constants = params.constants;\n\t\tthis.variables = params.variables;\n\n\t\tthis.#templateContainerNode = params.templateContainerNode;\n\t\tthis.#delayMinLimitM = params.delayMinLimitM;\n\t\tthis.#userOptions = params.userOptions;\n\t\tthis.#tracker = this.#context.tracker;\n\t\tthis.#data = {};\n\t\tthis.#robots = [];\n\t\tthis.#viewMode = ViewMode.none();\n\t}\n\n\tinit(data: Object, viewMode: number)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t\tif (!Type.isPlainObject(this.#data.CONSTANTS))\n\t\t\t{\n\t\t\t\tthis.#data.CONSTANTS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.PARAMETERS))\n\t\t\t{\n\t\t\t\tthis.#data.PARAMETERS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.VARIABLES))\n\t\t\t{\n\t\t\t\tthis.#data.VARIABLES = {};\n\t\t\t}\n\t\t\tif (!Type.isNil(this.#data.DOCUMENT_STATUS))\n\t\t\t{\n\t\t\t\tthis.#data.DOCUMENT_STATUS = String(this.#data.DOCUMENT_STATUS);\n\t\t\t}\n\n\t\t\tthis.markExternalModified(this.#data['IS_EXTERNAL_MODIFIED']);\n\t\t\tthis.markModified(false);\n\t\t}\n\n\t\tthis.#viewMode = ViewMode.fromRaw(viewMode);\n\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#templateNode = this.#templateContainerNode.querySelector(\n\t\t\t\t'[data-role=\"automation-template\"][data-status-id=\"' + this.#data.DOCUMENT_STATUS + '\"]'\n\t\t\t);\n\t\t\tthis.#listNode = this.#templateNode.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.#buttonsNode = this.#templateNode.querySelector('[data-role=\"buttons\"]');\n\n\t\t\tthis.initRobots();\n\t\t\tthis.initButtons();\n\n\t\t\tif (!this.isExternalModified() && this.canEdit())\n\t\t\t{\n\t\t\t\t//register DD\n\t\t\t\tjsDD.registerDest(this.#templateNode, 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjsDD.unregisterDest(this.#templateNode);\n\t\t\t}\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: number)\n\t{\n\t\tDom.clean(this.#listNode);\n\t\tDom.clean(this.#buttonsNode);\n\n\t\tthis.destroy();\n\t\tthis.init(data, viewMode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#robots.forEach(robot => robot.destroy());\n\t}\n\n\tstatic copyRobotTo(dstTemplate: Template, robot: Robot, beforeRobot: ?Robot): Robot\n\t{\n\t\tconst copiedRobot = robot.copyTo(dstTemplate, beforeRobot);\n\t\tdstTemplate.emit('Template:robot:add', {robot: copiedRobot});\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn this.#context.canEdit;\n\t}\n\n\tinitRobots()\n\t{\n\t\tthis.#robots = [];\n\n\t\tif (Type.isArray(this.#data.ROBOTS))\n\t\t{\n\t\t\tfor (let i = 0; i < this.#data.ROBOTS.length; ++i)\n\t\t\t{\n\t\t\t\tconst robot = new Robot({\n\t\t\t\t\tdocument: this.#context.document,\n\t\t\t\t\ttemplate: this,\n\t\t\t\t\tisFrameMode: this.#context.get('isFrameMode'),\n\t\t\t\t\ttracker: this.#tracker,\n\t\t\t\t});\n\t\t\t\trobot.init(this.#data.ROBOTS[i], this.#viewMode);\n\t\t\t\tthis.insertRobotNode(robot.node);\n\t\t\t\tthis.#robots.push(robot);\n\t\t\t}\n\t\t}\n\t}\n\n\tget robots(): Array<Robot>\n\t{\n\t\treturn this.#robots;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.#userOptions;\n\t}\n\n\tgetSelectedRobotNames(): Array<Robot>\n\t{\n\t\tconst selectedRobots = [];\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tif (robot.isSelected())\n\t\t\t{\n\t\t\t\tselectedRobots.push(robot.data.Name);\n\t\t\t}\n\t\t});\n\n\t\treturn selectedRobots;\n\t}\n\n\tgetActivatedRobotNames(): Array<string>\n\t{\n\t\tconst activatedRobots = [];\n\t\tthis.#robots.forEach(robot => {\n\t\t\tif (robot.isActivated())\n\t\t\t{\n\t\t\t\tactivatedRobots.push(robot.data.Name);\n\t\t\t}\n\t\t});\n\n\t\treturn activatedRobots;\n\t}\n\n\tgetDeactivatedRobotNames(): Array<string>\n\t{\n\t\tconst deactivatedRobots = [];\n\t\tthis.#robots.forEach(robot => {\n\t\t\tif (!robot.isActivated())\n\t\t\t{\n\t\t\t\tdeactivatedRobots.push(robot.data.Name);\n\t\t\t}\n\t\t});\n\n\t\treturn deactivatedRobots;\n\t}\n\n\tgetSerializedRobots()\n\t{\n\t\tconst serialized = [];\n\t\tthis.#robots.forEach(robot => serialized.push(robot.serialize()));\n\n\t\treturn serialized;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.#data.ID;\n\t}\n\n\tgetStatusId(): ?string\n\t{\n\t\treturn this.#data.DOCUMENT_STATUS;\n\t}\n\n\tgetStatus(): ?object\n\t{\n\t\treturn this.#context.document.statusList.find(status => String(status.STATUS_ID) === this.getStatusId());\n\t}\n\n\tgetTemplateId()\n\t{\n\t\tconst id = parseInt(this.#data.ID);\n\n\t\treturn !isNaN(id) ? id : 0;\n\t}\n\n\tinitButtons()\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.createExternalLocker();\n\t\t\tthis.createManageModeButton();\n\t\t}\n\t\telse if (this.#viewMode.isEdit() && this.getTemplateId() > 0)\n\t\t{\n\t\t\tthis.createConstantsEditButton();\n\t\t\tthis.createParametersEditButton();\n\t\t\tthis.createExternalEditTemplateButton();\n\t\t\tthis.createManageModeButton();\n\t\t}\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\t\tif (isActive)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--multiselect-mode');\n\t\t\t}\n\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.enableManageMode(isActive));\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.edit();\n\t\t\tDom.removeClass(this.#listNode, '--multiselect-mode');\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.disableManageMode());\n\t\t\t}\n\n\t\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t\t});\n\t\t}\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.registerItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.unregisterItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tcreateExternalEditTemplateButton(): undefined | boolean\n\t{\n\t\tif (Type.isNil(this.#context.bizprocEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst self = this;\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: '#'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top'\n\t\t\t}\n\t\t});\n\n\t\tif (!this.#context.bizprocEditorUrl.length)\n\t\t{\n\t\t\tDom.addClass(anchor, 'bizproc-automation-robot-btn-set-locked');\n\t\t}\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateManageModeButton()\n\t{\n\t\tif (!this.#context.canManage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst manageButton = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_MANAGE_ROBOTS_1'),\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top',\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tcursor: 'pointer',\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: event => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.onManageModeButtonClick(manageButton);\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(manageButton);\n\t}\n\n\tonManageModeButtonClick(manageButtonNode: HTMLElement)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(manageButtonNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('Template:enableManageMode', {\n\t\t\t\tdocumentStatus: this.#data.DOCUMENT_STATUS,\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateConstantsEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(this.#context.constantsEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url =\n\t\t\t!this.#viewMode.isManage()\n\t\t\t\t? this.#context.constantsEditorUrl.replace('#ID#', this.getTemplateId())\n\t\t\t\t: '#'\n\t\t;\n\n\t\tif (!url.length)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CONSTANTS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateParametersEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(this.#context.parametersEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url = this.#context.parametersEditorUrl.replace('#ID#', this.getTemplateId());\n\n\t\tif (!url.length || this.#viewMode.isManage())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_PARAMETERS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateExternalLocker()\n\t{\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-container\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-robot-container-wrapper bizproc-automation-robot-container-wrapper-lock'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" }\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT_TEXT')\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tEvent.bind(div, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.appendChild(settingsBtn);\n\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEvent.bind(deleteBtn, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onUnsetExternalModifiedClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\t\t}\n\n\t\tthis.#listNode.appendChild(div);\n\t\tthis.#templateNode = div;\n\t}\n\n\tonSearch(event: BaseEvent)\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.onExternalModifiedSearch(event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.forEach(robot => robot.onSearch(event));\n\t\t}\n\t}\n\n\tonExternalModifiedSearch(event)\n\t{\n\t\tif (this.#templateNode)\n\t\t{\n\t\t\tconst query = event.getData().queryString;\n\t\t\tBX[!query ? 'removeClass' : 'addClass'](this.#templateNode, '--search-mismatch');\n\t\t}\n\t}\n\n\tonExternalEditTemplateButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.#context.bizprocEditorUrl.length)\n\t\t{\n\t\t\tif (top.BX.UI && top.BX.UI.InfoHelper)\n\t\t\t{\n\t\t\t\ttop.BX.UI.InfoHelper.show('limit_office_bp_designer');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst templateId = this.getTemplateId();\n\t\tif (templateId > 0)\n\t\t{\n\t\t\tthis.openBizprocEditor(templateId);\n\t\t}\n\t}\n\n\tonUnsetExternalModifiedClick(button)\n\t{\n\t\tthis.#templateNode = null;\n\n\t\tthis.markExternalModified(false);\n\t\tthis.markModified();\n\t\tthis.reInit(null, this.#viewMode.intoRaw());\n\t}\n\n\topenBizprocEditor(templateId)\n\t{\n\t\ttop.window.location.href = this.#context.bizprocEditorUrl.replace('#ID#', templateId)\n\t}\n\n\taddRobot(robotData, callback)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: this.#context.document,\n\t\t\ttemplate: this,\n\t\t\tisFrameMode: this.#context.get('isFrameMode'),\n\t\t\ttracker: this.#tracker,\n\t\t});\n\t\tconst initData = {\n\t\t\tType: robotData['CLASS'],\n\t\t\tProperties: {\n\t\t\t\tTitle: robotData['NAME']\n\t\t\t},\n\t\t\tDialogContext: robotData['DIALOG_CONTEXT'],\n\t\t};\n\n\t\tif (this.#robots.length > 0)\n\t\t{\n\t\t\tconst parentRobot = this.#robots[this.#robots.length - 1];\n\t\t\tif (!parentRobot.getDelayInterval().isNow() || parentRobot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\tinitData['Delay'] = parentRobot.getDelayInterval().serialize();\n\t\t\t\tinitData['ExecuteAfterPrevious'] =  1;\n\t\t\t}\n\t\t}\n\n\t\trobot.draft = true;\n\t\trobot.init(initData, this.#viewMode);\n\n\t\tthis.insertRobot(robot);\n\t\tthis.insertRobotNode(robot.node);\n\t\tthis.emit('Template:robot:add', {robot});\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, robot);\n\t\t}\n\t}\n\n\tinsertRobot(robot, beforeRobot)\n\t{\n\t\tif (beforeRobot)\n\t\t{\n\t\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#robots[i] !== beforeRobot)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis.#robots.splice(i, 0, robot);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.push(robot);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tgetNextRobot(robot)\n\t{\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i] === robot)\n\t\t\t{\n\t\t\t\treturn (this.#robots[i + 1] || null);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tdeleteRobot(robot, callback)\n\t{\n\t\tfor(let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i].isEqual(robot))\n\t\t\t{\n\t\t\t\tthis.#robots.splice(i, 1);\n\n\t\t\t\tif (callback)\n\t\t\t\t{\n\t\t\t\t\tcallback(robot);\n\t\t\t\t}\n\n\t\t\t\tthis.markModified();\n\t\t\t\tthis.emit('Template:robot:delete', { robot });\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tinsertRobotNode(robotNode, beforeNode)\n\t{\n\t\tif (beforeNode)\n\t\t{\n\t\t\tthis.#listNode.insertBefore(robotNode, beforeNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#listNode.appendChild(robotNode);\n\t\t}\n\t}\n\n\topenRobotSettingsDialog(robot: Robot, context?: Object, saveCallback: (Robot) => void)\n\t{\n\t\tif (!Type.isPlainObject(context))\n\t\t{\n\t\t\tcontext = {};\n\t\t}\n\n\t\tif (Designer.getInstance().getRobotSettingsDialog())\n\t\t{\n\t\t\tif (context.changeRobot)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getRobotSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_robot_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t}\n\t\t});\n\n\t\tDesigner.getInstance().setRobotSettingsDialog({\n\t\t\ttemplate: this,\n\t\t\tcontext: context,\n\t\t\trobot: robot,\n\t\t\tform: form\n\t\t});\n\n\t\tform.appendChild(this.renderDelaySettings(robot));\n\t\tform.appendChild(this.renderConditionSettings(robot));\n\n\t\tconst robotBrokenLinks = robot.getBrokenLinks();\n\t\tif (robotBrokenLinks.length > 0)\n\t\t{\n\t\t\tDom.append(this.renderBrokenLinkAlert(robotBrokenLinks), form);\n\t\t}\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {\n\t\t\t\tclick: (event) => this.emit('Template:help:show', event)\n\t\t\t},\n\t\t});\n\t\tform.appendChild(iconHelp);\n\t\tcontext['DOCUMENT_CATEGORY_ID'] = this.#context.document.getCategoryId();\n\t\tif (Type.isPlainObject(robot.data.DialogContext) && (robot.data.DialogContext.hasOwnProperty('addMenuGroup')))\n\t\t{\n\t\t\tcontext['addMenuGroup'] = robot.data.DialogContext.addMenuGroup;\n\t\t}\n\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'html',\n\t\t\turl: Uri.addParam(\n\t\t\t\tthis.#context.ajaxUrl,\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: `automation_robot${robot.draft ? '_draft' : ''}_settings_${robot.data.Type.toLowerCase()}`\n\t\t\t\t}\n\t\t\t),\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_robot_dialog',\n\t\t\t\tdocument_signed: this.#context.signedDocument,\n\t\t\t\tdocument_status: this.#context.document.getCurrentStatusId(),\n\t\t\t\tcontext: context,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_name: formName\n\t\t\t},\n\t\t\tonsuccess: html => {\n\t\t\t\tif (html)\n\t\t\t\t{\n\t\t\t\t\tconst dialogRows = Dom.create('div', {\n\t\t\t\t\t\thtml: html\n\t\t\t\t\t});\n\t\t\t\t\tform.appendChild(dialogRows);\n\t\t\t\t}\n\n\t\t\t\tthis.showRobotSettingsPopup(robot, form, saveCallback);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowRobotSettingsPopup(robot: Robot, form: HTMLFormElement, saveCallback: (Robot) => void)\n\t{\n\t\tlet popupMinWidth = 580;\n\t\tlet popupWidth = popupMinWidth;\n\n\t\tif (this.#userOptions)\n\t\t{\n\t\t\t// TODO move from if?\n\t\t\tthis.emit('Template:robot:showSettings');\n\t\t\tpopupWidth = parseInt(\n\t\t\t\tthis.#userOptions.get('defaults', 'robot_settings_popup_width', 580)\n\t\t\t);\n\t\t}\n\n\t\tthis.initRobotSettingsControls(robot, form);\n\n\t\tif (\n\t\t\trobot.data.Type === 'CrmSendEmailActivity'\n\t\t\t|| robot.data.Type === 'MailActivity'\n\t\t\t|| robot.data.Type === 'RpaApproveActivity'\n\t\t)\n\t\t{\n\t\t\tpopupMinWidth += 170;\n\t\t\tif (popupWidth < popupMinWidth)\n\t\t\t{\n\t\t\t\tpopupWidth = popupMinWidth;\n\t\t\t}\n\t\t}\n\n\t\tlet robotTitle = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_SETTINGS_TITLE');\n\t\tlet descriptionTitle = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_SETTINGS_TITLE');\n\n\t\tif (robot.hasTitle())\n\t\t{\n\t\t\trobotTitle = robot.getTitle();\n\t\t\tdescriptionTitle = robot.getDescriptionTitle();\n\n\t\t\tif (descriptionTitle === 'untitled')\n\t\t\t{\n\t\t\t\tdescriptionTitle = robotTitle;\n\t\t\t}\n\t\t}\n\n\t\tconst titleBarContent = Tag.render`\n\t\t\t<div class=\"popup-window-titlebar-text bizproc-automation-robot-settings-popup-titlebar\">\n\t\t\t\t<span class=\"bizproc-automation-robot-settings-popup-titlebar-text\">${Text.encode(robotTitle)}</span>\n\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t<span class=\"ui-hint-icon\" data-text=\"${Text.encode(descriptionTitle)}\"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tHelpHint.bindAll(titleBarContent);\n\n\t\tconst me = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: {\n\t\t\t\tcontent: titleBarContent,\n\t\t\t},\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\twidth: popupWidth,\n\t\t\tresizable: {\n\t\t\t\tminWidth: popupMinWidth,\n\t\t\t\tminHeight: 100\n\t\t\t},\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\tevents: {\n\t\t\t\tonPopupClose: (popup) => {\n\t\t\t\t\tDesigner.getInstance().setRobotSettingsDialog(null);\n\t\t\t\t\tthis.destroyRobotSettingsControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tthis.emit('Template:robot:closeSettings');\n\t\t\t\t},\n\t\t\t\tonPopupResize: () => {\n\t\t\t\t\tthis.onResizeRobotSettings();\n\t\t\t\t},\n\t\t\t\tonPopupResizeEnd: function() {\n\t\t\t\t\tif (me.#userOptions)\n\t\t\t\t\t{\n\t\t\t\t\t\tme.#userOptions.set(\n\t\t\t\t\t\t\t'defaults',\n\t\t\t\t\t\t\t'robot_settings_popup_width',\n\t\t\t\t\t\t\tthis.getWidth()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst isNewRobot = robot.draft;\n\n\t\t\t\t\t\t\tme.saveRobotSettings(form, robot, BX.delegate(function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t\t\tif (isNewRobot)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tme.emit('Template:robot:add', { robot });\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (saveCallback)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsaveCallback(robot);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, this), this.buttonNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick: function(){\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tDesigner.getInstance().getRobotSettingsDialog().popup = popup;\n\t\tpopup.show();\n\t}\n\n\tinitRobotSettingsControls(robot, node)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tthis.initRobotSettingsControl(robot, controlNodes[i]);\n\t\t}\n\t}\n\n\tinitRobotSettingsControl(robot, controlNode)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tconst role = controlNode.getAttribute('data-role');\n\n\t\tconst controlProps = {\n\t\t\tcontext: new SelectorContext({\n\t\t\t\tfields: Runtime.clone(this.#context.document.getFields()),\n\t\t\t\tuseSwitcherMenu: this.#context.get('showTemplatePropertiesMenuOnSelecting'),\n\t\t\t\trootGroupTitle: this.#context.document.title,\n\t\t\t\tuserOptions: this.#context.userOptions,\n\t\t\t}),\n\t\t\tneedSync: robot.draft,\n\t\t\tcheckbox: controlNode,\n\t\t};\n\n\t\tif (role === SelectorManager.SELECTOR_ROLE_USER)\n\t\t{\n\t\t\tconst fieldProperty = JSON.parse(controlNode.getAttribute('data-property'));\n\t\t\tcontrolProps.context.set('additionalUserFields', [\n\t\t\t\t...this.#getUserSelectorAdditionalFields(fieldProperty),\n\t\t\t\t...this.globalConstants.filter(constant => constant['Type'] === 'user').map(constant => ({\n\t\t\t\t\tid: constant['Expression'],\n\t\t\t\t\ttitle: constant['Name'],\n\t\t\t\t})),\n\t\t\t\t...this.globalVariables.filter(variable => variable['Type'] === 'user').map(variable => ({\n\t\t\t\t\tid: variable['Expression'],\n\t\t\t\t\ttitle: variable['Name'],\n\t\t\t\t})),\n\t\t\t]);\n\t\t}\n\t\telse if (role === SelectorManager.SELECTOR_ROLE_FILE)\n\t\t{\n\t\t\tthis.robots.forEach((robot) => {\n\t\t\t\tcontrolProps.context.fields.push(\n\t\t\t\t\t...robot\n\t\t\t\t\t\t.getReturnFieldsDescription()\n\t\t\t\t\t\t.filter(field => field['Type'] === 'file')\n\t\t\t\t\t\t.map((field) => ({\n\t\t\t\t\t\t\tId: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t\tName: `${robot.getTitle()}: ${field['Name']}`,\n\t\t\t\t\t\t\tType: 'file',\n\t\t\t\t\t\t\tExpression: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t}))\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst control = SelectorManager.createSelectorByRole(role, controlProps);\n\n\t\tif (control && role !== SelectorManager.SELECTOR_ROLE_SAVE_STATE)\n\t\t{\n\t\t\tcontrol.renderTo(controlNode);\n\n\t\t\tcontrol.subscribe('onAskConstant', (event) => {\n\t\t\t\tconst {fieldProperty} = event.getData();\n\t\t\t\tcontrol.onFieldSelect(this.addConstant(fieldProperty));\n\t\t\t});\n\t\t\tcontrol.subscribe('onAskParameter', (event) => {\n\t\t\t\tconst {fieldProperty} = event.getData();\n\t\t\t\tcontrol.onFieldSelect(this.addParameter(fieldProperty));\n\t\t\t});\n\t\t\tcontrol.subscribe('onOpenFieldMenu', (event) => this.onOpenMenu(event, robot));\n\t\t\tcontrol.subscribe('onOpenMenu', (event) => this.onOpenMenu(event, robot));\n\t\t}\n\n\t\tBX.UI.Hint.init(controlNode);\n\n\t\tif (control)\n\t\t{\n\t\t\tthis.robotSettingsControls.push(control);\n\t\t}\n\t}\n\n\t#getUserSelectorAdditionalFields(fieldProperty): Array<object>\n\t{\n\t\tconst additionalFields = (\n\t\t\tthis\n\t\t\t\t.#getRobotsWithReturnFields()\n\t\t\t\t.map((robot) => (\n\t\t\t\t\trobot\n\t\t\t\t\t\t.getReturnFieldsDescription()\n\t\t\t\t\t\t.filter(field => field['Type'] === 'user')\n\t\t\t\t\t\t.map((field) => ({\n\t\t\t\t\t\t\tid: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t\ttitle: `${robot.getTitle()}: ${field['Name']}`,\n\t\t\t\t\t\t}))\n\t\t\t\t))\n\t\t\t\t.flat()\n\t\t);\n\n\t\tif (this.#context.get('showTemplatePropertiesMenuOnSelecting') && fieldProperty)\n\t\t{\n\t\t\tconst ask = this.addConstant(Runtime.clone(fieldProperty));\n\n\t\t\tadditionalFields.push({\n\t\t\t\tid: ask.Expression,\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'),\n\t\t\t\ttabs: ['recents', 'bpuserroles'],\n\t\t\t\tsort: 1,\n\t\t\t});\n\n\t\t\tconst param = this.addParameter(Runtime.clone(fieldProperty));\n\n\t\t\tadditionalFields.push({\n\t\t\t\tid: param.Expression,\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'),\n\t\t\t\ttabs: ['recents', 'bpuserroles'],\n\t\t\t\tsort: 2,\n\t\t\t});\n\t\t}\n\n\t\treturn additionalFields;\n\t}\n\n\t#addRobotReturnFieldsToSelector(event: BaseEvent, skipRobot: ?Robot)\n\t{\n\t\tconst selector = event.getData().selector;\n\t\tconst isMixedCondition = event.getData().isMixedCondition;\n\n\t\tif (Type.isBoolean(isMixedCondition) && !isMixedCondition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst robotMenuItems = (\n\t\t\tthis\n\t\t\t\t.#getRobotsWithReturnFields(skipRobot)\n\t\t\t\t.map((robot) => ({\n\t\t\t\t\tid: robot.getId(),\n\t\t\t\t\ttitle: robot.getTitle(),\n\t\t\t\t\tchildren: robot.getReturnFieldsDescription().map((field) => ({\n\t\t\t\t\t\tid: field.Expression,\n\t\t\t\t\t\ttitle: field.Name,\n\t\t\t\t\t\tcustomData: { field },\n\t\t\t\t\t}))\n\t\t\t\t}))\n\t\t);\n\n\t\tif (robotMenuItems.length > 0)\n\t\t{\n\t\t\tselector.addGroup('__RESULT', {\n\t\t\t\tid: '__RESULT',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_LIST'),\n\t\t\t\tchildren: robotMenuItems\n\t\t\t});\n\t\t}\n\t}\n\n\t#addConstantsToSelector(event: BaseEvent)\n\t{\n\t\tconst selector = event.getData().selector;\n\t\tconst isMixedCondition = event.getData().isMixedCondition;\n\n\t\tif (Type.isBoolean(isMixedCondition) && !isMixedCondition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// TODO - test !this.showTemplatePropertiesMenuOnSelecting\n\t\tconst constants = this.getConstants().map((constant) => {\n\t\t\treturn {\n\t\t\t\tid: constant.SystemExpression,\n\t\t\t\ttitle: constant.Name,\n\t\t\t\tsupertitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TEMPLATE_CONSTANTS_LIST'),\n\t\t\t\tcustomData: { field: constant }\n\t\t\t};\n\t\t});\n\n\t\tthis.globalConstants.forEach((constant) => {\n\t\t\tconstants.push({\n\t\t\t\tid: constant.SystemExpression,\n\t\t\t\ttitle: constant['Name'],\n\t\t\t\tsupertitle: constant.SuperTitle,\n\t\t\t\tcustomData: { field: constant },\n\t\t\t});\n\t\t});\n\n\t\tif (Type.isArrayFilled(constants))\n\t\t{\n\t\t\tselector.addGroup(\n\t\t\t\t'__CONSTANTS',\n\t\t\t\t{\n\t\t\t\t\tid: '__CONSTANTS',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CONSTANTS_LIST'),\n\t\t\t\t\tchildren: constants\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t#addVariablesToSelector(event: BaseEvent)\n\t{\n\t\tconst selector = event.getData().selector;\n\t\tconst isMixedCondition = event.getData().isMixedCondition;\n\n\t\tif (Type.isBoolean(isMixedCondition) && !isMixedCondition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst gVariables = this.globalVariables.map((variable) => {\n\t\t\treturn {\n\t\t\t\tid: variable.SystemExpression,\n\t\t\t\ttitle: variable.Name,\n\t\t\t\tsupertitle: variable.SuperTitle,\n\t\t\t\tcustomData: {field: variable},\n\t\t\t};\n\t\t});\n\n\t\tif (Type.isArrayFilled(gVariables))\n\t\t{\n\t\t\tselector.addGroup(\n\t\t\t\t'__GLOB_VARIABLES',\n\t\t\t\t{\n\t\t\t\t\tid: '__GLOB_VARIABLES',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_GLOB_VARIABLES_LIST_1'),\n\t\t\t\t\tchildren: gVariables,\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t#getRobotsWithReturnFields(skipRobot: ?Robot = undefined): Array<Robot>\n\t{\n\t\tconst skipId = skipRobot?.getId() || '';\n\n\t\treturn this\n\t\t\t.robots\n\t\t\t.filter((templateRobot) => (\n\t\t\t\ttemplateRobot.getId() !== skipId && templateRobot.hasReturnFields()\n\t\t\t))\n\t\t;\n\t}\n\n\tdestroyRobotSettingsControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.robotSettingsControls = null;\n\t}\n\n\tonBeforeSaveRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onBeforeSave))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onBeforeSave();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonResizeRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onPopupResize))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onPopupResize();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trenderDelaySettings(robot)\n\t{\n\t\tconst delay = robot.getDelayInterval().clone();\n\t\tconst idSalt = Helper.generateUniqueId();\n\n\t\tconst delayTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_type\",\n\t\t\t\tvalue: delay.type\n\t\t\t}\n\t\t});\n\t\tconst delayValueNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value\",\n\t\t\t\tvalue: delay.value\n\t\t\t}\n\t\t});\n\t\tconst delayValueTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value_type\",\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\t\tconst delayBasisNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_basis\",\n\t\t\t\tvalue: delay.basis\n\t\t\t}\n\t\t});\n\t\tconst delayWorkTimeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_worktime\",\n\t\t\t\tvalue: delay.workTime ? 1 : 0\n\t\t\t}\n\t\t});\n\n\t\tconst delayWaitWorkDayNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_wait_workday\",\n\t\t\t\tvalue: delay.waitWorkDay ? 1 : 0\n\t\t\t}\n\t\t});\n\n\t\tconst delayInTimeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_in_time\",\n\t\t\t\tvalue: delay.inTimeString,\n\t\t\t}\n\t\t});\n\n\t\tconst delayIntervalLabelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t}\n\t\t});\n\n\t\tconst basisFields = [];\n\n\t\tconst docFields = this.#context.document.getFields();\n\t\tconst minLimitM = this.#delayMinLimitM;\n\n\t\tif (Type.isArray(docFields))\n\t\t{\n\t\t\tfor (let i = 0; i < docFields.length; ++i)\n\t\t\t{\n\t\t\t\tconst field = docFields[i];\n\t\t\t\tif (field['Type'] === 'date' || field['Type'] === 'datetime')\n\t\t\t\t{\n\t\t\t\t\tbasisFields.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst delayIntervalSelector = new DelayIntervalSelector({\n\t\t\tlabelNode: delayIntervalLabelNode,\n\t\t\tonchange(delay) {\n\t\t\t\tdelayTypeNode.value = delay.type;\n\t\t\t\tdelayValueNode.value = delay.value;\n\t\t\t\tdelayValueTypeNode.value = delay.valueType;\n\t\t\t\tdelayBasisNode.value = delay.basis;\n\t\t\t\tdelayWorkTimeNode.value = delay.workTime ? 1 : 0;\n\t\t\t\tdelayWaitWorkDayNode.value = delay.waitWorkDay ? 1 : 0;\n\t\t\t\tdelayInTimeNode.value = delay.inTimeString;\n\t\t\t},\n\t\t\tbasisFields: basisFields,\n\t\t\tminLimitM: minLimitM,\n\t\t\tuseAfterBasis: true,\n\t\t\tshowWaitWorkDay: true,\n\t\t});\n\n\t\tlet executeAfterPreviousBlock = null;\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\tconst executeAfterPreviousCheckbox = Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tid: \"param-group-3-1\" + idSalt,\n\t\t\t\t\tname: \"execute_after_previous\",\n\t\t\t\t\tvalue: '1',\n\t\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (robot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\texecuteAfterPreviousCheckbox.setAttribute('checked', 'checked');\n\t\t\t}\n\t\t\texecuteAfterPreviousBlock = Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\tchildren: [\n\t\t\t\t\texecuteAfterPreviousCheckbox,\n\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tfor: \"param-group-3-1\" + idSalt,\n\t\t\t\t\t\t\tstyle: 'color: #535C69'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS_WIDE')\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings bizproc-automation-popup-settings-flex\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block bizproc-automation-popup-settings-block-flex\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title-wrapper\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tdelayTypeNode,\n\t\t\t\t\t\t\t\tdelayValueNode,\n\t\t\t\t\t\t\t\tdelayValueTypeNode,\n\t\t\t\t\t\t\t\tdelayBasisNode,\n\t\t\t\t\t\t\t\tdelayWorkTimeNode,\n\t\t\t\t\t\t\t\tdelayWaitWorkDayNode,\n\t\t\t\t\t\t\t\tdelayInTimeNode,\n\t\t\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-left\" },\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO_EXECUTE') + \":\"\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdelayIntervalLabelNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\texecuteAfterPreviousBlock\n\t\t\t]\n\t\t});\n\n\t\tdelayIntervalSelector.init(delay);\n\n\t\treturn div;\n\t}\n\n\tsetDelaySettingsFromForm(formFields,  robot)\n\t{\n\t\tconst delay = new DelayInterval();\n\t\tdelay.setType(formFields['delay_type']);\n\t\tdelay.setValue(formFields['delay_value']);\n\t\tdelay.setValueType(formFields['delay_value_type']);\n\t\tdelay.setBasis(formFields['delay_basis']);\n\t\tdelay.setWorkTime(formFields['delay_worktime'] === '1');\n\t\tdelay.setWaitWorkDay(formFields['delay_wait_workday'] === '1');\n\t\tdelay.setInTime(formFields['delay_in_time'] ? formFields['delay_in_time'].split(':') : null);\n\t\trobot.setDelayInterval(delay);\n\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\trobot.setExecuteAfterPrevious(\n\t\t\t\tformFields['execute_after_previous'] && (formFields['execute_after_previous']) === '1'\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trenderConditionSettings(robot)\n\t{\n\t\tconst conditionGroup = robot.getCondition();\n\t\tthis.conditionSelector = new ConditionGroupSelector(conditionGroup, {\n\t\t\tfields: this.#context.document.getFields(),\n\t\t\tonOpenFieldMenu: (event) => this.onOpenMenu(event, robot),\n\t\t\tonOpenMenu: (event) => this.onOpenMenu(event, robot),\n\t\t});\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\"\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tthis.conditionSelector.createNode(),\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tonOpenMenu(event: BaseEvent, robot: Robot): void\n\t{\n\t\tthis.#addRobotReturnFieldsToSelector(event, robot);\n\t\tthis.#addConstantsToSelector(event);\n\t\tthis.#addVariablesToSelector(event);\n\n\t\tthis.emit(\n\t\t\t'Template:onSelectorMenuOpen',\n\t\t\t{\n\t\t\t\ttemplate: this,\n\t\t\t\trobot,\n\t\t\t\t...event.getData()\n\t\t\t}\n\t\t);\n\t}\n\n\tsetConditionSettingsFromForm(formFields, robot)\n\t{\n\t\trobot.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\trenderBrokenLinkAlert(brokenLinks: [] = [])\n\t{\n\t\tconst moreInfoNode = Tag.render`\n\t\t\t<div class=\"bizproc-automation-robot-broken-link-full-info\">\n\t\t\t\t${brokenLinks.map((value) => {return Text.encode(value)}).join('<br>')}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst showMoreLabel = Tag.render`\n\t\t\t<span class=\"bizproc-automation-robot-broken-link-show-more\">\n\t\t\t\t${Loc.getMessage('JS_BIZPROC_AUTOMATION_BROKEN_LINK_MESSAGE_ERROR_MORE_INFO')}\n\t\t\t</span>\n\t\t`;\n\t\tEvent.bindOnce(showMoreLabel, 'click', () => {\n\t\t\tDom.style(moreInfoNode, 'height', moreInfoNode.scrollHeight + 'px');\n\t\t\tDom.remove(showMoreLabel);\n\t\t});\n\n\t\tconst closeBtn = Tag.render`<span class=\"ui-alert-close-btn\"></span>`;\n\n\t\tconst alert = Tag.render`\n\t\t\t<div class=\"ui-alert ui-alert-warning ui-alert-icon-info\">\n\t\t\t\t<div class=\"ui-alert-message\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>${Loc.getMessage('BIZPROC_AUTOMATION_BROKEN_LINK_MESSAGE_ERROR')}</span>\n\t\t\t\t\t\t${showMoreLabel}\n\t\t\t\t\t</div>\n\t\t\t\t\t${moreInfoNode}\n\t\t\t\t</div>\n\t\t\t\t${closeBtn}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bindOnce(closeBtn, 'click', () => {Dom.remove(alert)});\n\n\t\treturn alert;\n\t}\n\n\tsaveRobotSettings(form, robot, callback, btnNode)\n\t{\n\t\tif (btnNode)\n\t\t{\n\t\t\tbtnNode.classList.add('popup-window-button-wait');\n\t\t}\n\n\t\tthis.onBeforeSaveRobotSettings();\n\t\tconst formData = BX.ajax.prepareForm(form);\n\n\t\tconst ajaxUrl = this.#context.ajaxUrl;\n\t\tconst documentSigned = this.#context.signedDocument;\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: Uri.addParam(\n\t\t\t\tajaxUrl,\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: `automation_robot${robot.draft ? '_draft' : ''}_save_${robot.data.Type.toLowerCase()}`\n\t\t\t\t}\n\t\t\t),\n\t\t\tdata: {\n\t\t\t\tajax_action: 'save_robot_settings',\n\t\t\t\tdocument_signed: documentSigned,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_data_json: Helper.toJsonString(formData['data']),\n\t\t\t\tform_data: formData['data'], /** @bug 0135641 */\n\t\t\t},\n\t\t\tonsuccess: response => {\n\t\t\t\tif (btnNode)\n\t\t\t\t{\n\t\t\t\t\tbtnNode.classList.remove('popup-window-button-wait');\n\t\t\t\t}\n\n\t\t\t\tif (response.SUCCESS)\n\t\t\t\t{\n\t\t\t\t\trobot.updateData(response.DATA.robot);\n\t\t\t\t\tthis.setDelaySettingsFromForm(formData['data'], robot);\n\t\t\t\t\tthis.setConditionSettingsFromForm(formData['data'], robot);\n\n\t\t\t\t\trobot.draft = false;\n\n\t\t\t\t\trobot.reInit();\n\t\t\t\t\tthis.markModified();\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(response.DATA)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\talert(response.ERRORS[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tserialize()\n\t{\n\t\tconst data = BX.clone(this.#data);\n\t\tdata['IS_EXTERNAL_MODIFIED'] = this.isExternalModified() ? 1 : 0;\n\t\tdata['ROBOTS'] = [];\n\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tdata['ROBOTS'].push(this.#robots[i].serialize());\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tisExternalModified()\n\t{\n\t\treturn (this.externalModified === true);\n\t}\n\n\tmarkExternalModified(modified)\n\t{\n\t\tthis.externalModified = modified !== false;\n\t}\n\n\tgetRobotById(id)\n\t{\n\t\treturn this.#robots.find(robot => robot.getId() === id);\n\t}\n\n\tisModified()\n\t{\n\t\treturn this.modified;\n\t}\n\n\tmarkModified(modified)\n\t{\n\t\tthis.modified = modified !== false;\n\n\t\tif (this.modified)\n\t\t{\n\t\t\tthis.emit('Template:modified');\n\t\t}\n\t}\n\n\tgetConstants(): []\n\t{\n\t\tconst constants = [];\n\n\t\tObject.keys(this.#data.CONSTANTS).forEach(id => {\n\t\t\tconst constant = Runtime.clone(this.#data.CONSTANTS[id]);\n\n\t\t\tconstant.Id = id;\n\t\t\tconstant.ObjectId = 'Constant';\n\t\t\tconstant.SystemExpression = '{=Constant:' + id + '}';\n\t\t\tconstant.Expression = '{{~&:' + id + '}}';\n\n\t\t\tconstants.push(constant);\n\t\t});\n\n\t\treturn constants;\n\t}\n\n\tgetConstant(id)\n\t{\n\t\tconst constants = this.getConstants();\n\n\t\tfor (let i = 0; i < constants.length; ++i)\n\t\t{\n\t\t\tif (constants[i].Id === id)\n\t\t\t{\n\t\t\t\treturn constants[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddConstant(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Constant', this.#data.CONSTANTS);\n\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.CONSTANTS[id] = property;\n\n\t\tthis.emit('Template:constant:add');\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantAdd', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tupdateConstant(id, property)\n\t{\n\t\tif (!this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.CONSTANTS[id].Description = property.Description;\n\n\t\tthis.emit('Template:constant:update', {constant: this.getConstant(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantUpdate', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tdeleteConstant(id)\n\t{\n\t\tdelete this.#data.CONSTANTS[id];\n\n\t\treturn true;\n\t}\n\n\tsetConstantValue(id, value)\n\t{\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthis.#data.CONSTANTS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetParameters()\n\t{\n\t\tconst params = [];\n\n\t\tObject.keys(this.#data.PARAMETERS).forEach(id => {\n\t\t\tconst param = BX.clone(this.#data.PARAMETERS[id]);\n\n\t\t\tparam.Id = id;\n\t\t\tparam.ObjectId = 'Template';\n\t\t\tparam.SystemExpression = '{=Template:' + id + '}';\n\t\t\tparam.Expression = '{{~*:' + id + '}}';\n\n\t\t\tparams.push(param);\n\t\t});\n\n\t\treturn params;\n\t}\n\n\tgetParameter(id)\n\t{\n\t\tconst params = this.getParameters();\n\n\t\tfor (let i = 0; i < params.length; ++i)\n\t\t{\n\t\t\tif (params[i].Id === id)\n\t\t\t{\n\t\t\t\treturn params[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddParameter(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Parameter', this.#data.PARAMETERS);\n\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.PARAMETERS[id] = property;\n\n\t\tthis.emit('Template:parameter:add', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterAdd', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tupdateParameter(id, property)\n\t{\n\t\tif (!this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.PARAMETERS[id].Description = property.Description;\n\n\t\tthis.emit('Template:parameter:update', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterUpdate', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tdeleteParameter(id)\n\t{\n\t\tdelete this.#data.PARAMETERS[id];\n\n\t\treturn true;\n\t}\n\n\tsetParameterValue(id, value)\n\t{\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthis.#data.PARAMETERS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetVariables(): []\n\t{\n\t\tconst variables = [];\n\n\t\tObject.keys(this.#data.VARIABLES).forEach(id => {\n\t\t\tconst variable = Runtime.clone(this.#data.VARIABLES[id]);\n\n\t\t\tvariable.Id = id;\n\t\t\tvariable.ObjectId = 'Variable';\n\t\t\tvariable.SystemExpression = '{=Variable:' + id + '}';\n\t\t\tvariable.Expression = '{=Variable:' + id + '}';\n\n\t\t\tvariables.push(variable);\n\t\t});\n\n\t\treturn variables;\n\t}\n\n\tgeneratePropertyId(prefix, existsList)\n\t{\n\t\tlet index;\n\t\tfor(index = 1; index <= 1000; ++index)\n\t\t{\n\t\t\tif (!existsList[prefix + index])\n\t\t\t{\n\t\t\t\tbreak; //found\n\t\t\t}\n\t\t}\n\n\t\treturn prefix + index;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tconst robotUsages = robot.collectUsages();\n\n\t\t\tObject.keys(usages).forEach(key => {\n\t\t\t\trobotUsages[key].forEach(usage => {\n\t\t\t\t\tif (!usages[key].has(usage))\n\t\t\t\t\t{\n\t\t\t\t\t\tusages[key].add(usage);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn usages;\n\t}\n\n\tsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.#robots.forEach(robot => robot.subscribe(eventName, listener))\n\n\t\treturn this;\n\t}\n\n\tunsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void)\n\t{\n\t\tthis.#robots.forEach(robot => robot.unsubscribe(eventName, listener));\n\n\t\treturn this;\n\t}\n\n\tgetRobotDescription(type: string): ?object\n\t{\n\t\treturn this.#context.availableRobots.find(item => item['CLASS'] === type);\n\t}\n\n\tget globalConstants(): []\n\t{\n\t\treturn this.#context.automationGlobals ? this.#context.automationGlobals.globalConstants : [];\n\t}\n\n\tget globalVariables(): []\n\t{\n\t\treturn this.#context.automationGlobals ? this.#context.automationGlobals.globalVariables : [];\n\t}\n}","import { Type } from 'main.core';\nimport { Operator } from 'bizproc.condition';\n\nexport class Condition\n{\n\t#object: string;\n\t#field: string;\n\t#operator: string;\n\t#value: string;\n\n\tparentGroup;\n\n\tconstructor(params: ?Object, group)\n\t{\n\t\tthis.#object = 'Document';\n\t\tthis.#field = '';\n\t\tthis.#operator = '!empty';\n\t\tthis.#value = '';\n\n\t\tthis.parentGroup = null;\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['object'])\n\t\t\t{\n\t\t\t\tthis.setObject(params['object']);\n\t\t\t}\n\t\t\tif (params['field'])\n\t\t\t{\n\t\t\t\tthis.setField(params['field']);\n\t\t\t}\n\t\t\tif (params['operator'])\n\t\t\t{\n\t\t\t\tthis.setOperator(params['operator']);\n\t\t\t}\n\t\t\tif ('value' in params)\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t}\n\t\tif (group)\n\t\t{\n\t\t\tthis.parentGroup = group;\n\t\t}\n\t}\n\n\tclone(): Condition\n\t{\n\t\treturn new Condition(\n\t\t\t{\n\t\t\t\tobject: this.#object,\n\t\t\t\tfield: this.#field,\n\t\t\t\toperator: this.#operator,\n\t\t\t\tvalue: this.#value,\n\t\t\t},\n\t\t\tthis.parentGroup,\n\t\t);\n\t}\n\n\tsetObject(object)\n\t{\n\t\tif (Type.isStringFilled(object))\n\t\t{\n\t\t\tthis.#object = object;\n\t\t}\n\t}\n\n\tget object()\n\t{\n\t\treturn this.#object;\n\t}\n\n\tsetField(field)\n\t{\n\t\tif (Type.isStringFilled(field))\n\t\t{\n\t\t\tthis.#field = field;\n\t\t}\n\t}\n\n\tget field()\n\t{\n\t\treturn this.#field;\n\t}\n\n\tsetOperator(operator)\n\t{\n\t\tif (!operator)\n\t\t{\n\t\t\toperator = Operator.EQUAL;\n\t\t}\n\n\t\tthis.#operator = operator;\n\t}\n\n\tget operator(): string\n\t{\n\t\treturn this.#operator;\n\t}\n\n\tsetValue(value)\n\t{\n\t\tthis.#value = value;\n\t\tif (this.#operator === Operator.EQUAL && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = 'empty';\n\t\t}\n\t\telse if (this.#operator === Operator.NOT_EQUAL && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = '!empty';\n\t\t}\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\tobject: this.#object,\n\t\t\tfield: this.#field,\n\t\t\toperator: this.#operator,\n\t\t\tvalue: this.#value\n\t\t}\n\t}\n}","import { Type, Loc } from 'main.core';\nimport { Condition } from './condition';\nimport { ConditionNames } from './types';\nimport { Operator } from 'bizproc.condition';\n\nexport class ConditionGroup\n{\n\tstatic CONDITION_TYPE = {\n\t\tField: 'field',\n\t\tMixed: 'mixed',\n\t}\n\tstatic JOINER = {\n\t\tAnd: 'AND',\n\t\tOr: 'OR',\n\n\t\tmessage(type)\n\t\t{\n\t\t\tif (type === this.Or)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_OR');\n\t\t\t}\n\n\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_AND');\n\t\t}\n\t}\n\n\t#type: string;\n\t#items: Array<[Condition, string]>;\n\t#activityNames: ?ConditionNames;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tthis.#type = ConditionGroup.CONDITION_TYPE.Field;\n\t\tthis.#items = [];\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.#type = params['type'];\n\t\t\t}\n\t\t\tif (Type.isArray(params['items']))\n\t\t\t{\n\t\t\t\tparams['items'].forEach(item => {\n\t\t\t\t\tconst condition = new Condition(item[0], this);\n\t\t\t\t\tthis.addItem(condition, item[1]);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (Type.isPlainObject(params['activityNames']))\n\t\t\t{\n\t\t\t\tthis.#activityNames = params['activityNames'];\n\t\t\t}\n\t\t}\n\t}\n\n\tclone()\n\t{\n\t\tconst clonedGroup = new ConditionGroup({type: this.#type});\n\t\tthis.#items.forEach(([condition, joiner]) => {\n\t\t\tconst clonedCondition = condition.clone();\n\t\t\tclonedCondition.parentGroup = clonedGroup;\n\n\t\t\tclonedGroup.addItem(clonedCondition, joiner);\n\t\t});\n\n\t\treturn clonedGroup;\n\t}\n\n\tget conditionNamesList(): Array<string>\n\t{\n\t\tif (Type.isPlainObject(this.#activityNames))\n\t\t{\n\t\t\treturn [\n\t\t\t\tthis.#activityNames.Activity,\n\t\t\t\tthis.#activityNames.Branch1,\n\t\t\t\tthis.#activityNames.Branch2,\n\t\t\t];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tset type(type: string)\n\t{\n\t\tif (Object.values(ConditionGroup.CONDITION_TYPE).includes(type))\n\t\t{\n\t\t\tthis.#type = type;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget items()\n\t{\n\t\treturn this.#items;\n\t}\n\n\tstatic createFromForm(formFields, prefix)\n\t{\n\t\tconst conditionGroup = new ConditionGroup();\n\t\tif (!prefix)\n\t\t{\n\t\t\tprefix = 'condition_';\n\t\t}\n\n\t\tif (Type.isArray(formFields[prefix + 'field']))\n\t\t{\n\t\t\tfor (let i = 0, valueIndex = 0; i < formFields[prefix + 'field'].length; ++i, ++valueIndex)\n\t\t\t{\n\t\t\t\tif (formFields[prefix + 'field'][i] === '')\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst condition = new Condition({}, conditionGroup);\n\t\t\t\tcondition.setObject(formFields[prefix + 'object'][i]);\n\t\t\t\tcondition.setField(formFields[prefix + 'field'][i]);\n\t\t\t\tcondition.setOperator(formFields[prefix + 'operator'][i]);\n\n\t\t\t\tconst value =\n\t\t\t\t\tcondition.operator === Operator.BETWEEN\n\t\t\t\t\t\t? [formFields[prefix + 'value'][valueIndex], formFields[prefix + 'value'][valueIndex + 1]]\n\t\t\t\t\t\t: formFields[prefix + 'value'][valueIndex]\n\t\t\t\t;\n\t\t\t\tcondition.setValue(value);\n\n\t\t\t\tlet joiner = ConditionGroup.JOINER.And;\n\t\t\t\tif (formFields[prefix + 'joiner'] && formFields[prefix + 'joiner'][i] === ConditionGroup.JOINER.Or)\n\t\t\t\t{\n\t\t\t\t\tjoiner = ConditionGroup.JOINER.Or;\n\t\t\t\t}\n\n\t\t\t\tif (condition.operator === Operator.BETWEEN)\n\t\t\t\t{\n\t\t\t\t\tvalueIndex++;\n\t\t\t\t}\n\n\t\t\t\tconditionGroup.addItem(condition, joiner);\n\t\t\t}\n\t\t}\n\n\t\treturn conditionGroup;\n\t}\n\n\taddItem(condition, joiner)\n\t{\n\t\tthis.#items.push([condition, joiner]);\n\t}\n\n\tgetItems(): Array<Array<Condition, string>>\n\t{\n\t\treturn this.#items;\n\t}\n\n\tserialize()\n\t{\n\t\tconst itemsArray = [];\n\n\t\tthis.#items.forEach(item => {\n\t\t\tif (item.field !== '')\n\t\t\t{\n\t\t\t\titemsArray.push([item[0].serialize(), item[1]]);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\titems: itemsArray,\n\t\t\tactivityNames: this.#activityNames,\n\t\t};\n\t}\n}","import {\n\tCondition,\n\tConditionGroup,\n\tDesigner,\n\tgetGlobalContext,\n\tInlineSelectorCondition,\n\tSelectorContext,\n\tSelectorManager,\n} from 'bizproc.automation';\nimport { Dom, Type, Event, Loc, Runtime, Tag, Text } from 'main.core';\n\nimport type { ConditionSelectorOptions } from './types';\nimport { BaseEvent } from 'main.core.events';\nimport { Operator } from 'bizproc.condition';\n\nexport class ConditionSelector\n{\n\t#condition: ?Condition;\n\t#fields: Array<Object>;\n\t#joiner: string;\n\t#fieldPrefix: string;\n\t#rootGroupTitle: ?string;\n\t#onOpenFieldMenu: ?(BaseEvent) => void;\n\t#onOpenMenu: ?(BaseEvent) => void;\n\t#showValuesSelector: boolean;\n\n\tnode: ?HTMLElement;\n\tobjectNode: ?HTMLElement;\n\tfieldNode: ?HTMLElement;\n\tjoinerNode: ?HTMLElement;\n\tlabelNode: ?HTMLElement;\n\tvalueNode: ?HTMLElement;\n\t#valueNode2: ?HTMLElement = null;\n\n\tpopup: BX.PopupWindow;\n\tfieldDialog: ?InlineSelectorCondition;\n\t#selectedField;\n\n\tconstructor(condition, options: ?ConditionSelectorOptions)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.#fields = [];\n\t\tthis.#joiner = ConditionGroup.JOINER.And;\n\t\tthis.#fieldPrefix = 'condition_';\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields.map(field => {\n\t\t\t\t\tfield.ObjectId = 'Document';\n\n\t\t\t\t\treturn field;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (options.joiner && options.joiner === ConditionGroup.JOINER.Or)\n\t\t\t{\n\t\t\t\tthis.#joiner = ConditionGroup.JOINER.Or;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\n\t\t\tthis.#rootGroupTitle = options.rootGroupTitle;\n\t\t\tthis.#onOpenFieldMenu = options.onOpenFieldMenu;\n\t\t\tthis.#onOpenMenu = options.onOpenMenu;\n\t\t\tthis.#showValuesSelector = options.showValuesSelector ?? true;\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst conditionObjectNode = this.objectNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"object[]\",\n\t\t\t\tvalue: this.#condition.object\n\t\t\t}\n\t\t});\n\t\tconst conditionFieldNode = this.fieldNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"field[]\",\n\t\t\t\tvalue: this.#condition.field\n\t\t\t}\n\t\t});\n\t\tconst conditionOperatorNode = this.operatorNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"operator[]\",\n\t\t\t\tvalue: this.#condition.operator\n\t\t\t}\n\t\t});\n\n\t\tconst value = Type.isArrayFilled(this.#condition.value) ? this.#condition.value[0] : this.#condition.value;\n\t\tthis.valueNode = this.#createValueNode(value)\n\t\tconst conditionValueNode = this.valueNode;\n\n\t\tlet conditionValueNode2;\n\t\tif (this.#condition.operator === Operator.BETWEEN)\n\t\t{\n\t\t\tconst value2 =\n\t\t\t\t(Type.isArrayFilled(this.#condition.value) && this.#condition.value.length > 1)\n\t\t\t\t\t? this.#condition.value[1]\n\t\t\t\t\t: ''\n\t\t\t;\n\n\t\t\tthis.#valueNode2 = this.#createValueNode(value2);\n\t\t\tconditionValueNode2 = this.#valueNode2;\n\t\t}\n\n\t\tconst conditionJoinerNode = this.joinerNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"joiner[]\",\n\t\t\t\tvalue: this.#joiner\n\t\t\t}\n\t\t});\n\n\t\tconst labelNode = this.labelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-wrapper\"\n\t\t\t}\n\t\t});\n\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\n\t\tconst removeButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-remove\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: this.removeCondition.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst joinerButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-condition-joiner\"\n\t\t\t},\n\t\t\ttext: ConditionGroup.JOINER.message(this.#joiner),\n\t\t});\n\n\t\tEvent.bind(joinerButtonNode, 'click', this.changeJoiner.bind(this, joinerButtonNode));\n\n\t\tthis.node = Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper bizproc-automation-condition-wrapper\" },\n\t\t\tchildren: [\n\t\t\t\tconditionObjectNode,\n\t\t\t\tconditionFieldNode,\n\t\t\t\tconditionOperatorNode,\n\t\t\t\tconditionValueNode,\n\t\t\t\tconditionValueNode2,\n\t\t\t\tconditionJoinerNode,\n\t\t\t\tlabelNode,\n\t\t\t\tremoveButtonNode,\n\t\t\t\tjoinerButtonNode\n\t\t\t]\n\t\t});\n\n\t\treturn this.node;\n\t}\n\n\t#createValueNode(value: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"${Text.encode(this.#fieldPrefix + 'value[]')}\"\n\t\t\t\tvalue=\"${Text.encode(value)}\"\n\t\t\t>\n\t\t`;\n\t}\n\n\tinit(condition: Condition)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (!this.labelNode || !this.#condition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.labelNode);\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\tconst field = this.getField(this.#condition.object, this.#condition.field) || '?';\n\t\t\tconst valueLabel = this.#getValueLabel(field);\n\n\t\t\tDom.append(\n\t\t\t\tTag.render`<span class=\"bizproc-automation-popup-settings-link\">${Text.encode(field.Name)}</span>`,\n\t\t\t\tthis.labelNode\n\t\t\t);\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"bizproc-automation-popup-settings-link\">\n\t\t\t\t\t\t${Text.encode(this.getOperatorLabel(this.#condition.operator))}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tthis.labelNode\n\t\t\t);\n\n\t\t\tif (valueLabel)\n\t\t\t{\n\t\t\t\tDom.append(\n\t\t\t\t\tTag.render`<span class=\"bizproc-automation-popup-settings-link\">${Text.encode(valueLabel)}</span>`,\n\t\t\t\t\tthis.labelNode\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"bizproc-automation-popup-settings-link\">\n\t\t\t\t\t\t${Text.encode(this.getOperatorLabel(Operator.EMPTY))}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tthis.labelNode\n\t\t\t);\n\t\t}\n\t}\n\n\t#getValueLabel(field): ?string\n\t{\n\t\tconst operator = this.#condition.operator;\n\t\tconst value = this.#condition.value;\n\n\t\tif (operator === 'between')\n\t\t{\n\t\t\treturn (\n\t\t\t\tLoc.getMessage(\n\t\t\t\t'BIZPROC_AUTOMATION_ROBOT_CONDITION_BETWEEN_VALUE',\n\t\t\t\t\t{\n\t\t\t\t\t\t'#VALUE_1#': BX.Bizproc.FieldType.formatValuePrintable(\n\t\t\t\t\t\t\tfield,\n\t\t\t\t\t\t\tType.isArrayFilled(value) ? value[0] : value\n\t\t\t\t\t\t),\n\t\t\t\t\t\t'#VALUE_2#': BX.Bizproc.FieldType.formatValuePrintable(\n\t\t\t\t\t\t\tfield,\n\t\t\t\t\t\t\tType.isArrayFilled(value) ? value[1] : ''\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t?? ''\n\t\t\t);\n\t\t}\n\t\telse if(operator.indexOf('empty') < 0)\n\t\t{\n\t\t\treturn BX.Bizproc.FieldType.formatValuePrintable(field, value);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', this.onLabelClick.bind(this));\n\t\t}\n\t}\n\n\tonLabelClick()\n\t{\n\t\tthis.showPopup();\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.show();\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = this.filterFields();\n\n\t\tconst objectSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelectLabel = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown',\n\t\t\t\treadonly: 'readonly'\n\t\t\t},\n\t\t\tchildren: [fieldSelect]\n\t\t});\n\n\t\tEvent.bind(\n\t\t\tfieldSelectLabel,\n\t\t\t'click',\n\t\t\tthis.onFieldSelectorClick.bind(this, fieldSelectLabel, fieldSelect, fields, objectSelect)\n\t\t);\n\n\t\tlet selectedField = this.getField(this.#condition.object, this.#condition.field);\n\t\tif (!this.#condition.field)\n\t\t{\n\t\t\tselectedField = fields[0];\n\t\t}\n\n\t\tthis.#selectedField = selectedField;\n\n\t\tfieldSelect.value = selectedField.Id;\n\t\tobjectSelect.value = selectedField.ObjectId;\n\t\tfieldSelectLabel.textContent = selectedField.Name;\n\n\t\tconst valueInput = this.#getValueNode(selectedField, this.#condition.value, this.#condition.operator);\n\n\t\tconst valueWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [valueInput]\n\t\t});\n\n\t\tconst operatorSelect = this.createOperatorNode(selectedField, valueWrapper);\n\t\tconst operatorWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [operatorSelect]\n\t\t});\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\toperatorSelect.value = this.#condition.operator;\n\t\t}\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [fieldSelectLabel]\n\t\t\t\t}),\n\t\t\t\toperatorWrapper,\n\t\t\t\tvalueWrapper\n\t\t\t]\n\t\t});\n\n\t\tEvent.bind(fieldSelect, 'change', this.onFieldChange.bind(\n\t\t\tthis,\n\t\t\tfieldSelect,\n\t\t\toperatorWrapper,\n\t\t\tvalueWrapper,\n\t\t\tobjectSelect\n\t\t));\n\n\t\tconst self = this;\n\t\tthis.popup = new BX.PopupWindow('bizproc-automation-popup-set', this.labelNode, {\n\t\t\tclassName: 'bizproc-automation-popup-set',\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 45,\n\t\t\toverlay: { backgroundColor: 'transparent' },\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: \"webform-button webform-button-create\" ,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.#condition.setObject(objectSelect.value);\n\t\t\t\t\t\t\tself.#condition.setField(fieldSelect.value);\n\t\t\t\t\t\t\tself.#condition.setOperator(operatorWrapper.firstChild.value);\n\n\t\t\t\t\t\t\tconst valueInputs = valueWrapper.querySelectorAll('[name^=\"' + self.#fieldPrefix + 'value\"]');\n\n\t\t\t\t\t\t\tif (valueInputs.length > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet value = valueInputs[valueInputs.length - 1].value;\n\n\t\t\t\t\t\t\t\tif (self.#condition.operator === Operator.BETWEEN && valueInputs.length > 1)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvalue = [valueInputs[0].value, valueInputs[1].value];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tself.#condition.setValue(value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#condition.setValue('');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.setLabelText();\n\n\t\t\t\t\t\t\tconst field = self.getField(self.#condition.object, self.#condition.field);\n\t\t\t\t\t\t\tif (field && field.Type === 'UF:address')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst input = valueWrapper.querySelector('[name=\"' + self.#fieldPrefix + 'value\"]');\n\t\t\t\t\t\t\t\tself.#condition.setValue(input ? input.value : '');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.updateValueNode();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t\tif (self.fieldDialog)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldDialog.destroy();\n\t\t\t\t\t\tdelete(self.fieldDialog);\n\t\t\t\t\t}\n\t\t\t\t\tdelete(self.popup);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.popup.show();\n\t}\n\n\tonFieldSelectorClick(fieldSelectLabel, fieldSelect, fields, objectSelect, event)\n\t{\n\t\tif (!this.fieldDialog)\n\t\t{\n\t\t\tconst globalContext = getGlobalContext();\n\t\t\tconst fields = Runtime.clone(\n\t\t\t\tType.isArrayFilled(this.#fields) ? this.#fields : globalContext.document.getFields()\n\t\t\t);\n\n\t\t\tthis.fieldDialog = new InlineSelectorCondition({\n\t\t\t\tcontext: new SelectorContext({\n\t\t\t\t\tfields,\n\t\t\t\t\trootGroupTitle: globalContext.document.title,\n\t\t\t\t}),\n\t\t\t\tcondition: this.#condition,\n\t\t\t});\n\n\t\t\tif (Type.isFunction(this.#onOpenFieldMenu))\n\t\t\t{\n\t\t\t\tthis.fieldDialog.subscribe('onOpenMenu', this.#onOpenFieldMenu);\n\t\t\t}\n\n\t\t\tthis.fieldDialog.subscribe('change', (event) => {\n\t\t\t\tconst property = event.getData().field;\n\t\t\t\tfieldSelectLabel.textContent = property.Name\n\t\t\t\tfieldSelect.value = property.Id;\n\t\t\t\tobjectSelect.value = property.ObjectId;\n\t\t\t\tBX.fireEvent(fieldSelect, 'change');\n\t\t\t});\n\n\t\t\tthis.fieldDialog.renderTo(fieldSelectLabel);\n\t\t}\n\n\t\tthis.fieldDialog.openMenu(event);\n\t}\n\n\tupdateValueNode()\n\t{\n\t\tif (this.#condition)\n\t\t{\n\t\t\tif (this.objectNode)\n\t\t\t{\n\t\t\t\tthis.objectNode.value = this.#condition.object;\n\t\t\t}\n\t\t\tif (this.fieldNode)\n\t\t\t{\n\t\t\t\tthis.fieldNode.value = this.#condition.field;\n\t\t\t}\n\t\t\tif (this.operatorNode)\n\t\t\t{\n\t\t\t\tthis.operatorNode.value = this.#condition.operator;\n\t\t\t}\n\t\t\tif (this.valueNode)\n\t\t\t{\n\t\t\t\tthis.valueNode.value = Type.isArrayFilled(this.#condition.value) ? this.#condition.value[0] : this.#condition.value;\n\t\t\t}\n\n\t\t\tif (this.#condition.operator === Operator.BETWEEN)\n\t\t\t{\n\t\t\t\tconst value2 = this.#condition.value[1] || '';\n\t\t\t\tif (this.#valueNode2)\n\t\t\t\t{\n\t\t\t\t\tthis.#valueNode2.value = value2;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#valueNode2 = this.#createValueNode(value2);\n\t\t\t\t\tDom.append(this.#valueNode2, this.node);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (Type.isDomNode(this.#valueNode2))\n\t\t\t{\n\t\t\t\tDom.remove(this.#valueNode2);\n\t\t\t\tthis.#valueNode2 = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tonFieldChange(selectNode: Node, conditionWrapper: Node, valueWrapper: Node, objectSelect)\n\t{\n\t\tconst field = this.getField(objectSelect.value, selectNode.value);\n\t\tconst operatorNode = this.createOperatorNode(field, valueWrapper);\n\n\t\t//clean value if field types are different\n\t\tif (field.Type !== this.#selectedField?.Type)\n\t\t{\n\t\t\tDom.clean(valueWrapper);\n\t\t}\n\t\tthis.#selectedField = field;\n\n\t\t//keep selected operator if possible\n\t\tif (this.getOperators(field['Type'], field['Multiple'])[conditionWrapper.firstChild.value])\n\t\t{\n\t\t\toperatorNode.value = conditionWrapper.firstChild.value;\n\t\t}\n\n\t\tconditionWrapper.replaceChild(operatorNode, conditionWrapper.firstChild);\n\t\tthis.onOperatorChange(operatorNode, field, valueWrapper);\n\t}\n\n\tonOperatorChange(selectNode: Node, field: Object, valueWrapper: HTMLElement)\n\t{\n\t\tconst valueInput = valueWrapper.querySelector('[name^=\"' + this.#fieldPrefix + 'value\"]');\n\t\tDom.clean(valueWrapper);\n\n\t\tDom.append(\n\t\t\tthis.#getValueNode(field, valueInput?.value || this.#condition.value, selectNode.value),\n\t\t\tvalueWrapper\n\t\t);\n\t}\n\n\t#getValueNode(field: {}, value, operator: string): any\n\t{\n\t\tif (operator === Operator.BETWEEN)\n\t\t{\n\t\t\tconst valueNode1 = this.createValueNode(field, Type.isArrayFilled(value) ? value[0] : value);\n\t\t\tconst valueNode2 = this.createValueNode(field, Type.isArrayFilled(value) ? value[1] : '');\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t${valueNode1}\n\t\t\t\t\t<div>${ConditionGroup.JOINER.message('AND')}</div>\n\t\t\t\t\t${valueNode2}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse if (operator.indexOf('empty') < 0)\n\t\t{\n\t\t\treturn this.createValueNode(field, value);\n\t\t}\n\n\t\treturn '';\n\t}\n\n\t// TODO - fix this method\n\tgetField(object, id)\n\t{\n\t\tlet field;\n\t\tconst robot = Designer.getInstance().robot;\n\t\tconst component = Designer.getInstance().component;\n\t\tconst tpl = robot? robot.getTemplate() : null;\n\n\t\tswitch (object)\n\t\t{\n\t\t\tcase 'Document':\n\t\t\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (id === this.#fields[i].Id)\n\t\t\t\t\t{\n\t\t\t\t\t\tfield = this.#fields[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Template':\n\t\t\t\tif (tpl && component && component.triggerManager)\n\t\t\t\t{\n\t\t\t\t\tfield = component.triggerManager.getReturnProperty(tpl.getStatusId(), id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Constant':\n\t\t\t\tif (tpl)\n\t\t\t\t{\n\t\t\t\t\tfield = tpl.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalConst':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalVar':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getGVariable(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tvar foundRobot = tpl? tpl.getRobotById(object) : null;\n\t\t\t\tif (foundRobot)\n\t\t\t\t{\n\t\t\t\t\tfield = foundRobot.getReturnProperty(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn field || {\n\t\t\tId: id,\n\t\t\tObjectId: object,\n\t\t\tName: id,\n\t\t\tType: 'string',\n\t\t\tExpression: id,\n\t\t\tSystemExpression: '{='+object+':'+id+'}'\n\t\t};\n\t}\n\n\tgetOperators(fieldType, multiple): {}\n\t{\n\t\tconst allLabels = Operator.getAllLabels();\n\n\t\tlet list = {\n\t\t\t'!empty': allLabels[Operator.NOT_EMPTY],\n\t\t\t'empty': allLabels[Operator.EMPTY],\n\t\t\t'=': allLabels[Operator.EQUAL],\n\t\t\t'!=': allLabels[Operator.NOT_EQUAL],\n\t\t};\n\t\tswitch (fieldType)\n\t\t{\n\t\t\tcase 'file':\n\t\t\tcase 'UF:crm':\n\t\t\tcase 'UF:resourcebooking':\n\t\t\tcase 'email':\n\t\t\tcase 'phone':\n\t\t\tcase 'web':\n\t\t\tcase 'im':\n\t\t\t\tlist = {\n\t\t\t\t\t'!empty': allLabels[Operator.NOT_EMPTY],\n\t\t\t\t\t'empty': allLabels[Operator.EMPTY],\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'bool':\n\t\t\tcase 'select':\n\t\t\t\tif (multiple)\n\t\t\t\t{\n\t\t\t\t\tlist[Operator.CONTAIN] = allLabels[Operator.CONTAIN];\n\t\t\t\t\tlist[Operator.NOT_CONTAIN] = allLabels[Operator.NOT_CONTAIN];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//TODO: render multiple select in value selector\n\t\t\t\t\t//list['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'user':\n\t\t\t\tlist[Operator.IN] = allLabels[Operator.IN];\n\t\t\t\tlist[Operator.NOT_IN] = allLabels[Operator.NOT_IN];\n\t\t\t\tlist[Operator.CONTAIN] = allLabels[Operator.CONTAIN];\n\t\t\t\tlist[Operator.NOT_CONTAIN] = allLabels[Operator.NOT_CONTAIN];\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlist[Operator.IN] = allLabels[Operator.IN];\n\t\t\t\tlist[Operator.NOT_IN] = allLabels[Operator.NOT_IN];\n\t\t\t\tlist[Operator.CONTAIN] = allLabels[Operator.CONTAIN];\n\t\t\t\tlist[Operator.NOT_CONTAIN] = allLabels[Operator.NOT_CONTAIN];\n\t\t\t\tlist[Operator.GREATER_THEN] = allLabels[Operator.GREATER_THEN];\n\t\t\t\tlist[Operator.GREATER_THEN_OR_EQUAL] = allLabels[Operator.GREATER_THEN_OR_EQUAL];\n\t\t\t\tlist[Operator.LESS_THEN] = allLabels[Operator.LESS_THEN];\n\t\t\t\tlist[Operator.LESS_THEN_OR_EQUAL] = allLabels[Operator.LESS_THEN_OR_EQUAL];\n\t\t}\n\n\t\t// todo: interface\n\t\t// if (['time', 'date', 'datetime', 'int', 'double'].includes(fieldType) || Type.isUndefined(fieldType))\n\t\t// {\n\t\t// \tlist[Operator.BETWEEN] = allLabels[Operator.BETWEEN];\n\t\t// }\n\n\t\treturn list;\n\t}\n\n\tgetOperatorLabel(id): string\n\t{\n\t\treturn Operator.getOperatorLabel(id);\n\t}\n\n\tfilterFields()\n\t{\n\t\tconst filtered = [];\n\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t{\n\t\t\tconst type = this.#fields[i]['Type'];\n\n\t\t\tif (\n\t\t\t\ttype === 'bool'\n\t\t\t\t|| type === 'date'\n\t\t\t\t|| type === 'datetime'\n\t\t\t\t|| type === 'double'\n\t\t\t\t|| type === 'file'\n\t\t\t\t|| type === 'int'\n\t\t\t\t|| type === 'select'\n\t\t\t\t|| type === 'string'\n\t\t\t\t|| type === 'text'\n\t\t\t\t|| type === 'user'\n\t\t\t\t|| type === 'UF:money'\n\t\t\t\t|| type === 'UF:crm'\n\t\t\t\t|| type === 'UF:resourcebooking'\n\t\t\t\t|| type === 'UF:url'\n\t\t\t)\n\t\t\t{\n\t\t\t\tfiltered.push(this.#fields[i]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//TODO add support of custom types\n\t\t\t}\n\t\t}\n\n\t\treturn filtered;\n\t}\n\n\tcreateValueNode(docField, value)\n\t{\n\t\tconst currentDocument = (\n\t\t\tDesigner.getInstance().component\n\t\t\t\t? Designer.getInstance().component.document\n\t\t\t\t: getGlobalContext().document\n\t\t);\n\n\t\tconst docType = [...currentDocument.getRawType(), currentDocument.getCategoryId()];\n\n\t\tconst field = Runtime.clone(docField);\n\t\tfield.Multiple = false;\n\n\t\tconst valueNodes = BX.Bizproc.FieldType.renderControlPublic(\n\t\t\tdocType,\n\t\t\tfield,\n\t\t\tthis.#fieldPrefix + 'value',\n\t\t\tvalue,\n\t\t\tfalse\n\t\t);\n\n\t\tvalueNodes.querySelectorAll('[data-role]').forEach((node) => {\n\t\t\tconst selector = SelectorManager.createSelectorByRole(node.dataset.role, {\n\t\t\t\tcontext: new SelectorContext({\n\t\t\t\t\tfields: getGlobalContext().document.getFields(),\n\t\t\t\t\tuseSwitcherMenu: false,\n\t\t\t\t\trootGroupTitle: this.#rootGroupTitle ?? getGlobalContext().document.title,\n\t\t\t\t}),\n\t\t\t});\n\n\t\t\tif (selector)\n\t\t\t{\n\t\t\t\tif (this.#showValuesSelector === true)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isFunction(this.#onOpenMenu))\n\t\t\t\t\t{\n\t\t\t\t\t\tselector.subscribe('onOpenMenu', this.#onOpenMenu);\n\t\t\t\t\t}\n\t\t\t\t\tselector.renderTo(node);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselector.targetInput = node;\n\t\t\t\t\tselector.parseTargetProperties();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn valueNodes;\n\t}\n\n\tcreateOperatorNode(field, valueWrapper)\n\t{\n\t\tconst select = Dom.create('select', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'}\n\t\t});\n\n\t\tconst operatorList = this.getOperators(field['Type'], field['Multiple']);\n\t\tfor (var operatorId in operatorList)\n\t\t{\n\t\t\tif (!operatorList.hasOwnProperty(operatorId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\tprops: {value: operatorId},\n\t\t\t\ttext: operatorList[operatorId]\n\t\t\t}));\n\t\t}\n\n\t\tEvent.bind(select, 'change', this.onOperatorChange.bind(\n\t\t\tthis,\n\t\t\tselect,\n\t\t\tfield,\n\t\t\tvalueWrapper\n\t\t));\n\n\t\treturn select;\n\t}\n\n\tremoveCondition(event: Event)\n\t{\n\t\tthis.#condition = null;\n\t\tDom.remove(this.node);\n\n\t\tthis.labelNode = null;\n\t\tthis.fieldNode = null;\n\t\tthis.operatorNode = null;\n\t\tthis.valueNode = null;\n\t\tthis.#valueNode2 = null;\n\t\tthis.node = null;\n\n\t\tevent.stopPropagation();\n\t}\n\n\tchangeJoiner(btn: Element, event: Event)\n\t{\n\t\tthis.#joiner = (this.#joiner === ConditionGroup.JOINER.Or ? ConditionGroup.JOINER.And : ConditionGroup.JOINER.Or);\n\t\tbtn.textContent = ConditionGroup.JOINER.message(this.#joiner);\n\n\t\tif (this.joinerNode)\n\t\t{\n\t\t\tthis.joinerNode.value = this.#joiner;\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n}","import { Type, Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport { ConditionGroup } from 'bizproc.automation';\nimport { ConditionSelector } from './condition-selector';\nimport { Condition } from 'bizproc.automation';\n\nexport class ConditionGroupSelector\n{\n\t#conditionGroup: ConditionGroup;\n\t#fields: Array<Object>;\n\t#fieldPrefix: string;\n\t#itemSelectors: Array<ConditionSelector>;\n\t#onOpenFieldMenu: ?(BaseEvent) => void;\n\t#onOpenMenu: ?(BaseEvent) => void;\n\t#showValuesSelector: boolean;\n\t#rootGroupTitle: ?string;\n\n\tconstructor(conditionGroup: ConditionGroup, options: Object)\n\t{\n\t\tthis.#conditionGroup = conditionGroup;\n\t\tthis.#fields = [];\n\t\tthis.#fieldPrefix = 'condition_';\n\t\tthis.#itemSelectors = [];\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\n\t\t\tthis.#rootGroupTitle = options.rootGroupTitle\n\t\t\tthis.#onOpenFieldMenu = options.onOpenFieldMenu;\n\t\t\tthis.#onOpenMenu = options.onOpenMenu;\n\t\t\tthis.#showValuesSelector = options.showValuesSelector ?? true;\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst conditionNodes = [];\n\n\t\tthis.#conditionGroup.getItems().forEach((item) => {\n\t\t\tconst conditionSelector = new ConditionSelector(item[0], {\n\t\t\t\tfields: this.#fields,\n\t\t\t\tjoiner: item[1],\n\t\t\t\tfieldPrefix: this.#fieldPrefix,\n\t\t\t\trootGroupTitle: this.#rootGroupTitle,\n\t\t\t\tonOpenFieldMenu: this.#onOpenFieldMenu,\n\t\t\t\tonOpenMenu: this.#onOpenMenu,\n\t\t\t\tshowValuesSelector: this.#showValuesSelector,\n\t\t\t});\n\n\t\t\tthis.#itemSelectors.push(conditionSelector);\n\t\t\tconditionNodes.push(conditionSelector.createNode());\n\t\t});\n\n\t\tconst self = this;\n\t\tconditionNodes.push(Dom.create(\"a\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link\" },\n\t\t\ttext: '[+]',\n\t\t\tevents: {\n\t\t\t\tclick()\n\t\t\t\t{\n\t\t\t\t\tself.addItem(this);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\treturn Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper\" },\n\t\t\tchildren: conditionNodes\n\t\t});\n\t}\n\n\taddItem(buttonNode)\n\t{\n\t\tconst conditionSelector = new ConditionSelector(new Condition({}, this.#conditionGroup), {\n\t\t\tfields: this.#fields,\n\t\t\tfieldPrefix: this.#fieldPrefix,\n\t\t\trootGroupTitle: this.#rootGroupTitle,\n\t\t\tonOpenFieldMenu: this.#onOpenFieldMenu,\n\t\t\tonOpenMenu: this.#onOpenMenu,\n\t\t\tshowValuesSelector: this.#showValuesSelector,\n\t\t});\n\t\tthis.#itemSelectors.push(conditionSelector);\n\n\t\tbuttonNode.parentNode.insertBefore(conditionSelector.createNode(), buttonNode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#itemSelectors.forEach(selector => selector.destroy());\n\t\tthis.#itemSelectors = [];\n\t}\n}","import {\n\tDesigner,\n\tFileSelector,\n\tInlineSelector,\n\tInlineSelectorHtml,\n\tSaveStateCheckbox,\n\tTimeSelector,\n\tUserSelector,\n} from 'bizproc.automation';\nimport {Type} from \"main.core\";\n\nexport class Manager\n{\n\tstatic SELECTOR_ROLE_USER = 'user-selector';\n\tstatic SELECTOR_ROLE_FILE = 'file-selector';\n\tstatic SELECTOR_ROLE_INLINE = 'inline-selector-target';\n\tstatic SELECTOR_ROLE_INLINE_HTML = 'inline-selector-html';\n\tstatic SELECTOR_ROLE_TIME = 'time-selector';\n\tstatic SELECTOR_ROLE_SAVE_STATE = 'save-state-checkbox';\n\n\tstatic getSelectorByTarget(targetInput: HTMLElement): ?InlineSelector\n\t{\n\t\t// TODO - save created selectors with Manager\n\t\tconst template = Designer.getInstance().getRobotSettingsDialog()?.template;\n\n\t\tif (template && Type.isArray(template.robotSettingsControls))\n\t\t{\n\t\t\treturn template.robotSettingsControls.find(selector => selector.targetInput === targetInput);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tstatic createSelectorByRole(role: string, selectorProps: object): InlineSelector | SaveStateCheckbox\n\t{\n\t\tif (role === this.SELECTOR_ROLE_USER)\n\t\t{\n\t\t\treturn new UserSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_FILE)\n\t\t{\n\t\t\treturn new FileSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_INLINE)\n\t\t{\n\t\t\treturn new InlineSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_INLINE_HTML)\n\t\t{\n\t\t\treturn new InlineSelectorHtml(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_TIME)\n\t\t{\n\t\t\treturn new TimeSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_SAVE_STATE)\n\t\t{\n\t\t\treturn new SaveStateCheckbox(selectorProps);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn undefined;\n\t\t}\n\t}\n}","import {Type, Event, Loc, Text} from 'main.core';\nimport {DateTimeFormat} from 'main.date';\nimport { Menu } from 'main.popup';\n\nexport class InlineTimeSelector\n{\n\t#labelNode: HTMLInputElement = null;\n\n\t#time: string = '';\n\n\t#timeValues: [] = [];\n\t#timeFormat: string;\n\n\t#selector: Menu;\n\n\tconstructor(options: {\n\t\tlabelNode: HTMLInputElement,\n\t})\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isElementNode(options.labelNode))\n\t\t\t{\n\t\t\t\tthis.#labelNode = options.labelNode;\n\t\t\t}\n\t\t}\n\n\t\tthis.#fillTimeFormat();\n\t\tthis.#fillTimeValues();\n\t}\n\n\t#fillTimeFormat()\n\t{\n\t\tconst getFormat = (formatId) => (\n\t\t\tBX.Main.Date.convertBitrixFormat(Loc.getMessage(formatId)).replace(/:?\\s*s/, '')\n\t\t);\n\n\t\tconst dateFormat = getFormat('FORMAT_DATE');\n\t\tconst dateTimeFormat = getFormat('FORMAT_DATETIME');\n\t\tthis.#timeFormat = dateTimeFormat.replace(dateFormat, '').trim();\n\t}\n\n\t#fillTimeValues()\n\t{\n\t\tconst self = this;\n\t\tconst onclick = function(event, item)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tself.#labelNode.value = Text.encode(item.text);\n\t\t\tthis.close();\n\t\t};\n\n\t\tfor (let hour = 0; hour < 24; hour++)\n\t\t{\n\t\t\tthis.#timeValues.push({\n\t\t\t\tid: hour * 60,\n\t\t\t\ttext: this.#formatTime(hour, 0),\n\t\t\t\tonclick: onclick\n\t\t\t});\n\t\t\tthis.#timeValues.push({\n\t\t\t\tid: hour * 60 + 30,\n\t\t\t\ttext: this.#formatTime(hour, 30),\n\t\t\t\tonclick: onclick\n\t\t\t});\n\t\t}\n\t}\n\n\t#formatTime(hour, minute): string\n\t{\n\t\tconst date = new Date();\n\t\tdate.setHours(hour, minute);\n\n\t\treturn DateTimeFormat.format(this.#timeFormat, date.getTime() / 1000);\n\t}\n\n\tinit(time: string)\n\t{\n\t\tif (Type.isStringFilled(time))\n\t\t{\n\t\t\tthis.#time = time;\n\t\t}\n\n\t\tthis.#setLabelText();\n\t\tthis.#bindLabelNode();\n\t}\n\n\t#setLabelText()\n\t{\n\t\tif (Type.isElementNode(this.#labelNode))\n\t\t{\n\t\t\tthis.#labelNode.textContent = this.#time;\n\t\t}\n\t}\n\n\t#bindLabelNode()\n\t{\n\t\tif (Type.isElementNode(this.#labelNode))\n\t\t{\n\t\t\tEvent.bind(this.#labelNode, 'click', this.#onLabelClick.bind(this));\n\t\t}\n\t}\n\n\t#onLabelClick(event)\n\t{\n\t\tthis.#showTimeSelector();\n\t\tevent.preventDefault();\n\t}\n\n\t#showTimeSelector()\n\t{\n\t\tif (Type.isNil(this.#selector))\n\t\t{\n\t\t\tthis.#selector = new Menu({\n\t\t\t\tautoHide: true,\n\t\t\t\tbindElement: this.#labelNode,\n\t\t\t\titems: this.#timeValues,\n\t\t\t\tmaxHeight: 230,\n\t\t\t})\n\t\t}\n\n\t\tthis.#selector.show();\n\t}\n}","import { SelectorContext, DelayIntervalSelector, Helper, DelayInterval } from 'bizproc.automation';\nimport { Dom, Event, Type, Loc, Tag, Runtime } from \"main.core\";\nimport { EventEmitter } from \"main.core.events\";\n\nimport { Field, MenuGroupItem }  from \"./types\";\nimport { MenuManager, Menu } from 'main.popup';\nimport { Dialog } from 'ui.entity-selector';\nimport {InlineTimeSelector} from \"./inline-time-selector\";\n\nexport class InlineSelector extends EventEmitter\n{\n\tcontext: SelectorContext;\n\tfieldProperty: ?Field = null;\n\treplaceOnWrite: boolean = false;\n\tmenuButton: ?HTMLSpanElement = null;\n\ttargetInput: ?HTMLElement = null;\n\t#menuGroups: Object<string, MenuGroupItem> = {};\n\tbasisFields: Array<Object> = [];\n\t#dialog: ?Dialog = null;\n\t#switcherDialog: ?Menu = null;\n\n\tconstructor(props: { context: SelectorContext })\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation.Selector');\n\n\t\tthis.context = props.context;\n\t\tthis.basisFields = this.context.fields;\n\t}\n\n\thasGroup(groupId: string): boolean\n\t{\n\t\treturn this.#menuGroups.hasOwnProperty(groupId);\n\t}\n\n\taddGroup(groupId: string, group: MenuGroupItem)\n\t{\n\t\tthis.#menuGroups[groupId] = this.#normalizeGroup(group);\n\t}\n\n\taddGroupItem(groupId: string, item: MenuGroupItem)\n\t{\n\t\tif (this.hasGroup(groupId))\n\t\t{\n\t\t\tthis.#menuGroups[groupId].children.push(this.#normalizeGroup(item));\n\t\t}\n\t}\n\n\t#normalizeGroup(group: MenuGroupItem)\n\t{\n\t\tif (!Type.isArray(group.children))\n\t\t{\n\t\t\tgroup.children = [];\n\t\t}\n\n\t\tgroup.children = (\n\t\t\tgroup\n\t\t\t\t.children\n\t\t\t\t.filter(item => item.customData?.field ? this.#shouldShowField(item.customData.field) : true)\n\t\t\t\t.map(childGroup => this.#normalizeGroup(childGroup))\n\t\t);\n\n\t\treturn {\n\t\t\tentityId: 'bp',\n\t\t\ttabs: 'recents',\n\t\t\t...group\n\t\t};\n\t}\n\n\trenderWith(targetInput: Element): HTMLDivElement\n\t{\n\t\tthis.targetInput = Runtime.clone(targetInput);\n\t\tthis.targetInput.setAttribute('autocomplete', 'off');\n\n\t\tthis.menuButton = Tag.render`\n\t\t\t<span \n\t\t\t\tonclick=\"${this.openMenu.bind(this)}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-dotted\"\n\t\t\t></span>\n\t\t`;\n\n\t\tthis.parseTargetProperties();\n\n\t\tthis.replaceOnWrite |= (this.targetInput.getAttribute('data-select-mode') === 'replace');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-select\">\n\t\t\t\t${this.targetInput}\n\t\t\t\t${this.menuButton}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderTo(targetInput: Element): void\n\t{\n\t\ttargetInput.parentNode.replaceChild(this.renderWith(targetInput), targetInput);\n\t}\n\n\tbindTargetEvents(): void\n\t{\n\t\tEvent.bind(this.targetInput, 'keydown', this.#onKeyDown.bind(this));\n\t}\n\n\tparseTargetProperties(): void\n\t{\n\t\tthis.fieldProperty = JSON.parse(this.targetInput.getAttribute('data-property'));\n\t\tconst propertyType = this.targetInput.getAttribute('data-selector-type');\n\n\t\tif (!this.fieldProperty && propertyType)\n\t\t{\n\t\t\tthis.fieldProperty = {Type: propertyType};\n\t\t}\n\n\t\tif (this.fieldProperty)\n\t\t{\n\t\t\tthis.fieldProperty.Type = this.fieldProperty.Type || propertyType;\n\t\t\tthis.#prepareSelectorUsingFieldType();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.context.useSwitcherMenu = false;\n\t\t}\n\n\t\tthis.replaceOnWrite |= (this.targetInput.getAttribute('data-select-mode') === 'replace');\n\t}\n\n\t#prepareSelectorUsingFieldType(): void\n\t{\n\t\tthis.basisFields = this.basisFields.filter(field => this.#shouldShowField(field));\n\n\t\tconst type = this.fieldProperty?.Type;\n\t\tif (type === 'file')\n\t\t{\n\t\t\tthis.replaceOnWrite = true;\n\t\t}\n\t\telse if (type === 'date' || type === 'datetime')\n\t\t{\n\t\t\tthis.replaceOnWrite = true;\n\n\t\t\tconst delayIntervalSelector = new DelayIntervalSelector({\n\t\t\t\tlabelNode: this.targetInput,\n\t\t\t\tbasisFields: this.basisFields,\n\t\t\t\tuseAfterBasis: true,\n\t\t\t\tonchange: (function(delay)\n\t\t\t\t{\n\t\t\t\t\tthis.targetInput.value = delay.toExpression(\n\t\t\t\t\t\tthis.basisFields,\n\t\t\t\t\t\tHelper.getResponsibleUserExpression(this.context.fields)\n\t\t\t\t\t);\n\t\t\t\t}).bind(this)\n\t\t\t});\n\n\t\t\tdelayIntervalSelector.init(DelayInterval.fromString(this.targetInput.value, this.basisFields));\n\t\t}\n\t\telse if (type === 'time')\n\t\t{\n\t\t\tthis.replaceOnWrite = true;\n\n\t\t\tconst timeSelector = new InlineTimeSelector({labelNode: this.targetInput});\n\n\t\t\ttimeSelector.init(this.targetInput.value);\n\t\t}\n\t}\n\n\t#shouldShowField(field: Field): boolean\n\t{\n\t\tconst fieldType = this.fieldProperty?.Type;\n\t\tif (fieldType === 'file')\n\t\t{\n\t\t\treturn field.Type === 'file';\n\t\t}\n\t\telse if (fieldType === 'date' || fieldType === 'datetime')\n\t\t{\n\t\t\treturn field.Type === 'date' || field.Type === 'datetime';\n\t\t}\n\t\telse if (fieldType === 'time')\n\t\t{\n\t\t\treturn field.Type === 'date' || field.Type === 'datetime' || field.Type === 'time';\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#onKeyDown(event: KeyboardEvent)\n\t{\n\t\tif (event.keyCode === 45 && event.altKey === false && event.ctrlKey === false && event.shiftKey === false)\n\t\t{\n\t\t\tthis.openMenu(event);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\topenMenu(event: KeyboardEvent, skipPropertiesSwitcher: boolean = false)\n\t{\n\t\tif (!skipPropertiesSwitcher && this.context.useSwitcherMenu && !this.targetInput.value)\n\t\t{\n\t\t\treturn this.openPropertiesSwitcherMenu();\n\t\t}\n\n\t\tif (this.#dialog)\n\t\t{\n\t\t\tthis.#dialog.show();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.fillGroups();\n\t\tthis.onMenuOpen();\n\n\t\tlet menuItems = [];\n\t\tfor (const group of Object.values(this.#menuGroups))\n\t\t{\n\t\t\tif (group.children.length > 0)\n\t\t\t{\n\t\t\t\tmenuItems.push(group);\n\t\t\t}\n\t\t}\n\n\t\tif (menuItems.length === 1)\n\t\t{\n\t\t\tmenuItems = menuItems[0].children;\n\t\t}\n\n\t\tlet menuId = this.menuButton.getAttribute('data-selector-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tthis.menuButton.setAttribute('data-selector-id', menuId);\n\t\t}\n\n\t\tthis.#dialog = new Dialog({\n\t\t\ttargetNode: this.menuButton,\n\t\t\twidth: 500,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\titems: this.injectDialogMenuTitles(menuItems),\n\t\t\tshowAvatars: false,\n\t\t\tevents: {\n\t\t\t\t'Item:onBeforeSelect': (event) => {\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tconst item = event.getData().item;\n\t\t\t\t\tthis.onFieldSelect(item.getCustomData().get('field'));\n\t\t\t\t}\n\t\t\t},\n\t\t\tcompactView: true,\n\t\t});\n\n\t\tthis.#dialog.show();\n\t}\n\n\tfillGroups(): void\n\t{\n\t\tthis.fillFieldsGroups();\n\t\tthis.fillFileGroup();\n\t}\n\n\tfillFieldsGroups(): void\n\t{\n\t\tthis.addGroup('ROOT', {\n\t\t\tid: 'ROOT',\n\t\t\ttitle: this.context.rootGroupTitle,\n\t\t\tsearchable: false,\n\t\t});\n\n\t\tthis.getFields().forEach((field) => {\n\t\t\tlet groupKey = field.Id.indexOf('.') < 0 ? 'ROOT' : field.Id.split('.')[0];\n\t\t\tlet groupName = '';\n\t\t\tlet fieldName = field.Name;\n\n\t\t\tif (field.Name && groupKey !== 'ROOT' && field.Name.indexOf(': ') >= 0)\n\t\t\t{\n\t\t\t\tconst names = field.Name.split(': ');\n\t\t\t\tgroupName = names.shift();\n\t\t\t\tfieldName = names.join(': ');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tfield['Id'].indexOf('ASSIGNED_BY_') === 0\n\t\t\t\t&& field['Id'] !== 'ASSIGNED_BY_ID'\n\t\t\t\t&& field['Id'] !== 'ASSIGNED_BY_PRINTABLE'\n\t\t\t)\n\t\t\t{\n\t\t\t\tgroupKey = 'ASSIGNED_BY';\n\t\t\t\tconst names = field.Name.split(' ');\n\t\t\t\tgroupName = names.shift();\n\t\t\t\tfieldName = names.join(' ').replace('(', '').replace(')', '');\n\t\t\t}\n\n\t\t\tif (!this.hasGroup(groupKey))\n\t\t\t{\n\t\t\t\tthis.addGroup(groupKey, {\n\t\t\t\t\tid: groupKey,\n\t\t\t\t\ttitle: groupName,\n\t\t\t\t\tsearchable: false,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.addGroupItem(groupKey, {\n\t\t\t\tid: field.SystemExpression,\n\t\t\t\ttitle: fieldName || field.Id,\n\t\t\t\tcustomData: {field},\n\t\t\t});\n\t\t});\n\t}\n\n\tfillFileGroup(): void\n\t{\n\t\tconst fileFields = this.getFields().filter((field) => field.Type === 'file');\n\n\t\tif (fileFields.length > 0)\n\t\t{\n\t\t\tthis.addGroup('__FILES', {\n\t\t\t\tid: '__FILES',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FILES_LINKS'),\n\t\t\t\tchildren: this.#prepareFilesMenu(fileFields),\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\t}\n\n\t#prepareFilesMenu(fileFields: Array<Field>): Array<MenuGroupItem>\n\t{\n\t\treturn fileFields.map((field) => {\n\t\t\tconst exp = (\n\t\t\t\tfield['ObjectId'] === 'Document'\n\t\t\t\t\t? '{{'+field['Name']+' > shortlink}}'\n\t\t\t\t\t: '{{~'+field['ObjectId']+':'+field['Id']+' > shortlink}}'\n\t\t\t);\n\n\t\t\tlet title = field.Name || field.Id;\n\n\t\t\tif (field.ObjectName)\n\t\t\t{\n\t\t\t\ttitle = field.ObjectName + ': ' + title;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: title,\n\t\t\t\tcustomData: {\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tId: field['Id'] + '_shortlink',\n\t\t\t\t\t\tObjectId: field['ObjectId'],\n\t\t\t\t\t\tName: field['Name'],\n\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\tExpression: exp,\n\t\t\t\t\t\tSystemExpression: '{='+field['ObjectId']+':'+field['Id']+' > shortlink}'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tid: exp,\n\t\t\t};\n\t\t});\n\t}\n\n\tonMenuOpen(): void\n\t{\n\t\tthis.emit('onOpenMenu', { selector: this });\n\t}\n\n\topenPropertiesSwitcherMenu()\n\t{\n\t\tconst self = this;\n\n\t\tMenuManager.show(\n\t\t\tHelper.generateUniqueId(),\n\t\t\tthis.menuButton,\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'),\n\t\t\t\t\tdisabled: self.fieldProperty?.Type === 'file',\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.emit('onAskConstant', {fieldProperty: self.fieldProperty});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.emit('onAskParameter', {fieldProperty: self.fieldProperty});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_MANUAL'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.openMenu(event, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 20,\n\t\t\t\tangle: { position: 'top'},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.#switcherDialog = MenuManager.currentItem;\n\n\t\treturn true;\n\t}\n\n\tinjectDialogMenuTitles(items)\n\t{\n\t\titems.forEach((parent) => {\n\t\t\tif (Type.isArray(parent.children))\n\t\t\t{\n\t\t\t\tthis.injectDialogMenuSupertitles(parent.title, parent.children);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tinjectDialogMenuSupertitles(title: string, children)\n\t{\n\t\tchildren.forEach((child) => {\n\t\t\tif (!child.supertitle)\n\t\t\t{\n\t\t\t\tchild.supertitle = title;\n\t\t\t}\n\t\t\tif (Type.isArrayFilled(child.children))\n\t\t\t{\n\t\t\t\tthis.injectDialogMenuSupertitles(child.title, child.children);\n\t\t\t}\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field): void\n\t{\n\t\tif (!field)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputType = this.targetInput.tagName.toLowerCase();\n\n\t\tif (inputType === 'select')\n\t\t{\n\t\t\tlet expressionOption = this.targetInput.querySelector('[data-role=\"expression\"]');\n\t\t\tif (!expressionOption)\n\t\t\t{\n\t\t\t\texpressionOption = (\n\t\t\t\t\tthis.targetInput.appendChild(\n\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t'option',\n\t\t\t\t\t\t\t{attrs: {'data-role': 'expression'}}\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\texpressionOption.setAttribute('value', field.Expression);\n\t\t\texpressionOption.textContent = field['Expression'];\n\n\t\t\texpressionOption.selected = true;\n\t\t}\n\t\telse if (inputType === 'label')\n\t\t{\n\t\t\tthis.targetInput.textContent = field.Expression;\n\t\t\tconst hiddenInput = document.getElementById(this.targetInput.getAttribute('for'));\n\t\t\tif (hiddenInput)\n\t\t\t{\n\t\t\t\thiddenInput.value = field.Expression;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.replaceOnWrite)\n\t\t\t{\n\t\t\t\tthis.targetInput.value = field.Expression;\n\t\t\t\tthis.targetInput.selectionEnd = this.targetInput.value.length;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet beforePart = '';\n\t\t\t\tconst middlePart = field.Expression;\n\t\t\t\tlet afterPart = '';\n\t\t\t\tif (Type.isStringFilled(this.targetInput.value))\n\t\t\t\t{\n\t\t\t\t\tbeforePart = this.targetInput.value.substr(0, this.targetInput.selectionEnd);\n\t\t\t\t\tafterPart = this.targetInput.value.substr(this.targetInput.selectionEnd);\n\t\t\t\t}\n\n\t\t\t\tthis.targetInput.value = beforePart + middlePart + afterPart;\n\t\t\t\tthis.targetInput.selectionEnd = beforePart.length + middlePart.length;\n\t\t\t}\n\t\t}\n\n\t\tBX.fireEvent(this.targetInput, 'change');\n\t\tthis.emit('Field:Selected', { field });\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.#dialog)\n\t\t{\n\t\t\tthis.#dialog.destroy();\n\t\t}\n\t\tif (this.#switcherDialog)\n\t\t{\n\t\t\tthis.#switcherDialog.destroy();\n\t\t}\n\t}\n\n\tgetFields(): Array<Field>\n\t{\n\t\tconst printablePrefix = Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX');\n\t\tconst names = this.context.fields.map(field => field.Name).join('\\n');\n\n\t\tconst fields = [];\n\t\tthis.basisFields.forEach((field) => {\n\t\t\tfield.ObjectId = 'Document';\n\n\t\t\tconst custom = (field['BaseType'] === 'string' && field['Type'] !== 'string');\n\n\t\t\tif (!custom)\n\t\t\t{\n\t\t\t\tfields.push(field);\n\t\t\t}\n\n\t\t\t//generate printable version\n\t\t\tif (\n\t\t\t\tfield['Type'] === 'user'\n\t\t\t\t||\n\t\t\t\tfield['Type'] === 'bool'\n\t\t\t\t||\n\t\t\t\tfield['Type'] === 'file'\n\t\t\t\t||\n\t\t\t\tcustom\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst printableName = field['Name'] + ' ' + printablePrefix;\n\n\t\t\t\tif (names.indexOf(printableName) < 0)\n\t\t\t\t{\n\t\t\t\t\tconst printableField = BX.clone(field);\n\t\t\t\t\tconst printableTag = (field['Type'] === 'user') ? 'friendly' : 'printable';\n\n\t\t\t\t\tprintableField['Name'] = printableName;\n\t\t\t\t\tprintableField['Type'] = 'string';\n\t\t\t\t\tprintableField['SystemExpression'] = '{=Document:'+printableField['Id']+' > '+printableTag+'}';\n\t\t\t\t\tprintableField['Expression'] = '{{'+field['Name']+' > '+printableTag+'}}';\n\n\t\t\t\t\tfields.push(printableField);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (field['BaseType'] === 'date' || field['BaseType'] === 'datetime' || field['BaseType'] === 'time')\n\t\t\t{\n\t\t\t\tconst serverField = BX.clone(field);\n\t\t\t\tserverField['Name'] += ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_DATE_BY_SERVER');\n\t\t\t\tserverField['Type'] = 'string';\n\t\t\t\tserverField['SystemExpression'] = `{=Document:${serverField['Id']} > server}`;\n\t\t\t\tserverField['Expression'] = `{{${field['Name']} > server}}`;\n\n\t\t\t\tfields.push(serverField);\n\n\t\t\t\tconst responsibleField = BX.clone(field);\n\t\t\t\tresponsibleField['Name'] += ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_DATE_BY_RESPONSIBLE');\n\t\t\t\tresponsibleField['Type'] = 'string';\n\t\t\t\tresponsibleField['SystemExpression'] = `{=Document:${serverField['Id']} > responsible}`;\n\t\t\t\tresponsibleField['Expression'] = `{{${field['Name']} > responsible}}`;\n\n\t\t\t\tfields.push(responsibleField);\n\t\t\t}\n\t\t});\n\n\t\treturn fields;\n\t}\n}","import { SelectorContext, Condition, ConditionGroup } from 'bizproc.automation';\nimport { InlineSelector } from './inline-selector';\nimport { Field } from './types';\n\nexport class InlineSelectorCondition extends InlineSelector\n{\n\t#condition: Condition;\n\n\tconstructor(props: {\n\t\tcontext: SelectorContext,\n\t\tcondition: Condition,\n\t})\n\t{\n\t\tsuper(props);\n\n\t\tthis.#condition = props.condition;\n\t}\n\n\trenderTo(target: Element)\n\t{\n\t\tthis.targetInput = target;\n\t\tthis.menuButton = target;\n\n\t\tthis.parseTargetProperties();\n\t\tthis.bindTargetEvents();\n\t}\n\n\tfillGroups(): void\n\t{\n\t\tthis.fillFieldsGroups();\n\t}\n\n\tonMenuOpen(): void\n\t{\n\t\tthis.emit('onOpenMenu', {\n\t\t\tselector: this,\n\t\t\t// TODO - rename\n\t\t\tisMixedCondition: this.#isMixedConditionGroup(),\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field)\n\t{\n\t\tthis.emit('change', { field });\n\t}\n\n\t#isMixedConditionGroup(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.#condition\n\t\t\t&& this.#condition.parentGroup\n\t\t\t&& this.#condition.parentGroup.type === ConditionGroup.CONDITION_TYPE.Mixed\n\t\t);\n\t}\n\n\tgetFields(): Array<Field>\n\t{\n\t\treturn this.context.fields.map((field) => ({\n\t\t\t...field,\n\t\t\tObjectId: 'Document',\n\t\t}));\n\t}\n}","import { Tag } from 'main.core';\nimport { Field } from './types';\nimport { InlineSelector } from './inline-selector';\n\nexport class InlineSelectorHtml extends InlineSelector\n{\n\t#editorNode: ?BXHtmlEditor;\n\t#eventHandlers = {\n\t\t'OnEditorInitedAfter': this.#bindEditorHooks.bind(this),\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#unbindEvents();\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\t\tthis.#editorNode = targetInput.querySelector('.bx-html-editor');\n\t\tthis.menuButton = Tag.render`\n\t\t\t<span\n\t\t\t\tonclick=\"${this.openMenu.bind(this)}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-dotted\"\n\t\t\t></span>\n\t\t`;\n\n\t\tthis.parseTargetProperties();\n\t\tthis.bindTargetEvents()\n\n\t\ttargetInput.firstElementChild.appendChild(this.menuButton);\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tfor (const [name, handler] of Object.entries(this.#eventHandlers))\n\t\t{\n\t\t\tBX.addCustomEvent(name, handler);\n\t\t}\n\t}\n\n\t#unbindEvents(): void\n\t{\n\t\tfor (const [name, handler] of Object.entries(this.#eventHandlers))\n\t\t{\n\t\t\tBX.removeCustomEvent(name, handler);\n\t\t}\n\t}\n\n\t#bindEditorHooks(editor): void\n\t{\n\t\tif (editor.dom.cont !== this.#editorNode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet header = '';\n\t\tlet footer = '';\n\n\t\tconst cutHeader = (content: string, shouldSaveHeader: boolean = false) => {\n\t\t\treturn content.replace(/(^[\\s\\S]*?)(<body.*?>)/i, (str) => {\n\t\t\t\tif (shouldSaveHeader)\n\t\t\t\t{\n\t\t\t\t\theader = str;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t});\n\t\t};\n\n\t\tconst cutFooter = (content: string, shouldSaveFooter: boolean = false) => {\n\t\t\treturn content.replace(/(<\\/body>[\\s\\S]*?$)/i, (str) => {\n\t\t\t\tif (shouldSaveFooter)\n\t\t\t\t{\n\t\t\t\t\tfooter = str;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t});\n\t\t}\n\n\t\tBX.addCustomEvent(editor, 'OnParse', function (mode)\n\t\t{\n\t\t\tif (!mode)\n\t\t\t{\n\t\t\t\tthis.content = cutFooter(cutHeader(this.content, true), true);\n\t\t\t}\n\t\t});\n\n\t\tBX.addCustomEvent(editor, 'OnAfterParse', function (mode)\n\t\t{\n\t\t\tif (mode)\n\t\t\t{\n\t\t\t\tlet content = cutFooter(cutHeader(this.content));\n\n\t\t\t\tif (header !== '' && footer !== '')\n\t\t\t\t{\n\t\t\t\t\tcontent = header + content + footer;\n\t\t\t\t}\n\n\t\t\t\tthis.content = content;\n\t\t\t}\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field): void\n\t{\n\t\tconst insertText = field.Expression;\n\t\tconst editor = this.#getEditor();\n\n\t\tif (editor && editor.InsertHtml)\n\t\t{\n\t\t\tif (editor.synchro.IsFocusedOnTextarea())\n\t\t\t{\n\t\t\t\teditor.textareaView.Focus();\n\t\t\t\teditor.textareaView.WrapWith('', '', insertText);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\teditor.InsertHtml(insertText);\n\t\t\t}\n\t\t\teditor.synchro.Sync();\n\t\t}\n\t}\n\n\tonBeforeSave(): void\n\t{\n\t\tconst editor = this.#getEditor();\n\t\tif (editor && editor.SaveContent)\n\t\t{\n\t\t\teditor.SaveContent();\n\t\t}\n\t}\n\n\tonPopupResize()\n\t{\n\t\tconst editor = this.#getEditor();\n\t\tif (editor && editor.ResizeSceleton)\n\t\t{\n\t\t\teditor.ResizeSceleton();\n\t\t}\n\t}\n\n\t#getEditor(): ?BXHtmlEditor\n\t{\n\t\tif (this.#editorNode)\n\t\t{\n\t\t\tconst editorId = this.#editorNode.id.split('-');\n\t\t\treturn BXHtmlEditor.Get(editorId[editorId.length - 1]);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { SelectorContext } from 'bizproc.automation';\n\nexport class SaveStateCheckbox\n{\n\t#context: SelectorContext;\n\t#checkbox: Element;\n\t#needSync: boolean;\n\n\tconstructor(props: {\n\t\tcontext: SelectorContext,\n\t\tcheckbox: Element,\n\t\tneedSync: boolean,\n\t})\n\t{\n\t\tthis.#context = props.context;\n\t\tthis.#checkbox = props.checkbox;\n\t\tthis.#needSync = props.needSync;\n\n\t\tif (props.needSync)\n\t\t{\n\t\t\tconst category = 'save_state_checkbox';\n\t\t\tconst savedState = this.#context.get('userOptions').get(category, this.#getKey(), 'N');\n\t\t\tif (savedState === 'Y')\n\t\t\t{\n\t\t\t\tthis.#checkbox.checked = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.#needSync)\n\t\t{\n\t\t\tthis.#context.get('userOptions').set('save_state_checkboxes', this.#getKey(), this.#getValue());\n\t\t}\n\t}\n\n\t#getKey(): ?string\n\t{\n\t\treturn this.#checkbox.getAttribute('data-save-state-key');\n\t}\n\n\t#getValue(): string\n\t{\n\t\treturn this.#checkbox.checked ? 'Y'\t : 'N';\n\t}\n}","import { Type } from 'main.core';\nimport { InlineSelector } from './inline-selector';\n\nexport class UserSelector extends InlineSelector\n{\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\t\tthis.menuButton = targetInput;\n\n\t\tthis.fieldProperty = JSON.parse(targetInput.getAttribute('data-property'));\n\t\tif (!this.fieldProperty)\n\t\t{\n\t\t\tthis.context.useSwitcherMenu = false;\n\t\t}\n\n\t\tconst additionalUserFields = this.context.get('additionalUserFields');\n\t\tthis.userSelector = BX.Bizproc.UserSelector.decorateNode(\n\t\t\ttargetInput,\n\t\t\t{\n\t\t\t\tadditionalFields: Type.isArray(additionalUserFields) ? additionalUserFields : [],\n\t\t\t},\n\t\t);\n\t}\n\n\tdestroy()\n\t{\n\t\tsuper.destroy();\n\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.destroy();\n\t\t\tthis.userSelector = null;\n\t\t}\n\t}\n}","import { Type, Runtime, Tag, Dom, Event, Text, Loc } from 'main.core';\nimport { MenuManager } from 'main.popup';\nimport { SelectorContext, Helper } from 'bizproc.automation';\nimport { InlineSelector } from './inline-selector';\n\nexport class FileSelector extends InlineSelector\n{\n\tstatic TYPE = {\n\t\tNone: '',\n\t\tDisk: 'disk',\n\t\tFile: 'file',\n\t}\n\n\t#type: string = FileSelector.TYPE.None;\n\t#multiple: boolean = false;\n\t#required: boolean = false;\n\t#valueInputName: string = '';\n\t#typeInputName: string = '';\n\t#useDisk: boolean = false;\n\t#label: string = '';\n\t#labelFile: string = '';\n\t#labelDisk: string = '';\n\n\t#diskUploader: ?BX.Bizproc.Automation.DiskUploader = null;\n\n\t#diskControllerNode: ?HTMLDivElement = null;\n\t#fileItemsNode: ?HTMLSpanElement = null;\n\t#fileControllerNode: ?HTMLDivElement = null;\n\n\t#menuId: ?string;\n\n\tconstructor(props: { context: SelectorContext })\n\t{\n\t\tsuper(props);\n\n\t\tthis.context.set(\n\t\t\t'fileFields',\n\t\t\tthis.context.fields.filter(field => field.Type === 'file'),\n\t\t);\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.menu)\n\t\t{\n\t\t\tthis.menu.popupWindow.close();\n\t\t}\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\n\t\tconst selected = this.parseTargetProperties();\n\n\t\tthis.targetInput.appendChild(this.#createBaseNode());\n\t\tthis.#showTypeControlLayout(selected);\n\t\t// this.setFileFields()\n\t\t// this.createDom\n\t}\n\n\tparseTargetProperties()\n\t{\n\t\tlet config = JSON.parse(this.targetInput.getAttribute('data-config'));\n\t\tif (!Type.isPlainObject(config))\n\t\t{\n\t\t\tconfig = {};\n\t\t}\n\n\t\tthis.#type = config.type || FileSelector.TYPE.File;\n\t\tif (config.selected && !config.selected.length)\n\t\t{\n\t\t\tthis.#type = FileSelector.TYPE.None;\n\t\t}\n\n\t\tthis.#multiple = config.multiple || false;\n\t\tthis.#required = config.required || false;\n\t\tthis.#valueInputName = config.valueInputName || '';\n\t\tthis.#typeInputName = config.typeInputName || '';\n\t\tthis.#useDisk = config.useDisk || false;\n\t\tthis.#label = config.label || 'Attachment';\n\t\tthis.#labelFile = config.labelFile || 'File';\n\t\tthis.#labelDisk = config.labelDisk || 'Disk';\n\n\t\tif (config.selected && config.selected.length > 0)\n\t\t{\n\t\t\treturn Runtime.clone(config.selected);\n\t\t}\n\t}\n\n\t#createBaseNode(): HTMLDivElement\n\t{\n\t\tconst idSalt = Helper.generateUniqueId();\n\t\tlet fileRadio = null;\n\n\t\tconst fileTypeOptions = [];\n\n\t\tif (this.context.get('fileFields').length > 0)\n\t\t{\n\t\t\tfileRadio = Tag.render`\n\t\t\t\t<input\n\t\t\t\t\tid=\"type-1${idSalt}\"\n\t\t\t\t\tclass=\"bizproc-automation-popup-select-input\"\n\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\tname=\"${this.#typeInputName}\"\n\t\t\t\t\tvalue=\"${FileSelector.TYPE.File}\"\n\t\t\t\t\t${this.#type === FileSelector.TYPE.File ? 'checked' : ''}\n\t\t\t\t/>\n\t\t\t`;\n\t\t}\n\n\t\tconst diskFileRadio = Tag.render`\n\t\t\t<input\n\t\t\t\tid=\"type-2${idSalt}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-input\"\n\t\t\t\ttype=\"radio\"\n\t\t\t\tname=\"${this.#typeInputName}\"\n\t\t\t\tvalue=\"${FileSelector.TYPE.Disk}\"\n\t\t\t\t${this.#type === FileSelector.TYPE.Disk ? 'checked' : ''}\n\t\t\t/>\n\t\t`;\n\n\t\tfileTypeOptions.push(Tag.render`\n\t\t\t<span class=\"bizproc-automation-popup-settings-title\">${this.#label}:</span>\n\t\t`);\n\n\t\tif (fileRadio)\n\t\t{\n\t\t\tfileTypeOptions.push(fileRadio, Tag.render`\n\t\t\t\t<label\n\t\t\t\t\tclass=\"bizproc-automation-popup-settings-link\"\n\t\t\t\t\tfor=\"type-1${idSalt}\"\n\t\t\t\t\tonclick=\"${this.#onTypeChange.bind(this, FileSelector.TYPE.File)}\"\n\t\t\t\t>\n\t\t\t\t${this.#labelFile}\n\t\t\t\t</label>\n\t\t\t`);\n\t\t}\n\n\t\tfileTypeOptions.push(diskFileRadio, Tag.render`\n\t\t\t<label\n\t\t\t\tclass=\"bizproc-automation-popup-settings-link\"\n\t\t\t\tfor=\"type-2${idSalt}\"\n\t\t\t\tonclick=\"${this.#onTypeChange.bind(this, FileSelector.TYPE.Disk)}\"\n\t\t\t>\n\t\t\t${this.#labelDisk}\n\t\t\t</label>\n\t\t`);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-settings-block\">\n\t\t\t\t${fileTypeOptions}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#showTypeControlLayout(selected: Array): void\n\t{\n\t\tif (this.#type === FileSelector.TYPE.Disk)\n\t\t{\n\t\t\tthis.#hideFileControllerLayout();\n\t\t\tthis.#showDiskControllerLayout(selected);\n\t\t}\n\t\telse if (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tthis.#hideDiskControllerLayout();\n\t\t\tthis.#showFileControllerLayout(selected);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#hideFileControllerLayout();\n\t\t\tthis.#hideDiskControllerLayout();\n\t\t}\n\t}\n\n\t#showDiskControllerLayout(selected: Array): void\n\t{\n\t\tif (!this.#diskControllerNode)\n\t\t{\n\t\t\tthis.#diskControllerNode = Dom.create('div');\n\n\t\t\tthis.targetInput.appendChild(this.#diskControllerNode);\n\n\t\t\tconst diskUploader = this.#getDiskUploader();\n\t\t\tdiskUploader.layout(this.#diskControllerNode);\n\t\t\tdiskUploader.show(true);\n\n\t\t\tif (selected)\n\t\t\t{\n\t\t\t\tthis.addItems(selected);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.#diskControllerNode);\n\t\t}\n\t}\n\n\t#hideDiskControllerLayout(): void\n\t{\n\t\tif (this.#diskControllerNode)\n\t\t{\n\t\t\tDom.hide(this.#diskControllerNode);\n\t\t}\n\t}\n\n\t#showFileControllerLayout(selected: Array): void\n\t{\n\t\tif (!this.#fileControllerNode)\n\t\t{\n\t\t\tthis.#fileItemsNode = Dom.create('span');\n\t\t\tthis.#fileControllerNode = Dom.create('div', {children: [this.#fileItemsNode]});\n\t\t\tthis.targetInput.appendChild(this.#fileControllerNode);\n\t\t\tconst addButtonNode = Dom.create('a', {\n\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-link bizproc-automation-popup-settings-link-thin'},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ADD')\n\t\t\t});\n\n\t\t\tthis.#fileControllerNode.appendChild(addButtonNode);\n\n\t\t\tEvent.bind(addButtonNode, 'click', this.#onFileFieldAddClick.bind(this, addButtonNode));\n\n\t\t\tif (selected)\n\t\t\t{\n\t\t\t\tthis.addItems(selected);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.#fileControllerNode);\n\t\t}\n\t}\n\n\t#hideFileControllerLayout(): void\n\t{\n\t\tif (this.#fileControllerNode)\n\t\t{\n\t\t\tDom.hide(this.#fileControllerNode);\n\t\t}\n\t}\n\n\t#getDiskUploader(): BX.Bizproc.Automation.DiskUploader\n\t{\n\t\tif (!this.#diskUploader)\n\t\t{\n\t\t\tthis.#diskUploader = BX.Bizproc.Automation.DiskUploader.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\tmsg: {\n\t\t\t\t\t\t'diskAttachFiles' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_ATTACH_FILE'),\n\t\t\t\t\t\t'diskAttachedFiles' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_ATTACHED_FILES'),\n\t\t\t\t\t\t'diskSelectFile' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_SELECT_FILE'),\n\t\t\t\t\t\t'diskSelectFileLegend' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_SELECT_FILE_LEGEND'),\n\t\t\t\t\t\t'diskUploadFile' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_UPLOAD_FILE'),\n\t\t\t\t\t\t'diskUploadFileLegend' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_UPLOAD_FILE_LEGEND')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.#diskUploader.setMode(1);\n\t\t}\n\n\t\treturn this.#diskUploader;\n\t}\n\n\t#onTypeChange(newType: string): void\n\t{\n\t\tif (this.#type !== newType)\n\t\t{\n\t\t\tthis.#type = newType;\n\t\t\tthis.#showTypeControlLayout();\n\t\t}\n\t}\n\n\t#addFileItem(item)\n\t{\n\t\tif (this.#isFileItemSelected(item))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst node = this.#createFileItemNode(item);\n\t\tif (!this.#multiple)\n\t\t{\n\t\t\tDom.clean(this.#fileItemsNode)\n\t\t}\n\n\t\tthis.#fileItemsNode.appendChild(node);\n\t}\n\n\t#isFileItemSelected(item: object)\n\t{\n\t\treturn !!this.#fileItemsNode.querySelector(`[data-file-id=\"${item.id}\"]`);\n\t}\n\n\taddItems(items: Array<object>)\n\t{\n\t\tif (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tfor(const fileItem of items)\n\t\t\t{\n\t\t\t\tthis.#addFileItem(fileItem)\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis\n\t\t\t\t.#getDiskUploader()\n\t\t\t\t.setValues(\n\t\t\t\t\tFileSelector.#convertToDiskItems(items)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tstatic #convertToDiskItems(items: Array<object>)\n\t{\n\t\treturn items.map((item) => ({\n\t\t\tID: item['id'],\n\t\t\tNAME: item['name'],\n\t\t\tSIZE: item['size'],\n\t\t\tVIEW_URL: '',\n\t\t}));\n\t}\n\n\t#removeFileItem(item)\n\t{\n\t\tconst itemNode = this.#fileItemsNode.querySelector(`[data-file-id=\"${item.id}\"]`);\n\t\tif (itemNode)\n\t\t{\n\t\t\tthis.#fileItemsNode.removeChild(itemNode);\n\t\t}\n\t}\n\n\t#onFileFieldAddClick(addButtonNode, event)\n\t{\n\t\tconst self = this;\n\n\t\tif (!this.#menuId)\n\t\t{\n\t\t\tthis.#menuId = Helper.generateUniqueId();\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tthis.#menuId,\n\t\t\taddButtonNode,\n\t\t\tthis.context.get('fileFields').map((field) => ({\n\t\t\t\ttext: Text.encode(field.Name),\n\t\t\t\tfield,\n\t\t\t\tonclick(event, item)\n\t\t\t\t{\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\tself.onFieldSelect(field);\n\t\t\t\t}\n\t\t\t})),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: Dom.getPosition(addButtonNode)['width'] / 2,\n\t\t\t\tangle: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\toffset: 0,\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\t// this.#menu = MenuManager.currentItem;\n\t\tevent.preventDefault();\n\t}\n\n\tonFieldSelect(field)\n\t{\n\t\tthis.#addFileItem({\n\t\t\tid: field.Id,\n\t\t\texpression: field.Expression,\n\t\t\tname: field.Name,\n\t\t\ttype: FileSelector.TYPE.File\n\t\t});\n\t}\n\n\t#createFileItemNode(item)\n\t{\n\t\tconst itemField = this.context.get('fileFields').find(field => field.Expression === item.expression);\n\t\tconst label = itemField?.Name || '';\n\n\t\treturn Tag.render`\n\t\t\t<span\n\t\t\t\tclass=\"bizproc-automation-popup-autocomplete-item\"\n\t\t\t\tdata-file-id=\"${item.id}\"\n\t\t\t\tdata-file-expression=\"${item.expression}\"\n\t\t\t>\n\t\t\t\t<span class=\"bizproc-automation-popup-autocomplete-name\">${label}</span>\n\t\t\t\t<span\n\t\t\t\t\tclass=\"bizproc-automation-popup-autocomplete-delete\"\n\t\t\t\t\tonclick=\"${this.#removeFileItem.bind(this, item)}\"\n\t\t\t\t></span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonBeforeSave()\n\t{\n\t\tlet ids = [];\n\t\tif (this.#type === FileSelector.TYPE.Disk)\n\t\t{\n\t\t\tids = this.#getDiskUploader().getValues();\n\t\t}\n\t\telse if (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tids = (\n\t\t\t\tArray.from(this.#fileItemsNode.childNodes)\n\t\t\t\t\t.map(node => node.getAttribute('data-file-expression'))\n\t\t\t\t\t.filter(id => id !== '')\n\t\t\t);\n\t\t}\n\n\t\tfor (const id of ids)\n\t\t{\n\t\t\tthis.targetInput.appendChild(Tag.render`\n\t\t\t\t<input\n\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\tname=\"${this.#valueInputName + (this.#multiple ? '[]' : '')}\"\n\t\t\t\t\tvalue=\"${id}\"\n\t\t\t\t/>\n\t\t\t`);\n\t\t}\n\t}\n}\n","import { Event, Loc } from 'main.core';\nimport { InlineSelector } from './inline-selector';\n\nexport class TimeSelector extends InlineSelector\n{\n\t#clockInstance;\n\n\tdestroy()\n\t{\n\t\tif (this.#clockInstance)\n\t\t{\n\t\t\tthis.#clockInstance.closeWnd();\n\t\t}\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput; //this.targetInput = Runtime.clone(targetInput);\n\n\t\tconst datetime = new Date();\n\t\tdatetime.setHours(0, 0, 0, 0);\n\t\tdatetime.setTime(datetime.getTime() + this.#getCurrentTime() * 1000);\n\n\t\tthis.targetInput.value = this.constructor.#formatTime(datetime);\n\n\t\tEvent.bind(targetInput, 'click', this.showClock.bind(this));\n\t}\n\n\tshowClock(): void\n\t{\n\t\tif (!this.#clockInstance)\n\t\t{\n\t\t\tthis.#clockInstance = new BX.CClockSelector({\n\t\t\t\tstart_time: this.#getCurrentTime(),\n\t\t\t\tnode: this.targetInput,\n\t\t\t\tcallback: this.#onTimeSelect.bind(this),\n\t\t\t});\n\t\t}\n\n\t\tthis.#clockInstance.Show();\n\t}\n\n\t#onTimeSelect(time): void\n\t{\n\t\tthis.targetInput.value = time;\n\t\tBX.fireEvent(this.targetInput, 'change');\n\t\tthis.#clockInstance.closeWnd();\n\t}\n\n\t#getCurrentTime(): number\n\t{\n\t\treturn this.#convertTimeToSeconds(this.targetInput.value);\n\t}\n\n\t#convertTimeToSeconds(time: string): number\n\t{\n\t\tconst timeParts = time.split(/[\\s:]+/).map(part => parseInt(part));\n\n\t\tlet [hours, minutes] = timeParts;\n\t\tif (timeParts.length === 3)\n\t\t{\n\t\t\tconst period = timeParts[2];\n\n\t\t\tif (period === 'pm' && hours < 12)\n\t\t\t{\n\t\t\t\thours += 12;\n\t\t\t}\n\t\t\telse if (period === 'am' && hours === 12)\n\t\t\t{\n\t\t\t\thours = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn hours * 3600 + minutes * 60;\n\t}\n\n\tstatic #formatTime(datetime: Date): string\n\t{\n\t\tconst getFormat = (formatId) => (\n\t\t\tBX.date.convertBitrixFormat(Loc.getMessage(formatId)).replace(/:?\\s*s/, '')\n\t\t);\n\n\t\tconst dateFormat = getFormat('FORMAT_DATE');\n\t\tconst timeFormat = getFormat('FORMAT_DATETIME').replace(dateFormat, '').trim();\n\n\t\treturn BX.date.format(timeFormat, datetime);\n\t}\n}","import { Type, Loc, Event, Dom, Text, Tag } from 'main.core';\nimport { Helper } from './helper';\nimport { DelayInterval } from './delay-interval';\nimport { MenuManager } from 'main.popup';\nimport { getGlobalContext } from \"./automation\";\n\nexport class DelayIntervalSelector\n{\n\tbasisFields: Array;\n\tonchange: () => void;\n\tlabelNode;\n\tuseAfterBasis;\n\tminLimitM;\n\tshowWaitWorkDay;\n\n\tdelay;\n\n\tconstructor(options)\n\t{\n\t\tthis.basisFields = [];\n\t\tthis.onchange = null;\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.labelNode = options.labelNode;\n\t\t\tthis.useAfterBasis = options.useAfterBasis;\n\n\t\t\tif (Type.isArray(options.basisFields))\n\t\t\t{\n\t\t\t\tthis.basisFields = options.basisFields;\n\t\t\t}\n\t\t\tthis.onchange = options.onchange;\n\t\t\tthis.minLimitM = options.minLimitM;\n\t\t\tthis.showWaitWorkDay = options.showWaitWorkDay;\n\t\t}\n\t}\n\n\tinit(delay)\n\t{\n\t\tthis.delay = delay;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t\tthis.prepareBasisFields();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (this.delay && this.labelNode)\n\t\t{\n\t\t\tthis.labelNode.textContent = this.delay.format(\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\t\tthis.basisFields\n\t\t\t);\n\t\t}\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', BX.delegate(this.onLabelClick, this));\n\t\t}\n\t}\n\n\tonLabelClick(event)\n\t{\n\t\tthis.showDelayIntervalPopup();\n\t\tevent.preventDefault();\n\t}\n\n\tshowDelayIntervalPopup()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" }\n\t\t});\n\n\t\tconst radioNow = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid + \"now\",\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: 'now',\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.isNow())\n\t\t{\n\t\t\tradioNow.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst labelNow = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid + \"now\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_BASIS_NOW' : 'BIZPROC_AUTOMATION_CMP_AT_ONCE_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tconst labelNowHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP_2' : 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP')\n\t\t\t}\n\t\t});\n\t\tlabelNow.appendChild(labelNowHelpNode);\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioNow, labelNow]\n\t\t}));\n\n\t\tform.appendChild(this.createAfterControlNode());\n\n\t\tif (this.basisFields.length > 0)\n\t\t{\n\t\t\tform.appendChild(this.createBeforeControlNode());\n\t\t\tform.appendChild(this.createInControlNode());\n\t\t}\n\n\t\tconst workTimeRadio = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\",\n\t\t\t\tid: uid + \"worktime\",\n\t\t\t\tname: \"worktime\",\n\t\t\t\tvalue: '1',\n\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tchecked: delay.workTime\n\t\t\t}\n\t\t});\n\n\t\tconst workTimeHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_DELAY_WORK_TIME_HELP')\n\t\t\t}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\tchildren: [\n\t\t\t\tworkTimeRadio,\n\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-lbl\",\n\t\t\t\t\t\tfor: uid + \"worktime\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_DELAY_WORK_TIME_MSGVER_1')\n\t\t\t\t}),\n\t\t\t\tworkTimeHelpNode\n\t\t\t]\n\t\t}));\n\n\t\tif (this.showWaitWorkDay)\n\t\t{\n\t\t\tform.appendChild(this.#createWaitWorkDayNode());\n\t\t}\n\n\t\tconst self = this;\n\t\t//init modern Help tips\n\t\tBX.UI.Hint.init(form);\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), this.labelNode, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 20,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: 'webform-button webform-button-create bizproc-automation-button-left',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.saveFormData(new FormData(form));\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tif (self.fieldsMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldsMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tif (self.valueTypeMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.valueTypeMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tsaveFormData(formData: FormData)\n\t{\n\t\tconst type = formData.get('type');\n\n\t\tif (type === 'now')\n\t\t{\n\t\t\tthis.delay.setNow();\n\t\t}\n\t\telse if (type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tthis.delay.setType(DelayInterval.DELAY_TYPE.In);\n\t\t\tthis.delay.setValue(0);\n\t\t\tthis.delay.setValueType('i');\n\t\t\tthis.delay.setBasis(formData.get('basis_in'));\n\t\t\tthis.delay.setInTime(formData.get('basis_in_time') ? formData.get('basis_in_time').split(':') : null);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.delay.setType(type);\n\t\t\tthis.delay.setValue(formData.get('value_' + type));\n\t\t\tthis.delay.setValueType(formData.get('value_type_' + type));\n\n\t\t\tif (type === DelayInterval.DELAY_TYPE.After)\n\t\t\t{\n\t\t\t\tif (this.useAfterBasis)\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(formData.get('basis_after'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis.minLimitM > 0\n\t\t\t\t\t&& this.delay.basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t\t\t&& this.delay.valueType === 'i'\n\t\t\t\t\t&& this.delay.value < this.minLimitM\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('BIZPROC_AUTOMATION_DELAY_MIN_LIMIT_LABEL')\n\t\t\t\t\t});\n\t\t\t\t\tthis.delay.setValue(this.minLimitM);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.delay.setBasis(formData.get('basis_before'));\n\t\t\t}\n\t\t}\n\n\t\tthis.delay.setWorkTime(formData.get('worktime'));\n\t\tthis.delay.setWaitWorkDay(formData.get('wait_workday'));\n\t\tthis.setLabelText();\n\n\t\tif (this.onchange)\n\t\t{\n\t\t\tthis.onchange(this.delay);\n\t\t}\n\t}\n\n\tcreateAfterControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioAfter = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.After,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.After && delay.value > 0)\n\t\t{\n\t\t\tradioAfter.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_after',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.After && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelAfter = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_after')\n\t\t\t]\n\t\t});\n\n\t\tif (this.useAfterBasis)\n\t\t{\n\t\t\tlabelAfter.appendChild(Dom.create('span', {\n\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t}));\n\n\t\t\tlet basisField = this.getBasisField(delay.basis, true);\n\t\t\tlet basisValue = delay.basis;\n\t\t\tif (!basisField)\n\t\t\t{\n\t\t\t\tbasisField = this.getBasisField(DelayInterval.BASIS_TYPE.CurrentDateTime, true);\n\t\t\t\tbasisValue = basisField.SystemExpression;\n\t\t\t}\n\n\t\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: \"basis_after\",\n\t\t\t\t\tvalue: basisValue\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t\t},\n\t\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick(event)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onBasisClick(event, this, function(field)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t}, DelayInterval.DELAY_TYPE.After);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(beforeBasisValueNode);\n\t\t\tlabelAfter.appendChild(beforeBasisNode);\n\t\t}\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst afterHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_AFTER_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(afterHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioAfter, labelAfter]\n\t\t});\n\t}\n\n\tcreateBeforeControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioBefore = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.Before,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tradioBefore.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_before',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.Before && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelBefore = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_before'),\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_before\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t(field) => {\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tDelayInterval.DELAY_TYPE.Before\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tlabelBefore.appendChild(beforeBasisValueNode);\n\t\tlabelBefore.appendChild(beforeBasisNode);\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst beforeHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_BEFORE_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelBefore.appendChild(beforeHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioBefore, labelBefore]\n\t\t});\n\t}\n\n\tcreateInControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioIn = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.In,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tradioIn.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst labelIn = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis, true);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst inBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_in\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst inBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tfield => {\n\t\t\t\t\t\t\tinBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tinBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tDelayInterval.DELAY_TYPE.In\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tlabelIn.appendChild(inBasisValueNode);\n\t\tlabelIn.appendChild(inBasisNode);\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst helpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_IN_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelIn.appendChild(helpNode);\n\t\t}\n\n\t\tconst inTime = Tag.render`\n\t\t\t <span>\n\t\t\t \tTime: <input type=\"time\" value=\"${delay.inTimeString}\" name=\"basis_in_time\"/>\n\t\t\t</span>\n\t\t`;\n\n\t\t// Dom.append(inTime, labelIn); // TODO interface\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioIn, labelIn]\n\t\t});\n\t}\n\n\tcreateValueTypeSelector(name)\n\t{\n\t\tconst delay = this.delay;\n\t\tconst labelTexts = {\n\t\t\ti: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\th: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\td: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D')\n\t\t};\n\n\t\tconst label = Dom.create('label', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-link'},\n\t\t\ttext: labelTexts[delay.valueType],\n\t\t});\n\n\t\tconst input = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tname: name\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(label, 'click', this.onValueTypeSelectorClick.bind(this, label, input));\n\n\t\treturn Dom.create('span', {\n\t\t\tchildren: [label, input]\n\t\t});\n\t}\n\n\tonValueTypeSelectorClick(label, input)\n\t{\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst handler = function(event, item)\n\t\t{\n\t\t\tthis.popupWindow.close();\n\t\t\tinput.value = item.valueId;\n\t\t\tlabel.textContent = item.text;\n\t\t};\n\n\t\tconst menuItems = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\t\tvalueId: 'i',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\t\tvalueId: 'h',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D'),\n\t\t\t\tvalueId: 'd',\n\t\t\t\tonclick: handler\n\t\t\t}\n\t\t];\n\n\t\tMenuManager.show(\n\t\t\tuid,\n\t\t\tlabel,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 25,\n\t\t\t\tangle: { position: 'top'},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.valueTypeMenu = MenuManager.currentItem;\n\t}\n\n\tonBasisClick(event, labelNode, callback, delayType)\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (delayType === DelayInterval.DELAY_TYPE.After || delayType === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (\n\t\t\t\tdelayType !== DelayInterval.DELAY_TYPE.After\n\t\t\t\t&& this.basisFields[i]['Id'].indexOf('DATE_CREATE') > -1\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Text.encode(this.basisFields[i].Name),\n\t\t\t\tfield: this.basisFields[i],\n\t\t\t\tonclick(e, item)\n\t\t\t\t{\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(item.field || item.options.field);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tlet menuId = labelNode.getAttribute('data-menu-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tlabelNode.setAttribute('data-menu-id', menuId);\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tmenuId,\n\t\t\tlabelNode,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (BX.pos(labelNode)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.fieldsMenu = MenuManager.currentItem;\n\t}\n\n\tgetBasisField(basis, system)\n\t{\n\t\tif (system && (basis === DelayInterval.BASIS_TYPE.CurrentDateTime || basis === DelayInterval.BASIS_TYPE.CurrentDateTimeLocal))\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t};\n\t\t}\n\t\tif (system && basis === DelayInterval.BASIS_TYPE.CurrentDate)\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t};\n\t\t}\n\n\t\tlet field = null;\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (basis === this.basisFields[i].SystemExpression)\n\t\t\t{\n\t\t\t\tfield = this.basisFields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn field;\n\t}\n\n\tprepareBasisFields()\n\t{\n\t\tconst fields = [];\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tconst fld = this.basisFields[i];\n\t\t\tif (\n\t\t\t\tfld['Id'].indexOf('DATE_MODIFY') < 0\n\t\t\t\t&& fld['Id'].indexOf('EVENT_DATE') < 0\n\t\t\t\t&& fld['Id'].indexOf('BIRTHDATE') < 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tfields.push(fld);\n\t\t\t}\n\t\t}\n\n\t\tthis.basisFields = fields;\n\t}\n\n\t#createWaitWorkDayNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\t\tconst isAvailable = this.#isWorkTimeAvailable();\n\n\t\tconst workDayRadio = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\",\n\t\t\t\tid: uid + \"wait_workday\",\n\t\t\t\tname: \"wait_workday\",\n\t\t\t\tvalue: '1',\n\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tchecked: delay.waitWorkDay && isAvailable\n\t\t\t}\n\t\t});\n\n\t\tif (!isAvailable)\n\t\t{\n\t\t\tworkDayRadio.disabled = true;\n\t\t}\n\n\t\tconst workDayHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_DELAY_WAIT_WORK_DAY_HELP')\n\t\t\t}\n\t\t});\n\n\t\tconst events = {};\n\n\t\tif (!isAvailable)\n\t\t{\n\t\t\tevents.click = () => {\n\t\t\t\tif (top.BX.UI && top.BX.UI.InfoHelper)\n\t\t\t\t{\n\t\t\t\t\ttop.BX.UI.InfoHelper.show('limit_office_worktime_responsible');\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [ Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\tchildren: [\n\t\t\t\t\tworkDayRadio,\n\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tclassName: `bizproc-automation-popup-settings-lbl ${!isAvailable? 'bizproc-automation-robot-btn-set-locked' : ''}`,\n\t\t\t\t\t\t\tfor: uid + \"wait_workday\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_DELAY_WAIT_WORK_DAY_MSGVER_1')\n\t\t\t\t\t}),\n\t\t\t\t\tworkDayHelpNode\n\t\t\t\t]\n\t\t\t})],\n\t\t\tevents,\n\t\t});\n\t}\n\n\t#isWorkTimeAvailable(): boolean\n\t{\n\t\treturn getGlobalContext().get('IS_WORKTIME_AVAILABLE') ?? false;\n\t}\n}","import { Type } from 'main.core';\nimport { BaseContext } from './base-context';\nimport { Field } from '../selectors/types';\n\nexport class SelectorContext extends BaseContext\n{\n\tconstructor(props: {\n\t\tfields: Array<Field>,\n\t\tuseSwitcherMenu: boolean,\n\t\trootGroupTitle: string,\n\t})\n\t{\n\t\tsuper(props);\n\t}\n\n\tget fields(): Array<Field>\n\t{\n\t\tconst fields = this.get('fields');\n\n\t\treturn Type.isArray(fields) ? fields : [];\n\t}\n\n\tget useSwitcherMenu(): boolean\n\t{\n\t\treturn Type.isBoolean(this.get('useSwitcherMenu')) ? this.get('useSwitcherMenu') : false;\n\t}\n\n\tset useSwitcherMenu(value: boolean)\n\t{\n\t\tthis.set('useSwitcherMenu', value);\n\t}\n\n\tget rootGroupTitle(): string\n\t{\n\t\treturn this.get('rootGroupTitle') ?? '';\n\t}\n}","import {Type} from 'main.core';\nimport {Globals} from \"bizproc.globals\";\n\nexport class AutomationGlobals\n{\n\t#globalVariables: [] = [];\n\t#globalConstants: [] = [];\n\n\tconstructor(parameters: {\n\t\tvariables: ?[],\n\t\tconstants: ?[],\n\t})\n\t{\n\t\tif (Type.isArrayFilled(parameters.variables))\n\t\t{\n\t\t\tconst variables = [];\n\t\t\tparameters.variables.forEach((property) => {\n\t\t\t\tvariables.push(\n\t\t\t\t\tthis.#getAutomationGlobalsProperty(property.Id, property, Globals.Manager.Instance.mode.variable)\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tthis.#globalVariables = variables;\n\t\t}\n\n\t\tif (Type.isArrayFilled(parameters.constants))\n\t\t{\n\t\t\tconst constants = [];\n\t\t\tparameters.constants.forEach((property) => {\n\t\t\t\tconstants.push(\n\t\t\t\t\tthis.#getAutomationGlobalsProperty(property.Id, property, Globals.Manager.Instance.mode.constant)\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tthis.#globalConstants = constants;\n\t\t}\n\t}\n\n\tget globalVariables(): []\n\t{\n\t\treturn this.#globalVariables;\n\t}\n\n\tset globalVariables(variables: [])\n\t{\n\t\tif (!Type.isArray(variables))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#globalVariables = variables;\n\t}\n\n\tget globalConstants(): []\n\t{\n\t\treturn this.#globalConstants;\n\t}\n\n\tset globalConstants(constants: [])\n\t{\n\t\tif (!Type.isArray(constants))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#globalConstants = constants;\n\t}\n\n\t#isCorrectMode(mode): boolean\n\t{\n\t\treturn Type.isStringFilled(mode) && Object.values(Globals.Manager.Instance.mode).includes(mode);\n\t}\n\n\t#getAutomationGlobalsProperty(id: string, property: {}, mode: string): {\n\t\tObjectId: string,\n\t\tSuperTitle: string,\n\t\tId: string,\n\t\tName: string,\n\t\tType: string,\n\t\tBaseType: string,\n\t\tExpression: string,\n\t\tSystemExpression: string,\n\t\tOptions: any,\n\t\tMultiple: boolean,\n\t\tVisibility: string,\n\t}\n\t{\n\t\treturn {\n\t\t\tObjectId: this.#getObjectId(mode),\n\t\t\tSuperTitle: String(property.VisibilityName),\n\t\t\tId: String(id),\n\t\t\tName: String(property.Name),\n\t\t\tType: String(property.Type),\n\t\t\tBaseType: String(property.BaseType || property.Type),\n\t\t\tExpression:\n\t\t\t\tType.isStringFilled(property.Expression)\n\t\t\t\t\t? property.Expression\n\t\t\t\t\t: this.#getExpression(property.Name, property.VisibilityName)\n\t\t\t,\n\t\t\tSystemExpression:\n\t\t\t\tType.isStringFilled(property.SystemExpression)\n\t\t\t\t\t? property.SystemExpression\n\t\t\t\t\t: this.#getSystemExpression(mode, id)\n\t\t\t,\n\t\t\tOptions: property.Options,\n\t\t\tMultiple: Type.isBoolean(property.Multiple) ? property.Multiple : property.Multiple === 'Y',\n\t\t\tVisibility: String(property.Visibility),\n\t\t};\n\t}\n\n\t#getExpression(name, visibilityName): string\n\t{\n\t\treturn '{{' + String(visibilityName) + ': ' + String(name) + '}}'\n\t}\n\n\t#getSystemExpression(mode, id): string\n\t{\n\t\treturn '{=' + this.#getObjectId(mode) + ':' + String(id) + '}';\n\t}\n\n\t#getObjectId(mode): string\n\t{\n\t\treturn (mode === Globals.Manager.Instance.mode.variable) ? 'GlobalVar' : 'GlobalConst'\n\t}\n\n\tupdateGlobals(mode: string, updatedGlobals: {})\n\t{\n\t\tif (!this.#isCorrectMode(mode) || Object.keys(updatedGlobals).length < 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet globals = this.#getGlobals(mode);\n\n\t\tconst newGlobals = [];\n\t\tfor (const id in updatedGlobals)\n\t\t{\n\t\t\tconst property = updatedGlobals[id];\n\t\t\tconst index = globals.findIndex(prop => prop.Id === id);\n\t\t\tif (index > -1)\n\t\t\t{\n\t\t\t\tif (globals[index].Name !== property.Name)\n\t\t\t\t{\n\t\t\t\t\tglobals[index].Name = property.Name;\n\t\t\t\t\tglobals[index].Expression = this.#getExpression(property.Name, property.VisibilityName);\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnewGlobals.push(this.#getAutomationGlobalsProperty(id, property, mode));\n\t\t}\n\n\t\tif (Type.isArrayFilled(newGlobals))\n\t\t{\n\t\t\tglobals = globals.concat(newGlobals);\n\t\t}\n\n\t\tthis.#setGlobals(mode, globals);\n\t}\n\n\tdeleteGlobals(mode: string, deletedGlobals: [])\n\t{\n\t\tif (!this.#isCorrectMode(mode) || !Type.isArrayFilled(deletedGlobals))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst globals = this.#getGlobals(mode);\n\n\t\tdeletedGlobals.forEach((id) => {\n\t\t\tconst index = globals.findIndex((prop) => prop.Id === id);\n\t\t\tif (index > -1)\n\t\t\t{\n\t\t\t\tglobals.splice(index, 1);\n\t\t\t}\n\t\t});\n\n\t\tthis.#setGlobals(mode, globals);\n\t}\n\n\t#getGlobals(mode): []\n\t{\n\t\tif (mode === Globals.Manager.Instance.mode.variable)\n\t\t{\n\t\t\treturn this.globalVariables;\n\t\t}\n\n\t\tif (mode === Globals.Manager.Instance.mode.constant)\n\t\t{\n\t\t\treturn this.globalConstants;\n\t\t}\n\t}\n\n\t#setGlobals(mode, globals)\n\t{\n\t\tif (mode === Globals.Manager.Instance.mode.variable)\n\t\t{\n\t\t\tthis.#globalVariables = globals;\n\t\t}\n\n\t\tif (mode === Globals.Manager.Instance.mode.constant)\n\t\t{\n\t\t\tthis.#globalConstants = globals;\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {getGlobalContext, TrackingStatus, Template} from \"bizproc.automation\";\n\nexport class Statuses\n{\n\t#nodes: Array<HTMLElement> = [];\n\t#lastColorStatusIndex: number = -1;\n\t#defaultStatusColor: string = '#d4d6da';\n\n\tconstructor(stagesContainerNode: HTMLElement)\n\t{\n\t\tconst stagesContainer = stagesContainerNode.querySelector('.bizproc-automation-status-list');\n\t\tif (stagesContainer)\n\t\t{\n\t\t\tthis.#nodes = stagesContainer.querySelectorAll('[data-role=\"automation-status-title\"]');\n\t\t}\n\t}\n\n\tinit(templates: Array<Template>): void\n\t{\n\t\tconst context = getGlobalContext();\n\t\tif (context.document.getId() <= 0)\n\t\t{\n\t\t\tthis.#lastColorStatusIndex = this.#nodes.length - 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#lastColorStatusIndex = templates.findIndex((template) => (\n\t\t\t\ttemplate.getStatusId() === context.document.getCurrentStatusId()\n\t\t\t));\n\t\t}\n\t}\n\n\tfixColors(): void\n\t{\n\t\tthis.#fixBackgroundColors();\n\t\tthis.#fixTitleColors();\n\t}\n\n\t#fixBackgroundColors(): void\n\t{\n\t\tthis.#nodes.forEach((statusNode, index) => {\n\t\t\tconst backgroundNode = statusNode.querySelector('.bizproc-automation__status--bg');\n\n\t\t\tif (backgroundNode)\n\t\t\t{\n\t\t\t\tconst color = (\n\t\t\t\t\tthis.#isColorStatus(index) && statusNode.dataset.bgcolor\n\t\t\t\t\t\t? statusNode.dataset.bgcolor\n\t\t\t\t\t\t: this.#defaultStatusColor\n\t\t\t\t);\n\n\t\t\t\tDom.style(backgroundNode, {\n\t\t\t\t\tbackgroundColor: color,\n\t\t\t\t\tborderColor: color,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t#fixTitleColors(): void\n\t{\n\t\tthis.#nodes.forEach((statusNode, index) => {\n\t\t\tif (!this.#isColorStatus(index))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst backgroundColor = statusNode.dataset.bgcolor;\n\t\t\tif (backgroundColor)\n\t\t\t{\n\t\t\t\tconst bigint = parseInt(backgroundColor, 16);\n\t\t\t\tconst red = (bigint >> 16) & 255;\n\t\t\t\tconst green = (bigint >> 8) & 255;\n\t\t\t\tconst blue = bigint & 255;\n\n\t\t\t\tconst isDarkColor = 0.21 * red + 0.72 * green + 0.07 * blue < 145;\n\t\t\t\tif (isDarkColor)\n\t\t\t\t{\n\t\t\t\t\tDom.style(statusNode, 'color', 'white');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t#isColorStatus(index: number): boolean\n\t{\n\t\treturn index <= this.#lastColorStatusIndex;\n\t}\n}","import {Loc, Type, Text} from 'main.core';\nimport {Guide} from 'ui.tour';\n\nexport class BeginningGuide\n{\n\t#guide: Guide;\n\n\tconstructor(options: {target: HTMLElement, text?: string, article?: string})\n\t{\n\t\tif (!Type.isElementNode(options.target))\n\t\t{\n\t\t\tthrow 'options.target must be Node Element';\n\t\t}\n\n\t\tconst text =\n\t\t\tType.isStringFilled(options.text)\n\t\t\t\t? options.text\n\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_BEGINNING_SUBTITLE_1')\n\t\t;\n\t\tconst article = Type.isStringFilled(options.article) ? Text.toInteger(options.article) : '';\n\n\t\tthis.#guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: options.target,\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_BEGINNING_TITLE'),\n\t\t\t\t\ttext,\n\t\t\t\t\tarticle,\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\n\t\tthis.#guide.getPopup().setAutoHide(true);\n\t}\n\n\tstart()\n\t{\n\t\tthis.#guide.showNextStep();\n\t}\n}","import { Loc, Type, Text } from 'main.core';\nimport { Guide } from 'ui.tour';\n\nimport '../css/tourguide.css';\n\nexport class AutomationGuide\n{\n\t#isShownRobotGuide: boolean = true;\n\t#isShownTriggerGuide: boolean = true;\n\n\t#isShownSupportingRobotGuide: boolean = false;\n\n\t#showRobotGuide: boolean = false;\n\t#showTriggerGuide: boolean = false;\n\t#showSupportingRobotGuide: boolean = false;\n\n\t#guideTargets: {\n\t\ttrigger?: Element,\n\t\tsupportingRobot?: Element,\n\t\trobot?: Element,\n\t} = {};\n\n\tconstructor(options: {\n\t\tisShownRobotGuide: boolean,\n\t\tisShownTriggerGuide: boolean,\n\t})\n\t{\n\t\tif (Type.isBoolean(options.isShownRobotGuide))\n\t\t{\n\t\t\tthis.#isShownRobotGuide = options.isShownRobotGuide;\n\t\t}\n\t\tif (Type.isBoolean(options.isShownTriggerGuide))\n\t\t{\n\t\t\tthis.#isShownTriggerGuide = options.isShownTriggerGuide;\n\t\t}\n\t}\n\n\tget isShownRobotGuide(): boolean\n\t{\n\t\treturn this.#isShownRobotGuide;\n\t}\n\n\tget isShownTriggerGuide(): boolean\n\t{\n\t\treturn this.#isShownTriggerGuide;\n\t}\n\n\tsetShowRobotGuide(show: boolean, target?: Element)\n\t{\n\t\tthis.#showRobotGuide = show;\n\n\t\tif (show)\n\t\t{\n\t\t\tthis.#guideTargets['robot'] = target ?? null;\n\t\t}\n\t}\n\n\tsetShowTriggerGuide(show: boolean, target?: Element)\n\t{\n\t\tthis.#showTriggerGuide = show;\n\n\t\tif (show)\n\t\t{\n\t\t\tthis.#guideTargets['trigger'] = target ?? null;\n\t\t}\n\t}\n\n\tsetShowSupportingRobotGuide(show: boolean, target?: Element)\n\t{\n\t\tthis.#showSupportingRobotGuide = show;\n\n\t\tif (show)\n\t\t{\n\t\t\tthis.#guideTargets['supportingRobot'] = target ?? null;\n\t\t}\n\t}\n\n\t#resolveShowGuides()\n\t{\n\t\t// settings\n\t\tif (this.#isShownTriggerGuide)\n\t\t{\n\t\t\tthis.#showTriggerGuide = false;\n\t\t}\n\n\t\tif (this.#isShownSupportingRobotGuide)\n\t\t{\n\t\t\tthis.#showSupportingRobotGuide = false;\n\t\t\tthis.#isShownRobotGuide = true;\n\t\t}\n\n\t\tif (this.#isShownRobotGuide)\n\t\t{\n\t\t\tthis.#showRobotGuide = false;\n\t\t}\n\n\t\t// logic\n\t\tif (this.#showSupportingRobotGuide)\n\t\t{\n\t\t\tthis.#isShownRobotGuide = true;\n\t\t}\n\t}\n\n\t#getGuide(): ?Guide\n\t{\n\t\tlet guide = null;\n\n\t\tif (this.#showSupportingRobotGuide)\n\t\t{\n\t\t\tif (Type.isDomNode(this.#guideTargets['supportingRobot']))\n\t\t\t{\n\t\t\t\tguide = this.#getSupportingRobotGuide();\n\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t}\n\n\t\t\treturn guide;\n\t\t}\n\n\t\tif (this.#showTriggerGuide)\n\t\t{\n\t\t\tif (Type.isDomNode(this.#guideTargets['trigger']))\n\t\t\t{\n\t\t\t\tguide = this.#getTriggerGuide();\n\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t}\n\n\t\t\treturn guide;\n\t\t}\n\n\t\tif (this.#showRobotGuide)\n\t\t{\n\t\t\tif (Type.isDomNode(this.#guideTargets['robot']))\n\t\t\t{\n\t\t\t\tguide = this.#getRobotGuide();\n\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t}\n\n\t\t\treturn guide;\n\t\t}\n\n\t\treturn guide;\n\t}\n\n\tstart()\n\t{\n\t\tthis.#resolveShowGuides();\n\t\tconst guide = this.#getGuide();\n\t\tif (guide)\n\t\t{\n\t\t\tconst bindElement = guide.getCurrentStep().target;\n\t\t\tif (Type.isDomNode(bindElement) && document.body.contains(bindElement))\n\t\t\t{\n\t\t\t\tguide.showNextStep();\n\t\t\t}\n\t\t}\n\t}\n\n\t#getRobotGuide(): Guide\n\t{\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#guideTargets['robot'],\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_ROBOT_TITLE_1'),\n\t\t\t\t\ttext: this.constructor.#getText([\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_ROBOT_SUBTITLE_1'),\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_ROBOT_SUBTITLE_2')\n\t\t\t\t\t]),\n\t\t\t\t\tarticle: '16547618',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'onShow': () => {\n\t\t\t\t\t\t\tthis.#isShownRobotGuide = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\t}\n\n\t#getTriggerGuide(): Guide\n\t{\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#guideTargets['trigger'],\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_TRIGGER_TITLE_1'),\n\t\t\t\t\ttext: this.constructor.#getText([\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_TRIGGER_SUBTITLE_1'),\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_TRIGGER_SUBTITLE_2')\n\t\t\t\t\t]),\n\t\t\t\t\tarticle: '16547632',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'onShow': () => {\n\t\t\t\t\t\t\tthis.#isShownTriggerGuide = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\t}\n\n\t#getSupportingRobotGuide(): Guide\n\t{\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#guideTargets['supportingRobot'],\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_SUPPORTING_ROBOT_TITLE'),\n\t\t\t\t\ttext: this.constructor.#getText([\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_SUPPORTING_ROBOT_SUBTITLE_1'),\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_SUPPORTING_ROBOT_SUBTITLE_2'),\n\t\t\t\t\t]),\n\t\t\t\t\tarticle: '16547644',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'onShow': () => {\n\t\t\t\t\t\t\tthis.#isShownSupportingRobotGuide = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\t}\n\n\tstatic #getText(subtitles: Array): Element\n\t{\n\t\tlet text = `<ul class=\"bizproc-automation-tour-guide-list\">`;\n\n\t\tfor (const subtitle of subtitles)\n\t\t{\n\t\t\ttext += `<li class=\"bizproc-automation-tour-guide-list-item\"> ${Text.encode(subtitle)} </li>`;\n\t\t}\n\n\t\ttext += `</ul>`;\n\n\t\treturn text;\n\t}\n}","import TemplatesScheme from './templates-scheme';\nimport { Context } from './context/context';\n\nexport {TemplateScope} from './template-scope';\nexport {TriggerManager} from './trigger-manager';\nexport {Trigger} from './trigger';\nexport {Template} from './template';\nexport {Robot} from './robot';\nexport {UserOptions} from './user-options';\nexport {Document} from './document/document';\nexport {ViewMode} from './view-mode';\nexport {ConditionGroup} from './condition/condition-group';\nexport {ConditionGroupSelector} from './selectors/condition-group-selector';\nexport {Condition} from './condition/condition';\nexport {Designer} from './designer';\nexport * from './tracker/tracker';\nexport * from './workflow/types';\nexport {Manager as SelectorManager} from './selectors/manager';\nexport {InlineSelector} from './selectors/inline-selector';\nexport {InlineSelectorCondition} from './selectors/inline-selector-condition';\nexport {InlineSelectorHtml} from './selectors/inline-selector-html';\nexport {SaveStateCheckbox} from './selectors/save-state-checkbox';\nexport {UserSelector} from './selectors/user-selector';\nexport {FileSelector} from './selectors/file-selector';\nexport {TimeSelector} from './selectors/time-selector';\nexport {DelayInterval} from './delay-interval';\nexport {DelayIntervalSelector} from './delay-interval-selector';\nexport {HelpHint} from './help-hint';\nexport {SelectorContext} from './context/selector-context';\nexport {AutomationGlobals} from './automation-globals';\nexport {Statuses} from './statuses';\n\nexport {Helper} from './helper';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport './css/style.css'\n\nexport {\n\tTemplatesScheme,\n\tContext,\n}\n\nexport {BeginningGuide} from './tourguide/beginning-guide';\nexport {AutomationGuide} from './tourguide/automation-guide';\n\nlet contextInstance: ?Context;\n\nexport function getGlobalContext(): Context\n{\n\tif (contextInstance instanceof Context)\n\t{\n\t\treturn contextInstance;\n\t}\n\n\tthrow new Error('Context is not initialized yet');\n}\n\nexport function tryGetGlobalContext(): ?Context\n{\n\ttry\n\t{\n\t\treturn getGlobalContext();\n\t}\n\tcatch (error)\n\t{\n\t\treturn null;\n\t}\n}\n\nexport function setGlobalContext(context: Context): Context\n{\n\tif (context instanceof Context)\n\t{\n\t\tcontextInstance = context;\n\t}\n\telse\n\t{\n\t\tthrow new Error('Unsupported Context');\n\t}\n\n\treturn context;\n}"],"names":["TemplateScope","rawTemplateScope","DocumentType","Type","isNil","Category","Id","Status","hasCategory","isNull","TemplatesScheme","scheme","_classPrivateFieldInitSpec","isArray","forEach","rawScope","scope","push","documentTypes","Map","set","getDocumentType","Array","from","values","documentType","documentCategories","category","getDocumentCategory","documentCategory","takenStatuses","Set","predicate","shouldBeTaken","has","getDocumentStatus","add","map","generator","BaseContext","defaultValue","setEventNamespace","isPlainObject","clone","name","value","isValueChanged","emit","hasOwnProperty","listener","subscribe","event","data","EventEmitter","Context","props","Runtime","getValues","document","userOptions","code","availableTriggers","find","trigger","get","availableRobots","canManage","isBoolean","canEdit","tracker","ViewMode","mode","getAll","includes","none","Trigger","draft","ConditionGroup","viewMode","isString","id","parseInt","isNumber","Condition","edit","createNode","node","parentNode","replaceChild","getGlobalContext","String","statusList","status","STATUS_ID","getStatusId","triggerName","getCode","NAME","rules","log","getTriggerLog","getId","condition","flag","userId","isActive","manage","setProperty","checkboxNode","Tag","render","deleteButton","querySelector","Dom","hide","append","addClass","onclick","undefined","unselectNode","removeClass","remove","show","checked","isManage","hasClass","wrapperClass","isEdit","settingsBtn","copyBtn","create","attrs","className","text","Loc","getMessage","Event","bind","onCopyButtonClick","getLogStatus","TrackingStatus","COMPLETED","getPreviousStatusIdList","getName","containerClass","div","children","title","registerItem","deleteBtn","onDeleteButtonClick","appendChild","onSettingsButtonClick","getProperty","isSelected","selectNode","button","HelpHint","showNoPermissionsHint","stopPropagation","initData","serialize","clearRules","getSettingProperties","filter","property","Copyable","key","init","query","getData","queryString","match","toLowerCase","indexOf","object","onbxdragstart","BX","proxy","dragStart","onbxdrag","dragMove","onbxdragstop","dragStop","onbxdraghover","dragOver","jsDD","registerObject","registerDest","unregisterObject","unregisterDest","proxy_context","stopCurrentDrag","itemWidth","offsetWidth","cloneNode","style","position","classList","width","body","x","y","left","top","destination","type","getAttribute","window","isCopy","ctrlKey","metaKey","copyTrigger","parent","statusId","thisColumn","insertBefore","moveTo","skipInsert","removeChild","APPLY_RULES","items","length","triggerData","RETURN","SETTINGS","Properties","Helper","JSON","stringify","i","v","fields","field","Designer","dialog","robotSettingsDialog","robot","triggerSettingsDialog","_classStaticPrivateFieldSpecSet","TriggerManager","triggersContainerNode","_classPrivateMethodInitSpec","self","Promise","resolve","reject","ajax","method","dataType","url","ajaxUrl","ajax_action","document_signed","signedDocument","onsuccess","response","SUCCESS","reInit","TRIGGERS","DATA","triggers","onerror","isNone","querySelectorAll","initTriggers","markModified","columnNode","addCustomEvent","onRestAppInstall","clean","subscribeTriggerEvents","insertTriggerNode","openTriggerSettingsDialog","deleteTrigger","Object","entries","eventName","onSearch","listNode","dataset","enableManageMode","documentStatus","disableManageMode","callback","call","markDeleted","splice","unregisterItem","triggerNode","deleted","modified","context","getInstance","getTriggerSettingsDialog","changeTrigger","popup","close","formName","form","renderConditionSettings","iconHelp","events","click","getTriggerName","getAvailableTrigger","_classPrivateMethodGet","onCustomEvent","canSetExecuteBy","renderExecuteByControl","renderAllowBackwardsControl","setTriggerSettingsDialog","triggerManager","PopupWindow","generateUniqueId","titleBar","content","closeIcon","offsetLeft","offsetTop","closeByEsc","draggable","restrict","overlay","onPopupClose","destroySettingsDialogControls","destroy","buttons","PopupWindowButton","formData","prepareForm","setName","setConditionSettingsFromForm","setAllowBackwards","setExecuteBy","runAction","analyticsLabel","PopupWindowButtonLink","popupWindow","conditionGroup","getCondition","conditionSelector","ConditionGroupSelector","getFields","showValuesSelector","selector","Bizproc","FieldType","renderControl","getRawType","getCategoryId","getResponsibleUserExpression","getExecuteBy","isBackwardsAllowed","createTextNode","formFields","setCondition","createFromForm","installed","eventResult","redirect","setTimeout","settingsDialogControls","controlNodes","control","role","UserSelector","decorateNode","UI","Hint","isFunction","result","exists","getListByDocumentStatus","getReturnProperties","ObjectId","Name","ObjectName","Expression","SystemExpression","propertyId","properties","getApplyRules","toRenderProperty","AllowSelection","cmp","component","Options","Settings","Filter","check","templateManager","templates","template","robots","OptionNameProperty","setApplyRules","Fields","fieldPrefix","Text","getRandom","hookLinkTextarea","placeholder","readonly","select","Handler","location","protocol","host","Uri","addParam","replace","Password","PasswordLoader","myAlertText","passwordAlert","Alert","color","AlertColor","WARNING","icon","AlertIcon","getTextContainer","loaderConfig","runComponentAction","action","then","error","alert","password","handleCloseBtnClick","getContainer","menuId","Math","random","fieldName","fieldsList","renderFieldCheckbox","fieldSelectorHandler","targetNode","Main","MenuManager","getMenuById","menuItems","encode","item","autoHide","pos","angle","offset","zIndex","fieldListNode","ChooseFieldLabel","foundField","fld","Document","options","rawDocumentType","documentId","categoryId","findIndex","isStringFilled","documentFields","getCurrentStatusId","index","slice","newStatusId","isArrayFilled","DelayInterval","params","BASIS_TYPE","CurrentDateTime","DELAY_TYPE","After","setType","setValue","setValueType","setBasis","setWorkTime","setWaitWorkDay","setInTime","valueType","basis","workTime","waitWorkDay","inTime","Before","In","basisFields","workerExpression","CurrentDate","isSystemBasis","s","isNow","days","hours","minutes","fn","worker","emptyText","str","inTimeString","prefix","getFormattedPeriodLabel","fieldSuffix","label","labelIndex","labels","getPeriodLabels","CurrentDateTimeLocal","intervalString","toString","trimStart","h","d","substring","setTimeArgs","split","minute","pop","trim","hour","join","fnArgs","re","exec","found","period","element","bindToNode","showHint","hideHint","popupHint","bindElement","isSameNode","rawText","util","nl2br","lightShadow","darkMode","bindOptions","html","setAngle","showAngleHint","timeout","clearTimeout","createInstance","popupParameters","height","getPosition","WorkflowStatus","TrackingEntry","TRIGGER_ACTIVITY_TYPE","entryType","getAllActivityTypes","entryWorkflowStatus","getAllWorkflowStatuses","UNKNOWN_ACTIVITY_TYPE","EXECUTE_ACTIVITY_TYPE","CLOSE_ACTIVITY_TYPE","CANCEL_ACTIVITY_TYPE","FAULT_ACTIVITY_TYPE","CUSTOM_ACTIVITY_TYPE","REPORT_ACTIVITY_TYPE","ATTACHED_ENTITY_TYPE","ERROR_ACTIVITY_TYPE","DEBUG_ACTIVITY_TYPE","DEBUG_AUTOMATION_TYPE","DEBUG_DESIGNER_TYPE","DEBUG_LINK_TYPE","typeId","CREATED","RUNNING","SUSPENDED","TERMINATED","RobotEntry","WAITING","entry","addEntry","datetime","workflowStatus","errors","note","notes","TriggerEntry","isTriggerEntry","TrackingEntryBuilder","workflowId","logEntry","assign","isKnownActivityType","isKnownWorkflowStatus","Tracker","addLogs","logEntryBuilder","rawEntry","setLogEntry","build","addTriggerEntry","addRobotEntry","robotEntry","isRobotRunning","isWorkflowCompleted","isCurrentStatus","isRobotRunningAtAnotherStatus","isRobotRunningAndCurrentWorkflowCompleted","documentSigned","LOG","Robot","isFrameMode","clonedRobot","robotData","generateName","Delay","getDelayInterval","other","Activated","toBoolean","CONDITION_TYPE","Mixed","getProperties","getRobotLog","DelayName","activated","targetLabel","isView","viewData","responsibleLabel","labelText","getReturnFieldsDescription","getTitle","globalVariables","variable","globalConstants","constant","textContent","setAttribute","responsibleUrl","href","responsibleId","delayLabel","format","isExecuteAfterPrevious","delayNode","statusNode","subscribeOnce","isBindedToNode","delayNotes","getDelayNotes","AUTOCOMPLETED","getLogErrors","titleClassName","clipTitle","onTitleEditClick","lastChild","actionsButton","deleteRobot","openRobotSettingsDialog","DialogContext","copiedRobot","robotTitle","newTitle","Template","copyRobotTo","getNextRobot","e","preventDefault","nameNode","elements","fullTitle","arrTitle","lastWord","delay","ExecuteAfterPrevious","draggableItem","stub","droppableItem","droppableColumn","templateNode","beforeRobot","insertRobot","insertRobotNode","getDescriptionTitle","description","getRobotDescription","isObject","hasReturnProperties","hasAdditionalResultProperties","some","addProperty","fieldId","appendPropertyMods","printableTag","expression","usages","Constant","Variable","Parameter","GlobalConstant","GlobalVariable","Activity","collectExpressions","conditions","collectParsedExpressions","systemExpressionRegExp","RegExp","SYSTEM_EXPRESSION_PATTERN","groups","parsedUsage","activityRegExp","getBrokenLinks","collectUsages","objectsData","getConstants","getVariables","getParameters","getSerializedRobots","brokenLinks","size","source","searchInSource","brokenLinkObject","getRobotById","getReturnProperty","buttonText","menu","Menu","menuItem","setActivated","isActivated","UserOptions","storedValue","save","constants","variables","templateContainerNode","delayMinLimitM","CONSTANTS","PARAMETERS","VARIABLES","DOCUMENT_STATUS","markExternalModified","fromRaw","initRobots","initButtons","isExternalModified","ROBOTS","selectedRobots","activatedRobots","deactivatedRobots","serialized","ID","isNaN","createExternalLocker","createManageModeButton","getTemplateId","createConstantsEditButton","createParametersEditButton","createExternalEditTemplateButton","bizprocEditorUrl","anchor","onExternalEditTemplateButtonClick","target","manageButton","cursor","onManageModeButtonClick","manageButtonNode","constantsEditorUrl","parametersEditorUrl","onUnsetExternalModifiedClick","onExternalModifiedSearch","InfoHelper","templateId","openBizprocEditor","intoRaw","Title","parentRobot","isEqual","robotNode","beforeNode","saveCallback","getRobotSettingsDialog","changeRobot","setRobotSettingsDialog","renderDelaySettings","robotBrokenLinks","renderBrokenLinkAlert","addMenuGroup","document_status","robot_json","toJsonString","form_name","dialogRows","showRobotSettingsPopup","popupMinWidth","popupWidth","initRobotSettingsControls","descriptionTitle","hasTitle","titleBarContent","bindAll","me","resizable","minWidth","minHeight","destroyRobotSettingsControls","onPopupResize","onResizeRobotSettings","onPopupResizeEnd","getWidth","isNewRobot","saveRobotSettings","delegate","buttonNode","robotSettingsControls","initRobotSettingsControl","controlNode","controlProps","SelectorContext","useSwitcherMenu","rootGroupTitle","needSync","checkbox","SelectorManager","SELECTOR_ROLE_USER","fieldProperty","parse","SELECTOR_ROLE_FILE","createSelectorByRole","SELECTOR_ROLE_SAVE_STATE","renderTo","onFieldSelect","addConstant","addParameter","onOpenMenu","onBeforeSave","idSalt","delayTypeNode","delayValueNode","delayValueTypeNode","delayBasisNode","delayWorkTimeNode","delayWaitWorkDayNode","delayInTimeNode","delayIntervalLabelNode","docFields","minLimitM","delayIntervalSelector","DelayIntervalSelector","labelNode","onchange","useAfterBasis","showWaitWorkDay","executeAfterPreviousBlock","hasTemplate","executeAfterPreviousCheckbox","setDelayInterval","setExecuteAfterPrevious","onOpenFieldMenu","moreInfoNode","showMoreLabel","bindOnce","scrollHeight","closeBtn","btnNode","onBeforeSaveRobotSettings","form_data_json","form_data","updateData","setDelaySettingsFromForm","ERRORS","externalModified","keys","generatePropertyId","getConstant","Description","param","parameter","getParameter","existsList","robotUsages","usage","unsubscribe","automationGlobals","dstTemplate","copyTo","additionalFields","flat","ask","tabs","sort","skipRobot","isMixedCondition","robotMenuItems","customData","addGroup","supertitle","SuperTitle","gVariables","skipId","templateRobot","hasReturnFields","group","parentGroup","setObject","setField","setOperator","operator","Operator","EQUAL","NOT_EQUAL","Field","addItem","clonedGroup","joiner","clonedCondition","itemsArray","activityNames","Branch1","Branch2","valueIndex","BETWEEN","JOINER","And","Or","message","ConditionSelector","conditionObjectNode","objectNode","conditionFieldNode","fieldNode","conditionOperatorNode","operatorNode","valueNode","conditionValueNode","conditionValueNode2","value2","conditionJoinerNode","joinerNode","setLabelText","bindLabelNode","removeButtonNode","removeCondition","joinerButtonNode","changeJoiner","getField","valueLabel","getOperatorLabel","EMPTY","onLabelClick","showPopup","filterFields","objectSelect","fieldSelect","fieldSelectLabel","onFieldSelectorClick","selectedField","valueInput","valueWrapper","operatorSelect","createOperatorNode","operatorWrapper","onFieldChange","backgroundColor","firstChild","valueInputs","input","updateValueNode","fieldDialog","globalContext","InlineSelectorCondition","fireEvent","openMenu","isDomNode","conditionWrapper","getOperators","onOperatorChange","tpl","getTemplate","getGVariable","foundRobot","fieldType","multiple","allLabels","getAllLabels","list","NOT_EMPTY","CONTAIN","NOT_CONTAIN","IN","NOT_IN","GREATER_THEN","GREATER_THEN_OR_EQUAL","LESS_THEN","LESS_THEN_OR_EQUAL","filtered","docField","currentDocument","docType","Multiple","valueNodes","renderControlPublic","targetInput","parseTargetProperties","operatorList","operatorId","btn","formatValuePrintable","valueNode1","createValueNode","valueNode2","conditionNodes","getItems","Manager","selectorProps","FileSelector","SELECTOR_ROLE_INLINE","InlineSelector","SELECTOR_ROLE_INLINE_HTML","InlineSelectorHtml","SELECTOR_ROLE_TIME","TimeSelector","SaveStateCheckbox","InlineTimeSelector","isElementNode","time","getFormat","formatId","Date","convertBitrixFormat","dateFormat","dateTimeFormat","date","setHours","DateTimeFormat","getTime","maxHeight","groupId","hasGroup","menuButton","replaceOnWrite","renderWith","propertyType","skipPropertiesSwitcher","openPropertiesSwitcherMenu","fillGroups","onMenuOpen","Dialog","dropdownMode","enableSearch","injectDialogMenuTitles","showAvatars","getCustomData","compactView","fillFieldsGroups","fillFileGroup","searchable","groupKey","groupName","names","shift","addGroupItem","fileFields","disabled","currentItem","injectDialogMenuSupertitles","child","inputType","tagName","expressionOption","selected","hiddenInput","getElementById","selectionEnd","beforePart","middlePart","afterPart","substr","printablePrefix","custom","printableName","printableField","serverField","responsibleField","childGroup","entityId","toExpression","fromString","timeSelector","keyCode","altKey","shiftKey","exp","bindTargetEvents","firstElementChild","insertText","editor","InsertHtml","synchro","IsFocusedOnTextarea","textareaView","Focus","WrapWith","Sync","SaveContent","ResizeSceleton","handler","removeCustomEvent","dom","cont","header","footer","cutHeader","shouldSaveHeader","cutFooter","shouldSaveFooter","editorId","BXHtmlEditor","Get","savedState","additionalUserFields","userSelector","TYPE","None","config","File","required","valueInputName","typeInputName","useDisk","labelFile","labelDisk","fileItem","setValues","ids","Disk","childNodes","fileRadio","fileTypeOptions","diskFileRadio","diskUploader","layout","addItems","addButtonNode","Automation","DiskUploader","msg","setMode","newType","SIZE","VIEW_URL","itemNode","itemField","closeWnd","setTime","constructor","showClock","CClockSelector","start_time","Show","timeParts","part","timeFormat","prepareBasisFields","showDelayIntervalPopup","uid","radioNow","labelNow","labelNowHelpNode","createAfterControlNode","createBeforeControlNode","createInControlNode","workTimeRadio","workTimeHelpNode","saveFormData","FormData","fieldsMenu","valueTypeMenu","setNow","Notification","Center","notify","radioAfter","labelAfter","createValueTypeSelector","basisField","getBasisField","basisValue","beforeBasisValueNode","beforeBasisNode","onBasisClick","afterHelpNode","radioBefore","labelBefore","beforeHelpNode","radioIn","labelIn","inBasisValueNode","inBasisNode","helpNode","labelTexts","onValueTypeSelectorClick","valueId","delayType","delimiter","system","isAvailable","workDayRadio","workDayHelpNode","AutomationGlobals","parameters","Globals","Instance","updatedGlobals","globals","newGlobals","prop","VisibilityName","concat","deletedGlobals","BaseType","Visibility","visibilityName","Statuses","stagesContainerNode","stagesContainer","backgroundNode","bgcolor","borderColor","bigint","red","green","blue","isDarkColor","BeginningGuide","article","toInteger","Guide","steps","bottom","onEvents","getPopup","setAutoHide","showNextStep","AutomationGuide","isShownRobotGuide","isShownTriggerGuide","guide","getCurrentStep","contains","subtitles","subtitle","contextInstance","Error","tryGetGlobalContext","setGlobalContext"],"mappings":"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"}