{"version":3,"file":"automation.bundle.js","sources":["../src/template_scope.js","../src/templates_scheme.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { DocumentType, DocumentCategory, DocumentStatus } from './document/types';\n\nexport class TemplateScope\n{\n\t#documentType: DocumentType;\n\t#category: DocumentCategory | null;\n\t#status: DocumentStatus;\n\n\tconstructor(rawTemplateScope: {\n\t\tDocumentType: {\n\t\t\tType: string,\n\t\t\tName: string,\n\t\t},\n\t\tCategory: {\n\t\t\tId: string | null,\n\t\t\tName: string | null,\n\t\t},\n\t\tStatus: {\n\t\t\tId: string,\n\t\t\tName: string,\n\t\t\tColor: string,\n\t\t}\n\t})\n\t{\n\t\tthis.#documentType = rawTemplateScope.DocumentType;\n\t\tthis.#category = !Type.isNil(rawTemplateScope.Category.Id) ? rawTemplateScope.Category : null;\n\t\tthis.#status = rawTemplateScope.Status;\n\t}\n\n\tgetId()\n\t{\n\t\tif (this.hasCategory())\n\t\t{\n\t\t\treturn `${this.#documentType.Type}_${this.#category.Id}_${this.#status.Id}`;\n\t\t}\n\n\t\treturn `${this.#documentType.Type}_${this.#status.Id}`;\n\t}\n\n\tgetDocumentType(): DocumentType\n\t{\n\t\treturn this.#documentType;\n\t}\n\n\tgetDocumentCategory(): DocumentCategory\n\t{\n\t\treturn this.#category;\n\t}\n\n\tgetDocumentStatus(): DocumentStatus\n\t{\n\t\treturn this.#status;\n\t}\n\n\thasCategory(): boolean\n\t{\n\t\treturn !Type.isNull(this.#category);\n\t}\n}","import {Type} from 'main.core';\nimport {DocumentType, DocumentCategory, DocumentStatus} from './document/types';\nimport {TemplateScope} from './template_scope';\n\nexport default class TemplatesScheme\n{\n\t#scheme: Array<TemplateScope>;\n\n\tconstructor(scheme: Array<TemplateScope>)\n\t{\n\t\tthis.#scheme = [];\n\n\t\tif (Type.isArray(scheme))\n\t\t{\n\t\t\tscheme.forEach(rawScope => {\n\t\t\t\tconst scope = new TemplateScope(rawScope);\n\t\t\t\tthis.#scheme.push(scope);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetDocumentTypes(): Array<DocumentType>\n\t{\n\t\tconst documentTypes = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tdocumentTypes.set(scope.getDocumentType().Type, scope.getDocumentType());\n\t\t}\n\n\t\treturn Array.from(documentTypes.values());\n\t}\n\n\tgetTypeCategories(documentType: DocumentType): Array<DocumentCategory>\n\t{\n\t\tconst documentCategories = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tif (scope.hasCategory() && scope.getDocumentType().Type === documentType.Type)\n\t\t\t{\n\t\t\t\tconst category = scope.getDocumentCategory();\n\t\t\t\tdocumentCategories.set(category.Id, category);\n\t\t\t}\n\t\t}\n\n\t\treturn Array.from(documentCategories.values());\n\t}\n\n\tgetTypeStatuses(documentType: DocumentType, documentCategory: DocumentCategory | null): Array<DocumentStatus>\n\t{\n\t\tconst takenStatuses = new Set();\n\t\tif (Type.isNil(documentCategory))\n\t\t{\n\t\t\tdocumentCategory = {Id: null};\n\t\t}\n\n\t\tconst predicate = scope => {\n\t\t\tconst shouldBeTaken = (\n\t\t\t\tscope.getDocumentType().Type === documentType.Type\n\t\t\t\t&& (scope.hasCategory() ? scope.getDocumentCategory().Id === documentCategory.Id : true)\n\t\t\t\t&& !takenStatuses.has(scope.getDocumentStatus().Id)\n\t\t\t);\n\n\t\t\tif (shouldBeTaken)\n\t\t\t{\n\t\t\t\ttakenStatuses.add(scope.getDocumentStatus().Id);\n\t\t\t}\n\n\t\t\treturn shouldBeTaken;\n\t\t};\n\n\t\treturn Array.from(this.#filterBy(predicate)).map(scope => scope.getDocumentStatus());\n\t}\n\n\t#filterBy(predicate: (TemplateScope) => boolean): Iterable<TemplateScope>\n\t{\n\t\tconst generator = function*(scheme)\n\t\t{\n\t\t\tfor (const scope of scheme)\n\t\t\t{\n\t\t\t\tif (predicate(scope))\n\t\t\t\t{\n\t\t\t\t\tyield scope;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn generator(this.#scheme);\n\t}\n}"],"names":["TemplateScope","rawTemplateScope","DocumentType","Type","isNil","Category","Id","Status","hasCategory","isNull","TemplatesScheme","scheme","isArray","forEach","rawScope","scope","push","documentTypes","Map","set","getDocumentType","Array","from","values","documentType","documentCategories","category","getDocumentCategory","documentCategory","takenStatuses","Set","predicate","shouldBeTaken","has","getDocumentStatus","add","map","generator"],"mappings":"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"}