{"version":3,"file":"automation.bundle.js","sources":["../src/template-scope.js","../src/templates-scheme.js","../src/view-mode.js","../src/trigger.js","../src/help-hint.js","../src/helper.js","../src/designer.js","../src/trigger-manager.js","../src/document/document.js","../src/delay-interval.js","../src/workflow/types.js","../src/tracker/tracking-entry.js","../src/tracker/types.js","../src/tracker/robot-entry.js","../src/tracker/trigger-entry.js","../src/tracker/tracking-entry-builder.js","../src/tracker/tracker.js","../src/robot.js","../src/user-options.js","../src/template.js","../src/condition/condition.js","../src/condition/condition-group.js","../src/condition/condition-selector.js","../src/condition/condition-group-selector.js","../src/delay-interval-selector.js","../src/context/context.js","../src/context/automation-context.js","../src/automation.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { DocumentType, DocumentCategory, DocumentStatus } from './document/types';\n\nexport class TemplateScope\n{\n\t#documentType: DocumentType;\n\t#category: DocumentCategory | null;\n\t#status: DocumentStatus;\n\n\tconstructor(rawTemplateScope: {\n\t\tDocumentType: {\n\t\t\tType: string,\n\t\t\tName: string,\n\t\t},\n\t\tCategory: {\n\t\t\tId: string | null,\n\t\t\tName: string | null,\n\t\t},\n\t\tStatus: {\n\t\t\tId: string,\n\t\t\tName: string,\n\t\t\tColor: string,\n\t\t}\n\t})\n\t{\n\t\tthis.#documentType = rawTemplateScope.DocumentType;\n\t\tthis.#category = !Type.isNil(rawTemplateScope.Category.Id) ? rawTemplateScope.Category : null;\n\t\tthis.#status = rawTemplateScope.Status;\n\t}\n\n\tgetId()\n\t{\n\t\tif (this.hasCategory())\n\t\t{\n\t\t\treturn `${this.#documentType.Type}_${this.#category.Id}_${this.#status.Id}`;\n\t\t}\n\n\t\treturn `${this.#documentType.Type}_${this.#status.Id}`;\n\t}\n\n\tgetDocumentType(): DocumentType\n\t{\n\t\treturn this.#documentType;\n\t}\n\n\tgetDocumentCategory(): DocumentCategory\n\t{\n\t\treturn this.#category;\n\t}\n\n\tgetDocumentStatus(): DocumentStatus\n\t{\n\t\treturn this.#status;\n\t}\n\n\thasCategory(): boolean\n\t{\n\t\treturn !Type.isNull(this.#category);\n\t}\n}","import {Type} from 'main.core';\nimport {DocumentType, DocumentCategory, DocumentStatus} from './document/types';\nimport {TemplateScope} from './template-scope';\n\nexport default class TemplatesScheme\n{\n\t#scheme: Array<TemplateScope>;\n\n\tconstructor(scheme: Array<TemplateScope>)\n\t{\n\t\tthis.#scheme = [];\n\n\t\tif (Type.isArray(scheme))\n\t\t{\n\t\t\tscheme.forEach(rawScope => {\n\t\t\t\tconst scope = new TemplateScope(rawScope);\n\t\t\t\tthis.#scheme.push(scope);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetDocumentTypes(): Array<DocumentType>\n\t{\n\t\tconst documentTypes = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tdocumentTypes.set(scope.getDocumentType().Type, scope.getDocumentType());\n\t\t}\n\n\t\treturn Array.from(documentTypes.values());\n\t}\n\n\tgetTypeCategories(documentType: DocumentType): Array<DocumentCategory>\n\t{\n\t\tconst documentCategories = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tif (scope.hasCategory() && scope.getDocumentType().Type === documentType.Type)\n\t\t\t{\n\t\t\t\tconst category = scope.getDocumentCategory();\n\t\t\t\tdocumentCategories.set(category.Id, category);\n\t\t\t}\n\t\t}\n\n\t\treturn Array.from(documentCategories.values());\n\t}\n\n\tgetTypeStatuses(documentType: DocumentType, documentCategory: DocumentCategory | null): Array<DocumentStatus>\n\t{\n\t\tconst takenStatuses = new Set();\n\t\tif (Type.isNil(documentCategory))\n\t\t{\n\t\t\tdocumentCategory = {Id: null};\n\t\t}\n\n\t\tconst predicate = scope => {\n\t\t\tconst shouldBeTaken = (\n\t\t\t\tscope.getDocumentType().Type === documentType.Type\n\t\t\t\t&& (scope.hasCategory() ? scope.getDocumentCategory().Id === documentCategory.Id : true)\n\t\t\t\t&& !takenStatuses.has(scope.getDocumentStatus().Id)\n\t\t\t);\n\n\t\t\tif (shouldBeTaken)\n\t\t\t{\n\t\t\t\ttakenStatuses.add(scope.getDocumentStatus().Id);\n\t\t\t}\n\n\t\t\treturn shouldBeTaken;\n\t\t};\n\n\t\treturn Array.from(this.#filterBy(predicate)).map(scope => scope.getDocumentStatus());\n\t}\n\n\t#filterBy(predicate: (TemplateScope) => boolean): Iterable<TemplateScope>\n\t{\n\t\tconst generator = function*(scheme)\n\t\t{\n\t\t\tfor (const scope of scheme)\n\t\t\t{\n\t\t\t\tif (predicate(scope))\n\t\t\t\t{\n\t\t\t\t\tyield scope;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn generator(this.#scheme);\n\t}\n}","export class ViewMode\n{\n\t#mode: number;\n\t#properties: Object;\n\n\tstatic #none = 0;\n\tstatic #view = 1;\n\tstatic #edit = 2;\n\tstatic #manage = 3;\n\n\tconstructor(mode: number)\n\t{\n\t\tthis.#mode = mode;\n\t\tthis.#properties = {};\n\t}\n\n\tstatic none(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#none)\n\t}\n\n\tisNone(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#none;\n\t}\n\n\tstatic view(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#view);\n\t}\n\n\tisView(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#view;\n\t}\n\n\tstatic edit(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#edit);\n\t}\n\n\tisEdit(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#edit;\n\t}\n\n\tstatic manage(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#manage);\n\t}\n\n\tisManage(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#manage;\n\t}\n\n\tsetProperty(name: string, value: any): ViewMode\n\t{\n\t\tthis.#properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetProperty(name: string, defaultValue: any = null): ?any\n\t{\n\t\tif (this.#properties.hasOwnProperty(name))\n\t\t{\n\t\t\treturn this.#properties[name];\n\t\t}\n\n\t\treturn defaultValue;\n\t}\n\n\tstatic fromRaw(mode: number): ViewMode\n\t{\n\t\tif (ViewMode.getAll().includes(mode))\n\t\t{\n\t\t\treturn new ViewMode(mode);\n\t\t}\n\n\t\treturn ViewMode.none();\n\t}\n\n\tintoRaw(): number\n\t{\n\t\treturn this.#mode;\n\t}\n\n\tstatic getAll(): Array<number>\n\t{\n\t\treturn [\n\t\t\tthis.#none,\n\t\t\tthis.#view,\n\t\t\tthis.#edit,\n\t\t\tthis.#manage,\n\t\t];\n\t}\n}\n","import { clone, Type, Dom, Loc, Event } from \"main.core\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { getGlobalContext, ConditionGroup, TrackingStatus, HelpHint } from \"bizproc.automation\";\n\nexport class Trigger extends EventEmitter\n{\n\tdraft: boolean;\n\n\t#data: Object<string, any>;\n\t#deleted: boolean;\n\t#viewMode: ViewMode;\n\t#condition: ConditionGroup;\n\t#node: ?HTMLDivElement;\n\t#draggableItem: ?HTMLElement;\n\t#droppableItem: ?HTMLElement;\n\t#droppableColumn: ?HTMLElement;\n\t#stub: ?HTMLElement;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.draft = false;\n\t\tthis.#data = {};\n\t\tthis.#deleted = false;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#condition = new ConditionGroup();\n\t}\n\n\tget node(): HTMLDivElement\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget deleted(): boolean\n\t{\n\t\treturn this.#deleted;\n\t}\n\n\tget documentStatus(): string\n\t{\n\t\treturn this.#data['DOCUMENT_STATUS'] ?? '';\n\t}\n\n\tinit(data: Object<string, any>, viewMode: ?ViewMode): void\n\t{\n\t\tthis.#data = clone(data);\n\n\t\tif (!Type.isPlainObject(this.#data['APPLY_RULES']))\n\t\t{\n\t\t\tthis.#data['APPLY_RULES'] = {};\n\t\t}\n\n\t\tif (this.#data['APPLY_RULES'].Condition)\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup(this.#data['APPLY_RULES'].Condition);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup();\n\t\t}\n\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tthis.#node = this.createNode();\n\t}\n\n\treInit(data: Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.#data['ID'] || 0;\n\t}\n\n\tgetStatusId(): string\n\t{\n\t\treturn this.#data['DOCUMENT_STATUS'] || '';\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.#data['CODE'] ?? '';\n\t}\n\n\tgetName(): string\n\t{\n\t\tlet triggerName = this.#data['NAME'];\n\t\tif (!triggerName)\n\t\t{\n\t\t\tconst code = this.getCode();\n\t\t\tconst trigger = getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE']);\n\t\t\ttriggerName = trigger?.NAME ?? code;\n\t\t}\n\n\t\treturn triggerName;\n\t}\n\n\tsetName(name: string): this\n\t{\n\t\tif (Type.isString(name))\n\t\t{\n\t\t\tthis.#data['NAME'] = name;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetApplyRules()\n\t{\n\t\treturn this.#data['APPLY_RULES'];\n\t}\n\n\tsetApplyRules(rules: Object): this\n\t{\n\t\tthis.#data['APPLY_RULES'] = rules;\n\n\t\treturn this;\n\t}\n\n\tgetLogStatus()\n\t{\n\t\tconst log = getGlobalContext().tracker.getTriggerLog(this.getId());\n\t\treturn log ? log.status : null;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition: ConditionGroup): this\n\t{\n\t\tthis.#condition = condition;\n\t\treturn this;\n\t}\n\n\tisBackwardsAllowed(): boolean\n\t{\n\t\treturn this.#data['APPLY_RULES']['ALLOW_BACKWARDS'] === 'Y';\n\t}\n\n\tsetAllowBackwards(flag: boolean): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ALLOW_BACKWARDS'] = flag ? 'Y' : 'N';\n\n\t\treturn this;\n\t}\n\n\tgetExecuteBy(): string\n\t{\n\t\treturn this.#data['APPLY_RULES']['ExecuteBy'] || '';\n\t}\n\n\tsetExecuteBy(userId: number): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ExecuteBy'] = userId;\n\n\t\treturn this;\n\t}\n\n\tcreateNode()\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-trigger-item-wrapper';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-draggable';\n\t\t}\n\n\t\tlet settingsBtn = null;\n\t\tlet copyBtn = null;\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tsettingsBtn = Dom.create(\"div\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-trigger-item-wrapper-edit\"\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tcopyBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-trigger-btn-copy'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY') || 'copy'\n\t\t\t});\n\n\t\t\tEvent.bind(copyBtn, 'click', this.onCopyButtonClick.bind(this, copyBtn));\n\t\t}\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete';\n\t\t}\n\t\telse if (getGlobalContext().document.getPreviousStatusIdList().includes(this.getStatusId()))\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete-light';\n\t\t}\n\n\t\tconst triggerName = this.getName();\n\n\t\tlet containerClass = 'bizproc-automation-trigger-item';\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\tcontainerClass += ' --complete';\n\t\t}\n\n\t\tconst div = Dom.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'trigger-container',\n\t\t\t\t'className': containerClass,\n\t\t\t\t'data-type': 'item-trigger'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-trigger-item-wrapper-text\" },\n\t\t\t\t\t\t\ttext: triggerName\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\tcopyBtn,\n\t\t\t\tsettingsBtn\n\t\t\t]\n\t\t});\n\n\t\tif (!this.#viewMode.isEdit())\n\t\t{\n\t\t\treturn div;\n\t\t}\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'btn-delete-trigger',\n\t\t\t\t'className': 'bizproc-automation-trigger-btn-delete',\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\n\t\tdiv.appendChild(deleteBtn);\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\t\t}\n\n\t\treturn div;\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.emit('Trigger:onSettingsOpen', {trigger: this});\n\t\t}\n\t}\n\n\tonCopyButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = this.serialize();\n\t\t\tdelete initData['ID'];\n\t\t\t//TODO: refactoring\n\t\t\tif (initData['CODE'] === 'WEBHOOK')\n\t\t\t{\n\t\t\t\tinitData['APPLY_RULES'] = {};\n\t\t\t}\n\t\t\ttrigger.init(initData, this.#viewMode);\n\t\t\tthis.emit('Trigger:copied', {trigger});\n\t\t}\n\t}\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getName().toLowerCase().indexOf(query) >= 0;\n\n\t\tDom[match ? 'removeClass' : 'addClass'](this.#node, '--search-mismatch');\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.#draggableItem = BX.proxy_context;\n\n\t\tif (!this.#draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#stub)\n\t\t{\n\t\t\tconst itemWidth = this.#draggableItem.offsetWidth;\n\t\t\tthis.#stub = this.#draggableItem.cloneNode(true);\n\t\t\tthis.#stub.style.position = \"absolute\";\n\t\t\tthis.#stub.classList.add(\"bizproc-automation-trigger-item-drag\");\n\t\t\tthis.#stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.#stub);\n\t\t}\n\t}\n\n\tdragMove(x, y)\n\t{\n\t\tthis.#stub.style.left = x + \"px\";\n\t\tthis.#stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-trigger\")\n\t\t{\n\t\t\tthis.#droppableItem = destination;\n\t\t\tthis.#droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-trigger\")\n\t\t{\n\t\t\tthis.#droppableColumn = destination.querySelector('[data-role=\"trigger-list\"]');\n\t\t\tthis.#droppableItem = null;\n\t\t}\n\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.add(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.add(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tlet trigger = null;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\t\tconst copyTrigger = (parent, statusId) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = parent.serialize();\n\t\t\tdelete initData['ID'];\n\t\t\t//TODO: refactoring\n\t\t\tif (initData['CODE'] === 'WEBHOOK')\n\t\t\t{\n\t\t\t\tinitData['APPLY_RULES'] = {};\n\t\t\t}\n\t\t\tinitData['DOCUMENT_STATUS'] = statusId;\n\t\t\ttrigger.init(initData, parent.#viewMode);\n\n\t\t\treturn trigger;\n\t\t};\n\n\t\tif (this.#draggableItem)\n\t\t{\n\t\t\tif (this.#droppableItem)\n\t\t\t{\n\t\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t\t\tconst thisColumn = this.#droppableItem.parentNode;\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthisColumn.insertBefore(this.#draggableItem, this.#droppableItem);\n\t\t\t\t\tthis.moveTo(thisColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, thisColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthisColumn.insertBefore(trigger.#node, this.#droppableItem);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.#droppableColumn)\n\t\t\t{\n\t\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthis.#droppableColumn.appendChild(this.#draggableItem);\n\t\t\t\t\tthis.moveTo(this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthis.#droppableColumn.appendChild(trigger.#node);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (trigger)\n\t\t\t{\n\t\t\t\tthis.emit('Trigger:copied', {\n\t\t\t\t\ttrigger,\n\t\t\t\t\tskipInsert: true,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.#stub.parentNode.removeChild(this.#stub);\n\t\tthis.#stub = null;\n\t\tthis.#draggableItem = null;\n\t\tthis.#droppableItem = null;\n\t}\n\n\tonDeleteButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(button.parentNode);\n\t\t\tthis.emit('Trigger:deleted', {trigger: this});\n\t\t}\n\t}\n\n\tupdateData(data: Object<string, any>): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tmarkDeleted(): this\n\t{\n\t\tthis.#deleted = true;\n\n\t\treturn this;\n\t}\n\n\tserialize(): Object<string, any>\n\t{\n\t\tconst data = clone(this.#data);\n\t\tif (this.#deleted)\n\t\t{\n\t\t\tdata['DELETED'] = 'Y';\n\t\t}\n\n\t\tif (!Type.isPlainObject(data.APPLY_RULES))\n\t\t{\n\t\t\tdata.APPLY_RULES = {};\n\t\t}\n\n\t\tif (!this.#condition.items.length)\n\t\t{\n\t\t\tdelete data.APPLY_RULES.Condition;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdata.APPLY_RULES.Condition = this.#condition.serialize();\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tmoveTo(statusId)\n\t{\n\t\tthis.#data['DOCUMENT_STATUS'] = statusId;\n\t\tthis.emit('Trigger:modified', {trigger: this});\n\t}\n\n\tgetReturnProperties()\n\t{\n\t\tconst triggerData = getGlobalContext().availableTriggers.find(trigger => trigger['CODE'] === this.getCode());\n\n\t\treturn triggerData && Type.isArray(triggerData.RETURN) ? triggerData.RETURN : [];\n\t}\n}","import { Event, Text, Type, Dom, Loc } from 'main.core';\n\nexport class HelpHint\n{\n\tstatic popupHint;\n\tstatic timeout;\n\n\tstatic bindAll(node)\n\t{\n\t\tnode.querySelectorAll('[data-text]').forEach((element) => HelpHint.bindToNode(element));\n\t}\n\n\tstatic bindToNode(node)\n\t{\n\t\tEvent.bind(node, 'mouseover', this.showHint.bind(this, node));\n\t\tEvent.bind(node, 'mouseout', this.hideHint.bind(this));\n\t}\n\n\tstatic isBindedToNode(node): boolean\n\t{\n\t\treturn !!this.popupHint?.bindElement?.isSameNode(node);\n\t}\n\n\tstatic showHint(node)\n\t{\n\t\tconst rawText = node.getAttribute('data-text');\n\t\tif (!rawText)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet text = Text.encode(rawText);\n\t\ttext = BX.util.nl2br(text);\n\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.hideHint();\n\n\t\tthis.popupHint = new BX.PopupWindow('bizproc-automation-help-tip', node, {\n\t\t\tlightShadow: true,\n\t\t\tautoHide: false,\n\t\t\tdarkMode: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 2,\n\t\t\tbindOptions: {position: \"top\"},\n\t\t\tevents : {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent : Dom.create('div', {\n\t\t\t\tattrs : {\n\t\t\t\t\tstyle : 'padding-right: 5px; width: 250px;'\n\t\t\t\t},\n\t\t\t\thtml: text\n\t\t\t}),\n\t\t});\n\t\tthis.popupHint.setAngle({offset: 32, position: 'bottom'});\n\t\tthis.popupHint.show();\n\n\t\treturn true;\n\t}\n\n\tstatic showNoPermissionsHint(node)\n\t{\n\t\tthis.showAngleHint(node, Loc.getMessage('BIZPROC_AUTOMATION_RIGHTS_ERROR'));\n\t}\n\n\tstatic showAngleHint(node, text)\n\t{\n\t\tif (this.timeout)\n\t\t{\n\t\t\tclearTimeout(this.timeout);\n\t\t}\n\n\t\tthis.popupHint = BX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {\n\t\t\t\twidth: 334,\n\t\t\t\theight: 104,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tangle: {offset: Dom.getPosition(node).width / 2},\n\t\t\t\tbindOptions: {position: 'top'},\n\t\t\t}\n\t\t});\n\n\t\tthis.popupHint.close = function ()\n\t\t{\n\t\t\tthis.hide();\n\t\t};\n\t\tthis.popupHint.show(node, text);\n\t\tthis.timeout = setTimeout(this.hideHint.bind(this), 5000);\n\t}\n\n\tstatic hideHint()\n\t{\n\t\tif (this.popupHint)\n\t\t{\n\t\t\tthis.popupHint.close();\n\t\t}\n\t\tthis.popupHint = null;\n\t}\n}","import { Type } from \"main.core\";\n\nexport class Helper\n{\n\tstatic #idIncrement = 0;\n\n\tstatic generateUniqueId()\n\t{\n\t\t++Helper.#idIncrement;\n\t\treturn 'bizproc-automation-cmp-' + Helper.#idIncrement;\n\t}\n\n\tstatic toJsonString(data)\n\t{\n\t\treturn JSON.stringify(data, function (i, v)\n\t\t{\n\t\t\tif (typeof(v) == 'boolean')\n\t\t\t{\n\t\t\t\treturn v ? '1' : '0';\n\t\t\t}\n\t\t\treturn v;\n\t\t});\n\t}\n\n\tstatic getResponsibleUserExpression(fields: Array<Object>): ?string\n\t{\n\t\tif (Type.isArray(fields))\n\t\t{\n\t\t\tfor (const field of fields)\n\t\t\t{\n\t\t\t\tif (field['Id'] === 'ASSIGNED_BY_ID' || field['Id'] === 'RESPONSIBLE_ID')\n\t\t\t\t{\n\t\t\t\t\treturn '{{'+field['Name']+'}}';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n}","export class Designer\n{\n\tstatic #instance;\n\n\trobotSettingsDialog;\n\tcomponent;\n\trobot;\n\ttriggerSettingsDialog;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Designer.#instance)\n\t\t{\n\t\t\tDesigner.#instance = new Designer();\n\t\t}\n\n\t\treturn Designer.#instance;\n\t}\n\n\tsetRobotSettingsDialog(dialog)\n\t{\n\t\tthis.robotSettingsDialog = dialog;\n\t\tthis.robot = dialog ? dialog.robot : null;\n\t}\n\n\tgetRobotSettingsDialog()\n\t{\n\t\treturn this.robotSettingsDialog;\n\t}\n\n\tsetTriggerSettingsDialog(dialog)\n\t{\n\t\tthis.triggerSettingsDialog = dialog;\n\t}\n\n\tgetTriggerSettingsDialog()\n\t{\n\t\treturn this.triggerSettingsDialog;\n\t}\n}","import { Type, Event, Loc, Dom, Text, Reflection, Uri } from \"main.core\";\nimport { MenuManager } from \"main.popup\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { Trigger } from \"./trigger\";\nimport { HelpHint } from \"./help-hint\";\nimport { Helper } from \"./helper\";\nimport { Designer } from \"./designer\";\nimport { getGlobalContext, ConditionGroup, ConditionGroupSelector } from \"bizproc.automation\";\n\nexport class TriggerManager extends EventEmitter\n{\n\t#triggersContainerNode: HTMLElement;\n\t#viewMode: ViewMode;\n\t#triggers: Array<Trigger>;\n\t#triggersData: Array<Object<string, any>>;\n\t#columnNodes: NodeList;\n\t#listNodes: NodeList;\n\t#buttonsNodes: NodeList;\n\t#modified: boolean;\n\n\tconstructor(triggersContainerNode: HTMLElement)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#triggersContainerNode = triggersContainerNode;\n\t}\n\n\tinit(data: ?Object<string, any>, viewMode: ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode.isNone() ? ViewMode.edit() : viewMode;\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\t\tthis.#columnNodes = document.querySelectorAll('[data-type=\"column-trigger\"]');\n\t\tthis.#listNodes = this.#triggersContainerNode.querySelectorAll('[data-role=\"trigger-list\"]');\n\t\tthis.#buttonsNodes = this.#triggersContainerNode.querySelectorAll('[data-role=\"trigger-buttons\"]');\n\t\tthis.#modified = false;\n\t\tthis.initButtons();\n\t\tthis.initTriggers();\n\n\t\tthis.markModified(false);\n\n\t\t//register DD\n\t\tthis.#columnNodes.forEach(columnNode => jsDD.registerDest(columnNode, 10));\n\n\t\ttop.BX.addCustomEvent(\n\t\t\ttop,\n\t\t\t'Rest:AppLayout:ApplicationInstall',\n\t\t\tthis.onRestAppInstall.bind(this)\n\t\t);\n\t}\n\n\treInit(data: ?Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode || ViewMode.none();\n\t\tthis.#listNodes.forEach(node => Dom.clean(node));\n\t\tthis.#buttonsNodes.forEach(node => Dom.clean(node));\n\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\n\t\tthis.initTriggers();\n\t\tthis.initButtons();\n\n\t\tthis.markModified(false);\n\t}\n\n\tinitTriggers()\n\t{\n\t\tthis.#triggers = [];\n\t\tthis.#triggersData.forEach((triggerData) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\ttrigger.init(triggerData, this.#viewMode);\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\tthis.#triggers.push(trigger);\n\t\t});\n\t}\n\n\tsubscribeTriggerEvents(trigger: Trigger)\n\t{\n\t\ttrigger.subscribe('Trigger:copied', (event) => {\n\t\t\tconst trigger = event.data.trigger;\n\n\t\t\tthis.#triggers.push(trigger);\n\t\t\tif (!event.data.skipInsert)\n\t\t\t{\n\t\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\t}\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.markModified();\n\t\t});\n\t\ttrigger.subscribe('Trigger:modified', () => this.markModified());\n\t\ttrigger.subscribe('Trigger:onSettingsOpen', (event) => {\n\t\t\tthis.openTriggerSettingsDialog(event.data.trigger);\n\t\t});\n\t\ttrigger.subscribe('Trigger:deleted', (event) => this.deleteTrigger(event.data.trigger));\n\n\t}\n\n\tonSearch(event)\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.onSearch(event));\n\t}\n\n\tinitButtons()\n\t{\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tthis.#buttonsNodes.forEach(node => this.createAddButton(node));\n\t\t}\n\t}\n\n\tenableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.manage();\n\t\tconst deleteButtons = document.querySelectorAll('[data-role=\"btn-delete-trigger\"]');\n\t\tdeleteButtons.forEach(node => Dom.hide(node));\n\n\t\tthis.#triggers.forEach(trigger => Dom.addClass(trigger.node, '--locked-node'));\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tconst deleteButtons = document.querySelectorAll('[data-role=\"btn-delete-trigger\"]');\n\t\tdeleteButtons.forEach(node => Dom.show(node));\n\n\t\tthis.#triggers.forEach(trigger => Dom.removeClass(trigger.node, '--locked-node'));\n\t}\n\n\tcreateAddButton(containerNode: HTMLElement)\n\t{\n\t\tconst self = this;\n\t\tconst div = Dom.create('span', {\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tif (!self.canEdit())\n\t\t\t\t\t{\n\t\t\t\t\t\tHelpHint.showNoPermissionsHint(this);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!self.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onAddButtonClick(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-btn-add',\n\t\t\t\t'data-status-id': containerNode.getAttribute('data-status-id'),\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-btn-add-text',\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ADD'),\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tcontainerNode.appendChild(div);\n\t}\n\n\tonAddButtonClick(button: HTMLElement, context: Object<string, any>)\n\t{\n\t\tconst self = this;\n\t\tconst onMenuClick = function(event, item)\n\t\t{\n\t\t\tself.addTrigger(item.triggerData, function(trigger)\n\t\t\t{\n\t\t\t\tthis.openTriggerSettingsDialog(trigger, context);\n\t\t\t});\n\n\t\t\tthis.popupWindow.close();\n\t\t};\n\n\t\tconst menuItems = [];\n\t\tgetGlobalContext().availableTriggers.forEach((availableTrigger) => {\n\t\t\tif (availableTrigger.CODE === 'APP')\n\t\t\t{\n\t\t\t\tmenuItems.push(this.createAppTriggerMenuItem(\n\t\t\t\t\tbutton.getAttribute('data-status-id'),\n\t\t\t\t\tavailableTrigger,\n\t\t\t\t));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: availableTrigger.NAME,\n\t\t\t\t\ttriggerData: {\n\t\t\t\t\t\tDOCUMENT_STATUS: button.getAttribute('data-status-id') || context.statusId,\n\t\t\t\t\t\tCODE: availableTrigger.CODE\n\t\t\t\t\t},\n\t\t\t\t\tonclick: onMenuClick\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tMenuManager.show(\n\t\t\tHelper.generateUniqueId(),\n\t\t\tbutton,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (Dom.getPosition(button)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\tevents : {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonChangeTriggerClick(statusId: string, event)\n\t{\n\t\tthis.onAddButtonClick(event.target, {changeTrigger: true, statusId: statusId});\n\t}\n\n\tcreateAppTriggerMenuItem(status, triggerData)\n\t{\n\t\tconst self = this;\n\t\tconst onMenuClick = function(e, item)\n\t\t{\n\t\t\tself.addTrigger(item.triggerData, function(trigger)\n\t\t\t{\n\t\t\t\tthis.openTriggerSettingsDialog(trigger);\n\t\t\t});\n\n\t\t\tthis.getRootMenuWindow().close();\n\t\t};\n\n\t\tconst menuItems = [];\n\t\tfor (let i = 0; i < triggerData['APP_LIST'].length; ++i)\n\t\t{\n\t\t\tconst item = triggerData['APP_LIST'][i];\n\t\t\tconst itemName = '[' + item['APP_NAME'] + '] ' + item['NAME'];\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Text.encode(itemName),\n\t\t\t\ttriggerData: {\n\t\t\t\t\tDOCUMENT_STATUS: status,\n\t\t\t\t\tNAME: itemName,\n\t\t\t\t\tCODE: triggerData.CODE,\n\t\t\t\t\tAPPLY_RULES: {\n\t\t\t\t\t\tAPP_ID: item['APP_ID'],\n\t\t\t\t\t\tCODE: item['CODE']\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonclick: onMenuClick\n\t\t\t});\n\t\t}\n\n\t\tif (Reflection.getClass('BX.rest.Marketplace'))\n\t\t{\n\t\t\tif (menuItems.length)\n\t\t\t{\n\t\t\t\tmenuItems.push({ delimiter: true });\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER_MARKETPLACE_2'),\n\t\t\t\tonclick: function()\n\t\t\t\t{\n\t\t\t\t\tBX.rest.Marketplace.open({PLACEMENT: getGlobalContext().get('marketplaceRobotCategory')});\n\t\t\t\t\tthis.getRootMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\ttext: triggerData.NAME,\n\t\t\titems: menuItems\n\t\t}\n\t}\n\n\taddTrigger(triggerData: ?Object<string, any>, callback)\n\t{\n\t\tconst trigger = new Trigger();\n\t\ttrigger.init(triggerData, this.#viewMode);\n\t\tthis.subscribeTriggerEvents(trigger);\n\t\ttrigger.draft = true;\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, trigger);\n\t\t}\n\t}\n\n\tdeleteTrigger(trigger: Trigger, callback)\n\t{\n\t\tif (trigger.getId() > 0)\n\t\t{\n\t\t\ttrigger.markDeleted();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(let i = 0; i < this.#triggers.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#triggers[i] === trigger)\n\t\t\t\t{\n\t\t\t\t\tthis.#triggers.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback(trigger);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.registerItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.addClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.unregisterItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tinsertTriggerNode(documentStatus: string, triggerNode)\n\t{\n\t\tconst listNode = this.#triggersContainerNode.querySelector('[data-role=\"trigger-list\"][data-status-id=\"'+documentStatus+'\"]');\n\t\tif (listNode)\n\t\t{\n\t\t\tlistNode.appendChild(triggerNode);\n\t\t}\n\t}\n\n\tserialize(): Array<Object<string, any>>\n\t{\n\t\treturn this.#triggers.map(trigger => trigger.serialize());\n\t}\n\n\tcountAllTriggers(): number\n\t{\n\t\treturn this.#triggers.filter(trigger => !trigger.deleted).length;\n\t}\n\n\tgetTriggerName(code: string)\n\t{\n\t\treturn getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE'])?.NAME ?? code;\n\t}\n\n\tgetAvailableTrigger(code): ?Object\n\t{\n\t\tconst availableTriggers = getGlobalContext().availableTriggers;\n\t\tfor (let i = 0; i < availableTriggers.length; ++i)\n\t\t{\n\t\t\tif (code === availableTriggers[i]['CODE'])\n\t\t\t{\n\t\t\t\treturn availableTriggers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tcanSetExecuteBy(): boolean\n\t{\n\t\treturn getGlobalContext().get('TRIGGER_CAN_SET_EXECUTE_BY') ?? false;\n\t}\n\n\tneedSave()\n\t{\n\t\treturn this.#modified;\n\t}\n\n\tmarkModified(modified: boolean)\n\t{\n\t\tthis.#modified = modified !== false;\n\t\tif (this.#modified)\n\t\t{\n\t\t\tthis.emit('TriggerManager:dataModified');\n\t\t}\n\t}\n\n\topenTriggerSettingsDialog(trigger, context)\n\t{\n\t\tif (Designer.getInstance().getTriggerSettingsDialog())\n\t\t{\n\t\t\tif (context && context.changeTrigger)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getTriggerSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_trigger_dialog';\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tform.appendChild(this.renderConditionSettings(trigger));\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {click: (event) => this.emit('TriggerManager:onHelpClick', event)}\n\t\t});\n\t\tform.appendChild(iconHelp);\n\n\t\tconst title = this.getTriggerName(trigger.getCode());\n\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_NAME') + ':'\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: trigger.getName() || title\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t],\n\t\t}));\n\n\t\t//TODO: refactoring\n\t\tconst triggerData = this.getAvailableTrigger(trigger.getCode());\n\t\tif (trigger.getCode() === 'WEBHOOK')\n\t\t{\n\t\t\tif (!trigger.getApplyRules()['code'])\n\t\t\t{\n\t\t\t\ttrigger.getApplyRules()['code'] = Text.getRandom(5);\n\t\t\t}\n\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: \"URL:\"\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create('input', {\n\t\t\t\tprops: {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tvalue: trigger.getApplyRules()['code'],\n\t\t\t\t\tname: 'code'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tconst hookLinkTextarea = Dom.create(\"textarea\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-textarea\",\n\t\t\t\t\tplaceholder: \"...\",\n\t\t\t\t\treadonly: 'readonly',\n\t\t\t\t\tname: 'webhook_handler'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [hookLinkTextarea]\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_WEBHOOK_ID'),\n\t\t\t}));\n\n\t\t\tif (triggerData && triggerData['HANDLER'])\n\t\t\t{\n\t\t\t\tlet url = window.location.protocol + '//' + window.location.host + triggerData['HANDLER'];\n\t\t\t\turl = Uri.addParam(url, {code: trigger.getApplyRules()['code']});\n\t\t\t\turl = url.replace('{{DOCUMENT_TYPE}}', getGlobalContext().document.getRawType()[2]);\n\t\t\t\thookLinkTextarea.value = url;\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'EMAIL_LINK')\n\t\t{\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_EMAIL_LINK_URL') + ':',\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create(\"textarea\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tclassName: \"bizproc-automation-popup-textarea\",\n\t\t\t\t\t\t\tplaceholder: \"https://example.com\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprops: {name: 'url'},\n\t\t\t\t\t\ttext: trigger.getApplyRules()['url'] || ''\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}));\n\t\t}\n\t\telse if (trigger.getCode() === 'WEBFORM')\n\t\t{\n\t\t\tif (triggerData && triggerData['WEBFORM_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'form_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY')\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['WEBFORM_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['WEBFORM_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['form_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['form_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'CALLBACK')\n\t\t{\n\t\t\tif (triggerData && triggerData['WEBFORM_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'form_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['WEBFORM_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['WEBFORM_LIST'][i];\n\t\t\t\t\tselect.appendChild(\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['form_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['form_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_LABEL') + ':'}),\n\t\t\t\t\t\tselect\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'STATUS')\n\t\t{\n\t\t\tif (triggerData && triggerData['STATUS_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'STATUS',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_STATUS_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['STATUS_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['STATUS_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['STATUS'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['STATUS'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: triggerData['STATUS_LABEL'] + ':'}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tselect\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() == 'CALL')\n\t\t{\n\t\t\tif (triggerData && triggerData['LINES'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'LINE_NUMBER',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['LINES'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['LINES'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['LINE_NUMBER']},\n\t\t\t\t\t\ttext: item['SHORT_NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (trigger.getApplyRules()['LINE_NUMBER'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['LINE_NUMBER'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_CALL_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() == 'OPENLINE' || trigger.getCode() == 'OPENLINE_MSG')\n\t\t{\n\t\t\tif (triggerData && triggerData['CONFIG_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'config_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY')\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['CONFIG_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['CONFIG_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['config_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['config_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_OPENLINE_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\n\t\tBX.onCustomEvent(\n\t\t\t'BX.Bizproc.Automation.TriggerManager:onOpenSettingsDialog-' + trigger.getCode(),\n\t\t\t[trigger, form]\n\t\t);\n\n\t\tif (this.canSetExecuteBy())\n\t\t{\n\t\t\tthis.renderExecuteByControl(trigger, form);\n\t\t}\n\n\t\tthis.renderAllowBackwardsControl(trigger, form);\n\n\t\tDom.addClass(this.#triggersContainerNode, 'automation-base-blocked');\n\n\t\tDesigner.getInstance().setTriggerSettingsDialog({\n\t\t\ttriggerManager: this,\n\t\t\ttrigger: trigger,\n\t\t\tform: form\n\t\t});\n\n\t\tconst titleBar = trigger.draft ? this.createChangeTriggerTitleBar(title, trigger.documentStatus) : null;\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(BX.Bizproc.Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: titleBar || title,\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function(popup)\n\t\t\t\t{\n\t\t\t\t\tDesigner.getInstance().setTriggerSettingsDialog(null);\n\t\t\t\t\tself.destroySettingsDialogControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tDom.removeClass(self.#triggersContainerNode, 'automation-base-blocked');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick() {\n\t\t\t\t\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\t\t\t\t\ttrigger.setName(formData['data']['name']);\n\n\t\t\t\t\t\t\t//TODO: refactoring\n\t\t\t\t\t\t\tif (trigger.getCode() === 'WEBFORM')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({form_id:  formData['data']['form_id']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'CALLBACK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({form_id: formData['data']['form_id']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'STATUS')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({STATUS: formData['data']['STATUS']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'CALL' && 'LINE_NUMBER' in formData['data'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({LINE_NUMBER: formData['data']['LINE_NUMBER']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'OPENLINE' || trigger.getCode() === 'OPENLINE_MSG')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({config_id: formData['data']['config_id']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.getCode() === 'WEBHOOK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({code: formData['data']['code']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.getCode() === 'EMAIL_LINK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({url: formData['data']['url']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\t\t\t\t'BX.Bizproc.Automation.TriggerManager:onSaveSettings-'+trigger.getCode(),\n\t\t\t\t\t\t\t\t[trigger, formData]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tself.setConditionSettingsFromForm(formData['data'], trigger);\n\t\t\t\t\t\t\ttrigger.setAllowBackwards(formData['data']['allow_backwards'] === 'Y');\n\n\t\t\t\t\t\t\tif (self.canSetExecuteBy())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setExecuteBy(formData['data']['execute_by']);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.draft)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#triggers.push(trigger);\n\t\t\t\t\t\t\t\tself.insertTriggerNode(trigger.getStatusId(), trigger.node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelete trigger.draft;\n\n\t\t\t\t\t\t\ttrigger.reInit();\n\t\t\t\t\t\t\tself.markModified();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tDesigner.getInstance().getTriggerSettingsDialog().popup = popup;\n\t\tpopup.show();\n\t}\n\n\tcreateChangeTriggerTitleBar(title, statusId)\n\t{\n\t\treturn {\n\t\t\tcontent: Dom.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'popup-window-titlebar-text bizproc-automation-popup-titlebar-with-link'\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tdocument.createTextNode(title),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-titlebar-link'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHANGE_TRIGGER'),\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: this.onChangeTriggerClick.bind(this, statusId)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t};\n\t}\n\n\trenderConditionSettings(trigger: Trigger)\n\t{\n\t\tconst conditionGroup = trigger.getCondition().clone();\n\n\t\tthis.conditionSelector = new ConditionGroupSelector(\n\t\t\tconditionGroup,\n\t\t\t{fields: getGlobalContext().document.getFields()},\n\t\t);\n\t\tconst selector = this.conditionSelector;\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\",\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselector.createNode(),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\trenderExecuteByControl(trigger, form)\n\t{\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-top bizproc-automation-popup-settings-title-autocomplete\",\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_EXECUTE_BY') + ':',\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tBX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tgetGlobalContext().document.getRawType(),\n\t\t\t\t\t{\n\t\t\t\t\t\tType: 'user'\n\t\t\t\t\t},\n\t\t\t\t\t'execute_by',\n\t\t\t\t\ttrigger.draft\n\t\t\t\t\t\t? Helper.getResponsibleUserExpression(getGlobalContext().document.getFields())\n\t\t\t\t\t\t: trigger.getExecuteBy()\n\t\t\t\t),\n\t\t\t],\n\t\t}));\n\t}\n\n\trenderAllowBackwardsControl(trigger, form)\n\t{\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox-item\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-chk-label\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-chk',\n\t\t\t\t\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\t\t\t\t\tname: \"allow_backwards\",\n\t\t\t\t\t\t\t\t\t\tvalue: 'Y'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tchecked: trigger.isBackwardsAllowed()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdocument.createTextNode(Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_ALLOW_REVERSE')),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t}));\n\t}\n\n\tsetConditionSettingsFromForm(formFields: Object,  trigger: Trigger): this\n\t{\n\t\ttrigger.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\tonRestAppInstall(installed, eventResult)\n\t{\n\t\teventResult.redirect = false;\n\t\tconst self = this;\n\n\t\tsetTimeout(function()\n\t\t{\n\t\t\tBX.ajax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: getGlobalContext().ajaxUrl,\n\t\t\t\tdata: {\n\t\t\t\t\tajax_action: 'get_available_triggers',\n\t\t\t\t\tdocument_signed: getGlobalContext().signedDocument\n\t\t\t\t},\n\t\t\t\tonsuccess(response)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isArray(response['DATA']))\n\t\t\t\t\t{\n\t\t\t\t\t\tgetGlobalContext().set('availableTriggers', response['DATA']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}, 1500);\n\t}\n\n\tinitSettingsDialogControls(node)\n\t{\n\t\tif (!Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tthis.settingsDialogControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tlet control = null;\n\t\t\tconst role = controlNodes[i].getAttribute('data-role');\n\n\t\t\tif (role === 'user-selector')\n\t\t\t{\n\t\t\t\tcontrol = BX.Bizproc.UserSelector.decorateNode(controlNodes[i]);\n\t\t\t}\n\n\t\t\tBX.UI.Hint.init(controlNodes[i]);\n\n\t\t\tif (control)\n\t\t\t{\n\t\t\t\tthis.settingsDialogControls.push(control);\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroySettingsDialogControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.settingsDialogControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.settingsDialogControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.settingsDialogControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.settingsDialogControls = null;\n\t}\n\n\tgetListByDocumentStatus(statusId): Array<Trigger>\n\t{\n\t\tconst result = [];\n\t\tthis.#triggers.forEach((trigger) => {\n\t\t\tif (trigger.getStatusId() === statusId)\n\t\t\t{\n\t\t\t\tresult.push(trigger);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperties(statusId): Array<Object>\n\t{\n\t\tconst result = [];\n\t\tconst exists = {};\n\t\tconst triggers = this.getListByDocumentStatus(statusId);\n\n\t\ttriggers.forEach((trigger) => {\n\t\t\tconst props = trigger.deleted ? [] : trigger.getReturnProperties();\n\t\t\tif (props.length)\n\t\t\t{\n\t\t\t\tprops.forEach((property) => {\n\t\t\t\t\tif (!exists[property.Id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tId: property.Id,\n\t\t\t\t\t\t\tObjectId: 'Template',\n\t\t\t\t\t\t\tName: property.Name,\n\t\t\t\t\t\t\tObjectName: trigger.getName(),\n\t\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\t\tExpression: '{{~*:'+property.Id+'}}',\n\t\t\t\t\t\t\tSystemExpression: '{=Template:'+property.Id+'}'\n\t\t\t\t\t\t});\n\t\t\t\t\t\texists[property.Id] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperty(statusId, propertyId): ?Object\n\t{\n\t\tconst properties = this.getReturnProperties(statusId);\n\t\tfor (let i = 0; i < properties.length; ++i)\n\t\t{\n\t\t\tif (properties[i].Id === propertyId)\n\t\t\t{\n\t\t\t\treturn properties[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { Type } from 'main.core';\n\nexport class Document\n{\n\t#rawType: Array<string>;\n\t#id: number;\n\t#title: ?string;\n\t#categoryId: ?number;\n\t#statusList: ?Array<Object>;\n\t#currentStatusIndex: number;\n\n\t#fields: ?Array<Object>;\n\n\tconstructor(options: {\n\t\trawDocumentType: Array<string>,\n\t\tdocumentId: number,\n\t\tcategoryId?: number,\n\t\tstatusId?: string,\n\n\t\tstatusList: Array<Object>,\n\n\t\tdocumentFields?: Array<Object>;\n\t\ttitle?: string,\n\t})\n\t{\n\t\tthis.#rawType = options.rawDocumentType;\n\t\tthis.#id = options.documentId;\n\t\tthis.#title = options.title;\n\t\tthis.#categoryId = options.categoryId;\n\n\t\tthis.#statusList = [];\n\t\tthis.#currentStatusIndex = 0;\n\t\tif (Type.isArray(options.statusList))\n\t\t{\n\t\t\tthis.#statusList = options.statusList\n\t\t\tthis.#currentStatusIndex = this.#statusList.findIndex(status => status.STATUS_ID === options.statusId)\n\t\t}\n\t\telse if (Type.isStringFilled(options.statusId))\n\t\t{\n\t\t\tthis.#statusList.push(options.statusId);\n\t\t}\n\n\t\tif (this.#currentStatusIndex < 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = 0;\n\t\t}\n\n\t\tthis.#fields = Type.isArray(options.documentFields) ? options.documentFields : [];\n\t}\n\n\tget title(): ?string\n\t{\n\t\treturn this.#title;\n\t}\n\n\tgetRawType(): Array<string>\n\t{\n\t\treturn this.#rawType;\n\t}\n\n\tgetCategoryId(): ?number\n\t{\n\t\treturn this.#categoryId;\n\t}\n\n\tgetCurrentStatusId(): ?string\n\t{\n\t\treturn this.#statusList[this.#currentStatusIndex]?.STATUS_ID;\n\t}\n\n\tgetSortedStatusId(index: number): ?string\n\t{\n\t\tif (index >= 0 && index < this.#statusList.length)\n\t\t{\n\t\t\treturn this.#statusList[index].STATUS_ID;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetNextStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(this.#currentStatusIndex + 1).map(status => status.STATUS_ID);\n\t}\n\n\tgetPreviousStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(0, this.#currentStatusIndex).map(status => status.STATUS_ID);\n\t}\n\n\tsetStatus(statusId: string): Document\n\t{\n\t\tconst newStatusId = this.#statusList.findIndex(status => status.STATUS_ID === statusId);\n\t\tif (newStatusId >= 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = newStatusId;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetFields(): Array<Object>\n\t{\n\t\treturn this.#fields;\n\t}\n\n\tsetFields(documentFields: Array<object>): this\n\t{\n\t\tthis.#fields = documentFields;\n\n\t\treturn this;\n\t}\n\n\tsetStatusList(statusList: Array<Object>): this\n\t{\n\t\tif (Type.isArrayFilled(statusList))\n\t\t{\n\t\t\tthis.#statusList = statusList;\n\t\t}\n\n\t\treturn this;\n\t}\n}","import { Type, Loc } from 'main.core';\n\nexport class DelayInterval\n{\n\tstatic BASIS_TYPE = {\n\t\tCurrentDate: '{=System:Date}',\n\t\tCurrentDateTime: '{=System:Now}',\n\t\tCurrentDateTimeLocal: '{=System:NowLocal}',\n\t};\n\n\tstatic DELAY_TYPE = {\n\t\tAfter: 'after',\n\t\tBefore: 'before',\n\t\tIn: 'in',\n\t};\n\n\t#basis: string;\n\t#type: string;\n\t#value: number;\n\t#valueType: string;\n\t#workTime: boolean;\n\t#localTime: boolean;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tthis.#basis = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t\tthis.#type = DelayInterval.DELAY_TYPE.After;\n\t\tthis.#value = 0;\n\t\tthis.#valueType = 'i';\n\t\tthis.#workTime = false;\n\t\tthis.#localTime = false;\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.setType(params['type']);\n\t\t\t}\n\t\t\tif (params['value'])\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t\tif (params['valueType'])\n\t\t\t{\n\t\t\t\tthis.setValueType(params['valueType']);\n\t\t\t}\n\t\t\tif (params['basis'])\n\t\t\t{\n\t\t\t\tthis.setBasis(params['basis']);\n\t\t\t}\n\t\t\tif (params['workTime'])\n\t\t\t{\n\t\t\t\tthis.setWorkTime(params['workTime']);\n\t\t\t}\n\t\t\tif (params['localTime'])\n\t\t\t{\n\t\t\t\tthis.setLocalTime(params['localTime']);\n\t\t\t}\n\t\t}\n\t}\n\n\tget basis()\n\t{\n\t\treturn this.#basis;\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tget valueType()\n\t{\n\t\treturn this.#valueType;\n\t}\n\n\tget workTime()\n\t{\n\t\treturn this.#workTime;\n\t}\n\n\tget localTime()\n\t{\n\t\treturn this.#localTime;\n\t}\n\n\tclone()\n\t{\n\t\treturn new DelayInterval({\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime,\n\t\t\tlocalTime: this.#localTime,\n\t\t});\n\t}\n\n\tstatic isSystemBasis(basis: string): boolean\n\t{\n\t\treturn (\n\t\t\tbasis === this.BASIS_TYPE.CurrentDate\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTime\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTimeLocal\n\t\t);\n\t}\n\n\tstatic fromString(intervalString, basisFields): this\n\t{\n\t\tintervalString = intervalString.toString();\n\t\tconst params = {\n\t\t\tbasis: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\ti: 0,\n\t\t\th: 0,\n\t\t\td: 0,\n\t\t\tworkTime: false,\n\t\t\tlocalTime: false\n\t\t};\n\n\t\tif (intervalString.indexOf('=dateadd(') === 0 || intervalString.indexOf('=workdateadd(') === 0)\n\t\t{\n\t\t\tif (intervalString.indexOf('=workdateadd(') === 0)\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(13);\n\t\t\t\tparams['workTime'] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(9);\n\t\t\t}\n\n\t\t\tconst fnArgs = intervalString.split(',');\n\t\t\tparams['basis'] = fnArgs[0].trim();\n\t\t\tfnArgs[1] = fnArgs[1].replace(/['\")]+/g, '');\n\t\t\tparams['type'] = fnArgs[1].indexOf('-') === 0 ? DelayInterval.DELAY_TYPE.Before : DelayInterval.DELAY_TYPE.After;\n\n\t\t\tlet match;\n\t\t\tconst re = /s*([\\d]+)\\s*(i|h|d)\\s*/ig;\n\t\t\twhile (match = re.exec(fnArgs[1]))\n\t\t\t{\n\t\t\t\tparams[match[2]] = parseInt(match[1]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['basis'] = intervalString;\n\t\t}\n\n\t\tif (!DelayInterval.isSystemBasis(params['basis']) && BX.type.isArray(basisFields))\n\t\t{\n\t\t\tlet found = false;\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (params['basis'] === basisFields[i].SystemExpression || params['basis'] === basisFields[i].Expression)\n\t\t\t\t{\n\t\t\t\t\tparams['basis'] = basisFields[i].SystemExpression;\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\tparams['basis'] = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t\t\t}\n\t\t}\n\n\t\tconst minutes = params['i'] + params['h'] * 60 + params['d'] * 60 * 24;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 1440;\n\t\t\tparams['valueType'] = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 60;\n\t\t\tparams['valueType'] = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['value'] = minutes;\n\t\t\tparams['valueType'] = 'i';\n\t\t}\n\n\t\tif (!params['value'] && params['basis'] !== DelayInterval.BASIS_TYPE.CurrentDateTime && params['basis'])\n\t\t{\n\t\t\tparams['type'] = DelayInterval.DELAY_TYPE.In;\n\t\t}\n\n\t\treturn new DelayInterval(params);\n\t};\n\n\tstatic fromMinutes(minutes): Array<string>\n\t{\n\t\tlet value;\n\t\tlet type;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tvalue = minutes / 1440;\n\t\t\ttype = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tvalue = minutes / 60;\n\t\t\ttype = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalue = minutes;\n\t\t\ttype = 'i';\n\t\t}\n\n\t\treturn [value, type];\n\t}\n\n\tstatic toMinutes(value, valueType): number\n\t{\n\t\tlet result = 0;\n\n\t\tswitch (valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tresult = value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\tresult = value * 60;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tresult = value * 60 * 24;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetType(type): this\n\t{\n\t\tif (\n\t\t\ttype !== DelayInterval.DELAY_TYPE.After\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.Before\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.In\n\t\t)\n\t\t{\n\t\t\ttype = DelayInterval.DELAY_TYPE.After;\n\t\t}\n\t\tthis.#type = type;\n\n\t\treturn this;\n\t}\n\n\tsetValue(value): this\n\t{\n\t\tvalue = parseInt(value);\n\t\tthis.#value = value >= 0 ? value : 0;\n\n\t\treturn this;\n\t}\n\n\tsetValueType(valueType: string): this\n\t{\n\t\tif (valueType !== 'i' && valueType !== 'h' && valueType !== 'd')\n\t\t{\n\t\t\tvalueType = 'i';\n\t\t}\n\n\t\tthis.#valueType = valueType;\n\n\t\treturn this;\n\t}\n\n\tsetBasis(basis: string): this\n\t{\n\t\tif (Type.isString(basis) && basis !== '')\n\t\t{\n\t\t\tthis.#basis = basis;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetWorkTime(flag): this\n\t{\n\t\tthis.#workTime = !!flag;\n\n\t\treturn this;\n\t}\n\n\tsetLocalTime(flag): this\n\t{\n\t\tthis.#localTime = !!flag;\n\n\t\treturn this;\n\t}\n\n\tisNow(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t&& this.#basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t&& !this.#value\n\t\t);\n\t}\n\n\tsetNow(): void\n\t{\n\t\tthis.setType(DelayInterval.DELAY_TYPE.After);\n\t\tthis.setValue(0);\n\t\tthis.setValueType('i');\n\t\tthis.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime ? 1 : 0\n\t\t}\n\t}\n\n\ttoExpression(basisFields, workerExpression): string\n\t{\n\t\tlet basis = this.#basis ? this.#basis : DelayInterval.BASIS_TYPE.CurrentDate;\n\n\t\tif (!DelayInterval.isSystemBasis(basis) && Type.isArray(basisFields))\n\t\t{\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (basis === basisFields[i].SystemExpression)\n\t\t\t\t{\n\t\t\t\t\tbasis = basisFields[i].Expression;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this.#workTime && (this.#type === DelayInterval.DELAY_TYPE.In || this.isNow()))\n\t\t{\n\t\t\treturn basis;\n\t\t}\n\n\t\tlet days = 0;\n\t\tlet hours = 0;\n\t\tlet minutes = 0;\n\n\t\tswitch (this.#valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tminutes = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\thours = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tdays = this.#value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet add = '';\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tadd = '-';\n\t\t}\n\n\t\tif (days > 0)\n\t\t{\n\t\t\tadd += days + 'd';\n\t\t}\n\t\tif (hours > 0)\n\t\t{\n\t\t\tadd += hours + 'h';\n\t\t}\n\t\tif (minutes > 0)\n\t\t{\n\t\t\tadd += minutes + 'i';\n\t\t}\n\n\t\tconst fn = this.#workTime ? 'workdateadd' : 'dateadd';\n\n\t\tif (fn === 'workdateadd' && add === '')\n\t\t{\n\t\t\tadd = '0d';\n\t\t}\n\n\t\tlet worker = '';\n\t\tif (fn === 'workdateadd' && workerExpression)\n\t\t{\n\t\t\tworker = workerExpression;\n\t\t}\n\n\t\treturn '='+ fn + '(' + basis + ',\"' + add + '\"' + (worker ? ',' + worker : '') + ')';\n\t}\n\n\tformat(emptyText, fields)\n\t{\n\t\tlet str = emptyText;\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tstr = Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME');\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.#value)\n\t\t{\n\t\t\tconst prefix = (\n\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH')\n\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_1')\n\t\t\t);\n\n\t\t\tstr = prefix + ' ' + this.getFormattedPeriodLabel(this.#value, this.#valueType);\n\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tconst fieldSuffix = (\n\t\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t);\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fieldSuffix + ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.#workTime)\n\t\t{\n\t\t\tstr += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_WORKTIME');\n\t\t}\n\n\t\treturn str;\n\t}\n\n\tgetFormattedPeriodLabel(value, type)\n\t{\n\t\tconst label = value + ' ';\n\t\tlet labelIndex = 0;\n\t\tif (value > 20)\n\t\t{\n\t\t\tvalue = (value % 10);\n\t\t}\n\n\t\tif (value === 1)\n\t\t{\n\t\t\tlabelIndex = 0;\n\t\t}\n\t\telse if (value > 1 && value < 5)\n\t\t{\n\t\t\tlabelIndex = 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabelIndex = 2;\n\t\t}\n\n\t\tconst labels = DelayInterval.getPeriodLabels(type);\n\n\t\treturn label + (labels ? labels[labelIndex] : '');\n\t}\n\n\tstatic getPeriodLabels(period)\n\t{\n\t\tlet labels = [];\n\t\tif (period === 'i')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'h')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'd')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY3')\n\t\t\t];\n\t\t}\n\n\t\treturn labels;\n\t}\n}","export class WorkflowStatus\n{\n\tstatic CREATED_WORKFLOW_STATUS = 0;\n\tstatic RUNNING_WORKFLOW_STATUS = 1;\n\tstatic COMPLETED_WORKFLOW_STATUS = 2;\n\tstatic SUSPENDED_WORKFLOW_STATUS = 3;\n\tstatic TERMINATED_WORKFLOW_STATUS = 4;\n}","import {WorkflowStatus} from \"../workflow/types\";\n\nexport class TrackingEntry\n{\n\tstatic UNKNOWN_ACTIVITY_TYPE = 0;\n\tstatic EXECUTE_ACTIVITY_TYPE = 1;\n\tstatic CLOSE_ACTIVITY_TYPE = 2;\n\tstatic CANCEL_ACTIVITY_TYPE = 3;\n\tstatic FAULT_ACTIVITY_TYPE = 4;\n\tstatic CUSTOM_ACTIVITY_TYPE = 5;\n\tstatic REPORT_ACTIVITY_TYPE = 6;\n\tstatic ATTACHED_ENTITY_TYPE = 7;\n\tstatic TRIGGER_ACTIVITY_TYPE = 8;\n\tstatic ERROR_ACTIVITY_TYPE = 9;\n\tstatic DEBUG_ACTIVITY_TYPE = 10;\n\tstatic DEBUG_AUTOMATION_TYPE = 11;\n\tstatic DEBUG_DESIGNER_TYPE = 12;\n\tstatic DEBUG_LINK_TYPE = 13;\n\n\tid: number;\n\tworkflowId: string;\n\t#type: number;\n\tname: string;\n\ttitle: string;\n\tnote: string;\n\t// TODO - convert string to Date\n\tdatetime: string;\n\t#workflowStatus: number;\n\n\tget type(): number\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget workflowStatus(): number\n\t{\n\t\treturn this.#workflowStatus;\n\t}\n\n\tset type(entryType: number)\n\t{\n\t\tif (TrackingEntry.getAllActivityTypes().includes(entryType))\n\t\t{\n\t\t\tthis.#type = entryType;\n\t\t}\n\t}\n\n\tset workflowStatus(entryWorkflowStatus: number)\n\t{\n\t\tif (TrackingEntry.getAllWorkflowStatuses().includes(entryWorkflowStatus))\n\t\t{\n\t\t\tthis.#workflowStatus = entryWorkflowStatus;\n\t\t}\n\t}\n\n\tisTriggerEntry(): boolean\n\t{\n\t\treturn this.type === TrackingEntry.TRIGGER_ACTIVITY_TYPE;\n\t}\n\n\tstatic getAllActivityTypes(): Array<number>\n\t{\n\t\treturn [\n\t\t\tTrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CLOSE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CANCEL_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.FAULT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CUSTOM_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.REPORT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ATTACHED_ENTITY_TYPE,\n\t\t\tTrackingEntry.TRIGGER_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ERROR_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_AUTOMATION_TYPE,\n\t\t\tTrackingEntry.DEBUG_DESIGNER_TYPE,\n\t\t\tTrackingEntry.DEBUG_LINK_TYPE,\n\t\t];\n\t}\n\n\tstatic isKnownActivityType(typeId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllActivityTypes().includes(typeId);\n\t}\n\n\tstatic getAllWorkflowStatuses(): Array<number>\n\t{\n\t\treturn [\n\t\t\tWorkflowStatus.CREATED_WORKFLOW_STATUS,\n\t\t\tWorkflowStatus.RUNNING_WORKFLOW_STATUS,\n\t\t\tWorkflowStatus.COMPLETED_WORKFLOW_STATUS,\n\t\t\tWorkflowStatus.SUSPENDED_WORKFLOW_STATUS,\n\t\t\tWorkflowStatus.TERMINATED_WORKFLOW_STATUS,\n\t\t];\n\t}\n\n\tstatic isKnownWorkflowStatus(statusId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllWorkflowStatuses().includes(statusId);\n\t}\n}","export class TrackingStatus\n{\n\tstatic WAITING = 0;\n\tstatic RUNNING = 1;\n\tstatic COMPLETED = 2;\n\tstatic AUTOCOMPLETED = 3;\n}","import {Type} from 'main.core';\nimport { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport {WorkflowStatus} from \"../workflow/types\";\n\nexport class RobotEntry\n{\n\tid: string = '';\n\tstatus: string = TrackingStatus.WAITING;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\tnotes: Array<string> = [];\n\terrors: Array<string> = [];\n\t#entryId: number = -1;\n\tworkflowStatus: number = WorkflowStatus.CREATED_WORKFLOW_STATUS;\n\n\tconstructor(entries: ?Array<TrackingEntry>)\n\t{\n\t\tif (Type.isArray(entries))\n\t\t{\n\t\t\tfor (const entry of entries)\n\t\t\t{\n\t\t\t\tthis.addEntry(entry);\n\t\t\t}\n\t\t}\n\t}\n\n\taddEntry(entry: TrackingEntry)\n\t{\n\t\tthis.id = entry.name;\n\n\t\tif (this.#entryId < entry.id)\n\t\t{\n\t\t\tthis.#entryId = entry.id;\n\t\t\tthis.modified = entry.datetime;\n\t\t\tthis.workflowStatus = entry.workflowStatus;\n\n\t\t\tif (entry.type === TrackingEntry.CLOSE_ACTIVITY_TYPE)\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.COMPLETED;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\tif (entry.type === TrackingEntry.ERROR_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.errors.push(entry.note);\n\t\t}\n\t\telse if (entry.type === TrackingEntry.CUSTOM_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.notes.push(entry.note);\n\t\t}\n\t}\n}","import { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\n\nexport class TriggerEntry\n{\n\tid: string = '';\n\tstatus: number = TrackingStatus.COMPLETED;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\n\tconstructor(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.id = entry.note;\n\t\t\tthis.modified = entry.datetime;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport class TrackingEntryBuilder\n{\n\t#defaultSettings = {\n\t\tid: TrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\tworkflowId: '',\n\t\ttype: TrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\tname: '',\n\t\ttitle: '',\n\t\tdatetime: '',\n\t\tnote: '',\n\t\tworkflowStatus: WorkflowStatus.CREATED_WORKFLOW_STATUS,\n\t};\n\t#entrySettings: Object<string, string | number>;\n\n\tconstructor()\n\t{\n\t\tthis.#entrySettings = this.#defaultSettings;\n\t}\n\n\tsetLogEntry(logEntry: Object<string, any>): this\n\t{\n\t\tthis.#entrySettings = Object.assign({}, this.#defaultSettings);\n\t\tlogEntry = Object.assign({}, logEntry);\n\n\t\tif (Type.isStringFilled(logEntry['ID']))\n\t\t{\n\t\t\tlogEntry['ID'] = parseInt(logEntry['ID']);\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['TYPE']))\n\t\t{\n\t\t\tlogEntry['TYPE'] = parseInt(logEntry['TYPE']);\n\t\t}\n\n\t\tif (Type.isNumber(logEntry['ID']))\n\t\t{\n\t\t\tthis.#entrySettings.id = logEntry['ID'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['WORKFLOW_ID']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowId = logEntry['WORKFLOW_ID'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['TYPE']) && TrackingEntry.isKnownActivityType(logEntry['TYPE']))\n\t\t{\n\t\t\tthis.#entrySettings.type = logEntry['TYPE'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['MODIFIED']))\n\t\t{\n\t\t\tthis.#entrySettings.datetime = logEntry['MODIFIED'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['WORKFLOW_STATUS']) && TrackingEntry.isKnownWorkflowStatus(logEntry['WORKFLOW_STATUS']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowStatus = logEntry['WORKFLOW_STATUS'];\n\t\t}\n\n\t\tthis.#entrySettings.name = String(logEntry['ACTION_NAME']);\n\t\tthis.#entrySettings.title = String(logEntry['ACTION_TITLE']);\n\t\tthis.#entrySettings.note = String(logEntry['ACTION_NOTE']);\n\n\t\treturn this;\n\t}\n\n\tsetStatus(status: string): this\n\t{\n\t\tthis.#entrySettings.status = status;\n\n\t\treturn this;\n\t}\n\n\tbuild(): TrackingEntry\n\t{\n\t\tconst entry = new TrackingEntry();\n\n\t\tentry.id = this.#entrySettings.id;\n\t\tentry.workflowId = this.#entrySettings.workflowId;\n\t\tentry.type = this.#entrySettings.type;\n\t\tentry.name = this.#entrySettings.name;\n\t\tentry.title = this.#entrySettings.title;\n\t\tentry.note = this.#entrySettings.note;\n\t\tentry.datetime = this.#entrySettings.datetime;\n\t\tentry.workflowStatus = this.#entrySettings.workflowStatus;\n\n\t\treturn entry;\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { RobotEntry } from './robot-entry';\nimport { TriggerEntry } from './trigger-entry';\nimport { TrackingEntryBuilder } from './tracking-entry-builder';\nimport { Document } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport {\n\tRobotEntry,\n\tTriggerEntry,\n\tTrackingEntryBuilder,\n\tTrackingEntry,\n\tTrackingStatus,\n}\n\nexport class Tracker\n{\n\t#ajaxUrl: string;\n\t#document: ?Document;\n\n\t#triggerLogs: Object<string, TrackingEntry>;\n\t#robotLogs: Object<string, RobotEntry>;\n\n\tconstructor(document: ?Document, ajaxUrl: string)\n\t{\n\t\tthis.#ajaxUrl = ajaxUrl;\n\t\tthis.#document = document;\n\t}\n\n\tinit(log)\n\t{\n\t\tthis.#triggerLogs = {};\n\t\tthis.#robotLogs = {};\n\n\t\tthis.addLogs(log);\n\t}\n\n\treInit(log)\n\t{\n\t\tthis.init(log);\n\t}\n\n\taddLogs(log: Object<string, Array<Object<string, any>>>)\n\t{\n\t\tif (!Type.isPlainObject(log))\n\t\t{\n\t\t\tlog = {};\n\t\t}\n\n\t\tconst logEntryBuilder = new TrackingEntryBuilder();\n\n\t\tfor (const [statusId, entries] of Object.entries(log))\n\t\t{\n\t\t\tif (!Type.isArray(entries))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const rawEntry of entries)\n\t\t\t{\n\t\t\t\tconst entry = logEntryBuilder.setLogEntry(rawEntry).build();\n\n\t\t\t\tif (entry.isTriggerEntry())\n\t\t\t\t{\n\t\t\t\t\tthis.addTriggerEntry(entry);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.addRobotEntry(entry);\n\t\t\t\t\tconst robotEntry = this.#robotLogs[entry.name];\n\n\t\t\t\t\tif (!Type.isNil(this.#document))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isRobotRunning = (robotEntry.status === TrackingStatus.RUNNING);\n\t\t\t\t\t\tconst isWorkflowCompleted =\n\t\t\t\t\t\t\t(robotEntry.workflowStatus === WorkflowStatus.COMPLETED_WORKFLOW_STATUS)\n\t\t\t\t\t\t;\n\t\t\t\t\t\tconst isCurrentStatus = (this.#document.getCurrentStatusId() === statusId);\n\n\t\t\t\t\t\tconst isRobotRunningAtAnotherStatus = isRobotRunning && !isCurrentStatus;\n\t\t\t\t\t\tconst isRobotRunningAndCurrentWorkflowCompleted =\n\t\t\t\t\t\t\tisRobotRunning && isWorkflowCompleted && isCurrentStatus\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tif (isRobotRunningAtAnotherStatus || isRobotRunningAndCurrentWorkflowCompleted)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trobotEntry.status = TrackingStatus.COMPLETED;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddTriggerEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.#triggerLogs[entry.note] = new TriggerEntry(entry);\n\t\t}\n\t}\n\n\taddRobotEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#robotLogs[entry.name])\n\t\t{\n\t\t\tthis.#robotLogs[entry.name] = new RobotEntry([entry]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robotLogs[entry.name].addEntry(entry);\n\t\t}\n\t}\n\n\tgetRobotLog(id: string): ?RobotEntry\n\t{\n\t\treturn this.#robotLogs[id] || null;\n\t}\n\n\tgetTriggerLog(id: string): ?TriggerEntry\n\t{\n\t\treturn this.#triggerLogs[id] || null;\n\t}\n\n\tupdate(documentSigned: string)\n\t{\n\t\treturn BX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: this.#ajaxUrl,\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_log',\n\t\t\t\tdocument_signed: documentSigned\n\t\t\t},\n\t\t\tonsuccess: (response) => {\n\t\t\t\tif (response.DATA && response.DATA.LOG)\n\t\t\t\t{\n\t\t\t\t\tthis.reInit(response.DATA.LOG);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","import { Dom, Type, Event, Text, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Document } from './document/document';\nimport { Template } from './template';\nimport { DelayInterval } from './delay-interval';\nimport { ViewMode } from './view-mode';\nimport { HelpHint } from './help-hint';\nimport { ConditionGroup } from 'bizproc.automation';\nimport { Tracker } from './tracker/tracker'\nimport { TrackingStatus } from './tracker/types';\n\nexport class Robot extends EventEmitter\n{\n\tSYSTEM_EXPRESSION_PATTERN = '\\\\{=\\\\s*(?<object>[a-z0-9_]+)\\\\s*\\\\:\\\\s*(?<field>[a-z0-9_\\\\.]+)(\\\\s*>\\\\s*(?<mod1>[a-z0-9_\\\\:]+)(\\\\s*,\\\\s*(?<mod2>[a-z0-9_]+))?)?\\\\s*\\\\}';\n\n\t#data: Object<string, any>;\n\t#document: Document;\n\t#template: ?Template;\n\t#tracker: ?Object;\n\t#delay: DelayInterval;\n\t#node: HTMLElement;\n\t#condition: ConditionGroup;\n\t#isDraft: boolean;\n\n\t#isFrameMode: boolean;\n\t#viewMode: ViewMode;\n\n\tconstructor(params: {\n\t\tdocument: Document,\n\t\ttemplate: ?Template,\n\t\tisFrameMode: boolean,\n\t\ttracker: Tracker,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#document = params.document;\n\t\tif (!Type.isNil(params.template))\n\t\t{\n\t\t\tthis.#template = params.template;\n\t\t}\n\t\tthis.#isFrameMode = params.isFrameMode;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#tracker = params.tracker;\n\t\tthis.#isDraft = false;\n\n\t\tthis.#delay = new DelayInterval();\n\t}\n\n\tget node()\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget data()\n\t{\n\t\treturn this.#data;\n\t}\n\n\tget draft()\n\t{\n\t\treturn this.#isDraft;\n\t}\n\n\tset draft(draft: boolean)\n\t{\n\t\tthis.#isDraft = draft;\n\t}\n\n\tget template()\n\t{\n\t\treturn this.#template;\n\t}\n\n\thasTemplate(): boolean\n\t{\n\t\treturn !Type.isNil(this.#template);\n\t}\n\n\tgetTemplate(): ?Template\n\t{\n\t\treturn this.#template;\n\t}\n\n\tgetDocument(): Document\n\t{\n\t\treturn this.#document;\n\t}\n\n\tstatic generateName(): string\n\t{\n\t\treturn (\n\t\t\t'A' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t);\n\t}\n\n\tclone(): Robot\n\t{\n\t\tconst clonedRobot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate: this.#template,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = {\n\t\t\tName: Robot.generateName(),\n\t\t\tDelay: this.getDelayInterval().clone(),\n\t\t\tCondition: this.getCondition().clone(),\n\t\t\t...BX.clone(this.#data)\n\t\t};\n\t\tclonedRobot.init(robotData, this.#viewMode);\n\n\t\treturn clonedRobot;\n\t}\n\n\tisEqual(other: Robot): boolean\n\t{\n\t\treturn this.#data.Name === other.#data.Name;\n\t}\n\n\tinit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\tif (!this.#data.Name)\n\t\t{\n\t\t\tthis.#data.Name = Robot.generateName();\n\t\t}\n\n\t\tthis.#delay = new DelayInterval(this.#data.Delay);\n\t\tthis.#condition = new ConditionGroup(this.#data.Condition);\n\t\tif (!this.#data.Condition)\n\t\t{\n\t\t\tthis.#condition.type = ConditionGroup.CONDITION_TYPE.Mixed;\n\t\t}\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#node = this.createNode();\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isNil(viewMode) && this.#viewMode.isNone())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.emit('Robot:destroyed');\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn this.#template.canEdit();\n\t}\n\n\tgetProperties(): Object\n\t{\n\t\tif (this.#data && Type.isPlainObject(this.#data.Properties))\n\t\t{\n\t\t\treturn this.#data.Properties;\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tgetProperty(name: string): ?Object\n\t{\n\t\treturn this.getProperties()[name] || null;\n\t}\n\n\thasProperty(name: string): boolean\n\t{\n\t\treturn this.getProperties().hasOwnProperty(name);\n\t}\n\n\tsetProperty(name: string, value: any): Robot\n\t{\n\t\tthis.#data.Properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetId(): ?string\n\t{\n\t\treturn this.#data.Name || null;\n\t}\n\n\tgetLogStatus(): number\n\t{\n\t\tlet status = TrackingStatus.WAITING;\n\t\tlet log = this.#tracker.getRobotLog(this.getId());\n\n\t\tif (log)\n\t\t{\n\t\t\tstatus = log.status;\n\t\t}\n\t\telse if (this.#data.DelayName)\n\t\t{\n\t\t\tlog = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\tstatus = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t}\n\n\tgetLogErrors(): Array<string>\n\t{\n\t\tlet errors = [];\n\t\tconst log = this.#tracker.getRobotLog(this.getId());\n\t\tif (log && log.errors)\n\t\t{\n\t\t\terrors = log.errors;\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\tgetDelayNotes(): Array<string>\n\t{\n\t\tif (this.#data.DelayName)\n\t\t{\n\t\t\tconst log = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\treturn log.notes;\n\t\t\t}\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tselectNode(): void\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--selected');\n\t\t\tthis.emit('Robot:selected');\n\t\t}\n\t}\n\n\tunselectNode()\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--selected');\n\t\t\tthis.emit('Robot:unselected');\n\t\t}\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#node && Dom.hasClass(this.#node, '--selected');\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\tif (!isActive)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--locked-node');\n\t\t}\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.hide(deleteButton);\n\n\t\tthis.#node.onclick = () => {\n\t\t\tif (!this.#viewMode.isManage() || !this.#viewMode.getProperty('isActive', false))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isSelected())\n\t\t\t{\n\t\t\t\tthis.selectNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unselectNode();\n\t\t\t}\n\t\t};\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tthis.unselectNode();\n\t\tDom.removeClass(this.#node, '--locked-node');\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.show(deleteButton);\n\n\t\tthis.#node.onclick = undefined;\n\t}\n\n\tcreateNode(): HTMLElement\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-robot-container-wrapper';\n\t\tlet containerClass = 'bizproc-automation-robot-container';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-robot-container-wrapper-draggable';\n\t\t}\n\n\t\tconst targetLabel = Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO');\n\t\tconst targetNode = Dom.create(\"a\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-settings-name\",\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t});\n\n\t\tif (Type.isPlainObject(this.#data.viewData) && this.#data.viewData.responsibleLabel)\n\t\t{\n\t\t\tlet labelText =\n\t\t\t\tthis.#data.viewData.responsibleLabel\n\t\t\t\t\t.replace('{=Document:ASSIGNED_BY_ID}', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace('author', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace(/\\{=Constant\\:Constant[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{\\{~&\\:Constant[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{=Template\\:Parameter[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t\t\t.replace(/\\{\\{~&:\\:Parameter[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t;\n\n\t\t\tif (labelText.indexOf('{=Document') >= 0)\n\t\t\t{\n\t\t\t\tthis.#document.getFields().forEach(field => {\n\t\t\t\t\tlabelText = labelText.replace(field['SystemExpression'], field['Name']);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (labelText.indexOf('{=A') >= 0)\n\t\t\t{\n\t\t\t\tthis.#template.robots.forEach(robot => {\n\t\t\t\t\trobot.getReturnFieldsDescription().forEach(field => {\n\t\t\t\t\t\tif (field['Type'] === 'user')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabelText = labelText.replace(\n\t\t\t\t\t\t\t\tfield['SystemExpression'],\n\t\t\t\t\t\t\t\trobot.getTitle() + ': ' + field['Name']\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttargetNode.textContent = labelText;\n\t\t\ttargetNode.setAttribute('title', labelText);\n\n\t\t\tif (this.#data.viewData.responsibleUrl)\n\t\t\t{\n\t\t\t\ttargetNode.href = this.#data.viewData.responsibleUrl;\n\t\t\t\tif (this.#isFrameMode)\n\t\t\t\t{\n\t\t\t\t\ttargetNode.setAttribute('target', '_blank');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (parseInt(this.#data.viewData.responsibleId) > 0)\n\t\t\t{\n\t\t\t\ttargetNode.setAttribute('bx-tooltip-user-id', this.#data.viewData.responsibleId);\n\t\t\t}\n\t\t}\n\n\t\tlet delayLabel = this.getDelayInterval().format(\n\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\tthis.#document.getFields()\n\t\t);\n\n\t\tif (this.isExecuteAfterPrevious())\n\t\t{\n\t\t\tdelayLabel = (delayLabel !== Loc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE')) ? delayLabel + ', ' : '';\n\t\t\tdelayLabel += Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS');\n\t\t}\n\n\t\tif (this.getCondition().items.length > 0)\n\t\t{\n\t\t\tdelayLabel += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_BY_CONDITION');\n\t\t}\n\n\t\tconst delayNode = Dom.create(\n\t\t\tthis.#viewMode.isEdit() ? \"a\" : \"span\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: this.#viewMode.isEdit() ? 'bizproc-automation-robot-link' : 'bizproc-automation-robot-text',\n\t\t\t\t\ttitle: delayLabel\n\t\t\t\t},\n\t\t\t\ttext: delayLabel,\n\t\t\t}\n\t\t);\n\n\t\tconst statusNode = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-information\"\n\t\t\t}\n\t\t});\n\t\tthis.subscribeOnce('Robot:destroyed', () => {\n\t\t\tif (HelpHint.isBindedToNode(statusNode))\n\t\t\t{\n\t\t\t\tHelpHint.hideHint();\n\t\t\t}\n\t\t})\n\n\t\tswitch (this.getLogStatus())\n\t\t{\n\t\t\tcase TrackingStatus.RUNNING:\n\t\t\t\tif (this.#document.getCurrentStatusId() === this.#template.getStatusId())\n\t\t\t\t{\n\t\t\t\t\tstatusNode.classList.add('--loader');\n\n\t\t\t\t\tconst delayNotes = this.getDelayNotes();\n\t\t\t\t\tif (delayNotes.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tstatusNode.setAttribute('data-text', delayNotes.join('\\n'));\n\t\t\t\t\t\tHelpHint.bindToNode(statusNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase TrackingStatus.COMPLETED:\n\t\t\tcase TrackingStatus.AUTOCOMPLETED:\n\t\t\t\tcontainerClass += ' --complete';\n\t\t\t\tstatusNode.classList.add('--complete');\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst errors = this.getLogErrors();\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tstatusNode.classList.add('--errors');\n\t\t\tstatusNode.setAttribute('data-text', errors.join('\\n'));\n\t\t\tHelpHint.bindToNode(statusNode);\n\t\t}\n\n\t\tlet titleClassName = 'bizproc-automation-robot-title-text';\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\ttitleClassName += ' bizproc-automation-robot-title-text-editable';\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: containerClass,\n\t\t\t\t'data-role': 'robot-container',\n\t\t\t\t'data-type': 'item-robot',\n\t\t\t\t'data-id': this.getId()\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-robot-container-checkbox\"\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" },\n\t\t\t\t\t\t\tchildren: [delayNode]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"bizproc-automation-robot-title\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: titleClassName\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\thtml: this.clipTitle(this.getTitle()),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: event => {\n\t\t\t\t\t\t\t\t\t\t\tif (this.#viewMode.isEdit() && this.canEdit() && !this.#viewMode.isManage())\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tthis.onTitleEditClick(event);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings-title\" },\n\t\t\t\t\t\t\t\t\ttext: targetLabel + ':'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\ttargetNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tstatusNode,\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\t\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\n\t\t\tconst copyBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-copy'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY') || 'copy'\n\t\t\t});\n\t\t\tEvent.bind(copyBtn, 'click', this.onCopyButtonClick.bind(this, copyBtn));\n\t\t\tdiv.appendChild(copyBtn);\n\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\n\t\t\tdiv.appendChild(settingsBtn);\n\t\t}\n\n\t\treturn div;\n\t}\n\n\tonDeleteButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(this.#node);\n\t\t\tthis.#template.deleteRobot(this);\n\t\t}\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.#template.openRobotSettingsDialog(this);\n\t\t}\n\t}\n\n\tonCopyButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst copiedRobot = this.clone();\n\t\t\tconst robotTitle = copiedRobot.getProperty('Title');\n\t\t\tif (!Type.isNil(robotTitle))\n\t\t\t{\n\t\t\t\tconst newTitle = robotTitle + ' ' + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY_CAPTION');\n\t\t\t\tcopiedRobot.setProperty('Title', newTitle);\n\t\t\t\tcopiedRobot.reInit();\n\t\t\t}\n\n\t\t\tTemplate.copyRobotTo(this.#template, copiedRobot, this.#template.getNextRobot(this));\n\t\t}\n\t}\n\n\tonTitleEditClick(e)\n\t{\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tconst formName = 'bizproc_automation_robot_title_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME') + ':'\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [BX.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\tvalue: this.getTitle()\n\t\t\t\t}\n\t\t\t})]\n\t\t}));\n\n\t\tthis.emit('Robot:title:editStart');\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(BX.Bizproc.Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME'),\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose(popup)\n\t\t\t\t{\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tself.emit('Robot:title:editCompleted');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nameNode = form.elements.name;\n\t\t\t\t\t\t\tself.setProperty('Title', nameNode.value);\n\t\t\t\t\t\t\tself.reInit();\n\t\t\t\t\t\t\tself.#template.markModified();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getTitle().toLowerCase().indexOf(query) >= 0;\n\n\t\tif (match)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--search-mismatch');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#node, '--search-mismatch');\n\t\t}\n\t}\n\n\tclipTitle(fullTitle: string)\n\t{\n\t\tlet title = Text.encode(fullTitle);\n\t\tconst arrTitle = title.split(\" \");\n\t\tconst lastWord = \"<span>\" + arrTitle[arrTitle.length - 1] + \"</span>\";\n\n\t\tarrTitle.splice(arrTitle.length - 1);\n\n\t\ttitle = arrTitle.join(\" \") + \" \" + lastWord;\n\n\t\treturn title;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tserialize()\n\t{\n\t\tconst result = BX.clone(this.#data);\n\t\tdelete result['viewData'];\n\t\tresult.Delay = this.#delay.serialize();\n\t\tresult.Condition = this.#condition.serialize();\n\n\t\treturn result;\n\t}\n\n\tgetDelayInterval(): DelayInterval\n\t{\n\t\treturn this.#delay;\n\t}\n\n\tsetDelayInterval(delay): Robot\n\t{\n\t\tthis.#delay = delay;\n\n\t\treturn this;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition)\n\t{\n\t\tthis.#condition = condition;\n\n\t\treturn this;\n\t}\n\n\tsetExecuteAfterPrevious(flag)\n\t{\n\t\tthis.#data.ExecuteAfterPrevious = flag ? 1 : 0;\n\n\t\treturn this;\n\t}\n\n\tisExecuteAfterPrevious()\n\t{\n\t\treturn (this.#data.ExecuteAfterPrevious === 1 || this.#data.ExecuteAfterPrevious === '1')\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.draggableItem = BX.proxy_context;\n\n\t\tif (!this.draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.stub)\n\t\t{\n\t\t\tconst itemWidth = this.draggableItem.offsetWidth;\n\t\t\tthis.stub = this.draggableItem.cloneNode(true);\n\t\t\tthis.stub.style.position = \"absolute\";\n\t\t\tthis.stub.classList.add(\"bizproc-automation-robot-container-drag\");\n\t\t\tthis.stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.stub);\n\t\t}\n\t}\n\n\tdragMove(x,y)\n\t{\n\t\tthis.stub.style.left = x + \"px\";\n\t\tthis.stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-robot\")\n\t\t{\n\t\t\tthis.droppableItem = destination;\n\t\t\tthis.droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-robot\")\n\t\t{\n\t\t\tthis.droppableColumn = destination.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.droppableItem = null;\n\t\t}\n\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.add(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.add(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\n\t\tif (this.draggableItem)\n\t\t{\n\t\t\tif (this.droppableItem)\n\t\t\t{\n\t\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableItem.parentNode,\n\t\t\t\t\tisCopy,\n\t\t\t\t\tdroppableItem: this.droppableItem,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.droppableColumn)\n\t\t\t{\n\t\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableColumn,\n\t\t\t\t\tisCopy,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.stub.parentNode.removeChild(this.stub);\n\t\tthis.stub = null;\n\t\tthis.draggableItem = null;\n\t\tthis.droppableItem = null;\n\t}\n\n\tmoveTo(template, beforeRobot)\n\t{\n\t\tDom.remove(this.#node);\n\t\tthis.#template.deleteRobot(this);\n\t\tthis.#template = template;\n\n\t\tthis.#template.insertRobot(this, beforeRobot);\n\t\tthis.#node = this.createNode();\n\t\tthis.#template.insertRobotNode(this.#node, beforeRobot ? beforeRobot.node : null);\n\t}\n\n\tcopyTo(template, beforeRobot)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = this.serialize();\n\t\tdelete robotData['Name'];\n\t\tdelete robotData['DelayName'];\n\n\t\trobot.init(robotData, this.#viewMode);\n\n\t\ttemplate.insertRobot(robot, beforeRobot);\n\t\ttemplate.insertRobotNode(robot.node, beforeRobot ? beforeRobot.node : null);\n\n\t\treturn robot;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getProperty('Title') || this.getDescriptionTitle();\n\t}\n\n\tgetDescriptionTitle()\n\t{\n\t\tlet name = 'untitled';\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\t\tif (description['NAME'])\n\t\t{\n\t\t\tname = description['NAME'];\n\t\t}\n\t\tif (description['ROBOT_SETTINGS'] && description['ROBOT_SETTINGS']['TITLE'])\n\t\t{\n\t\t\tname = description['ROBOT_SETTINGS']['TITLE'];\n\t\t}\n\n\t\treturn name;\n\t}\n\n\thasTitle(): boolean\n\t{\n\t\treturn this.getTitle() !== 'untitled';\n\t}\n\n\tgetReturnFieldsDescription()\n\t{\n\t\tconst fields = [];\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\n\t\tif (description && description['RETURN'])\n\t\t{\n\t\t\tfor (const fieldId in description['RETURN'])\n\t\t\t{\n\t\t\t\tif (description['RETURN'].hasOwnProperty(fieldId))\n\t\t\t\t{\n\t\t\t\t\tconst field = description['RETURN'][fieldId];\n\t\t\t\t\tfields.push({\n\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\tObjectName: this.getTitle(),\n\t\t\t\t\t\tName: field['NAME'],\n\t\t\t\t\t\tType: field['TYPE'],\n\t\t\t\t\t\tExpression: '{{~'+this.getId()+':'+fieldId+' # '+this.getTitle()+': '+field['NAME']+'}}',\n\t\t\t\t\t\tSystemExpression: '{='+this.getId()+':'+fieldId+'}'\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!this.appendPropertyMods)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t//generate printable version\n\t\t\t\t\tif (\n\t\t\t\t\t\tfield['TYPE'] === 'user'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'bool'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'file'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst printableTag = (field['TYPE'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\tName: field['NAME'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['NAME']}}}`,\n\t\t\t\t\t\t\tSystemExpression: `{=${this.getId()}:${fieldId}>${printableTag}}`,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (description && Type.isArray(description['ADDITIONAL_RESULT']))\n\t\t{\n\t\t\tconst props = this.#data['Properties'];\n\n\t\t\tdescription['ADDITIONAL_RESULT'].forEach(addProperty => {\n\t\t\t\tif (props[addProperty])\n\t\t\t\t{\n\t\t\t\t\tfor (const fieldId in props[addProperty])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (props[addProperty].hasOwnProperty(fieldId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst field = props[addProperty][fieldId];\n\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\tName: field['Name'],\n\t\t\t\t\t\t\t\tType: field['Type'],\n\t\t\t\t\t\t\t\tOptions: field['Options'] || null,\n\t\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} # ${this.getTitle()}: ${field['Name']}}}`,\n\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '}',\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t//generate printable version\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tfield['Type'] === 'user'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'bool'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'file'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst printableTag = (field['Type'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\t\t\tconst expression = `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['Name']}}}`;\n\t\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\t\tName: field['Name'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\t\t\tExpression: expression,\n\t\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '>' + printableTag + '}',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tgetReturnProperty(id): Array<Object>\n\t{\n\t\tconst fields = this.getReturnFieldsDescription();\n\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t{\n\t\t\tif (fields[i]['Id'] === id)\n\t\t\t{\n\t\t\t\treturn fields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst properties = this.getProperties();\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tObject.values(properties).forEach(property => this.collectExpressions(property, usages));\n\n\t\tconst conditions = this.getCondition().serialize();\n\t\tconditions.items.forEach(item => this.collectParsedExpressions(item[0], usages));\n\n\t\treturn usages;\n\t}\n\n\tcollectExpressions(value, usages)\n\t{\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue.forEach(v => this.collectExpressions(v, usages));\n\t\t}\n\t\telse if (Type.isPlainObject(value))\n\t\t{\n\t\t\tObject.values(value).forEach(value => this.collectExpressions(value, usages));\n\t\t}\n\t\telse if (Type.isStringFilled(value))\n\t\t{\n\t\t\tlet found;\n\t\t\tconst systemExpressionRegExp = new RegExp(this.SYSTEM_EXPRESSION_PATTERN, 'ig');\n\t\t\twhile ((found = systemExpressionRegExp.exec(value)) !== null)\n\t\t\t{\n\t\t\t\tthis.collectParsedExpressions(found.groups, usages);\n\t\t\t}\n\t\t}\n\t}\n\n\tcollectParsedExpressions(parsedUsage, usages)\n\t{\n\t\tif (Type.isPlainObject(parsedUsage) && parsedUsage['object'] && parsedUsage['field'])\n\t\t{\n\t\t\tswitch (parsedUsage['object'])\n\t\t\t{\n\t\t\t\tcase 'Document':\n\t\t\t\t\tusages.Document.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Constant':\n\t\t\t\t\tusages.Constant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Variable':\n\t\t\t\t\tusages.Variable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Template':\n\t\t\t\t\tusages.Parameter.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalConst':\n\t\t\t\t\tusages.GlobalConstant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalVar':\n\t\t\t\t\tusages.GlobalVariable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst activityRegExp = new RegExp(/^A[_0-9]+$/, 'ig');\n\t\t\tif (activityRegExp.exec(parsedUsage['object']))\n\t\t\t{\n\t\t\t\tusages.Activity.add([parsedUsage['object'], parsedUsage['field']]);\n\t\t\t}\n\t\t}\n\t}\n\n\thasBrokenLink()\n\t{\n\t\tconst usages = BX.clone(this.collectUsages());\n\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst objectsData = {\n\t\t\tDocument: this.#document.getFields(),\n\t\t\tConstant: this.#template.getConstants(),\n\t\t\tVariable: this.#template.getVariables(),\n\t\t\tGlobalConstant: this.#template.globalConstants,\n\t\t\tGlobalVariable: this.#template.globalVariables,\n\t\t\tParameter: this.#template.getParameters(),\n\t\t\tActivity: this.#template.getSerializedRobots()\n\t\t};\n\n\t\tfor (const object in usages)\n\t\t{\n\t\t\tif (usages[object].size > 0)\n\t\t\t{\n\t\t\t\tconst source = new Set();\n\n\t\t\t\tfor (const key in objectsData[object])\n\t\t\t\t{\n\t\t\t\t\tif (objectsData[object][key]['Id'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Id']);\n\t\t\t\t\t}\n\t\t\t\t\telse if (objectsData[object][key]['Name'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Name']);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (const value of usages[object].values())\n\t\t\t\t{\n\t\t\t\t\tlet searchInSource = value;\n\t\t\t\t\tlet id = value;\n\n\t\t\t\t\tif (Type.isArray(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\tsearchInSource = value[0];\n\t\t\t\t\t\tid = value[1];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!source.has(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (object === 'Activity')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst robot = this.#template.getRobotById(searchInSource);\n\t\t\t\t\t\tif (!robot.getReturnProperty(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n}","import { Type } from 'main.core';\n\nexport class UserOptions\n{\n\t#options: Object<string, any>;\n\n\tconstructor(options: Object<string, any>)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tset(category: string, key: string, value: any): UserOptions\n\t{\n\t\tif (!Type.isPlainObject(this.#options[category]))\n\t\t{\n\t\t\tthis.#options[category] = {};\n\t\t}\n\t\tconst storedValue = this.#options[category][key];\n\n\t\tif (storedValue !== value)\n\t\t{\n\t\t\tBX.userOptions.save(\n\t\t\t\t'bizproc.automation',\n\t\t\t\tcategory,\n\t\t\t\tkey,\n\t\t\t\tvalue,\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget(category: string, key: string, defaultValue: any): any\n\t{\n\t\tlet result = defaultValue;\n\t\tif (this.has(category, key))\n\t\t{\n\t\t\tresult = this.#options[category][key];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thas(category: string, key: string): boolean\n\t{\n\t\treturn Type.isPlainObject(this.#options[category]) && Type.isPlainObject(this.#options[category][key]);\n\t}\n}","import { Type, Dom, Loc, Reflection, Event } from 'main.core';\nimport { MenuManager } from 'main.popup';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { getGlobalContext, Tracker, Designer, ConditionGroupSelector, ConditionGroup, DelayIntervalSelector } from 'bizproc.automation';\nimport { Robot } from './robot'\nimport { UserOptions } from './user-options';\nimport { ViewMode } from './view-mode';\nimport { Helper } from './helper';\nimport { HelpHint } from './help-hint';\nimport { DelayInterval } from './delay-interval';\n\nexport class Template extends EventEmitter\n{\n\tconstants: Object<string, any>;\n\tglobalConstants: Array<Object>;\n\tvariables: Object<string, any>;\n\tglobalVariables: Array<Object>;\n\trobotSettingsControls;\n\n\t#selectors;\n\t#delayMinLimitM: number;\n\t#userOptions: UserOptions | null;\n\t#tracker: Tracker;\n\t#viewMode: ViewMode;\n\n\t#templateContainerNode: Element;\n\t#templateNode: ?Element;\n\t#listNode: Element | undefined;\n\t#buttonsNode: Element | undefined;\n\t#topButtonsNode: Element | undefined;\n\n\t#robots: Array<Robot>;\n\t#data: Object;\n\n\tconstructor(params: {\n\t\ttemplateContainerNode: Element,\n\t\tselectors: Object,\n\t\tconstants: Object<string, any>,\n\t\tglobalConstants: Array<Object>,\n\t\tvariables: Object<string, any>,\n\t\tglobalVariables: Array<Object>,\n\t\tuserOptions: ?UserOptions,\n\t\tdelayMinLimitM: number,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.constants = params.constants;\n\t\tthis.globalConstants = params.globalConstants;\n\t\tthis.variables = params.variables;\n\t\tthis.globalVariables = params.globalVariables;\n\n\t\tthis.#templateContainerNode = params.templateContainerNode;\n\t\tthis.#selectors = params.selectors;\n\t\tthis.#delayMinLimitM = params.delayMinLimitM;\n\t\tthis.#userOptions = params.userOptions;\n\t\tthis.#tracker = getGlobalContext().tracker;\n\t\tthis.#data = {};\n\t\tthis.#robots = [];\n\t\tthis.#viewMode = ViewMode.none();\n\t}\n\n\tinit(data: Object, viewMode: number)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t\tif (!Type.isPlainObject(this.#data.CONSTANTS))\n\t\t\t{\n\t\t\t\tthis.#data.CONSTANTS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.PARAMETERS))\n\t\t\t{\n\t\t\t\tthis.#data.PARAMETERS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.VARIABLES))\n\t\t\t{\n\t\t\t\tthis.#data.VARIABLES = {};\n\t\t\t}\n\n\t\t\tthis.markExternalModified(this.#data['IS_EXTERNAL_MODIFIED']);\n\t\t\tthis.markModified(false);\n\t\t}\n\n\t\tthis.#viewMode = ViewMode.fromRaw(viewMode);\n\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#templateNode = this.#templateContainerNode.querySelector(\n\t\t\t\t'[data-role=\"automation-template\"][data-status-id=\"' + this.#data.DOCUMENT_STATUS + '\"]'\n\t\t\t);\n\t\t\tthis.#listNode = this.#templateNode.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.#buttonsNode = this.#templateNode.querySelector('[data-role=\"buttons\"]');\n\t\t\tthis.#topButtonsNode = this.#templateNode.querySelector('[data-role=\"top-buttons\"]');\n\n\t\t\tthis.initRobots();\n\t\t\tthis.initButtons();\n\t\t\tthis.updateTopButtonsVisibility();\n\n\t\t\tif (!this.isExternalModified() && this.canEdit())\n\t\t\t{\n\t\t\t\t//register DD\n\t\t\t\tjsDD.registerDest(this.#templateNode, 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjsDD.unregisterDest(this.#templateNode);\n\t\t\t}\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: number)\n\t{\n\t\tDom.clean(this.#listNode);\n\t\tDom.clean(this.#buttonsNode);\n\t\tDom.clean(this.#topButtonsNode);\n\n\t\tthis.destroy();\n\t\tthis.init(data, viewMode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#robots.forEach(robot => robot.destroy());\n\t}\n\n\tstatic copyRobotTo(dstTemplate: Template, robot: Robot, beforeRobot: ?Robot): Robot\n\t{\n\t\tconst copiedRobot = robot.copyTo(dstTemplate, beforeRobot);\n\t\tdstTemplate.emit('Template:robot:add', {robot: copiedRobot});\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tinitRobots()\n\t{\n\t\tthis.#robots = [];\n\n\t\tif (Type.isArray(this.#data.ROBOTS))\n\t\t{\n\t\t\tfor (let i = 0; i < this.#data.ROBOTS.length; ++i)\n\t\t\t{\n\t\t\t\tconst robot = new Robot({\n\t\t\t\t\tdocument: getGlobalContext().document,\n\t\t\t\t\ttemplate: this,\n\t\t\t\t\tisFrameMode: getGlobalContext().get('isFrameMode'),\n\t\t\t\t\ttracker: this.#tracker,\n\t\t\t\t});\n\t\t\t\trobot.init(this.#data.ROBOTS[i], this.#viewMode);\n\t\t\t\tthis.insertRobotNode(robot.node);\n\t\t\t\tthis.#robots.push(robot);\n\t\t\t}\n\t\t}\n\t}\n\n\tget robots(): Array<Robot>\n\t{\n\t\treturn this.#robots;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.#userOptions;\n\t}\n\n\tgetSelectedRobotNames(): Array<Robot>\n\t{\n\t\tconst selectedRobots = [];\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tif (robot.isSelected())\n\t\t\t{\n\t\t\t\tselectedRobots.push(robot.data.Name);\n\t\t\t}\n\t\t});\n\n\t\treturn selectedRobots;\n\t}\n\n\tgetSerializedRobots()\n\t{\n\t\tconst serialized = [];\n\t\tthis.#robots.forEach(robot => serialized.push(robot.serialize()));\n\n\t\treturn serialized;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.#data.ID;\n\t}\n\n\tgetStatusId(): ?string\n\t{\n\t\treturn this.#data.DOCUMENT_STATUS;\n\t}\n\n\tgetTemplateId()\n\t{\n\t\tconst id = parseInt(this.#data.ID);\n\n\t\treturn !isNaN(id) ? id : 0;\n\t}\n\n\tinitButtons()\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.createExternalLocker();\n\t\t}\n\t\telse if (this.#viewMode.isEdit())\n\t\t{\n\t\t\tthis.createAddButton();\n\n\t\t\tif (this.getTemplateId() > 0)\n\t\t\t{\n\t\t\t\tthis.createConstantsEditButton();\n\t\t\t\tthis.createParametersEditButton();\n\t\t\t\tthis.createExternalEditTemplateButton();\n\t\t\t\tthis.createManageModeButton();\n\t\t\t}\n\t\t}\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\t\tif (isActive)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--multiselect-mode');\n\t\t\t}\n\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.enableManageMode(isActive));\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.edit();\n\t\t\tDom.removeClass(this.#listNode, '--multiselect-mode');\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.disableManageMode());\n\t\t\t}\n\n\t\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t\t});\n\t\t}\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.registerItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.unregisterItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tcreateAddButton()\n\t{\n\t\tconst anchor = () => Dom.create('span', {\n\t\t\tevents: {\n\t\t\t\tclick: event => {\n\t\t\t\t\tif (!this.canEdit())\n\t\t\t\t\t{\n\t\t\t\t\t\tHelpHint.showNoPermissionsHint(event.target);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!this.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onAddButtonClick(event.target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-robot-btn-add'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-btn-add-text',\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ADD'),\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.#topButtonsNode)\n\t\t{\n\t\t\tthis.#topButtonsNode.appendChild(anchor());\n\t\t}\n\n\t\tif (this.#buttonsNode)\n\t\t{\n\t\t\tthis.#buttonsNode.appendChild(anchor());\n\t\t}\n\t}\n\n\tupdateTopButtonsVisibility()\n\t{\n\t\tif (this.#topButtonsNode)\n\t\t{\n\t\t\tlet fn = (this.#robots && this.#robots.length < 1) ? 'hide' : 'show';\n\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tfn = 'show';\n\t\t\t}\n\n\t\t\tBX[fn](this.#topButtonsNode);\n\t\t}\n\t}\n\n\tcreateExternalEditTemplateButton(): undefined | boolean\n\t{\n\t\tif (Type.isNil(getGlobalContext().bizprocEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst self = this;\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: '#'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top'\n\t\t\t}\n\t\t});\n\n\t\tif (!getGlobalContext().bizprocEditorUrl.length)\n\t\t{\n\t\t\tDom.addClass(anchor, 'bizproc-automation-robot-btn-set-locked');\n\t\t}\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateManageModeButton()\n\t{\n\t\tif (!getGlobalContext().canManage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst manageButton = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_MANAGE_ROBOTS'),\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top',\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tcursor: 'pointer',\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: event => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.onManageModeButtonClick(manageButton);\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(manageButton);\n\t}\n\n\tonManageModeButtonClick(manageButtonNode: HTMLElement)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(manageButtonNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('Template:enableManageMode', {\n\t\t\t\tdocumentStatus: this.#data.DOCUMENT_STATUS,\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateConstantsEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(getGlobalContext().constantsEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url =\n\t\t\t!this.#viewMode.isManage()\n\t\t\t\t? getGlobalContext().constantsEditorUrl.replace('#ID#', this.getTemplateId())\n\t\t\t\t: '#'\n\t\t;\n\n\t\tif (!url.length)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CONSTANTS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateParametersEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(getGlobalContext().parametersEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url = getGlobalContext().parametersEditorUrl.replace('#ID#', this.getTemplateId());\n\n\t\tif (!url.length || this.#viewMode.isManage())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_PARAMETERS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateExternalLocker()\n\t{\n\t\tif (this.#topButtonsNode)\n\t\t{\n\t\t\tthis.#topButtonsNode.appendChild(\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: { className: 'bizproc-automation-robot-btn-prohibit' }\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-container\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-robot-container-wrapper bizproc-automation-robot-container-wrapper-lock'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" }\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT_TEXT')\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tEvent.bind(div, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.appendChild(settingsBtn);\n\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEvent.bind(deleteBtn, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onUnsetExternalModifiedClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\t\t}\n\n\t\tthis.#listNode.appendChild(div);\n\t\tthis.#templateNode = div;\n\t}\n\n\tonSearch(event: BaseEvent)\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.onExternalModifiedSearch(event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.forEach(robot => robot.onSearch(event));\n\t\t}\n\t}\n\n\tonExternalModifiedSearch(event)\n\t{\n\t\tif (this.#templateNode)\n\t\t{\n\t\t\tconst query = event.getData().queryString;\n\t\t\tBX[!query ? 'removeClass' : 'addClass'](this.#templateNode, '--search-mismatch');\n\t\t}\n\t}\n\n\tonAddButtonClick(button, context)\n\t{\n\t\tconst menuItems = {\n\t\t\temployee: [],\n\t\t\tclient: [],\n\t\t\tads: [],\n\t\t\tother: []\n\t\t};\n\t\tconst availableRobots = getGlobalContext().availableRobots;\n\n\t\tif (!Type.isPlainObject(context))\n\t\t{\n\t\t\tcontext = {};\n\t\t}\n\n\t\tconst self = this;\n\t\tconst menuItemClickHandler = function (event, item)\n\t\t{\n\t\t\tconst robotData = BX.clone(item.robotData);\n\n\t\t\tif (\n\t\t\t\trobotData['ROBOT_SETTINGS']\n\t\t\t\t&& robotData['ROBOT_SETTINGS']['TITLE_CATEGORY']\n\t\t\t\t&& robotData['ROBOT_SETTINGS']['TITLE_CATEGORY'][item.category]\n\t\t\t)\n\t\t\t{\n\t\t\t\trobotData['NAME'] = robotData['ROBOT_SETTINGS']['TITLE_CATEGORY'][item.category];\n\t\t\t}\n\t\t\telse if (robotData['ROBOT_SETTINGS'] && robotData['ROBOT_SETTINGS']['TITLE'])\n\t\t\t{\n\t\t\t\trobotData['NAME'] = robotData['ROBOT_SETTINGS']['TITLE'];\n\t\t\t}\n\n\t\t\tself.addRobot(robotData, function(robot)\n\t\t\t{\n\t\t\t\tcontext.ADD_MENU_CATEGORY = item.category;\n\t\t\t\tthis.openRobotSettingsDialog(robot, context);\n\t\t\t});\n\n\t\t\tthis.getRootMenuWindow().close();\n\t\t};\n\n\t\tfor (let i = 0; i < availableRobots.length; ++i)\n\t\t{\n\t\t\tif (availableRobots[i]['EXCLUDED'])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst settings =\n\t\t\t\tType.isPlainObject(availableRobots[i]['ROBOT_SETTINGS'])\n\t\t\t\t\t? availableRobots[i]['ROBOT_SETTINGS']\n\t\t\t\t\t: {}\n\t\t\t;\n\n\t\t\tlet title = availableRobots[i].NAME;\n\t\t\tif (settings['TITLE'])\n\t\t\t{\n\t\t\t\ttitle = settings['TITLE'];\n\t\t\t}\n\n\t\t\tlet categories = [];\n\t\t\tif (settings['CATEGORY'])\n\t\t\t{\n\t\t\t\tcategories = Type.isArray(settings['CATEGORY']) ? settings['CATEGORY'] : [settings['CATEGORY']];\n\t\t\t}\n\n\t\t\tif (!categories.length)\n\t\t\t{\n\t\t\t\tcategories.push('other');\n\t\t\t}\n\n\t\t\tfor (let j = 0; j < categories.length; ++j)\n\t\t\t{\n\t\t\t\tif (!menuItems[categories[j]])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tmenuItems[categories[j]].push({\n\t\t\t\t\ttext: title,\n\t\t\t\t\trobotData: availableRobots[i],\n\t\t\t\t\tcategory: categories[j],\n\t\t\t\t\tonclick: menuItemClickHandler,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (menuItems['other'].length > 0)\n\t\t{\n\t\t\tmenuItems['other'].push({delimiter: true});\n\t\t}\n\n\t\tif (Reflection.getClass('BX.rest.Marketplace'))\n\t\t{\n\t\t\tmenuItems['other'].push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER_MARKETPLACE_2'),\n\t\t\t\tonclick()\n\t\t\t\t{\n\t\t\t\t\tBX.rest.Marketplace.open({}, getGlobalContext().get('marketplaceRobotCategory'));\n\t\t\t\t\tthis.getRootMenuWindow().close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenuItems['other'].push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER_MARKETPLACE_2'),\n\t\t\t\thref:\n\t\t\t\t\t'/marketplace/category/%category%/'\n\t\t\t\t\t\t.replace('%category%', getGlobalContext().get('marketplaceRobotCategory')),\n\t\t\t\ttarget: '_blank'\n\t\t\t});\n\t\t}\n\n\t\tlet menuId = button.getAttribute('data-menu-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tbutton.setAttribute('data-menu-id', menuId);\n\t\t}\n\n\t\tconst rootMenuItems = [];\n\t\tif (menuItems['employee'].length > 0)\n\t\t{\n\t\t\trootMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_EMPLOYEE'),\n\t\t\t\titems: menuItems['employee']\n\t\t\t});\n\t\t}\n\t\tif (menuItems['client'].length > 0)\n\t\t{\n\t\t\trootMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_CLIENT'),\n\t\t\t\titems: menuItems['client']\n\t\t\t});\n\t\t}\n\t\tif (menuItems['ads'].length > 0)\n\t\t{\n\t\t\trootMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_ADS'),\n\t\t\t\titems: menuItems['ads']\n\t\t\t});\n\t\t}\n\t\trootMenuItems.push({\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CATEGORY_OTHER'),\n\t\t\titems: menuItems['other']\n\t\t});\n\n\t\tMenuManager.show(\n\t\t\tmenuId,\n\t\t\tbutton,\n\t\t\trootMenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (BX.pos(button)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\tmaxHeight: 550\n\t\t\t}\n\t\t);\n\t}\n\n\tonChangeRobotClick(event)\n\t{\n\t\tthis.onAddButtonClick(event.target, {changeRobot: true});\n\t}\n\n\tonExternalEditTemplateButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t\treturn;\n\t\t}\n\t\tif (!getGlobalContext().bizprocEditorUrl.length)\n\t\t{\n\t\t\tif (top.BX.UI && top.BX.UI.InfoHelper)\n\t\t\t{\n\t\t\t\ttop.BX.UI.InfoHelper.show('limit_office_bp_designer');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst templateId = this.getTemplateId();\n\t\tif (templateId > 0)\n\t\t{\n\t\t\tthis.openBizprocEditor(templateId);\n\t\t}\n\t}\n\n\tonUnsetExternalModifiedClick(button)\n\t{\n\t\tthis.#templateNode = null;\n\n\t\tthis.markExternalModified(false);\n\t\tthis.markModified();\n\t\tthis.reInit(null, this.#viewMode.intoRaw());\n\t}\n\n\topenBizprocEditor(templateId)\n\t{\n\t\ttop.window.location.href = getGlobalContext().bizprocEditorUrl.replace('#ID#', templateId)\n\t}\n\n\taddRobot(robotData, callback)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: getGlobalContext().document,\n\t\t\ttemplate: this,\n\t\t\tisFrameMode: getGlobalContext().get('isFrameMode'),\n\t\t\ttracker: this.#tracker,\n\t\t});\n\t\tconst initData = {\n\t\t\tType: robotData['CLASS'],\n\t\t\tProperties: {\n\t\t\t\tTitle: robotData['NAME']\n\t\t\t}\n\t\t};\n\n\t\tif (this.#robots.length > 0)\n\t\t{\n\t\t\tconst parentRobot = this.#robots[this.#robots.length - 1];\n\t\t\tif (!parentRobot.getDelayInterval().isNow() || parentRobot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\tinitData['Delay'] = parentRobot.getDelayInterval().serialize();\n\t\t\t\tinitData['ExecuteAfterPrevious'] =  1;\n\t\t\t}\n\t\t}\n\n\t\trobot.init(initData, this.#viewMode);\n\t\trobot.draft = true;\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, robot);\n\t\t}\n\t}\n\n\tinsertRobot(robot, beforeRobot)\n\t{\n\t\tif (beforeRobot)\n\t\t{\n\t\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#robots[i] !== beforeRobot)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis.#robots.splice(i, 0, robot);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.push(robot);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tgetNextRobot(robot)\n\t{\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i] === robot)\n\t\t\t{\n\t\t\t\treturn (this.#robots[i + 1] || null);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tdeleteRobot(robot, callback)\n\t{\n\t\tfor(let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i].isEqual(robot))\n\t\t\t{\n\t\t\t\tthis.#robots.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback(robot);\n\t\t}\n\n\t\tthis.markModified();\n\t\tthis.updateTopButtonsVisibility();\n\t}\n\n\tinsertRobotNode(robotNode, beforeNode)\n\t{\n\t\tif (beforeNode)\n\t\t{\n\t\t\tthis.#listNode.insertBefore(robotNode, beforeNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#listNode.appendChild(robotNode);\n\t\t}\n\n\t\tthis.updateTopButtonsVisibility();\n\t}\n\n\topenRobotSettingsDialog(robot: Robot, context?: Object, saveCallback: (Robot) => void)\n\t{\n\t\tif (!Type.isPlainObject(context))\n\t\t{\n\t\t\tcontext = {};\n\t\t}\n\n\t\tif (Designer.getInstance().getRobotSettingsDialog())\n\t\t{\n\t\t\tif (context.changeRobot)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getRobotSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_robot_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t}\n\t\t});\n\n\t\tDesigner.getInstance().setRobotSettingsDialog({\n\t\t\ttemplate: this,\n\t\t\tcontext: context,\n\t\t\trobot: robot,\n\t\t\tform: form\n\t\t});\n\n\t\tform.appendChild(this.renderDelaySettings(robot));\n\t\tform.appendChild(this.renderConditionSettings(robot));\n\t\tif (robot.hasBrokenLink())\n\t\t{\n\t\t\tform.appendChild(this.renderBrokenLinkAlert());\n\t\t}\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {\n\t\t\t\tclick: (event) => this.emit('Template:help:show', event)\n\t\t\t},\n\t\t});\n\t\tform.appendChild(iconHelp);\n\t\tcontext['DOCUMENT_CATEGORY_ID'] = getGlobalContext().document.getCategoryId();\n\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'html',\n\t\t\turl: getGlobalContext().ajaxUrl,\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_robot_dialog',\n\t\t\t\tdocument_signed: getGlobalContext().signedDocument,\n\t\t\t\tdocument_status: getGlobalContext().document.getCurrentStatusId(),\n\t\t\t\tcontext: context,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_name: formName\n\t\t\t},\n\t\t\tonsuccess: html => {\n\t\t\t\tif (html)\n\t\t\t\t{\n\t\t\t\t\tconst dialogRows = Dom.create('div', {\n\t\t\t\t\t\thtml: html\n\t\t\t\t\t});\n\t\t\t\t\tform.appendChild(dialogRows);\n\t\t\t\t}\n\n\t\t\t\tthis.showRobotSettingsPopup(robot, form, saveCallback);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowRobotSettingsPopup(robot: Robot, form: HTMLFormElement, saveCallback: (Robot) => void)\n\t{\n\t\tlet popupMinWidth = 580;\n\t\tlet popupWidth = popupMinWidth;\n\n\t\tif (this.#userOptions)\n\t\t{\n\t\t\tthis.emit('Template:robot:showSettings');\n\t\t\tpopupWidth = parseInt(\n\t\t\t\tthis.#userOptions.get('defaults', 'robot_settings_popup_width', 580)\n\t\t\t);\n\t\t}\n\n\t\tthis.initRobotSettingsControls(robot, form);\n\n\t\tif (\n\t\t\trobot.data.Type === 'CrmSendEmailActivity'\n\t\t\t|| robot.data.Type === 'MailActivity'\n\t\t\t|| robot.data.Type === 'RpaApproveActivity'\n\t\t)\n\t\t{\n\t\t\tpopupMinWidth += 170;\n\t\t\tif (popupWidth < popupMinWidth)\n\t\t\t{\n\t\t\t\tpopupWidth = popupMinWidth;\n\t\t\t}\n\t\t}\n\n\t\tlet titleBar;\n\t\tconst robotTitle =\n\t\t\trobot.hasTitle()\n\t\t\t\t? robot.getTitle()\n\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_SETTINGS_TITLE')\n\t\t;\n\n\t\tif (robot.draft)\n\t\t{\n\t\t\ttitleBar = this.createChangeRobotTitleBar(robotTitle);\n\t\t}\n\n\t\tconst me = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: titleBar || robotTitle,\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\twidth: popupWidth,\n\t\t\tresizable: {\n\t\t\t\tminWidth: popupMinWidth,\n\t\t\t\tminHeight: 100\n\t\t\t},\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\tevents: {\n\t\t\t\tonPopupClose: popup => {\n\t\t\t\t\tthis.currentRobot = null;\n\t\t\t\t\tDesigner.getInstance().setRobotSettingsDialog(null);\n\t\t\t\t\tthis.destroyRobotSettingsControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tthis.emit('Template:robot:closeSettings');\n\t\t\t\t},\n\t\t\t\tonPopupResize: () => {\n\t\t\t\t\tthis.onResizeRobotSettings();\n\t\t\t\t},\n\t\t\t\tonPopupResizeEnd: function() {\n\t\t\t\t\tif (me.#userOptions)\n\t\t\t\t\t{\n\t\t\t\t\t\tme.#userOptions.set(\n\t\t\t\t\t\t\t'defaults',\n\t\t\t\t\t\t\t'robot_settings_popup_width',\n\t\t\t\t\t\t\tthis.getWidth()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tme.saveRobotSettings(form, robot, BX.delegate(function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t\t\tme.emit('Template:robot:add', {robot});\n\t\t\t\t\t\t\t\tif (saveCallback)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsaveCallback(robot);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, this), this.buttonNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick: function(){\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tthis.currentRobot = robot;\n\t\tDesigner.getInstance().getRobotSettingsDialog().popup = popup;\n\t\tpopup.show();\n\t}\n\n\tcreateChangeRobotTitleBar(title)\n\t{\n\t\treturn {\n\t\t\tcontent: BX.Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'popup-window-titlebar-text bizproc-automation-popup-titlebar-with-link'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tdocument.createTextNode(title),\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-titlebar-link'\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHANGE_ROBOT'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: this.onChangeRobotClick.bind(this)\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t]\n\t\t\t})\n\t\t};\n\t}\n\n\tinitRobotSettingsControls(robot, node)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tthis.initRobotSettingsControl(robot, controlNodes[i]);\n\t\t}\n\t}\n\n\tinitRobotSettingsControl(robot, controlNode)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tlet control = null;\n\t\tconst role = controlNode.getAttribute('data-role');\n\n\t\tif (role === 'user-selector')\n\t\t{\n\t\t\tcontrol = new this.#selectors.userSelector(robot, controlNode, this.#data);\n\t\t}\n\t\telse if (role === 'file-selector')\n\t\t{\n\t\t\tcontrol = new this.#selectors.fileSelector(robot, controlNode);\n\t\t}\n\t\telse if (role === 'inline-selector-target')\n\t\t{\n\t\t\tcontrol = new this.#selectors.inlineSelector(robot, controlNode, this.#data);\n\t\t}\n\t\telse if (role === 'inline-selector-html')\n\t\t{\n\t\t\tcontrol = new this.#selectors.inlineSelectorHtml(robot, controlNode);\n\t\t}\n\t\telse if (role === 'time-selector')\n\t\t{\n\t\t\tcontrol = new this.#selectors.timeSelector(controlNode);\n\t\t}\n\t\telse if (role === 'save-state-checkbox')\n\t\t{\n\t\t\tcontrol = new this.#selectors.saveStateCheckbox(controlNode, robot);\n\t\t}\n\n\t\tBX.UI.Hint.init(controlNode);\n\n\t\tif (control)\n\t\t{\n\t\t\tthis.robotSettingsControls.push(control);\n\t\t}\n\t}\n\n\tdestroyRobotSettingsControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.robotSettingsControls = null;\n\t}\n\n\tonBeforeSaveRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onBeforeSave))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onBeforeSave();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonResizeRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onPopupResize))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onPopupResize();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trenderDelaySettings(robot)\n\t{\n\t\tconst delay = robot.getDelayInterval().clone();\n\t\tconst idSalt = Helper.generateUniqueId();\n\n\t\tconst delayTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_type\",\n\t\t\t\tvalue: delay.type\n\t\t\t}\n\t\t});\n\t\tconst delayValueNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value\",\n\t\t\t\tvalue: delay.value\n\t\t\t}\n\t\t});\n\t\tconst delayValueTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value_type\",\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\t\tconst delayBasisNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_basis\",\n\t\t\t\tvalue: delay.basis\n\t\t\t}\n\t\t});\n\t\tconst delayWorkTimeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_worktime\",\n\t\t\t\tvalue: delay.workTime ? 1 : 0\n\t\t\t}\n\t\t});\n\n\t\tconst delayIntervalLabelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t}\n\t\t});\n\n\t\tconst basisFields = [];\n\n\t\tconst docFields = getGlobalContext().document.getFields();\n\t\tconst minLimitM = this.#delayMinLimitM;\n\n\t\tif (Type.isArray(docFields))\n\t\t{\n\t\t\tfor (let i = 0; i < docFields.length; ++i)\n\t\t\t{\n\t\t\t\tconst field = docFields[i];\n\t\t\t\tif (field['Type'] == 'date' || field['Type'] == 'datetime')\n\t\t\t\t{\n\t\t\t\t\tbasisFields.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst delayIntervalSelector = new DelayIntervalSelector({\n\t\t\tlabelNode: delayIntervalLabelNode,\n\t\t\tonchange(delay) {\n\t\t\t\tdelayTypeNode.value = delay.type;\n\t\t\t\tdelayValueNode.value = delay.value;\n\t\t\t\tdelayValueTypeNode.value = delay.valueType;\n\t\t\t\tdelayBasisNode.value = delay.basis;\n\t\t\t\tdelayWorkTimeNode.value = delay.workTime ? 1 : 0;\n\t\t\t},\n\t\t\tbasisFields: basisFields,\n\t\t\tminLimitM: minLimitM,\n\t\t\tuseAfterBasis: true\n\t\t});\n\n\t\tlet executeAfterPreviousBlock = null;\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\tconst executeAfterPreviousCheckbox = Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tid: \"param-group-3-1\" + idSalt,\n\t\t\t\t\tname: \"execute_after_previous\",\n\t\t\t\t\tvalue: '1',\n\t\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (robot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\texecuteAfterPreviousCheckbox.setAttribute('checked', 'checked');\n\t\t\t}\n\t\t\texecuteAfterPreviousBlock = Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\tchildren: [\n\t\t\t\t\texecuteAfterPreviousCheckbox,\n\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tfor: \"param-group-3-1\" + idSalt,\n\t\t\t\t\t\t\tstyle: 'color: #535C69'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS_WIDE')\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings bizproc-automation-popup-settings-flex\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block bizproc-automation-popup-settings-block-flex\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title-wrapper\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tdelayTypeNode,\n\t\t\t\t\t\t\t\tdelayValueNode,\n\t\t\t\t\t\t\t\tdelayValueTypeNode,\n\t\t\t\t\t\t\t\tdelayBasisNode,\n\t\t\t\t\t\t\t\tdelayWorkTimeNode,\n\t\t\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-left\" },\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO_EXECUTE') + \":\"\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdelayIntervalLabelNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\texecuteAfterPreviousBlock\n\t\t\t]\n\t\t});\n\n\t\tdelayIntervalSelector.init(delay);\n\n\t\treturn div;\n\t}\n\n\tsetDelaySettingsFromForm(formFields,  robot)\n\t{\n\t\tconst delay = new DelayInterval();\n\t\tdelay.setType(formFields['delay_type']);\n\t\tdelay.setValue(formFields['delay_value']);\n\t\tdelay.setValueType(formFields['delay_value_type']);\n\t\tdelay.setBasis(formFields['delay_basis']);\n\t\tdelay.setWorkTime(formFields['delay_worktime'] === '1');\n\t\trobot.setDelayInterval(delay);\n\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\trobot.setExecuteAfterPrevious(\n\t\t\t\tformFields['execute_after_previous'] && (formFields['execute_after_previous']) === '1'\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trenderConditionSettings(robot)\n\t{\n\t\tconst conditionGroup = robot.getCondition();\n\t\tconst selector = this.conditionSelector = new ConditionGroupSelector(conditionGroup, {\n\t\t\tfields: getGlobalContext().document.getFields(),\n\t\t});\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\"\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselector.createNode(),\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tsetConditionSettingsFromForm(formFields, robot)\n\t{\n\t\trobot.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\trenderBrokenLinkAlert()\n\t{\n\t\tconst alert = Dom.create('div', {\n\t\t\tattrs: {className:'ui-alert ui-alert-warning ui-alert-icon-info ui-alert-xs'}\n\t\t});\n\n\t\tconst message = Dom.create('span', {\n\t\t\tattrs: {className: 'ui-alert-message'},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_BROKEN_LINK_MESSAGE_ERROR')\n\t\t});\n\n\t\talert.appendChild(message);\n\t\talert.appendChild(Dom.create('span', {\n\t\t\tattrs: {className: 'ui-alert-close-btn'},\n\t\t\tevents: {\n\t\t\t\tclick() {\n\t\t\t\t\talert.style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\treturn alert;\n\t}\n\n\tsaveRobotSettings(form, robot, callback, btnNode)\n\t{\n\t\tif (btnNode)\n\t\t{\n\t\t\tbtnNode.classList.add('popup-window-button-wait');\n\t\t}\n\n\t\tthis.onBeforeSaveRobotSettings();\n\t\tconst formData = BX.ajax.prepareForm(form);\n\n\t\tconst ajaxUrl = getGlobalContext().ajaxUrl;\n\t\tconst documentSigned = getGlobalContext().signedDocument;\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: ajaxUrl,\n\t\t\tdata: {\n\t\t\t\tajax_action: 'save_robot_settings',\n\t\t\t\tdocument_signed: documentSigned,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_data_json: Helper.toJsonString(formData['data']),\n\t\t\t\tform_data: formData['data'], /** @bug 0135641 */\n\t\t\t},\n\t\t\tonsuccess: response => {\n\t\t\t\tif (btnNode)\n\t\t\t\t{\n\t\t\t\t\tbtnNode.classList.remove('popup-window-button-wait');\n\t\t\t\t}\n\n\t\t\t\tif (response.SUCCESS)\n\t\t\t\t{\n\t\t\t\t\trobot.updateData(response.DATA.robot);\n\t\t\t\t\tthis.setDelaySettingsFromForm(formData['data'], robot);\n\t\t\t\t\tthis.setConditionSettingsFromForm(formData['data'], robot);\n\n\t\t\t\t\tif (robot.draft)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#robots.push(robot);\n\t\t\t\t\t\tthis.insertRobotNode(robot.node)\n\t\t\t\t\t}\n\t\t\t\t\trobot.draft = false;\n\n\t\t\t\t\trobot.reInit();\n\t\t\t\t\tthis.markModified();\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(response.DATA)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\talert(response.ERRORS[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tserialize()\n\t{\n\t\tconst data = BX.clone(this.#data);\n\t\tdata['IS_EXTERNAL_MODIFIED'] = this.isExternalModified() ? 1 : 0;\n\t\tdata['ROBOTS'] = [];\n\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tdata['ROBOTS'].push(this.#robots[i].serialize());\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tisExternalModified()\n\t{\n\t\treturn (this.externalModified === true);\n\t}\n\n\tmarkExternalModified(modified)\n\t{\n\t\tthis.externalModified = modified !== false;\n\t}\n\n\tgetRobotById(id)\n\t{\n\t\treturn this.#robots.find(robot => robot.getId() === id);\n\t}\n\n\tisModified()\n\t{\n\t\treturn this.modified;\n\t}\n\n\tmarkModified(modified)\n\t{\n\t\tthis.modified = modified !== false;\n\n\t\tif (this.modified)\n\t\t{\n\t\t\tthis.emit('Template:modified');\n\t\t}\n\t}\n\n\tgetConstants()\n\t{\n\t\tconst constants = [];\n\n\t\tObject.keys(this.#data.CONSTANTS).forEach(id => {\n\t\t\tconst constant = BX.clone(this.#data.CONSTANTS[id]);\n\n\t\t\tconstant.Id = id;\n\t\t\tconstant.ObjectId = 'Constant';\n\t\t\tconstant.SystemExpression = '{=Constant:' + id + '}';\n\t\t\tconstant.Expression = '{{~&:' + id + '}}';\n\n\t\t\tconstants.push(constant);\n\t\t});\n\n\t\treturn constants;\n\t}\n\n\tgetConstant(id)\n\t{\n\t\tconst constants = this.getConstants();\n\n\t\tfor (let i = 0; i < constants.length; ++i)\n\t\t{\n\t\t\tif (constants[i].Id === id)\n\t\t\t{\n\t\t\t\treturn constants[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddConstant(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Constant', this.#data.CONSTANTS);\n\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.CONSTANTS[id] = property;\n\n\t\tthis.emit('Template:constant:add');\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantAdd', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tupdateConstant(id, property)\n\t{\n\t\tif (!this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.CONSTANTS[id].Description = property.Description;\n\n\t\tthis.emit('Template:constant:update', {constant: this.getConstant(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantUpdate', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tdeleteConstant(id)\n\t{\n\t\tdelete this.#data.CONSTANTS[id];\n\n\t\treturn true;\n\t}\n\n\tsetConstantValue(id, value)\n\t{\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthis.#data.CONSTANTS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetParameters()\n\t{\n\t\tconst params = [];\n\n\t\tObject.keys(this.#data.PARAMETERS).forEach(id => {\n\t\t\tconst param = BX.clone(this.#data.PARAMETERS[id]);\n\n\t\t\tparam.Id = id;\n\t\t\tparam.ObjectId = 'Template';\n\t\t\tparam.SystemExpression = '{=Template:' + id + '}';\n\t\t\tparam.Expression = '{{~*:' + id + '}}';\n\n\t\t\tparams.push(param);\n\t\t});\n\n\t\treturn params;\n\t}\n\n\tgetParameter(id)\n\t{\n\t\tconst params = this.getParameters();\n\n\t\tfor (let i = 0; i < params.length; ++i)\n\t\t{\n\t\t\tif (params[i].Id === id)\n\t\t\t{\n\t\t\t\treturn params[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddParameter(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Parameter', this.#data.PARAMETERS);\n\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.PARAMETERS[id] = property;\n\n\t\tthis.emit('Template:parameter:add', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterAdd', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tupdateParameter(id, property)\n\t{\n\t\tif (!this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.PARAMETERS[id].Description = property.Description;\n\n\t\tthis.emit('Template:parameter:update', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterUpdate', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tdeleteParameter(id)\n\t{\n\t\tdelete this.#data.PARAMETERS[id];\n\n\t\treturn true;\n\t}\n\n\tsetParameterValue(id, value)\n\t{\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthis.#data.PARAMETERS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetVariables()\n\t{\n\t\tconst variables = [];\n\n\t\tObject.keys(this.#data.VARIABLES).forEach(id => {\n\t\t\tconst variable = BX.clone(this.#data.VARIABLES[id]);\n\n\t\t\tvariable.Id = id;\n\t\t\tvariable.ObjectId = 'Variable';\n\t\t\tvariable.SystemExpression = '{=Variable:' + id + '}';\n\t\t\tvariable.Expression = '{=Variable:' + id + '}';\n\n\t\t\tvariables.push(variable);\n\t\t});\n\n\t\treturn variables;\n\t}\n\n\tgeneratePropertyId(prefix, existsList)\n\t{\n\t\tlet index;\n\t\tfor(index = 1; index <= 1000; ++index)\n\t\t{\n\t\t\tif (!existsList[prefix + index])\n\t\t\t{\n\t\t\t\tbreak; //found\n\t\t\t}\n\t\t}\n\n\t\treturn prefix + index;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tconst robotUsages = robot.collectUsages();\n\n\t\t\tObject.keys(usages).forEach(key => {\n\t\t\t\trobotUsages[key].forEach(usage => {\n\t\t\t\t\tif (!usages[key].has(usage))\n\t\t\t\t\t{\n\t\t\t\t\t\tusages[key].add(usage);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn usages;\n\t}\n\n\tsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.#robots.forEach(robot => robot.subscribe(eventName, listener))\n\n\t\treturn this;\n\t}\n\n\tunsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void)\n\t{\n\t\tthis.#robots.forEach(robot => robot.unsubscribe(eventName, listener));\n\n\t\treturn this;\n\t}\n\n\tgetRobotDescription(type: string): ?object\n\t{\n\t\treturn getGlobalContext().availableRobots.find(item => item['CLASS'] === type);\n\t}\n\n\tsetGlobalVariables(globalVariables: Array = []): this\n\t{\n\t\tthis.globalVariables = globalVariables;\n\n\t\treturn this;\n\t}\n\n\tsetGlobalConstants(globalConstants: Array = []): this\n\t{\n\t\tthis.globalConstants = globalConstants;\n\n\t\treturn this;\n\t}\n}","import { Type } from 'main.core';\n\nexport class Condition\n{\n\t#object: string;\n\t#field: string;\n\t#operator: string;\n\t#value: string;\n\n\tparentGroup;\n\n\tconstructor(params: ?Object, group)\n\t{\n\t\tthis.#object = 'Document';\n\t\tthis.#field = '';\n\t\tthis.#operator = '!empty';\n\t\tthis.#value = '';\n\n\t\tthis.parentGroup = null;\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['object'])\n\t\t\t{\n\t\t\t\tthis.setObject(params['object']);\n\t\t\t}\n\t\t\tif (params['field'])\n\t\t\t{\n\t\t\t\tthis.setField(params['field']);\n\t\t\t}\n\t\t\tif (params['operator'])\n\t\t\t{\n\t\t\t\tthis.setOperator(params['operator']);\n\t\t\t}\n\t\t\tif ('value' in params)\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t}\n\t\tif (group)\n\t\t{\n\t\t\tthis.parentGroup = group;\n\t\t}\n\t}\n\n\tclone(): Condition\n\t{\n\t\treturn new Condition(\n\t\t\t{\n\t\t\t\tobject: this.#object,\n\t\t\t\tfield: this.#field,\n\t\t\t\toperator: this.#operator,\n\t\t\t\tvalue: this.#value,\n\t\t\t},\n\t\t\tthis.parentGroup,\n\t\t);\n\t}\n\n\tsetObject(object)\n\t{\n\t\tif (Type.isStringFilled(object))\n\t\t{\n\t\t\tthis.#object = object;\n\t\t}\n\t}\n\n\tget object()\n\t{\n\t\treturn this.#object;\n\t}\n\n\tsetField(field)\n\t{\n\t\tif (Type.isStringFilled(field))\n\t\t{\n\t\t\tthis.#field = field;\n\t\t}\n\t}\n\n\tget field()\n\t{\n\t\treturn this.#field;\n\t}\n\n\tsetOperator(operator)\n\t{\n\t\tif (!operator)\n\t\t{\n\t\t\toperator = '=';\n\t\t}\n\n\t\tthis.#operator = operator;\n\t}\n\n\tget operator(): string\n\t{\n\t\treturn this.#operator;\n\t}\n\n\tsetValue(value)\n\t{\n\t\tthis.#value = value;\n\t\tif (this.#operator === '=' && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = 'empty';\n\t\t}\n\t\telse if (this.#operator === '!=' && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = '!empty';\n\t\t}\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\tobject: this.#object,\n\t\t\tfield: this.#field,\n\t\t\toperator: this.#operator,\n\t\t\tvalue: this.#value\n\t\t}\n\t}\n}","import { Type, Loc } from 'main.core';\nimport { Condition } from './condition';\n\nexport class ConditionGroup\n{\n\tstatic CONDITION_TYPE = {\n\t\tField: 'field',\n\t\tMixed: 'mixed',\n\t}\n\tstatic JOINER = {\n\t\tAnd: 'AND',\n\t\tOr: 'OR',\n\n\t\tmessage(type)\n\t\t{\n\t\t\tif (type === this.Or)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_OR');\n\t\t\t}\n\n\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_AND');\n\t\t}\n\t}\n\n\t#type: string;\n\t#items: Array<[Condition, string]>;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tthis.#type = ConditionGroup.CONDITION_TYPE.field;\n\t\tthis.#items = [];\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.#type = params['type'];\n\t\t\t}\n\t\t\tif (Type.isArray(params['items']))\n\t\t\t{\n\t\t\t\tparams['items'].forEach(item => {\n\t\t\t\t\tconst condition = new Condition(item[0], this);\n\t\t\t\t\tthis.addItem(condition, item[1]);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tclone()\n\t{\n\t\tconst clonedGroup = new ConditionGroup({type: this.#type});\n\t\tthis.#items.forEach(([condition, joiner]) => {\n\t\t\tconst clonedCondition = condition.clone();\n\t\t\tclonedCondition.parentGroup = clonedGroup;\n\n\t\t\tclonedGroup.addItem(clonedCondition, joiner);\n\t\t});\n\n\t\treturn clonedGroup;\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tset type(type: string)\n\t{\n\t\tif (Object.values(ConditionGroup.CONDITION_TYPE).includes(type))\n\t\t{\n\t\t\tthis.#type = type;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget items()\n\t{\n\t\treturn this.#items;\n\t}\n\n\tstatic createFromForm(formFields, prefix)\n\t{\n\t\tconst conditionGroup = new ConditionGroup();\n\t\tif (!prefix)\n\t\t{\n\t\t\tprefix = 'condition_';\n\t\t}\n\n\t\tif (Type.isArray(formFields[prefix + 'field']))\n\t\t{\n\t\t\tfor (let i = 0; i < formFields[prefix + 'field'].length; ++i)\n\t\t\t{\n\t\t\t\tif (formFields[prefix + 'field'][i] === '')\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst condition = new Condition({}, conditionGroup);\n\t\t\t\tcondition.setObject(formFields[prefix + 'object'][i]);\n\t\t\t\tcondition.setField(formFields[prefix + 'field'][i]);\n\t\t\t\tcondition.setOperator(formFields[prefix + 'operator'][i]);\n\t\t\t\tcondition.setValue(formFields[prefix + 'value'][i]);\n\n\t\t\t\tlet joiner = ConditionGroup.JOINER.And;\n\t\t\t\tif (formFields[prefix + 'joiner'] && formFields[prefix + 'joiner'][i] === ConditionGroup.JOINER.Or)\n\t\t\t\t{\n\t\t\t\t\tjoiner = ConditionGroup.JOINER.Or;\n\t\t\t\t}\n\n\t\t\t\tconditionGroup.addItem(condition, joiner);\n\t\t\t}\n\t\t}\n\n\t\treturn conditionGroup;\n\t}\n\n\taddItem(condition, joiner)\n\t{\n\t\tthis.#items.push([condition, joiner]);\n\t}\n\n\tgetItems(): Array<Array<Condition, string>>\n\t{\n\t\treturn this.#items;\n\t}\n\n\tserialize()\n\t{\n\t\tconst itemsArray = [];\n\n\t\tthis.#items.forEach(item => {\n\t\t\tif (item.field !== '')\n\t\t\t{\n\t\t\t\titemsArray.push([item[0].serialize(), item[1]]);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\titems: itemsArray\n\t\t};\n\t}\n}","import { Condition, ConditionGroup, Designer } from 'bizproc.automation';\nimport { Dom, Type, Event, Loc } from 'main.core';\n\nexport class ConditionSelector\n{\n\t#condition: ?Condition;\n\t#fields: Array<Object>;\n\t#joiner: string;\n\t#fieldPrefix: string;\n\n\tnode: ?HTMLElement;\n\tobjectNode: ?HTMLElement;\n\tfieldNode: ?HTMLElement;\n\tjoinerNode: ?HTMLElement;\n\tlabelNode: ?HTMLElement;\n\n\tpopup: BX.PopupWindow;\n\tfieldDialog;\n\t#inlineSelector;\n\n\tconstructor(condition, options)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.#fields = [];\n\t\tthis.#joiner = ConditionGroup.JOINER.And;\n\t\tthis.#fieldPrefix = 'condition_';\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields.map(field => {\n\t\t\t\t\tfield.ObjectId = 'Document';\n\n\t\t\t\t\treturn field;\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (options.joiner && options.joiner === ConditionGroup.JOINER.Or)\n\t\t\t{\n\t\t\t\tthis.#joiner = ConditionGroup.JOINER.Or;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst conditionObjectNode = this.objectNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"object[]\",\n\t\t\t\tvalue: this.#condition.object\n\t\t\t}\n\t\t});\n\t\tconst conditionFieldNode = this.fieldNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"field[]\",\n\t\t\t\tvalue: this.#condition.field\n\t\t\t}\n\t\t});\n\t\tconst conditionOperatorNode = this.operatorNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"operator[]\",\n\t\t\t\tvalue: this.#condition.operator\n\t\t\t}\n\t\t});\n\t\tconst conditionValueNode = this.valueNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"value[]\",\n\t\t\t\tvalue: this.#condition.value\n\t\t\t}\n\t\t});\n\n\t\tconst conditionJoinerNode = this.joinerNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"joiner[]\",\n\t\t\t\tvalue: this.#joiner\n\t\t\t}\n\t\t});\n\n\t\tconst labelNode = this.labelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-wrapper\"\n\t\t\t}\n\t\t});\n\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\n\t\tconst removeButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-remove\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: this.removeCondition.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst joinerButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-condition-joiner\"\n\t\t\t},\n\t\t\ttext: ConditionGroup.JOINER.message(this.#joiner),\n\t\t});\n\n\t\tEvent.bind(joinerButtonNode, 'click', this.changeJoiner.bind(this, joinerButtonNode));\n\n\t\tthis.node = Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper bizproc-automation-condition-wrapper\" },\n\t\t\tchildren: [\n\t\t\t\tconditionObjectNode,\n\t\t\t\tconditionFieldNode,\n\t\t\t\tconditionOperatorNode,\n\t\t\t\tconditionValueNode,\n\t\t\t\tconditionJoinerNode,\n\t\t\t\tlabelNode,\n\t\t\t\tremoveButtonNode,\n\t\t\t\tjoinerButtonNode\n\t\t\t]\n\t\t});\n\n\t\treturn this.node;\n\t}\n\n\tinit(condition: Condition)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (!this.labelNode || !this.#condition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.labelNode);\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\tconst field = this.getField(this.#condition.object, this.#condition.field) || '?';\n\t\t\tconst valueLabel =\n\t\t\t\t(this.#condition.operator.indexOf('empty') < 0)\n\t\t\t\t\t? BX.Bizproc.FieldType.formatValuePrintable(field, this.#condition.value)\n\t\t\t\t\t: null\n\t\t\t;\n\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: field.Name\n\t\t\t}));\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: this.getOperatorLabel(this.#condition.operator)\n\t\t\t}));\n\t\t\tif (valueLabel)\n\t\t\t{\n\t\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: valueLabel\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY')\n\t\t\t}));\n\t\t}\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', this.onLabelClick.bind(this));\n\t\t}\n\t}\n\n\tonLabelClick()\n\t{\n\t\tthis.showPopup();\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.show();\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = this.filterFields();\n\n\t\tconst objectSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelectLabel = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown',\n\t\t\t\treadonly: 'readonly'\n\t\t\t},\n\t\t\tchildren: [fieldSelect]\n\t\t});\n\n\t\tEvent.bind(\n\t\t\tfieldSelectLabel,\n\t\t\t'click',\n\t\t\tthis.onFieldSelectorClick.bind(this, fieldSelectLabel, fieldSelect, fields, objectSelect)\n\t\t);\n\n\t\tlet selectedField = this.getField(this.#condition.object, this.#condition.field);\n\t\tif (!this.#condition.field)\n\t\t{\n\t\t\tselectedField = fields[0];\n\t\t}\n\t\tfieldSelect.value = selectedField.Id;\n\t\tobjectSelect.value = selectedField.ObjectId;\n\t\tfieldSelectLabel.textContent = selectedField.Name;\n\n\t\tconst valueInput = (this.#condition.operator.indexOf('empty') < 0)\n\t\t\t? this.createValueNode(selectedField, this.#condition.value) : null;\n\n\t\tconst valueWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [valueInput]\n\t\t});\n\n\t\tconst operatorSelect = this.createOperatorNode(selectedField, valueWrapper);\n\t\tconst operatorWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [operatorSelect]\n\t\t});\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\toperatorSelect.value = this.#condition.operator;\n\t\t}\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [fieldSelectLabel]\n\t\t\t\t}),\n\t\t\t\toperatorWrapper,\n\t\t\t\tvalueWrapper\n\t\t\t]\n\t\t});\n\n\t\tEvent.bind(fieldSelect, 'change', this.onFieldChange.bind(\n\t\t\tthis,\n\t\t\tfieldSelect,\n\t\t\toperatorWrapper,\n\t\t\tvalueWrapper,\n\t\t\tobjectSelect\n\t\t));\n\n\t\tconst self = this;\n\t\tthis.popup = new BX.PopupWindow('bizproc-automation-popup-set', this.labelNode, {\n\t\t\tclassName: 'bizproc-automation-popup-set',\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 45,\n\t\t\toverlay: { backgroundColor: 'transparent' },\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: \"webform-button webform-button-create\" ,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.#condition.setObject(objectSelect.value);\n\t\t\t\t\t\t\tself.#condition.setField(fieldSelect.value);\n\t\t\t\t\t\t\tself.#condition.setOperator(operatorWrapper.firstChild.value);\n\n\t\t\t\t\t\t\tconst valueInput = valueWrapper.querySelector('[name^=\"' + self.#fieldPrefix + 'value\"]');\n\n\t\t\t\t\t\t\tif (valueInput)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#condition.setValue(valueInput.value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#condition.setValue('');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.setLabelText();\n\t\t\t\t\t\t\tself.updateValueNode();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t\tif (self.fieldDialog)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldDialog.destroy();\n\t\t\t\t\t\tdelete(self.fieldDialog);\n\t\t\t\t\t}\n\t\t\t\t\tdelete(self.popup);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.popup.show();\n\t}\n\n\tonFieldSelectorClick(fieldSelectLabel, fieldSelect, fields, objectSelect, event)\n\t{\n\t\tif (!this.fieldDialog)\n\t\t{\n\t\t\tthis.fieldDialog = new BX.Bizproc.Automation.Selector.InlineSelectorCondition(fieldSelectLabel, fields, function(property)\n\t\t\t{\n\t\t\t\tfieldSelectLabel.textContent = property.Name\n\t\t\t\tfieldSelect.value = property.Id;\n\t\t\t\tobjectSelect.value = property.ObjectId;\n\t\t\t\tBX.fireEvent(fieldSelect, 'change');\n\t\t\t}, this.#condition);\n\t\t}\n\n\t\tthis.fieldDialog.openMenu(event);\n\t}\n\n\tupdateValueNode()\n\t{\n\t\tif (this.#condition)\n\t\t{\n\t\t\tif (this.objectNode)\n\t\t\t{\n\t\t\t\tthis.objectNode.value = this.#condition.object;\n\t\t\t}\n\t\t\tif (this.fieldNode)\n\t\t\t{\n\t\t\t\tthis.fieldNode.value = this.#condition.field;\n\t\t\t}\n\t\t\tif (this.operatorNode)\n\t\t\t{\n\t\t\t\tthis.operatorNode.value = this.#condition.operator;\n\t\t\t}\n\t\t\tif (this.valueNode)\n\t\t\t{\n\t\t\t\tthis.valueNode.value = this.#condition.value;\n\t\t\t}\n\t\t}\n\t}\n\n\tonFieldChange(selectNode: Node, conditionWrapper: Node, valueWrapper: Node, objectSelect)\n\t{\n\t\tconst field = this.getField(objectSelect.value, selectNode.value);\n\t\tconst operatorNode = this.createOperatorNode(field, valueWrapper);\n\t\tconditionWrapper.replaceChild(operatorNode, conditionWrapper.firstChild);\n\t\tthis.onOperatorChange(operatorNode, field, valueWrapper);\n\t}\n\n\tonOperatorChange(selectNode: Node, field: Object, valueWrapper: Node)\n\t{\n\t\tDom.clean(valueWrapper);\n\n\t\tif (selectNode.value.indexOf('empty') < 0)\n\t\t{\n\t\t\tconst valueNode = this.createValueNode(field);\n\t\t\tvalueWrapper.appendChild(valueNode);\n\t\t}\n\t}\n\n\t// TODO - fix this method\n\tgetField(object, id)\n\t{\n\t\tlet field;\n\t\tconst robot = Designer.getInstance().robot;\n\t\tconst component = Designer.getInstance().component;\n\t\tconst tpl = robot? robot.getTemplate() : null;\n\n\t\tswitch (object)\n\t\t{\n\t\t\tcase 'Document':\n\t\t\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (id === this.#fields[i].Id)\n\t\t\t\t\t{\n\t\t\t\t\t\tfield = this.#fields[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Template':\n\t\t\t\tif (tpl && component && component.triggerManager)\n\t\t\t\t{\n\t\t\t\t\tfield = component.triggerManager.getReturnProperty(tpl.getStatusId(), id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Constant':\n\t\t\t\tif (tpl)\n\t\t\t\t{\n\t\t\t\t\tfield = tpl.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalConst':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalVar':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getGVariable(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tvar foundRobot = tpl? tpl.getRobotById(object) : null;\n\t\t\t\tif (foundRobot)\n\t\t\t\t{\n\t\t\t\t\tfield = foundRobot.getReturnProperty(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn field || {\n\t\t\tId: id,\n\t\t\tObjectId: object,\n\t\t\tName: id,\n\t\t\tType: 'string',\n\t\t\tExpression: id,\n\t\t\tSystemExpression: '{='+object+':'+id+'}'\n\t\t};\n\t}\n\n\tgetOperators(fieldType, multiple)\n\t{\n\t\tlet list = {\n\t\t\t'!empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_EMPTY'),\n\t\t\t'empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY'),\n\t\t\t'=': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EQ'),\n\t\t\t'!=': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NE')\n\t\t};\n\t\tswitch (fieldType)\n\t\t{\n\t\t\tcase 'file':\n\t\t\tcase 'UF:crm':\n\t\t\tcase 'UF:resourcebooking':\n\t\t\t\tlist = {\n\t\t\t\t\t'!empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_EMPTY'),\n\t\t\t\t\t'empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY')\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'bool':\n\t\t\tcase 'select':\n\t\t\t\tif (multiple)\n\t\t\t\t{\n\t\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//TODO: render multiple select in value selector\n\t\t\t\t\t//list['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'user':\n\t\t\t\tlist['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\tlist['!in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_IN');\n\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlist['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\tlist['!in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_IN');\n\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\tlist['>'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_GT');\n\t\t\t\tlist['>='] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_GTE');\n\t\t\t\tlist['<'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_LT');\n\t\t\t\tlist['<='] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_LTE');\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetOperatorLabel(id)\n\t{\n\t\treturn this.getOperators()[id];\n\t}\n\n\tfilterFields()\n\t{\n\t\tconst filtered = [];\n\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t{\n\t\t\tconst type = this.#fields[i]['Type'];\n\n\t\t\tif (\n\t\t\t\ttype === 'bool'\n\t\t\t\t|| type === 'date'\n\t\t\t\t|| type === 'datetime'\n\t\t\t\t|| type === 'double'\n\t\t\t\t|| type === 'file'\n\t\t\t\t|| type === 'int'\n\t\t\t\t|| type === 'select'\n\t\t\t\t|| type === 'string'\n\t\t\t\t|| type === 'text'\n\t\t\t\t|| type === 'user'\n\t\t\t\t|| type === 'UF:money'\n\t\t\t\t|| type === 'UF:crm'\n\t\t\t\t|| type === 'UF:resourcebooking'\n\t\t\t\t|| type === 'UF:url'\n\t\t\t)\n\t\t\t{\n\t\t\t\tfiltered.push(this.#fields[i]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//TODO add support of custom types\n\t\t\t}\n\t\t}\n\n\t\treturn filtered;\n\t}\n\n\tcreateValueNode(docField, value)\n\t{\n\t\tconst docType = (\n\t\t\tDesigner.getInstance().component\n\t\t\t\t? Designer.getInstance().component.document.getRawType()\n\t\t\t\t: BX.Bizproc.Automation.API.documentType\n\t\t);\n\t\tconst field = BX.clone(docField);\n\t\tfield.Multiple = false;\n\n\t\treturn BX.Bizproc.FieldType.renderControl(\n\t\t\tdocType,\n\t\t\tfield,\n\t\t\tthis.#fieldPrefix + 'value',\n\t\t\tvalue\n\t\t);\n\t}\n\n\tcreateOperatorNode(field, valueWrapper)\n\t{\n\t\tconst select = Dom.create('select', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'}\n\t\t});\n\n\t\tconst operatorList = this.getOperators(field['Type'], field['Multiple']);\n\t\tfor (var operatorId in operatorList)\n\t\t{\n\t\t\tif (!operatorList.hasOwnProperty(operatorId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\tprops: {value: operatorId},\n\t\t\t\ttext: operatorList[operatorId]\n\t\t\t}));\n\t\t}\n\n\t\tEvent.bind(select, 'change', this.onOperatorChange.bind(\n\t\t\tthis,\n\t\t\tselect,\n\t\t\tfield,\n\t\t\tvalueWrapper\n\t\t));\n\n\t\treturn select;\n\t}\n\n\tremoveCondition(event: Event)\n\t{\n\t\tthis.#condition = null;\n\t\tDom.remove(this.node);\n\t\tthis.labelNode = this.fieldNode = this.operatorNode = this.valueNode = this.node = null;\n\n\t\tevent.stopPropagation();\n\t}\n\n\tchangeJoiner(btn: Element, event: Event)\n\t{\n\t\tthis.#joiner = (this.#joiner === ConditionGroup.JOINER.Or ? ConditionGroup.JOINER.And : ConditionGroup.JOINER.Or);\n\t\tbtn.textContent = ConditionGroup.JOINER.message(this.#joiner);\n\n\t\tif (this.joinerNode)\n\t\t{\n\t\t\tthis.joinerNode.value = this.#joiner;\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n}","import { Type, Dom } from 'main.core';\nimport { ConditionGroup } from './condition-group';\nimport { ConditionSelector } from './condition-selector';\nimport { Condition } from 'bizproc.automation';\n\nexport class ConditionGroupSelector\n{\n\t#conditionGroup: ConditionGroup;\n\t#fields: Array<Object>;\n\t#fieldPrefix: string;\n\t#itemSelectors: Array<ConditionSelector>;\n\n\tconstructor(conditionGroup: ConditionGroup, options: Object)\n\t{\n\t\tthis.#conditionGroup = conditionGroup;\n\t\tthis.#fields = [];\n\t\tthis.#fieldPrefix = 'condition_';\n\t\tthis.#itemSelectors = [];\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst me = this;\n\t\tconst conditionNodes = [];\n\t\tconst fields = this.#fields;\n\n\t\tthis.#conditionGroup.getItems().forEach(function(item)\n\t\t{\n\t\t\tconst conditionSelector = new ConditionSelector(item[0], {\n\t\t\t\tfields: fields,\n\t\t\t\tjoiner: item[1],\n\t\t\t\tfieldPrefix: me.#fieldPrefix,\n\t\t\t});\n\n\t\t\tthis.#itemSelectors.push(conditionSelector);\n\t\t\tconditionNodes.push(conditionSelector.createNode());\n\t\t}, this);\n\n\t\tconditionNodes.push(Dom.create(\"a\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link\" },\n\t\t\ttext: '[+]',\n\t\t\tevents: {\n\t\t\t\tclick()\n\t\t\t\t{\n\t\t\t\t\tme.addItem(this);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\treturn Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper\" },\n\t\t\tchildren: conditionNodes\n\t\t});\n\t}\n\n\taddItem(buttonNode)\n\t{\n\t\tconst conditionSelector = new ConditionSelector(new Condition({}, this.#conditionGroup), {\n\t\t\tfields: this.#fields,\n\t\t\tfieldPrefix: this.#fieldPrefix,\n\t\t});\n\t\tthis.#itemSelectors.push(conditionSelector);\n\n\t\tbuttonNode.parentNode.insertBefore(conditionSelector.createNode(), buttonNode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#itemSelectors.forEach(selector => selector.destroy());\n\t\tthis.#itemSelectors = [];\n\t}\n}","import { Type, Loc, Event, Dom, Text } from 'main.core';\nimport { Helper } from './helper';\nimport { DelayInterval } from './delay-interval';\nimport { MenuManager } from 'main.popup';\n\nexport class DelayIntervalSelector\n{\n\tbasisFields: Array;\n\tonchange: () => void;\n\tlabelNode;\n\tuseAfterBasis;\n\tminLimitH;\n\n\tdelay;\n\n\tconstructor(options)\n\t{\n\t\tthis.basisFields = [];\n\t\tthis.onchange = null;\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.labelNode = options.labelNode;\n\t\t\tthis.useAfterBasis = options.useAfterBasis;\n\n\t\t\tif (Type.isArray(options.basisFields))\n\t\t\t{\n\t\t\t\tthis.basisFields = options.basisFields;\n\t\t\t}\n\t\t\tthis.onchange = options.onchange;\n\t\t\tthis.minLimitM = options.minLimitM;\n\t\t}\n\t}\n\n\tinit(delay)\n\t{\n\t\tthis.delay = delay;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t\tthis.prepareBasisFields();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (this.delay && this.labelNode)\n\t\t{\n\t\t\tthis.labelNode.textContent = this.delay.format(\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\t\tthis.basisFields\n\t\t\t);\n\t\t}\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', BX.delegate(this.onLabelClick, this));\n\t\t}\n\t}\n\n\tonLabelClick(event)\n\t{\n\t\tthis.showDelayIntervalPopup();\n\t\tevent.preventDefault();\n\t}\n\n\tshowDelayIntervalPopup()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" }\n\t\t});\n\n\t\tconst radioNow = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid + \"now\",\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: 'now',\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.isNow())\n\t\t{\n\t\t\tradioNow.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst labelNow = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid + \"now\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_BASIS_NOW' : 'BIZPROC_AUTOMATION_CMP_AT_ONCE_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tconst labelNowHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP_2' : 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP')\n\t\t\t}\n\t\t});\n\t\tlabelNow.appendChild(labelNowHelpNode);\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioNow, labelNow]\n\t\t}));\n\n\t\tform.appendChild(this.createAfterControlNode());\n\n\t\tif (this.basisFields.length > 0)\n\t\t{\n\t\t\tform.appendChild(this.createBeforeControlNode());\n\t\t\tform.appendChild(this.createInControlNode());\n\t\t}\n\n\t\tconst workTimeRadio = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\",\n\t\t\t\tid: uid + \"worktime\",\n\t\t\t\tname: \"worktime\",\n\t\t\t\tvalue: '1',\n\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tchecked: delay.workTime\n\t\t\t}\n\t\t});\n\n\t\tconst workTimeHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_WORKTIME_HELP_2')\n\t\t\t}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\tchildren: [\n\t\t\t\tworkTimeRadio,\n\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-lbl\",\n\t\t\t\t\t\tfor: uid + \"worktime\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_WORK_TIME')\n\t\t\t\t}),\n\t\t\t\tworkTimeHelpNode\n\t\t\t]\n\t\t}));\n\n\t\tconst self = this;\n\t\t//init modern Help tips\n\t\tBX.UI.Hint.init(form);\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), this.labelNode, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 20,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: 'webform-button webform-button-create bizproc-automation-button-left',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\t\t\t\t\tself.saveFormData(formData['data']);\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tif (self.fieldsMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldsMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tif (self.valueTypeMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.valueTypeMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tsaveFormData(formData)\n\t{\n\t\tif (formData['type'] === 'now')\n\t\t{\n\t\t\tthis.delay.setNow();\n\t\t}\n\t\telse if (formData['type'] === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tthis.delay.setType(DelayInterval.DELAY_TYPE.In);\n\t\t\tthis.delay.setValue(0);\n\t\t\tthis.delay.setValueType('i');\n\t\t\tthis.delay.setBasis(formData['basis_in']);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.delay.setType(formData['type']);\n\t\t\tthis.delay.setValue(formData['value_' + formData['type']]);\n\t\t\tthis.delay.setValueType(formData['value_type_'+formData['type']]);\n\n\t\t\tif (formData['type'] === DelayInterval.DELAY_TYPE.After)\n\t\t\t{\n\t\t\t\tif (this.useAfterBasis)\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(formData['basis_after']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis.minLimitM > 0\n\t\t\t\t\t&& this.delay.basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t\t\t&& this.delay.valueType === 'i'\n\t\t\t\t\t&& this.delay.value < this.minLimitM\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('BIZPROC_AUTOMATION_DELAY_MIN_LIMIT_LABEL')\n\t\t\t\t\t});\n\t\t\t\t\tthis.delay.setValue(this.minLimitM);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.delay.setBasis(formData['basis_before']);\n\t\t\t}\n\t\t}\n\n\t\tthis.delay.setWorkTime(formData['worktime']);\n\t\tthis.setLabelText();\n\n\t\tif (this.onchange)\n\t\t{\n\t\t\tthis.onchange(this.delay);\n\t\t}\n\t}\n\n\tcreateAfterControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioAfter = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.After,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.After && delay.value > 0)\n\t\t{\n\t\t\tradioAfter.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_after',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.After && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelAfter = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_after')\n\t\t\t]\n\t\t});\n\n\t\tif (this.useAfterBasis)\n\t\t{\n\t\t\tlabelAfter.appendChild(Dom.create('span', {\n\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t}));\n\n\t\t\tlet basisField = this.getBasisField(delay.basis, true);\n\t\t\tlet basisValue = delay.basis;\n\t\t\tif (!basisField)\n\t\t\t{\n\t\t\t\tbasisField = this.getBasisField(DelayInterval.BASIS_TYPE.CurrentDateTime, true);\n\t\t\t\tbasisValue = basisField.SystemExpression;\n\t\t\t}\n\n\t\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: \"basis_after\",\n\t\t\t\t\tvalue: basisValue\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t\t},\n\t\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick(event)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onBasisClick(event, this, function(field)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t}, DelayInterval.DELAY_TYPE.After);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(beforeBasisValueNode);\n\t\t\tlabelAfter.appendChild(beforeBasisNode);\n\t\t}\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst afterHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_AFTER_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(afterHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioAfter, labelAfter]\n\t\t});\n\t}\n\n\tcreateBeforeControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioBefore = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.Before,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tradioBefore.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_before',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.Before && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelBefore = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_before'),\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_before\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t(field) => {\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tDelayInterval.DELAY_TYPE.Before\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tlabelBefore.appendChild(beforeBasisValueNode);\n\t\tlabelBefore.appendChild(beforeBasisNode);\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst beforeHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_BEFORE_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelBefore.appendChild(beforeHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioBefore, labelBefore]\n\t\t});\n\t}\n\n\tcreateInControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioIn = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.In,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tradioIn.setAttribute('checked', 'checked');\n\t\t}\n\n\n\t\tconst labelIn = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst inBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_in\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst inBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tfield => {\n\t\t\t\t\t\t\tinBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tinBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tlabelIn.appendChild(inBasisValueNode);\n\t\tlabelIn.appendChild(inBasisNode);\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst helpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_IN_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelIn.appendChild(helpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioIn, labelIn]\n\t\t});\n\t}\n\n\tcreateValueTypeSelector(name)\n\t{\n\t\tconst delay = this.delay;\n\t\tconst labelTexts = {\n\t\t\ti: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\th: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\td: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D')\n\t\t};\n\n\t\tconst label = Dom.create('label', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-link'},\n\t\t\ttext: labelTexts[delay.valueType],\n\t\t});\n\n\t\tconst input = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tname: name\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(label, 'click', this.onValueTypeSelectorClick.bind(this, label, input));\n\n\t\treturn Dom.create('span', {\n\t\t\tchildren: [label, input]\n\t\t});\n\t}\n\n\tonValueTypeSelectorClick(label, input)\n\t{\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst handler = function(event, item)\n\t\t{\n\t\t\tthis.popupWindow.close();\n\t\t\tinput.value = item.valueId;\n\t\t\tlabel.textContent = item.text;\n\t\t};\n\n\t\tconst menuItems = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\t\tvalueId: 'i',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\t\tvalueId: 'h',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D'),\n\t\t\t\tvalueId: 'd',\n\t\t\t\tonclick: handler\n\t\t\t}\n\t\t];\n\n\t\tMenuManager.show(\n\t\t\tuid,\n\t\t\tlabel,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 25,\n\t\t\t\tangle: { position: 'top'},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.valueTypeMenu = MenuManager.currentItem;\n\t}\n\n\tonBasisClick(event, labelNode, callback, delayType)\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (delayType === DelayInterval.DELAY_TYPE.After)\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (\n\t\t\t\tdelayType !== DelayInterval.DELAY_TYPE.After\n\t\t\t\t&& this.basisFields[i]['Id'].indexOf('DATE_CREATE') > -1\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Text.encode(this.basisFields[i].Name),\n\t\t\t\tfield: this.basisFields[i],\n\t\t\t\tonclick(e, item)\n\t\t\t\t{\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(item.field || item.options.field);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tlet menuId = labelNode.getAttribute('data-menu-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tlabelNode.setAttribute('data-menu-id', menuId);\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tmenuId,\n\t\t\tlabelNode,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (BX.pos(labelNode)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.fieldsMenu = MenuManager.currentItem;\n\t}\n\n\tgetBasisField(basis, system)\n\t{\n\t\tif (system && (basis === DelayInterval.BASIS_TYPE.CurrentDateTime || basis === DelayInterval.BASIS_TYPE.CurrentDateTimeLocal))\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t};\n\t\t}\n\t\tif (system && basis === DelayInterval.BASIS_TYPE.CurrentDate)\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t};\n\t\t}\n\n\t\tlet field = null;\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (basis === this.basisFields[i].SystemExpression)\n\t\t\t{\n\t\t\t\tfield = this.basisFields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn field;\n\t}\n\n\tprepareBasisFields()\n\t{\n\t\tconst fields = [];\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tconst fld = this.basisFields[i];\n\t\t\tif (\n\t\t\t\tfld['Id'].indexOf('DATE_MODIFY') < 0\n\t\t\t\t&& fld['Id'].indexOf('EVENT_DATE') < 0\n\t\t\t\t&& fld['Id'].indexOf('BIRTHDATE') < 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tfields.push(fld);\n\t\t\t}\n\t\t}\n\n\t\tthis.basisFields = fields;\n\t}\n}","import { Type } from \"main.core\";\nimport { EventEmitter, BaseEvent } from \"main.core.events\";\n\nexport class Context extends EventEmitter\n{\n\t#values: Object<string, any>;\n\n\tconstructor(defaultValue: Object<string, any>)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Bizproc.Automation.Context');\n\t\tif (Type.isPlainObject(defaultValue))\n\t\t{\n\t\t\tthis.#values = defaultValue;\n\t\t}\n\t}\n\n\n\tset(name: string, value: any): this\n\t{\n\t\tconst isValueChanged = this.has(name);\n\t\tthis.#values[name] = value;\n\t\tthis.emit(isValueChanged ? 'valueChanged' : 'valueAdded', {name, value})\n\n\t\treturn this;\n\t}\n\n\tget(name: string): any\n\t{\n\t\treturn this.#values[name];\n\t}\n\n\thas(name: string): boolean\n\t{\n\t\treturn this.#values.hasOwnProperty(name);\n\t}\n\n\tsubsribeValueChanges(name: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.subscribe('valueChanged', (event) => {\n\t\t\tif (event.data.name === name)\n\t\t\t{\n\t\t\t\tlistener(event);\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n}","import { Type } from \"main.core\";\nimport { Context } from \"./context\";\nimport { Document, UserOptions, Tracker } from \"bizproc.automation\";\n\nexport class AutomationContext extends Context\n{\n\tconstructor(props: {\n\t\tdocument: Document,\n\t\tsignedDocument: string,\n\t\tajaxUrl: string,\n\t\tavailableRobots?: Array<Object>,\n\t\tavailableTriggers?: Array<Object>,\n\t\tcanManage?: boolean,\n\t\tcanEdit?: boolean,\n\t\tuserOptions?: UserOptions,\n\t\ttracker?: Tracker,\n\n\t\tbizprocEditorUrl?: string,\n\t\tconstantsEditorUrl?: string,\n\t\tparametersEditorUrl?: string,\n\n\t\tmarketplaceRobotCategory?: string,\n\t})\n\t{\n\t\tsuper(props);\n\t}\n\n\tget document(): ?Document\n\t{\n\t\treturn this.get('document');\n\t}\n\n\tget signedDocument(): string\n\t{\n\t\treturn this.get('signedDocument') ?? '';\n\t}\n\n\tget ajaxUrl(): string\n\t{\n\t\treturn this.get('ajaxUrl') ?? '';\n\t}\n\n\tget availableRobots(): Array<Object>\n\t{\n\t\tconst availableRobots = this.get('availableRobots');\n\t\tif (Type.isArray(availableRobots))\n\t\t{\n\t\t\treturn availableRobots;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget availableTriggers(): Array<Object>\n\t{\n\t\tconst availableTriggers = this.get('availableTriggers');\n\t\tif (Type.isArray(availableTriggers))\n\t\t{\n\t\t\treturn availableTriggers;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget canManage(): boolean\n\t{\n\t\tconst canManage = this.get('canManage');\n\n\t\treturn Type.isBoolean(canManage) && canManage;\n\t}\n\n\tget canEdit(): boolean\n\t{\n\t\tconst canEdit = this.get('canEdit');\n\n\t\treturn Type.isBoolean(canEdit) && canEdit;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.get('userOptions');\n\t}\n\n\tget tracker(): ?Tracker\n\t{\n\t\treturn this.get('tracker');\n\t}\n\n\tset tracker(tracker: Tracker)\n\t{\n\t\tthis.set('tracker', tracker);\n\t}\n\n\tget bizprocEditorUrl(): ?string\n\t{\n\t\treturn this.get('bizprocEditorUrl');\n\t}\n\n\tget constantsEditorUrl(): ?string\n\t{\n\t\treturn this.get('constantsEditorUrl');\n\t}\n\n\tget parametersEditorUrl(): ?string\n\t{\n\t\treturn this.get('parametersEditorUrl');\n\t}\n\n\tgetAvailableTrigger(code: string): ?Object\n\t{\n\t\treturn this.availableTriggers.find(trigger => trigger['CODE'] === code);\n\t}\n}","import TemplatesScheme from './templates-scheme';\nexport { TemplateScope } from './template-scope';\nexport { TriggerManager } from './trigger-manager';\nexport { Trigger } from './trigger';\nexport { Template } from './template';\nexport { Robot } from './robot';\nexport { UserOptions } from './user-options';\nexport { Document } from './document/document';\nexport { ViewMode } from './view-mode';\nexport { ConditionGroup } from './condition/condition-group';\nexport { ConditionGroupSelector } from './condition/condition-group-selector';\nexport { Condition } from './condition/condition';\nexport { Designer } from './designer';\nexport * from './tracker/tracker';\nexport { DelayInterval } from './delay-interval';\nexport { DelayIntervalSelector } from './delay-interval-selector';\nexport { HelpHint } from './help-hint';\nimport { AutomationContext } from './context/automation-context';\n\nimport 'ui.fonts.opensans';\n\nexport { Helper } from './helper';\n\nimport { Reflection } from \"main.core\";\nimport './css/style.css'\n\nexport {\n\tTemplatesScheme,\n\tAutomationContext,\n}\n\nexport function getGlobalContext(): AutomationContext\n{\n\tReflection.namespace('BX.Bizproc.Automation');\n\n\tconst context = BX.Bizproc.Automation.Context;\n\tif (context instanceof AutomationContext)\n\t{\n\t\treturn context;\n\t}\n\n\tthrow new Error('Context is not initialized yet');\n}\n\nexport function tryGetGlobalContext(): ?AutomationContext\n{\n\ttry\n\t{\n\t\treturn getGlobalContext();\n\t}\n\tcatch (error)\n\t{\n\t\treturn null;\n\t}\n}\n\nexport function setGlobalContext(context: AutomationContext): AutomationContext\n{\n\tReflection.namespace('BX.Bizproc.Automation');\n\n\tBX.Bizproc.Automation.Context = context;\n\n\treturn context;\n}"],"names":["TemplateScope","rawTemplateScope","DocumentType","Type","isNil","Category","Id","Status","hasCategory","isNull","TemplatesScheme","scheme","isArray","forEach","rawScope","scope","push","documentTypes","Map","set","getDocumentType","Array","from","values","documentType","documentCategories","category","getDocumentCategory","documentCategory","takenStatuses","Set","predicate","shouldBeTaken","has","getDocumentStatus","add","map","generator","ViewMode","mode","name","value","defaultValue","hasOwnProperty","getAll","includes","none","Trigger","setEventNamespace","draft","ConditionGroup","data","viewMode","clone","isPlainObject","Condition","edit","createNode","node","parentNode","replaceChild","getGlobalContext","canEdit","triggerName","code","getCode","trigger","availableTriggers","find","NAME","isString","rules","log","tracker","getTriggerLog","getId","status","condition","flag","userId","wrapperClass","isEdit","settingsBtn","copyBtn","Dom","create","attrs","className","text","Loc","getMessage","Event","bind","onCopyButtonClick","getLogStatus","TrackingStatus","COMPLETED","document","getPreviousStatusIdList","getStatusId","getName","containerClass","div","children","registerItem","deleteBtn","onDeleteButtonClick","appendChild","onSettingsButtonClick","button","HelpHint","showNoPermissionsHint","isManage","emit","event","stopPropagation","initData","serialize","init","query","getData","queryString","match","toLowerCase","indexOf","object","onbxdragstart","BX","proxy","dragStart","onbxdrag","dragMove","onbxdragstop","dragStop","onbxdraghover","dragOver","jsDD","registerObject","registerDest","undefined","unregisterObject","unregisterDest","proxy_context","stopCurrentDrag","itemWidth","offsetWidth","cloneNode","style","position","classList","width","body","x","y","left","top","destination","remove","type","getAttribute","querySelector","window","isCopy","ctrlKey","metaKey","copyTrigger","parent","statusId","thisColumn","insertBefore","moveTo","skipInsert","removeChild","APPLY_RULES","items","length","triggerData","RETURN","EventEmitter","querySelectorAll","element","bindToNode","showHint","hideHint","popupHint","bindElement","isSameNode","rawText","Text","encode","util","nl2br","isStringFilled","PopupWindow","lightShadow","autoHide","darkMode","offsetLeft","offsetTop","bindOptions","events","onPopupClose","destroy","content","html","setAngle","offset","show","showAngleHint","timeout","clearTimeout","UI","Hint","createInstance","popupParameters","height","closeByEsc","angle","getPosition","close","hide","setTimeout","Helper","JSON","stringify","i","v","fields","field","Designer","dialog","robotSettingsDialog","robot","triggerSettingsDialog","TriggerManager","triggersContainerNode","isNone","TRIGGERS","initButtons","initTriggers","markModified","columnNode","addCustomEvent","onRestAppInstall","clean","subscribeTriggerEvents","insertTriggerNode","subscribe","openTriggerSettingsDialog","deleteTrigger","onSearch","createAddButton","manage","deleteButtons","addClass","removeClass","containerNode","self","click","onAddButtonClick","context","onMenuClick","item","addTrigger","popupWindow","menuItems","availableTrigger","CODE","createAppTriggerMenuItem","DOCUMENT_STATUS","onclick","MenuManager","generateUniqueId","target","changeTrigger","e","getRootMenuWindow","itemName","APP_ID","Reflection","getClass","delimiter","rest","Marketplace","open","PLACEMENT","get","callback","call","markDeleted","splice","unregisterItem","documentStatus","triggerNode","listNode","filter","deleted","modified","getInstance","getTriggerSettingsDialog","popup","formName","form","props","renderConditionSettings","iconHelp","title","getTriggerName","getAvailableTrigger","getApplyRules","getRandom","hookLinkTextarea","placeholder","readonly","select","url","location","protocol","host","Uri","addParam","replace","getRawType","onCustomEvent","canSetExecuteBy","renderExecuteByControl","renderAllowBackwardsControl","setTriggerSettingsDialog","triggerManager","titleBar","createChangeTriggerTitleBar","Bizproc","closeIcon","draggable","restrict","overlay","destroySettingsDialogControls","buttons","PopupWindowButton","formData","ajax","prepareForm","setName","setApplyRules","form_id","STATUS","LINE_NUMBER","config_id","setConditionSettingsFromForm","setAllowBackwards","setExecuteBy","reInit","PopupWindowButtonLink","createTextNode","onChangeTriggerClick","conditionGroup","getCondition","conditionSelector","ConditionGroupSelector","getFields","selector","FieldType","renderControl","getResponsibleUserExpression","getExecuteBy","checked","isBackwardsAllowed","formFields","setCondition","createFromForm","installed","eventResult","redirect","method","dataType","ajaxUrl","ajax_action","document_signed","signedDocument","onsuccess","response","settingsDialogControls","controlNodes","control","role","UserSelector","decorateNode","isFunction","result","exists","triggers","getListByDocumentStatus","getReturnProperties","property","ObjectId","Name","ObjectName","Expression","SystemExpression","propertyId","properties","Document","options","rawDocumentType","documentId","categoryId","statusList","findIndex","STATUS_ID","documentFields","index","slice","newStatusId","isArrayFilled","DelayInterval","params","BASIS_TYPE","CurrentDateTime","DELAY_TYPE","After","setType","setValue","setValueType","setBasis","setWorkTime","setLocalTime","valueType","basis","workTime","localTime","Before","In","parseInt","basisFields","workerExpression","CurrentDate","isSystemBasis","s","isNow","days","hours","minutes","fn","worker","emptyText","str","prefix","getFormattedPeriodLabel","fieldSuffix","label","labelIndex","labels","getPeriodLabels","CurrentDateTimeLocal","intervalString","toString","h","d","substring","fnArgs","split","trim","re","exec","found","period","WorkflowStatus","TrackingEntry","TRIGGER_ACTIVITY_TYPE","entryType","getAllActivityTypes","entryWorkflowStatus","getAllWorkflowStatuses","UNKNOWN_ACTIVITY_TYPE","EXECUTE_ACTIVITY_TYPE","CLOSE_ACTIVITY_TYPE","CANCEL_ACTIVITY_TYPE","FAULT_ACTIVITY_TYPE","CUSTOM_ACTIVITY_TYPE","REPORT_ACTIVITY_TYPE","ATTACHED_ENTITY_TYPE","ERROR_ACTIVITY_TYPE","DEBUG_ACTIVITY_TYPE","DEBUG_AUTOMATION_TYPE","DEBUG_DESIGNER_TYPE","DEBUG_LINK_TYPE","typeId","CREATED_WORKFLOW_STATUS","RUNNING_WORKFLOW_STATUS","COMPLETED_WORKFLOW_STATUS","SUSPENDED_WORKFLOW_STATUS","TERMINATED_WORKFLOW_STATUS","RobotEntry","entries","WAITING","entry","addEntry","id","datetime","workflowStatus","RUNNING","errors","note","notes","TriggerEntry","isTriggerEntry","TrackingEntryBuilder","workflowId","logEntry","Object","assign","isNumber","isKnownActivityType","isKnownWorkflowStatus","String","Tracker","addLogs","logEntryBuilder","rawEntry","setLogEntry","build","addTriggerEntry","addRobotEntry","robotEntry","isRobotRunning","isWorkflowCompleted","isCurrentStatus","getCurrentStatusId","isRobotRunningAtAnotherStatus","isRobotRunningAndCurrentWorkflowCompleted","documentSigned","DATA","LOG","Robot","template","isFrameMode","clonedRobot","robotData","generateName","Delay","getDelayInterval","other","CONDITION_TYPE","Mixed","Properties","getProperties","getRobotLog","DelayName","hasClass","isActive","setProperty","deleteButton","getProperty","isSelected","selectNode","unselectNode","targetLabel","targetNode","viewData","responsibleLabel","labelText","robots","getReturnFieldsDescription","getTitle","textContent","setAttribute","responsibleUrl","href","responsibleId","delayLabel","format","isExecuteAfterPrevious","delayNode","statusNode","subscribeOnce","isBindedToNode","delayNotes","getDelayNotes","join","AUTOCOMPLETED","getLogErrors","titleClassName","clipTitle","onTitleEditClick","lastChild","deleteRobot","openRobotSettingsDialog","copiedRobot","robotTitle","newTitle","Template","copyRobotTo","getNextRobot","preventDefault","nameNode","elements","fullTitle","arrTitle","lastWord","delay","ExecuteAfterPrevious","draggableItem","stub","droppableItem","droppableColumn","templateNode","beforeRobot","insertRobot","insertRobotNode","getDescriptionTitle","description","getRobotDescription","fieldId","appendPropertyMods","printableTag","addProperty","Options","expression","usages","Constant","Variable","Parameter","GlobalConstant","GlobalVariable","Activity","collectExpressions","conditions","collectParsedExpressions","systemExpressionRegExp","RegExp","SYSTEM_EXPRESSION_PATTERN","groups","parsedUsage","activityRegExp","collectUsages","objectsData","getConstants","getVariables","globalConstants","globalVariables","getParameters","getSerializedRobots","size","source","key","searchInSource","getRobotById","getReturnProperty","Math","random","UserOptions","storedValue","userOptions","save","constants","variables","templateContainerNode","selectors","delayMinLimitM","CONSTANTS","PARAMETERS","VARIABLES","markExternalModified","fromRaw","initRobots","updateTopButtonsVisibility","isExternalModified","ROBOTS","selectedRobots","serialized","ID","isNaN","createExternalLocker","getTemplateId","createConstantsEditButton","createParametersEditButton","createExternalEditTemplateButton","createManageModeButton","enableManageMode","disableManageMode","anchor","bizprocEditorUrl","onExternalEditTemplateButtonClick","canManage","manageButton","cursor","onManageModeButtonClick","manageButtonNode","constantsEditorUrl","parametersEditorUrl","onUnsetExternalModifiedClick","onExternalModifiedSearch","employee","client","ads","availableRobots","menuItemClickHandler","addRobot","ADD_MENU_CATEGORY","settings","categories","j","menuId","rootMenuItems","pos","maxHeight","changeRobot","InfoHelper","templateId","openBizprocEditor","intoRaw","Title","parentRobot","isEqual","robotNode","beforeNode","saveCallback","getRobotSettingsDialog","setRobotSettingsDialog","renderDelaySettings","hasBrokenLink","renderBrokenLinkAlert","getCategoryId","document_status","robot_json","toJsonString","form_name","dialogRows","showRobotSettingsPopup","popupMinWidth","popupWidth","initRobotSettingsControls","hasTitle","createChangeRobotTitleBar","me","resizable","minWidth","minHeight","currentRobot","destroyRobotSettingsControls","onPopupResize","onResizeRobotSettings","onPopupResizeEnd","getWidth","saveRobotSettings","delegate","buttonNode","onChangeRobotClick","robotSettingsControls","initRobotSettingsControl","controlNode","userSelector","fileSelector","inlineSelector","inlineSelectorHtml","timeSelector","saveStateCheckbox","onBeforeSave","idSalt","delayTypeNode","delayValueNode","delayValueTypeNode","delayBasisNode","delayWorkTimeNode","delayIntervalLabelNode","docFields","minLimitM","delayIntervalSelector","DelayIntervalSelector","labelNode","onchange","useAfterBasis","executeAfterPreviousBlock","hasTemplate","executeAfterPreviousCheckbox","setDelayInterval","setExecuteAfterPrevious","alert","message","display","btnNode","onBeforeSaveRobotSettings","form_data_json","form_data","SUCCESS","updateData","setDelaySettingsFromForm","ERRORS","externalModified","keys","constant","generatePropertyId","getConstant","Description","param","parameter","getParameter","variable","existsList","robotUsages","usage","eventName","listener","unsubscribe","dstTemplate","copyTo","group","parentGroup","setObject","setField","setOperator","operator","addItem","clonedGroup","joiner","clonedCondition","itemsArray","JOINER","And","Or","Field","ConditionSelector","fieldPrefix","conditionObjectNode","objectNode","conditionFieldNode","fieldNode","conditionOperatorNode","operatorNode","conditionValueNode","valueNode","conditionJoinerNode","joinerNode","setLabelText","bindLabelNode","removeButtonNode","removeCondition","joinerButtonNode","changeJoiner","getField","valueLabel","formatValuePrintable","getOperatorLabel","onLabelClick","showPopup","filterFields","objectSelect","fieldSelect","fieldSelectLabel","onFieldSelectorClick","selectedField","valueInput","createValueNode","valueWrapper","operatorSelect","createOperatorNode","operatorWrapper","onFieldChange","backgroundColor","firstChild","updateValueNode","fieldDialog","Automation","Selector","InlineSelectorCondition","fireEvent","openMenu","conditionWrapper","onOperatorChange","component","tpl","getTemplate","getGVariable","foundRobot","fieldType","multiple","list","getOperators","filtered","docField","docType","API","Multiple","operatorList","operatorId","btn","conditionNodes","getItems","prepareBasisFields","showDelayIntervalPopup","uid","radioNow","labelNow","labelNowHelpNode","createAfterControlNode","createBeforeControlNode","createInControlNode","workTimeRadio","workTimeHelpNode","saveFormData","fieldsMenu","valueTypeMenu","setNow","Notification","Center","notify","radioAfter","labelAfter","createValueTypeSelector","basisField","getBasisField","basisValue","beforeBasisValueNode","beforeBasisNode","onBasisClick","afterHelpNode","radioBefore","labelBefore","beforeHelpNode","radioIn","labelIn","inBasisValueNode","inBasisNode","helpNode","labelTexts","input","onValueTypeSelectorClick","handler","valueId","currentItem","delayType","system","fld","Context","isValueChanged","AutomationContext","isBoolean","namespace","Error","tryGetGlobalContext","error","setGlobalContext"],"mappings":"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"}