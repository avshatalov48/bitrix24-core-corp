{"version":3,"file":"automation.bundle.js","sources":["../src/template-scope.js","../src/templates-scheme.js","../src/view-mode.js","../src/trigger.js","../src/help-hint.js","../src/helper.js","../src/designer.js","../src/trigger-manager.js","../src/document/document.js","../src/delay-interval.js","../src/workflow/types.js","../src/tracker/tracking-entry.js","../src/tracker/types.js","../src/tracker/robot-entry.js","../src/tracker/trigger-entry.js","../src/tracker/tracking-entry-builder.js","../src/tracker/tracker.js","../src/robot.js","../src/user-options.js","../src/template.js","../src/condition/condition.js","../src/condition/condition-group.js","../src/selectors/condition-selector.js","../src/selectors/condition-group-selector.js","../src/selectors/manager.js","../src/selectors/inline-selector.js","../src/selectors/inline-selector-condition.js","../src/selectors/inline-selector-html.js","../src/selectors/save-state-checkbox.js","../src/selectors/user-selector.js","../src/selectors/file-selector.js","../src/selectors/time-selector.js","../src/delay-interval-selector.js","../src/context/base-context.js","../src/context/selector-context.js","../src/context/context.js","../src/tourguide/beginning-guide.js","../src/tourguide/automation-guide.js","../src/automation.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { DocumentType, DocumentCategory, DocumentStatus } from './document/types';\n\nexport class TemplateScope\n{\n\t#documentType: DocumentType;\n\t#category: DocumentCategory | null;\n\t#status: DocumentStatus;\n\n\tconstructor(rawTemplateScope: {\n\t\tDocumentType: {\n\t\t\tType: string,\n\t\t\tName: string,\n\t\t},\n\t\tCategory: {\n\t\t\tId: string | null,\n\t\t\tName: string | null,\n\t\t},\n\t\tStatus: {\n\t\t\tId: string,\n\t\t\tName: string,\n\t\t\tColor: string,\n\t\t}\n\t})\n\t{\n\t\tthis.#documentType = rawTemplateScope.DocumentType;\n\t\tthis.#category = !Type.isNil(rawTemplateScope.Category.Id) ? rawTemplateScope.Category : null;\n\t\tthis.#status = rawTemplateScope.Status;\n\t}\n\n\tgetId()\n\t{\n\t\tif (this.hasCategory())\n\t\t{\n\t\t\treturn `${this.#documentType.Type}_${this.#category.Id}_${this.#status.Id}`;\n\t\t}\n\n\t\treturn `${this.#documentType.Type}_${this.#status.Id}`;\n\t}\n\n\tgetDocumentType(): DocumentType\n\t{\n\t\treturn this.#documentType;\n\t}\n\n\tgetDocumentCategory(): DocumentCategory\n\t{\n\t\treturn this.#category;\n\t}\n\n\tgetDocumentStatus(): DocumentStatus\n\t{\n\t\treturn this.#status;\n\t}\n\n\thasCategory(): boolean\n\t{\n\t\treturn !Type.isNull(this.#category);\n\t}\n}","import {Type} from 'main.core';\nimport {DocumentType, DocumentCategory, DocumentStatus} from './document/types';\nimport {TemplateScope} from './template-scope';\n\nexport default class TemplatesScheme\n{\n\t#scheme: Array<TemplateScope>;\n\n\tconstructor(scheme: Array<TemplateScope>)\n\t{\n\t\tthis.#scheme = [];\n\n\t\tif (Type.isArray(scheme))\n\t\t{\n\t\t\tscheme.forEach(rawScope => {\n\t\t\t\tconst scope = new TemplateScope(rawScope);\n\t\t\t\tthis.#scheme.push(scope);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetDocumentTypes(): Array<DocumentType>\n\t{\n\t\tconst documentTypes = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tdocumentTypes.set(scope.getDocumentType().Type, scope.getDocumentType());\n\t\t}\n\n\t\treturn Array.from(documentTypes.values());\n\t}\n\n\tgetTypeCategories(documentType: DocumentType): Array<DocumentCategory>\n\t{\n\t\tconst documentCategories = new Map();\n\n\t\tfor (const scope of this.#scheme)\n\t\t{\n\t\t\tif (scope.hasCategory() && scope.getDocumentType().Type === documentType.Type)\n\t\t\t{\n\t\t\t\tconst category = scope.getDocumentCategory();\n\t\t\t\tdocumentCategories.set(category.Id, category);\n\t\t\t}\n\t\t}\n\n\t\treturn Array.from(documentCategories.values());\n\t}\n\n\tgetTypeStatuses(documentType: DocumentType, documentCategory: DocumentCategory | null): Array<DocumentStatus>\n\t{\n\t\tconst takenStatuses = new Set();\n\t\tif (Type.isNil(documentCategory))\n\t\t{\n\t\t\tdocumentCategory = {Id: null};\n\t\t}\n\n\t\tconst predicate = scope => {\n\t\t\tconst shouldBeTaken = (\n\t\t\t\tscope.getDocumentType().Type === documentType.Type\n\t\t\t\t&& (scope.hasCategory() ? scope.getDocumentCategory().Id === documentCategory.Id : true)\n\t\t\t\t&& !takenStatuses.has(scope.getDocumentStatus().Id)\n\t\t\t);\n\n\t\t\tif (shouldBeTaken)\n\t\t\t{\n\t\t\t\ttakenStatuses.add(scope.getDocumentStatus().Id);\n\t\t\t}\n\n\t\t\treturn shouldBeTaken;\n\t\t};\n\n\t\treturn Array.from(this.#filterBy(predicate)).map(scope => scope.getDocumentStatus());\n\t}\n\n\t#filterBy(predicate: (TemplateScope) => boolean): Iterable<TemplateScope>\n\t{\n\t\tconst generator = function*(scheme)\n\t\t{\n\t\t\tfor (const scope of scheme)\n\t\t\t{\n\t\t\t\tif (predicate(scope))\n\t\t\t\t{\n\t\t\t\t\tyield scope;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn generator(this.#scheme);\n\t}\n}","export class ViewMode\n{\n\t#mode: number;\n\t#properties: Object;\n\n\tstatic #none = 0;\n\tstatic #view = 1;\n\tstatic #edit = 2;\n\tstatic #manage = 3;\n\n\tconstructor(mode: number)\n\t{\n\t\tthis.#mode = mode;\n\t\tthis.#properties = {};\n\t}\n\n\tstatic none(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#none)\n\t}\n\n\tisNone(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#none;\n\t}\n\n\tstatic view(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#view);\n\t}\n\n\tisView(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#view;\n\t}\n\n\tstatic edit(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#edit);\n\t}\n\n\tisEdit(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#edit;\n\t}\n\n\tstatic manage(): ViewMode\n\t{\n\t\treturn new ViewMode(ViewMode.#manage);\n\t}\n\n\tisManage(): boolean\n\t{\n\t\treturn this.#mode === ViewMode.#manage;\n\t}\n\n\tsetProperty(name: string, value: any): ViewMode\n\t{\n\t\tthis.#properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetProperty(name: string, defaultValue: any = null): ?any\n\t{\n\t\tif (this.#properties.hasOwnProperty(name))\n\t\t{\n\t\t\treturn this.#properties[name];\n\t\t}\n\n\t\treturn defaultValue;\n\t}\n\n\tstatic fromRaw(mode: number): ViewMode\n\t{\n\t\tif (ViewMode.getAll().includes(mode))\n\t\t{\n\t\t\treturn new ViewMode(mode);\n\t\t}\n\n\t\treturn ViewMode.none();\n\t}\n\n\tintoRaw(): number\n\t{\n\t\treturn this.#mode;\n\t}\n\n\tstatic getAll(): Array<number>\n\t{\n\t\treturn [\n\t\t\tthis.#none,\n\t\t\tthis.#view,\n\t\t\tthis.#edit,\n\t\t\tthis.#manage,\n\t\t];\n\t}\n}\n","import { clone, Type, Dom, Loc, Event } from \"main.core\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { getGlobalContext, ConditionGroup, TrackingStatus, HelpHint } from \"bizproc.automation\";\n\nexport class Trigger extends EventEmitter\n{\n\tdraft: boolean;\n\n\t#data: Object<string, any>;\n\t#deleted: boolean;\n\t#viewMode: ViewMode;\n\t#condition: ConditionGroup;\n\t#node: ?HTMLDivElement;\n\t#draggableItem: ?HTMLElement;\n\t#droppableItem: ?HTMLElement;\n\t#droppableColumn: ?HTMLElement;\n\t#stub: ?HTMLElement;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.draft = false;\n\t\tthis.#data = {};\n\t\tthis.#deleted = false;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#condition = new ConditionGroup();\n\t}\n\n\tget node(): HTMLDivElement\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget deleted(): boolean\n\t{\n\t\treturn this.#deleted;\n\t}\n\n\tget documentStatus(): string\n\t{\n\t\treturn this.#data['DOCUMENT_STATUS'] ?? '';\n\t}\n\n\tinit(data: Object<string, any>, viewMode: ?ViewMode): void\n\t{\n\t\tthis.#data = clone(data);\n\n\t\tif (!Type.isPlainObject(this.#data['APPLY_RULES']))\n\t\t{\n\t\t\tthis.#data['APPLY_RULES'] = {};\n\t\t}\n\n\t\tif (this.#data['APPLY_RULES'].Condition)\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup(this.#data['APPLY_RULES'].Condition);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#condition = new ConditionGroup();\n\t\t}\n\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tthis.#node = this.createNode();\n\t}\n\n\treInit(data: Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.#data['ID'] || 0;\n\t}\n\n\tgetStatusId(): string\n\t{\n\t\treturn String(this.#data['DOCUMENT_STATUS'] || '');\n\t}\n\n\tgetStatus(): ?object\n\t{\n\t\treturn getGlobalContext().document.statusList.find(status => String(status.STATUS_ID) === this.getStatusId());\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.#data['CODE'] ?? '';\n\t}\n\n\tgetName(): string\n\t{\n\t\tlet triggerName = this.#data['NAME'];\n\t\tif (!triggerName)\n\t\t{\n\t\t\tconst code = this.getCode();\n\t\t\tconst trigger = getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE']);\n\t\t\ttriggerName = trigger?.NAME ?? code;\n\t\t}\n\n\t\treturn triggerName;\n\t}\n\n\tsetName(name: string): this\n\t{\n\t\tif (Type.isString(name))\n\t\t{\n\t\t\tthis.#data['NAME'] = name;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetApplyRules()\n\t{\n\t\treturn this.#data['APPLY_RULES'];\n\t}\n\n\tsetApplyRules(rules: Object): this\n\t{\n\t\tthis.#data['APPLY_RULES'] = rules;\n\n\t\treturn this;\n\t}\n\n\tgetLogStatus()\n\t{\n\t\tconst log = getGlobalContext().tracker.getTriggerLog(this.getId());\n\t\treturn log ? log.status : null;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition: ConditionGroup): this\n\t{\n\t\tthis.#condition = condition;\n\t\treturn this;\n\t}\n\n\tisBackwardsAllowed(): boolean\n\t{\n\t\treturn this.#data['APPLY_RULES']['ALLOW_BACKWARDS'] === 'Y';\n\t}\n\n\tsetAllowBackwards(flag: boolean): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ALLOW_BACKWARDS'] = flag ? 'Y' : 'N';\n\n\t\treturn this;\n\t}\n\n\tgetExecuteBy(): string\n\t{\n\t\treturn this.#data['APPLY_RULES']['ExecuteBy'] || '';\n\t}\n\n\tsetExecuteBy(userId: number): this\n\t{\n\t\tthis.#data['APPLY_RULES']['ExecuteBy'] = userId;\n\n\t\treturn this;\n\t}\n\n\tcreateNode()\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-trigger-item-wrapper';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-draggable';\n\t\t}\n\n\t\tlet settingsBtn = null;\n\t\tlet copyBtn = null;\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tsettingsBtn = Dom.create(\"div\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-trigger-item-wrapper-edit\"\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tcopyBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-trigger-btn-copy'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY') || 'copy'\n\t\t\t});\n\n\t\t\tEvent.bind(copyBtn, 'click', this.onCopyButtonClick.bind(this, copyBtn));\n\t\t}\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete';\n\t\t}\n\t\telse if (getGlobalContext().document.getPreviousStatusIdList().includes(this.getStatusId()))\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-trigger-item-wrapper-complete-light';\n\t\t}\n\n\t\tconst triggerName = this.getName();\n\n\t\tlet containerClass = 'bizproc-automation-trigger-item';\n\n\t\tif (this.getLogStatus() === TrackingStatus.COMPLETED)\n\t\t{\n\t\t\tcontainerClass += ' --complete';\n\t\t}\n\t\telse if (this.draft)\n\t\t{\n\t\t\tcontainerClass += ' --draft';\n\t\t}\n\n\t\tconst div = Dom.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'trigger-container',\n\t\t\t\t'className': containerClass,\n\t\t\t\t'data-type': 'item-trigger'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-trigger-item-wrapper-text\" },\n\t\t\t\t\t\t\ttext: triggerName\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\tcopyBtn,\n\t\t\t\tsettingsBtn\n\t\t\t]\n\t\t});\n\n\t\tif (!this.#viewMode.isEdit())\n\t\t{\n\t\t\treturn div;\n\t\t}\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\tattrs: {\n\t\t\t\t'data-role': 'btn-delete-trigger',\n\t\t\t\t'className': 'bizproc-automation-trigger-btn-delete',\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\n\t\tdiv.appendChild(deleteBtn);\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\t\t}\n\n\t\treturn div;\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.emit('Trigger:onSettingsOpen', {trigger: this});\n\t\t}\n\t}\n\n\tonCopyButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = this.serialize();\n\t\t\tdelete initData['ID'];\n\t\t\t//TODO: refactoring\n\t\t\tif (initData['CODE'] === 'WEBHOOK')\n\t\t\t{\n\t\t\t\tinitData['APPLY_RULES'] = {};\n\t\t\t}\n\t\t\ttrigger.init(initData, this.#viewMode);\n\t\t\tthis.emit('Trigger:copied', {trigger});\n\t\t}\n\t}\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getName().toLowerCase().indexOf(query) >= 0;\n\n\t\tDom[match ? 'removeClass' : 'addClass'](this.#node, '--search-mismatch');\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.#draggableItem = BX.proxy_context;\n\n\t\tif (!this.#draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#stub)\n\t\t{\n\t\t\tconst itemWidth = this.#draggableItem.offsetWidth;\n\t\t\tthis.#stub = this.#draggableItem.cloneNode(true);\n\t\t\tthis.#stub.style.position = \"absolute\";\n\t\t\tthis.#stub.classList.add(\"bizproc-automation-trigger-item-drag\");\n\t\t\tthis.#stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.#stub);\n\t\t}\n\t}\n\n\tdragMove(x, y)\n\t{\n\t\tthis.#stub.style.left = x + \"px\";\n\t\tthis.#stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-trigger\")\n\t\t{\n\t\t\tthis.#droppableItem = destination;\n\t\t\tthis.#droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-trigger\")\n\t\t{\n\t\t\tthis.#droppableColumn = destination.querySelector('[data-role=\"trigger-list\"]');\n\t\t\tthis.#droppableItem = null;\n\t\t}\n\n\t\tif (this.#droppableItem)\n\t\t{\n\t\t\tthis.#droppableItem.classList.add(\"bizproc-automation-trigger-item-pre\");\n\t\t}\n\n\t\tif (this.#droppableColumn)\n\t\t{\n\t\t\tthis.#droppableColumn.classList.add(\"bizproc-automation-trigger-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tlet trigger = null;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\t\tconst copyTrigger = (parent, statusId) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\tconst initData = parent.serialize();\n\t\t\tdelete initData['ID'];\n\t\t\t//TODO: refactoring\n\t\t\tif (initData['CODE'] === 'WEBHOOK')\n\t\t\t{\n\t\t\t\tinitData['APPLY_RULES'] = {};\n\t\t\t}\n\t\t\tinitData['DOCUMENT_STATUS'] = statusId;\n\t\t\ttrigger.init(initData, parent.#viewMode);\n\n\t\t\treturn trigger;\n\t\t};\n\n\t\tif (this.#draggableItem)\n\t\t{\n\t\t\tif (this.#droppableItem)\n\t\t\t{\n\t\t\t\tthis.#droppableItem.classList.remove(\"bizproc-automation-trigger-item-pre\");\n\t\t\t\tconst thisColumn = this.#droppableItem.parentNode;\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthisColumn.insertBefore(this.#draggableItem, this.#droppableItem);\n\t\t\t\t\tthis.moveTo(thisColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, thisColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthisColumn.insertBefore(trigger.#node, this.#droppableItem);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.#droppableColumn)\n\t\t\t{\n\t\t\t\tthis.#droppableColumn.classList.remove(\"bizproc-automation-trigger-list-pre\");\n\t\t\t\tif (!isCopy)\n\t\t\t\t{\n\t\t\t\t\tthis.#droppableColumn.appendChild(this.#draggableItem);\n\t\t\t\t\tthis.moveTo(this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrigger = copyTrigger(this, this.#droppableColumn.getAttribute('data-status-id'));\n\t\t\t\t\tthis.#droppableColumn.appendChild(trigger.#node);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (trigger)\n\t\t\t{\n\t\t\t\tthis.emit('Trigger:copied', {\n\t\t\t\t\ttrigger,\n\t\t\t\t\tskipInsert: true,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.#stub.parentNode.removeChild(this.#stub);\n\t\tthis.#stub = null;\n\t\tthis.#draggableItem = null;\n\t\tthis.#droppableItem = null;\n\t}\n\n\tonDeleteButtonClick(button: HTMLElement, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(button.parentNode);\n\t\t\tthis.emit('Trigger:deleted', {trigger: this});\n\t\t}\n\t}\n\n\tupdateData(data: Object<string, any>): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tmarkDeleted(): this\n\t{\n\t\tthis.#deleted = true;\n\n\t\treturn this;\n\t}\n\n\tserialize(): Object<string, any>\n\t{\n\t\tconst data = clone(this.#data);\n\t\tif (this.#deleted)\n\t\t{\n\t\t\tdata['DELETED'] = 'Y';\n\t\t}\n\n\t\tif (!Type.isPlainObject(data.APPLY_RULES))\n\t\t{\n\t\t\tdata.APPLY_RULES = {};\n\t\t}\n\n\t\tif (!this.#condition.items.length)\n\t\t{\n\t\t\tdelete data.APPLY_RULES.Condition;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdata.APPLY_RULES.Condition = this.#condition.serialize();\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tmoveTo(statusId)\n\t{\n\t\tthis.#data['DOCUMENT_STATUS'] = statusId;\n\t\tthis.emit('Trigger:modified', {trigger: this});\n\t}\n\n\tgetReturnProperties()\n\t{\n\t\tconst triggerData = getGlobalContext().availableTriggers.find(trigger => trigger['CODE'] === this.getCode());\n\n\t\treturn triggerData && Type.isArray(triggerData.RETURN) ? triggerData.RETURN : [];\n\t}\n}","import { Event, Text, Type, Dom, Loc } from 'main.core';\n\nexport class HelpHint\n{\n\tstatic popupHint;\n\tstatic timeout;\n\n\tstatic bindAll(node)\n\t{\n\t\tnode.querySelectorAll('[data-text]').forEach((element) => HelpHint.bindToNode(element));\n\t}\n\n\tstatic bindToNode(node)\n\t{\n\t\tEvent.bind(node, 'mouseover', this.showHint.bind(this, node));\n\t\tEvent.bind(node, 'mouseout', this.hideHint.bind(this));\n\t}\n\n\tstatic isBindedToNode(node): boolean\n\t{\n\t\treturn !!this.popupHint?.bindElement?.isSameNode(node);\n\t}\n\n\tstatic showHint(node)\n\t{\n\t\tconst rawText = node.getAttribute('data-text');\n\t\tif (!rawText)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet text = Text.encode(rawText);\n\t\ttext = BX.util.nl2br(text);\n\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.hideHint();\n\n\t\tthis.popupHint = new BX.PopupWindow('bizproc-automation-help-tip', node, {\n\t\t\tlightShadow: true,\n\t\t\tautoHide: false,\n\t\t\tdarkMode: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 2,\n\t\t\tbindOptions: {position: \"top\"},\n\t\t\tevents : {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent : Dom.create('div', {\n\t\t\t\tattrs : {\n\t\t\t\t\tstyle : 'padding-right: 5px; width: 250px;'\n\t\t\t\t},\n\t\t\t\thtml: text\n\t\t\t}),\n\t\t});\n\t\tthis.popupHint.setAngle({offset: 32, position: 'bottom'});\n\t\tthis.popupHint.show();\n\n\t\treturn true;\n\t}\n\n\tstatic showNoPermissionsHint(node)\n\t{\n\t\tthis.showAngleHint(node, Loc.getMessage('BIZPROC_AUTOMATION_RIGHTS_ERROR'));\n\t}\n\n\tstatic showAngleHint(node, text)\n\t{\n\t\tif (this.timeout)\n\t\t{\n\t\t\tclearTimeout(this.timeout);\n\t\t}\n\n\t\tthis.popupHint = BX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {\n\t\t\t\twidth: 334,\n\t\t\t\theight: 104,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tangle: {offset: Dom.getPosition(node).width / 2},\n\t\t\t\tbindOptions: {position: 'top'},\n\t\t\t}\n\t\t});\n\n\t\tthis.popupHint.close = function ()\n\t\t{\n\t\t\tthis.hide();\n\t\t};\n\t\tthis.popupHint.show(node, text);\n\t\tthis.timeout = setTimeout(this.hideHint.bind(this), 5000);\n\t}\n\n\tstatic hideHint()\n\t{\n\t\tif (this.popupHint)\n\t\t{\n\t\t\tthis.popupHint.close();\n\t\t}\n\t\tthis.popupHint = null;\n\t}\n}","import { Type } from \"main.core\";\n\nexport class Helper\n{\n\tstatic #idIncrement = 0;\n\n\tstatic generateUniqueId()\n\t{\n\t\t++Helper.#idIncrement;\n\t\treturn 'bizproc-automation-cmp-' + Helper.#idIncrement;\n\t}\n\n\tstatic toJsonString(data)\n\t{\n\t\treturn JSON.stringify(data, function (i, v)\n\t\t{\n\t\t\tif (typeof(v) == 'boolean')\n\t\t\t{\n\t\t\t\treturn v ? '1' : '0';\n\t\t\t}\n\t\t\treturn v;\n\t\t});\n\t}\n\n\tstatic getResponsibleUserExpression(fields: Array<Object>): ?string\n\t{\n\t\tif (Type.isArray(fields))\n\t\t{\n\t\t\tfor (const field of fields)\n\t\t\t{\n\t\t\t\tif (field['Id'] === 'ASSIGNED_BY_ID' || field['Id'] === 'RESPONSIBLE_ID')\n\t\t\t\t{\n\t\t\t\t\treturn '{{'+field['Name']+'}}';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n}","export class Designer\n{\n\tstatic #instance;\n\n\trobotSettingsDialog;\n\tcomponent;\n\trobot;\n\ttriggerSettingsDialog;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Designer.#instance)\n\t\t{\n\t\t\tDesigner.#instance = new Designer();\n\t\t}\n\n\t\treturn Designer.#instance;\n\t}\n\n\tsetRobotSettingsDialog(dialog)\n\t{\n\t\tthis.robotSettingsDialog = dialog;\n\t\tthis.robot = dialog ? dialog.robot : null;\n\t}\n\n\tgetRobotSettingsDialog()\n\t{\n\t\treturn this.robotSettingsDialog;\n\t}\n\n\tsetTriggerSettingsDialog(dialog)\n\t{\n\t\tthis.triggerSettingsDialog = dialog;\n\t}\n\n\tgetTriggerSettingsDialog()\n\t{\n\t\treturn this.triggerSettingsDialog;\n\t}\n}","import { Type, Event, Loc, Dom, Text, Reflection, Uri, ajax } from \"main.core\";\nimport { MenuManager } from \"main.popup\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ViewMode } from \"./view-mode\";\nimport { Trigger } from \"./trigger\";\nimport { HelpHint } from \"./help-hint\";\nimport { Helper } from \"./helper\";\nimport { Designer } from \"./designer\";\nimport { getGlobalContext, ConditionGroup, ConditionGroupSelector } from \"bizproc.automation\";\n\nexport class TriggerManager extends EventEmitter\n{\n\t#triggersContainerNode: HTMLElement;\n\t#viewMode: ViewMode;\n\t#triggers: Array<Trigger>;\n\t#triggersData: Array<Object<string, any>>;\n\t#columnNodes: NodeList;\n\t#listNodes: NodeList;\n\t#modified: boolean;\n\n\tconstructor(triggersContainerNode: HTMLElement)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#triggersContainerNode = triggersContainerNode;\n\t}\n\n\tinit(data: ?Object<string, any>, viewMode: ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode.isNone() ? ViewMode.edit() : viewMode;\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\t\tthis.#columnNodes = document.querySelectorAll('[data-type=\"column-trigger\"]');\n\t\tthis.#listNodes = this.#triggersContainerNode.querySelectorAll('[data-role=\"trigger-list\"]');\n\t\tthis.#modified = false;\n\t\tthis.initTriggers();\n\n\t\tthis.markModified(false);\n\n\t\t//register DD\n\t\tthis.#columnNodes.forEach(columnNode => jsDD.registerDest(columnNode, 10));\n\n\t\ttop.BX.addCustomEvent(\n\t\t\ttop,\n\t\t\t'Rest:AppLayout:ApplicationInstall',\n\t\t\tthis.onRestAppInstall.bind(this)\n\t\t);\n\t}\n\n\treInit(data: ?Object<string, any>, viewMode: ?ViewMode)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tthis.#viewMode = viewMode || ViewMode.none();\n\t\tthis.#listNodes.forEach(node => Dom.clean(node));\n\n\t\tthis.#triggersData = Type.isArray(data.TRIGGERS) ? data.TRIGGERS : [];\n\n\t\tthis.initTriggers();\n\n\t\tthis.markModified(false);\n\t}\n\n\tinitTriggers()\n\t{\n\t\tthis.#triggers = [];\n\t\tthis.#triggersData.forEach((triggerData) => {\n\t\t\tconst trigger = new Trigger();\n\t\t\ttrigger.init(triggerData, this.#viewMode);\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\tthis.#triggers.push(trigger);\n\t\t});\n\t}\n\n\tsubscribeTriggerEvents(trigger: Trigger)\n\t{\n\t\ttrigger.subscribe('Trigger:copied', (event) => {\n\t\t\tconst trigger = event.data.trigger;\n\n\t\t\tthis.#triggers.push(trigger);\n\t\t\tif (!event.data.skipInsert)\n\t\t\t{\n\t\t\t\tthis.insertTriggerNode(trigger.getStatusId(), trigger.node);\n\t\t\t}\n\t\t\tthis.subscribeTriggerEvents(trigger);\n\t\t\tthis.markModified();\n\t\t});\n\t\ttrigger.subscribe('Trigger:modified', () => this.markModified());\n\t\ttrigger.subscribe('Trigger:onSettingsOpen', (event) => {\n\t\t\tthis.openTriggerSettingsDialog(event.data.trigger);\n\t\t});\n\t\ttrigger.subscribe('Trigger:deleted', (event) => this.deleteTrigger(event.data.trigger));\n\n\t}\n\n\tonSearch(event)\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.onSearch(event));\n\t}\n\n\tenableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.manage();\n\t\tconst deleteButtons = document.querySelectorAll('[data-role=\"btn-delete-trigger\"]');\n\t\tdeleteButtons.forEach(node => Dom.hide(node));\n\n\t\tthis.#triggers.forEach(trigger => Dom.addClass(trigger.node, '--locked-node'));\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tconst deleteButtons = document.querySelectorAll('[data-role=\"btn-delete-trigger\"]');\n\t\tdeleteButtons.forEach(node => Dom.show(node));\n\n\t\tthis.#triggers.forEach(trigger => Dom.removeClass(trigger.node, '--locked-node'));\n\t}\n\n\taddTrigger(triggerData: ?Object<string, any>, callback)\n\t{\n\t\tconst trigger = new Trigger();\n\t\ttrigger.draft = true;\n\t\ttrigger.init(triggerData, this.#viewMode);\n\t\tthis.subscribeTriggerEvents(trigger);\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, trigger);\n\t\t}\n\t}\n\n\tdeleteTrigger(trigger: Trigger, callback)\n\t{\n\t\tif (trigger.getId() > 0)\n\t\t{\n\t\t\ttrigger.markDeleted();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(let i = 0; i < this.#triggers.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#triggers[i] === trigger)\n\t\t\t\t{\n\t\t\t\t\tthis.#triggers.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback(trigger);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.registerItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.addClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#triggers.forEach(trigger => trigger.unregisterItem(trigger.node));\n\t\tthis.#triggersContainerNode.querySelectorAll('.bizproc-automation-trigger-item-wrapper').forEach((node) => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-trigger-item-wrapper-draggable');\n\t\t});\n\t}\n\n\tinsertTrigger(trigger)\n\t{\n\t\tthis.#triggers.push(trigger);\n\t\tthis.markModified(true);\n\t}\n\n\tinsertTriggerNode(documentStatus: string, triggerNode)\n\t{\n\t\tconst listNode = this.#triggersContainerNode.querySelector('[data-role=\"trigger-list\"][data-status-id=\"'+documentStatus+'\"]');\n\t\tif (listNode)\n\t\t{\n\t\t\tlistNode.appendChild(triggerNode);\n\t\t}\n\t}\n\n\tserialize(): Array<Object<string, any>>\n\t{\n\t\treturn this.#triggers.map(trigger => trigger.serialize());\n\t}\n\n\tcountAllTriggers(): number\n\t{\n\t\treturn this.#triggers.filter(trigger => !trigger.deleted).length;\n\t}\n\n\tgetTriggerName(code: string)\n\t{\n\t\treturn getGlobalContext().availableTriggers.find((trigger) => code === trigger['CODE'])?.NAME ?? code;\n\t}\n\n\tgetAvailableTrigger(code): ?Object\n\t{\n\t\tconst availableTriggers = getGlobalContext().availableTriggers;\n\t\tfor (let i = 0; i < availableTriggers.length; ++i)\n\t\t{\n\t\t\tif (code === availableTriggers[i]['CODE'])\n\t\t\t{\n\t\t\t\treturn availableTriggers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn getGlobalContext().canEdit;\n\t}\n\n\tcanSetExecuteBy(): boolean\n\t{\n\t\treturn getGlobalContext().get('TRIGGER_CAN_SET_EXECUTE_BY') ?? false;\n\t}\n\n\tneedSave()\n\t{\n\t\treturn this.#modified;\n\t}\n\n\tmarkModified(modified: boolean)\n\t{\n\t\tthis.#modified = modified !== false;\n\t\tif (this.#modified)\n\t\t{\n\t\t\tthis.emit('TriggerManager:dataModified');\n\t\t}\n\t}\n\n\topenTriggerSettingsDialog(trigger, context)\n\t{\n\t\tif (Designer.getInstance().getTriggerSettingsDialog())\n\t\t{\n\t\t\tif (context && context.changeTrigger)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getTriggerSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_trigger_dialog';\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tform.appendChild(this.renderConditionSettings(trigger));\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {click: (event) => this.emit('TriggerManager:onHelpClick', event)}\n\t\t});\n\t\tform.appendChild(iconHelp);\n\n\t\tconst title = this.getTriggerName(trigger.getCode());\n\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_NAME') + ':'\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: trigger.getName() || title\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t],\n\t\t}));\n\n\t\t//TODO: refactoring\n\t\tconst triggerData = this.getAvailableTrigger(trigger.getCode());\n\t\tif (trigger.getCode() === 'WEBHOOK')\n\t\t{\n\t\t\tif (!trigger.getApplyRules()['code'])\n\t\t\t{\n\t\t\t\ttrigger.getApplyRules()['code'] = Text.getRandom(5);\n\t\t\t}\n\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: \"URL:\"\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create('input', {\n\t\t\t\tprops: {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tvalue: trigger.getApplyRules()['code'],\n\t\t\t\t\tname: 'code'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tconst hookLinkTextarea = Dom.create(\"textarea\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-textarea\",\n\t\t\t\t\tplaceholder: \"...\",\n\t\t\t\t\treadonly: 'readonly',\n\t\t\t\t\tname: 'webhook_handler'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [hookLinkTextarea]\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_WEBHOOK_ID'),\n\t\t\t}));\n\n\t\t\tif (triggerData && triggerData['HANDLER'])\n\t\t\t{\n\t\t\t\tlet url = window.location.protocol + '//' + window.location.host + triggerData['HANDLER'];\n\t\t\t\turl = Uri.addParam(url, {code: trigger.getApplyRules()['code']});\n\t\t\t\turl = url.replace('{{DOCUMENT_TYPE}}', getGlobalContext().document.getRawType()[2]);\n\t\t\t\thookLinkTextarea.value = url;\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'EMAIL_LINK')\n\t\t{\n\t\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_EMAIL_LINK_URL') + ':',\n\t\t\t}));\n\n\t\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create(\"textarea\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tclassName: \"bizproc-automation-popup-textarea\",\n\t\t\t\t\t\t\tplaceholder: \"https://example.com\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprops: {name: 'url'},\n\t\t\t\t\t\ttext: trigger.getApplyRules()['url'] || ''\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}));\n\t\t}\n\t\telse if (trigger.getCode() === 'WEBFORM')\n\t\t{\n\t\t\tif (triggerData && triggerData['WEBFORM_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'form_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY')\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['WEBFORM_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['WEBFORM_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['form_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['form_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'CALLBACK')\n\t\t{\n\t\t\tif (triggerData && triggerData['WEBFORM_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'form_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['WEBFORM_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['WEBFORM_LIST'][i];\n\t\t\t\t\tselect.appendChild(\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['form_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['form_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_LABEL') + ':'}),\n\t\t\t\t\t\tselect\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() === 'STATUS')\n\t\t{\n\t\t\tif (triggerData && triggerData['STATUS_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'STATUS',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_STATUS_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['STATUS_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['STATUS_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['STATUS'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['STATUS'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: triggerData['STATUS_LABEL'] + ':'}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tselect\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() == 'CALL')\n\t\t{\n\t\t\tif (triggerData && triggerData['LINES'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'LINE_NUMBER',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['LINES'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['LINES'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['LINE_NUMBER']},\n\t\t\t\t\t\ttext: item['SHORT_NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (trigger.getApplyRules()['LINE_NUMBER'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['LINE_NUMBER'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_CALL_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\t\telse if (trigger.getCode() == 'OPENLINE' || trigger.getCode() == 'OPENLINE_MSG')\n\t\t{\n\t\t\tif (triggerData && triggerData['CONFIG_LIST'])\n\t\t\t{\n\t\t\t\tconst select = Dom.create('select', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tname: 'config_id',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('option', {\n\t\t\t\t\t\t\tprops: {value: ''},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_WEBFORM_ANY')\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tfor (let i = 0; i < triggerData['CONFIG_LIST'].length; ++i)\n\t\t\t\t{\n\t\t\t\t\tconst item = triggerData['CONFIG_LIST'][i];\n\t\t\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\t\t\tprops: {value: item['ID']},\n\t\t\t\t\t\ttext: item['NAME']\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (Type.isPlainObject(trigger.getApplyRules()) && trigger.getApplyRules()['config_id'])\n\t\t\t\t{\n\t\t\t\t\tselect.value = trigger.getApplyRules()['config_id'];\n\t\t\t\t}\n\n\t\t\t\tconst div = Dom.create('div', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings'},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TRIGGER_OPENLINE_LABEL') + ':'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselect,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tform.appendChild(div);\n\t\t\t}\n\t\t}\n\n\t\tBX.onCustomEvent(\n\t\t\t'BX.Bizproc.Automation.TriggerManager:onOpenSettingsDialog-' + trigger.getCode(),\n\t\t\t[trigger, form]\n\t\t);\n\n\t\tif (this.canSetExecuteBy())\n\t\t{\n\t\t\tthis.renderExecuteByControl(trigger, form);\n\t\t}\n\n\t\tthis.renderAllowBackwardsControl(trigger, form);\n\n\t\tDom.addClass(this.#triggersContainerNode, 'automation-base-blocked');\n\n\t\tDesigner.getInstance().setTriggerSettingsDialog({\n\t\t\ttriggerManager: this,\n\t\t\ttrigger: trigger,\n\t\t\tform: form\n\t\t});\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: title,\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function(popup)\n\t\t\t\t{\n\t\t\t\t\tDesigner.getInstance().setTriggerSettingsDialog(null);\n\t\t\t\t\tself.destroySettingsDialogControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tDom.removeClass(self.#triggersContainerNode, 'automation-base-blocked');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick() {\n\t\t\t\t\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\t\t\t\t\ttrigger.setName(formData['data']['name']);\n\n\t\t\t\t\t\t\t//TODO: refactoring\n\t\t\t\t\t\t\tif (trigger.getCode() === 'WEBFORM')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({form_id:  formData['data']['form_id']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'CALLBACK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({form_id: formData['data']['form_id']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'STATUS')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({STATUS: formData['data']['STATUS']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'CALL' && 'LINE_NUMBER' in formData['data'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({LINE_NUMBER: formData['data']['LINE_NUMBER']});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (trigger.getCode() === 'OPENLINE' || trigger.getCode() === 'OPENLINE_MSG')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({config_id: formData['data']['config_id']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.getCode() === 'WEBHOOK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({code: formData['data']['code']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.getCode() === 'EMAIL_LINK')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setApplyRules({url: formData['data']['url']});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\t\t\t\t'BX.Bizproc.Automation.TriggerManager:onSaveSettings-'+trigger.getCode(),\n\t\t\t\t\t\t\t\t[trigger, formData]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tself.setConditionSettingsFromForm(formData['data'], trigger);\n\t\t\t\t\t\t\ttrigger.setAllowBackwards(formData['data']['allow_backwards'] === 'Y');\n\n\t\t\t\t\t\t\tif (self.canSetExecuteBy())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrigger.setExecuteBy(formData['data']['execute_by']);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (trigger.draft)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// remove orange/yellow color\n\n\t\t\t\t\t\t\t\t//self.#triggers.push(trigger);\n\t\t\t\t\t\t\t\t//self.insertTriggerNode(trigger.getStatusId(), trigger.node)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//analytics\n\t\t\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t\t\t'bizproc.analytics.push',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tanalyticsLabel: `automation_trigger${trigger.draft ? '_draft' : ''}_save_${trigger.getCode().toLowerCase()}`\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tdelete trigger.draft;\n\n\t\t\t\t\t\t\ttrigger.reInit();\n\t\t\t\t\t\t\tself.markModified();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tDesigner.getInstance().getTriggerSettingsDialog().popup = popup;\n\t\tpopup.show();\n\n\t\t//analytics\n\t\tajax.runAction(\n\t\t\t'bizproc.analytics.push',\n\t\t\t{\n\t\t\t\tanalyticsLabel: `automation_trigger${trigger.draft ? '_draft' : ''}_settings_${trigger.getCode().toLowerCase()}`\n\t\t\t}\n\t\t);\n\t}\n\n\trenderConditionSettings(trigger: Trigger)\n\t{\n\t\tconst conditionGroup = trigger.getCondition().clone();\n\n\t\tthis.conditionSelector = new ConditionGroupSelector(\n\t\t\tconditionGroup,\n\t\t\t{fields: getGlobalContext().document.getFields()},\n\t\t);\n\t\tconst selector = this.conditionSelector;\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\",\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tselector.createNode(),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\trenderExecuteByControl(trigger, form)\n\t{\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-top bizproc-automation-popup-settings-title-autocomplete\",\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_EXECUTE_BY') + ':',\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tBX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tgetGlobalContext().document.getRawType(),\n\t\t\t\t\t{\n\t\t\t\t\t\tType: 'user'\n\t\t\t\t\t},\n\t\t\t\t\t'execute_by',\n\t\t\t\t\ttrigger.draft\n\t\t\t\t\t\t? Helper.getResponsibleUserExpression(getGlobalContext().document.getFields())\n\t\t\t\t\t\t: trigger.getExecuteBy()\n\t\t\t\t),\n\t\t\t],\n\t\t}));\n\t}\n\n\trenderAllowBackwardsControl(trigger, form)\n\t{\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-checkbox-item\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-chk-label\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"input\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'bizproc-automation-popup-chk',\n\t\t\t\t\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\t\t\t\t\tname: \"allow_backwards\",\n\t\t\t\t\t\t\t\t\t\tvalue: 'Y'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tchecked: trigger.isBackwardsAllowed()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdocument.createTextNode(Loc.getMessage('BIZPROC_AUTOMATION_CMP_TRIGGER_ALLOW_REVERSE')),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t}));\n\t}\n\n\tsetConditionSettingsFromForm(formFields: Object,  trigger: Trigger): this\n\t{\n\t\ttrigger.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\tonRestAppInstall(installed, eventResult)\n\t{\n\t\teventResult.redirect = false;\n\t\tconst self = this;\n\n\t\tsetTimeout(function()\n\t\t{\n\t\t\tBX.ajax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: getGlobalContext().ajaxUrl,\n\t\t\t\tdata: {\n\t\t\t\t\tajax_action: 'get_available_triggers',\n\t\t\t\t\tdocument_signed: getGlobalContext().signedDocument\n\t\t\t\t},\n\t\t\t\tonsuccess(response)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isArray(response['DATA']))\n\t\t\t\t\t{\n\t\t\t\t\t\tgetGlobalContext().set('availableTriggers', response['DATA']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}, 1500);\n\t}\n\n\tinitSettingsDialogControls(node)\n\t{\n\t\tif (!Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tthis.settingsDialogControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tlet control = null;\n\t\t\tconst role = controlNodes[i].getAttribute('data-role');\n\n\t\t\tif (role === 'user-selector')\n\t\t\t{\n\t\t\t\tcontrol = BX.Bizproc.UserSelector.decorateNode(controlNodes[i]);\n\t\t\t}\n\n\t\t\tBX.UI.Hint.init(controlNodes[i]);\n\n\t\t\tif (control)\n\t\t\t{\n\t\t\t\tthis.settingsDialogControls.push(control);\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroySettingsDialogControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.settingsDialogControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.settingsDialogControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.settingsDialogControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.settingsDialogControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.settingsDialogControls = null;\n\t}\n\n\tgetListByDocumentStatus(statusId): Array<Trigger>\n\t{\n\t\tconst result = [];\n\t\tthis.#triggers.forEach((trigger) => {\n\t\t\tif (trigger.getStatusId() === statusId)\n\t\t\t{\n\t\t\t\tresult.push(trigger);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperties(statusId): Array<Object>\n\t{\n\t\tconst result = [];\n\t\tconst exists = {};\n\t\tconst triggers = this.getListByDocumentStatus(statusId);\n\n\t\ttriggers.forEach((trigger) => {\n\t\t\tconst props = trigger.deleted ? [] : trigger.getReturnProperties();\n\t\t\tif (props.length)\n\t\t\t{\n\t\t\t\tprops.forEach((property) => {\n\t\t\t\t\tif (!exists[property.Id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tId: property.Id,\n\t\t\t\t\t\t\tObjectId: 'Template',\n\t\t\t\t\t\t\tName: property.Name,\n\t\t\t\t\t\t\tObjectName: trigger.getName(),\n\t\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\t\tExpression: '{{~*:'+property.Id+'}}',\n\t\t\t\t\t\t\tSystemExpression: '{=Template:'+property.Id+'}'\n\t\t\t\t\t\t});\n\t\t\t\t\t\texists[property.Id] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetReturnProperty(statusId, propertyId): ?Object\n\t{\n\t\tconst properties = this.getReturnProperties(statusId);\n\t\tfor (let i = 0; i < properties.length; ++i)\n\t\t{\n\t\t\tif (properties[i].Id === propertyId)\n\t\t\t{\n\t\t\t\treturn properties[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { Type, Runtime } from 'main.core';\n\nexport class Document\n{\n\t#rawType: Array<string>;\n\t#id: number;\n\t#title: ?string;\n\t#categoryId: ?number;\n\t#statusList: ?Array<Object>;\n\t#currentStatusIndex: number;\n\n\t#fields: ?Array<Object>;\n\n\tconstructor(options: {\n\t\trawDocumentType: Array<string>,\n\t\tdocumentId: number,\n\t\tcategoryId?: number,\n\t\tstatusId?: string,\n\n\t\tstatusList: Array<Object>,\n\n\t\tdocumentFields?: Array<Object>;\n\t\ttitle?: string,\n\t})\n\t{\n\t\tthis.#rawType = options.rawDocumentType;\n\t\tthis.#id = options.documentId;\n\t\tthis.#title = options.title;\n\t\tthis.#categoryId = options.categoryId;\n\n\t\tthis.#statusList = [];\n\t\tthis.#currentStatusIndex = 0;\n\t\tif (Type.isArray(options.statusList))\n\t\t{\n\t\t\tthis.#statusList = options.statusList\n\t\t\tthis.#currentStatusIndex = this.#statusList.findIndex(status => status.STATUS_ID === options.statusId)\n\t\t}\n\t\telse if (Type.isStringFilled(options.statusId))\n\t\t{\n\t\t\tthis.#statusList.push(options.statusId);\n\t\t}\n\n\t\tif (this.#currentStatusIndex < 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = 0;\n\t\t}\n\n\t\tthis.#fields = Type.isArray(options.documentFields) ? options.documentFields : [];\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new Document({\n\t\t\trawDocumentType: Runtime.clone(this.#rawType),\n\t\t\tdocumentId: this.#id,\n\t\t\tcategoryId: this.#categoryId,\n\t\t\tstatusId: this.getCurrentStatusId(),\n\n\t\t\tstatusList: Runtime.clone(this.#statusList),\n\n\t\t\tdocumentFields: Runtime.clone(this.#fields),\n\t\t\ttitle: this.#title,\n\t\t});\n\t}\n\n\tget title(): ?string\n\t{\n\t\treturn this.#title;\n\t}\n\n\tgetRawType(): Array<string>\n\t{\n\t\treturn this.#rawType;\n\t}\n\n\tgetCategoryId(): ?number\n\t{\n\t\treturn this.#categoryId;\n\t}\n\n\tgetCurrentStatusId(): ?string\n\t{\n\t\treturn this.#statusList[this.#currentStatusIndex]?.STATUS_ID;\n\t}\n\n\tgetSortedStatusId(index: number): ?string\n\t{\n\t\tif (index >= 0 && index < this.#statusList.length)\n\t\t{\n\t\t\treturn this.#statusList[index].STATUS_ID;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetNextStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(this.#currentStatusIndex + 1).map(status => status.STATUS_ID);\n\t}\n\n\tgetPreviousStatusIdList(): Array<string>\n\t{\n\t\treturn this.#statusList.slice(0, this.#currentStatusIndex).map(status => status.STATUS_ID);\n\t}\n\n\tsetStatus(statusId: string): Document\n\t{\n\t\tconst newStatusId = this.#statusList.findIndex(status => status.STATUS_ID === statusId);\n\t\tif (newStatusId >= 0)\n\t\t{\n\t\t\tthis.#currentStatusIndex = newStatusId;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetFields(): Array<Object>\n\t{\n\t\treturn this.#fields;\n\t}\n\n\tsetFields(documentFields: Array<object>): this\n\t{\n\t\tthis.#fields = documentFields;\n\n\t\treturn this;\n\t}\n\n\tsetStatusList(statusList: Array<Object>): this\n\t{\n\t\tif (Type.isArrayFilled(statusList))\n\t\t{\n\t\t\tthis.#statusList = statusList;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget statusList(): ?Array<Object>\n\t{\n\t\treturn this.#statusList;\n\t}\n}","import { Type, Loc } from 'main.core';\n\nexport class DelayInterval\n{\n\tstatic BASIS_TYPE = {\n\t\tCurrentDate: '{=System:Date}',\n\t\tCurrentDateTime: '{=System:Now}',\n\t\tCurrentDateTimeLocal: '{=System:NowLocal}',\n\t};\n\n\tstatic DELAY_TYPE = {\n\t\tAfter: 'after',\n\t\tBefore: 'before',\n\t\tIn: 'in',\n\t};\n\n\t#basis: string;\n\t#type: string;\n\t#value: number;\n\t#valueType: string;\n\t#workTime: boolean;\n\t#localTime: boolean;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tthis.#basis = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t\tthis.#type = DelayInterval.DELAY_TYPE.After;\n\t\tthis.#value = 0;\n\t\tthis.#valueType = 'i';\n\t\tthis.#workTime = false;\n\t\tthis.#localTime = false;\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.setType(params['type']);\n\t\t\t}\n\t\t\tif (params['value'])\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t\tif (params['valueType'])\n\t\t\t{\n\t\t\t\tthis.setValueType(params['valueType']);\n\t\t\t}\n\t\t\tif (params['basis'])\n\t\t\t{\n\t\t\t\tthis.setBasis(params['basis']);\n\t\t\t}\n\t\t\tif (params['workTime'])\n\t\t\t{\n\t\t\t\tthis.setWorkTime(params['workTime']);\n\t\t\t}\n\t\t\tif (params['localTime'])\n\t\t\t{\n\t\t\t\tthis.setLocalTime(params['localTime']);\n\t\t\t}\n\t\t}\n\t}\n\n\tget basis()\n\t{\n\t\treturn this.#basis;\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tget valueType()\n\t{\n\t\treturn this.#valueType;\n\t}\n\n\tget workTime()\n\t{\n\t\treturn this.#workTime;\n\t}\n\n\tget localTime()\n\t{\n\t\treturn this.#localTime;\n\t}\n\n\tclone()\n\t{\n\t\treturn new DelayInterval({\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime,\n\t\t\tlocalTime: this.#localTime,\n\t\t});\n\t}\n\n\tstatic isSystemBasis(basis: string): boolean\n\t{\n\t\treturn (\n\t\t\tbasis === this.BASIS_TYPE.CurrentDate\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTime\n\t\t\t|| basis === this.BASIS_TYPE.CurrentDateTimeLocal\n\t\t);\n\t}\n\n\tstatic fromString(intervalString, basisFields): this\n\t{\n\t\tintervalString = intervalString.toString();\n\t\tconst params = {\n\t\t\tbasis: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\ti: 0,\n\t\t\th: 0,\n\t\t\td: 0,\n\t\t\tworkTime: false,\n\t\t\tlocalTime: false\n\t\t};\n\n\t\tif (intervalString.indexOf('=dateadd(') === 0 || intervalString.indexOf('=workdateadd(') === 0)\n\t\t{\n\t\t\tif (intervalString.indexOf('=workdateadd(') === 0)\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(13);\n\t\t\t\tparams['workTime'] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tintervalString = intervalString.substring(9);\n\t\t\t}\n\n\t\t\tconst fnArgs = intervalString.split(',');\n\t\t\tparams['basis'] = fnArgs[0].trim();\n\t\t\tfnArgs[1] = fnArgs[1].replace(/['\")]+/g, '');\n\t\t\tparams['type'] = fnArgs[1].indexOf('-') === 0 ? DelayInterval.DELAY_TYPE.Before : DelayInterval.DELAY_TYPE.After;\n\n\t\t\tlet match;\n\t\t\tconst re = /s*([\\d]+)\\s*(i|h|d)\\s*/ig;\n\t\t\twhile (match = re.exec(fnArgs[1]))\n\t\t\t{\n\t\t\t\tparams[match[2]] = parseInt(match[1]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['basis'] = intervalString;\n\t\t}\n\n\t\tif (!DelayInterval.isSystemBasis(params['basis']) && BX.type.isArray(basisFields))\n\t\t{\n\t\t\tlet found = false;\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (params['basis'] === basisFields[i].SystemExpression || params['basis'] === basisFields[i].Expression)\n\t\t\t\t{\n\t\t\t\t\tparams['basis'] = basisFields[i].SystemExpression;\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\tparams['basis'] = DelayInterval.BASIS_TYPE.CurrentDateTime;\n\t\t\t}\n\t\t}\n\n\t\tconst minutes = params['i'] + params['h'] * 60 + params['d'] * 60 * 24;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 1440;\n\t\t\tparams['valueType'] = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tparams['value'] = minutes / 60;\n\t\t\tparams['valueType'] = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams['value'] = minutes;\n\t\t\tparams['valueType'] = 'i';\n\t\t}\n\n\t\tif (!params['value'] && params['basis'] !== DelayInterval.BASIS_TYPE.CurrentDateTime && params['basis'])\n\t\t{\n\t\t\tparams['type'] = DelayInterval.DELAY_TYPE.In;\n\t\t}\n\n\t\treturn new DelayInterval(params);\n\t};\n\n\tstatic fromMinutes(minutes): Array<string>\n\t{\n\t\tlet value;\n\t\tlet type;\n\n\t\tif (minutes % 1440 === 0)\n\t\t{\n\t\t\tvalue = minutes / 1440;\n\t\t\ttype = 'd';\n\t\t}\n\t\telse if (minutes % 60 === 0)\n\t\t{\n\t\t\tvalue = minutes / 60;\n\t\t\ttype = 'h';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalue = minutes;\n\t\t\ttype = 'i';\n\t\t}\n\n\t\treturn [value, type];\n\t}\n\n\tstatic toMinutes(value, valueType): number\n\t{\n\t\tlet result = 0;\n\n\t\tswitch (valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tresult = value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\tresult = value * 60;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tresult = value * 60 * 24;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetType(type): this\n\t{\n\t\tif (\n\t\t\ttype !== DelayInterval.DELAY_TYPE.After\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.Before\n\t\t\t&& type !== DelayInterval.DELAY_TYPE.In\n\t\t)\n\t\t{\n\t\t\ttype = DelayInterval.DELAY_TYPE.After;\n\t\t}\n\t\tthis.#type = type;\n\n\t\treturn this;\n\t}\n\n\tsetValue(value): this\n\t{\n\t\tvalue = parseInt(value);\n\t\tthis.#value = value >= 0 ? value : 0;\n\n\t\treturn this;\n\t}\n\n\tsetValueType(valueType: string): this\n\t{\n\t\tif (valueType !== 'i' && valueType !== 'h' && valueType !== 'd')\n\t\t{\n\t\t\tvalueType = 'i';\n\t\t}\n\n\t\tthis.#valueType = valueType;\n\n\t\treturn this;\n\t}\n\n\tsetBasis(basis: string): this\n\t{\n\t\tif (Type.isString(basis) && basis !== '')\n\t\t{\n\t\t\tthis.#basis = basis;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetWorkTime(flag): this\n\t{\n\t\tthis.#workTime = !!flag;\n\n\t\treturn this;\n\t}\n\n\tsetLocalTime(flag): this\n\t{\n\t\tthis.#localTime = !!flag;\n\n\t\treturn this;\n\t}\n\n\tisNow(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t&& this.#basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t&& !this.#value\n\t\t);\n\t}\n\n\tsetNow(): void\n\t{\n\t\tthis.setType(DelayInterval.DELAY_TYPE.After);\n\t\tthis.setValue(0);\n\t\tthis.setValueType('i');\n\t\tthis.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\tvalue: this.#value,\n\t\t\tvalueType: this.#valueType,\n\t\t\tbasis: this.#basis,\n\t\t\tworkTime: this.#workTime ? 1 : 0\n\t\t}\n\t}\n\n\ttoExpression(basisFields, workerExpression): string\n\t{\n\t\tlet basis = this.#basis ? this.#basis : DelayInterval.BASIS_TYPE.CurrentDate;\n\n\t\tif (!DelayInterval.isSystemBasis(basis) && Type.isArray(basisFields))\n\t\t{\n\t\t\tfor (let i = 0, s = basisFields.length; i < s; ++i)\n\t\t\t{\n\t\t\t\tif (basis === basisFields[i].SystemExpression)\n\t\t\t\t{\n\t\t\t\t\tbasis = basisFields[i].Expression;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this.#workTime && (this.#type === DelayInterval.DELAY_TYPE.In || this.isNow()))\n\t\t{\n\t\t\treturn basis;\n\t\t}\n\n\t\tlet days = 0;\n\t\tlet hours = 0;\n\t\tlet minutes = 0;\n\n\t\tswitch (this.#valueType)\n\t\t{\n\t\t\tcase 'i':\n\t\t\t\tminutes = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\thours = this.#value;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tdays = this.#value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet add = '';\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tadd = '-';\n\t\t}\n\n\t\tif (days > 0)\n\t\t{\n\t\t\tadd += days + 'd';\n\t\t}\n\t\tif (hours > 0)\n\t\t{\n\t\t\tadd += hours + 'h';\n\t\t}\n\t\tif (minutes > 0)\n\t\t{\n\t\t\tadd += minutes + 'i';\n\t\t}\n\n\t\tconst fn = this.#workTime ? 'workdateadd' : 'dateadd';\n\n\t\tif (fn === 'workdateadd' && add === '')\n\t\t{\n\t\t\tadd = '0d';\n\t\t}\n\n\t\tlet worker = '';\n\t\tif (fn === 'workdateadd' && workerExpression)\n\t\t{\n\t\t\tworker = workerExpression;\n\t\t}\n\n\t\treturn '='+ fn + '(' + basis + ',\"' + add + '\"' + (worker ? ',' + worker : '') + ')';\n\t}\n\n\tformat(emptyText, fields)\n\t{\n\t\tlet str = emptyText;\n\n\t\tif (this.#type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tstr = Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME');\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.#value)\n\t\t{\n\t\t\tconst prefix = (\n\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH')\n\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_1')\n\t\t\t);\n\n\t\t\tstr = prefix + ' ' + this.getFormattedPeriodLabel(this.#value, this.#valueType);\n\n\t\t\tif (Type.isArray(fields))\n\t\t\t{\n\t\t\t\tconst fieldSuffix = (\n\t\t\t\t\tthis.#type === DelayInterval.DELAY_TYPE.After\n\t\t\t\t\t\t? Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t);\n\t\t\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (this.#basis === fields[i].SystemExpression)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += ' ' + fieldSuffix + ' ' + fields[i].Name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.#workTime)\n\t\t{\n\t\t\tstr += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_WORKTIME');\n\t\t}\n\n\t\treturn str;\n\t}\n\n\tgetFormattedPeriodLabel(value, type)\n\t{\n\t\tconst label = value + ' ';\n\t\tlet labelIndex = 0;\n\t\tif (value > 20)\n\t\t{\n\t\t\tvalue = (value % 10);\n\t\t}\n\n\t\tif (value === 1)\n\t\t{\n\t\t\tlabelIndex = 0;\n\t\t}\n\t\telse if (value > 1 && value < 5)\n\t\t{\n\t\t\tlabelIndex = 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabelIndex = 2;\n\t\t}\n\n\t\tconst labels = DelayInterval.getPeriodLabels(type);\n\n\t\treturn label + (labels ? labels[labelIndex] : '');\n\t}\n\n\tstatic getPeriodLabels(period)\n\t{\n\t\tlet labels = [];\n\t\tif (period === 'i')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_MIN3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'h')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_HOUR3')\n\t\t\t];\n\t\t}\n\t\telse if (period === 'd')\n\t\t{\n\t\t\tlabels = [\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY1'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY2'),\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_DAY3')\n\t\t\t];\n\t\t}\n\n\t\treturn labels;\n\t}\n}","export class WorkflowStatus\n{\n\tstatic CREATED = 0;\n\tstatic RUNNING = 1;\n\tstatic COMPLETED = 2;\n\tstatic SUSPENDED = 3;\n\tstatic TERMINATED = 4;\n}","import {WorkflowStatus} from \"../workflow/types\";\n\nexport class TrackingEntry\n{\n\tstatic UNKNOWN_ACTIVITY_TYPE = 0;\n\tstatic EXECUTE_ACTIVITY_TYPE = 1;\n\tstatic CLOSE_ACTIVITY_TYPE = 2;\n\tstatic CANCEL_ACTIVITY_TYPE = 3;\n\tstatic FAULT_ACTIVITY_TYPE = 4;\n\tstatic CUSTOM_ACTIVITY_TYPE = 5;\n\tstatic REPORT_ACTIVITY_TYPE = 6;\n\tstatic ATTACHED_ENTITY_TYPE = 7;\n\tstatic TRIGGER_ACTIVITY_TYPE = 8;\n\tstatic ERROR_ACTIVITY_TYPE = 9;\n\tstatic DEBUG_ACTIVITY_TYPE = 10;\n\tstatic DEBUG_AUTOMATION_TYPE = 11;\n\tstatic DEBUG_DESIGNER_TYPE = 12;\n\tstatic DEBUG_LINK_TYPE = 13;\n\n\tid: number;\n\tworkflowId: string;\n\t#type: number;\n\tname: string;\n\ttitle: string;\n\tnote: string;\n\t// TODO - convert string to Date\n\tdatetime: string;\n\t#workflowStatus: number;\n\n\tget type(): number\n\t{\n\t\treturn this.#type;\n\t}\n\n\tget workflowStatus(): number\n\t{\n\t\treturn this.#workflowStatus;\n\t}\n\n\tset type(entryType: number)\n\t{\n\t\tif (TrackingEntry.getAllActivityTypes().includes(entryType))\n\t\t{\n\t\t\tthis.#type = entryType;\n\t\t}\n\t}\n\n\tset workflowStatus(entryWorkflowStatus: number)\n\t{\n\t\tif (TrackingEntry.getAllWorkflowStatuses().includes(entryWorkflowStatus))\n\t\t{\n\t\t\tthis.#workflowStatus = entryWorkflowStatus;\n\t\t}\n\t}\n\n\tisTriggerEntry(): boolean\n\t{\n\t\treturn this.type === TrackingEntry.TRIGGER_ACTIVITY_TYPE;\n\t}\n\n\tstatic getAllActivityTypes(): Array<number>\n\t{\n\t\treturn [\n\t\t\tTrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CLOSE_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CANCEL_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.FAULT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.CUSTOM_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.REPORT_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ATTACHED_ENTITY_TYPE,\n\t\t\tTrackingEntry.TRIGGER_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.ERROR_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_ACTIVITY_TYPE,\n\t\t\tTrackingEntry.DEBUG_AUTOMATION_TYPE,\n\t\t\tTrackingEntry.DEBUG_DESIGNER_TYPE,\n\t\t\tTrackingEntry.DEBUG_LINK_TYPE,\n\t\t];\n\t}\n\n\tstatic isKnownActivityType(typeId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllActivityTypes().includes(typeId);\n\t}\n\n\tstatic getAllWorkflowStatuses(): Array<number>\n\t{\n\t\treturn [\n\t\t\tWorkflowStatus.CREATED,\n\t\t\tWorkflowStatus.RUNNING,\n\t\t\tWorkflowStatus.COMPLETED,\n\t\t\tWorkflowStatus.SUSPENDED,\n\t\t\tWorkflowStatus.TERMINATED,\n\t\t];\n\t}\n\n\tstatic isKnownWorkflowStatus(statusId: number): boolean\n\t{\n\t\treturn TrackingEntry.getAllWorkflowStatuses().includes(statusId);\n\t}\n}","export class TrackingStatus\n{\n\tstatic WAITING = 0;\n\tstatic RUNNING = 1;\n\tstatic COMPLETED = 2;\n\tstatic AUTOCOMPLETED = 3;\n}","import {Type} from 'main.core';\nimport { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport {WorkflowStatus} from \"../workflow/types\";\n\nexport class RobotEntry\n{\n\tid: string = '';\n\tstatus: string = TrackingStatus.WAITING;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\tnotes: Array<string> = [];\n\terrors: Array<string> = [];\n\t#entryId: number = -1;\n\tworkflowStatus: number = WorkflowStatus.CREATED;\n\n\tconstructor(entries: ?Array<TrackingEntry>)\n\t{\n\t\tif (Type.isArray(entries))\n\t\t{\n\t\t\tfor (const entry of entries)\n\t\t\t{\n\t\t\t\tthis.addEntry(entry);\n\t\t\t}\n\t\t}\n\t}\n\n\taddEntry(entry: TrackingEntry)\n\t{\n\t\tthis.id = entry.name;\n\n\t\tif (this.#entryId < entry.id)\n\t\t{\n\t\t\tthis.#entryId = entry.id;\n\t\t\tthis.modified = entry.datetime;\n\t\t\tthis.workflowStatus = entry.workflowStatus;\n\n\t\t\tif (entry.type === TrackingEntry.CLOSE_ACTIVITY_TYPE)\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.COMPLETED;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.status = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\tif (entry.type === TrackingEntry.ERROR_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.errors.push(entry.note);\n\t\t}\n\t\telse if (entry.type === TrackingEntry.CUSTOM_ACTIVITY_TYPE)\n\t\t{\n\t\t\tthis.notes.push(entry.note);\n\t\t}\n\t}\n}","import { TrackingEntry } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\n\nexport class TriggerEntry\n{\n\tid: string = '';\n\tstatus: number = TrackingStatus.COMPLETED;\n\t// TODO - change string to Date when Date appear in TrackingEntry\n\tmodified: ?string = undefined;\n\n\tconstructor(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.id = entry.note;\n\t\t\tthis.modified = entry.datetime;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport class TrackingEntryBuilder\n{\n\t#defaultSettings = {\n\t\tid: TrackingEntry.UNKNOWN_ACTIVITY_TYPE,\n\t\tworkflowId: '',\n\t\ttype: TrackingEntry.EXECUTE_ACTIVITY_TYPE,\n\t\tname: '',\n\t\ttitle: '',\n\t\tdatetime: '',\n\t\tnote: '',\n\t\tworkflowStatus: WorkflowStatus.CREATED,\n\t};\n\t#entrySettings: Object<string, string | number>;\n\n\tconstructor()\n\t{\n\t\tthis.#entrySettings = this.#defaultSettings;\n\t}\n\n\tsetLogEntry(logEntry: Object<string, any>): this\n\t{\n\t\tthis.#entrySettings = Object.assign({}, this.#defaultSettings);\n\t\tlogEntry = Object.assign({}, logEntry);\n\n\t\tif (Type.isStringFilled(logEntry['ID']))\n\t\t{\n\t\t\tlogEntry['ID'] = parseInt(logEntry['ID']);\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['TYPE']))\n\t\t{\n\t\t\tlogEntry['TYPE'] = parseInt(logEntry['TYPE']);\n\t\t}\n\n\t\tif (Type.isNumber(logEntry['ID']))\n\t\t{\n\t\t\tthis.#entrySettings.id = logEntry['ID'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['WORKFLOW_ID']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowId = logEntry['WORKFLOW_ID'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['TYPE']) && TrackingEntry.isKnownActivityType(logEntry['TYPE']))\n\t\t{\n\t\t\tthis.#entrySettings.type = logEntry['TYPE'];\n\t\t}\n\t\tif (Type.isStringFilled(logEntry['MODIFIED']))\n\t\t{\n\t\t\tthis.#entrySettings.datetime = logEntry['MODIFIED'];\n\t\t}\n\t\tif (Type.isNumber(logEntry['WORKFLOW_STATUS']) && TrackingEntry.isKnownWorkflowStatus(logEntry['WORKFLOW_STATUS']))\n\t\t{\n\t\t\tthis.#entrySettings.workflowStatus = logEntry['WORKFLOW_STATUS'];\n\t\t}\n\n\t\tthis.#entrySettings.name = String(logEntry['ACTION_NAME']);\n\t\tthis.#entrySettings.title = String(logEntry['ACTION_TITLE']);\n\t\tthis.#entrySettings.note = String(logEntry['ACTION_NOTE']);\n\n\t\treturn this;\n\t}\n\n\tsetStatus(status: string): this\n\t{\n\t\tthis.#entrySettings.status = status;\n\n\t\treturn this;\n\t}\n\n\tbuild(): TrackingEntry\n\t{\n\t\tconst entry = new TrackingEntry();\n\n\t\tentry.id = this.#entrySettings.id;\n\t\tentry.workflowId = this.#entrySettings.workflowId;\n\t\tentry.type = this.#entrySettings.type;\n\t\tentry.name = this.#entrySettings.name;\n\t\tentry.title = this.#entrySettings.title;\n\t\tentry.note = this.#entrySettings.note;\n\t\tentry.datetime = this.#entrySettings.datetime;\n\t\tentry.workflowStatus = this.#entrySettings.workflowStatus;\n\n\t\treturn entry;\n\t}\n}","import { Type } from 'main.core';\nimport { TrackingEntry } from './tracking-entry';\nimport { RobotEntry } from './robot-entry';\nimport { TriggerEntry } from './trigger-entry';\nimport { TrackingEntryBuilder } from './tracking-entry-builder';\nimport { Document } from 'bizproc.automation';\nimport { TrackingStatus } from './types';\nimport { WorkflowStatus } from \"../workflow/types\";\n\nexport {\n\tRobotEntry,\n\tTriggerEntry,\n\tTrackingEntryBuilder,\n\tTrackingEntry,\n\tTrackingStatus,\n}\n\nexport class Tracker\n{\n\t#ajaxUrl: string;\n\t#document: ?Document;\n\n\t#triggerLogs: Object<string, TrackingEntry>;\n\t#robotLogs: Object<string, RobotEntry>;\n\n\tconstructor(document: ?Document, ajaxUrl: string)\n\t{\n\t\tthis.#ajaxUrl = ajaxUrl;\n\t\tthis.#document = document;\n\t}\n\n\tinit(log)\n\t{\n\t\tthis.#triggerLogs = {};\n\t\tthis.#robotLogs = {};\n\n\t\tthis.addLogs(log);\n\t}\n\n\treInit(log)\n\t{\n\t\tthis.init(log);\n\t}\n\n\taddLogs(log: Object<string, Array<Object<string, any>>>)\n\t{\n\t\tif (!Type.isPlainObject(log))\n\t\t{\n\t\t\tlog = {};\n\t\t}\n\n\t\tconst logEntryBuilder = new TrackingEntryBuilder();\n\n\t\tfor (const [statusId, entries] of Object.entries(log))\n\t\t{\n\t\t\tif (!Type.isArray(entries))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const rawEntry of entries)\n\t\t\t{\n\t\t\t\tconst entry = logEntryBuilder.setLogEntry(rawEntry).build();\n\n\t\t\t\tif (entry.isTriggerEntry())\n\t\t\t\t{\n\t\t\t\t\tthis.addTriggerEntry(entry);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.addRobotEntry(entry);\n\t\t\t\t\tconst robotEntry = this.#robotLogs[entry.name];\n\n\t\t\t\t\tif (!Type.isNil(this.#document))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isRobotRunning = (robotEntry.status === TrackingStatus.RUNNING);\n\t\t\t\t\t\tconst isWorkflowCompleted =\n\t\t\t\t\t\t\t(robotEntry.workflowStatus === WorkflowStatus.COMPLETED)\n\t\t\t\t\t\t;\n\t\t\t\t\t\tconst isCurrentStatus = (this.#document.getCurrentStatusId() === statusId);\n\n\t\t\t\t\t\tconst isRobotRunningAtAnotherStatus = isRobotRunning && !isCurrentStatus;\n\t\t\t\t\t\tconst isRobotRunningAndCurrentWorkflowCompleted =\n\t\t\t\t\t\t\tisRobotRunning && isWorkflowCompleted && isCurrentStatus\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tif (isRobotRunningAtAnotherStatus || isRobotRunningAndCurrentWorkflowCompleted)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trobotEntry.status = TrackingStatus.COMPLETED;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddTriggerEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\tthis.#triggerLogs[entry.note] = new TriggerEntry(entry);\n\t\t}\n\t}\n\n\taddRobotEntry(entry: TrackingEntry)\n\t{\n\t\tif (entry.isTriggerEntry())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#robotLogs[entry.name])\n\t\t{\n\t\t\tthis.#robotLogs[entry.name] = new RobotEntry([entry]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robotLogs[entry.name].addEntry(entry);\n\t\t}\n\t}\n\n\tgetRobotLog(id: string): ?RobotEntry\n\t{\n\t\treturn this.#robotLogs[id] || null;\n\t}\n\n\tgetTriggerLog(id: string): ?TriggerEntry\n\t{\n\t\treturn this.#triggerLogs[id] || null;\n\t}\n\n\tupdate(documentSigned: string)\n\t{\n\t\treturn BX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: this.#ajaxUrl,\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_log',\n\t\t\t\tdocument_signed: documentSigned\n\t\t\t},\n\t\t\tonsuccess: (response) => {\n\t\t\t\tif (response.DATA && response.DATA.LOG)\n\t\t\t\t{\n\t\t\t\t\tthis.reInit(response.DATA.LOG);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","import { Dom, Type, Event, Text, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Document } from './document/document';\nimport { Template } from './template';\nimport { DelayInterval } from './delay-interval';\nimport { ViewMode } from './view-mode';\nimport { HelpHint } from './help-hint';\nimport { ConditionGroup, Helper } from 'bizproc.automation';\nimport { Tracker } from './tracker/tracker'\nimport { TrackingStatus } from './tracker/types';\n\nexport class Robot extends EventEmitter\n{\n\tSYSTEM_EXPRESSION_PATTERN = '\\\\{=\\\\s*(?<object>[a-z0-9_]+)\\\\s*\\\\:\\\\s*(?<field>[a-z0-9_\\\\.]+)(\\\\s*>\\\\s*(?<mod1>[a-z0-9_\\\\:]+)(\\\\s*,\\\\s*(?<mod2>[a-z0-9_]+))?)?\\\\s*\\\\}';\n\n\t#data: Object<string, any>;\n\t#document: Document;\n\t#template: ?Template;\n\t#tracker: ?Object;\n\t#delay: DelayInterval;\n\t#node: HTMLElement;\n\t#condition: ConditionGroup;\n\t#isDraft: boolean;\n\n\t#isFrameMode: boolean;\n\t#viewMode: ViewMode;\n\n\tconstructor(params: {\n\t\tdocument: Document,\n\t\ttemplate: ?Template,\n\t\tisFrameMode: boolean,\n\t\ttracker: Tracker,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#document = params.document;\n\t\tif (!Type.isNil(params.template))\n\t\t{\n\t\t\tthis.#template = params.template;\n\t\t}\n\t\tthis.#isFrameMode = params.isFrameMode;\n\t\tthis.#viewMode = ViewMode.none();\n\t\tthis.#tracker = params.tracker;\n\t\tthis.#isDraft = false;\n\n\t\tthis.#delay = new DelayInterval();\n\t}\n\n\tget node()\n\t{\n\t\treturn this.#node;\n\t}\n\n\tget data()\n\t{\n\t\treturn this.#data;\n\t}\n\n\tget draft()\n\t{\n\t\treturn this.#isDraft;\n\t}\n\n\tset draft(draft: boolean)\n\t{\n\t\tthis.#isDraft = draft;\n\t}\n\n\tget template()\n\t{\n\t\treturn this.#template;\n\t}\n\n\thasTemplate(): boolean\n\t{\n\t\treturn !Type.isNil(this.#template);\n\t}\n\n\tgetTemplate(): ?Template\n\t{\n\t\treturn this.#template;\n\t}\n\n\tgetDocument(): Document\n\t{\n\t\treturn this.#document;\n\t}\n\n\tstatic generateName(): string\n\t{\n\t\treturn (\n\t\t\t'A' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t\t+ '_' + parseInt(Math.random() * 100000)\n\t\t);\n\t}\n\n\tclone(): Robot\n\t{\n\t\tconst clonedRobot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate: this.#template,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = {\n\t\t\tName: Robot.generateName(),\n\t\t\tDelay: this.getDelayInterval().serialize(),\n\t\t\tCondition: this.getCondition().serialize(),\n\t\t\t...BX.clone(this.#data)\n\t\t};\n\t\tclonedRobot.init(robotData, this.#viewMode);\n\n\t\treturn clonedRobot;\n\t}\n\n\tisEqual(other: Robot): boolean\n\t{\n\t\treturn this.#data.Name === other.#data.Name;\n\t}\n\n\tinit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\tif (!this.#data.Name)\n\t\t{\n\t\t\tthis.#data.Name = Robot.generateName();\n\t\t}\n\n\t\tthis.#delay = new DelayInterval(this.#data.Delay);\n\t\tthis.#condition = new ConditionGroup(this.#data.Condition);\n\t\tif (!this.#data.Condition)\n\t\t{\n\t\t\tthis.#condition.type = ConditionGroup.CONDITION_TYPE.Mixed;\n\t\t}\n\t\tthis.#viewMode = Type.isNil(viewMode) ? ViewMode.edit() : viewMode;\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#node = this.createNode();\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: ?ViewMode): void\n\t{\n\t\tif (Type.isNil(viewMode) && this.#viewMode.isNone())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst node = this.#node;\n\t\tthis.#node = this.createNode();\n\t\tif (node.parentNode)\n\t\t{\n\t\t\tnode.parentNode.replaceChild(this.#node, node);\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(this.#node);\n\t\tthis.emit('Robot:destroyed');\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn this.#template.canEdit();\n\t}\n\n\tgetProperties(): Object\n\t{\n\t\tif (this.#data && Type.isPlainObject(this.#data.Properties))\n\t\t{\n\t\t\treturn this.#data.Properties;\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tgetProperty(name: string): ?Object\n\t{\n\t\treturn this.getProperties()[name] || null;\n\t}\n\n\thasProperty(name: string): boolean\n\t{\n\t\treturn this.getProperties().hasOwnProperty(name);\n\t}\n\n\tsetProperty(name: string, value: any): Robot\n\t{\n\t\tthis.#data.Properties[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetId(): ?string\n\t{\n\t\treturn this.#data.Name || null;\n\t}\n\n\tgetLogStatus(): number\n\t{\n\t\tlet status = TrackingStatus.WAITING;\n\t\tlet log = this.#tracker.getRobotLog(this.getId());\n\n\t\tif (log)\n\t\t{\n\t\t\tstatus = log.status;\n\t\t}\n\t\telse if (this.#data.DelayName)\n\t\t{\n\t\t\tlog = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\tstatus = TrackingStatus.RUNNING;\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t}\n\n\tgetLogErrors(): Array<string>\n\t{\n\t\tlet errors = [];\n\t\tconst log = this.#tracker.getRobotLog(this.getId());\n\t\tif (log && log.errors)\n\t\t{\n\t\t\terrors = log.errors;\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\tgetDelayNotes(): Array<string>\n\t{\n\t\tif (this.#data.DelayName)\n\t\t{\n\t\t\tconst log = this.#tracker.getRobotLog(this.#data.DelayName);\n\t\t\tif (log && log.status === TrackingStatus.RUNNING)\n\t\t\t{\n\t\t\t\treturn log.notes;\n\t\t\t}\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tselectNode(): void\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--selected');\n\t\t\tthis.emit('Robot:selected');\n\t\t}\n\t}\n\n\tunselectNode()\n\t{\n\t\tif (this.#node)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--selected');\n\t\t\tthis.emit('Robot:unselected');\n\t\t}\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#node && Dom.hasClass(this.#node, '--selected');\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\tif (!isActive)\n\t\t{\n\t\t\tDom.addClass(this.#node, '--locked-node');\n\t\t}\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.hide(deleteButton);\n\n\t\tthis.#node.onclick = () => {\n\t\t\tif (!this.#viewMode.isManage() || !this.#viewMode.getProperty('isActive', false))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isSelected())\n\t\t\t{\n\t\t\t\tthis.selectNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unselectNode();\n\t\t\t}\n\t\t};\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tthis.#viewMode = ViewMode.edit();\n\t\tthis.unselectNode();\n\t\tDom.removeClass(this.#node, '--locked-node');\n\n\t\tconst deleteButton = this.#node.querySelector('.bizproc-automation-robot-btn-delete');\n\t\tDom.show(deleteButton);\n\n\t\tthis.#node.onclick = undefined;\n\t}\n\n\tcreateNode(): HTMLElement\n\t{\n\t\tlet wrapperClass = 'bizproc-automation-robot-container-wrapper';\n\t\tlet containerClass = 'bizproc-automation-robot-container';\n\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\twrapperClass += ' bizproc-automation-robot-container-wrapper-draggable';\n\t\t}\n\t\tif (this.draft)\n\t\t{\n\t\t\tcontainerClass += ' --draft';\n\t\t}\n\n\t\tconst targetLabel = Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO');\n\t\tconst targetNode = Dom.create(\"a\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-settings-name \" + (this.#viewMode.isView() ? '--mode-view' : ''),\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t\t},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AUTOMATICALLY')\n\t\t});\n\n\t\tif (Type.isPlainObject(this.#data.viewData) && this.#data.viewData.responsibleLabel)\n\t\t{\n\t\t\tlet labelText =\n\t\t\t\tthis.#data.viewData.responsibleLabel\n\t\t\t\t\t.replace('{=Document:ASSIGNED_BY_ID}', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace('author', Loc.getMessage('BIZPROC_AUTOMATION_CMP_RESPONSIBLE'))\n\t\t\t\t\t.replace(/\\{=Constant\\:Constant[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{\\{~&\\:Constant[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'))\n\t\t\t\t\t.replace(/\\{=Template\\:Parameter[0-9]+\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t\t\t.replace(/\\{\\{~&:\\:Parameter[0-9]+\\}\\}/, Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'))\n\t\t\t;\n\n\t\t\tif (labelText.indexOf('{=Document') >= 0)\n\t\t\t{\n\t\t\t\tthis.#document.getFields().forEach(field => {\n\t\t\t\t\tlabelText = labelText.replace(field['SystemExpression'], field['Name']);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (labelText.indexOf('{=A') >= 0)\n\t\t\t{\n\t\t\t\tthis.#template.robots.forEach(robot => {\n\t\t\t\t\trobot.getReturnFieldsDescription().forEach(field => {\n\t\t\t\t\t\tif (field['Type'] === 'user')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabelText = labelText.replace(\n\t\t\t\t\t\t\t\tfield['SystemExpression'],\n\t\t\t\t\t\t\t\trobot.getTitle() + ': ' + field['Name']\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttargetNode.textContent = labelText;\n\t\t\ttargetNode.setAttribute('title', labelText);\n\n\t\t\tif (this.#data.viewData.responsibleUrl)\n\t\t\t{\n\t\t\t\ttargetNode.href = this.#data.viewData.responsibleUrl;\n\t\t\t\tif (this.#isFrameMode)\n\t\t\t\t{\n\t\t\t\t\ttargetNode.setAttribute('target', '_blank');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.#viewMode.isEdit() && parseInt(this.#data.viewData.responsibleId) > 0)\n\t\t\t{\n\t\t\t\ttargetNode.setAttribute('bx-tooltip-user-id', this.#data.viewData.responsibleId);\n\t\t\t}\n\t\t}\n\n\t\tlet delayLabel = this.getDelayInterval().format(\n\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\tthis.#document.getFields()\n\t\t);\n\n\t\tif (this.isExecuteAfterPrevious())\n\t\t{\n\t\t\tdelayLabel = (delayLabel !== Loc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE')) ? delayLabel + ', ' : '';\n\t\t\tdelayLabel += Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS');\n\t\t}\n\n\t\tif (this.getCondition().items.length > 0)\n\t\t{\n\t\t\tdelayLabel += ', ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_BY_CONDITION');\n\t\t}\n\n\t\tconst delayNode = Dom.create(\n\t\t\tthis.#viewMode.isEdit() ? \"a\" : \"span\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: this.#viewMode.isEdit() ? 'bizproc-automation-robot-link' : 'bizproc-automation-robot-text',\n\t\t\t\t\ttitle: delayLabel\n\t\t\t\t},\n\t\t\t\ttext: delayLabel,\n\t\t\t}\n\t\t);\n\n\t\tconst statusNode = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-information\"\n\t\t\t}\n\t\t});\n\t\tthis.subscribeOnce('Robot:destroyed', () => {\n\t\t\tif (HelpHint.isBindedToNode(statusNode))\n\t\t\t{\n\t\t\t\tHelpHint.hideHint();\n\t\t\t}\n\t\t})\n\n\t\tswitch (this.getLogStatus())\n\t\t{\n\t\t\tcase TrackingStatus.RUNNING:\n\t\t\t\tif (this.#document.getCurrentStatusId() === this.#template.getStatusId())\n\t\t\t\t{\n\t\t\t\t\tstatusNode.classList.add('--loader');\n\n\t\t\t\t\tconst delayNotes = this.getDelayNotes();\n\t\t\t\t\tif (delayNotes.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tstatusNode.setAttribute('data-text', delayNotes.join('\\n'));\n\t\t\t\t\t\tHelpHint.bindToNode(statusNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase TrackingStatus.COMPLETED:\n\t\t\tcase TrackingStatus.AUTOCOMPLETED:\n\t\t\t\tcontainerClass += ' --complete';\n\t\t\t\tstatusNode.classList.add('--complete');\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst errors = this.getLogErrors();\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tstatusNode.classList.add('--errors');\n\t\t\tstatusNode.setAttribute('data-text', errors.join('\\n'));\n\t\t\tHelpHint.bindToNode(statusNode);\n\t\t}\n\n\t\tlet titleClassName = 'bizproc-automation-robot-title-text';\n\t\tif (this.#viewMode.isEdit() && this.canEdit())\n\t\t{\n\t\t\ttitleClassName += ' bizproc-automation-robot-title-text-editable';\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: containerClass,\n\t\t\t\t'data-role': 'robot-container',\n\t\t\t\t'data-type': 'item-robot',\n\t\t\t\t'data-id': this.getId()\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-robot-container-checkbox\"\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: wrapperClass\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" },\n\t\t\t\t\t\t\tchildren: [delayNode]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"bizproc-automation-robot-title\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\tclassName: titleClassName\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\thtml: this.clipTitle(this.getTitle()),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: event => {\n\t\t\t\t\t\t\t\t\t\t\tif (this.#viewMode.isEdit() && this.canEdit() && !this.#viewMode.isManage())\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tthis.onTitleEditClick(event);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-settings-title\" },\n\t\t\t\t\t\t\t\t\ttext: targetLabel + ':'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\ttargetNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tstatusNode,\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.registerItem(div);\n\t\t}\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\t\t\tEvent.bind(deleteBtn, 'click', this.onDeleteButtonClick.bind(this, deleteBtn));\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\n\t\t\tconst copyBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-copy'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY') || 'copy'\n\t\t\t});\n\t\t\tEvent.bind(copyBtn, 'click', this.onCopyButtonClick.bind(this, copyBtn));\n\t\t\tdiv.appendChild(copyBtn);\n\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\t\t\tEvent.bind(div, 'click', this.onSettingsButtonClick.bind(this, div));\n\n\t\t\tdiv.appendChild(settingsBtn);\n\t\t}\n\n\t\treturn div;\n\t}\n\n\tonDeleteButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tDom.remove(this.#node);\n\t\t\tthis.#template.deleteRobot(this);\n\t\t}\n\t}\n\n\tonSettingsButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tthis.#template.openRobotSettingsDialog(this, this.#data.DialogContext ?? null);\n\t\t}\n\t}\n\n\tonCopyButtonClick(button, event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t}\n\t\telse if (!this.#viewMode.isManage())\n\t\t{\n\t\t\tconst copiedRobot = this.clone();\n\t\t\tconst robotTitle = copiedRobot.getProperty('Title');\n\t\t\tif (!Type.isNil(robotTitle))\n\t\t\t{\n\t\t\t\tconst newTitle = robotTitle + ' ' + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_COPY_CAPTION');\n\t\t\t\tcopiedRobot.setProperty('Title', newTitle);\n\t\t\t\tcopiedRobot.reInit();\n\t\t\t}\n\n\t\t\tTemplate.copyRobotTo(this.#template, copiedRobot, this.#template.getNextRobot(this));\n\t\t}\n\t}\n\n\tonTitleEditClick(e)\n\t{\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tconst formName = 'bizproc_automation_robot_title_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t},\n\t\t\tstyle: {\"min-width\": '540px'}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete\" },\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME') + ':'\n\t\t}));\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [BX.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-popup-input',\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\tvalue: this.getTitle()\n\t\t\t\t}\n\t\t\t})]\n\t\t}));\n\n\t\tthis.emit('Robot:title:editStart');\n\n\t\tconst self = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_NAME'),\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\toverlay: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose(popup)\n\t\t\t\t{\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tself.emit('Robot:title:editCompleted');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nameNode = form.elements.name;\n\t\t\t\t\t\t\tself.setProperty('Title', nameNode.value);\n\t\t\t\t\t\t\tself.reInit();\n\t\t\t\t\t\t\tself.#template.markModified();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tonSearch(event)\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = event.getData().queryString;\n\t\tconst match = !query || this.getTitle().toLowerCase().indexOf(query) >= 0;\n\n\t\tif (match)\n\t\t{\n\t\t\tDom.removeClass(this.#node, '--search-mismatch');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#node, '--search-mismatch');\n\t\t}\n\t}\n\n\tclipTitle(fullTitle: string)\n\t{\n\t\tlet title = Text.encode(fullTitle);\n\t\tconst arrTitle = title.split(\" \");\n\t\tconst lastWord = \"<span>\" + arrTitle[arrTitle.length - 1] + \"</span>\";\n\n\t\tarrTitle.splice(arrTitle.length - 1);\n\n\t\ttitle = arrTitle.join(\" \") + \" \" + lastWord;\n\n\t\treturn title;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow 'Invalid data';\n\t\t}\n\t}\n\n\tserialize()\n\t{\n\t\tconst result = BX.clone(this.#data);\n\t\tdelete result['viewData'];\n\t\tdelete result['DialogContext'];\n\t\tresult.Delay = this.#delay.serialize();\n\t\tresult.Condition = this.#condition.serialize();\n\n\t\treturn result;\n\t}\n\n\tgetDelayInterval(): DelayInterval\n\t{\n\t\treturn this.#delay;\n\t}\n\n\tsetDelayInterval(delay): Robot\n\t{\n\t\tthis.#delay = delay;\n\n\t\treturn this;\n\t}\n\n\tgetCondition(): ConditionGroup\n\t{\n\t\treturn this.#condition;\n\t}\n\n\tsetCondition(condition)\n\t{\n\t\tthis.#condition = condition;\n\n\t\treturn this;\n\t}\n\n\tsetExecuteAfterPrevious(flag)\n\t{\n\t\tthis.#data.ExecuteAfterPrevious = flag ? 1 : 0;\n\n\t\treturn this;\n\t}\n\n\tisExecuteAfterPrevious()\n\t{\n\t\treturn (this.#data.ExecuteAfterPrevious === 1 || this.#data.ExecuteAfterPrevious === '1')\n\t}\n\n\tregisterItem(object)\n\t{\n\t\tif (Type.isNil(object[\"__bxddid\"]))\n\t\t{\n\t\t\tobject.onbxdragstart = BX.proxy(this.dragStart, this);\n\t\t\tobject.onbxdrag = BX.proxy(this.dragMove, this);\n\t\t\tobject.onbxdragstop = BX.proxy(this.dragStop, this);\n\t\t\tobject.onbxdraghover = BX.proxy(this.dragOver, this);\n\t\t\tjsDD.registerObject(object);\n\t\t\tjsDD.registerDest(object, 1);\n\t\t}\n\t}\n\n\tunregisterItem(object)\n\t{\n\t\tobject.onbxdragstart = undefined;\n\t\tobject.onbxdrag = undefined;\n\t\tobject.onbxdragstop = undefined;\n\t\tobject.onbxdraghover = undefined;\n\t\tjsDD.unregisterObject(object);\n\t\tjsDD.unregisterDest(object);\n\t}\n\n\tdragStart()\n\t{\n\t\tthis.draggableItem = BX.proxy_context;\n\n\t\tif (!this.draggableItem)\n\t\t{\n\t\t\tjsDD.stopCurrentDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.stub)\n\t\t{\n\t\t\tconst itemWidth = this.draggableItem.offsetWidth;\n\t\t\tthis.stub = this.draggableItem.cloneNode(true);\n\t\t\tthis.stub.style.position = \"absolute\";\n\t\t\tthis.stub.classList.add(\"bizproc-automation-robot-container-drag\");\n\t\t\tthis.stub.style.width = itemWidth + \"px\";\n\t\t\tdocument.body.appendChild(this.stub);\n\t\t}\n\t}\n\n\tdragMove(x,y)\n\t{\n\t\tthis.stub.style.left = x + \"px\";\n\t\tthis.stub.style.top = y + \"px\";\n\t}\n\n\tdragOver(destination, x, y)\n\t{\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\n\t\tconst type = destination.getAttribute(\"data-type\");\n\n\t\tif (type === \"item-robot\")\n\t\t{\n\t\t\tthis.droppableItem = destination;\n\t\t\tthis.droppableColumn = null;\n\t\t}\n\n\t\tif (type === \"column-robot\")\n\t\t{\n\t\t\tthis.droppableColumn = destination.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.droppableItem = null;\n\t\t}\n\n\t\tif (this.droppableItem)\n\t\t{\n\t\t\tthis.droppableItem.classList.add(\"bizproc-automation-robot-container-pre\");\n\t\t}\n\n\t\tif (this.droppableColumn)\n\t\t{\n\t\t\tthis.droppableColumn.classList.add(\"bizproc-automation-robot-list-pre\");\n\t\t}\n\t}\n\n\tdragStop(x, y, event)\n\t{\n\t\tevent = event || window.event;\n\t\tconst isCopy = event && (event.ctrlKey || event.metaKey);\n\n\t\tif (this.draggableItem)\n\t\t{\n\t\t\tif (this.droppableItem)\n\t\t\t{\n\t\t\t\tthis.droppableItem.classList.remove(\"bizproc-automation-robot-container-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableItem.parentNode,\n\t\t\t\t\tisCopy,\n\t\t\t\t\tdroppableItem: this.droppableItem,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.droppableColumn)\n\t\t\t{\n\t\t\t\tthis.droppableColumn.classList.remove(\"bizproc-automation-robot-list-pre\");\n\t\t\t\tthis.emit('Robot:manage', {\n\t\t\t\t\ttemplateNode: this.droppableColumn,\n\t\t\t\t\tisCopy,\n\t\t\t\t\trobot: this,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.stub.parentNode.removeChild(this.stub);\n\t\tthis.stub = null;\n\t\tthis.draggableItem = null;\n\t\tthis.droppableItem = null;\n\t}\n\n\tmoveTo(template, beforeRobot)\n\t{\n\t\tDom.remove(this.#node);\n\t\tthis.#template.deleteRobot(this);\n\t\tthis.#template = template;\n\n\t\tthis.#template.insertRobot(this, beforeRobot);\n\t\tthis.#node = this.createNode();\n\t\tthis.#template.insertRobotNode(this.#node, beforeRobot ? beforeRobot.node : null);\n\t}\n\n\tcopyTo(template, beforeRobot)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: this.#document,\n\t\t\ttemplate,\n\t\t\tisFrameMode: this.#isFrameMode,\n\t\t\ttracker: this.#tracker,\n\t\t});\n\n\t\tconst robotData = this.serialize();\n\t\tdelete robotData['Name'];\n\t\tdelete robotData['DelayName'];\n\n\t\trobot.init(robotData, this.#viewMode);\n\n\t\ttemplate.insertRobot(robot, beforeRobot);\n\t\ttemplate.insertRobotNode(robot.node, beforeRobot ? beforeRobot.node : null);\n\n\t\treturn robot;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getProperty('Title') || this.getDescriptionTitle();\n\t}\n\n\tgetDescriptionTitle()\n\t{\n\t\tlet name = 'untitled';\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\t\tif (description['NAME'])\n\t\t{\n\t\t\tname = description['NAME'];\n\t\t}\n\t\tif (description['ROBOT_SETTINGS'] && description['ROBOT_SETTINGS']['TITLE'])\n\t\t{\n\t\t\tname = description['ROBOT_SETTINGS']['TITLE'];\n\t\t}\n\n\t\treturn name;\n\t}\n\n\thasTitle(): boolean\n\t{\n\t\treturn this.getTitle() !== 'untitled';\n\t}\n\n\thasReturnFields(): boolean\n\t{\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\t\tconst props = this.#data['Properties'];\n\n\t\tif (!Type.isObject(description))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst hasReturnProperties = () => (\n\t\t\tType.isObject(description['RETURN'])\n\t\t\t&& Type.isArrayFilled(Object.values(description['RETURN']))\n\t\t);\n\n\t\tconst hasAdditionalResultProperties = () => (\n\t\t\tType.isArray(description['ADDITIONAL_RESULT'])\n\t\t\t&& description['ADDITIONAL_RESULT'].some(addProperty => Object.values(props[addProperty] ?? []).length > 0)\n\t\t);\n\n\t\treturn hasReturnProperties() || hasAdditionalResultProperties();\n\t}\n\n\tgetReturnFieldsDescription()\n\t{\n\t\tconst fields = [];\n\t\tconst description = this.template.getRobotDescription(this.#data['Type']);\n\n\t\tif (description && description['RETURN'])\n\t\t{\n\t\t\tfor (const fieldId in description['RETURN'])\n\t\t\t{\n\t\t\t\tif (description['RETURN'].hasOwnProperty(fieldId))\n\t\t\t\t{\n\t\t\t\t\tconst field = description['RETURN'][fieldId];\n\t\t\t\t\tfields.push({\n\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\tObjectName: this.getTitle(),\n\t\t\t\t\t\tName: field['NAME'],\n\t\t\t\t\t\tType: field['TYPE'],\n\t\t\t\t\t\tExpression: '{{~'+this.getId()+':'+fieldId+' # '+this.getTitle()+': '+field['NAME']+'}}',\n\t\t\t\t\t\tSystemExpression: '{='+this.getId()+':'+fieldId+'}'\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!this.appendPropertyMods)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t//generate printable version\n\t\t\t\t\tif (\n\t\t\t\t\t\tfield['TYPE'] === 'user'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'bool'\n\t\t\t\t\t\t||\n\t\t\t\t\t\tfield['TYPE'] === 'file'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst printableTag = (field['TYPE'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\tName: field['NAME'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['NAME']}}}`,\n\t\t\t\t\t\t\tSystemExpression: `{=${this.getId()}:${fieldId}>${printableTag}}`,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (description && Type.isArray(description['ADDITIONAL_RESULT']))\n\t\t{\n\t\t\tconst props = this.#data['Properties'];\n\n\t\t\tdescription['ADDITIONAL_RESULT'].forEach((addProperty) => {\n\t\t\t\tif (props[addProperty])\n\t\t\t\t{\n\t\t\t\t\tfor (const fieldId in props[addProperty])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (props[addProperty].hasOwnProperty(fieldId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst field = props[addProperty][fieldId];\n\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\tId: fieldId,\n\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\tName: field['Name'],\n\t\t\t\t\t\t\t\tType: field['Type'],\n\t\t\t\t\t\t\t\tOptions: field['Options'] || null,\n\t\t\t\t\t\t\t\tExpression: `{{~${this.getId()}:${fieldId} # ${this.getTitle()}: ${field['Name']}}}`,\n\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '}',\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t//generate printable version\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tfield['Type'] === 'user'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'bool'\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\tfield['Type'] === 'file'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst printableTag = (field['Type'] === 'user') ? 'friendly' : 'printable';\n\t\t\t\t\t\t\t\tconst expression = `{{~${this.getId()}:${fieldId} > ${printableTag} # ${this.getTitle()}: ${field['Name']}}}`;\n\t\t\t\t\t\t\t\tfields.push({\n\t\t\t\t\t\t\t\t\tId: fieldId + '_printable',\n\t\t\t\t\t\t\t\t\tObjectId: this.getId(),\n\t\t\t\t\t\t\t\t\tName: field['Name'] + ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX'),\n\t\t\t\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\t\t\t\tExpression: expression,\n\t\t\t\t\t\t\t\t\tSystemExpression: '{=' + this.getId() + ':' + fieldId + '>' + printableTag + '}',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tgetReturnProperty(id): Array<Object>\n\t{\n\t\tconst fields = this.getReturnFieldsDescription();\n\t\tfor (let i = 0; i < fields.length; ++i)\n\t\t{\n\t\t\tif (fields[i]['Id'] === id)\n\t\t\t{\n\t\t\t\treturn fields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst properties = this.getProperties();\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tObject.values(properties).forEach(property => this.collectExpressions(property, usages));\n\n\t\tconst conditions = this.getCondition().serialize();\n\t\tconditions.items.forEach(item => this.collectParsedExpressions(item[0], usages));\n\n\t\treturn usages;\n\t}\n\n\tcollectExpressions(value, usages)\n\t{\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue.forEach(v => this.collectExpressions(v, usages));\n\t\t}\n\t\telse if (Type.isPlainObject(value))\n\t\t{\n\t\t\tObject.values(value).forEach(value => this.collectExpressions(value, usages));\n\t\t}\n\t\telse if (Type.isStringFilled(value))\n\t\t{\n\t\t\tlet found;\n\t\t\tconst systemExpressionRegExp = new RegExp(this.SYSTEM_EXPRESSION_PATTERN, 'ig');\n\t\t\twhile ((found = systemExpressionRegExp.exec(value)) !== null)\n\t\t\t{\n\t\t\t\tthis.collectParsedExpressions(found.groups, usages);\n\t\t\t}\n\t\t}\n\t}\n\n\tcollectParsedExpressions(parsedUsage, usages)\n\t{\n\t\tif (Type.isPlainObject(parsedUsage) && parsedUsage['object'] && parsedUsage['field'])\n\t\t{\n\t\t\tswitch (parsedUsage['object'])\n\t\t\t{\n\t\t\t\tcase 'Document':\n\t\t\t\t\tusages.Document.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Constant':\n\t\t\t\t\tusages.Constant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Variable':\n\t\t\t\t\tusages.Variable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'Template':\n\t\t\t\t\tusages.Parameter.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalConst':\n\t\t\t\t\tusages.GlobalConstant.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\n\t\t\t\tcase 'GlobalVar':\n\t\t\t\t\tusages.GlobalVariable.add(parsedUsage['field']);\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst activityRegExp = new RegExp(/^A[_0-9]+$/, 'ig');\n\t\t\tif (activityRegExp.exec(parsedUsage['object']))\n\t\t\t{\n\t\t\t\tusages.Activity.add([parsedUsage['object'], parsedUsage['field']]);\n\t\t\t}\n\t\t}\n\t}\n\n\thasBrokenLink()\n\t{\n\t\tconst usages = BX.clone(this.collectUsages());\n\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst objectsData = {\n\t\t\tDocument: this.#document.getFields(),\n\t\t\tConstant: this.#template.getConstants(),\n\t\t\tVariable: this.#template.getVariables(),\n\t\t\tGlobalConstant: this.#template.globalConstants,\n\t\t\tGlobalVariable: this.#template.globalVariables,\n\t\t\tParameter: this.#template.getParameters(),\n\t\t\tActivity: this.#template.getSerializedRobots()\n\t\t};\n\n\t\tfor (const object in usages)\n\t\t{\n\t\t\tif (usages[object].size > 0)\n\t\t\t{\n\t\t\t\tconst source = new Set();\n\n\t\t\t\tfor (const key in objectsData[object])\n\t\t\t\t{\n\t\t\t\t\tif (objectsData[object][key]['Id'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Id']);\n\t\t\t\t\t}\n\t\t\t\t\telse if (objectsData[object][key]['Name'])\n\t\t\t\t\t{\n\t\t\t\t\t\tsource.add(objectsData[object][key]['Name']);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (const value of usages[object].values())\n\t\t\t\t{\n\t\t\t\t\tlet searchInSource = value;\n\t\t\t\t\tlet id = value;\n\n\t\t\t\t\tif (Type.isArray(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\tsearchInSource = value[0];\n\t\t\t\t\t\tid = value[1];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!source.has(searchInSource))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (object === 'Activity')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst robot = this.#template.getRobotById(searchInSource);\n\t\t\t\t\t\tif (!robot.getReturnProperty(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n}","import { Type, Runtime } from 'main.core';\n\nexport class UserOptions\n{\n\t#options: Object<string, any>;\n\n\tconstructor(options: Object<string, any>)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new UserOptions(Runtime.clone(this.#options));\n\t}\n\n\tset(category: string, key: string, value: any): UserOptions\n\t{\n\t\tif (!Type.isPlainObject(this.#options[category]))\n\t\t{\n\t\t\tthis.#options[category] = {};\n\t\t}\n\t\tconst storedValue = this.#options[category][key];\n\n\t\tif (storedValue !== value)\n\t\t{\n\t\t\tBX.userOptions.save(\n\t\t\t\t'bizproc.automation',\n\t\t\t\tcategory,\n\t\t\t\tkey,\n\t\t\t\tvalue,\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget(category: string, key: string, defaultValue: any): any\n\t{\n\t\tlet result = defaultValue;\n\t\tif (this.has(category, key))\n\t\t{\n\t\t\tresult = this.#options[category][key];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thas(category: string, key: string): boolean\n\t{\n\t\treturn Type.isPlainObject(this.#options[category]) && Type.isPlainObject(this.#options[category][key]);\n\t}\n}","import {Type, Dom, Loc, Event, Runtime, Uri} from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport {\n\tContext,\n\tSelectorContext,\n\tgetGlobalContext,\n\tTracker,\n\tDesigner,\n\tConditionGroupSelector,\n\tConditionGroup,\n\tDelayIntervalSelector,\n\tSelectorManager,\n} from 'bizproc.automation';\nimport { Robot } from './robot'\nimport { UserOptions } from './user-options';\nimport { ViewMode } from './view-mode';\nimport { Helper } from './helper';\nimport { HelpHint } from './help-hint';\nimport { DelayInterval } from './delay-interval';\n\nexport class Template extends EventEmitter\n{\n\t#context: Context;\n\n\tconstants: Object<string, any>;\n\tglobalConstants: Array<Object>;\n\tvariables: Object<string, any>;\n\tglobalVariables: Array<Object>;\n\trobotSettingsControls;\n\n\t#delayMinLimitM: number;\n\t#userOptions: UserOptions | null;\n\t#tracker: Tracker;\n\t#viewMode: ViewMode;\n\n\t#templateContainerNode: Element;\n\t#templateNode: ?Element;\n\t#listNode: Element | undefined;\n\t#buttonsNode: Element | undefined;\n\n\t#robots: Array<Robot>;\n\t#data: Object;\n\n\tconstructor(params: {\n\t\tcontext: ?Context,\n\t\ttemplateContainerNode: Element,\n\t\tconstants: Object<string, any>,\n\t\tglobalConstants: Array<Object>,\n\t\tvariables: Object<string, any>,\n\t\tglobalVariables: Array<Object>,\n\t\tuserOptions: ?UserOptions,\n\t\tdelayMinLimitM: number,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation');\n\n\t\tthis.#context = params.context ?? getGlobalContext();\n\t\tthis.constants = params.constants;\n\t\tthis.globalConstants = params.globalConstants;\n\t\tthis.variables = params.variables;\n\t\tthis.globalVariables = params.globalVariables;\n\n\t\tthis.#templateContainerNode = params.templateContainerNode;\n\t\tthis.#delayMinLimitM = params.delayMinLimitM;\n\t\tthis.#userOptions = params.userOptions;\n\t\tthis.#tracker = this.#context.tracker;\n\t\tthis.#data = {};\n\t\tthis.#robots = [];\n\t\tthis.#viewMode = ViewMode.none();\n\t}\n\n\tinit(data: Object, viewMode: number)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t\tif (!Type.isPlainObject(this.#data.CONSTANTS))\n\t\t\t{\n\t\t\t\tthis.#data.CONSTANTS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.PARAMETERS))\n\t\t\t{\n\t\t\t\tthis.#data.PARAMETERS = {};\n\t\t\t}\n\t\t\tif (!Type.isPlainObject(this.#data.VARIABLES))\n\t\t\t{\n\t\t\t\tthis.#data.VARIABLES = {};\n\t\t\t}\n\n\t\t\tthis.markExternalModified(this.#data['IS_EXTERNAL_MODIFIED']);\n\t\t\tthis.markModified(false);\n\t\t}\n\n\t\tthis.#viewMode = ViewMode.fromRaw(viewMode);\n\n\t\tif (!this.#viewMode.isNone())\n\t\t{\n\t\t\tthis.#templateNode = this.#templateContainerNode.querySelector(\n\t\t\t\t'[data-role=\"automation-template\"][data-status-id=\"' + this.#data.DOCUMENT_STATUS + '\"]'\n\t\t\t);\n\t\t\tthis.#listNode = this.#templateNode.querySelector('[data-role=\"robot-list\"]');\n\t\t\tthis.#buttonsNode = this.#templateNode.querySelector('[data-role=\"buttons\"]');\n\n\t\t\tthis.initRobots();\n\t\t\tthis.initButtons();\n\n\t\t\tif (!this.isExternalModified() && this.canEdit())\n\t\t\t{\n\t\t\t\t//register DD\n\t\t\t\tjsDD.registerDest(this.#templateNode, 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjsDD.unregisterDest(this.#templateNode);\n\t\t\t}\n\t\t}\n\t}\n\n\treInit(data: Object, viewMode: number)\n\t{\n\t\tDom.clean(this.#listNode);\n\t\tDom.clean(this.#buttonsNode);\n\n\t\tthis.destroy();\n\t\tthis.init(data, viewMode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#robots.forEach(robot => robot.destroy());\n\t}\n\n\tstatic copyRobotTo(dstTemplate: Template, robot: Robot, beforeRobot: ?Robot): Robot\n\t{\n\t\tconst copiedRobot = robot.copyTo(dstTemplate, beforeRobot);\n\t\tdstTemplate.emit('Template:robot:add', {robot: copiedRobot});\n\t}\n\n\tcanEdit()\n\t{\n\t\treturn this.#context.canEdit;\n\t}\n\n\tinitRobots()\n\t{\n\t\tthis.#robots = [];\n\n\t\tif (Type.isArray(this.#data.ROBOTS))\n\t\t{\n\t\t\tfor (let i = 0; i < this.#data.ROBOTS.length; ++i)\n\t\t\t{\n\t\t\t\tconst robot = new Robot({\n\t\t\t\t\tdocument: this.#context.document,\n\t\t\t\t\ttemplate: this,\n\t\t\t\t\tisFrameMode: this.#context.get('isFrameMode'),\n\t\t\t\t\ttracker: this.#tracker,\n\t\t\t\t});\n\t\t\t\trobot.init(this.#data.ROBOTS[i], this.#viewMode);\n\t\t\t\tthis.insertRobotNode(robot.node);\n\t\t\t\tthis.#robots.push(robot);\n\t\t\t}\n\t\t}\n\t}\n\n\tget robots(): Array<Robot>\n\t{\n\t\treturn this.#robots;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.#userOptions;\n\t}\n\n\tgetSelectedRobotNames(): Array<Robot>\n\t{\n\t\tconst selectedRobots = [];\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tif (robot.isSelected())\n\t\t\t{\n\t\t\t\tselectedRobots.push(robot.data.Name);\n\t\t\t}\n\t\t});\n\n\t\treturn selectedRobots;\n\t}\n\n\tgetSerializedRobots()\n\t{\n\t\tconst serialized = [];\n\t\tthis.#robots.forEach(robot => serialized.push(robot.serialize()));\n\n\t\treturn serialized;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.#data.ID;\n\t}\n\n\tgetStatusId(): ?string\n\t{\n\t\treturn this.#data.DOCUMENT_STATUS;\n\t}\n\n\tgetStatus(): ?object\n\t{\n\t\treturn this.#context.document.statusList.find(status => String(status.STATUS_ID) === this.getStatusId());\n\t}\n\n\tgetTemplateId()\n\t{\n\t\tconst id = parseInt(this.#data.ID);\n\n\t\treturn !isNaN(id) ? id : 0;\n\t}\n\n\tinitButtons()\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.createExternalLocker();\n\t\t}\n\t\telse if (this.#viewMode.isEdit() && this.getTemplateId() > 0)\n\t\t{\n\t\t\tthis.createConstantsEditButton();\n\t\t\tthis.createParametersEditButton();\n\t\t\tthis.createExternalEditTemplateButton();\n\t\t\tthis.createManageModeButton();\n\t\t}\n\t}\n\n\tenableManageMode(isActive: boolean)\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.manage().setProperty('isActive', isActive);\n\n\t\t\tif (isActive)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--multiselect-mode');\n\t\t\t}\n\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.addClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.enableManageMode(isActive));\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableManageMode()\n\t{\n\t\tif (this.#listNode)\n\t\t{\n\t\t\tthis.#viewMode = ViewMode.edit();\n\t\t\tDom.removeClass(this.#listNode, '--multiselect-mode');\n\t\t\tif (this.isExternalModified())\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#listNode, '--locked-node');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#robots.forEach(robot => robot.disableManageMode());\n\t\t\t}\n\n\t\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t\t});\n\t\t}\n\t}\n\n\tenableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.registerItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.addClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tdisableDragAndDrop()\n\t{\n\t\tthis.#robots.forEach(robot => robot.unregisterItem(robot.node));\n\n\t\tthis.#templateNode.querySelectorAll('.bizproc-automation-robot-container-wrapper').forEach(node => {\n\t\t\tDom.removeClass(node, 'bizproc-automation-robot-container-wrapper-draggable');\n\t\t});\n\t}\n\n\tcreateExternalEditTemplateButton(): undefined | boolean\n\t{\n\t\tif (Type.isNil(this.#context.bizprocEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst self = this;\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: '#'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top'\n\t\t\t}\n\t\t});\n\n\t\tif (!this.#context.bizprocEditorUrl.length)\n\t\t{\n\t\t\tDom.addClass(anchor, 'bizproc-automation-robot-btn-set-locked');\n\t\t}\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateManageModeButton()\n\t{\n\t\tif (!this.#context.canManage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst manageButton = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_MANAGE_ROBOTS'),\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-btn-set\",\n\t\t\t\ttarget: '_top',\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tcursor: 'pointer',\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: event => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.onManageModeButtonClick(manageButton);\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(manageButton);\n\t}\n\n\tonManageModeButtonClick(manageButtonNode: HTMLElement)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(manageButtonNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('Template:enableManageMode', {\n\t\t\t\tdocumentStatus: this.#data.DOCUMENT_STATUS,\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateConstantsEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(this.#context.constantsEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url =\n\t\t\t!this.#viewMode.isManage()\n\t\t\t\t? this.#context.constantsEditorUrl.replace('#ID#', this.getTemplateId())\n\t\t\t\t: '#'\n\t\t;\n\n\t\tif (!url.length)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CONSTANTS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateParametersEditButton(): boolean | undefined\n\t{\n\t\tif (Type.isNil(this.#context.parametersEditorUrl))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst url = this.#context.parametersEditorUrl.replace('#ID#', this.getTemplateId());\n\n\t\tif (!url.length || this.#viewMode.isManage())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst anchor = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_PARAMETERS_EDIT'),\n\t\t\tprops: {\n\t\t\t\thref: url\n\t\t\t},\n\t\t\tattrs: { className: \"bizproc-automation-robot-btn-set\" }\n\t\t});\n\n\t\tthis.#buttonsNode.appendChild(anchor);\n\t}\n\n\tcreateExternalLocker()\n\t{\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-robot-container\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-robot-container-wrapper bizproc-automation-robot-container-wrapper-lock'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-deadline\" }\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-robot-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EXTERNAL_EDIT_TEXT')\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (this.#viewMode.isEdit())\n\t\t{\n\t\t\tconst settingsBtn = Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-settings'\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_EDIT')\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tEvent.bind(div, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onExternalEditTemplateButtonClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.appendChild(settingsBtn);\n\n\t\t\tconst deleteBtn = Dom.create('SPAN', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'bizproc-automation-robot-btn-delete'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEvent.bind(deleteBtn, 'click', function (event) {\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tif (!self.#viewMode.isManage())\n\t\t\t\t{\n\t\t\t\t\tself.onUnsetExternalModifiedClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv.lastChild.appendChild(deleteBtn);\n\t\t}\n\n\t\tthis.#listNode.appendChild(div);\n\t\tthis.#templateNode = div;\n\t}\n\n\tonSearch(event: BaseEvent)\n\t{\n\t\tif (this.isExternalModified())\n\t\t{\n\t\t\tthis.onExternalModifiedSearch(event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.forEach(robot => robot.onSearch(event));\n\t\t}\n\t}\n\n\tonExternalModifiedSearch(event)\n\t{\n\t\tif (this.#templateNode)\n\t\t{\n\t\t\tconst query = event.getData().queryString;\n\t\t\tBX[!query ? 'removeClass' : 'addClass'](this.#templateNode, '--search-mismatch');\n\t\t}\n\t}\n\n\tonExternalEditTemplateButtonClick(button)\n\t{\n\t\tif (!this.canEdit())\n\t\t{\n\t\t\tHelpHint.showNoPermissionsHint(button);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.#context.bizprocEditorUrl.length)\n\t\t{\n\t\t\tif (top.BX.UI && top.BX.UI.InfoHelper)\n\t\t\t{\n\t\t\t\ttop.BX.UI.InfoHelper.show('limit_office_bp_designer');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst templateId = this.getTemplateId();\n\t\tif (templateId > 0)\n\t\t{\n\t\t\tthis.openBizprocEditor(templateId);\n\t\t}\n\t}\n\n\tonUnsetExternalModifiedClick(button)\n\t{\n\t\tthis.#templateNode = null;\n\n\t\tthis.markExternalModified(false);\n\t\tthis.markModified();\n\t\tthis.reInit(null, this.#viewMode.intoRaw());\n\t}\n\n\topenBizprocEditor(templateId)\n\t{\n\t\ttop.window.location.href = this.#context.bizprocEditorUrl.replace('#ID#', templateId)\n\t}\n\n\taddRobot(robotData, callback)\n\t{\n\t\tconst robot = new Robot({\n\t\t\tdocument: this.#context.document,\n\t\t\ttemplate: this,\n\t\t\tisFrameMode: this.#context.get('isFrameMode'),\n\t\t\ttracker: this.#tracker,\n\t\t});\n\t\tconst initData = {\n\t\t\tType: robotData['CLASS'],\n\t\t\tProperties: {\n\t\t\t\tTitle: robotData['NAME']\n\t\t\t},\n\t\t\tDialogContext: robotData['DIALOG_CONTEXT'],\n\t\t};\n\n\t\tif (this.#robots.length > 0)\n\t\t{\n\t\t\tconst parentRobot = this.#robots[this.#robots.length - 1];\n\t\t\tif (!parentRobot.getDelayInterval().isNow() || parentRobot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\tinitData['Delay'] = parentRobot.getDelayInterval().serialize();\n\t\t\t\tinitData['ExecuteAfterPrevious'] =  1;\n\t\t\t}\n\t\t}\n\n\t\trobot.draft = true;\n\t\trobot.init(initData, this.#viewMode);\n\n\t\tthis.insertRobot(robot);\n\t\tthis.insertRobotNode(robot.node);\n\t\tthis.emit('Template:robot:add', {robot});\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback.call(this, robot);\n\t\t}\n\t}\n\n\tinsertRobot(robot, beforeRobot)\n\t{\n\t\tif (beforeRobot)\n\t\t{\n\t\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t\t{\n\t\t\t\tif (this.#robots[i] !== beforeRobot)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis.#robots.splice(i, 0, robot);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#robots.push(robot);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tgetNextRobot(robot)\n\t{\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i] === robot)\n\t\t\t{\n\t\t\t\treturn (this.#robots[i + 1] || null);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tdeleteRobot(robot, callback)\n\t{\n\t\tfor(let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tif (this.#robots[i].isEqual(robot))\n\t\t\t{\n\t\t\t\tthis.#robots.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (callback)\n\t\t{\n\t\t\tcallback(robot);\n\t\t}\n\n\t\tthis.markModified();\n\t}\n\n\tinsertRobotNode(robotNode, beforeNode)\n\t{\n\t\tif (beforeNode)\n\t\t{\n\t\t\tthis.#listNode.insertBefore(robotNode, beforeNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#listNode.appendChild(robotNode);\n\t\t}\n\t}\n\n\topenRobotSettingsDialog(robot: Robot, context?: Object, saveCallback: (Robot) => void)\n\t{\n\t\tif (!Type.isPlainObject(context))\n\t\t{\n\t\t\tcontext = {};\n\t\t}\n\n\t\tif (Designer.getInstance().getRobotSettingsDialog())\n\t\t{\n\t\t\tif (context.changeRobot)\n\t\t\t{\n\t\t\t\tDesigner.getInstance().getRobotSettingsDialog().popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst formName = 'bizproc_automation_robot_dialog';\n\n\t\tconst form = Dom.create('form', {\n\t\t\tprops: {\n\t\t\t\tname: formName\n\t\t\t}\n\t\t});\n\n\t\tDesigner.getInstance().setRobotSettingsDialog({\n\t\t\ttemplate: this,\n\t\t\tcontext: context,\n\t\t\trobot: robot,\n\t\t\tform: form\n\t\t});\n\n\t\tform.appendChild(this.renderDelaySettings(robot));\n\t\tform.appendChild(this.renderConditionSettings(robot));\n\t\tif (robot.hasBrokenLink())\n\t\t{\n\t\t\tform.appendChild(this.renderBrokenLinkAlert());\n\t\t}\n\n\t\tconst iconHelp = Dom.create('div', {\n\t\t\tattrs: { className: 'bizproc-automation-robot-help' },\n\t\t\tevents: {\n\t\t\t\tclick: (event) => this.emit('Template:help:show', event)\n\t\t\t},\n\t\t});\n\t\tform.appendChild(iconHelp);\n\t\tcontext['DOCUMENT_CATEGORY_ID'] = this.#context.document.getCategoryId();\n\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'html',\n\t\t\turl: Uri.addParam(\n\t\t\t\tthis.#context.ajaxUrl,\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: `automation_robot${robot.draft ? '_draft' : ''}_settings_${robot.data.Type.toLowerCase()}`\n\t\t\t\t}\n\t\t\t),\n\t\t\tdata: {\n\t\t\t\tajax_action: 'get_robot_dialog',\n\t\t\t\tdocument_signed: this.#context.signedDocument,\n\t\t\t\tdocument_status: this.#context.document.getCurrentStatusId(),\n\t\t\t\tcontext: context,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_name: formName\n\t\t\t},\n\t\t\tonsuccess: html => {\n\t\t\t\tif (html)\n\t\t\t\t{\n\t\t\t\t\tconst dialogRows = Dom.create('div', {\n\t\t\t\t\t\thtml: html\n\t\t\t\t\t});\n\t\t\t\t\tform.appendChild(dialogRows);\n\t\t\t\t}\n\n\t\t\t\tthis.showRobotSettingsPopup(robot, form, saveCallback);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowRobotSettingsPopup(robot: Robot, form: HTMLFormElement, saveCallback: (Robot) => void)\n\t{\n\t\tlet popupMinWidth = 580;\n\t\tlet popupWidth = popupMinWidth;\n\n\t\tif (this.#userOptions)\n\t\t{\n\t\t\t// TODO move from if?\n\t\t\tthis.emit('Template:robot:showSettings');\n\t\t\tpopupWidth = parseInt(\n\t\t\t\tthis.#userOptions.get('defaults', 'robot_settings_popup_width', 580)\n\t\t\t);\n\t\t}\n\n\t\tthis.initRobotSettingsControls(robot, form);\n\n\t\tif (\n\t\t\trobot.data.Type === 'CrmSendEmailActivity'\n\t\t\t|| robot.data.Type === 'MailActivity'\n\t\t\t|| robot.data.Type === 'RpaApproveActivity'\n\t\t)\n\t\t{\n\t\t\tpopupMinWidth += 170;\n\t\t\tif (popupWidth < popupMinWidth)\n\t\t\t{\n\t\t\t\tpopupWidth = popupMinWidth;\n\t\t\t}\n\t\t}\n\n\t\tlet titleBar;\n\t\tconst robotTitle =\n\t\t\trobot.hasTitle()\n\t\t\t\t? robot.getTitle()\n\t\t\t\t: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_SETTINGS_TITLE')\n\t\t;\n\n\t\tconst me = this;\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), null, {\n\t\t\ttitleBar: titleBar || robotTitle,\n\t\t\tcontent: form,\n\t\t\tcloseIcon: true,\n\t\t\twidth: popupWidth,\n\t\t\tresizable: {\n\t\t\t\tminWidth: popupMinWidth,\n\t\t\t\tminHeight: 100\n\t\t\t},\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tdraggable: {restrict: false},\n\t\t\tevents: {\n\t\t\t\tonPopupClose: (popup) => {\n\t\t\t\t\tDesigner.getInstance().setRobotSettingsDialog(null);\n\t\t\t\t\tthis.destroyRobotSettingsControls();\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t\tthis.emit('Template:robot:closeSettings');\n\t\t\t\t},\n\t\t\t\tonPopupResize: () => {\n\t\t\t\t\tthis.onResizeRobotSettings();\n\t\t\t\t},\n\t\t\t\tonPopupResizeEnd: function() {\n\t\t\t\t\tif (me.#userOptions)\n\t\t\t\t\t{\n\t\t\t\t\t\tme.#userOptions.set(\n\t\t\t\t\t\t\t'defaults',\n\t\t\t\t\t\t\t'robot_settings_popup_width',\n\t\t\t\t\t\t\tthis.getWidth()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_SAVE'),\n\t\t\t\t\tclassName : \"popup-window-button-accept\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst isNewRobot = robot.draft;\n\n\t\t\t\t\t\t\tme.saveRobotSettings(form, robot, BX.delegate(function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t\t\tif (isNewRobot)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tme.emit('Template:robot:add', { robot });\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (saveCallback)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsaveCallback(robot);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, this), this.buttonNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick: function(){\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tDesigner.getInstance().getRobotSettingsDialog().popup = popup;\n\t\tpopup.show();\n\t}\n\n\tinitRobotSettingsControls(robot, node)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tconst controlNodes = node.querySelectorAll('[data-role]');\n\t\tfor (let i = 0; i < controlNodes.length; ++i)\n\t\t{\n\t\t\tthis.initRobotSettingsControl(robot, controlNodes[i]);\n\t\t}\n\t}\n\n\tinitRobotSettingsControl(robot, controlNode)\n\t{\n\t\tif (!Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tthis.robotSettingsControls = [];\n\t\t}\n\n\t\tconst role = controlNode.getAttribute('data-role');\n\n\t\tconst controlProps = {\n\t\t\tcontext: new SelectorContext({\n\t\t\t\tfields: Runtime.clone(this.#context.document.getFields()),\n\t\t\t\tuseSwitcherMenu: this.#context.get('showTemplatePropertiesMenuOnSelecting'),\n\t\t\t\trootGroupTitle: this.#context.document.title,\n\t\t\t\tuserOptions: this.#context.userOptions,\n\t\t\t}),\n\t\t\tneedSync: robot.draft,\n\t\t\tcheckbox: controlNode,\n\t\t};\n\n\t\tif (role === SelectorManager.SELECTOR_ROLE_USER)\n\t\t{\n\t\t\tconst fieldProperty = JSON.parse(controlNode.getAttribute('data-property'));\n\t\t\tcontrolProps.context.set('additionalUserFields', this.#getUserSelectorAdditionalFields(fieldProperty));\n\t\t}\n\t\telse if (role === SelectorManager.SELECTOR_ROLE_FILE)\n\t\t{\n\t\t\tthis.robots.forEach((robot) => {\n\t\t\t\tcontrolProps.context.fields.push(\n\t\t\t\t\t...robot\n\t\t\t\t\t\t.getReturnFieldsDescription()\n\t\t\t\t\t\t.filter(field => field['Type'] === 'file')\n\t\t\t\t\t\t.map((field) => ({\n\t\t\t\t\t\t\tId: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t\tName: `${robot.getTitle()}: ${field['Name']}`,\n\t\t\t\t\t\t\tType: 'file',\n\t\t\t\t\t\t\tExpression: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t}))\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst control = SelectorManager.createSelectorByRole(role, controlProps);\n\n\t\tif (control && role !== SelectorManager.SELECTOR_ROLE_SAVE_STATE)\n\t\t{\n\t\t\tcontrol.renderTo(controlNode);\n\n\t\t\tcontrol.subscribe('onAskConstant', (event) => {\n\t\t\t\tconst {fieldProperty} = event.getData();\n\t\t\t\tcontrol.onFieldSelect(this.addConstant(fieldProperty));\n\t\t\t});\n\t\t\tcontrol.subscribe('onAskParameter', (event) => {\n\t\t\t\tconst {fieldProperty} = event.getData();\n\t\t\t\tcontrol.onFieldSelect(this.addParameter(fieldProperty));\n\t\t\t});\n\t\t\tcontrol.subscribe('onOpenFieldMenu', (event) => this.onOpenMenu(event, robot));\n\t\t\tcontrol.subscribe('onOpenMenu', (event) => this.onOpenMenu(event, robot));\n\t\t}\n\n\t\tBX.UI.Hint.init(controlNode);\n\n\t\tif (control)\n\t\t{\n\t\t\tthis.robotSettingsControls.push(control);\n\t\t}\n\t}\n\n\t#getUserSelectorAdditionalFields(fieldProperty): Array<object>\n\t{\n\t\tconst additionalFields = (\n\t\t\tthis\n\t\t\t\t.#getRobotsWithReturnFields()\n\t\t\t\t.map((robot) => (\n\t\t\t\t\trobot\n\t\t\t\t\t\t.getReturnFieldsDescription()\n\t\t\t\t\t\t.filter(field => field['Type'] === 'user')\n\t\t\t\t\t\t.map((field) => ({\n\t\t\t\t\t\t\tid: `{{~${robot.getId()}:${field['Id']}}}`,\n\t\t\t\t\t\t\ttitle: `${robot.getTitle()}: ${field['Name']}`,\n\t\t\t\t\t\t}))\n\t\t\t\t))\n\t\t\t\t.flat()\n\t\t);\n\n\t\tif (this.#context.get('showTemplatePropertiesMenuOnSelecting') && fieldProperty)\n\t\t{\n\t\t\tconst ask = this.addConstant(Runtime.clone(fieldProperty));\n\n\t\t\tadditionalFields.push({\n\t\t\t\tid: ask.Expression,\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'),\n\t\t\t\ttabs: ['recents', 'bpuserroles'],\n\t\t\t\tsort: 1,\n\t\t\t});\n\n\t\t\tconst param = this.addParameter(Runtime.clone(fieldProperty));\n\n\t\t\tadditionalFields.push({\n\t\t\t\tid: param.Expression,\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'),\n\t\t\t\ttabs: ['recents', 'bpuserroles'],\n\t\t\t\tsort: 2,\n\t\t\t});\n\t\t}\n\n\t\treturn additionalFields;\n\t}\n\n\t#addRobotReturnFieldsToSelector(event: BaseEvent, skipRobot: ?Robot)\n\t{\n\t\tconst selector = event.getData().selector;\n\t\tconst isMixedCondition = event.getData().isMixedCondition;\n\n\t\tif (Type.isBoolean(isMixedCondition) && !isMixedCondition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst robotMenuItems = (\n\t\t\tthis\n\t\t\t\t.#getRobotsWithReturnFields(skipRobot)\n\t\t\t\t.map((robot) => ({\n\t\t\t\t\tid: robot.getId(),\n\t\t\t\t\ttitle: robot.getTitle(),\n\t\t\t\t\tchildren: robot.getReturnFieldsDescription().map((field) => ({\n\t\t\t\t\t\tid: field.Expression,\n\t\t\t\t\t\ttitle: field.Name,\n\t\t\t\t\t\tcustomData: { field },\n\t\t\t\t\t}))\n\t\t\t\t}))\n\t\t);\n\n\t\tif (robotMenuItems.length > 0)\n\t\t{\n\t\t\tselector.addGroup('__RESULT', {\n\t\t\t\tid: '__RESULT',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ROBOT_LIST'),\n\t\t\t\tchildren: robotMenuItems\n\t\t\t});\n\t\t}\n\t}\n\n\t#getRobotsWithReturnFields(skipRobot: ?Robot = undefined): Array<Robot>\n\t{\n\t\tconst skipId = skipRobot?.getId() || '';\n\n\t\treturn this\n\t\t\t.robots\n\t\t\t.filter((templateRobot) => (\n\t\t\t\ttemplateRobot.getId() !== skipId && templateRobot.hasReturnFields()\n\t\t\t))\n\t\t;\n\t}\n\n\tdestroyRobotSettingsControls()\n\t{\n\t\tif (this.conditionSelector)\n\t\t{\n\t\t\tthis.conditionSelector.destroy();\n\t\t\tthis.conditionSelector = null;\n\t\t}\n\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].destroy))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.robotSettingsControls = null;\n\t}\n\n\tonBeforeSaveRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onBeforeSave))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onBeforeSave();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonResizeRobotSettings()\n\t{\n\t\tif (Type.isArray(this.robotSettingsControls))\n\t\t{\n\t\t\tfor (let i = 0; i < this.robotSettingsControls.length; ++i)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.robotSettingsControls[i].onPopupResize))\n\t\t\t\t{\n\t\t\t\t\tthis.robotSettingsControls[i].onPopupResize();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trenderDelaySettings(robot)\n\t{\n\t\tconst delay = robot.getDelayInterval().clone();\n\t\tconst idSalt = Helper.generateUniqueId();\n\n\t\tconst delayTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_type\",\n\t\t\t\tvalue: delay.type\n\t\t\t}\n\t\t});\n\t\tconst delayValueNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value\",\n\t\t\t\tvalue: delay.value\n\t\t\t}\n\t\t});\n\t\tconst delayValueTypeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_value_type\",\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\t\tconst delayBasisNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_basis\",\n\t\t\t\tvalue: delay.basis\n\t\t\t}\n\t\t});\n\t\tconst delayWorkTimeNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"delay_worktime\",\n\t\t\t\tvalue: delay.workTime ? 1 : 0\n\t\t\t}\n\t\t});\n\n\t\tconst delayIntervalLabelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t}\n\t\t});\n\n\t\tconst basisFields = [];\n\n\t\tconst docFields = this.#context.document.getFields();\n\t\tconst minLimitM = this.#delayMinLimitM;\n\n\t\tif (Type.isArray(docFields))\n\t\t{\n\t\t\tfor (let i = 0; i < docFields.length; ++i)\n\t\t\t{\n\t\t\t\tconst field = docFields[i];\n\t\t\t\tif (field['Type'] == 'date' || field['Type'] == 'datetime')\n\t\t\t\t{\n\t\t\t\t\tbasisFields.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst delayIntervalSelector = new DelayIntervalSelector({\n\t\t\tlabelNode: delayIntervalLabelNode,\n\t\t\tonchange(delay) {\n\t\t\t\tdelayTypeNode.value = delay.type;\n\t\t\t\tdelayValueNode.value = delay.value;\n\t\t\t\tdelayValueTypeNode.value = delay.valueType;\n\t\t\t\tdelayBasisNode.value = delay.basis;\n\t\t\t\tdelayWorkTimeNode.value = delay.workTime ? 1 : 0;\n\t\t\t},\n\t\t\tbasisFields: basisFields,\n\t\t\tminLimitM: minLimitM,\n\t\t\tuseAfterBasis: true\n\t\t});\n\n\t\tlet executeAfterPreviousBlock = null;\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\tconst executeAfterPreviousCheckbox = Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tid: \"param-group-3-1\" + idSalt,\n\t\t\t\t\tname: \"execute_after_previous\",\n\t\t\t\t\tvalue: '1',\n\t\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (robot.isExecuteAfterPrevious())\n\t\t\t{\n\t\t\t\texecuteAfterPreviousCheckbox.setAttribute('checked', 'checked');\n\t\t\t}\n\t\t\texecuteAfterPreviousBlock = Dom.create(\"div\", {\n\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\tchildren: [\n\t\t\t\t\texecuteAfterPreviousCheckbox,\n\t\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tfor: \"param-group-3-1\" + idSalt,\n\t\t\t\t\t\t\tstyle: 'color: #535C69'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER_PREVIOUS_WIDE')\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t}\n\n\t\tconst div = Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings bizproc-automation-popup-settings-flex\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block bizproc-automation-popup-settings-block-flex\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title-wrapper\" },\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tdelayTypeNode,\n\t\t\t\t\t\t\t\tdelayValueNode,\n\t\t\t\t\t\t\t\tdelayValueTypeNode,\n\t\t\t\t\t\t\t\tdelayBasisNode,\n\t\t\t\t\t\t\t\tdelayWorkTimeNode,\n\t\t\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-left\" },\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_TO_EXECUTE') + \":\"\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdelayIntervalLabelNode\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\texecuteAfterPreviousBlock\n\t\t\t]\n\t\t});\n\n\t\tdelayIntervalSelector.init(delay);\n\n\t\treturn div;\n\t}\n\n\tsetDelaySettingsFromForm(formFields,  robot)\n\t{\n\t\tconst delay = new DelayInterval();\n\t\tdelay.setType(formFields['delay_type']);\n\t\tdelay.setValue(formFields['delay_value']);\n\t\tdelay.setValueType(formFields['delay_value_type']);\n\t\tdelay.setBasis(formFields['delay_basis']);\n\t\tdelay.setWorkTime(formFields['delay_worktime'] === '1');\n\t\trobot.setDelayInterval(delay);\n\n\t\tif (robot.hasTemplate())\n\t\t{\n\t\t\trobot.setExecuteAfterPrevious(\n\t\t\t\tformFields['execute_after_previous'] && (formFields['execute_after_previous']) === '1'\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trenderConditionSettings(robot)\n\t{\n\t\tconst conditionGroup = robot.getCondition();\n\t\tthis.conditionSelector = new ConditionGroupSelector(conditionGroup, {\n\t\t\tfields: this.#context.document.getFields(),\n\t\t\tonOpenFieldMenu: (event) => this.onOpenMenu(event, robot),\n\t\t\tonOpenMenu: (event) => this.onOpenMenu(event, robot),\n\t\t});\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-block\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION') + \":\"\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tthis.conditionSelector.createNode(),\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tonOpenMenu(event: BaseEvent, robot: Robot): void\n\t{\n\t\tthis.#addRobotReturnFieldsToSelector(event, robot);\n\n\t\tthis.emit(\n\t\t\t'Template:onSelectorMenuOpen',\n\t\t\t{\n\t\t\t\ttemplate: this,\n\t\t\t\trobot,\n\t\t\t\t...event.getData()\n\t\t\t}\n\t\t);\n\t}\n\n\tsetConditionSettingsFromForm(formFields, robot)\n\t{\n\t\trobot.setCondition(ConditionGroup.createFromForm(formFields));\n\n\t\treturn this;\n\t}\n\n\trenderBrokenLinkAlert()\n\t{\n\t\tconst alert = Dom.create('div', {\n\t\t\tattrs: {className:'ui-alert ui-alert-warning ui-alert-icon-info ui-alert-xs'}\n\t\t});\n\n\t\tconst message = Dom.create('span', {\n\t\t\tattrs: {className: 'ui-alert-message'},\n\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_BROKEN_LINK_MESSAGE_ERROR')\n\t\t});\n\n\t\talert.appendChild(message);\n\t\talert.appendChild(Dom.create('span', {\n\t\t\tattrs: {className: 'ui-alert-close-btn'},\n\t\t\tevents: {\n\t\t\t\tclick() {\n\t\t\t\t\talert.style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\treturn alert;\n\t}\n\n\tsaveRobotSettings(form, robot, callback, btnNode)\n\t{\n\t\tif (btnNode)\n\t\t{\n\t\t\tbtnNode.classList.add('popup-window-button-wait');\n\t\t}\n\n\t\tthis.onBeforeSaveRobotSettings();\n\t\tconst formData = BX.ajax.prepareForm(form);\n\n\t\tconst ajaxUrl = this.#context.ajaxUrl;\n\t\tconst documentSigned = this.#context.signedDocument;\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: Uri.addParam(\n\t\t\t\tajaxUrl,\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: `automation_robot${robot.draft ? '_draft' : ''}_save_${robot.data.Type.toLowerCase()}`\n\t\t\t\t}\n\t\t\t),\n\t\t\tdata: {\n\t\t\t\tajax_action: 'save_robot_settings',\n\t\t\t\tdocument_signed: documentSigned,\n\t\t\t\trobot_json: Helper.toJsonString(robot.serialize()),\n\t\t\t\tform_data_json: Helper.toJsonString(formData['data']),\n\t\t\t\tform_data: formData['data'], /** @bug 0135641 */\n\t\t\t},\n\t\t\tonsuccess: response => {\n\t\t\t\tif (btnNode)\n\t\t\t\t{\n\t\t\t\t\tbtnNode.classList.remove('popup-window-button-wait');\n\t\t\t\t}\n\n\t\t\t\tif (response.SUCCESS)\n\t\t\t\t{\n\t\t\t\t\trobot.updateData(response.DATA.robot);\n\t\t\t\t\tthis.setDelaySettingsFromForm(formData['data'], robot);\n\t\t\t\t\tthis.setConditionSettingsFromForm(formData['data'], robot);\n\n\t\t\t\t\tif (robot.draft)\n\t\t\t\t\t{\n\t\t\t\t\t\t// remove yellow/orange color\n\n\t\t\t\t\t\t//this.#robots.push(robot);\n\t\t\t\t\t\t//this.insertRobotNode(robot.node);\n\t\t\t\t\t}\n\t\t\t\t\trobot.draft = false;\n\n\t\t\t\t\trobot.reInit();\n\t\t\t\t\tthis.markModified();\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(response.DATA)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\talert(response.ERRORS[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tserialize()\n\t{\n\t\tconst data = BX.clone(this.#data);\n\t\tdata['IS_EXTERNAL_MODIFIED'] = this.isExternalModified() ? 1 : 0;\n\t\tdata['ROBOTS'] = [];\n\n\t\tfor (let i = 0; i < this.#robots.length; ++i)\n\t\t{\n\t\t\tdata['ROBOTS'].push(this.#robots[i].serialize());\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tisExternalModified()\n\t{\n\t\treturn (this.externalModified === true);\n\t}\n\n\tmarkExternalModified(modified)\n\t{\n\t\tthis.externalModified = modified !== false;\n\t}\n\n\tgetRobotById(id)\n\t{\n\t\treturn this.#robots.find(robot => robot.getId() === id);\n\t}\n\n\tisModified()\n\t{\n\t\treturn this.modified;\n\t}\n\n\tmarkModified(modified)\n\t{\n\t\tthis.modified = modified !== false;\n\n\t\tif (this.modified)\n\t\t{\n\t\t\tthis.emit('Template:modified');\n\t\t}\n\t}\n\n\tgetConstants()\n\t{\n\t\tconst constants = [];\n\n\t\tObject.keys(this.#data.CONSTANTS).forEach(id => {\n\t\t\tconst constant = BX.clone(this.#data.CONSTANTS[id]);\n\n\t\t\tconstant.Id = id;\n\t\t\tconstant.ObjectId = 'Constant';\n\t\t\tconstant.SystemExpression = '{=Constant:' + id + '}';\n\t\t\tconstant.Expression = '{{~&:' + id + '}}';\n\n\t\t\tconstants.push(constant);\n\t\t});\n\n\t\treturn constants;\n\t}\n\n\tgetConstant(id)\n\t{\n\t\tconst constants = this.getConstants();\n\n\t\tfor (let i = 0; i < constants.length; ++i)\n\t\t{\n\t\t\tif (constants[i].Id === id)\n\t\t\t{\n\t\t\t\treturn constants[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddConstant(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Constant', this.#data.CONSTANTS);\n\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.CONSTANTS[id] = property;\n\n\t\tthis.emit('Template:constant:add');\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantAdd', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tupdateConstant(id, property)\n\t{\n\t\tif (!this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthrow `Constant with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.CONSTANTS[id].Description = property.Description;\n\n\t\tthis.emit('Template:constant:update', {constant: this.getConstant(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateConstantUpdate', [this, this.getConstant(id)]);\n\t\t// }\n\n\t\treturn this.getConstant(id);\n\t}\n\n\tdeleteConstant(id)\n\t{\n\t\tdelete this.#data.CONSTANTS[id];\n\n\t\treturn true;\n\t}\n\n\tsetConstantValue(id, value)\n\t{\n\t\tif (this.#data.CONSTANTS[id])\n\t\t{\n\t\t\tthis.#data.CONSTANTS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetParameters()\n\t{\n\t\tconst params = [];\n\n\t\tObject.keys(this.#data.PARAMETERS).forEach(id => {\n\t\t\tconst param = BX.clone(this.#data.PARAMETERS[id]);\n\n\t\t\tparam.Id = id;\n\t\t\tparam.ObjectId = 'Template';\n\t\t\tparam.SystemExpression = '{=Template:' + id + '}';\n\t\t\tparam.Expression = '{{~*:' + id + '}}';\n\n\t\t\tparams.push(param);\n\t\t});\n\n\t\treturn params;\n\t}\n\n\tgetParameter(id)\n\t{\n\t\tconst params = this.getParameters();\n\n\t\tfor (let i = 0; i < params.length; ++i)\n\t\t{\n\t\t\tif (params[i].Id === id)\n\t\t\t{\n\t\t\t\treturn params[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddParameter(property)\n\t{\n\t\tconst id = property.Id || this.generatePropertyId('Parameter', this.#data.PARAMETERS);\n\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" is already exists`;\n\t\t}\n\n\t\tthis.#data.PARAMETERS[id] = property;\n\n\t\tthis.emit('Template:parameter:add', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterAdd', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tupdateParameter(id, property)\n\t{\n\t\tif (!this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthrow `Parameter with id \"${id}\" does not exists`;\n\t\t}\n\n\t\t//TODO: only Description yet.\n\t\tthis.#data.PARAMETERS[id].Description = property.Description;\n\n\t\tthis.emit('Template:parameter:update', {parameter: this.getParameter(id)});\n\t\t// if (this.component)\n\t\t// {\n\t\t// \tBX.onCustomEvent(this.component, 'onTemplateParameterUpdate', [this, this.getParameter(id)]);\n\t\t// }\n\n\t\treturn this.getParameter(id);\n\t}\n\n\tdeleteParameter(id)\n\t{\n\t\tdelete this.#data.PARAMETERS[id];\n\n\t\treturn true;\n\t}\n\n\tsetParameterValue(id, value)\n\t{\n\t\tif (this.#data.PARAMETERS[id])\n\t\t{\n\t\t\tthis.#data.PARAMETERS[id]['Default'] = value;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetVariables()\n\t{\n\t\tconst variables = [];\n\n\t\tObject.keys(this.#data.VARIABLES).forEach(id => {\n\t\t\tconst variable = BX.clone(this.#data.VARIABLES[id]);\n\n\t\t\tvariable.Id = id;\n\t\t\tvariable.ObjectId = 'Variable';\n\t\t\tvariable.SystemExpression = '{=Variable:' + id + '}';\n\t\t\tvariable.Expression = '{=Variable:' + id + '}';\n\n\t\t\tvariables.push(variable);\n\t\t});\n\n\t\treturn variables;\n\t}\n\n\tgeneratePropertyId(prefix, existsList)\n\t{\n\t\tlet index;\n\t\tfor(index = 1; index <= 1000; ++index)\n\t\t{\n\t\t\tif (!existsList[prefix + index])\n\t\t\t{\n\t\t\t\tbreak; //found\n\t\t\t}\n\t\t}\n\n\t\treturn prefix + index;\n\t}\n\n\tcollectUsages()\n\t{\n\t\tconst usages = {\n\t\t\tDocument: new Set(),\n\t\t\tConstant: new Set(),\n\t\t\tVariable: new Set(),\n\t\t\tParameter: new Set(),\n\t\t\tGlobalConstant: new Set(),\n\t\t\tGlobalVariable: new Set(),\n\t\t\tActivity: new Set()\n\t\t};\n\n\t\tthis.#robots.forEach(robot => {\n\t\t\tconst robotUsages = robot.collectUsages();\n\n\t\t\tObject.keys(usages).forEach(key => {\n\t\t\t\trobotUsages[key].forEach(usage => {\n\t\t\t\t\tif (!usages[key].has(usage))\n\t\t\t\t\t{\n\t\t\t\t\t\tusages[key].add(usage);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn usages;\n\t}\n\n\tsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.#robots.forEach(robot => robot.subscribe(eventName, listener))\n\n\t\treturn this;\n\t}\n\n\tunsubscribeRobotEvents(eventName: string, listener: (BaseEvent) => void)\n\t{\n\t\tthis.#robots.forEach(robot => robot.unsubscribe(eventName, listener));\n\n\t\treturn this;\n\t}\n\n\tgetRobotDescription(type: string): ?object\n\t{\n\t\treturn this.#context.availableRobots.find(item => item['CLASS'] === type);\n\t}\n\n\tsetGlobalVariables(globalVariables: Array = []): this\n\t{\n\t\tthis.globalVariables = globalVariables;\n\n\t\treturn this;\n\t}\n\n\tsetGlobalConstants(globalConstants: Array = []): this\n\t{\n\t\tthis.globalConstants = globalConstants;\n\n\t\treturn this;\n\t}\n}","import { Type } from 'main.core';\n\nexport class Condition\n{\n\t#object: string;\n\t#field: string;\n\t#operator: string;\n\t#value: string;\n\n\tparentGroup;\n\n\tconstructor(params: ?Object, group)\n\t{\n\t\tthis.#object = 'Document';\n\t\tthis.#field = '';\n\t\tthis.#operator = '!empty';\n\t\tthis.#value = '';\n\n\t\tthis.parentGroup = null;\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['object'])\n\t\t\t{\n\t\t\t\tthis.setObject(params['object']);\n\t\t\t}\n\t\t\tif (params['field'])\n\t\t\t{\n\t\t\t\tthis.setField(params['field']);\n\t\t\t}\n\t\t\tif (params['operator'])\n\t\t\t{\n\t\t\t\tthis.setOperator(params['operator']);\n\t\t\t}\n\t\t\tif ('value' in params)\n\t\t\t{\n\t\t\t\tthis.setValue(params['value']);\n\t\t\t}\n\t\t}\n\t\tif (group)\n\t\t{\n\t\t\tthis.parentGroup = group;\n\t\t}\n\t}\n\n\tclone(): Condition\n\t{\n\t\treturn new Condition(\n\t\t\t{\n\t\t\t\tobject: this.#object,\n\t\t\t\tfield: this.#field,\n\t\t\t\toperator: this.#operator,\n\t\t\t\tvalue: this.#value,\n\t\t\t},\n\t\t\tthis.parentGroup,\n\t\t);\n\t}\n\n\tsetObject(object)\n\t{\n\t\tif (Type.isStringFilled(object))\n\t\t{\n\t\t\tthis.#object = object;\n\t\t}\n\t}\n\n\tget object()\n\t{\n\t\treturn this.#object;\n\t}\n\n\tsetField(field)\n\t{\n\t\tif (Type.isStringFilled(field))\n\t\t{\n\t\t\tthis.#field = field;\n\t\t}\n\t}\n\n\tget field()\n\t{\n\t\treturn this.#field;\n\t}\n\n\tsetOperator(operator)\n\t{\n\t\tif (!operator)\n\t\t{\n\t\t\toperator = '=';\n\t\t}\n\n\t\tthis.#operator = operator;\n\t}\n\n\tget operator(): string\n\t{\n\t\treturn this.#operator;\n\t}\n\n\tsetValue(value)\n\t{\n\t\tthis.#value = value;\n\t\tif (this.#operator === '=' && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = 'empty';\n\t\t}\n\t\telse if (this.#operator === '!=' && this.#value === '')\n\t\t{\n\t\t\tthis.#operator = '!empty';\n\t\t}\n\t}\n\n\tget value()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tserialize(): Object\n\t{\n\t\treturn {\n\t\t\tobject: this.#object,\n\t\t\tfield: this.#field,\n\t\t\toperator: this.#operator,\n\t\t\tvalue: this.#value\n\t\t}\n\t}\n}","import { Type, Loc } from 'main.core';\nimport { Condition } from './condition';\n\nexport class ConditionGroup\n{\n\tstatic CONDITION_TYPE = {\n\t\tField: 'field',\n\t\tMixed: 'mixed',\n\t}\n\tstatic JOINER = {\n\t\tAnd: 'AND',\n\t\tOr: 'OR',\n\n\t\tmessage(type)\n\t\t{\n\t\t\tif (type === this.Or)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_OR');\n\t\t\t}\n\n\t\t\treturn Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_AND');\n\t\t}\n\t}\n\n\t#type: string;\n\t#items: Array<[Condition, string]>;\n\n\tconstructor(params: ?Object)\n\t{\n\t\tthis.#type = ConditionGroup.CONDITION_TYPE.Field;\n\t\tthis.#items = [];\n\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (params['type'])\n\t\t\t{\n\t\t\t\tthis.#type = params['type'];\n\t\t\t}\n\t\t\tif (Type.isArray(params['items']))\n\t\t\t{\n\t\t\t\tparams['items'].forEach(item => {\n\t\t\t\t\tconst condition = new Condition(item[0], this);\n\t\t\t\t\tthis.addItem(condition, item[1]);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tclone()\n\t{\n\t\tconst clonedGroup = new ConditionGroup({type: this.#type});\n\t\tthis.#items.forEach(([condition, joiner]) => {\n\t\t\tconst clonedCondition = condition.clone();\n\t\t\tclonedCondition.parentGroup = clonedGroup;\n\n\t\t\tclonedGroup.addItem(clonedCondition, joiner);\n\t\t});\n\n\t\treturn clonedGroup;\n\t}\n\n\tget type()\n\t{\n\t\treturn this.#type;\n\t}\n\n\tset type(type: string)\n\t{\n\t\tif (Object.values(ConditionGroup.CONDITION_TYPE).includes(type))\n\t\t{\n\t\t\tthis.#type = type;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget items()\n\t{\n\t\treturn this.#items;\n\t}\n\n\tstatic createFromForm(formFields, prefix)\n\t{\n\t\tconst conditionGroup = new ConditionGroup();\n\t\tif (!prefix)\n\t\t{\n\t\t\tprefix = 'condition_';\n\t\t}\n\n\t\tif (Type.isArray(formFields[prefix + 'field']))\n\t\t{\n\t\t\tfor (let i = 0; i < formFields[prefix + 'field'].length; ++i)\n\t\t\t{\n\t\t\t\tif (formFields[prefix + 'field'][i] === '')\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst condition = new Condition({}, conditionGroup);\n\t\t\t\tcondition.setObject(formFields[prefix + 'object'][i]);\n\t\t\t\tcondition.setField(formFields[prefix + 'field'][i]);\n\t\t\t\tcondition.setOperator(formFields[prefix + 'operator'][i]);\n\t\t\t\tcondition.setValue(formFields[prefix + 'value'][i]);\n\n\t\t\t\tlet joiner = ConditionGroup.JOINER.And;\n\t\t\t\tif (formFields[prefix + 'joiner'] && formFields[prefix + 'joiner'][i] === ConditionGroup.JOINER.Or)\n\t\t\t\t{\n\t\t\t\t\tjoiner = ConditionGroup.JOINER.Or;\n\t\t\t\t}\n\n\t\t\t\tconditionGroup.addItem(condition, joiner);\n\t\t\t}\n\t\t}\n\n\t\treturn conditionGroup;\n\t}\n\n\taddItem(condition, joiner)\n\t{\n\t\tthis.#items.push([condition, joiner]);\n\t}\n\n\tgetItems(): Array<Array<Condition, string>>\n\t{\n\t\treturn this.#items;\n\t}\n\n\tserialize()\n\t{\n\t\tconst itemsArray = [];\n\n\t\tthis.#items.forEach(item => {\n\t\t\tif (item.field !== '')\n\t\t\t{\n\t\t\t\titemsArray.push([item[0].serialize(), item[1]]);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\ttype: this.#type,\n\t\t\titems: itemsArray\n\t\t};\n\t}\n}","import {\n\tCondition,\n\tConditionGroup,\n\tDesigner,\n\tgetGlobalContext,\n\tInlineSelectorCondition,\n\tSelectorContext,\n\tSelectorManager,\n} from 'bizproc.automation';\nimport { Dom, Type, Event, Loc, Runtime } from 'main.core';\n\nimport type { ConditionSelectorOptions } from './types';\nimport { BaseEvent } from 'main.core.events';\n\nexport class ConditionSelector\n{\n\t#condition: ?Condition;\n\t#fields: Array<Object>;\n\t#joiner: string;\n\t#fieldPrefix: string;\n\t#rootGroupTitle: ?string;\n\t#onOpenFieldMenu: ?(BaseEvent) => void;\n\t#onOpenMenu: ?(BaseEvent) => void;\n\n\tnode: ?HTMLElement;\n\tobjectNode: ?HTMLElement;\n\tfieldNode: ?HTMLElement;\n\tjoinerNode: ?HTMLElement;\n\tlabelNode: ?HTMLElement;\n\n\tpopup: BX.PopupWindow;\n\tfieldDialog: ?InlineSelectorCondition;\n\n\tconstructor(condition, options: ?ConditionSelectorOptions)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.#fields = [];\n\t\tthis.#joiner = ConditionGroup.JOINER.And;\n\t\tthis.#fieldPrefix = 'condition_';\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields.map(field => {\n\t\t\t\t\tfield.ObjectId = 'Document';\n\n\t\t\t\t\treturn field;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (options.joiner && options.joiner === ConditionGroup.JOINER.Or)\n\t\t\t{\n\t\t\t\tthis.#joiner = ConditionGroup.JOINER.Or;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\n\t\t\tthis.#rootGroupTitle = options.rootGroupTitle;\n\t\t\tthis.#onOpenFieldMenu = options.onOpenFieldMenu;\n\t\t\tthis.#onOpenMenu = options.onOpenMenu;\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst conditionObjectNode = this.objectNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"object[]\",\n\t\t\t\tvalue: this.#condition.object\n\t\t\t}\n\t\t});\n\t\tconst conditionFieldNode = this.fieldNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"field[]\",\n\t\t\t\tvalue: this.#condition.field\n\t\t\t}\n\t\t});\n\t\tconst conditionOperatorNode = this.operatorNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"operator[]\",\n\t\t\t\tvalue: this.#condition.operator\n\t\t\t}\n\t\t});\n\t\tconst conditionValueNode = this.valueNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"value[]\",\n\t\t\t\tvalue: this.#condition.value\n\t\t\t}\n\t\t});\n\n\t\tconst conditionJoinerNode = this.joinerNode = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: this.#fieldPrefix + \"joiner[]\",\n\t\t\t\tvalue: this.#joiner\n\t\t\t}\n\t\t});\n\n\t\tconst labelNode = this.labelNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-wrapper\"\n\t\t\t}\n\t\t});\n\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\n\t\tconst removeButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link-remove\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: this.removeCondition.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst joinerButtonNode = Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-condition-joiner\"\n\t\t\t},\n\t\t\ttext: ConditionGroup.JOINER.message(this.#joiner),\n\t\t});\n\n\t\tEvent.bind(joinerButtonNode, 'click', this.changeJoiner.bind(this, joinerButtonNode));\n\n\t\tthis.node = Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper bizproc-automation-condition-wrapper\" },\n\t\t\tchildren: [\n\t\t\t\tconditionObjectNode,\n\t\t\t\tconditionFieldNode,\n\t\t\t\tconditionOperatorNode,\n\t\t\t\tconditionValueNode,\n\t\t\t\tconditionJoinerNode,\n\t\t\t\tlabelNode,\n\t\t\t\tremoveButtonNode,\n\t\t\t\tjoinerButtonNode\n\t\t\t]\n\t\t});\n\n\t\treturn this.node;\n\t}\n\n\tinit(condition: Condition)\n\t{\n\t\tthis.#condition = condition;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (!this.labelNode || !this.#condition)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.labelNode);\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\tconst field = this.getField(this.#condition.object, this.#condition.field) || '?';\n\t\t\tconst valueLabel =\n\t\t\t\t(this.#condition.operator.indexOf('empty') < 0)\n\t\t\t\t\t? BX.Bizproc.FieldType.formatValuePrintable(field, this.#condition.value)\n\t\t\t\t\t: null\n\t\t\t;\n\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: field.Name\n\t\t\t}));\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: this.getOperatorLabel(this.#condition.operator)\n\t\t\t}));\n\t\t\tif (valueLabel)\n\t\t\t{\n\t\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: valueLabel\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.labelNode.appendChild(Dom.create(\"span\", {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link\"\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY')\n\t\t\t}));\n\t\t}\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', this.onLabelClick.bind(this));\n\t\t}\n\t}\n\n\tonLabelClick()\n\t{\n\t\tthis.showPopup();\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.show();\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = this.filterFields();\n\n\t\tconst objectSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelect = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown'\n\t\t\t}\n\t\t});\n\t\tconst fieldSelectLabel = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-dropdown',\n\t\t\t\treadonly: 'readonly'\n\t\t\t},\n\t\t\tchildren: [fieldSelect]\n\t\t});\n\n\t\tEvent.bind(\n\t\t\tfieldSelectLabel,\n\t\t\t'click',\n\t\t\tthis.onFieldSelectorClick.bind(this, fieldSelectLabel, fieldSelect, fields, objectSelect)\n\t\t);\n\n\t\tlet selectedField = this.getField(this.#condition.object, this.#condition.field);\n\t\tif (!this.#condition.field)\n\t\t{\n\t\t\tselectedField = fields[0];\n\t\t}\n\t\tfieldSelect.value = selectedField.Id;\n\t\tobjectSelect.value = selectedField.ObjectId;\n\t\tfieldSelectLabel.textContent = selectedField.Name;\n\n\t\tconst valueInput = (this.#condition.operator.indexOf('empty') < 0)\n\t\t\t? this.createValueNode(selectedField, this.#condition.value) : null;\n\n\t\tconst valueWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [valueInput]\n\t\t});\n\n\t\tconst operatorSelect = this.createOperatorNode(selectedField, valueWrapper);\n\t\tconst operatorWrapper = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t},\n\t\t\tchildren: [operatorSelect]\n\t\t});\n\n\t\tif (this.#condition.field !== '')\n\t\t{\n\t\t\toperatorSelect.value = this.#condition.operator;\n\t\t}\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" },\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'bizproc-automation-popup-settings'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [fieldSelectLabel]\n\t\t\t\t}),\n\t\t\t\toperatorWrapper,\n\t\t\t\tvalueWrapper\n\t\t\t]\n\t\t});\n\n\t\tEvent.bind(fieldSelect, 'change', this.onFieldChange.bind(\n\t\t\tthis,\n\t\t\tfieldSelect,\n\t\t\toperatorWrapper,\n\t\t\tvalueWrapper,\n\t\t\tobjectSelect\n\t\t));\n\n\t\tconst self = this;\n\t\tthis.popup = new BX.PopupWindow('bizproc-automation-popup-set', this.labelNode, {\n\t\t\tclassName: 'bizproc-automation-popup-set',\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 45,\n\t\t\toverlay: { backgroundColor: 'transparent' },\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: \"webform-button webform-button-create\" ,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.#condition.setObject(objectSelect.value);\n\t\t\t\t\t\t\tself.#condition.setField(fieldSelect.value);\n\t\t\t\t\t\t\tself.#condition.setOperator(operatorWrapper.firstChild.value);\n\n\t\t\t\t\t\t\tconst valueInput = valueWrapper.querySelector('[name^=\"' + self.#fieldPrefix + 'value\"]');\n\n\t\t\t\t\t\t\tif (valueInput)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#condition.setValue(valueInput.value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.#condition.setValue('');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.setLabelText();\n\t\t\t\t\t\t\tself.updateValueNode();\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext : Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\tclassName : \"popup-window-button-link-cancel\",\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupWindow.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t\tif (self.fieldDialog)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldDialog.destroy();\n\t\t\t\t\t\tdelete(self.fieldDialog);\n\t\t\t\t\t}\n\t\t\t\t\tdelete(self.popup);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.popup.show();\n\t}\n\n\tonFieldSelectorClick(fieldSelectLabel, fieldSelect, fields, objectSelect, event)\n\t{\n\t\tif (!this.fieldDialog)\n\t\t{\n\t\t\tconst globalContext = getGlobalContext();\n\t\t\tconst fields = Runtime.clone(\n\t\t\t\tType.isArrayFilled(this.#fields) ? this.#fields : globalContext.document.getFields()\n\t\t\t);\n\n\t\t\tthis.fieldDialog = new InlineSelectorCondition({\n\t\t\t\tcontext: new SelectorContext({\n\t\t\t\t\tfields,\n\t\t\t\t\trootGroupTitle: globalContext.document.title,\n\t\t\t\t}),\n\t\t\t\tcondition: this.#condition,\n\t\t\t});\n\n\t\t\tif (Type.isFunction(this.#onOpenFieldMenu))\n\t\t\t{\n\t\t\t\tthis.fieldDialog.subscribe('onOpenMenu', this.#onOpenFieldMenu);\n\t\t\t}\n\n\t\t\tthis.fieldDialog.subscribe('change', (event) => {\n\t\t\t\tconst property = event.getData().field;\n\t\t\t\tfieldSelectLabel.textContent = property.Name\n\t\t\t\tfieldSelect.value = property.Id;\n\t\t\t\tobjectSelect.value = property.ObjectId;\n\t\t\t\tBX.fireEvent(fieldSelect, 'change');\n\t\t\t});\n\n\t\t\tthis.fieldDialog.renderTo(fieldSelectLabel);\n\t\t}\n\n\t\tthis.fieldDialog.openMenu(event);\n\t}\n\n\tupdateValueNode()\n\t{\n\t\tif (this.#condition)\n\t\t{\n\t\t\tif (this.objectNode)\n\t\t\t{\n\t\t\t\tthis.objectNode.value = this.#condition.object;\n\t\t\t}\n\t\t\tif (this.fieldNode)\n\t\t\t{\n\t\t\t\tthis.fieldNode.value = this.#condition.field;\n\t\t\t}\n\t\t\tif (this.operatorNode)\n\t\t\t{\n\t\t\t\tthis.operatorNode.value = this.#condition.operator;\n\t\t\t}\n\t\t\tif (this.valueNode)\n\t\t\t{\n\t\t\t\tthis.valueNode.value = this.#condition.value;\n\t\t\t}\n\t\t}\n\t}\n\n\tonFieldChange(selectNode: Node, conditionWrapper: Node, valueWrapper: Node, objectSelect)\n\t{\n\t\tconst field = this.getField(objectSelect.value, selectNode.value);\n\t\tconst operatorNode = this.createOperatorNode(field, valueWrapper);\n\t\tconditionWrapper.replaceChild(operatorNode, conditionWrapper.firstChild);\n\t\tthis.onOperatorChange(operatorNode, field, valueWrapper);\n\t}\n\n\tonOperatorChange(selectNode: Node, field: Object, valueWrapper: Node)\n\t{\n\t\tDom.clean(valueWrapper);\n\n\t\tif (selectNode.value.indexOf('empty') < 0)\n\t\t{\n\t\t\tconst valueNode = this.createValueNode(field);\n\t\t\tvalueWrapper.appendChild(valueNode);\n\t\t}\n\t}\n\n\t// TODO - fix this method\n\tgetField(object, id)\n\t{\n\t\tlet field;\n\t\tconst robot = Designer.getInstance().robot;\n\t\tconst component = Designer.getInstance().component;\n\t\tconst tpl = robot? robot.getTemplate() : null;\n\n\t\tswitch (object)\n\t\t{\n\t\t\tcase 'Document':\n\t\t\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (id === this.#fields[i].Id)\n\t\t\t\t\t{\n\t\t\t\t\t\tfield = this.#fields[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Template':\n\t\t\t\tif (tpl && component && component.triggerManager)\n\t\t\t\t{\n\t\t\t\t\tfield = component.triggerManager.getReturnProperty(tpl.getStatusId(), id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Constant':\n\t\t\t\tif (tpl)\n\t\t\t\t{\n\t\t\t\t\tfield = tpl.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalConst':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getConstant(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GlobalVar':\n\t\t\t\tif (component)\n\t\t\t\t{\n\t\t\t\t\tfield = component.getGVariable(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tvar foundRobot = tpl? tpl.getRobotById(object) : null;\n\t\t\t\tif (foundRobot)\n\t\t\t\t{\n\t\t\t\t\tfield = foundRobot.getReturnProperty(id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn field || {\n\t\t\tId: id,\n\t\t\tObjectId: object,\n\t\t\tName: id,\n\t\t\tType: 'string',\n\t\t\tExpression: id,\n\t\t\tSystemExpression: '{='+object+':'+id+'}'\n\t\t};\n\t}\n\n\tgetOperators(fieldType, multiple)\n\t{\n\t\tlet list = {\n\t\t\t'!empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_EMPTY'),\n\t\t\t'empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY'),\n\t\t\t'=': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EQ'),\n\t\t\t'!=': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NE')\n\t\t};\n\t\tswitch (fieldType)\n\t\t{\n\t\t\tcase 'file':\n\t\t\tcase 'UF:crm':\n\t\t\tcase 'UF:resourcebooking':\n\t\t\t\tlist = {\n\t\t\t\t\t'!empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_EMPTY'),\n\t\t\t\t\t'empty': Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_EMPTY')\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'bool':\n\t\t\tcase 'select':\n\t\t\t\tif (multiple)\n\t\t\t\t{\n\t\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//TODO: render multiple select in value selector\n\t\t\t\t\t//list['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'user':\n\t\t\t\tlist['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\tlist['!in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_IN');\n\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlist['in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_IN');\n\t\t\t\tlist['!in'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_IN');\n\t\t\t\tlist['contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_CONTAIN');\n\t\t\t\tlist['!contain'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_NOT_CONTAIN');\n\t\t\t\tlist['>'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_GT');\n\t\t\t\tlist['>='] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_GTE');\n\t\t\t\tlist['<'] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_LT');\n\t\t\t\tlist['<='] = Loc.getMessage('BIZPROC_AUTOMATION_ROBOT_CONDITION_LTE');\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetOperatorLabel(id)\n\t{\n\t\treturn this.getOperators()[id];\n\t}\n\n\tfilterFields()\n\t{\n\t\tconst filtered = [];\n\t\tfor (let i = 0; i < this.#fields.length; ++i)\n\t\t{\n\t\t\tconst type = this.#fields[i]['Type'];\n\n\t\t\tif (\n\t\t\t\ttype === 'bool'\n\t\t\t\t|| type === 'date'\n\t\t\t\t|| type === 'datetime'\n\t\t\t\t|| type === 'double'\n\t\t\t\t|| type === 'file'\n\t\t\t\t|| type === 'int'\n\t\t\t\t|| type === 'select'\n\t\t\t\t|| type === 'string'\n\t\t\t\t|| type === 'text'\n\t\t\t\t|| type === 'user'\n\t\t\t\t|| type === 'UF:money'\n\t\t\t\t|| type === 'UF:crm'\n\t\t\t\t|| type === 'UF:resourcebooking'\n\t\t\t\t|| type === 'UF:url'\n\t\t\t)\n\t\t\t{\n\t\t\t\tfiltered.push(this.#fields[i]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//TODO add support of custom types\n\t\t\t}\n\t\t}\n\n\t\treturn filtered;\n\t}\n\n\tcreateValueNode(docField, value)\n\t{\n\t\tconst docType = (\n\t\t\tDesigner.getInstance().component\n\t\t\t\t? Designer.getInstance().component.document.getRawType()\n\t\t\t\t: getGlobalContext().document.getRawType()\n\t\t);\n\t\tconst field = BX.clone(docField);\n\t\tfield.Multiple = false;\n\n\t\tconst valueNodes = BX.Bizproc.FieldType.renderControlPublic(\n\t\t\tdocType,\n\t\t\tfield,\n\t\t\tthis.#fieldPrefix + 'value',\n\t\t\tvalue,\n\t\t\tfalse\n\t\t);\n\n\t\tvalueNodes.querySelectorAll('[data-role]').forEach((node) => {\n\t\t\tconst selector = SelectorManager.createSelectorByRole(node.dataset.role, {\n\t\t\t\tcontext: new SelectorContext({\n\t\t\t\t\tfields: getGlobalContext().document.getFields(),\n\t\t\t\t\tuseSwitcherMenu: false,\n\t\t\t\t\trootGroupTitle: this.#rootGroupTitle ?? getGlobalContext().document.title,\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tif (selector)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.#onOpenMenu))\n\t\t\t\t{\n\t\t\t\t\tselector.subscribe('onOpenMenu', this.#onOpenMenu);\n\t\t\t\t}\n\t\t\t\tselector.renderTo(node);\n\t\t\t}\n\t\t});\n\n\t\treturn valueNodes;\n\t}\n\n\tcreateOperatorNode(field, valueWrapper)\n\t{\n\t\tconst select = Dom.create('select', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-dropdown'}\n\t\t});\n\n\t\tconst operatorList = this.getOperators(field['Type'], field['Multiple']);\n\t\tfor (var operatorId in operatorList)\n\t\t{\n\t\t\tif (!operatorList.hasOwnProperty(operatorId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tselect.appendChild(Dom.create('option', {\n\t\t\t\tprops: {value: operatorId},\n\t\t\t\ttext: operatorList[operatorId]\n\t\t\t}));\n\t\t}\n\n\t\tEvent.bind(select, 'change', this.onOperatorChange.bind(\n\t\t\tthis,\n\t\t\tselect,\n\t\t\tfield,\n\t\t\tvalueWrapper\n\t\t));\n\n\t\treturn select;\n\t}\n\n\tremoveCondition(event: Event)\n\t{\n\t\tthis.#condition = null;\n\t\tDom.remove(this.node);\n\t\tthis.labelNode = this.fieldNode = this.operatorNode = this.valueNode = this.node = null;\n\n\t\tevent.stopPropagation();\n\t}\n\n\tchangeJoiner(btn: Element, event: Event)\n\t{\n\t\tthis.#joiner = (this.#joiner === ConditionGroup.JOINER.Or ? ConditionGroup.JOINER.And : ConditionGroup.JOINER.Or);\n\t\tbtn.textContent = ConditionGroup.JOINER.message(this.#joiner);\n\n\t\tif (this.joinerNode)\n\t\t{\n\t\t\tthis.joinerNode.value = this.#joiner;\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n}","import { Type, Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport { ConditionGroup } from 'bizproc.automation';\nimport { ConditionSelector } from './condition-selector';\nimport { Condition } from 'bizproc.automation';\n\nexport class ConditionGroupSelector\n{\n\t#conditionGroup: ConditionGroup;\n\t#fields: Array<Object>;\n\t#fieldPrefix: string;\n\t#itemSelectors: Array<ConditionSelector>;\n\t#onOpenFieldMenu: ?(BaseEvent) => void;\n\t#onOpenMenu: ?(BaseEvent) => void;\n\t#rootGroupTitle: ?string;\n\n\tconstructor(conditionGroup: ConditionGroup, options: Object)\n\t{\n\t\tthis.#conditionGroup = conditionGroup;\n\t\tthis.#fields = [];\n\t\tthis.#fieldPrefix = 'condition_';\n\t\tthis.#itemSelectors = [];\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isArray(options.fields))\n\t\t\t{\n\t\t\t\tthis.#fields = options.fields;\n\t\t\t}\n\t\t\tif (options.fieldPrefix)\n\t\t\t{\n\t\t\t\tthis.#fieldPrefix = options.fieldPrefix;\n\t\t\t}\n\n\t\t\tthis.#rootGroupTitle = options.rootGroupTitle\n\t\t\tthis.#onOpenFieldMenu = options.onOpenFieldMenu;\n\t\t\tthis.#onOpenMenu = options.onOpenMenu;\n\t\t}\n\t}\n\n\tcreateNode()\n\t{\n\t\tconst me = this;\n\t\tconst conditionNodes = [];\n\t\tconst fields = this.#fields;\n\n\t\tthis.#conditionGroup.getItems().forEach(function(item)\n\t\t{\n\t\t\tconst conditionSelector = new ConditionSelector(item[0], {\n\t\t\t\tfields: fields,\n\t\t\t\tjoiner: item[1],\n\t\t\t\tfieldPrefix: me.#fieldPrefix,\n\t\t\t\trootGroupTitle: this.#rootGroupTitle,\n\t\t\t\tonOpenFieldMenu: this.#onOpenFieldMenu,\n\t\t\t\tonOpenMenu: this.#onOpenMenu,\n\t\t\t});\n\n\t\t\tthis.#itemSelectors.push(conditionSelector);\n\t\t\tconditionNodes.push(conditionSelector.createNode());\n\t\t}, this);\n\n\t\tconditionNodes.push(Dom.create(\"a\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link\" },\n\t\t\ttext: '[+]',\n\t\t\tevents: {\n\t\t\t\tclick()\n\t\t\t\t{\n\t\t\t\t\tme.addItem(this);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\treturn Dom.create(\"span\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-link-wrapper\" },\n\t\t\tchildren: conditionNodes\n\t\t});\n\t}\n\n\taddItem(buttonNode)\n\t{\n\t\tconst conditionSelector = new ConditionSelector(new Condition({}, this.#conditionGroup), {\n\t\t\tfields: this.#fields,\n\t\t\tfieldPrefix: this.#fieldPrefix,\n\t\t\trootGroupTitle: this.#rootGroupTitle,\n\t\t\tonOpenFieldMenu: this.#onOpenFieldMenu,\n\t\t\tonOpenMenu: this.#onOpenMenu,\n\t\t});\n\t\tthis.#itemSelectors.push(conditionSelector);\n\n\t\tbuttonNode.parentNode.insertBefore(conditionSelector.createNode(), buttonNode);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#itemSelectors.forEach(selector => selector.destroy());\n\t\tthis.#itemSelectors = [];\n\t}\n}","import {\n\tFileSelector,\n\tInlineSelector,\n\tInlineSelectorHtml,\n\tSaveStateCheckbox,\n\tTimeSelector,\n\tUserSelector,\n} from 'bizproc.automation';\n\nexport class Manager\n{\n\tstatic SELECTOR_ROLE_USER = 'user-selector';\n\tstatic SELECTOR_ROLE_FILE = 'file-selector';\n\tstatic SELECTOR_ROLE_INLINE = 'inline-selector-target';\n\tstatic SELECTOR_ROLE_INLINE_HTML = 'inline-selector-html';\n\tstatic SELECTOR_ROLE_TIME = 'time-selector';\n\tstatic SELECTOR_ROLE_SAVE_STATE = 'save-state-checkbox';\n\n\tstatic createSelectorByRole(role: string, selectorProps: object): InlineSelector | SaveStateCheckbox\n\t{\n\t\tif (role === this.SELECTOR_ROLE_USER)\n\t\t{\n\t\t\treturn new UserSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_FILE)\n\t\t{\n\t\t\treturn new FileSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_INLINE)\n\t\t{\n\t\t\treturn new InlineSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_INLINE_HTML)\n\t\t{\n\t\t\treturn new InlineSelectorHtml(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_TIME)\n\t\t{\n\t\t\treturn new TimeSelector(selectorProps);\n\t\t}\n\t\telse if (role === this.SELECTOR_ROLE_SAVE_STATE)\n\t\t{\n\t\t\treturn new SaveStateCheckbox(selectorProps);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn undefined;\n\t\t}\n\t}\n}","import { SelectorContext, DelayIntervalSelector, Helper, DelayInterval } from 'bizproc.automation';\nimport { Dom, Event, Type, Loc, Tag, Runtime } from \"main.core\";\nimport { EventEmitter } from \"main.core.events\";\n\nimport { Field, MenuGroupItem }  from \"./types\";\nimport { MenuManager, Menu } from 'main.popup';\nimport { Dialog } from 'ui.entity-selector';\n\nexport class InlineSelector extends EventEmitter\n{\n\tcontext: SelectorContext;\n\tfieldProperty: ?Field = null;\n\treplaceOnWrite: boolean = false;\n\tmenuButton: ?HTMLSpanElement = null;\n\ttargetInput: ?HTMLElement = null;\n\t#menuGroups: Object<string, MenuGroupItem> = {};\n\tbasisFields: Array<Object> = [];\n\t#dialog: ?Dialog = null;\n\t#switcherDialog: ?Menu = null;\n\n\tconstructor(props: { context: SelectorContext })\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Automation.Selector');\n\n\t\tthis.context = props.context;\n\t\tthis.basisFields = this.context.fields;\n\t}\n\n\thasGroup(groupId: string): boolean\n\t{\n\t\treturn this.#menuGroups.hasOwnProperty(groupId);\n\t}\n\n\taddGroup(groupId: string, group: MenuGroupItem)\n\t{\n\t\tthis.#menuGroups[groupId] = this.#normalizeGroup(group);\n\t}\n\n\taddGroupItem(groupId: string, item: MenuGroupItem)\n\t{\n\t\tif (this.hasGroup(groupId))\n\t\t{\n\t\t\tthis.#menuGroups[groupId].children.push(this.#normalizeGroup(item));\n\t\t}\n\t}\n\n\t#normalizeGroup(group: MenuGroupItem)\n\t{\n\t\tif (!Type.isArray(group.children))\n\t\t{\n\t\t\tgroup.children = [];\n\t\t}\n\n\t\tgroup.children = (\n\t\t\tgroup\n\t\t\t\t.children\n\t\t\t\t.filter(item => item.customData?.field ? this.#shouldShowField(item.customData.field) : true)\n\t\t\t\t.map(childGroup => this.#normalizeGroup(childGroup))\n\t\t);\n\n\t\treturn {\n\t\t\tentityId: 'bp',\n\t\t\ttabs: 'recents',\n\t\t\t...group\n\t\t};\n\t}\n\n\trenderWith(targetInput: Element): HTMLDivElement\n\t{\n\t\tthis.targetInput = Runtime.clone(targetInput);\n\t\tthis.targetInput.setAttribute('autocomplete', 'off');\n\n\t\tthis.menuButton = Tag.render`\n\t\t\t<span \n\t\t\t\tonclick=\"${this.openMenu.bind(this)}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-dotted\"\n\t\t\t></span>\n\t\t`;\n\n\t\tthis.parseTargetProperties();\n\n\t\tthis.replaceOnWrite |= (this.targetInput.getAttribute('data-select-mode') === 'replace');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-select\">\n\t\t\t\t${this.targetInput}\n\t\t\t\t${this.menuButton}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderTo(targetInput: Element): void\n\t{\n\t\ttargetInput.parentNode.replaceChild(this.renderWith(targetInput), targetInput);\n\t}\n\n\tbindTargetEvents(): void\n\t{\n\t\tEvent.bind(this.targetInput, 'keydown', this.#onKeyDown.bind(this));\n\t}\n\n\tparseTargetProperties(): void\n\t{\n\t\tthis.fieldProperty = JSON.parse(this.targetInput.getAttribute('data-property'));\n\t\tconst propertyType = this.targetInput.getAttribute('data-selector-type');\n\n\t\tif (!this.fieldProperty && propertyType)\n\t\t{\n\t\t\tthis.fieldProperty = {Type: propertyType};\n\t\t}\n\n\t\tif (this.fieldProperty)\n\t\t{\n\t\t\tthis.fieldProperty.Type = this.fieldProperty.Type || propertyType;\n\t\t\tthis.#prepareSelectorUsingFieldType();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.context.useSwitcherMenu = false;\n\t\t}\n\n\t\tthis.replaceOnWrite |= (this.targetInput.getAttribute('data-select-mode') === 'replace');\n\t}\n\n\t#prepareSelectorUsingFieldType(): void\n\t{\n\t\tthis.basisFields = this.basisFields.filter(field => this.#shouldShowField(field));\n\n\t\tconst type = this.fieldProperty?.Type;\n\t\tif (type === 'file')\n\t\t{\n\t\t\tthis.replaceOnWrite = true;\n\t\t}\n\t\telse if (type === 'date' || type === 'datetime')\n\t\t{\n\t\t\tthis.replaceOnWrite = true;\n\n\t\t\tconst delayIntervalSelector = new DelayIntervalSelector({\n\t\t\t\tlabelNode: this.targetInput,\n\t\t\t\tbasisFields: this.basisFields,\n\t\t\t\tuseAfterBasis: true,\n\t\t\t\tonchange: (function(delay)\n\t\t\t\t{\n\t\t\t\t\tthis.targetInput.value = delay.toExpression(\n\t\t\t\t\t\tthis.basisFields,\n\t\t\t\t\t\tHelper.getResponsibleUserExpression(this.context.fields)\n\t\t\t\t\t);\n\t\t\t\t}).bind(this)\n\t\t\t});\n\n\t\t\tdelayIntervalSelector.init(DelayInterval.fromString(this.targetInput.value, this.basisFields));\n\t\t}\n\t}\n\n\t#shouldShowField(field: Field): boolean\n\t{\n\t\tconst fieldType = this.fieldProperty?.Type;\n\t\tif (fieldType === 'file')\n\t\t{\n\t\t\treturn field.Type === 'file';\n\t\t}\n\t\telse if (fieldType === 'date' || fieldType === 'datetime')\n\t\t{\n\t\t\treturn field.Type === 'date' || field.Type === 'datetime';\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#onKeyDown(event: KeyboardEvent)\n\t{\n\t\tif (event.keyCode === 45 && event.altKey === false && event.ctrlKey === false && event.shiftKey === false)\n\t\t{\n\t\t\tthis.openMenu(event);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\topenMenu(event: KeyboardEvent, skipPropertiesSwitcher: boolean = false)\n\t{\n\t\tif (!skipPropertiesSwitcher && this.context.useSwitcherMenu && !this.targetInput.value)\n\t\t{\n\t\t\treturn this.openPropertiesSwitcherMenu();\n\t\t}\n\n\t\tif (this.#dialog)\n\t\t{\n\t\t\tthis.#dialog.show();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.fillGroups();\n\t\tthis.onMenuOpen();\n\n\t\tlet menuItems = [];\n\t\tfor (const group of Object.values(this.#menuGroups))\n\t\t{\n\t\t\tif (group.children.length > 0)\n\t\t\t{\n\t\t\t\tmenuItems.push(group);\n\t\t\t}\n\t\t}\n\n\t\tif (menuItems.length === 1)\n\t\t{\n\t\t\tmenuItems = menuItems[0].children;\n\t\t}\n\n\t\tlet menuId = this.menuButton.getAttribute('data-selector-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tthis.menuButton.setAttribute('data-selector-id', menuId);\n\t\t}\n\n\t\tthis.#dialog = new Dialog({\n\t\t\ttargetNode: this.menuButton,\n\t\t\twidth: 500,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\titems: this.injectDialogMenuTitles(menuItems),\n\t\t\tshowAvatars: false,\n\t\t\tevents: {\n\t\t\t\t'Item:onBeforeSelect': (event) => {\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tconst item = event.getData().item;\n\t\t\t\t\tthis.onFieldSelect(item.getCustomData().get('field'));\n\t\t\t\t}\n\t\t\t},\n\t\t\tcompactView: true,\n\t\t});\n\n\t\tthis.#dialog.show();\n\t}\n\n\tfillGroups(): void\n\t{\n\t\tthis.fillFieldsGroups();\n\t\tthis.fillFileGroup();\n\t}\n\n\tfillFieldsGroups(): void\n\t{\n\t\tthis.addGroup('ROOT', {\n\t\t\tid: 'ROOT',\n\t\t\ttitle: this.context.rootGroupTitle,\n\t\t\tsearchable: false,\n\t\t});\n\n\t\tthis.getFields().forEach((field) => {\n\t\t\tlet groupKey = field.Id.indexOf('.') < 0 ? 'ROOT' : field.Id.split('.')[0];\n\t\t\tlet groupName = '';\n\t\t\tlet fieldName = field.Name;\n\n\t\t\tif (field.Name && groupKey !== 'ROOT' && field.Name.indexOf(': ') >= 0)\n\t\t\t{\n\t\t\t\tconst names = field.Name.split(': ');\n\t\t\t\tgroupName = names.shift();\n\t\t\t\tfieldName = names.join(': ');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tfield['Id'].indexOf('ASSIGNED_BY_') === 0\n\t\t\t\t&& field['Id'] !== 'ASSIGNED_BY_ID'\n\t\t\t\t&& field['Id'] !== 'ASSIGNED_BY_PRINTABLE'\n\t\t\t)\n\t\t\t{\n\t\t\t\tgroupKey = 'ASSIGNED_BY';\n\t\t\t\tconst names = field.Name.split(' ');\n\t\t\t\tgroupName = names.shift();\n\t\t\t\tfieldName = names.join(' ').replace('(', '').replace(')', '');\n\t\t\t}\n\n\t\t\tif (!this.hasGroup(groupKey))\n\t\t\t{\n\t\t\t\tthis.addGroup(groupKey, {\n\t\t\t\t\tid: groupKey,\n\t\t\t\t\ttitle: groupName,\n\t\t\t\t\tsearchable: false,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.addGroupItem(groupKey, {\n\t\t\t\tid: field.SystemExpression,\n\t\t\t\ttitle: fieldName || field.Id,\n\t\t\t\tcustomData: {field},\n\t\t\t});\n\t\t});\n\t}\n\n\tfillFileGroup(): void\n\t{\n\t\tconst fileFields = this.getFields().filter((field) => field.Type === 'file');\n\n\t\tif (fileFields.length > 0)\n\t\t{\n\t\t\tthis.addGroup('__FILES', {\n\t\t\t\tid: '__FILES',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FILES_LINKS'),\n\t\t\t\tchildren: this.#prepareFilesMenu(fileFields),\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\t}\n\n\t#prepareFilesMenu(fileFields: Array<Field>): Array<MenuGroupItem>\n\t{\n\t\treturn fileFields.map((field) => {\n\t\t\tconst exp = (\n\t\t\t\tfield['ObjectId'] === 'Document'\n\t\t\t\t\t? '{{'+field['Name']+' > shortlink}}'\n\t\t\t\t\t: '{{~'+field['ObjectId']+':'+field['Id']+' > shortlink}}'\n\t\t\t);\n\n\t\t\tlet title = field.Name || field.Id;\n\n\t\t\tif (field.ObjectName)\n\t\t\t{\n\t\t\t\ttitle = field.ObjectName + ': ' + title;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: title,\n\t\t\t\tcustomData: {\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tId: field['Id'] + '_shortlink',\n\t\t\t\t\t\tObjectId: field['ObjectId'],\n\t\t\t\t\t\tName: field['Name'],\n\t\t\t\t\t\tType: 'string',\n\t\t\t\t\t\tExpression: exp,\n\t\t\t\t\t\tSystemExpression: '{='+field['ObjectId']+':'+field['Id']+' > shortlink}'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tid: exp,\n\t\t\t};\n\t\t});\n\t}\n\n\tonMenuOpen(): void\n\t{\n\t\tthis.emit('onOpenMenu', { selector: this });\n\t}\n\n\topenPropertiesSwitcherMenu()\n\t{\n\t\tconst self = this;\n\n\t\tMenuManager.show(\n\t\t\tHelper.generateUniqueId(),\n\t\t\tthis.menuButton,\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_CONSTANT'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.emit('onAskConstant', {fieldProperty: self.fieldProperty});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_PARAMETER'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.emit('onAskParameter', {fieldProperty: self.fieldProperty});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_ASK_MANUAL'),\n\t\t\t\t\tonclick(event) {\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\tself.openMenu(event, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 20,\n\t\t\t\tangle: { position: 'top'},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.#switcherDialog = MenuManager.currentItem;\n\n\t\treturn true;\n\t}\n\n\tinjectDialogMenuTitles(items)\n\t{\n\t\titems.forEach((parent) => {\n\t\t\tif (Type.isArray(parent.children))\n\t\t\t{\n\t\t\t\tthis.injectDialogMenuSupertitles(parent.title, parent.children);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tinjectDialogMenuSupertitles(title: string, children)\n\t{\n\t\tchildren.forEach((child) => {\n\t\t\tif (!child.supertitle)\n\t\t\t{\n\t\t\t\tchild.supertitle = title;\n\t\t\t}\n\t\t\tif (Type.isArrayFilled(child.children))\n\t\t\t{\n\t\t\t\tthis.injectDialogMenuSupertitles(child.title, child.children);\n\t\t\t}\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field): void\n\t{\n\t\tif (!field)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputType = this.targetInput.tagName.toLowerCase();\n\n\t\tif (inputType === 'select')\n\t\t{\n\t\t\tlet expressionOption = this.targetInput.querySelector('[data-role=\"expression\"]');\n\t\t\tif (!expressionOption)\n\t\t\t{\n\t\t\t\texpressionOption = (\n\t\t\t\t\tthis.targetInput.appendChild(\n\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t'option',\n\t\t\t\t\t\t\t{attrs: {'data-role': 'expression'}}\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\texpressionOption.setAttribute('value', field.Expression);\n\t\t\texpressionOption.textContent = field['Expression'];\n\n\t\t\texpressionOption.selected = true;\n\t\t}\n\t\telse if (inputType === 'label')\n\t\t{\n\t\t\tthis.targetInput.textContent = field.Expression;\n\t\t\tconst hiddenInput = document.getElementById(this.targetInput.getAttribute('for'));\n\t\t\tif (hiddenInput)\n\t\t\t{\n\t\t\t\thiddenInput.value = field.Expression;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.replaceOnWrite)\n\t\t\t{\n\t\t\t\tthis.targetInput.value = field.Expression;\n\t\t\t\tthis.targetInput.selectionEnd = this.targetInput.value.length;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst beforePart = this.targetInput.value.substr(0, this.targetInput.selectionEnd);\n\t\t\t\tconst middlePart = field.Expression;\n\t\t\t\tconst afterPart = this.targetInput.value.substr(this.targetInput.selectionEnd);\n\n\t\t\t\tthis.targetInput.value = beforePart + middlePart + afterPart;\n\t\t\t\tthis.targetInput.selectionEnd = beforePart.length + middlePart.length;\n\t\t\t}\n\t\t}\n\n\t\tBX.fireEvent(this.targetInput, 'change');\n\t\tthis.emit('change', { field });\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.#dialog)\n\t\t{\n\t\t\tthis.#dialog.destroy();\n\t\t}\n\t\tif (this.#switcherDialog)\n\t\t{\n\t\t\tthis.#switcherDialog.destroy();\n\t\t}\n\t}\n\n\tgetFields(): Array<Field>\n\t{\n\t\tconst printablePrefix = Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_PRINTABLE_PREFIX');\n\t\tconst names = this.context.fields.map(field => field.Name).join('\\n');\n\n\t\tconst fields = [];\n\t\tthis.basisFields.forEach((field) => {\n\t\t\tfield.ObjectId = 'Document';\n\n\t\t\tconst custom = (field['BaseType'] === 'string' && field['Type'] !== 'string');\n\n\t\t\tif (!custom)\n\t\t\t{\n\t\t\t\tfields.push(field);\n\t\t\t}\n\n\t\t\t//generate printable version\n\t\t\tif (\n\t\t\t\tfield['Type'] === 'user'\n\t\t\t\t||\n\t\t\t\tfield['Type'] === 'bool'\n\t\t\t\t||\n\t\t\t\tfield['Type'] === 'file'\n\t\t\t\t||\n\t\t\t\tcustom\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst printableName = field['Name'] + ' ' + printablePrefix;\n\n\t\t\t\tif (names.indexOf(printableName) < 0)\n\t\t\t\t{\n\t\t\t\t\tconst printableField = BX.clone(field);\n\t\t\t\t\tconst printableTag = (field['Type'] === 'user') ? 'friendly' : 'printable';\n\n\t\t\t\t\tprintableField['Name'] = printableName;\n\t\t\t\t\tprintableField['Type'] = 'string';\n\t\t\t\t\tprintableField['SystemExpression'] = '{=Document:'+printableField['Id']+' > '+printableTag+'}';\n\t\t\t\t\tprintableField['Expression'] = '{{'+field['Name']+' > '+printableTag+'}}';\n\n\t\t\t\t\tfields.push(printableField);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (field['BaseType'] === 'date' || field['BaseType'] === 'datetime')\n\t\t\t{\n\t\t\t\tconst serverField = BX.clone(field);\n\t\t\t\tserverField['Name'] += ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_DATE_BY_SERVER');\n\t\t\t\tserverField['Type'] = 'string';\n\t\t\t\tserverField['SystemExpression'] = `{=Document:${serverField['Id']} > server}`;\n\t\t\t\tserverField['Expression'] = `{{${field['Name']} > server}}`;\n\n\t\t\t\tfields.push(serverField);\n\n\t\t\t\tconst responsibleField = BX.clone(field);\n\t\t\t\tresponsibleField['Name'] += ' ' + Loc.getMessage('BIZPROC_AUTOMATION_CMP_MOD_DATE_BY_RESPONSIBLE');\n\t\t\t\tresponsibleField['Type'] = 'string';\n\t\t\t\tresponsibleField['SystemExpression'] = `{=Document:${serverField['Id']} > responsible}`;\n\t\t\t\tresponsibleField['Expression'] = `{{${field['Name']} > responsible}}`;\n\n\t\t\t\tfields.push(responsibleField);\n\t\t\t}\n\t\t});\n\n\t\treturn fields;\n\t}\n}","import { SelectorContext, Condition, ConditionGroup } from 'bizproc.automation';\nimport { InlineSelector } from './inline-selector';\nimport { Field } from './types';\n\nexport class InlineSelectorCondition extends InlineSelector\n{\n\t#condition: Condition;\n\n\tconstructor(props: {\n\t\tcontext: SelectorContext,\n\t\tcondition: Condition,\n\t})\n\t{\n\t\tsuper(props);\n\n\t\tthis.#condition = props.condition;\n\t}\n\n\trenderTo(target: Element)\n\t{\n\t\tthis.targetInput = target;\n\t\tthis.menuButton = target;\n\n\t\tthis.parseTargetProperties();\n\t\tthis.bindTargetEvents();\n\t}\n\n\tfillGroups(): void\n\t{\n\t\tthis.fillFieldsGroups();\n\t}\n\n\tonMenuOpen(): void\n\t{\n\t\tthis.emit('onOpenMenu', {\n\t\t\tselector: this,\n\t\t\t// TODO - rename\n\t\t\tisMixedCondition: this.#isMixedConditionGroup(),\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field)\n\t{\n\t\tthis.emit('change', { field });\n\t}\n\n\t#isMixedConditionGroup(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.#condition\n\t\t\t&& this.#condition.parentGroup\n\t\t\t&& this.#condition.parentGroup.type === ConditionGroup.CONDITION_TYPE.Mixed\n\t\t);\n\t}\n\n\tgetFields(): Array<Field>\n\t{\n\t\treturn this.context.fields.map((field) => ({\n\t\t\t...field,\n\t\t\tObjectId: 'Document',\n\t\t}));\n\t}\n}","import { Tag } from 'main.core';\nimport { Field } from './types';\nimport { InlineSelector } from './inline-selector';\n\nexport class InlineSelectorHtml extends InlineSelector\n{\n\t#editorNode: ?BXHtmlEditor;\n\t#eventHandlers = {\n\t\t'OnEditorInitedAfter': this.#bindEditorHooks.bind(this),\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#unbindEvents();\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\t\tthis.#editorNode = targetInput.querySelector('.bx-html-editor');\n\t\tthis.menuButton = Tag.render`\n\t\t\t<span\n\t\t\t\tonclick=\"${this.openMenu.bind(this)}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-dotted\"\n\t\t\t></span>\n\t\t`;\n\n\t\tthis.parseTargetProperties();\n\t\tthis.bindTargetEvents()\n\n\t\ttargetInput.firstElementChild.appendChild(this.menuButton);\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tfor (const [name, handler] of Object.entries(this.#eventHandlers))\n\t\t{\n\t\t\tBX.addCustomEvent(name, handler);\n\t\t}\n\t}\n\n\t#unbindEvents(): void\n\t{\n\t\tfor (const [name, handler] of Object.entries(this.#eventHandlers))\n\t\t{\n\t\t\tBX.removeCustomEvent(name, handler);\n\t\t}\n\t}\n\n\t#bindEditorHooks(editor): void\n\t{\n\t\tif (editor.dom.cont !== this.#editorNode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet header = '';\n\t\tlet footer = '';\n\n\t\tconst cutHeader = (content: string, shouldSaveHeader: boolean = false) => {\n\t\t\treturn content.replace(/(^[\\s\\S]*?)(<body.*?>)/i, (str) => {\n\t\t\t\tif (shouldSaveHeader)\n\t\t\t\t{\n\t\t\t\t\theader = str;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t});\n\t\t};\n\n\t\tconst cutFooter = (content: string, shouldSaveFooter: boolean = false) => {\n\t\t\treturn content.replace(/(<\\/body>[\\s\\S]*?$)/i, (str) => {\n\t\t\t\tif (shouldSaveFooter)\n\t\t\t\t{\n\t\t\t\t\tfooter = str;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t});\n\t\t}\n\n\t\tBX.addCustomEvent(editor, 'OnParse', function (mode)\n\t\t{\n\t\t\tif (!mode)\n\t\t\t{\n\t\t\t\tthis.content = cutFooter(cutHeader(this.content, true), true);\n\t\t\t}\n\t\t});\n\n\t\tBX.addCustomEvent(editor, 'OnAfterParse', function (mode)\n\t\t{\n\t\t\tif (mode)\n\t\t\t{\n\t\t\t\tlet content = cutFooter(cutHeader(this.content));\n\n\t\t\t\tif (header !== '' && footer !== '')\n\t\t\t\t{\n\t\t\t\t\tcontent = header + content + footer;\n\t\t\t\t}\n\n\t\t\t\tthis.content = content;\n\t\t\t}\n\t\t});\n\t}\n\n\tonFieldSelect(field: ?Field): void\n\t{\n\t\tconst insertText = field.Expression;\n\t\tconst editor = this.#getEditor();\n\n\t\tif (editor && editor.InsertHtml)\n\t\t{\n\t\t\tif (editor.synchro.IsFocusedOnTextarea())\n\t\t\t{\n\t\t\t\teditor.textareaView.Focus();\n\t\t\t\teditor.textareaView.WrapWith('', '', insertText);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\teditor.InsertHtml(insertText);\n\t\t\t}\n\t\t\teditor.synchro.Sync();\n\t\t}\n\t}\n\n\tonBeforeSave(): void\n\t{\n\t\tconst editor = this.#getEditor();\n\t\tif (editor && editor.SaveContent)\n\t\t{\n\t\t\teditor.SaveContent();\n\t\t}\n\t}\n\n\tonPopupResize()\n\t{\n\t\tconst editor = this.#getEditor();\n\t\tif (editor && editor.ResizeSceleton)\n\t\t{\n\t\t\teditor.ResizeSceleton();\n\t\t}\n\t}\n\n\t#getEditor(): ?BXHtmlEditor\n\t{\n\t\tif (this.#editorNode)\n\t\t{\n\t\t\tconst editorId = this.#editorNode.id.split('-');\n\t\t\treturn BXHtmlEditor.Get(editorId[editorId.length - 1]);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { SelectorContext } from 'bizproc.automation';\n\nexport class SaveStateCheckbox\n{\n\t#context: SelectorContext;\n\t#checkbox: Element;\n\t#needSync: boolean;\n\n\tconstructor(props: {\n\t\tcontext: SelectorContext,\n\t\tcheckbox: Element,\n\t\tneedSync: boolean,\n\t})\n\t{\n\t\tthis.#context = props.context;\n\t\tthis.#checkbox = props.checkbox;\n\t\tthis.#needSync = props.needSync;\n\n\t\tif (props.needSync)\n\t\t{\n\t\t\tconst category = 'save_state_checkbox';\n\t\t\tconst savedState = this.#context.get('userOptions').get(category, this.#getKey(), 'N');\n\t\t\tif (savedState === 'Y')\n\t\t\t{\n\t\t\t\tthis.#checkbox.checked = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.#needSync)\n\t\t{\n\t\t\tthis.#context.get('userOptions').set('save_state_checkboxes', this.#getKey(), this.#getValue());\n\t\t}\n\t}\n\n\t#getKey(): ?string\n\t{\n\t\treturn this.#checkbox.getAttribute('data-save-state-key');\n\t}\n\n\t#getValue(): string\n\t{\n\t\treturn this.#checkbox.checked ? 'Y'\t : 'N';\n\t}\n}","import { Type } from 'main.core';\nimport { InlineSelector } from './inline-selector';\n\nexport class UserSelector extends InlineSelector\n{\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\t\tthis.menuButton = targetInput;\n\n\t\tthis.fieldProperty = JSON.parse(targetInput.getAttribute('data-property'));\n\t\tif (!this.fieldProperty)\n\t\t{\n\t\t\tthis.context.useSwitcherMenu = false;\n\t\t}\n\n\t\tconst additionalUserFields = this.context.get('additionalUserFields');\n\t\tthis.userSelector = BX.Bizproc.UserSelector.decorateNode(\n\t\t\ttargetInput,\n\t\t\t{\n\t\t\t\tadditionalFields: Type.isArray(additionalUserFields) ? additionalUserFields : [],\n\t\t\t},\n\t\t);\n\t}\n\n\tdestroy()\n\t{\n\t\tsuper.destroy();\n\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.destroy();\n\t\t\tthis.userSelector = null;\n\t\t}\n\t}\n}","import { Type, Runtime, Tag, Dom, Event, Text, Loc } from 'main.core';\nimport { MenuManager } from 'main.popup';\nimport { SelectorContext, Helper } from 'bizproc.automation';\nimport { InlineSelector } from './inline-selector';\n\nexport class FileSelector extends InlineSelector\n{\n\tstatic TYPE = {\n\t\tNone: '',\n\t\tDisk: 'disk',\n\t\tFile: 'file',\n\t}\n\n\t#type: string = FileSelector.TYPE.None;\n\t#multiple: boolean = false;\n\t#required: boolean = false;\n\t#valueInputName: string = '';\n\t#typeInputName: string = '';\n\t#useDisk: boolean = false;\n\t#label: string = '';\n\t#labelFile: string = '';\n\t#labelDisk: string = '';\n\n\t#diskUploader: ?BX.Bizproc.Automation.DiskUploader = null;\n\n\t#diskControllerNode: ?HTMLDivElement = null;\n\t#fileItemsNode: ?HTMLSpanElement = null;\n\t#fileControllerNode: ?HTMLDivElement = null;\n\n\t#menuId: ?string;\n\n\tconstructor(props: { context: SelectorContext })\n\t{\n\t\tsuper(props);\n\n\t\tthis.context.set(\n\t\t\t'fileFields',\n\t\t\tthis.context.fields.filter(field => field.Type === 'file'),\n\t\t);\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.menu)\n\t\t{\n\t\t\tthis.menu.popupWindow.close();\n\t\t}\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput;\n\n\t\tconst selected = this.parseTargetProperties();\n\n\t\tthis.targetInput.appendChild(this.#createBaseNode());\n\t\tthis.#showTypeControlLayout(selected);\n\t\t// this.setFileFields()\n\t\t// this.createDom\n\t}\n\n\tparseTargetProperties()\n\t{\n\t\tlet config = JSON.parse(this.targetInput.getAttribute('data-config'));\n\t\tif (!Type.isPlainObject(config))\n\t\t{\n\t\t\tconfig = {};\n\t\t}\n\n\t\tthis.#type = config.type || FileSelector.TYPE.File;\n\t\tif (config.selected && !config.selected.length)\n\t\t{\n\t\t\tthis.#type = FileSelector.TYPE.None;\n\t\t}\n\n\t\tthis.#multiple = config.multiple || false;\n\t\tthis.#required = config.required || false;\n\t\tthis.#valueInputName = config.valueInputName || '';\n\t\tthis.#typeInputName = config.typeInputName || '';\n\t\tthis.#useDisk = config.useDisk || false;\n\t\tthis.#label = config.label || 'Attachment';\n\t\tthis.#labelFile = config.labelFile || 'File';\n\t\tthis.#labelDisk = config.labelDisk || 'Disk';\n\n\t\tif (config.selected && config.selected.length > 0)\n\t\t{\n\t\t\treturn Runtime.clone(config.selected);\n\t\t}\n\t}\n\n\t#createBaseNode(): HTMLDivElement\n\t{\n\t\tconst idSalt = Helper.generateUniqueId();\n\t\tlet fileRadio = null;\n\n\t\tconst fileTypeOptions = [];\n\n\t\tif (this.context.get('fileFields').length > 0)\n\t\t{\n\t\t\tfileRadio = Tag.render`\n\t\t\t\t<input\n\t\t\t\t\tid=\"type-1${idSalt}\"\n\t\t\t\t\tclass=\"bizproc-automation-popup-select-input\"\n\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\tname=\"${this.#typeInputName}\"\n\t\t\t\t\tvalue=\"${FileSelector.TYPE.File}\"\n\t\t\t\t\t${this.#type === FileSelector.TYPE.File ? 'checked' : ''}\n\t\t\t\t/>\n\t\t\t`;\n\t\t}\n\n\t\tconst diskFileRadio = Tag.render`\n\t\t\t<input\n\t\t\t\tid=\"type-2${idSalt}\"\n\t\t\t\tclass=\"bizproc-automation-popup-select-input\"\n\t\t\t\ttype=\"radio\"\n\t\t\t\tname=\"${this.#typeInputName}\"\n\t\t\t\tvalue=\"${FileSelector.TYPE.Disk}\"\n\t\t\t\t${this.#type === FileSelector.TYPE.Disk ? 'checked' : ''}\n\t\t\t/>\n\t\t`;\n\n\t\tfileTypeOptions.push(Tag.render`\n\t\t\t<span class=\"bizproc-automation-popup-settings-title\">${this.#label}:</span>\n\t\t`);\n\n\t\tif (fileRadio)\n\t\t{\n\t\t\tfileTypeOptions.push(fileRadio, Tag.render`\n\t\t\t\t<label\n\t\t\t\t\tclass=\"bizproc-automation-popup-settings-link\"\n\t\t\t\t\tfor=\"type-1${idSalt}\"\n\t\t\t\t\tonclick=\"${this.#onTypeChange.bind(this, FileSelector.TYPE.File)}\"\n\t\t\t\t>\n\t\t\t\t${this.#labelFile}\n\t\t\t\t</label>\n\t\t\t`);\n\t\t}\n\n\t\tfileTypeOptions.push(diskFileRadio, Tag.render`\n\t\t\t<label\n\t\t\t\tclass=\"bizproc-automation-popup-settings-link\"\n\t\t\t\tfor=\"type-2${idSalt}\"\n\t\t\t\tonclick=\"${this.#onTypeChange.bind(this, FileSelector.TYPE.Disk)}\"\n\t\t\t>\n\t\t\t${this.#labelDisk}\n\t\t\t</label>\n\t\t`);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-settings-block\">\n\t\t\t\t${fileTypeOptions}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#showTypeControlLayout(selected: Array): void\n\t{\n\t\tif (this.#type === FileSelector.TYPE.Disk)\n\t\t{\n\t\t\tthis.#hideFileControllerLayout();\n\t\t\tthis.#showDiskControllerLayout(selected);\n\t\t}\n\t\telse if (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tthis.#hideDiskControllerLayout();\n\t\t\tthis.#showFileControllerLayout(selected);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#hideFileControllerLayout();\n\t\t\tthis.#hideDiskControllerLayout();\n\t\t}\n\t}\n\n\t#showDiskControllerLayout(selected: Array): void\n\t{\n\t\tif (!this.#diskControllerNode)\n\t\t{\n\t\t\tthis.#diskControllerNode = Dom.create('div');\n\n\t\t\tthis.targetInput.appendChild(this.#diskControllerNode);\n\n\t\t\tconst diskUploader = this.#getDiskUploader();\n\t\t\tdiskUploader.layout(this.#diskControllerNode);\n\t\t\tdiskUploader.show(true);\n\n\t\t\tif (selected)\n\t\t\t{\n\t\t\t\tthis.addItems(selected);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.#diskControllerNode);\n\t\t}\n\t}\n\n\t#hideDiskControllerLayout(): void\n\t{\n\t\tif (this.#diskControllerNode)\n\t\t{\n\t\t\tDom.hide(this.#diskControllerNode);\n\t\t}\n\t}\n\n\t#showFileControllerLayout(selected: Array): void\n\t{\n\t\tif (!this.#fileControllerNode)\n\t\t{\n\t\t\tthis.#fileItemsNode = Dom.create('span');\n\t\t\tthis.#fileControllerNode = Dom.create('div', {children: [this.#fileItemsNode]});\n\t\t\tthis.targetInput.appendChild(this.#fileControllerNode);\n\t\t\tconst addButtonNode = Dom.create('a', {\n\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-link bizproc-automation-popup-settings-link-thin'},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_ADD')\n\t\t\t});\n\n\t\t\tthis.#fileControllerNode.appendChild(addButtonNode);\n\n\t\t\tEvent.bind(addButtonNode, 'click', this.#onFileFieldAddClick.bind(this, addButtonNode));\n\n\t\t\tif (selected)\n\t\t\t{\n\t\t\t\tthis.addItems(selected);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.#fileControllerNode);\n\t\t}\n\t}\n\n\t#hideFileControllerLayout(): void\n\t{\n\t\tif (this.#fileControllerNode)\n\t\t{\n\t\t\tDom.hide(this.#fileControllerNode);\n\t\t}\n\t}\n\n\t#getDiskUploader(): BX.Bizproc.Automation.DiskUploader\n\t{\n\t\tif (!this.#diskUploader)\n\t\t{\n\t\t\tthis.#diskUploader = BX.Bizproc.Automation.DiskUploader.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\tmsg: {\n\t\t\t\t\t\t'diskAttachFiles' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_ATTACH_FILE'),\n\t\t\t\t\t\t'diskAttachedFiles' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_ATTACHED_FILES'),\n\t\t\t\t\t\t'diskSelectFile' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_SELECT_FILE'),\n\t\t\t\t\t\t'diskSelectFileLegend' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_SELECT_FILE_LEGEND'),\n\t\t\t\t\t\t'diskUploadFile' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_UPLOAD_FILE'),\n\t\t\t\t\t\t'diskUploadFileLegend' : Loc.getMessage('BIZPROC_AUTOMATION_CMP_DISK_UPLOAD_FILE_LEGEND')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.#diskUploader.setMode(1);\n\t\t}\n\n\t\treturn this.#diskUploader;\n\t}\n\n\t#onTypeChange(newType: string): void\n\t{\n\t\tif (this.#type !== newType)\n\t\t{\n\t\t\tthis.#type = newType;\n\t\t\tthis.#showTypeControlLayout();\n\t\t}\n\t}\n\n\t#addFileItem(item)\n\t{\n\t\tif (this.#isFileItemSelected(item))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst node = this.#createFileItemNode(item);\n\t\tif (!this.#multiple)\n\t\t{\n\t\t\tDom.clean(this.#fileItemsNode)\n\t\t}\n\n\t\tthis.#fileItemsNode.appendChild(node);\n\t}\n\n\t#isFileItemSelected(item: object)\n\t{\n\t\treturn !!this.#fileItemsNode.querySelector(`[data-file-id=\"${item.id}\"]`);\n\t}\n\n\taddItems(items: Array<object>)\n\t{\n\t\tif (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tfor(const fileItem of items)\n\t\t\t{\n\t\t\t\tthis.#addFileItem(fileItem)\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis\n\t\t\t\t.#getDiskUploader()\n\t\t\t\t.setValues(\n\t\t\t\t\tFileSelector.#convertToDiskItems(items)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tstatic #convertToDiskItems(items: Array<object>)\n\t{\n\t\treturn items.map((item) => ({\n\t\t\tID: item['id'],\n\t\t\tNAME: item['name'],\n\t\t\tSIZE: item['size'],\n\t\t\tVIEW_URL: '',\n\t\t}));\n\t}\n\n\t#removeFileItem(item)\n\t{\n\t\tconst itemNode = this.#fileItemsNode.querySelector(`[data-file-id=\"${item.id}\"]`);\n\t\tif (itemNode)\n\t\t{\n\t\t\tthis.#fileItemsNode.removeChild(itemNode);\n\t\t}\n\t}\n\n\t#onFileFieldAddClick(addButtonNode, event)\n\t{\n\t\tconst self = this;\n\n\t\tif (!this.#menuId)\n\t\t{\n\t\t\tthis.#menuId = Helper.generateUniqueId();\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tthis.#menuId,\n\t\t\taddButtonNode,\n\t\t\tthis.context.get('fileFields').map((field) => ({\n\t\t\t\ttext: Text.encode(field.Name),\n\t\t\t\tfield,\n\t\t\t\tonclick(event, item)\n\t\t\t\t{\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\tself.onFieldSelect(field);\n\t\t\t\t}\n\t\t\t})),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: Dom.getPosition(addButtonNode)['width'] / 2,\n\t\t\t\tangle: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\toffset: 0,\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\t// this.#menu = MenuManager.currentItem;\n\t\tevent.preventDefault();\n\t}\n\n\tonFieldSelect(field)\n\t{\n\t\tthis.#addFileItem({\n\t\t\tid: field.Id,\n\t\t\texpression: field.Expression,\n\t\t\tname: field.Name,\n\t\t\ttype: FileSelector.TYPE.File\n\t\t});\n\t}\n\n\t#createFileItemNode(item)\n\t{\n\t\tconst itemField = this.context.get('fileFields').find(field => field.Expression === item.expression);\n\t\tconst label = itemField?.Name || '';\n\n\t\treturn Tag.render`\n\t\t\t<span\n\t\t\t\tclass=\"bizproc-automation-popup-autocomplete-item\"\n\t\t\t\tdata-file-id=\"${item.id}\"\n\t\t\t\tdata-file-expression=\"${item.expression}\"\n\t\t\t>\n\t\t\t\t<span class=\"bizproc-automation-popup-autocomplete-name\">${label}</span>\n\t\t\t\t<span\n\t\t\t\t\tclass=\"bizproc-automation-popup-autocomplete-delete\"\n\t\t\t\t\tonclick=\"${this.#removeFileItem.bind(this, item)}\"\n\t\t\t\t></span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonBeforeSave()\n\t{\n\t\tlet ids = [];\n\t\tif (this.#type === FileSelector.TYPE.Disk)\n\t\t{\n\t\t\tids = this.#getDiskUploader().getValues();\n\t\t}\n\t\telse if (this.#type === FileSelector.TYPE.File)\n\t\t{\n\t\t\tids = (\n\t\t\t\tArray.from(this.#fileItemsNode.childNodes)\n\t\t\t\t\t.map(node => node.getAttribute('data-file-expression'))\n\t\t\t\t\t.filter(id => id !== '')\n\t\t\t);\n\t\t}\n\n\t\tfor (const id of ids)\n\t\t{\n\t\t\tthis.targetInput.appendChild(Tag.render`\n\t\t\t\t<input\n\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\tname=\"${this.#valueInputName + (this.#multiple ? '[]' : '')}\"\n\t\t\t\t\tvalue=\"${id}\"\n\t\t\t\t/>\n\t\t\t`);\n\t\t}\n\t}\n}\n","import { Event, Loc } from 'main.core';\nimport { InlineSelector } from './inline-selector';\n\nexport class TimeSelector extends InlineSelector\n{\n\t#clockInstance;\n\n\tdestroy()\n\t{\n\t\tif (this.#clockInstance)\n\t\t{\n\t\t\tthis.#clockInstance.closeWnd();\n\t\t}\n\t}\n\n\trenderTo(targetInput: Element)\n\t{\n\t\tthis.targetInput = targetInput; //this.targetInput = Runtime.clone(targetInput);\n\n\t\tconst datetime = new Date();\n\t\tdatetime.setHours(0, 0, 0, 0);\n\t\tdatetime.setTime(datetime.getTime() + this.#getCurrentTime() * 1000);\n\n\t\tthis.targetInput.value = this.constructor.#formatTime(datetime);\n\n\t\tEvent.bind(targetInput, 'click', this.showClock.bind(this));\n\t}\n\n\tshowClock(): void\n\t{\n\t\tif (!this.#clockInstance)\n\t\t{\n\t\t\tthis.#clockInstance = new BX.CClockSelector({\n\t\t\t\tstart_time: this.#getCurrentTime(),\n\t\t\t\tnode: this.targetInput,\n\t\t\t\tcallback: this.#onTimeSelect.bind(this),\n\t\t\t});\n\t\t}\n\n\t\tthis.#clockInstance.Show();\n\t}\n\n\t#onTimeSelect(time): void\n\t{\n\t\tthis.targetInput.value = time;\n\t\tBX.fireEvent(this.targetInput, 'change');\n\t\tthis.#clockInstance.closeWnd();\n\t}\n\n\t#getCurrentTime(): number\n\t{\n\t\treturn this.#convertTimeToSeconds(this.targetInput.value);\n\t}\n\n\t#convertTimeToSeconds(time: string): number\n\t{\n\t\tconst timeParts = time.split(/[\\s:]+/).map(part => parseInt(part));\n\n\t\tlet [hours, minutes] = timeParts;\n\t\tif (timeParts.length === 3)\n\t\t{\n\t\t\tconst period = timeParts[2];\n\n\t\t\tif (period === 'pm' && hours < 12)\n\t\t\t{\n\t\t\t\thours += 12;\n\t\t\t}\n\t\t\telse if (period === 'am' && hours === 12)\n\t\t\t{\n\t\t\t\thours = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn hours * 3600 + minutes * 60;\n\t}\n\n\tstatic #formatTime(datetime: Date): string\n\t{\n\t\tconst getFormat = (formatId) => (\n\t\t\tBX.date.convertBitrixFormat(Loc.getMessage(formatId)).replace(/:?\\s*s/, '')\n\t\t);\n\n\t\tconst dateFormat = getFormat('FORMAT_DATE');\n\t\tconst timeFormat = getFormat('FORMAT_DATETIME').replace(dateFormat, '').trim();\n\n\t\treturn BX.date.format(timeFormat, datetime);\n\t}\n}","import { Type, Loc, Event, Dom, Text } from 'main.core';\nimport { Helper } from './helper';\nimport { DelayInterval } from './delay-interval';\nimport { MenuManager } from 'main.popup';\n\nexport class DelayIntervalSelector\n{\n\tbasisFields: Array;\n\tonchange: () => void;\n\tlabelNode;\n\tuseAfterBasis;\n\tminLimitH;\n\n\tdelay;\n\n\tconstructor(options)\n\t{\n\t\tthis.basisFields = [];\n\t\tthis.onchange = null;\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.labelNode = options.labelNode;\n\t\t\tthis.useAfterBasis = options.useAfterBasis;\n\n\t\t\tif (Type.isArray(options.basisFields))\n\t\t\t{\n\t\t\t\tthis.basisFields = options.basisFields;\n\t\t\t}\n\t\t\tthis.onchange = options.onchange;\n\t\t\tthis.minLimitM = options.minLimitM;\n\t\t}\n\t}\n\n\tinit(delay)\n\t{\n\t\tthis.delay = delay;\n\t\tthis.setLabelText();\n\t\tthis.bindLabelNode();\n\t\tthis.prepareBasisFields();\n\t}\n\n\tsetLabelText()\n\t{\n\t\tif (this.delay && this.labelNode)\n\t\t{\n\t\t\tthis.labelNode.textContent = this.delay.format(\n\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_CMP_AT_ONCE'),\n\t\t\t\tthis.basisFields\n\t\t\t);\n\t\t}\n\t}\n\n\tbindLabelNode()\n\t{\n\t\tif (this.labelNode)\n\t\t{\n\t\t\tEvent.bind(this.labelNode, 'click', BX.delegate(this.onLabelClick, this));\n\t\t}\n\t}\n\n\tonLabelClick(event)\n\t{\n\t\tthis.showDelayIntervalPopup();\n\t\tevent.preventDefault();\n\t}\n\n\tshowDelayIntervalPopup()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst form = Dom.create(\"form\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-block\" }\n\t\t});\n\n\t\tconst radioNow = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid + \"now\",\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: 'now',\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.isNow())\n\t\t{\n\t\t\tradioNow.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst labelNow = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid + \"now\"\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_BASIS_NOW' : 'BIZPROC_AUTOMATION_CMP_AT_ONCE_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tconst labelNowHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage(this.useAfterBasis ? 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP_2' : 'BIZPROC_AUTOMATION_CMP_DELAY_NOW_HELP')\n\t\t\t}\n\t\t});\n\t\tlabelNow.appendChild(labelNowHelpNode);\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioNow, labelNow]\n\t\t}));\n\n\t\tform.appendChild(this.createAfterControlNode());\n\n\t\tif (this.basisFields.length > 0)\n\t\t{\n\t\t\tform.appendChild(this.createBeforeControlNode());\n\t\t\tform.appendChild(this.createInControlNode());\n\t\t}\n\n\t\tconst workTimeRadio = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\",\n\t\t\t\tid: uid + \"worktime\",\n\t\t\t\tname: \"worktime\",\n\t\t\t\tvalue: '1',\n\t\t\t\tstyle: 'vertical-align: middle'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tchecked: delay.workTime\n\t\t\t}\n\t\t});\n\n\t\tconst workTimeHelpNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_WORKTIME_HELP_2')\n\t\t\t}\n\t\t});\n\n\t\tform.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-settings-title\" },\n\t\t\tchildren: [\n\t\t\t\tworkTimeRadio,\n\t\t\t\tDom.create(\"label\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-lbl\",\n\t\t\t\t\t\tfor: uid + \"worktime\"\n\t\t\t\t\t},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_WORK_TIME')\n\t\t\t\t}),\n\t\t\t\tworkTimeHelpNode\n\t\t\t]\n\t\t}));\n\n\t\tconst self = this;\n\t\t//init modern Help tips\n\t\tBX.UI.Hint.init(form);\n\t\tconst popup = new BX.PopupWindow(Helper.generateUniqueId(), this.labelNode, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\ttitleBar: false,\n\t\t\tangle: true,\n\t\t\toffsetLeft: 20,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: 'webform-button webform-button-create bizproc-automation-button-left',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst formData = BX.ajax.prepareForm(form);\n\t\t\t\t\t\t\tself.saveFormData(formData['data']);\n\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tif (self.fieldsMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.fieldsMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tif (self.valueTypeMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.valueTypeMenu.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tsaveFormData(formData)\n\t{\n\t\tif (formData['type'] === 'now')\n\t\t{\n\t\t\tthis.delay.setNow();\n\t\t}\n\t\telse if (formData['type'] === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tthis.delay.setType(DelayInterval.DELAY_TYPE.In);\n\t\t\tthis.delay.setValue(0);\n\t\t\tthis.delay.setValueType('i');\n\t\t\tthis.delay.setBasis(formData['basis_in']);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.delay.setType(formData['type']);\n\t\t\tthis.delay.setValue(formData['value_' + formData['type']]);\n\t\t\tthis.delay.setValueType(formData['value_type_'+formData['type']]);\n\n\t\t\tif (formData['type'] === DelayInterval.DELAY_TYPE.After)\n\t\t\t{\n\t\t\t\tif (this.useAfterBasis)\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(formData['basis_after']);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.delay.setBasis(DelayInterval.BASIS_TYPE.CurrentDateTime);\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis.minLimitM > 0\n\t\t\t\t\t&& this.delay.basis === DelayInterval.BASIS_TYPE.CurrentDateTime\n\t\t\t\t\t&& this.delay.valueType === 'i'\n\t\t\t\t\t&& this.delay.value < this.minLimitM\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('BIZPROC_AUTOMATION_DELAY_MIN_LIMIT_LABEL')\n\t\t\t\t\t});\n\t\t\t\t\tthis.delay.setValue(this.minLimitM);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.delay.setBasis(formData['basis_before']);\n\t\t\t}\n\t\t}\n\n\t\tthis.delay.setWorkTime(formData['worktime']);\n\t\tthis.setLabelText();\n\n\t\tif (this.onchange)\n\t\t{\n\t\t\tthis.onchange(this.delay);\n\t\t}\n\t}\n\n\tcreateAfterControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioAfter = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.After,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.After && delay.value > 0)\n\t\t{\n\t\t\tradioAfter.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_after',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.After && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelAfter = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_THROUGH_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_after')\n\t\t\t]\n\t\t});\n\n\t\tif (this.useAfterBasis)\n\t\t{\n\t\t\tlabelAfter.appendChild(Dom.create('span', {\n\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_AFTER')\n\t\t\t}));\n\n\t\t\tlet basisField = this.getBasisField(delay.basis, true);\n\t\t\tlet basisValue = delay.basis;\n\t\t\tif (!basisField)\n\t\t\t{\n\t\t\t\tbasisField = this.getBasisField(DelayInterval.BASIS_TYPE.CurrentDateTime, true);\n\t\t\t\tbasisValue = basisField.SystemExpression;\n\t\t\t}\n\n\t\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: \"basis_after\",\n\t\t\t\t\tvalue: basisValue\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst self = this;\n\t\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t\t},\n\t\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick(event)\n\t\t\t\t\t{\n\t\t\t\t\t\tself.onBasisClick(event, this, function(field)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t}, DelayInterval.DELAY_TYPE.After);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(beforeBasisValueNode);\n\t\t\tlabelAfter.appendChild(beforeBasisNode);\n\t\t}\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst afterHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_AFTER_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelAfter.appendChild(afterHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: { className: \"bizproc-automation-popup-select-item\" },\n\t\t\tchildren: [radioAfter, labelAfter]\n\t\t});\n\t}\n\n\tcreateBeforeControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioBefore = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.Before,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.Before)\n\t\t{\n\t\t\tradioBefore.setAttribute('checked', 'checked');\n\t\t}\n\n\t\tconst valueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'value_before',\n\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-input'\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.type === DelayInterval.DELAY_TYPE.Before && delay.value ? delay.value : (this.minLimitM || 5)\n\t\t\t}\n\t\t});\n\n\t\tconst labelBefore = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_FOR_TIME_3')\n\t\t\t\t}),\n\t\t\t\tvalueNode,\n\t\t\t\tthis.createValueTypeSelector('value_type_before'),\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-auto-width'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BEFORE_1')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst beforeBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_before\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst beforeBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t(field) => {\n\t\t\t\t\t\t\tbeforeBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tbeforeBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tDelayInterval.DELAY_TYPE.Before\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tlabelBefore.appendChild(beforeBasisValueNode);\n\t\tlabelBefore.appendChild(beforeBasisNode);\n\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst beforeHelpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_BEFORE_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelBefore.appendChild(beforeHelpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioBefore, labelBefore]\n\t\t});\n\t}\n\n\tcreateInControlNode()\n\t{\n\t\tconst delay = this.delay;\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst radioIn = Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-input\",\n\t\t\t\tid: uid,\n\t\t\t\ttype: \"radio\",\n\t\t\t\tvalue: DelayInterval.DELAY_TYPE.In,\n\t\t\t\tname: \"type\"\n\t\t\t}\n\t\t});\n\n\t\tif (delay.type === DelayInterval.DELAY_TYPE.In)\n\t\t{\n\t\t\tradioIn.setAttribute('checked', 'checked');\n\t\t}\n\n\n\t\tconst labelIn = Dom.create(\"label\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-select-wrapper\",\n\t\t\t\tfor: uid\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tattrs: {className: 'bizproc-automation-popup-settings-title'},\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_IN_TIME_2')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tlet basisField = this.getBasisField(delay.basis);\n\t\tlet basisValue = delay.basis;\n\t\tif (!basisField)\n\t\t{\n\t\t\tbasisField = this.basisFields[0];\n\t\t\tbasisValue = basisField.SystemExpression;\n\t\t}\n\n\t\tconst inBasisValueNode = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: \"hidden\",\n\t\t\t\tname: \"basis_in\",\n\t\t\t\tvalue: basisValue\n\t\t\t}\n\t\t});\n\n\t\tconst self = this;\n\t\tconst inBasisNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"bizproc-automation-popup-settings-link bizproc-automation-delay-interval-basis\"\n\t\t\t},\n\t\t\ttext: basisField ? basisField.Name : Loc.getMessage('BIZPROC_AUTOMATION_CMP_CHOOSE_DATE_FIELD'),\n\t\t\tevents: {\n\t\t\t\tclick(event)\n\t\t\t\t{\n\t\t\t\t\tself.onBasisClick(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tfield => {\n\t\t\t\t\t\t\tinBasisNode.textContent = field.Name;\n\t\t\t\t\t\t\tinBasisValueNode.value = field.SystemExpression;\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tlabelIn.appendChild(inBasisValueNode);\n\t\tlabelIn.appendChild(inBasisNode);\n\t\tif (!this.useAfterBasis)\n\t\t{\n\t\t\tconst helpNode = Dom.create('span', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"bizproc-automation-status-help bizproc-automation-status-help-right\",\n\t\t\t\t\t'data-hint': Loc.getMessage('BIZPROC_AUTOMATION_CMP_DELAY_IN_HELP')\n\t\t\t\t}\n\t\t\t});\n\t\t\tlabelIn.appendChild(helpNode);\n\t\t}\n\n\t\treturn Dom.create(\"div\", {\n\t\t\tattrs: {className: \"bizproc-automation-popup-select-item\"},\n\t\t\tchildren: [radioIn, labelIn]\n\t\t});\n\t}\n\n\tcreateValueTypeSelector(name)\n\t{\n\t\tconst delay = this.delay;\n\t\tconst labelTexts = {\n\t\t\ti: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\th: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\td: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D')\n\t\t};\n\n\t\tconst label = Dom.create('label', {\n\t\t\tattrs: {className: 'bizproc-automation-popup-settings-link'},\n\t\t\ttext: labelTexts[delay.valueType],\n\t\t});\n\n\t\tconst input = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tname: name\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: delay.valueType\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(label, 'click', this.onValueTypeSelectorClick.bind(this, label, input));\n\n\t\treturn Dom.create('span', {\n\t\t\tchildren: [label, input]\n\t\t});\n\t}\n\n\tonValueTypeSelectorClick(label, input)\n\t{\n\t\tconst uid = Helper.generateUniqueId();\n\n\t\tconst handler = function(event, item)\n\t\t{\n\t\t\tthis.popupWindow.close();\n\t\t\tinput.value = item.valueId;\n\t\t\tlabel.textContent = item.text;\n\t\t};\n\n\t\tconst menuItems = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_M'),\n\t\t\t\tvalueId: 'i',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_H'),\n\t\t\t\tvalueId: 'h',\n\t\t\t\tonclick: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_INTERVAL_D'),\n\t\t\t\tvalueId: 'd',\n\t\t\t\tonclick: handler\n\t\t\t}\n\t\t];\n\n\t\tMenuManager.show(\n\t\t\tuid,\n\t\t\tlabel,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 25,\n\t\t\t\tangle: { position: 'top'},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.valueTypeMenu = MenuManager.currentItem;\n\t}\n\n\tonBasisClick(event, labelNode, callback, delayType)\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (delayType === DelayInterval.DELAY_TYPE.After)\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\tfield: {\n\t\t\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t\t\t},\n\t\t\t\t\tonclick(event, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(item.field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (\n\t\t\t\tdelayType !== DelayInterval.DELAY_TYPE.After\n\t\t\t\t&& this.basisFields[i]['Id'].indexOf('DATE_CREATE') > -1\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Text.encode(this.basisFields[i].Name),\n\t\t\t\tfield: this.basisFields[i],\n\t\t\t\tonclick(e, item)\n\t\t\t\t{\n\t\t\t\t\tif (callback)\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(item.field || item.options.field);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tlet menuId = labelNode.getAttribute('data-menu-id');\n\t\tif (!menuId)\n\t\t{\n\t\t\tmenuId = Helper.generateUniqueId();\n\t\t\tlabelNode.setAttribute('data-menu-id', menuId);\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tmenuId,\n\t\t\tlabelNode,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (BX.pos(labelNode)['width'] / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\toverlay: { backgroundColor: 'transparent' }\n\t\t\t}\n\t\t);\n\n\t\tthis.fieldsMenu = MenuManager.currentItem;\n\t}\n\n\tgetBasisField(basis, system)\n\t{\n\t\tif (system && (basis === DelayInterval.BASIS_TYPE.CurrentDateTime || basis === DelayInterval.BASIS_TYPE.CurrentDateTimeLocal))\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_NOW'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDateTime,\n\t\t\t};\n\t\t}\n\t\tif (system && basis === DelayInterval.BASIS_TYPE.CurrentDate)\n\t\t{\n\t\t\treturn {\n\t\t\t\tName: Loc.getMessage('BIZPROC_AUTOMATION_CMP_BASIS_DATE'),\n\t\t\t\tSystemExpression: DelayInterval.BASIS_TYPE.CurrentDate,\n\t\t\t};\n\t\t}\n\n\t\tlet field = null;\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tif (basis === this.basisFields[i].SystemExpression)\n\t\t\t{\n\t\t\t\tfield = this.basisFields[i];\n\t\t\t}\n\t\t}\n\n\t\treturn field;\n\t}\n\n\tprepareBasisFields()\n\t{\n\t\tconst fields = [];\n\t\tfor (let i = 0; i < this.basisFields.length; ++i)\n\t\t{\n\t\t\tconst fld = this.basisFields[i];\n\t\t\tif (\n\t\t\t\tfld['Id'].indexOf('DATE_MODIFY') < 0\n\t\t\t\t&& fld['Id'].indexOf('EVENT_DATE') < 0\n\t\t\t\t&& fld['Id'].indexOf('BIRTHDATE') < 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tfields.push(fld);\n\t\t\t}\n\t\t}\n\n\t\tthis.basisFields = fields;\n\t}\n}","import { Type, clone } from \"main.core\";\nimport { EventEmitter, BaseEvent } from \"main.core.events\";\n\nexport class BaseContext extends EventEmitter\n{\n\t#values: Object<string, any>;\n\n\tconstructor(defaultValue: Object<string, any>)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Bizproc.Automation.Context');\n\t\tif (Type.isPlainObject(defaultValue))\n\t\t{\n\t\t\tthis.#values = defaultValue;\n\t\t}\n\t}\n\n\tclone(): this\n\t{\n\t\treturn new BaseContext(clone(this.#values));\n\t}\n\n\tgetValues(): object\n\t{\n\t\treturn this.#values;\n\t}\n\n\tset(name: string, value: any): this\n\t{\n\t\tconst isValueChanged = this.has(name);\n\t\tthis.#values[name] = value;\n\t\tthis.emit(isValueChanged ? 'valueChanged' : 'valueAdded', {name, value})\n\n\t\treturn this;\n\t}\n\n\tget(name: string): any\n\t{\n\t\treturn this.#values[name];\n\t}\n\n\thas(name: string): boolean\n\t{\n\t\treturn this.#values.hasOwnProperty(name);\n\t}\n\n\tsubsribeValueChanges(name: string, listener: (BaseEvent) => void): this\n\t{\n\t\tthis.subscribe('valueChanged', (event) => {\n\t\t\tif (event.data.name === name)\n\t\t\t{\n\t\t\t\tlistener(event);\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n}","import { Type } from 'main.core';\nimport { BaseContext } from './base-context';\nimport { Field } from '../selectors/types';\n\nexport class SelectorContext extends BaseContext\n{\n\tconstructor(props: {\n\t\tfields: Array<Field>,\n\t\tuseSwitcherMenu: boolean,\n\t\trootGroupTitle: string,\n\t})\n\t{\n\t\tsuper(props);\n\t}\n\n\tget fields(): Array<Field>\n\t{\n\t\tconst fields = this.get('fields');\n\n\t\treturn Type.isArray(fields) ? fields : [];\n\t}\n\n\tget useSwitcherMenu(): boolean\n\t{\n\t\treturn Type.isBoolean(this.get('useSwitcherMenu')) ? this.get('useSwitcherMenu') : false;\n\t}\n\n\tset useSwitcherMenu(value: boolean)\n\t{\n\t\tthis.set('useSwitcherMenu', value);\n\t}\n\n\tget rootGroupTitle(): string\n\t{\n\t\treturn this.get('rootGroupTitle') ?? '';\n\t}\n}","import { Type, Runtime } from \"main.core\";\nimport { BaseContext } from \"./base-context\";\nimport { Document, UserOptions, Tracker } from \"bizproc.automation\";\n\nexport class Context extends BaseContext\n{\n\tconstructor(props: {\n\t\tdocument: Document,\n\t\tsignedDocument: string,\n\t\tajaxUrl: string,\n\t\tavailableRobots?: Array<Object>,\n\t\tavailableTriggers?: Array<Object>,\n\t\tcanManage?: boolean,\n\t\tcanEdit?: boolean,\n\t\tuserOptions?: UserOptions,\n\t\ttracker?: Tracker,\n\n\t\tbizprocEditorUrl?: string,\n\t\tconstantsEditorUrl?: string,\n\t\tparametersEditorUrl?: string,\n\n\t\tmarketplaceRobotCategory?: string,\n\t})\n\t{\n\t\tsuper(props);\n\t}\n\n\tclone(): this\n\t{\n\t\t// TODO - clone Tracker object when the corresponding method appears\n\t\treturn (new Context(Runtime.clone(this.getValues())))\n\t\t\t.set('document', this.document.clone())\n\t\t\t.set('userOptions', this.userOptions?.clone())\n\t\t;\n\t}\n\n\tget document(): ?Document\n\t{\n\t\treturn this.get('document');\n\t}\n\n\tget signedDocument(): string\n\t{\n\t\treturn this.get('signedDocument') ?? '';\n\t}\n\n\tget ajaxUrl(): string\n\t{\n\t\treturn this.get('ajaxUrl') ?? '';\n\t}\n\n\tget availableRobots(): Array<Object>\n\t{\n\t\tconst availableRobots = this.get('availableRobots');\n\t\tif (Type.isArray(availableRobots))\n\t\t{\n\t\t\treturn availableRobots;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget availableTriggers(): Array<Object>\n\t{\n\t\tconst availableTriggers = this.get('availableTriggers');\n\t\tif (Type.isArray(availableTriggers))\n\t\t{\n\t\t\treturn availableTriggers;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tget canManage(): boolean\n\t{\n\t\tconst canManage = this.get('canManage');\n\n\t\treturn Type.isBoolean(canManage) && canManage;\n\t}\n\n\tget canEdit(): boolean\n\t{\n\t\tconst canEdit = this.get('canEdit');\n\n\t\treturn Type.isBoolean(canEdit) && canEdit;\n\t}\n\n\tget userOptions(): ?UserOptions\n\t{\n\t\treturn this.get('userOptions');\n\t}\n\n\tget tracker(): ?Tracker\n\t{\n\t\treturn this.get('tracker');\n\t}\n\n\tset tracker(tracker: Tracker)\n\t{\n\t\tthis.set('tracker', tracker);\n\t}\n\n\tget bizprocEditorUrl(): ?string\n\t{\n\t\treturn this.get('bizprocEditorUrl');\n\t}\n\n\tget constantsEditorUrl(): ?string\n\t{\n\t\treturn this.get('constantsEditorUrl');\n\t}\n\n\tget parametersEditorUrl(): ?string\n\t{\n\t\treturn this.get('parametersEditorUrl');\n\t}\n\n\tgetAvailableTrigger(code: string): ?Object\n\t{\n\t\treturn this.availableTriggers.find(trigger => trigger['CODE'] === code);\n\t}\n}","import {Loc} from 'main.core';\nimport {Guide} from 'ui.tour';\n\nexport class BeginningGuide\n{\n\t#guide: Guide;\n\n\tconstructor(options)\n\t{\n\t\tthis.#guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: options.target,\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_BEGINNING_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_BEGINNING_SUBTITLE'),\n\t\t\t\t\tarticle: '16547606',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\n\t\tthis.#guide.getPopup().setAutoHide(true);\n\t}\n\n\tstart()\n\t{\n\t\tthis.#guide.showNextStep();\n\t}\n}","import { Loc, Type, Text } from 'main.core';\nimport { Guide } from 'ui.tour';\n\nimport '../css/tourguide.css';\n\nexport class AutomationGuide\n{\n\t#isShownRobotGuide: boolean = true;\n\t#isShownTriggerGuide: boolean = true;\n\n\t#isShownSupportingRobotGuide: boolean = false;\n\n\t#showRobotGuide: boolean = false;\n\t#showTriggerGuide: boolean = false;\n\t#showSupportingRobotGuide: boolean = false;\n\n\t#guideTargets: {\n\t\ttrigger?: Element,\n\t\tsupportingRobot?: Element,\n\t\trobot?: Element,\n\t} = {};\n\n\tconstructor(options: {\n\t\tisShownRobotGuide: boolean,\n\t\tisShownTriggerGuide: boolean,\n\t})\n\t{\n\t\tif (Type.isBoolean(options.isShownRobotGuide))\n\t\t{\n\t\t\tthis.#isShownRobotGuide = options.isShownRobotGuide;\n\t\t}\n\t\tif (Type.isBoolean(options.isShownTriggerGuide))\n\t\t{\n\t\t\tthis.#isShownTriggerGuide = options.isShownTriggerGuide;\n\t\t}\n\t}\n\n\tget isShownRobotGuide(): boolean\n\t{\n\t\treturn this.#isShownRobotGuide;\n\t}\n\n\tget isShownTriggerGuide(): boolean\n\t{\n\t\treturn this.#isShownTriggerGuide;\n\t}\n\n\tsetShowRobotGuide(show: boolean, target?: Element)\n\t{\n\t\tthis.#showRobotGuide = show;\n\n\t\tif (show)\n\t\t{\n\t\t\tthis.#guideTargets['robot'] = target ?? null;\n\t\t}\n\t}\n\n\tsetShowTriggerGuide(show: boolean, target?: Element)\n\t{\n\t\tthis.#showTriggerGuide = show;\n\n\t\tif (show)\n\t\t{\n\t\t\tthis.#guideTargets['trigger'] = target ?? null;\n\t\t}\n\t}\n\n\tsetShowSupportingRobotGuide(show: boolean, target?: Element)\n\t{\n\t\tthis.#showSupportingRobotGuide = show;\n\n\t\tif (show)\n\t\t{\n\t\t\tthis.#guideTargets['supportingRobot'] = target ?? null;\n\t\t}\n\t}\n\n\t#resolveShowGuides()\n\t{\n\t\t// settings\n\t\tif (this.#isShownTriggerGuide)\n\t\t{\n\t\t\tthis.#showTriggerGuide = false;\n\t\t}\n\n\t\tif (this.#isShownSupportingRobotGuide)\n\t\t{\n\t\t\tthis.#showSupportingRobotGuide = false;\n\t\t\tthis.#isShownRobotGuide = true;\n\t\t}\n\n\t\tif (this.#isShownRobotGuide)\n\t\t{\n\t\t\tthis.#showRobotGuide = false;\n\t\t}\n\n\t\t// logic\n\t\tif (this.#showSupportingRobotGuide)\n\t\t{\n\t\t\tthis.#isShownRobotGuide = true;\n\t\t}\n\t}\n\n\t#getGuide(): ?Guide\n\t{\n\t\tlet guide = null;\n\n\t\tif (this.#showSupportingRobotGuide)\n\t\t{\n\t\t\tif (Type.isDomNode(this.#guideTargets['supportingRobot']))\n\t\t\t{\n\t\t\t\tguide = this.#getSupportingRobotGuide();\n\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t}\n\n\t\t\treturn guide;\n\t\t}\n\n\t\tif (this.#showTriggerGuide)\n\t\t{\n\t\t\tif (Type.isDomNode(this.#guideTargets['trigger']))\n\t\t\t{\n\t\t\t\tguide = this.#getTriggerGuide();\n\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t}\n\n\t\t\treturn guide;\n\t\t}\n\n\t\tif (this.#showRobotGuide)\n\t\t{\n\t\t\tif (Type.isDomNode(this.#guideTargets['robot']))\n\t\t\t{\n\t\t\t\tguide = this.#getRobotGuide();\n\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t}\n\n\t\t\treturn guide;\n\t\t}\n\n\t\treturn guide;\n\t}\n\n\tstart()\n\t{\n\t\tthis.#resolveShowGuides();\n\t\tconst guide = this.#getGuide();\n\t\tif (guide)\n\t\t{\n\t\t\tconst bindElement = guide.getCurrentStep().target;\n\t\t\tif (Type.isDomNode(bindElement) && document.body.contains(bindElement))\n\t\t\t{\n\t\t\t\tguide.showNextStep();\n\t\t\t}\n\t\t}\n\t}\n\n\t#getRobotGuide(): Guide\n\t{\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#guideTargets['robot'],\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_ROBOT_TITLE'),\n\t\t\t\t\ttext: this.constructor.#getText([\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_ROBOT_SUBTITLE_1'),\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_ROBOT_SUBTITLE_2')\n\t\t\t\t\t]),\n\t\t\t\t\tarticle: '16547618',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'onShow': () => {\n\t\t\t\t\t\t\tthis.#isShownRobotGuide = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\t}\n\n\t#getTriggerGuide(): Guide\n\t{\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#guideTargets['trigger'],\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_TRIGGER_TITLE'),\n\t\t\t\t\ttext: this.constructor.#getText([\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_TRIGGER_SUBTITLE_1'),\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_TRIGGER_SUBTITLE_2')\n\t\t\t\t\t]),\n\t\t\t\t\tarticle: '16547632',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'onShow': () => {\n\t\t\t\t\t\t\tthis.#isShownTriggerGuide = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\t}\n\n\t#getSupportingRobotGuide(): Guide\n\t{\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#guideTargets['supportingRobot'],\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_SUPPORTING_ROBOT_TITLE'),\n\t\t\t\t\ttext: this.constructor.#getText([\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_SUPPORTING_ROBOT_SUBTITLE_1'),\n\t\t\t\t\t\tLoc.getMessage('BIZPROC_AUTOMATION_TOUR_GUIDE_SUPPORTING_ROBOT_SUBTITLE_2'),\n\t\t\t\t\t]),\n\t\t\t\t\tarticle: '16547644',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t\tposition: 'top',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'onShow': () => {\n\t\t\t\t\t\t\tthis.#isShownSupportingRobotGuide = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true,\n\t\t});\n\t}\n\n\tstatic #getText(subtitles: Array): Element\n\t{\n\t\tlet text = `<ul class=\"bizproc-automation-tour-guide-list\">`;\n\n\t\tfor (const subtitle of subtitles)\n\t\t{\n\t\t\ttext += `<li class=\"bizproc-automation-tour-guide-list-item\"> ${Text.encode(subtitle)} </li>`;\n\t\t}\n\n\t\ttext += `</ul>`;\n\n\t\treturn text;\n\t}\n}","import TemplatesScheme from './templates-scheme';\nexport { TemplateScope } from './template-scope';\nexport { TriggerManager } from './trigger-manager';\nexport { Trigger } from './trigger';\nexport { Template } from './template';\nexport { Robot } from './robot';\nexport { UserOptions } from './user-options';\nexport { Document } from './document/document';\nexport { ViewMode } from './view-mode';\nexport { ConditionGroup } from './condition/condition-group';\nexport { ConditionGroupSelector } from './selectors/condition-group-selector';\nexport { Condition } from './condition/condition';\nexport { Designer } from './designer';\nexport * from './tracker/tracker';\nexport * from './workflow/types';\nexport { Manager as SelectorManager} from './selectors/manager';\nexport { InlineSelector } from './selectors/inline-selector';\nexport { InlineSelectorCondition } from './selectors/inline-selector-condition';\nexport { InlineSelectorHtml } from './selectors/inline-selector-html';\nexport { SaveStateCheckbox } from './selectors/save-state-checkbox';\nexport { UserSelector } from './selectors/user-selector';\nexport { FileSelector } from './selectors/file-selector';\nexport { TimeSelector } from './selectors/time-selector';\nexport { DelayInterval } from './delay-interval';\nexport { DelayIntervalSelector } from './delay-interval-selector';\nexport { HelpHint } from './help-hint';\nexport { SelectorContext } from './context/selector-context';\nimport { Context } from './context/context';\n\nexport { Helper } from './helper';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport './css/style.css'\n\nexport {\n\tTemplatesScheme,\n\tContext,\n}\n\nexport { BeginningGuide } from './tourguide/beginning-guide';\nexport { AutomationGuide } from './tourguide/automation-guide';\n\nlet contextInstance: ?Context;\n\nexport function getGlobalContext(): Context\n{\n\tif (contextInstance instanceof Context)\n\t{\n\t\treturn contextInstance;\n\t}\n\n\tthrow new Error('Context is not initialized yet');\n}\n\nexport function tryGetGlobalContext(): ?Context\n{\n\ttry\n\t{\n\t\treturn getGlobalContext();\n\t}\n\tcatch (error)\n\t{\n\t\treturn null;\n\t}\n}\n\nexport function setGlobalContext(context: Context): Context\n{\n\tif (context instanceof Context)\n\t{\n\t\tcontextInstance = context;\n\t}\n\telse\n\t{\n\t\tthrow new Error('Unsupported Context');\n\t}\n\n\treturn context;\n}"],"names":["TemplateScope","rawTemplateScope","DocumentType","Type","isNil","Category","Id","Status","hasCategory","isNull","TemplatesScheme","scheme","isArray","forEach","rawScope","scope","push","documentTypes","Map","set","getDocumentType","Array","from","values","documentType","documentCategories","category","getDocumentCategory","documentCategory","takenStatuses","Set","predicate","shouldBeTaken","has","getDocumentStatus","add","map","generator","ViewMode","mode","name","value","defaultValue","hasOwnProperty","getAll","includes","none","Trigger","setEventNamespace","draft","ConditionGroup","data","viewMode","clone","isPlainObject","Condition","edit","createNode","node","parentNode","replaceChild","getGlobalContext","canEdit","String","document","statusList","find","status","STATUS_ID","getStatusId","triggerName","code","getCode","trigger","availableTriggers","NAME","isString","rules","log","tracker","getTriggerLog","getId","condition","flag","userId","wrapperClass","isEdit","settingsBtn","copyBtn","Dom","create","attrs","className","text","Loc","getMessage","Event","bind","onCopyButtonClick","getLogStatus","TrackingStatus","COMPLETED","getPreviousStatusIdList","getName","containerClass","div","children","registerItem","deleteBtn","onDeleteButtonClick","appendChild","onSettingsButtonClick","button","HelpHint","showNoPermissionsHint","isManage","emit","event","stopPropagation","initData","serialize","init","query","getData","queryString","match","toLowerCase","indexOf","object","onbxdragstart","BX","proxy","dragStart","onbxdrag","dragMove","onbxdragstop","dragStop","onbxdraghover","dragOver","jsDD","registerObject","registerDest","undefined","unregisterObject","unregisterDest","proxy_context","stopCurrentDrag","itemWidth","offsetWidth","cloneNode","style","position","classList","width","body","x","y","left","top","destination","remove","type","getAttribute","querySelector","window","isCopy","ctrlKey","metaKey","copyTrigger","parent","statusId","thisColumn","insertBefore","moveTo","skipInsert","removeChild","APPLY_RULES","items","length","triggerData","RETURN","EventEmitter","querySelectorAll","element","bindToNode","showHint","hideHint","popupHint","bindElement","isSameNode","rawText","Text","encode","util","nl2br","isStringFilled","PopupWindow","lightShadow","autoHide","darkMode","offsetLeft","offsetTop","bindOptions","events","onPopupClose","destroy","content","html","setAngle","offset","show","showAngleHint","timeout","clearTimeout","UI","Hint","createInstance","popupParameters","height","closeByEsc","angle","getPosition","close","hide","setTimeout","Helper","JSON","stringify","i","v","fields","field","Designer","dialog","robotSettingsDialog","robot","triggerSettingsDialog","TriggerManager","triggersContainerNode","isNone","TRIGGERS","initTriggers","markModified","columnNode","addCustomEvent","onRestAppInstall","clean","subscribeTriggerEvents","insertTriggerNode","subscribe","openTriggerSettingsDialog","deleteTrigger","onSearch","manage","deleteButtons","addClass","removeClass","callback","call","markDeleted","splice","unregisterItem","documentStatus","triggerNode","listNode","filter","deleted","get","modified","context","getInstance","getTriggerSettingsDialog","changeTrigger","popup","formName","form","props","renderConditionSettings","iconHelp","click","title","getTriggerName","getAvailableTrigger","getApplyRules","getRandom","hookLinkTextarea","placeholder","readonly","e","select","url","location","protocol","host","Uri","addParam","replace","getRawType","item","onCustomEvent","canSetExecuteBy","renderExecuteByControl","renderAllowBackwardsControl","setTriggerSettingsDialog","triggerManager","self","generateUniqueId","titleBar","closeIcon","draggable","restrict","overlay","destroySettingsDialogControls","buttons","PopupWindowButton","formData","ajax","prepareForm","setName","setApplyRules","form_id","STATUS","LINE_NUMBER","config_id","setConditionSettingsFromForm","setAllowBackwards","setExecuteBy","runAction","analyticsLabel","reInit","popupWindow","PopupWindowButtonLink","conditionGroup","getCondition","conditionSelector","ConditionGroupSelector","getFields","selector","Bizproc","FieldType","renderControl","getResponsibleUserExpression","getExecuteBy","checked","isBackwardsAllowed","createTextNode","formFields","setCondition","createFromForm","installed","eventResult","redirect","method","dataType","ajaxUrl","ajax_action","document_signed","signedDocument","onsuccess","response","settingsDialogControls","controlNodes","control","role","UserSelector","decorateNode","isFunction","result","exists","triggers","getListByDocumentStatus","getReturnProperties","property","ObjectId","Name","ObjectName","Expression","SystemExpression","propertyId","properties","Document","options","rawDocumentType","documentId","categoryId","findIndex","documentFields","Runtime","getCurrentStatusId","index","slice","newStatusId","isArrayFilled","DelayInterval","params","BASIS_TYPE","CurrentDateTime","DELAY_TYPE","After","setType","setValue","setValueType","setBasis","setWorkTime","setLocalTime","valueType","basis","workTime","localTime","Before","In","parseInt","basisFields","workerExpression","CurrentDate","isSystemBasis","s","isNow","days","hours","minutes","fn","worker","emptyText","str","prefix","getFormattedPeriodLabel","fieldSuffix","label","labelIndex","labels","getPeriodLabels","CurrentDateTimeLocal","intervalString","toString","h","d","substring","fnArgs","split","trim","re","exec","found","period","WorkflowStatus","TrackingEntry","TRIGGER_ACTIVITY_TYPE","entryType","getAllActivityTypes","entryWorkflowStatus","getAllWorkflowStatuses","UNKNOWN_ACTIVITY_TYPE","EXECUTE_ACTIVITY_TYPE","CLOSE_ACTIVITY_TYPE","CANCEL_ACTIVITY_TYPE","FAULT_ACTIVITY_TYPE","CUSTOM_ACTIVITY_TYPE","REPORT_ACTIVITY_TYPE","ATTACHED_ENTITY_TYPE","ERROR_ACTIVITY_TYPE","DEBUG_ACTIVITY_TYPE","DEBUG_AUTOMATION_TYPE","DEBUG_DESIGNER_TYPE","DEBUG_LINK_TYPE","typeId","CREATED","RUNNING","SUSPENDED","TERMINATED","RobotEntry","entries","WAITING","entry","addEntry","id","datetime","workflowStatus","errors","note","notes","TriggerEntry","isTriggerEntry","TrackingEntryBuilder","workflowId","logEntry","Object","assign","isNumber","isKnownActivityType","isKnownWorkflowStatus","Tracker","addLogs","logEntryBuilder","rawEntry","setLogEntry","build","addTriggerEntry","addRobotEntry","robotEntry","isRobotRunning","isWorkflowCompleted","isCurrentStatus","isRobotRunningAtAnotherStatus","isRobotRunningAndCurrentWorkflowCompleted","documentSigned","DATA","LOG","Robot","template","isFrameMode","clonedRobot","robotData","generateName","Delay","getDelayInterval","other","CONDITION_TYPE","Mixed","Properties","getProperties","getRobotLog","DelayName","hasClass","isActive","setProperty","deleteButton","onclick","getProperty","isSelected","selectNode","unselectNode","targetLabel","targetNode","isView","viewData","responsibleLabel","labelText","robots","getReturnFieldsDescription","getTitle","textContent","setAttribute","responsibleUrl","href","responsibleId","delayLabel","format","isExecuteAfterPrevious","delayNode","statusNode","subscribeOnce","isBindedToNode","delayNotes","getDelayNotes","join","AUTOCOMPLETED","getLogErrors","titleClassName","clipTitle","onTitleEditClick","lastChild","deleteRobot","openRobotSettingsDialog","DialogContext","copiedRobot","robotTitle","newTitle","Template","copyRobotTo","getNextRobot","preventDefault","nameNode","elements","fullTitle","arrTitle","lastWord","delay","ExecuteAfterPrevious","draggableItem","stub","droppableItem","droppableColumn","templateNode","beforeRobot","insertRobot","insertRobotNode","getDescriptionTitle","description","getRobotDescription","isObject","hasReturnProperties","hasAdditionalResultProperties","some","addProperty","fieldId","appendPropertyMods","printableTag","Options","expression","usages","Constant","Variable","Parameter","GlobalConstant","GlobalVariable","Activity","collectExpressions","conditions","collectParsedExpressions","systemExpressionRegExp","RegExp","SYSTEM_EXPRESSION_PATTERN","groups","parsedUsage","activityRegExp","collectUsages","objectsData","getConstants","getVariables","globalConstants","globalVariables","getParameters","getSerializedRobots","size","source","key","searchInSource","getRobotById","getReturnProperty","Math","random","UserOptions","storedValue","userOptions","save","constants","variables","templateContainerNode","delayMinLimitM","CONSTANTS","PARAMETERS","VARIABLES","markExternalModified","fromRaw","DOCUMENT_STATUS","initRobots","initButtons","isExternalModified","ROBOTS","selectedRobots","serialized","ID","isNaN","createExternalLocker","getTemplateId","createConstantsEditButton","createParametersEditButton","createExternalEditTemplateButton","createManageModeButton","enableManageMode","disableManageMode","bizprocEditorUrl","anchor","onExternalEditTemplateButtonClick","target","canManage","manageButton","cursor","onManageModeButtonClick","manageButtonNode","constantsEditorUrl","parametersEditorUrl","onUnsetExternalModifiedClick","onExternalModifiedSearch","InfoHelper","templateId","openBizprocEditor","intoRaw","Title","parentRobot","isEqual","robotNode","beforeNode","saveCallback","getRobotSettingsDialog","changeRobot","setRobotSettingsDialog","renderDelaySettings","hasBrokenLink","renderBrokenLinkAlert","getCategoryId","document_status","robot_json","toJsonString","form_name","dialogRows","showRobotSettingsPopup","popupMinWidth","popupWidth","initRobotSettingsControls","hasTitle","me","resizable","minWidth","minHeight","destroyRobotSettingsControls","onPopupResize","onResizeRobotSettings","onPopupResizeEnd","getWidth","isNewRobot","saveRobotSettings","delegate","buttonNode","robotSettingsControls","initRobotSettingsControl","controlNode","controlProps","SelectorContext","useSwitcherMenu","rootGroupTitle","needSync","checkbox","SelectorManager","SELECTOR_ROLE_USER","fieldProperty","parse","SELECTOR_ROLE_FILE","createSelectorByRole","SELECTOR_ROLE_SAVE_STATE","renderTo","onFieldSelect","addConstant","addParameter","onOpenMenu","onBeforeSave","idSalt","delayTypeNode","delayValueNode","delayValueTypeNode","delayBasisNode","delayWorkTimeNode","delayIntervalLabelNode","docFields","minLimitM","delayIntervalSelector","DelayIntervalSelector","labelNode","onchange","useAfterBasis","executeAfterPreviousBlock","hasTemplate","executeAfterPreviousCheckbox","setDelayInterval","setExecuteAfterPrevious","onOpenFieldMenu","alert","message","display","btnNode","onBeforeSaveRobotSettings","form_data_json","form_data","SUCCESS","updateData","setDelaySettingsFromForm","ERRORS","externalModified","keys","constant","generatePropertyId","getConstant","Description","param","parameter","getParameter","variable","existsList","robotUsages","usage","eventName","listener","unsubscribe","availableRobots","dstTemplate","copyTo","additionalFields","_classPrivateMethodGet","flat","ask","tabs","sort","skipRobot","isMixedCondition","isBoolean","robotMenuItems","customData","addGroup","skipId","templateRobot","hasReturnFields","group","parentGroup","setObject","setField","setOperator","operator","Field","addItem","clonedGroup","joiner","clonedCondition","itemsArray","JOINER","And","Or","ConditionSelector","fieldPrefix","conditionObjectNode","objectNode","conditionFieldNode","fieldNode","conditionOperatorNode","operatorNode","conditionValueNode","valueNode","conditionJoinerNode","joinerNode","setLabelText","bindLabelNode","removeButtonNode","removeCondition","joinerButtonNode","changeJoiner","getField","valueLabel","formatValuePrintable","getOperatorLabel","onLabelClick","showPopup","filterFields","objectSelect","fieldSelect","fieldSelectLabel","onFieldSelectorClick","selectedField","valueInput","createValueNode","valueWrapper","operatorSelect","createOperatorNode","operatorWrapper","onFieldChange","backgroundColor","firstChild","updateValueNode","fieldDialog","globalContext","InlineSelectorCondition","fireEvent","openMenu","conditionWrapper","onOperatorChange","component","tpl","getTemplate","getGVariable","foundRobot","fieldType","multiple","list","getOperators","filtered","docField","docType","Multiple","valueNodes","renderControlPublic","dataset","operatorList","operatorId","btn","conditionNodes","getItems","Manager","selectorProps","FileSelector","SELECTOR_ROLE_INLINE","InlineSelector","SELECTOR_ROLE_INLINE_HTML","InlineSelectorHtml","SELECTOR_ROLE_TIME","TimeSelector","SaveStateCheckbox","groupId","hasGroup","targetInput","menuButton","Tag","render","parseTargetProperties","replaceOnWrite","renderWith","propertyType","skipPropertiesSwitcher","openPropertiesSwitcherMenu","fillGroups","onMenuOpen","menuItems","menuId","Dialog","dropdownMode","enableSearch","injectDialogMenuTitles","showAvatars","getCustomData","compactView","fillFieldsGroups","fillFileGroup","searchable","groupKey","groupName","fieldName","names","shift","addGroupItem","fileFields","MenuManager","currentItem","injectDialogMenuSupertitles","child","supertitle","inputType","tagName","expressionOption","selected","hiddenInput","getElementById","selectionEnd","beforePart","substr","middlePart","afterPart","printablePrefix","custom","printableName","printableField","serverField","responsibleField","childGroup","entityId","toExpression","fromString","keyCode","altKey","shiftKey","exp","bindTargetEvents","firstElementChild","insertText","editor","InsertHtml","synchro","IsFocusedOnTextarea","textareaView","Focus","WrapWith","Sync","SaveContent","ResizeSceleton","handler","removeCustomEvent","dom","cont","header","footer","cutHeader","shouldSaveHeader","cutFooter","shouldSaveFooter","editorId","BXHtmlEditor","Get","savedState","additionalUserFields","userSelector","TYPE","None","menu","config","File","required","valueInputName","typeInputName","useDisk","labelFile","labelDisk","fileItem","setValues","ids","Disk","getValues","childNodes","fileRadio","fileTypeOptions","diskFileRadio","diskUploader","layout","addItems","addButtonNode","Automation","DiskUploader","msg","setMode","newType","SIZE","VIEW_URL","itemNode","itemField","closeWnd","Date","setHours","setTime","getTime","constructor","showClock","CClockSelector","start_time","Show","time","timeParts","part","getFormat","formatId","date","convertBitrixFormat","dateFormat","timeFormat","prepareBasisFields","showDelayIntervalPopup","uid","radioNow","labelNow","labelNowHelpNode","createAfterControlNode","createBeforeControlNode","createInControlNode","workTimeRadio","workTimeHelpNode","saveFormData","fieldsMenu","valueTypeMenu","setNow","Notification","Center","notify","radioAfter","labelAfter","createValueTypeSelector","basisField","getBasisField","basisValue","beforeBasisValueNode","beforeBasisNode","onBasisClick","afterHelpNode","radioBefore","labelBefore","beforeHelpNode","radioIn","labelIn","inBasisValueNode","inBasisNode","helpNode","labelTexts","input","onValueTypeSelectorClick","valueId","delayType","delimiter","pos","system","fld","BaseContext","isValueChanged","Context","BeginningGuide","Guide","steps","article","bottom","color","onEvents","getPopup","setAutoHide","showNextStep","AutomationGuide","isShownRobotGuide","isShownTriggerGuide","guide","getCurrentStep","isDomNode","contains","subtitles","subtitle","contextInstance","Error","tryGetGlobalContext","error","setGlobalContext"],"mappings":"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"}