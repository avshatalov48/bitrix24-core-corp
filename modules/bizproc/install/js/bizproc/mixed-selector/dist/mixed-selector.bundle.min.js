this.BX=this.BX||{};(function(e,t,i,a){"use strict";var r,s,n;function l(e,t){o(e,t);t.add(e)}function o(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function u(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var h=new WeakSet;var c=new WeakSet;var d=new WeakSet;var b=new WeakSet;var p=new WeakSet;var m=new WeakSet;var f=function(e){babelHelpers.inherits(i,e);function i(e){var a;babelHelpers.classCallCheck(this,i);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));l(babelHelpers.assertThisInitialized(a),m);l(babelHelpers.assertThisInitialized(a),p);l(babelHelpers.assertThisInitialized(a),b);l(babelHelpers.assertThisInitialized(a),d);l(babelHelpers.assertThisInitialized(a),c);l(babelHelpers.assertThisInitialized(a),h);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"targetNode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"tabs",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"template",[]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"activityName","");babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"maxWidth",300);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"maxHeight",500);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"minWidth",100);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"minHeight",60);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"objectName","mixed_selector[object]");babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"fieldName","mixed_selector[field]");babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"checkActivityChildren",true);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"map",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"menuItems",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"menuTargetNode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"menuId",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"objectInputNode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"fieldInputNode",null);a.setEventNamespace("BX.Bizproc.MixedSelector.BpMixedSelector");var r=t.Type.isPlainObject(e)?e:{};a.setTargetNode(r.targetNode);a.setObjectTabs(r.objectTabs);a.setTemplate(r.template);a.setActivityName(r.activityName);a.setSize(r.size);a.setInputNames(r.inputNames);a.setTargetTitle(r.targetTitle);a.setCheckActivityChildren(r.checkActivityChildren);return a}babelHelpers.createClass(i,[{key:"setTargetNode",value:function e(i){if(t.Type.isDomNode(i)){this.targetNode=i}}},{key:"getTargetNode",value:function e(){return this.targetNode}},{key:"setObjectTabs",value:function e(i){if(t.Type.isPlainObject(i)){this.tabs=i}}},{key:"getObjectTabs",value:function e(){return this.tabs}},{key:"setTemplate",value:function e(i){if(t.Type.isArrayFilled(i)){this.template=i}}},{key:"getTemplate",value:function e(){return this.template}},{key:"setActivityName",value:function e(i){if(t.Type.isStringFilled(i)){this.activityName=i}}},{key:"getActivityName",value:function e(){return this.activityName}},{key:"setSize",value:function e(i){if(!t.Type.isPlainObject(i)){return}if(t.Type.isNumber(i.maxWidth)){this.maxWidth=i.maxWidth}if(t.Type.isNumber(i.minWidth)){this.minWidth=i.minWidth}if(t.Type.isNumber(i.maxHeight)){this.maxHeight=i.maxHeight}if(t.Type.isNumber(i.minHeight)){this.minHeight=i.minHeight}}},{key:"getSize",value:function e(){return{maxWidth:this.maxWidth,minWidth:this.minWidth,maxHeight:this.maxHeight,minHeight:this.minHeight}}},{key:"setInputNames",value:function e(i){if(!t.Type.isPlainObject(i)){return}if(t.Type.isStringFilled(i.object)){this.objectName=i.object}if(t.Type.isStringFilled(i.field)){this.fieldName=i.field}}},{key:"getInputNames",value:function e(){return{object:this.objectName,field:this.fieldName}}},{key:"setTargetTitle",value:function e(i){if(t.Type.isStringFilled(i)){this.targetTitle=i;return}this.targetTitle=t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_CHOOSE_TARGET")}},{key:"getTargetTitle",value:function e(){return this.targetTitle}},{key:"setCheckActivityChildren",value:function e(i){if(t.Type.isBoolean(i)){this.checkActivityChildren=i}}},{key:"getCheckActivityChildren",value:function e(){return this.checkActivityChildren}},{key:"getMenu",value:function e(){var i=this;if(this.menuId){return a.MenuManager.getMenuById(this.menuId)}this.menuId=BX.util.getRandomString();var r=this.getSize();return a.MenuManager.create(i.menuId,i.getMenuTargetNode(),i.getMenuItems(),{zIndex:200,autoHide:true,offsetLeft:t.Dom.getPosition(i.getMenuTargetNode())["width"]/2,angle:{position:"top",offset:0},maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:r.minHeight})}},{key:"getMenuTargetNode",value:function e(){return this.menuTargetNode}},{key:"getMenuItems",value:function e(){if(this.menuItems){return this.menuItems}this.menuItems=[];u(this,h,v).call(this);return this.menuItems}},{key:"getMenuItemsByTabName",value:function e(t){var i=this.getMenuItems();for(var a in i){if(i[a].tabName===t){return i[a].items}}return[]}},{key:"renderMixedSelector",value:function e(){var i=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<a href="#">',"</a>"])),BX.util.htmlspecialchars(this.getTargetTitle()));this.menuTargetNode=i;t.Event.bind(i,"click",u(this,m,I).bind(this));var a=t.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<input \n\t\t\t\ttype="hidden" \n\t\t\t\tname="','" \n\t\t\t\tdata-role="mixed-selector-object"\n\t\t\t\tvalue=""\n\t\t\t>\n\t\t'])),this.objectName);this.objectInputNode=a;var l=t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<input \n\t\t\t\ttype="hidden" \n\t\t\t\tname="','" \n\t\t\t\tdata-role="mixed-selector-field"\n\t\t\t\tvalue=""\n\t\t\t>\n\t\t'])),this.fieldName);this.fieldInputNode=l;t.Dom.append(i,this.targetNode);t.Dom.append(a,this.targetNode);t.Dom.append(l,this.targetNode)}},{key:"getSelectedObjectValue",value:function e(){if(this.objectInputNode){return this.objectInputNode.value}return null}},{key:"getSelectedFieldValue",value:function e(){if(this.fieldInputNode){return this.fieldInputNode.value}return null}},{key:"setSelectedObjectAndField",value:function e(a,r,s){var n=this.getMenuTargetNode();var l=i.getAvailableTabsLocMessages();if(i.getAvailableTabsName().includes(a)){n.innerText=l[a]+": "+s}else{n.innerText=l["Activity"]+": "+s}if(t.Type.isStringFilled(a)&&t.Type.isStringFilled(r)){this.objectInputNode.value=a;this.fieldInputNode.value=r}}}],[{key:"getAvailableTabsName",value:function e(){return["Parameter","Variable","Constant","GlobalConst","GlobalVar","Document","Activity"]}},{key:"getAvailableTabsLocMessages",value:function e(){return{Parameter:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_PARAMETER"),Variable:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_VARIABLE"),Constant:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_CONSTANT"),GlobalConst:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_GLOBAL_CONSTANT"),GlobalVar:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_GLOBAL_VARIABLE"),Document:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_DOCUMENT_FIELDS"),Activity:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_ADDITIONAL_RESULT")}}}]);return i}(i.EventEmitter);function v(){var e=this;var i=this;var a=u(this,c,T).call(this);var r=f.getAvailableTabsLocMessages();var s=BX.util.object_keys(a);var n=function n(){if(s[l]!=="Activity"){e.menuItems.push({text:r[s[l]],items:u(e,d,g).call(e,a[s[l]],s[l]),tabName:s[l]})}else{var o=u(e,b,y).call(e,e.template,a[s[l]]);var h=[];o.forEach((function(e){if(!t.Type.isArrayFilled(e)){return}var a=[];e.forEach((function(e){if(!t.Type.isStringFilled(e.description)){return}a.push({text:t.Text.encode(e.text+" ("+e.description+")"),object:e.object,field:e.field,property:e,onclick:u(i,p,N).bind(i)})}));if(t.Type.isArrayFilled(a)){h.push({text:e[0].description,object:e[0].object,items:a})}}));if(t.Type.isArrayFilled(h)){e.menuItems.push({text:r[s[l]],items:h,tabName:"Activity"})}}};for(var l in s){n()}}function T(){if(this.map){return this.map}this.map={};var e=f.getAvailableTabsName();var t=Object.keys(this.tabs);for(var i in t){if(e.includes(t[i])&&Object.keys(this.tabs[t[i]]).length>0){this.map[t[i]]=this.tabs[t[i]]}}if(this.template.length<0){if(this.map["Activity"]){delete this.map["Activity"]}}return this.map}function g(e,t){var i=[];var a=Object.keys(e);for(var r in a){i.push({text:BX.util.htmlspecialchars(e[a[r]].Name),object:t,field:a[r],property:e[a[r]],onclick:u(this,p,N).bind(this)})}return i}function y(e,i){var a=this;var r=[];var s=function s(n){var l;if(e[n].Name===a.activityName&&!a.checkActivityChildren){return"continue"}var o=e[n].Type.toLowerCase();var h=(l=i[o])!==null&&l!==void 0?l:{};var c=h["RETURN"];var d=h["ADDITIONAL_RESULT"];if(c){var p=Object.keys(c);var m=[];for(var f in p){m.push({text:c[p[f]].NAME,description:e[n].Properties.Title||h.NAME,value:"{="+e[n].Name+":"+p[f]+"}",object:e[n].Name,field:p[f],property:{Name:c[p[f]].NAME,Type:c[p[f]].TYPE}})}if(m.length>0){r.push(m)}}else if(t.Type.isArray(d)){var v=e[n]["Properties"];d.forEach((function(t){if(v[t]){var i=Object.keys(v[t]);var a=[];for(var s in i){var l=v[t][i[s]];a.push({text:l.Name,description:v["Title"]||h["NAME"],value:"{="+e[n]["Name"]+":"+i[s]+"}",object:e[n]["Name"],field:i[s],property:l})}if(a.length>0){r.push(a)}}}),a)}if(e[n]["Children"]&&e[n]["Children"].length>0){var T=u(a,b,y).call(a,e[n]["Children"],i);r=r.concat(T)}};for(var n=0,l=e.length;n<l;++n){var o=s(n);if(o==="continue")continue}return r}function N(e,t){var a=this.getMenu();a.close();this.setSelectedObjectAndField(t.object,t.field,t.text);i.EventEmitter.emit(this,"onSelect",{item:t})}function I(e){var t=this.getMenu();t.show();e.preventDefault()}var H={BpMixedSelector:f};e.MixedSelector=H;e.BpMixedSelector=f})(this.BX.Bizproc=this.BX.Bizproc||{},BX,BX.Event,BX.Main);
//# sourceMappingURL=mixed-selector.bundle.map.js