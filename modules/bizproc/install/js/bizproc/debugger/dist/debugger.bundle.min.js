this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,s,t,a,i,l,r,o,n,d,c,b,u,p,v,g,h,P,L){"use strict";class F{}F.Run=0;F.NextStep=1;F.Stop=2;F.Pause=3;F.Undefined=-1;class B{static isNumeric(e){if(P.Type.isNumber(e)){return true}if(!P.Type.isStringFilled(e)){return false}return Number(e).toString()===e.trim()}static isDate(e){if(P.Type.isDate(e)){return true}if(!B.isNumeric(e)){return false}return new Date(Number(e)).getTime()===Number(e)}static convertDateFromDB(e){if(!B.isNumeric(e)){return null}return new Date(e*1e3)}static toDate(e){if(Date.parse(e)){return new Date(e)}if(!B.isDate(e)){return null}if(P.Type.isDate(e)){return e}return B.convertDateFromDB(e)}static formatDate(e,s){if(!P.Type.isStringFilled(e)){e="j F Y H:i:s"}return n.DateTimeFormat.format(e,s)}static getOperatorsLabel(){return{"!empty":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_EMPTY"),empty:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_EMPTY"),"=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_EQ"),"!=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NE"),in:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_IN"),"!in":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_IN"),contain:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_CONTAIN"),"!contain":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_CONTAIN"),">":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_GT"),">=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_GTE"),"<":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_LT"),"<=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_LTE")}}static getOperatorLabel(e){return B.getOperatorsLabel()[e]}static getJoinerLabel(e){const s={AND:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_AND"),OR:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_OR")};return s[e]}static getColorBrightness(e){if(e[0]==="#"){e=e.replace("#","")}const s=parseInt(e,16);const t=s>>16&255;const a=s>>8&255;const i=s&255;return.21*t+.72*a+.07*i}static getBgColorAdditionalClass(e){const s=B.getColorBrightness(e);if(s>224){return"--with-border --light-color"}if(s>145){return"--light-color"}return""}static toHtml(e){return P.Text.encode(e||"").replace(/\[(\/)?b\]/gi,"<$1b>")}}let H=e=>e,f,m,_,y,T,O,E,I,w,S,D;var C=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var R=babelHelpers.classPrivateFieldLooseKey("popupInstance");var N=babelHelpers.classPrivateFieldLooseKey("loaded");var A=babelHelpers.classPrivateFieldLooseKey("node");var x=babelHelpers.classPrivateFieldLooseKey("triggerManager");var G=babelHelpers.classPrivateFieldLooseKey("template");var j=babelHelpers.classPrivateFieldLooseKey("tracker");var K=babelHelpers.classPrivateFieldLooseKey("tabs");var M=babelHelpers.classPrivateFieldLooseKey("expandedMinWidth");var k=babelHelpers.classPrivateFieldLooseKey("expandedMinHeight");var z=babelHelpers.classPrivateFieldLooseKey("collapsedMinWidth");var $=babelHelpers.classPrivateFieldLooseKey("collapsedMinHeight");var U=babelHelpers.classPrivateFieldLooseKey("changingViewTimeout");var V=babelHelpers.classPrivateFieldLooseKey("buttonPlay");var J=babelHelpers.classPrivateFieldLooseKey("getPopup");var Z=babelHelpers.classPrivateFieldLooseKey("getPopupWidth");var W=babelHelpers.classPrivateFieldLooseKey("getPopupHeight");var X=babelHelpers.classPrivateFieldLooseKey("getPopupTitleBar");var Y=babelHelpers.classPrivateFieldLooseKey("handleCollapse");var q=babelHelpers.classPrivateFieldLooseKey("handleClose");var Q=babelHelpers.classPrivateFieldLooseKey("getNode");var ee=babelHelpers.classPrivateFieldLooseKey("renderExpandedMode");var se=babelHelpers.classPrivateFieldLooseKey("renderCollapsedMode");var te=babelHelpers.classPrivateFieldLooseKey("getAddFieldNode");var ae=babelHelpers.classPrivateFieldLooseKey("getFieldListNode");var ie=babelHelpers.classPrivateFieldLooseKey("handleChangeTab");var le=babelHelpers.classPrivateFieldLooseKey("handleAddDocFieldMenu");var re=babelHelpers.classPrivateFieldLooseKey("handleAddField");var oe=babelHelpers.classPrivateFieldLooseKey("handleRemoveField");var ne=babelHelpers.classPrivateFieldLooseKey("handleFieldListChange");var de=babelHelpers.classPrivateFieldLooseKey("getFieldNode");var ce=babelHelpers.classPrivateFieldLooseKey("createTriggersHeaderNode");var be=babelHelpers.classPrivateFieldLooseKey("createTriggersNode");var ue=babelHelpers.classPrivateFieldLooseKey("createTemplateNode");var pe=babelHelpers.classPrivateFieldLooseKey("updateTemplate");var ve=babelHelpers.classPrivateFieldLooseKey("createTemplateToolbar");var ge=babelHelpers.classPrivateFieldLooseKey("handleStartTemplate");var he=babelHelpers.classPrivateFieldLooseKey("handleEmulateExternalEvent");var Pe=babelHelpers.classPrivateFieldLooseKey("updateTracker");var Le=babelHelpers.classPrivateFieldLooseKey("createStageNode");var Fe=babelHelpers.classPrivateFieldLooseKey("handleShowStages");var Be=babelHelpers.classPrivateFieldLooseKey("handleChangeStatus");var He=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusTitle");var fe=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusColor");var me=babelHelpers.classPrivateFieldLooseKey("onDocumentStatusChanged");var _e=babelHelpers.classPrivateFieldLooseKey("onWorkflowEventsChanged");var ye=babelHelpers.classPrivateFieldLooseKey("onWorkflowTrackAdded");var Te=babelHelpers.classPrivateFieldLooseKey("onDocumentValuesUpdated");var Oe=babelHelpers.classPrivateFieldLooseKey("onWorkflowStatusChange");var Ee=babelHelpers.classPrivateFieldLooseKey("onAfterDocumentFixed");var Ie=babelHelpers.classPrivateFieldLooseKey("setDebuggerState");class we extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,Ie,{value:ps});Object.defineProperty(this,Ee,{value:us});Object.defineProperty(this,Oe,{value:bs});Object.defineProperty(this,Te,{value:cs});Object.defineProperty(this,ye,{value:ds});Object.defineProperty(this,_e,{value:ns});Object.defineProperty(this,me,{value:os});Object.defineProperty(this,fe,{value:rs});Object.defineProperty(this,He,{value:ls});Object.defineProperty(this,Be,{value:is});Object.defineProperty(this,Fe,{value:as});Object.defineProperty(this,Le,{value:ts});Object.defineProperty(this,Pe,{value:ss});Object.defineProperty(this,he,{value:es});Object.defineProperty(this,ge,{value:Qe});Object.defineProperty(this,ve,{value:qe});Object.defineProperty(this,pe,{value:Ye});Object.defineProperty(this,ue,{value:Xe});Object.defineProperty(this,be,{value:We});Object.defineProperty(this,ce,{value:Ze});Object.defineProperty(this,de,{value:Je});Object.defineProperty(this,ne,{value:Ve});Object.defineProperty(this,oe,{value:Ue});Object.defineProperty(this,re,{value:$e});Object.defineProperty(this,le,{value:ze});Object.defineProperty(this,ie,{value:ke});Object.defineProperty(this,ae,{value:Me});Object.defineProperty(this,te,{value:Ke});Object.defineProperty(this,se,{value:je});Object.defineProperty(this,ee,{value:Ge});Object.defineProperty(this,Q,{value:xe});Object.defineProperty(this,q,{value:Ae});Object.defineProperty(this,Y,{value:Ne});Object.defineProperty(this,X,{value:Re});Object.defineProperty(this,W,{value:Ce});Object.defineProperty(this,Z,{value:De});Object.defineProperty(this,J,{value:Se});Object.defineProperty(this,C,{writable:true,value:void 0});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,N,{writable:true,value:false});Object.defineProperty(this,A,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:void 0});Object.defineProperty(this,G,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:["doc","log"]});Object.defineProperty(this,M,{writable:true,value:781});Object.defineProperty(this,k,{writable:true,value:612});Object.defineProperty(this,z,{writable:true,value:465});Object.defineProperty(this,$,{writable:true,value:187});Object.defineProperty(this,U,{writable:true,value:void 0});Object.defineProperty(this,V,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.AutomationMainView");babelHelpers.classPrivateFieldLooseBase(this,C)[C]=e;e.subscribe("onDocumentStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,me)[me].bind(this));e.subscribe("onWorkflowEventsChanged",babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].bind(this));e.subscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].bind(this));e.subscribe("onDocumentValuesUpdated",babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].bind(this));e.subscribe("onWorkflowStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].bind(this));e.subscribe("onAfterDocumentFixed",babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].bind(this))}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,C)[C]}show(){if(babelHelpers.classPrivateFieldLooseBase(this,N)[N]){babelHelpers.classPrivateFieldLooseBase(this,J)[J]().show();return}this.debugger.loadMainViewInfo().then((()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N]=true;babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setContent(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]());babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](this.debugger.getState());babelHelpers.classPrivateFieldLooseBase(this,J)[J]().show()}))}showExpanded(){if(!babelHelpers.classPrivateFieldLooseBase(this,J)[J]().isShown()){this.debugger.settings.set("popup-collapsed",false);this.show();return}babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]()}showCollapsed(){this.debugger.settings.set("popup-collapsed",true);this.show()}close(){babelHelpers.classPrivateFieldLooseBase(this,J)[J]().close()}destroy(){this.close()}}function Se(){if(!babelHelpers.classPrivateFieldLooseBase(this,R)[R]){const e=this.debugger.settings.get("popup-collapsed");const t="bizproc-debugger-automation__main-popup bizproc-debugger-automation__scope";babelHelpers.classPrivateFieldLooseBase(this,R)[R]=new s.Popup({className:t+(e?" --collapse":""),titleBar:babelHelpers.classPrivateFieldLooseBase(this,X)[X](),noAllPaddings:true,contentBackground:"white",draggable:true,zIndexOptions:{alwaysOnTop:e},width:babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](e),height:babelHelpers.classPrivateFieldLooseBase(this,W)[W](e),events:{onResizeStart:()=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinWidth(babelHelpers.classPrivateFieldLooseBase(this,M)[M]);babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinHeight(babelHelpers.classPrivateFieldLooseBase(this,k)[k])},onResizeEnd:()=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinWidth(null);babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinHeight(null);this.debugger.settings.set("popup-width",babelHelpers.classPrivateFieldLooseBase(this,R)[R].getWidth());this.debugger.settings.set("popup-height",babelHelpers.classPrivateFieldLooseBase(this,R)[R].getHeight())}}});babelHelpers.classPrivateFieldLooseBase(this,R)[R].setResizeMode(!e)}return babelHelpers.classPrivateFieldLooseBase(this,R)[R]}function De(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,z)[z]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,M)[M],this.debugger.settings.get("popup-width")||0)}function Ce(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,$)[$]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,k)[k],this.debugger.settings.get("popup-height")||0)}function Re(){return{content:P.Tag.render(f||(f=H`
				<div class="popup-window-titlebar-text bizproc-debugger-automation__titlebar">
					<div class="bizproc-debugger-automation__titlebar--move-icon"></div>
					${0}
					<div 
						class="bizproc-debugger-automation__titlebar--button-collapse" 
						onclick="${0}"
					></div>
					<span 
						class=" popup-window-close-icon 
								popup-window-titlebar-close-icon 
								bizproc-debugger-automation__titlebar--button-close"
						onclick="${0}"
					></span>
				</div>
			`),document.createTextNode(P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_POPUP_TITLE")),babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].bind(this),babelHelpers.classPrivateFieldLooseBase(this,q)[q].bind(this))}}function Ne(){const e=babelHelpers.classPrivateFieldLooseBase(this,J)[J]().getPopupContainer();const s=P.Dom.hasClass(e,"--collapse");this.debugger.settings.set("popup-collapsed",!s);babelHelpers.classPrivateFieldLooseBase(this,J)[J]().getZIndexComponent().setAlwaysOnTop(!s);babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setResizeMode(s);P.Dom.toggleClass(e,"--collapse");clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,U)[U]);P.Dom.addClass(e,"--changing-view");babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setWidth(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](!s));babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setHeight(babelHelpers.classPrivateFieldLooseBase(this,W)[W](!s));babelHelpers.classPrivateFieldLooseBase(this,U)[U]=setTimeout((()=>P.Dom.removeClass(e,"--changing-view")),500)}function Ae(){b.MessageBox.show({message:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_FINISH_SESSION"),okCaption:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),onOk:()=>p.Manager.Instance.finishSession(this.debugger.session),buttons:b.MessageBoxButtons.OK_CANCEL})}function xe(){if(!babelHelpers.classPrivateFieldLooseBase(this,A)[A]){babelHelpers.classPrivateFieldLooseBase(this,A)[A]=P.Tag.render(m||(m=H`
				<div class="bizproc-debugger-automation__content">
					<div class="bizproc-debugger-automation-content-collapsed">
						${0}
					</div>
					<div class="bizproc-debugger-automation__content-expanded">
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,se)[se](),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]());u.HelpHint.bindAll(babelHelpers.classPrivateFieldLooseBase(this,A)[A])}return babelHelpers.classPrivateFieldLooseBase(this,A)[A]}function Ge(){var e,s;const t=!this.debugger.isTemplateEmpty();const a=this.debugger.settings.get("tab")==="log"?"log":"doc";const i=a==="doc"?"--active":"";const l=a==="log"?"--active":"";const r=this.debugger.session.isFixed();const o=r?"":"--empty --active";const n=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]();const d=n.querySelector("[data-field-id]")!==null;return P.Tag.render(_||(_=H`
				<div class="bizproc-debugger-automation__main">
					<div class="bizproc-debugger-automation__main-robots">
						<div class="bizproc-debugger-automation__main-robots--head">
							${0}
						</div>
						<div data-role="automation-content" class="bizproc-debugger-automation__main-robots--main-content">
							${0}
							${0}
							<div class="bizproc-debugger-automation__head">
								<div class="bizproc-debugger-automation__main--title">
									<div class="bizproc-debugger-automation__main--name">${0} </div>
									<div class="ui-hint">
										<span class="ui-hint-icon" data-text="${0}"></span>
									</div>
								</div>
								<div data-role="no-template" class="bizproc-debugger-automation__main-hint ${0}">
									<div class="bizproc-debugger-automation__main-hint--title">
										${0}
									</div>
									<div class="bizproc-debugger-automation__main-hint--text">
										${0}
									</div>
									<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
								</div>
							</div>
							${0}
						</div>
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-fields ${0}">
						<div data-role="tabs-container" class="bizproc-debugger-automation__main-navigation --active-${0}">
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="doc" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="log" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							
							<div data-tab-item="doc" class="bizproc-debugger-automation__tab-action ${0}">
								${0}
							</div>
							
							<div data-tab-item="log" class="bizproc-debugger-automation__tab-action ${0}">
								<div class="bizproc-debugger-automation__action-btn --icon-search" style="display: none"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-log" onclick="${0}"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-note" style="display: none"></div>
							</div>
						</div>
						
						<div data-tab-item="doc" data-role="tab-content-doc" class="bizproc-debugger-tab__content ${0} ${0}">
							<div class="bizproc-debugger-tab__content--empty">
								${0}
							</div>
							<div class="bizproc-debugger-tab__content--not-empty">
								<div class="bizproc-debugger-tab__content-title">${0}</div>							
								${0}
							</div>
						</div>
						<div data-tab-item="log" class="bizproc-debugger-tab__content ${0} bizproc-debugger-automation-main-section-log">
							${0}
						</div>
						<div data-tab-item="no-document" class="bizproc-debugger-tab__content ${0} bizproc-debugger-automation-main-section-disabled">
							<div class="bizproc-debugger-tab__content--empty">
								${0}
							</div>
						</div>
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Le)[Le](),(e=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]())!=null?e:"",(s=babelHelpers.classPrivateFieldLooseBase(this,be)[be]())!=null?s:"",P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ROBOTS_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_ROBOT")),t?"":"--active",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_TITLE")),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_SUBTITLE")),this.debugger.getSettingsUrl(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")),babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](),babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](),r?"":"--disabled",a,i,babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].bind(this),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_FIELD")),l,babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].bind(this),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_LOG_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_LOG")),i,babelHelpers.classPrivateFieldLooseBase(this,te)[te](),l,(()=>{p.Manager.Instance.openSessionLog(this.debugger.sessionId)}),r?i:"",d?"":"--empty",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_FIELD_TITLE")),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),n,r?l:"",this.debugger.getLogView().shouldScrollToBottom(true).shouldLoadPreviousLog(true).render(),o,P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_FIXED_DOCUMENT")))}function je(){return P.Tag.render(y||(y=H`
			<div class="bizproc-debugger-automation-menu__content-body">
				<div class="bizproc-debugger-automation-menu__content-body--logo"></div>
				<div class="bizproc-debugger-automation-menu__content-body--text">${0}</div>
			</div>
		`),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_SUBTITLE"))}function Ke(){return new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,noCaps:true,text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_ADD_FIELD"),onclick:babelHelpers.classPrivateFieldLooseBase(this,le)[le].bind(this)}).render()}function Me(){const e=P.Tag.render(T||(T=H`<div class="ui-form" data-role="doc-field-list">
			</div>`));const s=this.debugger.settings.getSet("watch-fields");s.forEach((s=>{const t=babelHelpers.classPrivateFieldLooseBase(this,de)[de](s);if(t){P.Dom.append(t,e)}}));return e}function ke(e){const s=e.target.dataset.tabItem;const t=babelHelpers.classPrivateFieldLooseBase(this,K)[K].filter((e=>e!==s))[0];const a=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]();const i=a.querySelector('[data-role="tabs-container"]');a.querySelectorAll([`[data-tab-item="${s}"]`]).forEach((e=>P.Dom.addClass(e,"--active")));a.querySelectorAll([`[data-tab-item="${t}"]`]).forEach((e=>P.Dom.removeClass(e,"--active")));P.Dom.addClass(i,`--active-${s}`);P.Dom.removeClass(i,`--active-${t}`);this.debugger.settings.set("tab",s);this.emit("onChangeTab",{tab:s})}function ze(e,s){const t=this.debugger.getDocumentFields();const a=this.debugger.settings.getSet("watch-fields");const l=new i.EntitySelector.Dialog({targetNode:s.target,width:500,height:300,multiple:true,dropdownMode:true,enableSearch:true,cacheable:false,items:t.filter((e=>e.Watchable===true)).map((e=>({title:e.Name,id:e.Id,customData:{field:e},entityId:"bp",tabs:"recents",selected:a.has(e.Id)}))),showAvatars:false,events:{"Item:onSelect":e=>babelHelpers.classPrivateFieldLooseBase(this,re)[re](e.getData().item),"Item:onDeselect":e=>babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](e.getData().item.getId())},compactView:true});l.show()}function $e(e){const s=this.debugger.settings.getSet("watch-fields");const t=e.getCustomData().get("field");if(s.has(t.Id)){return}const a=babelHelpers.classPrivateFieldLooseBase(this,de)[de](t);P.Dom.append(a,babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="doc-field-list"]'));s.add(t.Id);this.debugger.settings.set("watch-fields",s);babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](s)}function Ue(e){const s=this.debugger.settings.getSet("watch-fields");if(!s.has(e)){return}s.delete(e);this.debugger.settings.set("watch-fields",s);P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector(`[data-field-id="${e}"]`));babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](s)}function Ve(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="tab-content-doc"]');const t=s.querySelector("[data-field-id]")!==null;P.Dom[t?"removeClass":"addClass"](s,"--empty")}function Je(e){if(P.Type.isString(e)){e=this.debugger.getDocumentField(e)}if(!e||!e.Id){return null}const s=this.debugger.getDocumentValue(e.Id)||"";return P.Tag.render(O||(O=H`
			<div class="ui-form-row" data-role="field-row" data-field-id="${0}">
				<div class="ui-form-label">
					<div class="ui-ctl-label-text">${0}</div>
				</div>
				<div class="ui-form-content">
					<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-ext-after-icon">
						<input type="text" readonly class="ui-ctl-element"
						 placeholder="${0}"
						 data-role="field-value-${0}"
						 value="${0}"
						 >
						 <a class="ui-ctl-after ui-ctl-icon-clear" onclick="${0}"></a>
					</div>
				</div>
			</div>
		`),P.Text.encode(e.Id),P.Text.encode(e.Name),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_EMPTY_VALUE"),P.Text.encode(e.Id),P.Text.encode(s),babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].bind(this,e.Id))}function Ze(){const e=this.debugger.templateTriggers.length>0;const s=!this.debugger.isTemplateEmpty();if(!e&&s){return null}return P.Tag.render(E||(E=H`
			<div data-role="triggers-header" class="bizproc-debugger-automation__head">
				<div class="bizproc-debugger-automation__main--title">
					<div class="bizproc-debugger-automation__main--name">${0} </div>
					<div class="ui-hint">
						<span class="ui-hint-icon" data-text="${0}"></span>
					</div>
				</div>
				<div data-role="no-triggers" class="bizproc-debugger-automation__main-hint ${0}">
					<div class="bizproc-debugger-automation__main-hint--title">
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-hint--text">
						${0}
					</div>
					<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
				</div>
			</div>
		`),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_TRIGGERS_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_TRIGGER")),e||s?"":"--active",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_TITLE")),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_SUBTITLE")),this.debugger.getSettingsUrl(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")))}function We(){const e=this.debugger.getTemplate().DOCUMENT_STATUS;babelHelpers.classPrivateFieldLooseBase(this,j)[j]=new u.Tracker(u.getGlobalContext().document);const s={};s[e]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,j)[j].init(s);u.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,j)[j];const t=this.debugger.templateTriggers;if(t.length===0){return null}const a=P.Tag.render(I||(I=H`
			<div data-role="triggers" class="bizproc-debugger__template">
				<div class="bizproc-automation-status-list-item" data-type="column-trigger">
					<div data-role="trigger-list" class="bizproc-automation-trigger-list" data-status-id="${0}"></div>
				</div>
			</div>
		`),e);babelHelpers.classPrivateFieldLooseBase(this,x)[x]=new u.TriggerManager(a);babelHelpers.classPrivateFieldLooseBase(this,x)[x].init({TRIGGERS:t},u.ViewMode.view());return a}function Xe(){const e=this.debugger.getTemplate();babelHelpers.classPrivateFieldLooseBase(this,j)[j]=new u.Tracker(u.getGlobalContext().document);const s={};s[e.DOCUMENT_STATUS]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,j)[j].init(s);u.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,j)[j];const t=P.Tag.render(w||(w=H`
			<div data-role="template" class="bizproc-debugger__template">
				<div data-role="automation-template" data-status-id="${0}">
					<div data-role="robot-list" class="bizproc-automation-robot-list"></div>
				</div>
			</div>
		`),e.DOCUMENT_STATUS);const a=new u.Template({constants:{},variables:{},templateContainerNode:t,delayMinLimitM:0});a.init(e,u.ViewMode.view().intoRaw());babelHelpers.classPrivateFieldLooseBase(this,pe)[pe](a);return t}function Ye(e){if(!P.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,G)[G])){babelHelpers.classPrivateFieldLooseBase(this,G)[G].destroy()}babelHelpers.classPrivateFieldLooseBase(this,G)[G]=e;return babelHelpers.classPrivateFieldLooseBase(this,G)[G]}function qe(){babelHelpers.classPrivateFieldLooseBase(this,V)[V]=new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,icon:t.ButtonIcon.START,onclick:babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].bind(this)});const e=this.debugger.hasWorkflowEvents();const s=this.debugger.session.isFixed();return P.Tag.render(S||(S=H`
			<div class="bizproc-debugger-automation__toolbar ${0}">
			<div data-role="external-event-info" class="bizproc-debugger-automation__toolbar--info-waiting ${0}">
				<div>
					${0}
				</div>
				<a onclick="${0}" class="bizproc-debugger-automation__link">
					${0}
				</a>
			</div>
			<div class="bizproc-debugger-automation__toolbar--btn-block">
				${0}
				<div class="bizproc-debugger-automation__toolbar--btn-text">
					${0}
				</div>
			</div>
			</div>
		`),s?"":"--disabled",e?"--active":"",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_SUBTITLE")),babelHelpers.classPrivateFieldLooseBase(this,he)[he].bind(this),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_TITLE")),babelHelpers.classPrivateFieldLooseBase(this,V)[V].render(),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START"))}function Qe(e){e.setWaiting(true);this.debugger.startDebugTemplate().then((()=>{e.setWaiting(false);babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](this.debugger.getState())}))}function es(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="external-event-info"]');P.Dom.removeClass(s,"--active");this.debugger.emulateExternalEvent()}function ss(e){if(babelHelpers.classPrivateFieldLooseBase(this,j)[j]){const e={};e[this.debugger.getDocumentStatus()]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,j)[j].reInit(e);babelHelpers.classPrivateFieldLooseBase(this,G)[G].reInit(null,u.ViewMode.view().intoRaw())}}function ts(){const e=babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]();const s=P.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,He)[He]());return P.Tag.render(D||(D=H`
			<div 
				class="bizproc-debugger-automation__status --robot-change ${0}"
				data-role="document-status"
				title="${0}"
				onclick="${0}"
			>
				<div class="bizproc-debugger-automation__status--title" data-role="document-status-title">
					${0}
				</div>
				<div class="bizproc-debugger-automation__status--bg" data-role="document-status-bg" style="background-color: ${0}; border-color: ${0};">
					<span class="bizproc-debugger-automation__status--bg-arrow"></span>
				</div>
			</div>
		`),B.getBgColorAdditionalClass(e),s,babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe].bind(this),s,e,e)}function as(e){e.preventDefault();const t=this.debugger.getStatusList();const a=new s.Menu({bindElement:e.target,items:t.map((e=>({text:e.NAME,statusId:e["STATUS_ID"],onclick:babelHelpers.classPrivateFieldLooseBase(this,Be)[Be].bind(this)})))});a.show()}function is(e,s){s.getMenuWindow().destroy();this.debugger.setDocumentStatus(s.statusId)}function ls(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.NAME||t.TITLE:"?"}function rs(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.COLOR:"#9DCF00"}function os(){if(!babelHelpers.classPrivateFieldLooseBase(this,J)[J]().isShown()){return}const e=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="automation-content"]');const s=new d.Loader({target:e});P.Dom.addClass(e,"--loading");s.show();this.debugger.loadMainViewInfo().then((()=>{const t=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="document-status-title"]');const a=babelHelpers.classPrivateFieldLooseBase(this,He)[He]();t.textContent=a;t.parentNode.setAttribute("title",a);const i=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="document-status-bg"]');const l=babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]();P.Dom.style(i,{backgroundColor:l,borderColor:l});const r=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="document-status"]');P.Dom.removeClass(r,["--with-border","--light-color"]);P.Dom.addClass(r,B.getBgColorAdditionalClass(l));P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="triggers-header"]'));P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="triggers"]'));P.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,be)[be](),e);const o=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]();if(o){u.HelpHint.bindAll(o);P.Dom.prepend(o,e)}const n=babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]();P.Dom.replace(babelHelpers.classPrivateFieldLooseBase(this,A)[A].querySelector('[data-role="template"]'),n);const d=this.debugger.templateTriggers.length>0;const c=!this.debugger.isTemplateEmpty();P.Dom[d||c?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,A)[A].querySelector('[data-role="no-triggers"]'),"--active");P.Dom[c?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,A)[A].querySelector('[data-role="no-template"]'),"--active");P.Dom.removeClass(e,"--loading");s.destroy()}))}function ns(e){if(!babelHelpers.classPrivateFieldLooseBase(this,V)[V]){return}const s=e.getData().events;const t=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]().querySelector('[data-role="external-event-info"]');P.Dom[s.length?"addClass":"removeClass"](t,"--active")}function ds(e){babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](this.debugger.track)}function cs(e){if(!babelHelpers.classPrivateFieldLooseBase(this,J)[J]().isShown()){return}const s=e.getData().values;const t=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]();Object.keys(s).forEach((e=>{const a=t.querySelector(`[data-role="field-value-${e}"]`);if(a){a.value=s[e]||""}}))}function bs(e){const s=e.getData().status;const t=e.getData().workflowId;if([u.WorkflowStatus.COMPLETED,u.WorkflowStatus.TERMINATED].includes(s)){this.debugger.track.forEach((e=>{if(e["WORKFLOW_ID"]===t){e["WORKFLOW_STATUS"]=u.WorkflowStatus.COMPLETED}}));babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](this.debugger.track)}}function us(){const e=babelHelpers.classPrivateFieldLooseBase(this,J)[J]().getPopupContainer();P.Dom.removeClass(e.getElementsByClassName("bizproc-debugger-automation__main-fields")[0],"--disabled");P.Dom.removeClass(e.getElementsByClassName("bizproc-debugger-automation__toolbar")[0],"--disabled");const s=this.debugger.settings.get("tab")==="log"?"log":"doc";e.querySelectorAll([`[data-tab-item="no-document"]`]).forEach((e=>P.Dom.removeClass(e,["--empty","--active"])));e.querySelectorAll([`[data-tab-item="${s}"]`]).forEach((e=>P.Dom.addClass(e,"--active")));babelHelpers.classPrivateFieldLooseBase(this,me)[me]()}function ps(e){if(!babelHelpers.classPrivateFieldLooseBase(this,V)[V]){return}switch(e){case F.Run:babelHelpers.classPrivateFieldLooseBase(this,V)[V].setIcon(t.ButtonIcon.PAUSE);babelHelpers.classPrivateFieldLooseBase(this,V)[V].getContainer().nextElementSibling.textContent=P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_PAUSE");break;default:babelHelpers.classPrivateFieldLooseBase(this,V)[V].setIcon(t.ButtonIcon.START);babelHelpers.classPrivateFieldLooseBase(this,V)[V].getContainer().nextElementSibling.textContent=P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START")}}class vs{static isMode(e){return[0,1].includes(e)}static getMode(e){if(e===0){return vs.experimental}else if(e===1){return vs.interception}return null}static getAllModes(){return{0:vs.experimental,1:vs.interception}}}vs.experimental={id:0,code:"experimental"};vs.interception={id:1,code:"interception"};var gs=babelHelpers.classPrivateFieldLooseKey("id");var hs=babelHelpers.classPrivateFieldLooseKey("sessionId");var Ps=babelHelpers.classPrivateFieldLooseKey("documentId");var Ls=babelHelpers.classPrivateFieldLooseKey("categoryId");var Fs=babelHelpers.classPrivateFieldLooseKey("dateExpire");var Bs=babelHelpers.classPrivateFieldLooseKey("documentSigned");class Hs{constructor(e){Object.defineProperty(this,gs,{writable:true,value:void 0});Object.defineProperty(this,hs,{writable:true,value:void 0});Object.defineProperty(this,Ps,{writable:true,value:void 0});Object.defineProperty(this,Ls,{writable:true,value:void 0});Object.defineProperty(this,Fs,{writable:true,value:void 0});Object.defineProperty(this,Bs,{writable:true,value:""});babelHelpers.classPrivateFieldLooseBase(this,gs)[gs]=parseInt(e.Id)>=0?parseInt(e.Id):0;babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]=P.Type.isStringFilled(e.SessionId)?e.SessionId:"";babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps]=P.Type.isStringFilled(e.DocumentId)?e.DocumentId:"";babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]=P.Text.toInteger(e.DocumentCategoryId);babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs]=B.toDate(e.DateExpire);if(e.DocumentSigned){this.documentSigned=e.DocumentSigned}}get documentId(){return babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps]}get categoryId(){return babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]}set categoryId(e){babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]=P.Type.isNumber(e)?e:0}get documentSigned(){return babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]}set documentSigned(e){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]=P.Type.isStringFilled(e)?e:""}}var fs=babelHelpers.classPrivateFieldLooseKey("id");var ms=babelHelpers.classPrivateFieldLooseKey("mode");var _s=babelHelpers.classPrivateFieldLooseKey("startedBy");var ys=babelHelpers.classPrivateFieldLooseKey("active");var Ts=babelHelpers.classPrivateFieldLooseKey("fixed");var Os=babelHelpers.classPrivateFieldLooseKey("documents");var Es=babelHelpers.classPrivateFieldLooseKey("shortDescription");var Is=babelHelpers.classPrivateFieldLooseKey("categoryId");var ws=babelHelpers.classPrivateFieldLooseKey("documentSigned");var Ss=babelHelpers.classPrivateFieldLooseKey("finished");var Ds=babelHelpers.classPrivateFieldLooseKey("pullFinishHandler");var Cs=babelHelpers.classPrivateFieldLooseKey("pullDocumentValuesHandler");var Rs=babelHelpers.classPrivateFieldLooseKey("setMode");var Ns=babelHelpers.classPrivateFieldLooseKey("setDocuments");var As=babelHelpers.classPrivateFieldLooseKey("handleExternalFinished");var xs=babelHelpers.classPrivateFieldLooseKey("handleExternalDocumentValues");var Gs=babelHelpers.classPrivateFieldLooseKey("handleFinish");var js=babelHelpers.classPrivateFieldLooseKey("updateSession");class Ks extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,js,{value:Vs});Object.defineProperty(this,Gs,{value:Us});Object.defineProperty(this,xs,{value:$s});Object.defineProperty(this,As,{value:zs});Object.defineProperty(this,Ns,{value:ks});Object.defineProperty(this,Rs,{value:Ms});Object.defineProperty(this,fs,{writable:true,value:""});Object.defineProperty(this,ms,{writable:true,value:{}});Object.defineProperty(this,_s,{writable:true,value:0});Object.defineProperty(this,ys,{writable:true,value:void 0});Object.defineProperty(this,Ts,{writable:true,value:void 0});Object.defineProperty(this,Os,{writable:true,value:[]});Object.defineProperty(this,Es,{writable:true,value:""});Object.defineProperty(this,Is,{writable:true,value:0});Object.defineProperty(this,ws,{writable:true,value:""});Object.defineProperty(this,Ss,{writable:true,value:false});Object.defineProperty(this,Ds,{writable:true,value:void 0});Object.defineProperty(this,Cs,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.Session");e=P.Type.isPlainObject(e)?e:{};babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]=e.Id;babelHelpers.classPrivateFieldLooseBase(this,Rs)[Rs](e.Mode);babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]=parseInt(e.StartedBy)>=0?parseInt(e.StartedBy):0;babelHelpers.classPrivateFieldLooseBase(this,Es)[Es]=String(e.ShortDescription);babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]=Boolean(e.Active);babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]=Boolean(e.Fixed);babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]=P.Text.toInteger(e.CategoryId);babelHelpers.classPrivateFieldLooseBase(this,Ns)[Ns](e.Documents);if(this.isActive()){babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds]=babelHelpers.classPrivateFieldLooseBase(this,As)[As].bind(this);p.Manager.Instance.pullHandler.subscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds]);babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]=babelHelpers.classPrivateFieldLooseBase(this,xs)[xs].bind(this);p.Manager.Instance.pullHandler.subscribe("documentValues",babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs])}}set documentSigned(e){if(this.isFixed()&&this.activeDocument){this.activeDocument.documentSigned=e}babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]=e}get documentSigned(){if(this.activeDocument){const e=this.activeDocument.documentSigned;if(P.Type.isStringFilled(e)){return e}}return babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]}get id(){return babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]}get startedBy(){return babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]}get activeDocument(){if(babelHelpers.classPrivateFieldLooseBase(this,Os)[Os].length===1){return babelHelpers.classPrivateFieldLooseBase(this,Os)[Os][0]}return null}get modeId(){return babelHelpers.classPrivateFieldLooseBase(this,ms)[ms].id}get shortDescription(){return babelHelpers.classPrivateFieldLooseBase(this,Es)[Es]}get initialCategoryId(){return babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]}isActive(){return babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]}isFixed(){return babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]}isSessionStartedByUser(e){return this.startedBy===e}isAutomation(){return true}isInterceptionMode(){return this.modeId===vs.interception.id}isExperimentalMode(){return this.modeId===vs.experimental.id}static start(e,s){return new Promise(((t,a)=>{P.ajax.runAction("bizproc.debugger.startSession",{data:{documentSigned:e,mode:s},analyticsLabel:{automation_select_debug_mode:"Y",mode_type:vs.getMode(s).code}}).then((e=>{const s=new Ks(e.data.session);s.documentSigned=e.data.documentSigned;t(s)}),a)}))}finish(){return P.ajax.runAction("bizproc.debugger.finishDebugSession",{data:{sessionId:this.id}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,Gs)[Gs]();return e}))}fixateDocument(e){return P.ajax.runAction("bizproc.debugger.fixateSessionDocument",{data:{documentId:e}}).then((e=>{this.documentSigned=e.data.documentSigned;babelHelpers.classPrivateFieldLooseBase(this,js)[js](e.data.session);this.emit("onAfterDocumentFixed");return e}))}removeDocuments(e=[]){return P.ajax.runAction("bizproc.debugger.removeSessionDocument",{data:{documentIds:e}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,js)[js](e.data.session);return e}))}}function Ms(e){e=B.isNumeric(e)?Number(e):null;if(vs.isMode(e)){babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]=vs.getMode(e)}}function ks(e){if(P.Type.isArrayFilled(e)){e.forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,Os)[Os].push(new Hs(e))}))}return this}function zs(e){const s=e.getData().sessionId;if(s===this.id){babelHelpers.classPrivateFieldLooseBase(this,Gs)[Gs]()}}function $s(e){if(!this.activeDocument){return}const s=e.getData().rawValues;const t=s["CATEGORY_ID"];if(t){this.activeDocument.categoryId=P.Text.toInteger(t);p.Manager.Instance.requireSetFilter(this)}}function Us(){if(!babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]){babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]=true;this.emit("onFinished");this.unsubscribeAll();if(babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds]){p.Manager.Instance.pullHandler.unsubscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds]);babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds]=null}if(babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]){p.Manager.Instance.pullHandler.unsubscribe("documentValues",babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]);babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]=null}}}function Vs(e={}){if(Object.keys(e).length<=0){return}babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]=Boolean(e.Active);babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]=Boolean(e.Fixed);babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]=P.Text.toInteger(e.CategoryId);babelHelpers.classPrivateFieldLooseBase(this,Ns)[Ns](e.Documents)}let Js=e=>e,Zs,Ws,Xs,Ys,qs,Qs,et,st,tt,at,it,lt,rt,ot,nt,dt,ct;var bt=babelHelpers.classPrivateFieldLooseKey("robot");var ut=babelHelpers.classPrivateFieldLooseKey("view");var pt=babelHelpers.classPrivateFieldLooseKey("currentNode");var vt=babelHelpers.classPrivateFieldLooseKey("currentIndex");var gt=babelHelpers.classPrivateFieldLooseKey("isAfterPreviousRendered");var ht=babelHelpers.classPrivateFieldLooseKey("isPauseRendered");var Pt=babelHelpers.classPrivateFieldLooseKey("isActivityBodyRendered");var Lt=babelHelpers.classPrivateFieldLooseKey("prevRobotTitle");var Ft=babelHelpers.classPrivateFieldLooseKey("getCurrentRobotNode");var Bt=babelHelpers.classPrivateFieldLooseKey("renderRobotTitle");var Ht=babelHelpers.classPrivateFieldLooseKey("renderAfterPrevious");var ft=babelHelpers.classPrivateFieldLooseKey("renderPause");var mt=babelHelpers.classPrivateFieldLooseKey("renderDelayInterval");var _t=babelHelpers.classPrivateFieldLooseKey("renderCondition");var yt=babelHelpers.classPrivateFieldLooseKey("renderConditions");var Tt=babelHelpers.classPrivateFieldLooseKey("renderActivity");var Ot=babelHelpers.classPrivateFieldLooseKey("renderActivityFinish");var Et=babelHelpers.classPrivateFieldLooseKey("renderNote");var It=babelHelpers.classPrivateFieldLooseKey("renderDebugNote");var wt=babelHelpers.classPrivateFieldLooseKey("renderDebugLink");class St{constructor(e,s){Object.defineProperty(this,wt,{value:zt});Object.defineProperty(this,It,{value:kt});Object.defineProperty(this,Et,{value:Mt});Object.defineProperty(this,Ot,{value:Kt});Object.defineProperty(this,Tt,{value:jt});Object.defineProperty(this,yt,{value:Gt});Object.defineProperty(this,_t,{value:xt});Object.defineProperty(this,mt,{value:At});Object.defineProperty(this,ft,{value:Nt});Object.defineProperty(this,Ht,{value:Rt});Object.defineProperty(this,Bt,{value:Ct});Object.defineProperty(this,Ft,{value:Dt});Object.defineProperty(this,bt,{writable:true,value:void 0});Object.defineProperty(this,ut,{writable:true,value:void 0});Object.defineProperty(this,pt,{writable:true,value:null});Object.defineProperty(this,vt,{writable:true,value:null});Object.defineProperty(this,gt,{writable:true,value:false});Object.defineProperty(this,ht,{writable:true,value:false});Object.defineProperty(this,Pt,{writable:true,value:false});Object.defineProperty(this,Lt,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=e;babelHelpers.classPrivateFieldLooseBase(this,bt)[bt]=s}get name(){return babelHelpers.classPrivateFieldLooseBase(this,bt)[bt].name}get title(){return babelHelpers.classPrivateFieldLooseBase(this,bt)[bt].title}get delayName(){return babelHelpers.classPrivateFieldLooseBase(this,bt)[bt].delayName}get conditionNames(){return babelHelpers.classPrivateFieldLooseBase(this,bt)[bt].conditionNames}getActivitiesName(){let e=[];if(this.name){e.push(this.name)}if(this.delayName){e.push(this.delayName)}e=e.concat(this.conditionNames);return e}set previousRobotTitle(e){babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt]=e}renderTrack(e){const s=[u.TrackingEntry.EXECUTE_ACTIVITY_TYPE,u.TrackingEntry.ATTACHED_ENTITY_TYPE];if(s.includes(e.type)){return}if(e.name===this.delayName){return babelHelpers.classPrivateFieldLooseBase(this,ft)[ft](e)}if(this.conditionNames.includes(e.name)){if(babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,mt)[mt](new u.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]=true}return babelHelpers.classPrivateFieldLooseBase(this,_t)[_t](e)}if(e.name===this.name){if(babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,mt)[mt](new u.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]=true}return babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt](e)}}}function Dt(e){if(babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index!==babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]){const s=P.Tag.render(Zs||(Zs=Js`
				<div class="bizproc-debugger-automation__log-section">
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt](e.datetime));if(P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt])&&babelHelpers.classPrivateFieldLooseBase(this,gt)[gt]===false){P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht](),s)}P.Dom.append(s,babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].logNode);babelHelpers.classPrivateFieldLooseBase(this,pt)[pt]=s}return babelHelpers.classPrivateFieldLooseBase(this,pt)[pt]}function Ct(e){const s=P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TITLE",{"#TITLE#":this.title});const t=P.Tag.render(Ws||(Ws=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),Za.renderTime(e),P.Text.encode(s));babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index;return t}function Rt(){babelHelpers.classPrivateFieldLooseBase(this,gt)[gt]=true;const e=P.Tag.render(Xs||(Xs=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --blue">
							"${0}"
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_AFTER_PREVIOUS"),P.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt]));babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index;return e}function Nt(e){babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]=true;const s=[u.TrackingEntry.CLOSE_ACTIVITY_TYPE];if(s.includes(e.type)){return}if(e.type===u.TrackingEntry.DEBUG_AUTOMATION_TYPE){const s=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);const t=JSON.parse(e.note);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,mt)[mt](t),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Et)[Et](e),t)}function At(e={}){var s;const t=new u.DelayInterval(e);let a=(s=e.fieldName)!=null?s:(new u.DelayIntervalSelector).getBasisField(t.basis,true).Name;a=a+" ["+e.fieldValue+"]";const i=t.format(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_AT_ONCE"),[{SystemExpression:t.basis,Name:a}]);const l=P.Tag.render(Ys||(Ys=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --dark-blue">
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_RUN"),P.Text.encode(i));babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index;return l}function xt(e){const s=[u.TrackingEntry.CLOSE_ACTIVITY_TYPE];if(s.includes(e.type)){return}if(e.type===u.TrackingEntry.DEBUG_AUTOMATION_TYPE){const s=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Et)[Et](e),t)}function Gt(e){const s=JSON.parse(e.note);const t=P.Tag.render(qs||(qs=Js`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),s.result==="Y"?P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"):P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_FALSE"));Object.keys(s).forEach((e=>{if(e==="result"){return}let a="";if(s.result===s[e]["result"]){a=s.result==="Y"?"bizproc-debugger-automation__log-color-box --green":"bizproc-debugger-automation__log-color-box --orange"}const i=s[e]["condition"];const l=i["field"];const r=s[e]["fieldValue"]?String(s[e]["fieldValue"]):"";const o=B.getOperatorLabel(i["operator"]);const n=i["value"];const d=B.getJoinerLabel(s[e]["joiner"]);P.Dom.append(P.Tag.render(Qs||(Qs=Js`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0} 
							${0} 
							${0}
						</span>
					</div>
				`),a,e==="0"?"":P.Text.encode(d)+" ",P.Text.encode(l)+" ","["+P.Text.encode(r)+"] ",P.Text.encode(o)+" ",P.Text.encode(n)),t)}));const a=P.Tag.render(et||(et=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index;return a}function jt(e){if(e.type===u.TrackingEntry.CLOSE_ACTIVITY_TYPE){if(babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot](),s)}return}babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt]=true;const s=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);const t=babelHelpers.classPrivateFieldLooseBase(this,Et)[Et](e);P.Dom.append(t,s);babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].collapseInfoResults(t)}function Kt(){return P.Tag.render(st||(st=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation-log-section-robot-activity">
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_FINISH_WITHOUT_SETTINGS"))}function Mt(e){if([u.TrackingEntry.DEBUG_AUTOMATION_TYPE,u.TrackingEntry.DEBUG_ACTIVITY_TYPE].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,It)[It](e)}if([u.TrackingEntry.DEBUG_LINK_TYPE].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,wt)[wt](e)}const s=[u.TrackingEntry.CANCEL_ACTIVITY_TYPE,u.TrackingEntry.FAULT_ACTIVITY_TYPE,u.TrackingEntry.ERROR_ACTIVITY_TYPE].includes(e.type)?"bizproc-debugger-automation__log-color-box --red":"";const t=P.Tag.render(tt||(tt=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info--value --first">
					<span class="${0}">
						${0}
					</span>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),s,P.Text.encode(e.note).replace(/([^>])\n/g,"$1<br>"));babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index;return t}function kt(e){const s=JSON.parse(e.note);const t=P.Tag.render(at||(at=Js`<div class="bizproc-debugger-automation__log-info"></div>`));if(s["propertyName"]){P.Dom.append(P.Tag.render(it||(it=Js`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),P.Text.encode(s["propertyName"]),P.Text.encode(s["propertyName"])),t)}P.Dom.append(P.Tag.render(lt||(lt=Js`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<div>
							${0}
						</div>
					</div>
					<div data-role="more-info-result" style="display:none;">
						<span class="bizproc-debugger-automation__log-info--more">
							${0}
						</span>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",s["propertyValue"]?P.Text.encode(s["propertyValue"]).replace(/([^>])\n/g,"$1<br>"):"",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_MORE_INFORMATION"))),t);const a=P.Tag.render(rt||(rt=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index;return a}function zt(e){const s=JSON.parse(e.note);const t=P.Tag.render(ot||(ot=Js`<div class="bizproc-debugger-automation__log-info"></div>`));const a=s["propertyLinkName"]||s["propertyValue"];const i=s["propertyValue"];if(s["propertyName"]){P.Dom.append(P.Tag.render(nt||(nt=Js`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),P.Text.encode(s["propertyName"]),P.Text.encode(s["propertyName"])),t)}P.Dom.append(P.Tag.render(dt||(dt=Js`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<a href="${0}" target="_blank">
							${0}
						</a>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",P.Text.encode(i),a),t);const l=P.Tag.render(ct||(ct=Js`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=babelHelpers.classPrivateFieldLooseBase(this,ut)[ut].index;return l}let $t=e=>e,Ut,Vt,Jt,Zt,Wt;var Xt=babelHelpers.classPrivateFieldLooseKey("view");var Yt=babelHelpers.classPrivateFieldLooseKey("condition");var qt=babelHelpers.classPrivateFieldLooseKey("title");var Qt=babelHelpers.classPrivateFieldLooseKey("track");var ea=babelHelpers.classPrivateFieldLooseKey("renderTitle");var sa=babelHelpers.classPrivateFieldLooseKey("renderCondition");class ta{constructor(e){Object.defineProperty(this,sa,{value:ia});Object.defineProperty(this,ea,{value:aa});Object.defineProperty(this,Xt,{writable:true,value:void 0});Object.defineProperty(this,Yt,{writable:true,value:{}});Object.defineProperty(this,qt,{writable:true,value:""});Object.defineProperty(this,Qt,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt]=e}addTrack(e){if(e.type===u.TrackingEntry.DEBUG_AUTOMATION_TYPE&&e.name==="TRIGGER_LOG"){babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]=JSON.parse(e.note);babelHelpers.classPrivateFieldLooseBase(this,qt)[qt]=e.title;babelHelpers.classPrivateFieldLooseBase(this,Qt)[Qt]=e}return this}render(){const e=P.Tag.render(Ut||(Ut=$t`
			<div class="bizproc-debugger-automation__log-section">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					<div class="bizproc-debugger-automation__log-info--value --first">
						<span>
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ea)[ea](),babelHelpers.classPrivateFieldLooseBase(this,sa)[sa](),babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt].renderIndex(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_FINISH")));P.Dom.append(e,babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt].logNode)}}function aa(){const e=P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_TITLE",{"#TITLE#":babelHelpers.classPrivateFieldLooseBase(this,qt)[qt]});return P.Tag.render(Vt||(Vt=$t`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt].renderIndex(),Za.renderTime(babelHelpers.classPrivateFieldLooseBase(this,Qt)[Qt].datetime),P.Text.encode(e))}function ia(){if(!babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]||Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]).length<=0){return""}const e=babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt];const s=P.Tag.render(Jt||(Jt=$t`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"));Object.keys(e).forEach((t=>{const a=e[t]["result"]==="Y"?"bizproc-debugger-automation__log-color-box --green":"";const i=e[t]["condition"];const l=i["field"];const r=e[t]["fieldValue"]?String(e[t]["fieldValue"]):"";const o=B.getOperatorLabel(i["operator"]);const n=i["value"];const d=B.getJoinerLabel(e[t]["joiner"]);P.Dom.append(P.Tag.render(Zt||(Zt=$t`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0}
							${0}
							${0}
						</span>
					</div>
				`),a,t==="0"?"":P.Text.encode(d)+" ",P.Text.encode(l)+" ","["+P.Text.encode(r)+"] ",P.Text.encode(o)+" ",P.Text.encode(n)),s)}));return P.Tag.render(Wt||(Wt=$t`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt].renderIndex(),s)}let la=e=>e,ra,oa,na,da,ca,ba,ua;var pa=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var va=babelHelpers.classPrivateFieldLooseKey("workflowId");var ga=babelHelpers.classPrivateFieldLooseKey("activityRenderer");var ha=babelHelpers.classPrivateFieldLooseKey("documentStatus");var Pa=babelHelpers.classPrivateFieldLooseKey("categoryName");var La=babelHelpers.classPrivateFieldLooseKey("statusSettings");var Fa=babelHelpers.classPrivateFieldLooseKey("node");var Ba=babelHelpers.classPrivateFieldLooseKey("index");var Ha=babelHelpers.classPrivateFieldLooseKey("trackId");var fa=babelHelpers.classPrivateFieldLooseKey("poolTrack");var ma=babelHelpers.classPrivateFieldLooseKey("poolWorkflowRobots");var _a=babelHelpers.classPrivateFieldLooseKey("isRendering");var ya=babelHelpers.classPrivateFieldLooseKey("NUMBER_OF_LINES_TO_SHOW_IN_PIXELS");var Ta=babelHelpers.classPrivateFieldLooseKey("shouldScrollToBottom");var Oa=babelHelpers.classPrivateFieldLooseKey("shouldLoadPreviousLog");var Ea=babelHelpers.classPrivateFieldLooseKey("onTrackAddedHandler");var Ia=babelHelpers.classPrivateFieldLooseKey("onChangeTabHandler");var wa=babelHelpers.classPrivateFieldLooseKey("onSessionFinishedHandler");var Sa=babelHelpers.classPrivateFieldLooseKey("autoScrollHandler");var Da=babelHelpers.classPrivateFieldLooseKey("scrollAnimationId");var Ca=babelHelpers.classPrivateFieldLooseKey("loadPreviousLog");var Ra=babelHelpers.classPrivateFieldLooseKey("loadWorkflowRobotsByWorkflowId");var Na=babelHelpers.classPrivateFieldLooseKey("onAfterGetLog");var Aa=babelHelpers.classPrivateFieldLooseKey("renderStartDebugLog");var xa=babelHelpers.classPrivateFieldLooseKey("renderStartedDate");var Ga=babelHelpers.classPrivateFieldLooseKey("renderLegend");var ja=babelHelpers.classPrivateFieldLooseKey("renderCategoryChange");var Ka=babelHelpers.classPrivateFieldLooseKey("onChangeTab");var Ma=babelHelpers.classPrivateFieldLooseKey("bindAutoScroll");var ka=babelHelpers.classPrivateFieldLooseKey("scrollToBottom");var za=babelHelpers.classPrivateFieldLooseKey("animateScroll");var $a=babelHelpers.classPrivateFieldLooseKey("cancelAnimateScroll");var Ua=babelHelpers.classPrivateFieldLooseKey("askScrollToBottom");var Va=babelHelpers.classPrivateFieldLooseKey("clearWorkflowRobots");var Ja=babelHelpers.classPrivateFieldLooseKey("onSessionFinished");class Za{constructor(e){Object.defineProperty(this,Ja,{value:di});Object.defineProperty(this,Va,{value:ni});Object.defineProperty(this,Ua,{value:oi});Object.defineProperty(this,$a,{value:ri});Object.defineProperty(this,za,{value:li});Object.defineProperty(this,ka,{value:ii});Object.defineProperty(this,Ma,{value:ai});Object.defineProperty(this,Ka,{value:ti});Object.defineProperty(this,ja,{value:si});Object.defineProperty(this,Ga,{value:ei});Object.defineProperty(this,xa,{value:Qa});Object.defineProperty(this,Aa,{value:qa});Object.defineProperty(this,Na,{value:Ya});Object.defineProperty(this,Ra,{value:Xa});Object.defineProperty(this,Ca,{value:Wa});Object.defineProperty(this,pa,{writable:true,value:null});Object.defineProperty(this,va,{writable:true,value:void 0});Object.defineProperty(this,ga,{writable:true,value:{}});Object.defineProperty(this,ha,{writable:true,value:""});Object.defineProperty(this,Pa,{writable:true,value:""});Object.defineProperty(this,La,{writable:true,value:void 0});Object.defineProperty(this,Fa,{writable:true,value:null});Object.defineProperty(this,Ba,{writable:true,value:0});Object.defineProperty(this,Ha,{writable:true,value:0});Object.defineProperty(this,fa,{writable:true,value:[]});Object.defineProperty(this,ma,{writable:true,value:{}});Object.defineProperty(this,_a,{writable:true,value:true});Object.defineProperty(this,Ta,{writable:true,value:false});Object.defineProperty(this,Oa,{writable:true,value:false});Object.defineProperty(this,Ea,{writable:true,value:void 0});Object.defineProperty(this,Ia,{writable:true,value:void 0});Object.defineProperty(this,wa,{writable:true,value:void 0});Object.defineProperty(this,Sa,{writable:true,value:void 0});Object.defineProperty(this,Da,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,pa)[pa]=e;babelHelpers.classPrivateFieldLooseBase(this,va)[va]=this.debugger.workflowId;const s=this.debugger.getTemplate();this.initializeWorkflowRobotsRenderer(s?s["ROBOTS"]:[]);if(this.debugger.session.isActive()){babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]=this.onTrackAdded.bind(this);this.debugger.subscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]);babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]=babelHelpers.classPrivateFieldLooseBase(this,Ka)[Ka].bind(this);this.debugger.getMainView().subscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]);babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]=babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja].bind(this);this.debugger.session.subscribeOnce("onFinished",babelHelpers.classPrivateFieldLooseBase(this,wa)[wa])}}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,pa)[pa]}get index(){return babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba]}get logNode(){if(!babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]){babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]=P.Tag.render(ra||(ra=la`<div data-role="log" class="bizproc-debugger-tab__log"></div>`))}return babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]}initializeWorkflowRobotsRenderer(e=[],s=null){if(!s&&!babelHelpers.classPrivateFieldLooseBase(this,va)[va]){return}if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,ga)[ga][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,va)[va]])){babelHelpers.classPrivateFieldLooseBase(this,ga)[ga][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,va)[va]]={}}if(P.Type.isArrayFilled(e)){let a=null;for(let i=0;i<e.length;++i){var t;const l=new u.Robot({});l.init(e[i],u.ViewMode.none());const r=[];if(P.Type.isPlainObject(l.data.Condition)){r.push(l.data.Condition["activityNames"]["Activity"]);r.push(l.data.Condition["activityNames"]["Branch1"]);r.push(l.data.Condition["activityNames"]["Branch2"])}const o=new St(this,{name:l.getId(),title:l.getTitle(),delayName:(t=l.data.DelayName)!=null?t:null,conditionNames:r});if(l.isExecuteAfterPrevious()&&a){o.previousRobotTitle=a}a=l.getTitle();o.getActivitiesName().forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,ga)[ga][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,va)[va]][e]=o}))}}}shouldLoadPreviousLog(e){babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=e;return this}setPreviousLog(e={logs:[],workflowRobots:{}}){babelHelpers.classPrivateFieldLooseBase(this,Na)[Na](e);return this}render(){if(this.logNode.children.length<=0){babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=true;if(babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]){babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca]().then((()=>{this.startRendering()}))}else{this.startRendering()}}return this.logNode}renderTo(e){P.Dom.append(this.logNode,e);babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=true;this.startRendering();return this}startRendering(){const e=babelHelpers.classPrivateFieldLooseBase(this,fa)[fa].shift();if(P.Type.isUndefined(e)){babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=false;babelHelpers.classPrivateFieldLooseBase(this,Ua)[Ua]();babelHelpers.classPrivateFieldLooseBase(this,Ma)[Ma](babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]);return}if(babelHelpers.classPrivateFieldLooseBase(this,va)[va]!==e.workflowId){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,ga)[ga][e.workflowId])){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,ma)[ma][e.workflowId])){babelHelpers.classPrivateFieldLooseBase(this,Ra)[Ra](e);this.renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,va)[va]=e.workflowId;return}this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,ma)[ma][e.workflowId],e.workflowId)}}this.renderTrack(e);this.startRendering()}renderIndex(){babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba]++;return P.Tag.render(oa||(oa=la`
			<div class="bizproc-debugger-automation__log--index" data-role="index">${0}</div>
		`),String(babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba]).padStart(3,"0"))}static renderTime(e){e=B.toDate(e);return P.Tag.render(na||(na=la`
			<div class="bizproc-debugger-automation__log--time">
				[${0}]
			</div>
		`),P.Text.encode(B.formatDate("H:i:s",e)))}renderStatusChange(e){const s=JSON.parse(e.note);if(!P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,ha)[ha])){babelHelpers.classPrivateFieldLooseBase(this,ha)[ha]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,La)[La]=s;return}const t=this.getStatusSettings(babelHelpers.classPrivateFieldLooseBase(this,ha)[ha]);const a=s;const i=P.Tag.render(da||(da=la`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div class="bizproc-debugger-automation__status--change-info">
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
						<div class="bizproc-debugger-automation__status--robot-change-arrow"></div>
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),Za.renderTime(e.datetime),B.getBgColorAdditionalClass(t["COLOR"]),P.Text.encode(t["NAME"]),P.Text.encode(t["NAME"]),t["COLOR"],t["COLOR"],B.getBgColorAdditionalClass(a["COLOR"]),P.Text.encode(a["NAME"]),P.Text.encode(a["NAME"]),a.COLOR,a.COLOR);P.Dom.append(i,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,ha)[ha]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,La)[La]=s}getStatusSettings(){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,La)[La])){return{NAME:"",COLOR:"AEF2F9"}}return babelHelpers.classPrivateFieldLooseBase(this,La)[La]}onTrackAdded(e){const s=new u.TrackingEntryBuilder;s.setLogEntry(e.getData().row);this.addTrack(s.build())}addTrack(e){if(!babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]){this.renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,Ua)[Ua]();return}babelHelpers.classPrivateFieldLooseBase(this,fa)[fa].push(e)}renderTrack(e){var s;if(e.id<=babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]){return}if(!Object.keys((s=babelHelpers.classPrivateFieldLooseBase(this,ga)[ga][e.workflowId])!=null?s:{}).includes(e.name)){if(e.name==="SESSION_LEGEND"){babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa](e);babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=e.id}else if(e.name==="STATUS_CHANGED"){this.renderStatusChange(e);babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=e.id}else if(e.name==="CATEGORY_CHANGED"){babelHelpers.classPrivateFieldLooseBase(this,ja)[ja](e);babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=e.id}else if(e.name==="TRIGGER_LOG"){new ta(this).addTrack(e).render();babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=e.id}else if(e.name==="Template"&&e.type===u.TrackingEntry.EXECUTE_ACTIVITY_TYPE){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,ma)[ma][e.workflowId])&&babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]===false){babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=true;babelHelpers.classPrivateFieldLooseBase(this,Ra)[Ra](e)}}else if(e.name==="Template"&&e.type===u.TrackingEntry.CLOSE_ACTIVITY_TYPE){babelHelpers.classPrivateFieldLooseBase(this,Va)[Va](e.workflowId)}return}babelHelpers.classPrivateFieldLooseBase(this,ga)[ga][e.workflowId][e.name].renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=e.id}collapseInfoResults(e){if(!e){e=this.logNode}const s=e.querySelectorAll('[data-role="info-result"]');s.forEach((e=>{if(e.firstElementChild.clientHeight>babelHelpers.classPrivateFieldLooseBase(this.constructor,ya)[ya]){const s=e.parentNode.querySelector('[data-role="more-info-result"]');P.Event.bind(s,"click",(()=>{P.Dom.style(e,"height",e.firstElementChild.clientHeight+"px");P.Dom.style(s,"display","none")}));P.Event.bind(e,"transitionend",(()=>{P.Dom.style(e,"height",null)}));P.Dom.style(e,"height",babelHelpers.classPrivateFieldLooseBase(this.constructor,ya)[ya]+"px");P.Dom.style(s,"display","block")}}));return this}shouldScrollToBottom(e){babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]=e;return this}}function Wa(){return new Promise((e=>{this.debugger.loadAllLog().then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Na)[Na](s);e(this)}),(()=>{e(this)}))}))}function Xa(e){this.debugger.loadRobotsByWorkflowId(e.workflowId).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,ma)[ma][e.workflowId]=s.workflowRobots;this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,ma)[ma][e.workflowId],e.workflowId);this.startRendering()}),(()=>{babelHelpers.classPrivateFieldLooseBase(this,ma)[ma][e.workflowId]=[];console.info("session has no workflowId from track:",e);this.startRendering()}))}function Ya(e){const s=[];const t=new u.TrackingEntryBuilder;if(P.Type.isArrayFilled(e["logs"])){e["logs"].forEach((e=>{s.push(t.setLogEntry(e).build())}))}babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]=s.concat(babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]);babelHelpers.classPrivateFieldLooseBase(this,ma)[ma]=Object.assign(e["workflowRobots"],babelHelpers.classPrivateFieldLooseBase(this,ma)[ma])}function qa(e){babelHelpers.classPrivateFieldLooseBase(this,xa)[xa](e);babelHelpers.classPrivateFieldLooseBase(this,Ga)[Ga](e)}function Qa(e){const s=B.toDate(e.datetime);const t=P.Tag.render(ca||(ca=la`
			<div class="bizproc-debugger-automation__log--date">
				<div class="bizproc-debugger-automation__log--date-text">${0}</div>
			</div>
		`),P.Text.encode(B.formatDate("j F Y",s)));P.Dom.append(t,this.logNode)}function ei(e){const s=JSON.parse(e.note)["propertyValue"];const t=P.Tag.render(ba||(ba=la`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div>${0}</div>
				</div>
			</div>
		`),this.renderIndex(),Za.renderTime(e.datetime),P.Text.encode(s));P.Dom.append(t,this.logNode)}function si(e){const s=JSON.parse(e.note)["propertyValue"];if(!P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa])){babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]=s;return}const t=P.Tag.render(ua||(ua=la`
			<div>
				<div class="bizproc-debugger-automation__log-separator"></div>
				<div class="bizproc-debugger-automation__log-section">
					<div class="bizproc-debugger-automation__log-section--row">
						${0}
						${0}
						<div>
							${0}
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),Za.renderTime(e.datetime),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CATEGORY_CHANGE",{"#SOURCE_CATEGORY#":babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa],"#DESTINATION_CATEGORY#":s})));P.Dom.append(t,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]=s}function ti(e){if(e.getData().tab==="log"){this.collapseInfoResults();babelHelpers.classPrivateFieldLooseBase(this,Ua)[Ua]()}}function ai(e){if(!this.logNode.parentNode){return}const s=this.logNode.parentNode;if(e){babelHelpers.classPrivateFieldLooseBase(this,Sa)[Sa]=()=>{if(babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]){return}const e=s.scrollHeight-s.clientHeight;babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]=s.scrollTop>=e-babelHelpers.classPrivateFieldLooseBase(this.constructor,ya)[ya]};P.Event.bind(s,"scroll",babelHelpers.classPrivateFieldLooseBase(this,Sa)[Sa])}else if(babelHelpers.classPrivateFieldLooseBase(this,Sa)[Sa]){P.Event.unbind(s,"scroll",babelHelpers.classPrivateFieldLooseBase(this,Sa)[Sa])}}function ii(){if(!this.logNode.parentNode){return}const e=this.logNode.parentNode;const s=e.scrollTop;const t=e.scrollHeight-e.clientHeight;babelHelpers.classPrivateFieldLooseBase(this,za)[za](e,s,t)}function li(e,s,t){babelHelpers.classPrivateFieldLooseBase(this,$a)[$a]();const a=20;const i=500;const l=t-s;let r=0;const o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)};const n=()=>{r+=a;e.scrollTop=ci(r,s,l,i);if(r<i){babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]=o(n)}else{babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]=null}};return n()}function ri(){if(babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]){const e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)};e(babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]);babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]=null}}function oi(){if(babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]){babelHelpers.classPrivateFieldLooseBase(this,ka)[ka]()}}function ni(e){delete babelHelpers.classPrivateFieldLooseBase(this,ma)[ma][e];delete babelHelpers.classPrivateFieldLooseBase(this,ga)[ga][e]}function di(){this.debugger.unsubscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]);this.debugger.getMainView().unsubscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia])}Object.defineProperty(Za,ya,{writable:true,value:50});const ci=function(e,s,t,a){e/=a/2;if(e<1){return t/2*e*e+s}e--;return-t/2*(e*(e-2)-1)+s};var bi=babelHelpers.classPrivateFieldLooseKey("guide");var ui=babelHelpers.classPrivateFieldLooseKey("getHtmlTitle");class pi{constructor(e){Object.defineProperty(this,bi,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,bi)[bi]=new L.Guide({steps:[{target:e.target,title:babelHelpers.classPrivateFieldLooseBase(pi,ui)[ui](e.title)||"",text:e.text||"",condition:{top:true,bottom:false,color:"warning"}}],onEvents:true})}start(){babelHelpers.classPrivateFieldLooseBase(this,bi)[bi].getPopup().setWidth(370);babelHelpers.classPrivateFieldLooseBase(this,bi)[bi].showNextStep()}finish(){babelHelpers.classPrivateFieldLooseBase(this,bi)[bi].close()}}function vi(e){if(e){return`\n\t\t\t\t<div class="bizproc__action-panel-guide">\n\t\t\t\t\t<div class="bizproc__action-panel-guide--title --warning-icon">${P.Text.encode(e)}</div>\n\t\t\t\t</div>\n\t\t\t`}return null}Object.defineProperty(pi,ui,{value:vi});var gi=babelHelpers.classPrivateFieldLooseKey("actionPanel");var hi=babelHelpers.classPrivateFieldLooseKey("grid");var Pi=babelHelpers.classPrivateFieldLooseKey("guides");var Li=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var Fi=babelHelpers.classPrivateFieldLooseKey("appendItems");var Bi=babelHelpers.classPrivateFieldLooseKey("onHideActionPanel");var Hi=babelHelpers.classPrivateFieldLooseKey("getRemoveEntityActionText");var fi=babelHelpers.classPrivateFieldLooseKey("getCheckedIdsInBpStyle");var mi=babelHelpers.classPrivateFieldLooseKey("handleRejectResponse");class _i{constructor(e,s){Object.defineProperty(this,mi,{value:Ii});Object.defineProperty(this,fi,{value:Ei});Object.defineProperty(this,Hi,{value:Oi});Object.defineProperty(this,Bi,{value:Ti});Object.defineProperty(this,Fi,{value:yi});Object.defineProperty(this,gi,{writable:true,value:null});Object.defineProperty(this,hi,{writable:true,value:null});Object.defineProperty(this,Pi,{writable:true,value:[]});Object.defineProperty(this,Li,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,hi)[hi]=e;babelHelpers.classPrivateFieldLooseBase(this,Li)[Li]=s;babelHelpers.classPrivateFieldLooseBase(this,gi)[gi]=new BX.UI.ActionPanel({removeLeftPosition:true,maxHeight:58,parentPosition:"bottom",autoHide:false});babelHelpers.classPrivateFieldLooseBase(this,Fi)[Fi]();const t=babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi].bind(this);h.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,gi)[gi],"BX.UI.ActionPanel:hidePanel",t)}get actionPanel(){return babelHelpers.classPrivateFieldLooseBase(this,gi)[gi]}fixEntityAction(){const e=babelHelpers.classPrivateFieldLooseBase(this,fi)[fi]();if(e.length!==1){const e=new pi({target:this.actionPanel.getItemById("fix_entity").layout.container,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_COUNT_ERROR_TITLE"),article:"limit_office_bp_designer"});babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi].push(e);e.start();return}babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].session.fixateDocument(e[0]).then((()=>{this.stopActionPanel();p.Manager.Instance.requireSetFilter(babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].session,true);if(babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].settings.get("popup-collapsed")){babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].getMainView().showExpanded()}}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,mi)[mi](e,"fix_entity")}))}removeEntityAction(){const e=babelHelpers.classPrivateFieldLooseBase(this,fi)[fi]();babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].session.removeDocuments(e).then((()=>{this.actionPanel.hidePanel();babelHelpers.classPrivateFieldLooseBase(this,hi)[hi].reload()}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,mi)[mi](e,"remove_entity")}))}stopActionPanel(){this.actionPanel.hidePanel();babelHelpers.classPrivateFieldLooseBase(this,hi)[hi].resetActionPanel();babelHelpers.classPrivateFieldLooseBase(this,hi)[hi].stopActionPanel()}}function yi(){babelHelpers.classPrivateFieldLooseBase(this,gi)[gi].appendItem({id:"fix_entity",text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_ACTION_1"),onclick:this.fixEntityAction.bind(this)});babelHelpers.classPrivateFieldLooseBase(this,gi)[gi].appendItem({id:"remove_entity",text:babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi](),onclick:this.removeEntityAction.bind(this)});babelHelpers.classPrivateFieldLooseBase(this,gi)[gi].appendItem({id:"finish_debug",text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FINISH_DEBUG_ACTION"),onclick:function(){p.Manager.Instance.finishSession(babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].session).then((()=>{this.stopActionPanel()}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,mi)[mi](e,"finish_debug")}))}.bind(this)})}function Ti(){babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi].forEach((e=>{e.finish()}))}function Oi(){return`\n\t\t\t<span>${P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_REMOVE_DEAL_ACTION_1"))}</span>\n\t\t`}function Ei(){const e=babelHelpers.classPrivateFieldLooseBase(this,hi)[hi].getCheckedId();return e.map((e=>"DEAL_"+e))}function Ii(e,s){let t="";e.errors.forEach((e=>{t=t+"\n"+e.message}));const a=new pi({target:this.actionPanel.getItemById(s).layout.container,title:t,article:"limit_office_bp_designer"});babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi].push(a);a.start()}var wi=babelHelpers.classPrivateFieldLooseKey("pullHandlers");var Si=babelHelpers.classPrivateFieldLooseKey("settings");var Di=babelHelpers.classPrivateFieldLooseKey("mainView");var Ci=babelHelpers.classPrivateFieldLooseKey("triggers");var Ri=babelHelpers.classPrivateFieldLooseKey("template");var Ni=babelHelpers.classPrivateFieldLooseKey("documentStatus");var Ai=babelHelpers.classPrivateFieldLooseKey("statusList");var xi=babelHelpers.classPrivateFieldLooseKey("documentCategoryId");var Gi=babelHelpers.classPrivateFieldLooseKey("documentFields");var ji=babelHelpers.classPrivateFieldLooseKey("documentValues");var Ki=babelHelpers.classPrivateFieldLooseKey("workflowId");var Mi=babelHelpers.classPrivateFieldLooseKey("workflowStatus");var ki=babelHelpers.classPrivateFieldLooseKey("workflowEvents");var zi=babelHelpers.classPrivateFieldLooseKey("workflowTrack");var $i=babelHelpers.classPrivateFieldLooseKey("debuggerState");var Ui=babelHelpers.classPrivateFieldLooseKey("customActionPanel");var Vi=babelHelpers.classPrivateFieldLooseKey("resumeShowActionPanel");var Ji=babelHelpers.classPrivateFieldLooseKey("shouldSetCustomActionPanel");var Zi=babelHelpers.classPrivateFieldLooseKey("initAutomationContext");var Wi=babelHelpers.classPrivateFieldLooseKey("subscribePull");var Xi=babelHelpers.classPrivateFieldLooseKey("unsubscribePull");var Yi=babelHelpers.classPrivateFieldLooseKey("handleRejectResponse");var qi=babelHelpers.classPrivateFieldLooseKey("onAfterDocumentFixed");class Qi extends h.EventEmitter{constructor(e={}){super();Object.defineProperty(this,qi,{value:rl});Object.defineProperty(this,Yi,{value:ll});Object.defineProperty(this,Xi,{value:il});Object.defineProperty(this,Wi,{value:al});Object.defineProperty(this,Zi,{value:tl});Object.defineProperty(this,Ji,{value:sl});Object.defineProperty(this,Vi,{value:el});this.session=null;Object.defineProperty(this,wi,{writable:true,value:null});Object.defineProperty(this,Si,{writable:true,value:void 0});Object.defineProperty(this,Di,{writable:true,value:void 0});Object.defineProperty(this,Ci,{writable:true,value:void 0});Object.defineProperty(this,Ri,{writable:true,value:void 0});Object.defineProperty(this,Ni,{writable:true,value:void 0});Object.defineProperty(this,Ai,{writable:true,value:void 0});Object.defineProperty(this,xi,{writable:true,value:0});Object.defineProperty(this,Gi,{writable:true,value:void 0});Object.defineProperty(this,ji,{writable:true,value:{}});Object.defineProperty(this,Ki,{writable:true,value:void 0});Object.defineProperty(this,Mi,{writable:true,value:void 0});Object.defineProperty(this,ki,{writable:true,value:[]});Object.defineProperty(this,zi,{writable:true,value:[]});Object.defineProperty(this,$i,{writable:true,value:void 0});Object.defineProperty(this,Ui,{writable:true,value:null});this.setEventNamespace("BX.Bizproc.Debugger.Automation");this.session=e.session;if(this.session.isActive()){this.session.subscribeOnce("onAfterDocumentFixed",babelHelpers.classPrivateFieldLooseBase(this,qi)[qi].bind(this));this.session.subscribe("onFinished",this.destroy.bind(this));babelHelpers.classPrivateFieldLooseBase(this,Wi)[Wi]()}babelHelpers.classPrivateFieldLooseBase(this,Si)[Si]=new g.Settings("atm-dbg");babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi]();babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]()}destroy(){var e,s;this.unsubscribeAll();babelHelpers.classPrivateFieldLooseBase(this,Xi)[Xi]();(e=babelHelpers.classPrivateFieldLooseBase(this,Di)[Di])==null?void 0:e.destroy();this.session=null;babelHelpers.classPrivateFieldLooseBase(this,Si)[Si]=null;babelHelpers.classPrivateFieldLooseBase(this,Di)[Di]=null;babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]=[];babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=null;babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]=[];babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]=[];babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]={};babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=null;babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]=0;babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=[];babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=[];(s=babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui])==null?void 0:s.stopActionPanel()}get track(){return babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]}get settings(){return babelHelpers.classPrivateFieldLooseBase(this,Si)[Si]}get documentSigned(){return this.session.documentSigned}get sessionId(){return this.session.id}get workflowId(){return babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]}get pullHandlers(){if(babelHelpers.classPrivateFieldLooseBase(this,wi)[wi]===null){babelHelpers.classPrivateFieldLooseBase(this,wi)[wi]=[{name:"documentStatus",func:this.handleExternalDocumentStatus.bind(this)},{name:"documentValues",func:this.handleExternalDocumentValues.bind(this)},{name:"documentDelete",func:this.handleExternalDocumentDelete.bind(this)},{name:"workflowStatus",func:this.handleExternalWorkflowStatus.bind(this)},{name:"workflowEventAdd",func:this.handleExternalWorkflowEventAdd.bind(this)},{name:"workflowEventRemove",func:this.handleExternalWorkflowEventRemove.bind(this)},{name:"trackRow",func:this.handleExternalTrackRow.bind(this)}]}return babelHelpers.classPrivateFieldLooseBase(this,wi)[wi]}getMainView(){if(!babelHelpers.classPrivateFieldLooseBase(this,Di)[Di]){babelHelpers.classPrivateFieldLooseBase(this,Di)[Di]=new we(this)}return babelHelpers.classPrivateFieldLooseBase(this,Di)[Di]}getLogView(){return new Za(this)}getStatusList(){return babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]}getDocumentFields(){return babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]}getDocumentField(e){return babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi].find((s=>s.Id===e))}getDocumentValue(e){return babelHelpers.classPrivateFieldLooseBase(this,ji)[ji][e]||null}getDocumentStatus(){return babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]}getWorkflowStatus(){return babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]}getState(){return babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]}hasWorkflowEvents(){return babelHelpers.classPrivateFieldLooseBase(this,ki)[ki].length>0}setDocumentStatus(e){return new Promise((s=>{P.ajax.runAction("bizproc.debugger.setDocumentStatus",{data:{statusId:e}}).then((e=>{if(e.data&&e.data.newStatus){babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=e.data.newStatus;babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]=e.data.template;babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=[];this.emit("onDocumentStatusChanged")}s(e)}),babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi].bind(this))}))}get templateTriggers(){return babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci].filter((e=>e["DOCUMENT_STATUS"]===babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]["DOCUMENT_STATUS"]))}getTemplate(){return babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]}isTemplateEmpty(){return babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri].IS_EXTERNAL_MODIFIED===false&&!P.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri].ROBOTS)}startDebugTemplate(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.resumeAutomationTemplate",{data:{sessionId:this.sessionId},analyticsLabel:"automation_start_debug"}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]=s.data.debuggerState;e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi].bind(this))}))}emulateExternalEvent(){return new Promise((e=>{const s=babelHelpers.classPrivateFieldLooseBase(this,ki)[ki][0];if(!s){return}P.ajax.runAction("bizproc.debugger.emulateExternalEvent",{data:{workflowId:babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki],eventId:s}}).then((s=>{e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi].bind(this))}))}loadMainViewInfo(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.fillAutomationView",{data:{sessionId:this.sessionId}}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci]=s.data.triggers;babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]=s.data.template;babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=s.data.documentStatus;babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]=s.data.statusList;babelHelpers.classPrivateFieldLooseBase(this,xi)[xi]=s.data.documentCategoryId;babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]=s.data.documentFields;babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]=s.data.documentValues;babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]=s.data.workflowStatus;babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=s.data.workflowEvents;babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=s.data.track;babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]=s.data.debuggerState;u.getGlobalContext().document.setFields(this.getDocumentFields()).setStatusList(this.getStatusList()).setStatus(this.getDocumentStatus());e()}),babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi].bind(this))}))}loadAllLog(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.loadAllLog",{data:{sessionId:this.session.id}}).then((s=>{e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi].bind(this))}))}loadRobotsByWorkflowId(e){return new Promise(((s,t)=>{P.ajax.runAction("bizproc.debugger.loadRobotsByWorkflowId",{data:{sessionId:this.sessionId,workflowId:e}}).then((e=>{s(e.data)}),(e=>{t(e.data)}))}))}handleExternalDocumentStatus(e){const s=e.getData().status;if(this.getDocumentStatus()===s){return}console.info("document status: "+s);babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=s;this.emit("onDocumentStatusChanged")}handleExternalDocumentValues(e){const s=e.getData().values;Object.keys(s).forEach((e=>babelHelpers.classPrivateFieldLooseBase(this,ji)[ji][e]=s[e]));console.info("document values: "+Object.keys(s));this.emit("onDocumentValuesUpdated",{values:s})}handleExternalDocumentDelete(){b.MessageBox.show({message:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_ON_DOCUMENT_DELETE"),okCaption:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),onOk:()=>jl.Instance.finishSession(this.session).then(null,babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi].bind(this)),buttons:b.MessageBoxButtons.OK_CANCEL})}handleExternalTrackRow(e){const s=e.getData().row;s["WORKFLOW_STATUS"]=babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi];babelHelpers.classPrivateFieldLooseBase(this,zi)[zi].push(s);this.emit("onWorkflowTrackAdded",{row:s})}handleExternalWorkflowStatus(e){const s=e.getData().status;const t=e.getData().workflowId;babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]=s;if(s===u.WorkflowStatus.RUNNING){babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=t}if(babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]!==t){return}console.info("workflow status: "+s);this.emit("onWorkflowStatusChanged",{status:s,workflowId:t})}handleExternalWorkflowEventAdd(e){const s=e.getData().eventName;console.info("workflow event added: "+s);babelHelpers.classPrivateFieldLooseBase(this,ki)[ki].push(s);console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,ki)[ki].join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]})}handleExternalWorkflowEventRemove(e){const s=e.getData().eventName;console.info("workflow event removed: "+s);babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=babelHelpers.classPrivateFieldLooseBase(this,ki)[ki].filter((e=>e!==s));console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,ki)[ki].join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]})}getField(e,s){let t;switch(e){case"Document":t=babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi].find((e=>e.Id===s));break;case"Template":case"Parameter":case"Constant":case"GlobalConst":case"GlobalVar":break}return t||{Id:s,ObjectId:e,Name:s,Type:"string",Expression:s,SystemExpression:"{="+e+":"+s+"}"}}getSettingsUrl(){return`/crm/deal/automation/${babelHelpers.classPrivateFieldLooseBase(this,xi)[xi]}/`}}function el(){if(this.session.isInterceptionMode()&&!this.session.isFixed()){if(P.Reflection.getClass("BX.CRM.Kanban.Grid")){const e=BX.CRM.Kanban.Grid.getInstance();if(babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji](e)){babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]=new _i(e,this);e.stopActionPanel(true);e.resetActionPanel();e.setCustomActionPanel(babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui].actionPanel)}}}}function sl(e){const s=e.getData();const t=s.entityType;if(t!=="DEAL"){return false}const a=s.params.hasOwnProperty("CATEGORY_ID")?P.Text.toInteger(s.params.CATEGORY_ID):0;return this.session.initialCategoryId===a}function tl(){const e=new u.Context({document:new u.Document({rawDocumentType:[],documentId:null,categoryId:0,statusList:this.getStatusList(),statusId:this.getDocumentStatus(),documentFields:this.getDocumentFields()}),documentSigned:this.documentSigned,canEdit:false,canManage:false});u.setGlobalContext(e)}function al(){const e=jl.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.subscribe(s,t)}))}function il(){if(babelHelpers.classPrivateFieldLooseBase(this,wi)[wi]===null){return}const e=jl.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.unsubscribe(s,t)}));babelHelpers.classPrivateFieldLooseBase(this,wi)[wi]=null}function ll(e){if(P.Type.isArrayFilled(e.errors)){const s=e.errors.find((e=>e.code===404));if(s){this.handleExternalDocumentDelete()}else{const s=e.errors.map((e=>e.message)).join("\n");b.MessageBox.alert(s)}}}function rl(){this.loadMainViewInfo().then((()=>{this.emit("onAfterDocumentFixed")}))}var ol=babelHelpers.classPrivateFieldLooseKey("unsubscribe");var nl=babelHelpers.classPrivateFieldLooseKey("commands");var dl=babelHelpers.classPrivateFieldLooseKey("handleCommand");class cl extends h.EventEmitter{constructor(){super();Object.defineProperty(this,dl,{value:bl});Object.defineProperty(this,ol,{writable:true,value:void 0});Object.defineProperty(this,nl,{writable:true,value:["documentStatus","documentValues","documentDelete","workflowStatus","workflowEventAdd","workflowEventRemove","trackRow","sessionFinish"]});this.setEventNamespace("BX.Bizproc.Debugger.Pull");babelHelpers.classPrivateFieldLooseBase(this,ol)[ol]=v.PULL.subscribe(this)}destroy(){if(P.Type.isFunction(babelHelpers.classPrivateFieldLooseBase(this,ol)[ol])){babelHelpers.classPrivateFieldLooseBase(this,ol)[ol]()}babelHelpers.classPrivateFieldLooseBase(this,ol)[ol]=null}getModuleId(){return"bizproc"}getSubscriptionType(){return BX.PullClient.SubscriptionType.Server}getMap(){const e={};babelHelpers.classPrivateFieldLooseBase(this,nl)[nl].forEach((s=>{e[s]=babelHelpers.classPrivateFieldLooseBase(this,dl)[dl].bind(this)}));return e}}function bl(e,s,t){this.emit(t,e)}var ul=babelHelpers.classPrivateFieldLooseKey("getText");class pl{constructor(e){var s;this.guide=new L.Guide({steps:[{target:e.target,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TITLE"),text:babelHelpers.classPrivateFieldLooseBase(pl,ul)[ul](),article:"16087180",events:(s=e.events)!=null?s:{},condition:{top:true,bottom:false,color:"primary"}}],onEvents:true});this.bindEvents()}bindEvents(){}start(){this.guide.getPopup().setWidth(365);this.guide.showNextStep()}}function vl(){return`\n\t\t\t<ul class="bizproc-debugger-filter-guide-list">\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${B.toHtml(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_1"))}\n\t\t\t\t</li>\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${B.toHtml(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_2"))}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`}Object.defineProperty(pl,ul,{value:vl});var gl=babelHelpers.classPrivateFieldLooseKey("getText");class hl{constructor(e){var s;this.guide=new L.Guide({steps:[{target:e.target,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TITLE"),text:babelHelpers.classPrivateFieldLooseBase(hl,gl)[gl](),article:"16483018",events:(s=e.events)!=null?s:{},condition:{top:true,bottom:false,color:"primary"}}],onEvents:true})}start(){this.guide.getPopup().setWidth(330);this.guide.showNextStep()}}function Pl(){return`\n\t\t\t<ul class="bizproc-debugger-filter-guide-list">\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_1")}\n\t\t\t\t</li>\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_2")}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`}Object.defineProperty(hl,gl,{value:Pl});var Ll=babelHelpers.classPrivateFieldLooseKey("grid");var Fl=babelHelpers.classPrivateFieldLooseKey("guides");var Bl=babelHelpers.classPrivateFieldLooseKey("reserveFilterIds");var Hl=babelHelpers.classPrivateFieldLooseKey("getStageGuide");var fl=babelHelpers.classPrivateFieldLooseKey("getFilterGuide");class ml extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,fl,{value:yl});Object.defineProperty(this,Hl,{value:_l});Object.defineProperty(this,Ll,{writable:true,value:null});Object.defineProperty(this,Fl,{writable:true,value:[]});Object.defineProperty(this,Bl,{writable:true,value:[]});this.setEventNamespace("BX.Bizproc.Debugger.CrmDebuggerGuide");babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll]=e.grid;babelHelpers.classPrivateFieldLooseBase(this,Bl)[Bl]=e.reserveFilterIds;if(e.showStageStep){const e=babelHelpers.classPrivateFieldLooseBase(this,Hl)[Hl]();if(e){babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl].push(e)}}if(e.showFilterStep){const e=babelHelpers.classPrivateFieldLooseBase(this,fl)[fl]();if(e){babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl].push(e)}}}start(){if(babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl].length<=0){return}babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl][babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl].length-1].start()}}function _l(){if(!babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll]){return}const e=babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].getColumns()[0];if(!e){return null}const s=e.getTitleContainer();if(!s){return null}const t=babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl][babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl].length-1];return new hl({target:"."+s.classList[0],events:{onShow:function(){this.emit("onStageGuideStepShow")}.bind(this),onClose:function(){if(t){t.start()}this.emit("onStageGuideStepClose")}.bind(this)}})}function yl(){var e,s;const t=babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll]?[babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].getData().gridId]:babelHelpers.classPrivateFieldLooseBase(this,Bl)[Bl];if(t.length<=0){return null}let a;for(const e in t){a=BX.Main.filterManager.getById(t[e]);if(a){break}}if(!a){return null}const i=a.getApi();const l=i==null?void 0:(e=i.parent)==null?void 0:(s=e.getPopupBindElement())==null?void 0:s.firstElementChild;if(!l){return null}const r=babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl][babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl].length-1];return new pl({target:l,events:{onShow:function(){this.emit("onFilterGuideStepShow")}.bind(this),onClose:function(){if(r){r.start()}this.emit("onFilterGuideStepClose")}.bind(this)}})}let Tl=null;var Ol=babelHelpers.classPrivateFieldLooseKey("settings");var El=babelHelpers.classPrivateFieldLooseKey("showDebugger");var Il=babelHelpers.classPrivateFieldLooseKey("showGuide");var wl=babelHelpers.classPrivateFieldLooseKey("setDebugFilter");var Sl=babelHelpers.classPrivateFieldLooseKey("removeDebugFilter");var Dl=babelHelpers.classPrivateFieldLooseKey("lastFilterId");var Cl=babelHelpers.classPrivateFieldLooseKey("getFilterApis");var Rl=babelHelpers.classPrivateFieldLooseKey("getFilterIds");var Nl=babelHelpers.classPrivateFieldLooseKey("isFilterGuideShown");var Al=babelHelpers.classPrivateFieldLooseKey("isStageGuideShown");var xl=babelHelpers.classPrivateFieldLooseKey("setFilterGuideShown");var Gl=babelHelpers.classPrivateFieldLooseKey("setStageGuideShown");class jl{static get Instance(){if(Tl===null){Tl=new jl}return Tl}constructor(){Object.defineProperty(this,Gl,{value:Yl});Object.defineProperty(this,xl,{value:Xl});Object.defineProperty(this,Al,{value:Wl});Object.defineProperty(this,Nl,{value:Zl});Object.defineProperty(this,Rl,{value:Jl});Object.defineProperty(this,Cl,{value:Vl});Object.defineProperty(this,Dl,{get:$l,set:Ul});Object.defineProperty(this,Sl,{value:zl});Object.defineProperty(this,wl,{value:kl});Object.defineProperty(this,Il,{value:Ml});Object.defineProperty(this,El,{value:Kl});Object.defineProperty(this,Ol,{writable:true,value:void 0});this.pullHandler=new cl;babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol]=new g.Settings("manager")}initializeDebugger(e={session:{},documentSigned:""}){const s=P.Type.isPlainObject(e.session)?new Ks(e.session):null;if(!s){return}s.documentSigned=e.documentSigned;this.requireSetFilter(s);babelHelpers.classPrivateFieldLooseBase(this,El)[El](s)}startSession(e,s){return new Promise(((t,a)=>{Ks.start(e,s).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,Dl)[Dl]=null;babelHelpers.classPrivateFieldLooseBase(this,wl)[wl](e);const s=babelHelpers.classPrivateFieldLooseBase(this,El)[El](e,true);babelHelpers.classPrivateFieldLooseBase(this,Il)[Il](s);t()}),a)}))}finishSession(e){return new Promise(((s,t)=>{e.finish().then((t=>{babelHelpers.classPrivateFieldLooseBase(this,Sl)[Sl](e);s(t)}),t)}))}requireSetFilter(e,s=false){const t=babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl](e).pop();if(t!==babelHelpers.classPrivateFieldLooseBase(this,Dl)[Dl]||s){babelHelpers.classPrivateFieldLooseBase(this,wl)[wl](e)}}createAutomationDebugger(e={}){return new Qi(e)}openDebuggerStartPage(e,s={}){const t=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.start/",{documentSigned:e,analyticsLabel:{automation_enter_debug:"Y",start_type:s.analyticsStartType||"default"}});const a={width:745,cacheable:false,allowChangeHistory:true,events:{}};return jl.openSlider(t,a)}openSessionLog(e){const s=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.log/",{setTitle:"Y",sessionId:e});const t={width:720,cacheable:false,allowChangeHistory:true,events:{},newWindowLabel:true};return jl.openSlider(s,t)}static openSlider(e,s){if(!P.Type.isPlainObject(s)){s={}}s={...{cacheable:false,allowChangeHistory:true,events:{}},...s};return new Promise(((t,a)=>{if(P.Type.isStringFilled(e)){if(BX.SidePanel.Instance.open(e,s)){return t()}return a()}return a()}))}}function Kl(e,s=false){let t=null;if(e.isAutomation()){t=this.createAutomationDebugger({session:e})}if(t){let e=t.session.isExperimentalMode()?"showExpanded":"showCollapsed";if(!babelHelpers.classPrivateFieldLooseBase(this,Nl)[Nl]()){e="showCollapsed"}t.getMainView()[s?e:"show"]();return t}return t}function Ml(e){const s=new ml({grid:P.Reflection.getClass("BX.CRM.Kanban.Grid")?BX.CRM.Kanban.Grid.getInstance():null,showFilterStep:!babelHelpers.classPrivateFieldLooseBase(this,Nl)[Nl](),showStageStep:!babelHelpers.classPrivateFieldLooseBase(this,Al)[Al]()&&e.session.isInterceptionMode(),reserveFilterIds:babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl](e.session)});s.subscribe("onFilterGuideStepShow",babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].bind(this,true));s.subscribe("onStageGuideStepShow",babelHelpers.classPrivateFieldLooseBase(this,Gl)[Gl].bind(this,true));s.subscribe("onFilterGuideStepClose",(()=>{if(e.session&&e.session.isExperimentalMode()&&e.settings.get("popup-collapsed")===true){e.getMainView().showExpanded()}}));s.start()}function kl(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl](e);babelHelpers.classPrivateFieldLooseBase(this,Cl)[Cl](s).forEach((({id:e,api:s})=>{s.setFilter({preset_id:"filter_robot_debugger"});babelHelpers.classPrivateFieldLooseBase(this,Dl)[Dl]=e}))}function zl(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl](e);babelHelpers.classPrivateFieldLooseBase(this,Cl)[Cl](s).forEach((({api:e})=>{e.setFilter({preset_id:"default_filter"});babelHelpers.classPrivateFieldLooseBase(this,Dl)[Dl]=null}))}function $l(){return babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol].get("last-filter-id")}function Ul(e){return babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol].set("last-filter-id",e)}function Vl(e){const s=[];e.forEach((e=>{var t;const a=(t=BX.Main.filterManager)==null?void 0:t.getById(e);if(a){s.push({id:e,api:a.getApi()})}}));return s}function Jl(e){let s;if(e&&e.modeId===vs.interception.id&&!e.isFixed()){s=e.initialCategoryId}else{var t;s=e==null?void 0:(t=e.activeDocument)==null?void 0:t.categoryId}const a="CRM_DEAL_LIST_V12";if(!s){return[a,`${a}_C_0`]}return[`${a}_C_${s}`]}function Zl(){return babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol].get("filter-guide-shown")===true}function Wl(){return babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol].get("stage-guide-shown")===true}function Xl(e=true){babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol].set("filter-guide-shown",e)}function Yl(e=true){babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol].set("stage-guide-shown",e)}const ql={Manager:jl,Session:Ks,Mode:vs};e.Debugger=ql;e.Manager=jl;e.Session=Ks;e.Mode=vs})(this.BX.Bizproc.Debugger=this.BX.Bizproc.Debugger||{},BX.Main,BX.UI,BX,BX.UI.EntitySelector,BX,BX.UI,BX,BX.Main,BX,BX,BX.UI.Dialogs,BX.Bizproc.Automation,BX.Bizproc.Debugger,BX,BX.Bizproc.LocalSettings,BX.Event,BX,BX.UI.Tour);
//# sourceMappingURL=debugger.bundle.map.js