this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,s,t,a,i,l,r,o,n,d,c,b,u,p,v,g,h,P,L){"use strict";class F{}F.Run=0;F.NextStep=1;F.Stop=2;F.Pause=3;F.Undefined=-1;class B{static isNumeric(e){if(P.Type.isNumber(e)){return true}if(!P.Type.isStringFilled(e)){return false}return Number(e).toString()===e.trim()}static isDate(e){if(P.Type.isDate(e)){return true}if(!B.isNumeric(e)){return false}return new Date(Number(e)).getTime()===Number(e)}static convertDateFromDB(e){if(!B.isNumeric(e)){return null}return new Date(e*1e3)}static toDate(e){if(Date.parse(e)){return new Date(e)}if(!B.isDate(e)){return null}if(P.Type.isDate(e)){return e}return B.convertDateFromDB(e)}static formatDate(e,s){if(!P.Type.isStringFilled(e)){e="j F Y H:i:s"}return n.DateTimeFormat.format(e,s)}static getOperatorsLabel(){return{"!empty":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_EMPTY"),empty:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_EMPTY"),"=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_EQ"),"!=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NE"),in:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_IN"),"!in":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_IN"),contain:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_CONTAIN"),"!contain":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_CONTAIN"),">":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_GT"),">=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_GTE"),"<":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_LT"),"<=":P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_LTE")}}static getOperatorLabel(e){return B.getOperatorsLabel()[e]}static getJoinerLabel(e){const s={AND:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_AND"),OR:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_OR")};return s[e]}static getColorBrightness(e){if(e[0]==="#"){e=e.replace("#","")}const s=parseInt(e,16);const t=s>>16&255;const a=s>>8&255;const i=s&255;return.21*t+.72*a+.07*i}static getBgColorAdditionalClass(e){const s=B.getColorBrightness(e);if(s>224){return"--with-border --light-color"}if(s>145){return"--light-color"}return""}static toHtml(e){return P.Text.encode(e||"").replace(/\[(\/)?b\]/gi,"<$1b>")}}let H=e=>e,f,m,_,y,T,O,E,I,w,S,D;var C=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var R=babelHelpers.classPrivateFieldLooseKey("popupInstance");var N=babelHelpers.classPrivateFieldLooseKey("loaded");var A=babelHelpers.classPrivateFieldLooseKey("node");var x=babelHelpers.classPrivateFieldLooseKey("triggerManager");var G=babelHelpers.classPrivateFieldLooseKey("template");var j=babelHelpers.classPrivateFieldLooseKey("tracker");var K=babelHelpers.classPrivateFieldLooseKey("tabs");var M=babelHelpers.classPrivateFieldLooseKey("expandedMinWidth");var k=babelHelpers.classPrivateFieldLooseKey("expandedMinHeight");var z=babelHelpers.classPrivateFieldLooseKey("collapsedMinWidth");var $=babelHelpers.classPrivateFieldLooseKey("collapsedMinHeight");var U=babelHelpers.classPrivateFieldLooseKey("changingViewTimeout");var V=babelHelpers.classPrivateFieldLooseKey("buttonPlay");var J=babelHelpers.classPrivateFieldLooseKey("getPopup");var Z=babelHelpers.classPrivateFieldLooseKey("getPopupWidth");var W=babelHelpers.classPrivateFieldLooseKey("getPopupHeight");var X=babelHelpers.classPrivateFieldLooseKey("getPopupTitleBar");var Y=babelHelpers.classPrivateFieldLooseKey("handleClose");var q=babelHelpers.classPrivateFieldLooseKey("getNode");var Q=babelHelpers.classPrivateFieldLooseKey("renderExpandedMode");var ee=babelHelpers.classPrivateFieldLooseKey("renderCollapsedMode");var se=babelHelpers.classPrivateFieldLooseKey("getAddFieldNode");var te=babelHelpers.classPrivateFieldLooseKey("getFieldListNode");var ae=babelHelpers.classPrivateFieldLooseKey("handleChangeTab");var ie=babelHelpers.classPrivateFieldLooseKey("handleAddDocFieldMenu");var le=babelHelpers.classPrivateFieldLooseKey("handleAddField");var re=babelHelpers.classPrivateFieldLooseKey("handleRemoveField");var oe=babelHelpers.classPrivateFieldLooseKey("handleFieldListChange");var ne=babelHelpers.classPrivateFieldLooseKey("getFieldNode");var de=babelHelpers.classPrivateFieldLooseKey("createTriggersHeaderNode");var ce=babelHelpers.classPrivateFieldLooseKey("createTriggersNode");var be=babelHelpers.classPrivateFieldLooseKey("createTemplateNode");var ue=babelHelpers.classPrivateFieldLooseKey("updateTemplate");var pe=babelHelpers.classPrivateFieldLooseKey("createTemplateToolbar");var ve=babelHelpers.classPrivateFieldLooseKey("handleStartTemplate");var ge=babelHelpers.classPrivateFieldLooseKey("handleEmulateExternalEvent");var he=babelHelpers.classPrivateFieldLooseKey("updateTracker");var Pe=babelHelpers.classPrivateFieldLooseKey("createStageNode");var Le=babelHelpers.classPrivateFieldLooseKey("handleShowStages");var Fe=babelHelpers.classPrivateFieldLooseKey("handleChangeStatus");var Be=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusTitle");var He=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusColor");var fe=babelHelpers.classPrivateFieldLooseKey("onDocumentStatusChanged");var me=babelHelpers.classPrivateFieldLooseKey("onWorkflowEventsChanged");var _e=babelHelpers.classPrivateFieldLooseKey("onWorkflowTrackAdded");var ye=babelHelpers.classPrivateFieldLooseKey("onDocumentValuesUpdated");var Te=babelHelpers.classPrivateFieldLooseKey("onWorkflowStatusChange");var Oe=babelHelpers.classPrivateFieldLooseKey("onAfterDocumentFixed");var Ee=babelHelpers.classPrivateFieldLooseKey("setDebuggerState");class Ie extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,Ee,{value:bs});Object.defineProperty(this,Oe,{value:cs});Object.defineProperty(this,Te,{value:ds});Object.defineProperty(this,ye,{value:ns});Object.defineProperty(this,_e,{value:os});Object.defineProperty(this,me,{value:rs});Object.defineProperty(this,fe,{value:ls});Object.defineProperty(this,He,{value:is});Object.defineProperty(this,Be,{value:as});Object.defineProperty(this,Fe,{value:ts});Object.defineProperty(this,Le,{value:ss});Object.defineProperty(this,Pe,{value:es});Object.defineProperty(this,he,{value:Qe});Object.defineProperty(this,ge,{value:qe});Object.defineProperty(this,ve,{value:Ye});Object.defineProperty(this,pe,{value:Xe});Object.defineProperty(this,ue,{value:We});Object.defineProperty(this,be,{value:Ze});Object.defineProperty(this,ce,{value:Je});Object.defineProperty(this,de,{value:Ve});Object.defineProperty(this,ne,{value:Ue});Object.defineProperty(this,oe,{value:$e});Object.defineProperty(this,re,{value:ze});Object.defineProperty(this,le,{value:ke});Object.defineProperty(this,ie,{value:Me});Object.defineProperty(this,ae,{value:Ke});Object.defineProperty(this,te,{value:je});Object.defineProperty(this,se,{value:Ge});Object.defineProperty(this,ee,{value:xe});Object.defineProperty(this,Q,{value:Ae});Object.defineProperty(this,q,{value:Ne});Object.defineProperty(this,Y,{value:Re});Object.defineProperty(this,X,{value:Ce});Object.defineProperty(this,W,{value:De});Object.defineProperty(this,Z,{value:Se});Object.defineProperty(this,J,{value:we});Object.defineProperty(this,C,{writable:true,value:void 0});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,N,{writable:true,value:false});Object.defineProperty(this,A,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:void 0});Object.defineProperty(this,G,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:["doc","log"]});Object.defineProperty(this,M,{writable:true,value:781});Object.defineProperty(this,k,{writable:true,value:612});Object.defineProperty(this,z,{writable:true,value:465});Object.defineProperty(this,$,{writable:true,value:187});Object.defineProperty(this,U,{writable:true,value:void 0});Object.defineProperty(this,V,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.AutomationMainView");babelHelpers.classPrivateFieldLooseBase(this,C)[C]=e;e.subscribe("onDocumentStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].bind(this));e.subscribe("onWorkflowEventsChanged",babelHelpers.classPrivateFieldLooseBase(this,me)[me].bind(this));e.subscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].bind(this));e.subscribe("onDocumentValuesUpdated",babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].bind(this));e.subscribe("onWorkflowStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].bind(this));e.subscribe("onAfterDocumentFixed",babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].bind(this))}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,C)[C]}show(){if(babelHelpers.classPrivateFieldLooseBase(this,N)[N]){babelHelpers.classPrivateFieldLooseBase(this,J)[J]().show();return}this.debugger.loadMainViewInfo().then((()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N]=true;babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setContent(babelHelpers.classPrivateFieldLooseBase(this,q)[q]());babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](this.debugger.getState());babelHelpers.classPrivateFieldLooseBase(this,J)[J]().show()}))}showExpanded(){this.debugger.settings.set("popup-collapsed",false);this.show()}showCollapsed(){this.debugger.settings.set("popup-collapsed",true);this.show()}close(){babelHelpers.classPrivateFieldLooseBase(this,J)[J]().close()}destroy(){this.close()}handleCollapse(){const e=babelHelpers.classPrivateFieldLooseBase(this,J)[J]().getPopupContainer();const s=P.Dom.hasClass(e,"--collapse");this.debugger.settings.set("popup-collapsed",!s);babelHelpers.classPrivateFieldLooseBase(this,J)[J]().getZIndexComponent().setAlwaysOnTop(!s);babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setResizeMode(s);P.Dom.toggleClass(e,"--collapse");clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,U)[U]);P.Dom.addClass(e,"--changing-view");babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setWidth(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](!s));babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setHeight(babelHelpers.classPrivateFieldLooseBase(this,W)[W](!s));babelHelpers.classPrivateFieldLooseBase(this,U)[U]=setTimeout((()=>P.Dom.removeClass(e,"--changing-view")),500)}}function we(){if(!babelHelpers.classPrivateFieldLooseBase(this,R)[R]){const e=this.debugger.settings.get("popup-collapsed");const t="bizproc-debugger-automation__main-popup bizproc-debugger-automation__scope";babelHelpers.classPrivateFieldLooseBase(this,R)[R]=new s.Popup({className:t+(e?" --collapse":""),titleBar:babelHelpers.classPrivateFieldLooseBase(this,X)[X](),noAllPaddings:true,contentBackground:"white",draggable:true,zIndexOptions:{alwaysOnTop:e},width:babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](e),height:babelHelpers.classPrivateFieldLooseBase(this,W)[W](e),events:{onResizeStart:()=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinWidth(babelHelpers.classPrivateFieldLooseBase(this,M)[M]);babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinHeight(babelHelpers.classPrivateFieldLooseBase(this,k)[k])},onResizeEnd:()=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinWidth(null);babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinHeight(null);this.debugger.settings.set("popup-width",babelHelpers.classPrivateFieldLooseBase(this,R)[R].getWidth());this.debugger.settings.set("popup-height",babelHelpers.classPrivateFieldLooseBase(this,R)[R].getHeight())}}});babelHelpers.classPrivateFieldLooseBase(this,R)[R].setResizeMode(!e)}return babelHelpers.classPrivateFieldLooseBase(this,R)[R]}function Se(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,z)[z]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,M)[M],this.debugger.settings.get("popup-width")||0)}function De(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,$)[$]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,k)[k],this.debugger.settings.get("popup-height")||0)}function Ce(){return{content:P.Tag.render(f||(f=H`
				<div class="popup-window-titlebar-text bizproc-debugger-automation__titlebar">
					<div class="bizproc-debugger-automation__titlebar--move-icon"></div>
					${0}
					<div 
						class="bizproc-debugger-automation__titlebar--button-collapse" 
						onclick="${0}"
					></div>
					<span 
						class=" popup-window-close-icon 
								popup-window-titlebar-close-icon 
								bizproc-debugger-automation__titlebar--button-close"
						onclick="${0}"
					></span>
				</div>
			`),document.createTextNode(P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_POPUP_TITLE")),this.handleCollapse.bind(this),babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].bind(this))}}function Re(){u.MessageBox.show({message:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_FINISH_SESSION"),okCaption:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),onOk:()=>v.Manager.Instance.finishSession(this.debugger.session),buttons:u.MessageBoxButtons.OK_CANCEL})}function Ne(){if(!babelHelpers.classPrivateFieldLooseBase(this,A)[A]){babelHelpers.classPrivateFieldLooseBase(this,A)[A]=P.Tag.render(m||(m=H`
				<div class="bizproc-debugger-automation__content">
					<div class="bizproc-debugger-automation-content-collapsed">
						${0}
					</div>
					<div class="bizproc-debugger-automation__content-expanded">
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee](),babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]());p.HelpHint.bindAll(babelHelpers.classPrivateFieldLooseBase(this,A)[A])}return babelHelpers.classPrivateFieldLooseBase(this,A)[A]}function Ae(){var e,s;const t=!this.debugger.isTemplateEmpty();const a=this.debugger.settings.get("tab")==="log"?"log":"doc";const i=a==="doc"?"--active":"";const l=a==="log"?"--active":"";const r=this.debugger.session.isFixed();const o=r?"":"--empty --active";const n=babelHelpers.classPrivateFieldLooseBase(this,te)[te]();const d=n.querySelector("[data-field-id]")!==null;return P.Tag.render(_||(_=H`
				<div class="bizproc-debugger-automation__main">
					<div class="bizproc-debugger-automation__main-robots">
						<div class="bizproc-debugger-automation__main-robots--head">
							${0}
						</div>
						<div data-role="automation-content" class="bizproc-debugger-automation__main-robots--main-content">
							${0}
							${0}
							<div class="bizproc-debugger-automation__head">
								<div class="bizproc-debugger-automation__main--title">
									<div class="bizproc-debugger-automation__main--name">${0} </div>
									<div class="ui-hint">
										<span class="ui-hint-icon" data-text="${0}"></span>
									</div>
								</div>
								<div data-role="no-template" class="bizproc-debugger-automation__main-hint ${0}">
									<div class="bizproc-debugger-automation__main-hint--title">
										${0}
									</div>
									<div class="bizproc-debugger-automation__main-hint--text">
										${0}
									</div>
									<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
								</div>
							</div>
							${0}
						</div>
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-fields ${0}">
						<div data-role="tabs-container" class="bizproc-debugger-automation__main-navigation --active-${0}">
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="doc" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="log" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							
							<div data-tab-item="doc" class="bizproc-debugger-automation__tab-action ${0}">
								${0}
							</div>
							
							<div data-tab-item="log" class="bizproc-debugger-automation__tab-action ${0}">
								<div class="bizproc-debugger-automation__action-btn --icon-search" style="display: none"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-log" onclick="${0}"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-note" style="display: none"></div>
							</div>
						</div>
						
						<div data-tab-item="doc" data-role="tab-content-doc" class="bizproc-debugger-tab__content ${0} ${0}">
							<div class="bizproc-debugger-tab__content--empty">
								${0}
							</div>
							<div class="bizproc-debugger-tab__content--not-empty">
								<div class="bizproc-debugger-tab__content-title">${0}</div>							
								${0}
							</div>
						</div>
						<div data-tab-item="log" class="bizproc-debugger-tab__content ${0} bizproc-debugger-automation-main-section-log">
							${0}
						</div>
						<div data-tab-item="no-document" class="bizproc-debugger-tab__content ${0} bizproc-debugger-automation-main-section-disabled">
							<div class="bizproc-debugger-tab__content--empty">
								${0}
							</div>
						</div>
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](),(e=babelHelpers.classPrivateFieldLooseBase(this,de)[de]())!=null?e:"",(s=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]())!=null?s:"",P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ROBOTS_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_ROBOT")),t?"":"--active",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_TITLE")),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_SUBTITLE")),this.debugger.getSettingsUrl(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")),babelHelpers.classPrivateFieldLooseBase(this,be)[be](),babelHelpers.classPrivateFieldLooseBase(this,pe)[pe](),r?"":"--disabled",a,i,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].bind(this),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_FIELD")),l,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].bind(this),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_LOG_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_LOG")),i,babelHelpers.classPrivateFieldLooseBase(this,se)[se](),l,(()=>{v.Manager.Instance.openSessionLog(this.debugger.sessionId)}),r?i:"",d?"":"--empty",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_FIELD_TITLE")),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),n,r?l:"",this.debugger.getLogView().shouldScrollToBottom(true).shouldLoadPreviousLog(true).render(),o,P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_FIXED_DOCUMENT")))}function xe(){return P.Tag.render(y||(y=H`
			<div class="bizproc-debugger-automation-menu__content-body">
				<div class="bizproc-debugger-automation-menu__content-body--logo"></div>
				<div class="bizproc-debugger-automation-menu__content-body--text">${0}</div>
			</div>
		`),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_SUBTITLE"))}function Ge(){return new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,noCaps:true,text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_ADD_FIELD"),onclick:babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].bind(this)}).render()}function je(){const e=P.Tag.render(T||(T=H`<div class="ui-form" data-role="doc-field-list">
			</div>`));const s=this.debugger.settings.getSet("watch-fields");s.forEach((s=>{const t=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](s);if(t){P.Dom.append(t,e)}}));return e}function Ke(e){const s=e.target.dataset.tabItem;const t=babelHelpers.classPrivateFieldLooseBase(this,K)[K].filter((e=>e!==s))[0];const a=babelHelpers.classPrivateFieldLooseBase(this,q)[q]();const i=a.querySelector('[data-role="tabs-container"]');a.querySelectorAll([`[data-tab-item="${s}"]`]).forEach((e=>P.Dom.addClass(e,"--active")));a.querySelectorAll([`[data-tab-item="${t}"]`]).forEach((e=>P.Dom.removeClass(e,"--active")));P.Dom.addClass(i,`--active-${s}`);P.Dom.removeClass(i,`--active-${t}`);this.debugger.settings.set("tab",s);this.emit("onChangeTab",{tab:s})}function Me(e,s){const t=this.debugger.getDocumentFields();const a=this.debugger.settings.getSet("watch-fields");const l=new i.EntitySelector.Dialog({targetNode:s.target,width:500,height:300,multiple:true,dropdownMode:true,enableSearch:true,cacheable:false,items:t.filter((e=>e.Watchable===true)).map((e=>({title:e.Name,id:e.Id,customData:{field:e},entityId:"bp",tabs:"recents",selected:a.has(e.Id)}))),showAvatars:false,events:{"Item:onSelect":e=>babelHelpers.classPrivateFieldLooseBase(this,le)[le](e.getData().item),"Item:onDeselect":e=>babelHelpers.classPrivateFieldLooseBase(this,re)[re](e.getData().item.getId())},compactView:true});l.show()}function ke(e){const s=this.debugger.settings.getSet("watch-fields");const t=e.getCustomData().get("field");if(s.has(t.Id)){return}const a=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](t);P.Dom.append(a,babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="doc-field-list"]'));s.add(t.Id);this.debugger.settings.set("watch-fields",s);babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](s)}function ze(e){const s=this.debugger.settings.getSet("watch-fields");if(!s.has(e)){return}s.delete(e);this.debugger.settings.set("watch-fields",s);P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector(`[data-field-id="${e}"]`));babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](s)}function $e(e){const s=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="tab-content-doc"]');const t=s.querySelector("[data-field-id]")!==null;P.Dom[t?"removeClass":"addClass"](s,"--empty")}function Ue(e){if(P.Type.isString(e)){e=this.debugger.getDocumentField(e)}if(!e||!e.Id){return null}const s=this.debugger.getDocumentValue(e.Id)||"";return P.Tag.render(O||(O=H`
			<div class="ui-form-row" data-role="field-row" data-field-id="${0}">
				<div class="ui-form-label">
					<div class="ui-ctl-label-text">${0}</div>
				</div>
				<div class="ui-form-content">
					<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-ext-after-icon">
						<input type="text" readonly class="ui-ctl-element"
						 placeholder="${0}"
						 data-role="field-value-${0}"
						 value="${0}"
						 >
						 <a class="ui-ctl-after ui-ctl-icon-clear" onclick="${0}"></a>
					</div>
				</div>
			</div>
		`),P.Text.encode(e.Id),P.Text.encode(e.Name),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_EMPTY_VALUE"),P.Text.encode(e.Id),P.Text.encode(s),babelHelpers.classPrivateFieldLooseBase(this,re)[re].bind(this,e.Id))}function Ve(){const e=this.debugger.templateTriggers.length>0;const s=!this.debugger.isTemplateEmpty();if(!e&&s){return null}return P.Tag.render(E||(E=H`
			<div data-role="triggers-header" class="bizproc-debugger-automation__head">
				<div class="bizproc-debugger-automation__main--title">
					<div class="bizproc-debugger-automation__main--name">${0} </div>
					<div class="ui-hint">
						<span class="ui-hint-icon" data-text="${0}"></span>
					</div>
				</div>
				<div data-role="no-triggers" class="bizproc-debugger-automation__main-hint ${0}">
					<div class="bizproc-debugger-automation__main-hint--title">
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-hint--text">
						${0}
					</div>
					<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
				</div>
			</div>
		`),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_TRIGGERS_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_TRIGGER")),e||s?"":"--active",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_TITLE")),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_SUBTITLE")),this.debugger.getSettingsUrl(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")))}function Je(){const e=this.debugger.getTemplate().DOCUMENT_STATUS;babelHelpers.classPrivateFieldLooseBase(this,j)[j]=new p.Tracker(p.getGlobalContext().document);const s={};s[e]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,j)[j].init(s);p.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,j)[j];const t=this.debugger.templateTriggers;if(t.length===0){return null}const a=P.Tag.render(I||(I=H`
			<div data-role="triggers" class="bizproc-debugger__template">
				<div class="bizproc-automation-status-list-item" data-type="column-trigger">
					<div data-role="trigger-list" class="bizproc-automation-trigger-list" data-status-id="${0}"></div>
				</div>
			</div>
		`),e);babelHelpers.classPrivateFieldLooseBase(this,x)[x]=new p.TriggerManager(a);babelHelpers.classPrivateFieldLooseBase(this,x)[x].init({TRIGGERS:t},p.ViewMode.view());return a}function Ze(){const e=this.debugger.getTemplate();babelHelpers.classPrivateFieldLooseBase(this,j)[j]=new p.Tracker(p.getGlobalContext().document);const s={};s[e.DOCUMENT_STATUS]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,j)[j].init(s);p.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,j)[j];const t=P.Tag.render(w||(w=H`
			<div data-role="template" class="bizproc-debugger__template">
				<div data-role="automation-template" data-status-id="${0}">
					<div data-role="robot-list" class="bizproc-automation-robot-list"></div>
				</div>
			</div>
		`),e.DOCUMENT_STATUS);const a=new p.Template({constants:{},variables:{},templateContainerNode:t,delayMinLimitM:0});a.init(e,p.ViewMode.view().intoRaw());babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](a);return t}function We(e){if(!P.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,G)[G])){babelHelpers.classPrivateFieldLooseBase(this,G)[G].destroy()}babelHelpers.classPrivateFieldLooseBase(this,G)[G]=e;return babelHelpers.classPrivateFieldLooseBase(this,G)[G]}function Xe(){babelHelpers.classPrivateFieldLooseBase(this,V)[V]=new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,icon:t.ButtonIcon.START,onclick:babelHelpers.classPrivateFieldLooseBase(this,ve)[ve].bind(this)});const e=this.debugger.hasWorkflowEvents();const s=this.debugger.session.isFixed();return P.Tag.render(S||(S=H`
			<div class="bizproc-debugger-automation__toolbar ${0}">
			<div data-role="external-event-info" class="bizproc-debugger-automation__toolbar--info-waiting ${0}">
				<div>
					${0}
				</div>
				<a onclick="${0}" class="bizproc-debugger-automation__link">
					${0}
				</a>
			</div>
			<div class="bizproc-debugger-automation__toolbar--btn-block">
				${0}
				<div class="bizproc-debugger-automation__toolbar--btn-text">
					${0}
				</div>
			</div>
			</div>
		`),s?"":"--disabled",e?"--active":"",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_SUBTITLE")),babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].bind(this),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_TITLE")),babelHelpers.classPrivateFieldLooseBase(this,V)[V].render(),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START"))}function Ye(e){e.setWaiting(true);this.debugger.startDebugTemplate().then((()=>{e.setWaiting(false);babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](this.debugger.getState())}))}function qe(e){const s=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="external-event-info"]');P.Dom.removeClass(s,"--active");this.debugger.emulateExternalEvent()}function Qe(e){if(babelHelpers.classPrivateFieldLooseBase(this,j)[j]){const e={};e[this.debugger.getDocumentStatus()]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,j)[j].reInit(e);babelHelpers.classPrivateFieldLooseBase(this,G)[G].reInit(null,p.ViewMode.view().intoRaw())}}function es(){const e=babelHelpers.classPrivateFieldLooseBase(this,He)[He]();const s=P.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]());return P.Tag.render(D||(D=H`
			<div class="bizproc-debugger-automation__status ---robot-change ${0}" data-role="document-status" title="${0}">
				<div class="bizproc-debugger-automation__status--title" data-role="document-status-title">
					${0}
				</div>
				<div class="bizproc-debugger-automation__status--bg" data-role="document-status-bg" style="background-color: ${0}; border-color: ${0};">
					<span class="bizproc-debugger-automation__status--bg-arrow"></span>
				</div>
			</div>
		`),B.getBgColorAdditionalClass(e),s,s,e,e)}function ss(e){e.preventDefault();const t=this.debugger.getStatusList();const a=new s.Menu({bindElement:e.target,items:t.map((e=>({text:e.NAME,statusId:e["STATUS_ID"],onclick:babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe].bind(this)})))});a.show()}function ts(e,s){s.getMenuWindow().destroy();this.debugger.setDocumentStatus(s.statusId)}function as(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.NAME||t.TITLE:"?"}function is(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.COLOR:"#9DCF00"}function ls(){if(!babelHelpers.classPrivateFieldLooseBase(this,J)[J]().isShown()){return}const e=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="automation-content"]');const s=new d.Loader({target:e});P.Dom.addClass(e,"--loading");s.show();this.debugger.loadMainViewInfo().then((()=>{const t=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="document-status-title"]');const a=babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]();t.textContent=a;t.parentNode.setAttribute("title",a);const i=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="document-status-bg"]');const l=babelHelpers.classPrivateFieldLooseBase(this,He)[He]();P.Dom.style(i,{backgroundColor:l,borderColor:l});const r=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="document-status"]');P.Dom.removeClass(r,["--with-border","--light-color"]);P.Dom.addClass(r,B.getBgColorAdditionalClass(l));P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="triggers-header"]'));P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="triggers"]'));P.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](),e);const o=babelHelpers.classPrivateFieldLooseBase(this,de)[de]();if(o){p.HelpHint.bindAll(o);P.Dom.prepend(o,e)}const n=babelHelpers.classPrivateFieldLooseBase(this,be)[be]();P.Dom.replace(babelHelpers.classPrivateFieldLooseBase(this,A)[A].querySelector('[data-role="template"]'),n);const d=this.debugger.templateTriggers.length>0;const c=!this.debugger.isTemplateEmpty();P.Dom[d||c?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,A)[A].querySelector('[data-role="no-triggers"]'),"--active");P.Dom[c?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,A)[A].querySelector('[data-role="no-template"]'),"--active");P.Dom.removeClass(e,"--loading");s.destroy()}))}function rs(e){if(!babelHelpers.classPrivateFieldLooseBase(this,V)[V]){return}const s=e.getData().events;const t=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector('[data-role="external-event-info"]');P.Dom[s.length?"addClass":"removeClass"](t,"--active")}function os(e){babelHelpers.classPrivateFieldLooseBase(this,he)[he](this.debugger.track)}function ns(e){if(!babelHelpers.classPrivateFieldLooseBase(this,J)[J]().isShown()){return}const s=e.getData().values;const t=babelHelpers.classPrivateFieldLooseBase(this,q)[q]();Object.keys(s).forEach((e=>{const a=t.querySelector(`[data-role="field-value-${e}"]`);if(a){a.value=s[e]||""}}))}function ds(e){const s=e.getData().status;const t=e.getData().workflowId;if([p.WorkflowStatus.COMPLETED,p.WorkflowStatus.TERMINATED].includes(s)){this.debugger.track.forEach((e=>{if(e["WORKFLOW_ID"]===t){e["WORKFLOW_STATUS"]=p.WorkflowStatus.COMPLETED}}));babelHelpers.classPrivateFieldLooseBase(this,he)[he](this.debugger.track)}}function cs(){const e=babelHelpers.classPrivateFieldLooseBase(this,J)[J]().getPopupContainer();P.Dom.removeClass(e.getElementsByClassName("bizproc-debugger-automation__main-fields")[0],"--disabled");P.Dom.removeClass(e.getElementsByClassName("bizproc-debugger-automation__toolbar")[0],"--disabled");const s=this.debugger.settings.get("tab")==="log"?"log":"doc";e.querySelectorAll([`[data-tab-item="no-document"]`]).forEach((e=>P.Dom.removeClass(e,["--empty","--active"])));e.querySelectorAll([`[data-tab-item="${s}"]`]).forEach((e=>P.Dom.addClass(e,"--active")));babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]()}function bs(e){if(!babelHelpers.classPrivateFieldLooseBase(this,V)[V]){return}switch(e){case F.Run:babelHelpers.classPrivateFieldLooseBase(this,V)[V].setIcon(t.ButtonIcon.PAUSE);babelHelpers.classPrivateFieldLooseBase(this,V)[V].getContainer().nextElementSibling.textContent=P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_PAUSE");break;default:babelHelpers.classPrivateFieldLooseBase(this,V)[V].setIcon(t.ButtonIcon.START);babelHelpers.classPrivateFieldLooseBase(this,V)[V].getContainer().nextElementSibling.textContent=P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START")}}class us{static isMode(e){return[0,1].includes(e)}static getMode(e){if(e===0){return us.experimental}else if(e===1){return us.interception}return null}static getAllModes(){return{0:us.experimental,1:us.interception}}}us.experimental={id:0,code:"experimental"};us.interception={id:1,code:"interception"};var ps=babelHelpers.classPrivateFieldLooseKey("id");var vs=babelHelpers.classPrivateFieldLooseKey("sessionId");var gs=babelHelpers.classPrivateFieldLooseKey("documentId");var hs=babelHelpers.classPrivateFieldLooseKey("categoryId");var Ps=babelHelpers.classPrivateFieldLooseKey("dateExpire");var Ls=babelHelpers.classPrivateFieldLooseKey("documentSigned");class Fs{constructor(e){Object.defineProperty(this,ps,{writable:true,value:void 0});Object.defineProperty(this,vs,{writable:true,value:void 0});Object.defineProperty(this,gs,{writable:true,value:void 0});Object.defineProperty(this,hs,{writable:true,value:void 0});Object.defineProperty(this,Ps,{writable:true,value:void 0});Object.defineProperty(this,Ls,{writable:true,value:""});babelHelpers.classPrivateFieldLooseBase(this,ps)[ps]=parseInt(e.Id)>=0?parseInt(e.Id):0;babelHelpers.classPrivateFieldLooseBase(this,vs)[vs]=P.Type.isStringFilled(e.SessionId)?e.SessionId:"";babelHelpers.classPrivateFieldLooseBase(this,gs)[gs]=P.Type.isStringFilled(e.DocumentId)?e.DocumentId:"";babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]=P.Text.toInteger(e.DocumentCategoryId);babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps]=B.toDate(e.DateExpire);if(e.DocumentSigned){this.documentSigned=e.DocumentSigned}}get documentId(){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs]}get categoryId(){return babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]}set categoryId(e){babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]=P.Type.isNumber(e)?e:0}get documentSigned(){return babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]}set documentSigned(e){babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]=P.Type.isStringFilled(e)?e:""}}var Bs=babelHelpers.classPrivateFieldLooseKey("id");var Hs=babelHelpers.classPrivateFieldLooseKey("mode");var fs=babelHelpers.classPrivateFieldLooseKey("startedBy");var ms=babelHelpers.classPrivateFieldLooseKey("active");var _s=babelHelpers.classPrivateFieldLooseKey("fixed");var ys=babelHelpers.classPrivateFieldLooseKey("documents");var Ts=babelHelpers.classPrivateFieldLooseKey("shortDescription");var Os=babelHelpers.classPrivateFieldLooseKey("categoryId");var Es=babelHelpers.classPrivateFieldLooseKey("documentSigned");var Is=babelHelpers.classPrivateFieldLooseKey("finished");var ws=babelHelpers.classPrivateFieldLooseKey("pullFinishHandler");var Ss=babelHelpers.classPrivateFieldLooseKey("pullDocumentValuesHandler");var Ds=babelHelpers.classPrivateFieldLooseKey("setMode");var Cs=babelHelpers.classPrivateFieldLooseKey("setDocuments");var Rs=babelHelpers.classPrivateFieldLooseKey("handleExternalFinished");var Ns=babelHelpers.classPrivateFieldLooseKey("handleExternalDocumentValues");var As=babelHelpers.classPrivateFieldLooseKey("handleFinish");var xs=babelHelpers.classPrivateFieldLooseKey("updateSession");class Gs extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,xs,{value:$s});Object.defineProperty(this,As,{value:zs});Object.defineProperty(this,Ns,{value:ks});Object.defineProperty(this,Rs,{value:Ms});Object.defineProperty(this,Cs,{value:Ks});Object.defineProperty(this,Ds,{value:js});Object.defineProperty(this,Bs,{writable:true,value:""});Object.defineProperty(this,Hs,{writable:true,value:{}});Object.defineProperty(this,fs,{writable:true,value:0});Object.defineProperty(this,ms,{writable:true,value:void 0});Object.defineProperty(this,_s,{writable:true,value:void 0});Object.defineProperty(this,ys,{writable:true,value:[]});Object.defineProperty(this,Ts,{writable:true,value:""});Object.defineProperty(this,Os,{writable:true,value:0});Object.defineProperty(this,Es,{writable:true,value:""});Object.defineProperty(this,Is,{writable:true,value:false});Object.defineProperty(this,ws,{writable:true,value:void 0});Object.defineProperty(this,Ss,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.Session");e=P.Type.isPlainObject(e)?e:{};babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]=e.Id;babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds](e.Mode);babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]=parseInt(e.StartedBy)>=0?parseInt(e.StartedBy):0;babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]=String(e.ShortDescription);babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]=Boolean(e.Active);babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]=Boolean(e.Fixed);babelHelpers.classPrivateFieldLooseBase(this,Os)[Os]=P.Text.toInteger(e.CategoryId);babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs](e.Documents);if(this.isActive()){babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]=babelHelpers.classPrivateFieldLooseBase(this,Rs)[Rs].bind(this);v.Manager.Instance.pullHandler.subscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]);babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]=babelHelpers.classPrivateFieldLooseBase(this,Ns)[Ns].bind(this);v.Manager.Instance.pullHandler.subscribe("documentValues",babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss])}}set documentSigned(e){if(this.isFixed()&&this.activeDocument){this.activeDocument.documentSigned=e}babelHelpers.classPrivateFieldLooseBase(this,Es)[Es]=e}get documentSigned(){if(this.activeDocument){const e=this.activeDocument.documentSigned;if(P.Type.isStringFilled(e)){return e}}return babelHelpers.classPrivateFieldLooseBase(this,Es)[Es]}get id(){return babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]}get startedBy(){return babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]}get activeDocument(){if(babelHelpers.classPrivateFieldLooseBase(this,ys)[ys].length===1){return babelHelpers.classPrivateFieldLooseBase(this,ys)[ys][0]}return null}get modeId(){return babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs].id}get shortDescription(){return babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]}get initialCategoryId(){return babelHelpers.classPrivateFieldLooseBase(this,Os)[Os]}isActive(){return babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]}isFixed(){return babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]}isSessionStartedByUser(e){return this.startedBy===e}isAutomation(){return true}isInterceptionMode(){return this.modeId===us.interception.id}isExperimentalMode(){return this.modeId===us.experimental.id}static start(e,s){return new Promise(((t,a)=>{P.ajax.runAction("bizproc.debugger.startSession",{data:{documentSigned:e,mode:s},analyticsLabel:{automation_select_debug_mode:"Y",mode_type:us.getMode(s).code}}).then((e=>{const s=new Gs(e.data.session);s.documentSigned=e.data.documentSigned;t(s)}),a)}))}finish(){return P.ajax.runAction("bizproc.debugger.finishDebugSession",{data:{sessionId:this.id}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,As)[As]();return e}))}fixateDocument(e){return P.ajax.runAction("bizproc.debugger.fixateSessionDocument",{data:{documentId:e}}).then((e=>{this.documentSigned=e.data.documentSigned;babelHelpers.classPrivateFieldLooseBase(this,xs)[xs](e.data.session);this.emit("onAfterDocumentFixed");return e}))}removeDocuments(e=[]){return P.ajax.runAction("bizproc.debugger.removeSessionDocument",{data:{documentIds:e}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,xs)[xs](e.data.session);return e}))}}function js(e){e=B.isNumeric(e)?Number(e):null;if(us.isMode(e)){babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs]=us.getMode(e)}}function Ks(e){if(P.Type.isArrayFilled(e)){e.forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,ys)[ys].push(new Fs(e))}))}return this}function Ms(e){const s=e.getData().sessionId;if(s===this.id){babelHelpers.classPrivateFieldLooseBase(this,As)[As]()}}function ks(e){if(!this.activeDocument){return}const s=e.getData().rawValues;const t=s["CATEGORY_ID"];if(t){this.activeDocument.categoryId=P.Text.toInteger(t);v.Manager.Instance.requireSetFilter(this)}}function zs(){if(!babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]){babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]=true;this.emit("onFinished");this.unsubscribeAll();if(babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]){v.Manager.Instance.pullHandler.unsubscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]);babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]=null}if(babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]){v.Manager.Instance.pullHandler.unsubscribe("documentValues",babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]);babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]=null}}}function $s(e={}){if(Object.keys(e).length<=0){return}babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]=Boolean(e.Active);babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]=Boolean(e.Fixed);babelHelpers.classPrivateFieldLooseBase(this,Os)[Os]=P.Text.toInteger(e.CategoryId);babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs](e.Documents)}let Us=e=>e,Vs,Js,Zs,Ws,Xs,Ys,qs,Qs,et,st,tt,at,it,lt,rt,ot,nt;var dt=babelHelpers.classPrivateFieldLooseKey("robot");var ct=babelHelpers.classPrivateFieldLooseKey("view");var bt=babelHelpers.classPrivateFieldLooseKey("currentNode");var ut=babelHelpers.classPrivateFieldLooseKey("currentIndex");var pt=babelHelpers.classPrivateFieldLooseKey("isAfterPreviousRendered");var vt=babelHelpers.classPrivateFieldLooseKey("isPauseRendered");var gt=babelHelpers.classPrivateFieldLooseKey("isActivityBodyRendered");var ht=babelHelpers.classPrivateFieldLooseKey("prevRobotTitle");var Pt=babelHelpers.classPrivateFieldLooseKey("getCurrentRobotNode");var Lt=babelHelpers.classPrivateFieldLooseKey("renderRobotTitle");var Ft=babelHelpers.classPrivateFieldLooseKey("renderAfterPrevious");var Bt=babelHelpers.classPrivateFieldLooseKey("renderPause");var Ht=babelHelpers.classPrivateFieldLooseKey("renderDelayInterval");var ft=babelHelpers.classPrivateFieldLooseKey("renderCondition");var mt=babelHelpers.classPrivateFieldLooseKey("renderConditions");var _t=babelHelpers.classPrivateFieldLooseKey("renderActivity");var yt=babelHelpers.classPrivateFieldLooseKey("renderActivityFinish");var Tt=babelHelpers.classPrivateFieldLooseKey("renderNote");var Ot=babelHelpers.classPrivateFieldLooseKey("renderDebugNote");var Et=babelHelpers.classPrivateFieldLooseKey("renderDebugLink");class It{constructor(e,s){Object.defineProperty(this,Et,{value:Mt});Object.defineProperty(this,Ot,{value:Kt});Object.defineProperty(this,Tt,{value:jt});Object.defineProperty(this,yt,{value:Gt});Object.defineProperty(this,_t,{value:xt});Object.defineProperty(this,mt,{value:At});Object.defineProperty(this,ft,{value:Nt});Object.defineProperty(this,Ht,{value:Rt});Object.defineProperty(this,Bt,{value:Ct});Object.defineProperty(this,Ft,{value:Dt});Object.defineProperty(this,Lt,{value:St});Object.defineProperty(this,Pt,{value:wt});Object.defineProperty(this,dt,{writable:true,value:void 0});Object.defineProperty(this,ct,{writable:true,value:void 0});Object.defineProperty(this,bt,{writable:true,value:null});Object.defineProperty(this,ut,{writable:true,value:null});Object.defineProperty(this,pt,{writable:true,value:false});Object.defineProperty(this,vt,{writable:true,value:false});Object.defineProperty(this,gt,{writable:true,value:false});Object.defineProperty(this,ht,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,ct)[ct]=e;babelHelpers.classPrivateFieldLooseBase(this,dt)[dt]=s}get name(){return babelHelpers.classPrivateFieldLooseBase(this,dt)[dt].name}get title(){return babelHelpers.classPrivateFieldLooseBase(this,dt)[dt].title}get delayName(){return babelHelpers.classPrivateFieldLooseBase(this,dt)[dt].delayName}get conditionNames(){return babelHelpers.classPrivateFieldLooseBase(this,dt)[dt].conditionNames}getActivitiesName(){let e=[];if(this.name){e.push(this.name)}if(this.delayName){e.push(this.delayName)}e=e.concat(this.conditionNames);return e}set previousRobotTitle(e){babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]=e}renderTrack(e){const s=[p.TrackingEntry.EXECUTE_ACTIVITY_TYPE,p.TrackingEntry.ATTACHED_ENTITY_TYPE];if(s.includes(e.type)){return}if(e.name===this.delayName){return babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt](e)}if(this.conditionNames.includes(e.name)){if(babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht](new p.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=true}return babelHelpers.classPrivateFieldLooseBase(this,ft)[ft](e)}if(e.name===this.name){if(babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht](new p.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=true}return babelHelpers.classPrivateFieldLooseBase(this,_t)[_t](e)}}}function wt(e){if(babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index!==babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]){const s=P.Tag.render(Vs||(Vs=Us`
				<div class="bizproc-debugger-automation__log-section">
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt](e.datetime));if(P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,ht)[ht])&&babelHelpers.classPrivateFieldLooseBase(this,pt)[pt]===false){P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](),s)}P.Dom.append(s,babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].logNode);babelHelpers.classPrivateFieldLooseBase(this,bt)[bt]=s}return babelHelpers.classPrivateFieldLooseBase(this,bt)[bt]}function St(e){const s=P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TITLE",{"#TITLE#":this.title});const t=P.Tag.render(Js||(Js=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),Va.renderTime(e),P.Text.encode(s));babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index;return t}function Dt(){babelHelpers.classPrivateFieldLooseBase(this,pt)[pt]=true;const e=P.Tag.render(Zs||(Zs=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --blue">
							"${0}"
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_AFTER_PREVIOUS"),P.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]));babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index;return e}function Ct(e){babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=true;const s=[p.TrackingEntry.CLOSE_ACTIVITY_TYPE];if(s.includes(e.type)){return}if(e.type===p.TrackingEntry.DEBUG_AUTOMATION_TYPE){const s=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);const t=JSON.parse(e.note);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht](t),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt](e),t)}function Rt(e={}){var s;const t=new p.DelayInterval(e);let a=(s=e.fieldName)!=null?s:(new p.DelayIntervalSelector).getBasisField(t.basis,true).Name;a=a+" ["+e.fieldValue+"]";const i=t.format(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_AT_ONCE"),[{SystemExpression:t.basis,Name:a}]);const l=P.Tag.render(Ws||(Ws=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --dark-blue">
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_RUN"),P.Text.encode(i));babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index;return l}function Nt(e){const s=[p.TrackingEntry.CLOSE_ACTIVITY_TYPE];if(s.includes(e.type)){return}if(e.type===p.TrackingEntry.DEBUG_AUTOMATION_TYPE){const s=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,mt)[mt](e),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt](e),t)}function At(e){const s=JSON.parse(e.note);const t=P.Tag.render(Xs||(Xs=Us`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),s.result==="Y"?P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"):P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_FALSE"));Object.keys(s).forEach((e=>{if(e==="result"){return}let a="";if(s.result===s[e]["result"]){a=s.result==="Y"?"bizproc-debugger-automation__log-color-box --green":"bizproc-debugger-automation__log-color-box --orange"}const i=s[e]["condition"];const l=i["field"];const r=s[e]["fieldValue"]?String(s[e]["fieldValue"]):"";const o=B.getOperatorLabel(i["operator"]);const n=i["value"];const d=B.getJoinerLabel(s[e]["joiner"]);P.Dom.append(P.Tag.render(Ys||(Ys=Us`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0} 
							${0} 
							${0}
						</span>
					</div>
				`),a,e==="0"?"":P.Text.encode(d)+" ",P.Text.encode(l)+" ","["+P.Text.encode(r)+"] ",P.Text.encode(o)+" ",P.Text.encode(n)),t)}));const a=P.Tag.render(qs||(qs=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index;return a}function xt(e){if(e.type===p.TrackingEntry.CLOSE_ACTIVITY_TYPE){if(babelHelpers.classPrivateFieldLooseBase(this,gt)[gt]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](),s)}return}babelHelpers.classPrivateFieldLooseBase(this,gt)[gt]=true;const s=babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e);const t=babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt](e);P.Dom.append(t,s);babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].collapseInfoResults(t)}function Gt(){return P.Tag.render(Qs||(Qs=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation-log-section-robot-activity">
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_FINISH_WITHOUT_SETTINGS"))}function jt(e){if([p.TrackingEntry.DEBUG_AUTOMATION_TYPE,p.TrackingEntry.DEBUG_ACTIVITY_TYPE].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot](e)}if([p.TrackingEntry.DEBUG_LINK_TYPE].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,Et)[Et](e)}const s=[p.TrackingEntry.CANCEL_ACTIVITY_TYPE,p.TrackingEntry.FAULT_ACTIVITY_TYPE,p.TrackingEntry.ERROR_ACTIVITY_TYPE].includes(e.type)?"bizproc-debugger-automation__log-color-box --red":"";const t=P.Tag.render(et||(et=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info--value --first">
					<span class="${0}">
						${0}
					</span>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),s,P.Text.encode(e.note).replace(/([^>])\n/g,"$1<br>"));babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index;return t}function Kt(e){const s=JSON.parse(e.note);const t=P.Tag.render(st||(st=Us`<div class="bizproc-debugger-automation__log-info"></div>`));if(s["propertyName"]){P.Dom.append(P.Tag.render(tt||(tt=Us`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),P.Text.encode(s["propertyName"]),P.Text.encode(s["propertyName"])),t)}P.Dom.append(P.Tag.render(at||(at=Us`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<div>
							${0}
						</div>
					</div>
					<div data-role="more-info-result" style="display:none;">
						<span class="bizproc-debugger-automation__log-info--more">
							${0}
						</span>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",s["propertyValue"]?P.Text.encode(s["propertyValue"]).replace(/([^>])\n/g,"$1<br>"):"",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_MORE_INFORMATION"))),t);const a=P.Tag.render(it||(it=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index;return a}function Mt(e){const s=JSON.parse(e.note);const t=P.Tag.render(lt||(lt=Us`<div class="bizproc-debugger-automation__log-info"></div>`));const a=s["propertyLinkName"]||s["propertyValue"];const i=s["propertyValue"];if(s["propertyName"]){P.Dom.append(P.Tag.render(rt||(rt=Us`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),P.Text.encode(s["propertyName"]),P.Text.encode(s["propertyName"])),t)}P.Dom.append(P.Tag.render(ot||(ot=Us`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<a href="${0}" target="_blank">
							${0}
						</a>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",P.Text.encode(i),a),t);const l=P.Tag.render(nt||(nt=Us`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=babelHelpers.classPrivateFieldLooseBase(this,ct)[ct].index;return l}let kt=e=>e,zt,$t,Ut,Vt,Jt;var Zt=babelHelpers.classPrivateFieldLooseKey("view");var Wt=babelHelpers.classPrivateFieldLooseKey("condition");var Xt=babelHelpers.classPrivateFieldLooseKey("title");var Yt=babelHelpers.classPrivateFieldLooseKey("track");var qt=babelHelpers.classPrivateFieldLooseKey("renderTitle");var Qt=babelHelpers.classPrivateFieldLooseKey("renderCondition");class ea{constructor(e){Object.defineProperty(this,Qt,{value:ta});Object.defineProperty(this,qt,{value:sa});Object.defineProperty(this,Zt,{writable:true,value:void 0});Object.defineProperty(this,Wt,{writable:true,value:{}});Object.defineProperty(this,Xt,{writable:true,value:""});Object.defineProperty(this,Yt,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,Zt)[Zt]=e}addTrack(e){if(e.type===p.TrackingEntry.DEBUG_AUTOMATION_TYPE&&e.name==="TRIGGER_LOG"){babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt]=JSON.parse(e.note);babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt]=e.title;babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]=e}return this}render(){const e=P.Tag.render(zt||(zt=kt`
			<div class="bizproc-debugger-automation__log-section">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					<div class="bizproc-debugger-automation__log-info--value --first">
						<span>
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,qt)[qt](),babelHelpers.classPrivateFieldLooseBase(this,Qt)[Qt](),babelHelpers.classPrivateFieldLooseBase(this,Zt)[Zt].renderIndex(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_FINISH")));P.Dom.append(e,babelHelpers.classPrivateFieldLooseBase(this,Zt)[Zt].logNode)}}function sa(){const e=P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_TITLE",{"#TITLE#":babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt]});return P.Tag.render($t||($t=kt`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Zt)[Zt].renderIndex(),Va.renderTime(babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt].datetime),P.Text.encode(e))}function ta(){if(!babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt]||Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt]).length<=0){return""}const e=babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt];const s=P.Tag.render(Ut||(Ut=kt`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"));Object.keys(e).forEach((t=>{const a=e[t]["result"]==="Y"?"bizproc-debugger-automation__log-color-box --green":"";const i=e[t]["condition"];const l=i["field"];const r=e[t]["fieldValue"]?String(e[t]["fieldValue"]):"";const o=B.getOperatorLabel(i["operator"]);const n=i["value"];const d=B.getJoinerLabel(e[t]["joiner"]);P.Dom.append(P.Tag.render(Vt||(Vt=kt`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0}
							${0}
							${0}
						</span>
					</div>
				`),a,t==="0"?"":P.Text.encode(d)+" ",P.Text.encode(l)+" ","["+P.Text.encode(r)+"] ",P.Text.encode(o)+" ",P.Text.encode(n)),s)}));return P.Tag.render(Jt||(Jt=kt`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Zt)[Zt].renderIndex(),s)}let aa=e=>e,ia,la,ra,oa,na,da,ca;var ba=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var ua=babelHelpers.classPrivateFieldLooseKey("workflowId");var pa=babelHelpers.classPrivateFieldLooseKey("activityRenderer");var va=babelHelpers.classPrivateFieldLooseKey("documentStatus");var ga=babelHelpers.classPrivateFieldLooseKey("categoryName");var ha=babelHelpers.classPrivateFieldLooseKey("statusSettings");var Pa=babelHelpers.classPrivateFieldLooseKey("node");var La=babelHelpers.classPrivateFieldLooseKey("index");var Fa=babelHelpers.classPrivateFieldLooseKey("trackId");var Ba=babelHelpers.classPrivateFieldLooseKey("poolTrack");var Ha=babelHelpers.classPrivateFieldLooseKey("poolWorkflowRobots");var fa=babelHelpers.classPrivateFieldLooseKey("isRendering");var ma=babelHelpers.classPrivateFieldLooseKey("NUMBER_OF_LINES_TO_SHOW_IN_PIXELS");var _a=babelHelpers.classPrivateFieldLooseKey("shouldScrollToBottom");var ya=babelHelpers.classPrivateFieldLooseKey("shouldLoadPreviousLog");var Ta=babelHelpers.classPrivateFieldLooseKey("onTrackAddedHandler");var Oa=babelHelpers.classPrivateFieldLooseKey("onChangeTabHandler");var Ea=babelHelpers.classPrivateFieldLooseKey("onSessionFinishedHandler");var Ia=babelHelpers.classPrivateFieldLooseKey("autoScrollHandler");var wa=babelHelpers.classPrivateFieldLooseKey("scrollAnimationId");var Sa=babelHelpers.classPrivateFieldLooseKey("loadPreviousLog");var Da=babelHelpers.classPrivateFieldLooseKey("loadWorkflowRobotsByWorkflowId");var Ca=babelHelpers.classPrivateFieldLooseKey("onAfterGetLog");var Ra=babelHelpers.classPrivateFieldLooseKey("renderStartDebugLog");var Na=babelHelpers.classPrivateFieldLooseKey("renderStartedDate");var Aa=babelHelpers.classPrivateFieldLooseKey("renderLegend");var xa=babelHelpers.classPrivateFieldLooseKey("renderCategoryChange");var Ga=babelHelpers.classPrivateFieldLooseKey("onChangeTab");var ja=babelHelpers.classPrivateFieldLooseKey("bindAutoScroll");var Ka=babelHelpers.classPrivateFieldLooseKey("scrollToBottom");var Ma=babelHelpers.classPrivateFieldLooseKey("animateScroll");var ka=babelHelpers.classPrivateFieldLooseKey("cancelAnimateScroll");var za=babelHelpers.classPrivateFieldLooseKey("askScrollToBottom");var $a=babelHelpers.classPrivateFieldLooseKey("clearWorkflowRobots");var Ua=babelHelpers.classPrivateFieldLooseKey("onSessionFinished");class Va{constructor(e){Object.defineProperty(this,Ua,{value:oi});Object.defineProperty(this,$a,{value:ri});Object.defineProperty(this,za,{value:li});Object.defineProperty(this,ka,{value:ii});Object.defineProperty(this,Ma,{value:ai});Object.defineProperty(this,Ka,{value:ti});Object.defineProperty(this,ja,{value:si});Object.defineProperty(this,Ga,{value:ei});Object.defineProperty(this,xa,{value:Qa});Object.defineProperty(this,Aa,{value:qa});Object.defineProperty(this,Na,{value:Ya});Object.defineProperty(this,Ra,{value:Xa});Object.defineProperty(this,Ca,{value:Wa});Object.defineProperty(this,Da,{value:Za});Object.defineProperty(this,Sa,{value:Ja});Object.defineProperty(this,ba,{writable:true,value:null});Object.defineProperty(this,ua,{writable:true,value:void 0});Object.defineProperty(this,pa,{writable:true,value:{}});Object.defineProperty(this,va,{writable:true,value:""});Object.defineProperty(this,ga,{writable:true,value:""});Object.defineProperty(this,ha,{writable:true,value:void 0});Object.defineProperty(this,Pa,{writable:true,value:null});Object.defineProperty(this,La,{writable:true,value:0});Object.defineProperty(this,Fa,{writable:true,value:0});Object.defineProperty(this,Ba,{writable:true,value:[]});Object.defineProperty(this,Ha,{writable:true,value:{}});Object.defineProperty(this,fa,{writable:true,value:true});Object.defineProperty(this,_a,{writable:true,value:false});Object.defineProperty(this,ya,{writable:true,value:false});Object.defineProperty(this,Ta,{writable:true,value:void 0});Object.defineProperty(this,Oa,{writable:true,value:void 0});Object.defineProperty(this,Ea,{writable:true,value:void 0});Object.defineProperty(this,Ia,{writable:true,value:void 0});Object.defineProperty(this,wa,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,ba)[ba]=e;babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]=this.debugger.workflowId;const s=this.debugger.getTemplate();this.initializeWorkflowRobotsRenderer(s?s["ROBOTS"]:[]);if(this.debugger.session.isActive()){babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]=this.onTrackAdded.bind(this);this.debugger.subscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]);babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=babelHelpers.classPrivateFieldLooseBase(this,Ga)[Ga].bind(this);this.debugger.getMainView().subscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]);babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]=babelHelpers.classPrivateFieldLooseBase(this,Ua)[Ua].bind(this);this.debugger.session.subscribeOnce("onFinished",babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea])}}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,ba)[ba]}get index(){return babelHelpers.classPrivateFieldLooseBase(this,La)[La]}get logNode(){if(!babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]){babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]=P.Tag.render(ia||(ia=aa`<div data-role="log" class="bizproc-debugger-tab__log"></div>`))}return babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]}initializeWorkflowRobotsRenderer(e=[],s=null){if(!s&&!babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]){return}if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]])){babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]]={}}if(P.Type.isArrayFilled(e)){let a=null;for(let i=0;i<e.length;++i){var t;const l=new p.Robot({});l.init(e[i],p.ViewMode.none());const r=[];if(P.Type.isPlainObject(l.data.Condition)){r.push(l.data.Condition["activityNames"]["Activity"]);r.push(l.data.Condition["activityNames"]["Branch1"]);r.push(l.data.Condition["activityNames"]["Branch2"])}const o=new It(this,{name:l.getId(),title:l.getTitle(),delayName:(t=l.data.DelayName)!=null?t:null,conditionNames:r});if(l.isExecuteAfterPrevious()&&a){o.previousRobotTitle=a}a=l.getTitle();o.getActivitiesName().forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]][e]=o}))}}}shouldLoadPreviousLog(e){babelHelpers.classPrivateFieldLooseBase(this,ya)[ya]=e;return this}setPreviousLog(e={logs:[],workflowRobots:{}}){babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca](e);return this}render(){if(this.logNode.children.length<=0){babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]=true;if(babelHelpers.classPrivateFieldLooseBase(this,ya)[ya]){babelHelpers.classPrivateFieldLooseBase(this,Sa)[Sa]().then((()=>{this.startRendering()}))}else{this.startRendering()}}return this.logNode}renderTo(e){P.Dom.append(this.logNode,e);babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]=true;this.startRendering();return this}startRendering(){const e=babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba].shift();if(P.Type.isUndefined(e)){babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]=false;babelHelpers.classPrivateFieldLooseBase(this,za)[za]();babelHelpers.classPrivateFieldLooseBase(this,ja)[ja](babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]);return}if(babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]!==e.workflowId){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId])){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha][e.workflowId])){babelHelpers.classPrivateFieldLooseBase(this,Da)[Da](e);this.renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]=e.workflowId;return}this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha][e.workflowId],e.workflowId)}}this.renderTrack(e);this.startRendering()}renderIndex(){babelHelpers.classPrivateFieldLooseBase(this,La)[La]++;return P.Tag.render(la||(la=aa`
			<div class="bizproc-debugger-automation__log--index" data-role="index">${0}</div>
		`),String(babelHelpers.classPrivateFieldLooseBase(this,La)[La]).padStart(3,"0"))}static renderTime(e){e=B.toDate(e);return P.Tag.render(ra||(ra=aa`
			<div class="bizproc-debugger-automation__log--time">
				[${0}]
			</div>
		`),P.Text.encode(B.formatDate("H:i:s",e)))}renderStatusChange(e){const s=JSON.parse(e.note);if(!P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,va)[va])){babelHelpers.classPrivateFieldLooseBase(this,va)[va]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,ha)[ha]=s;return}const t=this.getStatusSettings(babelHelpers.classPrivateFieldLooseBase(this,va)[va]);const a=s;const i=P.Tag.render(oa||(oa=aa`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div class="bizproc-debugger-automation__status--change-info">
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
						<div class="bizproc-debugger-automation__status--robot-change-arrow"></div>
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),Va.renderTime(e.datetime),B.getBgColorAdditionalClass(t["COLOR"]),P.Text.encode(t["NAME"]),P.Text.encode(t["NAME"]),t["COLOR"],t["COLOR"],B.getBgColorAdditionalClass(a["COLOR"]),P.Text.encode(a["NAME"]),P.Text.encode(a["NAME"]),a.COLOR,a.COLOR);P.Dom.append(i,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,va)[va]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,ha)[ha]=s}getStatusSettings(){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,ha)[ha])){return{NAME:"",COLOR:"AEF2F9"}}return babelHelpers.classPrivateFieldLooseBase(this,ha)[ha]}onTrackAdded(e){const s=new p.TrackingEntryBuilder;s.setLogEntry(e.getData().row);this.addTrack(s.build())}addTrack(e){if(!babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]){this.renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,za)[za]();return}babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba].push(e)}renderTrack(e){var s;if(e.id<=babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]){return}if(!Object.keys((s=babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId])!=null?s:{}).includes(e.name)){if(e.name==="SESSION_LEGEND"){babelHelpers.classPrivateFieldLooseBase(this,Ra)[Ra](e);babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]=e.id}else if(e.name==="STATUS_CHANGED"){this.renderStatusChange(e);babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]=e.id}else if(e.name==="CATEGORY_CHANGED"){babelHelpers.classPrivateFieldLooseBase(this,xa)[xa](e);babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]=e.id}else if(e.name==="TRIGGER_LOG"){new ea(this).addTrack(e).render();babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]=e.id}else if(e.name==="Template"&&e.type===p.TrackingEntry.EXECUTE_ACTIVITY_TYPE){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha][e.workflowId])&&babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]===false){babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]=true;babelHelpers.classPrivateFieldLooseBase(this,Da)[Da](e)}}else if(e.name==="Template"&&e.type===p.TrackingEntry.CLOSE_ACTIVITY_TYPE){babelHelpers.classPrivateFieldLooseBase(this,$a)[$a](e.workflowId)}return}babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId][e.name].renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]=e.id}collapseInfoResults(e){if(!e){e=this.logNode}const s=e.querySelectorAll('[data-role="info-result"]');s.forEach((e=>{if(e.firstElementChild.clientHeight>babelHelpers.classPrivateFieldLooseBase(this.constructor,ma)[ma]){const s=e.parentNode.querySelector('[data-role="more-info-result"]');P.Event.bind(s,"click",(()=>{P.Dom.style(e,"height",e.firstElementChild.clientHeight+"px");P.Dom.style(s,"display","none")}));P.Event.bind(e,"transitionend",(()=>{P.Dom.style(e,"height",null)}));P.Dom.style(e,"height",babelHelpers.classPrivateFieldLooseBase(this.constructor,ma)[ma]+"px");P.Dom.style(s,"display","block")}}));return this}shouldScrollToBottom(e){babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=e;return this}}function Ja(){return new Promise((e=>{this.debugger.loadAllLog().then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca](s);e(this)}),(()=>{e(this)}))}))}function Za(e){this.debugger.loadRobotsByWorkflowId(e.workflowId).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha][e.workflowId]=s.workflowRobots;this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha][e.workflowId],e.workflowId);this.startRendering()}),(()=>{babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha][e.workflowId]=[];console.info("session has no workflowId from track:",e);this.startRendering()}))}function Wa(e){const s=[];const t=new p.TrackingEntryBuilder;if(P.Type.isArrayFilled(e["logs"])){e["logs"].forEach((e=>{s.push(t.setLogEntry(e).build())}))}babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba]=s.concat(babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba]);babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=Object.assign(e["workflowRobots"],babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha])}function Xa(e){babelHelpers.classPrivateFieldLooseBase(this,Na)[Na](e);babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa](e)}function Ya(e){const s=B.toDate(e.datetime);const t=P.Tag.render(na||(na=aa`
			<div class="bizproc-debugger-automation__log--date">
				<div class="bizproc-debugger-automation__log--date-text">${0}</div>
			</div>
		`),P.Text.encode(B.formatDate("j F Y",s)));P.Dom.append(t,this.logNode)}function qa(e){const s=JSON.parse(e.note)["propertyValue"];const t=P.Tag.render(da||(da=aa`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div>${0}</div>
				</div>
			</div>
		`),this.renderIndex(),Va.renderTime(e.datetime),P.Text.encode(s));P.Dom.append(t,this.logNode)}function Qa(e){const s=JSON.parse(e.note)["propertyValue"];if(!P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,ga)[ga])){babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]=s;return}const t=P.Tag.render(ca||(ca=aa`
			<div>
				<div class="bizproc-debugger-automation__log-separator"></div>
				<div class="bizproc-debugger-automation__log-section">
					<div class="bizproc-debugger-automation__log-section--row">
						${0}
						${0}
						<div>
							${0}
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),Va.renderTime(e.datetime),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CATEGORY_CHANGE",{"#SOURCE_CATEGORY#":babelHelpers.classPrivateFieldLooseBase(this,ga)[ga],"#DESTINATION_CATEGORY#":s})));P.Dom.append(t,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]=s}function ei(e){if(e.getData().tab==="log"){this.collapseInfoResults();babelHelpers.classPrivateFieldLooseBase(this,za)[za]()}}function si(e){if(!this.logNode.parentNode){return}const s=this.logNode.parentNode;if(e){babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]=()=>{if(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]){return}const e=s.scrollHeight-s.clientHeight;babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=s.scrollTop>=e-babelHelpers.classPrivateFieldLooseBase(this.constructor,ma)[ma]};P.Event.bind(s,"scroll",babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia])}else if(babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]){P.Event.unbind(s,"scroll",babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia])}}function ti(){if(!this.logNode.parentNode){return}const e=this.logNode.parentNode;const s=e.scrollTop;const t=e.scrollHeight-e.clientHeight;babelHelpers.classPrivateFieldLooseBase(this,Ma)[Ma](e,s,t)}function ai(e,s,t){babelHelpers.classPrivateFieldLooseBase(this,ka)[ka]();const a=20;const i=500;const l=t-s;let r=0;const o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)};const n=()=>{r+=a;e.scrollTop=ni(r,s,l,i);if(r<i){babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]=o(n)}else{babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]=null}};return n()}function ii(){if(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]){const e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)};e(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]);babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]=null}}function li(){if(babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]){babelHelpers.classPrivateFieldLooseBase(this,Ka)[Ka]()}}function ri(e){delete babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha][e];delete babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e]}function oi(){this.debugger.unsubscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]);this.debugger.getMainView().unsubscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa])}Object.defineProperty(Va,ma,{writable:true,value:50});const ni=function(e,s,t,a){e/=a/2;if(e<1){return t/2*e*e+s}e--;return-t/2*(e*(e-2)-1)+s};var di=babelHelpers.classPrivateFieldLooseKey("ttl");var ci=babelHelpers.classPrivateFieldLooseKey("prefix");var bi=babelHelpers.classPrivateFieldLooseKey("getName");class ui{constructor(e){Object.defineProperty(this,bi,{value:pi});Object.defineProperty(this,di,{writable:true,value:3*86400});Object.defineProperty(this,ci,{writable:true,value:"bp-"});if(e){babelHelpers.classPrivateFieldLooseBase(this,ci)[ci]+=e+"-"}}getSet(e){const s=this.get(e);return s instanceof Array?new Set(s):new Set}get(e){return BX.localStorage.get(babelHelpers.classPrivateFieldLooseBase(this,bi)[bi](e))}set(e,s){if(s instanceof Set){s=Array.from(s)}BX.localStorage.set(babelHelpers.classPrivateFieldLooseBase(this,bi)[bi](e),s,babelHelpers.classPrivateFieldLooseBase(this,di)[di]);return this}}function pi(e){return babelHelpers.classPrivateFieldLooseBase(this,ci)[ci]+e}var vi=babelHelpers.classPrivateFieldLooseKey("guide");var gi=babelHelpers.classPrivateFieldLooseKey("getHtmlTitle");class hi{constructor(e){Object.defineProperty(this,vi,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,vi)[vi]=new L.Guide({steps:[{target:e.target,title:babelHelpers.classPrivateFieldLooseBase(hi,gi)[gi](e.title)||"",text:e.text||"",condition:{top:true,bottom:false,color:"warning"}}],onEvents:true})}start(){babelHelpers.classPrivateFieldLooseBase(this,vi)[vi].getPopup().setWidth(370);babelHelpers.classPrivateFieldLooseBase(this,vi)[vi].showNextStep()}finish(){babelHelpers.classPrivateFieldLooseBase(this,vi)[vi].close()}}function Pi(e){if(e){return`\n\t\t\t\t<div class="bizproc__action-panel-guide">\n\t\t\t\t\t<div class="bizproc__action-panel-guide--title --warning-icon">${P.Text.encode(e)}</div>\n\t\t\t\t</div>\n\t\t\t`}return null}Object.defineProperty(hi,gi,{value:Pi});var Li=babelHelpers.classPrivateFieldLooseKey("actionPanel");var Fi=babelHelpers.classPrivateFieldLooseKey("grid");var Bi=babelHelpers.classPrivateFieldLooseKey("guides");var Hi=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var fi=babelHelpers.classPrivateFieldLooseKey("appendItems");var mi=babelHelpers.classPrivateFieldLooseKey("onHideActionPanel");var _i=babelHelpers.classPrivateFieldLooseKey("getRemoveEntityActionText");var yi=babelHelpers.classPrivateFieldLooseKey("getCheckedIdsInBpStyle");var Ti=babelHelpers.classPrivateFieldLooseKey("handleRejectResponse");class Oi{constructor(e,s){Object.defineProperty(this,Ti,{value:Di});Object.defineProperty(this,yi,{value:Si});Object.defineProperty(this,_i,{value:wi});Object.defineProperty(this,mi,{value:Ii});Object.defineProperty(this,fi,{value:Ei});Object.defineProperty(this,Li,{writable:true,value:null});Object.defineProperty(this,Fi,{writable:true,value:null});Object.defineProperty(this,Bi,{writable:true,value:[]});Object.defineProperty(this,Hi,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Fi)[Fi]=e;babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi]=s;babelHelpers.classPrivateFieldLooseBase(this,Li)[Li]=new BX.UI.ActionPanel({removeLeftPosition:true,maxHeight:58,parentPosition:"bottom",autoHide:false});babelHelpers.classPrivateFieldLooseBase(this,fi)[fi]();const t=babelHelpers.classPrivateFieldLooseBase(this,mi)[mi].bind(this);h.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,Li)[Li],"BX.UI.ActionPanel:hidePanel",t)}get actionPanel(){return babelHelpers.classPrivateFieldLooseBase(this,Li)[Li]}fixEntityAction(){const e=babelHelpers.classPrivateFieldLooseBase(this,yi)[yi]();if(e.length!==1){const e=new hi({target:this.actionPanel.getItemById("fix_entity").layout.container,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_COUNT_ERROR_TITLE"),article:"limit_office_bp_designer"});babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi].push(e);e.start();return}babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].session.fixateDocument(e[0]).then((()=>{this.stopActionPanel();v.Manager.Instance.requireSetFilter(babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].session,true);if(babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].settings.get("popup-collapsed")){babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].getMainView().handleCollapse()}}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](e,"fix_entity")}))}removeEntityAction(){const e=babelHelpers.classPrivateFieldLooseBase(this,yi)[yi]();babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].session.removeDocuments(e).then((()=>{this.actionPanel.hidePanel();babelHelpers.classPrivateFieldLooseBase(this,Fi)[Fi].reload()}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](e,"remove_entity")}))}stopActionPanel(){this.actionPanel.hidePanel();babelHelpers.classPrivateFieldLooseBase(this,Fi)[Fi].resetActionPanel();babelHelpers.classPrivateFieldLooseBase(this,Fi)[Fi].stopActionPanel()}}function Ei(){babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].appendItem({id:"fix_entity",text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_ACTION"),onclick:this.fixEntityAction.bind(this)});babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].appendItem({id:"remove_entity",text:babelHelpers.classPrivateFieldLooseBase(this,_i)[_i](),onclick:this.removeEntityAction.bind(this)});babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].appendItem({id:"finish_debug",text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FINISH_DEBUG_ACTION"),onclick:function(){v.Manager.Instance.finishSession(babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].session).then((()=>{this.stopActionPanel()}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](e,"finish_debug")}))}.bind(this)})}function Ii(){babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi].forEach((e=>{e.finish()}))}function wi(){return`\n\t\t\t<span>${P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_REMOVE_DEAL_ACTION"))}</span>\n\t\t`}function Si(){const e=babelHelpers.classPrivateFieldLooseBase(this,Fi)[Fi].getCheckedId();return e.map((e=>"DEAL_"+e))}function Di(e,s){let t="";e.errors.forEach((e=>{t=t+"\n"+e.message}));const a=new hi({target:this.actionPanel.getItemById(s).layout.container,title:t,article:"limit_office_bp_designer"});babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi].push(a);a.start()}var Ci=babelHelpers.classPrivateFieldLooseKey("pullHandlers");var Ri=babelHelpers.classPrivateFieldLooseKey("settings");var Ni=babelHelpers.classPrivateFieldLooseKey("mainView");var Ai=babelHelpers.classPrivateFieldLooseKey("triggers");var xi=babelHelpers.classPrivateFieldLooseKey("template");var Gi=babelHelpers.classPrivateFieldLooseKey("documentStatus");var ji=babelHelpers.classPrivateFieldLooseKey("statusList");var Ki=babelHelpers.classPrivateFieldLooseKey("documentCategoryId");var Mi=babelHelpers.classPrivateFieldLooseKey("documentFields");var ki=babelHelpers.classPrivateFieldLooseKey("documentValues");var zi=babelHelpers.classPrivateFieldLooseKey("workflowId");var $i=babelHelpers.classPrivateFieldLooseKey("workflowStatus");var Ui=babelHelpers.classPrivateFieldLooseKey("workflowEvents");var Vi=babelHelpers.classPrivateFieldLooseKey("workflowTrack");var Ji=babelHelpers.classPrivateFieldLooseKey("debuggerState");var Zi=babelHelpers.classPrivateFieldLooseKey("customActionPanel");var Wi=babelHelpers.classPrivateFieldLooseKey("resumeShowActionPanel");var Xi=babelHelpers.classPrivateFieldLooseKey("shouldSetCustomActionPanel");var Yi=babelHelpers.classPrivateFieldLooseKey("initAutomationContext");var qi=babelHelpers.classPrivateFieldLooseKey("subscribePull");var Qi=babelHelpers.classPrivateFieldLooseKey("unsubscribePull");var el=babelHelpers.classPrivateFieldLooseKey("handleRejectResponse");var sl=babelHelpers.classPrivateFieldLooseKey("onAfterDocumentFixed");class tl extends h.EventEmitter{constructor(e={}){super();Object.defineProperty(this,sl,{value:dl});Object.defineProperty(this,el,{value:nl});Object.defineProperty(this,Qi,{value:ol});Object.defineProperty(this,qi,{value:rl});Object.defineProperty(this,Yi,{value:ll});Object.defineProperty(this,Xi,{value:il});Object.defineProperty(this,Wi,{value:al});this.session=null;Object.defineProperty(this,Ci,{writable:true,value:null});Object.defineProperty(this,Ri,{writable:true,value:void 0});Object.defineProperty(this,Ni,{writable:true,value:void 0});Object.defineProperty(this,Ai,{writable:true,value:void 0});Object.defineProperty(this,xi,{writable:true,value:void 0});Object.defineProperty(this,Gi,{writable:true,value:void 0});Object.defineProperty(this,ji,{writable:true,value:void 0});Object.defineProperty(this,Ki,{writable:true,value:0});Object.defineProperty(this,Mi,{writable:true,value:void 0});Object.defineProperty(this,ki,{writable:true,value:{}});Object.defineProperty(this,zi,{writable:true,value:void 0});Object.defineProperty(this,$i,{writable:true,value:void 0});Object.defineProperty(this,Ui,{writable:true,value:[]});Object.defineProperty(this,Vi,{writable:true,value:[]});Object.defineProperty(this,Ji,{writable:true,value:void 0});Object.defineProperty(this,Zi,{writable:true,value:null});this.setEventNamespace("BX.Bizproc.Debugger.Automation");this.session=e.session;if(this.session.isActive()){this.session.subscribeOnce("onAfterDocumentFixed",babelHelpers.classPrivateFieldLooseBase(this,sl)[sl].bind(this));this.session.subscribe("onFinished",this.destroy.bind(this));babelHelpers.classPrivateFieldLooseBase(this,qi)[qi]()}babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]=new ui("atm-dbg");babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi]();babelHelpers.classPrivateFieldLooseBase(this,Wi)[Wi]()}destroy(){var e,s;this.unsubscribeAll();babelHelpers.classPrivateFieldLooseBase(this,Qi)[Qi]();(e=babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni])==null?void 0:e.destroy();this.session=null;babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]=null;babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=null;babelHelpers.classPrivateFieldLooseBase(this,xi)[xi]=[];babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]=null;babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]=[];babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]=[];babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]={};babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=null;babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]=0;babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]=[];babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]=[];(s=babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi])==null?void 0:s.stopActionPanel()}get track(){return babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]}get settings(){return babelHelpers.classPrivateFieldLooseBase(this,Ri)[Ri]}get documentSigned(){return this.session.documentSigned}get sessionId(){return this.session.id}get workflowId(){return babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]}get pullHandlers(){if(babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci]===null){babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci]=[{name:"documentStatus",func:this.handleExternalDocumentStatus.bind(this)},{name:"documentValues",func:this.handleExternalDocumentValues.bind(this)},{name:"documentDelete",func:this.handleExternalDocumentDelete.bind(this)},{name:"workflowStatus",func:this.handleExternalWorkflowStatus.bind(this)},{name:"workflowEventAdd",func:this.handleExternalWorkflowEventAdd.bind(this)},{name:"workflowEventRemove",func:this.handleExternalWorkflowEventRemove.bind(this)},{name:"trackRow",func:this.handleExternalTrackRow.bind(this)}]}return babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci]}getMainView(){if(!babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]){babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=new Ie(this)}return babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]}getLogView(){return new Va(this)}getStatusList(){return babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]}getDocumentFields(){return babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]}getDocumentField(e){return babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi].find((s=>s.Id===e))}getDocumentValue(e){return babelHelpers.classPrivateFieldLooseBase(this,ki)[ki][e]||null}getDocumentStatus(){return babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]}getWorkflowStatus(){return babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]}getState(){return babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]}hasWorkflowEvents(){return babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui].length>0}setDocumentStatus(e){return new Promise((s=>{P.ajax.runAction("bizproc.debugger.setDocumentStatus",{data:{statusId:e}}).then((e=>{if(e.data&&e.data.newStatus){babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]=e.data.newStatus;babelHelpers.classPrivateFieldLooseBase(this,xi)[xi]=e.data.template;babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]=[];this.emit("onDocumentStatusChanged")}s(e)}),babelHelpers.classPrivateFieldLooseBase(this,el)[el].bind(this))}))}get templateTriggers(){return babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai].filter((e=>e["DOCUMENT_STATUS"]===babelHelpers.classPrivateFieldLooseBase(this,xi)[xi]["DOCUMENT_STATUS"]))}getTemplate(){return babelHelpers.classPrivateFieldLooseBase(this,xi)[xi]}isTemplateEmpty(){return babelHelpers.classPrivateFieldLooseBase(this,xi)[xi].IS_EXTERNAL_MODIFIED===false&&!P.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,xi)[xi].ROBOTS)}startDebugTemplate(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.resumeAutomationTemplate",{data:{sessionId:this.sessionId},analyticsLabel:"automation_start_debug"}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]=s.data.debuggerState;e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,el)[el].bind(this))}))}emulateExternalEvent(){return new Promise((e=>{const s=babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui][0];if(!s){return}P.ajax.runAction("bizproc.debugger.emulateExternalEvent",{data:{workflowId:babelHelpers.classPrivateFieldLooseBase(this,zi)[zi],eventId:s}}).then((s=>{e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,el)[el].bind(this))}))}loadMainViewInfo(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.fillAutomationView",{data:{sessionId:this.sessionId}}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]=s.data.triggers;babelHelpers.classPrivateFieldLooseBase(this,xi)[xi]=s.data.template;babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]=s.data.documentStatus;babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]=s.data.statusList;babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=s.data.documentCategoryId;babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]=s.data.documentFields;babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=s.data.documentValues;babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]=s.data.workflowStatus;babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]=s.data.workflowEvents;babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]=s.data.track;babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]=s.data.debuggerState;p.getGlobalContext().document.setFields(this.getDocumentFields()).setStatusList(this.getStatusList()).setStatus(this.getDocumentStatus());e()}),babelHelpers.classPrivateFieldLooseBase(this,el)[el].bind(this))}))}loadAllLog(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.loadAllLog",{data:{sessionId:this.session.id}}).then((s=>{e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,el)[el].bind(this))}))}loadRobotsByWorkflowId(e){return new Promise(((s,t)=>{P.ajax.runAction("bizproc.debugger.loadRobotsByWorkflowId",{data:{sessionId:this.sessionId,workflowId:e}}).then((e=>{s(e.data)}),(e=>{t(e.data)}))}))}handleExternalDocumentStatus(e){const s=e.getData().status;if(this.getDocumentStatus()===s){return}console.info("document status: "+s);babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]=s;this.emit("onDocumentStatusChanged")}handleExternalDocumentValues(e){const s=e.getData().values;Object.keys(s).forEach((e=>babelHelpers.classPrivateFieldLooseBase(this,ki)[ki][e]=s[e]));console.info("document values: "+Object.keys(s));this.emit("onDocumentValuesUpdated",{values:s})}handleExternalDocumentDelete(){u.MessageBox.show({message:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_ON_DOCUMENT_DELETE"),okCaption:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),onOk:()=>Gl.Instance.finishSession(this.session).then(null,babelHelpers.classPrivateFieldLooseBase(this,el)[el].bind(this)),buttons:u.MessageBoxButtons.OK_CANCEL})}handleExternalTrackRow(e){const s=e.getData().row;s["WORKFLOW_STATUS"]=babelHelpers.classPrivateFieldLooseBase(this,$i)[$i];babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi].push(s);this.emit("onWorkflowTrackAdded",{row:s})}handleExternalWorkflowStatus(e){const s=e.getData().status;const t=e.getData().workflowId;babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]=s;if(s===p.WorkflowStatus.RUNNING){babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=t}if(babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]!==t){return}console.info("workflow status: "+s);this.emit("onWorkflowStatusChanged",{status:s,workflowId:t})}handleExternalWorkflowEventAdd(e){const s=e.getData().eventName;console.info("workflow event added: "+s);babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui].push(s);console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui].join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]})}handleExternalWorkflowEventRemove(e){const s=e.getData().eventName;console.info("workflow event removed: "+s);babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]=babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui].filter((e=>e!==s));console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui].join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]})}getField(e,s){let t;switch(e){case"Document":t=babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi].find((e=>e.Id===s));break;case"Template":case"Parameter":case"Constant":case"GlobalConst":case"GlobalVar":break}return t||{Id:s,ObjectId:e,Name:s,Type:"string",Expression:s,SystemExpression:"{="+e+":"+s+"}"}}getSettingsUrl(){return`/crm/deal/automation/${babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]}/`}}function al(){if(this.session.isInterceptionMode()&&!this.session.isFixed()){if(P.Reflection.getClass("BX.CRM.Kanban.Grid")){const e=BX.CRM.Kanban.Grid.getInstance();if(babelHelpers.classPrivateFieldLooseBase(this,Xi)[Xi](e)){babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi]=new Oi(e,this);e.stopActionPanel(true);e.resetActionPanel();e.setCustomActionPanel(babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi].actionPanel)}}}}function il(e){const s=e.getData();const t=s.entityType;if(t!=="DEAL"){return false}const a=s.params.hasOwnProperty("CATEGORY_ID")?P.Text.toInteger(s.params.CATEGORY_ID):0;return this.session.initialCategoryId===a}function ll(){const e=new p.Context({document:new p.Document({rawDocumentType:[],documentId:null,categoryId:0,statusList:this.getStatusList(),statusId:this.getDocumentStatus(),documentFields:this.getDocumentFields()}),documentSigned:this.documentSigned,canEdit:false,canManage:false});p.setGlobalContext(e)}function rl(){const e=Gl.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.subscribe(s,t)}))}function ol(){if(babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci]===null){return}const e=Gl.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.unsubscribe(s,t)}));babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci]=null}function nl(e){if(P.Type.isArrayFilled(e.errors)){const s=e.errors.find((e=>e.code===404));if(s){this.handleExternalDocumentDelete()}else{const s=e.errors.map((e=>e.message)).join("\n");u.MessageBox.alert(s)}}}function dl(){this.loadMainViewInfo().then((()=>{this.emit("onAfterDocumentFixed")}))}var cl=babelHelpers.classPrivateFieldLooseKey("unsubscribe");var bl=babelHelpers.classPrivateFieldLooseKey("commands");var ul=babelHelpers.classPrivateFieldLooseKey("handleCommand");class pl extends h.EventEmitter{constructor(){super();Object.defineProperty(this,ul,{value:vl});Object.defineProperty(this,cl,{writable:true,value:void 0});Object.defineProperty(this,bl,{writable:true,value:["documentStatus","documentValues","documentDelete","workflowStatus","workflowEventAdd","workflowEventRemove","trackRow","sessionFinish"]});this.setEventNamespace("BX.Bizproc.Debugger.Pull");babelHelpers.classPrivateFieldLooseBase(this,cl)[cl]=g.PULL.subscribe(this)}destroy(){if(P.Type.isFunction(babelHelpers.classPrivateFieldLooseBase(this,cl)[cl])){babelHelpers.classPrivateFieldLooseBase(this,cl)[cl]()}babelHelpers.classPrivateFieldLooseBase(this,cl)[cl]=null}getModuleId(){return"bizproc"}getSubscriptionType(){return BX.PullClient.SubscriptionType.Server}getMap(){const e={};babelHelpers.classPrivateFieldLooseBase(this,bl)[bl].forEach((s=>{e[s]=babelHelpers.classPrivateFieldLooseBase(this,ul)[ul].bind(this)}));return e}}function vl(e,s,t){this.emit(t,e)}var gl=babelHelpers.classPrivateFieldLooseKey("getText");class hl{constructor(e){var s;this.guide=new L.Guide({steps:[{target:e.target,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TITLE"),text:babelHelpers.classPrivateFieldLooseBase(hl,gl)[gl](),article:"16087180",events:(s=e.events)!=null?s:{},condition:{top:true,bottom:false,color:"primary"}}],onEvents:true});this.bindEvents()}bindEvents(){}start(){this.guide.getPopup().setWidth(365);this.guide.showNextStep()}}function Pl(){return`\n\t\t\t<ul class="bizproc-debugger-filter-guide-list">\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${B.toHtml(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_1"))}\n\t\t\t\t</li>\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${B.toHtml(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_2"))}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`}Object.defineProperty(hl,gl,{value:Pl});var Ll=babelHelpers.classPrivateFieldLooseKey("getText");class Fl{constructor(e){var s;this.guide=new L.Guide({steps:[{target:e.target,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TITLE"),text:babelHelpers.classPrivateFieldLooseBase(Fl,Ll)[Ll](),events:(s=e.events)!=null?s:{},condition:{top:true,bottom:false,color:"primary"}}],onEvents:true})}start(){this.guide.getPopup().setWidth(330);this.guide.showNextStep()}}function Bl(){return`\n\t\t\t<ul class="bizproc-debugger-filter-guide-list">\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_1")}\n\t\t\t\t</li>\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_2")}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`}Object.defineProperty(Fl,Ll,{value:Bl});var Hl=babelHelpers.classPrivateFieldLooseKey("grid");var fl=babelHelpers.classPrivateFieldLooseKey("guides");var ml=babelHelpers.classPrivateFieldLooseKey("reserveFilterIds");var _l=babelHelpers.classPrivateFieldLooseKey("getStageGuide");var yl=babelHelpers.classPrivateFieldLooseKey("getFilterGuide");class Tl extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,yl,{value:El});Object.defineProperty(this,_l,{value:Ol});Object.defineProperty(this,Hl,{writable:true,value:null});Object.defineProperty(this,fl,{writable:true,value:[]});Object.defineProperty(this,ml,{writable:true,value:[]});this.setEventNamespace("BX.Bizproc.Debugger.CrmDebuggerGuide");babelHelpers.classPrivateFieldLooseBase(this,Hl)[Hl]=e.grid;babelHelpers.classPrivateFieldLooseBase(this,ml)[ml]=e.reserveFilterIds;if(e.showStageStep){const e=babelHelpers.classPrivateFieldLooseBase(this,_l)[_l]();if(e){babelHelpers.classPrivateFieldLooseBase(this,fl)[fl].push(e)}}if(e.showFilterStep){const e=babelHelpers.classPrivateFieldLooseBase(this,yl)[yl]();if(e){babelHelpers.classPrivateFieldLooseBase(this,fl)[fl].push(e)}}}start(){if(babelHelpers.classPrivateFieldLooseBase(this,fl)[fl].length<=0){return}babelHelpers.classPrivateFieldLooseBase(this,fl)[fl][babelHelpers.classPrivateFieldLooseBase(this,fl)[fl].length-1].start()}}function Ol(){if(!babelHelpers.classPrivateFieldLooseBase(this,Hl)[Hl]){return}const e=babelHelpers.classPrivateFieldLooseBase(this,Hl)[Hl].getColumns()[0];if(!e){return null}const s=e.getTitleContainer();if(!s){return null}const t=babelHelpers.classPrivateFieldLooseBase(this,fl)[fl][babelHelpers.classPrivateFieldLooseBase(this,fl)[fl].length-1];return new Fl({target:"."+s.classList[0],events:{onShow:function(){this.emit("onStageGuideStepShow")}.bind(this),onClose:function(){if(t){t.start()}}.bind(this)}})}function El(){var e;const s=babelHelpers.classPrivateFieldLooseBase(this,Hl)[Hl]?[babelHelpers.classPrivateFieldLooseBase(this,Hl)[Hl].getData().gridId]:babelHelpers.classPrivateFieldLooseBase(this,ml)[ml];if(s.length<=0){return null}let t;for(const e in s){t=BX.Main.filterManager.getById(s[e]);if(t){break}}if(!t){return null}const a=t.getApi();const i=a==null?void 0:(e=a.parent)==null?void 0:e.getPopupBindElement();if(!i){return null}const l=babelHelpers.classPrivateFieldLooseBase(this,fl)[fl][babelHelpers.classPrivateFieldLooseBase(this,fl)[fl].length-1];return new hl({target:i,events:{onShow:function(){this.emit("onFilterGuideStepShow")}.bind(this),onClose:function(){if(l){l.start()}}.bind(this)}})}let Il=null;var wl=babelHelpers.classPrivateFieldLooseKey("settings");var Sl=babelHelpers.classPrivateFieldLooseKey("showDebugger");var Dl=babelHelpers.classPrivateFieldLooseKey("showGuide");var Cl=babelHelpers.classPrivateFieldLooseKey("setDebugFilter");var Rl=babelHelpers.classPrivateFieldLooseKey("removeDebugFilter");var Nl=babelHelpers.classPrivateFieldLooseKey("lastFilterId");var Al=babelHelpers.classPrivateFieldLooseKey("getFilterApis");var xl=babelHelpers.classPrivateFieldLooseKey("getFilterIds");class Gl{static get Instance(){if(Il===null){Il=new Gl}return Il}constructor(){Object.defineProperty(this,xl,{value:Vl});Object.defineProperty(this,Al,{value:Ul});Object.defineProperty(this,Nl,{get:zl,set:$l});Object.defineProperty(this,Rl,{value:kl});Object.defineProperty(this,Cl,{value:Ml});Object.defineProperty(this,Dl,{value:Kl});Object.defineProperty(this,Sl,{value:jl});Object.defineProperty(this,wl,{writable:true,value:void 0});this.pullHandler=new pl;babelHelpers.classPrivateFieldLooseBase(this,wl)[wl]=new ui("manager")}initializeDebugger(e={session:{},documentSigned:""}){const s=P.Type.isPlainObject(e.session)?new Gs(e.session):null;if(!s){return}s.documentSigned=e.documentSigned;this.requireSetFilter(s);babelHelpers.classPrivateFieldLooseBase(this,Sl)[Sl](s)}startSession(e,s){return new Promise(((t,a)=>{Gs.start(e,s).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,Nl)[Nl]=null;babelHelpers.classPrivateFieldLooseBase(this,Cl)[Cl](e);const s=babelHelpers.classPrivateFieldLooseBase(this,Sl)[Sl](e,true);babelHelpers.classPrivateFieldLooseBase(this,Dl)[Dl](s);t()}),a)}))}finishSession(e){return new Promise(((s,t)=>{e.finish().then((t=>{babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl](e);s(t)}),t)}))}requireSetFilter(e,s=false){const t=babelHelpers.classPrivateFieldLooseBase(this,xl)[xl](e).pop();if(t!==babelHelpers.classPrivateFieldLooseBase(this,Nl)[Nl]||s){babelHelpers.classPrivateFieldLooseBase(this,Cl)[Cl](e)}}createAutomationDebugger(e={}){return new tl(e)}openDebuggerStartPage(e,s={}){const t=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.start/",{documentSigned:e,analyticsLabel:{automation_enter_debug:"Y",start_type:s.analyticsStartType||"default"}});const a={width:745,cacheable:false,allowChangeHistory:true,events:{}};return Gl.openSlider(t,a)}openSessionLog(e){const s=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.log/",{setTitle:"Y",sessionId:e});const t={width:720,cacheable:false,allowChangeHistory:true,events:{},newWindowLabel:true};return Gl.openSlider(s,t)}static openSlider(e,s){if(!P.Type.isPlainObject(s)){s={}}s={...{cacheable:false,allowChangeHistory:true,events:{}},...s};return new Promise(((t,a)=>{if(P.Type.isStringFilled(e)){if(BX.SidePanel.Instance.open(e,s)){return t()}return a()}return a()}))}}function jl(e,s=false){let t=null;if(e.isAutomation()){t=this.createAutomationDebugger({session:e})}if(t){const a=e.isExperimentalMode()?"showExpanded":"showCollapsed";t.getMainView()[s?a:"show"]();return t}return t}function Kl(e){const s=new Tl({grid:P.Reflection.getClass("BX.CRM.Kanban.Grid")?BX.CRM.Kanban.Grid.getInstance():null,showFilterStep:babelHelpers.classPrivateFieldLooseBase(this,wl)[wl].get("filter-guide-shown")!==true,showStageStep:babelHelpers.classPrivateFieldLooseBase(this,wl)[wl].get("stage-guide-shown")!==true&&e.session.isInterceptionMode(),reserveFilterIds:babelHelpers.classPrivateFieldLooseBase(this,xl)[xl](e.session)});s.subscribe("onFilterGuideStepShow",function(){babelHelpers.classPrivateFieldLooseBase(this,wl)[wl].set("filter-guide-shown",true)}.bind(this));s.subscribe("onStageGuideStepShow",function(){babelHelpers.classPrivateFieldLooseBase(this,wl)[wl].set("stage-guide-shown",true)}.bind(this));s.start()}function Ml(e){const s=babelHelpers.classPrivateFieldLooseBase(this,xl)[xl](e);babelHelpers.classPrivateFieldLooseBase(this,Al)[Al](s).forEach((({id:e,api:s})=>{s.setFilter({preset_id:"filter_robot_debugger"});babelHelpers.classPrivateFieldLooseBase(this,Nl)[Nl]=e}))}function kl(e){const s=babelHelpers.classPrivateFieldLooseBase(this,xl)[xl](e);babelHelpers.classPrivateFieldLooseBase(this,Al)[Al](s).forEach((({api:e})=>{e.setFilter({preset_id:"default_filter"});babelHelpers.classPrivateFieldLooseBase(this,Nl)[Nl]=null}))}function zl(){return babelHelpers.classPrivateFieldLooseBase(this,wl)[wl].get("last-filter-id")}function $l(e){return babelHelpers.classPrivateFieldLooseBase(this,wl)[wl].set("last-filter-id",e)}function Ul(e){const s=[];e.forEach((e=>{var t;const a=(t=BX.Main.filterManager)==null?void 0:t.getById(e);if(a){s.push({id:e,api:a.getApi()})}}));return s}function Vl(e){let s;if(e&&e.modeId===us.interception.id&&!e.isFixed()){s=e.initialCategoryId}else{var t;s=e==null?void 0:(t=e.activeDocument)==null?void 0:t.categoryId}const a="CRM_DEAL_LIST_V12";if(!s){return[a,`${a}_C_0`]}return[`${a}_C_${s}`]}const Jl={Manager:Gl,Session:Gs,Mode:us};e.Debugger=Jl;e.Manager=Gl;e.Session=Gs;e.Mode=us})(this.BX.Bizproc.Debugger=this.BX.Bizproc.Debugger||{},BX.Main,BX.UI,BX,BX.UI.EntitySelector,BX,BX.UI,BX,BX.Main,BX,BX,BX,BX.UI.Dialogs,BX.Bizproc.Automation,BX.Bizproc.Debugger,BX,BX.Event,BX,BX.UI.Tour);
//# sourceMappingURL=debugger.bundle.map.js