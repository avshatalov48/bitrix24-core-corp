this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,s,t,a,i,l,r,o,n,d,b,c,u,p,v,g,h,P,L,F){"use strict";class H{}H.Run=0;H.NextStep=1;H.Stop=2;H.Pause=3;H.Undefined=-1;class B{static isNumeric(e){if(P.Type.isNumber(e)){return true}if(!P.Type.isStringFilled(e)){return false}return Number(e).toString()===e.trim()}static isDate(e){if(P.Type.isDate(e)){return true}if(!B.isNumeric(e)){return false}return new Date(Number(e)).getTime()===Number(e)}static convertDateFromDB(e){if(!B.isNumeric(e)){return null}return new Date(e*1e3)}static toDate(e){if(n.DateTimeFormat.parse(e)){return n.DateTimeFormat.parse(e,false)}if(Date.parse(e)){return new Date(e)}if(!B.isDate(e)){return null}if(P.Type.isDate(e)){return e}return B.convertDateFromDB(e)}static formatDate(e,s){if(!P.Type.isStringFilled(e)){e="j F Y H:i:s"}return n.DateTimeFormat.format(e,s)}static getOperatorsLabel(){return b.Operator.getAllLabels()}static getOperatorLabel(e){return b.Operator.getOperatorLabel([e])}static getJoinerLabel(e){const s={AND:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_AND"),OR:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_OR")};return s[e]}static getColorBrightness(e){if(e[0]==="#"){e=e.replace("#","")}const s=parseInt(e,16);const t=s>>16&255;const a=s>>8&255;const i=s&255;return.21*t+.72*a+.07*i}static getBgColorAdditionalClass(e){const s=B.getColorBrightness(e);if(s>224){return"--with-border --light-color"}if(s>145){return"--light-color"}return""}static toHtml(e){return P.Text.encode(e||"").replace(/\[(\/)?b\]/gi,"<$1b>")}}let f=e=>e,m,_,y,T,O,E,w,I,S,D,C,R;var x=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var A=babelHelpers.classPrivateFieldLooseKey("popupInstance");var j=babelHelpers.classPrivateFieldLooseKey("loaded");var N=babelHelpers.classPrivateFieldLooseKey("node");var G=babelHelpers.classPrivateFieldLooseKey("triggerManager");var K=babelHelpers.classPrivateFieldLooseKey("template");var k=babelHelpers.classPrivateFieldLooseKey("tracker");var M=babelHelpers.classPrivateFieldLooseKey("tabs");var z=babelHelpers.classPrivateFieldLooseKey("expandedMinWidth");var $=babelHelpers.classPrivateFieldLooseKey("expandedMinHeight");var U=babelHelpers.classPrivateFieldLooseKey("collapsedMinWidth");var V=babelHelpers.classPrivateFieldLooseKey("collapsedMinHeight");var W=babelHelpers.classPrivateFieldLooseKey("changingViewTimeout");var J=babelHelpers.classPrivateFieldLooseKey("buttonPlay");var Z=babelHelpers.classPrivateFieldLooseKey("getPopup");var X=babelHelpers.classPrivateFieldLooseKey("getPopupWidth");var Y=babelHelpers.classPrivateFieldLooseKey("getPopupHeight");var q=babelHelpers.classPrivateFieldLooseKey("getPopupTitleBar");var Q=babelHelpers.classPrivateFieldLooseKey("handleCollapse");var ee=babelHelpers.classPrivateFieldLooseKey("handleClose");var se=babelHelpers.classPrivateFieldLooseKey("getNode");var te=babelHelpers.classPrivateFieldLooseKey("renderExpandedMode");var ae=babelHelpers.classPrivateFieldLooseKey("renderCollapsedMode");var ie=babelHelpers.classPrivateFieldLooseKey("getAddFieldNode");var le=babelHelpers.classPrivateFieldLooseKey("getFieldListNode");var re=babelHelpers.classPrivateFieldLooseKey("handleChangeTab");var oe=babelHelpers.classPrivateFieldLooseKey("handleAddDocFieldMenu");var ne=babelHelpers.classPrivateFieldLooseKey("handleAddField");var de=babelHelpers.classPrivateFieldLooseKey("handleRemoveField");var be=babelHelpers.classPrivateFieldLooseKey("handleFieldListChange");var ce=babelHelpers.classPrivateFieldLooseKey("getFieldNode");var ue=babelHelpers.classPrivateFieldLooseKey("createTriggersHeaderNode");var pe=babelHelpers.classPrivateFieldLooseKey("createTriggersNode");var ve=babelHelpers.classPrivateFieldLooseKey("createTemplateNode");var ge=babelHelpers.classPrivateFieldLooseKey("updateTemplate");var he=babelHelpers.classPrivateFieldLooseKey("createTemplateToolbar");var Pe=babelHelpers.classPrivateFieldLooseKey("handleStartTemplate");var Le=babelHelpers.classPrivateFieldLooseKey("handleEmulateExternalEvent");var Fe=babelHelpers.classPrivateFieldLooseKey("updateTracker");var He=babelHelpers.classPrivateFieldLooseKey("renderPausedRobots");var Be=babelHelpers.classPrivateFieldLooseKey("createStageNode");var fe=babelHelpers.classPrivateFieldLooseKey("handleShowStages");var me=babelHelpers.classPrivateFieldLooseKey("handleChangeStatus");var _e=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusTitle");var ye=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusColor");var Te=babelHelpers.classPrivateFieldLooseKey("onDocumentStatusChanged");var Oe=babelHelpers.classPrivateFieldLooseKey("onWorkflowEventsChanged");var Ee=babelHelpers.classPrivateFieldLooseKey("onWorkflowTrackAdded");var we=babelHelpers.classPrivateFieldLooseKey("onDocumentValuesUpdated");var Ie=babelHelpers.classPrivateFieldLooseKey("onWorkflowStatusChange");var Se=babelHelpers.classPrivateFieldLooseKey("onAfterDocumentFixed");var De=babelHelpers.classPrivateFieldLooseKey("setDebuggerState");class Ce extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,De,{value:Ps});Object.defineProperty(this,Se,{value:hs});Object.defineProperty(this,Ie,{value:gs});Object.defineProperty(this,we,{value:vs});Object.defineProperty(this,Ee,{value:ps});Object.defineProperty(this,Oe,{value:us});Object.defineProperty(this,Te,{value:cs});Object.defineProperty(this,ye,{value:bs});Object.defineProperty(this,_e,{value:ds});Object.defineProperty(this,me,{value:ns});Object.defineProperty(this,fe,{value:os});Object.defineProperty(this,Be,{value:rs});Object.defineProperty(this,He,{value:ls});Object.defineProperty(this,Fe,{value:is});Object.defineProperty(this,Le,{value:as});Object.defineProperty(this,Pe,{value:ts});Object.defineProperty(this,he,{value:ss});Object.defineProperty(this,ge,{value:es});Object.defineProperty(this,ve,{value:Qe});Object.defineProperty(this,pe,{value:qe});Object.defineProperty(this,ue,{value:Ye});Object.defineProperty(this,ce,{value:Xe});Object.defineProperty(this,be,{value:Ze});Object.defineProperty(this,de,{value:Je});Object.defineProperty(this,ne,{value:We});Object.defineProperty(this,oe,{value:Ve});Object.defineProperty(this,re,{value:Ue});Object.defineProperty(this,le,{value:$e});Object.defineProperty(this,ie,{value:ze});Object.defineProperty(this,ae,{value:Me});Object.defineProperty(this,te,{value:ke});Object.defineProperty(this,se,{value:Ke});Object.defineProperty(this,ee,{value:Ge});Object.defineProperty(this,Q,{value:Ne});Object.defineProperty(this,q,{value:je});Object.defineProperty(this,Y,{value:Ae});Object.defineProperty(this,X,{value:xe});Object.defineProperty(this,Z,{value:Re});Object.defineProperty(this,x,{writable:true,value:void 0});Object.defineProperty(this,A,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:false});Object.defineProperty(this,N,{writable:true,value:void 0});Object.defineProperty(this,G,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:void 0});Object.defineProperty(this,k,{writable:true,value:void 0});Object.defineProperty(this,M,{writable:true,value:["doc","log"]});Object.defineProperty(this,z,{writable:true,value:781});Object.defineProperty(this,$,{writable:true,value:612});Object.defineProperty(this,U,{writable:true,value:465});Object.defineProperty(this,V,{writable:true,value:187});Object.defineProperty(this,W,{writable:true,value:void 0});Object.defineProperty(this,J,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.AutomationMainView");babelHelpers.classPrivateFieldLooseBase(this,x)[x]=e;e.subscribe("onDocumentStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].bind(this));e.subscribe("onWorkflowEventsChanged",babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].bind(this));e.subscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].bind(this));e.subscribe("onDocumentValuesUpdated",babelHelpers.classPrivateFieldLooseBase(this,we)[we].bind(this));e.subscribe("onWorkflowStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie].bind(this));e.subscribe("onAfterDocumentFixed",babelHelpers.classPrivateFieldLooseBase(this,Se)[Se].bind(this))}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,x)[x]}show(){if(babelHelpers.classPrivateFieldLooseBase(this,j)[j]){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().show();return}this.debugger.loadMainViewInfo().then((()=>{babelHelpers.classPrivateFieldLooseBase(this,j)[j]=true;babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().setContent(babelHelpers.classPrivateFieldLooseBase(this,se)[se]());babelHelpers.classPrivateFieldLooseBase(this,De)[De](this.debugger.getState());babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().show()}))}showExpanded(){if(!babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().isShown()){this.debugger.settings.set("popup-collapsed",false);this.show();return}babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()}showCollapsed(){this.debugger.settings.set("popup-collapsed",true);this.show()}close(){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().close()}destroy(){this.close()}}function Re(){if(!babelHelpers.classPrivateFieldLooseBase(this,A)[A]){const e=this.debugger.settings.get("popup-collapsed");const t="bizproc-debugger-automation__main-popup bizproc-debugger-automation__scope";babelHelpers.classPrivateFieldLooseBase(this,A)[A]=new s.Popup({className:t+(e?" --collapse":""),titleBar:babelHelpers.classPrivateFieldLooseBase(this,q)[q](),noAllPaddings:true,contentBackground:"white",draggable:true,zIndexOptions:{alwaysOnTop:e},width:babelHelpers.classPrivateFieldLooseBase(this,X)[X](e),height:babelHelpers.classPrivateFieldLooseBase(this,Y)[Y](e),events:{onResizeStart:()=>{babelHelpers.classPrivateFieldLooseBase(this,A)[A].setMinWidth(babelHelpers.classPrivateFieldLooseBase(this,z)[z]);babelHelpers.classPrivateFieldLooseBase(this,A)[A].setMinHeight(babelHelpers.classPrivateFieldLooseBase(this,$)[$])},onResizeEnd:()=>{babelHelpers.classPrivateFieldLooseBase(this,A)[A].setMinWidth(null);babelHelpers.classPrivateFieldLooseBase(this,A)[A].setMinHeight(null);this.debugger.settings.set("popup-width",babelHelpers.classPrivateFieldLooseBase(this,A)[A].getWidth());this.debugger.settings.set("popup-height",babelHelpers.classPrivateFieldLooseBase(this,A)[A].getHeight())}}});babelHelpers.classPrivateFieldLooseBase(this,A)[A].setResizeMode(!e)}return babelHelpers.classPrivateFieldLooseBase(this,A)[A]}function xe(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,U)[U]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,z)[z],this.debugger.settings.get("popup-width")||0)}function Ae(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,V)[V]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,$)[$],this.debugger.settings.get("popup-height")||0)}function je(){return{content:P.Tag.render(m||(m=f`
				<div class="popup-window-titlebar-text bizproc-debugger-automation__titlebar">
					<div class="bizproc-debugger-automation__titlebar--move-icon"></div>
					${0}
					<div 
						class="bizproc-debugger-automation__titlebar--button-collapse" 
						onclick="${0}"
					></div>
					<span 
						class=" popup-window-close-icon 
								popup-window-titlebar-close-icon 
								bizproc-debugger-automation__titlebar--button-close"
						onclick="${0}"
					></span>
				</div>
			`),document.createTextNode(P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_POPUP_TITLE")),babelHelpers.classPrivateFieldLooseBase(this,Q)[Q].bind(this),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].bind(this))}}function Ne(){const e=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().getPopupContainer();const s=P.Dom.hasClass(e,"--collapse");this.debugger.settings.set("popup-collapsed",!s);babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().getZIndexComponent().setAlwaysOnTop(!s);babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().setResizeMode(s);P.Dom.toggleClass(e,"--collapse");clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,W)[W]);P.Dom.addClass(e,"--changing-view");babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().setWidth(babelHelpers.classPrivateFieldLooseBase(this,X)[X](!s));babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().setHeight(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y](!s));babelHelpers.classPrivateFieldLooseBase(this,W)[W]=setTimeout((()=>P.Dom.removeClass(e,"--changing-view")),500)}function Ge(){p.Manager.Instance.askFinishSession(this.debugger.session).catch((()=>{}))}function Ke(){if(!babelHelpers.classPrivateFieldLooseBase(this,N)[N]){babelHelpers.classPrivateFieldLooseBase(this,N)[N]=P.Tag.render(_||(_=f`
				<div class="bizproc-debugger-automation__content">
					<div class="bizproc-debugger-automation-content-collapsed">
						${0}
					</div>
					<div class="bizproc-debugger-automation__content-expanded">
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,ae)[ae](),babelHelpers.classPrivateFieldLooseBase(this,te)[te]());u.HelpHint.bindAll(babelHelpers.classPrivateFieldLooseBase(this,N)[N])}return babelHelpers.classPrivateFieldLooseBase(this,N)[N]}function ke(){var e,s;const t=!this.debugger.isTemplateEmpty();const a=this.debugger.settings.get("tab")==="log"?"log":"doc";const i=a==="doc"?"--active":"";const l=a==="log"?"--active":"";const r=this.debugger.session.isFixed();const o=r?"":"--empty --active";const n=babelHelpers.classPrivateFieldLooseBase(this,le)[le]();const d=n.querySelector("[data-field-id]")!==null;return P.Tag.render(y||(y=f`
				<div class="bizproc-debugger-automation__main">
					<div class="bizproc-debugger-automation__main-robots">
						<div class="bizproc-debugger-automation__main-robots--head">
							${0}
						</div>
						<div data-role="automation-content" class="bizproc-debugger-automation__main-robots--main-content">
							${0}
							${0}
							<div class="bizproc-debugger-automation__head">
								<div class="bizproc-debugger-automation__main--title">
									<div class="bizproc-debugger-automation__main--name">${0} </div>
									<div class="ui-hint">
										<span class="ui-hint-icon" data-text="${0}"></span>
									</div>
								</div>
								<div data-role="no-template" class="bizproc-debugger-automation__main-hint ${0}">
									<div class="bizproc-debugger-automation__main-hint--title">
										${0}
									</div>
									<div class="bizproc-debugger-automation__main-hint--text">
										${0}
									</div>
									<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
								</div>
							</div>
							${0}
						</div>
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-fields ${0}">
						<div data-role="tabs-container" class="bizproc-debugger-automation__main-navigation --active-${0}">
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="doc" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="log" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							
							<div data-tab-item="doc" class="bizproc-debugger-automation__tab-action ${0}">
								${0}
							</div>
							
							<div data-tab-item="log" class="bizproc-debugger-automation__tab-action ${0}">
								<div class="bizproc-debugger-automation__action-btn --icon-search" style="display: none"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-log" onclick="${0}"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-note" style="display: none"></div>
							</div>
						</div>
						
						<div data-tab-item="doc" data-role="tab-content-doc" class="bizproc-debugger-tab__content ${0} ${0}">
							<div class="bizproc-debugger-tab__content--empty">
								${0}
							</div>
							<div class="bizproc-debugger-tab__content--not-empty">
								<div class="bizproc-debugger-tab__content-title">${0}</div>							
								${0}
							</div>
						</div>
						<div data-tab-item="log" class="bizproc-debugger-tab__content ${0} bizproc-debugger-automation-main-section-log">
							${0}
						</div>
						<div data-tab-item="no-document" class="bizproc-debugger-tab__content ${0} bizproc-debugger-automation-main-section-disabled">
							<div class="bizproc-debugger-tab__content--empty">
								${0}
							</div>
						</div>
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Be)[Be](),(e=babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]())!=null?e:"",(s=babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]())!=null?s:"",P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ROBOTS_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_ROBOT")),t?"":"--active",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_TITLE")),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_SUBTITLE")),this.debugger.getSettingsUrl(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")),babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](),babelHelpers.classPrivateFieldLooseBase(this,he)[he](),r?"":"--disabled",a,i,babelHelpers.classPrivateFieldLooseBase(this,re)[re].bind(this),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_FIELD")),l,babelHelpers.classPrivateFieldLooseBase(this,re)[re].bind(this),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_LOG_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_LOG")),i,babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](),l,(()=>{p.Manager.Instance.openSessionLog(this.debugger.sessionId)}),r?i:"",d?"":"--empty",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_FIELD_TITLE")),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),n,r?l:"",this.debugger.getLogView().shouldScrollToBottom(true).shouldLoadPreviousLog(true).render(),o,P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_FIXED_DOCUMENT")))}function Me(){return P.Tag.render(T||(T=f`
			<div class="bizproc-debugger-automation-menu__content-body">
				<div class="bizproc-debugger-automation-menu__content-body--logo"></div>
				<div class="bizproc-debugger-automation-menu__content-body--text">${0}</div>
			</div>
		`),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_SUBTITLE"))}function ze(){return new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,noCaps:true,text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_ADD_FIELD"),onclick:babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].bind(this)}).render()}function $e(){const e=P.Tag.render(O||(O=f`<div class="ui-form" data-role="doc-field-list">
			</div>`));const s=this.debugger.settings.getSet("watch-fields");s.forEach((s=>{const t=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](s);if(t){P.Dom.append(t,e)}}));return e}function Ue(e){const s=e.target.dataset.tabItem;const t=babelHelpers.classPrivateFieldLooseBase(this,M)[M].filter((e=>e!==s))[0];const a=babelHelpers.classPrivateFieldLooseBase(this,se)[se]();const i=a.querySelector('[data-role="tabs-container"]');a.querySelectorAll([`[data-tab-item="${s}"]`]).forEach((e=>P.Dom.addClass(e,"--active")));a.querySelectorAll([`[data-tab-item="${t}"]`]).forEach((e=>P.Dom.removeClass(e,"--active")));P.Dom.addClass(i,`--active-${s}`);P.Dom.removeClass(i,`--active-${t}`);this.debugger.settings.set("tab",s);this.emit("onChangeTab",{tab:s})}function Ve(e,s){const t=this.debugger.getDocumentFields();const a=this.debugger.settings.getSet("watch-fields");const l=new i.EntitySelector.Dialog({targetNode:s.target,width:500,height:300,multiple:true,dropdownMode:true,enableSearch:true,cacheable:false,items:t.filter((e=>e.Watchable===true)).map((e=>({title:e.Name,id:e.Id,customData:{field:e},entityId:"bp",tabs:"recents",selected:a.has(e.Id)}))),showAvatars:false,events:{"Item:onSelect":e=>babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](e.getData().item),"Item:onDeselect":e=>babelHelpers.classPrivateFieldLooseBase(this,de)[de](e.getData().item.getId())},compactView:true});l.show()}function We(e){const s=this.debugger.settings.getSet("watch-fields");const t=e.getCustomData().get("field");if(s.has(t.Id)){return}const a=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](t);P.Dom.append(a,babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="doc-field-list"]'));s.add(t.Id);this.debugger.settings.set("watch-fields",s);babelHelpers.classPrivateFieldLooseBase(this,be)[be](s)}function Je(e){const s=this.debugger.settings.getSet("watch-fields");if(!s.has(e)){return}s.delete(e);this.debugger.settings.set("watch-fields",s);P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector(`[data-field-id="${e}"]`));babelHelpers.classPrivateFieldLooseBase(this,be)[be](s)}function Ze(e){const s=babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="tab-content-doc"]');const t=s.querySelector("[data-field-id]")!==null;P.Dom[t?"removeClass":"addClass"](s,"--empty")}function Xe(e){if(P.Type.isString(e)){e=this.debugger.getDocumentField(e)}if(!e||!e.Id){return null}const s=this.debugger.getDocumentValue(e.Id)||"";return P.Tag.render(E||(E=f`
			<div class="ui-form-row" data-role="field-row" data-field-id="${0}">
				<div class="ui-form-label">
					<div class="ui-ctl-label-text">${0}</div>
				</div>
				<div class="ui-form-content">
					<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-ext-after-icon">
						<input type="text" readonly class="ui-ctl-element"
						 placeholder="${0}"
						 data-role="field-value-${0}"
						 value="${0}"
						 >
						 <a class="ui-ctl-after ui-ctl-icon-clear" onclick="${0}"></a>
					</div>
				</div>
			</div>
		`),P.Text.encode(e.Id),P.Text.encode(e.Name),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_EMPTY_VALUE"),P.Text.encode(e.Id),P.Text.encode(s),babelHelpers.classPrivateFieldLooseBase(this,de)[de].bind(this,e.Id))}function Ye(){const e=this.debugger.templateTriggers.length>0;const s=!this.debugger.isTemplateEmpty();if(!e&&s){return null}return P.Tag.render(w||(w=f`
			<div data-role="triggers-header" class="bizproc-debugger-automation__head">
				<div class="bizproc-debugger-automation__main--title">
					<div class="bizproc-debugger-automation__main--name">${0} </div>
					<div class="ui-hint">
						<span class="ui-hint-icon" data-text="${0}"></span>
					</div>
				</div>
				<div data-role="no-triggers" class="bizproc-debugger-automation__main-hint ${0}">
					<div class="bizproc-debugger-automation__main-hint--title">
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-hint--text">
						${0}
					</div>
					<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
				</div>
			</div>
		`),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_TRIGGERS_TITLE"),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_TRIGGER")),e||s?"":"--active",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_TITLE")),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_SUBTITLE")),this.debugger.getSettingsUrl(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")))}function qe(){const e=this.debugger.getTemplate().DOCUMENT_STATUS;babelHelpers.classPrivateFieldLooseBase(this,k)[k]=new u.Tracker(u.getGlobalContext().document);const s={};s[e]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,k)[k].init(s);u.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,k)[k];const t=this.debugger.templateTriggers;if(t.length===0){return null}const a=P.Tag.render(I||(I=f`
			<div data-role="triggers" class="bizproc-debugger__template">
				<div class="bizproc-automation-status-list-item" data-type="column-trigger">
					<div data-role="trigger-list" class="bizproc-automation-trigger-list" data-status-id="${0}"></div>
				</div>
			</div>
		`),e);babelHelpers.classPrivateFieldLooseBase(this,G)[G]=new u.TriggerManager(a);babelHelpers.classPrivateFieldLooseBase(this,G)[G].init({TRIGGERS:t},u.ViewMode.view());return a}function Qe(){const e=this.debugger.getTemplate();babelHelpers.classPrivateFieldLooseBase(this,k)[k]=new u.Tracker(u.getGlobalContext().document);const s={};s[e.DOCUMENT_STATUS]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,k)[k].init(s);u.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,k)[k];const t=P.Tag.render(S||(S=f`
			<div data-role="template" class="bizproc-debugger__template">
				<div data-role="automation-template" data-status-id="${0}">
					<div data-role="robot-list" class="bizproc-automation-robot-list"></div>
				</div>
			</div>
		`),e.DOCUMENT_STATUS);const a=new u.Template({constants:{},variables:{},templateContainerNode:t,delayMinLimitM:0});a.init(e,u.ViewMode.view().intoRaw());babelHelpers.classPrivateFieldLooseBase(this,ge)[ge](a);babelHelpers.classPrivateFieldLooseBase(this,He)[He]();return t}function es(e){if(!P.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,K)[K])){babelHelpers.classPrivateFieldLooseBase(this,K)[K].destroy()}babelHelpers.classPrivateFieldLooseBase(this,K)[K]=e;return babelHelpers.classPrivateFieldLooseBase(this,K)[K]}function ss(){babelHelpers.classPrivateFieldLooseBase(this,J)[J]=new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,icon:t.ButtonIcon.START,onclick:babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe].bind(this)});const e=this.debugger.hasWorkflowEvents();const s=this.debugger.session.isFixed();return P.Tag.render(D||(D=f`
			<div class="bizproc-debugger-automation__toolbar ${0}">
			<div data-role="external-event-info" class="bizproc-debugger-automation__toolbar--info-waiting ${0}">
				<div>
					${0}
				</div>
				<a onclick="${0}" class="bizproc-debugger-automation__link">
					${0}
				</a>
			</div>
			<div class="bizproc-debugger-automation__toolbar--btn-block">
				${0}
				<div class="bizproc-debugger-automation__toolbar--btn-text">
					${0}
				</div>
			</div>
			</div>
		`),s?"":"--disabled",e?"--active":"",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_SUBTITLE")),babelHelpers.classPrivateFieldLooseBase(this,Le)[Le].bind(this),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_TITLE")),babelHelpers.classPrivateFieldLooseBase(this,J)[J].render(),P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START"))}function ts(e){e.setWaiting(true);this.debugger.startDebugTemplate().then((()=>{e.setWaiting(false);babelHelpers.classPrivateFieldLooseBase(this,De)[De](this.debugger.getState())}))}function as(e){const s=babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="external-event-info"]');P.Dom.removeClass(s,"--active");this.debugger.emulateExternalEvent(e.target.dataset.sourceId)}function is(e){if(babelHelpers.classPrivateFieldLooseBase(this,k)[k]){const e={};e[this.debugger.getDocumentStatus()]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,k)[k].reInit(e);babelHelpers.classPrivateFieldLooseBase(this,K)[K].reInit(null,u.ViewMode.view().intoRaw());babelHelpers.classPrivateFieldLooseBase(this,He)[He]()}}function ls(){const e=babelHelpers.classPrivateFieldLooseBase(this,K)[K].robots.filter((e=>e.getLogStatus()===u.TrackingStatus.RUNNING));e.forEach((e=>{const s=e.node.lastChild.lastChild;const t=P.Runtime.clone(s);u.HelpHint.bindToNode(t);P.Dom.replace(s,P.Tag.render(C||(C=f`
					<div class="bizproc-debugger-automation-robot-info-container">
						${0}
						<a 
							onclick="${0}"
							data-source-id="${0}"
							class="bizproc-debugger-automation__link --inside-robot"
						>
							${0}
						</a>
					</div>
				`),t,babelHelpers.classPrivateFieldLooseBase(this,Le)[Le].bind(this),e.getId(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_TITLE"))))}))}function rs(){const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]();const s=P.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]());return P.Tag.render(R||(R=f`
			<div 
				class="bizproc-debugger-automation__status --robot-change ${0}"
				data-role="document-status"
				title="${0}"
				onclick="${0}"
			>
				<div class="bizproc-debugger-automation__status--title" data-role="document-status-title">
					${0}
				</div>
				<div class="bizproc-debugger-automation__status--bg" data-role="document-status-bg" style="background-color: ${0}; border-color: ${0};">
					<span class="bizproc-debugger-automation__status--bg-arrow"></span>
				</div>
			</div>
		`),B.getBgColorAdditionalClass(e),s,babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].bind(this),s,e,e)}function os(e){e.preventDefault();const t=this.debugger.getStatusList();const a=new s.Menu({bindElement:e.target,items:t.map((e=>({text:e.NAME,statusId:e["STATUS_ID"],onclick:babelHelpers.classPrivateFieldLooseBase(this,me)[me].bind(this)})))});a.show()}function ns(e,s){s.getMenuWindow().destroy();this.debugger.setDocumentStatus(s.statusId)}function ds(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.NAME||t.TITLE:"?"}function bs(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.COLOR:"#9DCF00"}function cs(){if(!babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().isShown()){return}const e=babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="automation-content"]');const s=new d.Loader({target:e});P.Dom.addClass(e,"--loading");s.show();this.debugger.loadMainViewInfo().then((()=>{const t=babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="document-status-title"]');const a=babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]();t.textContent=a;t.parentNode.setAttribute("title",a);const i=babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="document-status-bg"]');const l=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]();P.Dom.style(i,{backgroundColor:l,borderColor:l});const r=babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="document-status"]');P.Dom.removeClass(r,["--with-border","--light-color"]);P.Dom.addClass(r,B.getBgColorAdditionalClass(l));P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="triggers-header"]'));P.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="triggers"]'));P.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,pe)[pe](),e);const o=babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]();if(o){u.HelpHint.bindAll(o);P.Dom.prepend(o,e)}const n=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]();P.Dom.replace(babelHelpers.classPrivateFieldLooseBase(this,N)[N].querySelector('[data-role="template"]'),n);const d=this.debugger.templateTriggers.length>0;const b=!this.debugger.isTemplateEmpty();P.Dom[d||b?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,N)[N].querySelector('[data-role="no-triggers"]'),"--active");P.Dom[b?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,N)[N].querySelector('[data-role="no-template"]'),"--active");P.Dom.removeClass(e,"--loading");s.destroy()}))}function us(e){if(!babelHelpers.classPrivateFieldLooseBase(this,J)[J]){return}const s=e.getData().events;const t=babelHelpers.classPrivateFieldLooseBase(this,se)[se]().querySelector('[data-role="external-event-info"]');P.Dom[s.length?"addClass":"removeClass"](t,"--active")}function ps(e){babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe](this.debugger.track)}function vs(e){if(!babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().isShown()){return}const s=e.getData().values;const t=babelHelpers.classPrivateFieldLooseBase(this,se)[se]();Object.keys(s).forEach((e=>{const a=t.querySelector(`[data-role="field-value-${e}"]`);if(a){a.value=s[e]||""}}))}function gs(e){const s=e.getData().status;const t=e.getData().workflowId;if([u.WorkflowStatus.COMPLETED,u.WorkflowStatus.TERMINATED].includes(s)){this.debugger.track.forEach((e=>{if(e["WORKFLOW_ID"]===t){e["WORKFLOW_STATUS"]=u.WorkflowStatus.COMPLETED}}));babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe](this.debugger.track)}}function hs(){const e=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().getPopupContainer();P.Dom.removeClass(e.getElementsByClassName("bizproc-debugger-automation__main-fields")[0],"--disabled");P.Dom.removeClass(e.getElementsByClassName("bizproc-debugger-automation__toolbar")[0],"--disabled");const s=this.debugger.settings.get("tab")==="log"?"log":"doc";e.querySelectorAll([`[data-tab-item="no-document"]`]).forEach((e=>P.Dom.removeClass(e,["--empty","--active"])));e.querySelectorAll([`[data-tab-item="${s}"]`]).forEach((e=>P.Dom.addClass(e,"--active")));babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]()}function Ps(e){if(!babelHelpers.classPrivateFieldLooseBase(this,J)[J]){return}switch(e){case H.Run:babelHelpers.classPrivateFieldLooseBase(this,J)[J].setIcon(t.ButtonIcon.PAUSE);babelHelpers.classPrivateFieldLooseBase(this,J)[J].getContainer().nextElementSibling.textContent=P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_PAUSE");break;default:babelHelpers.classPrivateFieldLooseBase(this,J)[J].setIcon(t.ButtonIcon.START);babelHelpers.classPrivateFieldLooseBase(this,J)[J].getContainer().nextElementSibling.textContent=P.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START")}}class Ls{static isMode(e){return[0,1].includes(e)}static getMode(e){if(e===0){return Ls.experimental}else if(e===1){return Ls.interception}return null}static getAllModes(){return{0:Ls.experimental,1:Ls.interception}}}Ls.experimental={id:0,code:"experimental"};Ls.interception={id:1,code:"interception"};var Fs=babelHelpers.classPrivateFieldLooseKey("id");var Hs=babelHelpers.classPrivateFieldLooseKey("sessionId");var Bs=babelHelpers.classPrivateFieldLooseKey("documentId");var fs=babelHelpers.classPrivateFieldLooseKey("categoryId");var ms=babelHelpers.classPrivateFieldLooseKey("dateExpire");var _s=babelHelpers.classPrivateFieldLooseKey("documentSigned");class ys{constructor(e){Object.defineProperty(this,Fs,{writable:true,value:void 0});Object.defineProperty(this,Hs,{writable:true,value:void 0});Object.defineProperty(this,Bs,{writable:true,value:void 0});Object.defineProperty(this,fs,{writable:true,value:void 0});Object.defineProperty(this,ms,{writable:true,value:void 0});Object.defineProperty(this,_s,{writable:true,value:""});babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs]=parseInt(e.Id)>=0?parseInt(e.Id):0;babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs]=P.Type.isStringFilled(e.SessionId)?e.SessionId:"";babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]=P.Type.isStringFilled(e.DocumentId)?e.DocumentId:"";babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]=P.Text.toInteger(e.DocumentCategoryId);babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]=B.toDate(e.DateExpire);if(e.DocumentSigned){this.documentSigned=e.DocumentSigned}}get documentId(){return babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]}get categoryId(){return babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]}set categoryId(e){babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]=P.Type.isNumber(e)?e:0}get documentSigned(){return babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]}set documentSigned(e){babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]=P.Type.isStringFilled(e)?e:""}}var Ts=babelHelpers.classPrivateFieldLooseKey("id");var Os=babelHelpers.classPrivateFieldLooseKey("mode");var Es=babelHelpers.classPrivateFieldLooseKey("startedBy");var ws=babelHelpers.classPrivateFieldLooseKey("active");var Is=babelHelpers.classPrivateFieldLooseKey("fixed");var Ss=babelHelpers.classPrivateFieldLooseKey("documents");var Ds=babelHelpers.classPrivateFieldLooseKey("shortDescription");var Cs=babelHelpers.classPrivateFieldLooseKey("categoryId");var Rs=babelHelpers.classPrivateFieldLooseKey("documentSigned");var xs=babelHelpers.classPrivateFieldLooseKey("finished");var As=babelHelpers.classPrivateFieldLooseKey("pullFinishHandler");var js=babelHelpers.classPrivateFieldLooseKey("pullDocumentValuesHandler");var Ns=babelHelpers.classPrivateFieldLooseKey("setMode");var Gs=babelHelpers.classPrivateFieldLooseKey("setDocuments");var Ks=babelHelpers.classPrivateFieldLooseKey("innerFinish");var ks=babelHelpers.classPrivateFieldLooseKey("handleExternalFinished");var Ms=babelHelpers.classPrivateFieldLooseKey("handleExternalDocumentValues");var zs=babelHelpers.classPrivateFieldLooseKey("handleFinish");var $s=babelHelpers.classPrivateFieldLooseKey("updateSession");class Us extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,$s,{value:qs});Object.defineProperty(this,zs,{value:Ys});Object.defineProperty(this,Ms,{value:Xs});Object.defineProperty(this,ks,{value:Zs});Object.defineProperty(this,Ks,{value:Js});Object.defineProperty(this,Gs,{value:Ws});Object.defineProperty(this,Ns,{value:Vs});Object.defineProperty(this,Ts,{writable:true,value:""});Object.defineProperty(this,Os,{writable:true,value:{}});Object.defineProperty(this,Es,{writable:true,value:0});Object.defineProperty(this,ws,{writable:true,value:void 0});Object.defineProperty(this,Is,{writable:true,value:void 0});Object.defineProperty(this,Ss,{writable:true,value:[]});Object.defineProperty(this,Ds,{writable:true,value:""});Object.defineProperty(this,Cs,{writable:true,value:0});Object.defineProperty(this,Rs,{writable:true,value:""});Object.defineProperty(this,xs,{writable:true,value:false});Object.defineProperty(this,As,{writable:true,value:void 0});Object.defineProperty(this,js,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.Session");e=P.Type.isPlainObject(e)?e:{};babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]=e.Id;babelHelpers.classPrivateFieldLooseBase(this,Ns)[Ns](e.Mode);babelHelpers.classPrivateFieldLooseBase(this,Es)[Es]=parseInt(e.StartedBy)>=0?parseInt(e.StartedBy):0;babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds]=String(e.ShortDescription);babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]=Boolean(e.Active);babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]=Boolean(e.Fixed);babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]=P.Text.toInteger(e.CategoryId);babelHelpers.classPrivateFieldLooseBase(this,Gs)[Gs](e.Documents);if(this.isActive()){babelHelpers.classPrivateFieldLooseBase(this,As)[As]=babelHelpers.classPrivateFieldLooseBase(this,ks)[ks].bind(this);p.Manager.Instance.pullHandler.subscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,As)[As]);babelHelpers.classPrivateFieldLooseBase(this,js)[js]=babelHelpers.classPrivateFieldLooseBase(this,Ms)[Ms].bind(this);p.Manager.Instance.pullHandler.subscribe("documentValues",babelHelpers.classPrivateFieldLooseBase(this,js)[js])}}set documentSigned(e){if(this.isFixed()&&this.activeDocument){this.activeDocument.documentSigned=e}babelHelpers.classPrivateFieldLooseBase(this,Rs)[Rs]=e}get documentSigned(){if(this.activeDocument){const e=this.activeDocument.documentSigned;if(P.Type.isStringFilled(e)){return e}}return babelHelpers.classPrivateFieldLooseBase(this,Rs)[Rs]}get id(){return babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]}get startedBy(){return babelHelpers.classPrivateFieldLooseBase(this,Es)[Es]}get activeDocument(){if(babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss].length===1){return babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss][0]}return null}get modeId(){return babelHelpers.classPrivateFieldLooseBase(this,Os)[Os].id}get shortDescription(){return babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds]}get initialCategoryId(){return babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]}isActive(){return babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]}isFixed(){return babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]}isSessionStartedByUser(e){return this.startedBy===e}isAutomation(){return true}isInterceptionMode(){return this.modeId===Ls.interception.id}isExperimentalMode(){return this.modeId===Ls.experimental.id}static start(e,s){return new Promise(((t,a)=>{P.ajax.runAction("bizproc.debugger.startSession",{data:{documentSigned:e,mode:s},analyticsLabel:{automation_select_debug_mode:"Y",mode_type:Ls.getMode(s).code}}).then((e=>{const s=new Us(e.data.session);s.documentSigned=e.data.documentSigned;t(s)}),a)}))}finish(e={}){return babelHelpers.classPrivateFieldLooseBase(this,Ks)[Ks](e).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,zs)[zs]();return e}))}fixateDocument(e){return P.ajax.runAction("bizproc.debugger.fixateSessionDocument",{data:{documentId:e}}).then((e=>{this.documentSigned=e.data.documentSigned;babelHelpers.classPrivateFieldLooseBase(this,$s)[$s](e.data.session);this.emit("onAfterDocumentFixed");return e}))}removeDocuments(e=[]){return P.ajax.runAction("bizproc.debugger.removeSessionDocument",{data:{documentIds:e}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,$s)[$s](e.data.session);return e}))}}function Vs(e){e=B.isNumeric(e)?Number(e):null;if(Ls.isMode(e)){babelHelpers.classPrivateFieldLooseBase(this,Os)[Os]=Ls.getMode(e)}}function Ws(e){if(P.Type.isArrayFilled(e)){e.forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss].push(new ys(e))}))}return this}function Js(e={}){return P.ajax.runAction("bizproc.debugger.finishDebugSession",{json:{sessionId:this.id,...e}})}function Zs(e){const s=e.getData().sessionId;if(s===this.id){babelHelpers.classPrivateFieldLooseBase(this,zs)[zs]()}}function Xs(e){if(!this.activeDocument){return}const s=e.getData().rawValues;const t=s["CATEGORY_ID"];if(t){this.activeDocument.categoryId=P.Text.toInteger(t);p.Manager.Instance.requireSetFilter(this)}}function Ys(){if(!babelHelpers.classPrivateFieldLooseBase(this,xs)[xs]){babelHelpers.classPrivateFieldLooseBase(this,xs)[xs]=true;this.emit("onFinished");this.unsubscribeAll();if(babelHelpers.classPrivateFieldLooseBase(this,As)[As]){p.Manager.Instance.pullHandler.unsubscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,As)[As]);babelHelpers.classPrivateFieldLooseBase(this,As)[As]=null}if(babelHelpers.classPrivateFieldLooseBase(this,js)[js]){p.Manager.Instance.pullHandler.unsubscribe("documentValues",babelHelpers.classPrivateFieldLooseBase(this,js)[js]);babelHelpers.classPrivateFieldLooseBase(this,js)[js]=null}}}function qs(e={}){if(Object.keys(e).length<=0){return}babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]=Boolean(e.Active);babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]=Boolean(e.Fixed);babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]=P.Text.toInteger(e.CategoryId);babelHelpers.classPrivateFieldLooseBase(this,Gs)[Gs](e.Documents)}let Qs=e=>e,et,st,tt,at,it,lt,rt,ot,nt,dt,bt,ct,ut,pt,vt,gt,ht;var Pt=babelHelpers.classPrivateFieldLooseKey("robot");var Lt=babelHelpers.classPrivateFieldLooseKey("view");var Ft=babelHelpers.classPrivateFieldLooseKey("currentNode");var Ht=babelHelpers.classPrivateFieldLooseKey("currentIndex");var Bt=babelHelpers.classPrivateFieldLooseKey("isAfterPreviousRendered");var ft=babelHelpers.classPrivateFieldLooseKey("isPauseRendered");var mt=babelHelpers.classPrivateFieldLooseKey("isActivityBodyRendered");var _t=babelHelpers.classPrivateFieldLooseKey("prevRobotTitle");var yt=babelHelpers.classPrivateFieldLooseKey("getCurrentRobotNode");var Tt=babelHelpers.classPrivateFieldLooseKey("renderRobotTitle");var Ot=babelHelpers.classPrivateFieldLooseKey("renderAfterPrevious");var Et=babelHelpers.classPrivateFieldLooseKey("renderPause");var wt=babelHelpers.classPrivateFieldLooseKey("renderDelayInterval");var It=babelHelpers.classPrivateFieldLooseKey("renderCondition");var St=babelHelpers.classPrivateFieldLooseKey("renderConditions");var Dt=babelHelpers.classPrivateFieldLooseKey("renderActivity");var Ct=babelHelpers.classPrivateFieldLooseKey("renderActivityFinish");var Rt=babelHelpers.classPrivateFieldLooseKey("renderNote");var xt=babelHelpers.classPrivateFieldLooseKey("renderDebugNote");var At=babelHelpers.classPrivateFieldLooseKey("renderDebugLink");class jt{constructor(e,s){Object.defineProperty(this,At,{value:Zt});Object.defineProperty(this,xt,{value:Jt});Object.defineProperty(this,Rt,{value:Wt});Object.defineProperty(this,Ct,{value:Vt});Object.defineProperty(this,Dt,{value:Ut});Object.defineProperty(this,St,{value:$t});Object.defineProperty(this,It,{value:zt});Object.defineProperty(this,wt,{value:Mt});Object.defineProperty(this,Et,{value:kt});Object.defineProperty(this,Ot,{value:Kt});Object.defineProperty(this,Tt,{value:Gt});Object.defineProperty(this,yt,{value:Nt});Object.defineProperty(this,Pt,{writable:true,value:void 0});Object.defineProperty(this,Lt,{writable:true,value:void 0});Object.defineProperty(this,Ft,{writable:true,value:null});Object.defineProperty(this,Ht,{writable:true,value:null});Object.defineProperty(this,Bt,{writable:true,value:false});Object.defineProperty(this,ft,{writable:true,value:false});Object.defineProperty(this,mt,{writable:true,value:false});Object.defineProperty(this,_t,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt]=e;babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt]=s}get name(){return babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt].name}get title(){return babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt].title}get delayName(){return babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt].delayName}get conditionNames(){return babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt].conditionNames}getActivitiesName(){let e=[];if(this.name){e.push(this.name)}if(this.delayName){e.push(this.delayName)}e=e.concat(this.conditionNames);return e}set previousRobotTitle(e){babelHelpers.classPrivateFieldLooseBase(this,_t)[_t]=e}renderTrack(e){const s=[u.TrackingEntry.EXECUTE_ACTIVITY_TYPE,u.TrackingEntry.ATTACHED_ENTITY_TYPE];if(s.includes(e.type)){return}if(e.name===this.delayName){return babelHelpers.classPrivateFieldLooseBase(this,Et)[Et](e)}if(this.conditionNames.includes(e.name)){if(babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,wt)[wt](new u.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]=true}return babelHelpers.classPrivateFieldLooseBase(this,It)[It](e)}if(e.name===this.name){if(babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,wt)[wt](new u.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]=true}return babelHelpers.classPrivateFieldLooseBase(this,Dt)[Dt](e)}}}function Nt(e){if(babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index!==babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]){const s=P.Tag.render(et||(et=Qs`
				<div class="bizproc-debugger-automation__log-section">
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt](e.datetime));if(P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,_t)[_t])&&babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt]===false){P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot](),s)}P.Dom.append(s,babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].logNode);babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft]=s}return babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft]}function Gt(e){const s=P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TITLE",{"#TITLE#":this.title});const t=P.Tag.render(st||(st=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),ei.renderTime(e),P.Text.encode(s));babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index;return t}function Kt(){babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt]=true;const e=P.Tag.render(tt||(tt=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --blue">
							"${0}"
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_AFTER_PREVIOUS"),P.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,_t)[_t]));babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index;return e}function kt(e){babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]=true;const s=[u.TrackingEntry.CLOSE_ACTIVITY_TYPE];if(s.includes(e.type)){return}if(e.type===u.TrackingEntry.DEBUG_AUTOMATION_TYPE){const s=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);const t=JSON.parse(e.note);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,wt)[wt](t),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Rt)[Rt](e),t)}function Mt(e={}){var s;const t=new u.DelayInterval(e);let a=(s=e.fieldName)!=null?s:(new u.DelayIntervalSelector).getBasisField(t.basis,true).Name;a=a+" ["+e.fieldValue+"]";const i=t.format(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_AT_ONCE"),[{SystemExpression:t.basis,Name:a}]);const l=P.Tag.render(at||(at=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --dark-blue">
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_RUN"),P.Text.encode(i));babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index;return l}function zt(e){const s=[u.TrackingEntry.CLOSE_ACTIVITY_TYPE];if(s.includes(e.type)){return}if(e.type===u.TrackingEntry.DEBUG_AUTOMATION_TYPE){const s=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,St)[St](e),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Rt)[Rt](e),t)}function $t(e){const s=JSON.parse(e.note);const t=P.Tag.render(it||(it=Qs`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),s.result==="Y"?P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"):P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_FALSE"));Object.keys(s).forEach((e=>{if(e==="result"){return}let a="";if(s.result===s[e]["result"]){a=s.result==="Y"?"bizproc-debugger-automation__log-color-box --green":"bizproc-debugger-automation__log-color-box --orange"}const i=s[e]["condition"];const l=i["field"];const r=s[e]["fieldValue"]?String(s[e]["fieldValue"]):"";const o=b.Operator.getOperatorLabel(i["operator"]);const n=i["value"];const d=B.getJoinerLabel(s[e]["joiner"]);P.Dom.append(P.Tag.render(lt||(lt=Qs`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0} 
							${0} 
							${0}
						</span>
					</div>
				`),a,e==="0"?"":P.Text.encode(d)+" ",P.Text.encode(l)+" ","["+P.Text.encode(r)+"] ",P.Text.encode(o)+" ",P.Text.encode(n)),t)}));const a=P.Tag.render(rt||(rt=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index;return a}function Ut(e){if(e.type===u.TrackingEntry.CLOSE_ACTIVITY_TYPE){if(babelHelpers.classPrivateFieldLooseBase(this,mt)[mt]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);return P.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ct)[Ct](),s)}return}babelHelpers.classPrivateFieldLooseBase(this,mt)[mt]=true;const s=babelHelpers.classPrivateFieldLooseBase(this,yt)[yt](e);const t=babelHelpers.classPrivateFieldLooseBase(this,Rt)[Rt](e);P.Dom.append(t,s);babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].collapseInfoResults(t)}function Vt(){return P.Tag.render(ot||(ot=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation-log-section-robot-activity">
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_FINISH_WITHOUT_SETTINGS"))}function Wt(e){if([u.TrackingEntry.DEBUG_AUTOMATION_TYPE,u.TrackingEntry.DEBUG_ACTIVITY_TYPE].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,xt)[xt](e)}if([u.TrackingEntry.DEBUG_LINK_TYPE].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,At)[At](e)}const s=[u.TrackingEntry.CANCEL_ACTIVITY_TYPE,u.TrackingEntry.FAULT_ACTIVITY_TYPE,u.TrackingEntry.ERROR_ACTIVITY_TYPE].includes(e.type)?"bizproc-debugger-automation__log-color-box --red":"";const t=P.Tag.render(nt||(nt=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info--value --first">
					<span class="${0}">
						${0}
					</span>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),s,P.Text.encode(e.note).replace(/([^>])\n/g,"$1<br>"));babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index;return t}function Jt(e){const s=JSON.parse(e.note);const t=P.Tag.render(dt||(dt=Qs`<div class="bizproc-debugger-automation__log-info"></div>`));if(s["propertyName"]){P.Dom.append(P.Tag.render(bt||(bt=Qs`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),P.Text.encode(s["propertyName"]),P.Text.encode(s["propertyName"])),t)}P.Dom.append(P.Tag.render(ct||(ct=Qs`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<div>
							${0}
						</div>
					</div>
					<div data-role="more-info-result" style="display:none;">
						<span class="bizproc-debugger-automation__log-info--more">
							${0}
						</span>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",s["propertyValue"]?P.Text.encode(s["propertyValue"]).replace(/([^>])\n/g,"$1<br>"):"",P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_MORE_INFORMATION"))),t);const a=P.Tag.render(ut||(ut=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index;return a}function Zt(e){const s=JSON.parse(e.note);const t=P.Tag.render(pt||(pt=Qs`<div class="bizproc-debugger-automation__log-info"></div>`));const a=s["propertyLinkName"]||s["propertyValue"];const i=s["propertyValue"];if(s["propertyName"]){P.Dom.append(P.Tag.render(vt||(vt=Qs`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),P.Text.encode(s["propertyName"]),P.Text.encode(s["propertyName"])),t)}P.Dom.append(P.Tag.render(gt||(gt=Qs`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<a href="${0}" target="_blank">
							${0}
						</a>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",P.Text.encode(i),a),t);const l=P.Tag.render(ht||(ht=Qs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt].index;return l}let Xt=e=>e,Yt,qt,Qt,ea,sa;var ta=babelHelpers.classPrivateFieldLooseKey("view");var aa=babelHelpers.classPrivateFieldLooseKey("condition");var ia=babelHelpers.classPrivateFieldLooseKey("title");var la=babelHelpers.classPrivateFieldLooseKey("track");var ra=babelHelpers.classPrivateFieldLooseKey("renderTitle");var oa=babelHelpers.classPrivateFieldLooseKey("renderCondition");class na{constructor(e){Object.defineProperty(this,oa,{value:ba});Object.defineProperty(this,ra,{value:da});Object.defineProperty(this,ta,{writable:true,value:void 0});Object.defineProperty(this,aa,{writable:true,value:{}});Object.defineProperty(this,ia,{writable:true,value:""});Object.defineProperty(this,la,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,ta)[ta]=e}addTrack(e){if(e.type===u.TrackingEntry.DEBUG_AUTOMATION_TYPE&&e.name==="TRIGGER_LOG"){babelHelpers.classPrivateFieldLooseBase(this,aa)[aa]=JSON.parse(e.note);babelHelpers.classPrivateFieldLooseBase(this,ia)[ia]=e.title;babelHelpers.classPrivateFieldLooseBase(this,la)[la]=e}return this}render(){const e=P.Tag.render(Yt||(Yt=Xt`
			<div class="bizproc-debugger-automation__log-section">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					<div class="bizproc-debugger-automation__log-info--value --first">
						<span>
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ra)[ra](),babelHelpers.classPrivateFieldLooseBase(this,oa)[oa](),babelHelpers.classPrivateFieldLooseBase(this,ta)[ta].renderIndex(),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_FINISH")));P.Dom.append(e,babelHelpers.classPrivateFieldLooseBase(this,ta)[ta].logNode)}}function da(){const e=P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_TITLE",{"#TITLE#":babelHelpers.classPrivateFieldLooseBase(this,ia)[ia]});return P.Tag.render(qt||(qt=Xt`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ta)[ta].renderIndex(),ei.renderTime(babelHelpers.classPrivateFieldLooseBase(this,la)[la].datetime),P.Text.encode(e))}function ba(){if(!babelHelpers.classPrivateFieldLooseBase(this,aa)[aa]||Object.keys(babelHelpers.classPrivateFieldLooseBase(this,aa)[aa]).length<=0){return""}const e=babelHelpers.classPrivateFieldLooseBase(this,aa)[aa];const s=P.Tag.render(Qt||(Qt=Xt`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),P.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"));Object.keys(e).forEach((t=>{const a=e[t]["result"]==="Y"?"bizproc-debugger-automation__log-color-box --green":"";const i=e[t]["condition"];const l=i["field"];const r=e[t]["fieldValue"]?String(e[t]["fieldValue"]):"";const o=b.Operator.getOperatorLabel(i["operator"]);const n=i["value"];const d=B.getJoinerLabel(e[t]["joiner"]);P.Dom.append(P.Tag.render(ea||(ea=Xt`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0}
							${0}
							${0}
						</span>
					</div>
				`),a,t==="0"?"":P.Text.encode(d)+" ",P.Text.encode(l)+" ","["+P.Text.encode(r)+"] ",P.Text.encode(o)+" ",P.Text.encode(n)),s)}));return P.Tag.render(sa||(sa=Xt`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ta)[ta].renderIndex(),s)}let ca=e=>e,ua,pa,va,ga,ha,Pa,La;var Fa=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var Ha=babelHelpers.classPrivateFieldLooseKey("workflowId");var Ba=babelHelpers.classPrivateFieldLooseKey("activityRenderer");var fa=babelHelpers.classPrivateFieldLooseKey("documentStatus");var ma=babelHelpers.classPrivateFieldLooseKey("categoryName");var _a=babelHelpers.classPrivateFieldLooseKey("statusSettings");var ya=babelHelpers.classPrivateFieldLooseKey("node");var Ta=babelHelpers.classPrivateFieldLooseKey("index");var Oa=babelHelpers.classPrivateFieldLooseKey("trackId");var Ea=babelHelpers.classPrivateFieldLooseKey("poolTrack");var wa=babelHelpers.classPrivateFieldLooseKey("poolWorkflowRobots");var Ia=babelHelpers.classPrivateFieldLooseKey("isRendering");var Sa=babelHelpers.classPrivateFieldLooseKey("NUMBER_OF_LINES_TO_SHOW_IN_PIXELS");var Da=babelHelpers.classPrivateFieldLooseKey("shouldScrollToBottom");var Ca=babelHelpers.classPrivateFieldLooseKey("shouldLoadPreviousLog");var Ra=babelHelpers.classPrivateFieldLooseKey("onTrackAddedHandler");var xa=babelHelpers.classPrivateFieldLooseKey("onChangeTabHandler");var Aa=babelHelpers.classPrivateFieldLooseKey("onSessionFinishedHandler");var ja=babelHelpers.classPrivateFieldLooseKey("autoScrollHandler");var Na=babelHelpers.classPrivateFieldLooseKey("scrollAnimationId");var Ga=babelHelpers.classPrivateFieldLooseKey("loadPreviousLog");var Ka=babelHelpers.classPrivateFieldLooseKey("loadWorkflowRobotsByWorkflowId");var ka=babelHelpers.classPrivateFieldLooseKey("onAfterGetLog");var Ma=babelHelpers.classPrivateFieldLooseKey("renderStartDebugLog");var za=babelHelpers.classPrivateFieldLooseKey("renderStartedDate");var $a=babelHelpers.classPrivateFieldLooseKey("renderLegend");var Ua=babelHelpers.classPrivateFieldLooseKey("renderCategoryChange");var Va=babelHelpers.classPrivateFieldLooseKey("onChangeTab");var Wa=babelHelpers.classPrivateFieldLooseKey("bindAutoScroll");var Ja=babelHelpers.classPrivateFieldLooseKey("scrollToBottom");var Za=babelHelpers.classPrivateFieldLooseKey("animateScroll");var Xa=babelHelpers.classPrivateFieldLooseKey("cancelAnimateScroll");var Ya=babelHelpers.classPrivateFieldLooseKey("askScrollToBottom");var qa=babelHelpers.classPrivateFieldLooseKey("clearWorkflowRobots");var Qa=babelHelpers.classPrivateFieldLooseKey("onSessionFinished");class ei{constructor(e){Object.defineProperty(this,Qa,{value:gi});Object.defineProperty(this,qa,{value:vi});Object.defineProperty(this,Ya,{value:pi});Object.defineProperty(this,Xa,{value:ui});Object.defineProperty(this,Za,{value:ci});Object.defineProperty(this,Ja,{value:bi});Object.defineProperty(this,Wa,{value:di});Object.defineProperty(this,Va,{value:ni});Object.defineProperty(this,Ua,{value:oi});Object.defineProperty(this,$a,{value:ri});Object.defineProperty(this,za,{value:li});Object.defineProperty(this,Ma,{value:ii});Object.defineProperty(this,ka,{value:ai});Object.defineProperty(this,Ka,{value:ti});Object.defineProperty(this,Ga,{value:si});Object.defineProperty(this,Fa,{writable:true,value:null});Object.defineProperty(this,Ha,{writable:true,value:void 0});Object.defineProperty(this,Ba,{writable:true,value:{}});Object.defineProperty(this,fa,{writable:true,value:""});Object.defineProperty(this,ma,{writable:true,value:""});Object.defineProperty(this,_a,{writable:true,value:void 0});Object.defineProperty(this,ya,{writable:true,value:null});Object.defineProperty(this,Ta,{writable:true,value:0});Object.defineProperty(this,Oa,{writable:true,value:0});Object.defineProperty(this,Ea,{writable:true,value:[]});Object.defineProperty(this,wa,{writable:true,value:{}});Object.defineProperty(this,Ia,{writable:true,value:true});Object.defineProperty(this,Da,{writable:true,value:false});Object.defineProperty(this,Ca,{writable:true,value:false});Object.defineProperty(this,Ra,{writable:true,value:void 0});Object.defineProperty(this,xa,{writable:true,value:void 0});Object.defineProperty(this,Aa,{writable:true,value:void 0});Object.defineProperty(this,ja,{writable:true,value:void 0});Object.defineProperty(this,Na,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]=e;babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=this.debugger.workflowId;const s=this.debugger.getTemplate();this.initializeWorkflowRobotsRenderer(s?s["ROBOTS"]:[]);if(this.debugger.session.isActive()){babelHelpers.classPrivateFieldLooseBase(this,Ra)[Ra]=this.onTrackAdded.bind(this);this.debugger.subscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,Ra)[Ra]);babelHelpers.classPrivateFieldLooseBase(this,xa)[xa]=babelHelpers.classPrivateFieldLooseBase(this,Va)[Va].bind(this);this.debugger.getMainView().subscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,xa)[xa]);babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa]=babelHelpers.classPrivateFieldLooseBase(this,Qa)[Qa].bind(this);this.debugger.session.subscribeOnce("onFinished",babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa])}}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]}get index(){return babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]}get logNode(){if(!babelHelpers.classPrivateFieldLooseBase(this,ya)[ya]){babelHelpers.classPrivateFieldLooseBase(this,ya)[ya]=P.Tag.render(ua||(ua=ca`<div data-role="log" class="bizproc-debugger-tab__log"></div>`))}return babelHelpers.classPrivateFieldLooseBase(this,ya)[ya]}initializeWorkflowRobotsRenderer(e=[],s=null){if(!s&&!babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]){return}if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]])){babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]]={}}if(P.Type.isArrayFilled(e)){let a=null;for(let i=0;i<e.length;++i){var t;const l=new u.Robot({});l.init(e[i],u.ViewMode.none());const r=new jt(this,{name:l.getId(),title:l.getTitle(),delayName:(t=l.data.DelayName)!=null?t:null,conditionNames:l.getCondition().conditionNamesList});if(l.isExecuteAfterPrevious()&&a){r.previousRobotTitle=a}a=l.getTitle();r.getActivitiesName().forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]][e]=r}))}}}shouldLoadPreviousLog(e){babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca]=e;return this}setPreviousLog(e={logs:[],workflowRobots:{}}){babelHelpers.classPrivateFieldLooseBase(this,ka)[ka](e);return this}render(){if(this.logNode.children.length<=0){babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]=true;if(babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca]){babelHelpers.classPrivateFieldLooseBase(this,Ga)[Ga]().then((()=>{this.startRendering()}))}else{this.startRendering()}}return this.logNode}renderTo(e){P.Dom.append(this.logNode,e);babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]=true;this.startRendering();return this}startRendering(){const e=babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea].shift();if(P.Type.isUndefined(e)){babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]=false;babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]();babelHelpers.classPrivateFieldLooseBase(this,Wa)[Wa](babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]);return}if(babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]!==e.workflowId){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba][e.workflowId])){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa][e.workflowId])){babelHelpers.classPrivateFieldLooseBase(this,Ka)[Ka](e);this.renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha]=e.workflowId;return}this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa][e.workflowId],e.workflowId)}}this.renderTrack(e);this.startRendering()}renderIndex(){babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]++;return P.Tag.render(pa||(pa=ca`
			<div class="bizproc-debugger-automation__log--index" data-role="index">${0}</div>
		`),String(babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]).padStart(3,"0"))}static renderTime(e){e=B.toDate(e);return P.Tag.render(va||(va=ca`
			<div class="bizproc-debugger-automation__log--time">
				[${0}]
			</div>
		`),P.Text.encode(B.formatDate("H:i:s",e)))}renderStatusChange(e){const s=JSON.parse(e.note);if(!P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,fa)[fa])){babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=s;return}const t=this.getStatusSettings(babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]);const a=s;const i=P.Tag.render(ga||(ga=ca`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div class="bizproc-debugger-automation__status--change-info">
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
						<div class="bizproc-debugger-automation__status--robot-change-arrow"></div>
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),ei.renderTime(e.datetime),B.getBgColorAdditionalClass(t["COLOR"]),P.Text.encode(t["NAME"]),P.Text.encode(t["NAME"]),t["COLOR"],t["COLOR"],B.getBgColorAdditionalClass(a["COLOR"]),P.Text.encode(a["NAME"]),P.Text.encode(a["NAME"]),a.COLOR,a.COLOR);P.Dom.append(i,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=s}getStatusSettings(){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,_a)[_a])){return{NAME:"",COLOR:"AEF2F9"}}return babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]}onTrackAdded(e){const s=new u.TrackingEntryBuilder;s.setLogEntry(e.getData().row);this.addTrack(s.build())}addTrack(e){if(!babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]){this.renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]();return}babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea].push(e)}renderTrack(e){var s;if(e.id<=babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]){return}if(!Object.keys((s=babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba][e.workflowId])!=null?s:{}).includes(e.name)){if(e.name==="SESSION_LEGEND"){babelHelpers.classPrivateFieldLooseBase(this,Ma)[Ma](e);babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=e.id}else if(e.name==="STATUS_CHANGED"){this.renderStatusChange(e);babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=e.id}else if(e.name==="CATEGORY_CHANGED"){babelHelpers.classPrivateFieldLooseBase(this,Ua)[Ua](e);babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=e.id}else if(e.name==="TRIGGER_LOG"){new na(this).addTrack(e).render();babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=e.id}else if(e.name==="Template"&&e.type===u.TrackingEntry.EXECUTE_ACTIVITY_TYPE){if(P.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa][e.workflowId])&&babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]===false){babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]=true;babelHelpers.classPrivateFieldLooseBase(this,Ka)[Ka](e)}}else if(e.name==="Template"&&e.type===u.TrackingEntry.CLOSE_ACTIVITY_TYPE){babelHelpers.classPrivateFieldLooseBase(this,qa)[qa](e.workflowId)}return}babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba][e.workflowId][e.name].renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=e.id}collapseInfoResults(e){if(!e){e=this.logNode}const s=e.querySelectorAll('[data-role="info-result"]');s.forEach((e=>{if(e.firstElementChild.clientHeight>babelHelpers.classPrivateFieldLooseBase(this.constructor,Sa)[Sa]){const s=e.parentNode.querySelector('[data-role="more-info-result"]');P.Event.bind(s,"click",(()=>{P.Dom.style(e,"height",e.firstElementChild.clientHeight+"px");P.Dom.style(s,"display","none")}));P.Event.bind(e,"transitionend",(()=>{P.Dom.style(e,"height",null)}));P.Dom.style(e,"height",babelHelpers.classPrivateFieldLooseBase(this.constructor,Sa)[Sa]+"px");P.Dom.style(s,"display","block")}}));return this}shouldScrollToBottom(e){babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]=e;return this}}function si(){return new Promise((e=>{this.debugger.loadAllLog().then((s=>{babelHelpers.classPrivateFieldLooseBase(this,ka)[ka](s);e(this)}),(()=>{e(this)}))}))}function ti(e){this.debugger.loadRobotsByWorkflowId(e.workflowId).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,wa)[wa][e.workflowId]=s.workflowRobots;this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa][e.workflowId],e.workflowId);this.startRendering()}),(()=>{babelHelpers.classPrivateFieldLooseBase(this,wa)[wa][e.workflowId]=[];console.info("session has no workflowId from track:",e);this.startRendering()}))}function ai(e){const s=[];const t=new u.TrackingEntryBuilder;if(P.Type.isArrayFilled(e["logs"])){e["logs"].forEach((e=>{s.push(t.setLogEntry(e).build())}))}babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]=s.concat(babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]);babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]=Object.assign(e["workflowRobots"],babelHelpers.classPrivateFieldLooseBase(this,wa)[wa])}function ii(e){babelHelpers.classPrivateFieldLooseBase(this,za)[za](e);babelHelpers.classPrivateFieldLooseBase(this,$a)[$a](e)}function li(e){const s=B.toDate(e.datetime);const t=P.Tag.render(ha||(ha=ca`
			<div class="bizproc-debugger-automation__log--date">
				<div class="bizproc-debugger-automation__log--date-text">${0}</div>
			</div>
		`),P.Text.encode(B.formatDate("j F Y",s)));P.Dom.append(t,this.logNode)}function ri(e){const s=JSON.parse(e.note)["propertyValue"];const t=P.Tag.render(Pa||(Pa=ca`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div>${0}</div>
				</div>
			</div>
		`),this.renderIndex(),ei.renderTime(e.datetime),P.Text.encode(s));P.Dom.append(t,this.logNode)}function oi(e){const s=JSON.parse(e.note)["propertyValue"];if(!P.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,ma)[ma])){babelHelpers.classPrivateFieldLooseBase(this,ma)[ma]=s;return}const t=P.Tag.render(La||(La=ca`
			<div>
				<div class="bizproc-debugger-automation__log-separator"></div>
				<div class="bizproc-debugger-automation__log-section">
					<div class="bizproc-debugger-automation__log-section--row">
						${0}
						${0}
						<div>
							${0}
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),ei.renderTime(e.datetime),P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CATEGORY_CHANGE_MSGVER_1",{"#SOURCE_CATEGORY#":babelHelpers.classPrivateFieldLooseBase(this,ma)[ma],"#DESTINATION_CATEGORY#":s})));P.Dom.append(t,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,ma)[ma]=s}function ni(e){if(e.getData().tab==="log"){this.collapseInfoResults();babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]()}}function di(e){if(!this.logNode.parentNode){return}const s=this.logNode.parentNode;if(e){babelHelpers.classPrivateFieldLooseBase(this,ja)[ja]=()=>{if(babelHelpers.classPrivateFieldLooseBase(this,Na)[Na]){return}const e=s.scrollHeight-s.clientHeight;babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]=s.scrollTop>=e-babelHelpers.classPrivateFieldLooseBase(this.constructor,Sa)[Sa]};P.Event.bind(s,"scroll",babelHelpers.classPrivateFieldLooseBase(this,ja)[ja])}else if(babelHelpers.classPrivateFieldLooseBase(this,ja)[ja]){P.Event.unbind(s,"scroll",babelHelpers.classPrivateFieldLooseBase(this,ja)[ja])}}function bi(){if(!this.logNode.parentNode){return}const e=this.logNode.parentNode;const s=e.scrollTop;const t=e.scrollHeight-e.clientHeight;babelHelpers.classPrivateFieldLooseBase(this,Za)[Za](e,s,t)}function ci(e,s,t){babelHelpers.classPrivateFieldLooseBase(this,Xa)[Xa]();const a=20;const i=500;const l=t-s;let r=0;const o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)};const n=()=>{r+=a;e.scrollTop=hi(r,s,l,i);if(r<i){babelHelpers.classPrivateFieldLooseBase(this,Na)[Na]=o(n)}else{babelHelpers.classPrivateFieldLooseBase(this,Na)[Na]=null}};return n()}function ui(){if(babelHelpers.classPrivateFieldLooseBase(this,Na)[Na]){const e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)};e(babelHelpers.classPrivateFieldLooseBase(this,Na)[Na]);babelHelpers.classPrivateFieldLooseBase(this,Na)[Na]=null}}function pi(){if(babelHelpers.classPrivateFieldLooseBase(this,Da)[Da]){babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]()}}function vi(e){delete babelHelpers.classPrivateFieldLooseBase(this,wa)[wa][e];delete babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba][e]}function gi(){this.debugger.unsubscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,Ra)[Ra]);this.debugger.getMainView().unsubscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,xa)[xa])}Object.defineProperty(ei,Sa,{writable:true,value:50});const hi=function(e,s,t,a){e/=a/2;if(e<1){return t/2*e*e+s}e--;return-t/2*(e*(e-2)-1)+s};var Pi=babelHelpers.classPrivateFieldLooseKey("guide");var Li=babelHelpers.classPrivateFieldLooseKey("getHtmlTitle");class Fi{constructor(e){Object.defineProperty(this,Pi,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi]=new L.Guide({steps:[{target:e.target,title:babelHelpers.classPrivateFieldLooseBase(Fi,Li)[Li](e.title)||"",text:e.text||"",condition:{top:true,bottom:false,color:"warning"}}],onEvents:true})}start(){babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi].getPopup().setWidth(370);babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi].showNextStep()}finish(){babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi].close()}}function Hi(e){if(e){return`\n\t\t\t\t<div class="bizproc__action-panel-guide">\n\t\t\t\t\t<div class="bizproc__action-panel-guide--title --warning-icon">${P.Text.encode(e)}</div>\n\t\t\t\t</div>\n\t\t\t`}return null}Object.defineProperty(Fi,Li,{value:Hi});var Bi=babelHelpers.classPrivateFieldLooseKey("actionPanel");var fi=babelHelpers.classPrivateFieldLooseKey("grid");var mi=babelHelpers.classPrivateFieldLooseKey("guides");var _i=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var yi=babelHelpers.classPrivateFieldLooseKey("appendItems");var Ti=babelHelpers.classPrivateFieldLooseKey("onHideActionPanel");var Oi=babelHelpers.classPrivateFieldLooseKey("getRemoveEntityActionText");var Ei=babelHelpers.classPrivateFieldLooseKey("getCheckedIdsInBpStyle");var wi=babelHelpers.classPrivateFieldLooseKey("handleRejectResponse");class Ii{constructor(e,s){Object.defineProperty(this,wi,{value:xi});Object.defineProperty(this,Ei,{value:Ri});Object.defineProperty(this,Oi,{value:Ci});Object.defineProperty(this,Ti,{value:Di});Object.defineProperty(this,yi,{value:Si});Object.defineProperty(this,Bi,{writable:true,value:null});Object.defineProperty(this,fi,{writable:true,value:null});Object.defineProperty(this,mi,{writable:true,value:[]});Object.defineProperty(this,_i,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,fi)[fi]=e;babelHelpers.classPrivateFieldLooseBase(this,_i)[_i]=s;babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi]=new BX.UI.ActionPanel({removeLeftPosition:true,maxHeight:58,parentPosition:"bottom",autoHide:false});babelHelpers.classPrivateFieldLooseBase(this,yi)[yi]();const t=babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti].bind(this);h.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi],"BX.UI.ActionPanel:hidePanel",t)}get actionPanel(){return babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi]}fixEntityAction(){const e=babelHelpers.classPrivateFieldLooseBase(this,Ei)[Ei]();if(e.length!==1){const e=new Fi({target:this.actionPanel.getItemById("fix_entity").layout.container,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_COUNT_ERROR_TITLE"),article:"limit_office_bp_designer"});babelHelpers.classPrivateFieldLooseBase(this,mi)[mi].push(e);e.start();return}babelHelpers.classPrivateFieldLooseBase(this,_i)[_i].session.fixateDocument(e[0]).then((()=>{this.stopActionPanel();p.Manager.Instance.requireSetFilter(babelHelpers.classPrivateFieldLooseBase(this,_i)[_i].session,true);if(babelHelpers.classPrivateFieldLooseBase(this,_i)[_i].settings.get("popup-collapsed")){babelHelpers.classPrivateFieldLooseBase(this,_i)[_i].getMainView().showExpanded()}}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,wi)[wi](e,"fix_entity")}))}removeEntityAction(){const e=babelHelpers.classPrivateFieldLooseBase(this,Ei)[Ei]();babelHelpers.classPrivateFieldLooseBase(this,_i)[_i].session.removeDocuments(e).then((()=>{this.actionPanel.hidePanel();babelHelpers.classPrivateFieldLooseBase(this,fi)[fi].reload()}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,wi)[wi](e,"remove_entity")}))}stopActionPanel(){this.actionPanel.hidePanel();babelHelpers.classPrivateFieldLooseBase(this,fi)[fi].resetActionPanel();babelHelpers.classPrivateFieldLooseBase(this,fi)[fi].stopActionPanel()}}function Si(){babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi].appendItem({id:"fix_entity",text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_ACTION_1"),onclick:this.fixEntityAction.bind(this)});babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi].appendItem({id:"remove_entity",text:babelHelpers.classPrivateFieldLooseBase(this,Oi)[Oi](),onclick:this.removeEntityAction.bind(this)});babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi].appendItem({id:"finish_debug",text:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FINISH_DEBUG_ACTION"),onclick:function(){p.Manager.Instance.askFinishSession(babelHelpers.classPrivateFieldLooseBase(this,_i)[_i].session).then((()=>{this.stopActionPanel()}),(e=>{babelHelpers.classPrivateFieldLooseBase(this,wi)[wi](e,"finish_debug")}))}.bind(this)})}function Di(){babelHelpers.classPrivateFieldLooseBase(this,mi)[mi].forEach((e=>{e.finish()}))}function Ci(){return`\n\t\t\t<span>${P.Text.encode(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_REMOVE_DEAL_ACTION_1"))}</span>\n\t\t`}function Ri(){const e=babelHelpers.classPrivateFieldLooseBase(this,fi)[fi].getCheckedId();return e.map((e=>"DEAL_"+e))}function xi(e,s){if(!e.errors){return}let t="";e.errors.forEach((e=>{t=t+"\n"+e.message}));const a=new Fi({target:this.actionPanel.getItemById(s).layout.container,title:t,article:"limit_office_bp_designer"});babelHelpers.classPrivateFieldLooseBase(this,mi)[mi].push(a);a.start()}var Ai=babelHelpers.classPrivateFieldLooseKey("pullHandlers");var ji=babelHelpers.classPrivateFieldLooseKey("settings");var Ni=babelHelpers.classPrivateFieldLooseKey("mainView");var Gi=babelHelpers.classPrivateFieldLooseKey("triggers");var Ki=babelHelpers.classPrivateFieldLooseKey("template");var ki=babelHelpers.classPrivateFieldLooseKey("documentStatus");var Mi=babelHelpers.classPrivateFieldLooseKey("statusList");var zi=babelHelpers.classPrivateFieldLooseKey("documentCategoryId");var $i=babelHelpers.classPrivateFieldLooseKey("documentFields");var Ui=babelHelpers.classPrivateFieldLooseKey("documentValues");var Vi=babelHelpers.classPrivateFieldLooseKey("workflowId");var Wi=babelHelpers.classPrivateFieldLooseKey("workflowStatus");var Ji=babelHelpers.classPrivateFieldLooseKey("workflowEvents");var Zi=babelHelpers.classPrivateFieldLooseKey("workflowTrack");var Xi=babelHelpers.classPrivateFieldLooseKey("debuggerState");var Yi=babelHelpers.classPrivateFieldLooseKey("customActionPanel");var qi=babelHelpers.classPrivateFieldLooseKey("resumeShowActionPanel");var Qi=babelHelpers.classPrivateFieldLooseKey("shouldSetCustomActionPanel");var el=babelHelpers.classPrivateFieldLooseKey("initAutomationContext");var sl=babelHelpers.classPrivateFieldLooseKey("subscribePull");var tl=babelHelpers.classPrivateFieldLooseKey("unsubscribePull");var al=babelHelpers.classPrivateFieldLooseKey("handleRejectResponse");var il=babelHelpers.classPrivateFieldLooseKey("onAfterDocumentFixed");class ll extends h.EventEmitter{constructor(e={}){super();Object.defineProperty(this,il,{value:ul});Object.defineProperty(this,al,{value:cl});Object.defineProperty(this,tl,{value:bl});Object.defineProperty(this,sl,{value:dl});Object.defineProperty(this,el,{value:nl});Object.defineProperty(this,Qi,{value:ol});Object.defineProperty(this,qi,{value:rl});this.session=null;Object.defineProperty(this,Ai,{writable:true,value:null});Object.defineProperty(this,ji,{writable:true,value:void 0});Object.defineProperty(this,Ni,{writable:true,value:void 0});Object.defineProperty(this,Gi,{writable:true,value:void 0});Object.defineProperty(this,Ki,{writable:true,value:void 0});Object.defineProperty(this,ki,{writable:true,value:void 0});Object.defineProperty(this,Mi,{writable:true,value:void 0});Object.defineProperty(this,zi,{writable:true,value:0});Object.defineProperty(this,$i,{writable:true,value:void 0});Object.defineProperty(this,Ui,{writable:true,value:{}});Object.defineProperty(this,Vi,{writable:true,value:void 0});Object.defineProperty(this,Wi,{writable:true,value:void 0});Object.defineProperty(this,Ji,{writable:true,value:[]});Object.defineProperty(this,Zi,{writable:true,value:[]});Object.defineProperty(this,Xi,{writable:true,value:void 0});Object.defineProperty(this,Yi,{writable:true,value:null});this.setEventNamespace("BX.Bizproc.Debugger.Automation");this.session=e.session;if(this.session.isActive()){this.session.subscribeOnce("onAfterDocumentFixed",babelHelpers.classPrivateFieldLooseBase(this,il)[il].bind(this));this.session.subscribe("onFinished",this.destroy.bind(this));babelHelpers.classPrivateFieldLooseBase(this,sl)[sl]()}babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]=new g.Settings("atm-dbg");babelHelpers.classPrivateFieldLooseBase(this,el)[el]();babelHelpers.classPrivateFieldLooseBase(this,qi)[qi]()}destroy(){var e,s;this.unsubscribeAll();babelHelpers.classPrivateFieldLooseBase(this,tl)[tl]();(e=babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni])==null?void 0:e.destroy();this.session=null;babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]=null;babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=null;babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=[];babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=null;babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]=[];babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]=[];babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]={};babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]=null;babelHelpers.classPrivateFieldLooseBase(this,Wi)[Wi]=0;babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]=[];babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi]=[];(s=babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi])==null?void 0:s.stopActionPanel()}get track(){return babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi]}get settings(){return babelHelpers.classPrivateFieldLooseBase(this,ji)[ji]}get documentSigned(){return this.session.documentSigned}get sessionId(){return this.session.id}get workflowId(){return babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]}get pullHandlers(){if(babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]===null){babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]=[{name:"documentStatus",func:this.handleExternalDocumentStatus.bind(this)},{name:"documentValues",func:this.handleExternalDocumentValues.bind(this)},{name:"documentDelete",func:this.handleExternalDocumentDelete.bind(this)},{name:"workflowStatus",func:this.handleExternalWorkflowStatus.bind(this)},{name:"workflowEventAdd",func:this.handleExternalWorkflowEventAdd.bind(this)},{name:"workflowEventRemove",func:this.handleExternalWorkflowEventRemove.bind(this)},{name:"trackRow",func:this.handleExternalTrackRow.bind(this)}]}return babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]}getMainView(){if(!babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]){babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]=new Ce(this)}return babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni]}getLogView(){return new ei(this)}getStatusList(){return babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]}getDocumentFields(){return babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]}getDocumentField(e){return babelHelpers.classPrivateFieldLooseBase(this,$i)[$i].find((s=>s.Id===e))}getDocumentValue(e){return babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui][e]||null}getDocumentStatus(){return babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]}getWorkflowStatus(){return babelHelpers.classPrivateFieldLooseBase(this,Wi)[Wi]}getState(){return babelHelpers.classPrivateFieldLooseBase(this,Xi)[Xi]}hasWorkflowEvents(){return babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji].length>0}setDocumentStatus(e){return new Promise((s=>{P.ajax.runAction("bizproc.debugger.setDocumentStatus",{data:{statusId:e}}).then((e=>{if(e.data&&e.data.newStatus){babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=e.data.newStatus;babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=e.data.template;babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi]=[];this.emit("onDocumentStatusChanged")}s(e)}),babelHelpers.classPrivateFieldLooseBase(this,al)[al].bind(this))}))}get templateTriggers(){return babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi].filter((e=>e["DOCUMENT_STATUS"]===babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]["DOCUMENT_STATUS"]))}getTemplate(){return babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]}isTemplateEmpty(){return babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki].IS_EXTERNAL_MODIFIED===false&&!P.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki].ROBOTS)}startDebugTemplate(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.resumeAutomationTemplate",{data:{sessionId:this.sessionId},analyticsLabel:"automation_start_debug"}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,Xi)[Xi]=s.data.debuggerState;e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,al)[al].bind(this))}))}emulateExternalEvent(e){return new Promise((s=>{var t;let a=(t=babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji][0])==null?void 0:t.name;if(P.Type.isStringFilled(e)){var i;a=(i=babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji].find((({sourceId:s})=>s===e)))==null?void 0:i.name}if(!a){return}P.ajax.runAction("bizproc.debugger.emulateExternalEvent",{data:{workflowId:babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi],eventId:a}}).then((e=>{s(e.data)}),babelHelpers.classPrivateFieldLooseBase(this,al)[al].bind(this))}))}loadMainViewInfo(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.fillAutomationView",{data:{sessionId:this.sessionId}}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Gi)[Gi]=s.data.triggers;babelHelpers.classPrivateFieldLooseBase(this,Ki)[Ki]=s.data.template;babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=s.data.documentStatus;babelHelpers.classPrivateFieldLooseBase(this,Mi)[Mi]=s.data.statusList;babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]=s.data.documentCategoryId;babelHelpers.classPrivateFieldLooseBase(this,$i)[$i]=s.data.documentFields;babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui]=s.data.documentValues;babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,Wi)[Wi]=s.data.workflowStatus;babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]=s.data.workflowEvents;babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi]=s.data.track;babelHelpers.classPrivateFieldLooseBase(this,Xi)[Xi]=s.data.debuggerState;u.getGlobalContext().document.setFields(this.getDocumentFields()).setStatusList(this.getStatusList()).setStatus(this.getDocumentStatus());u.getGlobalContext().automationGlobals.globalConstants=P.Type.isArrayFilled(s.data.globalConstants)?s.data.globalConstants:[];u.getGlobalContext().automationGlobals.globalVariables=P.Type.isArrayFilled(s.data.globalVariables)?s.data.globalVariables:[];e()}),babelHelpers.classPrivateFieldLooseBase(this,al)[al].bind(this))}))}get globalConstants(){const e=u.getGlobalContext();return e&&e.automationGlobals?e.automationGlobals.globalConstants:[]}get globalVariables(){const e=u.getGlobalContext();return e&&e.automationGlobals?e.automationGlobals.globalVariables:[]}loadAllLog(){return new Promise((e=>{P.ajax.runAction("bizproc.debugger.loadAllLog",{data:{sessionId:this.session.id}}).then((s=>{e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,al)[al].bind(this))}))}loadRobotsByWorkflowId(e){return new Promise(((s,t)=>{P.ajax.runAction("bizproc.debugger.loadRobotsByWorkflowId",{data:{sessionId:this.sessionId,workflowId:e}}).then((e=>{s(e.data)}),(e=>{t(e.data)}))}))}handleExternalDocumentStatus(e){const s=e.getData().status;if(this.getDocumentStatus()===s){return}console.info("document status: "+s);babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]=s;this.emit("onDocumentStatusChanged")}handleExternalDocumentValues(e){const s=e.getData().values;Object.keys(s).forEach((e=>babelHelpers.classPrivateFieldLooseBase(this,Ui)[Ui][e]=s[e]));console.info("document values: "+Object.keys(s));this.emit("onDocumentValuesUpdated",{values:s})}handleExternalDocumentDelete(){F.MessageBox.show({message:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_ON_DOCUMENT_DELETE"),okCaption:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),onOk:()=>Jl.Instance.finishSession(this.session).then(null,babelHelpers.classPrivateFieldLooseBase(this,al)[al].bind(this)),buttons:F.MessageBoxButtons.OK_CANCEL})}handleExternalTrackRow(e){const s=e.getData().row;s["WORKFLOW_STATUS"]=babelHelpers.classPrivateFieldLooseBase(this,Wi)[Wi];babelHelpers.classPrivateFieldLooseBase(this,Zi)[Zi].push(s);this.emit("onWorkflowTrackAdded",{row:s})}handleExternalWorkflowStatus(e){const s=e.getData().status;const t=e.getData().workflowId;babelHelpers.classPrivateFieldLooseBase(this,Wi)[Wi]=s;if(s===u.WorkflowStatus.RUNNING){babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]=t}if(babelHelpers.classPrivateFieldLooseBase(this,Vi)[Vi]!==t){return}console.info("workflow status: "+s);this.emit("onWorkflowStatusChanged",{status:s,workflowId:t})}handleExternalWorkflowEventAdd(e){const s=e.getData().eventName;const t=e.getData().sourceId;console.info("workflow event added: "+s);babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji].push({name:s,sourceId:t});console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji].map((e=>e.name)).join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]})}handleExternalWorkflowEventRemove(e){const s=e.getData().eventName;console.info("workflow event removed: "+s);babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]=babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji].filter((({name:e})=>e!==s));console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji].map((({name:e})=>e)).join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,Ji)[Ji]})}getField(e,s){let t;switch(e){case"Document":t=babelHelpers.classPrivateFieldLooseBase(this,$i)[$i].find((e=>e.Id===s));break;case"Template":case"Parameter":case"Constant":case"GlobalConst":case"GlobalVar":break}return t||{Id:s,ObjectId:e,Name:s,Type:"string",Expression:s,SystemExpression:"{="+e+":"+s+"}"}}getSettingsUrl(){return`/crm/deal/automation/${babelHelpers.classPrivateFieldLooseBase(this,zi)[zi]}/`}}function rl(){if(this.session.isInterceptionMode()&&!this.session.isFixed()){if(P.Reflection.getClass("BX.CRM.Kanban.Grid")){const e=BX.CRM.Kanban.Grid.getInstance();if(babelHelpers.classPrivateFieldLooseBase(this,Qi)[Qi](e)){babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi]=new Ii(e,this);e.stopActionPanel(true);e.resetActionPanel();e.setCustomActionPanel(babelHelpers.classPrivateFieldLooseBase(this,Yi)[Yi].actionPanel)}}}}function ol(e){const s=e.getData();const t=s.entityType;if(t!=="DEAL"){return false}const a=s.params.hasOwnProperty("CATEGORY_ID")?P.Text.toInteger(s.params.CATEGORY_ID):0;return this.session.initialCategoryId===a}function nl(){const e=new u.Context({document:new u.Document({rawDocumentType:[],documentId:null,categoryId:0,statusList:this.getStatusList(),statusId:this.getDocumentStatus(),documentFields:this.getDocumentFields()}),documentSigned:this.documentSigned,canEdit:false,canManage:false,automationGlobals:new u.AutomationGlobals({variables:[],constants:[]})});u.setGlobalContext(e)}function dl(){const e=Jl.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.subscribe(s,t)}))}function bl(){if(babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]===null){return}const e=Jl.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.unsubscribe(s,t)}));babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]=null}function cl(e){if(P.Type.isArrayFilled(e.errors)){const s=e.errors.find((e=>e.code===404));if(s){this.handleExternalDocumentDelete()}else{const s=e.errors.map((e=>e.message)).join("\n");F.MessageBox.alert(s)}}}function ul(){this.loadMainViewInfo().then((()=>{this.emit("onAfterDocumentFixed")}))}var pl=babelHelpers.classPrivateFieldLooseKey("unsubscribe");var vl=babelHelpers.classPrivateFieldLooseKey("commands");var gl=babelHelpers.classPrivateFieldLooseKey("handleCommand");class hl extends h.EventEmitter{constructor(){super();Object.defineProperty(this,gl,{value:Pl});Object.defineProperty(this,pl,{writable:true,value:void 0});Object.defineProperty(this,vl,{writable:true,value:["documentStatus","documentValues","documentDelete","workflowStatus","workflowEventAdd","workflowEventRemove","trackRow","sessionFinish"]});this.setEventNamespace("BX.Bizproc.Debugger.Pull");babelHelpers.classPrivateFieldLooseBase(this,pl)[pl]=v.PULL.subscribe(this)}destroy(){if(P.Type.isFunction(babelHelpers.classPrivateFieldLooseBase(this,pl)[pl])){babelHelpers.classPrivateFieldLooseBase(this,pl)[pl]()}babelHelpers.classPrivateFieldLooseBase(this,pl)[pl]=null}getModuleId(){return"bizproc"}getSubscriptionType(){return BX.PullClient.SubscriptionType.Server}getMap(){const e={};babelHelpers.classPrivateFieldLooseBase(this,vl)[vl].forEach((s=>{e[s]=babelHelpers.classPrivateFieldLooseBase(this,gl)[gl].bind(this)}));return e}}function Pl(e,s,t){this.emit(t,e)}var Ll=babelHelpers.classPrivateFieldLooseKey("getText");class Fl{constructor(e){var s;this.guide=new L.Guide({steps:[{target:e.target,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TITLE"),text:babelHelpers.classPrivateFieldLooseBase(Fl,Ll)[Ll](),article:"16087180",events:(s=e.events)!=null?s:{},condition:{top:true,bottom:false,color:"primary"}}],onEvents:true});this.bindEvents()}bindEvents(){}start(){this.guide.getPopup().setWidth(365);this.guide.showNextStep()}}function Hl(){return`\n\t\t\t<ul class="bizproc-debugger-filter-guide-list">\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${B.toHtml(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_1"))}\n\t\t\t\t</li>\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${B.toHtml(P.Loc.getMessage("BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_2"))}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`}Object.defineProperty(Fl,Ll,{value:Hl});var Bl=babelHelpers.classPrivateFieldLooseKey("getText");class fl{constructor(e){var s;this.guide=new L.Guide({steps:[{target:e.target,title:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TITLE"),text:babelHelpers.classPrivateFieldLooseBase(fl,Bl)[Bl](),article:"16483018",events:(s=e.events)!=null?s:{},condition:{top:true,bottom:false,color:"primary"}}],onEvents:true})}start(){this.guide.getPopup().setWidth(330);this.guide.showNextStep()}}function ml(){return`\n\t\t\t<ul class="bizproc-debugger-filter-guide-list">\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_1")}\n\t\t\t\t</li>\n\t\t\t\t<li class="bizproc-debugger-filter-guide-list-item">\n\t\t\t\t\t${P.Loc.getMessage("BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_2")}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`}Object.defineProperty(fl,Bl,{value:ml});var _l=babelHelpers.classPrivateFieldLooseKey("grid");var yl=babelHelpers.classPrivateFieldLooseKey("guides");var Tl=babelHelpers.classPrivateFieldLooseKey("reserveFilterIds");var Ol=babelHelpers.classPrivateFieldLooseKey("getStageGuide");var El=babelHelpers.classPrivateFieldLooseKey("getFilterGuide");class wl extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,El,{value:Sl});Object.defineProperty(this,Ol,{value:Il});Object.defineProperty(this,_l,{writable:true,value:null});Object.defineProperty(this,yl,{writable:true,value:[]});Object.defineProperty(this,Tl,{writable:true,value:[]});this.setEventNamespace("BX.Bizproc.Debugger.CrmDebuggerGuide");babelHelpers.classPrivateFieldLooseBase(this,_l)[_l]=e.grid;babelHelpers.classPrivateFieldLooseBase(this,Tl)[Tl]=e.reserveFilterIds;if(e.showStageStep){const e=babelHelpers.classPrivateFieldLooseBase(this,Ol)[Ol]();if(e){babelHelpers.classPrivateFieldLooseBase(this,yl)[yl].push(e)}}if(e.showFilterStep){const e=babelHelpers.classPrivateFieldLooseBase(this,El)[El]();if(e){babelHelpers.classPrivateFieldLooseBase(this,yl)[yl].push(e)}}}start(){if(babelHelpers.classPrivateFieldLooseBase(this,yl)[yl].length<=0){return}babelHelpers.classPrivateFieldLooseBase(this,yl)[yl][babelHelpers.classPrivateFieldLooseBase(this,yl)[yl].length-1].start()}}function Il(){if(!babelHelpers.classPrivateFieldLooseBase(this,_l)[_l]){return}const e=babelHelpers.classPrivateFieldLooseBase(this,_l)[_l].getColumns()[0];if(!e){return null}const s=e.getTitleContainer();if(!s){return null}const t=babelHelpers.classPrivateFieldLooseBase(this,yl)[yl][babelHelpers.classPrivateFieldLooseBase(this,yl)[yl].length-1];return new fl({target:"."+s.classList[0],events:{onShow:function(){this.emit("onStageGuideStepShow")}.bind(this),onClose:function(){if(t){t.start()}this.emit("onStageGuideStepClose")}.bind(this)}})}function Sl(){var e,s;const t=babelHelpers.classPrivateFieldLooseBase(this,_l)[_l]?[babelHelpers.classPrivateFieldLooseBase(this,_l)[_l].getData().gridId]:babelHelpers.classPrivateFieldLooseBase(this,Tl)[Tl];if(t.length<=0){return null}let a;for(const e in t){a=BX.Main.filterManager.getById(t[e]);if(a){break}}if(!a){return null}const i=a.getApi();const l=i==null?void 0:(e=i.parent)==null?void 0:(s=e.getPopupBindElement())==null?void 0:s.firstElementChild;if(!l){return null}const r=babelHelpers.classPrivateFieldLooseBase(this,yl)[yl][babelHelpers.classPrivateFieldLooseBase(this,yl)[yl].length-1];return new Fl({target:l,events:{onShow:function(){this.emit("onFilterGuideStepShow")}.bind(this),onClose:function(){if(r){r.start()}this.emit("onFilterGuideStepClose")}.bind(this)}})}let Dl=e=>e,Cl,Rl;let xl=null;var Al=babelHelpers.classPrivateFieldLooseKey("settings");var jl=babelHelpers.classPrivateFieldLooseKey("showDebugger");var Nl=babelHelpers.classPrivateFieldLooseKey("showGuide");var Gl=babelHelpers.classPrivateFieldLooseKey("setDebugFilter");var Kl=babelHelpers.classPrivateFieldLooseKey("removeDebugFilter");var kl=babelHelpers.classPrivateFieldLooseKey("lastFilterId");var Ml=babelHelpers.classPrivateFieldLooseKey("getFilterApis");var zl=babelHelpers.classPrivateFieldLooseKey("getFilterIds");var $l=babelHelpers.classPrivateFieldLooseKey("isFilterGuideShown");var Ul=babelHelpers.classPrivateFieldLooseKey("isStageGuideShown");var Vl=babelHelpers.classPrivateFieldLooseKey("setFilterGuideShown");var Wl=babelHelpers.classPrivateFieldLooseKey("setStageGuideShown");class Jl{static get Instance(){if(xl===null){xl=new Jl}return xl}constructor(){Object.defineProperty(this,Wl,{value:rr});Object.defineProperty(this,Vl,{value:lr});Object.defineProperty(this,Ul,{value:ir});Object.defineProperty(this,$l,{value:ar});Object.defineProperty(this,zl,{value:tr});Object.defineProperty(this,Ml,{value:sr});Object.defineProperty(this,kl,{get:Ql,set:er});Object.defineProperty(this,Kl,{value:ql});Object.defineProperty(this,Gl,{value:Yl});Object.defineProperty(this,Nl,{value:Xl});Object.defineProperty(this,jl,{value:Zl});Object.defineProperty(this,Al,{writable:true,value:void 0});this.pullHandler=new hl;babelHelpers.classPrivateFieldLooseBase(this,Al)[Al]=new g.Settings("manager")}initializeDebugger(e={session:{},documentSigned:""}){const s=P.Type.isPlainObject(e.session)?new Us(e.session):null;if(!s){return}s.documentSigned=e.documentSigned;this.requireSetFilter(s);babelHelpers.classPrivateFieldLooseBase(this,jl)[jl](s)}startSession(e,s){return new Promise(((t,a)=>{Us.start(e,s).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,kl)[kl]=null;babelHelpers.classPrivateFieldLooseBase(this,Gl)[Gl](e);const s=babelHelpers.classPrivateFieldLooseBase(this,jl)[jl](e,true);babelHelpers.classPrivateFieldLooseBase(this,Nl)[Nl](s);t()}),a)}))}finishSession(e,s=false){return new Promise(((t,a)=>{e.finish({deleteDocument:s}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Kl)[Kl](e);t(s)}),a)}))}askFinishSession(e){const s=P.Tag.render(Cl||(Cl=Dl`<input type="checkbox" class="ui-ctl-element">`));const t={message:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_FINISH_SESSION"),okCaption:P.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),buttons:F.MessageBoxButtons.OK_CANCEL,popupOptions:{zIndexOptions:{alwaysOnTop:true}}};if(e.isExperimentalMode()){t.title=P.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_FINISH_SESSION");t.message=P.Tag.render(Rl||(Rl=Dl`
				<label class="ui-ctl ui-ctl-checkbox">
					${0}
					<div class="ui-ctl-label-text">${0}</div>
				</label>
			`),s,P.Loc.getMessage("BIZPROC_JS_DEBUGGER_DELETE_SESSION_DOCUMENT"))}return new Promise(((a,i)=>{t.onOk=()=>Jl.Instance.finishSession(e,s==null?void 0:s.checked).then(a,i);t.onCancel=()=>{i({cancel:true});return true};F.MessageBox.show(t)}))}requireSetFilter(e,s=false){const t=babelHelpers.classPrivateFieldLooseBase(this,zl)[zl](e).pop();if(t!==babelHelpers.classPrivateFieldLooseBase(this,kl)[kl]||s){babelHelpers.classPrivateFieldLooseBase(this,Gl)[Gl](e)}}createAutomationDebugger(e={}){return new ll(e)}openDebuggerStartPage(e,s={}){const t=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.start/",{documentSigned:e,analyticsLabel:{automation_enter_debug:"Y",start_type:s.analyticsStartType||"default"}});const a={width:745,cacheable:false,allowChangeHistory:true,events:{}};return Jl.openSlider(t,a)}openSessionLog(e){const s=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.log/",{setTitle:"Y",sessionId:e});const t={width:720,cacheable:false,allowChangeHistory:true,events:{},newWindowLabel:true};return Jl.openSlider(s,t)}static openSlider(e,s){if(!P.Type.isPlainObject(s)){s={}}s={...{cacheable:false,allowChangeHistory:true,events:{}},...s};return new Promise(((t,a)=>{if(P.Type.isStringFilled(e)){if(BX.SidePanel.Instance.open(e,s)){return t()}return a()}return a()}))}}function Zl(e,s=false){let t=null;if(e.isAutomation()){t=this.createAutomationDebugger({session:e})}if(t){let e=t.session.isExperimentalMode()?"showExpanded":"showCollapsed";if(!babelHelpers.classPrivateFieldLooseBase(this,$l)[$l]()){e="showCollapsed"}t.getMainView()[s?e:"show"]();return t}return t}function Xl(e){const s=new wl({grid:P.Reflection.getClass("BX.CRM.Kanban.Grid")?BX.CRM.Kanban.Grid.getInstance():null,showFilterStep:!babelHelpers.classPrivateFieldLooseBase(this,$l)[$l](),showStageStep:!babelHelpers.classPrivateFieldLooseBase(this,Ul)[Ul]()&&e.session.isInterceptionMode(),reserveFilterIds:babelHelpers.classPrivateFieldLooseBase(this,zl)[zl](e.session)});s.subscribe("onFilterGuideStepShow",babelHelpers.classPrivateFieldLooseBase(this,Vl)[Vl].bind(this,true));s.subscribe("onStageGuideStepShow",babelHelpers.classPrivateFieldLooseBase(this,Wl)[Wl].bind(this,true));s.subscribe("onFilterGuideStepClose",(()=>{if(e.session&&e.session.isExperimentalMode()&&e.settings.get("popup-collapsed")===true){e.getMainView().showExpanded()}}));s.start()}function Yl(e){const s=babelHelpers.classPrivateFieldLooseBase(this,zl)[zl](e);babelHelpers.classPrivateFieldLooseBase(this,Ml)[Ml](s).forEach((({id:e,api:s})=>{s.setFilter({preset_id:"filter_robot_debugger"});babelHelpers.classPrivateFieldLooseBase(this,kl)[kl]=e}))}function ql(e){const s=babelHelpers.classPrivateFieldLooseBase(this,zl)[zl](e);babelHelpers.classPrivateFieldLooseBase(this,Ml)[Ml](s).forEach((({api:e})=>{e.setFilter({preset_id:"default_filter"});babelHelpers.classPrivateFieldLooseBase(this,kl)[kl]=null}))}function Ql(){return babelHelpers.classPrivateFieldLooseBase(this,Al)[Al].get("last-filter-id")}function er(e){return babelHelpers.classPrivateFieldLooseBase(this,Al)[Al].set("last-filter-id",e)}function sr(e){const s=[];e.forEach((e=>{var t;const a=(t=BX.Main.filterManager)==null?void 0:t.getById(e);if(a){s.push({id:e,api:a.getApi()})}}));return s}function tr(e){let s;if(e&&e.modeId===Ls.interception.id&&!e.isFixed()){s=e.initialCategoryId}else{var t;s=e==null?void 0:(t=e.activeDocument)==null?void 0:t.categoryId}const a="CRM_DEAL_LIST_V12";if(!s){return[a,`${a}_C_0`]}return[`${a}_C_${s}`]}function ar(){return babelHelpers.classPrivateFieldLooseBase(this,Al)[Al].get("filter-guide-shown")===true}function ir(){return babelHelpers.classPrivateFieldLooseBase(this,Al)[Al].get("stage-guide-shown")===true}function lr(e=true){babelHelpers.classPrivateFieldLooseBase(this,Al)[Al].set("filter-guide-shown",e)}function rr(e=true){babelHelpers.classPrivateFieldLooseBase(this,Al)[Al].set("stage-guide-shown",e)}const or={Manager:Jl,Session:Us,Mode:Ls};e.Debugger=or;e.Manager=Jl;e.Session=Us;e.Mode=Ls})(this.BX.Bizproc.Debugger=this.BX.Bizproc.Debugger||{},BX.Main,BX.UI,BX,BX.UI.EntitySelector,BX,BX.UI,BX,BX.Main,BX,BX.Bizproc,BX,BX.Bizproc.Automation,BX.Bizproc.Debugger,BX,BX.Bizproc.LocalSettings,BX.Event,BX,BX.UI.Tour,BX.UI.Dialogs);
//# sourceMappingURL=debugger.bundle.map.js