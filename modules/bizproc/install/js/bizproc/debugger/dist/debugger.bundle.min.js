this.BX=this.BX||{};(function(e,s,t,a,i,l,r,o,n,d,b,c,u,v,p,g,h){"use strict";class P{}P.Created=0;P.Running=1;P.Completed=2;P.Suspended=3;P.Terminated=4;class L{}L.Run=0;L.NextStep=1;L.Stop=2;L.Pause=3;L.Undefined=-1;class F{static isNumeric(e){if(p.Type.isNumber(e)){return true}if(!p.Type.isStringFilled(e)){return false}return Number(e).toString()===e.trim()}static isDate(e){if(p.Type.isDate(e)){return true}if(!F.isNumeric(e)){return false}return new Date(Number(e)).getTime()===Number(e)}static convertDateFromDB(e){if(!F.isNumeric(e)){return null}return new Date(e*1e3)}static toDate(e){if(Date.parse(e)){return new Date(e)}if(!F.isDate(e)){return null}if(p.Type.isDate(e)){return e}return F.convertDateFromDB(e)}static formatDate(e,s){if(!p.Type.isStringFilled(e)){e="j F Y H:i:s"}return n.DateTimeFormat.format(e,s)}static getOperatorsLabel(){return{"!empty":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_EMPTY"),empty:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_EMPTY"),"=":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_EQ"),"!=":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NE"),in:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_IN"),"!in":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_IN"),contain:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_CONTAIN"),"!contain":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_CONTAIN"),">":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_GT"),">=":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_GTE"),"<":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_LT"),"<=":p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_LTE")}}static getOperatorLabel(e){return F.getOperatorsLabel()[e]}static getJoinerLabel(e){const s={AND:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_AND"),OR:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_OR")};return s[e]}static getColorBrightness(e){if(e[0]==="#"){e=e.replace("#","")}const s=parseInt(e,16);const t=s>>16&255;const a=s>>8&255;const i=s&255;return.21*t+.72*a+.07*i}static getBgColorAdditionalClass(e){const s=F.getColorBrightness(e);if(s>224){return"--with-border --light-color"}if(s>145){return"--light-color"}return""}}let B=e=>e,f,m,H,_,y,O,T,w,I,E,S;var D=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var R=babelHelpers.classPrivateFieldLooseKey("popupInstance");var C=babelHelpers.classPrivateFieldLooseKey("loaded");var N=babelHelpers.classPrivateFieldLooseKey("node");var x=babelHelpers.classPrivateFieldLooseKey("triggerManager");var A=babelHelpers.classPrivateFieldLooseKey("template");var G=babelHelpers.classPrivateFieldLooseKey("tracker");var j=babelHelpers.classPrivateFieldLooseKey("tabs");var z=babelHelpers.classPrivateFieldLooseKey("expandedMinWidth");var k=babelHelpers.classPrivateFieldLooseKey("expandedMinHeight");var M=babelHelpers.classPrivateFieldLooseKey("collapsedMinWidth");var K=babelHelpers.classPrivateFieldLooseKey("collapsedMinHeight");var $=babelHelpers.classPrivateFieldLooseKey("changingViewTimeout");var U=babelHelpers.classPrivateFieldLooseKey("buttonPlay");var W=babelHelpers.classPrivateFieldLooseKey("getPopup");var J=babelHelpers.classPrivateFieldLooseKey("getPopupWidth");var Z=babelHelpers.classPrivateFieldLooseKey("getPopupHeight");var V=babelHelpers.classPrivateFieldLooseKey("getPopupTitleBar");var X=babelHelpers.classPrivateFieldLooseKey("handleCollapse");var q=babelHelpers.classPrivateFieldLooseKey("handleClose");var Y=babelHelpers.classPrivateFieldLooseKey("getNode");var Q=babelHelpers.classPrivateFieldLooseKey("renderExpandedMode");var ee=babelHelpers.classPrivateFieldLooseKey("renderCollapsedMode");var se=babelHelpers.classPrivateFieldLooseKey("getAddFieldNode");var te=babelHelpers.classPrivateFieldLooseKey("getFieldListNode");var ae=babelHelpers.classPrivateFieldLooseKey("handleChangeTab");var ie=babelHelpers.classPrivateFieldLooseKey("handleAddDocFieldMenu");var le=babelHelpers.classPrivateFieldLooseKey("handleAddField");var re=babelHelpers.classPrivateFieldLooseKey("handleRemoveField");var oe=babelHelpers.classPrivateFieldLooseKey("handleFieldListChange");var ne=babelHelpers.classPrivateFieldLooseKey("getFieldNode");var de=babelHelpers.classPrivateFieldLooseKey("createTriggersHeaderNode");var be=babelHelpers.classPrivateFieldLooseKey("createTriggersNode");var ce=babelHelpers.classPrivateFieldLooseKey("createTemplateNode");var ue=babelHelpers.classPrivateFieldLooseKey("updateTemplate");var ve=babelHelpers.classPrivateFieldLooseKey("createTemplateToolbar");var pe=babelHelpers.classPrivateFieldLooseKey("handleStartTemplate");var ge=babelHelpers.classPrivateFieldLooseKey("handleEmulateExternalEvent");var he=babelHelpers.classPrivateFieldLooseKey("updateTracker");var Pe=babelHelpers.classPrivateFieldLooseKey("createStageNode");var Le=babelHelpers.classPrivateFieldLooseKey("handleShowStages");var Fe=babelHelpers.classPrivateFieldLooseKey("handleChangeStatus");var Be=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusTitle");var fe=babelHelpers.classPrivateFieldLooseKey("getDocumentStatusColor");var me=babelHelpers.classPrivateFieldLooseKey("onDocumentStatusChanged");var He=babelHelpers.classPrivateFieldLooseKey("onWorkflowEventsChanged");var _e=babelHelpers.classPrivateFieldLooseKey("onWorkflowTrackAdded");var ye=babelHelpers.classPrivateFieldLooseKey("onDocumentValuesUpdated");var Oe=babelHelpers.classPrivateFieldLooseKey("onWorkflowStatusChange");var Te=babelHelpers.classPrivateFieldLooseKey("setDebuggerState");class we extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,Te,{value:bs});Object.defineProperty(this,Oe,{value:ds});Object.defineProperty(this,ye,{value:ns});Object.defineProperty(this,_e,{value:os});Object.defineProperty(this,He,{value:rs});Object.defineProperty(this,me,{value:ls});Object.defineProperty(this,fe,{value:is});Object.defineProperty(this,Be,{value:as});Object.defineProperty(this,Fe,{value:ts});Object.defineProperty(this,Le,{value:ss});Object.defineProperty(this,Pe,{value:es});Object.defineProperty(this,he,{value:Qe});Object.defineProperty(this,ge,{value:Ye});Object.defineProperty(this,pe,{value:qe});Object.defineProperty(this,ve,{value:Xe});Object.defineProperty(this,ue,{value:Ve});Object.defineProperty(this,ce,{value:Ze});Object.defineProperty(this,be,{value:Je});Object.defineProperty(this,de,{value:We});Object.defineProperty(this,ne,{value:Ue});Object.defineProperty(this,oe,{value:$e});Object.defineProperty(this,re,{value:Ke});Object.defineProperty(this,le,{value:Me});Object.defineProperty(this,ie,{value:ke});Object.defineProperty(this,ae,{value:ze});Object.defineProperty(this,te,{value:je});Object.defineProperty(this,se,{value:Ge});Object.defineProperty(this,ee,{value:Ae});Object.defineProperty(this,Q,{value:xe});Object.defineProperty(this,Y,{value:Ne});Object.defineProperty(this,q,{value:Ce});Object.defineProperty(this,X,{value:Re});Object.defineProperty(this,V,{value:De});Object.defineProperty(this,Z,{value:Se});Object.defineProperty(this,J,{value:Ee});Object.defineProperty(this,W,{value:Ie});Object.defineProperty(this,D,{writable:true,value:void 0});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,C,{writable:true,value:false});Object.defineProperty(this,N,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:void 0});Object.defineProperty(this,A,{writable:true,value:void 0});Object.defineProperty(this,G,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:["doc","log"]});Object.defineProperty(this,z,{writable:true,value:781});Object.defineProperty(this,k,{writable:true,value:612});Object.defineProperty(this,M,{writable:true,value:465});Object.defineProperty(this,K,{writable:true,value:187});Object.defineProperty(this,$,{writable:true,value:void 0});Object.defineProperty(this,U,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.AutomationMainView");babelHelpers.classPrivateFieldLooseBase(this,D)[D]=e;e.subscribe("onDocumentStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,me)[me].bind(this));e.subscribe("onWorkflowEventsChanged",babelHelpers.classPrivateFieldLooseBase(this,He)[He].bind(this));e.subscribe("onWorkflowTrackAdded",babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].bind(this));e.subscribe("onDocumentValuesUpdated",babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].bind(this));e.subscribe("onWorkflowStatusChanged",babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].bind(this))}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,D)[D]}show(){if(babelHelpers.classPrivateFieldLooseBase(this,C)[C]){babelHelpers.classPrivateFieldLooseBase(this,W)[W]().show();return}this.debugger.loadMainViewInfo().then((()=>{babelHelpers.classPrivateFieldLooseBase(this,C)[C]=true;babelHelpers.classPrivateFieldLooseBase(this,W)[W]().setContent(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]());babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](this.debugger.getState());babelHelpers.classPrivateFieldLooseBase(this,W)[W]().show()}))}showExpanded(){this.debugger.settings.set("popup-collapsed",false);this.show()}close(){babelHelpers.classPrivateFieldLooseBase(this,W)[W]().close()}destroy(){this.close()}}function Ie(){if(!babelHelpers.classPrivateFieldLooseBase(this,R)[R]){const e=this.debugger.settings.get("popup-collapsed");babelHelpers.classPrivateFieldLooseBase(this,R)[R]=new s.Popup({className:"bizproc-debugger-automation__main-popup bizproc-debugger-automation__scope "+(e?"--collapse":""),titleBar:babelHelpers.classPrivateFieldLooseBase(this,V)[V](),noAllPaddings:true,contentBackground:"white",draggable:true,zIndexOptions:{alwaysOnTop:e},width:babelHelpers.classPrivateFieldLooseBase(this,J)[J](e),height:babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](e),events:{onResizeStart:()=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinWidth(babelHelpers.classPrivateFieldLooseBase(this,z)[z]);babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinHeight(babelHelpers.classPrivateFieldLooseBase(this,k)[k])},onResizeEnd:()=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinWidth(null);babelHelpers.classPrivateFieldLooseBase(this,R)[R].setMinHeight(null);this.debugger.settings.set("popup-width",babelHelpers.classPrivateFieldLooseBase(this,R)[R].getWidth());this.debugger.settings.set("popup-height",babelHelpers.classPrivateFieldLooseBase(this,R)[R].getHeight())}}});babelHelpers.classPrivateFieldLooseBase(this,R)[R].setResizeMode(!e)}return babelHelpers.classPrivateFieldLooseBase(this,R)[R]}function Ee(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,M)[M]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,z)[z],this.debugger.settings.get("popup-width")||0)}function Se(e){if(e){return babelHelpers.classPrivateFieldLooseBase(this,K)[K]}return Math.max(babelHelpers.classPrivateFieldLooseBase(this,k)[k],this.debugger.settings.get("popup-height")||0)}function De(){return{content:p.Tag.render(f||(f=B`
				<div class="popup-window-titlebar-text bizproc-debugger-automation__titlebar">
					<div class="bizproc-debugger-automation__titlebar--move-icon"></div>
					${0}
					<div 
						class="bizproc-debugger-automation__titlebar--button-collapse" 
						onclick="${0}"
					></div>
					<span 
						class=" popup-window-close-icon 
								popup-window-titlebar-close-icon 
								bizproc-debugger-automation__titlebar--button-close"
						onclick="${0}"
					></span>
				</div>
			`),document.createTextNode(p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_POPUP_TITLE")),babelHelpers.classPrivateFieldLooseBase(this,X)[X].bind(this),babelHelpers.classPrivateFieldLooseBase(this,q)[q].bind(this))}}function Re(){const e=babelHelpers.classPrivateFieldLooseBase(this,W)[W]().getPopupContainer();const s=p.Dom.hasClass(e,"--collapse");this.debugger.settings.set("popup-collapsed",!s);babelHelpers.classPrivateFieldLooseBase(this,W)[W]().getZIndexComponent().setAlwaysOnTop(!s);babelHelpers.classPrivateFieldLooseBase(this,W)[W]().setResizeMode(s);p.Dom.toggleClass(e,"--collapse");clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,$)[$]);p.Dom.addClass(e,"--changing-view");babelHelpers.classPrivateFieldLooseBase(this,W)[W]().setWidth(babelHelpers.classPrivateFieldLooseBase(this,J)[J](!s));babelHelpers.classPrivateFieldLooseBase(this,W)[W]().setHeight(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](!s));babelHelpers.classPrivateFieldLooseBase(this,$)[$]=setTimeout((()=>p.Dom.removeClass(e,"--changing-view")),500)}function Ce(){u.MessageBox.show({message:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_FINISH_SESSION"),okCaption:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),onOk:()=>d.Manager.Instance.finishSession(this.debugger.session),buttons:u.MessageBoxButtons.OK_CANCEL})}function Ne(){if(!babelHelpers.classPrivateFieldLooseBase(this,N)[N]){babelHelpers.classPrivateFieldLooseBase(this,N)[N]=p.Tag.render(m||(m=B`
				<div class="bizproc-debugger-automation__content">
					<div class="bizproc-debugger-automation-content-collapsed">
						${0}
					</div>
					<div class="bizproc-debugger-automation__content-expanded">
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee](),babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]());v.HelpHint.bindAll(babelHelpers.classPrivateFieldLooseBase(this,N)[N])}return babelHelpers.classPrivateFieldLooseBase(this,N)[N]}function xe(){var e,s;const t=this.debugger.settings.getSet("watch-fields").size>0;const a=!this.debugger.isTemplateEmpty();const i=this.debugger.settings.get("tab")==="log"?"log":"doc";const l=i==="doc"?"--active":"";const r=i==="log"?"--active":"";return p.Tag.render(H||(H=B`
				<div class="bizproc-debugger-automation__main">
					<div class="bizproc-debugger-automation__main-robots">
						<div class="bizproc-debugger-automation__main-robots--head">
							${0}
						</div>
						<div data-role="automation-content" class="bizproc-debugger-automation__main-robots--main-content">
							${0}
							${0}
							<div class="bizproc-debugger-automation__head">
								<div class="bizproc-debugger-automation__main--title">
									<div class="bizproc-debugger-automation__main--name">${0} </div>
									<div class="ui-hint">
										<span class="ui-hint-icon" data-text="${0}"></span>
									</div>
								</div>
								<div data-role="no-template" class="bizproc-debugger-automation__main-hint ${0}">
									<div class="bizproc-debugger-automation__main-hint--title">
										${0}
									</div>
									<div class="bizproc-debugger-automation__main-hint--text">
										${0}
									</div>
									<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
								</div>
							</div>
<!--							<div class="bizproc-debugger-automation__dividing-line"></div>-->
							${0}
						</div>
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-fields">
						<div data-role="tabs-container" class="bizproc-debugger-automation__main-navigation --active-${0}">
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="doc" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							<div class="bizproc-debugger-automation__tab-block">
								<span class="bizproc-debugger-automation__tab ${0}" data-tab-item="log" onclick="${0}">
									${0}
								</span>
								<div class="ui-hint">
									<span class="ui-hint-icon" data-text="${0}"></span>
								</div>
							</div>
							
							<div data-tab-item="doc" class="bizproc-debugger-automation__tab-action ${0}">
								${0}
							</div>
							
							<div data-tab-item="log" class="bizproc-debugger-automation__tab-action ${0}">
								<div class="bizproc-debugger-automation__action-btn --icon-search" style="display: none"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-log" onclick="${0}"></div>
								<div class="bizproc-debugger-automation__action-btn --icon-note" style="display: none"></div>
							</div>
						</div>
						
						<div data-tab-item="doc" data-role="tab-content-doc" class="bizproc-debugger-tab__content ${0} ${0}">
							<div class="bizproc-debugger-tab__content--empty">
								${0}
							</div>
							<div class="bizproc-debugger-tab__content--not-empty">
								<div class="bizproc-debugger-tab__content-title">${0}</div>							
								${0}
							</div>
						</div>
						<div data-tab-item="log" class="bizproc-debugger-tab__content ${0} bizproc-debugger-automation-main-section-log">
							${0}
						</div>
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](),(e=babelHelpers.classPrivateFieldLooseBase(this,de)[de]())!=null?e:"",(s=babelHelpers.classPrivateFieldLooseBase(this,be)[be]())!=null?s:"",p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ROBOTS_TITLE"),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_ROBOT")),a?"":"--active",p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_TITLE")),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_ROBOTS_SUBTITLE")),this.debugger.getSettingsUrl(),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")),babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](),babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](),i,l,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].bind(this),p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_FIELD")),r,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].bind(this),p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_LOG_TITLE"),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_LOG")),l,babelHelpers.classPrivateFieldLooseBase(this,se)[se](),r,(()=>{d.Manager.Instance.openSessionLog(this.debugger.sessionId)}),l,t?"":"--empty",p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_FIELD_TITLE")),p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,te)[te](),r,this.debugger.getLogView().shouldScrollToBottom(true).shouldLoadPreviousLog(true).render())}function Ae(){return p.Tag.render(_||(_=B`
			<div class="bizproc-debugger-automation-menu__content-body">
				<div class="bizproc-debugger-automation-menu__content-body--logo"></div>
				<div class="bizproc-debugger-automation-menu__content-body--text">${0}</div>
			</div>
		`),p.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_SUBTITLE"))}function Ge(){return new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,noCaps:true,text:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_ADD_FIELD"),onclick:babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].bind(this)}).render()}function je(){const e=p.Tag.render(y||(y=B`<div class="ui-form" data-role="doc-field-list">
			</div>`));const s=this.debugger.settings.getSet("watch-fields");s.forEach((s=>{const t=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](s);if(t){p.Dom.append(t,e)}}));return e}function ze(e){const s=e.target.dataset.tabItem;const t=babelHelpers.classPrivateFieldLooseBase(this,j)[j].filter((e=>e!==s))[0];const a=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]();const i=a.querySelector('[data-role="tabs-container"]');a.querySelectorAll([`[data-tab-item="${s}"]`]).forEach((e=>p.Dom.addClass(e,"--active")));a.querySelectorAll([`[data-tab-item="${t}"]`]).forEach((e=>p.Dom.removeClass(e,"--active")));p.Dom.addClass(i,`--active-${s}`);p.Dom.removeClass(i,`--active-${t}`);this.debugger.settings.set("tab",s);this.emit("onChangeTab",{tab:s})}function ke(e,s){const t=this.debugger.getDocumentFields();const a=this.debugger.settings.getSet("watch-fields");const l=new i.EntitySelector.Dialog({targetNode:s.target,width:500,height:300,multiple:true,dropdownMode:true,enableSearch:true,cacheable:false,items:t.filter((e=>e.Watchable===true)).map((e=>({title:e.Name,id:e.Id,customData:{field:e},entityId:"bp",tabs:"recents",selected:a.has(e.Id)}))),showAvatars:false,events:{"Item:onSelect":e=>babelHelpers.classPrivateFieldLooseBase(this,le)[le](e.getData().item),"Item:onDeselect":e=>babelHelpers.classPrivateFieldLooseBase(this,re)[re](e.getData().item.getId())},compactView:true});l.show()}function Me(e){const s=this.debugger.settings.getSet("watch-fields");const t=e.getCustomData().get("field");if(s.has(t.Id)){return}const a=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](t);p.Dom.append(a,babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="doc-field-list"]'));s.add(t.Id);this.debugger.settings.set("watch-fields",s);babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](s)}function Ke(e){const s=this.debugger.settings.getSet("watch-fields");if(!s.has(e)){return}s.delete(e);this.debugger.settings.set("watch-fields",s);babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](s);p.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector(`[data-field-id="${e}"]`))}function $e(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="tab-content-doc"]');p.Dom[e.size>0?"removeClass":"addClass"](s,"--empty")}function Ue(e){if(p.Type.isString(e)){e=this.debugger.getDocumentField(e)}if(!e||!e.Id){return null}const s=this.debugger.getDocumentValue(e.Id)||"";return p.Tag.render(O||(O=B`
			<div class="ui-form-row" data-role="field-row" data-field-id="${0}">
				<div class="ui-form-label">
					<div class="ui-ctl-label-text">${0}</div>
				</div>
				<div class="ui-form-content">
					<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-ext-after-icon">
						<input type="text" readonly class="ui-ctl-element"
						 placeholder="${0}"
						 data-role="field-value-${0}"
						 value="${0}"
						 >
						 <a class="ui-ctl-after ui-ctl-icon-clear" onclick="${0}"></a>
					</div>
				</div>
			</div>
		`),p.Text.encode(e.Id),p.Text.encode(e.Name),p.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_EMPTY_VALUE"),p.Text.encode(e.Id),p.Text.encode(s),babelHelpers.classPrivateFieldLooseBase(this,re)[re].bind(this,e.Id))}function We(){const e=this.debugger.templateTriggers.length>0;const s=!this.debugger.isTemplateEmpty();if(!e&&s){return null}return p.Tag.render(T||(T=B`
			<div data-role="triggers-header" class="bizproc-debugger-automation__head">
				<div class="bizproc-debugger-automation__main--title">
					<div class="bizproc-debugger-automation__main--name">${0} </div>
					<div class="ui-hint">
						<span class="ui-hint-icon" data-text="${0}"></span>
					</div>
				</div>
				<div data-role="no-triggers" class="bizproc-debugger-automation__main-hint ${0}">
					<div class="bizproc-debugger-automation__main-hint--title">
						${0}
					</div>
					<div class="bizproc-debugger-automation__main-hint--text">
						${0}
					</div>
					<a href="${0}" class="bizproc-debugger-automation__link">${0}</a>
				</div>
			</div>
		`),p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_TRIGGERS_TITLE"),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_HELPTIP_TRIGGER")),e||s?"":"--active",p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_TITLE")),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_NO_TRIGGERS_SUBTITLE")),this.debugger.getSettingsUrl(),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS")))}function Je(){const e=this.debugger.getTemplate().DOCUMENT_STATUS;babelHelpers.classPrivateFieldLooseBase(this,G)[G]=new v.Tracker(v.getGlobalContext().document);const s={};s[e]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,G)[G].init(s);v.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,G)[G];const t=this.debugger.templateTriggers;if(t.length===0){return null}const a=p.Tag.render(w||(w=B`
			<div data-role="triggers" class="bizproc-debugger__template">
				<div class="bizproc-automation-status-list-item" data-type="column-trigger">
					<div data-role="trigger-list" class="bizproc-automation-trigger-list" data-status-id="${0}"></div>
				</div>
			</div>
		`),e);babelHelpers.classPrivateFieldLooseBase(this,x)[x]=new v.TriggerManager(a);babelHelpers.classPrivateFieldLooseBase(this,x)[x].init({TRIGGERS:t},v.ViewMode.view());return a}function Ze(){const e=this.debugger.getTemplate();babelHelpers.classPrivateFieldLooseBase(this,G)[G]=new v.Tracker(v.getGlobalContext().document);const s={};s[e.DOCUMENT_STATUS]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,G)[G].init(s);v.getGlobalContext().tracker=babelHelpers.classPrivateFieldLooseBase(this,G)[G];const t=p.Tag.render(I||(I=B`
			<div data-role="template" class="bizproc-debugger__template">
				<div data-role="automation-template" data-status-id="${0}">
					<div data-role="robot-list" class="bizproc-automation-robot-list"></div>
				</div>
			</div>
		`),e.DOCUMENT_STATUS);const a=new v.Template({constants:{},variables:{},templateContainerNode:t,delayMinLimitM:0});a.init(e,v.ViewMode.view().intoRaw());babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](a);return t}function Ve(e){if(!p.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,A)[A])){babelHelpers.classPrivateFieldLooseBase(this,A)[A].destroy()}babelHelpers.classPrivateFieldLooseBase(this,A)[A]=e;return babelHelpers.classPrivateFieldLooseBase(this,A)[A]}function Xe(){babelHelpers.classPrivateFieldLooseBase(this,U)[U]=new t.Button({size:t.ButtonSize.EXTRA_SMALL,color:t.ButtonColor.PRIMARY,round:true,icon:t.ButtonIcon.START,onclick:babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].bind(this)});const e=this.debugger.hasWorkflowEvents();return p.Tag.render(E||(E=B`
			<div class="bizproc-debugger-automation__toolbar">
			<div data-role="external-event-info" class="bizproc-debugger-automation__toolbar--info-waiting ${0}">
				<div>
					${0}
				</div>
				<a onclick="${0}" class="bizproc-debugger-automation__link">
					${0}
				</a>
			</div>
			<div class="bizproc-debugger-automation__toolbar--btn-block">
				${0}
				<div class="bizproc-debugger-automation__toolbar--btn-text">
					${0}
				</div>
			</div>
			</div>
		`),e?"--active":"",p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_SUBTITLE")),babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].bind(this),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_SKIP_WAITING_TITLE")),babelHelpers.classPrivateFieldLooseBase(this,U)[U].render(),p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START"))}function qe(e){e.setWaiting(true);this.debugger.startDebugTemplate().then((()=>{e.setWaiting(false);babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](this.debugger.getState())}))}function Ye(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="external-event-info"]');p.Dom.removeClass(s,"--active");this.debugger.emulateExternalEvent()}function Qe(e){if(babelHelpers.classPrivateFieldLooseBase(this,G)[G]){const e={};e[this.debugger.getDocumentStatus()]=this.debugger.track;babelHelpers.classPrivateFieldLooseBase(this,G)[G].reInit(e);babelHelpers.classPrivateFieldLooseBase(this,A)[A].reInit(null,v.ViewMode.view().intoRaw())}}function es(){const e=babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]();const s=p.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]());return p.Tag.render(S||(S=B`
			<div class="bizproc-debugger-automation__status ---robot-change ${0}" data-role="document-status" title="${0}">
				<div class="bizproc-debugger-automation__status--title" data-role="document-status-title">
					${0}
				</div>
				<div class="bizproc-debugger-automation__status--bg" data-role="document-status-bg" style="background-color: ${0}; border-color: ${0};">
					<span class="bizproc-debugger-automation__status--bg-arrow"></span>
				</div>
			</div>
		`),F.getBgColorAdditionalClass(e),s,s,e,e)}function ss(e){e.preventDefault();const t=this.debugger.getStatusList();const a=new s.Menu({bindElement:e.target,items:t.map((e=>({text:e.NAME,statusId:e["STATUS_ID"],onclick:babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe].bind(this)})))});a.show()}function ts(e,s){s.getMenuWindow().destroy();this.debugger.setDocumentStatus(s.statusId)}function as(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.NAME||t.TITLE:"?"}function is(){const e=this.debugger.getDocumentStatus();const s=this.debugger.getStatusList();const t=s.find((s=>s["STATUS_ID"]===e));return t?t.COLOR:"#9DCF00"}function ls(){if(!babelHelpers.classPrivateFieldLooseBase(this,W)[W]().isShown()){return}const e=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="document-status-title"]');const s=babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]();e.textContent=s;e.parentNode.setAttribute("title",s);const t=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="document-status-bg"]');const a=babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]();p.Dom.style(t,{backgroundColor:a,borderColor:a});const i=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="document-status"]');p.Dom.removeClass(i,["--with-border","--light-color"]);p.Dom.addClass(i,F.getBgColorAdditionalClass(a));p.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="triggers-header"]'));p.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="triggers"]'));const l=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="automation-content"]');p.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,be)[be](),l);const r=babelHelpers.classPrivateFieldLooseBase(this,de)[de]();if(r){v.HelpHint.bindAll(r);p.Dom.prepend(r,l)}const o=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]();p.Dom.replace(babelHelpers.classPrivateFieldLooseBase(this,N)[N].querySelector('[data-role="template"]'),o);const n=this.debugger.templateTriggers.length>0;const d=!this.debugger.isTemplateEmpty();p.Dom[n||d?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,N)[N].querySelector('[data-role="no-triggers"]'),"--active");p.Dom[d?"removeClass":"addClass"](babelHelpers.classPrivateFieldLooseBase(this,N)[N].querySelector('[data-role="no-template"]'),"--active")}function rs(e){if(!babelHelpers.classPrivateFieldLooseBase(this,U)[U]){return}const s=e.getData().events;const t=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]().querySelector('[data-role="external-event-info"]');p.Dom[s.length?"addClass":"removeClass"](t,"--active")}function os(e){babelHelpers.classPrivateFieldLooseBase(this,he)[he](this.debugger.track)}function ns(e){if(!babelHelpers.classPrivateFieldLooseBase(this,W)[W]().isShown()){return}const s=e.getData().values;const t=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]();Object.keys(s).forEach((e=>{const a=t.querySelector(`[data-role="field-value-${e}"]`);if(a){a.value=s[e]||""}}))}function ds(e){const s=e.getData().status;const t=e.getData().workflowId;if([P.Completed,P.Terminated].includes(s)){this.debugger.track.forEach((e=>{if(e["WORKFLOW_ID"]===t){e["WORKFLOW_STATUS"]=P.Completed}}));babelHelpers.classPrivateFieldLooseBase(this,he)[he](this.debugger.track)}}function bs(e){if(!babelHelpers.classPrivateFieldLooseBase(this,U)[U]){return}switch(e){case L.Run:babelHelpers.classPrivateFieldLooseBase(this,U)[U].setIcon(t.ButtonIcon.PAUSE);babelHelpers.classPrivateFieldLooseBase(this,U)[U].getContainer().nextElementSibling.textContent=p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_PAUSE");break;default:babelHelpers.classPrivateFieldLooseBase(this,U)[U].setIcon(t.ButtonIcon.START);babelHelpers.classPrivateFieldLooseBase(this,U)[U].getContainer().nextElementSibling.textContent=p.Loc.getMessage("BIZPROC_DEBUGGER_AUTOMATION_ACTION_START")}}class cs{static isMode(e){return[0,1].includes(e)}static getMode(e){if(e===0){return cs.experimental}else if(e===1){return cs.interception}return null}static getAllModes(){return{0:cs.experimental,1:cs.interception}}}cs.experimental={id:0};cs.interception={id:1};var us=babelHelpers.classPrivateFieldLooseKey("id");var vs=babelHelpers.classPrivateFieldLooseKey("sessionId");var ps=babelHelpers.classPrivateFieldLooseKey("documentId");var gs=babelHelpers.classPrivateFieldLooseKey("dateExpire");var hs=babelHelpers.classPrivateFieldLooseKey("documentSigned");class Ps{constructor(e){Object.defineProperty(this,us,{writable:true,value:void 0});Object.defineProperty(this,vs,{writable:true,value:void 0});Object.defineProperty(this,ps,{writable:true,value:void 0});Object.defineProperty(this,gs,{writable:true,value:void 0});Object.defineProperty(this,hs,{writable:true,value:""});babelHelpers.classPrivateFieldLooseBase(this,us)[us]=parseInt(e.Id)>=0?parseInt(e.Id):0;babelHelpers.classPrivateFieldLooseBase(this,vs)[vs]=p.Type.isStringFilled(e.SessionId)?e.SessionId:"";babelHelpers.classPrivateFieldLooseBase(this,ps)[ps]=p.Type.isStringFilled(e.DocumentId)?e.DocumentId:"";babelHelpers.classPrivateFieldLooseBase(this,gs)[gs]=F.toDate(e.DateExpire);if(e.DocumentSigned){this.documentSigned=e.DocumentSigned}}get documentId(){return babelHelpers.classPrivateFieldLooseBase(this,ps)[ps]}get documentSigned(){return babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]}set documentSigned(e){babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]=p.Type.isStringFilled(e)?e:""}}var Ls=babelHelpers.classPrivateFieldLooseKey("id");var Fs=babelHelpers.classPrivateFieldLooseKey("mode");var Bs=babelHelpers.classPrivateFieldLooseKey("startedBy");var fs=babelHelpers.classPrivateFieldLooseKey("active");var ms=babelHelpers.classPrivateFieldLooseKey("fixed");var Hs=babelHelpers.classPrivateFieldLooseKey("documents");var _s=babelHelpers.classPrivateFieldLooseKey("shortDescription");var ys=babelHelpers.classPrivateFieldLooseKey("documentSigned");var Os=babelHelpers.classPrivateFieldLooseKey("finished");var Ts=babelHelpers.classPrivateFieldLooseKey("pullFinishHandler");var ws=babelHelpers.classPrivateFieldLooseKey("setMode");var Is=babelHelpers.classPrivateFieldLooseKey("setDocuments");var Es=babelHelpers.classPrivateFieldLooseKey("handleExternalFinished");var Ss=babelHelpers.classPrivateFieldLooseKey("handleFinish");class Ds extends h.EventEmitter{constructor(e){super();Object.defineProperty(this,Ss,{value:xs});Object.defineProperty(this,Es,{value:Ns});Object.defineProperty(this,Is,{value:Cs});Object.defineProperty(this,ws,{value:Rs});Object.defineProperty(this,Ls,{writable:true,value:""});Object.defineProperty(this,Fs,{writable:true,value:{}});Object.defineProperty(this,Bs,{writable:true,value:0});Object.defineProperty(this,fs,{writable:true,value:void 0});Object.defineProperty(this,ms,{writable:true,value:void 0});Object.defineProperty(this,Hs,{writable:true,value:[]});Object.defineProperty(this,_s,{writable:true,value:""});Object.defineProperty(this,ys,{writable:true,value:""});Object.defineProperty(this,Os,{writable:true,value:false});Object.defineProperty(this,Ts,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.Session");e=p.Type.isPlainObject(e)?e:{};babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]=e.Id;babelHelpers.classPrivateFieldLooseBase(this,ws)[ws](e.Mode);babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]=parseInt(e.StartedBy)>=0?parseInt(e.StartedBy):0;babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]=String(e.ShortDescription);babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]=Boolean(e.Active);babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]=Boolean(e.Fixed);babelHelpers.classPrivateFieldLooseBase(this,Is)[Is](e.Documents);if(this.isActive()){babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]=babelHelpers.classPrivateFieldLooseBase(this,Es)[Es].bind(this);d.Manager.Instance.pullHandler.subscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts])}}set documentSigned(e){if(this.isFixed()){this.activeDocument.documentSigned=e}babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]=e}get documentSigned(){if(this.activeDocument){const e=this.activeDocument.documentSigned;if(p.Type.isStringFilled(e)){return e}}return babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]}get id(){return babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]}get startedBy(){return babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]}get activeDocument(){if(babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs].length===1){return babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs][0]}return null}get modeId(){return babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs].id}get shortDescription(){return babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]}isActive(){return babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]}isFixed(){return babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]}isSessionStartedByUser(e){return this.startedBy===e}isAutomation(){return true}static start(e,s){return new Promise(((t,a)=>{p.ajax.runAction("bizproc.debugger.startSession",{data:{documentSigned:e,mode:s}}).then((e=>{const s=new Ds(e.data.session);s.documentSigned=e.data.documentSigned;t(s)}),a)}))}finish(){return p.ajax.runAction("bizproc.debugger.finishDebugSession",{data:{sessionId:this.id}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]();return e}))}}function Rs(e){e=F.isNumeric(e)?Number(e):null;if(cs.isMode(e)){babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs]=cs.getMode(e)}}function Cs(e){if(p.Type.isArrayFilled(e)){e.forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs].push(new Ps(e))}))}return this}function Ns(e){const s=e.getData().sessionId;if(s===this.id){babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]()}}function xs(){if(!babelHelpers.classPrivateFieldLooseBase(this,Os)[Os]){babelHelpers.classPrivateFieldLooseBase(this,Os)[Os]=true;this.emit("onFinished");this.unsubscribeAll();if(babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]){d.Manager.Instance.pullHandler.unsubscribe("sessionFinish",babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]);babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]=null}}}class As{}As.Unknown=0;As.ExecuteActivity=1;As.CloseActivity=2;As.CancelActivity=3;As.FaultActivity=4;As.Custom=5;As.Report=6;As.AttachedEntity=7;As.Trigger=8;As.Error=9;As.Debug=10;As.DebugAutomation=11;As.DebugDesigner=12;As.DebugLink=13;let Gs=e=>e,js,zs,ks,Ms,Ks,$s,Us,Ws,Js,Zs,Vs,Xs,qs,Ys,Qs,et,st;var tt=babelHelpers.classPrivateFieldLooseKey("robot");var at=babelHelpers.classPrivateFieldLooseKey("view");var it=babelHelpers.classPrivateFieldLooseKey("currentNode");var lt=babelHelpers.classPrivateFieldLooseKey("currentIndex");var rt=babelHelpers.classPrivateFieldLooseKey("isAfterPreviousRendered");var ot=babelHelpers.classPrivateFieldLooseKey("isPauseRendered");var nt=babelHelpers.classPrivateFieldLooseKey("isActivityBodyRendered");var dt=babelHelpers.classPrivateFieldLooseKey("prevRobotTitle");var bt=babelHelpers.classPrivateFieldLooseKey("getCurrentRobotNode");var ct=babelHelpers.classPrivateFieldLooseKey("renderRobotTitle");var ut=babelHelpers.classPrivateFieldLooseKey("renderAfterPrevious");var vt=babelHelpers.classPrivateFieldLooseKey("renderPause");var pt=babelHelpers.classPrivateFieldLooseKey("renderDelayInterval");var gt=babelHelpers.classPrivateFieldLooseKey("renderCondition");var ht=babelHelpers.classPrivateFieldLooseKey("renderConditions");var Pt=babelHelpers.classPrivateFieldLooseKey("renderActivity");var Lt=babelHelpers.classPrivateFieldLooseKey("renderActivityFinish");var Ft=babelHelpers.classPrivateFieldLooseKey("renderNote");var Bt=babelHelpers.classPrivateFieldLooseKey("renderDebugNote");var ft=babelHelpers.classPrivateFieldLooseKey("renderDebugLink");class mt{constructor(e,s){Object.defineProperty(this,ft,{value:Ct});Object.defineProperty(this,Bt,{value:Rt});Object.defineProperty(this,Ft,{value:Dt});Object.defineProperty(this,Lt,{value:St});Object.defineProperty(this,Pt,{value:Et});Object.defineProperty(this,ht,{value:It});Object.defineProperty(this,gt,{value:wt});Object.defineProperty(this,pt,{value:Tt});Object.defineProperty(this,vt,{value:Ot});Object.defineProperty(this,ut,{value:yt});Object.defineProperty(this,ct,{value:_t});Object.defineProperty(this,bt,{value:Ht});Object.defineProperty(this,tt,{writable:true,value:void 0});Object.defineProperty(this,at,{writable:true,value:void 0});Object.defineProperty(this,it,{writable:true,value:null});Object.defineProperty(this,lt,{writable:true,value:null});Object.defineProperty(this,rt,{writable:true,value:false});Object.defineProperty(this,ot,{writable:true,value:false});Object.defineProperty(this,nt,{writable:true,value:false});Object.defineProperty(this,dt,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,at)[at]=e;babelHelpers.classPrivateFieldLooseBase(this,tt)[tt]=s}get name(){return babelHelpers.classPrivateFieldLooseBase(this,tt)[tt].name}get title(){return babelHelpers.classPrivateFieldLooseBase(this,tt)[tt].title}get delayName(){return babelHelpers.classPrivateFieldLooseBase(this,tt)[tt].delayName}get conditionNames(){return babelHelpers.classPrivateFieldLooseBase(this,tt)[tt].conditionNames}getActivitiesName(){let e=[];if(this.name){e.push(this.name)}if(this.delayName){e.push(this.delayName)}e=e.concat(this.conditionNames);return e}set previousRobotTitle(e){babelHelpers.classPrivateFieldLooseBase(this,dt)[dt]=e}renderTrack(e){const s=[As.ExecuteActivity,As.AttachedEntity];if(s.includes(e.type)){return}if(e.name===this.delayName){return babelHelpers.classPrivateFieldLooseBase(this,vt)[vt](e)}if(this.conditionNames.includes(e.name)){if(babelHelpers.classPrivateFieldLooseBase(this,ot)[ot]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,pt)[pt](new v.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,ot)[ot]=true}return babelHelpers.classPrivateFieldLooseBase(this,gt)[gt](e)}if(e.name===this.name){if(babelHelpers.classPrivateFieldLooseBase(this,ot)[ot]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,pt)[pt](new v.DelayInterval),s);babelHelpers.classPrivateFieldLooseBase(this,ot)[ot]=true}return babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt](e)}}}function Ht(e){if(babelHelpers.classPrivateFieldLooseBase(this,at)[at].index!==babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]){const s=p.Tag.render(js||(js=Gs`
				<div class="bizproc-debugger-automation__log-section">
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,ct)[ct](e.datetime));if(p.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,dt)[dt])&&babelHelpers.classPrivateFieldLooseBase(this,rt)[rt]===false){p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,ut)[ut](),s)}p.Dom.append(s,babelHelpers.classPrivateFieldLooseBase(this,at)[at].logNode);babelHelpers.classPrivateFieldLooseBase(this,it)[it]=s}return babelHelpers.classPrivateFieldLooseBase(this,it)[it]}function _t(e){const s=p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TITLE",{"#TITLE#":this.title});const t=p.Tag.render(zs||(zs=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),Ea.renderTime(e),p.Text.encode(s));babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]=babelHelpers.classPrivateFieldLooseBase(this,at)[at].index;return t}function yt(){babelHelpers.classPrivateFieldLooseBase(this,rt)[rt]=true;const e=p.Tag.render(ks||(ks=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --blue">
							"${0}"
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_AFTER_PREVIOUS"),p.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,dt)[dt]));babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]=babelHelpers.classPrivateFieldLooseBase(this,at)[at].index;return e}function Ot(e){babelHelpers.classPrivateFieldLooseBase(this,ot)[ot]=true;const s=[As.CloseActivity];if(s.includes(e.type)){return}if(e.type===As.DebugAutomation){const s=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);const t=JSON.parse(e.note);return p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,pt)[pt](t),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);return p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e),t)}function Tt(e={}){var s;const t=new v.DelayInterval(e);let a=(s=e.fieldName)!=null?s:(new v.DelayIntervalSelector).getBasisField(t.basis,true).Name;a=a+" ["+e.fieldValue+"]";const i=t.format(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_AT_ONCE"),[{SystemExpression:t.basis,Name:a}]);const l=p.Tag.render(Ms||(Ms=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info">
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text">
							${0}
						</span>
						<span>:</span>
					</div>
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="bizproc-debugger-automation__log-color-box --dark-blue">
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_RUN"),p.Text.encode(i));babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]=babelHelpers.classPrivateFieldLooseBase(this,at)[at].index;return l}function wt(e){const s=[As.CloseActivity];if(s.includes(e.type)){return}if(e.type===As.DebugAutomation){const s=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);return p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,ht)[ht](e),s)}const t=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);return p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e),t)}function It(e){const s=JSON.parse(e.note);const t=p.Tag.render(Ks||(Ks=Gs`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),s.result==="Y"?p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"):p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION_FALSE"));Object.keys(s).forEach((e=>{if(e==="result"){return}let a="";if(s.result===s[e]["result"]){a=s.result==="Y"?"bizproc-debugger-automation__log-color-box --green":"bizproc-debugger-automation__log-color-box --orange"}const i=s[e]["condition"];const l=i["field"];const r=s[e]["fieldValue"]?String(s[e]["fieldValue"]):"";const o=F.getOperatorLabel(i["operator"]);const n=i["value"];const d=F.getJoinerLabel(s[e]["joiner"]);p.Dom.append(p.Tag.render($s||($s=Gs`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0} 
							${0} 
							${0}
						</span>
					</div>
				`),a,e==="0"?"":p.Text.encode(d)+" ",p.Text.encode(l)+" ","["+p.Text.encode(r)+"] ",p.Text.encode(o)+" ",p.Text.encode(n)),t)}));const a=p.Tag.render(Us||(Us=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]=babelHelpers.classPrivateFieldLooseBase(this,at)[at].index;return a}function Et(e){if(e.type===As.CloseActivity){if(babelHelpers.classPrivateFieldLooseBase(this,nt)[nt]===false){const s=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);return p.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt](),s)}return}babelHelpers.classPrivateFieldLooseBase(this,nt)[nt]=true;const s=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt](e);const t=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e);p.Dom.append(t,s);babelHelpers.classPrivateFieldLooseBase(this,at)[at].collapseInfoResults(t)}function St(){return p.Tag.render(Ws||(Ws=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation-log-section-robot-activity">
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_FINISH_WITHOUT_SETTINGS"))}function Dt(e){if([As.DebugAutomation,As.Debug].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt](e)}if([As.DebugLink].includes(e.type)){return babelHelpers.classPrivateFieldLooseBase(this,ft)[ft](e)}const s=[As.CancelActivity,As.FaultActivity,As.Error].includes(e.type)?"bizproc-debugger-automation__log-color-box --red":"";const t=p.Tag.render(Js||(Js=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				<div class="bizproc-debugger-automation__log-info--value --first">
					<span class="${0}">
						${0}
					</span>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),s,p.Text.encode(e.note).replace(/([^>])\n/g,"$1<br>"));babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]=babelHelpers.classPrivateFieldLooseBase(this,at)[at].index;return t}function Rt(e){const s=JSON.parse(e.note);const t=p.Tag.render(Zs||(Zs=Gs`<div class="bizproc-debugger-automation__log-info"></div>`));if(s["propertyName"]){p.Dom.append(p.Tag.render(Vs||(Vs=Gs`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),p.Text.encode(s["propertyName"]),p.Text.encode(s["propertyName"])),t)}p.Dom.append(p.Tag.render(Xs||(Xs=Gs`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<div>
							${0}
						</div>
					</div>
					<div data-role="more-info-result" style="display:none;">
						<span class="bizproc-debugger-automation__log-info--more">
							${0}
						</span>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",s["propertyValue"]?p.Text.encode(s["propertyValue"]).replace(/([^>])\n/g,"$1<br>"):"",p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_MORE_INFORMATION"))),t);const a=p.Tag.render(qs||(qs=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]=babelHelpers.classPrivateFieldLooseBase(this,at)[at].index;return a}function Ct(e){const s=JSON.parse(e.note);const t=p.Tag.render(Ys||(Ys=Gs`<div class="bizproc-debugger-automation__log-info"></div>`));const a=s["propertyLinkName"]||s["propertyValue"];const i=s["propertyValue"];if(s["propertyName"]){p.Dom.append(p.Tag.render(Qs||(Qs=Gs`
					<div class="bizproc-debugger-automation__log-info--name">
						<span class="bizproc-debugger-automation__log-info--name-text" title="${0}">
							${0}
						</span>
						<span>:</span>
					</div>
				`),p.Text.encode(s["propertyName"]),p.Text.encode(s["propertyName"])),t)}p.Dom.append(p.Tag.render(et||(et=Gs`
				<div class="bizproc-debugger-automation__log-info--value ${0}">
					<div class="bizproc-debugger-automation__log--variable-height" data-role="info-result">
						<a href="${0}" target="_blank">
							${0}
						</a>
					</div>
				</div>
			`),s["propertyName"]?"":"--first",p.Text.encode(i),a),t);const l=p.Tag.render(st||(st=Gs`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at].renderIndex(),t);babelHelpers.classPrivateFieldLooseBase(this,lt)[lt]=babelHelpers.classPrivateFieldLooseBase(this,at)[at].index;return l}let Nt=e=>e,xt,At,Gt,jt,zt;var kt=babelHelpers.classPrivateFieldLooseKey("view");var Mt=babelHelpers.classPrivateFieldLooseKey("condition");var Kt=babelHelpers.classPrivateFieldLooseKey("title");var $t=babelHelpers.classPrivateFieldLooseKey("track");var Ut=babelHelpers.classPrivateFieldLooseKey("renderTitle");var Wt=babelHelpers.classPrivateFieldLooseKey("renderCondition");class Jt{constructor(e){Object.defineProperty(this,Wt,{value:Vt});Object.defineProperty(this,Ut,{value:Zt});Object.defineProperty(this,kt,{writable:true,value:void 0});Object.defineProperty(this,Mt,{writable:true,value:{}});Object.defineProperty(this,Kt,{writable:true,value:""});Object.defineProperty(this,$t,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]=e}addTrack(e){if(e.type===As.DebugAutomation&&e.name==="TRIGGER_LOG"){babelHelpers.classPrivateFieldLooseBase(this,Mt)[Mt]=JSON.parse(e.note);babelHelpers.classPrivateFieldLooseBase(this,Kt)[Kt]=e.title;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t]=e}return this}render(){const e=p.Tag.render(xt||(xt=Nt`
			<div class="bizproc-debugger-automation__log-section">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					<div class="bizproc-debugger-automation__log-info--value --first">
						<span>
							${0}
						</span>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Ut)[Ut](),babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt](),babelHelpers.classPrivateFieldLooseBase(this,kt)[kt].renderIndex(),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_FINISH")));p.Dom.append(e,babelHelpers.classPrivateFieldLooseBase(this,kt)[kt].logNode)}}function Zt(){const e=p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_TRIGGER_TITLE",{"#TITLE#":babelHelpers.classPrivateFieldLooseBase(this,Kt)[Kt]});return p.Tag.render(At||(At=Nt`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
				<div class="bizproc-debugger-automation__log-section--title">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,kt)[kt].renderIndex(),Ea.renderTime(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].datetime),p.Text.encode(e))}function Vt(){if(!babelHelpers.classPrivateFieldLooseBase(this,Mt)[Mt]||Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Mt)[Mt]).length<=0){return""}const e=babelHelpers.classPrivateFieldLooseBase(this,Mt)[Mt];const s=p.Tag.render(Gt||(Gt=Nt`
			<div class="bizproc-debugger-automation__log-info">
				<div class="bizproc-debugger-automation__log-info--name">
					<span class="bizproc-debugger-automation__log-info--name-text">
						${0}
					</span>
					<span>:</span> 
				</div> 
			</div>
		`),p.Loc.getMessage("BIZPROC_JS_DEBUGGER_LOG_CONDITION"));Object.keys(e).forEach((t=>{const a=e[t]["result"]==="Y"?"bizproc-debugger-automation__log-color-box --green":"";const i=e[t]["condition"];const l=i["field"];const r=e[t]["fieldValue"]?String(e[t]["fieldValue"]):"";const o=F.getOperatorLabel(i["operator"]);const n=i["value"];const d=F.getJoinerLabel(e[t]["joiner"]);p.Dom.append(p.Tag.render(jt||(jt=Nt`
					<div class="bizproc-debugger-automation__log-info--value">
						<span class="${0}" >
							${0}
							${0}
							${0}
							${0}
							${0}
						</span>
					</div>
				`),a,t==="0"?"":p.Text.encode(d)+" ",p.Text.encode(l)+" ","["+p.Text.encode(r)+"] ",p.Text.encode(o)+" ",p.Text.encode(n)),s)}));return p.Tag.render(zt||(zt=Nt`
			<div class="bizproc-debugger-automation__log-section--row">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,kt)[kt].renderIndex(),s)}let Xt=e=>e,qt,Yt,Qt,ea,sa,ta,aa;var ia=babelHelpers.classPrivateFieldLooseKey("debuggerInstance");var la=babelHelpers.classPrivateFieldLooseKey("workflowId");var ra=babelHelpers.classPrivateFieldLooseKey("activityRenderer");var oa=babelHelpers.classPrivateFieldLooseKey("documentStatus");var na=babelHelpers.classPrivateFieldLooseKey("categoryName");var da=babelHelpers.classPrivateFieldLooseKey("statusSettings");var ba=babelHelpers.classPrivateFieldLooseKey("node");var ca=babelHelpers.classPrivateFieldLooseKey("index");var ua=babelHelpers.classPrivateFieldLooseKey("trackId");var va=babelHelpers.classPrivateFieldLooseKey("poolTrack");var pa=babelHelpers.classPrivateFieldLooseKey("poolWorkflowRobots");var ga=babelHelpers.classPrivateFieldLooseKey("isRendering");var ha=babelHelpers.classPrivateFieldLooseKey("NUMBER_OF_LINES_TO_SHOW_IN_PIXELS");var Pa=babelHelpers.classPrivateFieldLooseKey("shouldScrollToBottom");var La=babelHelpers.classPrivateFieldLooseKey("shouldLoadPreviousLog");var Fa=babelHelpers.classPrivateFieldLooseKey("loadPreviousLog");var Ba=babelHelpers.classPrivateFieldLooseKey("loadWorkflowRobotsByWorkflowId");var fa=babelHelpers.classPrivateFieldLooseKey("onAfterGetLog");var ma=babelHelpers.classPrivateFieldLooseKey("renderStartDebugLog");var Ha=babelHelpers.classPrivateFieldLooseKey("renderStartedDate");var _a=babelHelpers.classPrivateFieldLooseKey("renderLegend");var ya=babelHelpers.classPrivateFieldLooseKey("renderCategoryChange");var Oa=babelHelpers.classPrivateFieldLooseKey("onChangeTab");var Ta=babelHelpers.classPrivateFieldLooseKey("scrollToBottom");var wa=babelHelpers.classPrivateFieldLooseKey("clearWorkflowRobots");var Ia=babelHelpers.classPrivateFieldLooseKey("onSessionFinished");class Ea{constructor(e){Object.defineProperty(this,Ia,{value:ka});Object.defineProperty(this,wa,{value:za});Object.defineProperty(this,Ta,{value:ja});Object.defineProperty(this,Oa,{value:Ga});Object.defineProperty(this,ya,{value:Aa});Object.defineProperty(this,_a,{value:xa});Object.defineProperty(this,Ha,{value:Na});Object.defineProperty(this,ma,{value:Ca});Object.defineProperty(this,fa,{value:Ra});Object.defineProperty(this,Ba,{value:Da});Object.defineProperty(this,Fa,{value:Sa});Object.defineProperty(this,ia,{writable:true,value:null});Object.defineProperty(this,la,{writable:true,value:void 0});Object.defineProperty(this,ra,{writable:true,value:{}});Object.defineProperty(this,oa,{writable:true,value:""});Object.defineProperty(this,na,{writable:true,value:""});Object.defineProperty(this,da,{writable:true,value:void 0});Object.defineProperty(this,ba,{writable:true,value:null});Object.defineProperty(this,ca,{writable:true,value:0});Object.defineProperty(this,ua,{writable:true,value:0});Object.defineProperty(this,va,{writable:true,value:[]});Object.defineProperty(this,pa,{writable:true,value:{}});Object.defineProperty(this,ga,{writable:true,value:true});Object.defineProperty(this,Pa,{writable:true,value:false});Object.defineProperty(this,La,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,ia)[ia]=e;babelHelpers.classPrivateFieldLooseBase(this,la)[la]=this.debugger.workflowId;const s=this.debugger.getTemplate();this.initializeWorkflowRobotsRenderer(s?s["ROBOTS"]:[]);if(this.debugger.session.isActive()){this.debugger.subscribe("onWorkflowTrackAdded",this.onTrackAdded.bind(this));this.debugger.getMainView().subscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa].bind(this));this.debugger.session.subscribe("onFinished",babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia].bind(this))}}get debugger(){return babelHelpers.classPrivateFieldLooseBase(this,ia)[ia]}get index(){return babelHelpers.classPrivateFieldLooseBase(this,ca)[ca]}get logNode(){if(!babelHelpers.classPrivateFieldLooseBase(this,ba)[ba]){babelHelpers.classPrivateFieldLooseBase(this,ba)[ba]=p.Tag.render(qt||(qt=Xt`<div data-role="log" class="bizproc-debugger-tab__log"></div>`))}return babelHelpers.classPrivateFieldLooseBase(this,ba)[ba]}initializeWorkflowRobotsRenderer(e=[],s=null){if(!s&&!babelHelpers.classPrivateFieldLooseBase(this,la)[la]){return}if(p.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,ra)[ra][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,la)[la]])){babelHelpers.classPrivateFieldLooseBase(this,ra)[ra][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,la)[la]]={}}if(p.Type.isArrayFilled(e)){let a=null;for(let i=0;i<e.length;++i){var t;const l=new v.Robot({});l.init(e[i],v.ViewMode.none());const r=[];if(p.Type.isPlainObject(l.data.Condition)){r.push(l.data.Condition["activityNames"]["Activity"]);r.push(l.data.Condition["activityNames"]["Branch1"]);r.push(l.data.Condition["activityNames"]["Branch2"])}const o=new mt(this,{name:l.getId(),title:l.getTitle(),delayName:(t=l.data.DelayName)!=null?t:null,conditionNames:r});if(l.isExecuteAfterPrevious()&&a){o.previousRobotTitle=a}a=l.getTitle();o.getActivitiesName().forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,ra)[ra][s!=null?s:babelHelpers.classPrivateFieldLooseBase(this,la)[la]][e]=o}))}}}shouldLoadPreviousLog(e){babelHelpers.classPrivateFieldLooseBase(this,La)[La]=e;return this}setPreviousLog(e={logs:[],workflowRobots:{}}){babelHelpers.classPrivateFieldLooseBase(this,fa)[fa](e);return this}render(){if(this.logNode.children.length<=0){babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]=true;if(babelHelpers.classPrivateFieldLooseBase(this,La)[La]){babelHelpers.classPrivateFieldLooseBase(this,Fa)[Fa]().then((()=>{this.startRendering()}))}else{this.startRendering()}}return this.logNode}renderTo(e){p.Dom.append(this.logNode,e);babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]=true;this.startRendering();return this}startRendering(){const e=babelHelpers.classPrivateFieldLooseBase(this,va)[va].shift();if(p.Type.isUndefined(e)){babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]=false;return}if(babelHelpers.classPrivateFieldLooseBase(this,la)[la]!==e.workflowId){if(p.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,ra)[ra][e.workflowId])){if(p.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId])){babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba](e);this.renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,la)[la]=e.workflowId;return}this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId],e.workflowId)}}this.renderTrack(e);this.startRendering()}renderIndex(){babelHelpers.classPrivateFieldLooseBase(this,ca)[ca]++;return p.Tag.render(Yt||(Yt=Xt`
			<div class="bizproc-debugger-automation__log--index" data-role="index">${0}</div>
		`),String(babelHelpers.classPrivateFieldLooseBase(this,ca)[ca]).padStart(3,"0"))}static renderTime(e){e=F.toDate(e);return p.Tag.render(Qt||(Qt=Xt`
			<div class="bizproc-debugger-automation__log--time">
				[${0}]
			</div>
		`),p.Text.encode(F.formatDate("H:i:s",e)))}renderStatusChange(e){const s=JSON.parse(e.note);if(!p.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,oa)[oa])){babelHelpers.classPrivateFieldLooseBase(this,oa)[oa]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,da)[da]=s;return}const t=this.getStatusSettings(babelHelpers.classPrivateFieldLooseBase(this,oa)[oa]);const a=s;const i=p.Tag.render(ea||(ea=Xt`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div class="bizproc-debugger-automation__status--change-info">
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
						<div class="bizproc-debugger-automation__status--robot-change-arrow"></div>
						<div class="bizproc-debugger-automation__status --log-status ${0}" title="${0}"> 
							<div class="bizproc-debugger-automation__status--title">${0}</div>
							<div class="bizproc-debugger-automation__status--bg" style="background-color: ${0}; border-color: ${0};">
								<span class="bizproc-debugger-automation__status--bg-arrow"></span>
							</div>
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),Ea.renderTime(e.datetime),F.getBgColorAdditionalClass(t["COLOR"]),p.Text.encode(t["NAME"]),p.Text.encode(t["NAME"]),t["COLOR"],t["COLOR"],F.getBgColorAdditionalClass(a["COLOR"]),p.Text.encode(a["NAME"]),p.Text.encode(a["NAME"]),a.COLOR,a.COLOR);p.Dom.append(i,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,oa)[oa]=s["STATUS_ID"];babelHelpers.classPrivateFieldLooseBase(this,da)[da]=s}getStatusSettings(){if(p.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,da)[da])){return{NAME:"",COLOR:"AEF2F9"}}return babelHelpers.classPrivateFieldLooseBase(this,da)[da]}onTrackAdded(e){const s=new v.TrackingEntryBuilder;s.setLogEntry(e.getData().row);this.addTrack(s.build())}addTrack(e){if(!babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]){return this.renderTrack(e)}babelHelpers.classPrivateFieldLooseBase(this,va)[va].push(e)}renderTrack(e){var s;if(e.id<=babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]){return}if(!Object.keys((s=babelHelpers.classPrivateFieldLooseBase(this,ra)[ra][e.workflowId])!=null?s:{}).includes(e.name)){if(e.name==="SESSION_LEGEND"){babelHelpers.classPrivateFieldLooseBase(this,ma)[ma](e);babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]=e.id}else if(e.name==="STATUS_CHANGED"){this.renderStatusChange(e);babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]=e.id}else if(e.name==="CATEGORY_CHANGED"){babelHelpers.classPrivateFieldLooseBase(this,ya)[ya](e);babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]=e.id}else if(e.name==="TRIGGER_LOG"){new Jt(this).addTrack(e).render();babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]=e.id}else if(e.name==="Template"&&e.type===As.ExecuteActivity){if(p.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId])&&babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]===false){babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]=true;babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba](e)}}else if(e.name==="Template"&&e.type===As.CloseActivity){babelHelpers.classPrivateFieldLooseBase(this,wa)[wa](e.workflowId)}return}babelHelpers.classPrivateFieldLooseBase(this,ra)[ra][e.workflowId][e.name].renderTrack(e);babelHelpers.classPrivateFieldLooseBase(this,ua)[ua]=e.id}collapseInfoResults(e){if(!e){e=this.logNode}const s=e.querySelectorAll('[data-role="info-result"]');s.forEach((e=>{if(e.firstElementChild.clientHeight>babelHelpers.classPrivateFieldLooseBase(this.constructor,ha)[ha]){const s=e.parentNode.querySelector('[data-role="more-info-result"]');p.Event.bind(s,"click",(()=>{p.Dom.style(e,"height",e.firstElementChild.clientHeight+"px");p.Dom.style(s,"display","none")}));p.Event.bind(e,"transitionend",(()=>{p.Dom.style(e,"height",null)}));p.Dom.style(e,"height",babelHelpers.classPrivateFieldLooseBase(this.constructor,ha)[ha]+"px");p.Dom.style(s,"display","block")}}));return this}shouldScrollToBottom(e){babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]=e;return this}}function Sa(){return new Promise((e=>{this.debugger.loadAllLog().then((s=>{babelHelpers.classPrivateFieldLooseBase(this,fa)[fa](s);e(this)}),(()=>{e(this)}))}))}function Da(e){this.debugger.loadRobotsByWorkflowId(e.workflowId).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId]=s.workflowRobots;this.initializeWorkflowRobotsRenderer(babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId],e.workflowId);this.startRendering()}),(()=>{babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e.workflowId]=[];console.info("session has no workflowId from track:",e);this.startRendering()}))}function Ra(e){const s=[];const t=new v.TrackingEntryBuilder;if(p.Type.isArrayFilled(e["logs"])){e["logs"].forEach((e=>{s.push(t.setLogEntry(e).build())}))}babelHelpers.classPrivateFieldLooseBase(this,va)[va]=s.concat(babelHelpers.classPrivateFieldLooseBase(this,va)[va]);babelHelpers.classPrivateFieldLooseBase(this,pa)[pa]=Object.assign(e["workflowRobots"],babelHelpers.classPrivateFieldLooseBase(this,pa)[pa])}function Ca(e){babelHelpers.classPrivateFieldLooseBase(this,Ha)[Ha](e);babelHelpers.classPrivateFieldLooseBase(this,_a)[_a](e)}function Na(e){const s=F.toDate(e.datetime);const t=p.Tag.render(sa||(sa=Xt`
			<div class="bizproc-debugger-automation__log--date">
				<div class="bizproc-debugger-automation__log--date-text">${0}</div>
			</div>
		`),p.Text.encode(F.formatDate("j F Y",s)));p.Dom.append(t,this.logNode)}function xa(e){const s=JSON.parse(e.note)["propertyValue"];const t=p.Tag.render(ta||(ta=Xt`
			<div class="bizproc-debugger-automation__log-section">
				<div class="bizproc-debugger-automation__log-section--row">
					${0}
					${0}
					<div>${0}</div>
				</div>
			</div>
		`),this.renderIndex(),Ea.renderTime(e.datetime),p.Text.encode(s));p.Dom.append(t,this.logNode)}function Aa(e){const s=JSON.parse(e.note)["propertyValue"];if(!p.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,na)[na])){babelHelpers.classPrivateFieldLooseBase(this,na)[na]=s;return}const t=p.Tag.render(aa||(aa=Xt`
			<div>
				<div class="bizproc-debugger-automation__log-separator"></div>
				<div class="bizproc-debugger-automation__log-section">
					<div class="bizproc-debugger-automation__log-section--row">
						${0}
						${0}
						<div>
							${0}
						</div>
					</div>
				</div>
			</div>
		`),this.renderIndex(),Ea.renderTime(e.datetime),p.Text.encode(p.Loc.getMessage("BIZPROC_JS_DEBUGGER_CATEGORY_CHANGE",{"#SOURCE_CATEGORY#":babelHelpers.classPrivateFieldLooseBase(this,na)[na],"#DESTINATION_CATEGORY#":s})));p.Dom.append(t,this.logNode);babelHelpers.classPrivateFieldLooseBase(this,na)[na]=s}function Ga(e){if(e.getData().tab==="log"){this.collapseInfoResults();if(babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]){babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]();babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]=false}}}function ja(){var e;this.logNode.parentNode.scrollTop=(e=this.logNode.parentNode)==null?void 0:e.scrollHeight}function za(e){delete babelHelpers.classPrivateFieldLooseBase(this,pa)[pa][e];delete babelHelpers.classPrivateFieldLooseBase(this,ra)[ra][e]}function ka(){this.debugger.unsubscribe("onWorkflowTrackAdded",this.onTrackAdded.bind(this));this.debugger.getMainView().unsubscribe("onChangeTab",babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa].bind(this))}Object.defineProperty(Ea,ha,{writable:true,value:50});var Ma=babelHelpers.classPrivateFieldLooseKey("ttl");var Ka=babelHelpers.classPrivateFieldLooseKey("prefix");var $a=babelHelpers.classPrivateFieldLooseKey("getName");class Ua{constructor(){Object.defineProperty(this,$a,{value:Wa});Object.defineProperty(this,Ma,{writable:true,value:3*86400});Object.defineProperty(this,Ka,{writable:true,value:"bp-atm-dbg-"})}getSet(e){const s=this.get(e);return s instanceof Array?new Set(s):new Set}get(e){return BX.localStorage.get(babelHelpers.classPrivateFieldLooseBase(this,$a)[$a](e))}set(e,s){if(s instanceof Set){s=Array.from(s)}BX.localStorage.set(babelHelpers.classPrivateFieldLooseBase(this,$a)[$a](e),s,babelHelpers.classPrivateFieldLooseBase(this,Ma)[Ma]);return this}}function Wa(e){return babelHelpers.classPrivateFieldLooseBase(this,Ka)[Ka]+e}var Ja=babelHelpers.classPrivateFieldLooseKey("pullHandlers");var Za=babelHelpers.classPrivateFieldLooseKey("settings");var Va=babelHelpers.classPrivateFieldLooseKey("mainView");var Xa=babelHelpers.classPrivateFieldLooseKey("triggers");var qa=babelHelpers.classPrivateFieldLooseKey("template");var Ya=babelHelpers.classPrivateFieldLooseKey("documentStatus");var Qa=babelHelpers.classPrivateFieldLooseKey("statusList");var ei=babelHelpers.classPrivateFieldLooseKey("documentCategoryId");var si=babelHelpers.classPrivateFieldLooseKey("documentFields");var ti=babelHelpers.classPrivateFieldLooseKey("documentValues");var ai=babelHelpers.classPrivateFieldLooseKey("workflowId");var ii=babelHelpers.classPrivateFieldLooseKey("workflowStatus");var li=babelHelpers.classPrivateFieldLooseKey("workflowEvents");var ri=babelHelpers.classPrivateFieldLooseKey("workflowTrack");var oi=babelHelpers.classPrivateFieldLooseKey("debuggerState");var ni=babelHelpers.classPrivateFieldLooseKey("initAutomationContext");var di=babelHelpers.classPrivateFieldLooseKey("subscribePull");var bi=babelHelpers.classPrivateFieldLooseKey("unsubscribePull");var ci=babelHelpers.classPrivateFieldLooseKey("handleRejectResponse");class ui extends h.EventEmitter{constructor(e={}){super();Object.defineProperty(this,ci,{value:hi});Object.defineProperty(this,bi,{value:gi});Object.defineProperty(this,di,{value:pi});Object.defineProperty(this,ni,{value:vi});this.session=null;Object.defineProperty(this,Ja,{writable:true,value:null});Object.defineProperty(this,Za,{writable:true,value:void 0});Object.defineProperty(this,Va,{writable:true,value:void 0});Object.defineProperty(this,Xa,{writable:true,value:void 0});Object.defineProperty(this,qa,{writable:true,value:void 0});Object.defineProperty(this,Ya,{writable:true,value:void 0});Object.defineProperty(this,Qa,{writable:true,value:void 0});Object.defineProperty(this,ei,{writable:true,value:0});Object.defineProperty(this,si,{writable:true,value:void 0});Object.defineProperty(this,ti,{writable:true,value:{}});Object.defineProperty(this,ai,{writable:true,value:void 0});Object.defineProperty(this,ii,{writable:true,value:void 0});Object.defineProperty(this,li,{writable:true,value:[]});Object.defineProperty(this,ri,{writable:true,value:[]});Object.defineProperty(this,oi,{writable:true,value:void 0});this.setEventNamespace("BX.Bizproc.Debugger.Automation");this.session=e.session;if(this.session.isActive()){this.session.subscribe("onFinished",this.destroy.bind(this));babelHelpers.classPrivateFieldLooseBase(this,di)[di]()}babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]=new Ua;babelHelpers.classPrivateFieldLooseBase(this,ni)[ni]()}destroy(){var e;this.unsubscribeAll();babelHelpers.classPrivateFieldLooseBase(this,bi)[bi]();(e=babelHelpers.classPrivateFieldLooseBase(this,Va)[Va])==null?void 0:e.destroy();this.session=null;babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]=null;babelHelpers.classPrivateFieldLooseBase(this,Va)[Va]=null;babelHelpers.classPrivateFieldLooseBase(this,qa)[qa]=[];babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]=null;babelHelpers.classPrivateFieldLooseBase(this,Qa)[Qa]=[];babelHelpers.classPrivateFieldLooseBase(this,si)[si]=[];babelHelpers.classPrivateFieldLooseBase(this,ti)[ti]={};babelHelpers.classPrivateFieldLooseBase(this,ai)[ai]=null;babelHelpers.classPrivateFieldLooseBase(this,ii)[ii]=0;babelHelpers.classPrivateFieldLooseBase(this,li)[li]=[];babelHelpers.classPrivateFieldLooseBase(this,ri)[ri]=[]}get track(){return babelHelpers.classPrivateFieldLooseBase(this,ri)[ri]}get settings(){return babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]}get documentSigned(){return this.session.documentSigned}get sessionId(){return this.session.id}get workflowId(){return babelHelpers.classPrivateFieldLooseBase(this,ai)[ai]}get pullHandlers(){if(babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]===null){babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]=[{name:"documentStatus",func:this.handleExternalDocumentStatus.bind(this)},{name:"documentValues",func:this.handleExternalDocumentValues.bind(this)},{name:"documentDelete",func:this.handleExternalDocumentDelete.bind(this)},{name:"workflowStatus",func:this.handleExternalWorkflowStatus.bind(this)},{name:"workflowEventAdd",func:this.handleExternalWorkflowEventAdd.bind(this)},{name:"workflowEventRemove",func:this.handleExternalWorkflowEventRemove.bind(this)},{name:"trackRow",func:this.handleExternalTrackRow.bind(this)}]}return babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]}getMainView(){if(!babelHelpers.classPrivateFieldLooseBase(this,Va)[Va]){babelHelpers.classPrivateFieldLooseBase(this,Va)[Va]=new we(this)}return babelHelpers.classPrivateFieldLooseBase(this,Va)[Va]}getLogView(){return new Ea(this)}getStatusList(){return babelHelpers.classPrivateFieldLooseBase(this,Qa)[Qa]}getDocumentFields(){return babelHelpers.classPrivateFieldLooseBase(this,si)[si]}getDocumentField(e){return babelHelpers.classPrivateFieldLooseBase(this,si)[si].find((s=>s.Id===e))}getDocumentValue(e){return babelHelpers.classPrivateFieldLooseBase(this,ti)[ti][e]||null}getDocumentStatus(){return babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]}getWorkflowStatus(){return babelHelpers.classPrivateFieldLooseBase(this,ii)[ii]}getState(){return babelHelpers.classPrivateFieldLooseBase(this,oi)[oi]}hasWorkflowEvents(){return babelHelpers.classPrivateFieldLooseBase(this,li)[li].length>0}setDocumentStatus(e){return new Promise((s=>{p.ajax.runAction("bizproc.debugger.setDocumentStatus",{data:{statusId:e}}).then((e=>{if(e.data&&e.data.newStatus){babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]=e.data.newStatus;babelHelpers.classPrivateFieldLooseBase(this,qa)[qa]=e.data.template;babelHelpers.classPrivateFieldLooseBase(this,ri)[ri]=[];this.emit("onDocumentStatusChanged")}s(e)}),babelHelpers.classPrivateFieldLooseBase(this,ci)[ci].bind(this))}))}get templateTriggers(){return babelHelpers.classPrivateFieldLooseBase(this,Xa)[Xa].filter((e=>e["DOCUMENT_STATUS"]===babelHelpers.classPrivateFieldLooseBase(this,qa)[qa]["DOCUMENT_STATUS"]))}getTemplate(){return babelHelpers.classPrivateFieldLooseBase(this,qa)[qa]}isTemplateEmpty(){return babelHelpers.classPrivateFieldLooseBase(this,qa)[qa].IS_EXTERNAL_MODIFIED===false&&!p.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,qa)[qa].ROBOTS)}startDebugTemplate(){return new Promise((e=>{p.ajax.runAction("bizproc.debugger.resumeAutomationTemplate",{data:{sessionId:this.sessionId}}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,ai)[ai]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,oi)[oi]=s.data.debuggerState;e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,ci)[ci].bind(this))}))}emulateExternalEvent(){return new Promise((e=>{const s=babelHelpers.classPrivateFieldLooseBase(this,li)[li][0];if(!s){return}p.ajax.runAction("bizproc.debugger.emulateExternalEvent",{data:{workflowId:babelHelpers.classPrivateFieldLooseBase(this,ai)[ai],eventId:s}}).then((s=>{e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,ci)[ci].bind(this))}))}loadMainViewInfo(){return new Promise((e=>{p.ajax.runAction("bizproc.debugger.fillAutomationView",{data:{sessionId:this.sessionId}}).then((s=>{babelHelpers.classPrivateFieldLooseBase(this,Xa)[Xa]=s.data.triggers;babelHelpers.classPrivateFieldLooseBase(this,qa)[qa]=s.data.template;babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]=s.data.documentStatus;babelHelpers.classPrivateFieldLooseBase(this,Qa)[Qa]=s.data.statusList;babelHelpers.classPrivateFieldLooseBase(this,ei)[ei]=s.data.documentCategoryId;babelHelpers.classPrivateFieldLooseBase(this,si)[si]=s.data.documentFields;babelHelpers.classPrivateFieldLooseBase(this,ti)[ti]=s.data.documentValues;babelHelpers.classPrivateFieldLooseBase(this,ai)[ai]=s.data.workflowId;babelHelpers.classPrivateFieldLooseBase(this,ii)[ii]=s.data.workflowStatus;babelHelpers.classPrivateFieldLooseBase(this,li)[li]=s.data.workflowEvents;babelHelpers.classPrivateFieldLooseBase(this,ri)[ri]=s.data.track;babelHelpers.classPrivateFieldLooseBase(this,oi)[oi]=s.data.debuggerState;v.getGlobalContext().document.setFields(this.getDocumentFields()).setStatusList(this.getStatusList()).setStatus(this.getDocumentStatus());e()}),babelHelpers.classPrivateFieldLooseBase(this,ci)[ci].bind(this))}))}loadAllLog(){return new Promise((e=>{p.ajax.runAction("bizproc.debugger.loadAllLog",{data:{sessionId:this.session.id}}).then((s=>{e(s.data)}),babelHelpers.classPrivateFieldLooseBase(this,ci)[ci].bind(this))}))}loadRobotsByWorkflowId(e){return new Promise(((s,t)=>{p.ajax.runAction("bizproc.debugger.loadRobotsByWorkflowId",{data:{sessionId:this.sessionId,workflowId:e}}).then((e=>{s(e.data)}),(e=>{t(e.data)}))}))}handleExternalDocumentStatus(e){const s=e.getData().status;if(this.getDocumentStatus()===s){return}console.info("document status: "+s);this.loadMainViewInfo().then((()=>{this.emit("onDocumentStatusChanged")}))}handleExternalDocumentValues(e){const s=e.getData().values;Object.keys(s).forEach((e=>babelHelpers.classPrivateFieldLooseBase(this,ti)[ti][e]=s[e]));console.info("document values: "+Object.keys(s));this.emit("onDocumentValuesUpdated",{values:s})}handleExternalDocumentDelete(){u.MessageBox.show({message:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_CONFIRM_ON_DOCUMENT_DELETE"),okCaption:p.Loc.getMessage("BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION"),onOk:()=>_i.Instance.finishSession(this.session).then(null,babelHelpers.classPrivateFieldLooseBase(this,ci)[ci].bind(this)),buttons:u.MessageBoxButtons.OK_CANCEL})}handleExternalTrackRow(e){const s=e.getData().row;s["WORKFLOW_STATUS"]=babelHelpers.classPrivateFieldLooseBase(this,ii)[ii];babelHelpers.classPrivateFieldLooseBase(this,ri)[ri].push(s);this.emit("onWorkflowTrackAdded",{row:s})}handleExternalWorkflowStatus(e){const s=e.getData().status;const t=e.getData().workflowId;babelHelpers.classPrivateFieldLooseBase(this,ii)[ii]=s;if(s===P.Running){babelHelpers.classPrivateFieldLooseBase(this,ai)[ai]=t}if(babelHelpers.classPrivateFieldLooseBase(this,ai)[ai]!==t){return}console.info("workflow status: "+s);this.emit("onWorkflowStatusChanged",{status:s,workflowId:t})}handleExternalWorkflowEventAdd(e){const s=e.getData().eventName;console.info("workflow event added: "+s);babelHelpers.classPrivateFieldLooseBase(this,li)[li].push(s);console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,li)[li].join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,li)[li]})}handleExternalWorkflowEventRemove(e){const s=e.getData().eventName;console.info("workflow event removed: "+s);babelHelpers.classPrivateFieldLooseBase(this,li)[li]=babelHelpers.classPrivateFieldLooseBase(this,li)[li].filter((e=>e!==s));console.info("workflow events: "+babelHelpers.classPrivateFieldLooseBase(this,li)[li].join(", "));this.emit("onWorkflowEventsChanged",{events:babelHelpers.classPrivateFieldLooseBase(this,li)[li]})}getField(e,s){let t;switch(e){case"Document":t=babelHelpers.classPrivateFieldLooseBase(this,si)[si].find((e=>e.Id===s));break;case"Template":case"Parameter":case"Constant":case"GlobalConst":case"GlobalVar":break}return t||{Id:s,ObjectId:e,Name:s,Type:"string",Expression:s,SystemExpression:"{="+e+":"+s+"}"}}getSettingsUrl(){return`/crm/deal/automation/${babelHelpers.classPrivateFieldLooseBase(this,ei)[ei]}/`}}function vi(){const e=new v.AutomationContext({document:new v.Document({rawDocumentType:[],documentId:null,categoryId:0,statusList:this.getStatusList(),statusId:this.getDocumentStatus(),documentFields:this.getDocumentFields()}),documentSigned:this.documentSigned,canEdit:false,canManage:false});v.setGlobalContext(e)}function pi(){const e=_i.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.subscribe(s,t)}))}function gi(){if(babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]===null){return}const e=_i.Instance.pullHandler;this.pullHandlers.forEach((({name:s,func:t})=>{e.unsubscribe(s,t)}));babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]=null}function hi(e){if(p.Type.isArrayFilled(e.errors)){const s=e.errors.find((e=>e.code===404));if(s){this.handleExternalDocumentDelete()}else{const s=e.errors.map((e=>e.message)).join("\n");u.MessageBox.alert(s)}}}var Pi=babelHelpers.classPrivateFieldLooseKey("unsubscribe");var Li=babelHelpers.classPrivateFieldLooseKey("commands");var Fi=babelHelpers.classPrivateFieldLooseKey("handleCommand");class Bi extends h.EventEmitter{constructor(){super();Object.defineProperty(this,Fi,{value:fi});Object.defineProperty(this,Pi,{writable:true,value:void 0});Object.defineProperty(this,Li,{writable:true,value:["documentStatus","documentValues","documentDelete","workflowStatus","workflowEventAdd","workflowEventRemove","trackRow","sessionFinish"]});this.setEventNamespace("BX.Bizproc.Debugger.Pull");babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi]=g.PULL.subscribe(this)}destroy(){if(p.Type.isFunction(babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi])){babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi]()}babelHelpers.classPrivateFieldLooseBase(this,Pi)[Pi]=null}getModuleId(){return"bizproc"}getSubscriptionType(){return BX.PullClient.SubscriptionType.Server}getMap(){const e={};babelHelpers.classPrivateFieldLooseBase(this,Li)[Li].forEach((s=>{e[s]=babelHelpers.classPrivateFieldLooseBase(this,Fi)[Fi].bind(this)}));return e}}function fi(e,s,t){this.emit(t,e)}let mi=null;var Hi=babelHelpers.classPrivateFieldLooseKey("showDebugger");class _i{static get Instance(){if(mi===null){mi=new _i}return mi}constructor(){Object.defineProperty(this,Hi,{value:yi});this.pullHandler=new Bi}initializeDebugger(e={session:{},documentSigned:""}){const s=p.Type.isPlainObject(e.session)?new Ds(e.session):null;if(!s){return}s.documentSigned=e.documentSigned;babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi](s)}startSession(e,s){return new Promise(((t,a)=>{Ds.start(e,s).then((e=>{this.setDebugFilter();babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi](e,true);t()}),a)}))}finishSession(e){return new Promise(((s,t)=>{e.finish().then((e=>{this.removeDebugFilter();s(e)}),t)}))}setDebugFilter(){var e;const s=(e=BX.Main.filterManager)==null?void 0:e.getList();if(!s){return}s.forEach((e=>{const s=e.getApi();s.setFilter({preset_id:"filter_robot_debugger"})}))}removeDebugFilter(){var e;const s=(e=BX.Main.filterManager)==null?void 0:e.getList();if(!s){return}s.forEach((e=>{const s=e.getApi();s.setFilter({preset_id:"default_filter"})}))}createAutomationDebugger(e={}){return new ui(e)}openDebuggerStartPage(e){const s=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.start/",{documentSigned:e});const t={width:745,cacheable:false,allowChangeHistory:true,events:{}};return _i.openSlider(s,t)}openSessionLog(e){const s=BX.Uri.addParam("/bitrix/components/bitrix/bizproc.debugger.log/",{setTitle:"Y",sessionId:e});const t={width:720,cacheable:false,allowChangeHistory:true,events:{},newWindowLabel:true};return _i.openSlider(s,t)}static openSlider(e,s){if(!p.Type.isPlainObject(s)){s={}}s={...{cacheable:false,allowChangeHistory:true,events:{}},...s};return new Promise(((t,a)=>{if(p.Type.isStringFilled(e)){if(BX.SidePanel.Instance.open(e,s)){return t()}return a()}return a()}))}}function yi(e,s=false){let t=null;if(e.isAutomation()){t=this.createAutomationDebugger({session:e})}if(t){t.getMainView()[s?"showExpanded":"show"]()}}const Oi={Manager:_i,Session:Ds,Mode:cs};e.Debugger=Oi;e.Manager=_i;e.Session=Ds;e.Mode=cs})(this.BX.Bizproc=this.BX.Bizproc||{},BX.Main,BX.UI,BX,BX.UI.EntitySelector,BX,BX.UI,BX,BX.Main,BX.Bizproc,BX,BX,BX.UI.Dialogs,BX.Bizproc,BX,BX,BX.Event);
//# sourceMappingURL=debugger.bundle.map.js