{"version":3,"file":"debugger.bundle.js","sources":["../src/workflow/types.js","../src/helper.js","../src/views/automation-main.js","../src/session/mode.js","../src/session/document.js","../src/session/session.js","../src/tracker/robot-log.js","../src/tracker/trigger-log.js","../src/views/automation-log.js","../src/settings.js","../src/tourguide/action-panel-guide.js","../src/actionpanel/custom-crm-action-panel.js","../src/automation.js","../src/pull/command-handler.js","../src/tourguide/filter-guide.js","../src/tourguide/stage-guide.js","../src/tourguide/crm-debugger-guide.js","../src/manager.js","../src/index.js"],"sourcesContent":["export class DebuggerState\n{\n\tstatic Run = 0;\n\tstatic NextStep = 1;\n\tstatic Stop = 2;\n\tstatic Pause = 3;\n\tstatic Undefined = -1;\n}\n","import {Loc, Text, Type} from 'main.core';\nimport {DateTimeFormat} from 'main.date';\n\nexport class Helper\n{\n\t/** Finds whether a variable is a number or a numeric string */\n\tstatic isNumeric(num: string | number): boolean\n\t{\n\t\tif (Type.isNumber(num))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!Type.isStringFilled(num))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (Number(num).toString() === num.trim());\n\t}\n\n\t/** Checks whether the variable is a date or a timestamp */\n\tstatic isDate(date: string | Date): boolean\n\t{\n\t\tif (Type.isDate(date))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!Helper.isNumeric(date))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (new Date(Number(date)).getTime() === Number(date));\n\t}\n\n\t/** Convert date from DataBase to date in JS */\n\tstatic convertDateFromDB(date: string | number): ?Date\n\t{\n\t\tif (!Helper.isNumeric(date))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn new Date(date * 1000);\n\t}\n\n\t/** if the variable is a date or a timestamp return Date, else null  */\n\tstatic toDate(date: string | Date): ?Date\n\t{\n\t\tif (Date.parse(date))\n\t\t{\n\t\t\treturn new Date(date);\n\t\t}\n\n\t\tif (!Helper.isDate(date))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isDate(date))\n\t\t{\n\t\t\treturn date;\n\t\t}\n\n\t\treturn Helper.convertDateFromDB(date);\n\t}\n\n\t/** formats the date */\n\tstatic formatDate(format: string, date: Date): string\n\t{\n\t\tif (!Type.isStringFilled(format))\n\t\t{\n\t\t\tformat = 'j F Y H:i:s';\n\t\t}\n\n\t\treturn DateTimeFormat.format(format, date);\n\t}\n\n\t/** return condition operators label */\n\tstatic getOperatorsLabel(): object\n\t{\n\t\treturn {\n\t\t\t'!empty': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_EMPTY'),\n\t\t\t'empty': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_EMPTY'),\n\t\t\t'=': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_EQ'),\n\t\t\t'!=': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_NE'),\n\t\t\t'in': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_IN'),\n\t\t\t'!in': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_IN'),\n\t\t\t'contain': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_CONTAIN'),\n\t\t\t'!contain': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_NOT_CONTAIN'),\n\t\t\t'>': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_GT'),\n\t\t\t'>=': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_GTE'),\n\t\t\t'<': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_LT'),\n\t\t\t'<=': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_LTE'),\n\t\t};\n\t}\n\n\t/** return condition operator label */\n\tstatic getOperatorLabel(operator: string): string\n\t{\n\t\treturn Helper.getOperatorsLabel()[operator];\n\t}\n\n\t/** return joiner label */\n\tstatic getJoinerLabel(joiner: string): string\n\t{\n\t\tconst joiners = {\n\t\t\t'AND': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_AND'),\n\t\t\t'OR': Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_OR'),\n\t\t};\n\n\t\treturn joiners[joiner];\n\t}\n\n\tstatic getColorBrightness(bgColor: string): number\n\t{\n\t\tif (bgColor[0] === '#')\n\t\t{\n\t\t\tbgColor = bgColor.replace('#', '');\n\t\t}\n\n\t\tconst bigint = parseInt(bgColor, 16);\n\t\tconst r = (bigint >> 16) & 255;\n\t\tconst g = (bigint >> 8) & 255;\n\t\tconst b = bigint & 255;\n\n\t\treturn 0.21 * r + 0.72 * g + 0.07 * b;\n\t}\n\n\tstatic getBgColorAdditionalClass(bgColor: string): boolean\n\t{\n\t\tconst brightness = Helper.getColorBrightness(bgColor);\n\t\tif (brightness > 224)\n\t\t{\n\t\t\treturn '--with-border --light-color';\n\t\t}\n\n\t\tif (brightness > 145)\n\t\t{\n\t\t\treturn '--light-color';\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tstatic toHtml(text): string\n\t{\n\t\treturn Text.encode(text || '')\n\t\t\t.replace(/\\[(\\/)?b\\]/ig, '<$1b>')\n\t\t;\n\t}\n}","import {Dom, Loc, Tag, Text, Type} from 'main.core';\nimport Automation from \"../automation\";\nimport {Menu, MenuItem, Popup} from \"main.popup\";\nimport {getGlobalContext, Template, Tracker, ViewMode, TriggerManager, HelpHint, WorkflowStatus } from 'bizproc.automation';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport { Button, ButtonSize, ButtonColor, ButtonIcon} from 'ui.buttons';\nimport 'ui.buttons.icons';\nimport {EntitySelector} from \"ui.entity-selector\";\nimport \"bp_field_type\";\nimport 'ui.layout-form';\nimport 'ui.hint';\nimport {DebuggerState} from \"../workflow/types\";\nimport {MessageBox, MessageBoxButtons} from \"ui.dialogs.messagebox\";\nimport {Manager} from \"bizproc.debugger\";\nimport {Helper} from \"../helper\";\nimport {Loader} from \"main.loader\";\n\nexport default class AutomationMainView extends EventEmitter\n{\n\t#debuggerInstance: Automation;\n\n\t#popupInstance;\n\t#loaded = false;\n\t#node;\n\t#triggerManager: ?TriggerManager;\n\t#template;\n\t#tracker;\n\t#tabs = ['doc', 'log'];\n\n\t#expandedMinWidth = 781;\n\t#expandedMinHeight = 612;\n\n\t#collapsedMinWidth = 465;\n\t#collapsedMinHeight = 187;\n\n\t#changingViewTimeout;\n\n\t#buttonPlay: Button;\n\n\tconstructor(debuggerInstance: Automation)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Debugger.AutomationMainView');\n\n\t\tthis.#debuggerInstance = debuggerInstance;\n\n\t\tdebuggerInstance.subscribe('onDocumentStatusChanged', this.#onDocumentStatusChanged.bind(this));\n\t\tdebuggerInstance.subscribe('onWorkflowEventsChanged', this.#onWorkflowEventsChanged.bind(this));\n\t\tdebuggerInstance.subscribe('onWorkflowTrackAdded', this.#onWorkflowTrackAdded.bind(this));\n\t\tdebuggerInstance.subscribe('onDocumentValuesUpdated', this.#onDocumentValuesUpdated.bind(this));\n\t\tdebuggerInstance.subscribe('onWorkflowStatusChanged', this.#onWorkflowStatusChange.bind(this));\n\t\tdebuggerInstance.subscribe('onAfterDocumentFixed', this.#onAfterDocumentFixed.bind(this));\n\t}\n\n\tget debugger(): Automation\n\t{\n\t\treturn this.#debuggerInstance;\n\t}\n\n\tshow()\n\t{\n\t\tif (this.#loaded)\n\t\t{\n\t\t\tthis.#getPopup().show();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.debugger.loadMainViewInfo().then(() => {\n\t\t\tthis.#loaded = true;\n\t\t\tthis.#getPopup().setContent(this.#getNode());\n\t\t\tthis.#setDebuggerState(this.debugger.getState());\n\n\t\t\tthis.#getPopup().show();\n\t\t});\n\t}\n\n\tshowExpanded()\n\t{\n\t\tthis.debugger.settings.set('popup-collapsed', false);\n\t\tthis.show();\n\t}\n\n\tshowCollapsed()\n\t{\n\t\tthis.debugger.settings.set('popup-collapsed', true);\n\t\tthis.show();\n\t}\n\n\tclose()\n\t{\n\t\tthis.#getPopup().close();\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.close();\n\t\t//TODO - cleanup\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\tif (!this.#popupInstance)\n\t\t{\n\t\t\tconst collapsed = this.debugger.settings.get('popup-collapsed');\n\t\t\tconst className = 'bizproc-debugger-automation__main-popup bizproc-debugger-automation__scope';\n\n\t\t\tthis.#popupInstance = new Popup({\n\t\t\t\tclassName: className + (collapsed ? ' --collapse' : ''),\n\t\t\t\ttitleBar: this.#getPopupTitleBar(),\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\tcontentBackground: 'white',\n\t\t\t\tdraggable: true,\n\t\t\t\tzIndexOptions: {\n\t\t\t\t\talwaysOnTop: collapsed\n\t\t\t\t},\n\t\t\t\twidth: this.#getPopupWidth(collapsed),\n\t\t\t\theight: this.#getPopupHeight(collapsed),\n\t\t\t\tevents: {\n\t\t\t\t\tonResizeStart: ()=> {\n\t\t\t\t\t\tthis.#popupInstance.setMinWidth(this.#expandedMinWidth);\n\t\t\t\t\t\tthis.#popupInstance.setMinHeight(this.#expandedMinHeight);\n\t\t\t\t\t},\n\t\t\t\t\tonResizeEnd: ()=> {\n\t\t\t\t\t\tthis.#popupInstance.setMinWidth(null);\n\t\t\t\t\t\tthis.#popupInstance.setMinHeight(null);\n\n\t\t\t\t\t\tthis.debugger.settings.set('popup-width', this.#popupInstance.getWidth());\n\t\t\t\t\t\tthis.debugger.settings.set('popup-height', this.#popupInstance.getHeight());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.#popupInstance.setResizeMode(!collapsed);\n\t\t}\n\n\t\treturn this.#popupInstance;\n\t}\n\n\t#getPopupWidth(collapsed: boolean): number\n\t{\n\t\tif (collapsed)\n\t\t{\n\t\t\treturn this.#collapsedMinWidth;\n\t\t}\n\n\t\treturn Math.max(\n\t\t\tthis.#expandedMinWidth,\n\t\t\tthis.debugger.settings.get('popup-width') || 0\n\t\t);\n\t}\n\n\t#getPopupHeight(collapsed: boolean): number\n\t{\n\t\tif (collapsed)\n\t\t{\n\t\t\treturn this.#collapsedMinHeight;\n\t\t}\n\n\t\treturn Math.max(\n\t\t\tthis.#expandedMinHeight,\n\t\t\tthis.debugger.settings.get('popup-height') || 0\n\t\t);\n\t}\n\n\t#getPopupTitleBar(): {}\n\t{\n\t\treturn {\n\t\t\tcontent: Tag.render`\n\t\t\t\t<div class=\"popup-window-titlebar-text bizproc-debugger-automation__titlebar\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__titlebar--move-icon\"></div>\n\t\t\t\t\t${document.createTextNode(Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_POPUP_TITLE'))}\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"bizproc-debugger-automation__titlebar--button-collapse\" \n\t\t\t\t\t\tonclick=\"${this.handleCollapse.bind(this)}\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\" popup-window-close-icon \n\t\t\t\t\t\t\t\tpopup-window-titlebar-close-icon \n\t\t\t\t\t\t\t\tbizproc-debugger-automation__titlebar--button-close\"\n\t\t\t\t\t\tonclick=\"${this.#handleClose.bind(this)}\"\n\t\t\t\t\t></span>\n\t\t\t\t</div>\n\t\t\t`\n\t\t};\n\t}\n\n\thandleCollapse()\n\t{\n\t\tconst node = this.#getPopup().getPopupContainer();\n\t\tconst collapsed = Dom.hasClass(node, '--collapse');\n\n\t\tthis.debugger.settings.set('popup-collapsed', !collapsed);\n\t\tthis.#getPopup().getZIndexComponent().setAlwaysOnTop(!collapsed);\n\n\t\tthis.#getPopup().setResizeMode(collapsed);\n\n\t\tDom.toggleClass(node, '--collapse');\n\n\t\tclearTimeout(this.#changingViewTimeout);\n\t\tDom.addClass(node, '--changing-view');\n\n\t\tthis.#getPopup().setWidth(this.#getPopupWidth(!collapsed));\n\t\tthis.#getPopup().setHeight(this.#getPopupHeight(!collapsed));\n\n\t\tthis.#changingViewTimeout = setTimeout(\n\t\t\t() => Dom.removeClass(node, '--changing-view'),\n\t\t\t500\n\t\t);\n\t}\n\n\t#handleClose()\n\t{\n\t\tMessageBox.show({\n\t\t\tmessage: Loc.getMessage('BIZPROC_JS_DEBUGGER_CONFIRM_FINISH_SESSION'),\n\t\t\tokCaption: Loc.getMessage('BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION'),\n\t\t\tonOk: () => Manager.Instance.finishSession(this.debugger.session),\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t});\n\t}\n\n\t#getNode(): Element\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\tthis.#node = Tag.render`\n\t\t\t\t<div class=\"bizproc-debugger-automation__content\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation-content-collapsed\">\n\t\t\t\t\t\t${this.#renderCollapsedMode()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__content-expanded\">\n\t\t\t\t\t\t${this.#renderExpandedMode()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tHelpHint.bindAll(this.#node);\n\t\t}\n\n\t\treturn this.#node;\n\t}\n\n\t#renderExpandedMode(): Element\n\t{\n\t\tconst hasRobots = !this.debugger.isTemplateEmpty();\n\n\t\tconst activeTab = this.debugger.settings.get('tab') === 'log' ? 'log' : 'doc';\n\t\tconst tabDocClass = activeTab === 'doc' ? '--active' : '';\n\t\tconst tabLogClass = activeTab === 'log' ? '--active' : '';\n\n\t\tconst hasActiveDocument = this.debugger.session.isFixed();\n\t\tconst tabNoDocumentClass = hasActiveDocument ? '' : '--empty --active';\n\n\t\tconst fieldListNode = this.#getFieldListNode();\n\t\tconst hasFields = fieldListNode.querySelector('[data-field-id]') !== null;\n\n\t\treturn Tag.render`\n\t\t\t\t<div class=\"bizproc-debugger-automation__main\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__main-robots\">\n\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__main-robots--head\">\n\t\t\t\t\t\t\t${this.#createStageNode()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div data-role=\"automation-content\" class=\"bizproc-debugger-automation__main-robots--main-content\">\n\t\t\t\t\t\t\t${this.#createTriggersHeaderNode() ?? ''}\n\t\t\t\t\t\t\t${this.#createTriggersNode() ?? ''}\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__head\">\n\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__main--title\">\n\t\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__main--name\">${Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_ROBOTS_TITLE')} </div>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"ui-hint-icon\" data-text=\"${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_HELPTIP_ROBOT'))}\"></span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div data-role=\"no-template\" class=\"bizproc-debugger-automation__main-hint ${hasRobots ? '' : '--active'}\">\n\t\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__main-hint--title\">\n\t\t\t\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_NO_ROBOTS_TITLE'))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__main-hint--text\">\n\t\t\t\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_NO_ROBOTS_SUBTITLE'))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<a href=\"${this.debugger.getSettingsUrl()}\" class=\"bizproc-debugger-automation__link\">${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS'))}</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.#createTemplateNode()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.#createTemplateToolbar()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__main-fields ${hasActiveDocument ? '' : '--disabled'}\">\n\t\t\t\t\t\t<div data-role=\"tabs-container\" class=\"bizproc-debugger-automation__main-navigation --active-${activeTab}\">\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__tab-block\">\n\t\t\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__tab ${tabDocClass}\" data-tab-item=\"doc\" onclick=\"${this.#handleChangeTab.bind(this)}\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t<span class=\"ui-hint-icon\" data-text=\"${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_HELPTIP_FIELD'))}\"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__tab-block\">\n\t\t\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__tab ${tabLogClass}\" data-tab-item=\"log\" onclick=\"${this.#handleChangeTab.bind(this)}\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_LOG_TITLE')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t<span class=\"ui-hint-icon\" data-text=\"${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_HELPTIP_LOG'))}\"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div data-tab-item=\"doc\" class=\"bizproc-debugger-automation__tab-action ${tabDocClass}\">\n\t\t\t\t\t\t\t\t${this.#getAddFieldNode()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div data-tab-item=\"log\" class=\"bizproc-debugger-automation__tab-action ${tabLogClass}\">\n\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__action-btn --icon-search\" style=\"display: none\"></div>\n\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__action-btn --icon-log\" onclick=\"${() => {Manager.Instance.openSessionLog(this.debugger.sessionId);}}\"></div>\n\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__action-btn --icon-note\" style=\"display: none\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div data-tab-item=\"doc\" data-role=\"tab-content-doc\" class=\"bizproc-debugger-tab__content ${hasActiveDocument ? tabDocClass : ''} ${hasFields ? '' : '--empty'}\">\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-tab__content--empty\">\n\t\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_NO_FIELD_TITLE'))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-tab__content--not-empty\">\n\t\t\t\t\t\t\t\t<div class=\"bizproc-debugger-tab__content-title\">${Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_DOCUMENT_TITLE')}</div>\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t${fieldListNode}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div data-tab-item=\"log\" class=\"bizproc-debugger-tab__content ${hasActiveDocument ? tabLogClass : ''} bizproc-debugger-automation-main-section-log\">\n\t\t\t\t\t\t\t${this.debugger.getLogView().shouldScrollToBottom(true).shouldLoadPreviousLog(true).render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div data-tab-item=\"no-document\" class=\"bizproc-debugger-tab__content ${tabNoDocumentClass} bizproc-debugger-automation-main-section-disabled\">\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-tab__content--empty\">\n\t\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_NO_FIXED_DOCUMENT'))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t}\n\n\t#renderCollapsedMode(): Element\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation-menu__content-body\">\n\t\t\t\t<div class=\"bizproc-debugger-automation-menu__content-body--logo\"></div>\n\t\t\t\t<div class=\"bizproc-debugger-automation-menu__content-body--text\">${Loc.getMessage('BIZPROC_JS_DEBUGGER_VIEWS_MENU_SUBTITLE')}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getAddFieldNode()\n\t{\n\t\treturn (new Button({\n\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\tround: true,\n\t\t\tnoCaps: true,\n\t\t\ttext: Loc.getMessage('BIZPROC_JS_DEBUGGER_VIEWS_ADD_FIELD'),\n\t\t\tonclick: this.#handleAddDocFieldMenu.bind(this)\n\t\t})).render();\n\t}\n\n\t#getFieldListNode()\n\t{\n\t\tconst form = Tag.render`<div class=\"ui-form\" data-role=\"doc-field-list\">\n\t\t\t</div>`;\n\t\tconst fields = this.debugger.settings.getSet('watch-fields');\n\n\t\tfields.forEach(value => {\n\t\t\tconst node = this.#getFieldNode(value);\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tDom.append(node, form);\n\t\t\t}\n\t\t});\n\n\t\treturn form;\n\t}\n\n\t#handleChangeTab(event: Event)\n\t{\n\t\tconst activeTabName = event.target.dataset.tabItem;\n\t\tconst hiddenTabName = this.#tabs.filter((tabName) => tabName !== activeTabName)[0]\n\n\t\tconst node = this.#getNode();\n\t\tconst navigationNode = node.querySelector('[data-role=\"tabs-container\"]');\n\n\t\tnode.querySelectorAll([`[data-tab-item=\"${activeTabName}\"]`]).forEach(\n\t\t\t(tab) => Dom.addClass(tab, '--active')\n\t\t);\n\n\t\tnode.querySelectorAll([`[data-tab-item=\"${hiddenTabName}\"]`]).forEach(\n\t\t\t(tab) => Dom.removeClass(tab, '--active')\n\t\t);\n\n\t\tDom.addClass(navigationNode, `--active-${activeTabName}`);\n\t\tDom.removeClass(navigationNode, `--active-${hiddenTabName}`);\n\n\t\tthis.debugger.settings.set('tab', activeTabName);\n\n\t\tthis.emit('onChangeTab', {tab: activeTabName});\n\t}\n\n\t#handleAddDocFieldMenu(button: Button, event: Event)\n\t{\n\t\tconst documentFields = this.debugger.getDocumentFields();\n\t\tconst selectedFields = this.debugger.settings.getSet('watch-fields');\n\n\t\tconst fieldsDialog = new EntitySelector.Dialog({\n\t\t\ttargetNode: event.target,\n\t\t\twidth: 500,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tcacheable: false,\n\t\t\titems: documentFields\n\t\t\t\t.filter(field => field.Watchable === true)\n\t\t\t\t.map((field) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttitle: field.Name,\n\t\t\t\t\t\tid: field.Id,\n\t\t\t\t\t\tcustomData: {field},\n\t\t\t\t\t\tentityId: 'bp',\n\t\t\t\t\t\ttabs: 'recents',\n\t\t\t\t\t\tselected: selectedFields.has(field.Id)\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\tshowAvatars: false,\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': event => this.#handleAddField(event.getData().item),\n\t\t\t\t'Item:onDeselect': event => this.#handleRemoveField(event.getData().item.getId()),\n\t\t\t},\n\t\t\tcompactView: true,\n\t\t});\n\n\t\tfieldsDialog.show();\n\t}\n\n\t#handleAddField(item)\n\t{\n\t\tconst fields = this.debugger.settings.getSet('watch-fields');\n\t\tconst field = item.getCustomData().get('field');\n\n\t\tif (fields.has(field.Id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fieldNode = this.#getFieldNode(field);\n\n\t\tDom.append(\n\t\t\tfieldNode,\n\t\t\tthis.#getNode().querySelector('[data-role=\"doc-field-list\"]')\n\t\t);\n\n\t\tfields.add(field.Id);\n\t\tthis.debugger.settings.set('watch-fields', fields);\n\t\tthis.#handleFieldListChange(fields);\n\t}\n\n\t#handleRemoveField(fieldId: string)\n\t{\n\t\tconst fields = this.debugger.settings.getSet('watch-fields');\n\n\t\tif (!fields.has(fieldId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfields.delete(fieldId);\n\t\tthis.debugger.settings.set('watch-fields', fields);\n\t\tDom.remove(this.#getNode().querySelector(`[data-field-id=\"${fieldId}\"]`));\n\t\tthis.#handleFieldListChange(fields);\n\t}\n\n\t#handleFieldListChange(fields: Set)\n\t{\n\t\tconst contentNode = this.#getNode().querySelector('[data-role=\"tab-content-doc\"]');\n\t\tconst hasFields = contentNode.querySelector('[data-field-id]') !== null;\n\t\tDom[hasFields ? 'removeClass' : 'addClass'](contentNode, '--empty');\n\t}\n\n\t#getFieldNode(field: string | {}): ?Element\n\t{\n\t\tif (Type.isString(field))\n\t\t{\n\t\t\tfield = this.debugger.getDocumentField(field);\n\t\t}\n\n\t\tif (!field || !field.Id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst value = this.debugger.getDocumentValue(field.Id) || '';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form-row\" data-role=\"field-row\" data-field-id=\"${Text.encode(field.Id)}\">\n\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Text.encode(field.Name)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-ext-after-icon\">\n\t\t\t\t\t\t<input type=\"text\" readonly class=\"ui-ctl-element\"\n\t\t\t\t\t\t placeholder=\"${Loc.getMessage('BIZPROC_JS_DEBUGGER_VIEWS_EMPTY_VALUE')}\"\n\t\t\t\t\t\t data-role=\"field-value-${Text.encode(field.Id)}\"\n\t\t\t\t\t\t value=\"${Text.encode(value)}\"\n\t\t\t\t\t\t >\n\t\t\t\t\t\t <a class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.#handleRemoveField.bind(this, field.Id)}\"></a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createTriggersHeaderNode(): ?Element\n\t{\n\t\tconst hasTriggers = this.debugger.templateTriggers.length > 0;\n\t\tconst hasRobots = !this.debugger.isTemplateEmpty();\n\n\t\tif (!hasTriggers && hasRobots)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div data-role=\"triggers-header\" class=\"bizproc-debugger-automation__head\">\n\t\t\t\t<div class=\"bizproc-debugger-automation__main--title\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__main--name\">${Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_TRIGGERS_TITLE')} </div>\n\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t<span class=\"ui-hint-icon\" data-text=\"${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_HELPTIP_TRIGGER'))}\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div data-role=\"no-triggers\" class=\"bizproc-debugger-automation__main-hint ${hasTriggers || hasRobots ? '' : '--active'}\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__main-hint--title\">\n\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_NO_TRIGGERS_TITLE'))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__main-hint--text\">\n\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_NO_TRIGGERS_SUBTITLE'))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<a href=\"${this.debugger.getSettingsUrl()}\" class=\"bizproc-debugger-automation__link\">${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_AUTOMATION_SETTINGS'))}</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createTriggersNode(): ?Element\n\t{\n\t\tconst documentStatus = this.debugger.getTemplate().DOCUMENT_STATUS;\n\n\t\tthis.#tracker = new Tracker(getGlobalContext().document);\n\t\tconst logs = {};\n\t\tlogs[documentStatus] = this.debugger.track;\n\t\tthis.#tracker.init(logs);\n\t\tgetGlobalContext().tracker = this.#tracker;\n\n\t\tconst triggers = this.debugger.templateTriggers;\n\t\tif (triggers.length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst node = Tag.render`\n\t\t\t<div data-role=\"triggers\" class=\"bizproc-debugger__template\">\n\t\t\t\t<div class=\"bizproc-automation-status-list-item\" data-type=\"column-trigger\">\n\t\t\t\t\t<div data-role=\"trigger-list\" class=\"bizproc-automation-trigger-list\" data-status-id=\"${documentStatus}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#triggerManager = new TriggerManager(node);\n\t\tthis.#triggerManager.init({TRIGGERS: triggers}, ViewMode.view());\n\n\t\treturn node;\n\t}\n\n\t#createTemplateNode(): Element\n\t{\n\t\tconst templateData = this.debugger.getTemplate();\n\n\t\tthis.#tracker = new Tracker(getGlobalContext().document);\n\t\tconst logs = {};\n\t\tlogs[templateData.DOCUMENT_STATUS] = this.debugger.track;\n\t\tthis.#tracker.init(logs);\n\t\tgetGlobalContext().tracker = this.#tracker;\n\n\t\tconst node = Tag.render`\n\t\t\t<div data-role=\"template\" class=\"bizproc-debugger__template\">\n\t\t\t\t<div data-role=\"automation-template\" data-status-id=\"${templateData.DOCUMENT_STATUS}\">\n\t\t\t\t\t<div data-role=\"robot-list\" class=\"bizproc-automation-robot-list\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst template = new Template({\n\t\t\tconstants: {},\n\t\t\t// globalConstants: this.component.getConstants(),\n\t\t\tvariables: {},\n\t\t\t// globalVariables: this.component.getGVariables(),\n\t\t\ttemplateContainerNode: node,\n\t\t\tdelayMinLimitM: 0,\n\t\t\t// userOptions: this.userOptions,\n\t\t});\n\n\t\ttemplate.init(templateData, ViewMode.view().intoRaw());\n\t\tthis.#updateTemplate(template);\n\n\t\treturn node;\n\t}\n\n\t#updateTemplate(newTemplate: Template): Template\n\t{\n\t\tif (!Type.isNil(this.#template))\n\t\t{\n\t\t\tthis.#template.destroy();\n\t\t}\n\t\tthis.#template = newTemplate;\n\n\t\treturn this.#template;\n\t}\n\n\t#createTemplateToolbar(): Element\n\t{\n\t\tthis.#buttonPlay = new Button({\n\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\tround: true,\n\t\t\ticon: ButtonIcon.START,\n\t\t\tonclick: this.#handleStartTemplate.bind(this)\n\t\t});\n\n\t\tconst hasEvents = this.debugger.hasWorkflowEvents();\n\n\t\tconst hasActiveDocument = this.debugger.session.isFixed();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__toolbar ${hasActiveDocument ? '' : '--disabled'}\">\n\t\t\t<div data-role=\"external-event-info\" class=\"bizproc-debugger-automation__toolbar--info-waiting ${hasEvents ? '--active' : ''}\">\n\t\t\t\t<div>\n\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_SKIP_WAITING_SUBTITLE'))}\n\t\t\t\t</div>\n\t\t\t\t<a onclick=\"${this.#handleEmulateExternalEvent.bind(this)}\" class=\"bizproc-debugger-automation__link\">\n\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_SKIP_WAITING_TITLE'))}\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-debugger-automation__toolbar--btn-block\">\n\t\t\t\t${this.#buttonPlay.render()}\n\t\t\t\t<div class=\"bizproc-debugger-automation__toolbar--btn-text\">\n\t\t\t\t\t${Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_ACTION_START')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#handleStartTemplate(button: Button)\n\t{\n\t\tbutton.setWaiting(true);\n\t\tthis.debugger.startDebugTemplate().then(() => {\n\t\t\tbutton.setWaiting(false);\n\t\t\tthis.#setDebuggerState(this.debugger.getState());\n\t\t});\n\t}\n\n\t#handleEmulateExternalEvent(event: Event)\n\t{\n\t\tconst infoNode = this.#getNode().querySelector('[data-role=\"external-event-info\"]');\n\t\tDom.removeClass(infoNode, '--active');\n\t\tthis.debugger.emulateExternalEvent();\n\t}\n\n\t#updateTracker(data: Array)\n\t{\n\t\tif (this.#tracker)\n\t\t{\n\t\t\tconst logs = {};\n\t\t\tlogs[this.debugger.getDocumentStatus()] = this.debugger.track;\n\n\t\t\tthis.#tracker.reInit(logs);\n\t\t\tthis.#template.reInit(null, ViewMode.view().intoRaw());\n\t\t}\n\t}\n\n\t#createStageNode(): Element\n\t{\n\t\tconst color = this.#getDocumentStatusColor();\n\t\tconst title = Text.encode(this.#getDocumentStatusTitle());\n\n\t\t//class --robot-change\n\t\t//onclick=\"${this.#handleShowStages.bind(this)}\"\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__status ---robot-change ${Helper.getBgColorAdditionalClass(color)}\" data-role=\"document-status\" title=\"${title}\">\n\t\t\t\t<div class=\"bizproc-debugger-automation__status--title\" data-role=\"document-status-title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-debugger-automation__status--bg\" data-role=\"document-status-bg\" style=\"background-color: ${color}; border-color: ${color};\">\n\t\t\t\t\t<span class=\"bizproc-debugger-automation__status--bg-arrow\"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#handleShowStages(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst statusList = this.debugger.getStatusList();\n\n\t\tconst menu = new Menu({\n\t\t\tbindElement: event.target,\n\t\t\titems: statusList.map((stage) => {\n\t\t\t\treturn {text: stage.NAME, statusId: stage['STATUS_ID'], onclick: this.#handleChangeStatus.bind(this)}\n\t\t\t}),\n\t\t});\n\t\tmenu.show();\n\t}\n\n\t#handleChangeStatus(event, item: MenuItem)\n\t{\n\t\titem.getMenuWindow().destroy();\n\t\tthis.debugger.setDocumentStatus(item.statusId);\n\t}\n\n\t#getDocumentStatusTitle(): string\n\t{\n\t\tconst statusId = this.debugger.getDocumentStatus();\n\t\tconst statusList = this.debugger.getStatusList();\n\n\t\tconst status = statusList.find((stage) => stage['STATUS_ID'] === statusId);\n\n\t\treturn status ? (status.NAME || status.TITLE) : '?'\n\t}\n\n\t#getDocumentStatusColor(): string\n\t{\n\t\tconst statusId = this.debugger.getDocumentStatus();\n\t\tconst statusList = this.debugger.getStatusList();\n\n\t\tconst status = statusList.find((stage) => stage['STATUS_ID'] === statusId);\n\n\t\treturn status ? status.COLOR : '#9DCF00';\n\t}\n\n\t#onDocumentStatusChanged()\n\t{\n\t\tif (!this.#getPopup().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst automationContentNode = this.#getNode().querySelector('[data-role=\"automation-content\"]');\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: automationContentNode\n\t\t});\n\n\t\tDom.addClass(automationContentNode, '--loading');\n\t\tloader.show();\n\n\t\tthis.debugger.loadMainViewInfo().then(() => {\n\t\t\tconst statusTitleNode = this.#getNode().querySelector('[data-role=\"document-status-title\"]');\n\t\t\tconst statusTitle = this.#getDocumentStatusTitle();\n\t\t\tstatusTitleNode.textContent = statusTitle;\n\t\t\tstatusTitleNode.parentNode.setAttribute('title', statusTitle);\n\n\t\t\tconst statusBgNode = this.#getNode().querySelector('[data-role=\"document-status-bg\"]');\n\t\t\tconst color = this.#getDocumentStatusColor();\n\t\t\tDom.style(statusBgNode, {\n\t\t\t\tbackgroundColor: color,\n\t\t\t\tborderColor: color,\n\t\t\t});\n\n\t\t\tconst documentStatusNode = this.#getNode().querySelector('[data-role=\"document-status\"]');\n\t\t\tDom.removeClass(documentStatusNode,['--with-border', '--light-color']);\n\t\t\tDom.addClass(documentStatusNode, Helper.getBgColorAdditionalClass(color));\n\n\t\t\tDom.remove(this.#getNode().querySelector('[data-role=\"triggers-header\"]'));\n\t\t\tDom.remove(this.#getNode().querySelector('[data-role=\"triggers\"]'));\n\n\t\t\tDom.prepend(this.#createTriggersNode(), automationContentNode);\n\t\t\tconst triggersHeaderNode = this.#createTriggersHeaderNode();\n\t\t\tif (triggersHeaderNode)\n\t\t\t{\n\t\t\t\tHelpHint.bindAll(triggersHeaderNode);\n\t\t\t\tDom.prepend(triggersHeaderNode, automationContentNode);\n\t\t\t}\n\n\t\t\tconst tplNode = this.#createTemplateNode();\n\t\t\tDom.replace(this.#node.querySelector('[data-role=\"template\"]'), tplNode);\n\n\t\t\tconst hasTriggers = this.debugger.templateTriggers.length > 0;\n\t\t\tconst hasRobots = !this.debugger.isTemplateEmpty()\n\t\t\tDom[hasTriggers || hasRobots ? 'removeClass' : 'addClass'](this.#node.querySelector('[data-role=\"no-triggers\"]'), '--active');\n\t\t\tDom[hasRobots ? 'removeClass' :'addClass'](this.#node.querySelector('[data-role=\"no-template\"]'), '--active');\n\n\t\t\tDom.removeClass(automationContentNode, '--loading');\n\t\t\tloader.destroy();\n\t\t});\n\t}\n\n\t#onWorkflowEventsChanged(event: BaseEvent)\n\t{\n\t\tif (!this.#buttonPlay)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst events = event.getData().events;\n\t\tconst infoNode = this.#getNode().querySelector('[data-role=\"external-event-info\"]');\n\t\tDom[events.length ? 'addClass' : 'removeClass'](infoNode, '--active');\n\t}\n\n\t#onWorkflowTrackAdded(event: BaseEvent)\n\t{\n\t\tthis.#updateTracker(this.debugger.track);\n\t}\n\n\t#onDocumentValuesUpdated(event: BaseEvent)\n\t{\n\t\tif (!this.#getPopup().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst values = event.getData().values;\n\t\tconst node = this.#getNode();\n\n\t\tObject.keys(values).forEach(key => {\n\t\t\tconst valueNode = node.querySelector(`[data-role=\"field-value-${key}\"]`);\n\t\t\tif (valueNode)\n\t\t\t{\n\t\t\t\tvalueNode.value = values[key] || '';\n\t\t\t}\n\t\t});\n\t}\n\n\t#onWorkflowStatusChange(event: BaseEvent)\n\t{\n\t\tconst status = event.getData().status;\n\t\tconst workflowId = event.getData().workflowId;\n\n\t\tif ([WorkflowStatus.COMPLETED, WorkflowStatus.TERMINATED].includes(status))\n\t\t{\n\t\t\tthis.debugger.track.forEach((track) => {\n\t\t\t\tif (track['WORKFLOW_ID'] === workflowId)\n\t\t\t\t{\n\t\t\t\t\ttrack['WORKFLOW_STATUS'] = WorkflowStatus.COMPLETED;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.#updateTracker(this.debugger.track);\n\t\t}\n\t}\n\n\t#onAfterDocumentFixed()\n\t{\n\t\tconst popupContainer = this.#getPopup().getPopupContainer();\n\n\t\tDom.removeClass(\n\t\t\tpopupContainer.getElementsByClassName('bizproc-debugger-automation__main-fields')[0],\n\t\t\t'--disabled'\n\t\t);\n\n\t\tDom.removeClass(\n\t\t\tpopupContainer.getElementsByClassName('bizproc-debugger-automation__toolbar')[0],\n\t\t\t'--disabled'\n\t\t);\n\n\t\tconst activeTab = this.debugger.settings.get('tab') === 'log' ? 'log' : 'doc';\n\t\tpopupContainer.querySelectorAll([`[data-tab-item=\"no-document\"]`]).forEach(\n\t\t\t(tab) => Dom.removeClass(tab, ['--empty', '--active'])\n\t\t);\n\t\tpopupContainer.querySelectorAll([`[data-tab-item=\"${activeTab}\"]`]).forEach(\n\t\t\t(tab) => Dom.addClass(tab, '--active')\n\t\t);\n\n\t\tthis.#onDocumentStatusChanged();\n\t}\n\n\t#setDebuggerState(state: number)\n\t{\n\t\tif (!this.#buttonPlay)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (state)\n\t\t{\n\t\t\tcase DebuggerState.Run:\n\t\t\t\tthis.#buttonPlay.setIcon(ButtonIcon.PAUSE);\n\t\t\t\tthis.#buttonPlay.getContainer()\n\t\t\t\t\t.nextElementSibling.textContent = Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_ACTION_PAUSE');\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthis.#buttonPlay.setIcon(ButtonIcon.START);\n\t\t\t\tthis.#buttonPlay.getContainer()\n\t\t\t\t\t.nextElementSibling.textContent = Loc.getMessage('BIZPROC_DEBUGGER_AUTOMATION_ACTION_START');\n\n\t\t}\n\t}\n}","export class Mode\n{\n\tstatic experimental: ModeOptions = {\n\t\tid: 0,\n\t\tcode: 'experimental',\n\t};\n\n\tstatic interception: ModeOptions = {\n\t\tid: 1,\n\t\tcode: 'interception',\n\t};\n\n\tstatic isMode(modeId: number): boolean\n\t{\n\t\treturn [0, 1].includes(modeId);\n\t}\n\n\tstatic getMode(modeId: number): ModeOptions | null\n\t{\n\t\tif (modeId === 0)\n\t\t{\n\t\t\treturn Mode.experimental;\n\t\t}\n\t\telse if (modeId === 1)\n\t\t{\n\t\t\treturn Mode.interception;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tstatic getAllModes(): object<number, ModeOptions>\n\t{\n\t\treturn {\n\t\t\t0: Mode.experimental,\n\t\t\t1: Mode.interception\n\t\t};\n\t}\n}\n\nexport type ModeOptions = {\n\tid: number,\n\tcode: string,\n}","import {Type, Text} from 'main.core';\nimport {DocumentOptions} from './document-options';\nimport {Helper} from '../helper';\n\nexport class Document\n{\n\t#id: number;\n\t#sessionId: string;\n\t#documentId: string;\n\t#categoryId: number;\n\t#dateExpire: Date;\n\n\t#documentSigned: string = '';\n\n\tconstructor(options: DocumentOptions)\n\t{\n\t\tthis.#id = parseInt(options.Id) >= 0 ? parseInt(options.Id) : 0;\n\t\tthis.#sessionId = Type.isStringFilled(options.SessionId) ? options.SessionId : '';\n\t\tthis.#documentId = Type.isStringFilled(options.DocumentId) ? options.DocumentId : '';\n\t\tthis.#categoryId = Text.toInteger(options.DocumentCategoryId);\n\t\tthis.#dateExpire = Helper.toDate(options.DateExpire);\n\t\tif (options.DocumentSigned)\n\t\t{\n\t\t\tthis.documentSigned = options.DocumentSigned;\n\t\t}\n\t}\n\n\tget documentId(): string\n\t{\n\t\treturn this.#documentId;\n\t}\n\n\tget categoryId(): number\n\t{\n\t\treturn this.#categoryId;\n\t}\n\n\tset categoryId(categoryId: number)\n\t{\n\t\tthis.#categoryId = Type.isNumber(categoryId) ? categoryId : 0;\n\t}\n\n\tget documentSigned(): string\n\t{\n\t\treturn this.#documentSigned;\n\t}\n\n\tset documentSigned(documentSigned: string)\n\t{\n\t\tthis.#documentSigned = Type.isStringFilled(documentSigned) ? documentSigned : '';\n\t}\n}","import {Type, Text, ajax} from 'main.core';\nimport {SessionOptions} from './session-options';\nimport {Mode, ModeOptions} from './mode';\nimport {Document} from './document';\nimport {Helper} from '../helper';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {Manager} from \"bizproc.debugger\";\n\nexport default class Session extends EventEmitter\n{\n\t#id: string = '';\n\t#mode: ModeOptions = {};\n\t#startedBy: number = 0;\n\t#active: boolean;\n\t#fixed: boolean;\n\t#documents: Array<Document> = [];\n\t#shortDescription: string = '';\n\t#categoryId: number = 0;\n\n\t#documentSigned: string = '';\n\n\t#finished: boolean = false;\n\t#pullFinishHandler: Function;\n\t#pullDocumentValuesHandler: Function;\n\n\tconstructor(options: SessionOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Debugger.Session');\n\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tthis.#id = options.Id;\n\t\tthis.#setMode(options.Mode);\n\t\tthis.#startedBy = parseInt(options.StartedBy) >= 0 ? parseInt(options.StartedBy) : 0;\n\t\tthis.#shortDescription = String(options.ShortDescription);\n\t\tthis.#active = Boolean(options.Active);\n\t\tthis.#fixed = Boolean(options.Fixed);\n\t\tthis.#categoryId = Text.toInteger(options.CategoryId);\n\n\t\tthis.#setDocuments(options.Documents);\n\n\t\tif (this.isActive())\n\t\t{\n\t\t\tthis.#pullFinishHandler = this.#handleExternalFinished.bind(this);\n\t\t\tManager.Instance.pullHandler.subscribe('sessionFinish', this.#pullFinishHandler);\n\n\t\t\tthis.#pullDocumentValuesHandler = this.#handleExternalDocumentValues.bind(this);\n\t\t\tManager.Instance.pullHandler.subscribe('documentValues', this.#pullDocumentValuesHandler);\n\t\t}\n\t}\n\n\tset documentSigned(documentSigned: string)\n\t{\n\t\tif (this.isFixed() && this.activeDocument)\n\t\t{\n\t\t\tthis.activeDocument.documentSigned = documentSigned;\n\t\t}\n\n\t\tthis.#documentSigned = documentSigned;\n\t}\n\n\tget documentSigned(): string\n\t{\n\t\tif (this.activeDocument)\n\t\t{\n\t\t\tconst documentSigned = this.activeDocument.documentSigned;\n\t\t\tif (Type.isStringFilled(documentSigned))\n\t\t\t{\n\t\t\t\treturn documentSigned;\n\t\t\t}\n\t\t}\n\n\t\treturn this.#documentSigned;\n\t}\n\n\t#setMode(modeId: string | number)\n\t{\n\t\tmodeId = Helper.isNumeric(modeId) ? Number(modeId) : null;\n\n\t\tif (Mode.isMode(modeId))\n\t\t{\n\t\t\tthis.#mode = Mode.getMode(modeId);\n\t\t}\n\t}\n\n\t#setDocuments(documents: Array): this\n\t{\n\t\tif (Type.isArrayFilled(documents))\n\t\t{\n\t\t\tdocuments.forEach((document) => {\n\t\t\t\tthis.#documents.push(\n\t\t\t\t\tnew Document(document)\n\t\t\t\t);\n\t\t\t})\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget id(): string\n\t{\n\t\treturn this.#id;\n\t}\n\n\tget startedBy(): number\n\t{\n\t\treturn this.#startedBy;\n\t}\n\n\tget activeDocument(): ?Document\n\t{\n\t\tif (this.#documents.length === 1)\n\t\t{\n\t\t\treturn this.#documents[0];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tget modeId(): number\n\t{\n\t\treturn this.#mode.id;\n\t}\n\n\tget shortDescription(): string\n\t{\n\t\treturn this.#shortDescription;\n\t}\n\n\tget initialCategoryId(): number\n\t{\n\t\treturn this.#categoryId;\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn this.#active;\n\t}\n\n\tisFixed(): boolean\n\t{\n\t\treturn this.#fixed;\n\t}\n\n\tisSessionStartedByUser(userId: number): boolean\n\t{\n\t\treturn this.startedBy === userId;\n\t}\n\n\tisAutomation(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tisInterceptionMode(): boolean\n\t{\n\t\treturn this.modeId === Mode.interception.id;\n\t}\n\n\tisExperimentalMode(): boolean\n\t{\n\t\treturn this.modeId === Mode.experimental.id;\n\t}\n\n\tstatic start(documentSigned: string, modeId: number): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bizproc.debugger.startSession',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdocumentSigned,\n\t\t\t\t\t\tmode: modeId,\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\tautomation_select_debug_mode: 'Y',\n\t\t\t\t\t\tmode_type: Mode.getMode(modeId).code,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(response) => {\n\t\t\t\t\tconst session = new Session(response.data.session);\n\t\t\t\t\tsession.documentSigned = response.data.documentSigned;\n\n\t\t\t\t\tresolve(session);\n\t\t\t\t},\n\t\t\t\treject\n\t\t\t)\n\t\t});\n\t}\n\n\tfinish(): Promise\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'bizproc.debugger.finishDebugSession',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: this.id,\n\t\t\t\t}\n\t\t\t}\n\t\t).then(response => {\n\t\t\tthis.#handleFinish();\n\n\t\t\treturn response;\n\t\t});\n\t}\n\n\tfixateDocument(id: number): Promise\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'bizproc.debugger.fixateSessionDocument',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tdocumentId: id\n\t\t\t\t}\n\t\t\t}\n\t\t).then(response => {\n\t\t\tthis.documentSigned = response.data.documentSigned;\n\t\t\tthis.#updateSession(response.data.session);\n\n\t\t\tthis.emit('onAfterDocumentFixed');\n\n\t\t\treturn response;\n\t\t});\n\t}\n\n\tremoveDocuments(ids: Array = []): Promise\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'bizproc.debugger.removeSessionDocument',\n\t\t\t{\n\t\t\t\tdata:{\n\t\t\t\t\tdocumentIds: ids,\n\t\t\t\t}\n\t\t\t}\n\t\t).then(response => {\n\t\t\tthis.#updateSession(response.data.session);\n\n\t\t\treturn response;\n\t\t});\n\t}\n\n\t#handleExternalFinished(event: BaseEvent)\n\t{\n\t\tconst sessionId: string = event.getData().sessionId;\n\t\tif (sessionId === this.id)\n\t\t{\n\t\t\tthis.#handleFinish();\n\t\t}\n\t}\n\n\t#handleExternalDocumentValues(event: BaseEvent)\n\t{\n\t\tif (!this.activeDocument)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst values: {} = event.getData().rawValues;\n\t\tconst categoryId = values['CATEGORY_ID'];\n\n\t\tif (categoryId)\n\t\t{\n\t\t\tthis.activeDocument.categoryId = Text.toInteger(categoryId);\n\n\t\t\t//TODO: refactoring candidate\n\t\t\tManager.Instance.requireSetFilter(this);\n\t\t}\n\t}\n\n\t#handleFinish()\n\t{\n\t\tif (!this.#finished)\n\t\t{\n\t\t\tthis.#finished = true;\n\t\t\tthis.emit('onFinished');\n\t\t\tthis.unsubscribeAll();\n\t\t\tif (this.#pullFinishHandler)\n\t\t\t{\n\t\t\t\tManager.Instance.pullHandler.unsubscribe('sessionFinish', this.#pullFinishHandler);\n\t\t\t\tthis.#pullFinishHandler = null;\n\t\t\t}\n\t\t\tif (this.#pullDocumentValuesHandler)\n\t\t\t{\n\t\t\t\tManager.Instance.pullHandler.unsubscribe('documentValues', this.#pullDocumentValuesHandler);\n\t\t\t\tthis.#pullDocumentValuesHandler = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t#updateSession(options ={})\n\t{\n\t\tif (Object.keys(options).length <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#active = Boolean(options.Active);\n\t\tthis.#fixed = Boolean(options.Fixed);\n\t\tthis.#categoryId = Text.toInteger(options.CategoryId);\n\n\t\tthis.#setDocuments(options.Documents);\n\t}\n}","import {Loc, Tag, Text, Type, Dom} from 'main.core';\nimport {DelayInterval, DelayIntervalSelector, TrackingEntry} from \"bizproc.automation\";\nimport AutomationLogView from \"../views/automation-log\";\nimport {Helper} from \"../helper\";\n\nexport type RobotInfo = {\n\tname: string,\n\ttitle: string,\n\tdelayName: string | null;\n\tconditionNames: Array<string>\n};\n\nexport default class RobotLog\n{\n\t#robot: RobotInfo;\n\t#view: AutomationLogView;\n\n\t#currentNode: HTMLDivElement = null;\n\t#currentIndex: number = null;\n\n\t#isAfterPreviousRendered: boolean = false;\n\t#isPauseRendered: boolean = false;\n\t#isActivityBodyRendered: boolean = false;\n\n\t#prevRobotTitle: string = null;\n\n\tconstructor(view: AutomationLogView, robotInfo: RobotInfo)\n\t{\n\t\tthis.#view = view;\n\t\tthis.#robot = robotInfo;\n\t}\n\n\tget name(): string\n\t{\n\t\treturn this.#robot.name;\n\t}\n\n\tget title(): string\n\t{\n\t\treturn this.#robot.title;\n\t}\n\n\tget delayName(): string | null\n\t{\n\t\treturn this.#robot.delayName;\n\t}\n\n\tget conditionNames(): Array<string>\n\t{\n\t\treturn this.#robot.conditionNames;\n\t}\n\n\tgetActivitiesName(): Array<string>\n\t{\n\t\tlet names = [];\n\n\t\tif (this.name)\n\t\t{\n\t\t\tnames.push(this.name);\n\t\t}\n\n\t\tif (this.delayName)\n\t\t{\n\t\t\tnames.push(this.delayName);\n\t\t}\n\n\t\tnames = names.concat(this.conditionNames);\n\n\t\treturn names;\n\t}\n\n\tset previousRobotTitle(title: string)\n\t{\n\t\tthis.#prevRobotTitle = title;\n\t}\n\n\trenderTrack(track: TrackingEntry): void\n\t{\n\t\tconst excludedTypes = [TrackingEntry.EXECUTE_ACTIVITY_TYPE, TrackingEntry.ATTACHED_ENTITY_TYPE];\n\t\tif (excludedTypes.includes(track.type))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (track.name === this.delayName)\n\t\t{\n\t\t\treturn this.#renderPause(track);\n\t\t}\n\n\t\tif (this.conditionNames.includes(track.name))\n\t\t{\n\t\t\tif (this.#isPauseRendered === false)\n\t\t\t{\n\t\t\t\tconst node = this.#getCurrentRobotNode(track);\n\t\t\t\tDom.append(this.#renderDelayInterval(new DelayInterval()), node);\n\t\t\t\tthis.#isPauseRendered = true;\n\t\t\t}\n\n\t\t\treturn this.#renderCondition(track);\n\t\t}\n\n\t\tif (track.name === this.name)\n\t\t{\n\t\t\tif (this.#isPauseRendered === false)\n\t\t\t{\n\t\t\t\tconst node = this.#getCurrentRobotNode(track);\n\t\t\t\tDom.append(this.#renderDelayInterval(new DelayInterval()), node);\n\t\t\t\tthis.#isPauseRendered = true;\n\t\t\t}\n\n\t\t\treturn this.#renderActivity(track);\n\t\t}\n\t}\n\n\t#getCurrentRobotNode(track: TrackingEntry): HTMLDivElement\n\t{\n\t\tif (this.#view.index !== this.#currentIndex)\n\t\t{\n\t\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-section\">\n\t\t\t\t\t${this.#renderRobotTitle(track.datetime)}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (Type.isStringFilled(this.#prevRobotTitle) && this.#isAfterPreviousRendered === false)\n\t\t\t{\n\t\t\t\tDom.append(this.#renderAfterPrevious(), node);\n\t\t\t}\n\n\t\t\tDom.append(node, this.#view.logNode);\n\n\t\t\tthis.#currentNode = node;\n\t\t}\n\n\t\treturn this.#currentNode;\n\t}\n\n\t#renderRobotTitle(time: string): HTMLDivElement\n\t{\n\t\tconst message = Loc.getMessage(\n\t\t\t'BIZPROC_JS_DEBUGGER_LOG_TITLE',\n\t\t\t{'#TITLE#' : this.title}\n\t\t);\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t${AutomationLogView.renderTime(time)}\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-section--title\">${Text.encode(message)}</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#currentIndex = this.#view.index;\n\n\t\treturn node;\n\t}\n\n\t#renderAfterPrevious(): HTMLDivElement\n\t{\n\t\tthis.#isAfterPreviousRendered = true;\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-info\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--name\">\n\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-info--name-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_AFTER_PREVIOUS')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>:</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value\">\n\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-color-box --blue\">\n\t\t\t\t\t\t\t\"${Text.encode(this.#prevRobotTitle)}\"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#currentIndex = this.#view.index;\n\n\t\treturn node;\n\t}\n\n\t// region Pause\n\t#renderPause(track: TrackingEntry): void\n\t{\n\t\tthis.#isPauseRendered = true;\n\n\t\tconst excludedTypes = [TrackingEntry.CLOSE_ACTIVITY_TYPE];\n\n\t\t// ignore\n\t\tif (excludedTypes.includes(track.type))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// delay Interval\n\t\tif (track.type === TrackingEntry.DEBUG_AUTOMATION_TYPE)\n\t\t{\n\t\t\tconst node = this.#getCurrentRobotNode(track);\n\t\t\tconst note = JSON.parse(track.note);\n\n\t\t\treturn Dom.append(this.#renderDelayInterval(note), node);\n\t\t}\n\n\t\tconst node = this.#getCurrentRobotNode(track);\n\n\t\treturn Dom.append(this.#renderNote(track), node);\n\t}\n\n\t#renderDelayInterval(note ={}): HTMLDivElement\n\t{\n\t\tconst delayInterval = new DelayInterval(note);\n\t\tlet name = note.fieldName ?? (new DelayIntervalSelector()).getBasisField(delayInterval.basis, true).Name;\n\t\tname = name + ' [' + note.fieldValue + ']';\n\n\t\tconst delay = delayInterval.format(\n\t\t\tLoc.getMessage('BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_AT_ONCE'),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tSystemExpression: delayInterval.basis,\n\t\t\t\t\tName: name\n\t\t\t\t}\n\t\t\t]\n\t\t);\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-info\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--name\">\n\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-info--name-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_DELAY_INTERVAL_RUN')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>:</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value\">\n\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-color-box --dark-blue\">\n\t\t\t\t\t\t\t${Text.encode(delay)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#currentIndex = this.#view.index;\n\n\t\treturn node;\n\t}\n\t// endregion\n\n\t// region Condition\n\t#renderCondition(track: TrackingEntry): void\n\t{\n\t\tconst excludedTypes = [TrackingEntry.CLOSE_ACTIVITY_TYPE];\n\n\t\t// ignore\n\t\tif (excludedTypes.includes(track.type))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (track.type === TrackingEntry.DEBUG_AUTOMATION_TYPE)\n\t\t{\n\t\t\tconst node = this.#getCurrentRobotNode(track);\n\n\t\t\treturn Dom.append(this.#renderConditions(track), node);\n\t\t}\n\n\t\tconst node = this.#getCurrentRobotNode(track);\n\n\t\treturn Dom.append(this.#renderNote(track), node);\n\t}\n\n\t#renderConditions(track: TrackingEntry): HTMLDivElement\n\t{\n\t\tconst note = JSON.parse(track.note);\n\n\t\tconst conditionNode = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-info\">\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--name\">\n\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-info--name-text\">\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\tnote.result === 'Y'\n\t\t\t\t\t\t\t\t? Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION')\n\t\t\t\t\t\t\t\t: Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION_FALSE')\n\t\t\t\t\t\t}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>:</span> \n\t\t\t\t</div> \n\t\t\t</div>\n\t\t`;\n\n\t\tObject.keys(note).forEach((key) => {\n\t\t\tif (key === 'result')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet colorCondition = '';\n\t\t\tif (note.result === note[key]['result'])\n\t\t\t{\n\t\t\t\tcolorCondition =\n\t\t\t\t\t(note.result === 'Y')\n\t\t\t\t\t\t? 'bizproc-debugger-automation__log-color-box --green'\n\t\t\t\t\t\t: 'bizproc-debugger-automation__log-color-box --orange'\n\t\t\t\t;\n\t\t\t}\n\n\t\t\tconst condition = note[key]['condition'];\n\t\t\tconst field = condition['field'];\n\t\t\tconst fieldValue =\n\t\t\t\t(note[key]['fieldValue'])\n\t\t\t\t\t? String(note[key]['fieldValue'])\n\t\t\t\t\t: ''\n\t\t\t;\n\t\t\tconst operator = Helper.getOperatorLabel(condition['operator']);\n\t\t\tconst value = condition['value'];\n\t\t\tconst joiner = Helper.getJoinerLabel(note[key]['joiner']);\n\n\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value\">\n\t\t\t\t\t\t<span class=\"${colorCondition}\" >\n\t\t\t\t\t\t\t${(key === '0') ? '' : Text.encode(joiner) + ' '}\n\t\t\t\t\t\t\t${Text.encode(field) + ' '}\n\t\t\t\t\t\t\t${'[' + Text.encode(fieldValue) + '] '} \n\t\t\t\t\t\t\t${Text.encode(operator) + ' '} \n\t\t\t\t\t\t\t${Text.encode(value)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tconditionNode\n\t\t\t);\n\t\t});\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t${conditionNode}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#currentIndex = this.#view.index;\n\n\t\treturn node;\n\t}\n\t// endregion\n\n\t// region Activity\n\t#renderActivity(track: TrackingEntry): void\n\t{\n\t\tif (track.type === TrackingEntry.CLOSE_ACTIVITY_TYPE)\n\t\t{\n\t\t\tif (this.#isActivityBodyRendered === false)\n\t\t\t{\n\t\t\t\tconst node = this.#getCurrentRobotNode(track);\n\n\t\t\t\treturn Dom.append(this.#renderActivityFinish(), node);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// fields\n\t\tthis.#isActivityBodyRendered = true;\n\t\tconst node = this.#getCurrentRobotNode(track);\n\n\t\tconst renderedNote = this.#renderNote(track);\n\n\t\tDom.append(renderedNote, node);\n\n\t\tthis.#view.collapseInfoResults(renderedNote);\n\t}\n\n\t#renderActivityFinish(): HTMLDivElement\n\t{\n\t\t// tracking-track-2\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t<div class=\"bizproc-debugger-automation-log-section-robot-activity\">\n\t\t\t\t\t${Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_FINISH_WITHOUT_SETTINGS')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\t// endregion\n\n\t#renderNote(track: TrackingEntry): HTMLDivElement\n\t{\n\t\tif ([TrackingEntry.DEBUG_AUTOMATION_TYPE, TrackingEntry.DEBUG_ACTIVITY_TYPE].includes(track.type))\n\t\t{\n\t\t\treturn this.#renderDebugNote(track);\n\t\t}\n\n\t\tif ([TrackingEntry.DEBUG_LINK_TYPE].includes(track.type))\n\t\t{\n\t\t\treturn this.#renderDebugLink(track);\n\t\t}\n\n\t\tconst colorBox =\n\t\t\t[TrackingEntry.CANCEL_ACTIVITY_TYPE, TrackingEntry.FAULT_ACTIVITY_TYPE, TrackingEntry.ERROR_ACTIVITY_TYPE].includes(track.type)\n\t\t\t\t? 'bizproc-debugger-automation__log-color-box --red'\n\t\t\t\t: ''\n\t\t;\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value --first\">\n\t\t\t\t\t<span class=\"${colorBox}\">\n\t\t\t\t\t\t${Text.encode(track.note).replace(/([^>])\\n/g, '$1<br>')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#currentIndex = this.#view.index;\n\n\t\treturn node;\n\t}\n\n\t#renderDebugNote(track: TrackingEntry): HTMLDivElement\n\t{\n\t\tconst note = JSON.parse(track.note);\n\n\t\tconst infoNode = Tag.render`<div class=\"bizproc-debugger-automation__log-info\"></div>`;\n\n\t\tif (note['propertyName'])\n\t\t{\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--name\">\n\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-info--name-text\" title=\"${Text.encode(note['propertyName'])}\">\n\t\t\t\t\t\t\t${Text.encode(note['propertyName'])}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>:</span>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tinfoNode\n\t\t\t);\n\t\t}\n\n\t\tDom.append(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value ${note['propertyName'] ? '' : '--first'}\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log--variable-height\" data-role=\"info-result\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t${note['propertyValue'] ? Text.encode(note['propertyValue']).replace(/([^>])\\n/g, '$1<br>') : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-role=\"more-info-result\" style=\"display:none;\">\n\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-info--more\">\n\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_MORE_INFORMATION'))}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tinfoNode\n\t\t);\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t${infoNode}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#currentIndex = this.#view.index;\n\n\t\treturn node;\n\t}\n\n\t#renderDebugLink(track: TrackingEntry): HTMLDivElement\n\t{\n\t\tconst note = JSON.parse(track.note);\n\t\tconst infoNode = Tag.render`<div class=\"bizproc-debugger-automation__log-info\"></div>`;\n\t\tconst label = note['propertyLinkName'] || note['propertyValue'];\n\t\tconst link = note['propertyValue'];\n\n\t\tif (note['propertyName'])\n\t\t{\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--name\">\n\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-info--name-text\" title=\"${Text.encode(note['propertyName'])}\">\n\t\t\t\t\t\t\t${Text.encode(note['propertyName'])}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>:</span>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tinfoNode\n\t\t\t);\n\t\t}\n\n\t\tDom.append(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value ${note['propertyName'] ? '' : '--first'}\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log--variable-height\" data-role=\"info-result\">\n\t\t\t\t\t\t<a href=\"${Text.encode(link)}\" target=\"_blank\">\n\t\t\t\t\t\t\t${label}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tinfoNode\n\t\t);\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t${infoNode}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#currentIndex = this.#view.index;\n\n\t\treturn node;\n\t}\n}","import AutomationLogView from \"../views/automation-log\";\nimport {TrackingEntry} from \"bizproc.automation\";\nimport {Dom, Loc, Tag, Text} from 'main.core';\nimport {Helper} from \"../helper\";\n\nexport default class TriggerLog\n{\n\t#view: AutomationLogView;\n\n\t#condition: {} = {};\n\t#title: string = '';\n\t#track: TrackingEntry = null;\n\n\tconstructor(view: AutomationLogView)\n\t{\n\t\tthis.#view = view;\n\t}\n\n\taddTrack(track: TrackingEntry): TriggerLog\n\t{\n\t\tif (track.type === TrackingEntry.DEBUG_AUTOMATION_TYPE && track.name === 'TRIGGER_LOG')\n\t\t{\n\t\t\tthis.#condition = JSON.parse(track.note);\n\t\t\tthis.#title = track.title;\n\t\t\tthis.#track = track;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trender()\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section\">\n\t\t\t\t${this.#renderTitle()}\n\t\t\t\t${this.#renderCondition()}\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value --first\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_TRIGGER_FINISH'))}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(node, this.#view.logNode);\n\t}\n\n\t#renderTitle(): HTMLDivElement | string\n\t{\n\t\tconst message = Loc.getMessage(\n\t\t\t'BIZPROC_JS_DEBUGGER_LOG_TRIGGER_TITLE',\n\t\t\t{'#TITLE#' : this.#title}\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t${AutomationLogView.renderTime(this.#track.datetime)}\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-section--title\">${Text.encode(message)}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderCondition(): HTMLDivElement | string\n\t{\n\t\tif (!this.#condition || Object.keys(this.#condition).length <= 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst note = this.#condition;\n\n\t\tconst conditionNode = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-info\">\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--name\">\n\t\t\t\t\t<span class=\"bizproc-debugger-automation__log-info--name-text\">\n\t\t\t\t\t\t${Loc.getMessage('BIZPROC_JS_DEBUGGER_LOG_CONDITION')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>:</span> \n\t\t\t\t</div> \n\t\t\t</div>\n\t\t`;\n\n\t\tObject.keys(note).forEach((key) => {\n\t\t\tconst colorCondition = (note[key]['result'] === 'Y') ? 'bizproc-debugger-automation__log-color-box --green' : '';\n\n\t\t\tconst condition = note[key]['condition'];\n\t\t\t//const object = Helper.getFieldObjectLabel(condition['object']);\n\t\t\tconst field = condition['field'];\n\t\t\tconst fieldValue =\n\t\t\t\t(note[key]['fieldValue'])\n\t\t\t\t\t? String(note[key]['fieldValue'])\n\t\t\t\t\t: ''\n\t\t\t;\n\t\t\tconst operator = Helper.getOperatorLabel(condition['operator']);\n\t\t\tconst value = condition['value'];\n\t\t\tconst joiner = Helper.getJoinerLabel(note[key]['joiner']);\n\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-info--value\">\n\t\t\t\t\t\t<span class=\"${colorCondition}\" >\n\t\t\t\t\t\t\t${(key === '0') ? '' : (Text.encode(joiner) + ' ')}\n\t\t\t\t\t\t\t${Text.encode(field) + ' '}\n\t\t\t\t\t\t\t${'[' + Text.encode(fieldValue) + '] '}\n\t\t\t\t\t\t\t${Text.encode(operator) + ' '}\n\t\t\t\t\t\t\t${Text.encode(value)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tconditionNode\n\t\t\t);\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t${this.#view.renderIndex()}\n\t\t\t\t${conditionNode}\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {Tag, Text, Type, Dom, Event, Loc} from 'main.core';\nimport RobotLog from \"../tracker/robot-log\";\nimport Automation from \"../automation\";\nimport {Robot, TrackingEntry, TrackingEntryBuilder, ViewMode} from 'bizproc.automation';\nimport {Helper} from \"../helper\";\nimport {BaseEvent} from \"main.core.events\";\nimport TriggerLog from \"../tracker/trigger-log\";\nimport 'ui.fonts.robotomono';\n\nexport default class AutomationLogView\n{\n\t#debuggerInstance: Automation = null;\n\t#workflowId: string;\n\n\t#activityRenderer = {};\n\n\t#documentStatus: string = '';\n\t#categoryName: string = '';\n\t#statusSettings: object;\n\n\t#node: HTMLDivElement = null;\n\t#index: number = 0;\n\t#trackId: number = 0;\n\n\t#poolTrack: Array<TrackingEntry> = [];\n\t#poolWorkflowRobots: object = {};\n\t#isRendering: boolean = true;\n\n\tstatic #NUMBER_OF_LINES_TO_SHOW_IN_PIXELS: number = 50; // 3 lines\n\t#shouldScrollToBottom: boolean = false;\n\t#shouldLoadPreviousLog: boolean = false;\n\n\t#onTrackAddedHandler: Function;\n\t#onChangeTabHandler: Function;\n\t#onSessionFinishedHandler: Function;\n\t#autoScrollHandler: Function;\n\t#scrollAnimationId;\n\n\tconstructor(debuggerInstance: Automation)\n\t{\n\t\tthis.#debuggerInstance = debuggerInstance;\n\t\tthis.#workflowId = this.debugger.workflowId;\n\n\t\tconst template = this.debugger.getTemplate();\n\t\tthis.initializeWorkflowRobotsRenderer(template ? template['ROBOTS'] : []);\n\n\t\tif (this.debugger.session.isActive())\n\t\t{\n\t\t\tthis.#onTrackAddedHandler = this.onTrackAdded.bind(this);\n\t\t\tthis.debugger.subscribe('onWorkflowTrackAdded', this.#onTrackAddedHandler);\n\n\t\t\tthis.#onChangeTabHandler = this.#onChangeTab.bind(this);\n\t\t\tthis.debugger.getMainView().subscribe('onChangeTab', this.#onChangeTabHandler);\n\n\t\t\tthis.#onSessionFinishedHandler = this.#onSessionFinished.bind(this);\n\t\t\tthis.debugger.session.subscribeOnce('onFinished', this.#onSessionFinishedHandler);\n\t\t}\n\t}\n\n\tget debugger(): Automation | null\n\t{\n\t\treturn this.#debuggerInstance;\n\t}\n\n\tget index(): number\n\t{\n\t\treturn this.#index;\n\t}\n\n\tget logNode(): HTMLDivElement | null\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\tthis.#node = Tag.render`<div data-role=\"log\" class=\"bizproc-debugger-tab__log\"></div>`;\n\t\t}\n\n\t\treturn this.#node;\n\t}\n\n\tinitializeWorkflowRobotsRenderer(workflowRobots: Array = [], workflowId: string = null)\n\t{\n\t\tif (!workflowId && ! this.#workflowId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(this.#activityRenderer[workflowId ?? this.#workflowId]))\n\t\t{\n\t\t\tthis.#activityRenderer[workflowId ?? this.#workflowId] = {};\n\t\t}\n\n\t\tif (Type.isArrayFilled(workflowRobots))\n\t\t{\n\t\t\tlet prevRobotTitle = null;\n\n\t\t\tfor (let i = 0; i < workflowRobots.length; ++i)\n\t\t\t{\n\t\t\t\tconst robot = new Robot({});\n\t\t\t\trobot.init(workflowRobots[i], ViewMode.none());\n\n\t\t\t\tconst conditionNames = [];\n\t\t\t\tif (Type.isPlainObject(robot.data.Condition))\n\t\t\t\t{\n\t\t\t\t\tconditionNames.push(robot.data.Condition['activityNames']['Activity']);\n\t\t\t\t\tconditionNames.push(robot.data.Condition['activityNames']['Branch1']);\n\t\t\t\t\tconditionNames.push(robot.data.Condition['activityNames']['Branch2']);\n\t\t\t\t}\n\n\t\t\t\tconst robotLogger = new RobotLog(this, {\n\t\t\t\t\tname: robot.getId(),\n\t\t\t\t\ttitle: robot.getTitle(),\n\t\t\t\t\tdelayName: robot.data.DelayName ?? null,\n\t\t\t\t\tconditionNames: conditionNames\n\t\t\t\t});\n\n\t\t\t\tif (robot.isExecuteAfterPrevious() && prevRobotTitle)\n\t\t\t\t{\n\t\t\t\t\trobotLogger.previousRobotTitle = prevRobotTitle;\n\t\t\t\t}\n\n\t\t\t\tprevRobotTitle = robot.getTitle();\n\n\t\t\t\trobotLogger.getActivitiesName().forEach((activityName) => {\n\t\t\t\t\tthis.#activityRenderer[workflowId ?? this.#workflowId][activityName] = robotLogger;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t// region LOAD LOG\n\n\tshouldLoadPreviousLog(should: boolean): this\n\t{\n\t\tthis.#shouldLoadPreviousLog = should;\n\n\t\treturn this;\n\t}\n\n\t#loadPreviousLog(): Promise<this>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.debugger.loadAllLog()\n\t\t\t\t.then(\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tthis.#onAfterGetLog(data);\n\n\t\t\t\t\t\tresolve(this)\n\t\t\t\t\t},\n\t\t\t\t\t() => {resolve(this)}\n\t\t\t\t)\n\t\t\t;\n\t\t});\n\t}\n\n\t#loadWorkflowRobotsByWorkflowId(track)\n\t{\n\t\tthis.debugger.loadRobotsByWorkflowId(track.workflowId)\n\t\t\t.then(\n\t\t\t\t(data) => {\n\t\t\t\t\tthis.#poolWorkflowRobots[track.workflowId] = data.workflowRobots;\n\t\t\t\t\tthis.initializeWorkflowRobotsRenderer(this.#poolWorkflowRobots[track.workflowId], track.workflowId);\n\t\t\t\t\tthis.startRendering();\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tthis.#poolWorkflowRobots[track.workflowId] = [];\n\t\t\t\t\tconsole.info('session has no workflowId from track:', track);\n\t\t\t\t\tthis.startRendering();\n\t\t\t\t}\n\t\t\t)\n\t\t;\n\t}\n\n\tsetPreviousLog(data = {logs: [], workflowRobots: {}}): this\n\t{\n\t\tthis.#onAfterGetLog(data);\n\n\t\treturn this;\n\t}\n\n\t#onAfterGetLog(data)\n\t{\n\t\tconst logFromDB = [];\n\t\tconst builder = new TrackingEntryBuilder();\n\n\t\tif (Type.isArrayFilled(data['logs']))\n\t\t{\n\t\t\tdata['logs'].forEach((item) => {\n\t\t\t\tlogFromDB.push(builder.setLogEntry(item).build());\n\t\t\t});\n\t\t}\n\n\t\tthis.#poolTrack = logFromDB.concat(this.#poolTrack);\n\t\tthis.#poolWorkflowRobots = Object.assign(data['workflowRobots'], this.#poolWorkflowRobots);\n\t}\n\n\t// endregion\n\n\t// region RENDER LOG\n\n\trender(): HTMLDivElement\n\t{\n\t\tif (this.logNode.children.length <= 0)\n\t\t{\n\t\t\tthis.#isRendering = true;\n\n\t\t\tif (this.#shouldLoadPreviousLog)\n\t\t\t{\n\t\t\t\tthis.#loadPreviousLog().then(() => {\n\t\t\t\t\tthis.startRendering();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.startRendering();\n\t\t\t}\n\t\t}\n\n\t\treturn this.logNode;\n\t}\n\n\trenderTo(element: HTMLElement): this\n\t{\n\t\tDom.append(this.logNode, element);\n\t\tthis.#isRendering = true;\n\t\tthis.startRendering();\n\n\t\treturn this;\n\t}\n\n\tstartRendering()\n\t{\n\t\tconst track = this.#poolTrack.shift();\n\t\tif (Type.isUndefined(track))\n\t\t{\n\t\t\tthis.#isRendering = false;\n\t\t\tthis.#askScrollToBottom();\n\t\t\tthis.#bindAutoScroll(this.#shouldScrollToBottom)\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#workflowId !== track.workflowId)\n\t\t{\n\t\t\tif (Type.isUndefined(this.#activityRenderer[track.workflowId]))\n\t\t\t{\n\t\t\t\tif (Type.isUndefined(this.#poolWorkflowRobots[track.workflowId]))\n\t\t\t\t{\n\t\t\t\t\tthis.#loadWorkflowRobotsByWorkflowId(track);\n\n\t\t\t\t\tthis.renderTrack(track);\n\t\t\t\t\tthis.#workflowId = track.workflowId;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.initializeWorkflowRobotsRenderer(this.#poolWorkflowRobots[track.workflowId], track.workflowId);\n\t\t\t}\n\t\t}\n\n\t\tthis.renderTrack(track);\n\t\tthis.startRendering();\n\t}\n\n\t#renderStartDebugLog(track: TrackingEntry)\n\t{\n\t\tthis.#renderStartedDate(track);\n\t\tthis.#renderLegend(track);\n\t}\n\n\t#renderStartedDate(track: TrackingEntry)\n\t{\n\t\tconst startedDate = Helper.toDate(track.datetime);\n\n\t\tconst dateNode = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log--date\">\n\t\t\t\t<div class=\"bizproc-debugger-automation__log--date-text\">${Text.encode(Helper.formatDate('j F Y', startedDate))}</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(dateNode, this.logNode);\n\t}\n\n\t#renderLegend(track: TrackingEntry)\n\t{\n\t\tconst description = JSON.parse(track.note)['propertyValue'];\n\n\t\t// separator <div class=\"bizproc-debugger-automation__log-separator\"></div>\n\n\t\tconst descriptionNode = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section\">\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t\t${this.renderIndex()}\n\t\t\t\t\t${AutomationLogView.renderTime(track.datetime)}\n\t\t\t\t\t<div>${Text.encode(description)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(descriptionNode, this.logNode);\n\t}\n\n\trenderIndex(): HTMLDivElement\n\t{\n\t\tthis.#index++;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log--index\" data-role=\"index\">${String(this.#index).padStart(3, '0')}</div>\n\t\t`;\n\t}\n\n\tstatic renderTime(datetime: string): HTMLDivElement\n\t{\n\t\tdatetime = Helper.toDate(datetime);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log--time\">\n\t\t\t\t[${Text.encode(Helper.formatDate('H:i:s', datetime))}]\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t// endregion\n\n\t// region status log\n\n\trenderStatusChange(track: TrackingEntry)\n\t{\n\t\tconst parsedTrackNote = JSON.parse(track.note);\n\t\tif (!Type.isStringFilled(this.#documentStatus))\n\t\t{\n\t\t\tthis.#documentStatus = parsedTrackNote['STATUS_ID'];\n\t\t\tthis.#statusSettings = parsedTrackNote;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceStage = this.getStatusSettings(this.#documentStatus);\n\t\tconst destinationStage = parsedTrackNote;\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"bizproc-debugger-automation__log-section\">\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t\t${this.renderIndex()}\n\t\t\t\t\t${AutomationLogView.renderTime(track.datetime)}\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__status--change-info\">\n\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__status --log-status ${Helper.getBgColorAdditionalClass(sourceStage['COLOR'])}\" title=\"${Text.encode(sourceStage['NAME'])}\"> \n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__status--title\">${Text.encode(sourceStage['NAME'])}</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__status--bg\" style=\"background-color: ${sourceStage['COLOR']}; border-color: ${sourceStage['COLOR']};\">\n\t\t\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__status--bg-arrow\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__status--robot-change-arrow\"></div>\n\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__status --log-status ${Helper.getBgColorAdditionalClass(destinationStage['COLOR'])}\" title=\"${Text.encode(destinationStage['NAME'])}\"> \n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__status--title\">${Text.encode(destinationStage['NAME'])}</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-debugger-automation__status--bg\" style=\"background-color: ${destinationStage.COLOR}; border-color: ${destinationStage.COLOR};\">\n\t\t\t\t\t\t\t\t<span class=\"bizproc-debugger-automation__status--bg-arrow\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(node, this.logNode);\n\n\t\tthis.#documentStatus = parsedTrackNote['STATUS_ID'];\n\t\tthis.#statusSettings = parsedTrackNote;\n\t}\n\n\tgetStatusSettings(): object\n\t{\n\t\tif (Type.isUndefined(this.#statusSettings))\n\t\t{\n\t\t\treturn {\n\t\t\t\tNAME: '',\n\t\t\t\tCOLOR: 'AEF2F9'\n\t\t\t};\n\t\t}\n\n\t\treturn this.#statusSettings;\n\t}\n\n\t#renderCategoryChange(track: TrackingEntry)\n\t{\n\t\tconst categoryName = JSON.parse(track.note)['propertyValue'];\n\t\tif (!Type.isStringFilled(this.#categoryName))\n\t\t{\n\t\t\tthis.#categoryName = categoryName;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst descriptionNode = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-separator\"></div>\n\t\t\t\t<div class=\"bizproc-debugger-automation__log-section\">\n\t\t\t\t\t<div class=\"bizproc-debugger-automation__log-section--row\">\n\t\t\t\t\t\t${this.renderIndex()}\n\t\t\t\t\t\t${AutomationLogView.renderTime(track.datetime)}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t${Text.encode(Loc.getMessage(\n\t\t\t\t\t\t\t\t'BIZPROC_JS_DEBUGGER_CATEGORY_CHANGE',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t'#SOURCE_CATEGORY#': this.#categoryName,\n\t\t\t\t\t\t\t\t\t'#DESTINATION_CATEGORY#': categoryName\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(descriptionNode, this.logNode);\n\n\t\tthis.#categoryName = categoryName;\n\t}\n\n\t// endregion\n\n\t// region TRACK\n\tonTrackAdded(event: BaseEvent)\n\t{\n\t\tconst entryBuilder = new TrackingEntryBuilder();\n\t\tentryBuilder.setLogEntry(event.getData().row);\n\n\t\tthis.addTrack(entryBuilder.build());\n\t}\n\n\taddTrack(track: TrackingEntry): void {\n\t\tif (!this.#isRendering)\n\t\t{\n\t\t\tthis.renderTrack(track);\n\t\t\tthis.#askScrollToBottom();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#poolTrack.push(track);\n\t}\n\n\trenderTrack(track: TrackingEntry)\n\t{\n\t\tif ((track.id <= this.#trackId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Object.keys(this.#activityRenderer[track.workflowId] ?? {}).includes(track.name))\n\t\t{\n\t\t\tif (track.name === 'SESSION_LEGEND')\n\t\t\t{\n\t\t\t\tthis.#renderStartDebugLog(track);\n\t\t\t\tthis.#trackId = track.id;\n\t\t\t}\n\t\t\telse if (track.name === 'STATUS_CHANGED')\n\t\t\t{\n\t\t\t\tthis.renderStatusChange(track);\n\t\t\t\tthis.#trackId = track.id;\n\t\t\t}\n\t\t\telse if (track.name === 'CATEGORY_CHANGED')\n\t\t\t{\n\t\t\t\tthis.#renderCategoryChange(track);\n\t\t\t\tthis.#trackId = track.id;\n\t\t\t}\n\t\t\telse if (track.name === 'TRIGGER_LOG')\n\t\t\t{\n\t\t\t\t(new TriggerLog(this)).addTrack(track).render();\n\t\t\t\tthis.#trackId = track.id;\n\t\t\t}\n\t\t\telse if (track.name === 'Template' && track.type === TrackingEntry.EXECUTE_ACTIVITY_TYPE)\n\t\t\t{\n\t\t\t\tif (Type.isUndefined(this.#poolWorkflowRobots[track.workflowId]) && this.#isRendering === false)\n\t\t\t\t{\n\t\t\t\t\tthis.#isRendering = true;\n\n\t\t\t\t\tthis.#loadWorkflowRobotsByWorkflowId(track);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (track.name === 'Template' && track.type === TrackingEntry.CLOSE_ACTIVITY_TYPE)\n\t\t\t{\n\t\t\t\tthis.#clearWorkflowRobots(track.workflowId);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#activityRenderer[track.workflowId][track.name].renderTrack(track);\n\t\tthis.#trackId = track.id;\n\t}\n\t//endregion\n\n\t// region ON CHANGE TAB: scrollToBottom, collapseInfoResults\n\n\t#onChangeTab(event: BaseEvent)\n\t{\n\t\tif (event.getData().tab === 'log')\n\t\t{\n\t\t\tthis.collapseInfoResults();\n\t\t\tthis.#askScrollToBottom();\n\t\t}\n\t}\n\n\tcollapseInfoResults(node?: HTMLElement): this\n\t{\n\t\tif (!node)\n\t\t{\n\t\t\tnode = this.logNode;\n\t\t}\n\n\t\tconst infoResults = node.querySelectorAll('[data-role=\"info-result\"]');\n\t\tinfoResults.forEach((infoNode) => {\n\t\t\tif (infoNode.firstElementChild.clientHeight > this.constructor.#NUMBER_OF_LINES_TO_SHOW_IN_PIXELS)\n\t\t\t{\n\t\t\t\tconst moreInfoNode = infoNode.parentNode.querySelector('[data-role=\"more-info-result\"]');\n\n\t\t\t\tEvent.bind(moreInfoNode, 'click', () => {\n\t\t\t\t\tDom.style(infoNode, 'height', infoNode.firstElementChild.clientHeight + 'px');\n\t\t\t\t\tDom.style(moreInfoNode, 'display', 'none');\n\t\t\t\t});\n\n\t\t\t\tEvent.bind(infoNode, 'transitionend', () => {\n\t\t\t\t\tDom.style(infoNode, 'height', null);\n\t\t\t\t});\n\n\t\t\t\tDom.style(infoNode, 'height', this.constructor.#NUMBER_OF_LINES_TO_SHOW_IN_PIXELS + 'px');\n\t\t\t\tDom.style(moreInfoNode, 'display', 'block');\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tshouldScrollToBottom(should: boolean): this\n\t{\n\t\tthis.#shouldScrollToBottom = should;\n\n\t\treturn this;\n\t}\n\n\t#bindAutoScroll(state: boolean)\n\t{\n\t\tif (!this.logNode.parentNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst scrollNode = this.logNode.parentNode;\n\n\t\tif (state)\n\t\t{\n\t\t\tthis.#autoScrollHandler = () => {\n\t\t\t\tif (this.#scrollAnimationId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst scrollMax = scrollNode.scrollHeight - scrollNode.clientHeight;\n\n\t\t\t\tthis.#shouldScrollToBottom = (\n\t\t\t\t\tscrollNode.scrollTop >= scrollMax - this.constructor.#NUMBER_OF_LINES_TO_SHOW_IN_PIXELS\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tEvent.bind(scrollNode, 'scroll', this.#autoScrollHandler);\n\t\t}\n\t\telse if (this.#autoScrollHandler)\n\t\t{\n\t\t\tEvent.unbind(scrollNode, 'scroll', this.#autoScrollHandler);\n\t\t}\n\t}\n\n\t#scrollToBottom()\n\t{\n\t\tif (!this.logNode.parentNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst scrollNode = this.logNode.parentNode;\n\n\t\tconst from = scrollNode.scrollTop;\n\t\tconst to = scrollNode.scrollHeight - scrollNode.clientHeight;\n\n\t\tthis.#animateScroll(scrollNode, from, to);\n\t}\n\n\t#animateScroll(element, start, end)\n\t{\n\t\tthis.#cancelAnimateScroll();\n\n\t\tconst increment = 20;\n\t\tconst duration = 500;\n\n\t\tconst diff = end - start;\n\t\tlet currentPosition = 0;\n\n\t\tconst requestFrame = (\n\t\t\twindow.requestAnimationFrame\n\t\t\t|| window.webkitRequestAnimationFrame\n\t\t\t|| window.mozRequestAnimationFrame\n\t\t\t|| function(callback){return window.setTimeout(callback, 1000 / 60);}\n\t\t);\n\n\t\tconst animateScroll = () =>\n\t\t{\n\t\t\tcurrentPosition += increment;\n\n\t\t\telement.scrollTop = easeInOutQuad(currentPosition, start, diff, duration);\n\t\t\tif (currentPosition < duration)\n\t\t\t{\n\t\t\t\tthis.#scrollAnimationId = requestFrame(animateScroll);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#scrollAnimationId = null;\n\t\t\t}\n\t\t};\n\n\t\treturn animateScroll();\n\t}\n\n\t#cancelAnimateScroll()\n\t{\n\t\tif (this.#scrollAnimationId)\n\t\t{\n\t\t\tconst cancelFrame = (\n\t\t\t\twindow.cancelAnimationFrame\n\t\t\t\t|| window.webkitCancelAnimationFrame\n\t\t\t\t|| window.mozCancelAnimationFrame\n\t\t\t\t|| function(id){clearTimeout(id)}\n\t\t\t);\n\n\t\t\tcancelFrame(this.#scrollAnimationId);\n\t\t\tthis.#scrollAnimationId = null;\n\t\t}\n\t}\n\n\t#askScrollToBottom(): this\n\t{\n\t\tif (this.#shouldScrollToBottom)\n\t\t{\n\t\t\tthis.#scrollToBottom();\n\t\t}\n\t}\n\n\t// endregion\n\n\t#clearWorkflowRobots(workflowId: string)\n\t{\n\t\tdelete this.#poolWorkflowRobots[workflowId];\n\t\tdelete this.#activityRenderer[workflowId];\n\t}\n\n\t#onSessionFinished()\n\t{\n\t\tthis.debugger.unsubscribe('onWorkflowTrackAdded', this.#onTrackAddedHandler);\n\t\tthis.debugger.getMainView().unsubscribe('onChangeTab', this.#onChangeTabHandler);\n\t}\n}\n\nconst easeInOutQuad = function (current, start, diff, duration)\n{\n\tcurrent /= duration/2;\n\n\tif (current < 1)\n\t{\n\t\treturn diff / 2 * current * current + start;\n\t}\n\n\tcurrent--;\n\n\treturn -diff/2 * (current*(current-2) - 1) + start;\n};","import \"ls\";\n\nexport default class Settings\n{\n\t#ttl = 3 * 86400;\n\t#prefix = 'bp-'\n\n\tconstructor(section: string)\n\t{\n\t\tif (section)\n\t\t{\n\t\t\tthis.#prefix += section + '-';\n\t\t}\n\t}\n\n\t#getName(name: string): string\n\t{\n\t\treturn this.#prefix + name;\n\t}\n\n\tgetSet(name: string): Set\n\t{\n\t\tconst value = this.get(name);\n\n\t\treturn value instanceof Array ? new Set(value) : new Set();\n\t}\n\n\tget(name: string): any\n\t{\n\t\treturn BX.localStorage.get(this.#getName(name));\n\t}\n\n\tset(name: string, value: any): this\n\t{\n\t\tif (value instanceof Set)\n\t\t{\n\t\t\tvalue = Array.from(value);\n\t\t}\n\n\t\tBX.localStorage.set(this.#getName(name), value, this.#ttl);\n\n\t\treturn this;\n\t}\n}","import {Guide} from 'ui.tour';\nimport {Text} from \"main.core\";\n\nexport class ActionPanelGuide\n{\n\t#guide: Guide;\n\n\tconstructor(options)\n\t{\n\t\tthis.#guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: options.target,\n\t\t\t\t\ttitle: ActionPanelGuide.#getHtmlTitle(options.title) || '',\n\t\t\t\t\ttext: options.text || '',\n\t\t\t\t\t//article: options.article,\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'warning',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\t}\n\n\tstart()\n\t{\n\t\tthis.#guide.getPopup().setWidth(370); //some magic ^_^\n\t\tthis.#guide.showNextStep();\n\t}\n\n\tfinish()\n\t{\n\t\tthis.#guide.close();\n\t}\n\n\tstatic #getHtmlTitle(title): ?HTMLDivElement\n\t{\n\t\tif (title)\n\t\t{\n\t\t\treturn `\n\t\t\t\t<div class=\"bizproc__action-panel-guide\">\n\t\t\t\t\t<div class=\"bizproc__action-panel-guide--title --warning-icon\">${Text.encode(title)}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {Loc, Text} from 'main.core';\nimport {ActionPanelGuide} from \"../tourguide/action-panel-guide\";\nimport {EventEmitter} from 'main.core.events';\nimport Automation from \"../automation\";\nimport {Manager} from \"bizproc.debugger\";\n\nexport class CustomCrmActionPanel\n{\n\t#actionPanel: BX.UI.ActionPanel = null;\n\t#grid: BX.CRM.Kanban.Grid = null;\n\t#guides: Array<ActionPanelGuide> = [];\n\t#debuggerInstance: Automation;\n\n\tconstructor(grid: BX.CRM.Kanban.Grid, debuggerInstance: Automation)\n\t{\n\t\tthis.#grid = grid;\n\t\tthis.#debuggerInstance = debuggerInstance;\n\n\t\tthis.#actionPanel = new BX.UI.ActionPanel({\n\t\t\tremoveLeftPosition: true,\n\t\t\tmaxHeight: 58,\n\t\t\tparentPosition: 'bottom',\n\t\t\tautoHide: false,\n\t\t});\n\n\t\tthis.#appendItems();\n\n\t\tconst onHideActionPanelHandler = this.#onHideActionPanel.bind(this);\n\t\tEventEmitter.subscribe(this.#actionPanel, 'BX.UI.ActionPanel:hidePanel', onHideActionPanelHandler);\n\t}\n\n\t#appendItems()\n\t{\n\t\tthis.#actionPanel.appendItem({\n\t\t\tid: 'fix_entity',\n\t\t\ttext: Loc.getMessage('BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_ACTION'),\n\t\t\tonclick: this.fixEntityAction.bind(this)\n\t\t});\n\n\t\tthis.#actionPanel.appendItem({\n\t\t\tid: 'remove_entity',\n\t\t\ttext: this.#getRemoveEntityActionText(),\n\t\t\tonclick: this.removeEntityAction.bind(this)\n\t\t});\n\n\t\tthis.#actionPanel.appendItem({\n\t\t\tid: 'finish_debug',\n\t\t\ttext: Loc.getMessage('BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FINISH_DEBUG_ACTION'),\n\t\t\tonclick: function () {\n\t\t\t\tManager.Instance.finishSession(this.#debuggerInstance.session).then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.stopActionPanel();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tthis.#handleRejectResponse(response, 'finish_debug');\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t}\n\t\t);\n\t}\n\n\tget actionPanel(): BX.UI.ActionPanel\n\t{\n\t\treturn this.#actionPanel;\n\t}\n\n\t#onHideActionPanel()\n\t{\n\t\tthis.#guides.forEach((guide) => {\n\t\t\tguide.finish();\n\t\t})\n\t}\n\n\tfixEntityAction()\n\t{\n\t\tconst checkedIds = this.#getCheckedIdsInBpStyle();\n\t\tif (checkedIds.length !== 1)\n\t\t{\n\t\t\tconst guide = new ActionPanelGuide({\n\t\t\t\ttarget: this.actionPanel.getItemById('fix_entity').layout.container,\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_FIX_DEAL_COUNT_ERROR_TITLE'),\n\t\t\t\tarticle: 'limit_office_bp_designer', // todo: replace,\n\t\t\t});\n\t\t\tthis.#guides.push(guide);\n\n\t\t\tguide.start();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#debuggerInstance.session.fixateDocument(checkedIds[0]).then(\n\t\t\t() => {\n\t\t\t\tthis.stopActionPanel();\n\t\t\t\tManager.Instance.requireSetFilter(this.#debuggerInstance.session, true);\n\t\t\t\tif (this.#debuggerInstance.settings.get('popup-collapsed'))\n\t\t\t\t{\n\t\t\t\t\tthis.#debuggerInstance.getMainView().handleCollapse();\n\t\t\t\t}\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tthis.#handleRejectResponse(response, 'fix_entity');\n\t\t\t}\n\t\t);\n\t}\n\n\t#getRemoveEntityActionText()\n\t{\n\t\treturn `\n\t\t\t<span>${Text.encode(Loc.getMessage('BIZPROC_JS_DEBUGGER_ACTION_PANEL_CRM_REMOVE_DEAL_ACTION'))}</span>\n\t\t`;\n\t}\n\n\tremoveEntityAction()\n\t{\n\t\tconst checkedIds = this.#getCheckedIdsInBpStyle();\n\n\t\tthis.#debuggerInstance.session.removeDocuments(checkedIds).then(\n\t\t\t() => {\n\t\t\t\tthis.actionPanel.hidePanel();\n\t\t\t\tthis.#grid.reload();\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tthis.#handleRejectResponse(response, 'remove_entity');\n\t\t\t}\n\t\t);\n\t}\n\n\t#getCheckedIdsInBpStyle(): Array\n\t{\n\t\tconst checkedIds = this.#grid.getCheckedId();\n\n\t\t// todo: get EntityType from another place\n\t\treturn checkedIds.map(id => 'DEAL_' + id);\n\t}\n\n\tstopActionPanel()\n\t{\n\t\tthis.actionPanel.hidePanel();\n\t\tthis.#grid.resetActionPanel();\n\t\tthis.#grid.stopActionPanel();\n\t}\n\n\t#handleRejectResponse(response, actionId)\n\t{\n\t\tlet message = '';\n\t\tresponse.errors.forEach((error)=>{\n\t\t\tmessage = message + '\\n' + error.message;\n\t\t});\n\n\t\tconst guide = new ActionPanelGuide({\n\t\t\ttarget: this.actionPanel.getItemById(actionId).layout.container,\n\t\t\ttitle: message,\n\t\t\tarticle: 'limit_office_bp_designer', // todo: replace,\n\t\t});\n\t\tthis.#guides.push(guide);\n\n\t\tguide.start();\n\t}\n}","import AutomationMainView from './views/automation-main';\nimport Session from './session/session';\nimport {ajax, Loc, Type, Text, Reflection} from \"main.core\";\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport AutomationLogView from \"./views/automation-log\";\nimport Settings from \"./settings\";\nimport {MessageBox, MessageBoxButtons} from \"ui.dialogs.messagebox\";\nimport {Manager} from \"./index\";\nimport { setGlobalContext, getGlobalContext, Context, Document, WorkflowStatus } from 'bizproc.automation';\nimport {CustomCrmActionPanel} from \"./actionpanel/custom-crm-action-panel\";\n\nexport default class Automation extends EventEmitter\n{\n\tsession: Session = null;\n\t#pullHandlers: ?[] = null;\n\n\t#settings: Settings;\n\n\t#mainView;\n\n\t#triggers: Array;\n\t#template: Array;\n\t#documentStatus: string;\n\t#statusList: Array;\n\t#documentCategoryId: Number = 0;\n\t#documentFields: Array;\n\t#documentValues: Object = {};\n\n\t#workflowId: string;\n\t#workflowStatus: number;\n\t#workflowEvents: Array = [];\n\t#workflowTrack: Array = [];\n\t#debuggerState: number;\n\n\t#customActionPanel: CustomCrmActionPanel = null;\n\n\tconstructor(parameters = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Debugger.Automation');\n\n\t\tthis.session = parameters.session;\n\n\t\tif (this.session.isActive())\n\t\t{\n\t\t\tthis.session.subscribeOnce('onAfterDocumentFixed', this.#onAfterDocumentFixed.bind(this));\n\t\t\tthis.session.subscribe('onFinished', this.destroy.bind(this));\n\t\t\tthis.#subscribePull();\n\t\t}\n\n\t\tthis.#settings = new Settings('atm-dbg');\n\t\tthis.#initAutomationContext();\n\n\t\tthis.#resumeShowActionPanel();\n\t}\n\n\t#resumeShowActionPanel()\n\t{\n\t\tif (this.session.isInterceptionMode() && !this.session.isFixed())\n\t\t{\n\t\t\tif (Reflection.getClass('BX.CRM.Kanban.Grid'))\n\t\t\t{\n\t\t\t\tconst gridInstance = BX.CRM.Kanban.Grid.getInstance();\n\t\t\t\tif (this.#shouldSetCustomActionPanel(gridInstance))\n\t\t\t\t{\n\t\t\t\t\tthis.#customActionPanel = new CustomCrmActionPanel(gridInstance, this);\n\t\t\t\t\tgridInstance.stopActionPanel(true);\n\t\t\t\t\tgridInstance.resetActionPanel();\n\t\t\t\t\tgridInstance.setCustomActionPanel(this.#customActionPanel.actionPanel);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t#shouldSetCustomActionPanel(gridInstance): boolean\n\t{\n\t\tconst gridData = gridInstance.getData();\n\t\tconst entityType = gridData.entityType;\n\n\t\t//todo: modify\n\t\tif (entityType !== 'DEAL')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst categoryId =\n\t\t\tgridData.params.hasOwnProperty('CATEGORY_ID')\n\t\t\t\t? Text.toInteger(gridData.params.CATEGORY_ID)\n\t\t\t\t: 0\n\t\t;\n\n\t\treturn (this.session.initialCategoryId === categoryId);\n\t}\n\n\t#initAutomationContext()\n\t{\n\t\tconst context = new Context({\n\t\t\tdocument: new Document({\n\t\t\t\trawDocumentType: [],\n\t\t\t\tdocumentId: null,\n\t\t\t\tcategoryId: 0,\n\t\t\t\tstatusList: this.getStatusList(),\n\t\t\t\tstatusId: this.getDocumentStatus(),\n\t\t\t\tdocumentFields: this.getDocumentFields(),\n\t\t\t}),\n\t\t\tdocumentSigned: this.documentSigned,\n\t\t\tcanEdit: false,\n\t\t\tcanManage: false,\n\t\t});\n\n\t\tsetGlobalContext(context);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.unsubscribeAll();\n\t\tthis.#unsubscribePull();\n\n\t\tthis.#mainView?.destroy();\n\n\t\tthis.session = null;\n\t\tthis.#settings = null;\n\t\tthis.#mainView = null;\n\n\t\tthis.#template = [];\n\t\tthis.#documentStatus = null;\n\t\tthis.#statusList = [];\n\t\tthis.#documentFields = [];\n\t\tthis.#documentValues = {};\n\n\t\tthis.#workflowId = null;\n\t\tthis.#workflowStatus = 0;\n\t\tthis.#workflowEvents = [];\n\t\tthis.#workflowTrack = [];\n\t\tthis.#customActionPanel?.stopActionPanel();\n\t}\n\n\tget track()\n\t{\n\t\treturn this.#workflowTrack;\n\t}\n\n\tget settings(): Settings\n\t{\n\t\treturn this.#settings;\n\t}\n\n\tget documentSigned(): string\n\t{\n\t\treturn this.session.documentSigned;\n\t}\n\n\tget sessionId(): string\n\t{\n\t\treturn this.session.id;\n\t}\n\n\tget workflowId(): string\n\t{\n\t\treturn this.#workflowId;\n\t}\n\n\tget pullHandlers(): []\n\t{\n\t\tif (this.#pullHandlers === null)\n\t\t{\n\t\t\tthis.#pullHandlers = [\n\t\t\t\t{name: 'documentStatus', func: this.handleExternalDocumentStatus.bind(this)},\n\t\t\t\t{name: 'documentValues', func: this.handleExternalDocumentValues.bind(this)},\n\t\t\t\t{name: 'documentDelete', func: this.handleExternalDocumentDelete.bind(this)},\n\t\t\t\t{name: 'workflowStatus', func: this.handleExternalWorkflowStatus.bind(this)},\n\t\t\t\t{name: 'workflowEventAdd', func: this.handleExternalWorkflowEventAdd.bind(this)},\n\t\t\t\t{name: 'workflowEventRemove', func: this.handleExternalWorkflowEventRemove.bind(this)},\n\t\t\t\t{name: 'trackRow', func: this.handleExternalTrackRow.bind(this)},\n\t\t\t]\n\t\t}\n\t\treturn this.#pullHandlers;\n\t}\n\n\t#subscribePull()\n\t{\n\t\tconst pull = Manager.Instance.pullHandler;\n\n\t\tthis.pullHandlers.forEach(({name, func}) => {\n\t\t\tpull.subscribe(name, func);\n\t\t});\n\t}\n\n\t#unsubscribePull()\n\t{\n\t\tif (this.#pullHandlers === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pull = Manager.Instance.pullHandler;\n\n\t\tthis.pullHandlers.forEach(({name, func}) => {\n\t\t\tpull.unsubscribe(name, func);\n\t\t});\n\n\t\tthis.#pullHandlers = null;\n\t}\n\n\tgetMainView(): AutomationMainView\n\t{\n\t\tif (!this.#mainView)\n\t\t{\n\t\t\tthis.#mainView = new AutomationMainView(this);\n\t\t}\n\n\t\treturn this.#mainView;\n\t}\n\n\tgetLogView(): AutomationLogView\n\t{\n\t\treturn new AutomationLogView(this);\n\t}\n\n\tgetStatusList(): Array\n\t{\n\t\treturn this.#statusList;\n\t}\n\n\tgetDocumentFields(): Array\n\t{\n\t\treturn this.#documentFields;\n\t}\n\n\tgetDocumentField(fieldId: string): null | {}\n\t{\n\t\treturn this.#documentFields.find((field) => field.Id === fieldId);\n\t}\n\n\tgetDocumentValue(fieldId: string): null | any\n\t{\n\t\treturn this.#documentValues[fieldId] || null;\n\t}\n\n\tgetDocumentStatus(): string\n\t{\n\t\treturn this.#documentStatus; //getActiveDocument().getStatus();\n\t}\n\n\tgetWorkflowStatus(): number\n\t{\n\t\treturn this.#workflowStatus;\n\t}\n\n\tgetState(): number\n\t{\n\t\treturn this.#debuggerState;\n\t}\n\n\thasWorkflowEvents(): boolean\n\t{\n\t\treturn this.#workflowEvents.length > 0;\n\t}\n\n\tsetDocumentStatus(statusId: string): Promise\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tajax.runAction(\n\t\t\t\t'bizproc.debugger.setDocumentStatus',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tstatusId: statusId,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(response) => {\n\n\t\t\t\t\tif (response.data && response.data.newStatus)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#documentStatus = response.data.newStatus;\n\t\t\t\t\t\tthis.#template = response.data.template;\n\t\t\t\t\t\tthis.#workflowTrack = [];\n\t\t\t\t\t\tthis.emit('onDocumentStatusChanged');\n\t\t\t\t\t}\n\t\t\t\t\tresolve(response);\n\t\t\t\t},\n\t\t\t\tthis.#handleRejectResponse.bind(this)\n\t\t\t);\n\t\t});\n\t}\n\n\tget templateTriggers(): Array\n\t{\n\t\treturn this.#triggers.filter(trigger => trigger['DOCUMENT_STATUS'] === this.#template['DOCUMENT_STATUS']);\n\t}\n\n\tgetTemplate(): Array\n\t{\n\t\treturn this.#template;\n\t}\n\n\tisTemplateEmpty(): boolean\n\t{\n\t\treturn this.#template.IS_EXTERNAL_MODIFIED === false && !Type.isArrayFilled(this.#template.ROBOTS)\n\t}\n\n\tstartDebugTemplate(): Promise\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tajax.runAction(\n\t\t\t\t'bizproc.debugger.resumeAutomationTemplate',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tsessionId: this.sessionId,\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: 'automation_start_debug',\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(response) => {\n\n\t\t\t\t\tthis.#workflowId = response.data.workflowId;\n\t\t\t\t\tthis.#debuggerState = response.data.debuggerState;\n\n\t\t\t\t\tresolve(response.data);\n\t\t\t\t},\n\t\t\t\tthis.#handleRejectResponse.bind(this));\n\t\t});\n\t}\n\n\temulateExternalEvent()\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tconst eventId = this.#workflowEvents[0];\n\n\t\t\tif (!eventId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tajax.runAction(\n\t\t\t\t'bizproc.debugger.emulateExternalEvent',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tworkflowId: this.#workflowId,\n\t\t\t\t\t\teventId,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(response) => {\n\n\t\t\t\tresolve(response.data)\n\t\t\t\t},\n\t\t\t\tthis.#handleRejectResponse.bind(this)\n\t\t\t);\n\t\t});\n\t}\n\n\tloadMainViewInfo(): Promise\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tajax.runAction(\n\t\t\t\t'bizproc.debugger.fillAutomationView',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tsessionId: this.sessionId,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(response) =>\n\t\t\t\t{\n\t\t\t\t\tthis.#triggers = response.data.triggers;\n\t\t\t\t\tthis.#template = response.data.template;\n\t\t\t\t\tthis.#documentStatus = response.data.documentStatus;\n\t\t\t\t\tthis.#statusList = response.data.statusList;\n\t\t\t\t\tthis.#documentCategoryId = response.data.documentCategoryId;\n\t\t\t\t\tthis.#documentFields = response.data.documentFields;\n\t\t\t\t\tthis.#documentValues = response.data.documentValues;\n\n\t\t\t\t\tthis.#workflowId = response.data.workflowId;\n\t\t\t\t\tthis.#workflowStatus = response.data.workflowStatus;\n\t\t\t\t\tthis.#workflowEvents = response.data.workflowEvents;\n\t\t\t\t\tthis.#workflowTrack = response.data.track;\n\t\t\t\t\tthis.#debuggerState = response.data.debuggerState;\n\n\t\t\t\t\tgetGlobalContext().document\n\t\t\t\t\t\t.setFields(this.getDocumentFields())\n\t\t\t\t\t\t.setStatusList(this.getStatusList())\n\t\t\t\t\t\t.setStatus(this.getDocumentStatus())\n\t\t\t\t\t;\n\n\t\t\t\t\tresolve();\n\t\t\t\t},\n\t\t\t\tthis.#handleRejectResponse.bind(this)\n\t\t\t);\n\t\t});\n\t}\n\n\tloadAllLog(): Promise\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tajax.runAction(\n\t\t\t\t'bizproc.debugger.loadAllLog',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tsessionId: this.session.id,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(response) => {\n\t\t\t\t\tresolve(response.data);\n\t\t\t\t},\n\t\t\t\tthis.#handleRejectResponse.bind(this)\n\t\t\t);\n\t\t});\n\t}\n\n\tloadRobotsByWorkflowId(workflowId: string): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bizproc.debugger.loadRobotsByWorkflowId',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tsessionId: this.sessionId,\n\t\t\t\t\t\tworkflowId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(response) => {\n\t\t\t\t\tresolve(response.data);\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\treject(response.data);\n\t\t\t\t\t//this.#handleRejectResponse.bind(this);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\thandleExternalDocumentStatus(event: BaseEvent)\n\t{\n\t\tconst status: string = event.getData().status;\n\n\t\tif (this.getDocumentStatus() === status)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.info('document status: ' + status);\n\t\tthis.#documentStatus = status\n\t\tthis.emit('onDocumentStatusChanged');\n\t}\n\n\thandleExternalDocumentValues(event: BaseEvent)\n\t{\n\t\tconst values: {} = event.getData().values;\n\n\t\tObject.keys(values).forEach((key) => this.#documentValues[key] = values[key]);\n\n\t\tconsole.info('document values: ' + Object.keys(values));\n\n\t\tthis.emit('onDocumentValuesUpdated', {values});\n\t}\n\n\thandleExternalDocumentDelete()\n\t{\n\t\tMessageBox.show({\n\t\t\tmessage: Loc.getMessage('BIZPROC_JS_DEBUGGER_CONFIRM_ON_DOCUMENT_DELETE'),\n\t\t\tokCaption: Loc.getMessage('BIZPROC_JS_DEBUGGER_VIEWS_MENU_FINISH_SESSION'),\n\t\t\tonOk: () => {\n\t\t\t\treturn Manager.Instance.finishSession(this.session).then(\n\t\t\t\t\tnull,\n\t\t\t\t\tthis.#handleRejectResponse.bind(this)\n\t\t\t\t);\n\t\t\t},\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t});\n\t}\n\n\t#handleRejectResponse(response)\n\t{\n\t\tif (Type.isArrayFilled(response.errors))\n\t\t{\n\t\t\tconst noDocumentError = response.errors.find((error) => error.code === 404);\n\n\t\t\tif (noDocumentError)\n\t\t\t{\n\t\t\t\tthis.handleExternalDocumentDelete();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = response.errors.map(error => error.message).join('\\n');\n\n\t\t\t\tMessageBox.alert(message);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleExternalTrackRow(event: BaseEvent)\n\t{\n\t\tconst row: {} = event.getData().row;\n\t\trow['WORKFLOW_STATUS'] = this.#workflowStatus;\n\n\t\tthis.#workflowTrack.push(row);\n\n\t\tthis.emit('onWorkflowTrackAdded', {row});\n\t}\n\n\thandleExternalWorkflowStatus(event: BaseEvent)\n\t{\n\t\tconst status: WorkflowStatus = event.getData().status;\n\t\tconst workflowId: string = event.getData().workflowId;\n\n\t\tthis.#workflowStatus = status;\n\n\t\tif (status === WorkflowStatus.RUNNING)\n\t\t{\n\t\t\tthis.#workflowId = workflowId;\n\t\t}\n\n\t\tif (this.#workflowId !== workflowId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.info('workflow status: ' + status);\n\t\tthis.emit('onWorkflowStatusChanged', {status, workflowId});\n\t}\n\n\thandleExternalWorkflowEventAdd(event: BaseEvent)\n\t{\n\t\tconst eventName: string = event.getData().eventName;\n\n\t\tconsole.info('workflow event added: ' + eventName);\n\t\tthis.#workflowEvents.push(eventName);\n\t\tconsole.info('workflow events: ' + this.#workflowEvents.join(', '));\n\t\tthis.emit('onWorkflowEventsChanged', {events: this.#workflowEvents});\n\t}\n\n\thandleExternalWorkflowEventRemove(event: BaseEvent)\n\t{\n\t\tconst eventName: string = event.getData().eventName;\n\n\t\tconsole.info('workflow event removed: ' + eventName);\n\t\tthis.#workflowEvents = this.#workflowEvents.filter(value => value !== eventName);\n\t\tconsole.info('workflow events: ' + this.#workflowEvents.join(', '));\n\t\tthis.emit('onWorkflowEventsChanged', {events: this.#workflowEvents});\n\t}\n\n\t#onAfterDocumentFixed()\n\t{\n\t\tthis.loadMainViewInfo().then(()=> {\n\t\t\tthis.emit('onAfterDocumentFixed');\n\t\t});\n\t}\n\n\tgetField(object, id): object\n\t{\n\t\tlet field;\n\n\t\tswitch (object)\n\t\t{\n\t\t\tcase 'Document':\n\t\t\t\tfield = this.#documentFields.find((field) => field.Id === id);\n\t\t\t\tbreak;\n\t\t\tcase 'Template':\n\t\t\tcase 'Parameter':\n\t\t\tcase 'Constant':\n\t\t\tcase 'GlobalConst':\n\t\t\tcase 'GlobalVar':\n\t\t\t\t// todo: parameter, variable, constant, GlobalConst, GlobalVar, Activity\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn field || {\n\t\t\tId: id,\n\t\t\tObjectId: object,\n\t\t\tName: id,\n\t\t\tType: 'string',\n\t\t\tExpression: id,\n\t\t\tSystemExpression: '{='+object+':'+id+'}'\n\t\t};\n\t}\n\n\tgetSettingsUrl(): string\n\t{\n\t\t//TODO: get actual url\n\t\treturn `/crm/deal/automation/${this.#documentCategoryId}/`;\n\t}\n}","import {Type} from 'main.core';\nimport {PULL} from \"pull.client\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class CommandHandler extends EventEmitter\n{\n\t#unsubscribe: CallableFunction;\n\t#commands = [\n\t\t'documentStatus',\n\t\t'documentValues',\n\t\t'documentDelete',\n\t\t//workflow\n\t\t'workflowStatus',\n\t\t'workflowEventAdd',\n\t\t'workflowEventRemove',\n\t\t//track\n\t\t'trackRow',\n\t\t//session\n\t\t'sessionFinish'\n\t];\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Debugger.Pull');\n\n\t\tthis.#unsubscribe = PULL.subscribe(this);\n\t}\n\n\tdestroy()\n\t{\n\t\tif (Type.isFunction(this.#unsubscribe))\n\t\t{\n\t\t\tthis.#unsubscribe();\n\t\t}\n\n\t\tthis.#unsubscribe = null;\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'bizproc';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn BX.PullClient.SubscriptionType.Server;\n\t}\n\n\tgetMap()\n\t{\n\t\tconst map = {};\n\t\tthis.#commands.forEach(command => {\n\t\t\tmap[command] = this.#handleCommand.bind(this);\n\t\t});\n\n\t\treturn map;\n\t}\n\n\t#handleCommand(params, extra, command)\n\t{\n\t\tthis.emit(command, params);\n\t}\n}","import {Loc} from 'main.core';\nimport {Guide} from 'ui.tour';\nimport {Helper} from \"../helper\";\n\nexport class FilterGuide\n{\n\tconstructor(options)\n\t{\n\t\tthis.guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: options.target,\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_JS_DEBUGGER_FILTER_TOUR_TITLE'),\n\t\t\t\t\ttext: FilterGuide.#getText(),\n\t\t\t\t\tarticle: '16087180',\n\t\t\t\t\tevents: options.events ?? {},\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\t// EventEmitter.subscribe('UI.Tour.Guide:onFinish'....\n\t}\n\n\tstart()\n\t{\n\t\tthis.guide.getPopup().setWidth(365); //some magic ^_^\n\t\tthis.guide.showNextStep();\n\t}\n\n\tstatic #getText(): Element\n\t{\n\t\treturn `\n\t\t\t<ul class=\"bizproc-debugger-filter-guide-list\">\n\t\t\t\t<li class=\"bizproc-debugger-filter-guide-list-item\">\n\t\t\t\t\t${Helper.toHtml(Loc.getMessage('BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_1'))}\n\t\t\t\t</li>\n\t\t\t\t<li class=\"bizproc-debugger-filter-guide-list-item\">\n\t\t\t\t\t${Helper.toHtml(Loc.getMessage('BIZPROC_JS_DEBUGGER_FILTER_TOUR_TEXT_LINE_2'))}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`;\n\t}\n}\n","import {Loc} from 'main.core';\nimport {Guide} from 'ui.tour';\n\nexport class StageGuide\n{\n\tconstructor(options)\n\t{\n\t\tthis.guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: options.target,\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_JS_DEBUGGER_STAGE_TOUR_TITLE'),\n\t\t\t\t\ttext: StageGuide.#getText(),\n\t\t\t\t\t//article: 'limit_office_bp_designer', // todo: replace,\n\t\t\t\t\tevents: options.events ?? {},\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\t}\n\n\tstart()\n\t{\n\t\tthis.guide.getPopup().setWidth(330); //some magic ^_^\n\t\tthis.guide.showNextStep();\n\t}\n\n\tstatic #getText(): Element\n\t{\n\t\treturn `\n\t\t\t<ul class=\"bizproc-debugger-filter-guide-list\">\n\t\t\t\t<li class=\"bizproc-debugger-filter-guide-list-item\">\n\t\t\t\t\t${Loc.getMessage('BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_1')}\n\t\t\t\t</li>\n\t\t\t\t<li class=\"bizproc-debugger-filter-guide-list-item\">\n\t\t\t\t\t${Loc.getMessage('BIZPROC_JS_DEBUGGER_STAGE_TOUR_TEXT_LINE_2')}\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t`;\n\t}\n}","import {EventEmitter} from \"main.core.events\";\nimport {FilterGuide} from \"./filter-guide\";\nimport {StageGuide} from \"./stage-guide\";\n\nexport type CrmDebuggerGuideOptions = {\n\tgrid: BX.CRM.Kanban.Grid,\n\tshowFilterStep: boolean,\n\tshowStageStep: boolean,\n\treserveFilterIds: string,\n};\n\nexport class CrmDebuggerGuide extends EventEmitter\n{\n\t#grid: BX.CRM.Kanban.Grid = null;\n\t#guides: Array = [];\n\t#reserveFilterIds: Array<string> = [];\n\n\tconstructor(options: CrmDebuggerGuideOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Debugger.CrmDebuggerGuide');\n\n\t\tthis.#grid = options.grid;\n\t\tthis.#reserveFilterIds = options.reserveFilterIds;\n\n\t\t// reverse order\n\t\tif (options.showStageStep)\n\t\t{\n\t\t\tconst stageStep = this.#getStageGuide();\n\t\t\tif (stageStep)\n\t\t\t{\n\t\t\t\tthis.#guides.push(stageStep);\n\t\t\t}\n\t\t}\n\n\t\tif (options.showFilterStep)\n\t\t{\n\t\t\tconst filterGuide = this.#getFilterGuide();\n\t\t\tif (filterGuide)\n\t\t\t{\n\t\t\t\tthis.#guides.push(filterGuide);\n\t\t\t}\n\t\t}\n\t}\n\n\t#getStageGuide(): ?StageGuide\n\t{\n\t\tif (!this.#grid)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstColumn = this.#grid.getColumns()[0];\n\t\tif (!firstColumn)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst guideTarget = firstColumn.getTitleContainer();\n\t\tif (!guideTarget)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst nextGuide = this.#guides[this.#guides.length - 1];\n\n\t\treturn new StageGuide({\n\t\t\ttarget: '.' + guideTarget.classList[0],\n\t\t\tevents: {\n\t\t\t\t'onShow': function () {\n\t\t\t\t\tthis.emit('onStageGuideStepShow');\n\t\t\t\t}.bind(this),\n\t\t\t\t'onClose': function () {\n\t\t\t\t\tif (nextGuide)\n\t\t\t\t\t{\n\t\t\t\t\t\tnextGuide.start();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this),\n\t\t\t},\n\t\t});\n\t}\n\n\t#getFilterGuide(): ?FilterGuide\n\t{\n\t\tconst filterId = this.#grid ? [this.#grid.getData().gridId] :  this.#reserveFilterIds;\n\t\tif (filterId.length <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet filter;\n\t\tfor (const key in filterId)\n\t\t{\n\t\t\tfilter = BX.Main.filterManager.getById(filterId[key]);\n\t\t\tif (filter)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!filter)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst filterApi = filter.getApi();\n\t\tconst guideTarget = filterApi?.parent?.getPopupBindElement();\n\n\t\tif (!guideTarget)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst nextGuide = this.#guides[this.#guides.length - 1];\n\n\t\treturn new FilterGuide({\n\t\t\ttarget: guideTarget,\n\t\t\tevents: {\n\t\t\t\t'onShow': function () {\n\t\t\t\t\tthis.emit('onFilterGuideStepShow');\n\t\t\t\t}.bind(this),\n\t\t\t\t'onClose': function () {\n\t\t\t\t\tif (nextGuide)\n\t\t\t\t\t{\n\t\t\t\t\t\tnextGuide.start();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this),\n\t\t\t}\n\t\t});\n\t}\n\n\tstart()\n\t{\n\t\tif (this.#guides.length <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#guides[this.#guides.length - 1].start();\n\t}\n}","import {Type, Reflection} from 'main.core';\nimport Automation from \"./automation\";\nimport Session from './session/session';\nimport {CommandHandler} from \"./pull/command-handler\";\nimport Settings from \"./settings\";\nimport {Mode} from \"./session/mode\";\nimport {CrmDebuggerGuide} from \"./tourguide/crm-debugger-guide\";\n\nlet instance = null;\n\nexport default class Manager\n{\n\tpullHandler: CommandHandler;\n\t#settings: Settings;\n\n\tstatic get Instance(): Manager\n\t{\n\t\tif (instance === null)\n\t\t{\n\t\t\tinstance = new Manager();\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.pullHandler = new CommandHandler();\n\t\tthis.#settings = new Settings('manager');\n\t}\n\n\tinitializeDebugger(parameters = {session: {}, documentSigned: ''})\n\t{\n\t\tconst session = Type.isPlainObject(parameters.session) ? new Session(parameters.session) : null;\n\t\tif (!session)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsession.documentSigned = parameters.documentSigned;\n\n\t\tthis.requireSetFilter(session);\n\t\tthis.#showDebugger(session);\n\t}\n\n\tstartSession(documentSigned: string, modeId: number): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tSession.start(documentSigned, modeId).then(\n\t\t\t\t(session: Session) => {\n\t\t\t\t\tthis.#lastFilterId = null;\n\n\t\t\t\t\tthis.#setDebugFilter(session);\n\t\t\t\t\tconst debuggerInstance = this.#showDebugger(session, true);\n\n\t\t\t\t\tthis.#showGuide(debuggerInstance);\n\n\t\t\t\t\tresolve();\n\t\t\t\t},\n\t\t\t\treject\n\t\t\t);\n\t\t});\n\t}\n\n\tfinishSession(session: Session): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsession.finish().then(\n\t\t\t\t(response) => {\n\t\t\t\t\tthis.#removeDebugFilter(session);\n\t\t\t\t\tresolve(response);\n\t\t\t\t},\n\t\t\t\treject\n\t\t\t);\n\t\t});\n\t}\n\n\t#showDebugger(session: Session, isFirstShow: boolean = false): ?Automation\n\t{\n\t\tlet debuggerInstance = null;\n\n\t\tif (session.isAutomation())\n\t\t{\n\t\t\tdebuggerInstance = this.createAutomationDebugger({\n\t\t\t\tsession: session\n\t\t\t});\n\t\t}\n\n\t\tif (debuggerInstance)\n\t\t{\n\t\t\tconst initialShowState = session.isExperimentalMode() ? 'showExpanded' : 'showCollapsed';\n\t\t\tdebuggerInstance.getMainView()[isFirstShow ? initialShowState : 'show']();\n\n\t\t\treturn debuggerInstance;\n\t\t}\n\n\t\treturn debuggerInstance;\n\t}\n\n\t#showGuide(debuggerInstance: Automation)\n\t{\n\t\tconst guide = new CrmDebuggerGuide({\n\t\t\tgrid: Reflection.getClass('BX.CRM.Kanban.Grid') ? BX.CRM.Kanban.Grid.getInstance() : null,\n\t\t\tshowFilterStep: (this.#settings.get('filter-guide-shown') !== true),\n\t\t\tshowStageStep: (this.#settings.get('stage-guide-shown') !== true) && debuggerInstance.session.isInterceptionMode(),\n\t\t\treserveFilterIds: this.#getFilterIds(debuggerInstance.session),\n\t\t});\n\n\t\tguide.subscribe(\n\t\t\t'onFilterGuideStepShow', (function () {\n\t\t\t\tthis.#settings.set('filter-guide-shown', true)\n\t\t\t}).bind(this)\n\t\t);\n\t\tguide.subscribe(\n\t\t\t'onStageGuideStepShow', (function () {\n\t\t\t\tthis.#settings.set('stage-guide-shown', true)\n\t\t\t}).bind(this)\n\t\t);\n\n\t\tguide.start();\n\t}\n\n\trequireSetFilter(session: Session, force: boolean = false)\n\t{\n\t\tconst lastId = this.#getFilterIds(session).pop();\n\n\t\tif (lastId !== this.#lastFilterId || force)\n\t\t{\n\t\t\tthis.#setDebugFilter(session);\n\t\t}\n\t}\n\n\t#setDebugFilter(session: Session)\n\t{\n\t\tconst ids = this.#getFilterIds(session);\n\n\t\tthis.#getFilterApis(ids).forEach(\n\t\t\t({id, api}) => {\n\t\t\t\tapi.setFilter({preset_id: 'filter_robot_debugger'});\n\t\t\t\tthis.#lastFilterId = id;\n\t\t\t}\n\t\t);\n\t}\n\n\t#removeDebugFilter(session: Session)\n\t{\n\t\tconst ids = this.#getFilterIds(session);\n\n\t\tthis.#getFilterApis(ids).forEach(\n\t\t\t({api}) => {\n\t\t\t\tapi.setFilter({preset_id: 'default_filter'});\n\t\t\t\tthis.#lastFilterId = null;\n\t\t\t}\n\t\t);\n\t}\n\n\tget #lastFilterId()\n\t{\n\t\treturn this.#settings.get('last-filter-id');\n\t}\n\n\tset #lastFilterId(value: string)\n\t{\n\t\treturn this.#settings.set('last-filter-id', value);\n\t}\n\n\t/**\n\t * @return BX.Filter.Api | null\n\t */\n\t#getFilterApis(ids: []): []\n\t{\n\t\tconst apis = [];\n\n\t\tids.forEach(id => {\n\t\t\tconst filter = BX.Main.filterManager?.getById(id);\n\t\t\tif (filter)\n\t\t\t{\n\t\t\t\tapis.push({id, api: filter.getApi()});\n\t\t\t}\n\t\t});\n\n\t\treturn apis;\n\t}\n\n\t#getFilterIds(session: Session): string[]\n\t{\n\t\tlet categoryId;\n\t\tif (session && (session.modeId === Mode.interception.id) && !session.isFixed())\n\t\t{\n\t\t\tcategoryId = session.initialCategoryId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcategoryId = session?.activeDocument?.categoryId\n\t\t}\n\n\t\tconst filterId = 'CRM_DEAL_LIST_V12';\n\n\t\tif (!categoryId)\n\t\t{\n\t\t\treturn [filterId, `${filterId}_C_0`];\n\t\t}\n\n\t\treturn [`${filterId}_C_${categoryId}`];\n\t}\n\n\tcreateAutomationDebugger(parameters = {}): Automation\n\t{\n\t\treturn new Automation(parameters);\n\t}\n\n\topenDebuggerStartPage(documentSigned: string, parameters = {}): Promise\n\t{\n\t\tconst url = BX.Uri.addParam(\n\t\t\t'/bitrix/components/bitrix/bizproc.debugger.start/',\n\t\t\t{\n\t\t\t\tdocumentSigned: documentSigned,\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tautomation_enter_debug: 'Y',\n\t\t\t\t\tstart_type: parameters.analyticsStartType || 'default',\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tconst options = {\n\t\t\twidth: 745,\n\t\t\tcacheable: false,\n\t\t\tallowChangeHistory: true,\n\t\t\tevents: {},\n\t\t};\n\n\t\treturn Manager.openSlider(url, options);\n\t}\n\n\topenSessionLog(sessionId: string): Promise\n\t{\n\t\tconst url = BX.Uri.addParam(\n\t\t\t'/bitrix/components/bitrix/bizproc.debugger.log/',\n\t\t\t{\n\t\t\t\t'setTitle': 'Y',\n\t\t\t\t'sessionId': sessionId,\n\t\t\t}\n\t\t);\n\n\t\tconst options = {\n\t\t\twidth: 720,\n\t\t\tcacheable: false,\n\t\t\tallowChangeHistory: true,\n\t\t\tevents: {},\n\t\t\tnewWindowLabel: true\n\t\t};\n\n\t\treturn Manager.openSlider(url, options);\n\t}\n\n\tstatic openSlider(url, options): Promise\n\t{\n\t\tif(!Type.isPlainObject(options))\n\t\t{\n\t\t\toptions = {};\n\t\t}\n\t\toptions = {...{cacheable: false, allowChangeHistory: true, events: {}}, ...options};\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (Type.isStringFilled(url))\n\t\t\t{\n\t\t\t\tif (BX.SidePanel.Instance.open(url, options))\n\t\t\t\t{\n\t\t\t\t\treturn resolve();\n\t\t\t\t}\n\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\treturn reject();\n\t\t});\n\t}\n}\n","import Manager from \"./manager\";\nimport Session from './session/session';\nimport {Mode} from './session/mode';\nimport 'ui.fonts.opensans';\nimport 'ui.design-tokens';\n\nimport './css/style.css';\nimport './css/filter-guide.css';\nimport './css/action-panel-guide.css';\n\nconst Debugger = {\n\tManager,\n\tSession,\n\tMode,\n};\n\nexport {\n\tDebugger,\n\tManager,\n\tSession,\n\tMode,\n}"],"names":["DebuggerState","Run","NextStep","Stop","Pause","Undefined","Helper","isNumeric","num","Type","isNumber","isStringFilled","Number","toString","trim","isDate","date","Date","getTime","convertDateFromDB","toDate","parse","formatDate","format","DateTimeFormat","getOperatorsLabel","Loc","getMessage","getOperatorLabel","operator","getJoinerLabel","joiner","joiners","getColorBrightness","bgColor","replace","bigint","parseInt","r","g","b","getBgColorAdditionalClass","brightness","toHtml","text","Text","encode","AutomationMainView","EventEmitter","constructor","debuggerInstance","setEventNamespace","subscribe","bind","debugger","show","loadMainViewInfo","then","setContent","getState","showExpanded","settings","set","showCollapsed","close","destroy","handleCollapse","node","getPopupContainer","collapsed","Dom","hasClass","getZIndexComponent","setAlwaysOnTop","setResizeMode","toggleClass","clearTimeout","addClass","setWidth","setHeight","setTimeout","removeClass","get","className","Popup","titleBar","noAllPaddings","contentBackground","draggable","zIndexOptions","alwaysOnTop","width","height","events","onResizeStart","setMinWidth","setMinHeight","onResizeEnd","getWidth","getHeight","Math","max","content","Tag","render","document","createTextNode","MessageBox","message","okCaption","onOk","Manager","Instance","finishSession","session","buttons","MessageBoxButtons","OK_CANCEL","HelpHint","bindAll","hasRobots","isTemplateEmpty","activeTab","tabDocClass","tabLogClass","hasActiveDocument","isFixed","tabNoDocumentClass","fieldListNode","hasFields","querySelector","getSettingsUrl","openSessionLog","sessionId","getLogView","shouldScrollToBottom","shouldLoadPreviousLog","Button","size","ButtonSize","EXTRA_SMALL","color","ButtonColor","PRIMARY","round","noCaps","onclick","form","fields","getSet","forEach","value","append","event","activeTabName","target","dataset","tabItem","hiddenTabName","filter","tabName","navigationNode","querySelectorAll","tab","emit","button","documentFields","getDocumentFields","selectedFields","fieldsDialog","EntitySelector","Dialog","targetNode","multiple","dropdownMode","enableSearch","cacheable","items","field","Watchable","map","title","Name","id","Id","customData","entityId","tabs","selected","has","showAvatars","getData","item","getId","compactView","getCustomData","fieldNode","add","fieldId","delete","remove","contentNode","isString","getDocumentField","getDocumentValue","hasTriggers","templateTriggers","length","documentStatus","getTemplate","DOCUMENT_STATUS","Tracker","getGlobalContext","logs","track","init","tracker","triggers","TriggerManager","TRIGGERS","ViewMode","view","templateData","template","Template","constants","variables","templateContainerNode","delayMinLimitM","intoRaw","newTemplate","isNil","icon","ButtonIcon","START","hasEvents","hasWorkflowEvents","setWaiting","startDebugTemplate","infoNode","emulateExternalEvent","data","getDocumentStatus","reInit","preventDefault","statusList","getStatusList","menu","Menu","bindElement","stage","NAME","statusId","getMenuWindow","setDocumentStatus","status","find","TITLE","COLOR","isShown","automationContentNode","loader","Loader","statusTitleNode","statusTitle","textContent","parentNode","setAttribute","statusBgNode","style","backgroundColor","borderColor","documentStatusNode","prepend","triggersHeaderNode","tplNode","values","Object","keys","key","valueNode","workflowId","WorkflowStatus","COMPLETED","TERMINATED","includes","popupContainer","getElementsByClassName","state","setIcon","PAUSE","getContainer","nextElementSibling","Mode","isMode","modeId","getMode","experimental","interception","getAllModes","code","Document","options","SessionId","DocumentId","toInteger","DocumentCategoryId","DateExpire","DocumentSigned","documentSigned","documentId","categoryId","Session","isPlainObject","StartedBy","String","ShortDescription","Boolean","Active","Fixed","CategoryId","Documents","isActive","pullHandler","activeDocument","startedBy","shortDescription","initialCategoryId","isSessionStartedByUser","userId","isAutomation","isInterceptionMode","isExperimentalMode","start","Promise","resolve","reject","ajax","runAction","mode","analyticsLabel","automation_select_debug_mode","mode_type","response","finish","fixateDocument","removeDocuments","ids","documentIds","documents","isArrayFilled","push","rawValues","requireSetFilter","unsubscribeAll","unsubscribe","RobotLog","robotInfo","name","delayName","conditionNames","getActivitiesName","names","concat","previousRobotTitle","renderTrack","excludedTypes","TrackingEntry","EXECUTE_ACTIVITY_TYPE","ATTACHED_ENTITY_TYPE","type","DelayInterval","index","datetime","logNode","time","renderIndex","AutomationLogView","renderTime","CLOSE_ACTIVITY_TYPE","DEBUG_AUTOMATION_TYPE","note","JSON","delayInterval","fieldName","DelayIntervalSelector","getBasisField","basis","fieldValue","delay","SystemExpression","conditionNode","result","colorCondition","condition","renderedNote","collapseInfoResults","DEBUG_ACTIVITY_TYPE","DEBUG_LINK_TYPE","colorBox","CANCEL_ACTIVITY_TYPE","FAULT_ACTIVITY_TYPE","ERROR_ACTIVITY_TYPE","label","link","TriggerLog","addTrack","initializeWorkflowRobotsRenderer","onTrackAdded","getMainView","subscribeOnce","workflowRobots","isUndefined","prevRobotTitle","i","robot","Robot","none","Condition","robotLogger","getTitle","DelayName","isExecuteAfterPrevious","activityName","should","setPreviousLog","children","startRendering","renderTo","element","shift","padStart","renderStatusChange","parsedTrackNote","sourceStage","getStatusSettings","destinationStage","entryBuilder","TrackingEntryBuilder","setLogEntry","row","build","infoResults","firstElementChild","clientHeight","moreInfoNode","Event","loadAllLog","loadRobotsByWorkflowId","console","info","logFromDB","builder","assign","startedDate","dateNode","description","descriptionNode","categoryName","scrollNode","scrollMax","scrollHeight","scrollTop","unbind","from","to","end","increment","duration","diff","currentPosition","requestFrame","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","animateScroll","easeInOutQuad","cancelFrame","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","current","Settings","section","Array","Set","BX","localStorage","ActionPanelGuide","Guide","steps","top","bottom","onEvents","getPopup","showNextStep","CustomCrmActionPanel","grid","UI","ActionPanel","removeLeftPosition","maxHeight","parentPosition","autoHide","onHideActionPanelHandler","actionPanel","fixEntityAction","checkedIds","guide","getItemById","layout","container","article","stopActionPanel","removeEntityAction","hidePanel","reload","resetActionPanel","appendItem","getCheckedId","actionId","errors","error","Automation","parameters","pullHandlers","func","handleExternalDocumentStatus","handleExternalDocumentValues","handleExternalDocumentDelete","handleExternalWorkflowStatus","handleExternalWorkflowEventAdd","handleExternalWorkflowEventRemove","handleExternalTrackRow","getWorkflowStatus","newStatus","trigger","IS_EXTERNAL_MODIFIED","ROBOTS","debuggerState","eventId","documentCategoryId","documentValues","workflowStatus","workflowEvents","setFields","setStatusList","setStatus","RUNNING","eventName","join","getField","object","ObjectId","Expression","Reflection","getClass","gridInstance","CRM","Kanban","Grid","getInstance","setCustomActionPanel","gridData","entityType","params","hasOwnProperty","CATEGORY_ID","context","Context","rawDocumentType","canEdit","canManage","setGlobalContext","pull","noDocumentError","alert","CommandHandler","PULL","isFunction","getModuleId","getSubscriptionType","PullClient","SubscriptionType","Server","getMap","command","extra","FilterGuide","bindEvents","StageGuide","CrmDebuggerGuide","reserveFilterIds","showStageStep","stageStep","showFilterStep","filterGuide","firstColumn","getColumns","guideTarget","getTitleContainer","nextGuide","classList","filterId","gridId","Main","filterManager","getById","filterApi","getApi","parent","getPopupBindElement","instance","initializeDebugger","startSession","force","lastId","pop","createAutomationDebugger","openDebuggerStartPage","url","Uri","addParam","automation_enter_debug","start_type","analyticsStartType","allowChangeHistory","openSlider","newWindowLabel","SidePanel","open","isFirstShow","initialShowState","api","setFilter","preset_id","apis","Debugger"],"mappings":"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"}