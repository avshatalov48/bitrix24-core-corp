{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection, Tag, Type, Loc, Event, Dom, Text} from 'main.core';\nimport {Globals} from 'bizproc.globals';\nimport {Dialog} from 'ui.entity-selector';\nimport 'bp_field_type';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Activity');\n\nclass SetGlobalVariableActivity {\n\tisRobot: boolean;\n\tdocumentType;\n\tsignedDocumentType: string;\n\n\tvariables: object;\n\tconstants: object;\n\tdocumentFields: object;\n\n\tcurrentValues: object;\n\tvisibilityMessages: object;\n\tformName: string;\n\n\taddRowTable: HTMLDivElement | HTMLTableElement;\n\n\tgVarObjectName: string;\n\tgConstObjectName: string;\n\tdocumentObjectName: string;\n\thelperObjectName: string;\n\n\taddRowTableNodeId: string;\n\taddButtonNodeId: string;\n\thiddenInputsNodeId: string;\n\tvariableRole: string;\n\tparameterRole: string;\n\n\tindexAttributeName: string;\n\tinputIndexAttributeName: string;\n\n\tavailableOptions: Map;\n\tavailableOptionsByGroupId: Map;\n\n\trowIndex: number;\n\tnumberOfTypes: number;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options)) {\n\t\t\tthis.isRobot = options.isRobot;\n\t\t\tthis.documentType = options.documentType;\n\t\t\tthis.signedDocumentType = options.signedDocumentType;\n\n\t\t\tthis.variables = options.variables;\n\t\t\tthis.constants = options.constants ?? {};\n\t\t\tthis.documentFields = options.documentFields ?? {};\n\n\t\t\tthis.currentValues = options.currentValues;\n\t\t\tthis.visibilityMessages = options.visibilityMessages;\n\t\t\tthis.formName = options.formName;\n\n\t\t\tthis.addRowTable = options.addRowTable;\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tthis.initObjectNames();\n\t\tthis.initNodeIdNames();\n\t\tthis.initNodeAttributeNames();\n\t\tthis.initAvailableOptions();\n\n\t\tthis.rowIndex = -1;\n\t\tthis.numberOfTypes = 9;\n\n\t\tconst addAssignmentExpression = this.isRobot ? 'addAssignmentExpressionRobot' : 'addAssignmentExpressionDesigner';\n\t\tif (Object.keys(this.currentValues).length <= 0) {\n\t\t\tthis[addAssignmentExpression]();\n\t\t}\n\t\tfor (const variableExpression in this.currentValues) {\n\t\t\tthis[addAssignmentExpression](variableExpression, this.currentValues[variableExpression]);\n\t\t}\n\n\t\tif (this.isRobot)\n\t\t{\n\t\t\t//this.addExpressionButtonRobot();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addExpressionButtonDesigner()\n\t\t}\n\n\t}\n\n\tinitObjectNames()\n\t{\n\t\tthis.gVarObjectName = 'GlobalVar';\n\t\tthis.gConstObjectName = 'GlobalConst';\n\t\tthis.documentObjectName = 'Document';\n\t\tthis.helperObjectName = 'Default';\n\t}\n\n\tisGVariableVisibility(visibility)\n\t{\n\t\treturn visibility.startsWith(this.gVarObjectName);\n\t}\n\n\tisGConstantVisibility(visibility)\n\t{\n\t\treturn visibility.startsWith(this.gConstObjectName);\n\t}\n\n\tisDocumentVisibility(visibility)\n\t{\n\t\treturn visibility.startsWith(this.documentObjectName);\n\t}\n\n\tisHelperVisibility(visibility)\n\t{\n\t\treturn visibility.startsWith(this.helperObjectName);\n\t}\n\n\tinitNodeIdNames()\n\t{\n\t\tthis.addRowTableNodeId = 'bp_sgva_addrow_table';\n\t\tthis.addButtonNodeId = 'bp_sgva_add_button';\n\t\tthis.hiddenInputsNodeId = 'bp_sgva_results_';\n\t\tthis.variableRole = 'bp_sgva_variable_';\n\t\tthis.parameterRole = 'bp_sgva_value_';\n\t}\n\n\tinitNodeAttributeNames()\n\t{\n\t\tthis.indexAttributeName = 'bp_sgva_index';\n\t\tthis.inputIndexAttributeName = 'bp_sgva_input_index';\n\t}\n\n\tinitAvailableOptions()\n\t{\n\t\tthis.availableOptions = this.getAvailableOptions();\n\t\tthis.availableOptionsByGroupId = this.getAvailableOptionsByGroup();\n\t}\n\n\tgetAvailableOptions()\n\t{\n\t\tconst options = new Map();\n\t\tthis.fillOptions(this.variables, options);\n\t\tthis.fillOptions(this.constants, options);\n\t\tthis.fillOptions(this.documentFields, options);\n\n\t\toptions.set('variable', {\n\t\t\tid: '',\n\t\t\ttitle: BX.message('BPSGVA_VARIABLE'),\n\t\t\tcustomData: {\n\t\t\t\tproperty: {Type: 'string', Multiple: false},\n\t\t\t\tgroupId: this.helperObjectName,\n\t\t\t\ttitle: BX.message('BPSGVA_VARIABLE')\n\t\t\t}\n\t\t});\n\n\t\toptions.set('parameter', {\n\t\t\tid: '',\n\t\t\ttitle: BX.message('BPSGVA_PARAMETER'),\n\t\t\tcustomData: {\n\t\t\t\tproperty: {Type: 'string', Multiple: false},\n\t\t\t\tgroupId: this.helperObjectName,\n\t\t\t\ttitle: BX.message('BPSGVA_PARAMETER')\n\t\t\t}\n\t\t});\n\n\t\toptions.set('clear', {\n\t\t\tid: '',\n\t\t\ttitle: BX.message('BPSGVA_CLEAR'),\n\t\t\tcustomData: {\n\t\t\t\tproperty: {Type: 'string', Multiple: false},\n\t\t\t\tgroupId: this.helperObjectName,\n\t\t\t\ttitle: BX.message('BPSGVA_CLEAR')\n\t\t\t}\n\t\t});\n\n\t\treturn options;\n\t}\n\n\tfillOptions(source, options)\n\t{\n\t\tlet optionId, optionProperty, optionsSource;\n\n\t\tfor (const groupName in source) {\n\t\t\toptionsSource = source[groupName];\n\n\t\t\tif (optionsSource['children']) {\n\t\t\t\toptionsSource = optionsSource['children'];\n\t\t\t}\n\n\t\t\tfor (const i in optionsSource) {\n\t\t\t\toptionId = optionsSource[i]['id'];\n\t\t\t\toptionProperty = optionsSource[i];\n\t\t\t\toptions.set(optionId, optionProperty);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAvailableOptionsByGroup()\n\t{\n\t\tconst options = new Map();\n\t\tthis.fillOptionsByGroupWithGlobals(this.variables, options, this.gVarObjectName);\n\t\tthis.fillOptionsByGroupWithGlobals(this.constants, options, this.gConstObjectName);\n\n\t\tconst items = [];\n\t\tfor (const i in this.documentFields) {\n\t\t\titems.push(this.documentFields[i]);\n\t\t}\n\t\toptions.set(this.documentObjectName + ':' + this.documentObjectName, items);\n\n\t\treturn options;\n\t}\n\n\tfillOptionsByGroupWithGlobals(source, options, topGroupName)\n\t{\n\t\tfor (const subGroupName in source) {\n\t\t\tconst key = topGroupName + ':' + subGroupName;\n\t\t\toptions.set(key, source[subGroupName]);\n\t\t}\n\t}\n\n\taddAssignmentExpressionRobot(variableId, values) {\n\t\tif (Type.isString(values)) {\n\t\t\tvalues = {0: values};\n\t\t}\n\n\t\tconst incomingData = {variable: variableId, values};\n\t\tthis.modifyIncomingDataRobot(incomingData);\n\n\t\tconst addRowTable = this.addRowTable;\n\t\tthis.rowIndex++;\n\t\tconst newRow = Tag.render`<div class=\"bizproc-automation-popup-settings\"></div>`;\n\n\t\tconst rowInputs = Tag.render`<div id=\"${this.hiddenInputsNodeId + this.rowIndex}\"></div>`;\n\n\t\tconst dataRow = Tag.render`\n\t\t\t<div \n\t\t\t\tclass=\"bizproc-automation-popup-settings bizproc-automation-popup-settings-text\" \n\t\t\t\tstyle=\"display: flex; align-items: flex-start\"\n\t\t\t></div>\n\t\t`;\n\t\tdataRow.appendChild(this.createVariableRowRobot(incomingData.variable, rowInputs));\n\n\t\tconst parameterRowWrapper = Tag.render`<div class=\"bizproc-automation-popup-settings-title\"></div>`;\n\t\tparameterRowWrapper.setAttribute('data-role', this.parameterRole + this.rowIndex);\n\n\t\tif (incomingData.values.length <= 0)\n\t\t{\n\t\t\tconst option = BX.clone(this.getOptionPropertiesRobot('clear'));\n\t\t\toption['multiple'] = incomingData.variable.property.Multiple;\n\t\t\toption['type'] = incomingData.variable.property.Type;\n\t\t\toption['inputIndex'] = 0;\n\t\t\tparameterRowWrapper.appendChild(this.createParameterRowRobot(this.rowIndex, option, rowInputs));\n\t\t}\n\t\tfor (const i in incomingData.values)\n\t\t{\n\t\t\tconst option = BX.clone(incomingData.values[i]);\n\t\t\toption['multiple'] = incomingData.variable.property.Multiple;\n\t\t\toption['type'] = incomingData.variable.property.Type;\n\t\t\toption['inputIndex'] = i;\n\t\t\tparameterRowWrapper.appendChild(this.createParameterRowRobot(this.rowIndex, option, rowInputs));\n\t\t}\n\n\t\tif (incomingData.variable.property.Multiple && incomingData.variable.property.Type !== 'user')\n\t\t{\n\t\t\tparameterRowWrapper.appendChild(this.createAddParameterRowRobot(this.rowIndex, incomingData.values.length));\n\t\t}\n\n\t\tdataRow.appendChild(parameterRowWrapper);\n\n\t\tnewRow.appendChild(dataRow);\n\t\tnewRow.appendChild(rowInputs);\n\n\t\taddRowTable.appendChild(newRow);\n\t}\n\n\tmodifyIncomingDataRobot(incomingData)\n\t{\n\t\tconst option = this.getOptionPropertiesRobot(incomingData.variable);\n\t\tif (incomingData.variable === undefined || option.groupId === this.helperObjectName + ':text')\n\t\t{\n\t\t\tincomingData.variable = BX.clone(this.getOptionPropertiesRobot('variable'));\n\t\t\tconst valueOption = BX.clone(this.getOptionPropertiesRobot('parameter'));\n\t\t\tincomingData.values = [{\n\t\t\t\tid: valueOption.id,\n\t\t\t\ttitle: valueOption.title\n\t\t\t}];\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet valuesOptions = [];\n\n\t\tswitch (option.property.Type)\n\t\t{\n\t\t\tcase 'select':\n\t\t\t\tvaluesOptions = this.getIncomingValuesSelect(incomingData);\n\t\t\t\tbreak;\n\t\t\tcase 'bool':\n\t\t\t\tvaluesOptions = this.getIncomingValuesBool(incomingData);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfor (const i in incomingData.values)\n\t\t\t\t{\n\t\t\t\t\tlet valueOption = this.getOptionPropertiesRobot(incomingData.values[i]);\n\t\t\t\t\tif (incomingData.values[i] === '')\n\t\t\t\t\t{\n\t\t\t\t\t\tvalueOption = this.getOptionPropertiesRobot('clear');\n\t\t\t\t\t}\n\t\t\t\t\tvaluesOptions.push({\n\t\t\t\t\t\tid: valueOption.id,\n\t\t\t\t\t\ttitle: valueOption.title\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t}\n\n\t\tincomingData.variable = BX.clone(option);\n\t\tincomingData.values = valuesOptions;\n\t}\n\n\tgetOptionPropertiesRobot(optionId)\n\t{\n\t\tconst option = this.availableOptions.get(optionId);\n\t\tif (option === undefined) {\n\t\t\treturn this.getDefaultOptionProperties(optionId);\n\t\t}\n\n\t\treturn this.getShortOptionProperties(option);\n\t}\n\n\tgetDefaultOptionProperties(optionId)\n\t{\n\t\treturn {\n\t\t\tid: optionId,\n\t\t\tproperty: {Type: 'string', Multiple: false},\n\t\t\tgroupId: this.helperObjectName + ':text',\n\t\t\ttitle: optionId\n\t\t};\n\t}\n\n\tgetShortOptionProperties(option)\n\t{\n\t\treturn {\n\t\t\tid: option.id,\n\t\t\tproperty: option.customData.property,\n\t\t\tgroupId: option.customData.groupId,\n\t\t\ttitle: option.customData.title\n\t\t};\n\t}\n\n\tgetIncomingValuesSelect(incomingData)\n\t{\n\t\tconst option = this.getOptionPropertiesRobot(incomingData.variable);\n\t\tlet title, valueOption, valuesOptions = [], isExpressionOption;\n\n\t\tfor (const i in incomingData.values)\n\t\t{\n\t\t\ttitle = BX.message('BPSGVA_CLEAR');\n\t\t\tif (incomingData.values[i] !== '')\n\t\t\t{\n\t\t\t\tvalueOption = this.getOptionPropertiesRobot(incomingData.values[i]);\n\t\t\t\tisExpressionOption = true;\n\t\t\t\ttitle = valueOption.title;\n\t\t\t}\n\t\t\tif (option.property.Options[incomingData.values[i]] !== undefined)\n\t\t\t{\n\t\t\t\tisExpressionOption = false;\n\t\t\t\ttitle = option.property.Options[incomingData.values[i]];\n\t\t\t}\n\n\t\t\tvaluesOptions.push({\n\t\t\t\tid: incomingData.values[i],\n\t\t\t\ttitle,\n\t\t\t\tisExpressionOption\n\t\t\t});\n\t\t}\n\n\t\treturn valuesOptions;\n\t}\n\n\tgetIncomingValuesBool(incomingData)\n\t{\n\t\tlet title, valueOption, valuesOptions = [];\n\n\t\tfor (const i in incomingData.values)\n\t\t{\n\t\t\tlet isExpressionOption = false;\n\t\t\tswitch (incomingData.values[i])\n\t\t\t{\n\t\t\t\tcase 'Y':\n\t\t\t\t\ttitle = BX.message('BPSGVA_BOOL_YES');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'N':\n\t\t\t\t\ttitle = BX.message('BPSGVA_BOOL_NO');\n\t\t\t\t\tbreak;\n\t\t\t\tcase '':\n\t\t\t\t\ttitle = BX.message('BPSGVA_CLEAR');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvalueOption = this.getOptionPropertiesRobot(incomingData.values[i]);\n\t\t\t\t\ttitle = valueOption.title;\n\t\t\t\t\tisExpressionOption = true;\n\t\t\t}\n\t\t\tvaluesOptions.push({\n\t\t\t\tid: incomingData.values[i],\n\t\t\t\ttitle,\n\t\t\t\tisExpressionOption\n\t\t\t});\n\t\t}\n\n\t\treturn valuesOptions;\n\t}\n\n\tcreateVariableRowRobot(variableData, rowInputs)\n\t{\n\t\tconst div = Tag.render`<div></div>`;\n\t\tconst variableNode = Tag.render`\n\t\t\t<span class=\"bizproc-automation-popup-settings-link setglobalvariableactivity-underline\"></span>\n\t\t`;\n\t\tvariableNode.setAttribute('data-role', this.variableRole + this.rowIndex);\n\t\tvariableNode.setAttribute(this.indexAttributeName, String(this.rowIndex));\n\n\t\tconst data = this.getDataForTitleReplacement(variableData, variableNode.getAttribute('data-role'));\n\t\tdata.multiple = false;\n\t\tdata.type = 'string';\n\t\tdata.inputIndex = 0;\n\t\tif (data.title === '')\n\t\t{\n\t\t\tdata.title = BX.message('BPSGVA_VARIABLE');\n\t\t}\n\t\tthis.replaceTitleAndHiddenInputRobot(variableNode, data, rowInputs);\n\n\t\tBX.bind(variableNode, 'click', BX.proxy(this.onVariableSelectClickRobot, this));\n\n\t\tdiv.appendChild(variableNode);\n\n\t\treturn div;\n\t}\n\n\tcreateParameterRowRobot(index, valueData, rowInputs)\n\t{\n\t\tconst wrapper = Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-settings-title setglobalvariableactivity-parameter-wrapper\"></div>\n\t\t`;\n\n\t\tconst equal = Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-settings-title setglobalvariableactivity-symbol-equal\"> = </div>\n\t\t`;\n\n\t\tconst div = Tag.render`<div></div>`;\n\t\tconst parameter = Tag.render`\n\t\t\t<span class=\"bizproc-automation-popup-settings-link setglobalvariableactivity-underline\"></span>\n\t\t`;\n\t\tparameter.setAttribute('data-role', this.parameterRole + index)\n\t\tparameter.setAttribute(this.indexAttributeName, String(index));\n\t\tparameter.setAttribute(this.inputIndexAttributeName, String(valueData.inputIndex));\n\n\t\twrapper.appendChild(equal);\n\t\tdiv.appendChild(parameter);\n\t\twrapper.appendChild(div);\n\n\t\tconst data = BX.clone(this.getDataForTitleReplacement(valueData, parameter.getAttribute('data-role')));\n\t\tdata.isExpressionOption = valueData.isExpressionOption;\n\t\tif (data.title === '')\n\t\t{\n\t\t\tdata.title = BX.message('BPSGVA_CLEAR');\n\t\t}\n\t\tthis.replaceTitleAndHiddenInputRobot(parameter, data, rowInputs);\n\n\t\tBX.bind(parameter, 'click', BX.proxy(\n\t\t\t(event) => {\n\t\t\t\tthis.onParameterSelectClickRobot(event, valueData.inputIndex)\n\t\t\t},\n\t\t\tthis)\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetDataForTitleReplacement(data, role)\n\t{\n\t\treturn {\n\t\t\tinputValue: data.id,\n\t\t\ttitle: data.title,\n\t\t\tmultiple: data.multiple,\n\t\t\ttype: data.type,\n\t\t\tinputIndex: data.inputIndex,\n\t\t\tproperty: data.property,\n\t\t\trole\n\t\t};\n\t}\n\n\treplaceTitleAndHiddenInputRobot(target, data, rowInputs)\n\t{\n\t\ttarget.innerText = this.getTitleForReplacement(data) ?? data.title;\n\t\tthis.replaceHiddenInputRobot(data, rowInputs);\n\t}\n\n\tgetTitleForReplacement(data)\n\t{\n\t\tconst type = data.type;\n\t\tconst title = data.title;\n\t\tconst value = data.inputValue;\n\n\t\tif (type === 'bool')\n\t\t{\n\t\t\tif (['Y', 'N'].includes(value))\n\t\t\t{\n\t\t\t\treturn BX.Bizproc.FieldType.formatValuePrintable({Type: type}, value);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.Bizproc.FieldType.formatValuePrintable({Type: type}, title);\n\t}\n\n\treplaceHiddenInputRobot(data, rowInputs)\n\t{\n\t\tconst inputValue = data.inputValue;\n\t\tconst role =  data.role + '_input';\n\t\tlet input = document.querySelectorAll('[data-role=\"' + role + '\"]');\n\n\t\t// single input\n\t\tif (input.length >= 1 && !data.multiple)\n\t\t{\n\t\t\tinput[0].name = data.isExpressionOption ? data.role + '_text' : data.role;\n\t\t\tinput[0].value = data.inputValue;\n\n\t\t\treturn;\n\t\t}\n\n\t\t// multiple input\n\t\tif (input.length >= 1 && data.multiple)\n\t\t{\n\t\t\tconst inputKeys = Object.keys(input);\n\t\t\tfor (const i in inputKeys)\n\t\t\t{\n\t\t\t\tconst inputIndex = input[inputKeys[i]].getAttribute(this.inputIndexAttributeName);\n\t\t\t\tif (data.inputIndex === inputIndex)\n\t\t\t\t{\n\t\t\t\t\tinput[i].name = data.isExpressionOption ? data.role + '_text' : data.role + '[]';\n\t\t\t\t\tinput[i].value = data.inputValue;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// create input\n\t\tinput = Tag.render`<input type=\"hidden\"\">`;\n\t\tif (data.isExpressionOption)\n\t\t{\n\t\t\tinput.name = data.role + '_text';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tinput.name = data.multiple ? data.role + '[]' : data.role;\n\t\t}\n\n\t\tinput.value = inputValue;\n\t\tinput.setAttribute('data-role', role);\n\t\tinput.setAttribute(this.inputIndexAttributeName, String(data.inputIndex));\n\t\trowInputs.appendChild(input);\n\t}\n\n\tonVariableSelectClickRobot(event)\n\t{\n\t\tconst target = event.target;\n\t\tconst inputValue = this.getVariableInputValue(target.getAttribute('data-role'));\n\t\tconst index = target.getAttribute(this.indexAttributeName);\n\n\t\tconst form = this.createFormForMenuRobot('variable', inputValue, index);\n\n\t\tconst me = this;\n\t\tconst popup = new BX.PopupWindow(target.id + '_popup', target, {\n\t\t\tclassName: 'bizproc-automation-popup-set',\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetTop: 5,\n\t\t\toverlay: {backgroundColor: 'transparent'},\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: BX.message('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: 'webform-button webform-button-create',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst rowInputs = document.getElementById(me.hiddenInputsNodeId + index);\n\t\t\t\t\t\t\tconst input = me.findInputInFormRobot(form);\n\n\t\t\t\t\t\t\tconst data = me.getDataForTitleReplacement(\n\t\t\t\t\t\t\t\tme.getOptionPropertiesRobot(input.value),\n\t\t\t\t\t\t\t\ttarget.getAttribute('data-role')\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdata.multiple = false;\n\t\t\t\t\t\t\tdata.type = 'string';\n\t\t\t\t\t\t\tdata.inputIndex = target.getAttribute(me.inputIndexAttributeName) ?? '0';\n\t\t\t\t\t\t\tif (data.title === '')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdata.title = BX.message('BPSGVA_VARIABLE');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tme.replaceTitleAndHiddenInputRobot(target, data, rowInputs);\n\t\t\t\t\t\t\tme.changeParameterExpressionRobot(index, data);\n\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext: BX.message('BIZPROC_AUTOMATION_CMP_CANCEL'),\n\t\t\t\t\tclassName: 'popup-window-button-link',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function ()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tgetVariableInputValue(role)\n\t{\n\t\tconst inputRole = role + '_input';\n\t\tconst inputs = document.querySelectorAll('[data-role=\"' + inputRole + '\"]');\n\n\t\treturn (inputs.length >= 1) ? inputs['0'].value : '';\n\t}\n\n\tcreateFormForMenuRobot(typeMenu, inputValue, index)\n\t{\n\t\tconst me = this;\n\n\t\tconst form = Tag.render`<form class=\"bizproc-automation-popup-select-block\"></form>`;\n\n\t\tconst fieldsListWrapper = Tag.render`<div class=\"bizproc-automation-popup-settings\"></div>`;\n\t\tconst labelFieldsList = Tag.render`<div class=\"bizproc-automation-robot-settings-title\"></div>`;\n\t\tlabelFieldsList.innerText = BX.message('BPSGVA_LIST_OF_VALUES');\n\n\t\tconst formInputWrapper = this.createInputForMenuFormRobot(typeMenu, index, inputValue);\n\t\tconst formInput = this.findInputInFormRobot(formInputWrapper);\n\n\t\tconst filterType = (typeMenu === 'variable')\n\t\t\t? 'string'\n\t\t\t: this.getVariableOptionFromVariableInput(index).property.Type\n\t\t;\n\n\t\tconst fieldsSelectNode = Tag.render`<div class=\"bizproc-automation-popup-settings-dropdown\" readonly=\"readonly\"></div>`;\n\t\tBX.bind(fieldsSelectNode, 'click', () => {\n\t\t\tconst items = me.availableOptionsByGroupId.get(visibilitySelect.value) ?? [];\n\t\t\tconst filterItems = me.filterItemsInStandardMenuRobot(filterType, items);\n\t\t\tconst visibilityInfo = me.getVisibilityInfoForDialog(visibilitySelect.value);\n\n\t\t\tconst dialogOptions = me.getDialogOptions(filterItems, visibilityInfo);\n\t\t\tdialogOptions['targetNode'] = fieldsSelectNode;\n\t\t\tdialogOptions['events'] = {\n\t\t\t\t'Item:onBeforeSelect': (event) => {\n\t\t\t\t\tconst dialogItem = event.data.item;\n\t\t\t\t\tfieldsSelectNode.innerText = dialogItem.customData.get('title');\n\t\t\t\t\tif (!formInput)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(Tag.render`<input type=\"hidden\" name=\"bp_sgva_field_input\" value=\"${Text.encode(dialogItem.id)}\">`, formInputWrapper);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (formInput.tagName !== 'SELECT')\n\t\t\t\t\t{\n\t\t\t\t\t\tformInput.value = dialogItem.id;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tme.resolveAdditionOptionInSelectRobot(formInput, dialogItem);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonHide: (event) => {\n\t\t\t\t\tevent.target.destroy();\n\t\t\t\t},\n\t\t\t\t'Search:onItemCreateAsync': (event) => {\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tconst query = event.getData().searchQuery.query;\n\t\t\t\t\t\tconst dialog = event.getTarget();\n\t\t\t\t\t\tconst context = {\n\t\t\t\t\t\t\tvisibilityInfo,\n\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tme.onCreateGlobalsClick(dialog, context, query, me, resolve);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst dialog = new Dialog(dialogOptions);\n\n\t\t\tif (filterItems.length <= 0) {\n\t\t\t\tdialog.setFooter(me.getFooter({visibilityInfo, index}, dialog));\n\t\t\t}\n\n\t\t\tdialog.show();\n\t\t});\n\n\t\tconst visibilityWrapper = Tag.render`<div class=\"bizproc-automation-popup-settings\"></div>`;\n\n\t\tconst visibilitySelect = Tag.render`<select class=\"bizproc-automation-popup-settings-dropdown\"></select>`;\n\t\tBX.bind(visibilitySelect, 'change', BX.proxy(() => {\n\t\t\tme.changeParameterSelectInFormRobot(visibilitySelect.value, fieldsSelectNode, labelFieldsList, formInputWrapper)\n\t\t}, this));\n\n\t\tconst visibilityOptions = this.getVisibilityNamesForSelect(typeMenu);\n\t\tfor (const groupId in visibilityOptions)\n\t\t{\n\t\t\tconst optionNode = Tag.render`\n\t\t\t\t<option value=\"${BX.util.htmlspecialchars(groupId)}\">\n\t\t\t\t\t${BX.util.htmlspecialchars(visibilityOptions[groupId])}\n\t\t\t\t</option>\n\t\t\t`;\n\t\t\tvisibilitySelect.appendChild(optionNode);\n\t\t}\n\n\t\tconst option = this.getOptionPropertiesRobot(inputValue);\n\t\tif (option.groupId === this.helperObjectName)\n\t\t{\n\t\t\toption.groupId = this.helperObjectName + ':text';\n\t\t\toption.id = inputValue;\n\t\t}\n\n\t\tvisibilitySelect.value = this.getVisibilityRelativeToVariableType(option, filterType);\n\t\tif (visibilitySelect.selectedIndex === -1)\n\t\t{\n\t\t\tvisibilitySelect.selectedIndex = 0;\n\t\t}\n\t\tthis.changeParameterSelectInFormRobot(visibilitySelect.value, fieldsSelectNode, labelFieldsList, formInputWrapper);\n\t\tfieldsSelectNode.innerText = (option.title !== '') ? option.title : BX.message('BPSGVA_EMPTY');\n\n\t\tif (visibilitySelect.value === this.helperObjectName + ':text' && option.groupId !== this.helperObjectName + ':text')\n\t\t{\n\t\t\tif (formInput)\n\t\t\t{\n\t\t\t\tformInput.value = this.convertFieldExpression(option);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (formInput)\n\t\t\t{\n\t\t\t\tformInput.value = option.id;\n\t\t\t}\n\t\t}\n\n\t\tvisibilityWrapper.appendChild(Tag.render`\n\t\t\t<div class=\"bizproc-automation-robot-settings-title\">\n\t\t\t\t${BX.util.htmlspecialchars(BX.message('BPSGVA_TYPE_OF_PARAMETER'))}\n\t\t\t</div>\n\t\t`);\n\t\tvisibilityWrapper.appendChild(visibilitySelect);\n\n\t\tfieldsListWrapper.appendChild(labelFieldsList);\n\t\tfieldsListWrapper.appendChild(fieldsSelectNode);\n\t\tfieldsListWrapper.append(formInputWrapper);\n\n\t\tform.appendChild(visibilityWrapper);\n\t\tform.appendChild(fieldsListWrapper);\n\n\t\treturn form;\n\t}\n\n\tcreateInputForMenuFormRobot(type, index, inputValue)\n\t{\n\t\tif (type === 'variable')\n\t\t{\n\t\t\tconst wrapper = Tag.render`<div class=\"bizproc-automation-popup-select\"></div>`;\n\t\t\tconst input = Tag.render`<input class=\"bizproc-automation-popup-input\" type=\"hidden\" style=\"width: 280px\">`;\n\t\t\twrapper.appendChild(input);\n\n\t\t\treturn wrapper;\n\t\t}\n\n\t\tconst variableOption = this.getVariableOptionFromVariableInput(index);\n\n\t\tlet wrapper;\n\t\tswitch (variableOption.property.Type)\n\t\t{\n\t\t\tcase 'user':\n\t\t\t\twrapper = BX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tthis.documentType,\n\t\t\t\t\tvariableOption.property,\n\t\t\t\t\t'bp_sgva_field_input',\n\t\t\t\t\tinputValue\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 'select':\n\t\t\tcase 'bool':\n\t\t\t\twrapper = BX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tthis.documentType,\n\t\t\t\t\t{\n\t\t\t\t\t\tType: variableOption.property.Type,\n\t\t\t\t\t\tOptions: variableOption.property.Options\n\t\t\t\t\t},\n\t\t\t\t\t'bp_sgva_field_input',\n\t\t\t\t\tinputValue\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\twrapper = BX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tthis.documentType,\n\t\t\t\t\t{Type: variableOption.property.Type},\n\t\t\t\t\t'bp_sgva_field_input',\n\t\t\t\t\tvariableOption.id\n\t\t\t\t);\n\t\t}\n\n\t\twrapper.style.width = '280px';\n\t\tconst input = this.findInputInFormRobot(wrapper);\n\t\tif (['bool', 'select'].includes(variableOption.property.Type))\n\t\t{\n\t\t\tif (input.value !== inputValue)\n\t\t\t{\n\t\t\t\tconst option = this.getOptionPropertiesRobot(inputValue);\n\t\t\t\tthis.resolveAdditionOptionInSelectRobot(input, option);\n\t\t\t}\n\t\t}\n\n\t\tif (input)\n\t\t{\n\t\t\tinput.style.width = '100%';\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tgetVariableOptionFromVariableInput(index)\n\t{\n\t\tconst variableInput = document.querySelector('[data-role=\"' + this.variableRole + index + '_input\"]');\n\t\tconst variableId = variableInput ? variableInput.value: '';\n\n\t\treturn this.getOptionPropertiesRobot(variableId);\n\t}\n\n\tfindInputInFormRobot(form)\n\t{\n\t\tlet inputs = form.getElementsByTagName('input');\n\t\tif (inputs.length >= 1)\n\t\t{\n\t\t\treturn inputs[inputs.length - 1];\n\t\t}\n\n\t\tinputs = form.getElementsByTagName('textarea');\n\t\tif (inputs.length >= 1)\n\t\t{\n\t\t\treturn inputs[inputs.length - 1];\n\t\t}\n\n\t\tinputs = form.getElementsByTagName('select');\n\t\tif (inputs.length >= 1)\n\t\t{\n\t\t\treturn inputs[inputs.length - 1];\n\t\t}\n\t}\n\n\tresolveAdditionOptionInSelectRobot(input, option)\n\t{\n\t\tconst selectOptions = input.options;\n\t\tlet opt = selectOptions[selectOptions.length - 1];\n\t\tif (opt.getAttribute('data-role') !== 'expression')\n\t\t{\n\t\t\topt = Tag.render`<option></option>`;\n\t\t\topt.setAttribute('data-role', 'expression');\n\t\t\tinput.appendChild(opt);\n\t\t}\n\t\topt.value = option.id;\n\t\tif (!option.customData)\n\t\t{\n\t\t\topt.text = option.title;\n\t\t}\n\t\telse\n\t\t{\n\t\t\topt.text = option.customData.get('title');\n\t\t}\n\n\t\topt.setAttribute('selected', 'selected');\n\t\tif (!opt.selected)\n\t\t{\n\t\t\topt.selected = true;\n\t\t}\n\t}\n\n\tfilterItemsInStandardMenuRobot(variableType, items)\n\t{\n\t\tconst filter = this.getFilterByVariableType(variableType);\n\t\tif (filter.length === this.numberOfTypes)\n\t\t{\n\t\t\treturn items;\n\t\t}\n\n\t\tconst filterItems = [];\n\t\tfor (const i in items)\n\t\t{\n\t\t\tif (items[i].children)\n\t\t\t{\n\t\t\t\tconst filterChildrenItems = this.filterItemsInStandardMenuRobot(variableType, items[i].children);\n\t\t\t\tif (filterChildrenItems.length >= 1)\n\t\t\t\t{\n\t\t\t\t\tconst menuItem = items[i];\n\t\t\t\t\tmenuItem.children = filterChildrenItems;\n\t\t\t\t\tfilterItems.push(menuItem);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (filter.includes(items[i].customData.property.Type))\n\t\t\t\t{\n\t\t\t\t\tfilterItems.push(items[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn filterItems;\n\t}\n\n\tgetFilterByVariableType(type)\n\t{\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'double':\n\t\t\t\treturn ['int', 'double'];\n\t\t\tcase 'datetime':\n\t\t\t\treturn ['date', 'datetime'];\n\t\t\tcase 'date':\n\t\t\tcase 'int':\n\t\t\tcase 'user':\n\t\t\t\treturn [type];\n\t\t\tdefault:\n\t\t\t\t// this.numberOfTypes = 9\n\t\t\t\treturn ['string', 'text', 'select', 'bool', 'int', 'double', 'date', 'datetime', 'user'];\n\t\t}\n\t}\n\n\tgetVisibilityInfoForDialog(visibility)\n\t{\n\t\tlet recentStubOptions = {};\n\t\tlet searchStubOptions = {};\n\t\tlet searchFooterOptions = {};\n\t\tlet mode = '';\n\t\tlet objectName = '';\n\n\t\tif (this.isGVariableVisibility(visibility))\n\t\t{\n\t\t\trecentStubOptions = {\n\t\t\t\ttitle: BX.message('BPSGVA_GVARIABLE_NO_EXIST'),\n\t\t\t\tsubtitle: BX.message('BPSGVA_CREATE_GVARIABLE_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchStubOptions = {\n\t\t\t\ttitle: BX.message('BPSGVA_GVARIABLE_NOT_FOUND'),\n\t\t\t\tsubtitle: BX.message('BPSGVA_CREATE_GVARIABLE_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchFooterOptions = {\n\t\t\t\tlabel: BX.message('BPSGVA_CREATE_GVARIABLE'),\n\t\t\t};\n\n\t\t\tmode = Globals.Manager.Instance.mode.variable;\n\t\t\tobjectName = this.gVarObjectName;\n\t\t}\n\t\telse if (this.isGConstantVisibility(visibility))\n\t\t{\n\t\t\trecentStubOptions = {\n\t\t\t\ttitle: BX.message('BPSGVA_GCONSTANT_NO_EXIST'),\n\t\t\t\tsubtitle: BX.message('BPSGVA_CREATE_GCONSTANT_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchStubOptions = {\n\t\t\t\ttitle: BX.message('BPSGVA_GCONSTANT_NOT_FOUND'),\n\t\t\t\tsubtitle: BX.message('BPSGVA_CREATE_GCONSTANT_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchFooterOptions = {\n\t\t\t\tlabel: BX.message('BPSGVA_CREATE_GCONSTANT')\n\t\t\t};\n\n\t\t\tmode = Globals.Manager.Instance.mode.constant;\n\t\t\tobjectName = this.gConstObjectName;\n\t\t}\n\t\telse if (this.isDocumentVisibility(visibility))\n\t\t{\n\t\t\tobjectName = this.documentObjectName;\n\t\t}\n\n\t\treturn {\n\t\t\trecentStubOptions,\n\t\t\tsearchStubOptions,\n\t\t\tsearchFooterOptions,\n\t\t\tmode,\n\t\t\tobjectName,\n\t\t\tvisibility\n\t\t};\n\t}\n\n\tgetDialogOptions(items, visibilityInfo)\n\t{\n\t\tconst options = {\n\t\t\twidth: 480,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tshowAvatars: false,\n\t\t\tcompactView: true,\n\t\t\titems: items,\n\t\t\ttagSelectorOptions: {\n\t\t\t\ttextBoxWidth: 400\n\t\t\t}\n\t\t};\n\n\t\tconst extraOptions = {\n\t\t\trecentTabOptions: {\n\t\t\t\tstub: true,\n\t\t\t\ticon: '',\n\t\t\t\tstubOptions: visibilityInfo.recentStubOptions\n\t\t\t},\n\t\t\tsearchTabOptions: {\n\t\t\t\tstub: true,\n\t\t\t\tstubOptions: visibilityInfo.searchStubOptions\n\t\t\t},\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: true,\n\t\t\t\tfooterOptions: visibilityInfo.searchFooterOptions\n\t\t\t}\n\t\t};\n\n\t\tif (\n\t\t\tvisibilityInfo.objectName === this.gVarObjectName\n\t\t\t|| visibilityInfo.objectName === this.gConstObjectName\n\t\t)\n\t\t{\n\t\t\treturn Object.assign(options, extraOptions);\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tgetFooter(context, dialog)\n\t{\n\t\tconst me = this;\n\t\tconst footer = Tag.render`\n\t\t\t<span class=\"ui-selector-footer-link ui-selector-footer-link-add\" style=\"border: none\">\n\t\t\t\t${BX.util.htmlspecialchars(context.visibilityInfo.searchFooterOptions.label)}\n\t\t\t</span>\n\t\t`;\n\n\t\tBX.bind(footer, 'click', () => {\n\t\t\tme.onCreateGlobalsClick(dialog, context, '', me);\n\t\t});\n\n\t\treturn footer;\n\t}\n\n\tonCreateGlobalsClick(dialog, context, query,  me, resolve)\n\t{\n\t\tconst variableType = me.getVariableOptionFromVariableInput(context.index).property.Type;\n\t\tconst optionAvailableTypes = me.getFilterByVariableType(variableType);\n\n\t\tconst visibility = context.visibilityInfo.visibility;\n\t\tconst additionalContext = {\n\t\t\tvisibility: visibility.slice(visibility.indexOf(':') + 1),\n\t\t\tavailableTypes: optionAvailableTypes\n\t\t};\n\t\tGlobals.Manager.Instance.createGlobals(context.visibilityInfo.mode, me.signedDocumentType, query, additionalContext)\n\t\t\t.then((slider) =>\n\t\t\t{\n\t\t\t\tconst newContext = {\n\t\t\t\t\t'objectName': context.visibilityInfo.objectName,\n\t\t\t\t\t'visibility': context.visibilityInfo.visibility,\n\t\t\t\t\t'index': context.index\n\t\t\t\t};\n\t\t\t\tme.onAfterCreateGlobals(dialog, slider, newContext);\n\t\t\t\tif (resolve)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tonAfterCreateGlobals(dialog, slider, context)\n\t{\n\t\tconst info = slider.getData().entries();\n\t\tconst keys = Object.keys(info);\n\t\tif (keys.length <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = keys[0];\n\t\tconst property = BX.clone(info[keys[0]]);\n\n\t\tproperty.Multiple = property.Multiple === 'Y';\n\t\tconst variableType = this.getVariableOptionFromVariableInput(context.index).property.Type;\n\t\tconst optionAvailableTypes = this.getFilterByVariableType(variableType);\n\n\t\tconst item = {\n\t\t\tentityId: 'bp',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: property['Name'],\n\t\t\tid: '{=' + context.objectName + ':' + id + '}',\n\t\t\tcustomData: {\n\t\t\t\tgroupId: context.objectName + ':' + property['Visibility'],\n\t\t\t\tproperty: property,\n\t\t\t\ttitle: property['Name']\n\t\t\t}\n\t\t};\n\n\t\tif (\n\t\t\titem.customData.groupId === context.visibility\n\t\t\t&& optionAvailableTypes.includes(item.customData.property.Type)\n\t\t)\n\t\t{\n\t\t\tdialog.setFooter(null);\n\t\t\tdialog.addItem(item);\n\t\t}\n\n\t\tthis.availableOptions.set(item.id, item);\n\n\t\tconst groupItems = this.availableOptionsByGroupId.get(item.customData.groupId) ?? [];\n\t\tgroupItems.push(item);\n\t\tthis.availableOptionsByGroupId.set(item.customData.groupId, groupItems);\n\t}\n\n\tchangeParameterSelectInFormRobot(visibility, target, label, inputWrapper)\n\t{\n\t\tif (visibility !== this.helperObjectName + ':text')\n\t\t{\n\t\t\ttarget.style.display = 'inline-block';\n\t\t\ttarget.innerText = BX.message('BPSGVA_EMPTY');\n\t\t\tlabel.innerText = BX.message('BPSGVA_LIST_OF_VALUES');\n\t\t\tinputWrapper.style.display = 'none';\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttarget.style.display = 'none';\n\t\t\tlabel.innerText = BX.message('BPSGVA_INPUT_TEXT');\n\t\t\tinputWrapper.style.display = '';\n\t\t}\n\n\t\tconst input = this.findInputInFormRobot(inputWrapper);\n\t\tif (input)\n\t\t{\n\t\t\tinput.value = '';\n\t\t}\n\t}\n\n\tgetVisibilityNamesForSelect(type)\n\t{\n\t\tconst list = {};\n\t\tconst textMessages = {};\n\t\ttextMessages[this.helperObjectName] = {\n\t\t\t'text': BX.message('BPSGVA_TEXT')\n\t\t};\n\n\t\tconst source = Object.assign({}, this.visibilityMessages, textMessages);\n\n\t\tfor (const topGroupName in source) {\n\t\t\tif (type === 'variable' && topGroupName !== this.gVarObjectName) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor (const subGroupName in source[topGroupName]) {\n\t\t\t\tlist[topGroupName + ':' + subGroupName] = source[topGroupName][subGroupName];\n\t\t\t}\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetVisibilityRelativeToVariableType(option, variableType)\n\t{\n\t\tconst optionAvailableTypes = this.getFilterByVariableType(variableType);\n\t\tif (\n\t\t\toption.groupId === this.helperObjectName + ':text'\n\t\t\t|| optionAvailableTypes.includes(option.property.Type)\n\t\t)\n\t\t{\n\t\t\treturn option.groupId;\n\t\t}\n\n\t\treturn this.helperObjectName + ':text';\n\t}\n\n\tchangeParameterExpressionRobot(index, variable)\n\t{\n\t\tconst parameterNode = document.querySelector('[data-role=\"' + this.parameterRole + index + '\"]');\n\t\tthis.deleteOldValueRowsRobot(parameterNode);\n\t\tconst rowInputs = document.getElementById(this.hiddenInputsNodeId + index);\n\n\t\tconst option = BX.clone(this.getOptionPropertiesRobot('parameter'));\n\n\t\toption['multiple'] = variable.property.Multiple;\n\t\toption['inputIndex'] = '0';\n\n\t\tparameterNode.appendChild(this.createParameterRowRobot(index, option, rowInputs));\n\n\t\tif (variable.property.Multiple && variable.property.Type !== 'user')\n\t\t{\n\t\t\tconst inputIndex = (variable.inputIndex !== '0') ? variable.inputIndex : '1';\n\t\t\tparameterNode.appendChild(this.createAddParameterRowRobot(index, inputIndex));\n\t\t}\n\t}\n\n\tdeleteOldValueRowsRobot(node)\n\t{\n\t\tconst role = node.getAttribute('data-role');\n\t\tnode.innerHTML = '';\n\t\tconst oldInputs = document.querySelectorAll('[data-role=\"' + role + '_input\"]');\n\t\tfor (const i in Object.keys(oldInputs))\n\t\t{\n\t\t\toldInputs[i].remove();\n\t\t}\n\t}\n\n\tcreateAddParameterRowRobot(index, inputIndex)\n\t{\n\t\tconst addWrapper = Tag.render`<div class=\"bizproc-automation-popup-settings-title\" style=\"display:flex;\"></div>`\n\t\tconst addExpression = Tag.render`\n\t\t\t<div class=\"bizproc-type-control-clone-btn setglobalvariableactivity-dashed-grey setglobalvariableactivity-add-parameter\">\n\t\t\t\t${BX.util.htmlspecialchars(BX.message('BPSGVA_ADD_PARAMETER'))}\n\t\t\t</div>\n\t\t`;\n\t\taddExpression.setAttribute(this.indexAttributeName, String(index));\n\t\taddExpression.setAttribute(this.inputIndexAttributeName, String(inputIndex));\n\t\tBX.bind(addExpression, 'click', BX.proxy(this.onAddParameterButtonClickRobot, this));\n\n\t\taddWrapper.appendChild(addExpression);\n\n\t\treturn addWrapper;\n\t}\n\n\tonAddParameterButtonClickRobot(event)\n\t{\n\t\tconst index = event.target.getAttribute(this.indexAttributeName);\n\t\tconst rowInputs = document.getElementById(this.hiddenInputsNodeId + index);\n\t\tconst inputIndex = event.target.getAttribute(this.inputIndexAttributeName);\n\n\t\tconst option = BX.clone(this.getOptionPropertiesRobot('parameter'));\n\t\toption['multiple'] = true;\n\t\toption['inputIndex'] = inputIndex;\n\n\t\tevent.target.parentNode.before(this.createParameterRowRobot(index, option, rowInputs));\n\t\tevent.target.setAttribute(this.inputIndexAttributeName, Number(inputIndex) + 1);\n\t}\n\n\tonParameterSelectClickRobot(event, inputIndex)\n\t{\n\t\tconst target = event.target;\n\t\tconst inputValue = this.getParameterInputValue(target.getAttribute('data-role') + '_input', inputIndex);\n\t\tconst index = target.getAttribute(this.indexAttributeName);\n\n\t\tconst form = this.createFormForMenuRobot('all', inputValue, index);\n\n\t\tconst me = this;\n\t\tconst popup = new BX.PopupWindow(target.id + '_popup', target, {\n\t\t\tclassName: 'bizproc-automation-popup-set',\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: true,\n\t\t\toffsetTop: 5,\n\t\t\toverlay: {backgroundColor: 'transparent'},\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\ttext: BX.message('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\tclassName: 'webform-button webform-button-create',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst rowInputs = document.getElementById(me.hiddenInputsNodeId + index);\n\t\t\t\t\t\t\tconst variableOption = me.getVariableOptionFromVariableInput(index);\n\n\t\t\t\t\t\t\tconst input = me.findInputInFormRobot(form);\n\t\t\t\t\t\t\tlet data;\n\t\t\t\t\t\t\tif (input.tagName === 'SELECT')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst id = input.selectedOptions[0].value;\n\t\t\t\t\t\t\t\tconst title = (id !== '') ? input.selectedOptions[0].text : BX.message('BPSGVA_CLEAR');\n\t\t\t\t\t\t\t\tdata = me.getDataForTitleReplacement(\n\t\t\t\t\t\t\t\t\t{id, title},\n\t\t\t\t\t\t\t\t\ttarget.getAttribute('data-role')\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tdata.isExpressionOption = (input.selectedOptions[0].getAttribute('data-role') === 'expression');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst option = BX.clone(me.getOptionPropertiesRobot(input.value));\n\t\t\t\t\t\t\t\tif (option.groupId === me.helperObjectName)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\toption.id = input.value;\n\t\t\t\t\t\t\t\t\toption.title = input.value;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdata = me.getDataForTitleReplacement(\n\t\t\t\t\t\t\t\t\tme.getOptionPropertiesRobot(input.value),\n\t\t\t\t\t\t\t\t\ttarget.getAttribute('data-role')\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdata.inputIndex = target.getAttribute(me.inputIndexAttributeName) ?? '0';\n\t\t\t\t\t\t\tdata.multiple = variableOption.property.Multiple;\n\t\t\t\t\t\t\tdata.type = variableOption.property.Type;\n\t\t\t\t\t\t\tif (data.title === '')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdata.title = BX.message('BPSGVA_CLEAR');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tme.replaceTitleAndHiddenInputRobot(target, data, rowInputs);\n\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\ttext: BX.message('BIZPROC_AUTOMATION_CMP_CANCEL'),\n\t\t\t\t\tclassName: 'popup-window-button-link',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function ()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tgetParameterInputValue(role, index)\n\t{\n\t\tconst inputs = document.querySelectorAll('[data-role=\"' + role + '\"]', index);\n\t\tconst keys = Object.keys(inputs);\n\t\tfor (const i in keys)\n\t\t{\n\t\t\tif (String(inputs[keys[i]].getAttribute(this.inputIndexAttributeName)) === String(index))\n\t\t\t{\n\t\t\t\treturn inputs[keys[i]].value;\n\t\t\t}\n\t\t}\n\n\t\treturn '';\n\n\t}\n\n\taddExpressionButtonRobot()\n\t{\n\t\tconst buttonAdd = document.getElementById(this.addButtonNodeId);\n\t\tbuttonAdd.innerText = BX.message('BPSGVA_ADD_VARIABLE');\n\t\tBX.bind(buttonAdd, 'click', BX.proxy(function () {\n\t\t\tthis.addAssignmentExpressionRobot()\n\t\t}, this));\n\t}\n\n\taddExpressionButtonDesigner()\n\t{\n\t\tconst button = Tag.render`<a href='#'>${Loc.getMessage('BPSGVA_PD_ADD')}</a>`;\n\t\tEvent.bind(button, 'click', (event) => {\n\t\t\tthis.addAssignmentExpressionDesigner();\n\t\t\tevent.preventDefault();\n\t\t});\n\n\t\tDom.insertAfter(button, this.addRowTable);\n\t}\n\n\tconvertFieldExpression(option)\n\t{\n\t\tif (this.isDocumentVisibility(option.groupId))\n\t\t{\n\t\t\treturn '{{' + option.property.Name + '}}';\n\t\t}\n\n\t\tif (this.isGVariableVisibility(option.groupId))\n\t\t{\n\t\t\tconst messages = this.visibilityMessages[this.gVarObjectName];\n\t\t\tconst visibility = option.property.Visibility;\n\t\t\tconst name = option.property.Name;\n\n\t\t\treturn '{{' + messages[visibility] + ': ' + name + '}}';\n\t\t}\n\n\t\tif (this.isGConstantVisibility(option.groupId))\n\t\t{\n\t\t\tconst messages = this.visibilityMessages[this.gConstObjectName];\n\t\t\tconst visibility = option.property.Visibility;\n\t\t\tconst name = option.property.Name;\n\n\t\t\treturn '{{' + messages[visibility] + ': ' + name + '}}';\n\t\t}\n\n\t\treturn option.id;\n\t}\n\n\taddAssignmentExpressionDesigner(variable, value)\n\t{\n\t\tconst addRowTable = this.addRowTable;\n\t\tthis.rowIndex++;\n\n\t\tconst newRow = addRowTable.insertRow(-1);\n\t\tnewRow.id = 'delete_row_' + this.rowIndex;\n\n\t\tconst cellSelect = newRow.insertCell(-1);\n\n\t\tconst newSelect = Tag.render`<select name=\"${this.variableRole + this.rowIndex}\"></select>`;\n\t\tnewSelect.setAttribute(this.indexAttributeName, this.rowIndex);\n\t\tconst me = this;\n\t\tnewSelect.onchange = function() {\n\t\t\tme.changeFieldTypeDesigner(\n\t\t\t\tthis.getAttribute(me.indexAttributeName),\n\t\t\t\tthis.options[this.selectedIndex].value,\n\t\t\t\tnull\n\t\t\t);\n\t\t};\n\n\t\tconst objectVisibilityMessages = this.visibilityMessages[this.gVarObjectName];\n\t\tfor (const visibility in objectVisibilityMessages)\n\t\t{\n\t\t\tconst optgroupLabel = objectVisibilityMessages[visibility];\n\t\t\tconst optgroup = Tag.render`<optgroup label=\"${BX.util.htmlspecialchars(optgroupLabel)}\"></optgroup>`;\n\n\t\t\tconst groupOptions = this.availableOptionsByGroupId.get(this.gVarObjectName + ':' + visibility);\n\t\t\tif (!groupOptions){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet optionNode;\n\t\t\tfor (const i in groupOptions)\n\t\t\t{\n\t\t\t\toptionNode = Tag.render`\n\t\t\t\t\t<option value=\"${BX.util.htmlspecialchars(groupOptions[i]['id'])}\">\n\t\t\t\t\t\t${BX.util.htmlspecialchars(groupOptions[i]['customData']['title'])}\n\t\t\t\t\t</option>\n\t\t\t\t`;\n\t\t\t\toptgroup.appendChild(optionNode);\n\t\t\t}\n\n\t\t\tnewSelect.appendChild(optgroup);\n\t\t}\n\n\t\tnewSelect.value = variable;\n\t\tif (newSelect.selectedIndex === -1)\n\t\t{\n\t\t\tnewSelect.selectedIndex = 0;\n\t\t}\n\t\tcellSelect.appendChild(newSelect);\n\n\t\tconst cellSymbolEquals = newRow.insertCell(-1);\n\t\tcellSymbolEquals.innerHTML = '=';\n\n\t\tconst cellValue = newRow.insertCell(-1);\n\t\tcellValue.id = 'id_td_variable_value_' + this.rowIndex;\n\t\tcellValue.innerHTML = '';\n\n\t\tconst cellDeleteRow = newRow.insertCell(-1);\n\t\tcellDeleteRow.aligh = 'right';\n\t\tconst deleteLink = Tag.render`<a href=\"#\">${BX.util.htmlspecialchars(BX.message('BPSGVA_PD_DELETE'))}</a>`;\n\t\tconst index = this.rowIndex;\n\t\tEvent.bind(deleteLink, 'click', (event) =>\n\t\t{\n\t\t\tme.deleteConditionDesigner(index);\n\t\t\tevent.preventDefault();\n\t\t});\n\t\tcellDeleteRow.appendChild(deleteLink);\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tfor (const i in value)\n\t\t\t{\n\t\t\t\tconst item = this.getOptionPropertiesRobot(value[i]);\n\t\t\t\tif (item.groupId === this.helperObjectName + ':text')\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvalue[i] = this.convertFieldExpression(item);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst item = this.getOptionPropertiesRobot(value);\n\t\t\tif (item.groupId !== this.helperObjectName + ':text')\n\t\t\t{\n\t\t\t\tvalue = this.convertFieldExpression(item);\n\t\t\t}\n\t\t}\n\n\t\tif (value === undefined)\n\t\t{\n\t\t\tvalue = null;\n\t\t}\n\n\t\tthis.changeFieldTypeDesigner(this.rowIndex, newSelect.value, value);\n\t}\n\n\tchangeFieldTypeDesigner(index, field, value)\n\t{\n\t\tBX.showWait();\n\t\tconst valueTd = document.getElementById('id_td_variable_value_' + index);\n\n\t\tconst separatingSymbol = field.indexOf(':');\n\t\tlet fieldId = field;\n\t\tif (separatingSymbol !== -1){\n\t\t\tfieldId = field.slice(separatingSymbol + 1, field.length - 1);\n\t\t}\n\n\t\tobjFieldsGlobalVar.GetFieldInputControl(\n\t\t\tobjFieldsGlobalVar.arDocumentFields[fieldId],\n\t\t\tvalue,\n\t\t\t{'Field': fieldId, 'Form': this.formName},\n\t\t\tfunction(v) {\n\t\t\t\tif (v === undefined)\n\t\t\t\t{\n\t\t\t\t\tvalueTd.innerHTML = '';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvalueTd.innerHTML = v;\n\t\t\t\t\tif (typeof BX.Bizproc.Selector !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Bizproc.Selector.initSelectors(valueTd);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tBX.closeWait();\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\n\tdeleteConditionDesigner(index)\n\t{\n\t\tconst addrowTable = document.getElementById(this.addRowTableNodeId);\n\t\tconst count = addrowTable.rows.length;\n\t\tfor (let i = 0; i < count; i++)\n\t\t{\n\t\t\tif (addrowTable.rows[i].id !== 'delete_row_' + index)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\taddrowTable.deleteRow(i);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nnamespace.SetGlobalVariableActivity = SetGlobalVariableActivity;"],"names":["namespace","Reflection","SetGlobalVariableActivity","options","Type","isPlainObject","isRobot","documentType","signedDocumentType","variables","constants","documentFields","currentValues","visibilityMessages","formName","addRowTable","initObjectNames","initNodeIdNames","initNodeAttributeNames","initAvailableOptions","rowIndex","numberOfTypes","addAssignmentExpression","Object","keys","length","variableExpression","addExpressionButtonDesigner","gVarObjectName","gConstObjectName","documentObjectName","helperObjectName","visibility","startsWith","addRowTableNodeId","addButtonNodeId","hiddenInputsNodeId","variableRole","parameterRole","indexAttributeName","inputIndexAttributeName","availableOptions","getAvailableOptions","availableOptionsByGroupId","getAvailableOptionsByGroup","Map","fillOptions","set","id","title","BX","message","customData","property","Multiple","groupId","source","optionId","optionProperty","optionsSource","groupName","i","fillOptionsByGroupWithGlobals","items","push","topGroupName","subGroupName","key","variableId","values","isString","incomingData","variable","modifyIncomingDataRobot","newRow","Tag","render","rowInputs","dataRow","appendChild","createVariableRowRobot","parameterRowWrapper","setAttribute","option","clone","getOptionPropertiesRobot","createParameterRowRobot","createAddParameterRowRobot","undefined","valueOption","valuesOptions","getIncomingValuesSelect","getIncomingValuesBool","get","getDefaultOptionProperties","getShortOptionProperties","isExpressionOption","Options","variableData","div","variableNode","String","data","getDataForTitleReplacement","getAttribute","multiple","type","inputIndex","replaceTitleAndHiddenInputRobot","bind","proxy","onVariableSelectClickRobot","index","valueData","wrapper","equal","parameter","event","onParameterSelectClickRobot","role","inputValue","target","innerText","getTitleForReplacement","replaceHiddenInputRobot","value","includes","Bizproc","FieldType","formatValuePrintable","input","document","querySelectorAll","name","inputKeys","getVariableInputValue","form","createFormForMenuRobot","me","popup","PopupWindow","className","autoHide","closeByEsc","offsetTop","overlay","backgroundColor","content","buttons","PopupWindowButton","text","events","click","getElementById","findInputInFormRobot","changeParameterExpressionRobot","close","PopupWindowButtonLink","onPopupClose","destroy","show","inputRole","inputs","typeMenu","fieldsListWrapper","labelFieldsList","formInputWrapper","createInputForMenuFormRobot","formInput","filterType","getVariableOptionFromVariableInput","fieldsSelectNode","visibilitySelect","filterItems","filterItemsInStandardMenuRobot","visibilityInfo","getVisibilityInfoForDialog","dialogOptions","getDialogOptions","dialogItem","item","Dom","append","Text","encode","tagName","resolveAdditionOptionInSelectRobot","onHide","Promise","resolve","query","getData","searchQuery","dialog","getTarget","context","onCreateGlobalsClick","Dialog","setFooter","getFooter","visibilityWrapper","changeParameterSelectInFormRobot","visibilityOptions","getVisibilityNamesForSelect","optionNode","util","htmlspecialchars","getVisibilityRelativeToVariableType","selectedIndex","convertFieldExpression","variableOption","renderControl","style","width","variableInput","querySelector","getElementsByTagName","selectOptions","opt","selected","variableType","filter","getFilterByVariableType","children","filterChildrenItems","menuItem","recentStubOptions","searchStubOptions","searchFooterOptions","mode","objectName","isGVariableVisibility","subtitle","arrow","label","Globals","Manager","Instance","isGConstantVisibility","constant","isDocumentVisibility","height","dropdownMode","enableSearch","showAvatars","compactView","tagSelectorOptions","textBoxWidth","extraOptions","recentTabOptions","stub","icon","stubOptions","searchTabOptions","searchOptions","allowCreateItem","footerOptions","assign","footer","optionAvailableTypes","additionalContext","slice","indexOf","availableTypes","createGlobals","then","slider","newContext","onAfterCreateGlobals","info","entries","entityId","tabs","addItem","groupItems","inputWrapper","display","list","textMessages","parameterNode","deleteOldValueRowsRobot","node","innerHTML","oldInputs","remove","addWrapper","addExpression","onAddParameterButtonClickRobot","parentNode","before","Number","getParameterInputValue","selectedOptions","buttonAdd","addAssignmentExpressionRobot","button","Loc","getMessage","Event","addAssignmentExpressionDesigner","preventDefault","insertAfter","Name","messages","Visibility","insertRow","cellSelect","insertCell","newSelect","onchange","changeFieldTypeDesigner","objectVisibilityMessages","optgroupLabel","optgroup","groupOptions","cellSymbolEquals","cellValue","cellDeleteRow","aligh","deleteLink","deleteConditionDesigner","isArray","field","showWait","valueTd","separatingSymbol","fieldId","objFieldsGlobalVar","GetFieldInputControl","arDocumentFields","v","Selector","initSelectors","closeWait","addrowTable","count","rows","deleteRow"],"mappings":"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"}