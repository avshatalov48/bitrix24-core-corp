{"version":3,"file":"parallelactivity.js","sources":["src/index.js"],"sourcesContent":["import { Dom, Tag, Event, Text } from 'main.core';\n\nimport './css/style.css';\n\nconst BizProcActivity = window.BizProcActivity;\n\nexport class ParallelActivity extends BizProcActivity\n{\n\tallowSort: boolean = false;\n\tchildsContainer;\n\tcontainer: ?HTMLDivElement;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.Type = 'ParallelActivity';\n\t\tthis.childActivities = [];\n\t\t// eslint-disable-next-line no-underscore-dangle, @bitrix24/bitrix24-rules/no-pseudo-private\n\t\tthis.__parallelActivityInitType = 'SequenceActivity';\n\t\tthis.allowSort = false;\n\n\t\t// region compatibility\n\t\tthis.copyBranch = this.#copyBranch.bind(this);\n\t\tthis.addBranch = this.#addBranch.bind(this);\n\t\tthis.createBranch = this.#createBranch.bind(this);\n\t\tthis.delBranch = (event) => {\n\t\t\tthis.#deleteBranch(event.target.parentNode.parentNode);\n\t\t};\n\t\tthis.DrawVLine = this.#drawVLine.bind(this);\n\t\tthis.RefreshDelButton = this.#refreshDelButton.bind(this);\n\t\tthis.OnHideClick = this.#onHideClick.bind(this);\n\t\tthis.BizProcActivityDraw = this.Draw;\n\t\tthis.Draw = this.#draw.bind(this);\n\t\tthis.ActivityRemoveChild = this.RemoveChild;\n\t\tthis.RemoveChild = this.#removeChild.bind(this);\n\t\tthis.BizProcActivityRemoveResources = this.RemoveResources;\n\t\tthis.RemoveResources = this.#removeResources.bind(this);\n\t\tthis.drawMoveElement = this.#drawMoveBranchButtons.bind(this);\n\t\tthis.moveToRight = (event) => {\n\t\t\tthis.#moveBranchToRight(event.target.parentNode.parentNode, event);\n\t\t};\n\n\t\tthis.moveToLeft = (event) => {\n\t\t\tthis.#moveBranchToLeft(event.target.parentNode.parentNode, event);\n\t\t};\n\t\tthis.swapBranch = this.#swapBranch.bind(this);\n\t\t// endregion\n\t}\n\n\t#copyBranch(childIndex: number, branchIndex: number)\n\t{\n\t\tthis.#createBranch(this.childActivities[childIndex], branchIndex ?? childIndex);\n\t}\n\n\t#addBranch()\n\t{\n\t\tconst lastBranchNumber = this.childsContainer.rows[2].cells.length;\n\t\t// eslint-disable-next-line no-underscore-dangle\n\t\tthis.#createBranch(this.__parallelActivityInitType, lastBranchNumber - 1);\n\t}\n\n\t#createBranch(childActivityInfo, branchNumber: number)\n\t{\n\t\tconst childActivity = window.CreateActivity(childActivityInfo);\n\t\tchildActivity.parentActivity = this;\n\t\tchildActivity.setCanBeActivated(this.getCanBeActivatedChild());\n\t\tthis.childActivities.splice(branchNumber, 0, childActivity);\n\n\t\tfor (let i = 0; i < this.childsContainer.rows.length; i++)\n\t\t{\n\t\t\tconst cell = this.childsContainer.rows[i].insertCell(branchNumber);\n\t\t\tDom.attr(cell, { align: 'center', vAlign: 'top' });\n\t\t}\n\n\t\tthis.#drawVLine(branchNumber);\n\t\tchildActivity.Draw(this.childsContainer.rows[2].cells[branchNumber]);\n\t\tthis.#refreshDelButton();\n\t}\n\n\t#deleteBranch(target)\n\t{\n\t\tthis.RemoveChild(this.childActivities[target.ind]);\n\t}\n\n\t#drawVLine(branchNumber: number)\n\t{\n\t\tDom.attr(this.childsContainer.rows[0], 'class', 'trLine');\n\t\tDom.attr(this.childsContainer.rows[3], 'class', 'trLine');\n\t\tDom.style(\n\t\t\tthis.childsContainer.rows[1].cells[branchNumber],\n\t\t\t'background',\n\t\t\t'url(/bitrix/images/bizproc/act_line_bg.gif) 50% top repeat-y',\n\t\t);\n\t\tDom.style(\n\t\t\tthis.childsContainer.rows[2].cells[branchNumber],\n\t\t\t'background',\n\t\t\t'url(/bitrix/images/bizproc/act_line_bg.gif) 50% top repeat-y',\n\t\t);\n\t\tDom.attr(this.childsContainer.rows[2].cells[branchNumber], 'vAlign', 'top');\n\n\t\tconst childActivityCell = this.childsContainer.rows[1].cells[branchNumber];\n\t\tDom.attr(childActivityCell, { height: '20', vAlign: 'bottom' });\n\n\t\tconst { root, remove } = Tag.render`\n\t\t\t<div style=\"margin-top: 14px; display: none;\">\n\t\t\t\t<div class=\"bizproc-designer-parallel-activity__del_br\"\n\t\t\t\t\tref=\"remove\"\n\t\t\t\t\ttitle=\"${Text.encode(window.BPMESS.PARA_DEL)}\"\n\t\t\t\t\talt=\"${Text.encode(window.BPMESS.PARA_DEL)}\">\n\t\t\t\t\t<div class=\"ui-icon-set --minus-60\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tEvent.bind(remove, 'click', this.#deleteBranch.bind(this, childActivityCell));\n\t\tDom.append(root, childActivityCell);\n\n\t\tif (this.allowSort)\n\t\t{\n\t\t\tthis.#drawMoveBranchButtons(branchNumber, childActivityCell);\n\t\t}\n\t}\n\n\t#drawMoveBranchButtons(branchNumber, cell)\n\t{\n\t\tconst { root, left, right } = Tag.render`\n\t\t\t<div class=\"move-thread\">\n\t\t\t\t<div\n\t\t\t\t\tref=\"left\" \n\t\t\t\t\tclass=\"ui-icon-set --chevron-left bizproc-designer-parallel-activity-move-arrow\"\n\t\t\t\t\ttitle=\"${Text.encode(window.BPMESS.PARA_MOVE_LEFT)}\"\n\t\t\t\t></div>\n\t\t\t\t<div\n\t\t\t\t\tref=\"right\"\n\t\t\t\t\tclass=\"ui-icon-set --chevron-right bizproc-designer-parallel-activity-move-arrow\"\n\t\t\t\t\ttitle=\"${Text.encode(window.BPMESS.PARA_MOVE_RIGHT)}\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t`;\n\t\tEvent.bind(left, 'click', this.#moveBranchToLeft.bind(this, cell));\n\t\tEvent.bind(right, 'click', this.#moveBranchToRight.bind(this, cell));\n\t\tDom.append(root, cell);\n\t}\n\n\t#moveBranchToLeft(cell, event)\n\t{\n\t\tconst index = cell.ind;\n\t\tif (index !== 0)\n\t\t{\n\t\t\tif (this.#isEventWithCtrlKey(event))\n\t\t\t{\n\t\t\t\tthis.#copyBranch(index, index);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#swapBranch(index - 1, index);\n\t\t\t}\n\n\t\t\twindow.BPTemplateIsModified = true;\n\t\t}\n\t}\n\n\t#moveBranchToRight(cell, event)\n\t{\n\t\tconst index = cell.ind;\n\t\tif (index !== this.childActivities.length)\n\t\t{\n\t\t\tif (this.#isEventWithCtrlKey(event))\n\t\t\t{\n\t\t\t\tthis.#copyBranch(index, index + 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#swapBranch(index, index + 1);\n\t\t\t}\n\n\t\t\twindow.BPTemplateIsModified = true;\n\t\t}\n\t}\n\n\t#isEventWithCtrlKey(event): boolean\n\t{\n\t\treturn (event.ctrlKey === true || event.metaKey === true);\n\t}\n\n\t#swapBranch(branchIndex1, branchIndex2)\n\t{\n\t\tconst tmp = this.childActivities[branchIndex1];\n\t\tthis.childActivities[branchIndex1] = this.childActivities[branchIndex2];\n\t\tthis.childActivities[branchIndex2] = tmp;\n\n\t\tfor (let i = 1; i < 3; i++)\n\t\t{\n\t\t\tthis.childsContainer.rows[i].cells[branchIndex1].ind = branchIndex2;\n\t\t\tthis.childsContainer.rows[i].cells[branchIndex2].ind = branchIndex1;\n\t\t\tthis.#swapNodes(\n\t\t\t\tthis.childsContainer.rows[i].cells[branchIndex1],\n\t\t\t\tthis.childsContainer.rows[i].cells[branchIndex2],\n\t\t\t);\n\t\t}\n\t}\n\n\t#swapNodes(node1, node2)\n\t{\n\t\tconst beforeNode = node2.nextElementSibling;\n\t\tnode1.replaceWith(node2);\n\t\tif (beforeNode)\n\t\t{\n\t\t\tDom.insertBefore(node1, beforeNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(node1, node2.parentNode);\n\t\t}\n\t}\n\n\t#refreshDelButton()\n\t{\n\t\tthis.childActivities.forEach((child, index) => {\n\t\t\tDom.style(\n\t\t\t\tthis.childsContainer.rows[1].cells[index].childNodes[0],\n\t\t\t\t'display',\n\t\t\t\tthis.childActivities.length > 2 ? 'block' : 'none',\n\t\t\t);\n\t\t\tthis.childsContainer.rows[1].cells[index].ind = index;\n\t\t});\n\t}\n\n\t#onHideClick()\n\t{\n\t\t// eslint-disable-next-line no-underscore-dangle, @bitrix24/bitrix24-rules/no-pseudo-private\n\t\tthis.Properties._DesMinimized = this.Properties._DesMinimized === 'Y' ? 'N' : 'Y';\n\t\tBX.Dom.toggle(this.childsContainer);\n\t\tBX.Dom.toggle(this.hideContainer);\n\t}\n\n\t#draw(wrapper)\n\t{\n\t\tif (this.childActivities.length === 0)\n\t\t{\n\t\t\tthis.childActivities = [\n\t\t\t\t// eslint-disable-next-line no-underscore-dangle\n\t\t\t\twindow.CreateActivity(this.__parallelActivityInitType),\n\t\t\t\t// eslint-disable-next-line no-underscore-dangle\n\t\t\t\twindow.CreateActivity(this.__parallelActivityInitType),\n\t\t\t];\n\t\t\tthis.childActivities[0].parentActivity = this;\n\t\t\tthis.childActivities[0].setCanBeActivated(this.getCanBeActivatedChild());\n\t\t\tthis.childActivities[1].parentActivity = this;\n\t\t\tthis.childActivities[1].setCanBeActivated(this.getCanBeActivatedChild());\n\t\t}\n\n\t\tthis.container = Tag.render`<div class=\"parallelcontainer\">${this.#renderActivityContent()}</div>`;\n\t\tDom.append(this.container, wrapper);\n\n\t\tthis.BizProcActivityDraw(this.container);\n\t\tthis.activityContent = null;\n\n\t\tDom.style(this.div, { position: 'relative', top: '12px' });\n\t\tthis.#drawHideContainer();\n\t\tthis.#drawChildrenContainer();\n\n\t\t// eslint-disable-next-line no-underscore-dangle\n\t\tif (this.Properties._DesMinimized === 'Y')\n\t\t{\n\t\t\tDom.hide(this.childsContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.hide(this.hideContainer);\n\t\t}\n\n\t\tthis.childActivities.forEach((child, index) => {\n\t\t\tthis.#drawVLine(index);\n\t\t\tchild.Draw(this.childsContainer.rows[2].cells[index]);\n\t\t});\n\n\t\tthis.#refreshDelButton();\n\t}\n\n\t#renderActivityContent(): HTMLTableElement | string\n\t{\n\t\tif (!this.activityContent)\n\t\t{\n\t\t\tconst icon = this.Icon ?? '/bitrix/images/bizproc/act_icon.gif';\n\t\t\tconst { root, add } = Tag.render`\n\t\t\t\t<table \n\t\t\t\t\tcellpadding=\"0\"\n\t\t\t\t\tcellspacing=\"0\"\n\t\t\t\t\tborder=\"0\"\n\t\t\t\t\tstyle=\"width: 100%; font-size: 11px;\"\n\t\t\t\t>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td \n\t\t\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\t\t\tvalign=\"center\"\n\t\t\t\t\t\t\t\tstyle=\"\n\t\t\t\t\t\t\t\t\tbackground: url('${icon}') 2px 2px no-repeat;\n\t\t\t\t\t\t\t\t\theight: 24px;\n\t\t\t\t\t\t\t\t\twidth: 24px;\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t></td>\n\t\t\t\t\t\t\t<td align=\"left\" valign=\"center\">\n\t\t\t\t\t\t\t\t${Text.encode(this.Properties.Title)}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tref=\"add\"\n\t\t\t\t\t\t\t\tclass=\"bizproc-designer-parallel-activity-add-branch-icon\"\n\t\t\t\t\t\t\t\ttitle=\"${Text.encode(window.BPMESS.PARA_ADD)}\"\n\t\t\t\t\t\t\t></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t`;\n\t\t\tEvent.bind(add, 'click', this.#addBranch.bind(this));\n\t\t\tthis.activityContent = root;\n\n\t\t\treturn this.activityContent;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\t#drawHideContainer()\n\t{\n\t\tthis.hideContainer = Tag.render`\n\t\t\t<div \n\t\t\t\tstyle=\"\n\t\t\t\t\tbackground: #FFFFFF;\n\t\t\t\t\tborder: 1px #CCCCCC dotted;\n\t\t\t\t\twidth: 250px;\n\t\t\t\t\tcolor: #AAAAAA;\n\t\t\t\t\tpadding: 13px 0 3px 0;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t\"\n\t\t\t>${Text.encode(window.BPMESS.PARA_MIN)}</div>\n\t\t`;\n\t\tEvent.bind(this.hideContainer, 'click', this.#onHideClick.bind(this));\n\t\tDom.append(this.hideContainer, this.container);\n\t}\n\n\t#drawChildrenContainer()\n\t{\n\t\t// eslint-disable-next-line no-underscore-dangle\n\t\tthis.childsContainer = window._crt(4, this.childActivities.length);\n\t\tDom.attr(this.childsContainer, 'id', Text.encode(this.Name));\n\t\tDom.style(this.childsContainer, 'background', '#FFFFFF');\n\t\tDom.append(this.childsContainer, this.container);\n\t}\n\n\t#removeChild(child)\n\t{\n\t\tconst index = this.childActivities.indexOf(child);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.ActivityRemoveChild(child);\n\t\t\tif (this.childsContainer)\n\t\t\t{\n\t\t\t\tthis.childsContainer.rows[0].deleteCell(index);\n\t\t\t\tthis.childsContainer.rows[1].deleteCell(index);\n\t\t\t\tthis.childsContainer.rows[2].deleteCell(index);\n\t\t\t\tthis.childsContainer.rows[3].deleteCell(index);\n\n\t\t\t\tthis.#refreshDelButton();\n\t\t\t}\n\t\t}\n\t}\n\n\t#removeResources()\n\t{\n\t\tthis.BizProcActivityRemoveResources();\n\t\tif (this.container && this.container.parentNode)\n\t\t{\n\t\t\tDom.remove(this.container);\n\t\t\tthis.container = null;\n\t\t\tthis.childsContainer = null;\n\t\t}\n\t}\n}\n"],"names":["BizProcActivity","window","ParallelActivity","constructor","allowSort","Type","childActivities","__parallelActivityInitType","copyBranch","bind","addBranch","createBranch","delBranch","event","target","parentNode","DrawVLine","RefreshDelButton","OnHideClick","BizProcActivityDraw","Draw","ActivityRemoveChild","RemoveChild","BizProcActivityRemoveResources","RemoveResources","drawMoveElement","moveToRight","moveToLeft","swapBranch","childIndex","branchIndex","lastBranchNumber","childsContainer","rows","cells","length","childActivityInfo","branchNumber","childActivity","CreateActivity","parentActivity","setCanBeActivated","getCanBeActivatedChild","splice","i","cell","insertCell","Dom","attr","align","vAlign","ind","style","childActivityCell","height","root","remove","Tag","render","Text","encode","BPMESS","PARA_DEL","Event","append","left","right","PARA_MOVE_LEFT","PARA_MOVE_RIGHT","index","BPTemplateIsModified","ctrlKey","metaKey","branchIndex1","branchIndex2","tmp","node1","node2","beforeNode","nextElementSibling","replaceWith","insertBefore","forEach","child","childNodes","Properties","_DesMinimized","BX","toggle","hideContainer","wrapper","container","activityContent","div","position","top","hide","icon","Icon","add","Title","PARA_ADD","PARA_MIN","_crt","Name","indexOf","deleteCell"],"mappings":"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"}