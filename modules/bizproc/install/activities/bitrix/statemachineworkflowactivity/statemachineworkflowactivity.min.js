StateMachineWorkflowActivity=function(){var e=new BizProcActivity;e.classname="StateMachineWorkflowActivity";e.Table=null;e.__l=[];e.SerializeStateMachineWorkflowActivity=e.Serialize;e.Serialize=function(){if(e.childActivities.length>0)e.Properties["InitialStateName"]=e.childActivities[0]["Name"];return e.SerializeStateMachineWorkflowActivity()};e.LineMouseOver=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#ee0000";l.style.zIndex=parseInt(l.style.zIndex)+1e3}};e.LineMouseOut=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#afb8d2";l.style.zIndex=parseInt(l.style.zIndex)-1e3}};e.DrawLines=function(){var t,i;for(t=0;t<e.__l.length;t++)for(i=0;i<e.__l[t].length;i++)e.__l[t][i].parentNode.removeChild(e.__l[t][i]);e.__l=[];e.StatusArrows=[];e.FindSetState(false,e);var l=[],r=e.StatusArrows,s,o={};for(t=0;t<r.length;t++){s=r[t][0]+"|"+r[t][1];if(!(s in o)){o[s]=true;l.push(r[t])}}var a=0,n=0,c=0;for(t=0;t<l.length;t++){var p=ActGetRealPos(document.getElementById(l[t][0]));var d=ActGetRealPos(document.getElementById(l[t][1]));if(p===false||d===false||p["left"]<=0||d["left"]<=0)continue;var h=e.Table.parentNode;var f=h.appendChild(document.createElement("IMG"));f.style.position="absolute";f.style.zIndex=14+t*10;f.width="8";f.height="8";var u=h.appendChild(document.createElement("IMG"));u.style.position="absolute";u.style.zIndex=15+t*10;u.width="8";u.height="8";var y=h.appendChild(document.createElement("DIV"));y.style.position="absolute";y.style.backgroundColor="#afb8d2";y.style.zIndex=11+t*10;y.style.height="2px";y.id=l[t][0]+"-"+l[t][1]+".1";y.onmouseover=e.LineMouseOver;y.onmouseout=e.LineMouseOut;var g=h.appendChild(document.createElement("DIV"));g.style.position="absolute";g.style.backgroundColor="#afb8d2";g.style.zIndex=12+t*10;g.style.width="2px";g.id=l[t][0]+"-"+l[t][1]+".2";g.onmouseover=e.LineMouseOver;g.onmouseout=e.LineMouseOut;var v=h.appendChild(document.createElement("DIV"));v.style.position="absolute";v.style.backgroundColor="#afb8d2";v.style.zIndex=13+t*10;v.style.height="2px";v.id=l[t][0]+"-"+l[t][1]+".3";v.onmouseover=e.LineMouseOver;v.onmouseout=e.LineMouseOut;var m=v.appendChild(document.createElement("IMG"));m.width="1";m.height="1";m=y.appendChild(document.createElement("IMG"));m.width="1";m.height="1";p["right"]=p["right"]+10;p["left"]=p["left"]-10;var b,x=-50,w=12,A=-1;if(p["right"]<d["left"]){++n;x+=n%6*6;b=d["left"]-p["right"];y.style.left=p["right"]+"px";y.style.width=b/2+x+"px";g.style.left=p["right"]+b/2+x+"px";v.style.left=p["right"]+b/2+x+"px";f.src="/bitrix/images/bizproc/arr_l1.gif";f.style.left=p["right"]-2+"px";f.style.top=p["top"]+w-3+"px";u.src="/bitrix/images/bizproc/arr_r1.gif";u.style.left=d["left"]+"px";u.style.top=d["top"]+w-3+"px"}else if(p["left"]===d["left"]){b=150;var T=BX.findParent(document.getElementById(l[t][0]),{attr:"data-column"});if(T&&T.getAttribute("data-column")==="2"){++c;x+=c%10*10;f.src="/bitrix/images/bizproc/arr_l1.gif";f.style.left=p["right"]-2+"px";f.style.top=p["top"]+w-3+"px";y.style.left=p["right"]+"px";y.style.width=b/2+x+"px";g.style.left=p["right"]+b/2+x+"px";v.style.left=d["right"]+"px";u.src="/bitrix/images/bizproc/arr_l2.gif";u.style.left=d["right"]-8+"px";u.style.top=d["top"]+w-3+"px";A=1}else{++a;x+=a%10*10;y.style.left=p["left"]-b/2+x+"px";y.style.width=b/2-x+"px";g.style.left=p["left"]-b/2+x+"px";v.style.left=p["left"]-b/2+x+"px";f.src="/bitrix/images/bizproc/arr_l2.gif";f.style.left=p["left"]-6+"px";f.style.top=p["top"]+w-3+"px";u.src="/bitrix/images/bizproc/arr_r1.gif";u.style.left=d["left"]+"px";u.style.top=d["top"]+w-3+"px"}}else{++n;x=n%6*6-50;b=p["left"]-d["right"];y.style.left=d["right"]+b/2-x+"px";y.style.width=b/2+x+"px";g.style.left=d["right"]+b/2-x+"px";v.style.left=d["right"]+"px";f.src="/bitrix/images/bizproc/arr_r2.gif";f.style.left=p["left"]-6+"px";f.style.top=p["top"]+w-3+"px";u.src="/bitrix/images/bizproc/arr_l2.gif";u.style.left=d["right"]-8+"px";u.style.top=d["top"]+w-3+"px"}y.style.top=p["top"]+w+"px";if(p["top"]<d["top"]){g.style.top=p["top"]+w+"px";g.style.height=d["top"]-p["top"]+"px"}else{g.style.top=d["top"]+w+"px";g.style.height=p["top"]-d["top"]+"px"}v.style.top=d["top"]+Math.floor((d["bottom"]-d["top"])/2)+"px";v.style.width=b/2+A*x+2+"px";e.__l.push([f,y,g,v,u])}};e.FindSetState=function(t,i){if(i.Type=="SetStateActivity"){if(i.Properties["TargetStateName"])e.StatusArrows.push([t,i.Properties["TargetStateName"]])}else{for(var l=0;l<i.childActivities.length;l++){if(i.Type=="StateActivity")t=i.childActivities[l].Name;e.FindSetState(t,i.childActivities[l])}}};e.Draw=function(t){e.statediv=t;e.Table=t.appendChild(_crt(e.childActivities.length+1,3));e.Table.onresize=function(){};var i;for(i=0;i<e.childActivities.length;i++){e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[0].setAttribute("data-column",1);e.Table.rows[i].cells[2].align="left";e.Table.rows[i].cells[2].setAttribute("data-column",2);e.childActivities[i].Draw(e.Table.rows[i].cells[i%2*2])}i=e.childActivities.length;e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[0].width="350px";e.Table.rows[i].cells[1].width="150px";e.Table.rows[i].cells[2].align="left";var l=jsUtils.CreateElement("INPUT",{type:"button",value:BPMESS["STM_ADD_STATUS_1"]});l.style.marginBottom="20px";e.Table.rows[i].cells[i%2*2].appendChild(l);e.Table.rows[i].cells[(i+1)%2*2].innerHTML="&nbsp";l.onclick=e.AddStatus;e.ReCheckPosition(true)};e.AddStatus=function(t){var i=e.childActivities.length;var l=CreateActivity("StateActivity");e.childActivities.push(l);l.parentActivity=e;l.Draw(e.Table.rows[i].cells[i%2*2]);var r=e.Table.insertRow(-1);r.insertCell(-1).align="right";r.insertCell(-1).align="center";r.insertCell(-1).align="left";i++;e.Table.rows[i].cells[i%2*2].appendChild(this);l.Settings()};e.RemoveChildStateMachine=e.RemoveChild;e.RemoveChild=function(t){e.RemoveChildStateMachine(t);e.Table.parentNode.removeChild(e.Table);e.Draw(e.statediv)};e.ReplaceChild=function(t,i){var l=e.childActivities.indexOf(t);var r=e.childActivities.indexOf(i);if(l<0||r<0){return}e.childActivities[l]=i;e.childActivities[r]=t;BPTemplateIsModified=true;e.RemoveResources();e.Draw(e.statediv)};e.RemoveResourcesActivity=e.RemoveResources;e.RemoveResources=function(){e.RemoveResourcesActivity();if(e.Table){e.Table.parentNode.removeChild(e.Table);e.Table=null}};e.ReCheckPosition=function(t){if(e.Table.style.display=="none")return;var i=ActGetRealPos(e.Table);if(t||e.__lpos!=i["left"]||e.__rpos!=i["right"]){e.__lpos=i["left"];e.__rpos=i["right"];e.DrawLines()}setTimeout((function(){e.ReCheckPosition.call(e)}),1e3)};return e};
//# sourceMappingURL=statemachineworkflowactivity.map.js