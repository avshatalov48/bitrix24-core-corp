{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection, Tag, Type} from 'main.core';\nimport {Dialog} from 'ui.entity-selector';\nimport {Globals} from 'bizproc.globals';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Activity');\n\nclass MathOperationActivity\n{\n\tisRobot: boolean;\n\tsignedDocumentType: string;\n\n\tvariables: object;\n\tconstants: object;\n\tdocumentFields: object;\n\toperations: Array<string>;\n\n\tcurrentValues: object;\n\n\tvisibilityMessages: object;\n\n\taddRowTable: HTMLDivElement | HTMLTableElement;\n\n\tgVarObjectName: string;\n\tgConstObjectName: string;\n\tdocumentObjectName: string;\n\thelperObjectName: string;\n\toperationObjectName: string;\n\n\tindexAttributeName: string;\n\n\tvariableIdName: string;\n\tparameter1IdName: string;\n\toperationIdName: string;\n\tparameter2IdName: string;\n\tresultIdName: string;\n\toperationMenuIdName: string;\n\n\toptions: Map<string, object>;\n\toptionsByGroup: Map<string, Array<string>>;\n\trowIndex: number;\n\n\tavailableTypes: Array<string>;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.isRobot = options.isRobot;\n\t\t\tthis.signedDocumentType = options.signedDocumentType;\n\n\t\t\tthis.variables = options.variables;\n\t\t\tthis.constants = options.constants;\n\t\t\tthis.documentFields = options.documentFields;\n\t\t\tthis.operations = options.operations;\n\n\t\t\tthis.currentValues = options.currentValues;\n\t\t\tthis.visibilityMessages = options.visibilityMessages;\n\n\t\t\tthis.addRowTable = options.addRowTable;\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tthis.initObjectNames();\n\t\tthis.initNodeAttributeNames();\n\t\tthis.initNodeIdNames();\n\t\tthis.initAvailableOptions();\n\n\t\tthis.availableTypes = ['int', 'integer', 'double'];\n\t\tthis.rowIndex = -1;\n\n\t\tlet addCondition = this.isRobot ? 'addConditionRobot' : 'addConditionDesigner';\n\n\t\tif (Object.keys(this.currentValues).length <= 0)\n\t\t{\n\t\t\tthis[addCondition]('variable', ['parameter', '+', 'parameter']);\n\t\t}\n\t\tfor (let variableId in this.currentValues)\n\t\t{\n\t\t\tthis[addCondition](variableId, this.currentValues[variableId]);\n\t\t}\n\t}\n\n\tinitObjectNames()\n\t{\n\t\tthis.gVarObjectName = 'GlobalVar';\n\t\tthis.gConstObjectName = 'GlobalConst';\n\t\tthis.documentObjectName = 'Document';\n\t\tthis.operationObjectName = 'Operation';\n\n\t\tthis.helperObjectName = 'Default';\n\t}\n\n\tisGVariable(visibility)\n\t{\n\t\treturn visibility.startsWith(this.gVarObjectName);\n\t}\n\n\tisGConstant(visibility)\n\t{\n\t\treturn visibility.startsWith(this.gConstObjectName);\n\t}\n\n\tisDocument(visibility)\n\t{\n\t\treturn visibility.startsWith(this.documentObjectName);\n\t}\n\n\tinitNodeAttributeNames()\n\t{\n\t\tthis.indexAttributeName = 'bp_moa_index';\n\t}\n\n\tinitNodeIdNames()\n\t{\n\t\tthis.variableIdName = 'bp_moa_variable_';\n\t\tthis.parameter1IdName = 'bp_moa_common1_';\n\t\tthis.operationIdName = 'bp_moa_operation_';\n\t\tthis.parameter2IdName = 'bp_moa_common2_';\n\n\t\tthis.resultIdName = 'bp_moa_results_';\n\t\tthis.operationMenuIdName = 'bp_moa_operations_menu_';\n\t}\n\n\tinitAvailableOptions()\n\t{\n\t\tthis.options = this.getAvailableOptions();\n\t\tthis.optionsByGroup = this.getAvailableOptionsByGroup();\n\t}\n\n\tgetAvailableOptions()\n\t{\n\t\tlet options = new Map();\n\n\t\tthis.fillOptions(this.variables, options);\n\t\tthis.fillOptions(this.constants, options);\n\t\tthis.fillOptions(this.documentFields, options);\n\n\t\tlet source = this.operations;\n\t\tfor (let i in source)\n\t\t{\n\t\t\toptions.set(source[i], {\n\t\t\t\ttitle: source[i],\n\t\t\t\tgroupId: this.operationObjectName,\n\t\t\t\tvalue: source[i]\n\t\t\t});\n\t\t}\n\n\t\toptions.set('variable', {\n\t\t\ttitle: BX.message('BPMOA_CHOOSE_VARIABLE'),\n\t\t\tgroupId: this.helperObjectName,\n\t\t\tvalue: ''\n\t\t});\n\t\toptions.set('parameter', {\n\t\t\ttitle: BX.message('BPMOA_CHOOSE_PARAMETER'),\n\t\t\tgroupId: this.helperObjectName,\n\t\t\tvalue: ''\n\t\t});\n\t\toptions.set('operation', {\n\t\t\ttitle: '+',\n\t\t\tgroupId: this.helperObjectName,\n\t\t\tvalue: '+'\n\t\t});\n\n\t\treturn options;\n\t}\n\n\tfillOptions(source, options)\n\t{\n\t\tlet optionId, optionsSource;\n\t\tfor (let groupName in source)\n\t\t{\n\t\t\toptionsSource = source[groupName];\n\t\t\tif (optionsSource['children']) {\n\t\t\t\toptionsSource = optionsSource['children'];\n\t\t\t}\n\t\t\tfor (let i in optionsSource)\n\t\t\t{\n\t\t\t\toptionId = optionsSource[i]['id'];\n\t\t\t\toptions.set(optionId, this.createShortOptionProperty(optionId, optionsSource[i]));\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateShortOptionProperty(id, property)\n\t{\n\t\treturn {\n\t\t\ttitle: property['customData']['title'],\n\t\t\tgroupId: property['customData']['groupId'],\n\t\t\tvalue: id\n\t\t};\n\t}\n\n\tgetAvailableOptionsByGroup()\n\t{\n\t\tlet options = new Map();\n\t\tlet items;\n\n\t\tthis.fillOptionsByGroupWithGlobals(this.variables, options, this.gVarObjectName);\n\t\tthis.fillOptionsByGroupWithGlobals(this.constants, options, this.gConstObjectName);\n\n\t\titems = [];\n\t\tfor (let i in this.documentFields) {\n\t\t\titems.push(this.documentFields[i]);\n\t\t}\n\t\toptions.set(this.documentObjectName + ':' + this.documentObjectName, items);\n\n\t\toptions.set(this.operationObjectName, this.getOperationGroupOptions());\n\n\t\treturn options;\n\t}\n\n\tfillOptionsByGroupWithGlobals(source, options, topGroupName)\n\t{\n\t\tlet key;\n\t\tfor (let subGroupName in source)\n\t\t{\n\t\t\tkey = topGroupName + ':' + subGroupName;\n\t\t\toptions.set(key, source[subGroupName]);\n\t\t}\n\t}\n\n\tgetOperationGroupOptions()\n\t{\n\t\tlet items = [];\n\t\tlet source = this.operations;\n\t\tlet me = this;\n\n\t\tfor (let i in source)\n\t\t{\n\t\t\titems.push({\n\t\t\t\ttext: source[i],\n\t\t\t\tonclick: function (event, item)\n\t\t\t\t{\n\t\t\t\t\tlet target = this.bindElement;\n\t\t\t\t\tif (target)\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget.innerText = item.text;\n\t\t\t\t\t\tme.resolveHiddenInput(target, item.text, document.getElementById(\n\t\t\t\t\t\t\tme.resultIdName + target.getAttribute(me.indexAttributeName)\n\t\t\t\t\t\t));\n\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn items;\n\t}\n\n\taddConditionRobot(variableId, mathCondition)\n\t{\n\t\tlet properties = this.getPropertiesInfo(variableId, mathCondition);\n\n\t\tlet me = this;\n\t\tlet addRowTable = this.addRowTable;\n\t\tthis.rowIndex++;\n\n\t\tlet newRow = BX.Tag.render`<div class=\"bizproc-automation-popup-settings\"></div>`;\n\n\t\tlet rowProperties = BX.Tag.render`\n\t\t\t<div class=\"bizproc-automation-popup-settings bizproc-automation-popup-settings-text\"></div>\n\t\t`;\n\t\tlet rowInputs = BX.Tag.render`<div id=\"${this.resultIdName + this.rowIndex}\"></div>`;\n\n\t\t/* region Variable Wrapper */\n\n\t\tlet variableSpan = BX.Tag.render`\n\t\t\t<span class=\"bizproc-automation-popup-settings-link\" id=\"${this.variableIdName + this.rowIndex}\"></span>\n\t\t`;\n\t\tvariableSpan.setAttribute(this.indexAttributeName, this.rowIndex);\n\n\t\tthis.replaceTitleSelector(variableSpan, properties['variable'].title, rowInputs);\n\n\t\tBX.bind(variableSpan, 'click', function (event) {\n\t\t\tme.onFieldSelectClick(event, 'variable', me);\n\t\t});\n\t\trowProperties.appendChild(variableSpan);\n\n\t\t/* endregion */\n\n\t\trowProperties.appendChild(BX.Tag.render`<span> = </span>`);\n\n\t\tlet parameter1Span = this.getParameterSpan(\n\t\t\tthis.parameter1IdName + this.rowIndex,\n\t\t\tproperties['parameter1'].title,\n\t\t\trowInputs\n\t\t);\n\t\trowProperties.appendChild(parameter1Span);\n\n\t\t/* region Operation Wrapper*/\n\n\t\tlet operationSpan = BX.Tag.render`\n\t\t\t<span \n\t\t\t\tclass=\"bizproc-automation-popup-settings-link bizproc-automation-condition-joiner\" \n\t\t\t\tid=\"${this.operationIdName + this.rowIndex}\"\n\t\t\t></span>\n\t\t`;\n\t\toperationSpan.setAttribute(this.indexAttributeName, this.rowIndex);\n\n\t\tthis.replaceTitleSelector(operationSpan, properties['operation'].title, rowInputs);\n\n\t\tBX.bind(operationSpan, 'click', function (event) {\n\t\t\tme.onOperationSelectClick(event, me)\n\t\t});\n\t\trowProperties.appendChild(operationSpan);\n\n\t\t/* endregion */\n\n\t\tlet parameter2Span = this.getParameterSpan(\n\t\t\tthis.parameter2IdName + this.rowIndex,\n\t\t\tproperties['parameter2'].title,\n\t\t\trowInputs\n\t\t);\n\t\trowProperties.appendChild(parameter2Span);\n\n\t\tnewRow.appendChild(rowProperties);\n\t\tnewRow.appendChild(rowInputs);\n\n\t\taddRowTable.appendChild(newRow);\n\t}\n\n\tgetPropertiesInfo(variableId, mathCondition)\n\t{\n\t\tlet properties = {\n\t\t\t'variable': {value: variableId, defaultValue: 'variable'},\n\t\t\t'parameter1': {value: mathCondition[0], defaultValue: 'parameter'},\n\t\t\t'operation': {value: mathCondition[1], defaultValue: '+'},\n\t\t\t'parameter2': {value: mathCondition[2], defaultValue: 'parameter'}\n\t\t}\n\n\t\tlet infos = {};\n\t\tfor (let i in properties)\n\t\t{\n\t\t\tinfos[i] = this.getPropertyInfo(properties[i].value, properties[i].defaultValue);\n\t\t}\n\n\t\treturn infos;\n\t}\n\n\tgetPropertyInfo(item, defaultValue)\n\t{\n\t\tif (this.options.get(item) === undefined)\n\t\t{\n\t\t\titem = Number(item);\n\t\t\tif (isNaN(item))\n\t\t\t{\n\t\t\t\treturn {title: defaultValue}\n\t\t\t}\n\t\t}\n\n\t\treturn {title: item};\n\t}\n\n\tgetParameterSpan(id, title, rowInputs)\n\t{\n\t\tlet parameterSpan = BX.Tag.render`<span class=\"bizproc-automation-popup-settings-link\" id=\"${id}\"></span>`;\n\t\tparameterSpan.setAttribute(this.indexAttributeName, this.rowIndex);\n\n\t\tthis.replaceTitleSelector(parameterSpan, title, rowInputs);\n\n\t\tlet me = this;\n\t\tBX.bind(parameterSpan, 'click', function (event) {\n\t\t\tme.onFieldSelectClick(event, 'all', me);\n\t\t});\n\n\t\treturn parameterSpan;\n\t}\n\n\tonFieldSelectClick(event, type, me)\n\t{\n\t\tlet target = event.target;\n\t\tlet targetId = target.id;\n\n\t\tlet itemValue = document.getElementById(targetId + '_input').value;\n\t\tlet form = me.createFormForMenu(type, itemValue);\n\n\t\tlet popup = new BX.PopupWindow(\n\t\t\ttargetId + '_popup',\n\t\t\ttarget,\n\t\t\t{\n\t\t\t\tclassName: 'bizproc-automation-popup-set',\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 5,\n\t\t\t\toverlay: {backgroundColor: 'transparent'},\n\t\t\t\tcontent: form,\n\t\t\t\tbuttons: [\n\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\ttext: BX.message('BIZPROC_AUTOMATION_CMP_CHOOSE'),\n\t\t\t\t\t\tclassName: \"webform-button webform-button-create\" ,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\tlet formInput = form.getElementsByTagName('input')[0];\n\t\t\t\t\t\t\t\tlet rowInput = document.getElementById(\n\t\t\t\t\t\t\t\t\tme.resultIdName + target.getAttribute(me.indexAttributeName)\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tme.replaceTitleSelector(target, formInput.value, rowInput);\n\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew BX.PopupWindowButtonLink({\n\t\t\t\t\t\ttext : BX.message('BIZPROC_AUTOMATION_CMP_CANCEL'),\n\t\t\t\t\t\tclassName : \"popup-window-button-link\",\n\t\t\t\t\t\tevents : {\n\t\t\t\t\t\t\tclick: function(){\n\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: function ()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tpopup.show();\n\t}\n\n\tonOperationSelectClick(event, me)\n\t{\n\t\tlet target = event.target;\n\t\tBX.Main.MenuManager.show(\n\t\t\tme.operationMenuIdName + Math.random(),\n\t\t\ttarget,\n\t\t\tme.optionsByGroup.get(me.operationObjectName) ?? [],\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tclassName: 'bizproc-automation-inline-selector-menu',\n\t\t\t\toverlay: {backgroundColor: 'transparent'},\n\t\t\t\tminHeight: 50,\n\t\t\t\tminWidth: 40,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupClose: function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\treplaceTitleSelector(target, itemValue, rowInputs)\n\t{\n\t\tlet item = this.options.get(itemValue);\n\t\tlet inputValue;\n\n\t\tif (target && (item !== undefined)) {\n\t\t\ttarget.innerText = item['title'];\n\t\t\tinputValue = item['value'];\n\t\t}\n\t\telse if (target && !isNaN(Number(itemValue)))\n\t\t{\n\t\t\tinputValue = Number(itemValue);\n\t\t\tif (String(target.id).startsWith(this.variableIdName) && inputValue === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttarget.innerText = inputValue;\n\t\t}\n\t\telse {\n\t\t\treturn;\n\t\t}\n\n\t\tif (rowInputs)\n\t\t{\n\t\t\tthis.resolveHiddenInput(target, inputValue, rowInputs);\n\t\t}\n\t}\n\n\tresolveHiddenInput(source, value, target)\n\t{\n\t\tlet input = document.getElementById(source.id + '_input');\n\t\tif (input)\n\t\t{\n\t\t\tinput.name = source.id;\n\t\t\tinput.value = value;\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet name = source.id;\n\t\tlet id = name + '_input';\n\n\t\ttarget.appendChild(BX.Tag.render`<input type=\"hidden\" id=\"${id}\" name=\"${name}\" value=\"${value}\">`);\n\t}\n\n\tcreateFormForMenu(type, itemValue)\n\t{\n\t\tlet me = this;\n\n\t\tlet form = Tag.render`<form class=\"bizproc-automation-popup-select-block\"></form>`;\n\n\t\tlet fieldsListWrapper = Tag.render`<div class=\"bizproc-automation-popup-settings\"></div>`;\n\t\tlet labelFieldsList = Tag.render`<div class=\"bizproc-automation-robot-settings-title\"></div>`;\n\t\tlabelFieldsList.innerText = BX.message('BPMOA_LIST_OF_VALUES');\n\n\t\tlet formInput = Tag.render`<input class=\"bizproc-automation-popup-input\" type=\"hidden\" style=\"width: 280px;\">`;\n\n\t\tlet fieldsSelectNode = Tag.render`<div class=\"bizproc-automation-popup-settings-dropdown\" readonly=\"readonly\"></div>`;\n\t\tBX.bind(fieldsSelectNode, 'click', function () {\n\t\t\tlet items = me.optionsByGroup.get(visibilitySelect.value) ?? [];\n\t\t\tlet visibilityInfo = me.getVisibilityInfoForDialog(visibilitySelect.value);\n\n\t\t\tlet dialogOptions = me.getDialogOptions(items, visibilityInfo);\n\t\t\tdialogOptions['targetNode'] = this;\n\t\t\tdialogOptions['events'] = {\n\t\t\t\t'Item:onBeforeSelect': (event) => {\n\t\t\t\t\tlet item = event.data.item;\n\t\t\t\t\tfieldsSelectNode.innerText = item.customData.get('title');\n\t\t\t\t\tformInput.value = item.id;\n\t\t\t\t},\n\t\t\t\tonHide: function(event) {\n\t\t\t\t\tevent.target.destroy();\n\t\t\t\t},\n\t\t\t\t'Search:onItemCreateAsync': (event) => {\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tlet query = event.getData().searchQuery.query;\n\t\t\t\t\t\tlet dialog = event.getTarget();\n\n\t\t\t\t\t\tme.onCreateGlobalsClick(dialog, visibilityInfo, query, me, resolve);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tlet dialog = new Dialog(dialogOptions);\n\n\t\t\tif (items.length <= 0) {\n\t\t\t\tdialog.setFooter(me.getFooter(visibilityInfo, dialog));\n\t\t\t}\n\n\t\t\tdialog.show();\n\t\t});\n\n\t\tlet visibilityWrapper = Tag.render`<div class=\"bizproc-automation-popup-settings\"></div>`;\n\t\tlet visibilitySelect = Tag.render`<select class=\"bizproc-automation-popup-settings-dropdown\"></select>`;\n\t\tBX.bind(visibilitySelect, 'change', function () {\n\t\t\tme.changeSelectForField(this.value, fieldsSelectNode, labelFieldsList, formInput);\n\t\t});\n\n\t\tlet options = this.getVisibilityNamesForSelect(type);\n\t\tfor (let groupId in options)\n\t\t{\n\t\t\tlet optionNode = Tag.render`<option value=\"${BX.util.htmlspecialchars(groupId)}\"></option>`;\n\t\t\toptionNode.innerText = options[groupId];\n\n\t\t\tvisibilitySelect.appendChild(optionNode);\n\t\t}\n\n\t\tlet item = this.options.get(itemValue);\n\n\t\tvisibilitySelect.value = item ? item['groupId'] : this.helperObjectName + ':number';\n\t\tif (visibilitySelect.selectedIndex === -1) {\n\t\t\tvisibilitySelect.selectedIndex = 0;\n\t\t}\n\t\tthis.changeSelectForField(visibilitySelect.value, fieldsSelectNode, labelFieldsList, formInput);\n\t\tif (item && item['groupId'] !== this.helperObjectName)\n\t\t{\n\t\t\tfieldsSelectNode.innerText = item['title'];\n\t\t\tformInput.value = itemValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfieldsSelectNode.innerText = BX.message('BPMOA_EMPTY');\n\t\t\tformInput.value = itemValue;\n\t\t}\n\n\t\tvisibilityWrapper.appendChild(Tag.render`\n\t\t\t<div class=\"bizproc-automation-robot-settings-title\">\n\t\t\t\t${BX.util.htmlspecialchars(BX.message('BPMOA_TYPE_OF_PARAMETER'))}\n\t\t\t</div>\n\t\t`);\n\t\tvisibilityWrapper.appendChild(visibilitySelect);\n\n\t\tfieldsListWrapper.appendChild(labelFieldsList);\n\t\tfieldsListWrapper.appendChild(fieldsSelectNode);\n\t\tfieldsListWrapper.append(formInput);\n\n\t\tform.appendChild(visibilityWrapper);\n\t\tform.appendChild(fieldsListWrapper);\n\n\t\treturn form;\n\t}\n\n\tgetVisibilityInfoForDialog(visibility)\n\t{\n\t\tlet recentStubOptions = {};\n\t\tlet searchStubOptions = {};\n\t\tlet searchFooterOptions = {};\n\t\tlet mode = '';\n\t\tlet objectName = '';\n\n\t\tif (this.isGVariable(visibility))\n\t\t{\n\t\t\trecentStubOptions = {\n\t\t\t\ttitle: BX.message('BPMOA_GVARIABLE_NO_EXIST'),\n\t\t\t\tsubtitle: BX.message('BPMOA_CREATE_GVARIABLE_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchStubOptions = {\n\t\t\t\ttitle: BX.message('BPMOA_GVARIABLE_NOT_FOUND'),\n\t\t\t\tsubtitle: BX.message('BPMOA_CREATE_GVARIABLE_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchFooterOptions = {\n\t\t\t\tlabel: BX.message('BPMOA_CREATE_GVARIABLE'),\n\t\t\t};\n\n\t\t\tmode = Globals.Manager.Instance.mode.variable;\n\t\t\tobjectName = this.gVarObjectName;\n\t\t}\n\t\telse if (this.isGConstant(visibility))\n\t\t{\n\t\t\trecentStubOptions = {\n\t\t\t\ttitle: BX.message('BPMOA_GCONSTANT_NO_EXIST'),\n\t\t\t\tsubtitle: BX.message('BPMOA_CREATE_GCONSTANT_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchStubOptions = {\n\t\t\t\ttitle: BX.message('BPMOA_GCONSTANT_NOT_FOUND'),\n\t\t\t\tsubtitle: BX.message('BPMOA_CREATE_GCONSTANT_QUESTION'),\n\t\t\t\tarrow: true\n\t\t\t};\n\n\t\t\tsearchFooterOptions = {\n\t\t\t\tlabel: BX.message('BPMOA_CREATE_GCONSTANT')\n\t\t\t};\n\n\t\t\tmode = Globals.Manager.Instance.mode.constant;\n\t\t\tobjectName = this.gConstObjectName;\n\t\t}\n\t\telse if (this.isDocument(visibility))\n\t\t{\n\t\t\tobjectName = this.documentObjectName;\n\t\t}\n\n\t\treturn {\n\t\t\trecentStubOptions,\n\t\t\tsearchStubOptions,\n\t\t\tsearchFooterOptions,\n\t\t\tmode,\n\t\t\tobjectName,\n\t\t\tvisibility\n\t\t};\n\t}\n\n\tgetDialogOptions(items, visibilityInfo)\n\t{\n\t\tlet options = {\n\t\t\twidth: 480,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tshowAvatars: false,\n\t\t\tcompactView: true,\n\t\t\titems: items,\n\t\t\ttagSelectorOptions: {\n\t\t\t\ttextBoxWidth: 400\n\t\t\t}\n\t\t};\n\n\t\tlet extraOptions = {\n\t\t\trecentTabOptions: {\n\t\t\t\tstub: true,\n\t\t\t\ticon: '',\n\t\t\t\tstubOptions: visibilityInfo.recentStubOptions\n\t\t\t},\n\t\t\tsearchTabOptions: {\n\t\t\t\tstub: true,\n\t\t\t\tstubOptions: visibilityInfo.searchStubOptions\n\t\t\t},\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: true,\n\t\t\t\tfooterOptions: visibilityInfo.searchFooterOptions\n\t\t\t}\n\t\t};\n\n\t\tif (\n\t\t\tvisibilityInfo.objectName === this.gVarObjectName\n\t\t\t|| visibilityInfo.objectName === this.gConstObjectName\n\t\t)\n\t\t{\n\t\t\treturn Object.assign(options, extraOptions);\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tgetFooter(visibilityInfo, dialog)\n\t{\n\t\tlet me = this;\n\t\tlet footer = Tag.render`\n\t\t\t<span class=\"ui-selector-footer-link ui-selector-footer-link-add\" style=\"border: none\">\n\t\t\t\t${BX.util.htmlspecialchars(visibilityInfo.searchFooterOptions.label)}\n\t\t\t</span>\n\t\t`;\n\n\t\tBX.bind(footer, 'click', () => {\n\t\t\tme.onCreateGlobalsClick(dialog, visibilityInfo, '', me);\n\t\t});\n\n\t\treturn footer;\n\t}\n\n\tonCreateGlobalsClick(dialog, visibilityInfo, query,  me, resolve)\n\t{\n\t\tlet visibility = visibilityInfo.visibility;\n\t\tlet additionalContext = {\n\t\t\tvisibility: visibility.slice(visibility.indexOf(':') + 1),\n\t\t\tavailableTypes: me.availableTypes\n\t\t};\n\t\tGlobals.Manager.Instance.createGlobals(visibilityInfo.mode, me.signedDocumentType, query, additionalContext)\n\t\t\t.then((slider) =>\n\t\t\t{\n\t\t\t\tlet context = {\n\t\t\t\t\t'objectName': visibilityInfo.objectName,\n\t\t\t\t\t'visibility': visibilityInfo.visibility\n\t\t\t\t};\n\t\t\t\tme.onAfterCreateGlobals(dialog, slider, context);\n\t\t\t\tif (resolve)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tonAfterCreateGlobals(dialog, slider, context)\n\t{\n\t\tlet info = slider.getData().entries();\n\t\tlet keys = Object.keys(info);\n\t\tif (keys.length <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet id = keys[0];\n\t\tlet property = info[keys[0]];\n\n\t\tif (!this.availableTypes.includes(property['Type']))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet item = {\n\t\t\tentityId: 'bp',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: property['Name'],\n\t\t\tid: '{=' + context.objectName + ':' + id + '}',\n\t\t\tcustomData: {\n\t\t\t\tgroupId: context.objectName + ':' + property['Visibility'],\n\t\t\t\tproperty: property,\n\t\t\t\ttitle: property['Name']\n\t\t\t}\n\t\t};\n\n\t\tif (item.customData.groupId === context.visibility)\n\t\t{\n\t\t\tdialog.setFooter(null);\n\t\t\tdialog.addItem(item);\n\t\t}\n\n\t\tthis.options.set(item.id, this.createShortOptionProperty(item.id, item));\n\n\t\tlet groupItems = this.optionsByGroup.get(item.customData.groupId) ?? [];\n\t\tgroupItems.push(item);\n\t\tthis.optionsByGroup.set(item.customData.groupId, groupItems);\n\t}\n\n\tchangeSelectForField(value, target, label, input)\n\t{\n\t\tif (value !== this.helperObjectName + ':number')\n\t\t{\n\t\t\ttarget.style.display = '';\n\t\t\tlabel.innerText = BX.message('BPMOA_LIST_OF_VALUES');\n\t\t\ttarget.innerText = BX.message('BPMOA_EMPTY');\n\t\t\tinput.type = 'hidden';\n\t\t\tinput.value = '';\n\n\t\t\treturn;\n\t\t}\n\n\t\tlabel.innerText = BX.message('BPMOA_INPUT_NUMBER');\n\t\ttarget.style.display = 'none';\n\t\tinput.type = 'text';\n\t\tinput.value = '0';\n\t}\n\n\tgetVisibilityNamesForSelect(type)\n\t{\n\t\tlet list = {};\n\t\tlet numberMessages = {};\n\t\tnumberMessages[this.helperObjectName] = {\n\t\t\t'number': BX.message('BPMOA_NUMBER')\n\t\t};\n\t\tlet source = Object.assign({}, this.visibilityMessages, numberMessages);\n\n\t\tfor (let topGroupName in source) {\n\t\t\tif (type === 'variable' && topGroupName !== this.gVarObjectName) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor (let subGroupName in source[topGroupName]) {\n\t\t\t\tlist[topGroupName + ':' + subGroupName] = source[topGroupName][subGroupName];\n\t\t\t}\n\t\t}\n\n\t\treturn list;\n\t}\n\n\taddConditionDesigner(variableId, mathCondition)\n\t{\n\t\tlet addRowTable = this.addRowTable;\n\t\tthis.rowIndex++;\n\n\t\tlet newRow;\n\t\tlet cell, select;\n\n\t\tif (!mathCondition) {\n\t\t\tmathCondition = [NaN, null, NaN];\n\t\t}\n\n\t\tnewRow = addRowTable.insertRow(-1);\n\n\t\t/* region Variable Wrapper */\n\n\t\tcell = newRow.insertCell(-1);\n\t\tcell.style.minWidth = '50px';\n\n\t\tselect = BX.Tag.render`<select name=\"${this.variableIdName + this.rowIndex}\" style=\"width: 100%;\"></select>`;\n\t\tthis.appendChildToSelectDesigner(select, 'variable');\n\n\t\tselect.value = variableId;\n\t\tif (select.selectedIndex === -1) {\n\t\t\tselect.selectedIndex = 0;\n\t\t}\n\t\tcell.appendChild(select);\n\n\t\t/* endregion*/\n\n\t\tcell = newRow.insertCell(-1);\n\t\tcell.innerText = '=';\n\n\t\tthis.appendParameterSelectDesigner(newRow, this.parameter1IdName + this.rowIndex, mathCondition[0]);\n\n\t\t/* region Operation Wrapper */\n\n\t\tcell = newRow.insertCell(-1);\n\t\tcell.style.minWidth = '45px';\n\t\tselect = BX.Tag.render`<select name=\"${this.operationIdName + this.rowIndex}\" style=\"width: 100%\"></select>`;\n\t\tfor (let i in this.operations) {\n\t\t\tselect.appendChild(BX.Tag.render`\n\t\t\t\t<option value=\"${BX.util.htmlspecialchars(this.operations[i])}\">\n\t\t\t\t\t${BX.util.htmlspecialchars(this.operations[i])}\n\t\t\t\t</option>\n\t\t\t`);\n\t\t}\n\t\tselect.value = mathCondition[1];\n\t\tif (select.selectedIndex === -1) {\n\t\t\tselect.selectedIndex = 0;\n\t\t}\n\t\tcell.appendChild(select);\n\n\t\t/* endregion */\n\n\t\tthis.appendParameterSelectDesigner(newRow, this.parameter2IdName + this.rowIndex, mathCondition[2]);\n\t}\n\n\tappendChildToSelectDesigner(select, type)\n\t{\n\t\tfor (let objectName in this.visibilityMessages)\n\t\t{\n\t\t\tif (type === 'variable' && objectName !== this.gVarObjectName) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet objectVisibilityMessages = this.visibilityMessages[objectName];\n\t\t\tfor (let visibility in objectVisibilityMessages)\n\t\t\t{\n\t\t\t\tlet optgroupLabel = objectVisibilityMessages[visibility];\n\t\t\t\tlet optgroup = BX.Tag.render`<optgroup label=\"${BX.util.htmlspecialchars(optgroupLabel)}\"></optgroup>`;\n\n\t\t\t\tlet groupOptions = this.optionsByGroup.get(objectName + ':' + visibility);\n\t\t\t\tif (!groupOptions){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet optionNode, id, title;\n\t\t\t\tfor (let i in groupOptions)\n\t\t\t\t{\n\t\t\t\t\tlet groupOption = groupOptions[i];\n\t\t\t\t\tif (groupOption['children'])\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (let j in groupOption['children'])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid = groupOption['children'][j].id;\n\t\t\t\t\t\t\ttitle = groupOption['children'][j].customData.title;\n\t\t\t\t\t\t\toptionNode = BX.Tag.render`\n\t\t\t\t\t\t\t\t<option value=\"${BX.util.htmlspecialchars(id)}\">\n\t\t\t\t\t\t\t\t\t${BX.util.htmlspecialchars(title)}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\toptgroup.appendChild(optionNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tid = groupOption['id'];\n\t\t\t\t\t\ttitle = groupOption['customData']['title'];\n\t\t\t\t\t\toptionNode = BX.Tag.render`\n\t\t\t\t\t\t\t<option value=\"${BX.util.htmlspecialchars(id)}\">\n\t\t\t\t\t\t\t\t${BX.util.htmlspecialchars(title)}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t`;\n\t\t\t\t\t\toptgroup.appendChild(optionNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tselect.appendChild(optgroup);\n\t\t\t}\n\t\t}\n\t}\n\n\tchangeInputDesigner(target, value)\n\t{\n\t\tif (target.options[target.selectedIndex].value === '')\n\t\t{\n\t\t\ttarget.after(BX.Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tname=\"${target.name}\"\n\t\t\t\t\tstyle=\"width: 100px; height: 27px;\" \n\t\t\t\t\tvalue=\"${isFinite(value) ? value : 0}\"\n\t\t\t\t>\n\t\t\t`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet input = document.getElementsByName(target.name)[1];\n\t\t\tif (input) {\n\t\t\t\tinput.remove();\n\t\t\t}\n\t\t}\n\t}\n\n\tappendParameterSelectDesigner(newRow, id, value)\n\t{\n\t\tlet me = this;\n\t\tlet cell = newRow.insertCell(-1);\n\t\tlet select = BX.Tag.render`<select name=\"${BX.util.htmlspecialchars(id)}\" style=\"width: 100%\"></select>`;\n\t\tBX.bind(select, 'change', function (){\n\t\t\tme.changeInputDesigner(this, value);\n\t\t});\n\n\t\tselect.appendChild(BX.Tag.render`<option value=\"\">${BX.util.htmlspecialchars(BX.message('BPMOA_NUMBER'))}</option>`);\n\t\tthis.appendChildToSelectDesigner(select);\n\n\t\tselect.value = value;\n\t\tif (select.selectedIndex === -1) {\n\t\t\tselect.selectedIndex = 0;\n\t\t}\n\t\tcell.appendChild(select);\n\t\tthis.changeInputDesigner(select, value);\n\t}\n}\n\nnamespace.MathOperationActivity = MathOperationActivity;"],"names":["namespace","Reflection","MathOperationActivity","options","Type","isPlainObject","isRobot","signedDocumentType","variables","constants","documentFields","operations","currentValues","visibilityMessages","addRowTable","initObjectNames","initNodeAttributeNames","initNodeIdNames","initAvailableOptions","availableTypes","rowIndex","addCondition","Object","keys","length","variableId","gVarObjectName","gConstObjectName","documentObjectName","operationObjectName","helperObjectName","visibility","startsWith","indexAttributeName","variableIdName","parameter1IdName","operationIdName","parameter2IdName","resultIdName","operationMenuIdName","getAvailableOptions","optionsByGroup","getAvailableOptionsByGroup","Map","fillOptions","source","i","set","title","groupId","value","BX","message","optionId","optionsSource","groupName","createShortOptionProperty","id","property","items","fillOptionsByGroupWithGlobals","push","getOperationGroupOptions","topGroupName","key","subGroupName","me","text","onclick","event","item","target","bindElement","innerText","resolveHiddenInput","document","getElementById","getAttribute","popupWindow","close","mathCondition","properties","getPropertiesInfo","newRow","Tag","render","rowProperties","rowInputs","variableSpan","setAttribute","replaceTitleSelector","bind","onFieldSelectClick","appendChild","parameter1Span","getParameterSpan","operationSpan","onOperationSelectClick","parameter2Span","defaultValue","infos","getPropertyInfo","get","undefined","Number","isNaN","parameterSpan","type","targetId","itemValue","form","createFormForMenu","popup","PopupWindow","className","autoHide","closeByEsc","offsetTop","overlay","backgroundColor","content","buttons","PopupWindowButton","events","click","formInput","getElementsByTagName","rowInput","PopupWindowButtonLink","onPopupClose","destroy","show","Main","MenuManager","Math","random","minHeight","minWidth","inputValue","String","input","name","fieldsListWrapper","labelFieldsList","fieldsSelectNode","visibilitySelect","visibilityInfo","getVisibilityInfoForDialog","dialogOptions","getDialogOptions","data","customData","onHide","Promise","resolve","query","getData","searchQuery","dialog","getTarget","onCreateGlobalsClick","Dialog","setFooter","getFooter","visibilityWrapper","changeSelectForField","getVisibilityNamesForSelect","optionNode","util","htmlspecialchars","selectedIndex","append","recentStubOptions","searchStubOptions","searchFooterOptions","mode","objectName","isGVariable","subtitle","arrow","label","Globals","Manager","Instance","variable","isGConstant","constant","isDocument","width","height","multiple","dropdownMode","enableSearch","showAvatars","compactView","tagSelectorOptions","textBoxWidth","extraOptions","recentTabOptions","stub","icon","stubOptions","searchTabOptions","searchOptions","allowCreateItem","footerOptions","assign","footer","additionalContext","slice","indexOf","createGlobals","then","slider","context","onAfterCreateGlobals","info","entries","includes","entityId","tabs","addItem","groupItems","style","display","list","numberMessages","cell","select","NaN","insertRow","insertCell","appendChildToSelectDesigner","appendParameterSelectDesigner","objectVisibilityMessages","optgroupLabel","optgroup","groupOptions","groupOption","j","after","isFinite","getElementsByName","remove","changeInputDesigner"],"mappings":";;;;;AAAA,CAIA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAS,CAAC,qBAAqB,CAAC;CAAC,IAExDE,qBAAqB;GAqC1B,+BAAYC,OAAO,EACnB;KAAA;KACC,IAAIC,cAAI,CAACC,aAAa,CAACF,OAAO,CAAC,EAC/B;OACC,IAAI,CAACG,OAAO,GAAGH,OAAO,CAACG,OAAO;OAC9B,IAAI,CAACC,kBAAkB,GAAGJ,OAAO,CAACI,kBAAkB;OAEpD,IAAI,CAACC,SAAS,GAAGL,OAAO,CAACK,SAAS;OAClC,IAAI,CAACC,SAAS,GAAGN,OAAO,CAACM,SAAS;OAClC,IAAI,CAACC,cAAc,GAAGP,OAAO,CAACO,cAAc;OAC5C,IAAI,CAACC,UAAU,GAAGR,OAAO,CAACQ,UAAU;OAEpC,IAAI,CAACC,aAAa,GAAGT,OAAO,CAACS,aAAa;OAC1C,IAAI,CAACC,kBAAkB,GAAGV,OAAO,CAACU,kBAAkB;OAEpD,IAAI,CAACC,WAAW,GAAGX,OAAO,CAACW,WAAW;;;GAEvC;KAAA;KAAA,uBAGD;OACC,IAAI,CAACC,eAAe,EAAE;OACtB,IAAI,CAACC,sBAAsB,EAAE;OAC7B,IAAI,CAACC,eAAe,EAAE;OACtB,IAAI,CAACC,oBAAoB,EAAE;OAE3B,IAAI,CAACC,cAAc,GAAG,CAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;OAClD,IAAI,CAACC,QAAQ,GAAG,CAAC,CAAC;OAElB,IAAIC,YAAY,GAAG,IAAI,CAACf,OAAO,GAAG,mBAAmB,GAAG,sBAAsB;OAE9E,IAAIgB,MAAM,CAACC,IAAI,CAAC,IAAI,CAACX,aAAa,CAAC,CAACY,MAAM,IAAI,CAAC,EAC/C;SACC,IAAI,CAACH,YAAY,CAAC,CAAC,UAAU,EAAE,CAAC,WAAW,EAAE,GAAG,EAAE,WAAW,CAAC,CAAC;;OAEhE,KAAK,IAAII,UAAU,IAAI,IAAI,CAACb,aAAa,EACzC;SACC,IAAI,CAACS,YAAY,CAAC,CAACI,UAAU,EAAE,IAAI,CAACb,aAAa,CAACa,UAAU,CAAC,CAAC;;;;KAE/D;KAAA,kCAGD;OACC,IAAI,CAACC,cAAc,GAAG,WAAW;OACjC,IAAI,CAACC,gBAAgB,GAAG,aAAa;OACrC,IAAI,CAACC,kBAAkB,GAAG,UAAU;OACpC,IAAI,CAACC,mBAAmB,GAAG,WAAW;OAEtC,IAAI,CAACC,gBAAgB,GAAG,SAAS;;;KACjC;KAAA,4BAEWC,UAAU,EACtB;OACC,OAAOA,UAAU,CAACC,UAAU,CAAC,IAAI,CAACN,cAAc,CAAC;;;KACjD;KAAA,4BAEWK,UAAU,EACtB;OACC,OAAOA,UAAU,CAACC,UAAU,CAAC,IAAI,CAACL,gBAAgB,CAAC;;;KACnD;KAAA,2BAEUI,UAAU,EACrB;OACC,OAAOA,UAAU,CAACC,UAAU,CAAC,IAAI,CAACJ,kBAAkB,CAAC;;;KACrD;KAAA,yCAGD;OACC,IAAI,CAACK,kBAAkB,GAAG,cAAc;;;KACxC;KAAA,kCAGD;OACC,IAAI,CAACC,cAAc,GAAG,kBAAkB;OACxC,IAAI,CAACC,gBAAgB,GAAG,iBAAiB;OACzC,IAAI,CAACC,eAAe,GAAG,mBAAmB;OAC1C,IAAI,CAACC,gBAAgB,GAAG,iBAAiB;OAEzC,IAAI,CAACC,YAAY,GAAG,iBAAiB;OACrC,IAAI,CAACC,mBAAmB,GAAG,yBAAyB;;;KACpD;KAAA,uCAGD;OACC,IAAI,CAACpC,OAAO,GAAG,IAAI,CAACqC,mBAAmB,EAAE;OACzC,IAAI,CAACC,cAAc,GAAG,IAAI,CAACC,0BAA0B,EAAE;;;KACvD;KAAA,sCAGD;OACC,IAAIvC,OAAO,GAAG,IAAIwC,GAAG,EAAE;OAEvB,IAAI,CAACC,WAAW,CAAC,IAAI,CAACpC,SAAS,EAAEL,OAAO,CAAC;OACzC,IAAI,CAACyC,WAAW,CAAC,IAAI,CAACnC,SAAS,EAAEN,OAAO,CAAC;OACzC,IAAI,CAACyC,WAAW,CAAC,IAAI,CAAClC,cAAc,EAAEP,OAAO,CAAC;OAE9C,IAAI0C,MAAM,GAAG,IAAI,CAAClC,UAAU;OAC5B,KAAK,IAAImC,CAAC,IAAID,MAAM,EACpB;SACC1C,OAAO,CAAC4C,GAAG,CAACF,MAAM,CAACC,CAAC,CAAC,EAAE;WACtBE,KAAK,EAAEH,MAAM,CAACC,CAAC,CAAC;WAChBG,OAAO,EAAE,IAAI,CAACpB,mBAAmB;WACjCqB,KAAK,EAAEL,MAAM,CAACC,CAAC;UACf,CAAC;;OAGH3C,OAAO,CAAC4C,GAAG,CAAC,UAAU,EAAE;SACvBC,KAAK,EAAEG,EAAE,CAACC,OAAO,CAAC,uBAAuB,CAAC;SAC1CH,OAAO,EAAE,IAAI,CAACnB,gBAAgB;SAC9BoB,KAAK,EAAE;QACP,CAAC;OACF/C,OAAO,CAAC4C,GAAG,CAAC,WAAW,EAAE;SACxBC,KAAK,EAAEG,EAAE,CAACC,OAAO,CAAC,wBAAwB,CAAC;SAC3CH,OAAO,EAAE,IAAI,CAACnB,gBAAgB;SAC9BoB,KAAK,EAAE;QACP,CAAC;OACF/C,OAAO,CAAC4C,GAAG,CAAC,WAAW,EAAE;SACxBC,KAAK,EAAE,GAAG;SACVC,OAAO,EAAE,IAAI,CAACnB,gBAAgB;SAC9BoB,KAAK,EAAE;QACP,CAAC;OAEF,OAAO/C,OAAO;;;KACd;KAAA,4BAEW0C,MAAM,EAAE1C,OAAO,EAC3B;OACC,IAAIkD,QAAQ,EAAEC,aAAa;OAC3B,KAAK,IAAIC,SAAS,IAAIV,MAAM,EAC5B;SACCS,aAAa,GAAGT,MAAM,CAACU,SAAS,CAAC;SACjC,IAAID,aAAa,CAAC,UAAU,CAAC,EAAE;WAC9BA,aAAa,GAAGA,aAAa,CAAC,UAAU,CAAC;;SAE1C,KAAK,IAAIR,CAAC,IAAIQ,aAAa,EAC3B;WACCD,QAAQ,GAAGC,aAAa,CAACR,CAAC,CAAC,CAAC,IAAI,CAAC;WACjC3C,OAAO,CAAC4C,GAAG,CAACM,QAAQ,EAAE,IAAI,CAACG,yBAAyB,CAACH,QAAQ,EAAEC,aAAa,CAACR,CAAC,CAAC,CAAC,CAAC;;;;;KAGnF;KAAA,0CAEyBW,EAAE,EAAEC,QAAQ,EACtC;OACC,OAAO;SACNV,KAAK,EAAEU,QAAQ,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC;SACtCT,OAAO,EAAES,QAAQ,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC;SAC1CR,KAAK,EAAEO;QACP;;;KACD;KAAA,6CAGD;OACC,IAAItD,OAAO,GAAG,IAAIwC,GAAG,EAAE;OACvB,IAAIgB,KAAK;OAET,IAAI,CAACC,6BAA6B,CAAC,IAAI,CAACpD,SAAS,EAAEL,OAAO,EAAE,IAAI,CAACuB,cAAc,CAAC;OAChF,IAAI,CAACkC,6BAA6B,CAAC,IAAI,CAACnD,SAAS,EAAEN,OAAO,EAAE,IAAI,CAACwB,gBAAgB,CAAC;OAElFgC,KAAK,GAAG,EAAE;OACV,KAAK,IAAIb,CAAC,IAAI,IAAI,CAACpC,cAAc,EAAE;SAClCiD,KAAK,CAACE,IAAI,CAAC,IAAI,CAACnD,cAAc,CAACoC,CAAC,CAAC,CAAC;;OAEnC3C,OAAO,CAAC4C,GAAG,CAAC,IAAI,CAACnB,kBAAkB,GAAG,GAAG,GAAG,IAAI,CAACA,kBAAkB,EAAE+B,KAAK,CAAC;OAE3ExD,OAAO,CAAC4C,GAAG,CAAC,IAAI,CAAClB,mBAAmB,EAAE,IAAI,CAACiC,wBAAwB,EAAE,CAAC;OAEtE,OAAO3D,OAAO;;;KACd;KAAA,8CAE6B0C,MAAM,EAAE1C,OAAO,EAAE4D,YAAY,EAC3D;OACC,IAAIC,GAAG;OACP,KAAK,IAAIC,YAAY,IAAIpB,MAAM,EAC/B;SACCmB,GAAG,GAAGD,YAAY,GAAG,GAAG,GAAGE,YAAY;SACvC9D,OAAO,CAAC4C,GAAG,CAACiB,GAAG,EAAEnB,MAAM,CAACoB,YAAY,CAAC,CAAC;;;;KAEvC;KAAA,2CAGD;OACC,IAAIN,KAAK,GAAG,EAAE;OACd,IAAId,MAAM,GAAG,IAAI,CAAClC,UAAU;OAC5B,IAAIuD,EAAE,GAAG,IAAI;OAEb,KAAK,IAAIpB,CAAC,IAAID,MAAM,EACpB;SACCc,KAAK,CAACE,IAAI,CAAC;WACVM,IAAI,EAAEtB,MAAM,CAACC,CAAC,CAAC;WACfsB,OAAO,EAAE,iBAAUC,KAAK,EAAEC,IAAI,EAC9B;aACC,IAAIC,MAAM,GAAG,IAAI,CAACC,WAAW;aAC7B,IAAID,MAAM,EACV;eACCA,MAAM,CAACE,SAAS,GAAGH,IAAI,CAACH,IAAI;eAC5BD,EAAE,CAACQ,kBAAkB,CAACH,MAAM,EAAED,IAAI,CAACH,IAAI,EAAEQ,QAAQ,CAACC,cAAc,CAC/DV,EAAE,CAAC5B,YAAY,GAAGiC,MAAM,CAACM,YAAY,CAACX,EAAE,CAACjC,kBAAkB,CAAC,CAC5D,CAAC;eACF,IAAI,CAAC6C,WAAW,CAACC,KAAK,EAAE;;;UAG1B,CAAC;;OAGH,OAAOpB,KAAK;;;KACZ;KAAA,kCAEiBlC,UAAU,EAAEuD,aAAa,EAC3C;OACC,IAAIC,UAAU,GAAG,IAAI,CAACC,iBAAiB,CAACzD,UAAU,EAAEuD,aAAa,CAAC;OAElE,IAAId,EAAE,GAAG,IAAI;OACb,IAAIpD,WAAW,GAAG,IAAI,CAACA,WAAW;OAClC,IAAI,CAACM,QAAQ,EAAE;OAEf,IAAI+D,MAAM,GAAGhC,EAAE,CAACiC,GAAG,CAACC,MAAM,wIAAuD;OAEjF,IAAIC,aAAa,GAAGnC,EAAE,CAACiC,GAAG,CAACC,MAAM,+LAEhC;OACD,IAAIE,SAAS,GAAGpC,EAAE,CAACiC,GAAG,CAACC,MAAM,2GAAY,IAAI,CAAC/C,YAAY,GAAG,IAAI,CAAClB,QAAQ,CAAU;;;;OAIpF,IAAIoE,YAAY,GAAGrC,EAAE,CAACiC,GAAG,CAACC,MAAM,4KAC4B,IAAI,CAACnD,cAAc,GAAG,IAAI,CAACd,QAAQ,CAC9F;OACDoE,YAAY,CAACC,YAAY,CAAC,IAAI,CAACxD,kBAAkB,EAAE,IAAI,CAACb,QAAQ,CAAC;OAEjE,IAAI,CAACsE,oBAAoB,CAACF,YAAY,EAAEP,UAAU,CAAC,UAAU,CAAC,CAACjC,KAAK,EAAEuC,SAAS,CAAC;OAEhFpC,EAAE,CAACwC,IAAI,CAACH,YAAY,EAAE,OAAO,EAAE,UAAUnB,KAAK,EAAE;SAC/CH,EAAE,CAAC0B,kBAAkB,CAACvB,KAAK,EAAE,UAAU,EAAEH,EAAE,CAAC;QAC5C,CAAC;OACFoB,aAAa,CAACO,WAAW,CAACL,YAAY,CAAC;;;;OAIvCF,aAAa,CAACO,WAAW,CAAC1C,EAAE,CAACiC,GAAG,CAACC,MAAM,oGAAmB;OAE1D,IAAIS,cAAc,GAAG,IAAI,CAACC,gBAAgB,CACzC,IAAI,CAAC5D,gBAAgB,GAAG,IAAI,CAACf,QAAQ,EACrC6D,UAAU,CAAC,YAAY,CAAC,CAACjC,KAAK,EAC9BuC,SAAS,CACT;OACDD,aAAa,CAACO,WAAW,CAACC,cAAc,CAAC;;;;OAIzC,IAAIE,aAAa,GAAG7C,EAAE,CAACiC,GAAG,CAACC,MAAM,4OAGzB,IAAI,CAACjD,eAAe,GAAG,IAAI,CAAChB,QAAQ,CAE3C;OACD4E,aAAa,CAACP,YAAY,CAAC,IAAI,CAACxD,kBAAkB,EAAE,IAAI,CAACb,QAAQ,CAAC;OAElE,IAAI,CAACsE,oBAAoB,CAACM,aAAa,EAAEf,UAAU,CAAC,WAAW,CAAC,CAACjC,KAAK,EAAEuC,SAAS,CAAC;OAElFpC,EAAE,CAACwC,IAAI,CAACK,aAAa,EAAE,OAAO,EAAE,UAAU3B,KAAK,EAAE;SAChDH,EAAE,CAAC+B,sBAAsB,CAAC5B,KAAK,EAAEH,EAAE,CAAC;QACpC,CAAC;OACFoB,aAAa,CAACO,WAAW,CAACG,aAAa,CAAC;;;;OAIxC,IAAIE,cAAc,GAAG,IAAI,CAACH,gBAAgB,CACzC,IAAI,CAAC1D,gBAAgB,GAAG,IAAI,CAACjB,QAAQ,EACrC6D,UAAU,CAAC,YAAY,CAAC,CAACjC,KAAK,EAC9BuC,SAAS,CACT;OACDD,aAAa,CAACO,WAAW,CAACK,cAAc,CAAC;OAEzCf,MAAM,CAACU,WAAW,CAACP,aAAa,CAAC;OACjCH,MAAM,CAACU,WAAW,CAACN,SAAS,CAAC;OAE7BzE,WAAW,CAAC+E,WAAW,CAACV,MAAM,CAAC;;;KAC/B;KAAA,kCAEiB1D,UAAU,EAAEuD,aAAa,EAC3C;OACC,IAAIC,UAAU,GAAG;SAChB,UAAU,EAAE;WAAC/B,KAAK,EAAEzB,UAAU;WAAE0E,YAAY,EAAE;UAAW;SACzD,YAAY,EAAE;WAACjD,KAAK,EAAE8B,aAAa,CAAC,CAAC,CAAC;WAAEmB,YAAY,EAAE;UAAY;SAClE,WAAW,EAAE;WAACjD,KAAK,EAAE8B,aAAa,CAAC,CAAC,CAAC;WAAEmB,YAAY,EAAE;UAAI;SACzD,YAAY,EAAE;WAACjD,KAAK,EAAE8B,aAAa,CAAC,CAAC,CAAC;WAAEmB,YAAY,EAAE;;QACtD;OAED,IAAIC,KAAK,GAAG,EAAE;OACd,KAAK,IAAItD,CAAC,IAAImC,UAAU,EACxB;SACCmB,KAAK,CAACtD,CAAC,CAAC,GAAG,IAAI,CAACuD,eAAe,CAACpB,UAAU,CAACnC,CAAC,CAAC,CAACI,KAAK,EAAE+B,UAAU,CAACnC,CAAC,CAAC,CAACqD,YAAY,CAAC;;OAGjF,OAAOC,KAAK;;;KACZ;KAAA,gCAEe9B,IAAI,EAAE6B,YAAY,EAClC;OACC,IAAI,IAAI,CAAChG,OAAO,CAACmG,GAAG,CAAChC,IAAI,CAAC,KAAKiC,SAAS,EACxC;SACCjC,IAAI,GAAGkC,MAAM,CAAClC,IAAI,CAAC;SACnB,IAAImC,KAAK,CAACnC,IAAI,CAAC,EACf;WACC,OAAO;aAACtB,KAAK,EAAEmD;YAAa;;;OAI9B,OAAO;SAACnD,KAAK,EAAEsB;QAAK;;;KACpB;KAAA,iCAEgBb,EAAE,EAAET,KAAK,EAAEuC,SAAS,EACrC;OACC,IAAImB,aAAa,GAAGvD,EAAE,CAACiC,GAAG,CAACC,MAAM,8JAA4D5B,EAAE,CAAW;OAC1GiD,aAAa,CAACjB,YAAY,CAAC,IAAI,CAACxD,kBAAkB,EAAE,IAAI,CAACb,QAAQ,CAAC;OAElE,IAAI,CAACsE,oBAAoB,CAACgB,aAAa,EAAE1D,KAAK,EAAEuC,SAAS,CAAC;OAE1D,IAAIrB,EAAE,GAAG,IAAI;OACbf,EAAE,CAACwC,IAAI,CAACe,aAAa,EAAE,OAAO,EAAE,UAAUrC,KAAK,EAAE;SAChDH,EAAE,CAAC0B,kBAAkB,CAACvB,KAAK,EAAE,KAAK,EAAEH,EAAE,CAAC;QACvC,CAAC;OAEF,OAAOwC,aAAa;;;KACpB;KAAA,mCAEkBrC,KAAK,EAAEsC,IAAI,EAAEzC,EAAE,EAClC;OACC,IAAIK,MAAM,GAAGF,KAAK,CAACE,MAAM;OACzB,IAAIqC,QAAQ,GAAGrC,MAAM,CAACd,EAAE;OAExB,IAAIoD,SAAS,GAAGlC,QAAQ,CAACC,cAAc,CAACgC,QAAQ,GAAG,QAAQ,CAAC,CAAC1D,KAAK;OAClE,IAAI4D,IAAI,GAAG5C,EAAE,CAAC6C,iBAAiB,CAACJ,IAAI,EAAEE,SAAS,CAAC;OAEhD,IAAIG,KAAK,GAAG,IAAI7D,EAAE,CAAC8D,WAAW,CAC7BL,QAAQ,GAAG,QAAQ,EACnBrC,MAAM,EACN;SACC2C,SAAS,EAAE,8BAA8B;SACzCC,QAAQ,EAAE,IAAI;SACdC,UAAU,EAAE,IAAI;SAChBC,SAAS,EAAE,CAAC;SACZC,OAAO,EAAE;WAACC,eAAe,EAAE;UAAc;SACzCC,OAAO,EAAEV,IAAI;SACbW,OAAO,EAAE,CACR,IAAItE,EAAE,CAACuE,iBAAiB,CAAC;WACxBvD,IAAI,EAAEhB,EAAE,CAACC,OAAO,CAAC,+BAA+B,CAAC;WACjD8D,SAAS,EAAE,sCAAsC;WACjDS,MAAM,EAAE;aACPC,KAAK,EAAE,iBAAW;eACjB,IAAIC,SAAS,GAAGf,IAAI,CAACgB,oBAAoB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;eACrD,IAAIC,QAAQ,GAAGpD,QAAQ,CAACC,cAAc,CACrCV,EAAE,CAAC5B,YAAY,GAAGiC,MAAM,CAACM,YAAY,CAACX,EAAE,CAACjC,kBAAkB,CAAC,CAC5D;eAEDiC,EAAE,CAACwB,oBAAoB,CAACnB,MAAM,EAAEsD,SAAS,CAAC3E,KAAK,EAAE6E,QAAQ,CAAC;eAC1Df,KAAK,CAACjC,KAAK,EAAE;;;UAGf,CAAC,EACF,IAAI5B,EAAE,CAAC6E,qBAAqB,CAAC;WAC5B7D,IAAI,EAAGhB,EAAE,CAACC,OAAO,CAAC,+BAA+B,CAAC;WAClD8D,SAAS,EAAG,0BAA0B;WACtCS,MAAM,EAAG;aACRC,KAAK,EAAE,iBAAU;eAChBZ,KAAK,CAACjC,KAAK,EAAE;;;UAGf,CAAC,CACF;SACD4C,MAAM,EAAE;WACPM,YAAY,EAAE,wBACd;aACC,IAAI,CAACC,OAAO,EAAE;;;QAGhB,CACD;OACDlB,KAAK,CAACmB,IAAI,EAAE;;;KACZ;KAAA,uCAEsB9D,KAAK,EAAEH,EAAE,EAChC;OAAA;OACC,IAAIK,MAAM,GAAGF,KAAK,CAACE,MAAM;OACzBpB,EAAE,CAACiF,IAAI,CAACC,WAAW,CAACF,IAAI,CACvBjE,EAAE,CAAC3B,mBAAmB,GAAG+F,IAAI,CAACC,MAAM,EAAE,EACtChE,MAAM,2BACNL,EAAE,CAACzB,cAAc,CAAC6D,GAAG,CAACpC,EAAE,CAACrC,mBAAmB,CAAC,yEAAI,EAAE,EACnD;SACCsF,QAAQ,EAAE,IAAI;SACdD,SAAS,EAAE,yCAAyC;SACpDI,OAAO,EAAE;WAACC,eAAe,EAAE;UAAc;SACzCiB,SAAS,EAAE,EAAE;SACbC,QAAQ,EAAE,EAAE;SACZd,MAAM,EACL;WACCM,YAAY,EAAE,wBACd;aACC,IAAI,CAACC,OAAO,EAAE;;;QAGjB,CACD;;;KACD;KAAA,qCAEoB3D,MAAM,EAAEsC,SAAS,EAAEtB,SAAS,EACjD;OACC,IAAIjB,IAAI,GAAG,IAAI,CAACnE,OAAO,CAACmG,GAAG,CAACO,SAAS,CAAC;OACtC,IAAI6B,UAAU;OAEd,IAAInE,MAAM,IAAKD,IAAI,KAAKiC,SAAU,EAAE;SACnChC,MAAM,CAACE,SAAS,GAAGH,IAAI,CAAC,OAAO,CAAC;SAChCoE,UAAU,GAAGpE,IAAI,CAAC,OAAO,CAAC;QAC1B,MACI,IAAIC,MAAM,IAAI,CAACkC,KAAK,CAACD,MAAM,CAACK,SAAS,CAAC,CAAC,EAC5C;SACC6B,UAAU,GAAGlC,MAAM,CAACK,SAAS,CAAC;SAC9B,IAAI8B,MAAM,CAACpE,MAAM,CAACd,EAAE,CAAC,CAACzB,UAAU,CAAC,IAAI,CAACE,cAAc,CAAC,IAAIwG,UAAU,KAAK,CAAC,EACzE;WACC;;SAEDnE,MAAM,CAACE,SAAS,GAAGiE,UAAU;QAC7B,MACI;SACJ;;OAGD,IAAInD,SAAS,EACb;SACC,IAAI,CAACb,kBAAkB,CAACH,MAAM,EAAEmE,UAAU,EAAEnD,SAAS,CAAC;;;;KAEvD;KAAA,mCAEkB1C,MAAM,EAAEK,KAAK,EAAEqB,MAAM,EACxC;OACC,IAAIqE,KAAK,GAAGjE,QAAQ,CAACC,cAAc,CAAC/B,MAAM,CAACY,EAAE,GAAG,QAAQ,CAAC;OACzD,IAAImF,KAAK,EACT;SACCA,KAAK,CAACC,IAAI,GAAGhG,MAAM,CAACY,EAAE;SACtBmF,KAAK,CAAC1F,KAAK,GAAGA,KAAK;SAEnB;;OAGD,IAAI2F,IAAI,GAAGhG,MAAM,CAACY,EAAE;OACpB,IAAIA,EAAE,GAAGoF,IAAI,GAAG,QAAQ;OAExBtE,MAAM,CAACsB,WAAW,CAAC1C,EAAE,CAACiC,GAAG,CAACC,MAAM,oJAA4B5B,EAAE,EAAWoF,IAAI,EAAY3F,KAAK,EAAK;;;KACnG;KAAA,kCAEiByD,IAAI,EAAEE,SAAS,EACjC;OACC,IAAI3C,EAAE,GAAG,IAAI;OAEb,IAAI4C,IAAI,GAAG1B,aAAG,CAACC,MAAM,gJAA6D;OAElF,IAAIyD,iBAAiB,GAAG1D,aAAG,CAACC,MAAM,4IAAuD;OACzF,IAAI0D,eAAe,GAAG3D,aAAG,CAACC,MAAM,kJAA6D;OAC7F0D,eAAe,CAACtE,SAAS,GAAGtB,EAAE,CAACC,OAAO,CAAC,sBAAsB,CAAC;OAE9D,IAAIyE,SAAS,GAAGzC,aAAG,CAACC,MAAM,6KAAoF;OAE9G,IAAI2D,gBAAgB,GAAG5D,aAAG,CAACC,MAAM,2KAAoF;OACrHlC,EAAE,CAACwC,IAAI,CAACqD,gBAAgB,EAAE,OAAO,EAAE,YAAY;SAAA;SAC9C,IAAIrF,KAAK,6BAAGO,EAAE,CAACzB,cAAc,CAAC6D,GAAG,CAAC2C,gBAAgB,CAAC/F,KAAK,CAAC,2EAAI,EAAE;SAC/D,IAAIgG,cAAc,GAAGhF,EAAE,CAACiF,0BAA0B,CAACF,gBAAgB,CAAC/F,KAAK,CAAC;SAE1E,IAAIkG,aAAa,GAAGlF,EAAE,CAACmF,gBAAgB,CAAC1F,KAAK,EAAEuF,cAAc,CAAC;SAC9DE,aAAa,CAAC,YAAY,CAAC,GAAG,IAAI;SAClCA,aAAa,CAAC,QAAQ,CAAC,GAAG;WACzB,qBAAqB,EAAE,4BAAC/E,KAAK,EAAK;aACjC,IAAIC,IAAI,GAAGD,KAAK,CAACiF,IAAI,CAAChF,IAAI;aAC1B0E,gBAAgB,CAACvE,SAAS,GAAGH,IAAI,CAACiF,UAAU,CAACjD,GAAG,CAAC,OAAO,CAAC;aACzDuB,SAAS,CAAC3E,KAAK,GAAGoB,IAAI,CAACb,EAAE;YACzB;WACD+F,MAAM,EAAE,gBAASnF,KAAK,EAAE;aACvBA,KAAK,CAACE,MAAM,CAAC2D,OAAO,EAAE;YACtB;WACD,0BAA0B,EAAE,iCAAC7D,KAAK,EAAK;aACtC,OAAO,IAAIoF,OAAO,CAAC,UAACC,OAAO,EAAK;eAC/B,IAAIC,KAAK,GAAGtF,KAAK,CAACuF,OAAO,EAAE,CAACC,WAAW,CAACF,KAAK;eAC7C,IAAIG,MAAM,GAAGzF,KAAK,CAAC0F,SAAS,EAAE;eAE9B7F,EAAE,CAAC8F,oBAAoB,CAACF,MAAM,EAAEZ,cAAc,EAAES,KAAK,EAAEzF,EAAE,EAAEwF,OAAO,CAAC;cACnE,CAAC;;UAEH;SAED,IAAII,MAAM,GAAG,IAAIG,wBAAM,CAACb,aAAa,CAAC;SAEtC,IAAIzF,KAAK,CAACnC,MAAM,IAAI,CAAC,EAAE;WACtBsI,MAAM,CAACI,SAAS,CAAChG,EAAE,CAACiG,SAAS,CAACjB,cAAc,EAAEY,MAAM,CAAC,CAAC;;SAGvDA,MAAM,CAAC3B,IAAI,EAAE;QACb,CAAC;OAEF,IAAIiC,iBAAiB,GAAGhF,aAAG,CAACC,MAAM,4IAAuD;OACzF,IAAI4D,gBAAgB,GAAG7D,aAAG,CAACC,MAAM,2JAAsE;OACvGlC,EAAE,CAACwC,IAAI,CAACsD,gBAAgB,EAAE,QAAQ,EAAE,YAAY;SAC/C/E,EAAE,CAACmG,oBAAoB,CAAC,IAAI,CAACnH,KAAK,EAAE8F,gBAAgB,EAAED,eAAe,EAAElB,SAAS,CAAC;QACjF,CAAC;OAEF,IAAI1H,OAAO,GAAG,IAAI,CAACmK,2BAA2B,CAAC3D,IAAI,CAAC;OACpD,KAAK,IAAI1D,OAAO,IAAI9C,OAAO,EAC3B;SACC,IAAIoK,UAAU,GAAGnF,aAAG,CAACC,MAAM,sHAAkBlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAACxH,OAAO,CAAC,CAAa;SAC3FsH,UAAU,CAAC9F,SAAS,GAAGtE,OAAO,CAAC8C,OAAO,CAAC;SAEvCgG,gBAAgB,CAACpD,WAAW,CAAC0E,UAAU,CAAC;;OAGzC,IAAIjG,IAAI,GAAG,IAAI,CAACnE,OAAO,CAACmG,GAAG,CAACO,SAAS,CAAC;OAEtCoC,gBAAgB,CAAC/F,KAAK,GAAGoB,IAAI,GAAGA,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,CAACxC,gBAAgB,GAAG,SAAS;OACnF,IAAImH,gBAAgB,CAACyB,aAAa,KAAK,CAAC,CAAC,EAAE;SAC1CzB,gBAAgB,CAACyB,aAAa,GAAG,CAAC;;OAEnC,IAAI,CAACL,oBAAoB,CAACpB,gBAAgB,CAAC/F,KAAK,EAAE8F,gBAAgB,EAAED,eAAe,EAAElB,SAAS,CAAC;OAC/F,IAAIvD,IAAI,IAAIA,IAAI,CAAC,SAAS,CAAC,KAAK,IAAI,CAACxC,gBAAgB,EACrD;SACCkH,gBAAgB,CAACvE,SAAS,GAAGH,IAAI,CAAC,OAAO,CAAC;SAC1CuD,SAAS,CAAC3E,KAAK,GAAG2D,SAAS;QAC3B,MAED;SACCmC,gBAAgB,CAACvE,SAAS,GAAGtB,EAAE,CAACC,OAAO,CAAC,aAAa,CAAC;SACtDyE,SAAS,CAAC3E,KAAK,GAAG2D,SAAS;;OAG5BuD,iBAAiB,CAACvE,WAAW,CAACT,aAAG,CAACC,MAAM,uLAEpClC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAACtH,EAAE,CAACC,OAAO,CAAC,yBAAyB,CAAC,CAAC,EAEjE;OACFgH,iBAAiB,CAACvE,WAAW,CAACoD,gBAAgB,CAAC;OAE/CH,iBAAiB,CAACjD,WAAW,CAACkD,eAAe,CAAC;OAC9CD,iBAAiB,CAACjD,WAAW,CAACmD,gBAAgB,CAAC;OAC/CF,iBAAiB,CAAC6B,MAAM,CAAC9C,SAAS,CAAC;OAEnCf,IAAI,CAACjB,WAAW,CAACuE,iBAAiB,CAAC;OACnCtD,IAAI,CAACjB,WAAW,CAACiD,iBAAiB,CAAC;OAEnC,OAAOhC,IAAI;;;KACX;KAAA,2CAE0B/E,UAAU,EACrC;OACC,IAAI6I,iBAAiB,GAAG,EAAE;OAC1B,IAAIC,iBAAiB,GAAG,EAAE;OAC1B,IAAIC,mBAAmB,GAAG,EAAE;OAC5B,IAAIC,IAAI,GAAG,EAAE;OACb,IAAIC,UAAU,GAAG,EAAE;OAEnB,IAAI,IAAI,CAACC,WAAW,CAAClJ,UAAU,CAAC,EAChC;SACC6I,iBAAiB,GAAG;WACnB5H,KAAK,EAAEG,EAAE,CAACC,OAAO,CAAC,0BAA0B,CAAC;WAC7C8H,QAAQ,EAAE/H,EAAE,CAACC,OAAO,CAAC,iCAAiC,CAAC;WACvD+H,KAAK,EAAE;UACP;SAEDN,iBAAiB,GAAG;WACnB7H,KAAK,EAAEG,EAAE,CAACC,OAAO,CAAC,2BAA2B,CAAC;WAC9C8H,QAAQ,EAAE/H,EAAE,CAACC,OAAO,CAAC,iCAAiC,CAAC;WACvD+H,KAAK,EAAE;UACP;SAEDL,mBAAmB,GAAG;WACrBM,KAAK,EAAEjI,EAAE,CAACC,OAAO,CAAC,wBAAwB;UAC1C;SAED2H,IAAI,GAAGM,uBAAO,CAACC,OAAO,CAACC,QAAQ,CAACR,IAAI,CAACS,QAAQ;SAC7CR,UAAU,GAAG,IAAI,CAACtJ,cAAc;QAChC,MACI,IAAI,IAAI,CAAC+J,WAAW,CAAC1J,UAAU,CAAC,EACrC;SACC6I,iBAAiB,GAAG;WACnB5H,KAAK,EAAEG,EAAE,CAACC,OAAO,CAAC,0BAA0B,CAAC;WAC7C8H,QAAQ,EAAE/H,EAAE,CAACC,OAAO,CAAC,iCAAiC,CAAC;WACvD+H,KAAK,EAAE;UACP;SAEDN,iBAAiB,GAAG;WACnB7H,KAAK,EAAEG,EAAE,CAACC,OAAO,CAAC,2BAA2B,CAAC;WAC9C8H,QAAQ,EAAE/H,EAAE,CAACC,OAAO,CAAC,iCAAiC,CAAC;WACvD+H,KAAK,EAAE;UACP;SAEDL,mBAAmB,GAAG;WACrBM,KAAK,EAAEjI,EAAE,CAACC,OAAO,CAAC,wBAAwB;UAC1C;SAED2H,IAAI,GAAGM,uBAAO,CAACC,OAAO,CAACC,QAAQ,CAACR,IAAI,CAACW,QAAQ;SAC7CV,UAAU,GAAG,IAAI,CAACrJ,gBAAgB;QAClC,MACI,IAAI,IAAI,CAACgK,UAAU,CAAC5J,UAAU,CAAC,EACpC;SACCiJ,UAAU,GAAG,IAAI,CAACpJ,kBAAkB;;OAGrC,OAAO;SACNgJ,iBAAiB,EAAjBA,iBAAiB;SACjBC,iBAAiB,EAAjBA,iBAAiB;SACjBC,mBAAmB,EAAnBA,mBAAmB;SACnBC,IAAI,EAAJA,IAAI;SACJC,UAAU,EAAVA,UAAU;SACVjJ,UAAU,EAAVA;QACA;;;KACD;KAAA,iCAEgB4B,KAAK,EAAEuF,cAAc,EACtC;OACC,IAAI/I,OAAO,GAAG;SACbyL,KAAK,EAAE,GAAG;SACVC,MAAM,EAAE,GAAG;SACXC,QAAQ,EAAE,KAAK;SACfC,YAAY,EAAE,IAAI;SAClBC,YAAY,EAAE,IAAI;SAClBC,WAAW,EAAE,KAAK;SAClBC,WAAW,EAAE,IAAI;SACjBvI,KAAK,EAAEA,KAAK;SACZwI,kBAAkB,EAAE;WACnBC,YAAY,EAAE;;QAEf;OAED,IAAIC,YAAY,GAAG;SAClBC,gBAAgB,EAAE;WACjBC,IAAI,EAAE,IAAI;WACVC,IAAI,EAAE,EAAE;WACRC,WAAW,EAAEvD,cAAc,CAAC0B;UAC5B;SACD8B,gBAAgB,EAAE;WACjBH,IAAI,EAAE,IAAI;WACVE,WAAW,EAAEvD,cAAc,CAAC2B;UAC5B;SACD8B,aAAa,EAAE;WACdC,eAAe,EAAE,IAAI;WACrBC,aAAa,EAAE3D,cAAc,CAAC4B;;QAE/B;OAED,IACC5B,cAAc,CAAC8B,UAAU,KAAK,IAAI,CAACtJ,cAAc,IAC9CwH,cAAc,CAAC8B,UAAU,KAAK,IAAI,CAACrJ,gBAAgB,EAEvD;SACC,OAAOL,MAAM,CAACwL,MAAM,CAAC3M,OAAO,EAAEkM,YAAY,CAAC;;OAG5C,OAAOlM,OAAO;;;KACd;KAAA,0BAES+I,cAAc,EAAEY,MAAM,EAChC;OACC,IAAI5F,EAAE,GAAG,IAAI;OACb,IAAI6I,MAAM,GAAG3H,aAAG,CAACC,MAAM,4NAEnBlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAACvB,cAAc,CAAC4B,mBAAmB,CAACM,KAAK,CAAC,CAErE;OAEDjI,EAAE,CAACwC,IAAI,CAACoH,MAAM,EAAE,OAAO,EAAE,YAAM;SAC9B7I,EAAE,CAAC8F,oBAAoB,CAACF,MAAM,EAAEZ,cAAc,EAAE,EAAE,EAAEhF,EAAE,CAAC;QACvD,CAAC;OAEF,OAAO6I,MAAM;;;KACb;KAAA,qCAEoBjD,MAAM,EAAEZ,cAAc,EAAES,KAAK,EAAGzF,EAAE,EAAEwF,OAAO,EAChE;OACC,IAAI3H,UAAU,GAAGmH,cAAc,CAACnH,UAAU;OAC1C,IAAIiL,iBAAiB,GAAG;SACvBjL,UAAU,EAAEA,UAAU,CAACkL,KAAK,CAAClL,UAAU,CAACmL,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;SACzD/L,cAAc,EAAE+C,EAAE,CAAC/C;QACnB;OACDkK,uBAAO,CAACC,OAAO,CAACC,QAAQ,CAAC4B,aAAa,CAACjE,cAAc,CAAC6B,IAAI,EAAE7G,EAAE,CAAC3D,kBAAkB,EAAEoJ,KAAK,EAAEqD,iBAAiB,CAAC,CAC1GI,IAAI,CAAC,UAACC,MAAM,EACb;SACC,IAAIC,OAAO,GAAG;WACb,YAAY,EAAEpE,cAAc,CAAC8B,UAAU;WACvC,YAAY,EAAE9B,cAAc,CAACnH;UAC7B;SACDmC,EAAE,CAACqJ,oBAAoB,CAACzD,MAAM,EAAEuD,MAAM,EAAEC,OAAO,CAAC;SAChD,IAAI5D,OAAO,EACX;WACCA,OAAO,EAAE;;QAEV,CAAC;;;KACH;KAAA,qCAEoBI,MAAM,EAAEuD,MAAM,EAAEC,OAAO,EAC5C;OAAA;OACC,IAAIE,IAAI,GAAGH,MAAM,CAACzD,OAAO,EAAE,CAAC6D,OAAO,EAAE;OACrC,IAAIlM,IAAI,GAAGD,MAAM,CAACC,IAAI,CAACiM,IAAI,CAAC;OAC5B,IAAIjM,IAAI,CAACC,MAAM,IAAI,CAAC,EACpB;SACC;;OAGD,IAAIiC,EAAE,GAAGlC,IAAI,CAAC,CAAC,CAAC;OAChB,IAAImC,QAAQ,GAAG8J,IAAI,CAACjM,IAAI,CAAC,CAAC,CAAC,CAAC;OAE5B,IAAI,CAAC,IAAI,CAACJ,cAAc,CAACuM,QAAQ,CAAChK,QAAQ,CAAC,MAAM,CAAC,CAAC,EACnD;SACC;;OAGD,IAAIY,IAAI,GAAG;SACVqJ,QAAQ,EAAE,IAAI;SACdC,IAAI,EAAE,SAAS;SACf5K,KAAK,EAAEU,QAAQ,CAAC,MAAM,CAAC;SACvBD,EAAE,EAAE,IAAI,GAAG6J,OAAO,CAACtC,UAAU,GAAG,GAAG,GAAGvH,EAAE,GAAG,GAAG;SAC9C8F,UAAU,EAAE;WACXtG,OAAO,EAAEqK,OAAO,CAACtC,UAAU,GAAG,GAAG,GAAGtH,QAAQ,CAAC,YAAY,CAAC;WAC1DA,QAAQ,EAAEA,QAAQ;WAClBV,KAAK,EAAEU,QAAQ,CAAC,MAAM;;QAEvB;OAED,IAAIY,IAAI,CAACiF,UAAU,CAACtG,OAAO,KAAKqK,OAAO,CAACvL,UAAU,EAClD;SACC+H,MAAM,CAACI,SAAS,CAAC,IAAI,CAAC;SACtBJ,MAAM,CAAC+D,OAAO,CAACvJ,IAAI,CAAC;;OAGrB,IAAI,CAACnE,OAAO,CAAC4C,GAAG,CAACuB,IAAI,CAACb,EAAE,EAAE,IAAI,CAACD,yBAAyB,CAACc,IAAI,CAACb,EAAE,EAAEa,IAAI,CAAC,CAAC;OAExE,IAAIwJ,UAAU,4BAAG,IAAI,CAACrL,cAAc,CAAC6D,GAAG,CAAChC,IAAI,CAACiF,UAAU,CAACtG,OAAO,CAAC,yEAAI,EAAE;OACvE6K,UAAU,CAACjK,IAAI,CAACS,IAAI,CAAC;OACrB,IAAI,CAAC7B,cAAc,CAACM,GAAG,CAACuB,IAAI,CAACiF,UAAU,CAACtG,OAAO,EAAE6K,UAAU,CAAC;;;KAC5D;KAAA,qCAEoB5K,KAAK,EAAEqB,MAAM,EAAE6G,KAAK,EAAExC,KAAK,EAChD;OACC,IAAI1F,KAAK,KAAK,IAAI,CAACpB,gBAAgB,GAAG,SAAS,EAC/C;SACCyC,MAAM,CAACwJ,KAAK,CAACC,OAAO,GAAG,EAAE;SACzB5C,KAAK,CAAC3G,SAAS,GAAGtB,EAAE,CAACC,OAAO,CAAC,sBAAsB,CAAC;SACpDmB,MAAM,CAACE,SAAS,GAAGtB,EAAE,CAACC,OAAO,CAAC,aAAa,CAAC;SAC5CwF,KAAK,CAACjC,IAAI,GAAG,QAAQ;SACrBiC,KAAK,CAAC1F,KAAK,GAAG,EAAE;SAEhB;;OAGDkI,KAAK,CAAC3G,SAAS,GAAGtB,EAAE,CAACC,OAAO,CAAC,oBAAoB,CAAC;OAClDmB,MAAM,CAACwJ,KAAK,CAACC,OAAO,GAAG,MAAM;OAC7BpF,KAAK,CAACjC,IAAI,GAAG,MAAM;OACnBiC,KAAK,CAAC1F,KAAK,GAAG,GAAG;;;KACjB;KAAA,4CAE2ByD,IAAI,EAChC;OACC,IAAIsH,IAAI,GAAG,EAAE;OACb,IAAIC,cAAc,GAAG,EAAE;OACvBA,cAAc,CAAC,IAAI,CAACpM,gBAAgB,CAAC,GAAG;SACvC,QAAQ,EAAEqB,EAAE,CAACC,OAAO,CAAC,cAAc;QACnC;OACD,IAAIP,MAAM,GAAGvB,MAAM,CAACwL,MAAM,CAAC,EAAE,EAAE,IAAI,CAACjM,kBAAkB,EAAEqN,cAAc,CAAC;OAEvE,KAAK,IAAInK,YAAY,IAAIlB,MAAM,EAAE;SAChC,IAAI8D,IAAI,KAAK,UAAU,IAAI5C,YAAY,KAAK,IAAI,CAACrC,cAAc,EAAE;WAChE;;SAED,KAAK,IAAIuC,YAAY,IAAIpB,MAAM,CAACkB,YAAY,CAAC,EAAE;WAC9CkK,IAAI,CAAClK,YAAY,GAAG,GAAG,GAAGE,YAAY,CAAC,GAAGpB,MAAM,CAACkB,YAAY,CAAC,CAACE,YAAY,CAAC;;;OAI9E,OAAOgK,IAAI;;;KACX;KAAA,qCAEoBxM,UAAU,EAAEuD,aAAa,EAC9C;OACC,IAAIlE,WAAW,GAAG,IAAI,CAACA,WAAW;OAClC,IAAI,CAACM,QAAQ,EAAE;OAEf,IAAI+D,MAAM;OACV,IAAIgJ,IAAI,EAAEC,MAAM;OAEhB,IAAI,CAACpJ,aAAa,EAAE;SACnBA,aAAa,GAAG,CAACqJ,GAAG,EAAE,IAAI,EAAEA,GAAG,CAAC;;OAGjClJ,MAAM,GAAGrE,WAAW,CAACwN,SAAS,CAAC,CAAC,CAAC,CAAC;;;;OAIlCH,IAAI,GAAGhJ,MAAM,CAACoJ,UAAU,CAAC,CAAC,CAAC,CAAC;OAC5BJ,IAAI,CAACJ,KAAK,CAACtF,QAAQ,GAAG,MAAM;OAE5B2F,MAAM,GAAGjL,EAAE,CAACiC,GAAG,CAACC,MAAM,4IAAiB,IAAI,CAACnD,cAAc,GAAG,IAAI,CAACd,QAAQ,CAAkC;OAC5G,IAAI,CAACoN,2BAA2B,CAACJ,MAAM,EAAE,UAAU,CAAC;OAEpDA,MAAM,CAAClL,KAAK,GAAGzB,UAAU;OACzB,IAAI2M,MAAM,CAAC1D,aAAa,KAAK,CAAC,CAAC,EAAE;SAChC0D,MAAM,CAAC1D,aAAa,GAAG,CAAC;;OAEzByD,IAAI,CAACtI,WAAW,CAACuI,MAAM,CAAC;;;;OAIxBD,IAAI,GAAGhJ,MAAM,CAACoJ,UAAU,CAAC,CAAC,CAAC,CAAC;OAC5BJ,IAAI,CAAC1J,SAAS,GAAG,GAAG;OAEpB,IAAI,CAACgK,6BAA6B,CAACtJ,MAAM,EAAE,IAAI,CAAChD,gBAAgB,GAAG,IAAI,CAACf,QAAQ,EAAE4D,aAAa,CAAC,CAAC,CAAC,CAAC;;;;OAInGmJ,IAAI,GAAGhJ,MAAM,CAACoJ,UAAU,CAAC,CAAC,CAAC,CAAC;OAC5BJ,IAAI,CAACJ,KAAK,CAACtF,QAAQ,GAAG,MAAM;OAC5B2F,MAAM,GAAGjL,EAAE,CAACiC,GAAG,CAACC,MAAM,2IAAiB,IAAI,CAACjD,eAAe,GAAG,IAAI,CAAChB,QAAQ,CAAiC;OAC5G,KAAK,IAAI0B,CAAC,IAAI,IAAI,CAACnC,UAAU,EAAE;SAC9ByN,MAAM,CAACvI,WAAW,CAAC1C,EAAE,CAACiC,GAAG,CAACC,MAAM,kKACdlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAAC,IAAI,CAAC9J,UAAU,CAACmC,CAAC,CAAC,CAAC,EAC1DK,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAAC,IAAI,CAAC9J,UAAU,CAACmC,CAAC,CAAC,CAAC,EAE9C;;OAEHsL,MAAM,CAAClL,KAAK,GAAG8B,aAAa,CAAC,CAAC,CAAC;OAC/B,IAAIoJ,MAAM,CAAC1D,aAAa,KAAK,CAAC,CAAC,EAAE;SAChC0D,MAAM,CAAC1D,aAAa,GAAG,CAAC;;OAEzByD,IAAI,CAACtI,WAAW,CAACuI,MAAM,CAAC;;;;OAIxB,IAAI,CAACK,6BAA6B,CAACtJ,MAAM,EAAE,IAAI,CAAC9C,gBAAgB,GAAG,IAAI,CAACjB,QAAQ,EAAE4D,aAAa,CAAC,CAAC,CAAC,CAAC;;;KACnG;KAAA,4CAE2BoJ,MAAM,EAAEzH,IAAI,EACxC;OACC,KAAK,IAAIqE,UAAU,IAAI,IAAI,CAACnK,kBAAkB,EAC9C;SACC,IAAI8F,IAAI,KAAK,UAAU,IAAIqE,UAAU,KAAK,IAAI,CAACtJ,cAAc,EAAE;WAC9D;;SAED,IAAIgN,wBAAwB,GAAG,IAAI,CAAC7N,kBAAkB,CAACmK,UAAU,CAAC;SAClE,KAAK,IAAIjJ,UAAU,IAAI2M,wBAAwB,EAC/C;WACC,IAAIC,aAAa,GAAGD,wBAAwB,CAAC3M,UAAU,CAAC;WACxD,IAAI6M,QAAQ,GAAGzL,EAAE,CAACiC,GAAG,CAACC,MAAM,0HAAoBlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAACkE,aAAa,CAAC,CAAe;WAEtG,IAAIE,YAAY,GAAG,IAAI,CAACpM,cAAc,CAAC6D,GAAG,CAAC0E,UAAU,GAAG,GAAG,GAAGjJ,UAAU,CAAC;WACzE,IAAI,CAAC8M,YAAY,EAAC;aACjB;;WAGD,IAAItE,UAAU;aAAE9G,EAAE;aAAET,KAAK;WACzB,KAAK,IAAIF,CAAC,IAAI+L,YAAY,EAC1B;aACC,IAAIC,WAAW,GAAGD,YAAY,CAAC/L,CAAC,CAAC;aACjC,IAAIgM,WAAW,CAAC,UAAU,CAAC,EAC3B;eACC,KAAK,IAAIC,CAAC,IAAID,WAAW,CAAC,UAAU,CAAC,EACrC;iBACCrL,EAAE,GAAGqL,WAAW,CAAC,UAAU,CAAC,CAACC,CAAC,CAAC,CAACtL,EAAE;iBAClCT,KAAK,GAAG8L,WAAW,CAAC,UAAU,CAAC,CAACC,CAAC,CAAC,CAACxF,UAAU,CAACvG,KAAK;iBACnDuH,UAAU,GAAGpH,EAAE,CAACiC,GAAG,CAACC,MAAM,kMACRlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAAChH,EAAE,CAAC,EAC1CN,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAACzH,KAAK,CAAC,CAElC;iBACD4L,QAAQ,CAAC/I,WAAW,CAAC0E,UAAU,CAAC;;cAEjC,MAED;eACC9G,EAAE,GAAGqL,WAAW,CAAC,IAAI,CAAC;eACtB9L,KAAK,GAAG8L,WAAW,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC;eAC1CvE,UAAU,GAAGpH,EAAE,CAACiC,GAAG,CAACC,MAAM,0LACRlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAAChH,EAAE,CAAC,EAC1CN,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAACzH,KAAK,CAAC,CAElC;eACD4L,QAAQ,CAAC/I,WAAW,CAAC0E,UAAU,CAAC;;;WAIlC6D,MAAM,CAACvI,WAAW,CAAC+I,QAAQ,CAAC;;;;;KAG9B;KAAA,oCAEmBrK,MAAM,EAAErB,KAAK,EACjC;OACC,IAAIqB,MAAM,CAACpE,OAAO,CAACoE,MAAM,CAACmG,aAAa,CAAC,CAACxH,KAAK,KAAK,EAAE,EACrD;SACCqB,MAAM,CAACyK,KAAK,CAAC7L,EAAE,CAACiC,GAAG,CAACC,MAAM,wPAGhBd,MAAM,CAACsE,IAAI,EAEVoG,QAAQ,CAAC/L,KAAK,CAAC,GAAGA,KAAK,GAAG,CAAC,EAEpC;QACF,MAED;SACC,IAAI0F,KAAK,GAAGjE,QAAQ,CAACuK,iBAAiB,CAAC3K,MAAM,CAACsE,IAAI,CAAC,CAAC,CAAC,CAAC;SACtD,IAAID,KAAK,EAAE;WACVA,KAAK,CAACuG,MAAM,EAAE;;;;;KAGhB;KAAA,8CAE6BhK,MAAM,EAAE1B,EAAE,EAAEP,KAAK,EAC/C;OACC,IAAIgB,EAAE,GAAG,IAAI;OACb,IAAIiK,IAAI,GAAGhJ,MAAM,CAACoJ,UAAU,CAAC,CAAC,CAAC,CAAC;OAChC,IAAIH,MAAM,GAAGjL,EAAE,CAACiC,GAAG,CAACC,MAAM,2IAAiBlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAAChH,EAAE,CAAC,CAAiC;OACxGN,EAAE,CAACwC,IAAI,CAACyI,MAAM,EAAE,QAAQ,EAAE,YAAW;SACpClK,EAAE,CAACkL,mBAAmB,CAAC,IAAI,EAAElM,KAAK,CAAC;QACnC,CAAC;OAEFkL,MAAM,CAACvI,WAAW,CAAC1C,EAAE,CAACiC,GAAG,CAACC,MAAM,sHAAoBlC,EAAE,CAACqH,IAAI,CAACC,gBAAgB,CAACtH,EAAE,CAACC,OAAO,CAAC,cAAc,CAAC,CAAC,EAAY;OACpH,IAAI,CAACoL,2BAA2B,CAACJ,MAAM,CAAC;OAExCA,MAAM,CAAClL,KAAK,GAAGA,KAAK;OACpB,IAAIkL,MAAM,CAAC1D,aAAa,KAAK,CAAC,CAAC,EAAE;SAChC0D,MAAM,CAAC1D,aAAa,GAAG,CAAC;;OAEzByD,IAAI,CAACtI,WAAW,CAACuI,MAAM,CAAC;OACxB,IAAI,CAACgB,mBAAmB,CAAChB,MAAM,EAAElL,KAAK,CAAC;;;GACvC;CAAA;CAGFlD,SAAS,CAACE,qBAAqB,GAAGA,qBAAqB;;;;"}