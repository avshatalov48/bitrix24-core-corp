(function(e,t,a){"use strict";var i,r,n,o;function l(e,t){s(e,t);t.add(e)}function s(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function c(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var d=t.Reflection.namespace("BX.Bizproc.Activity");var h=new WeakSet;var m=new WeakSet;var p=new WeakSet;var u=new WeakSet;var v=new WeakSet;var f=new WeakSet;var b=new WeakSet;var g=new WeakSet;var D=new WeakSet;var y=new WeakSet;var j=function(){function e(a){babelHelpers.classCallCheck(this,e);l(this,y);l(this,D);l(this,g);l(this,b);l(this,f);l(this,v);l(this,u);l(this,p);l(this,m);l(this,h);babelHelpers.defineProperty(this,"index",0);if(t.Type.isPlainObject(a)){this.operatorList=a.operatorList;this.conditions=a.conditions;this.table=a.table;this.objectTabs=a.objectTabs;this.template=a.template;this.formName=a.formName}}babelHelpers.createClass(e,[{key:"init",value:function e(){this.addConditionNode=c(this,h,w).call(this);t.Dom.append(this.addConditionNode,this.table);for(var a in this.conditions){this.addCondition(this.conditions[a])}}},{key:"addCondition",value:function e(){var a,i;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{object:null,field:null,value:null,joiner:"0",operator:"!empty"};var n=this;if(r.object==="Template"){r.object="Parameter"}var o=t.Dom.create("tbody",{attrs:{"data-index":String(this.index),"data-object":(a=BX.util.htmlspecialchars(r.object))!==null&&a!==void 0?a:"","data-field":(i=BX.util.htmlspecialchars(r.field))!==null&&i!==void 0?i:""}});var l=c(this,m,S).call(this,r.joiner);if(this.index>0){t.Dom.append(l,o)}var s=c(this,p,T).call(this,r.object,r.field);t.Dom.append(s,o);if(this.selector){this.selector.subscribe("onSelect",(function(e){o.setAttribute("data-object",e.data.item.object);o.setAttribute("data-field",e.data.item.field);c(n,D,P).call(n,o)}))}var d=c(this,v,B).call(this,r.operator);t.Dom.append(d,o);var h=c(this,f,N).call(this,r.operator);t.Dom.append(h,o);c(this,D,P).call(this,o,r.operator,r.value);t.Dom.insertBefore(o,this.addConditionNode);this.index++}},{key:"getProperty",value:function e(t,a){if(t&&this.objectTabs[t]){return this.objectTabs[t][a]}var i=BX.Bizproc.Selector.getActivitiesItems();for(var r=0;r<i.length;++r){if(i[r].propertyObject===t&&i[r].propertyField===a){return i[r].property}}return null}}]);return e}();function w(){var e=this;return t.Dom.create("tbody",{children:[t.Dom.create("tr",{children:[t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-l"}}),t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-r"},children:[t.Dom.create("a",{attrs:{href:"#"},text:t.Loc.getMessage("BPMC_PD_ADD"),events:{click:function t(a){e.addCondition();a.preventDefault()}}})]})]})]})}function S(e){var a=t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-l",align:"right",width:"40%"}});var n=t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<select name="mixed_condition[','][joiner]">\n\t\t\t\t<option value="0">','</option>\n\t\t\t\t<option value="1">',"</option>\n\t\t\t</select>\n\t\t"])),this.index,t.Loc.getMessage("BPMC_PD_AND"),t.Loc.getMessage("BPMC_PD_OR"));if(String(e)==="1"){n.value="1"}t.Dom.append(n,a);var o=t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-r",align:"right",width:"60%"}});var l=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<a href="#">',"</a>"])),t.Loc.getMessage("BPMC_PD_DELETE"));t.Event.bind(l,"click",c(this,b,C).bind(this));t.Dom.append(l,o);return t.Dom.create("tr",{children:[a,o]})}function T(e,i){var r=t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-l",align:"right",width:"40%"},text:t.Loc.getMessage("BPMC_PD_FIELD")+":"});var n=t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-r",width:"60%"}});this.selector=new a.BpMixedSelector({targetNode:n,template:this.template,objectTabs:this.objectTabs,inputNames:{object:"mixed_condition["+String(this.index)+"][object]",field:"mixed_condition["+String(this.index)+"][field]"}});this.selector.renderMixedSelector();if(e&&i&&this.objectTabs[e]&&this.objectTabs[e][i]){this.selector.setSelectedObjectAndField(e,i,this.objectTabs[e][i]["Name"])}else{var o=c(this,u,x).call(this,e,i);if(o){this.selector.setSelectedObjectAndField(e,i,o)}}return t.Dom.create("tr",{children:[r,n]})}function x(e,t){var a=this.selector.getMenuItemsByTabName("Activity");for(var i in a){var r=a[i];if(r.object===e){var n=r.items;for(var o in n){var l=n[o];if(l.field===t){return l.text}}}}return null}function B(e){var a=t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-l",align:"right",width:"40%"},text:t.Loc.getMessage("BPMC_PD_CONDITION")+":"});var i=t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<select name="mixed_condition[','][operator]" data-role="operator-selector"></select>\n\t\t'])),this.index);t.Event.bind(i,"change",c(this,g,_).bind(this));for(var r in this.operatorList){var l=t.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<option value="','">',"</option>\n\t\t\t"])),r,BX.util.htmlspecialchars(this.operatorList[r]));t.Dom.append(l,i)}i.value=e;if(i.selectedIndex===-1){i.value="!empty"}return t.Dom.create("tr",{children:[a,t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-r",width:"60%"},children:[i]})]})}function N(e){var a=t.Dom.create("tr",{attrs:{"data-role":"value-row"},children:[t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-l",align:"right",width:"40%"},text:t.Loc.getMessage("BPMC_PD_VALUE")+":"}),t.Dom.create("td",{attrs:{className:"adm-detail-content-cell-r","data-role":"value-cell",width:"60%"},text:"..."})]});if(["empty","!empty"].includes(e)){t.Dom.style(a,"display","none")}return a}function C(e){var a=e.target.closest("tbody");if(a){t.Dom.remove(a)}e.preventDefault()}function _(e){var t=e.target;c(this,D,P).call(this,t.closest("tbody"),t.value)}function P(e,a){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;a=a||e.querySelector('[data-role="operator-selector"]').value;var r=e.querySelector('[data-role="value-row"]');if(["empty","!empty"].includes(a)){t.Dom.style(r,"display","none")}else{t.Dom.style(r,"display","");c(this,y,L).call(this,e,i)}}function L(e,a){var i=e.querySelector('[data-role="value-cell"]');var r=e.getAttribute("data-index");var n=this.getProperty(e.getAttribute("data-object"),e.getAttribute("data-field"));if(!n){return}objFieldsPVC.GetFieldInputControl(n,a!==null&&a!==void 0?a:"",{Field:"mixed_condition_value_"+r,Form:this.formName},(function(e){if(e){i.innerHTML=e}if(!t.Type.isUndefined(BX.Bizproc.Selector)){BX.Bizproc.Selector.initSelectors(i)}}),true)}d.MixedCondition=j})(this.window=this.window||{},BX,BX.Bizproc);
//# sourceMappingURL=script.map.js