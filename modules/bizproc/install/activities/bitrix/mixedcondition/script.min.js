(function(t,e,i,n){"use strict";var a,r,o,l,d,s,c;function b(t,e){p(t,e);e.add(t)}function h(t,e,i){p(t,e);e.set(t,i)}function p(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function u(t,e,i){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return i}var v=e.Reflection.namespace("BX.Bizproc.Activity");var g=new WeakMap;var f=new WeakSet;var T=new WeakSet;var m=new WeakSet;var j=new WeakSet;var x=new WeakSet;var y=function(){function t(i){babelHelpers.classCallCheck(this,t);b(this,x);b(this,j);b(this,m);b(this,T);b(this,f);h(this,g,{writable:true,value:void 0});babelHelpers.defineProperty(this,"index",0);if(e.Type.isPlainObject(i)){this.conditions=i.conditions;this.table=i.table;this.objectTabs=i.objectTabs;this.template=i.template;babelHelpers.classPrivateFieldSet(this,g,i.documentType)}}babelHelpers.createClass(t,[{key:"init",value:function t(){this.addConditionNode=u(this,f,w).call(this);e.Dom.append(this.addConditionNode,this.table);for(var i in this.conditions){this.addCondition(this.conditions[i])}}},{key:"addCondition",value:function t(){var i,r,o;var l=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{object:null,field:null,value:null,joiner:"0",operator:n.Operator.NOT_EMPTY};l.object=l.object==="Template"?"Parameter":l.object;var d=new n.BpCondition({operator:l.operator,value:l.value,selectName:"mixed_condition["+e.Text.toInteger(this.index)+"][operator]",inputName:"mixed_condition_value_"+e.Text.toInteger(this.index),useOperatorModified:false,documentType:babelHelpers.classPrivateFieldGet(this,g)});var s=(i=this.getProperty(l.object,l.field))!==null&&i!==void 0?i:{Type:"string"};var c=this.index>0?u(this,T,P).call(this,l.joiner):"";var b=e.Tag.render(a||(a=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tbody \n\t\t\t\tdata-index="','"\n\t\t\t\tdata-object="','"\n\t\t\t\tdata-field="','"\n\t\t\t>\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</tbody>\n\t\t"])),e.Text.toInteger(this.index),e.Text.encode((r=l.object)!==null&&r!==void 0?r:""),e.Text.encode((o=l.field)!==null&&o!==void 0?o:""),c,u(this,m,B).call(this,l.object,l.field),d.renderOperator(s.Type),d.renderValue(s));if(this.selector){this.selector.subscribe("onSelect",function(t){var e;var i=t.data.item.object;var n=t.data.item.field;var a=(e=this.getProperty(i,n))!==null&&e!==void 0?e:{Type:"string"};b.setAttribute("data-object",i);b.setAttribute("data-field",n);d.rerenderOperator(a.Type);d.rerenderValue(a)}.bind(this))}e.Dom.insertBefore(b,this.addConditionNode);this.index++}},{key:"getProperty",value:function t(e,i){if(e&&this.objectTabs[e]){return this.objectTabs[e][i]}var n=BX.Bizproc.Selector.getActivitiesItems();for(var a=0;a<n.length;++a){if(n[a].propertyObject===e&&n[a].propertyField===i){return n[a].property}}return null}}]);return t}();function w(){var t=this;var i=e.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<a href="#">',"</a>"])),e.Loc.getMessage("BPMC_PD_ADD"));e.Event.bind(i,"click",(function(e){e.preventDefault();t.addCondition()}));return e.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class="adm-detail-content-cell-l"></td>\n\t\t\t\t\t<td class="adm-detail-content-cell-r">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t"])),i)}function P(t){var i=e.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['<a href="#">',"</a>"])),e.Loc.getMessage("BPMC_PD_DELETE"));e.Event.bind(i,"click",u(this,x,C).bind(this));return e.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tr>\n\t\t\t\t<td align="right" width="40%" class="adm-detail-content-cell-l">\n\t\t\t\t\t<select name="mixed_condition[','][joiner]">\n\t\t\t\t\t\t<option value="0">','</option>\n\t\t\t\t\t\t<option value="1"',">\n\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t</option>\n\t\t\t\t\t</select>\n\t\t\t\t</td>\n\t\t\t\t<td align="right" width="60%" class="adm-detail-content-cell-r">\n\t\t\t\t\t',"\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t"])),e.Text.toInteger(this.index),e.Loc.getMessage("BPMC_PD_AND"),e.Text.toInteger(t)===1?" selected":"",e.Loc.getMessage("BPMC_PD_OR"),i)}function B(t,n){var a=e.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<td width="60%" class="adm-detail-content-cell-r"></td>'])));this.selector=new i.BpMixedSelector({targetNode:a,template:this.template,objectTabs:this.objectTabs,inputNames:{object:"mixed_condition["+String(e.Text.toInteger(this.index))+"][object]",field:"mixed_condition["+String(e.Text.toInteger(this.index))+"][field]"}});this.selector.renderMixedSelector();if(t&&n&&this.objectTabs[t]&&this.objectTabs[t][n]){this.selector.setSelectedObjectAndField(t,n,this.objectTabs[t][n]["Name"])}else{var r=u(this,j,_).call(this,t,n);if(r){this.selector.setSelectedObjectAndField(t,n,r)}}return e.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tr>\n\t\t\t\t<td align="right" width="40%" class="adm-detail-content-cell-l">\n\t\t\t\t\t',"\n\t\t\t\t</td>\n\t\t\t\t","\n\t\t\t</tr>\n\t\t"])),e.Loc.getMessage("BPMC_PD_FIELD")+":",a)}function _(t,e){var i=this.selector.getMenuItemsByTabName("Activity");for(var n in i){var a=i[n];if(a.object===t){var r=a.items;for(var o in r){var l=r[o];if(l.field===e){return l.text}}}}return null}function C(t){var i=t.target.closest("tbody");if(i){e.Dom.remove(i)}t.preventDefault()}v.MixedCondition=y})(this.window=this.window||{},BX,BX.Bizproc,BX.Bizproc);
//# sourceMappingURL=script.map.js