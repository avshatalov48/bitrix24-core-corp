{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection, Type, Loc, Event, Tag} from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport 'bp_field_type';\nimport {Globals} from 'bizproc.globals';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Component');\n\nclass GlobalFieldEditComponent\n{\n\toldProperty;\n\tdocumentType;\n\tsignedDocumentType: string;\n\tmode: string;\n\tavailableTypes: object;\n\n\tinputValueId: string;\n\n\tmultipleNode: HTMLSelectElement;\n\tsaveButtonNode: HTMLButtonElement;\n\tform: HTMLFormElement;\n\n\tslider: BX.SidePanel.Slider | null;\n\n\tsliderDict: BX.SidePanel.Dictionary | null;\n\n\tcorrespondenceModeToIdName: object;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.oldProperty = options.property;\n\t\t\tthis.documentType = options.documentType;\n\t\t\tthis.signedDocumentType = options.signedDocumentType;\n\t\t\tthis.mode = options.mode;\n\t\t\tthis.availableTypes = options.types;\n\n\t\t\tthis.inputValueId = options.inputValueId;\n\n\t\t\tthis.multipleNode = options.multipleNode;\n\t\t\tthis.saveButtonNode = options.saveButtonNode;\n\t\t\tthis.form = options.form;\n\n\t\t\tthis.slider = options.slider;\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tthis.sliderDict = this.slider ? this.slider.getData() : null;\n\t\tthis.correspondenceModeToIdName =  {\n\t\t\tconstant: 'Constant',\n\t\t\tvariable: 'Variable',\n\t\t};\n\n\t\tthis.editInputValue(this.oldProperty['Type'], this.oldProperty);\n\n\n\t\tEvent.bind(this.saveButtonNode, 'click', this.saveHandler.bind(this));\n\t}\n\n\teditInputValue(type, property)\n\t{\n\t\tlet prop = BX.clone(property);\n\t\tlet defaultProperty = {\n\t\t\tType: type ?? 'string',\n\t\t\tMultiple: false,\n\t\t\tDefault: ''\n\t\t};\n\n\t\tif (this.availableTypes[defaultProperty.Type] === undefined)\n\t\t{\n\t\t\tdefaultProperty.Type = Object.keys(this.availableTypes)[0];\n\t\t}\n\n\t\tif (!Type.isPlainObject(property))\n\t\t{\n\t\t\tprop = defaultProperty;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isString(property['Multiple']))\n\t\t\t{\n\t\t\t\tprop['Multiple'] = (property['Multiple'] === 'Y');\n\t\t\t}\n\t\t\tprop = {...defaultProperty, ...prop};\n\t\t}\n\n\t\tthis.multipleNode.value = prop['Multiple'] ? 'Y' : 'N';\n\n\t\tif (prop.Type === 'select' && property.Options === undefined)\n\t\t{\n\t\t\tprop.Options = this.oldProperty.Options ?? {};\n\t\t}\n\n\t\tlet control = BX.Bizproc.FieldType.renderControl(\n\t\t\tthis.documentType,\n\t\t\tprop,\n\t\t\t'VALUE',\n\t\t\tprop['Default'],\n\t\t\t'public'\n\t\t);\n\t\tcontrol.className = 'ui-ctl ui-ctl-textbox ui-ctl-w100 global-fields-max-width';\n\t\tcontrol.id = this.inputValueId;\n\n\t\tlet inputValueNode = document.getElementById(this.inputValueId);\n\t\tif (inputValueNode)\n\t\t{\n\t\t\tinputValueNode.replaceWith(control);\n\t\t}\n\n\t\tif (prop.Type !== 'select' && document.getElementById('bizproc_globEditComponent'))\n\t\t{\n\t\t\tdocument.getElementById('bizproc_globEditComponent').remove();\n\t\t\tthis.oldProperty.Options = {};\n\t\t}\n\t\telse if (prop.Type === 'select' && !document.getElementById('bizproc_globEditComponent'))\n\t\t{\n\t\t\tlet wrapper = Tag.render`<div class=\"ui-ctl ui-ctl-w100\" id=\"bizproc_globEditComponent\"></div>`;\n\t\t\tlet optionControl = BX.Bizproc.FieldType.createControlOptions(\n\t\t\t\tprop,\n\t\t\t\tthis.setSelectOptionFromForm.bind(this)\n\t\t\t);\n\t\t\toptionControl.className = 'ui-form-label';\n\t\t\twrapper.appendChild(optionControl);\n\t\t\twrapper.getElementsByTagName('textarea')[0].className = 'ui-ctl-element ui-ctl-textarea ui-ctl-resize-y ui-ctl-w100';\n\t\t\twrapper.getElementsByTagName('textarea')[0].style.paddingTop = '6px';\n\t\t\twrapper.getElementsByTagName('button')[0].className = 'ui-btn ui-btn-xs ui-btn-light-border';\n\n\t\t\tcontrol.before(wrapper);\n\t\t}\n\n\t\tif (!prop['Multiple'])\n\t\t{\n\t\t\tdocument.getElementsByName('VALUE')[0].placeholder = Loc.getMessage('BIZPROC_GLOBALFIELD_EDIT_TMP_EMPTY');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (prop['Type'] === 'user')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet values = document.getElementsByName('VALUE[]');\n\t\tfor (let i in values)\n\t\t{\n\t\t\tif (values.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tvalues[i].placeholder = Loc.getMessage('BIZPROC_GLOBALFIELD_EDIT_TMP_EMPTY');\n\t\t\t}\n\t\t}\n\n\t\tif (control.getElementsByTagName('a').length > 0)\n\t\t{\n\t\t\tlet buttonAdd = control.getElementsByTagName('a')[0];\n\t\t\tBX.bind(buttonAdd, 'click', () => {\n\t\t\t\tlet values = document.getElementsByName('VALUE[]');\n\t\t\t\tlet value = BX.clone(values[values.length - 1]);\n\n\t\t\t\tif (prop['Type'] !== 'date' && prop['Type'] !== 'datetime')\n\t\t\t\t{\n\t\t\t\t\t// remove wrapper div\n\t\t\t\t\tlet parent = values[values.length - 1].parentNode;\n\t\t\t\t\tif (parent)\n\t\t\t\t\t{\n\t\t\t\t\t\tparent.remove();\n\t\t\t\t\t}\n\t\t\t\t\tcontrol.insertBefore(value, buttonAdd.parentNode);\n\t\t\t\t}\n\n\t\t\t\tvalues[values.length - 1].placeholder = Loc.getMessage('BIZPROC_GLOBALFIELD_EDIT_TMP_EMPTY');\n\t\t\t});\n\t\t}\n\t}\n\n\tsetSelectOptionFromForm(options)\n\t{\n\t\tthis.oldProperty.Options = options;\n\n\t\tthis.editInputValue('select', {\n\t\t\tOptions: options,\n\t\t\tType: 'select',\n\t\t\tMultiple : this.multipleNode.value\n\t\t});\n\t}\n\n\tsaveHandler()\n\t{\n\t\tlet formElements = this.form.elements;\n\t\tlet id = formElements['ID'].value;\n\t\tlet property = {\n\t\t\tName: formElements['NAME'].value,\n\t\t\tDescription: formElements['DESCRIPTION'].value,\n\t\t\tType: formElements['TYPE'].value,\n\t\t\tOptions: '',\n\t\t\tDefault: this.getValues(formElements),\n\t\t\tVisibility: formElements['VISIBILITY'].value,\n\t\t\tMultiple: formElements['MULTIPLE'].value,\n\t\t\tRequired: 'N',\n\t\t\tCreatedBy: this.oldProperty['CreatedBy'] ? this.oldProperty['CreatedBy'] : null,\n\t\t\tCreatedDate: this.oldProperty['CreatedDate'] ? this.oldProperty['CreatedDate'] : null\n\t\t};\n\n\t\tif (!this.validateName(property.Name))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!id)\n\t\t{\n\t\t\tlet date = new Date();\n\t\t\tid = this.correspondenceModeToIdName[this.mode] + date.getTime().toString();\n\t\t}\n\n\t\tif (this.oldProperty.Options)\n\t\t{\n\t\t\tproperty.Options = this.oldProperty.Options;\n\t\t}\n\n\t\tlet me = this;\n\t\tGlobals.Manager.Instance.upsertGlobalsAction(id, property, this.signedDocumentType, this.mode).then((response) => {\n\t\t\tif (response.data && response.data.error)\n\t\t\t{\n\t\t\t\tMessageBox.alert(\n\t\t\t\t\tresponse.data.error,\n\t\t\t\t\t() => {\n\t\t\t\t\t\tBX.removeClass(me.saveButtonNode, 'ui-btn-wait');\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tme.sliderDict.set(id, property);\n\t\t\t\tme.slider.close();\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tgetValues(formElements)\n\t{\n\t\tif (formElements['VALUE'])\n\t\t{\n\t\t\treturn formElements['VALUE'].value;\n\t\t}\n\n\t\tif (formElements['VALUE[]'])\n\t\t{\n\t\t\tlet radioNodeList = formElements['VALUE[]'];\n\t\t\tlet values = [];\n\t\t\tif (Type.isElementNode(radioNodeList))\n\t\t\t{\n\t\t\t\tif (radioNodeList.tagName !== 'SELECT')\n\t\t\t\t{\n\t\t\t\t\treturn radioNodeList.value;\n\t\t\t\t}\n\n\t\t\t\tfor (let i in Object.keys(radioNodeList.selectedOptions))\n\t\t\t\t{\n\t\t\t\t\tvalues.push(radioNodeList.selectedOptions[i].value);\n\t\t\t\t}\n\n\t\t\t\treturn values;\n\t\t\t}\n\n\t\t\tfor (let i in radioNodeList)\n\t\t\t{\n\t\t\t\tif (radioNodeList.hasOwnProperty(i))\n\t\t\t\t{\n\t\t\t\t\tvalues.push(radioNodeList[i].value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn values;\n\t\t}\n\n\t}\n\n\tvalidateName(name)\n\t{\n\t\tlet me = this;\n\t\tif (!name)\n\t\t{\n\t\t\tMessageBox.alert(\n\t\t\t\tBX.Loc.getMessage('BIZPROC_GLOBALFIELD_EDIT_TMP_EMPTY_NAME'),\n\t\t\t\t() => {\n\t\t\t\t\tBX.removeClass(me.saveButtonNode, 'ui-btn-wait');\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\n\t}\n}\n\nnamespace.GlobalFieldEditComponent = GlobalFieldEditComponent;"],"names":["namespace","Reflection","GlobalFieldEditComponent","options","Type","isPlainObject","oldProperty","property","documentType","signedDocumentType","mode","availableTypes","types","inputValueId","multipleNode","saveButtonNode","form","slider","sliderDict","getData","correspondenceModeToIdName","constant","variable","editInputValue","Event","bind","saveHandler","type","prop","BX","clone","defaultProperty","Multiple","Default","undefined","Object","keys","isString","value","Options","control","Bizproc","FieldType","renderControl","className","id","inputValueNode","document","getElementById","replaceWith","remove","wrapper","Tag","render","optionControl","createControlOptions","setSelectOptionFromForm","appendChild","getElementsByTagName","style","paddingTop","before","getElementsByName","placeholder","Loc","getMessage","values","i","hasOwnProperty","length","buttonAdd","parent","parentNode","insertBefore","formElements","elements","Name","Description","getValues","Visibility","Required","CreatedBy","CreatedDate","validateName","date","Date","getTime","toString","me","Globals","Manager","Instance","upsertGlobalsAction","then","response","data","error","MessageBox","alert","removeClass","set","close","radioNodeList","isElementNode","tagName","selectedOptions","push","name"],"mappings":"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"}