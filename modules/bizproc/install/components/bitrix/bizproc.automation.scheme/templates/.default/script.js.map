{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Dom, Event, Reflection, Type, Tag, Text } from 'main.core';\nimport { TemplatesScheme } from 'bizproc.automation';\nimport { Menu } from 'main.popup';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Component');\n\nclass Scheme\n{\n\tscheme: TemplatesScheme;\n\tsignedParameters: string;\n\tsteps;\n\n\tselectedType = null;\n\tselectedCategory = null;\n\tselectedStatus = null;\n\n\texecuteButton: HTMLDivElement;\n\n\terrorsContainer: HTMLDivElement;\n\tstepContentTypeContainer: HTMLDivElement;\n\tstepContentCategoryContainer: HTMLDivElement;\n\tstepContentStatusContainer: HTMLDivElement;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.scheme = new TemplatesScheme(options.scheme);\n\t\t\tthis.signedParameters = options.signedParameters;\n\t\t\tthis.steps = options.steps;\n\t\t\tthis.action = options.action;\n\n\t\t\tthis.executeButton = options.executeButton;\n\n\t\t\tthis.errorsContainer = options.errorsContainer;\n\t\t\tthis.stepContentTypeContainer = options.stepsContentContainers[0];\n\t\t\tthis.stepContentCategoryContainer = options.stepsContentContainers[1];\n\t\t\tthis.stepContentStatusContainer = options.stepsContentContainers[2];\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tthis.renderStepContents();\n\t\tEvent.bind(this.executeButton, 'click', this.onExecuteButtonClick.bind(this));\n\t}\n\n\trenderStepContents()\n\t{\n\t\tconst steps = [\n\t\t\t[this.selectedType, this.stepContentTypeContainer, this.onTypeSelectorClick.bind(this)],\n\t\t\t[this.selectedCategory, this.stepContentCategoryContainer, this.onCategorySelectorClick.bind(this)],\n\t\t\t[this.selectedStatus, this.stepContentStatusContainer, this.onStatusSelectorClick.bind(this)],\n\t\t];\n\n\t\tlet completedSteps = 0;\n\t\tsteps.forEach(([selected, container, onclick]) => {\n\t\t\tconst text =\n\t\t\t\tType.isNil(selected)\n\t\t\t\t\t? BX.message('BIZPROC_AUTOMATION_SCHEME_DROPDOWN_PLACEHOLDER')\n\t\t\t\t\t: selected.Name\n\t\t\t;\n\t\t\tthis.renderDropdownStepContent(container, text, onclick);\n\t\t\tif (selected)\n\t\t\t{\n\t\t\t\tcompletedSteps += 1;\n\t\t\t}\n\t\t});\n\n\t\tif (!Type.isNil(this.selectedType) && this.scheme.getTypeCategories(this.selectedType).length <= 0)\n\t\t{\n\t\t\tthis.renderTextStepContent(this.stepContentCategoryContainer, BX.message('BIZPROC_AUTOMATION_SCHEME_CATEGORIES_NOT_EXISTS'));\n\t\t\tcompletedSteps += 1;\n\t\t}\n\t\tthis.stepTo(completedSteps);\n\t}\n\n\trenderDropdownStepContent(target, text, onclick)\n\t{\n\t\tDom.clean(target);\n\t\tconst dropdownNode = Dom.create('div', {\n\t\t\tattrs: {class: 'ui-ctl ui-ctl-after-icon ui-ctl-dropdown'},\n\t\t\tevents: {\n\t\t\t\tclick: onclick\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tTag.render`<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>`,\n\t\t\t\tTag.render`<div class=\"ui-ctl-element\">${Text.encode(text)}</div>`,\n\t\t\t],\n\t\t});\n\n\t\ttarget.appendChild(\n\t\t\tDom.create('div', {\n\t\t\t\tattrs: {class: 'bizproc-automation-scheme__content --padding-15'},\n\t\t\t\tchildren: [dropdownNode],\n\t\t\t})\n\t\t);\n\t}\n\n\trenderTextStepContent(target, text)\n\t{\n\t\tDom.clean(target);\n\t\ttarget.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"bizproc-automation-scheme__content\">\n\t\t\t\t\t<div class=\"ui-alert ui-alert-success\">\n\t\t\t\t\t\t<span class=\"ui-alert-message\">${Text.encode(text)}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`\n\t\t);\n\t}\n\n\tonExecuteButtonClick(event)\n\t{\n\t\tevent.preventDefault();\n\t\tif (!this.selectedType || !this.selectedStatus)\n\t\t{\n\t\t\tthis.showError({message: BX.message(`BIZPROC_AUTOMATION_SCHEME_DESTINATION_SCOPE_ERROR_ACTION_${this.action}`)});\n\t\t\tDom.removeClass(this.executeButton, 'ui-btn-wait');\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction('bitrix:bizproc.automation.scheme', 'copyMove', {\n\t\t\tmode: 'class',\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tdata: {\n\t\t\t\tdstScope: {\n\t\t\t\t\tDocumentType: this.selectedType,\n\t\t\t\t\tCategory: this.selectedCategory,\n\t\t\t\t\tStatus: this.selectedStatus,\n\t\t\t\t},\n\t\t\t}\n\t\t}).then(response => {\n\t\t\tif (this.isSlider())\n\t\t\t{\n\t\t\t\tconst sliderData = BX.SidePanel.Instance.getTopSlider().getData();\n\t\t\t\tObject.entries(response.data).forEach(([key, data]) => sliderData.set(key, data));\n\t\t\t\tsliderData.set('targetScope', {\n\t\t\t\t\tdocumentType: this.selectedType,\n\t\t\t\t\tcategory: this.selectedCategory,\n\t\t\t\t\tstatus: this.selectedStatus,\n\t\t\t\t});\n\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t}\n\t\t\tDom.removeClass(this.executeButton, 'ui-btn-wait');\n\t\t}).catch(response => {\n\t\t\tresponse.errors.forEach(error => this.showError(error));\n\t\t\tDom.removeClass(this.executeButton, 'ui-btn-wait');\n\t\t});\n\t}\n\n\tisSlider(): boolean\n\t{\n\t\treturn location.href.toString().indexOf('SIDE_SLIDER') > 0;\n\t}\n\n\tstepTo(index: number)\n\t{\n\t\tthis.steps.forEach(function(elem, i)\n\t\t{\n\t\t\tif (i < index)\n\t\t\t{\n\t\t\t\tDom.addClass(elem, '--success');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(elem, '--success');\n\t\t\t}\n\t\t}.bind(this));\n\t}\n\n\tonTypeSelectorClick(event)\n\t{\n\t\t// debugger;\n\t\tevent.preventDefault();\n\t\tconst self = this;\n\n\t\tthis.adjustDropdown(\n\t\t\tevent.target.closest('.ui-ctl-dropdown'),\n\t\t\tthis.scheme.getDocumentTypes().map(type => {\n\t\t\t\treturn {\n\t\t\t\t\tid: type.Type,\n\t\t\t\t\ttext: type.Name,\n\t\t\t\t\tonclick(event)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\tself.selectedType = type;\n\t\t\t\t\t\tself.selectedCategory = null;\n\t\t\t\t\t\tself.selectedStatus = null;\n\t\t\t\t\t\tself.renderStepContents();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t})\n\t\t);\n\t}\n\n\tonCategorySelectorClick(event)\n\t{\n\t\tevent.preventDefault();\n\t\tconst self = this;\n\t\tconst categories = !Type.isNil(this.selectedType) ? this.scheme.getTypeCategories(this.selectedType) : [];\n\n\t\tif (categories.length > 0)\n\t\t{\n\t\t\tthis.adjustDropdown(\n\t\t\t\tevent.target.closest('.ui-ctl-dropdown'),\n\t\t\t\tcategories.map(category => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: category.Id,\n\t\t\t\t\t\ttext: category.Name,\n\t\t\t\t\t\tonclick(event)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\tself.selectedCategory = category;\n\t\t\t\t\t\t\tself.selectedStatus = null;\n\t\t\t\t\t\t\tself.renderStepContents();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tonStatusSelectorClick(event)\n\t{\n\t\tevent.preventDefault();\n\t\tconst self = this;\n\t\tlet statuses =  [];\n\t\tif (!Type.isNil(this.selectedType))\n\t\t{\n\t\t\tstatuses = this.scheme.getTypeStatuses(this.selectedType, this.selectedCategory);\n\t\t}\n\n\t\tif (statuses.length > 0)\n\t\t{\n\t\t\tthis.adjustDropdown(\n\t\t\t\tevent.target.closest('.ui-ctl-dropdown'),\n\t\t\t\tstatuses.map(status => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: status.Id,\n\t\t\t\t\t\ttext: status.Name,\n\t\t\t\t\t\tonclick(event)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\tself.selectedStatus = status;\n\t\t\t\t\t\t\tself.renderStepContents();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tadjustDropdown(target, items)\n\t{\n\t\tconst popupMenu = new Menu({\n\t\t\tautoHide: true,\n\t\t\tbindElement: target,\n\t\t\twidth: target.offsetWidth,\n\t\t\tcloseByEsc: true,\n\t\t\titems: items,\n\t\t});\n\n\t\tpopupMenu.show();\n\t}\n\n\tshowError(error)\n\t{\n\t\tconst errorNode = Dom.create('div', {\n\t\t\tprops: {className: 'ui-alert ui-alert-danger'},\n\t\t\tchildren: [\n\t\t\t\tTag.render`<span class=\"ui-alert-message\">${error.message}</span>`\n\t\t\t]\n\t\t});\n\n\t\tthis.errorsContainer.append(errorNode);\n\t}\n}\n\nnamespace.Scheme = Scheme;\n"],"names":["namespace","Reflection","Scheme","options","Type","isPlainObject","scheme","TemplatesScheme","signedParameters","steps","action","executeButton","errorsContainer","stepContentTypeContainer","stepsContentContainers","stepContentCategoryContainer","stepContentStatusContainer","renderStepContents","Event","bind","onExecuteButtonClick","selectedType","onTypeSelectorClick","selectedCategory","onCategorySelectorClick","selectedStatus","onStatusSelectorClick","completedSteps","forEach","selected","container","onclick","text","isNil","BX","message","Name","renderDropdownStepContent","getTypeCategories","length","renderTextStepContent","stepTo","target","Dom","clean","dropdownNode","create","attrs","events","click","children","Tag","render","Text","encode","appendChild","event","preventDefault","showError","removeClass","ajax","runComponentAction","mode","data","dstScope","DocumentType","Category","Status","then","response","isSlider","sliderData","SidePanel","Instance","getTopSlider","getData","Object","entries","key","set","documentType","category","status","close","errors","error","location","href","toString","indexOf","index","elem","i","addClass","self","adjustDropdown","closest","getDocumentTypes","map","type","id","categories","Id","statuses","getTypeStatuses","items","popupMenu","Menu","autoHide","bindElement","width","offsetWidth","closeByEsc","show","errorNode","props","className","append"],"mappings":"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"}