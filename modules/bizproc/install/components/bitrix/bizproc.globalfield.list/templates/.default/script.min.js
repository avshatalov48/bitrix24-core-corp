(function(e,t,n,s){"use strict";var a=t.Reflection.namespace("BX.Bizproc.Component");var i=function(){function e(n){babelHelpers.classCallCheck(this,e);if(t.Type.isPlainObject(n)){this.componentName=n.componentName;this.signedParameters=n.signedParameters;this.gridId=n.gridId;this.signedDocumentType=n.signedDocumentType;this.mode=n.mode;this.slider=n.slider}}babelHelpers.createClass(e,[{key:"init",value:function e(){this.sliderDict=this.slider?this.slider.getData():null}},{key:"getGrid",value:function e(){if(this.gridId){return BX.Main.gridManager&&BX.Main.gridManager.getInstanceById(this.gridId)}return null}},{key:"reloadGrid",value:function e(){var t=this.getGrid();if(t){t.reload()}}},{key:"onCreateButtonClick",value:function e(){var t=this;s.Globals.Manager.Instance.createGlobals(this.mode,this.signedDocumentType).then((function(e){return t.onAfterUpsert(e)}))}},{key:"editGlobalFieldAction",value:function e(t,n){var a=this;s.Globals.Manager.Instance.editGlobals(t,n,this.signedDocumentType).then((function(e){return a.onAfterUpsert(e)}))}},{key:"onAfterUpsert",value:function e(t){var n=t.getData().entries();var s=Object.keys(n);if(s.length<=0){return}if(this.sliderDict){var a;var i=(a=this.sliderDict.get("upsert"))!==null&&a!==void 0?a:{};i[s[0]]=n[s[0]];this.sliderDict.set("upsert",i)}this.reloadGrid()}},{key:"getDeletePhrase",value:function e(n){if(n===s.Globals.Manager.Instance.mode.variable){return t.Loc.getMessage("BIZPROC_GLOBALFIELDS_LIST_CONFIRM_VARIABLE_DELETE")}else if(n===s.Globals.Manager.Instance.mode.constant){return t.Loc.getMessage("BIZPROC_GLOBALFIELDS_LIST_CONFIRM_CONSTANT_DELETE")}else{return""}}},{key:"getPluralDeletePhrase",value:function e(n){if(n===s.Globals.Manager.Instance.mode.variable){return t.Loc.getMessage("BIZPROC_GLOBALFIELDS_LIST_CONFIRM_VARIABLES_DELETE")}else if(n===s.Globals.Manager.Instance.mode.constant){return t.Loc.getMessage("BIZPROC_GLOBALFIELDS_LIST_CONFIRM_CONSTANTS_DELETE")}else{return""}}},{key:"deleteGlobalFieldAction",value:function e(a,i){var r=this;var o=this.getDeletePhrase(i);new n.MessageBox({message:o,okCaption:t.Loc.getMessage("BIZPROC_GLOBALFIELDS_LIST_BTN_DELETE"),onOk:function e(){s.Globals.Manager.Instance.deleteGlobalsAction(a,i,r.signedDocumentType).then((function(e){if(e.data&&e.data.error){n.MessageBox.alert(e.data.error)}else{if(r.sliderDict){var t;var s=(t=r.sliderDict.get("delete"))!==null&&t!==void 0?t:[];s.push(a);r.sliderDict.set("delete",s)}r.reloadGrid()}}));return true},buttons:n.MessageBoxButtons.OK_CANCEL,popupOptions:{events:{onAfterShow:function e(t){var n=t.getTarget().getButton("ok");if(n){n.getContainer().focus()}}}}}).show()}},{key:"deleteFieldsAction",value:function e(s){var a=this;var i=this;var r=this.getPluralDeletePhrase(s);new n.MessageBox({message:r,okCaption:t.Loc.getMessage("BIZPROC_GLOBALFIELDS_LIST_BTN_DELETE"),onOk:function e(){BX.ajax.runComponentAction(i.componentName,"processGridDelete",{mode:"class",data:{signedParameters:a.signedParameters,documentType:a.signedDocumentType,mode:s,ids:a.getGrid().getRows().getSelectedIds()}}).then((function(e){if(e.data&&e.data.error){n.MessageBox.alert(e.data.error)}else{if(i.sliderDict){var t;var s=(t=i.sliderDict.get("delete"))!==null&&t!==void 0?t:[];a.getGrid().getRows().getSelectedIds().forEach((function(e){s.push(e)}));i.sliderDict.set("delete",s)}i.reloadGrid()}}));return true},buttons:n.MessageBoxButtons.OK_CANCEL,popupOptions:{events:{onAfterShow:function e(t){var n=t.getTarget().getButton("ok");if(n){n.getContainer().focus()}}}}}).show()}}]);return e}();a.GlobalFieldListComponent=i})(this.window=this.window||{},BX,BX.UI.Dialogs,BX.Bizproc);
//# sourceMappingURL=script.map.js