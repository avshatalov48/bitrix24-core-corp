{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection, ajax, Type, Event } from 'main.core';\nimport { Alert, AlertColor } from 'ui.alerts';\nimport { Manager } from 'bizproc.debugger';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Component');\n\nclass DebuggerSessionList\n{\n\tgridId;\n\tcreateDebuggerSessionButton;\n\terrorsContainerDiv;\n\tdocumentSigned;\n\tsignedParameters;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.gridId = options.gridId;\n\t\t\tthis.createDebuggerSessionButton = options.createDebuggerSessionButton;\n\t\t\tthis.errorsContainerDiv = options.errorsContainerDiv;\n\t\t\tthis.documentSigned = options.documentSigned;\n\t\t\tthis.signedParameters = options.signedParameters;\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tif (this.createDebuggerSessionButton)\n\t\t{\n\t\t\tEvent.bind(this.createDebuggerSessionButton, 'click', event => this.createSession());\n\t\t}\n\t}\n\n\tcreateSession()\n\t{\n\t\tManager.Instance.openDebuggerStartPage(this.documentSigned, {analyticsStartType: 'session_list'}).then();\n\t}\n\n\tshowSession(sessionId: string): void\n\t{\n\t\tManager.Instance.openSessionLog(sessionId).then();\n\t}\n\n\trenameSession(sessionId: string): void\n\t{\n\t\tconst grid = this.getGrid();\n\n\t\tgrid.getRows().getById(sessionId)?.select();\n\t\tgrid.getActionsPanel().getPanel().querySelector('#grid_edit_button > .edit').click();\n\t\tgrid.enableActionsPanel();\n\t\tgrid.getPinPanel().pinPanel(true);\n\t}\n\n\tdeleteChosenSessions(): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tthis.deleteSessions(grid.getRows().getSelectedIds());\n\t\t}\n\t}\n\n\tdeleteSessions(sessionIds: Array<string>): void\n\t{\n\t\tajax.runComponentAction('bitrix:bizproc.debugger.session.list', 'deleteSessions', {\n\t\t\tmode: 'class',\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tdata: {sessionIds},\n\t\t}).then((response) => {\n\t\t\tthis.reloadGrid();\n\t\t}).catch((response) => {\n\t\t\tthis.showErrors(response.errors);\n\t\t});\n\t}\n\n\tshowErrors(errors: Array<{message: string}>)\n\t{\n\t\tthis.errorsContainerDiv.style.margin = '10px';\n\n\t\terrors.forEach((error) => {\n\t\t\tconst alert = new Alert({\n\t\t\t\ttext: error.message,\n\t\t\t\tcolor: AlertColor.DANGER,\n\t\t\t\tcloseBtn: true,\n\t\t\t\tanimated: true,\n\t\t\t});\n\n\t\t\talert.renderTo(this.errorsContainerDiv);\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tgrid.reload();\n\t\t}\n\t}\n\n\tgetGrid()\n\t{\n\t\tif (this.gridId)\n\t\t{\n\t\t\treturn BX.Main.gridManager && BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t}\n\t\treturn null;\n\t}\n}\n\nnamespace.DebuggerSessionList = DebuggerSessionList;"],"names":["namespace","Reflection","DebuggerSessionList","options","Type","isPlainObject","gridId","createDebuggerSessionButton","errorsContainerDiv","documentSigned","signedParameters","Event","bind","event","createSession","Manager","Instance","openDebuggerStartPage","analyticsStartType","then","sessionId","openSessionLog","grid","getGrid","getRows","getById","select","getActionsPanel","getPanel","querySelector","click","enableActionsPanel","getPinPanel","pinPanel","deleteSessions","getSelectedIds","sessionIds","ajax","runComponentAction","mode","data","response","reloadGrid","showErrors","errors","style","margin","forEach","error","alert","Alert","text","message","color","AlertColor","DANGER","closeBtn","animated","renderTo","reload","BX","Main","gridManager","getInstanceById"],"mappings":";;;;CAIA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAS,CAAC,sBAAsB,CAAC;CAAC,IAEzDE,mBAAmB;GAQxB,6BAAYC,OAAO,EACnB;KAAA;KACC,IAAIC,cAAI,CAACC,aAAa,CAACF,OAAO,CAAC,EAC/B;OACC,IAAI,CAACG,MAAM,GAAGH,OAAO,CAACG,MAAM;OAC5B,IAAI,CAACC,2BAA2B,GAAGJ,OAAO,CAACI,2BAA2B;OACtE,IAAI,CAACC,kBAAkB,GAAGL,OAAO,CAACK,kBAAkB;OACpD,IAAI,CAACC,cAAc,GAAGN,OAAO,CAACM,cAAc;OAC5C,IAAI,CAACC,gBAAgB,GAAGP,OAAO,CAACO,gBAAgB;;;GAEjD;KAAA;KAAA,uBAGD;OAAA;OACC,IAAI,IAAI,CAACH,2BAA2B,EACpC;SACCI,eAAK,CAACC,IAAI,CAAC,IAAI,CAACL,2BAA2B,EAAE,OAAO,EAAE,UAAAM,KAAK;WAAA,OAAI,KAAI,CAACC,aAAa,EAAE;WAAC;;;;KAErF;KAAA,gCAGD;OACCC,wBAAO,CAACC,QAAQ,CAACC,qBAAqB,CAAC,IAAI,CAACR,cAAc,EAAE;SAACS,kBAAkB,EAAE;QAAe,CAAC,CAACC,IAAI,EAAE;;;KACxG;KAAA,4BAEWC,SAAiB,EAC7B;OACCL,wBAAO,CAACC,QAAQ,CAACK,cAAc,CAACD,SAAS,CAAC,CAACD,IAAI,EAAE;;;KACjD;KAAA,8BAEaC,SAAiB,EAC/B;OAAA;OACC,IAAME,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;OAE3B,yBAAAD,IAAI,CAACE,OAAO,EAAE,CAACC,OAAO,CAACL,SAAS,CAAC,0DAAjC,sBAAmCM,MAAM,EAAE;OAC3CJ,IAAI,CAACK,eAAe,EAAE,CAACC,QAAQ,EAAE,CAACC,aAAa,CAAC,2BAA2B,CAAC,CAACC,KAAK,EAAE;OACpFR,IAAI,CAACS,kBAAkB,EAAE;OACzBT,IAAI,CAACU,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC;;;KACjC;KAAA,uCAGD;OACC,IAAMX,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;OAC3B,IAAID,IAAI,EACR;SACC,IAAI,CAACY,cAAc,CAACZ,IAAI,CAACE,OAAO,EAAE,CAACW,cAAc,EAAE,CAAC;;;;KAErD;KAAA,+BAEcC,UAAyB,EACxC;OAAA;OACCC,cAAI,CAACC,kBAAkB,CAAC,sCAAsC,EAAE,gBAAgB,EAAE;SACjFC,IAAI,EAAE,OAAO;SACb7B,gBAAgB,EAAE,IAAI,CAACA,gBAAgB;SACvC8B,IAAI,EAAE;WAACJ,UAAU,EAAVA;;QACP,CAAC,CAACjB,IAAI,CAAC,UAACsB,QAAQ,EAAK;SACrB,MAAI,CAACC,UAAU,EAAE;QACjB,CAAC,SAAM,CAAC,UAACD,QAAQ,EAAK;SACtB,MAAI,CAACE,UAAU,CAACF,QAAQ,CAACG,MAAM,CAAC;QAChC,CAAC;;;KACF;KAAA,2BAEUA,MAAgC,EAC3C;OAAA;OACC,IAAI,CAACpC,kBAAkB,CAACqC,KAAK,CAACC,MAAM,GAAG,MAAM;OAE7CF,MAAM,CAACG,OAAO,CAAC,UAACC,KAAK,EAAK;SACzB,IAAMC,KAAK,GAAG,IAAIC,eAAK,CAAC;WACvBC,IAAI,EAAEH,KAAK,CAACI,OAAO;WACnBC,KAAK,EAAEC,oBAAU,CAACC,MAAM;WACxBC,QAAQ,EAAE,IAAI;WACdC,QAAQ,EAAE;UACV,CAAC;SAEFR,KAAK,CAACS,QAAQ,CAAC,MAAI,CAAClD,kBAAkB,CAAC;QACvC,CAAC;;;KACF;KAAA,6BAGD;OACC,IAAMc,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;OAC3B,IAAID,IAAI,EACR;SACCA,IAAI,CAACqC,MAAM,EAAE;;;;KAEd;KAAA,0BAGD;OACC,IAAI,IAAI,CAACrD,MAAM,EACf;SACC,OAAOsD,EAAE,CAACC,IAAI,CAACC,WAAW,IAAIF,EAAE,CAACC,IAAI,CAACC,WAAW,CAACC,eAAe,CAAC,IAAI,CAACzD,MAAM,CAAC;;OAE/E,OAAO,IAAI;;;GACX;CAAA;CAGFN,SAAS,CAACE,mBAAmB,GAAGA,mBAAmB;;;;"}