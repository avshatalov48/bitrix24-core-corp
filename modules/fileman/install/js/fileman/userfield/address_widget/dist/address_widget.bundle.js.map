{"version":3,"file":"address_widget.bundle.js","sources":["../src/view/baseview.js","../src/view/view.js","../src/view/editentry.js","../src/view/edit.js","../src/address_widget.js"],"sourcesContent":["export class BaseView\n{\n\t#wrapper: ?Element = null;\n\n\tconstructor(params: Object) {\n\t\tthis.#wrapper = params.wrapper;\n\t}\n\n\tgetWrapper(): Element\n\t{\n\t\treturn this.#wrapper;\n\t}\n\n\tlayout(): Element\n\t{\n\t\tthrow new Error('please implement the layout() method');\n\t}\n}\n","import 'ui.design-tokens';\nimport {Address as AddressWidget, Factory} from \"location.widget\";\nimport {Dom, Tag} from \"main.core\";\nimport {Address as AddressEntity, AddressStringConverter, ControlMode, Format} from \"location.core\";\nimport {BaseView} from './baseview';\nimport './css/style.css';\n\nexport class View extends BaseView\n{\n\t#addresses: AddressEntity[] = [];\n\n\t#widgets: AddressWidget[] = [];\n\n\tconstructor(params: Object)\n\t{\n\t\tsuper(params);\n\t\tthis.#addresses = params.addresses;\n\t}\n\n\tdestroyWidgets()\n\t{\n\t\tthis.#widgets.forEach((widget) => {\n\t\t\twidget.destroy();\n\t\t});\n\t}\n\n\tlayout(): Element\n\t{\n\t\tconst layout = Tag.render`<div></div>`;\n\n\t\tthis.#addresses.forEach((address) => {\n\t\t\tDom.append(this.getLayoutForAddress(address), layout);\n\t\t});\n\n\t\tDom.append(layout, this.getWrapper());\n\n\t\treturn this.getWrapper();\n\t}\n\n\tgetLayoutForAddress(address: AddressEntity)\n\t{\n\t\tconst factory = new Factory();\n\t\tconst widget = factory.createAddressWidget({\n\t\t\taddress: address,\n\t\t\tmode: ControlMode.view,\n\t\t\tpopupOptions: {\n\t\t\t\toffsetLeft: 14,\n\t\t\t},\n\t\t\tpopupBindOptions: {\n\t\t\t\tforceBindPosition: true,\n\t\t\t\tposition: 'right',\n\t\t\t},\n\t\t\tmapBehavior: 'auto',\n\t\t\tuseFeatures: {\n\t\t\t\tfields: false,\n\t\t\t\tmap: true,\n\t\t\t\tautocomplete: false,\n\t\t\t}\n\t\t});\n\n\t\tthis.#widgets.push(widget);\n\n\t\tconst addressLayout = Tag.render`\n\t\t\t<span class=\"fields address field-item view\">\n\t\t\t\t<span class=\"ui-link ui-link-dark ui-link-dotted\">${this.getFormattedAddress(address)}</span>\n\t\t\t</span>\n\t\t`;\n\n\t\twidget.render({\n\t\t\tmapBindElement: addressLayout,\n\t\t\tcontrolWrapper: addressLayout,\n\t\t});\n\n\t\treturn addressLayout;\n\t}\n\n\tgetFormattedAddress(address: AddressEntity): string\n\t{\n\t\tconst format = new Format(JSON.parse(BX.message('LOCATION_WIDGET_DEFAULT_FORMAT')));\n\t\treturn address.toString(format, AddressStringConverter.STRATEGY_TYPE_TEMPLATE_COMMA) ?? '';\n\t}\n}\n","import {Address as AddressWidget, AutocompleteFeature, Factory, State} from \"location.widget\";\nimport {Address as AddressEntity, AddressStringConverter, AddressType, ControlMode, Format} from \"location.core\";\nimport {Dom, Event, Tag, Loc, Text} from \"main.core\";\nimport type {EditEntryProps} from \"./editentryprops\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class EditEntry extends EventEmitter\n{\n\t#widget: AddressWidget;\n\t#nodes: { name: string, node: Element } = {};\n\t#wrapper: Element;\n\t#address: AddressEntity = null;\n\t#fieldName: string;\n\t#fieldFormName: string;\n\t#showMap: boolean = true;\n\t#enableRemoveButton: boolean = false;\n\t#isCompactMode: boolean = false;\n\t#initialAddressId: ?number = null;\n\t#areDetailsShown: boolean = false;\n\t#isLoading: boolean = false;\n\t#isDropdownLoading: boolean = false;\n\t#isDestroyed: boolean = false;\n\n\tstatic onRemoveInputButtonClickedEvent = 'onRemoveInputButtonClicked';\n\n\tconstructor(props: EditEntryProps)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('Fileman.EditEntry');\n\t\tthis.#wrapper = props.wrapper;\n\t\tthis.#fieldName = props.fieldName;\n\t\tthis.#fieldFormName = props.fieldFormName;\n\t\tthis.#enableRemoveButton = props.enableRemoveButton;\n\t\tthis.#initialAddressId = props.initialAddressId;\n\t\tthis.#showMap = props.showMap;\n\n\t\tif (props.address)\n\t\t{\n\t\t\tthis.#address = props.address;\n\t\t}\n\t\tif (props.isCompactMode)\n\t\t{\n\t\t\tthis.#isCompactMode = props.isCompactMode;\n\t\t}\n\t}\n\n\tlayout(): Element\n\t{\n\t\tconst factory = new Factory();\n\t\tthis.#widget = factory.createAddressWidget({\n\t\t\taddress: this.#address,\n\t\t\tmode: ControlMode.edit,\n\t\t\tpopupOptions: {\n\t\t\t\toffsetLeft: 14,\n\t\t\t},\n\t\t\tpopupBindOptions: {\n\t\t\t\tforceBindPosition: true,\n\t\t\t\tposition: 'right',\n\t\t\t},\n\t\t\tmapBehavior: 'auto',\n\t\t\tuseFeatures: {\n\t\t\t\tfields: true,\n\t\t\t\tmap: this.#showMap,\n\t\t\t\tautocomplete: true\n\t\t\t}\n\t\t});\n\n\t\tthis.#nodes.userInput = Tag.render`<input type=\"text\" class=\"ui-ctl-element\" />`;\n\n\t\tthis.#nodes.fieldsContainer = Tag.render`<div class=\"location-fields-control-block\"></div>`;\n\t\tthis.#nodes.detailsToggle = Tag.render`<span class=\"ui-link ui-link-secondary address-control-mode-switch\">${Loc.getMessage('ADDRESS_USERFIELD_DETAILS')}</span>`;\n\t\tEvent.bind(this.#nodes.detailsToggle, 'click', this.onDetailsToggleClick.bind(this));\n\n\t\tlet inputValue = this.getInitialAddressFieldValue();\n\t\tthis.#nodes.fieldValueInput = Tag.render`<input type=\"hidden\" name=\"${this.#fieldFormName}\" value=\"${inputValue}\" />`;\n\n\t\tthis.#nodes.inputIcon = Tag.render`<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\"></button>`;\n\t\tEvent.bind(this.#nodes.inputIcon, 'click', this.onInputIconClick.bind(this));\n\n\t\tthis.#widget.subscribeOnAddressChangedEvent(this.onAddressChanged.bind(this));\n\t\tthis.#widget.subscribeOnStateChangedEvent(this.onWidgetStateChangedEvent.bind(this));\n\t\tthis.#widget.subscribeOnFeatureEvent(this.onFeatureEvent.bind(this));\n\n\t\tthis.#nodes.entryWrapper = Tag.render`\n\t\t\t<div class=\"edit-entry-input-wrapper\">\n\t\t\t\t<div class=\"fields address field-item edit ui-ctl ui-ctl-after-icon ${this.getUserInputSizeClass()}\">\n\t\t\t\t\t${this.#nodes.userInput}\n\t\t\t\t\t${this.#nodes.fieldsContainer}\n\t\t\t\t\t${this.#nodes.inputIcon}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\t// a workaround for bizproc conditionals; their conditionals popup seems to use the topmost <input>'s value\n\t\tconst hiddenFormattedInputValue = this.#address ? this.getRawValueForHiddenFormattedInput(this.#address) : '';\n\t\tthis.#nodes.hiddenFormattedAddressInput = Tag.render`<input type=\"hidden\" name=\"${this.#fieldName}_formatted\" value=\"${hiddenFormattedInputValue}\" />`;\n\n\t\t// a flag used to identify values set manually by the user\n\t\tconst manualEditFlagNode = Tag.render`<input type=\"hidden\" name=\"${this.#fieldName}_manual_edit\" value=\"Y\">`;\n\n\t\tthis.#nodes.layout = Tag.render`\n\t\t\t<div class=\"edit-entry-layout-wrapper ${this.getLayoutSizeClass()}\">\n\t\t\t\t<div class=\"address-control-mode-switch-wrapper\">\n\t\t\t\t\t${this.#nodes.detailsToggle}\n\t\t\t\t</div>\n\t\t\t\t${this.#nodes.hiddenFormattedAddressInput}\n\t\t\t\t${this.#nodes.entryWrapper}\n\t\t\t\t${manualEditFlagNode}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.#enableRemoveButton)\n\t\t{\n\t\t\tDom.append(this.getRemoveInputButton(this.#nodes.layout), this.#nodes.entryWrapper);\n\t\t}\n\n\t\tDom.append(this.#nodes.fieldValueInput, this.#nodes.layout);\n\n\t\tthis.#widget.render({\n\t\t\tinputNode: this.#nodes.userInput,\n\t\t\tmapBindElement: this.#wrapper,\n\t\t\tcontrolWrapper: this.#nodes.layout,\n\t\t\tfieldsContainer: this.#nodes.fieldsContainer,\n\t\t});\n\n\t\treturn this.#nodes.layout;\n\t}\n\n\tgetUserInputSizeClass(): string\n\t{\n\t\treturn this.#isCompactMode ? 'ui-ctl-wd' : 'ui-ctl-w100';\n\t}\n\n\tgetLayoutSizeClass(): string\n\t{\n\t\treturn this.#isCompactMode ? 'compact' : '';\n\t}\n\n\tgetRemoveInputButton(layout: Element)\n\t{\n\t\tconst removeInputButton = Tag.render`\n\t\t\t<span class=\"uf-address-search-input-remove\"></span>\n\t\t`;\n\n\t\tEvent.bind(removeInputButton, 'click', (event) => {\n\t\t\tthis.emit(EditEntry.onRemoveInputButtonClickedEvent);\n\t\t});\n\n\t\treturn removeInputButton;\n\t}\n\n\tdestroy()\n\t{\n\t\tif (!this.#nodes.layout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#widget)\n\t\t{\n\t\t\tthis.#widget.destroy();\n\t\t}\n\n\t\tif (this.#address && this.#address.id > 0)\n\t\t{\n\t\t\tDom.clean(this.#nodes.layout);\n\t\t\tconst input = Tag.render`<input type=\"hidden\" name=\"${this.#fieldFormName}\" value=\"${this.#address.id}_del\" />`;\n\t\t\tDom.append(input, this.#nodes.layout);\n\t\t\tthis.emitFieldChangedEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.remove(this.#nodes.layout);\n\t\t}\n\n\t\tthis.#isDestroyed = true;\n\t}\n\n\tisDestroyed(): boolean\n\t{\n\t\treturn this.#isDestroyed;\n\t}\n\n\tonAddressChanged(event)\n\t{\n\t\tconst initialAddressId = parseInt(this.#initialAddressId);\n\t\t/** @type {AddressEntity} */\n\t\tconst address = event.data.address;\n\t\tif (!address)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// when we clear the input, the address' id becomes 0, and because of it a new address is created upon\n\t\t// saving. we can set the address's id to the old id to edit the old address instead\n\t\tif (initialAddressId && parseInt(address.id) !== initialAddressId)\n\t\t{\n\t\t\taddress.id = initialAddressId;\n\t\t}\n\n\t\tthis.#nodes.fieldValueInput.value = this.getChangedAddressFieldValue(address);\n\n\t\tthis.#nodes.hiddenFormattedAddressInput.value = this.getRawValueForHiddenFormattedInput(address);\n\n\t\tthis.emitFieldChangedEvent();\n\t}\n\n\tonWidgetStateChangedEvent(event)\n\t{\n\t\tconst state = event.data.state;\n\t\tthis.#isLoading = (state === State.DATA_LOADING);\n\n\t\tthis.refreshInputIcon();\n\t}\n\n\tonFeatureEvent(event)\n\t{\n\t\tif (event.data.feature instanceof AutocompleteFeature)\n\t\t{\n\t\t\tthis.#isDropdownLoading = (event.data.eventCode === AutocompleteFeature.searchStartedEvent);\n\n\t\t\tthis.refreshInputIcon();\n\t\t}\n\t}\n\n\tisInputLoading(): boolean\n\t{\n\t\treturn this.#isLoading || this.#isDropdownLoading;\n\t}\n\n\trefreshInputIcon()\n\t{\n\t\tif (!this.#nodes.inputIcon)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isInputLoading())\n\t\t{\n\t\t\tDom.removeClass(this.#nodes.inputIcon, 'ui-ctl-icon-clear');\n\t\t\tDom.addClass(this.#nodes.inputIcon, 'ui-ctl-icon-loader');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.#nodes.inputIcon, 'ui-ctl-icon-loader');\n\t\t\tDom.addClass(this.#nodes.inputIcon, 'ui-ctl-icon-clear');\n\t\t}\n\t}\n\n\tgetInitialAddressFieldValue(): string\n\t{\n\t\tlet inputValue =  '';\n\n\t\tif (this.#address?.id == 0)\n\t\t{\n\t\t\tif (this.#address.location)\n\t\t\t{\n\t\t\t\t// JSON has probably been passed as the component's value; we need to create a new address\n\t\t\t\tinputValue = Text.encode(this.#address.toJson());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// for compatibility with the format used before the switch to location module's addresses\n\t\t\t\tinputValue = `${this.#address.getFieldValue(AddressType.ADDRESS_LINE_2)}|${this.#address.latitude};${this.#address.longitude}`;\n\t\t\t}\n\t\t}\n\t\telse if (this.#address?.id > 0)\n\t\t{\n\t\t\tinputValue = `${this.getFormattedAddress(this.#address)}|${this.#address.latitude};${this.#address.longitude}|${this.#address.id}`;\n\t\t}\n\n\t\treturn inputValue;\n\t}\n\n\tgetChangedAddressFieldValue(address: AddressEntity): string\n\t{\n\t\treturn address.toJson();\n\t}\n\n\tgetFormattedAddress(address: AddressEntity): string\n\t{\n\t\tconst format = new Format(JSON.parse(BX.message('LOCATION_WIDGET_DEFAULT_FORMAT')));\n\t\treturn address.toString(format, AddressStringConverter.STRATEGY_TYPE_TEMPLATE_COMMA) ?? '';\n\t}\n\n\tgetRawValueForHiddenFormattedInput(address: AddressEntity): string\n\t{\n\t\treturn `${this.getFormattedAddress(address)}|${address.latitude};${address.longitude}`;\n\t}\n\n\tonInputIconClick()\n\t{\n\t\tif (this.isInputLoading())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#nodes.userInput.focus();\n\n\t\tthis.#widget.resetView();\n\t\tthis.#widget.address = null;\n\n\t\tif (this.#address && this.#address.id > 0)\n\t\t{\n\t\t\tthis.#nodes.fieldValueInput.value = this.#address.id + '_del';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#nodes.fieldValueInput.value = '';\n\t\t}\n\n\t\tthis.emitFieldChangedEvent();\n\t}\n\n\tonDetailsToggleClick()\n\t{\n\t\tif (!this.#nodes.fieldsContainer || !this.#nodes.detailsToggle)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fieldsContainer = this.#nodes.fieldsContainer;\n\t\tconst detailsToggle = this.#nodes.detailsToggle;\n\t\tif (this.#areDetailsShown && Dom.hasClass(fieldsContainer, 'visible'))\n\t\t{\n\t\t\tDom.removeClass(fieldsContainer, 'visible');\n\t\t\tdetailsToggle.innerText = Loc.getMessage('ADDRESS_USERFIELD_DETAILS');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(fieldsContainer, 'visible');\n\t\t\tdetailsToggle.innerText = Loc.getMessage('ADDRESS_USERFIELD_NO_DETAILS');\n\t\t}\n\n\t\tthis.#areDetailsShown = !this.#areDetailsShown;\n\t}\n\n\temitFieldChangedEvent()\n\t{\n\t\tBX.onCustomEvent(window, 'onUIEntityEditorUserFieldExternalChanged', [this.#fieldName]);\n\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldExternalChanged', [this.#fieldName]);\n\t}\n}\n","import {Dom, Event, Tag, Loc} from \"main.core\";\nimport {Address as AddressEntity} from \"location.core\";\nimport {BaseView} from './baseview';\n\nimport './css/style.css';\nimport {EditEntry} from \"./editentry\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class Edit extends BaseView\n{\n\t#fieldName = '';\n\t#fieldFormName = '';\n\t#addresses: AddressEntity[] = [];\n\t#inputsWrapper: Element = null;\n\t#isMultiple = false;\n\t#isCompactMode = false;\n\t#showMap = true;\n\t#inputs: EditEntry[] = [];\n\n\tconstructor(params: Object)\n\t{\n\t\tsuper(params);\n\t\tthis.#fieldName = params.fieldName;\n\t\tthis.#fieldFormName = params.fieldFormName;\n\t\tthis.#addresses = params.addresses;\n\t\tthis.#isMultiple = params.isMultiple;\n\t\tthis.#isCompactMode = params.compactMode;\n\t\tthis.#showMap = params.showMap;\n\t}\n\n\tlayout(): Element\n\t{\n\t\tconst layout = Tag.render`<div class=\"address-edit-wrapper\"></div>`;\n\n\t\tconst inputsWrapper = Tag.render`<div class=\"address-inputs-wrapper\"></div>`;\n\n\t\tif (this.#addresses.length > 0)\n\t\t{\n\t\t\tthis.#addresses.forEach((address) => {\n\t\t\t\tconst input = this.createInputForAddress(address);\n\t\t\t\tDom.append(input.layout(), inputsWrapper);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst input = this.createInputForAddress();\n\t\t\tDom.append(input.layout(), inputsWrapper);\n\t\t}\n\n\t\tDom.append(inputsWrapper, layout);\n\t\tthis.#inputsWrapper = inputsWrapper;\n\n\t\tif (this.#isMultiple)\n\t\t{\n\t\t\tconst addInputElement = Tag.render`<input type=\"button\" value=\"${Loc.getMessage('ADDRESS_USERFIELD_ADD_INPUT')}\" />`;\n\t\t\tEvent.bind(addInputElement, 'click', this.addInput.bind(this));\n\t\t\tDom.append(addInputElement, layout);\n\t\t}\n\n\t\tDom.append(layout, this.getWrapper());\n\n\t\treturn this.getWrapper();\n\t}\n\n\taddInput()\n\t{\n\t\tif (!this.#inputsWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst input = this.createInputForAddress();\n\t\tDom.append(input.layout(), this.#inputsWrapper);\n\t}\n\n\tcreateInputForAddress(address: AddressEntity): EditEntry\n\t{\n\t\tconst entry = new EditEntry({\n\t\t\twrapper: this.getWrapper(),\n\t\t\taddress: address,\n\t\t\tfieldName: this.#fieldName,\n\t\t\tfieldFormName: this.#fieldFormName,\n\t\t\tenableRemoveButton: this.#isMultiple,\n\t\t\tinitialAddressId: parseInt(address?.id) ?? null,\n\t\t\tisCompactMode: this.#isCompactMode,\n\t\t\tshowMap: this.#showMap,\n\t\t});\n\t\tEventEmitter.subscribe(entry, EditEntry.onRemoveInputButtonClickedEvent, this.removeInput.bind(this, entry));\n\t\tthis.#inputs.push(entry);\n\n\t\treturn entry;\n\t}\n\n\tremoveInput(input: EditEntry)\n\t{\n\t\tconst activeInputsCount = this.#inputs.filter((input) => {return !input.isDestroyed()}).length;\n\n\t\tif (activeInputsCount > 1)\n\t\t{\n\t\t\tinput.destroy();\n\t\t}\n\t}\n}\n","import {Reflection, Type} from \"main.core\";\nimport {Address as AddressEntity} from \"location.core\";\n\nimport {View} from './view/view';\nimport {Edit} from './view/edit';\n\nclass AddressField\n{\n\tstatic VIEW_MODE = 'view';\n\tstatic EDIT_MODE = 'edit';\n\n\t#mode = AddressField.VIEW_MODE;\n\t#wrapper: Element;\n\t#addresses: [];\n\t#isMultiple: boolean = false;\n\t#showMap: boolean = true;\n\n\t#fieldConfig = {};\n\t#additionalProperties = {};\n\n\tstatic init(params: Object)\n\t{\n\t\tconst mode = params.mode;\n\t\tconst wrapper = document.getElementById(params.wrapperId);\n\t\tif (!wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet addresses = [];\n\t\tconst addressData = params.addressData;\n\t\taddressData.forEach((addressFields) => {\n\t\t\tif (Type.isObject(addressFields))\n\t\t\t{\n\t\t\t\taddresses.push(new AddressEntity(addressFields));\n\t\t\t}\n\t\t});\n\n\t\tconst showMap = params.showMap ?? true;\n\t\tlet addressFieldParams = {\n\t\t\taddresses: addresses,\n\t\t\twrapper: wrapper,\n\t\t\tmode: mode,\n\t\t\tfieldConfig: {\n\t\t\t\tfieldName: params.fieldName,\n\t\t\t\tfieldFormName: params.fieldFormName,\n\t\t\t},\n\t\t\tisMultiple: params.isMultiple,\n\t\t\tshowMap,\n\t\t};\n\n\t\tif (params.additionalProperties)\n\t\t{\n\t\t\taddressFieldParams.additionalProperties = params.additionalProperties;\n\t\t}\n\n\t\tconst addressField = new AddressField(addressFieldParams);\n\t\taddressField.layout();\n\t}\n\n\tconstructor(params: Object)\n\t{\n\t\tthis.#mode = params.mode;\n\t\tthis.#wrapper = params.wrapper;\n\t\tthis.#addresses = params.addresses;\n\t\tthis.#fieldConfig = params.fieldConfig;\n\t\tthis.#isMultiple = params.isMultiple;\n\t\tthis.#showMap = params.showMap;\n\t\tif (params.additionalProperties)\n\t\t{\n\t\t\tthis.#additionalProperties = params.additionalProperties;\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\t/** @type BaseView */\n\t\tlet view = null;\n\n\t\tif (this.#mode === AddressField.VIEW_MODE)\n\t\t{\n\t\t\tview = new View({\n\t\t\t\twrapper: this.#wrapper,\n\t\t\t\taddresses: this.#addresses,\n\t\t\t});\n\t\t}\n\n\t\tif (this.#mode === AddressField.EDIT_MODE)\n\t\t{\n\t\t\tview = new Edit({\n\t\t\t\twrapper: this.#wrapper,\n\t\t\t\tfieldName: this.#fieldConfig.fieldName,\n\t\t\t\tfieldFormName: this.#fieldConfig.fieldFormName,\n\t\t\t\taddresses: this.#addresses,\n\t\t\t\tisMultiple: this.#isMultiple,\n\t\t\t\tcompactMode: this.#additionalProperties.compactMode ?? false,\n\t\t\t\tshowMap: this.#showMap,\n\t\t\t});\n\t\t}\n\n\t\tif (view)\n\t\t{\n\t\t\tview.layout()\n\t\t}\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.Fileman.UserField');\nnamespace.AddressField = AddressField;\n"],"names":["BaseView","constructor","params","wrapper","getWrapper","layout","Error","View","addresses","destroyWidgets","forEach","widget","destroy","Tag","render","address","Dom","append","getLayoutForAddress","factory","Factory","createAddressWidget","mode","ControlMode","view","popupOptions","offsetLeft","popupBindOptions","forceBindPosition","position","mapBehavior","useFeatures","fields","map","autocomplete","push","addressLayout","getFormattedAddress","mapBindElement","controlWrapper","format","Format","JSON","parse","BX","message","toString","AddressStringConverter","STRATEGY_TYPE_TEMPLATE_COMMA","EditEntry","EventEmitter","props","setEventNamespace","fieldName","fieldFormName","enableRemoveButton","initialAddressId","showMap","isCompactMode","edit","userInput","fieldsContainer","detailsToggle","Loc","getMessage","Event","bind","onDetailsToggleClick","inputValue","getInitialAddressFieldValue","fieldValueInput","inputIcon","onInputIconClick","subscribeOnAddressChangedEvent","onAddressChanged","subscribeOnStateChangedEvent","onWidgetStateChangedEvent","subscribeOnFeatureEvent","onFeatureEvent","entryWrapper","getUserInputSizeClass","hiddenFormattedInputValue","getRawValueForHiddenFormattedInput","hiddenFormattedAddressInput","manualEditFlagNode","getLayoutSizeClass","getRemoveInputButton","inputNode","removeInputButton","event","emit","onRemoveInputButtonClickedEvent","id","clean","input","emitFieldChangedEvent","remove","isDestroyed","parseInt","data","value","getChangedAddressFieldValue","state","State","DATA_LOADING","refreshInputIcon","feature","AutocompleteFeature","eventCode","searchStartedEvent","isInputLoading","removeClass","addClass","location","Text","encode","toJson","getFieldValue","AddressType","ADDRESS_LINE_2","latitude","longitude","focus","resetView","hasClass","innerText","onCustomEvent","window","Edit","isMultiple","compactMode","inputsWrapper","length","createInputForAddress","addInputElement","addInput","entry","subscribe","removeInput","activeInputsCount","filter","AddressField","init","document","getElementById","wrapperId","addressData","addressFields","Type","isObject","AddressEntity","addressFieldParams","fieldConfig","additionalProperties","addressField","VIEW_MODE","EDIT_MODE","namespace","Reflection"],"mappings":"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"}