{"version":3,"file":"address_widget.bundle.js","sources":["../src/view/baseview.js","../src/view/view.js","../src/view/editentry.js","../src/view/edit.js","../src/address_widget.js"],"sourcesContent":["export class BaseView\n{\n\t#wrapper: ?Element = null;\n\n\tconstructor(params: Object) {\n\t\tthis.#wrapper = params.wrapper;\n\t}\n\n\tgetWrapper(): Element\n\t{\n\t\treturn this.#wrapper;\n\t}\n\n\tlayout(): Element\n\t{\n\t\tthrow new Error('please implement the layout() method');\n\t}\n}\n","import 'ui.design-tokens';\nimport {Address as AddressWidget, Factory} from \"location.widget\";\nimport {Dom, Tag} from \"main.core\";\nimport {Address as AddressEntity, AddressStringConverter, ControlMode, Format} from \"location.core\";\nimport {BaseView} from './baseview';\nimport './css/style.css';\n\nexport class View extends BaseView\n{\n\t#addresses: AddressEntity[] = [];\n\n\t#widgets: AddressWidget[] = [];\n\n\tconstructor(params: Object)\n\t{\n\t\tsuper(params);\n\t\tthis.#addresses = params.addresses;\n\t}\n\n\tdestroyWidgets()\n\t{\n\t\tthis.#widgets.forEach((widget) => {\n\t\t\twidget.destroy();\n\t\t});\n\t}\n\n\tlayout(): Element\n\t{\n\t\tconst layout = Tag.render`<div></div>`;\n\n\t\tthis.#addresses.forEach((address) => {\n\t\t\tDom.append(this.getLayoutForAddress(address), layout);\n\t\t});\n\n\t\tDom.append(layout, this.getWrapper());\n\n\t\treturn this.getWrapper();\n\t}\n\n\tgetLayoutForAddress(address: AddressEntity)\n\t{\n\t\tconst factory = new Factory();\n\t\tconst widget = factory.createAddressWidget({\n\t\t\taddress: address,\n\t\t\tmode: ControlMode.view,\n\t\t\tpopupOptions: {\n\t\t\t\toffsetLeft: 14,\n\t\t\t},\n\t\t\tpopupBindOptions: {\n\t\t\t\tforceBindPosition: true,\n\t\t\t\tposition: 'right',\n\t\t\t},\n\t\t\tmapBehavior: 'auto',\n\t\t\tuseFeatures: {\n\t\t\t\tfields: false,\n\t\t\t\tmap: true,\n\t\t\t\tautocomplete: false,\n\t\t\t}\n\t\t});\n\n\t\tthis.#widgets.push(widget);\n\n\t\tconst addressLayout = Tag.render`\n\t\t\t<span class=\"fields address field-item view\">\n\t\t\t\t<span class=\"ui-link ui-link-dark ui-link-dotted\">${this.getFormattedAddress(address)}</span>\n\t\t\t</span>\n\t\t`;\n\n\t\twidget.render({\n\t\t\tmapBindElement: addressLayout,\n\t\t\tcontrolWrapper: addressLayout,\n\t\t});\n\n\t\treturn addressLayout;\n\t}\n\n\tgetFormattedAddress(address: AddressEntity): string\n\t{\n\t\tconst format = new Format(JSON.parse(BX.message('LOCATION_WIDGET_DEFAULT_FORMAT')));\n\t\treturn address.toString(format, AddressStringConverter.STRATEGY_TYPE_TEMPLATE_COMMA) ?? '';\n\t}\n}\n","import {Address as AddressWidget, AutocompleteFeature, Factory, State} from \"location.widget\";\nimport {Address as AddressEntity, AddressStringConverter, AddressType, ControlMode, Format} from \"location.core\";\nimport {Dom, Event, Tag, Loc, Text} from \"main.core\";\nimport type {EditEntryProps} from \"./editentryprops\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class EditEntry extends EventEmitter\n{\n\t#widget: AddressWidget;\n\t#nodes: { name: string, node: Element } = {};\n\t#wrapper: Element;\n\t#address: AddressEntity = null;\n\t#fieldName: string;\n\t#fieldFormName: string;\n\t#showMap: boolean = true;\n\t#enableRemoveButton: boolean = false;\n\t#isCompactMode: boolean = false;\n\t#initialAddressId: ?number = null;\n\t#areDetailsShown: boolean = false;\n\t#isLoading: boolean = false;\n\t#isDropdownLoading: boolean = false;\n\t#isDestroyed: boolean = false;\n\n\tstatic onRemoveInputButtonClickedEvent = 'onRemoveInputButtonClicked';\n\n\tconstructor(props: EditEntryProps)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('Fileman.EditEntry');\n\t\tthis.#wrapper = props.wrapper;\n\t\tthis.#fieldName = props.fieldName;\n\t\tthis.#fieldFormName = props.fieldFormName;\n\t\tthis.#enableRemoveButton = props.enableRemoveButton;\n\t\tthis.#initialAddressId = props.initialAddressId;\n\t\tthis.#showMap = props.showMap;\n\n\t\tif (props.address)\n\t\t{\n\t\t\tthis.#address = props.address;\n\t\t}\n\t\tif (props.isCompactMode)\n\t\t{\n\t\t\tthis.#isCompactMode = props.isCompactMode;\n\t\t}\n\t}\n\n\tlayout(): Element\n\t{\n\t\tconst factory = new Factory();\n\t\tthis.#widget = factory.createAddressWidget({\n\t\t\taddress: this.#address,\n\t\t\tmode: ControlMode.edit,\n\t\t\tpopupOptions: {\n\t\t\t\toffsetLeft: 14,\n\t\t\t},\n\t\t\tpopupBindOptions: {\n\t\t\t\tforceBindPosition: true,\n\t\t\t\tposition: 'right',\n\t\t\t},\n\t\t\tmapBehavior: 'auto',\n\t\t\tuseFeatures: {\n\t\t\t\tfields: true,\n\t\t\t\tmap: this.#showMap,\n\t\t\t\tautocomplete: true\n\t\t\t}\n\t\t});\n\n\t\tthis.#nodes.userInput = Tag.render`<input type=\"text\" class=\"ui-ctl-element\" />`;\n\n\t\tthis.#nodes.fieldsContainer = Tag.render`<div class=\"location-fields-control-block\"></div>`;\n\t\tthis.#nodes.detailsToggle = Tag.render`<span class=\"ui-link ui-link-secondary address-control-mode-switch\">${Loc.getMessage('ADDRESS_USERFIELD_DETAILS')}</span>`;\n\t\tEvent.bind(this.#nodes.detailsToggle, 'click', this.onDetailsToggleClick.bind(this));\n\n\t\tlet inputValue = this.getInitialAddressFieldValue();\n\t\tthis.#nodes.fieldValueInput = Tag.render`<input type=\"hidden\" name=\"${this.#fieldFormName}\" value=\"${inputValue}\" />`;\n\n\t\tthis.#nodes.inputIcon = Tag.render`<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\"></button>`;\n\t\tEvent.bind(this.#nodes.inputIcon, 'click', this.onInputIconClick.bind(this));\n\n\t\tthis.#widget.subscribeOnAddressChangedEvent(this.onAddressChanged.bind(this));\n\t\tthis.#widget.subscribeOnStateChangedEvent(this.onWidgetStateChangedEvent.bind(this));\n\t\tthis.#widget.subscribeOnFeatureEvent(this.onFeatureEvent.bind(this));\n\n\t\tthis.#nodes.entryWrapper = Tag.render`\n\t\t\t<div class=\"edit-entry-input-wrapper\">\n\t\t\t\t<div class=\"fields address field-item edit ui-ctl ui-ctl-after-icon ${this.getUserInputSizeClass()}\">\n\t\t\t\t\t${this.#nodes.userInput}\n\t\t\t\t\t${this.#nodes.fieldsContainer}\n\t\t\t\t\t${this.#nodes.inputIcon}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\t// a workaround for bizproc conditionals; their conditionals popup seems to use the topmost <input>'s value\n\t\tconst hiddenFormattedInputValue = this.#address ? this.getRawValueForHiddenFormattedInput(this.#address) : '';\n\t\tthis.#nodes.hiddenFormattedAddressInput = Tag.render`<input type=\"hidden\" name=\"${this.#fieldName}_formatted\" value=\"${hiddenFormattedInputValue}\" />`;\n\n\t\t// a flag used to identify values set manually by the user\n\t\tconst manualEditFlagNode = Tag.render`<input type=\"hidden\" name=\"${this.#fieldName}_manual_edit\" value=\"Y\">`;\n\n\t\tthis.#nodes.layout = Tag.render`\n\t\t\t<div class=\"edit-entry-layout-wrapper ${this.getLayoutSizeClass()}\">\n\t\t\t\t<div class=\"address-control-mode-switch-wrapper\">\n\t\t\t\t\t${this.#nodes.detailsToggle}\n\t\t\t\t</div>\n\t\t\t\t${this.#nodes.hiddenFormattedAddressInput}\n\t\t\t\t${this.#nodes.entryWrapper}\n\t\t\t\t${manualEditFlagNode}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.#enableRemoveButton)\n\t\t{\n\t\t\tDom.append(this.getRemoveInputButton(this.#nodes.layout), this.#nodes.entryWrapper);\n\t\t}\n\n\t\tDom.append(this.#nodes.fieldValueInput, this.#nodes.layout);\n\n\t\tthis.#widget.render({\n\t\t\tinputNode: this.#nodes.userInput,\n\t\t\tmapBindElement: this.#wrapper,\n\t\t\tcontrolWrapper: this.#nodes.layout,\n\t\t\tfieldsContainer: this.#nodes.fieldsContainer,\n\t\t});\n\n\t\treturn this.#nodes.layout;\n\t}\n\n\tgetUserInputSizeClass(): string\n\t{\n\t\treturn this.#isCompactMode ? 'ui-ctl-wd' : 'ui-ctl-w100';\n\t}\n\n\tgetLayoutSizeClass(): string\n\t{\n\t\treturn this.#isCompactMode ? 'compact' : '';\n\t}\n\n\tgetRemoveInputButton(layout: Element)\n\t{\n\t\tconst removeInputButton = Tag.render`\n\t\t\t<span class=\"uf-address-search-input-remove\"></span>\n\t\t`;\n\n\t\tEvent.bind(removeInputButton, 'click', (event) => {\n\t\t\tthis.emit(EditEntry.onRemoveInputButtonClickedEvent);\n\t\t});\n\n\t\treturn removeInputButton;\n\t}\n\n\tdestroy()\n\t{\n\t\tif (!this.#nodes.layout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#widget)\n\t\t{\n\t\t\tthis.#widget.destroy();\n\t\t}\n\n\t\tif (this.#address && this.#address.id > 0)\n\t\t{\n\t\t\tDom.clean(this.#nodes.layout);\n\t\t\tconst input = Tag.render`<input type=\"hidden\" name=\"${this.#fieldFormName}\" value=\"${this.#address.id}_del\" />`;\n\t\t\tDom.append(input, this.#nodes.layout);\n\t\t\tthis.emitFieldChangedEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.remove(this.#nodes.layout);\n\t\t}\n\n\t\tthis.#isDestroyed = true;\n\t}\n\n\tisDestroyed(): boolean\n\t{\n\t\treturn this.#isDestroyed;\n\t}\n\n\tonAddressChanged(event)\n\t{\n\t\tconst initialAddressId = parseInt(this.#initialAddressId);\n\t\t/** @type {AddressEntity} */\n\t\tconst address = event.data.address;\n\t\tif (!address)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// when we clear the input, the address' id becomes 0, and because of it a new address is created upon\n\t\t// saving. we can set the address's id to the old id to edit the old address instead\n\t\tif (initialAddressId && parseInt(address.id) !== initialAddressId)\n\t\t{\n\t\t\taddress.id = initialAddressId;\n\t\t}\n\n\t\tthis.#nodes.fieldValueInput.value = this.getChangedAddressFieldValue(address);\n\n\t\tthis.#nodes.hiddenFormattedAddressInput.value = this.getRawValueForHiddenFormattedInput(address);\n\n\t\tthis.emitFieldChangedEvent();\n\t}\n\n\tonWidgetStateChangedEvent(event)\n\t{\n\t\tconst state = event.data.state;\n\t\tthis.#isLoading = (state === State.DATA_LOADING);\n\n\t\tthis.refreshInputIcon();\n\t}\n\n\tonFeatureEvent(event)\n\t{\n\t\tif (event.data.feature instanceof AutocompleteFeature)\n\t\t{\n\t\t\tthis.#isDropdownLoading = (event.data.eventCode === AutocompleteFeature.searchStartedEvent);\n\n\t\t\tthis.refreshInputIcon();\n\t\t}\n\t}\n\n\tisInputLoading(): boolean\n\t{\n\t\treturn this.#isLoading || this.#isDropdownLoading;\n\t}\n\n\trefreshInputIcon()\n\t{\n\t\tif (!this.#nodes.inputIcon)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isInputLoading())\n\t\t{\n\t\t\tDom.removeClass(this.#nodes.inputIcon, 'ui-ctl-icon-clear');\n\t\t\tDom.addClass(this.#nodes.inputIcon, 'ui-ctl-icon-loader');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.#nodes.inputIcon, 'ui-ctl-icon-loader');\n\t\t\tDom.addClass(this.#nodes.inputIcon, 'ui-ctl-icon-clear');\n\t\t}\n\t}\n\n\tgetInitialAddressFieldValue(): string\n\t{\n\t\tlet inputValue =  '';\n\n\t\tif (this.#address?.id == 0)\n\t\t{\n\t\t\tif (this.#address.location)\n\t\t\t{\n\t\t\t\t// JSON has probably been passed as the component's value; we need to create a new address\n\t\t\t\tinputValue = Text.encode(this.#address.toJson());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// for compatibility with the format used before the switch to location module's addresses\n\t\t\t\tinputValue = `${this.#address.getFieldValue(AddressType.ADDRESS_LINE_2)}|${this.#address.latitude};${this.#address.longitude}`;\n\t\t\t}\n\t\t}\n\t\telse if (this.#address?.id > 0)\n\t\t{\n\t\t\tinputValue = `${this.getFormattedAddress(this.#address)}|${this.#address.latitude};${this.#address.longitude}|${this.#address.id}`;\n\t\t}\n\n\t\treturn inputValue;\n\t}\n\n\tgetChangedAddressFieldValue(address: AddressEntity): string\n\t{\n\t\treturn address.toJson();\n\t}\n\n\tgetFormattedAddress(address: AddressEntity): string\n\t{\n\t\tconst format = new Format(JSON.parse(BX.message('LOCATION_WIDGET_DEFAULT_FORMAT')));\n\t\treturn address.toString(format, AddressStringConverter.STRATEGY_TYPE_TEMPLATE_COMMA) ?? '';\n\t}\n\n\tgetRawValueForHiddenFormattedInput(address: AddressEntity): string\n\t{\n\t\tconst formattedAddress = this.getFormattedAddress(address);\n\t\tif (\n\t\t\t(parseInt(address.latitude) !== 0 || parseInt(address.longitude) !== 0)\n\t\t\t&& (address.latitude !== '' && address.longitude !== '')\n\t\t)\n\t\t{\n\t\t\treturn `${formattedAddress}|${address.latitude};${address.longitude}`;\n\t\t}\n\t\treturn formattedAddress;\n\t}\n\n\tonInputIconClick()\n\t{\n\t\tif (this.isInputLoading())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#nodes.userInput.focus();\n\n\t\tthis.#widget.resetView();\n\t\tthis.#widget.address = null;\n\n\t\tif (this.#address && this.#address.id > 0)\n\t\t{\n\t\t\tthis.#nodes.fieldValueInput.value = this.#address.id + '_del';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#nodes.fieldValueInput.value = '';\n\t\t}\n\n\t\tthis.emitFieldChangedEvent();\n\t}\n\n\tonDetailsToggleClick()\n\t{\n\t\tif (!this.#nodes.fieldsContainer || !this.#nodes.detailsToggle)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fieldsContainer = this.#nodes.fieldsContainer;\n\t\tconst detailsToggle = this.#nodes.detailsToggle;\n\t\tif (this.#areDetailsShown && Dom.hasClass(fieldsContainer, 'visible'))\n\t\t{\n\t\t\tDom.removeClass(fieldsContainer, 'visible');\n\t\t\tdetailsToggle.innerText = Loc.getMessage('ADDRESS_USERFIELD_DETAILS');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(fieldsContainer, 'visible');\n\t\t\tdetailsToggle.innerText = Loc.getMessage('ADDRESS_USERFIELD_NO_DETAILS');\n\t\t}\n\n\t\tthis.#areDetailsShown = !this.#areDetailsShown;\n\t}\n\n\temitFieldChangedEvent()\n\t{\n\t\tBX.onCustomEvent(window, 'onUIEntityEditorUserFieldExternalChanged', [this.#fieldName]);\n\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldExternalChanged', [this.#fieldName]);\n\t}\n}\n","import {Dom, Event, Tag, Loc} from \"main.core\";\nimport {Address as AddressEntity} from \"location.core\";\nimport {BaseView} from './baseview';\n\nimport './css/style.css';\nimport {EditEntry} from \"./editentry\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class Edit extends BaseView\n{\n\t#fieldName = '';\n\t#fieldFormName = '';\n\t#addresses: AddressEntity[] = [];\n\t#inputsWrapper: Element = null;\n\t#isMultiple = false;\n\t#isCompactMode = false;\n\t#showMap = true;\n\t#inputs: EditEntry[] = [];\n\n\tconstructor(params: Object)\n\t{\n\t\tsuper(params);\n\t\tthis.#fieldName = params.fieldName;\n\t\tthis.#fieldFormName = params.fieldFormName;\n\t\tthis.#addresses = params.addresses;\n\t\tthis.#isMultiple = params.isMultiple;\n\t\tthis.#isCompactMode = params.compactMode;\n\t\tthis.#showMap = params.showMap;\n\t}\n\n\tlayout(): Element\n\t{\n\t\tconst layout = Tag.render`<div class=\"address-edit-wrapper\"></div>`;\n\n\t\tconst inputsWrapper = Tag.render`<div class=\"address-inputs-wrapper\"></div>`;\n\n\t\tif (this.#addresses.length > 0)\n\t\t{\n\t\t\tthis.#addresses.forEach((address) => {\n\t\t\t\tconst input = this.createInputForAddress(address);\n\t\t\t\tDom.append(input.layout(), inputsWrapper);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst input = this.createInputForAddress();\n\t\t\tDom.append(input.layout(), inputsWrapper);\n\t\t}\n\n\t\tDom.append(inputsWrapper, layout);\n\t\tthis.#inputsWrapper = inputsWrapper;\n\n\t\tif (this.#isMultiple)\n\t\t{\n\t\t\tconst addInputElement = Tag.render`<input type=\"button\" value=\"${Loc.getMessage('ADDRESS_USERFIELD_ADD_INPUT')}\" />`;\n\t\t\tEvent.bind(addInputElement, 'click', this.addInput.bind(this));\n\t\t\tDom.append(addInputElement, layout);\n\t\t}\n\n\t\tDom.append(layout, this.getWrapper());\n\n\t\treturn this.getWrapper();\n\t}\n\n\taddInput()\n\t{\n\t\tif (!this.#inputsWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst input = this.createInputForAddress();\n\t\tDom.append(input.layout(), this.#inputsWrapper);\n\t}\n\n\tcreateInputForAddress(address: AddressEntity): EditEntry\n\t{\n\t\tconst entry = new EditEntry({\n\t\t\twrapper: this.getWrapper(),\n\t\t\taddress: address,\n\t\t\tfieldName: this.#fieldName,\n\t\t\tfieldFormName: this.#fieldFormName,\n\t\t\tenableRemoveButton: this.#isMultiple,\n\t\t\tinitialAddressId: parseInt(address?.id) ?? null,\n\t\t\tisCompactMode: this.#isCompactMode,\n\t\t\tshowMap: this.#showMap,\n\t\t});\n\t\tEventEmitter.subscribe(entry, EditEntry.onRemoveInputButtonClickedEvent, this.removeInput.bind(this, entry));\n\t\tthis.#inputs.push(entry);\n\n\t\treturn entry;\n\t}\n\n\tremoveInput(input: EditEntry)\n\t{\n\t\tconst activeInputsCount = this.#inputs.filter((input) => {return !input.isDestroyed()}).length;\n\n\t\tif (activeInputsCount > 1)\n\t\t{\n\t\t\tinput.destroy();\n\t\t}\n\t}\n}\n","import {Reflection, Type} from \"main.core\";\nimport {Address as AddressEntity} from \"location.core\";\n\nimport {View} from './view/view';\nimport {Edit} from './view/edit';\n\nclass AddressField\n{\n\tstatic VIEW_MODE = 'view';\n\tstatic EDIT_MODE = 'edit';\n\n\t#mode = AddressField.VIEW_MODE;\n\t#wrapper: Element;\n\t#addresses: [];\n\t#isMultiple: boolean = false;\n\t#showMap: boolean = true;\n\n\t#fieldConfig = {};\n\t#additionalProperties = {};\n\n\tstatic init(params: Object)\n\t{\n\t\tconst mode = params.mode;\n\t\tconst wrapper = document.getElementById(params.wrapperId);\n\t\tif (!wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet addresses = [];\n\t\tconst addressData = params.addressData;\n\t\taddressData.forEach((addressFields) => {\n\t\t\tif (Type.isObject(addressFields))\n\t\t\t{\n\t\t\t\taddresses.push(new AddressEntity(addressFields));\n\t\t\t}\n\t\t});\n\n\t\tconst showMap = params.showMap ?? true;\n\t\tlet addressFieldParams = {\n\t\t\taddresses: addresses,\n\t\t\twrapper: wrapper,\n\t\t\tmode: mode,\n\t\t\tfieldConfig: {\n\t\t\t\tfieldName: params.fieldName,\n\t\t\t\tfieldFormName: params.fieldFormName,\n\t\t\t},\n\t\t\tisMultiple: params.isMultiple,\n\t\t\tshowMap,\n\t\t};\n\n\t\tif (params.additionalProperties)\n\t\t{\n\t\t\taddressFieldParams.additionalProperties = params.additionalProperties;\n\t\t}\n\n\t\tconst addressField = new AddressField(addressFieldParams);\n\t\taddressField.layout();\n\t}\n\n\tconstructor(params: Object)\n\t{\n\t\tthis.#mode = params.mode;\n\t\tthis.#wrapper = params.wrapper;\n\t\tthis.#addresses = params.addresses;\n\t\tthis.#fieldConfig = params.fieldConfig;\n\t\tthis.#isMultiple = params.isMultiple;\n\t\tthis.#showMap = params.showMap;\n\t\tif (params.additionalProperties)\n\t\t{\n\t\t\tthis.#additionalProperties = params.additionalProperties;\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\t/** @type BaseView */\n\t\tlet view = null;\n\n\t\tif (this.#mode === AddressField.VIEW_MODE)\n\t\t{\n\t\t\tview = new View({\n\t\t\t\twrapper: this.#wrapper,\n\t\t\t\taddresses: this.#addresses,\n\t\t\t});\n\t\t}\n\n\t\tif (this.#mode === AddressField.EDIT_MODE)\n\t\t{\n\t\t\tview = new Edit({\n\t\t\t\twrapper: this.#wrapper,\n\t\t\t\tfieldName: this.#fieldConfig.fieldName,\n\t\t\t\tfieldFormName: this.#fieldConfig.fieldFormName,\n\t\t\t\taddresses: this.#addresses,\n\t\t\t\tisMultiple: this.#isMultiple,\n\t\t\t\tcompactMode: this.#additionalProperties.compactMode ?? false,\n\t\t\t\tshowMap: this.#showMap,\n\t\t\t});\n\t\t}\n\n\t\tif (view)\n\t\t{\n\t\t\tview.layout()\n\t\t}\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.Fileman.UserField');\nnamespace.AddressField = AddressField;\n"],"names":["BaseView","constructor","params","wrapper","getWrapper","layout","Error","View","addresses","destroyWidgets","forEach","widget","destroy","Tag","render","address","Dom","append","getLayoutForAddress","factory","Factory","createAddressWidget","mode","ControlMode","view","popupOptions","offsetLeft","popupBindOptions","forceBindPosition","position","mapBehavior","useFeatures","fields","map","autocomplete","push","addressLayout","getFormattedAddress","mapBindElement","controlWrapper","format","Format","JSON","parse","BX","message","toString","AddressStringConverter","STRATEGY_TYPE_TEMPLATE_COMMA","EditEntry","EventEmitter","props","setEventNamespace","fieldName","fieldFormName","enableRemoveButton","initialAddressId","showMap","isCompactMode","edit","userInput","fieldsContainer","detailsToggle","Loc","getMessage","Event","bind","onDetailsToggleClick","inputValue","getInitialAddressFieldValue","fieldValueInput","inputIcon","onInputIconClick","subscribeOnAddressChangedEvent","onAddressChanged","subscribeOnStateChangedEvent","onWidgetStateChangedEvent","subscribeOnFeatureEvent","onFeatureEvent","entryWrapper","getUserInputSizeClass","hiddenFormattedInputValue","getRawValueForHiddenFormattedInput","hiddenFormattedAddressInput","manualEditFlagNode","getLayoutSizeClass","getRemoveInputButton","inputNode","removeInputButton","event","emit","onRemoveInputButtonClickedEvent","id","clean","input","emitFieldChangedEvent","remove","isDestroyed","parseInt","data","value","getChangedAddressFieldValue","state","State","DATA_LOADING","refreshInputIcon","feature","AutocompleteFeature","eventCode","searchStartedEvent","isInputLoading","removeClass","addClass","location","Text","encode","toJson","getFieldValue","AddressType","ADDRESS_LINE_2","latitude","longitude","formattedAddress","focus","resetView","hasClass","innerText","onCustomEvent","window","Edit","isMultiple","compactMode","inputsWrapper","length","createInputForAddress","addInputElement","addInput","entry","subscribe","removeInput","activeInputsCount","filter","AddressField","init","document","getElementById","wrapperId","addressData","addressFields","Type","isObject","AddressEntity","addressFieldParams","fieldConfig","additionalProperties","addressField","VIEW_MODE","EDIT_MODE","namespace","Reflection"],"mappings":"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"}