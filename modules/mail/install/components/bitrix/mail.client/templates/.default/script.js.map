{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { MessageGrid } from 'mail.messagegrid';\n\n;(function() {\n\n\tif (window.BXMailMessageController)\n\t\treturn;\n\n\tvar BXMailMessageController = {};\n\n\tBXMailMessageController.init = function (options)\n\t{\n\t\tif (this.__inited)\n\t\t\treturn;\n\n\t\tthis.options = options;\n\n\t\tthis.__dummyNode = document.createElement('DIV');\n\n\t\tif ('edit' != this.options.type)\n\t\t{\n\t\t\tif (this.options.pageSize < 1 || this.options.pageSize > 100)\n\t\t\t\tthis.options.pageSize = 5;\n\n\t\t\tthis.__log = {'a': 0, 'b': 0};\n\n\t\t\tvar details = BX('mail-msg-view-details-'+this.options.messageId);\n\n\t\t\tvar moreA = BX.findChildByClassName(details.parentNode, 'mail-msg-view-log-more-a', true);\n\t\t\tBX.bind(moreA, 'click', this.handleLogClick.bind(this, 'a'));\n\n\t\t\tvar moreB = BX.findChildByClassName(details.parentNode, 'mail-msg-view-log-more-b', true);\n\t\t\tBX.bind(moreB, 'click', this.handleLogClick.bind(this, 'b'));\n\n\t\t\tvar items = BX.findChildrenByClassName(details.parentNode, 'mail-msg-view-log-item', true);\n\t\t\tfor (var i in items)\n\t\t\t{\n\t\t\t\tvar log = items[i].getAttribute('data-log').toLowerCase();\n\t\t\t\tif (typeof this.__log[log] != 'undefined')\n\t\t\t\t\tthis.__log[log]++;\n\n\t\t\t\tBX.bind(items[i], 'click', this.handleLogItemClick.bind(this, items[i].getAttribute('data-id')));\n\t\t\t}\n\n\t\t\tBX.Event.EventEmitter.subscribe(\n\t\t\t\t'BXMailMessageActions:CRM_ACTIVITY',\n\t\t\t\tfunction (event)\n\t\t\t\t{\n\t\t\t\t\tBX.show(\n\t\t\t\t\t\tBX.findChildByClassName(\n\t\t\t\t\t\t\tBX('mail-msg-view-details-' + event.getData().messageId),\n\t\t\t\t\t\t\t'js-msg-view-control-skip',\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tBX.Event.EventEmitter.subscribe(\n\t\t\t\t'BXMailMessageActions:CRM_EXCLUDE',\n\t\t\t\tfunction (event)\n\t\t\t\t{\n\t\t\t\t\tBX.hide(\n\t\t\t\t\t\tBX.findChildByClassName(\n\t\t\t\t\t\t\tBX('mail-msg-view-details-' + event.getData().messageId),\n\t\t\t\t\t\t\t'js-msg-view-control-skip',\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.__inited = true;\n\t};\n\n\tBXMailMessageController.initScrollable = function()\n\t{\n\t\tif (!this.__scrollable)\n\t\t{\n\t\t\tif (document.scrollingElement)\n\t\t\t\tthis.__scrollable = document.scrollingElement;\n\t\t}\n\n\t\tif (!this.__scrollable)\n\t\t{\n\t\t\tif (document.documentElement.scrollTop > 0 || document.documentElement.scrollLeft > 0)\n\t\t\t\tthis.__scrollable = document.documentElement;\n\t\t\telse if (document.body.scrollTop > 0 || document.body.scrollLeft > 0)\n\t\t\t\tthis.__scrollable = document.body;\n\t\t}\n\n\t\tif (!this.__scrollable)\n\t\t{\n\t\t\twindow.scrollBy(1, 1);\n\n\t\t\tif (document.documentElement.scrollTop > 0 || document.documentElement.scrollLeft > 0)\n\t\t\t\tthis.__scrollable = document.documentElement;\n\t\t\telse if (document.body.scrollTop > 0 || document.body.scrollLeft > 0)\n\t\t\t\tthis.__scrollable = document.body;\n\n\t\t\twindow.scrollBy(-1, -1);\n\t\t}\n\n\t\treturn this.__scrollable;\n\t}\n\n\tBXMailMessageController.scrollWrapper = function (pos)\n\t{\n\t\tvar ctrl = this;\n\n\t\tif (!this.initScrollable())\n\t\t\treturn;\n\n\t\tif (this.__scrollable.__animation)\n\t\t{\n\t\t\tclearInterval(this.__scrollable.__animation);\n\t\t\tthis.__scrollable.__animation = null;\n\t\t}\n\n\t\tvar start = this.__scrollable.scrollTop;\n\t\tvar delta = pos - start;\n\t\tvar step = 0;\n\t\tthis.__scrollable.__animation = setInterval(function()\n\t\t{\n\t\t\tstep++;\n\t\t\tctrl.__scrollable.scrollTop = start + delta * step/8;\n\n\t\t\tif (step >= 8)\n\t\t\t{\n\t\t\t\tclearInterval(ctrl.__scrollable.__animation);\n\t\t\t\tctrl.__scrollable.__animation = null;\n\t\t\t}\n\t\t}, 20);\n\t};\n\n\tBXMailMessageController.scrollTo = function (node1, node2)\n\t{\n\t\tif (!this.initScrollable())\n\t\t\treturn;\n\n\t\tvar pos0 = BX.pos(this.__scrollable);\n\n\t\tpos0.top    += this.__scrollable.scrollTop;\n\t\tpos0.bottom += this.__scrollable.scrollTop;\n\n\t\tvar pos1 = BX.pos(node1);\n\t\tvar pos2 = typeof node2 == 'undefined' || node2 === node1 ? pos1 : BX.pos(node2);\n\n\t\tif (pos1.top < pos0.top)\n\t\t{\n\t\t\tthis.scrollWrapper(this.__scrollable.scrollTop - (pos0.top - pos1.top));\n\t\t}\n\t\telse if (pos2.bottom > pos0.bottom)\n\t\t{\n\t\t\tthis.scrollWrapper(Math.min(\n\t\t\t\tthis.__scrollable.scrollTop - (pos0.top - pos1.top),\n\t\t\t\tthis.__scrollable.scrollTop + (pos2.bottom - pos0.bottom)\n\t\t\t));\n\t\t}\n\t};\n\n\tBXMailMessageController.handleLogClick = function (log, event)\n\t{\n\t\tBX.PreventDefault(event);\n\n\t\tvar button = BX.findChildByClassName(\n\t\t\tBX('mail-msg-view-details-'+this.options.messageId).parentNode,\n\t\t\t'mail-msg-view-log-more-'+log,\n\t\t\ttrue\n\t\t);\n\t\tthis.loadLog(log, button);\n\t};\n\n\tBXMailMessageController.loadLog = function (log, button)\n\t{\n\t\tvar ctrl = this;\n\n\t\tvar separator = button.parentNode;\n\n\t\tif (this['__loadingLog'+log])\n\t\t\treturn;\n\n\t\tthis['__loadingLog'+log] = true;\n\n\t\tvar data = {\n\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\taction: 'log',\n\t\t\tid: this.options.messageId,\n\t\t\tlog: log + this.__log[log],\n\t\t\tsize: this.options.pageSize\n\t\t};\n\n\t\tif (this.options.mail_uf_message_token)\n\t\t{\n\t\t\tdata.mail_uf_message_token = this.options.mail_uf_message_token;\n\t\t}\n\n\t\tBX.ajax({\n\t\t\tmethod: 'POST',\n\t\t\turl: BX.util.add_url_param(this.options.ajaxUrl, {'action': 'log'}),\n\t\t\tdata: data,\n\t\t\tdataType: 'json',\n\t\t\tonsuccess: function(json)\n\t\t\t{\n\t\t\t\tctrl['__loadingLog'+log] = false;\n\n\t\t\t\tif (json.status == 'success')\n\t\t\t\t{\n\t\t\t\t\tctrl.__dummyNode.innerHTML = json.data.html;\n\n\t\t\t\t\tvar marker = log == 'a' ? BX.findNextSibling(separator, {'tag': 'div'}) : separator;\n\t\t\t\t\twhile (ctrl.__dummyNode.childNodes.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar item = separator.parentNode.insertBefore(ctrl.__dummyNode.childNodes[0], marker);\n\t\t\t\t\t\tif (item.nodeType == 1 && BX.hasClass(item, 'mail-msg-view-log-item'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tctrl.__log[log]++;\n\n\t\t\t\t\t\t\tBX.addClass(item, 'mail-msg-show-animation-rev');\n\t\t\t\t\t\t\tBX.bind(item, 'click', ctrl.handleLogItemClick.bind(ctrl, item.getAttribute('data-id')));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (json.data.count < ctrl.options.pageSize)\n\t\t\t\t\t\tseparator.style.display = 'none';\n\n\t\t\t\t\tif (log == 'b' && ctrl.initScrollable())\n\t\t\t\t\t{\n\t\t\t\t\t\tctrl.scrollWrapper(ctrl.__scrollable.scrollHeight);\n\t\t\t\t\t}\n\n\t\t\t\t\tctrl.__dummyNode.innerHTML = '';\n\t\t\t\t}\n\t\t\t},\n\t\t\tonfailure: function()\n\t\t\t{\n\t\t\t\tctrl['__loadingLog'+log] = false;\n\t\t\t}\n\t\t});\n\t};\n\n\tBXMailMessageController.handleLogItemClick = function (messageId, event)\n\t{\n\t\tevent = event || window.event;\n\t\tif (event.target && event.target.tagName && event.target.tagName.toUpperCase() == 'A')\n\t\t\treturn;\n\n\t\tif (window.getSelection)\n\t\t{\n\t\t\tif (window.getSelection().toString().trim() != '')\n\t\t\t\treturn;\n\t\t}\n\t\telse if (document.selection)\n\t\t{\n\t\t\tif (document.selection.createRange().htmlText.trim() != '')\n\t\t\t\treturn;\n\t\t}\n\n\t\tBX.PreventDefault(event);\n\n\t\tthis.toggleLogItem(messageId);\n\t};\n\n\tBXMailMessageController.toggleLogItem = function (messageId)\n\t{\n\t\tvar ctrl = this;\n\n\t\tvar wrapper = BX('mail-msg-view-details-'+this.options.messageId).parentNode;\n\n\t\tvar logItem = BX.findChildByClassName(wrapper, 'mail-msg-view-logitem-'+messageId, false);\n\t\tvar details = BX.findChildByClassName(wrapper, 'mail-msg-view-details-'+messageId, false);\n\n\t\tvar opened  = BX.hasClass(logItem, 'mail-msg-view-item-open');\n\n\t\tBX.removeClass(logItem, 'mail-msg-show-animation-rev');\n\t\tBX.toggleClass(logItem, 'mail-msg-view-item-open');\n\n\t\tif (opened)\n\t\t{\n\t\t\tdetails.style.display = 'none';\n\n\t\t\tBX.addClass(logItem, 'mail-msg-show-animation-rev');\n\t\t\tlogItem.style.display = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(details, 'mail-msg-show-animation-rev');\n\t\t\tBX.addClass(details, 'mail-msg-show-animation');\n\t\t\tdetails.style.display = '';\n\n\t\t\tif (details.getAttribute('data-empty'))\n\t\t\t{\n\t\t\t\tvar data = {\n\t\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\t\taction: 'logitem',\n\t\t\t\t\tid: messageId\n\t\t\t\t};\n\n\t\t\t\tif (this.options.mail_uf_message_token)\n\t\t\t\t{\n\t\t\t\t\tdata.mail_uf_message_token = this.options.mail_uf_message_token;\n\t\t\t\t}\n\n\t\t\t\tBX.ajax({\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\turl: BX.util.add_url_param(this.options.ajaxUrl, {'action': 'logitem'}),\n\t\t\t\t\tdata: data,\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tonsuccess: function (json)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (json.status != 'success')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tjson.errors = json.errors.map(\n\t\t\t\t\t\t\t\tfunction (item)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn item.message;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdetails.innerHTML = '<div class=\"mail-msg-view-log-item-error mail-msg-view-border-bottom\">'\n\t\t\t\t\t\t\t\t+ json.errors.join('<br>')\n\t\t\t\t\t\t\t\t+ '</div>';\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar response = BX.processHTML(json.data);\n\n\t\t\t\t\t\tBX.removeClass(details, 'mail-msg-show-animation');\n\t\t\t\t\t\tBX.removeClass(details, 'mail-msg-show-animation-rev');\n\t\t\t\t\t\tsetTimeout(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdetails.style.textAlign = '';\n\t\t\t\t\t\t\tdetails.innerHTML = response.HTML;\n\n\t\t\t\t\t\t\tif (details.offsetHeight > 0)\n\t\t\t\t\t\t\t\tlogItem.style.display = 'none';\n\n\t\t\t\t\t\t\tBX.ajax.processScripts(response.SCRIPT);\n\n\t\t\t\t\t\t\tBX.addClass(details, 'mail-msg-show-animation-rev');\n\n\t\t\t\t\t\t\tvar button = BX.findChildByClassName(details, 'mail-msg-view-header', true);\n\t\t\t\t\t\t\tBX.bind(button, 'click', ctrl.handleLogItemClick.bind(ctrl, messageId));\n\n\t\t\t\t\t\t\tctrl.scrollTo(details);\n\t\t\t\t\t\t}, 10);\n\n\t\t\t\t\t\tdetails.removeAttribute('data-empty');\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.scrollTo(logItem, details);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlogItem.style.display = 'none';\n\n\t\t\t\tthis.scrollTo(details);\n\t\t\t}\n\t\t}\n\t};\n\n\tBXMailMessageController.removeLogItem = function (messageId)\n\t{\n\t\tvar wrapper = BX('mail-msg-view-details-'+this.options.messageId).parentNode;\n\n\t\tvar logItem = BX.findChildByClassName(wrapper, 'mail-msg-view-logitem-'+messageId, false);\n\t\tvar details = BX.findChildByClassName(wrapper, 'mail-msg-view-details-'+messageId, false);\n\n\t\tvar log = logItem.getAttribute('data-log').toLowerCase();\n\t\tif (typeof this.__log[log] != 'undefined')\n\t\t\tthis.__log[log]--;\n\n\t\tsetTimeout(function()\n\t\t{\n\t\t\twrapper.removeChild(details);\n\t\t\twrapper.removeChild(logItem);\n\t\t}, 200);\n\n\t\tdetails.style.maxHeight = (details.offsetHeight*1.5)+'px';\n\t\tdetails.style.transition = 'max-height .2s ease-in';\n\t\tdetails.offsetHeight;\n\t\tdetails.style.maxHeight = '0px';\n\n\t\tBX.removeClass(details, 'mail-msg-show-animation');\n\t\tBX.removeClass(details, 'mail-msg-show-animation-rev');\n\t\tBX.addClass(details, 'mail-msg-close-animation');\n\t};\n\n\tBXMailMessageController.close = function (destroy)\n\t{\n\t\tvar slider = top.BX.SidePanel.Instance.getSliderByWindow(window);\n\t\tif (slider)\n\t\t{\n\t\t\tslider.setCacheable(!destroy);\n\t\t\tslider.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location.href = BX.util.add_url_param(\n\t\t\t\tthis.options.pathList,\n\t\t\t\t{ 'strict': 'N' }\n\t\t\t);\n\t\t}\n\t};\n\n\tvar BXMailMessage = function (options)\n\t{\n\t\tvar self = this;\n\n\t\tthis.ctrl = BXMailMessageController;\n\t\tthis.options = options;\n\n\t\tthis.__dummyNode = document.createElement('DIV');\n\n\t\tthis.htmlForm = BX(this.options.formId);\n\t\tthis.htmlForm.__wrapper = this.htmlForm.parentNode;\n\n\t\tif (this.htmlForm.__inited)\n\t\t\treturn;\n\n\t\tif ('edit' != this.ctrl.options.type)\n\t\t{\n\t\t\tthis.__wrapper = BX('mail-msg-view-details-'+this.ctrl.options.messageId);\n\t\t\tif (this.options.messageId != this.ctrl.options.messageId)\n\t\t\t\tthis.__wrapper = BX.findChildByClassName(this.__wrapper.parentNode, 'mail-msg-view-details-'+this.options.messageId, false);\n\n\t\t\tBX.addCustomEvent(\n\t\t\t\t'MailMessage:replyButtonClick',\n\t\t\t\tfunction (source)\n\t\t\t\t{\n\t\t\t\t\tif (source !== self)\n\t\t\t\t\t\tself.hideReplyForm();\n\t\t\t\t}\n\t\t\t);\n\t\t\ttop.BX.SidePanel.Instance.postMessage(\n\t\t\t\twindow,\n\t\t\t\t'mail-message-view',\n\t\t\t\t{\n\t\t\t\t\tid: this.options.messageId\n\t\t\t\t}\n\t\t\t);\n\t\t\tvar emailContainerId = 'mail_msg_'+this.options.messageId+'_body';\n\n\t\t\t// target links\n\t\t\tvar emailLinks = typeof document.querySelectorAll != 'undefined'\n\t\t\t\t? document.querySelectorAll('#'+emailContainerId+' a')\n\t\t\t\t: BX.findChildren(BX(emailContainerId), {tag: 'a'}, true);\n\t\t\tfor (var i in emailLinks)\n\t\t\t{\n\t\t\t\tif (!emailLinks.hasOwnProperty(i))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (emailLinks[i] && emailLinks[i].setAttribute)\n\t\t\t\t\temailLinks[i].setAttribute('target', '_blank');\n\t\t\t}\n\n\t\t\t// unfold quotes\n\t\t\tvar quotesList = typeof document.querySelectorAll != 'undefined'\n\t\t\t\t? document.querySelectorAll('#'+emailContainerId+' blockquote')\n\t\t\t\t: BX.findChildren(BX(emailContainerId), {tag: 'blockquote'}, true);\n\t\t\tfor (var i in quotesList)\n\t\t\t{\n\t\t\t\tif (!quotesList.hasOwnProperty(i))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tBX.bind(quotesList[i], 'click', function ()\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this, 'mail-msg-view-quote-unfolded');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// show hidden rcpt items\n\t\t\tvar rcptMore = BX.findChildrenByClassName(this.__wrapper, 'mail-msg-view-rcpt-more');\n\t\t\tfor (var i in rcptMore)\n\t\t\t{\n\t\t\t\tBX.bind(rcptMore[i], 'click', function (event)\n\t\t\t\t{\n\t\t\t\t\tBX.findChildByClassName(this.parentNode, 'mail-msg-view-rcpt-list-hidden', false).style.display = 'inline';\n\t\t\t\t\tthis.style.display = 'none';\n\n\t\t\t\t\tBX.PreventDefault(event);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar replyButton  = BX.findChildByClassName(this.__wrapper, 'js-msg-view-reply-panel', true);\n\t\t\tvar replyLink    = BX.findChildByClassName(this.__wrapper, 'js-msg-view-control-reply', true);\n\t\t\tvar replyAllLink = BX.findChildByClassName(this.__wrapper, 'js-msg-view-control-replyall', true);\n\t\t\tvar forwardLink  = BX.findChildByClassName(this.__wrapper, 'js-msg-view-control-forward', true);\n\t\t\tvar skipLink     = BX.findChildByClassName(this.__wrapper, 'js-msg-view-control-skip', true);\n\t\t\tvar spamLink     = BX.findChildByClassName(this.__wrapper, 'js-msg-view-control-spam', true);\n\t\t\tvar deleteLink   = BX.findChildByClassName(this.__wrapper, 'js-msg-view-control-delete', true);\n\n\t\t\tBX.bind(replyButton, 'click', this.showReplyForm.bind(this));\n\t\t\tBX.bind(replyAllLink, 'click', this.showReplyForm.bind(this));\n\t\t\tBX.bind(replyLink, 'click', this.showReplyForm.bind(this, true));\n\n\t\t\tBX.bind(forwardLink, 'click', function ()\n\t\t\t{\n\t\t\t\tvar params = {\n\t\t\t\t\tforward: self.options.messageId\n\t\t\t\t};\n\t\t\t\tif (self.ctrl.options.mail_uf_message_token)\n\t\t\t\t{\n\t\t\t\t\tparams.mail_uf_message_token = self.ctrl.options.mail_uf_message_token;\n\t\t\t\t}\n\n\t\t\t\twindow.location.href = BX.util.add_url_param(self.ctrl.options.pathNew, params);\n\t\t\t});\n\n\t\t\tBX.bind(\n\t\t\t\tskipLink,\n\t\t\t\t'click',\n\t\t\t\tfunction (event)\n\t\t\t\t{\n\t\t\t\t\tBXMailMessageActions && BXMailMessageActions.createAction(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmessageId: self.options.messageId,\n\t\t\t\t\t\t\tvalue: 'CRM_EXCLUDE',\n\t\t\t\t\t\t\tdisable: BX.addClass.bind(BX, skipLink, 'mail-msg-view-control-disabled'),\n\t\t\t\t\t\t\tenable: BX.removeClass.bind(BX, skipLink, 'mail-msg-view-control-disabled')\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tvar uidKeyData = document.querySelector('[data-uid-key]');\n\t\t\tvar uid = 0;\n\t\t\tif (uidKeyData)\n\t\t\t{\n\t\t\t\tuid = uidKeyData.dataset.uidKey;\n\t\t\t}\n\t\t\tBX.bind(spamLink, 'click', this.markAsSpam.bind(this, spamLink, uid));\n\t\t\tBX.bind(deleteLink, 'click', this.delete.bind(this, deleteLink, uid));\n\t\t}\n\n\t\tvar mailForm = BXMainMailForm.getForm(this.options.formId);\n\n\t\tBX.addCustomEvent(mailForm, 'MailForm:footer:buttonClick', BXMailMessage.handleFooterButtonClick.bind(this));\n\t\tBX.addCustomEvent(mailForm, 'MailForm:submit', BXMailMessage.handleFormSubmit.bind(this));\n\t\tBX.addCustomEvent(mailForm, 'MailForm:submit:ajaxSuccess', BXMailMessage.handleFormSubmitSuccess.bind(this));\n\t\tBX.PULL && BX.PULL.extendWatch('mail_mailbox_' + this.options.messageId);\n\t\tBX.addCustomEvent(\"onPullEvent-mail\", BX.proxy(function(command, params)\n\t\t{\n\t\t\t//outgoing message read confirmed handler\n\t\t\tif (command !== 'onMessageRead')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar wrapper = BX('mail-msg-view-details-' + params.messageId);\n\t\t\tif(!wrapper)\n\t\t\t{\n\t\t\t\twrapper = BX.findChildByClassName(document, 'mail-msg-view-logitem-' + params.messageId, true);\n\t\t\t}\n\t\t\tif(!wrapper)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar items = BX.findChildrenByClassName(wrapper, 'read-confirmed-datetime', true);\n\t\t\tif (items && items.length > 0)\n\t\t\t{\n\t\t\t\tfor (var i in items)\n\t\t\t\t\tBX.adjust(items[i], {text: BX.message('MAIL_MESSAGE_READ_CONFIRMED_SHORT')});\n\t\t\t}\n\t\t}, this));\n\n\t\tthis.htmlForm.__inited = true;\n\t};\n\n\tBXMailMessage.handleFooterButtonClick = function (form, button)\n\t{\n\t\tif (BX.hasClass(button, 'main-mail-form-cancel-button'))\n\t\t{\n\t\t\tif ('edit' == this.ctrl.options.type)\n\t\t\t{\n\t\t\t\tthis.ctrl.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideReplyForm();\n\t\t\t}\n\t\t}\n\t};\n\n\tBXMailMessage.handleFormSubmit = function (form, event)\n\t{\n\t\tvar fields = this.htmlForm.elements;\n\t\tvar emptyRcpt = true;\n\t\tfor (var i = 0; i < fields.length; i++)\n\t\t{\n\t\t\tif ('data[to][]' == fields[i].name && fields[i].value.length > 0)\n\t\t\t\temptyRcpt = false;\n\t\t}\n\t\tif (emptyRcpt)\n\t\t{\n\t\t\t// @TODO: hide on select\n\t\t\tform.showError(BX.message('MAIL_MESSAGE_NEW_EMPTY_RCPT'));\n\t\t\treturn BX.PreventDefault(event);\n\t\t}\n\n\t\t// @TODO: use events\n\t\tvar uploads, items, totalSize = 0;\n\t\tfor (var i in form.postForm.controllers)\n\t\t{\n\t\t\tif (!form.postForm.controllers.hasOwnProperty(i))\n\t\t\t\tcontinue;\n\n\t\t\tif (form.postForm.controllers[i].storage != 'disk')\n\t\t\t\tcontinue;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tuploads = 0;\n\t\t\t\tuploads = form.postForm.controllers[i].handler.agent.upload.filesCount;\n\t\t\t}\n\t\t\tcatch (err) {}\n\n\t\t\tif (uploads > 0)\n\t\t\t{\n\t\t\t\t// @TODO: hide on complete\n\t\t\t\tform.showError(BX.message('MAIL_MESSAGE_NEW_UPLOADING'));\n\t\t\t\treturn BX.PreventDefault(event);\n\t\t\t}\n\n\t\t\tif (BX.message('MAIL_MESSAGE_MAX_SIZE') > 0)\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\titems = form.postForm.controllers[i].handler.agent.queue.items.items;\n\t\t\t\t\ttotalSize = Object.keys(items).reduce(\n\t\t\t\t\t\tfunction (sum, k)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn sum + (items[k].file ? parseInt(items[k].file.sizeInt || items[k].file.size) : 0);\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttotalSize\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tcatch (err) {}\n\t\t\t}\n\t\t}\n\n\t\tif (BX.message('MAIL_MESSAGE_MAX_SIZE') > 0 && BX.message('MAIL_MESSAGE_MAX_SIZE') <= Math.ceil(totalSize / 3) * 4) // base64 coef.\n\t\t{\n\t\t\tform.showError(BX.message('MAIL_MESSAGE_MAX_SIZE_EXCEED'));\n\t\t\treturn BX.PreventDefault(event);\n\t\t}\n\t};\n\n\tBXMailMessage.handleFormSubmitSuccess = function (form, data)\n\t{\n\t\tif (data.status != 'success')\n\t\t{\n\t\t\tvar errorNode = document.createElement('DIV');\n\n\t\t\tif (!data.errors || !BX.type.isArray(data.errors))\n\t\t\t{\n\t\t\t\tdata.errors = [{\n\t\t\t\t\tmessage: BX.message('MAIL_CLIENT_AJAX_ERROR'),\n\t\t\t\t\tcode: 0\n\t\t\t\t}];\n\t\t\t}\n\t\t\tfor (var i = 0; i < data.errors.length; i++)\n\t\t\t{\n\t\t\t\terrorNode.appendChild(document.createTextNode(data.errors[i].message));\n\t\t\t\terrorNode.appendChild(document.createElement('BR'));\n\t\t\t}\n\n\t\t\tform.showError(errorNode.innerHTML);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif ('edit' != this.ctrl.options.type)\n\t\t\t{\n\t\t\t\tthis.hideReplyForm();\n\t\t\t}\n\n\t\t\ttop.BX.SidePanel.Instance.postMessage(window, 'Mail.Client.MessageCreatedSuccess', data);\n\n\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t\tcontent: BX.message('MAIL_MESSAGE_SEND_SUCCESS')\n\t\t\t});\n\n\t\t\tthis.ctrl.close(true);\n\t\t}\n\t};\n\n\tBXMailMessage.prototype.showReplyForm = function (min)\n\t{\n\t\tvar mailForm = BXMainMailForm.getForm(this.options.formId);\n\t\tvar replyButton = BX.findChildByClassName(this.__wrapper, 'js-msg-view-reply-panel', true);\n\n\t\tif (this.htmlForm.parentNode === this.__dummyNode)\n\t\t\tthis.htmlForm.__wrapper.appendChild(this.htmlForm);\n\n\t\tmailForm.init();\n\n\t\tif (min === true)\n\t\t{\n\t\t\tmailForm.getField('data[to]').setValue(this.options.rcptSelected);\n\t\t\tmailForm.getField('data[cc]').setValue();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmailForm.getField('data[to]').setValue(this.options.rcptAllSelected);\n\t\t\tmailForm.getField('data[cc]').setValue(this.options.rcptCcSelected);\n\t\t}\n\n\t\tmailForm.getField('data[bcc]').setValue();\n\n\t\tBX.onCustomEvent('MailMessage:replyButtonClick', [this]);\n\n\t\tBX.addClass(this.htmlForm, 'mail-msg-show-animation');\n\t\tthis.htmlForm.style.display = '';\n\n\t\treplyButton.style.display = 'none';\n\n\t\tBX.onCustomEvent(mailForm, 'MailForm:show', []);\n\n\t\tthis.ctrl.scrollTo(this.htmlForm);\n\t};\n\n\tBXMailMessage.prototype.hideReplyForm = function ()\n\t{\n\t\tvar mailForm = BXMainMailForm.getForm(this.options.formId);\n\t\tvar replyButton = BX.findChildByClassName(this.__wrapper, 'js-msg-view-reply-panel', true);\n\n\t\tBX.addClass(replyButton, 'mail-msg-show-animation-rev');\n\t\treplyButton.style.display = '';\n\n\t\tthis.htmlForm.style.display = 'none';\n\n\t\tBX.onCustomEvent(mailForm, 'MailForm:hide', []);\n\n\t\tthis.__dummyNode.appendChild(this.htmlForm);\n\t};\n\n\tBXMailMessage.prototype.markAsSpam = function (btn, uid)\n\t{\n\t\tbtn.classList.add('mail-msg-view-control-disabled');\n\t\tBX.ajax.runComponentAction('bitrix:mail.client', 'markAsSpam', {\n\t\t\tmode: 'ajax',\n\t\t\tdata: {ids: [uid]}\n\t\t}).then(\n\t\t\tthis.onMessageActionSuccess.bind(this, btn),\n\t\t\tfunction (response)\n\t\t\t{\n\t\t\t\tthis.onMessageActionError.bind(this, response)()\n\t\t\t}.bind(this)\n\t\t);\n\t};\n\n\tBXMailMessage.prototype.delete = function (btn, uid)\n\t{\n\t\tif (btn.dataset && btn.dataset.isTrash)\n\t\t{\n\t\t\tif (!this.popupDeleteConfirm)\n\t\t\t{\n\t\t\t\tvar buttons = [\n\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\ttext: BX.message(\"MAIL_MESSAGE_LIST_CONFIRM_CANCEL_BTN\"),\n\t\t\t\t\t\tclassName: \"popup-window-button-cancel\",\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: BX.delegate(function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.popupDeleteConfirm.close();\n\t\t\t\t\t\t\t}, this)\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\ttext: BX.message(\"MAIL_MESSAGE_LIST_CONFIRM_DELETE_BTN\"),\n\t\t\t\t\t\tclassName: \"popup-window-button-decline\",\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: BX.delegate(function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.processDelete(btn, uid);\n\t\t\t\t\t\t\t\tthis.popupDeleteConfirm.close();\n\t\t\t\t\t\t\t}, this)\n\t\t\t\t\t\t}\n\t\t\t\t\t})];\n\t\t\t\tthis.popupDeleteConfirm = new BX.PopupWindow('bx-mail-message-list-popup-delete-confirm', null, {\n\t\t\t\t\tzIndex: 1000,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tbuttons: buttons,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\ttitleBar: {\n\t\t\t\t\t\tcontent: BX.create('div', {\n\t\t\t\t\t\t\thtml: '<span class=\"popup-window-titlebar-text\">' + BX.message(\"MAIL_MESSAGE_LIST_CONFIRM_TITLE\") + '</span>'\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupClose: function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.destroy()\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupDeleteConfirm = null\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t},\n\t\t\t\t\tcontent: BX.create(\"div\", {\n\t\t\t\t\t\thtml: BX.message('MAIL_MESSAGE_LIST_CONFIRM_DELETE')\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.popupDeleteConfirm.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.processDelete(btn, uid);\n\t\t}\n\t};\n\n\tBXMailMessage.prototype.processDelete = function (btn, uid)\n\t{\n\t\tbtn.classList.add('mail-msg-view-control-disabled');\n\t\tBX.ajax.runComponentAction('bitrix:mail.client', 'delete', {\n\t\t\tmode: 'ajax',\n\t\t\tdata: {ids: [uid]}\n\t\t}).then(\n\t\t\tthis.onMessageActionSuccess.bind(this, btn),\n\t\t\tfunction (response)\n\t\t\t{\n\t\t\t\tthis.onMessageActionError.bind(this, response)()\n\t\t\t}.bind(this)\n\t\t);\n\t};\n\n\tBXMailMessage.prototype.onMessageActionError = function (response)\n\t{\n\t\talert(response.errors[0].message);\n\t\t// todo show errors\n\t};\n\n\tBXMailMessage.prototype.onMessageActionSuccess = function (btn)\n\t{\n\t\ttop.BX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'mail-message-reload-grid',\n\t\t\t{}\n\t\t);\n\n\t\tthis.ctrl.close(true);\n\t};\n\n\tvar BXMailMailbox = {\n\t\tsyncData: {}\n\t};\n\n\tBXMailMailbox.init = function (mailbox)\n\t{\n\t\tthis.mailbox = mailbox || {};\n\n\t\treturn this;\n\t};\n\n\tBXMailMailbox.sync = function (stepper, gridId, onlySyncCurrent, showProgressBar)\n\t{\n\t\tvar self = this;\n\n\t\t//if synchronization is requested by the user - show the bar even if synchronization is already in progress\n\t\tif(showProgressBar)\n\t\t{\n\t\t\tBXMailMailbox.updateStepper(stepper, 0, -1);\n\t\t}\n\n\t\tif (self.syncLock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tself.syncLock = true;\n\n\t\tvar filter = BX.Main.filterManager.getById(gridId);\n\t\tvar dir = filter.getFilterFieldsValues()['DIR'];\n\n\t\tvar pr = BX.ajax.runComponentAction(\n\t\t\t'bitrix:mail.client',\n\t\t\t'syncMailbox',\n\t\t\t{\n\t\t\t\tmode: 'ajax',\n\t\t\t\tdata: {\n\t\t\t\t\tid: self.mailbox.ID,\n\t\t\t\t\tdir: dir || self.mailbox.OPTIONS.inboxDir,\n\t\t\t\t\tonlySyncCurrent: onlySyncCurrent === undefined ? false : onlySyncCurrent,\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tpr.then(\n\t\t\tfunction (json)\n\t\t\t{\n\t\t\t\tBXMailMailbox.syncProgress(stepper, gridId, json.data);\n\t\t\t},\n\t\t\tfunction (json)\n\t\t\t{\n\t\t\t\tBXMailMailbox.syncProgress(\n\t\t\t\t\tstepper,\n\t\t\t\t\tgridId,\n\t\t\t\t\t{\n\t\t\t\t\t\t'complete': -1,\n\t\t\t\t\t\t'status': -1,\n\t\t\t\t\t\t'errors': json.errors\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t};\n\n\tBXMailMailbox.syncProgress = function (stepper, gridId, params)\n\t{\n\t\tvar self = this;\n\n\t\tif (params.timestamp < self.syncData.timestamp)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tself.syncData.timestamp = params.timestamp;\n\n\t\tif (!BX.type.isNotEmptyString(params.sessid))\n\t\t{\n\t\t\tparams.sessid = 'dummy';\n\t\t}\n\n\t\tif (typeof self.syncData[params.sessid] == 'undefined')\n\t\t{\n\t\t\tself.syncData[params.sessid] = {};\n\t\t}\n\n\t\tif (params.new > 0)\n\t\t{\n\t\t\tself.syncData[params.sessid].new = params.new;\n\t\t}\n\n\t\tif (params.complete > 0 && !self.syncData[params.sessid].complete)\n\t\t{\n\t\t\tif (self.syncData[params.sessid].new > 0 || params.updated > 0 || params.deleted > 0)\n\t\t\t{\n\t\t\t\tBX.onCustomEvent('BX.Mail.Sync:newLettersArrived');\n\n\t\t\t\tvar messageGrid = new MessageGrid();\n\t\t\t\tmessageGrid.setGridId(gridId);\n\t\t\t\tmessageGrid.reloadTable();\n\t\t\t}\n\n\t\t\tif (params.final > 0)\n\t\t\t{\n\t\t\t\tdelete self.syncData[params.sessid];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tself.syncData[params.sessid].complete = true;\n\t\t\t}\n\t\t}\n\n\t\tBXMailMailbox.updateStepper(stepper, params.complete, params.status, params.errors);\n\n\t\tif (params.complete < 0 || params.complete > 0)\n\t\t{\n\t\t\tthis.syncLock = false;\n\t\t}\n\n\t\tif (params.complete < 0 && params.status >= 0)\n\t\t{\n\t\t\t//sync incomplete to end\n\t\t\tBXMailMailbox.sync(stepper, gridId, true);\n\t\t}\n\t}\n\n\tBXMailMailbox.toggleStepper = function(stepper, show)\n\t{\n\t\tif (show)\n\t\t{\n\t\t\tstepper.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstepper.hide();\n\t\t}\n\t}\n\n\tBXMailMailbox.updateStepper = function(stepper, complete, status, errors)\n\t{\n\t\tstepper.hideTimeout = clearTimeout(stepper.hideTimeout);\n\n\t\tstatus = parseFloat(status);\n\n\t\tvar stepperInfo = stepper.getErrorTitleNode();\n\t\tvar stepperError = stepper.getErrorTextNode();\n\n\t\t//in case of synchronization error:\n\t\tif (complete < 0 && status < 0)\n\t\t{\n\t\t\tstepperInfo && (stepperInfo.innerText = BX.message('MAIL_CLIENT_MAILBOX_SYNC_BAR_INTERRUPTED'));\n\n\t\t\tif (stepperError)\n\t\t\t{\n\t\t\t\tvar details = [];\n\n\t\t\t\tif (errors && errors.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfor (var i = 0; i < errors.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (errors[i].code < 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdetails.push(errors[i].message);\n\t\t\t\t\t\t\terrors.splice(i--, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\terrors[i] = errors[i].message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar error = (errors.length > 0 ? errors : details).join(': ');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar error = BX.message('MAIL_CLIENT_AJAX_ERROR');\n\t\t\t\t}\n\n\t\t\t\tstepperError.innerText = error;\n\n\t\t\t\tif (details.length > 0 && errors.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstepperError.appendChild(\n\t\t\t\t\t\tBX.UI.Hint.createNode(details.join(': '))\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstepper.showErrorBox();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBXMailMailbox.toggleStepper(stepper, false);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstepper.hideErrorBox();\n\n\t\t\tif (complete > 0)\n\t\t\t{\n\t\t\t\tstepperInfo && (stepperInfo.innerHTML = BX.message('MAIL_CLIENT_MAILBOX_SYNC_BAR_COMPLETED'));\n\n\t\t\t\tstepper.hideTimeout = setTimeout(BXMailMailbox.toggleStepper.bind(this, stepper, false), 2000);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBXMailMailbox.toggleStepper(stepper, true);\n\t\t\t}\n\t\t}\n\n\t\tvar event = document.createEvent('Event');\n\t\tevent.initEvent('resize', true, true);\n\t\twindow.dispatchEvent(event);\n\t};\n\n\twindow.BXMailMessageController = BXMailMessageController;\n\twindow.BXMailMessage = BXMailMessage;\n\twindow.BXMailMailbox = BXMailMailbox;\n\n})();\n\n(function() {\n\n\tif (window !== window.top)\n\t{\n\t\treturn;\n\n\t\tBX.bind(\n\t\t\twindow,\n\t\t\t'beforeunload',\n\t\t\tfunction ()\n\t\t\t{\n\t\t\t\tdocument.body.style.opacity = '0.4';\n\t\t\t}\n\t\t);\n\t}\n\n\tvar siteDir = ('/' + (BX.message.SITE_DIR || '/').replace(/[\\\\*+?.()|[\\]{}]/g, '\\\\$&') + '/').replace(/\\/+/g, '/');\n\n\ttop.BX.SidePanel.Instance.bindAnchors({\n\t\trules: [\n\t\t\t{\n\t\t\t\tcondition: [\n\t\t\t\t\tsiteDir + 'mail/',\n\t\t\t\t],\n\t\t\t\toptions: {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tcustomLeftBoundary: 0,\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tcondition: [\n\t\t\t\t\t'^' + siteDir + 'mail/config/(new|edit)',\n\t\t\t\t],\n\t\t\t\toptions: {\n\t\t\t\t\twidth: 760,\n\t\t\t\t\tcacheable: false\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tcondition: [\n\t\t\t\t\t'^' + siteDir + 'mail/(blacklist|signature|config|message)'\n\t\t\t\t],\n\t\t\t\toptions: {\n\t\t\t\t\twidth: 1080\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t});\n\n})();\n"],"names":["window","BXMailMessageController","init","options","__inited","__dummyNode","document","createElement","type","pageSize","__log","details","BX","messageId","moreA","findChildByClassName","parentNode","bind","handleLogClick","moreB","items","findChildrenByClassName","i","log","getAttribute","toLowerCase","handleLogItemClick","Event","EventEmitter","subscribe","event","show","getData","hide","initScrollable","__scrollable","scrollingElement","documentElement","scrollTop","scrollLeft","body","scrollBy","scrollWrapper","pos","ctrl","__animation","clearInterval","start","delta","step","setInterval","scrollTo","node1","node2","pos0","top","bottom","pos1","pos2","Math","min","PreventDefault","button","loadLog","separator","data","sessid","bitrix_sessid","action","id","size","mail_uf_message_token","ajax","method","url","util","add_url_param","ajaxUrl","dataType","onsuccess","json","status","innerHTML","html","marker","findNextSibling","childNodes","length","item","insertBefore","nodeType","hasClass","addClass","count","style","display","scrollHeight","onfailure","target","tagName","toUpperCase","getSelection","toString","trim","selection","createRange","htmlText","toggleLogItem","wrapper","logItem","opened","removeClass","toggleClass","errors","map","message","join","response","processHTML","setTimeout","textAlign","HTML","offsetHeight","processScripts","SCRIPT","removeAttribute","removeLogItem","removeChild","maxHeight","transition","close","destroy","slider","SidePanel","Instance","getSliderByWindow","setCacheable","location","href","pathList","BXMailMessage","self","htmlForm","formId","__wrapper","addCustomEvent","source","hideReplyForm","postMessage","emailContainerId","emailLinks","querySelectorAll","findChildren","tag","hasOwnProperty","setAttribute","quotesList","rcptMore","replyButton","replyLink","replyAllLink","forwardLink","skipLink","spamLink","deleteLink","showReplyForm","params","forward","pathNew","BXMailMessageActions","createAction","value","disable","enable","uidKeyData","querySelector","uid","dataset","uidKey","markAsSpam","delete","mailForm","BXMainMailForm","getForm","handleFooterButtonClick","handleFormSubmit","handleFormSubmitSuccess","PULL","extendWatch","proxy","command","adjust","text","form","fields","elements","emptyRcpt","name","showError","uploads","totalSize","postForm","controllers","storage","handler","agent","upload","filesCount","err","queue","Object","keys","reduce","sum","k","file","parseInt","sizeInt","ceil","errorNode","isArray","code","appendChild","createTextNode","UI","Notification","Center","notify","autoHideDelay","content","prototype","getField","setValue","rcptSelected","rcptAllSelected","rcptCcSelected","onCustomEvent","btn","classList","add","runComponentAction","mode","ids","then","onMessageActionSuccess","onMessageActionError","isTrash","popupDeleteConfirm","buttons","PopupWindowButton","className","events","click","delegate","processDelete","PopupWindow","zIndex","autoHide","closeByEsc","titleBar","create","onPopupClose","onPopupDestroy","alert","BXMailMailbox","syncData","mailbox","sync","stepper","gridId","onlySyncCurrent","showProgressBar","updateStepper","syncLock","filter","Main","filterManager","getById","dir","getFilterFieldsValues","pr","ID","OPTIONS","inboxDir","undefined","syncProgress","timestamp","isNotEmptyString","new","complete","updated","deleted","messageGrid","MessageGrid","setGridId","reloadTable","final","toggleStepper","hideTimeout","clearTimeout","parseFloat","stepperInfo","getErrorTitleNode","stepperError","getErrorTextNode","innerText","push","splice","error","Hint","createNode","showErrorBox","hideErrorBox","createEvent","initEvent","dispatchEvent","opacity","siteDir","SITE_DIR","replace","bindAnchors","rules","condition","cacheable","customLeftBoundary","width"],"mappings":"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"}