(function(){BX.namespace("BX.Mail.UserSignature.Edit");BX.Mail.UserSignature.Edit={signatureId:null};BX.Mail.UserSignature.Edit.init=function(e){this.signatureId=e.signatureId||null;var i=function(e){var i=BX.findChildren(e,{tag:"input",attr:{type:"radio"}},true);for(var t in i){BX.bind(i[t],"change",function(){if(this.checked){if(this.value==0){var i=BX(e.getAttribute("data-checked"));if(i){var t=BX.findNextSibling(this,{tag:"label",attr:{for:this.id}});var r=BX.findNextSibling(i,{tag:"label",attr:{for:i.id}});if(t&&r)BX.adjust(t,{text:r.innerHTML})}}else{e.setAttribute("data-checked",this.id)}}})}BX.bind(e,"click",function(i){i=i||window.event;i.skip_singleselect=e});BX.bind(document,"click",function(i){i=i||window.event;if(i.skip_singleselect!==e){if(BX(e.getAttribute("data-checked"))){BX(e.getAttribute("data-checked")).checked=true}}})};var t=BX.findChildrenByClassName(document,"mail-set-singleselect",true);for(var r in t)i(t[r])};BX.Mail.UserSignature.Edit.save=function(e){e=e===true;var i=BX("mail-signature-signature-id").value;var t=BXHtmlEditor.Get("signatureeditorid").GetContent();var r="",n;if(BX("sender_bind_checkbox").checked){if(BX("mail_user_signature_sender_type_sender").checked){n=BX("mail_user_signature_list_sender")}else{n=BX("mail_user_signature_list_address")}var a=BX.findChildren(n,{tag:"input",attr:{type:"radio"}},true);for(var s in a){if(a.hasOwnProperty(s)){if(a[s].checked){r=a[s].value;break}}}}if(i>0){BX.ajax.runAction("mail.api.usersignature.update",{data:{userSignatureId:i,fields:{signature:t,sender:r}}}).then(function(t){if(e){BX.Mail.UserSignature.Edit.closeSlider(i)}else{BX.UI.Notification.Center.notify({content:BX.message("MAIL_SIGNATURE_UPDATE_SUCCESS")})}},function(e){BX.Mail.UserSignature.Edit.showError(e.errors.pop().message)})}else{BX.ajax.runAction("mail.api.usersignature.add",{data:{fields:{signature:t,sender:r}}}).then(function(e){BX.Mail.UserSignature.Edit.closeSlider(e.data.userSignature.id)},function(e){BX.Mail.UserSignature.Edit.showError(e.errors.pop().message)})}};BX.Mail.UserSignature.Edit.showError=function(e){var i=new BX.UI.Alert({color:BX.UI.Alert.Color.DANGER,icon:BX.UI.Alert.Icon.DANGER,text:e});BX.adjust(BX("signature-alert-container"),{html:""});BX.append(i.getContainer(),BX("signature-alert-container"))};BX.Mail.UserSignature.Edit.closeSlider=function(e){if(BX.SidePanel){var i=BX.SidePanel.Instance.getTopSlider();if(i){BX.SidePanel.Instance.postMessage(i,"mail-add-signature",{userSignatureId:e})}}BX.fireEvent(BX("ui-button-panel-close"),"click")};BX.Mail.UserSignature.Edit.showList=function(e){if(e==="sender"){BX.show(BX("mail_user_signature_list_sender"),"inline-block");BX.hide(BX("mail_user_signature_list_address"))}else{BX.hide(BX("mail_user_signature_list_sender"));BX.show(BX("mail_user_signature_list_address"),"inline-block")}}})();
//# sourceMappingURL=script.map.js