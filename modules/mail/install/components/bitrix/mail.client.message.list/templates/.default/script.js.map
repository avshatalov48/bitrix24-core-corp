{"version":3,"file":"script.js","sources":["src/js/progressbar.es6.js","src/js/counters.es6.js","src/js/leftmenu.es6.js","src/js/list.es6.js","script.es6.js"],"sourcesContent":["export class ProgressBar\n{\n\t#node;\n\t#errorTitleNode;\n\t#errorTextNode;\n\t#errorBoxNode;\n\t#syncButton;\n\t#errorHintNode;\n\n\tconstructor(node)\n\t{\n\t\tthis.#node = node;\n\t}\n\n\tsetSyncButton(button)\n\t{\n\t\tthis.#syncButton = button;\n\t}\n\n\tgetSyncButton()\n\t{\n\t\treturn this.#syncButton;\n\t}\n\n\tgetErrorBoxNode()\n\t{\n\t\treturn this.#errorBoxNode;\n\t}\n\n\tsetErrorBoxNode(errorBoxNode)\n\t{\n\t\tthis.#errorBoxNode = errorBoxNode;\n\t}\n\n\tsetErrorTitleNode(errorTitleNode)\n\t{\n\t\tthis.#errorTitleNode = errorTitleNode;\n\t}\n\n\tsetErrorTextNode(errorTextNode)\n\t{\n\t\tthis.#errorTextNode = errorTextNode;\n\t}\n\n\tsetErrorHintNode(errorHintNode)\n\t{\n\t\tthis.#errorHintNode = errorHintNode;\n\t}\n\n\tgetErrorTextNode()\n\t{\n\t\treturn this.#errorTextNode;\n\t}\n\n\tgetErrorHintNode()\n\t{\n\t\treturn this.#errorHintNode;\n\t}\n\n\tgetErrorTitleNode()\n\t{\n\t\treturn this.#errorTitleNode;\n\t}\n\n\tshow()\n\t{\n\t\tif(this.getSyncButton() !== undefined) this.getSyncButton().setWaiting(true);\n\t\tthis.#node.classList.add(\"mail-progress-show\");\n\t\tthis.#node.classList.remove(\"mail-progress-hide\");\n\t}\n\n\thide()\n\t{\n\t\tif(this.getSyncButton() !== undefined) this.getSyncButton().setWaiting(false);\n\t\tthis.#node.classList.add(\"mail-progress-hide\");\n\t\tthis.#node.classList.remove(\"mail-progress-show\");\n\t}\n\n\thideErrorBox()\n\t{\n\t\tthis.#errorBoxNode.classList.add(\"mail-hidden-element\");\n\t\tthis.#errorBoxNode.classList.remove(\"mail-visible-element\");\n\t}\n\n\tshowErrorBox()\n\t{\n\t\tthis.#errorBoxNode.classList.add(\"mail-visible-element\");\n\t\tthis.#errorBoxNode.classList.remove(\"mail-hidden-element\");\n\t}\n}","import { BaseEvent, EventEmitter } from \"main.core.events\";\n\nexport class Counters\n{\n\tcachedCounters = [];\n\tcounters = [];\n\thiddenCountersForTotalCounter = [];\n\tshortcuts = [];\n\t#name;\n\tselectedDirectory;\n\n\tconstructor(name,selectedDirectory)\n\t{\n\t\tthis.#name = name;\n\t\tthis.setDirectory(selectedDirectory);\n\t}\n\n\tgetCounters()\n\t{\n\t\treturn this.counters;\n\t}\n\n\tgetDirPath(shortcut)\n\t{\n\t\tif(shortcut === undefined)\n\t\t{\n\t\t\tshortcut = '';\n\t\t}\n\n\t\tif(this.shortcuts[shortcut] !== undefined)\n\t\t{\n\t\t\treturn this.shortcuts[shortcut];\n\t\t}\n\n\t\treturn shortcut;\n\t}\n\n\tgetShortcut(path)\n\t{\n\t\t//because they have a closure\n\t\treturn this.getDirPath(path);\n\t}\n\n\tsetDirectory(name)\n\t{\n\t\tif(name === undefined)\n\t\t{\n\t\t\tname = '';\n\t\t}\n\n\t\tif(this.shortcuts[name])\n\t\t{\n\t\t\tthis.selectedDirectory = this.shortcuts[name];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectedDirectory = name;\n\t\t}\n\n\t\tlet resultCounters = {};\n\t\tresultCounters[this.selectedDirectory] = this.getCounter(this.selectedDirectory);\n\t\tthis.sendCounterUpdateEvent(resultCounters);\n\t}\n\n\tsetShortcut(shortcutName,name)\n\t{\n\t\t//backlink\n\t\tthis.shortcuts[shortcutName] = name;\n\t\tthis.shortcuts[name] = shortcutName;\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.#name;\n\t}\n\n\tsetHiddenCountersForTotalCounter(counterNames)\n\t{\n\t\tfor (let counter of counterNames)\n\t\t{\n\t\t\tthis.hiddenCountersForTotalCounter[counter] = 'disabled';\n\t\t}\n\t}\n\n\tisHidden(name):boolean\n\t{\n\t\tif(this.hiddenCountersForTotalCounter[name] === 'disabled')\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetTotalCounter()\n\t{\n\t\tlet counters = 0;\n\t\tfor (let name in this.counters)\n\t\t{\n\t\t\tif(name in this.hiddenCountersForTotalCounter)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcounters += this.counters[name];\n\t\t}\n\n\t\treturn counters;\n\t}\n\n\tgetCounterObjects()\n\t{\n\t\treturn this.counters;\n\t}\n\n\tgetCounter(name)\n\t{\n\t\treturn this.counters[name];\n\t}\n\n\taddCounter(name,count)\n\t{\n\t\tthis.counters[name] = Number(count);\n\t\treturn this.counters[name];\n\t}\n\n\taddCounters(counters)\n\t{\n\t\tthis.cacheCounters();\n\n\t\tlet resultCounters = {};\n\n\t\tfor (let i = 0; i < counters.length; i++)\n\t\t{\n\t\t\tconst counter = counters[i]\n\n\t\t\tcounter['count'] = Number(counter['count']);\n\n\t\t\tconst path = counter['path'];\n\t\t\tthis.addCounter(path,counter['count']);\n\n\t\t\tif(this.shortcuts[path])\n\t\t\t{\n\t\t\t\tresultCounters[this.shortcuts[path]] = counter['count'];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresultCounters[path] = counter['count'];\n\t\t\t}\n\n\t\t}\n\n\t\tthis.sendCounterUpdateEvent(resultCounters);\n\t}\n\n\t/*Set counters as when adding. Old counters with different names are retained*/\n\tsetCounters(counters)\n\t{\n\t\tthis.addCounters(counters);\n\t}\n\n\tisExists(name)\n\t{\n\t\treturn this.counters[name] !== undefined;\n\t}\n\n\tincreaseCounter(name,count = 1 )\n\t{\n\t\tthis.cacheCounters();\n\n\t\tif(name in this.hiddenCountersForTotalCounter)\n\t\t{\n\t\t\treturn \"hidden counters for total counter\";\n\t\t}\n\n\t\tif(!this.isExists(name))\n\t\t{\n\t\t\treturn \"no counter\";\n\t\t}\n\t\tthis.counters[name] += Number(count);\n\t}\n\n\tlowerCounter(name,count = 1 )\n\t{\n\t\tthis.cacheCounters();\n\n\t\tif(name in this.hiddenCountersForTotalCounter)\n\t\t{\n\t\t\treturn \"hidden counters for total counter\";\n\t\t}\n\n\t\tif(!this.isExists(name))\n\t\t{\n\t\t\treturn \"no counter\";\n\t\t}\n\n\t\tconst newValue = this.counters[name] - Number(count);\n\t\tif(newValue < 0)\n\t\t{\n\t\t\treturn \"negative value\";\n\t\t}\n\n\t\tthis.counters[name] = newValue;\n\t}\n\n\tcacheCounters()\n\t{\n\t\tthis.cachedCounters = [];\n\t\tObject.assign(this.cachedCounters, this.counters);\n\t}\n\n\trestoreFromCache()\n\t{\n\t\tthis.counters = [];\n\t\tObject.assign(this.counters, this.cachedCounters);\n\t\tthis.sendCounterUpdateEvent(this.counters);\n\t}\n\n\t/*Change counters by rule*/\n\tupdateCounters(counters = [\n\t\t{\n\t\t\tname: 'counter1',\n\t\t\tcount: 2,\n\t\t\tincrease: false,\n\t\t\tlower: true,\n\t\t},\n\t\t{\n\t\t\tname: 'counter2',\n\t\t\tcount: 2,\n\t\t\tincrease: true,\n\t\t\tlower: false,\n\t\t},\n\t])\n\t{\n\t\tthis.cacheCounters();\n\t\tlet resultCounters = {};\n\t\tlet countersAreNotLoadedFromTheServer = false;\n\n\t\tfor (let i = 0; i < counters.length; i++)\n\t\t{\n\t\t\tconst counter = counters[i];\n\t\t\tconst name = counter['name'];\n\n\t\t\tif(counter['lower'])\n\t\t\t{\n\t\t\t\tif(this.lowerCounter(name,counter['count']) === \"negative value\")\n\t\t\t\t{\n\t\t\t\t\tcountersAreNotLoadedFromTheServer = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(counter['increase'] && countersAreNotLoadedFromTheServer === false)\n\t\t\t{\n\t\t\t\tthis.increaseCounter(name,counter['count'])\n\t\t\t}\n\n\t\t\tif(this.shortcuts[name])\n\t\t\t{\n\t\t\t\tresultCounters[this.shortcuts[name]] = this.getCounter(name);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresultCounters[name] = this.getCounter(name);\n\t\t\t}\n\t\t}\n\n\t\tthis.sendCounterUpdateEvent(resultCounters);\n\t}\n\n\tsendCounterUpdateEvent(counters)\n\t{\n\t\tif(counters === undefined)\n\t\t{\n\t\t\tcounters = this.counters;\n\t\t}\n\n\t\tif(counters.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tcounters: counters,\n\t\t\t\thidden: this.hiddenCountersForTotalCounter,\n\t\t\t\tselectedDirectory: this.selectedDirectory,\n\t\t\t\tname: this.getName(),\n\t\t\t\ttotal: this.getTotalCounter(),\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.emit('BX.Mail.Home:updatingCounters', event);\n\t}\n\n}","import { EventEmitter } from \"main.core.events\";\nimport { DirectoryMenu } from 'mail.directorymenu';\n\nexport class LeftMenu\n{\n\tconstructor(config={\n\t\tdirsWithUnseenMailCounters: {},\n\t\tmailboxId:'',\n\t\tfilterId: '',\n\t\tsystemDirs :\n\t\t{\n\t\t\tspam: 'Spam',\n\t\t\ttrash: 'Trash',\n\t\t\toutcome: 'Outcome',\n\t\t\tdrafts: 'Drafts',\n\t\t\tinbox: 'Inbox',\n\t\t}\n\t})\n\t{\n\t\tconst leftDirectoryMenuWrapper = document.querySelector('.mail-left-menu-wrapper');\n\n\t\tthis.directoryMenu = new DirectoryMenu({\n\t\t\tdirsWithUnseenMailCounters: config['dirsWithUnseenMailCounters'],\n\t\t\tfilterId: config['filterId'],\n\t\t\tsystemDirs: config['systemDirs'],\n\t\t});\n\n\t\tleftDirectoryMenuWrapper.append(this.directoryMenu.getNode());\n\t}\n}","import { EventEmitter } from \"main.core.events\";\nimport { Loc } from 'main.core';\n\nexport class List\n{\n\tconstructor(options)\n\t{\n\t\tthis.mailReadAllButton = options.mailReadAllButton;\n\t\tthis.gridId = options.gridId;\n\t\tthis.mailboxId = options.mailboxId;\n\t\tthis.canMarkSpam = options.canMarkSpam;\n\t\tthis.canDelete = options.canDelete;\n\t\tthis.ERROR_CODE_CAN_NOT_DELETE = options.ERROR_CODE_CAN_NOT_DELETE;\n\t\tthis.ERROR_CODE_CAN_NOT_MARK_SPAM = options.ERROR_CODE_CAN_NOT_MARK_SPAM;\n\t\tthis.disabledClassName = 'js-disabled';\n\t\tthis.userInterfaceManager = new BX.Mail.Client.Message.List.UserInterfaceManager(options);\n\t\tthis.userInterfaceManager.resetGridSelection = this.resetGridSelection.bind(this);\n\t\tthis.userInterfaceManager.isSelectedRowsHaveClass = this.isSelectedRowsHaveClass.bind(this);\n\t\tthis.userInterfaceManager.getGridInstance = this.getGridInstance.bind(this);\n\t\tthis.userInterfaceManager.updateCountersFromBackend = this.updateCountersFromBackend.bind(this);\n\t\tthis.cache = {};\n\t\tthis.addEventHandlers();\n\n\t\tBX.Mail.Client.Message.List[options.id] = this;\n\t};\n\n\taddEventHandlers()\n\t{\n\t\t// todo delete this hack\n\t\t// it is here to prevent grid's title changing after filter apply\n\t\tBX.ajax.UpdatePageData = (function() {\n\t\t});\n\n\t\tEventEmitter.subscribe(\n\t\t\t'onSubMenuShow',\n\t\t\tfunction(event){\n\t\t\t\tconst menuItem = event.target;\n\t\t\t\tconst container = menuItem.getMenuWindow().getPopupWindow().getPopupContainer();\n\t\t\t\tlet id = null;\n\n\t\t\t\tif (container)\n\t\t\t\t{\n\t\t\t\t\tid = BX.data(container, 'grid-row-id');\n\t\t\t\t}\n\n\t\t\t\tBX.data(\n\t\t\t\t\tmenuItem.getSubMenu().getPopupWindow().getPopupContainer(),\n\t\t\t\t\t'grid-row-id',\n\t\t\t\t\tmenuItem.gridRowId || id,\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tEventEmitter.subscribe('Mail::directoryChanged', () =>\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t})\n\n\t\tEventEmitter.subscribe('BX.Mail.Home:updatingCounters', (event) => {\n\t\t\tif(event['data']['name'] !== 'mailboxCounters')\n\t\t\t{\n\t\t\t\tconst counters = event['data']['counters'];\n\t\t\t\tBX.Mail.Home.LeftMenuNode.directoryMenu.setCounters(counters);\n\n\t\t\t\tBX.Mail.Home.mailboxCounters.setCounters([\n\t\t\t\t\t{\n\t\t\t\t\t\tpath: 'unseenCountInCurrentMailbox',\n\t\t\t\t\t\tcount: BX.Mail.Home.Counters.getTotalCounter(),\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.userInterfaceManager.updateLeftMenuCounter();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Main.Menu.Item:onmouseenter', function(event) {\n\t\t\tconst menuItem = event.target;\n\n\t\t\tif (!menuItem.dataset || !menuItem.getMenuWindow())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuWindow = menuItem.getMenuWindow();\n\t\t\tconst subMenuItems = menuWindow.getMenuItems();\n\n\t\t\tconst path = menuItem.dataset.path;\n\t\t\tconst hash = menuItem.dataset.dirMd5;\n\t\t\tconst hasChild = menuItem.dataset.hasChild;\n\n\t\t\tif (!hasChild)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < subMenuItems.length; i++)\n\t\t\t{\n\t\t\t\tconst item = subMenuItems[i];\n\n\t\t\t\tif (item.getId() === path)\n\t\t\t\t{\n\t\t\t\t\tconst hasSubMenu = item.hasSubMenu();\n\n\t\t\t\t\tif (hasSubMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.showSubMenu();\n\t\t\t\t\t\tconst subMenu = item.getSubMenu();\n\n\t\t\t\t\t\tlet hasLoadingItem = false;\n\n\t\t\t\t\t\tif (subMenu)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst items = subMenu.getMenuItems();\n\n\t\t\t\t\t\t\tfor (let k = 0; k < items.length; k++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst subItem = items[k];\n\n\t\t\t\t\t\t\t\tif (subItem.getId() === 'loading')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\thasLoadingItem = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!hasLoadingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.loadLevelMenu(item, hash);\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(this));\n\n\t\tconst itemsMenu = document.querySelectorAll('.ical-event-control-menu');\n\n\t\tfor (let i = 0; i < itemsMenu.length; i++)\n\t\t{\n\t\t\titemsMenu[i].addEventListener('click', this.showICalMenuDropdown.bind(this));\n\t\t}\n\n\t\tBX.bindDelegate(document.body, 'click', { className: 'ical-event-control-button' }, this.onClickICalButton.bind(this));\n\t}\n\n\tloadLevelMenu(menuItem, hash)\n\t{\n\t\tconst menu = this.getCache(menuItem.getId());\n\t\tconst popup = BX.Main.PopupManager.getPopupById('menu-popup-popup-submenu-' + menuItem.getId());\n\n\t\tif (popup)\n\t\t{\n\t\t\tpopup.destroy();\n\t\t}\n\n\t\tif (menu)\n\t\t{\n\t\t\tmenuItem.destroySubMenu();\n\t\t\tmenuItem.addSubMenu(menu);\n\t\t\tmenuItem.showSubMenu();\n\t\t\treturn;\n\t\t}\n\n\t\tconst subItem = {\n\t\t\t'id': 'loading',\n\t\t\t'text': Loc.getMessage('MAIL_CLIENT_BUTTON_LOADING'),\n\t\t\t'disabled': true,\n\t\t};\n\n\t\tmenuItem.destroySubMenu();\n\t\tmenuItem.addSubMenu([subItem]);\n\t\tmenuItem.showSubMenu();\n\n\t\tBX.ajax.runComponentAction('bitrix:mail.client.config.dirs', 'level', {\n\t\t\tmode: 'class',\n\t\t\tdata: { mailboxId: this.mailboxId, dir: { path: menuItem.getId(), dirMd5: hash } },\n\t\t}).then(\n\t\t\tfunction(response) {\n\t\t\t\tconst dirs = response.data.dirs;\n\t\t\t\tconst items = [];\n\n\t\t\t\tfor (let i = 0; i < dirs.length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst hasChild = /(HasChildren)/i.test(dirs[i].FLAGS);\n\t\t\t\t\tconst item = {\n\t\t\t\t\t\t'id': dirs[i].PATH,\n\t\t\t\t\t\t'text': dirs[i].NAME,\n\t\t\t\t\t\t'dataset': {\n\t\t\t\t\t\t\t'path': dirs[i].PATH,\n\t\t\t\t\t\t\t'dirMd5': dirs[i].DIR_MD5,\n\t\t\t\t\t\t\t'isDisabled': dirs[i].IS_DISABLED,\n\t\t\t\t\t\t\t'hasChild': hasChild,\n\t\t\t\t\t\t},\n\t\t\t\t\t\titems: hasChild ? [{\n\t\t\t\t\t\t\tid: 'loading',\n\t\t\t\t\t\t\t'text': Loc.getMessage('MAIL_CLIENT_BUTTON_LOADING'),\n\t\t\t\t\t\t\t'disabled': true,\n\t\t\t\t\t\t}] : [],\n\t\t\t\t\t};\n\n\t\t\t\t\titems.push(item);\n\t\t\t\t}\n\n\t\t\t\tthis.setCache(menuItem.getId(), items);\n\n\t\t\t\tconst popup = BX.Main.PopupManager.getPopupById('menu-popup-popup-submenu-' + menuItem.getId());\n\t\t\t\tconst isShown = menuItem.getMenuWindow().getPopupWindow().isShown();\n\n\t\t\t\tif (popup)\n\t\t\t\t{\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t}\n\n\t\t\t\tif (isShown)\n\t\t\t\t{\n\t\t\t\t\tmenuItem.destroySubMenu();\n\t\t\t\t\tmenuItem.addSubMenu(items);\n\t\t\t\t\tmenuItem.showSubMenu();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\tfunction(response) {\n\t\t\t}.bind(this),\n\t\t);\n\t}\n\n\tonCrmClick(id)\n\t{\n\t\tconst selected = this.getGridInstance().getRows().getSelected();\n\t\tconst row = id ? this.getGridInstance().getRows().getById(id) : selected[0];\n\t\tif (!(row && row.node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst addToCrm = this.userInterfaceManager.isAddToCrmActionAvailable(row.node);\n\t\tconst messageIdNode = row.node.querySelector('[data-message-id]');\n\t\tif (!(messageIdNode.dataset && messageIdNode.dataset.messageId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\n\t\tif (addToCrm)\n\t\t{\n\t\t\tconst crmBtnInRow = row.node.querySelector('.mail-binding-crm.mail-ui-not-active');\n\n\t\t\tif(crmBtnInRow)\n\t\t\t{\n\t\t\t\tcrmBtnInRow.startWait();\n\t\t\t}\n\n\t\t\tif (typeof this.isAddingToCrmInProgress !== \"object\")\n\t\t\t{\n\t\t\t\tthis.isAddingToCrmInProgress = {};\n\t\t\t}\n\t\t\tif (this.isAddingToCrmInProgress[id] === true)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isAddingToCrmInProgress[id] = true;\n\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'bitrix:mail.client',\n\t\t\t\t'createCrmActivity',\n\t\t\t\t{\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessageId: messageIdNode.dataset.messageId,\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t\t'bindings': this.getRowsBindings([row]),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t).then(\n\t\t\t\tfunction(id) {\n\t\t\t\t\tthis.isAddingToCrmInProgress[id] = false;\n\t\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_ADDED_TO_CRM'));\n\t\t\t\t}.bind(this, id),\n\t\t\t\tfunction(json) {\n\n\t\t\t\t\tif(crmBtnInRow)\n\t\t\t\t\t{\n\t\t\t\t\t\tcrmBtnInRow.stopWait();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.isAddingToCrmInProgress[id] = false;\n\t\t\t\t\tif (json.errors && json.errors.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.notify(json.errors.map(\n\t\t\t\t\t\t\tfunction(item) {\n\t\t\t\t\t\t\t\treturn item.message;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t).join('<br>'), 5000);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_ADD_TO_CRM_ERROR'));\n\t\t\t\t\t}\n\t\t\t\t}.bind(this),\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.userInterfaceManager.onCrmBindingDeleted(messageIdNode.dataset.messageId);\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'bitrix:mail.client',\n\t\t\t\t'removeCrmActivity',\n\t\t\t\t{\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessageId: messageIdNode.dataset.messageId,\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t\t'bindings': this.getRowsBindings([row]),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t).then(function(messageIdNode) {\n\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_EXCLUDED_FROM_CRM'));\n\t\t\t}.bind(this, messageIdNode));\n\t\t}\n\n\t\tlet selectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\tif(selectedIds.length === 1 && selectedIds[0]===id)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\t}\n\n\tonViewClick(id)\n\t{\n\t\tif (id === undefined && this.getGridInstance().getRows().getSelectedIds().length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\t// @TODO: path\n\t\tBX.SidePanel.Instance.open(\"/mail/message/\" + id, {\n\t\t\twidth: 1080,\n\t\t\tloader: 'view-mail-loader',\n\t\t});\n\t}\n\n\tonDeleteImmediately(id)\n\t{\n\t\tlet additionalOptions =\n\t\t{\n\t\t\t'deleteImmediately' : true,\n\t\t};\n\t\tthis.onDeleteClick(id,additionalOptions);\n\t}\n\n\tonDeleteClick(id,additionalOptions)\n\t{\n\t\tconst selected = this.getGridInstance().getRows().getSelected();\n\t\tif (id === undefined && selected.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (!this.canDelete)\n\t\t{\n\t\t\tthis.showDirsSlider();\n\t\t\treturn;\n\t\t}\n\t\tlet options = {\n\t\t\tparams: (additionalOptions !== undefined) ? additionalOptions : {},\n\t\t\tkeepRows: true,\n\t\t\tanalyticsLabel: {\n\t\t\t\t'groupCount': selected.length,\n\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t},\n\t\t};\n\t\tlet selectedIds;\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = BX.Mail.Home.Grid.getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\n\t\tselectedIds = this.filterRowsByClassName(this.disabledClassName, selectedIds, true);\n\t\toptions.ids = selectedIds;\n\n\t\tif (this.userInterfaceManager.isCurrentFolderTrash || (additionalOptions !== undefined && additionalOptions['deleteImmediately']) )\n\t\t{\n\t\t\tconst confirmPopup = this.getConfirmDeletePopup(options);\n\t\t\tconfirmPopup.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.Mail.Home.Grid.hideRowByIds(selectedIds);\n\n\t\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', selectedIds).length;\n\n\t\t\tif(this.getCurrentFolder() !== '')\n\t\t\t{\n\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t{\n\t\t\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\t\t\tlower: true,\n\t\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\n\t\t\tthis.runAction('delete', options,() =>\n\t\t\t\tBX.Mail.Home.Grid.reloadTable()\n\t\t\t);\n\t\t\tif(id === undefined)\n\t\t\t{\n\t\t\t\tthis.resetGridSelection();\n\t\t\t}\n\t\t}\n\t}\n\n\tonMoveToFolderClick(event)\n\t{\n\t\tconst folderOptions = event.currentTarget.dataset;\n\t\tconst toFolderByPath = folderOptions.path;\n\t\tconst toFolderByName = toFolderByPath;\n\n\t\tif(toFolderByPath === this.getCurrentFolder())\n\t\t{\n\t\t\tthis.notify(Loc.getMessage('MESSAGES_ALREADY_EXIST_IN_FOLDER'));\n\t\t\treturn;\n\t\t}\n\n\t\tlet id = undefined;\n\t\tconst popupSubmenu = BX.findParent(event.currentTarget, { className: 'popup-window' });\n\t\tif (popupSubmenu)\n\t\t{\n\t\t\tid = BX.data(popupSubmenu, 'grid-row-id');\n\t\t}\n\t\tconst isDisabled = JSON.parse(folderOptions.isDisabled);\n\n\t\tif ((id === undefined && this.getGridInstance().getRows().getSelectedIds().length === 0) || isDisabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet selected = this.getGridInstance().getRows().getSelected();\n\t\tlet idsForMoving = (id ? [id] : this.getGridInstance().getRows().getSelectedIds());\n\t\tidsForMoving = this.filterRowsByClassName(this.disabledClassName, idsForMoving, true);\n\t\tif (!idsForMoving.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// to hide the context menu\n\t\tBX.onCustomEvent('Grid::updated');\n\n\t\tlet selectedIds;\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = BX.Mail.Home.Grid.getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\n\t\tBX.Mail.Home.Grid.hideRowByIds(selectedIds);\n\n\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', selectedIds).length;\n\n\t\tif(this.getCurrentFolder() !== '')\n\t\t{\n\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t{\n\t\t\t\t\tname:toFolderByName,\n\t\t\t\t\tincrease: true,\n\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\t\tlower: true,\n\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t},\n\t\t\t]);\n\t\t}\n\n\t\tthis.runAction(\n\t\t\t'moveToFolder',\n\t\t\t{\n\t\t\t\tkeepRows: true,\n\t\t\t\tids: idsForMoving,\n\t\t\t\tparams: {\n\t\t\t\t\tfolder: toFolderByPath,\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t\t},\n\t\t\t},\n\t\t\t()=> {\n\t\t\t\tBX.Mail.Home.Grid.reloadTable();\n\t\t\t},\n\t\t);\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\t}\n\n\tonReadClick(id)\n\t{\n\t\tlet selected = [];\n\t\tlet resultIds = [];\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselected = this.getGridInstance().getRows().getSelected();\n\t\t\tresultIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet selectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t\tif(selectedIds.length === 1 && selectedIds[0]===id)\n\t\t\t{\n\t\t\t\t/*if the action is non-group, but one cell is selected,\n\t\t\t\tthen the action was performed through the \"Action panel\"\n\t\t\t\tand the selection should be reset*/\n\t\t\t\tselected = this.getGridInstance().getRows().getSelected();\n\t\t\t\tresultIds = selectedIds;\n\t\t\t\tid = undefined;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresultIds = [id];\n\t\t\t}\n\n\t\t}\n\t\tif (id === undefined && selected.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst actionName = 'all' == id || this.isSelectedRowsHaveClass('mail-msg-list-cell-unseen', id) ? 'markAsSeen' : 'markAsUnseen';\n\n\t\tresultIds = this.filterRowsByClassName('mail-msg-list-cell-unseen', resultIds, actionName !== 'markAsSeen');\n\t\tresultIds = this.filterRowsByClassName(this.disabledClassName, resultIds, true);\n\n\t\tif (!resultIds.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = function() {\n\t\t\tthis.userInterfaceManager.onMessagesRead(resultIds, { action: actionName });\n\t\t\tconst currentFolder = this.getCurrentFolder();\n\n\t\t\tconst oldMessagesCount = actionName !== 'markAsSeen'? this.isSelectedRowsHaveClass('mail-msg-list-cell-old') : 0;\n\t\t\tlet countMessages = resultIds.length - oldMessagesCount;\n\n\t\t\tif(this.getCurrentFolder() !== '')\n\t\t\t{\n\t\t\t\tif (actionName === 'markAsSeen')\n\t\t\t\t{\n\t\t\t\t\tif ('all' === id)\n\t\t\t\t\t{\n\t\t\t\t\t\tcountMessages = BX.Mail.Home.Counters.getCounter(currentFolder) - oldMessagesCount;\n\t\t\t\t\t}\n\n\t\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: currentFolder,\n\t\t\t\t\t\t\tlower: true,\n\t\t\t\t\t\t\tcount: countMessages,\n\t\t\t\t\t\t},\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: currentFolder,\n\t\t\t\t\t\t\tincrease: true,\n\t\t\t\t\t\t\tcount: countMessages,\n\t\t\t\t\t\t},\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(id === undefined) {\n\t\t\t\tthis.resetGridSelection();\n\t\t\t}\n\n\t\t\tif ('all' == id)\n\t\t\t{\n\t\t\t\tresultIds['for_all'] = this.mailboxId + '-' + this.userInterfaceManager.getCurrentFolder();\n\t\t\t}\n\n\t\t\tthis.userInterfaceManager.updateUnreadCounters();\n\n\t\t\tthis.runAction(actionName, {\n\t\t\t\tids: resultIds,\n\t\t\t\tkeepRows: true,\n\t\t\t\tsuccessParams: actionName,\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t\t},\n\t\t\t\tonSuccess: function(){\n\t\t\t\t\tthis.updateCountersFromBackend();\n\t\t\t\t}.bind(this),\n\t\t\t});\n\n\t\t\treturn true;\n\t\t};\n\t\thandler.apply(this);\n\t}\n\n\tonSpamClick(id)\n\t{\n\t\tconst selected = this.getGridInstance().getRows().getSelected();\n\t\tif (id === undefined && selected.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (!this.canMarkSpam)\n\t\t{\n\t\t\tthis.showDirsSlider();\n\t\t\treturn;\n\t\t}\n\t\tconst actionName = this.isSelectedRowsHaveClass('js-spam', id) ? 'restoreFromSpam' : 'markAsSpam';\n\t\tlet resultIds = this.filterRowsByClassName('js-spam', id, actionName !== 'restoreFromSpam');\n\t\tresultIds = this.filterRowsByClassName(this.disabledClassName, resultIds, true);\n\t\tif (!resultIds.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst options = {\n\t\t\tkeepRows: true,\n\t\t\tanalyticsLabel: {\n\t\t\t\t'groupCount': selected.length,\n\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t},\n\t\t};\n\n\t\tlet selectedIds;\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = BX.Mail.Home.Grid.getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\n\t\toptions.ids = selectedIds;\n\n\t\tBX.Mail.Home.Grid.hideRowByIds(selectedIds);\n\n\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', selectedIds).length;\n\n\t\tif(this.getCurrentFolder() !== '') {\n\t\t\tif (actionName === 'markAsSpam') {\n\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t{\n\t\t\t\t\t\tname: this.userInterfaceManager.spamDir,\n\t\t\t\t\t\tincrease: true,\n\t\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\t\t\tlower: true,\n\t\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t} else {\n\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t{\n\t\t\t\t\t\tname: this.userInterfaceManager.spamDir,\n\t\t\t\t\t\tlower: true,\n\t\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: this.userInterfaceManager.inboxDir,\n\t\t\t\t\t\tincrease: true,\n\t\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\n\t\tthis.runAction(actionName, options,() =>\n\t\t\tBX.Mail.Home.Grid.reloadTable()\n\t\t);\n\t\tif(id === undefined)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\t}\n\n\tgetConfirmDeletePopup(options)\n\t{\n\t\treturn new BX.UI.Dialogs.MessageBox({\n\t\t\ttitle: Loc.getMessage('MAIL_MESSAGE_LIST_CONFIRM_TITLE'),\n\t\t\tmessage: Loc.getMessage('MAIL_MESSAGE_LIST_CONFIRM_DELETE'),\n\t\t\tbuttons: [\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\tcolor: BX.UI.Button.Color.DANGER,\n\t\t\t\t\ttext: Loc.getMessage('MAIL_MESSAGE_LIST_CONFIRM_DELETE_BTN'),\n\t\t\t\t\tonclick: (function(button) {\n\n\t\t\t\t\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', options.ids).length;\n\n\t\t\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\t\t\t\t\tlower: true,\n\t\t\t\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]);\n\n\t\t\t\t\t\tthis.runAction('delete', options,() =>\n\t\t\t\t\t\t\tBX.Mail.Home.Grid.reloadTable()\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbutton.getContext().close();\n\t\t\t\t\t\tBX.Mail.Home.Grid.hideRowByIds(options.ids);\n\t\t\t\t\t}).bind(this),\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.CancelButton({\n\t\t\t\t\tonclick: function(button) {\n\t\t\t\t\t\tbutton.getContext().close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\t}\n\n\tresetGridSelection()\n\t{\n\t\tBX.onCustomEvent('Mail::resetGridSelection');\n\t\tthis.getGridInstance().getRows().unselectAll();\n\t\tthis.getGridInstance().adjustCheckAllCheckboxes();\n\t\tBX.Mail.Home.Grid.hidePanel();\n\t}\n\n\tisSelectedRowsHaveClass(className, id)\n\t{\n\t\tlet selectedIds;\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\t\tconst ids = selectedIds.length ? selectedIds : (id ? [id] : []);\n\n\t\tlet selectedLinesWithClassNumber = 0;\n\n\t\tfor (let i = 0; i < ids.length; i++)\n\t\t{\n\t\t\tconst row = this.getGridInstance().getRows().getById(ids[i]);\n\t\t\tif (row && row.node)\n\t\t\t{\n\t\t\t\tconst columns = row.node.getElementsByClassName(className);\n\t\t\t\tif (columns && columns.length)\n\t\t\t\t{\n\t\t\t\t\tselectedLinesWithClassNumber++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn selectedLinesWithClassNumber;\n\t}\n\n\tfilterRowsByClassName(className, ids, isReversed)\n\t{\n\t\tlet resIds = [];\n\t\tif ('all' == ids)\n\t\t{\n\t\t\tresIds = this.getGridInstance().getRows().getBodyChild().map(\n\t\t\t\tfunction(current) {\n\t\t\t\t\treturn current.getId();\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\telse if (Array.isArray(ids))\n\t\t{\n\t\t\tresIds = ids;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst selectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t\tresIds = selectedIds.length ? selectedIds : (ids ? [ids] : []);\n\t\t}\n\t\tconst resultIds = [];\n\t\tfor (let i = resIds.length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst row = this.getGridInstance().getRows().getById(resIds[i]);\n\t\t\tif (row && row.node)\n\t\t\t{\n\t\t\t\tconst columns = row.node.getElementsByClassName(className);\n\t\t\t\tif (!isReversed && (columns && columns.length))\n\t\t\t\t{\n\t\t\t\t\tresultIds.push(resIds[i]);\n\t\t\t\t}\n\t\t\t\telse if (isReversed && !(columns && columns.length))\n\t\t\t\t{\n\t\t\t\t\tresultIds.push(resIds[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn resultIds;\n\t}\n\n\tnotify(text, delay)\n\t{\n\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\tautoHideDelay: delay > 0 ? delay : 2000,\n\t\t\tcontent: text ? text : Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_SUCCESS'),\n\t\t});\n\t}\n\n\tupdateCountersFromBackend()\n\t{\n\t\tif(this.getCurrentFolder() === '')\n\t\t{\n\t\t\tBX.ajax.runComponentAction('bitrix:mail.client.message.list', 'getDirsWithUnseenMailCounters', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tmailboxId: this.mailboxId\n\t\t\t\t},\n\t\t\t}).then(\n\t\t\t\tfunction(response) {\n\t\t\t\t\tBX.Mail.Home.Counters.setCounters(response.data);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\trunAction(actionName, options, actionOnSuccess)\n\t{\n\t\toptions = options ? options : {};\n\n\t\tlet selectedIds = [];\n\n\t\tif (options.ids)\n\t\t{\n\t\t\tselectedIds = options.ids;\n\t\t}\n\t\tif (!selectedIds.length && !selectedIds.for_all)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (!options.keepRows)\n\t\t{\n\t\t\tthis.getGridInstance().tableFade();\n\t\t}\n\t\tconst data = { ids: selectedIds };\n\t\tif (options.params)\n\t\t{\n\t\t\tconst optionsKeys = Object.keys(Object(options.params));\n\t\t\tfor (let nextIndex = 0, len = optionsKeys.length; nextIndex < len; nextIndex++)\n\t\t\t{\n\t\t\t\tconst nextKey = optionsKeys[nextIndex];\n\t\t\t\tconst desc = Object.getOwnPropertyDescriptor(options.params, nextKey);\n\t\t\t\tif (desc !== undefined && desc.enumerable)\n\t\t\t\t{\n\t\t\t\t\tdata[nextKey] = options.params[nextKey];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tBX.ajax.runComponentAction('bitrix:mail.client', actionName, {\n\t\t\tmode: 'ajax',\n\t\t\tdata: data,\n\t\t\tanalyticsLabel: options.analyticsLabel,\n\t\t}).then(\n\t\t\tfunction() {\n\t\t\t\tif (options.onSuccess === false)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.updateCountersFromBackend();\n\n\t\t\t\tif (options.onSuccess && typeof (options.onSuccess) === \"function\")\n\t\t\t\t{\n\t\t\t\t\toptions.onSuccess.bind(this, selectedIds, options.successParams)();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(actionOnSuccess === undefined)\n\t\t\t\t{\n\t\t\t\t\tthis.notify();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactionOnSuccess();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\tfunction(response) {\n\t\t\t\tBX.Mail.Home.Counters.restoreFromCache();\n\t\t\t\tBX.Mail.Home.Grid.reloadTable();\n\t\t\t\toptions.onError && typeof (options.onError) === \"function\" ?\n\t\t\t\t\toptions.onError().bind(this, response) :\n\t\t\t\t\tthis.onErrorRequest(response);\n\t\t\t}.bind(this),\n\t\t);\n\t}\n\n\tonErrorRequest(response)\n\t{\n\t\tlet options = {};\n\t\tthis.checkErrorRights(response.errors);\n\t\toptions.errorMessage = response.errors[0].message;\n\t\tthis.notify(options.errorMessage);\n\t}\n\n\tcheckErrorRights(errors)\n\t{\n\t\tfor (let i = 0; i < errors.length; i++)\n\t\t{\n\t\t\tif (errors[i].code === this.ERROR_CODE_CAN_NOT_DELETE)\n\t\t\t{\n\t\t\t\tthis.canDelete = false;\n\t\t\t}\n\t\t\tif (errors[i].code === this.ERROR_CODE_CAN_NOT_MARK_SPAM)\n\t\t\t{\n\t\t\t\tthis.canMarkSpam = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tshowDirsSlider()\n\t{\n\t\tconst url = BX.util.add_url_param(\"/mail/config/dirs\", {\n\t\t\tmailboxId: this.mailboxId,\n\t\t});\n\t\tBX.SidePanel.Instance.open(url, {\n\t\t\twidth: 640,\n\t\t\tcacheable: false,\n\t\t\tallowChangeHistory: false,\n\t\t});\n\t\tthis.canDelete = true;\n\t\tthis.canMarkSpam = true;\n\t}\n\n\tonDisabledGroupActionClick()\n\t{\n\t}\n\n\tgetCurrentFolder()\n\t{\n\t\treturn this.userInterfaceManager.getCurrentFolder();\n\t}\n\n\tgetGridInstance()\n\t{\n\t\treturn BX.Main.gridManager.getById(this.gridId).instance;\n\t}\n\n\tgetRowsBindings(rows)\n\t{\n\t\treturn BX.util.array_unique(Array.prototype.concat.apply(\n\t\t\t[],\n\t\t\trows.map(\n\t\t\t\tfunction(row) {\n\t\t\t\t\tif (!row || !row.node)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Array.prototype.map.call(\n\t\t\t\t\t\trow.node.querySelectorAll('[class^=\"js-bind-\"] [data-type]'),\n\t\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\t\treturn node.dataset.type;\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t),\n\t\t));\n\t}\n\n\tgetCache(key)\n\t{\n\t\tif (!key)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.cache[key] ? this.cache[key] : null;\n\t}\n\n\tsetCache(key, value)\n\t{\n\t\treturn this.cache[key] = value;\n\t}\n\n\tshowICalMenuDropdown(event)\n\t{\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst menu = event.currentTarget.dataset.menu;\n\n\t\tif (!menu)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.iCalMenuDropdown = BX.Main.MenuManager.create({\n\t\t\tid: 'mail-client-message-list-ical-dropdown-menu',\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\titems: JSON.parse(menu),\n\t\t\tzIndex: 7001,\n\t\t\tmaxHeight: 400,\n\t\t\tmaxWidth: 200,\n\t\t\tangle: {\n\t\t\t\tposition: \"top\",\n\t\t\t\toffset: 40,\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function() {\n\t\t\t\t\tthis.removeICalMenuDropdown();\n\t\t\t\t}.bind(this),\n\t\t\t},\n\t\t});\n\t\tthis.iCalMenuDropdown.popupWindow.setBindElement(event.currentTarget);\n\t\tthis.iCalMenuDropdown.show();\n\t}\n\n\tremoveICalMenuDropdown()\n\t{\n\t\tif (this.iCalMenuDropdown)\n\t\t{\n\t\t\tBX.Main.MenuManager.destroy(this.iCalMenuDropdown.id);\n\t\t}\n\t}\n\n\tonClickICalButton(event)\n\t{\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst messageId = event.target.dataset.messageid || event.target.parentNode.dataset.messageid;\n\t\tconst action = event.target.dataset.action || event.target.parentNode.dataset.action;\n\t\tconst button = event.target;\n\n\t\tbutton.classList.add('ui-btn-wait');\n\t\tthis.removeICalMenuDropdown();\n\n\t\tthis.sendICal(messageId, action)\n\t\t\t.then(function() {\n\t\t\t\tbutton.classList.remove('ui-btn-wait');\n\t\t\t\tthis.notify(Loc.getMessage(action === 'cancelled' ? 'MAIL_MESSAGE_ICAL_NOTIFY_REJECT' : 'MAIL_MESSAGE_ICAL_NOTIFY_ACCEPT'));\n\t\t\t}.bind(this))\n\t\t\t.catch(function() {\n\t\t\t\tbutton.classList.remove('ui-btn-wait');\n\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_ICAL_NOTIFY_ERROR'));\n\t\t\t}.bind(this));\n\t}\n\n\tsendICal(messageId, action)\n\t{\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tBX.ajax.runComponentAction('bitrix:mail.client', 'ical', {\n\t\t\t\tmode: 'ajax',\n\t\t\t\tdata: { messageId, action },\n\t\t\t}).then(\n\t\t\t\tfunction() {\n\t\t\t\t\tresolve();\n\t\t\t\t}.bind(this),\n\t\t\t\tfunction() {\n\t\t\t\t\treject();\n\t\t\t\t}.bind(this),\n\t\t\t);\n\t\t});\n\t}\n}\n","import { Type, Reflection, Event, Loc } from 'main.core';\nimport { Avatar } from 'mail.avatar';\nimport { EventEmitter } from 'main.core.events';\nimport { MessageGrid } from 'mail.messagegrid';\nimport { ProgressBar } from './src/js/progressbar.es6';\nimport { Counters } from './src/js/counters.es6';\nimport { LeftMenu } from './src/js/leftmenu.es6';\nimport { List } from './src/js/list.es6';\nimport { Button } from 'ui.buttons';\n\nconst namespaceMailHome = Reflection.namespace('BX.Mail.Home');\n\nEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\tconst [messageEvent] = event.getCompatData();\n\tif(messageEvent.getEventId() === 'mail-mailbox-config-success')\n\t{\n\t\tBXMailMailbox.sync(namespaceMailHome.ProgressBar, namespaceMailHome.Grid.getId(), false,true);\n\t}\n});\n\nlet sliderPage;\nlet progressBar;\nlet errorBox;\nlet syncButtonWrapper;\n\nlet selectedIdsForRecovery = {};\n\nEvent.ready(() => {\n\n\tsyncButtonWrapper = document.querySelector('[data-role=\"mail-msg-sync-button-wrapper\"]');\n\n\tconst syncButton = new Button({\n\t\tclassName:\"ui-btn ui-btn-themes ui-btn-light-border mail-msg-sync-button\",\n\t\ticon: Button.Icon.BUSINESS,\n\t\tprops: {\n\t\t\ttitle: Loc.getMessage(\"MAIL_MESSAGE_SYNC_BTN_HINT\")\n\t\t},\n\t\tonclick: function() {\n\t\t\tBXMailMailbox.sync(namespaceMailHome.ProgressBar, Loc.getMessage(\"MAIL_MESSAGE_GRID_ID\"),false,true);\n\t\t},\n\t});\n\n\tsyncButtonWrapper.append(\n\t\tsyncButton.getContainer()\n\t)\n\n\tEventEmitter.subscribe('BX.Main.Grid:onBeforeReload', (event) => {\n\t\tconst [grid] = event.getCompatData();\n\t\tif(grid !== {} && grid !== undefined && Loc.getMessage(\"MAIL_MESSAGE_GRID_ID\") === grid.getId())\n\t\t{\n\t\t\tselectedIdsForRecovery = grid.getRows().getSelectedIds();\n\t\t}\n\t});\n\n\tEventEmitter.subscribe('Grid::updated', (event) => {\n\t\tconst [grid] = event.getCompatData();\n\n\t\tif(grid !== {} && grid !== undefined && Loc.getMessage(\"MAIL_MESSAGE_GRID_ID\") === grid.getId())\n\t\t{\n\t\t\tlet rowsWereSelected = false;\n\t\t\tnamespaceMailHome.Grid.getRows().map(function (row)\n\t\t\t{\n\t\t\t\tif(Type.isFunction(selectedIdsForRecovery.indexOf) && selectedIdsForRecovery.indexOf(row.getId()) !== -1)\n\t\t\t\t{\n\t\t\t\t\tif(row.isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\trow.select();\n\t\t\t\t\t\trowsWereSelected = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\tselectedIdsForRecovery = {}\n\n\t\t\tif(rowsWereSelected)\n\t\t\t{\n\t\t\t\tsetTimeout(\n\t\t\t\t\tfunction ()\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit(window,'Grid::thereSelectedRows');\n\t\t\t\t\t},\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tAvatar.replaceTagsWithAvatars({\n\t\tclassName: 'mail-ui-avatar',\n\t});\n\n\tsliderPage = document.getElementsByClassName(\"ui-slider-page\")[0];\n\tprogressBar = document.querySelector('[data-role=\"mail-progress-bar\"]');\n\tsliderPage.insertBefore(progressBar,sliderPage.firstChild);\n\terrorBox = document.querySelector('[data-role=\"error-box\"]');\n\n\tnamespaceMailHome.ProgressBar = new ProgressBar(progressBar);\n\tnamespaceMailHome.unreadMessageMailboxesMarker = document.querySelector('[data-role=\"unreadMessageMailboxesMarker\"]');;\n\n\tnamespaceMailHome.ProgressBar.setSyncButton(syncButton);\n\tnamespaceMailHome.ProgressBar.setErrorBoxNode(document.querySelector('[data-role=\"error-box\"]'))\n\tnamespaceMailHome.ProgressBar.setErrorTextNode(document.querySelector('[data-role=\"error-box-text\"]'));\n\tnamespaceMailHome.ProgressBar.setErrorHintNode(document.querySelector('[data-role=\"error-box-hint\"]'));\n\tnamespaceMailHome.ProgressBar.setErrorTitleNode(document.querySelector('[data-role=\"error-box-title\"]'));\n});\n\nBX.ready(function() {\n\tnamespaceMailHome.Counters = new Counters('dirs', Loc.getMessage(\"DEFAULT_DIR\"));\n\tnamespaceMailHome.mailboxCounters = new Counters('mailboxCounters');\n\tnamespaceMailHome.Grid = new MessageGrid(Loc.getMessage(\"MAILBOX_IS_SYNC_AVAILABILITY\"));\n});\nnamespaceMailHome.LeftMenu = LeftMenu;\n\nconst namespaceClientMessage = Reflection.namespace('BX.Mail.Client.Message');\nnamespaceClientMessage.List = List;\n"],"names":["ProgressBar","node","button","errorBoxNode","errorTitleNode","errorTextNode","errorHintNode","getSyncButton","undefined","setWaiting","classList","add","remove","Counters","name","selectedDirectory","_classPrivateFieldInitSpec","setDirectory","counters","shortcut","shortcuts","path","getDirPath","resultCounters","getCounter","sendCounterUpdateEvent","shortcutName","counterNames","counter","hiddenCountersForTotalCounter","count","Number","cacheCounters","i","length","addCounter","addCounters","isExists","newValue","cachedCounters","Object","assign","increase","lower","countersAreNotLoadedFromTheServer","lowerCounter","increaseCounter","event","BaseEvent","data","hidden","getName","total","getTotalCounter","EventEmitter","emit","LeftMenu","config","dirsWithUnseenMailCounters","mailboxId","filterId","systemDirs","spam","trash","outcome","drafts","inbox","leftDirectoryMenuWrapper","document","querySelector","directoryMenu","DirectoryMenu","append","getNode","List","options","mailReadAllButton","gridId","canMarkSpam","canDelete","ERROR_CODE_CAN_NOT_DELETE","ERROR_CODE_CAN_NOT_MARK_SPAM","disabledClassName","userInterfaceManager","BX","Mail","Client","Message","UserInterfaceManager","resetGridSelection","bind","isSelectedRowsHaveClass","getGridInstance","updateCountersFromBackend","cache","addEventHandlers","id","ajax","UpdatePageData","subscribe","menuItem","target","container","getMenuWindow","getPopupWindow","getPopupContainer","getSubMenu","gridRowId","Home","LeftMenuNode","setCounters","mailboxCounters","updateLeftMenuCounter","dataset","menuWindow","subMenuItems","getMenuItems","hash","dirMd5","hasChild","item","getId","hasSubMenu","showSubMenu","subMenu","hasLoadingItem","items","k","subItem","loadLevelMenu","itemsMenu","querySelectorAll","addEventListener","showICalMenuDropdown","bindDelegate","body","className","onClickICalButton","menu","getCache","popup","Main","PopupManager","getPopupById","destroy","destroySubMenu","addSubMenu","Loc","getMessage","runComponentAction","mode","dir","then","response","dirs","test","FLAGS","PATH","NAME","DIR_MD5","IS_DISABLED","push","setCache","isShown","selected","getRows","getSelected","row","getById","addToCrm","isAddToCrmActionAvailable","messageIdNode","messageId","crmBtnInRow","startWait","isAddingToCrmInProgress","analyticsLabel","getRowsBindings","notify","json","stopWait","errors","map","message","join","onCrmBindingDeleted","selectedIds","getSelectedIds","SidePanel","Instance","open","width","loader","additionalOptions","onDeleteClick","showDirsSlider","params","keepRows","Grid","filterRowsByClassName","ids","isCurrentFolderTrash","confirmPopup","getConfirmDeletePopup","show","hideRowByIds","unseenRowsIdsCount","getCurrentFolder","updateCounters","runAction","reloadTable","folderOptions","currentTarget","toFolderByPath","toFolderByName","popupSubmenu","findParent","isDisabled","JSON","parse","idsForMoving","onCustomEvent","folder","resultIds","actionName","handler","onMessagesRead","action","currentFolder","oldMessagesCount","countMessages","updateUnreadCounters","successParams","onSuccess","apply","spamDir","inboxDir","UI","Dialogs","MessageBox","title","buttons","Button","color","Color","DANGER","text","onclick","getContext","close","CancelButton","unselectAll","adjustCheckAllCheckboxes","hidePanel","selectedLinesWithClassNumber","columns","getElementsByClassName","isReversed","resIds","getBodyChild","current","Array","isArray","delay","top","Notification","Center","autoHideDelay","content","actionOnSuccess","for_all","tableFade","optionsKeys","keys","nextIndex","len","nextKey","desc","getOwnPropertyDescriptor","enumerable","restoreFromCache","onError","onErrorRequest","checkErrorRights","errorMessage","code","url","util","add_url_param","cacheable","allowChangeHistory","gridManager","instance","rows","array_unique","prototype","concat","call","type","key","value","stopPropagation","preventDefault","iCalMenuDropdown","MenuManager","create","autoHide","closeByEsc","zIndex","maxHeight","maxWidth","angle","position","offset","events","onPopupClose","removeICalMenuDropdown","popupWindow","setBindElement","messageid","parentNode","sendICal","Promise","resolve","reject","namespaceMailHome","Reflection","namespace","getCompatData","messageEvent","getEventId","BXMailMailbox","sync","sliderPage","progressBar","errorBox","syncButtonWrapper","selectedIdsForRecovery","Event","ready","syncButton","icon","Icon","BUSINESS","props","getContainer","grid","rowsWereSelected","Type","isFunction","indexOf","select","setTimeout","window","Avatar","replaceTagsWithAvatars","insertBefore","firstChild","unreadMessageMailboxesMarker","setSyncButton","setErrorBoxNode","setErrorTextNode","setErrorHintNode","setErrorTitleNode","MessageGrid","namespaceClientMessage"],"mappings":"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"}