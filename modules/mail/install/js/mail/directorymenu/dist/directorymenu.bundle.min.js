this.BX=this.BX||{};(function(e,t,i){"use strict";var a,r;function l(e,t,i){s(e,t);t.set(e,i)}function s(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var n=new WeakMap;var u=new WeakMap;var c=new WeakMap;var o=new WeakMap;var v=new WeakMap;var b=new WeakMap;var d=new WeakMap;var h=new WeakMap;var p=new WeakMap;var f=function(){babelHelpers.createClass(e,[{key:"setCount",value:function e(t){babelHelpers.classPrivateFieldSet(this,n,t);babelHelpers.classPrivateFieldGet(this,o).textContent=t;if(t===0){babelHelpers.classPrivateFieldGet(this,o).classList.add("ui-sidepanel-menu-link-text-counter-hidden")}else{babelHelpers.classPrivateFieldGet(this,o).classList.remove("ui-sidepanel-menu-link-text-counter-hidden")}}},{key:"getCount",value:function e(){return Number(babelHelpers.classPrivateFieldGet(this,n))}},{key:"disableActivity",value:function e(){babelHelpers.classPrivateFieldSet(this,b,false);babelHelpers.classPrivateFieldGet(this,v).classList.remove("ui-sidepanel-menu-active")}},{key:"getPath",value:function e(){return babelHelpers.classPrivateFieldGet(this,d)}},{key:"enableActivity",value:function e(){babelHelpers.classPrivateFieldSet(this,b,true);babelHelpers.classPrivateFieldGet(this,v).classList.add("ui-sidepanel-menu-active")}},{key:"isActive",value:function e(){return babelHelpers.classPrivateFieldGet(this,b)}}],[{key:"checkProperties",value:function e(t){if(t["path"]===undefined||t["name"]===undefined||t["name"]===undefined){return false}return true}}]);function e(t,s){var f=this;var m=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var y=arguments.length>3?arguments[3]:undefined;babelHelpers.classCallCheck(this,e);l(this,n,{writable:true,value:0});l(this,u,{writable:true,value:""});l(this,c,{writable:true,value:""});l(this,o,{writable:true,value:void 0});l(this,v,{writable:true,value:void 0});l(this,b,{writable:true,value:void 0});l(this,d,{writable:true,value:void 0});l(this,h,{writable:true,value:10});l(this,p,{writable:true,value:29});babelHelpers.classPrivateFieldSet(this,d,t["path"]);var F="default";if(y["inbox"]===babelHelpers.classPrivateFieldGet(this,d)){F="inbox"}else if(y["spam"]===babelHelpers.classPrivateFieldGet(this,d)){F="spam"}else if(y["outcome"]===babelHelpers.classPrivateFieldGet(this,d)){F="outcome"}else if(y["trash"]===babelHelpers.classPrivateFieldGet(this,d)){F="trash"}else if(y["drafts"]===babelHelpers.classPrivateFieldGet(this,d)){F="drafts"}babelHelpers.classPrivateFieldSet(this,u,t["name"]);babelHelpers.classPrivateFieldSet(this,c,babelHelpers.classPrivateFieldGet(this,u).charAt(0).toUpperCase()+babelHelpers.classPrivateFieldGet(this,u).slice(1));var H=i.Tag.render(a||(a=babelHelpers.taggedTemplateLiteral(['<div title="','" class="mail-menu-directory-item-container"></div>'])),babelHelpers.classPrivateFieldGet(this,c));var P=i.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<li class="ui-sidepanel-menu-item ui-sidepanel-menu-counter-white mail-menu-directory-item-','">\n\t\t\t\t<a style="padding-left: ','px" class="ui-sidepanel-menu-link">\n\t\t\t\t\t<div class="ui-sidepanel-menu-link-text">\n\t\t\t\t\t\t<span class="ui-sidepanel-menu-link-text-item">','</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class="ui-sidepanel-menu-link-text-counter">',"</span>\n\t\t\t\t</a>\n\t\t\t</li>"])),F,babelHelpers.classPrivateFieldGet(this,p)+babelHelpers.classPrivateFieldGet(this,h)*m,babelHelpers.classPrivateFieldGet(this,c),t["count"]);H.append(P);P.onclick=function(){if(!H.isActive()){s.chooseFunction(t["path"]);H.enableActivity()}};var k=P.querySelector(".ui-sidepanel-menu-link-text-counter");babelHelpers.classPrivateFieldSet(this,o,k);babelHelpers.classPrivateFieldSet(this,v,P);H.getCount=function(){return f.getCount()};H.setCount=function(e){return f.setCount(e)};H.enableActivity=function(){return f.enableActivity()};H.disableActivity=function(){return f.disableActivity()};H.isActive=function(){return f.isActive()};H.setIconClass=function(e){return f.setIconClass(e)};this.setCount(t["count"]);for(var w=0;w<t["items"].length;w++){if(!e.checkProperties(t["items"][w])){continue}var g=new e(t["items"][w],s,m+1,y);H.append(g)}s.includeItem(H,babelHelpers.classPrivateFieldGet(this,d));return H}return e}();var m;function y(e,t){var i=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=F(e))||t&&e&&typeof e.length==="number"){if(i)e=i;var a=0;var r=function e(){};return{s:r,n:function t(){if(a>=e.length)return{done:true};return{done:false,value:e[a++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,s=false,n;return{s:function t(){i=i.call(e)},n:function e(){var t=i.next();l=t.done;return t},e:function e(t){s=true;n=t},f:function e(){try{if(!l&&i["return"]!=null)i["return"]()}finally{if(s)throw n}}}}function F(e,t){if(!e)return;if(typeof e==="string")return H(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor)i=e.constructor.name;if(i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return H(e,t)}function H(e,t){if(t==null||t>e.length)t=e.length;for(var i=0,a=new Array(t);i<t;i++){a[i]=e[i]}return a}function P(e,t,i){k(e,t);t.set(e,i)}function k(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var w=new WeakMap;var g=new WeakMap;var M=new WeakMap;var C=new WeakMap;var G=new WeakMap;var A=function(){babelHelpers.createClass(e,[{key:"getActiveDir",value:function e(){return babelHelpers.classPrivateFieldGet(this,w)}},{key:"setActiveDir",value:function e(t){babelHelpers.classPrivateFieldSet(this,w,t)}},{key:"clearActiveMenuButtons",value:function e(){var t=y(babelHelpers.classPrivateFieldGet(this,C).values()),i;try{for(t.s();!(i=t.n()).done;){var a=i.value;a.disableActivity()}}catch(e){t.e(e)}finally{t.f()}}},{key:"rebuildMenu",value:function e(t){babelHelpers.classPrivateFieldSet(this,M,t);this.cleanItems();this.buildMenu();this.setDirectory(this.getActiveDir())}},{key:"cleanItems",value:function e(){var t=y(babelHelpers.classPrivateFieldGet(this,C).values()),i;try{for(t.s();!(i=t.n()).done;){var a=i.value;babelHelpers.classPrivateFieldGet(this,g).removeChild(a)}}catch(e){t.e(e)}finally{t.f()}babelHelpers.classPrivateFieldGet(this,C).clear()}},{key:"includeItem",value:function e(t,i){babelHelpers.classPrivateFieldGet(this,C).set(i,t);babelHelpers.classPrivateFieldGet(this,g).append(t)}},{key:"chooseFunction",value:function e(t){this.clearActiveMenuButtons();this.setActiveDir(t);this.setFilterDir(t)}},{key:"buildMenu",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;for(var i=0;i<babelHelpers.classPrivateFieldGet(this,M).length;i++){var a=babelHelpers.classPrivateFieldGet(this,M)[i];var r=a["path"];if(!f.checkProperties(a)){continue}if(babelHelpers.classPrivateFieldGet(this,G)["inbox"]===r&&t){BX.Mail.Home.FilterToolbar.setCount(a["count"])}new f(a,this,0,babelHelpers.classPrivateFieldGet(this,G))}}},{key:"setFilterDir",value:function e(i){var a=new t.BaseEvent({data:{directory:i}});t.EventEmitter.emit("BX.DirectoryMenu:onChangeFilter",a);i=BX.Mail.Home.Counters.getShortcut(i);var r=this.filter;if(!!r&&r instanceof BX.Main.Filter){var l=r.getApi();l.setFields({DIR:i});l.apply()}}},{key:"changeCounter",value:function e(t,i,a){var r=babelHelpers.classPrivateFieldGet(this,C).get(t);if(r===undefined)return;if(a!=="set"){r.setCount(r.getCount()+Number(i))}else{r.setCount(Number(i))}}},{key:"setCounters",value:function e(t){for(var i in t){if(t.hasOwnProperty(i)){this.changeCounter(i,t[i],"set")}}}},{key:"setDirectory",value:function e(t){this.clearActiveMenuButtons();if(t===undefined)return;var i=babelHelpers.classPrivateFieldGet(this,C).get(t);if(i){this.setActiveDir(t);i.enableActivity()}}}]);function e(){var a=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{dirsWithUnseenMailCounters:{},filterId:"",systemDirs:{spam:"Spam",trash:"Trash",outcome:"Outcome",drafts:"Drafts",inbox:"Inbox"}};babelHelpers.classCallCheck(this,e);P(this,w,{writable:true,value:""});P(this,g,{writable:true,value:i.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['<ul class="ui-mail-left-directory-menu"></ul>'])))});P(this,M,{writable:true,value:new Map});P(this,C,{writable:true,value:new Map});P(this,G,{writable:true,value:[]});this.filter=BX.Main.filterManager.getById(r["filterId"]);babelHelpers.classPrivateFieldSet(this,G,r["systemDirs"]);t.EventEmitter.subscribe("BX.Main.Filter:apply",(function(e){var i=BX.Mail.Home.Counters.getDirPath(a.filter.getFilterFieldsValues()["DIR"]);t.EventEmitter.emit("BX.DirectoryMenu:onChangeFilter",new t.BaseEvent({data:{directory:i}}));a.setDirectory(i)}));babelHelpers.classPrivateFieldSet(this,M,r["dirsWithUnseenMailCounters"]);this.buildMenu(true)}babelHelpers.createClass(e,[{key:"getNode",value:function e(){return babelHelpers.classPrivateFieldGet(this,g)}}]);return e}();e.DirectoryMenu=A})(this.BX.Mail=this.BX.Mail||{},BX.Event,BX);
//# sourceMappingURL=directorymenu.bundle.map.js