{"version":3,"file":"binding.bundle.js","sources":["../src/item.js","../src/binding.js"],"sourcesContent":["import { Loc, Tag } from 'main.core';\nimport {UI} from 'ui.notification';\n\nexport class Item\n{\n\t#text;\n\t#active = false;\n\t#id;\n\t#href;\n\t#bindingType;\n\t#wait = false;\n\t#node;\n\t#messageId;\n\t#messageSimpleId;\n\t#createHref;\n\t#waitCSSClassName = 'ui-btn-wait';\n\t#errorType;\n\n\t#phrases = {\n\t\t'crm' : 'MAIL_BINDING_CRM_',\n\t\t'chat' : 'MAIL_BINDING_CHAT_',\n\t\t'task' : 'MAIL_BINDING_TASK_',\n\t\t'post' : 'MAIL_BINDING_POST_',\n\t\t'meeting' : 'MAIL_BINDING_MEETING_'\n\t}\n\n\tstatic #errorPhrases = {\n\t\t'crm-install-error' : 'MAIL_BINDING_CRM_ERROR',\n\t\t'calendar-install-error' : 'MAIL_BINDING_MEETING_ERROR',\n\t\t'tasks-install-error' : 'MAIL_BINDING_TASK_ERROR',\n\t\t'chat-install-error' : 'MAIL_BINDING_CHAT_ERROR',\n\t\t'socialnetwork-install-error' : 'MAIL_BINDING_POST_ERROR',\n\t\t'crm-install-permission-error' : 'MAIL_BINDING_CRM_PERMISSION_SAVE_ERROR',\n\t\t'crm-install-permission-open-error' : 'MAIL_BINDING_CRM_PERMISSION_OPEN_ERROR',\n\t\t'crm-install-permission-working-error' :'MAIL_BINDING_CRM_PERMISSION_WORKING_ERROR',\n\t}\n\n\t#phrasesFull = {\n\t\t'crm' : 'MAIL_BINDING_CRM_TITLE',\n\t\t'chat' : 'MAIL_BINDING_CHAT_TITLE',\n\t\t'task' : 'MAIL_BINDING_TASK_TITLE',\n\t\t'post' : 'MAIL_BINDING_POST_TITLE',\n\t\t'meeting' : 'MAIL_BINDING_MEETING_TITLE'\n\t}\n\n\t#classes = {\n\t\t'crm' : 'mail-binding-crm',\n\t\t'chat' : 'mail-binding-chat',\n\t\t'task' : 'mail-binding-task',\n\t\t'post' : 'mail-binding-post',\n\t\t'meeting' : 'mail-binding-meeting'\n\t}\n\n\tisError(errorKey)\n\t{\n\t\tif(Item.#errorPhrases[errorKey] !== undefined)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.#active;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetMessageId(simple = false)\n\t{\n\t\tif(!simple)\n\t\t{\n\t\t\treturn this.#messageId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#messageSimpleId;\n\t\t}\n\t}\n\n\tconstructor(config = {\n\t\ttype: '',\n\t\tid: '',\n\t})\n\t{\n\t\tthis.#errorType = config['errorType'];\n\t\tthis.#messageId = config['messageId'];\n\t\tthis.#id = config['id'];\n\t\tthis.#href = config['href'];\n\t\tthis.#bindingType = config['type'];\n\t\tthis.#messageSimpleId = config['messageSimpleId'];\n\t\tthis.#createHref =  config['createHref'];\n\n\t\tif(this.#id)\n\t\t{\n\t\t\tthis.#active = true;\n\t\t}\n\n\t\tif(this.isActive())\n\t\t{\n\t\t\tthis.#text = Loc.getMessage(this.#phrases[this.#bindingType]+'ACTIVE');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#text = Loc.getMessage(this.#phrases[this.#bindingType]+'NOT_ACTIVE');\n\t\t}\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.#bindingType;\n\t}\n\n\tstatic showError(key)\n\t{\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage(Item.#errorPhrases[key]),\n\t\t});\n\t}\n\n\tonClick(event)\n\t{\n\t\tif(this.isError(this.#errorType))\n\t\t{\n\t\t\tItem.showError(this.#errorType);\n\t\t\treturn;\n\t\t}\n\n\t\tif(this.isActive())\n\t\t{\n\t\t\t//to join the chat if you left it\n\t\t\tif (this.getType() === 'chat')\n\t\t\t{\n\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openChat();\n\t\t\t}\n\t\t}\n\t\telse if(!this.#wait)\n\t\t{\n\t\t\tswitch (this.getType())\n\t\t\t{\n\t\t\t\tcase 'crm':\n\t\t\t\t\tthis.startWait();\n\t\t\t\t\tBX.Mail.Client.Message.List[\"mail-client-list-manager\"].onCrmClick(this.getMessageId());\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'chat':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openChat();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'task':\n\t\t\t\t\ttop.BX.SidePanel.Instance.open(this.#createHref);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'post':\n\t\t\t\t\ttop.BX.SidePanel.Instance.open(this.#createHref);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'meeting':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openCalendarEvent();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHref()\n\t{\n\t\treturn this.#href;\n\t}\n\n\tsetText(text)\n\t{\n\t\tthis.#node.textContent = text;\n\t}\n\n\tgetNode()\n\t{\n\t\treturn this.#node;\n\t}\n\n\tstartWait()\n\t{\n\t\tthis.#wait = true;\n\t\tthis.getNode().classList.add(this.#waitCSSClassName);\n\t}\n\n\tstopWait()\n\t{\n\t\tthis.#wait = false;\n\t\tthis.getNode().classList.remove(this.#waitCSSClassName);\n\t}\n\n\tsetActive(href)\n\t{\n\t\tthis.stopWait();\n\t\tthis.getNode().classList.remove(\"mail-ui-not-active\");\n\t\tthis.getNode().classList.add(\"mail-ui-active\");\n\t\tthis.setText(Loc.getMessage(this.#phrases[this.getType()]+'ACTIVE'));\n\t\tthis.getNode().setAttribute(\"href\", href);\n\t\tthis.#active = true;\n\t\tthis.updateTitle();\n\t}\n\n\tdeactivation()\n\t{\n\t\tthis.stopWait();\n\t\tthis.getNode().classList.add(\"mail-ui-not-active\");\n\t\tthis.getNode().classList.remove(\"mail-ui-active\");\n\t\tthis.setText(Loc.getMessage(this.#phrases[this.getType()]+'NOT_ACTIVE'));\n\t\tthis.getNode().removeAttribute(\"href\");\n\t\tthis.#active = false;\n\t\tthis.updateTitle();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn Loc.getMessage(this.#phrasesFull[this.getType()]+(this.isActive() ? '_ACTIVE' :''));\n\t}\n\n\tupdateTitle()\n\t{\n\t\tthis.getNode().removeAttribute(\"title\");\n\t\tthis.getNode().setAttribute(\"title\", this.getTitle());\n\t}\n\n\trender()\n\t{\n\t\tconst activeClass = this.isActive() ? 'mail-ui-active' : 'mail-ui-not-active';\n\t\tconst item = Tag.render`\n\t\t\t<a class=\"mail-ui-binding ui-btn-light-border ui-btn ui-btn-xs ui-btn-round ui-btn-no-caps ${this.#classes[this.getType()]} ${activeClass} js-bind-${this.getMessageId(true)}\">\n\t\t\t\t${this.#text}\n\t\t\t</a>`\n\n\t\tthis.#node = item;\n\t\tthis.#node.object = this;\n\n\t\tthis.updateTitle();\n\n\t\titem.onclick = function()\n\t\t{\n\t\t\tthis.object.onClick();\n\t\t};\n\n\t\titem.ondblclick = event => {\n\t\t\tevent.stopPropagation();\n\t\t};\n\n\t\titem.setActive = function(href)\n\t\t{\n\t\t\tthis.object.setActive(href);\n\t\t};\n\n\t\titem.deactivation = function()\n\t\t{\n\t\t\tthis.object.deactivation();\n\t\t};\n\n\t\titem.startWait = function()\n\t\t{\n\t\t\tthis.object.startWait();\n\t\t};\n\n\t\titem.stopWait = function()\n\t\t{\n\t\t\tthis.object.stopWait();\n\t\t};\n\n\t\tif(this.#errorType === 'crm-install-permission-error' && this.getHref())\n\t\t{\n\t\t\tthis.#errorType = 'crm-install-permission-open-error';\n\t\t}\n\n\t\tif(this.isActive() && !this.isError(this.#errorType))\n\t\t{\n\t\t\titem.setAttribute(\"href\", this.getHref());\n\t\t}\n\n\t\treturn item;\n\t}\n}","import { Tag } from 'main.core';\nimport { Loc } from 'main.core';\nimport { Item } from './item.js';\nimport { EventEmitter } from \"main.core.events\";\n\nexport class Binding\n{\n\t#mailboxId;\n\n\t#selectors = {\n\t\tCRM_ACTIVITY: '.mail-binding-crm',\n\t\tTASKS_TASK: '.mail-binding-task',\n\t\tIM_CHAT: '.mail-binding-chat',\n\t\tBLOG_POST: '.mail-binding-post',\n\t\tCALENDAR_EVENT: '.mail-binding-meeting',\n\t};\n\n\tgetMailbox()\n\t{\n\t\treturn this.#mailboxId;\n\t}\n\n\tconstructor(mailboxId)\n\t{\n\t\tthis.#mailboxId = mailboxId;\n\n\t\tEventEmitter.subscribe('onPullEvent-mail', (event) => {\n\n\t\t\tlet data = event.getData();\n\n\t\t\tif(data[0] === \"messageBindingCreated\" && (data[1]['mailboxId'] === this.getMailbox() || data[1]['mailboxId'] === String(this.getMailbox())))\n\t\t\t{\n\t\t\t\tconst binding = data[1];\n\t\t\t\tconst messageSimpleId = binding['messageId'];\n\n\t\t\t\tconst bindingWrapper = document.querySelector(\"\"+('.js-bind-' + messageSimpleId) + this.#selectors[binding['entityType']] + \"\");\n\n\t\t\t\tif (bindingWrapper)\n\t\t\t\t{\n\t\t\t\t\tbindingWrapper.setActive(binding['bindingEntityLink']);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(data[0] === \"messageBindingDeleted\" && (data[1]['mailboxId'] === this.getMailbox() || data[1]['mailboxId'] === String(this.getMailbox())))\n\t\t\t{\n\t\t\t\tconst binding = data[1];\n\t\t\t\tconst messageSimpleId = binding['messageId'];\n\n\t\t\t\tconst bindingWrapper = document.querySelector(\"\"+('.js-bind-' + messageSimpleId) + this.#selectors[binding['entityType']] + \"\");\n\n\t\t\t\tif (bindingWrapper)\n\t\t\t\t{\n\t\t\t\t\tbindingWrapper.deactivation();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic build(config)\n\t{\n\t\tconst item = new Item(config);\n\t\treturn item.render();\n\t}\n\n\tstatic replaceElement(object)\n\t{\n\t\tconst parent = object.parentNode;\n\n\t\tlet newObject = this.build({\n\t\t\ttype: object.getAttribute('bind-type'),\n\t\t\tid:  object.getAttribute('bind-id'),\n\t\t\tmessageId: object.getAttribute('message-id'),\n\t\t\tmessageSimpleId: object.getAttribute('message-simple-id'),\n\t\t\thref:  object.getAttribute('bind-href'),\n\t\t\tcreateHref: object.getAttribute('create-href'),\n\t\t\terrorType: object.getAttribute('error-type'),\n\t\t});\n\t\tparent.replaceChild(newObject,object);\n\t}\n\n\tstatic initButtons(context: HTMLElement = document.body)\n\t{\n\t\tconst elements = Array.from(context.getElementsByClassName('mail-ui-binding-data'));\n\t\tfor (let element of elements)\n\t\t{\n\t\t\tthis.replaceElement(element);\n\t\t}\n\t}\n}"],"names":["Item","errorKey","undefined","simple","config","type","id","isActive","Loc","getMessage","event","isError","showError","getType","BX","Mail","Secretary","getInstance","getMessageId","openChat","startWait","Client","Message","List","onCrmClick","top","SidePanel","Instance","open","openCalendarEvent","text","textContent","getNode","classList","add","remove","href","stopWait","setText","setAttribute","updateTitle","removeAttribute","getTitle","activeClass","item","Tag","render","object","onclick","onClick","ondblclick","stopPropagation","setActive","deactivation","getHref","key","UI","Notification","Center","notify","content","Binding","mailboxId","_classPrivateFieldInitSpec","CRM_ACTIVITY","TASKS_TASK","IM_CHAT","BLOG_POST","CALENDAR_EVENT","EventEmitter","subscribe","data","getData","getMailbox","String","binding","messageSimpleId","bindingWrapper","document","querySelector","parent","parentNode","newObject","build","getAttribute","messageId","createHref","errorType","replaceChild","context","body","elements","Array","from","getElementsByClassName","element","replaceElement"],"mappings":"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"}