{"version":3,"file":"binding.bundle.js","sources":["../src/item.js","../src/binding.js"],"sourcesContent":["import { Loc, Tag } from 'main.core';\nimport {UI} from 'ui.notification';\n\nexport class Item\n{\n\t#text;\n\t#active = false;\n\t#id;\n\t#href;\n\t#bindingType;\n\t#wait = false;\n\t#node;\n\t#messageId;\n\t#messageSimpleId;\n\t#createHref;\n\t#waitCSSClassName = 'ui-btn-wait';\n\t#errorType;\n\n\t#phrases = {\n\t\t'crm' : 'MAIL_BINDING_CRM_',\n\t\t'chat' : 'MAIL_BINDING_CHAT_',\n\t\t'task' : 'MAIL_BINDING_TASK_',\n\t\t'post' : 'MAIL_BINDING_POST_',\n\t\t'meeting' : 'MAIL_BINDING_MEETING_'\n\t}\n\n\tstatic #errorPhrases = {\n\t\t'crm-install-error' : 'MAIL_BINDING_CRM_ERROR',\n\t\t'calendar-install-error' : 'MAIL_BINDING_MEETING_ERROR',\n\t\t'tasks-install-error' : 'MAIL_BINDING_TASK_ERROR',\n\t\t'chat-install-error' : 'MAIL_BINDING_CHAT_ERROR',\n\t\t'socialnetwork-install-error' : 'MAIL_BINDING_POST_ERROR',\n\t\t'crm-install-permission-error' : 'MAIL_BINDING_CRM_PERMISSION_SAVE_ERROR',\n\t\t'crm-install-permission-open-error' : 'MAIL_BINDING_CRM_PERMISSION_OPEN_ERROR',\n\t\t'crm-install-permission-working-error' :'MAIL_BINDING_CRM_PERMISSION_WORKING_ERROR',\n\t}\n\n\t#phrasesFull = {\n\t\t'crm' : 'MAIL_BINDING_CRM_TITLE',\n\t\t'chat' : 'MAIL_BINDING_CHAT_TITLE',\n\t\t'task' : 'MAIL_BINDING_TASK_TITLE',\n\t\t'post' : 'MAIL_BINDING_POST_TITLE',\n\t\t'meeting' : 'MAIL_BINDING_MEETING_TITLE'\n\t}\n\n\t#classes = {\n\t\t'crm' : 'mail-binding-crm',\n\t\t'chat' : 'mail-binding-chat',\n\t\t'task' : 'mail-binding-task',\n\t\t'post' : 'mail-binding-post',\n\t\t'meeting' : 'mail-binding-meeting'\n\t}\n\n\tisError(errorKey)\n\t{\n\t\tif(Item.#errorPhrases[errorKey] !== undefined)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.#active;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetMessageId(simple = false)\n\t{\n\t\tif(!simple)\n\t\t{\n\t\t\treturn this.#messageId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#messageSimpleId;\n\t\t}\n\t}\n\n\tconstructor(config = {\n\t\ttype: '',\n\t\tid: '',\n\t})\n\t{\n\t\tthis.#errorType = config['errorType'];\n\t\tthis.#messageId = config['messageId'];\n\t\tthis.#id = config['id'];\n\t\tthis.#href = config['href'];\n\t\tthis.#bindingType = config['type'];\n\t\tthis.#messageSimpleId = config['messageSimpleId'];\n\t\tthis.#createHref =  config['createHref'];\n\n\t\tif(this.#id)\n\t\t{\n\t\t\tthis.#active = true;\n\t\t}\n\n\t\tif(this.isActive())\n\t\t{\n\t\t\tthis.#text = Loc.getMessage(this.#phrases[this.#bindingType]+'ACTIVE');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#text = Loc.getMessage(this.#phrases[this.#bindingType]+'NOT_ACTIVE');\n\t\t}\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.#bindingType;\n\t}\n\n\tstatic showError(key)\n\t{\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage(Item.#errorPhrases[key]),\n\t\t});\n\t}\n\n\tonClick(event)\n\t{\n\t\tif(this.isError(this.#errorType))\n\t\t{\n\t\t\tItem.showError(this.#errorType);\n\t\t\treturn;\n\t\t}\n\n\t\tif(this.isActive())\n\t\t{\n\t\t\t//to join the chat if you left it\n\t\t\tif (this.getType() === 'chat')\n\t\t\t{\n\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openChat();\n\t\t\t}\n\t\t}\n\t\telse if(!this.#wait)\n\t\t{\n\t\t\tswitch (this.getType())\n\t\t\t{\n\t\t\t\tcase 'crm':\n\t\t\t\t\tthis.startWait();\n\t\t\t\t\tBX.Mail.Client.Message.List[\"mail-client-list-manager\"].onCrmClick(this.getMessageId());\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'chat':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openChat();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'task':\n\t\t\t\t\ttop.BX.SidePanel.Instance.open(this.#createHref);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'post':\n\t\t\t\t\ttop.BX.SidePanel.Instance.open(this.#createHref);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'meeting':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openCalendarEvent();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHref()\n\t{\n\t\treturn this.#href;\n\t}\n\n\tsetText(text)\n\t{\n\t\tthis.#node.textContent = text;\n\t}\n\n\tgetNode()\n\t{\n\t\treturn this.#node;\n\t}\n\n\tstartWait()\n\t{\n\t\tthis.#wait = true;\n\t\tthis.getNode().classList.add(this.#waitCSSClassName);\n\t}\n\n\tstopWait()\n\t{\n\t\tthis.#wait = false;\n\t\tthis.getNode().classList.remove(this.#waitCSSClassName);\n\t}\n\n\tsetActive(href)\n\t{\n\t\tthis.stopWait();\n\t\tthis.getNode().classList.remove(\"mail-ui-not-active\");\n\t\tthis.getNode().classList.add(\"mail-ui-active\");\n\t\tthis.setText(Loc.getMessage(this.#phrases[this.getType()]+'ACTIVE'));\n\t\tthis.getNode().setAttribute(\"href\", href);\n\t\tthis.#active = true;\n\t\tthis.updateTitle();\n\t}\n\n\tdeactivation()\n\t{\n\t\tthis.stopWait();\n\t\tthis.getNode().classList.add(\"mail-ui-not-active\");\n\t\tthis.getNode().classList.remove(\"mail-ui-active\");\n\t\tthis.setText(Loc.getMessage(this.#phrases[this.getType()]+'NOT_ACTIVE'));\n\t\tthis.getNode().removeAttribute(\"href\");\n\t\tthis.#active = false;\n\t\tthis.updateTitle();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn Loc.getMessage(this.#phrasesFull[this.getType()]+(this.isActive() ? '_ACTIVE' :''));\n\t}\n\n\tupdateTitle()\n\t{\n\t\tthis.getNode().removeAttribute(\"title\");\n\t\tthis.getNode().setAttribute(\"title\", this.getTitle());\n\t}\n\n\trender()\n\t{\n\t\tconst activeClass = this.isActive() ? 'mail-ui-active' : 'mail-ui-not-active';\n\t\tconst item = Tag.render`\n\t\t\t<a class=\"mail-ui-binding ui-btn-light-border ui-btn ui-btn-xs ui-btn-round ui-btn-no-caps ${this.#classes[this.getType()]} ${activeClass} js-bind-${this.getMessageId(true)}\">\n\t\t\t\t${this.#text}\n\t\t\t</a>`\n\n\t\tthis.#node = item;\n\t\tthis.#node.object = this;\n\n\t\tthis.updateTitle();\n\n\t\titem.onclick = function()\n\t\t{\n\t\t\tthis.object.onClick();\n\t\t};\n\n\t\titem.ondblclick = event => {\n\t\t\tevent.stopPropagation();\n\t\t};\n\n\t\titem.setActive = function(href)\n\t\t{\n\t\t\tthis.object.setActive(href);\n\t\t};\n\n\t\titem.deactivation = function()\n\t\t{\n\t\t\tthis.object.deactivation();\n\t\t};\n\n\t\titem.startWait = function()\n\t\t{\n\t\t\tthis.object.startWait();\n\t\t};\n\n\t\titem.stopWait = function()\n\t\t{\n\t\t\tthis.object.stopWait();\n\t\t};\n\n\t\tif(this.#errorType === 'crm-install-permission-error' && this.getHref())\n\t\t{\n\t\t\tthis.#errorType = 'crm-install-permission-open-error';\n\t\t}\n\n\t\tif(this.isActive() && !this.isError(this.#errorType))\n\t\t{\n\t\t\titem.setAttribute(\"href\", this.getHref());\n\t\t}\n\n\t\treturn item;\n\t}\n}","import { Tag } from 'main.core';\nimport { Loc } from 'main.core';\nimport { Item } from './item.js';\nimport { EventEmitter } from \"main.core.events\";\n\nexport class Binding\n{\n\t#mailboxId;\n\n\t#selectors = {\n\t\tCRM_ACTIVITY: '.mail-binding-crm',\n\t\tTASKS_TASK: '.mail-binding-task',\n\t\tIM_CHAT: '.mail-binding-chat',\n\t\tBLOG_POST: '.mail-binding-post',\n\t\tCALENDAR_EVENT: '.mail-binding-meeting',\n\t};\n\n\tgetMailbox()\n\t{\n\t\treturn this.#mailboxId;\n\t}\n\n\tconstructor(mailboxId)\n\t{\n\t\tthis.#mailboxId = mailboxId;\n\n\t\tEventEmitter.subscribe('onPullEvent-mail', (event) => {\n\n\t\t\tlet data = event.getData();\n\n\t\t\tif(data[0] === \"messageBindingCreated\" && (data[1]['mailboxId'] === this.getMailbox() || data[1]['mailboxId'] === String(this.getMailbox())))\n\t\t\t{\n\t\t\t\tconst binding = data[1];\n\t\t\t\tconst messageSimpleId = binding['messageId'];\n\n\t\t\t\tconst bindingWrapper = document.querySelector(\"\"+('.js-bind-' + messageSimpleId) + this.#selectors[binding['entityType']] + \"\");\n\n\t\t\t\tif (bindingWrapper)\n\t\t\t\t{\n\t\t\t\t\tbindingWrapper.setActive(binding['bindingEntityLink']);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(data[0] === \"messageBindingDeleted\" && (data[1]['mailboxId'] === this.getMailbox() || data[1]['mailboxId'] === String(this.getMailbox())))\n\t\t\t{\n\t\t\t\tconst binding = data[1];\n\t\t\t\tconst messageSimpleId = binding['messageId'];\n\n\t\t\t\tconst bindingWrapper = document.querySelector(\"\"+('.js-bind-' + messageSimpleId) + this.#selectors[binding['entityType']] + \"\");\n\n\t\t\t\tif (bindingWrapper)\n\t\t\t\t{\n\t\t\t\t\tbindingWrapper.deactivation();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic build(config)\n\t{\n\t\tconst item = new Item(config);\n\t\treturn item.render();\n\t}\n\n\tstatic replaceElement(object)\n\t{\n\t\tconst parent = object.parentNode;\n\n\t\tlet newObject = this.build({\n\t\t\ttype: object.getAttribute('bind-type'),\n\t\t\tid:  object.getAttribute('bind-id'),\n\t\t\tmessageId: object.getAttribute('message-id'),\n\t\t\tmessageSimpleId: object.getAttribute('message-simple-id'),\n\t\t\thref:  object.getAttribute('bind-href'),\n\t\t\tcreateHref: object.getAttribute('create-href'),\n\t\t\terrorType: object.getAttribute('error-type'),\n\t\t});\n\t\tparent.replaceChild(newObject,object);\n\t}\n\n\tstatic initButtons(context: HTMLElement = document.body)\n\t{\n\t\tconst elements = Array.from(context.getElementsByClassName('mail-ui-binding-data'));\n\t\tfor (let element of elements)\n\t\t{\n\t\t\tthis.replaceElement(element);\n\t\t}\n\t}\n}"],"names":["Item","errorKey","undefined","simple","config","type","id","isActive","Loc","getMessage","event","isError","showError","getType","BX","Mail","Secretary","getInstance","getMessageId","openChat","startWait","Client","Message","List","onCrmClick","top","SidePanel","Instance","open","openCalendarEvent","text","textContent","getNode","classList","add","remove","href","stopWait","setText","setAttribute","updateTitle","removeAttribute","getTitle","activeClass","item","Tag","render","object","onclick","onClick","ondblclick","stopPropagation","setActive","deactivation","getHref","key","UI","Notification","Center","notify","content","Binding","mailboxId","CRM_ACTIVITY","TASKS_TASK","IM_CHAT","BLOG_POST","CALENDAR_EVENT","EventEmitter","subscribe","data","getData","getMailbox","String","binding","messageSimpleId","bindingWrapper","document","querySelector","parent","parentNode","newObject","build","getAttribute","messageId","createHref","errorType","replaceChild","context","body","elements","Array","from","getElementsByClassName","element","replaceElement"],"mappings":"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"}