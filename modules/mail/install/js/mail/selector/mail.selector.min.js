(function(){var t=window.BX;if(!!t.MailUISelector){return}t.MailUISelector={prefix:"MC",onEmptySearchResult:function(e){if(!t.type.isNotEmptyObject(e)||!t.type.isNotEmptyString(e.selectorId)||!t.type.isNotEmptyString(e.searchString)||!t.type.isNotEmptyObject(t.UI.SelectorManager)){return}var a=t.UI.SelectorManager.instances[e.selectorId];if(!t.type.isNotEmptyObject(a)){return}if(a.getOption("allowAdd","MAILCONTACTS")=="Y"){var i=a.manager.checkEmail(e.searchString);if(t.type.isNotEmptyObject(i)&&!t.type.isNotEmptyObject(a.entities.MAILCONTACTS.items[i.email])){this.openAddDialog({selectorId:e.selectorId,contactData:i})}}},openAddDialog:function(e){if(!t.type.isNotEmptyObject(e)||!t.type.isNotEmptyString(e.selectorId)||!t.type.isNotEmptyObject(e.contactData)){return}var a=t.UI.SelectorManager.instances[e.selectorId];if(!t.type.isNotEmptyObject(a)){return}if(!a.popups.addMailContact){a.popups.addMailContact=new t.PopupWindow("add-mailcontact-popup",a.getPopupBind(),{offsetTop:1,content:this.getAddDialogContent(e),zIndex:1250,lightShadow:true,autoHide:true,closeByEsc:true,angle:{position:"bottom",offset:20},events:{onPopupClose:function(){if(a.popups.addMailContact!=null||!a.popups.addMailContact.isShown()){this.addMailContact({selectorId:e.selectorId,name:a.addMailContactSubmitted?t("add_mailcontact_name_"+e.selectorId).value:"",lastName:a.addMailContactSubmitted?t("add_mailcontact_lastname_"+e.selectorId).value:"",email:t("add_mailcontact_email_"+e.selectorId).value})}a.addMailContactSubmitted=false;if(a.manager.statuses.allowSendEvent&&a.callback.closeEmailAdd){a.callback.closeEmailAdd({selectorId:a.id})}}.bind(this),onPopupShow:function(){t.defer(t.focus)(t("add_mailcontact_name_"+e.selectorId));if(a.manager.statuses.allowSendEvent&&a.callback.openEmailAdd){a.callback.openEmailAdd({selectorId:a.id})}}}})}else{a.popups.addMailContact.setContent(this.getAddDialogContent(e));a.popups.addMailContact.setBindElement(a.getPopupBind())}if(!a.popups.addMailContact.isShown()){a.popups.addMailContact.show()}},getAddDialogContent:function(e){if(!t.type.isNotEmptyObject(e)||!t.type.isNotEmptyString(e.selectorId)||!t.type.isNotEmptyObject(e.contactData)){return}var a=t.UI.SelectorManager.instances[e.selectorId];if(!t.type.isNotEmptyObject(a)){return}return t.create("DIV",{props:{className:"bx-ui-selector bx-feed-email-popup"},children:[t.create("DIV",{props:{className:"bx-feed-email-title"},text:t.message("MAIL_EXT_SELECTOR_ADD_MAILCONTACT_TITLE")}),t.create("FORM",{style:{padding:0,margin:0},events:{submit:function(t){this.submitAddMailContactForm(e);t.stopPropagation();t.preventDefault()}.bind(this)},children:[t.create("DIV",{children:[t.create("INPUT",{attrs:{id:"add_mailcontact_email_"+e.selectorId,type:"hidden",value:e.contactData.email}}),t.create("INPUT",{attrs:{id:"add_mailcontact_name_"+e.selectorId,type:"text",placeholder:t.message("MAIL_EXT_SELECTOR_ADD_MAILCONTACT_PLACEHOLDER_NAME"),value:e.contactData.name},props:{className:"bx-feed-email-input"}}),t.create("INPUT",{attrs:{id:"add_mailcontact_lastname_"+e.selectorId,type:"text",placeholder:t.message("MAIL_EXT_SELECTOR_ADD_MAILCONTACT_PLACEHOLDER_LAST_NAME"),value:e.contactData.lastName},props:{className:"bx-feed-email-input"},events:{keyup:function(a){if(t("add_mailcontact_name_"+e.selectorId).value.length>0||t("add_mailcontact_lastname_"+e.selectorId).value.length>0){t.removeClass(t("add_mailcontact_button_"+e.selectorId),"ui-btn-disabled")}else{t.addClass(t("add_mailcontact_button_"+e.selectorId),"ui-btn-disabled")}a.stopPropagation();a.preventDefault()}}}),t.create("SPAN",{attrs:{id:"add_mailcontact_button_"+e.selectorId},props:{className:"ui-btn ui-btn-md ui-btn-primary ui-btn-disabled"},text:t.message("MAIL_EXT_SELECTOR_ADD_MAILCONTACT_BUTTON_OK"),style:{cursor:"pointer"},events:{click:function(){this.submitAddMailContactForm(e)}.bind(this)}}),t.create("INPUT",{style:{display:"none"},attrs:{type:"submit"}})]})]})]})},addMailContact:function(e){if(!t.type.isNotEmptyObject(e)||!t.type.isNotEmptyString(e.selectorId)){return}var a=t.UI.SelectorManager.instances[e.selectorId];if(!t.type.isNotEmptyObject(a)||!t.type.isNotEmptyObject(a.entities.MAILCONTACTS)){return}var i=false,o=e.email,n=t.util.htmlspecialchars(e.name)+(t.type.isNotEmptyString(e.name)?" ":"")+t.util.htmlspecialchars(e.lastName);if(!t.type.isNotEmptyString(n)){n=o}else{i=true}a.entities.MAILCONTACTS.items[o]={name:n,email:o,id:"MC"+o,showEmail:i?"Y":"N",params:e,isEmail:"Y"};if(a.callback.select){a.callback.select({item:a.entities.MAILCONTACTS.items[o],entityType:"MAILCONTACTS",selectorId:a.id,state:"select",prefix:this.prefix})}},submitAddMailContactForm:function(e){if(!t.type.isNotEmptyObject(e)||!t.type.isNotEmptyString(e.selectorId)){return}var a=t.UI.SelectorManager.instances[e.selectorId];if(!t.type.isNotEmptyObject(a)){return}a.addMailContactSubmitted=true;a.popups.addMailContact.close()},onGetEntityTypes:function(e){if(!t.type.isNotEmptyObject(e)||!t.type.isNotEmptyObject(e.selector)){return}var a=e.selector;if(a.getOption("enableMailContacts")=="Y"){var i={};a.entityTypes.MAILCONTACTS={options:{allowAdd:a.getOption("allowAddMailContact")=="Y"?"Y":"N",addTab:a.getOption("addMailContactsTab")=="Y"?"Y":"N",selectedItemsData:a.getOption("selectedItemsData")}}}}};t.addCustomEvent("BX.Main.SelectorV2:onGetEntityTypes",t.MailUISelector.onGetEntityTypes);t.ready(function(){t.addCustomEvent("BX.UI.Selector:onEmptySearchResult",t.MailUISelector.onEmptySearchResult.bind(t.MailUISelector))})})();
//# sourceMappingURL=mail.selector.map.js