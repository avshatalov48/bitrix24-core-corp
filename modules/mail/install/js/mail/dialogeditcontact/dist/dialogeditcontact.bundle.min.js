this.BX=this.BX||{};this.BX.Mail=this.BX.Mail||{};(function(e,t,a,l,i){"use strict";var n,r,o,s,c,d,u,g,v;var T=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getCheckedFields",value:function e(a){var l=a.querySelector('[data-role="email-container"]');var i=l.querySelector('[data-role="input-field"]');var n=i.value;var r=a.querySelector('[data-role="name-container"]');var o=r.querySelector('[data-role="input-field"]');var s=o.value;var c=true;var d=[];if(!t.Validation.isEmail(n)){c=false;l.showError(0)}else if(s.length<1){s=n.split("@")[0]}d={name:s,email:n};if(c){return d}return false}},{key:"openRemoveDialog",value:function e(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{id:""};var i=new BX.Promise;var n=this.removeContact;var r=BX.SidePanel.Instance.getTopSlider();var o=1;if(r!=null){o+=r.getZindex()}var s=new l.MessageBox({title:t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_REMOVE_DIALOG_TITLE"),message:t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_REMOVE_DIALOG_MESSAGE"),buttons:BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,popupOptions:{zIndex:o},onOk:function e(){n(a["id"]).then((function(){return i.fulfill()}));s.close()},onCancel:function e(){i.reject();s.close()}});s.show();return i}},{key:"removeContact",value:function e(t){return BX.ajax.runAction("mail.addressbook.removecontacts",{data:{idSet:[t]}})}},{key:"saveContact",value:function e(t,a,l){var n=i.Avatar.getAvatarData({fullName:t,email:a});var r={NAME:t,EMAIL:a,COLOR:n["color"],INITIALS:n["abbreviation"]};if(l!==undefined){r["ID"]=l}return BX.ajax.runAction("mail.addressbook.savecontact",{data:{contactData:r}})}},{key:"showError",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;this.emailInputWrapper.classList.add("ui-ctl-danger");BX.show(this.errorTitle[t])}},{key:"hideError",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"all";this.emailInputWrapper.classList.remove("ui-ctl-danger");if(t==="all"){this.errorTitle.forEach((function(e){BX.hide(e)}));return}BX.hide(this.errorTitle[t])}},{key:"openDialog",value:function e(l){var i=this;var T=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{contactID:"new"};var I="dialogEditContact_"+T["contactID"];var p="";var m="";var L="";var A="";if(T["contactData"]!==undefined){m=T["contactData"]["name"];p=T["contactData"]["email"];L="ui-ctl-disabled";A="disabled"}var _=t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<input data-role="input-field" type="text" class="ui-ctl-element" value="" placeholder="info@example.com"  ',">"])),A);var E=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ','">\n\t\t\t',"\n\t\t</div>"])),L,_);_.value=p;var b=t.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['<div class="ui-alert ui-alert-danger mail-addressbook-error-box">\n\t\t\t<span class="ui-alert-message">',"</span>\n\t\t</div>"])),t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_EMAIL_ERROR"));var f=t.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<div class="ui-alert ui-alert-danger mail-addressbook-error-box">\n\t\t\t<span class="ui-alert-message">',"</span>\n\t\t\t<br>\n\t\t</div>"])),t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_EMAIL_ERROR_EMAIL_IS_ALREADY_EXISTS"));var D=f.querySelector('[data-role="contact-email"]');var h=t.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['<div data-role="email-container" class="mail-addressbook-dialogeditcontact-item">\n\t\t\t<label class="mail-addressbook-dialogeditcontact-lable">','\n\t\t\t\t<div id="mail-addressbook-dialogeditcontact-contact-email-container" class="ui-ctl ui-ctl-textbox mail-addressbook-dialogeditcontact-field">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t","\n\t\t\t","\n\t\t</div>"])),t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_EMAIL_TITLE"),E,b,f);var C=t.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['<input data-role="input-field" type="text" class="ui-ctl-element" value="" placeholder="">'])));var M=t.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t',"\n\t\t</div>"])),C);C.value=m;var B=t.Tag.render(g||(g=babelHelpers.taggedTemplateLiteral(['<div data-role="name-container" class="mail-addressbook-dialogeditcontact-item">\n\t\t\t<label class="mail-addressbook-dialogeditcontact-lable">','\n\t\t\t\t<div id="mail-addressbook-dialogeditcontact-contact-email-container" class="ui-ctl ui-ctl-textbox mail-addressbook-dialogeditcontact-field">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t</div>"])),t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_NAME_TITLE"),M);var O=t.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(["\n\t\t<div>\n\t\t\t","\n\t\t\t","\n\t\t</div>"])),B,h);h.errorTitle=[b,f];h.emailInputWrapper=E;h.showError=this.showError;h.hideError=this.hideError;h.hideError();_.oninput=function(){return h.hideError()};a.SidePanelWrapper.open({id:I,titleText:l,footerIsActive:true,content:O,cancelButton:{text:t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_BUTTON_CANCEL")},consentButton:{text:t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_BUTTON_SAVE"),function:function e(t){var a=i.getCheckedFields(O);if(a){t.setClocking(true);i.saveContact(a["name"],a["email"],T["contactID"]).then((function(e){BX.SidePanel.Instance.postMessageAll(I,"dialogEditContact::reloadList",{});BX.SidePanel.Instance.close()}))["catch"]((function(e){var a=e.errors.pop().message.pop();if(a["ID"]){t.setClocking(false);D.onclick=function(){i.openEditDialog({contactID:Number(a["ID"]),contactData:{name:a["NAME"],email:a["EMAIL"]}})};h.showError(1)}else{BX.SidePanel.Instance.postMessageAll(I,"dialogEditContact::reloadList",{});BX.SidePanel.Instance.close()}}))}}}})}},{key:"openCreateDialog",value:function e(a){this.openDialog(t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_TITLE_BAR_ADD"),a)}},{key:"openEditDialog",value:function e(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{contactID:"",contactData:{name:"",email:""}};this.openDialog(t.Loc.getMessage("MAIL_DIALOG_EDIT_CONTACT_TITLE_BAR_EDIT"),a)}}]);return e}();e.DialogEditContact=T})(this.BX.Mail.AddressBook=this.BX.Mail.AddressBook||{},BX,BX.Mail,BX.UI.Dialogs,BX.Mail);
//# sourceMappingURL=dialogeditcontact.bundle.map.js