this.BX=this.BX||{};(function(e,t){"use strict";function a(e,t){r(e,t);t.add(e)}function n(e,t,a){r(e,t);t.set(e,a)}function r(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function i(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var s="mail";var o={};var l=new WeakMap;var c=new WeakSet;var d=function(){function e(t){babelHelpers.classCallCheck(this,e);a(this,c);n(this,l,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,l,t);this.sliderId="MailSecretary:".concat(s+babelHelpers.classPrivateFieldGet(this,l)).concat(Math.floor(Math.random()*1e3));this.contextBx=window.top.BX||window.BX;this.subscribe()}babelHelpers.createClass(e,[{key:"openChat",value:function e(){var t=this;return BX.ajax.runAction("mail.secretary.createChatFromMessage",{data:{messageId:babelHelpers.classPrivateFieldGet(this,l)}}).then((function(e){if(top.window.BXIM&&e.data){top.BXIM.openMessenger("chat"+parseInt(e.data))}}),(function(e){i(t,c,u).call(t,e.errors)}))}},{key:"openCalendarEvent",value:function e(){var t=this;return BX.ajax.runAction("mail.secretary.getCalendarEventDataFromMessage",{data:{messageId:babelHelpers.classPrivateFieldGet(this,l)}}).then((function(e){new(window.top.BX||window.BX).Calendar.SliderLoader(0,{sliderId:t.sliderId,entryName:e.data.name,entryDescription:e.data.desc}).show()}),(function(e){i(t,c,u).call(t,e.errors)}))}},{key:"onCalendarSave",value:function e(t){if(t instanceof this.contextBx.Event.BaseEvent){var a=t.getData();if(a.sliderId===this.sliderId){BX.ajax.runAction("mail.secretary.onCalendarSave",{data:{messageId:babelHelpers.classPrivateFieldGet(this,l),calendarEventId:a.responseData.entryId}})}}}},{key:"subscribe",value:function e(){this.contextBx.Event.EventEmitter.subscribe("BX.Calendar:onEntrySave",this.onCalendarSave.bind(this))}},{key:"destroy",value:function e(){this.contextBx.Event.EventEmitter.unsubscribe("BX.Calendar:onEntrySave",this.onCalendarSave)}}],[{key:"getInstance",value:function a(n){if(t.Type.isUndefined(o[n])){o[n]=new e(n)}return o[n]}}]);return e}();function u(e){if(t.Type.isArray(e)){var a=[];e.forEach((function(e){a.push(e.message)}));alert(a.join("\n"))}else{alert("action can't be performed")}}e.Secretary=d})(this.BX.Mail=this.BX.Mail||{},BX);
//# sourceMappingURL=secretary.bundle.map.js