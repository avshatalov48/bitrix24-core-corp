this.BX=this.BX||{};(function(e,a){"use strict";function t(e,a,t){if(!a.has(e)){throw new TypeError("attempted to get private field on non-instance")}return t}var n="mail";var r={};var i=new WeakMap;var s=new WeakSet;var l=function(){function e(a){babelHelpers.classCallCheck(this,e);s.add(this);i.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,i,a);this.sliderId="MailSecretary:".concat(n+babelHelpers.classPrivateFieldGet(this,i)).concat(Math.floor(Math.random()*1e3));this.contextBx=window.top.BX||window.BX;this.subscribe()}babelHelpers.createClass(e,[{key:"openChat",value:function e(){var a=this;return BX.ajax.runAction("mail.secretary.createChatFromMessage",{data:{messageId:babelHelpers.classPrivateFieldGet(this,i)}}).then(function(e){if(top.window.BXIM&&e.data){top.BXIM.openMessenger("chat"+parseInt(e.data))}},function(e){t(a,s,o).call(a,e.errors)})}},{key:"openCalendarEvent",value:function e(){var a=this;return BX.ajax.runAction("mail.secretary.getCalendarEventDataFromMessage",{data:{messageId:babelHelpers.classPrivateFieldGet(this,i)}}).then(function(e){new(window.top.BX||window.BX).Calendar.SliderLoader(0,{sliderId:a.sliderId,entryName:e.data.name,entryDescription:e.data.desc}).show()},function(e){t(a,s,o).call(a,e.errors)})}},{key:"onCalendarSave",value:function e(a){if(a instanceof this.contextBx.Event.BaseEvent){var t=a.getData();if(t.sliderId===this.sliderId){BX.ajax.runAction("mail.secretary.onCalendarSave",{data:{messageId:babelHelpers.classPrivateFieldGet(this,i),calendarEventId:t.responseData.entryId}})}}}},{key:"subscribe",value:function e(){this.contextBx.Event.EventEmitter.subscribe("BX.Calendar:onEntrySave",this.onCalendarSave.bind(this))}},{key:"destroy",value:function e(){this.contextBx.Event.EventEmitter.unsubscribe("BX.Calendar:onEntrySave",this.onCalendarSave)}}],[{key:"getInstance",value:function t(n){if(a.Type.isUndefined(r[n])){r[n]=new e(n)}return r[n]}}]);return e}();function o(e){if(a.Type.isArray(e)){var t=[];e.forEach(function(e){t.push(e.message)});alert(t.join("\n"))}else{alert("action can't be performed")}}e.Secretary=l})(this.BX.Mail=this.BX.Mail||{},BX);
//# sourceMappingURL=secretary.bundle.map.js