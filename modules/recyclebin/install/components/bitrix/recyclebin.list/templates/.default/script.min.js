"use strict";BX.namespace("Recyclebin");(function(){BX.Recyclebin.List=function(){};BX.Recyclebin.List.reloadTable=function(){var e=BX.Main.gridManager.getById(BX.Recyclebin.List.gridId);var t={apply_filter:"Y",clear_nav:"Y"};if(e.hasOwnProperty("instance")){e.instance.reloadTable("POST",t)}};BX.Recyclebin.List.restore=function(e,t){BX.ajax.runComponentAction("bitrix:recyclebin.list","restore",{mode:"ajax",data:{recyclebinId:e}}).then((function(e){BX.UI.Notification.Center.notify({content:BX.message("RECYCLEBIN_NOTIFY_RESTORE_"+t)});BX.Recyclebin.List.reloadTable()}),(function(e){BX.UI.Notification.Center.notify({content:e.errors[0].message})}))};BX.Recyclebin.List.remove=function(e,t){BX.Recyclebin.confirm(BX.message("RECYCLEBIN_CONFIRM_REMOVE")).then((function(i){BX.ajax.runComponentAction("bitrix:recyclebin.list","remove",{mode:"ajax",data:{recyclebinId:e}}).then((function(e){BX.UI.Notification.Center.notify({content:BX.message("RECYCLEBIN_NOTIFY_REMOVE_"+t)});BX.Recyclebin.List.reloadTable()}),(function(e){BX.UI.Notification.Center.notify({content:e.errors[0].message})}))}))};BX.Recyclebin.List.restoreBatch=function(e=false){const{isAll:t,selectedRows:i}=this.getGridObjectBatchParams();if(e){const e=BX.Recyclebin.DeletionManager.getInstance(this.gridId);if(!e||e.isRunning()){return}e.setMessages({textBefore:"RECYCLEBIN_DM_PROGRESSBAR_TITLE_RESTORE",textAfter:"RECYCLEBIN_DM_PROGRESSBAR_CANCEL",successCount:"RECYCLEBIN_DM_PROGRESSBAR_SUCCESS_COUNT_RESTORE",failedCount:"RECYCLEBIN_DM_PROGRESSBAR_FAILED_COUNT_RESTORE"});if(t){e.resetEntityIds()}else{e.setEntityIds(i)}e.executeRestore();return}BX.ajax.runComponentAction("bitrix:recyclebin.list","restore",{mode:"ajax",data:{recyclebinId:i,isAll:t}}).then((function(e){BX.UI.Notification.Center.notify({content:BX.message("RECYCLEBIN_RESTORE_SUCCESS_MULTIPLE")});BX.Recyclebin.List.reloadTable()}),(function(e){BX.UI.Notification.Center.notify({content:e.errors[0].message})}))};BX.Recyclebin.List.removeBatch=function(e=false){const{isAll:t,selectedRows:i}=this.getGridObjectBatchParams();if(e){const e=BX.Recyclebin.DeletionManager.getInstance(this.gridId);if(!e||e.isRunning()){return}e.setMessages({textBefore:"RECYCLEBIN_DM_PROGRESSBAR_TITLE_DELETION",textAfter:"RECYCLEBIN_DM_PROGRESSBAR_CANCEL",successCount:"RECYCLEBIN_DM_PROGRESSBAR_SUCCESS_COUNT_DELETION",failedCount:"RECYCLEBIN_DM_PROGRESSBAR_FAILED_COUNT_DELETION"});if(t){e.resetEntityIds()}else{e.setEntityIds(i)}e.executeDelete();return}BX.Recyclebin.confirm(BX.message("RECYCLEBIN_CONFIRM_REMOVE")).then((function(e){BX.ajax.runComponentAction("bitrix:recyclebin.list","remove",{mode:"ajax",data:{recyclebinId:i,isAll:t}}).then((function(e){BX.UI.Notification.Center.notify({content:BX.message("RECYCLEBIN_DELETE_SUCCESS_MULTIPLE")});BX.Recyclebin.List.reloadTable()}),(function(e){BX.UI.Notification.Center.notify({content:e.errors[0].message})}))}))};BX.Recyclebin.List.getGridObjectBatchParams=function(){const e=BX.Main.gridManager.getById(this.gridId).instance;const t=e.getActionsPanel();const i=t.getForAllCheckbox()&&t.getForAllCheckbox().checked;const n=i?1:0;const o=e.getRows().getSelectedIds();return{isAll:n,selectedRows:o}};BX.Recyclebin.List.showLimit=function(e){BX.Runtime.loadExtension("ui.info-helper").then((({FeaturePromotersRegistry:t})=>{if(t){t.getPromoter({featureId:e,bindElement:null}).show()}}))};BX.Recyclebin.confirm=function(e,t,i){if(!BX.type.isFunction(t)){t=BX.DoNothing}i=i||{};i.ctx=i.ctx||this;var n=new BX.Promise(null,i.ctx);if(BX.Recyclebin.confirmPopup==null){BX.Recyclebin.confirmPopup=new BX.PopupWindow("recyclebin-confirm-popup",null,{zIndex:22e3,overlay:{opacity:50},content:"",autoHide:false,closeByEsc:false,minWidth:300,className:"recyclebin-confirm-popup"})}var o=i.isDisposable&&i.id;var c=null;var s=i.buttonSet||[{text:BX.message("JS_CORE_WINDOW_CONTINUE"),type:"green",code:"continue",default:true}];var r=[];s.forEach((function(e){(function(e,t,i,o,c){e.push(new BX.PopupWindowButton({text:t.text,className:t.type=="red"?"popup-window-button-decline":"popup-window-button-accept",events:{click:function(){c.apply(i.ctx,[true]);this.popupWindow.close();if(o&&BX("bx-recyclebin-disposable-"+i.id).checked){BX.Tasks.Util.hintManager.disable(i.id)}n.fulfill(t.code)}}}))})(r,e,i,o,t)}));r.push(new BX.PopupWindowButtonLink({text:BX.message("JS_CORE_WINDOW_CANCEL"),events:{click:function(){t.apply(i.ctx,[false]);this.popupWindow.close();n.reject()}}}));BX.Recyclebin.confirmPopup.setButtons(r);if(typeof i.title!="undefined"){BX.Recyclebin.confirmPopup.setTitleBar(BX.type.isElementNode(i.title)?i.title:BX.create("div",{html:i.title}))}e=BX.create("div",{style:{padding:"16px 12px",maxWidth:"400px",maxHeight:"400px",overflow:"hidden"},html:BX.type.isElementNode(e)?e.outerHTML:e.toString()});if(c){BX.append(c,e)}BX.Recyclebin.confirmPopup.setContent(e.outerHTML);BX.Recyclebin.confirmPopup.show();return n};BX.Recyclebin.getTotalCount=function(){if(this.getTotalCountProceed){return}this.getTotalCountProceed=true;var e=document.getElementById("recyclebin_row_count_wrapper");var t=e.querySelector("a");if(t){t.style.display="none"}var i=e.querySelector(".recyclebin-circle-loader-circular");if(i){i.style.display="inline"}BX.ajax.runComponentAction("bitrix:recyclebin.list","getTotalCount",{mode:"class",data:{}}).then(function(t){var i=e.querySelector(".recyclebin-circle-loader-circular");if(i){i.style.display="none"}if(t.data){t.data=typeof t.data=="number"?t.data:0;var n=e.querySelector("a");if(n){n.remove()}e.append(t.data)}this.getTotalCountProceed=false}.bind(this)).catch(function(e){if(e.errors){alert(e.errors)}this.getTotalCountProceed=false}.bind(this))}}).call(this);if(typeof BX.FilterEntitySelector==="undefined"){BX.FilterEntitySelector=function(){this._id="";this._settings={};this._fieldId="";this._control=null;this._selector=null;this._inputKeyPressHandler=BX.delegate(this.keypress,this)};BX.FilterEntitySelector.prototype={initialize:function(e,t){this._id=e;this._settings=t?t:{};this._fieldId=this.getSetting("fieldId","");BX.addCustomEvent(window,"BX.Main.Filter:customEntityFocus",BX.delegate(this.onCustomEntitySelectorOpen,this));BX.addCustomEvent(window,"BX.Main.Filter:customEntityBlur",BX.delegate(this.onCustomEntitySelectorClose,this))},getId:function(){return this._id},getSetting:function(e,t){return this._settings.hasOwnProperty(e)?this._settings[e]:t},keypress:function(e){},open:function(e,t){this._selector=new BX.Tasks.Integration.Socialnetwork.NetworkSelector({scope:e,id:this.getId()+"-selector",mode:this.getSetting("mode"),query:t?t:false,useSearch:true,useAdd:false,parent:this,popupOffsetTop:5,popupOffsetLeft:40});this._selector.bindEvent("item-selected",BX.delegate((function(e){this._control.setData(BX.util.htmlspecialcharsback(e.nameFormatted),e.id);if(!this.getSetting("multi")){this._selector.close()}}),this));this._selector.open()},close:function(){if(this._selector){this._selector.close()}},onCustomEntitySelectorOpen:function(e){this._control=e;if(this._fieldId!==e.getId()){this._selector=null;this.close()}else{this._selector=e;this.open(e.field)}},onCustomEntitySelectorClose:function(e){if(this._fieldId!==e.getId()){this.close()}}};BX.FilterEntitySelector.closeAll=function(){for(var e in this.items){if(this.items.hasOwnProperty(e)){this.items[e].close()}}};BX.FilterEntitySelector.items={};BX.FilterEntitySelector.create=function(e,t){var i=new BX.FilterEntitySelector(e,t);i.initialize(e,t);this.items[i.getId()]=i;return i}}
//# sourceMappingURL=script.map.js