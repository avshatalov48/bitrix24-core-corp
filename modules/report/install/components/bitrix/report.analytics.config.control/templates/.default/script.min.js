(function(){"use strict";BX.namespace("BX.Report.Analytics.Config");BX.Report.Analytics.Config.Controls=function(t){this.configurationButton=t.configurationButton;this.boardId=t.boardId;this.boardOptions=BX.prop.getArray(t,"boardOptions",[]);this.pageTitle=document.querySelector(".ui-side-panel-wrap-title-name");this.pageTitleWrap=document.querySelector(".ui-side-panel-wrap-title-wrap");this.pageControlsContainer=document.querySelector(".pagetitle-container.pagetitle-align-right-container");this.init()};BX.Report.Analytics.Config.Controls.prototype={init:function(){BX.bind(this.configurationButton,"click",this.handleConfigurationButtonClick.bind(this));this.loader=new BX.Loader({size:80})},handleConfigurationButtonClick:function(){if(!this.menu){var t=[];this.boardOptions.forEach(function(o){t.push({text:o["TITLE"],className:"menu-popup-no-icon",onclick:function(){this.menu.popupWindow.close();this.toggleBoardOption(o["NAME"])}.bind(this)})},this);if(t.length>0){t.push({separator:true})}t.push({text:this.getToggleBoardTitle(),className:"menu-popup-no-icon",onclick:function(){this.menu.popupWindow.close();this.toggleBoard()}.bind(this)});this.menu=new BX.PopupMenuWindow("report-analytics-config-control-menu",this.configurationButton,t,{closeByEsc:true,autoHide:true,cacheable:false,events:{onDestroy:function(){this.menu=null}.bind(this)}})}this.menu.toggle()},getToggleBoardTitle:function(){return BX.message("VISUALCONSTRUCTOR_DASHBOARD_GO_TO_DEFAULT")},toggleBoard:function(){this.contentContainer=document.querySelector(".report-analytics-content");this.cleanPageContent();this.showLoader();BX.Report.VC.Core.ajaxPost("analytics.toggleToDefaultByBoardKey",{data:{IFRAME:"Y",boardKey:this.boardId},onFullSuccess:BX.delegate(function(t){this.hideLoader();this.changePageTitle(t.additionalParams.pageTitle);this.changePageControls(t.additionalParams.pageControlsParams);BX.html(this.contentContainer,t.data)},this)});this.confirmationPopup.close()},toggleBoardOption:function(t){this.contentContainer=document.querySelector(".report-analytics-content");this.cleanPageContent();this.showLoader();BX.Report.VC.Core.ajaxPost("analytics.toggleBoardOption",{data:{IFRAME:"Y",boardKey:this.boardId,optionName:t},onFullSuccess:BX.delegate(function(t){this.hideLoader();this.changePageTitle(t.additionalParams.pageTitle);this.changePageControls(t.additionalParams.pageControlsParams);BX.html(this.contentContainer,t.data)},this)})},cleanPageContent:function(){this.pageTitle.innerText="";this.pageControlsContainer.innerText="";BX.cleanNode(this.contentContainer);if(BX.Report.Dashboard){BX.Report.Dashboard.BoardRepository.destroyBoards()}if(BX.VisualConstructor&&BX.VisualConstructor.BoardRepository){BX.VisualConstructor.BoardRepository.destroyBoards()}},changePageControls:function(t){var o={};o.onFullSuccess=function(t){BX.html(this.pageControlsContainer,t.html)}.bind(this);BX.Report.VC.Core._successHandler(t,o)},changePageTitle:function(t){this.pageTitle.innerText=t},showLoader:function(){this.pageTitleWrap.style.display="none";var t=BX.create("img",{attrs:{src:"/bitrix/images/report/visualconstructor/preview/view-without-menu.svg",height:"1200px",width:"100%"}});this.contentContainer.appendChild(t)},hideLoader:function(){this.pageTitleWrap.style.display="block";this.loader.hide()}}})();
//# sourceMappingURL=script.map.js