(function(){BX.namespace("BX.VisualConstructor");BX.VisualConstructor.GroupedDataGrid=function(t){this.context=t.context;this.rows=this.context.querySelectorAll('[data-role="report-operator"]')||[];this.blockContainer=this.context.querySelector('[data-role="report-widget-triple-data-with-progress"]');this.wrapper=this.context.querySelector('[data-role="report-widget-triple-data-with-progress-wrapper"]');this.actionControlNode=this.context.querySelector('[data-role="reports-more-users"]');this.containerHeight=null;this.layout={container:null,header:null,content:null};this.init()};BX.VisualConstructor.GroupedDataGrid.prototype={init:function(){for(var t=0;t<this.rows.length;t++){BX.bind(this.getHeader(this.rows[t]),"click",this.handleClickOnRow.bind(this,this.rows[t]))}BX.bind(this.actionControlNode,"click",this.toggleWidgetHeight.bind(this))},handleClickOnRow:function(t){this.expendWidgetHeight();if(this.getContent(t).offsetHeight>0){this.collapseRow(t)}else{this.expendRow(t)}},toggleWidgetHeight:function(){BX.hasClass(this.blockContainer,"report-widget-triple-data-with-progress-open")?this.collapseWidgetHeight():this.expendWidgetHeight()},expendWidgetHeight:function(){if(!this.containerHeight){this.containerHeight=this.blockContainer.offsetHeight}BX.addClass(this.blockContainer,"report-widget-triple-data-with-progress-open");this.blockContainer.style.height=this.wrapper.offsetHeight+"px";this.blockContainer.addEventListener("transitionend",function(){if(BX.hasClass(this.blockContainer,"report-widget-triple-data-with-progress-open")){this.blockContainer.style.height="auto"}}.bind(this),false);this.actionControlNode.textContent=BX.message("REPORT_GROUPED_DATA_GRID_CLOSE_TITLE")},collapseWidgetHeight:function(){this.blockContainer.style.height=this.blockContainer.offsetHeight+"px";this.collapseAllRows();BX.removeClass(this.blockContainer,"report-widget-triple-data-with-progress-open");setTimeout(function(){this.blockContainer.style.height=this.containerHeight+"px"}.bind(this),0);this.actionControlNode.textContent=BX.message("REPORT_GROUPED_DATA_GRID_MORE_TITLE")},collapseAllRows:function(){for(var t=0;t<this.rows.length;t++){this.collapseRow(this.rows[t])}},expendRow:function(t){var e=this.getContent(t).firstElementChild;var o=e.offsetHeight;this.getContent(t).parentNode.classList.add("report-operator-open");this.getContent(t).style.height=o+"px"},collapseRow:function(t){this.getContent(t).parentNode.classList.remove("report-operator-open");this.getContent(t).style.height="0"},getHeader:function(t){return t.querySelector('[data-role="report-operator-header"]')},getContent:function(t){return t.querySelector('[data-role="report-operator-content"]')}}})();