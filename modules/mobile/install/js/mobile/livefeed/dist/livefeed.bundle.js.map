{"version":3,"file":"livefeed.bundle.js","sources":["../src/balloonnotifier.js","../src/nextpageloader.js","../src/notificationbar.js","../src/database.js","../src/publicationqueue.js","../src/post.js","../src/blogpost.js","../src/menu/postmenu.js","../src/menu/pagemenu.js","../src/postform.js","../src/postformold.js","../src/pinned.js","../src/rating.js","../src/important.js","../src/searchbar.js","../src/pagescroll.js","../src/followmanager.js","../src/comments.js","../src/page.js","../src/feed.js"],"sourcesContent":["import {Loc} from 'main.core';\nimport {Instance, PageInstance} from \"./feed\";\nimport {EventEmitter} from \"main.core.events\";\n\nclass BalloonNotifier\n{\n\tconstructor()\n\t{\n\t\tthis.initialized = false;\n\t\tthis.classes = {\n\t\t\tshow: 'lenta-notifier-shown'\n\t\t};\n\t\tthis.nodeIdList = {\n\t\t\tnotifier: 'lenta_notifier',\n\t\t\tnotifierCounter: 'lenta_notifier_cnt',\n\t\t\tnotifierCounterTitle: 'lenta_notifier_cnt_title',\n\t\t\trefreshNeeded: 'lenta_notifier_2',\n\t\t\trefreshError: 'lenta_refresh_error',\n\t\t\tnextPageError: 'lenta_nextpage_error',\n\t\t};\n\n\t\tthis.init();\n\t\tEventEmitter.subscribe('onFrameDataProcessed', () => {\n\t\t\tthis.init();\n\t\t});\n\t}\n\n\tinit()\n\t{\n\t\tconst notifierNode = this.getNotifierNode();\n\t\tif (\n\t\t\t!notifierNode\n\t\t\t|| this.initialized\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.initialized = true;\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tconst notifierNode = this.getNotifierNode();\n\n\t\tnotifierNode.addEventListener('click', () => {\n\t\t\tPageInstance.refresh(true);\n\t\t\treturn false;\n\t\t});\n\n\t\tconst refreshNeededNode = this.getRefreshNeededNode();\n\t\tif (refreshNeededNode)\n\t\t{\n\t\t\trefreshNeededNode.addEventListener('click', () => {\n\t\t\t\tapp.exec('pullDownLoadingStart');\n\t\t\t\tPageInstance.refresh(true);\n\t\t\t\treturn false;\n\t\t\t})\n\t\t}\n\n\t\tconst refreshErrorNode = this.getRefreshErrorNode();\n\t\tif (refreshErrorNode)\n\t\t{\n\t\t\trefreshErrorNode.addEventListener('click', () => {\n\t\t\t\tPageInstance.requestError('refresh', false);\n\t\t\t})\n\t\t}\n\n\t\tconst nextPageErrorNode = this.getNextPageErrorNode();\n\t\tif (nextPageErrorNode)\n\t\t{\n\t\t\tnextPageErrorNode.addEventListener('click', () => {\n\t\t\t\tPageInstance.requestError('nextPage', false);\n\t\t\t})\n\t\t}\n\t}\n\n\tgetNotifierNode()\n\t{\n\t\treturn document.getElementById(this.nodeIdList.notifier);\n\t}\n\tgetNotifierCounterNode()\n\t{\n\t\treturn document.getElementById(this.nodeIdList.notifierCounter);\n\t}\n\tgetNotifierCounterTitleNode()\n\t{\n\t\treturn document.getElementById(this.nodeIdList.notifierCounterTitle);\n\t}\n\tgetRefreshNeededNode()\n\t{\n\t\treturn document.getElementById(this.nodeIdList.refreshNeeded);\n\t}\n\tgetRefreshErrorNode()\n\t{\n\t\treturn document.getElementById(this.nodeIdList.refreshError);\n\t}\n\tgetNextPageErrorNode()\n\t{\n\t\treturn document.getElementById(this.nodeIdList.nextPageError);\n\t}\n\n\tshowRefreshNeededNotifier()\n\t{\n\t\tconst refreshNeededBlock = this.getRefreshNeededNode();\n\t\tif (refreshNeededBlock)\n\t\t{\n\t\t\trefreshNeededBlock.classList.add(this.classes.show);\n\t\t}\n\t}\n\n\thideRefreshNeededNotifier()\n\t{\n\t\tconst refreshNeededNode = this.getRefreshNeededNode();\n\t\tif (refreshNeededNode)\n\t\t{\n\t\t\trefreshNeededNode.classList.remove(this.classes.show);\n\t\t}\n\t}\n\n\tshowNotifier(params)\n\t{\n\t\tlet cnt = parseInt(params.counterValue);\n\n\t\tconst\n\t\t\tcnt_cent = cnt % 100,\n\t\t\treminder = cnt % 10;\n\n\t\tlet suffix = '';\n\n\t\tif (\n\t\t\tcnt_cent >= 10\n\t\t\t&& cnt_cent < 15\n\t\t)\n\t\t{\n\t\t\tsuffix = 3;\n\t\t}\n\t\telse if (reminder == 0)\n\t\t{\n\t\t\tsuffix = 3;\n\t\t}\n\t\telse if (reminder == 1)\n\t\t{\n\t\t\tsuffix = 1;\n\t\t}\n\t\telse if (\n\t\t\treminder == 2\n\t\t\t|| reminder == 3\n\t\t\t|| reminder == 4\n\t\t)\n\t\t{\n\t\t\tsuffix = 2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsuffix = 3;\n\t\t}\n\n\t\tif (Instance.getRefreshNeeded())\n\t\t{\n\t\t\tthis.getNotifierCounterNode().innerHTML = (cnt ? cnt + '+' : '');\n\t\t\tthis.hideRefreshNeededNotifier();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getNotifierCounterNode().innerHTML = cnt || '';\n\t\t}\n\n\t\tthis.getNotifierCounterTitleNode().innerHTML = Loc.getMessage('MOBILE_EXT_LIVEFEED_COUNTER_TITLE_' + suffix);\n\t\tthis.getNotifierNode().classList.add(this.classes.show);\n\t}\n\n\thideNotifier()\n\t{\n\t\tconst notifierNode = this.getNotifierNode();\n\t\tif (notifierNode)\n\t\t{\n\t\t\tnotifierNode.classList.remove(this.classes.show);\n\t\t}\n\t};\n}\n\nexport {\n\tBalloonNotifier\n}","import {PageInstance} from './feed';\nimport {EventEmitter} from \"main.core.events\";\n\nclass NextPageLoader\n{\n\tconstructor()\n\t{\n\t\tthis.initialized = false;\n\n\t\tthis.init();\n\t\tEventEmitter.subscribe('onFrameDataProcessed', () => {\n\t\t\tthis.init();\n\t\t});\n\t}\n\n\tinit()\n\t{\n\t\tconst buttonNode = this.getButtonNode();\n\n\t\tif (\n\t\t\t!buttonNode\n\t\t\t|| this.initialized\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.initialized = true;\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tconst buttonNode = this.getButtonNode();\n\n\t\tbuttonNode.addEventListener('click', (e) => {\n\t\t\tPageInstance.refresh(true);\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tgetButtonNode()\n\t{\n\t\treturn document.getElementById('next_page_refresh_needed_button');\n\t}\n\n\tstartWaiter()\n\t{\n\t\tconst button = this.getButtonNode();\n\t\tif (button)\n\t\t{\n\t\t\tbutton.classList.add('--loading');\n\t\t}\n\t}\n\n\tstopWaiter()\n\t{\n\t\tconst button = this.getButtonNode();\n\t\tif (button)\n\t\t{\n\t\t\tbutton.classList.remove('--loading');\n\t\t}\n\t}\n}\n\nexport {\n\tNextPageLoader,\n}","class NotificationBar\n{\n\tconstructor()\n\t{\n\t\tthis.repo = [];\n\t\tthis.color = {\n\t\t\tbackground: {\n\t\t\t\terror: '#affb0000',\n\t\t\t\tinfo: '#3a3735'\n\t\t\t},\n\t\t\ttext: {\n\t\t\t\terror: '#ffffff',\n\t\t\t\tinfo: '#ffffff'\n\t\t\t}\n\t\t}\n\t}\n\n\thideAll()\n\t{\n\t\tthis.repo = this.repo.filter(notifyBar => {\n\t\t\treturn notifyBar;\n\t\t});\n\t\tthis.repo.forEach(notifyBar => {\n\t\t\tnotifyBar.hide();\n\t\t});\n\t}\n\n\tshowError(params)\n\t{\n\t\tconst bar = new BXMobileApp.UI.NotificationBar({\n\t\t\t\tmessage: params.text ? params.text : '',\n\t\t\t\tcolor: this.color.background.error,\n\t\t\t\ttextColor: this.color.text.error,\n\t\t\t\tuseLoader: (params.useLoader ? !!params.useLoader : false),\n\t\t\t\tgroupId: (params.groupId ? params.groupId : ''),\n\t\t\t\talign: (params.textAlign ? params.textAlign : 'center'),\n\t\t\t\tautoHideTimeout: (params.autoHideTimeout ? params.autoHideTimeout : 30000),\n\t\t\t\thideOnTap: (params.hideOnTap ? !!params.hideOnTap : true),\n\t\t\t\tonTap: params.onTap ? params.onTap : () => {},\n\t\t\t}, (params.id ? params.id : parseInt(Math.random() * 100000)));\n\n\t\tthis.repo.push(bar);\n\t\tbar.show();\n\t}\n\n\tshowInfo(params)\n\t{\n\t\tconst bar = new BXMobileApp.UI.NotificationBar({\n\t\t\t\tmessage: params.text ? params.text : '',\n\t\t\t\tcolor: this.color.background.info,\n\t\t\t\ttextColor: this.color.text.info,\n\t\t\t\tuseLoader: (params.useLoader ? !!params.useLoader : false),\n\t\t\t\tgroupId: (params.groupId ? params.groupId : ''),\n\t\t\t\tmaxLines: (params.maxLines ? params.maxLines : false),\n\t\t\t\talign: (params.textAlign ? params.textAlign : 'center'),\n\t\t\t\tisGlobal: (params.isGlobal ? !!params.isGlobal : true),\n\t\t\t\tuseCloseButton: (params.useCloseButton ? !!params.useCloseButton : true),\n\t\t\t\tautoHideTimeout: (params.autoHideTimeout ? params.autoHideTimeout : 1000),\n\t\t\t\thideOnTap: (params.hideOnTap ? !!params.hideOnTap : true)\n\t\t\t}, (params.id ? params.id : parseInt(Math.random() * 100000)));\n\n\t\tthis.repo.push(bar);\n\t\tbar.show();\n\t}\n}\n\nexport {\n\tNotificationBar\n}","import {Type} from \"main.core\";\n\nclass Database\n{\n\tconstructor(params)\n\t{\n\t\tthis.tableName = null;\n\t\tthis.keyName = null;\n\n\t\tthis.setTableName(Type.isPlainObject(params) && Type.isStringFilled(params.tableName) ? params.tableName : 'livefeed');\n\t\tthis.setKeyName(Type.isPlainObject(params) && Type.isStringFilled(params.keyName) ? params.keyName : 'postUnsent');\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tBXMobileApp.addCustomEvent('Livefeed.Database::clear', this.onClear.bind(this));\n\t}\n\n\tsetTableName(value)\n\t{\n\t\tthis.tableName = value;\n\t}\n\tgetTableName()\n\t{\n\t\treturn this.tableName;\n\t}\n\n\tsetKeyName(value)\n\t{\n\t\tthis.keyName = value;\n\t}\n\tgetKeyName()\n\t{\n\t\treturn this.keyName;\n\t}\n\n\tonClear(params)\n\t{\n\t\tthis.delete(params.groupId);\n\t}\n\n\tdelete(groupId)\n\t{\n\t\tif (parseInt(groupId) <= 0)\n\t\t{\n\t\t\tgroupId = false;\n\t\t}\n\n\t\tapp.exec('setStorageValue', {\n\t\t\tstorageId: this.getTableName(),\n\t\t\tkey: this.getKeyName() + (groupId ? '_' + groupId : ''),\n\t\t\tvalue: {},\n\t\t\tcallback: (res) => {\n\t\t\t}\n\t\t});\n\t}\n\n\tsave(data, groupId)\n\t{\n\t\tif (parseInt(groupId) <= 0)\n\t\t{\n\t\t\tgroupId = false;\n\t\t}\n\n\t\tfor (let x in data)\n\t\t{\n\t\t\tif (!data.hasOwnProperty(x))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (x === 'sessid')\n\t\t\t{\n\t\t\t\tdelete data[x];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tapp.exec('setStorageValue', {\n\t\t\tstorageId: this.getTableName(),\n\t\t\tkey: this.getKeyName() + (groupId ? '_' + groupId : ''),\n\t\t\tvalue: data,\n\t\t\tcallback: (res) => {\n\t\t\t}\n\t\t});\n\t}\n\n\tload(callback, groupId)\n\t{\n\t\tif (parseInt(groupId) <= 0)\n\t\t{\n\t\t\tgroupId = false;\n\t\t}\n\n\t\tapp.exec('getStorageValue', {\n\t\t\tstorageId: this.getTableName(),\n\t\t\tkey: this.getKeyName() + (groupId ? '_' + groupId : ''),\n\t\t\tcallback: (value) =>\n\t\t\t{\n\t\t\t\tvalue = (Type.isPlainObject(value) ? value : (Type.isStringFilled(value) ? JSON.parse(value) : {}));\n\t\t\t\tif (\n\t\t\t\t\tType.isPlainObject(value)\n\t\t\t\t\t&& Object.keys(value).length > 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcallback.onLoad(value);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcallback.onEmpty();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t}\n}\n\nexport {\n\tDatabase\n}","import {Tag, Dom, Loc, Type, Event} from \"main.core\";\nimport {Instance} from \"./feed\";\nimport {EventEmitter} from 'main.core.events';\n\nclass PublicationQueue extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.repo = {};\n\n\t\tthis.nodeId = {\n\t\t\tcontainer: 'post-balloon-container'\n\t\t};\n\n\t\tthis.class = {\n\t\t\tballoonHidden: 'post-balloon-hidden',\n\t\t\tballoonFixed: 'post-balloon-box-fixed',\n\t\t\tballoonPublished: 'post-balloon-done',\n\t\t\tballoonShow: 'post-balloon-show',\n\t\t\tballoonHide: 'post-balloon-hide'\n\t\t};\n\n\t\tthis.timeout = {\n\t\t\tshow: 750\n\t\t};\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterSetItem', this.afterSetItem.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostAdd', this.afterPostAdd.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostAddError', this.afterPostAddError.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostUpdate', this.afterPostUpdate.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostUpdateError', this.afterPostUpdateError.bind(this));\n\n\t\tthis.setEventNamespace('BX.Mobile.Livefeed');\n\t\tthis.subscribe('onFeedReady', this.onFeedLoaded.bind(this));\n\t\tthis.subscribe('onPostInserted', this.onPostInserted.bind(this));\n\n\t\tEvent.bind(document, 'scroll', this.onScroll.bind(this));\n\t}\n\n\tonScroll()\n\t{\n\t\tconst\n\t\t\tcontainerNode = document.getElementById(this.nodeId.container);\n\n\t\tif (!Type.isDomNode(containerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (window.pageYOffset > 0)\n\t\t{\n\t\t\tcontainerNode.classList.add(this.class.balloonFixed);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontainerNode.classList.remove(this.class.balloonFixed);\n\t\t}\n\t}\n\n\tonFeedLoaded()\n\t{\n\t\tapp.exec('getStorageValue', {\n\t\t\tstorageId: 'livefeed',\n\t\t\tkey: 'publicationQueue',\n\t\t\tcallback: (queue) =>\n\t\t\t{\n\t\t\t\tqueue = (Type.isPlainObject(queue) ? queue : (Type.isStringFilled(queue) ? JSON.parse(queue) : {}));\n\n\t\t\t\tif (!Type.isPlainObject(queue))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (let key in queue)\n\t\t\t\t{\n\t\t\t\t\tif (!queue.hasOwnProperty(key))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.addToTray(key, {});\n\t\t\t\t}\n\n\t\t\t\tthis.drawList();\n\t\t\t}\n\t\t});\n\t}\n\n\tonPostInserted(event)\n\t{\n\t\tthis.removeFromTray(event.data.key);\n\t}\n\n\taddToTray(key, params)\n\t{\n\t\tthis.repo[key] = params;\n\t\tthis.repo[key].node = this.drawItem();\n\t\tthis.repo[key].node.classList.add(this.class.balloonShow);\n\t}\n\tremoveFromTray(key, params)\n\t{\n\t\tthis.hideItem(key);\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.repo[key])\n\t\t\t{\n\t\t\t\tdelete this.repo[key];\n\t\t\t}\n\t\t}, 3000);\n\t}\n\n\taddSuccess(key, warningText)\n\t{\n\t\tif (\n\t\t\tthis.repo[key]\n\t\t\t&& this.repo[key].node\n\t\t)\n\t\t{\n\t\t\tthis.repo[key].node.classList.remove(this.class.balloonHidden);\n\t\t\tthis.repo[key].node.classList.remove(this.class.balloonShow);\n\t\t\tthis.repo[key].node.classList.add(this.class.balloonPublished);\n\t\t\tthis.repo[key].node.lastElementChild.innerHTML = (Type.isStringFilled(warningText) ? warningText : Loc.getMessage('MOBILE_EXT_LIVEFEED_PUBLICATION_QUEUE_SUCCESS_TITLE'));\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tthis.removeFromTray(key);\n\t\t}, 5000);\n\t}\n\n\tdrawItem()\n\t{\n\t\tconst\n\t\t\ttitle = Loc.getMessage('MOBILE_EXT_LIVEFEED_PUBLICATION_QUEUE_ITEM_TITLE');\n\n\t\treturn Tag.render`\n\t\t\t\t<div class=\"post-balloon-hidden post-balloon post-balloon-active\"><span class=\"post-balloon-icon\"></span><span class=\"post-balloon-text\">${title}</span></div>\n\t\t\t`;\n\t}\n\n\thideItem(key, params)\n\t{\n\t\tif (this.repo[key])\n\t\t{\n\t\t\tthis.repo[key].node.classList.add(this.class.balloonHide);\n\t\t}\n\t}\n\n\tdrawList()\n\t{\n\t\tconst\n\t\t\tcontainerNode = document.getElementById(this.nodeId.container);\n\n\t\tif (!Type.isDomNode(containerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(containerNode);\n\n\t\tfor (let key in this.repo)\n\t\t{\n\t\t\tif (\n\t\t\t\t!this.repo.hasOwnProperty(key)\n\t\t\t\t|| !Type.isDomNode(this.repo[key].node)\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tDom.append(this.repo[key].node, containerNode);\n\t\t}\n\t}\n\n\tafterSetItem(params)\n\t{\n\t\tconst\n\t\t\tkey = params.key ? params.key : '',\n\t\t\tpageId = params.pageId ? params.pageId : '',\n\t\t\tcontentType = params.contentType ? params.contentType : '';\n\n\t\tif (\n\t\t\tpageId != Instance.getPageId()\n\t\t\t|| !key\n\t\t\t|| !Type.isStringFilled(contentType)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (contentType == 'post')\n\t\t{\n\t\t\tthis.addToTray(key, {\n\t\t\t\tkey: key\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.drawList();\n\t\t\t}, this.timeout.show);\n\t\t}\n\t}\n\n\tafterPostAdd(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tthis.addSuccess((params.key ? params.key : ''), params.warningText);\n\t\tthis.drawList();\n\t}\n\n\tafterPostUpdate(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tthis.addSuccess(params.key ? params.key : '');\n\t\tthis.drawList();\n\t}\n\n\tafterPostAddError(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst\n\t\t\tkey = params.key ? params.key : '';\n\n\t\tthis.removeFromTray(key, {\n\t\t\tkey: key\n\t\t});\n\t\tthis.drawList();\n\t}\n\n\tafterPostUpdateError(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst\n\t\t\tkey = params.key ? params.key : '';\n\n\t\tthis.removeFromTray(key, {\n\t\t\tkey: key\n\t\t});\n\t\tthis.drawList();\n\t}\n}\n\nexport {\n\tPublicationQueue\n}","import {FollowManagerInstance} from \"./feed\";\nimport {Loc, Type} from 'main.core';\nimport {Ajax} from 'mobile.ajax';\n\nclass Post\n{\n\tstatic moveBottom()\n\t{\n\t\twindow.scrollTo(0, document.body.scrollHeight);\n\t}\n\n\tstatic moveTop()\n\t{\n\t\twindow.scrollTo(0, 0);\n\t}\n\n\tconstructor(data)\n\t{\n\t\tthis.logId = 0;\n\t\tthis.entryType = '';\n\t\tthis.useFollow = false;\n\t\tthis.useTasks = false;\n\t\tthis.perm = '';\n\t\tthis.destinations = {};\n\t\tthis.postId = 0;\n\t\tthis.url = '';\n\t\tthis.entityXmlId = '';\n\t\tthis.readOnly = false;\n\t\tthis.contentTypeId = '';\n\t\tthis.contentId = 0;\n\t\tthis.showFull = false;\n\n\t\tthis.taskId = 0;\n\t\tthis.taskData = null;\n\n\t\tthis.calendarEventId = 0;\n\n\t\tthis.init(data);\n\t}\n\n\tinit(data)\n\t{\n\t\tlet {\n\t\t\tlogId,\n\t\t\tentryType,\n\t\t\tuseFollow,\n\t\t\tuseTasks,\n\t\t\tperm,\n\t\t\tdestinations,\n\t\t\tpostId,\n\t\t\turl,\n\t\t\tentityXmlId,\n\t\t\treadOnly,\n\t\t\tcontentTypeId,\n\t\t\tcontentId,\n\t\t\tshowFull,\n\n\t\t\ttaskId,\n\t\t\ttaskData,\n\n\t\t\tcalendarEventId\n\t\t} = data;\n\n\t\tlogId = parseInt(logId);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.logId = logId;\n\n\t\tthis.postId = parseInt(postId);\n\t\tthis.contentId = parseInt(contentId);\n\t\tthis.taskId = parseInt(taskId);\n\t\tthis.calendarEventId = parseInt(calendarEventId);\n\n\t\tthis.useFollow = !!useFollow;\n\t\tthis.useTasks = !!useTasks;\n\t\tthis.readOnly = !!readOnly;\n\t\tthis.showFull = !!showFull;\n\n\t\tif (Type.isStringFilled(entryType))\n\t\t{\n\t\t\tthis.entryType = entryType;\n\t\t}\n\t\tif (Type.isStringFilled(perm))\n\t\t{\n\t\t\tthis.perm = perm;\n\t\t}\n\t\tif (Type.isStringFilled(url))\n\t\t{\n\t\t\tthis.url = url;\n\t\t}\n\t\tif (Type.isStringFilled(entityXmlId))\n\t\t{\n\t\t\tthis.entityXmlId = entityXmlId;\n\t\t}\n\t\tif (Type.isStringFilled(contentTypeId))\n\t\t{\n\t\t\tthis.contentTypeId = contentTypeId;\n\t\t}\n\t\tif (Type.isStringFilled(taskData))\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.taskData = JSON.parse(taskData);\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\tthis.taskData = null;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(destinations))\n\t\t{\n\t\t\tthis.destinations = destinations;\n\t\t}\n\t}\n\n\tsetFavorites(data):void\n\t{\n\t\tif (this.logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet {node, event} = data;\n\n\t\t// for old versions without post menu in the feed\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\tnode = document.getElementById('log_entry_favorites_' + this.logId);\n\t\t}\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tconst oldValue = (node.getAttribute('data-favorites') === 'Y' ? 'Y' : 'N');\n\t\t\tconst newValue = (oldValue === 'Y' ? 'N' : 'Y');\n\n\t\t\t// for old versions without post menu in the feed\n\t\t\tif (node.classList.contains('lenta-item-fav'))\n\t\t\t{\n\t\t\t\tif (oldValue === 'Y')\n\t\t\t\t{\n\t\t\t\t\tnode.classList.remove('lenta-item-fav-active');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.classList.add('lenta-item-fav-active');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnode.setAttribute('data-favorites', newValue);\n\n\t\t\tAjax.runAction('socialnetwork.api.livefeed.changeFavorites', {\n\t\t\t\tdata: {\n\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\tvalue: newValue\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newValue === 'Y' ? 'addFavorites' : 'removeFavorites'),\n\t\t\t\t\tb24statContext: 'mobile'\n\t\t\t\t}\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.data.success)\n\t\t\t\t{\n\t\t\t\t\tif (newValue === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tFollowManagerInstance.setFollow({\n\t\t\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\t\t\tbOnlyOn: true,\n\t\t\t\t\t\t\tbRunEvent: true,\n\t\t\t\t\t\t\tbAjax: false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tBXMobileApp.onCustomEvent('onLogEntryFavorites', {\n\t\t\t\t\t\tlog_id: this.logId,\n\t\t\t\t\t\tpage_id: Loc.getMessage('MSLPageId')\n\t\t\t\t\t}, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.setAttribute('data-favorites', oldValue);\n\t\t\t\t}\n\t\t\t}, () => {\n\t\t\t\tnode.setAttribute('data-favorites', oldValue);\n\t\t\t});\n\t\t}\n\n\t\tif (event instanceof Event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\tsetPinned(data):void\n\t{\n\t\tif (this.logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tmenuNode,\n\t\t\tcontext\n\t\t} = data;\n\n\t\tif (Type.isDomNode(menuNode))\n\t\t{\n\t\t\tconst oldValue = (menuNode.getAttribute('data-pinned') === 'Y' ? 'Y' : 'N');\n\t\t\tconst newValue = (oldValue === 'Y' ? 'N' : 'Y');\n\n\t\t\tmenuNode.setAttribute('data-pinned', newValue);\n\n\t\t\tBXMobileApp.onCustomEvent('Livefeed::showLoader', {}, true, true);\n\n\t\t\tconst action = (\n\t\t\t\tnewValue === 'Y'\n\t\t\t\t\t? 'socialnetwork.api.livefeed.logentry.pin'\n\t\t\t\t\t: 'socialnetwork.api.livefeed.logentry.unpin'\n\t\t\t);\n\n\t\t\tAjax.runAction(action, {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: this.logId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newValue === 'Y' ? 'pinLivefeedEntry' : 'unpinLivefeedEntry'),\n\t\t\t\t\tb24statContext: 'mobile'\n\t\t\t\t}\n\t\t\t}).then((response) => {\n\t\t\t\tBXMobileApp.onCustomEvent('Livefeed::hideLoader', {}, true, true);\n\t\t\t\tif (response.data.success)\n\t\t\t\t{\n\t\t\t\t\tBXMobileApp.onCustomEvent('Livefeed.PinnedPanel::change', {\n\t\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\t\tvalue: newValue,\n\t\t\t\t\t\tpostNode: menuNode.closest('.lenta-item'),\n\t\t\t\t\t\tpinActionContext: context\n\t\t\t\t\t}, true, true);\n\t\t\t\t\tBXMobileApp.onCustomEvent('Livefeed.PostDetail::pinChanged', {\n\t\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\t\tvalue: newValue\n\t\t\t\t\t}, true, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmenuNode.setAttribute('data-pinned', oldValue);\n\t\t\t\t}\n\t\t\t}, () => {\n\t\t\t\tBXMobileApp.onCustomEvent('Livefeed::hideLoader', {}, true, true);\n\t\t\t\tmenuNode.setAttribute('data-pinned', oldValue);\n\t\t\t});\n\t\t}\n\t}\n\n\topenDetail(params)\n\t{\n\t\tconst {\n\t\t\tpathToEmptyPage,\n\t\t\tpathToCalendarEvent,\n\t\t\tpathToTasksRouter,\n\t\t\tevent,\n\t\t\tfocusComments,\n\t\t\tshowFull\n\t\t} = params;\n\n\t\tif (!Type.isStringFilled(pathToEmptyPage))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.taskId > 0\n\t\t\t&& BXMobileAppContext.getApiVersion() >= 31\n\t\t\t&& this.taskData\n\t\t)\n\t\t{\n\t\t\tBXMobileApp.Events.postToComponent('taskbackground::task::open', [\n\t\t\t\t{\n\t\t\t\t\tid: this.taskId,\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\ttitle: 'TASK',\n\t\t\t\t\ttaskInfo: {\n\t\t\t\t\t\ttitle: this.taskData.title,\n\t\t\t\t\t\tcreatorIcon: this.taskData.creatorIcon,\n\t\t\t\t\t\tresponsibleIcon: this.taskData.responsibleIcon\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\tgetTaskInfo: true\n\t\t\t\t}\n\t\t\t]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet path = pathToEmptyPage;\n\n\t\t\tif (\n\t\t\t\tthis.calendarEventId > 0\n\t\t\t\t&& !focusComments\n\t\t\t\t&& pathToCalendarEvent.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tpath = pathToCalendarEvent.replace('#EVENT_ID#', this.calendarEventId);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tthis.taskId > 0\n\t\t\t\t&& this.taskData\n\t\t\t\t&& pathToTasksRouter.length > 0\n\t\t\t) // API version <= 31\n\t\t\t{\n\t\t\t\tpath = pathToTasksRouter\n\t\t\t\t\t.replace('__ROUTE_PAGE__', 'view')\n\t\t\t\t\t.replace('#USER_ID#', Loc.getMessage('MOBILE_EXT_LIVEFEED_CURRENT_USER_ID')) + '&TASK_ID=' + this.taskId;\n\t\t\t}\n\n\t\t\t__MSLOpenLogEntryNew({\n\t\t\t\tpath: path,\n\t\t\t\tlog_id: this.logId,\n\t\t\t\tentry_type: this.entryType,\n\t\t\t\tuse_follow: (this.useFollow ? 'Y' : 'N'),\n\t\t\t\tuse_tasks: (this.useTasks ? 'Y' : 'N'),\n\t\t\t\tpost_perm: this.perm,\n\t\t\t\tdestinations: this.destinations,\n\t\t\t\tpost_id: this.postId,\n\t\t\t\tpost_url: this.url,\n\t\t\t\tentity_xml_id: this.entityXmlId,\n\t\t\t\tfocus_comments: focusComments,\n\t\t\t\tfocus_form: false,\n\t\t\t\tshow_full: (this.showFull || showFull),\n\t\t\t\tread_only: (this.readOnly ? 'Y' : 'N'),\n\t\t\t\tpost_content_type_id: this.contentTypeId,\n\t\t\t\tpost_content_id: this.contentId,\n\t\t\t}, event);\n\t\t}\n\t}\n\n\tinitDetailPin()\n\t{\n\t\tconst menuNode = document.getElementById('log-entry-menu-' + this.logId);\n\t\tif (!menuNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postNode = menuNode.closest('.post-wrap');\n\t\tif (!postNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pinnedValue = menuNode.getAttribute('data-pinned');\n\t\tif (pinnedValue === 'Y')\n\t\t{\n\t\t\tpostNode.classList.add('lenta-item-pin-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpostNode.classList.remove('lenta-item-pin-active');\n\t\t}\n\t}\n\n\texpandText()\n\t{\n\t\toMSL.expandText(this.logId);\n\t}\n}\n\nexport {\n\tPost\n}","import {Loc, Type, Uri, Text} from 'main.core';\nimport {Ajax} from 'mobile.ajax';\n\nimport {Instance, PostFormManagerInstance, PostFormOldManagerInstance} from './feed';\n\nclass BlogPost\n{\n\tstatic delete(params)\n\t{\n\t\tconst context = (Type.isStringFilled(params.context) ? params.context : 'list');\n\t\tconst postId = (!Type.isUndefined(params.postId) ? parseInt(params.postId) : 0);\n\t\tif (postId <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tapp.confirm({\n\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_DELETE_CONFIRM_TITLE'),\n\t\t\ttext : Loc.getMessage('MOBILE_EXT_LIVEFEED_DELETE_CONFIRM_DESCRIPTION'),\n\t\t\tbuttons : [\n\t\t\t\tLoc.getMessage('MOBILE_EXT_LIVEFEED_DELETE_CONFIRM_BUTTON_OK'),\n\t\t\t\tLoc.getMessage('MOBILE_EXT_LIVEFEED_DELETE_CONFIRM_BUTTON_CANCEL'),\n\t\t\t],\n\t\t\tcallback : (btnNum) => {\n\t\t\t\tif (parseInt(btnNum) !== 1)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tapp.showPopupLoader({\n\t\t\t\t\ttext: '',\n\t\t\t\t});\n\n\t\t\t\tconst actionUrl = Uri.addParam(`${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/ajax.php`, {\n\t\t\t\t\tb24statAction: 'deleteBlogPost',\n\t\t\t\t\tb24statContext: 'mobile',\n\t\t\t\t});\n\n\t\t\t\tAjax.wrap({\n\t\t\t\t\ttype: 'json',\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\turl: actionUrl,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'delete_post',\n\t\t\t\t\t\tmobile_action: 'delete_post',\n\t\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid'),\n\t\t\t\t\t\tsite: Loc.getMessage('SITE_ID'),\n\t\t\t\t\t\tlang: Loc.getMessage('LANGUAGE_ID'),\n\t\t\t\t\t\tpost_id: postId,\n\t\t\t\t\t},\n\t\t\t\t\tprocessData: true,\n\t\t\t\t\tcallback: (response) => {\n\t\t\t\t\t\tapp.hidePopupLoader();\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!Type.isStringFilled(response.SUCCESS)\n\t\t\t\t\t\t\t|| response.SUCCESS !== 'Y'\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tBXMobileApp.onCustomEvent('onBlogPostDelete', {}, true, true);\n\t\t\t\t\t\tif (context === 'detail')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tapp.closeController({\n\t\t\t\t\t\t\t\tdrop: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcallback_failure: () => {\n\t\t\t\t\t\tapp.hidePopupLoader();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic edit(params)\n\t{\n\t\tconst postId = (!Type.isUndefined(params.postId) ? parseInt(params.postId) : 0);\n\t\tif (postId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pinnedContext = (!Type.isUndefined(params.pinnedContext) ? !!params.pinnedContext : false);\n\n\t\tif (Application.getApiVersion() >= Instance.getApiVersion('layoutPostForm'))\n\t\t{\n\t\t\tPostFormManagerInstance.show({\n\t\t\t\tpageId: Instance.getPageId(),\n\t\t\t\tpostId: postId,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getData({\n\t\t\t\tpostId: postId,\n\t\t\t\tcallback: (postData) => {\n\t\t\t\t\tPostFormOldManagerInstance.formParams = {};\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!Type.isUndefined(postData.PostPerm)\n\t\t\t\t\t\t&& postData.PostPerm >= 'W'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst selectedDestinations = {\n\t\t\t\t\t\t\ta_users: [],\n\t\t\t\t\t\t\tb_groups: [],\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tPostFormOldManagerInstance.setExtraDataArray({\n\t\t\t\t\t\t\tpostId: postId,\n\t\t\t\t\t\t\tpostAuthorId: postData.post_user_id,\n\t\t\t\t\t\t\tlogId: postData.log_id,\n\t\t\t\t\t\t\tpinnedContext: pinnedContext,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (!Type.isUndefined(postData.PostDetailText))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tPostFormOldManagerInstance.setParams({\n\t\t\t\t\t\t\t\tmessageText: postData.PostDetailText,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isPlainObject(postData.PostDestination))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (const [key, value] of Object.entries(postData.PostDestination))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tType.isStringFilled(postData.PostDestination[key].STYLE)\n\t\t\t\t\t\t\t\t\t&& postData.PostDestination[key].STYLE === 'all-users'\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tPostFormOldManagerInstance.addDestination(\n\t\t\t\t\t\t\t\t\t\tselectedDestinations,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'UA'\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\t\t\tType.isStringFilled(postData.PostDestination[key].TYPE)\n\t\t\t\t\t\t\t\t\t&& [ 'U', 'SG' ].includes(postData.PostDestination[key].TYPE)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tPostFormOldManagerInstance.addDestination(\n\t\t\t\t\t\t\t\t\t\tselectedDestinations,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttype: postData.PostDestination[key].TYPE,\n\t\t\t\t\t\t\t\t\t\t\tid: postData.PostDestination[key].ID,\n\t\t\t\t\t\t\t\t\t\t\tname: Text.decode(postData.PostDestination[key].TITLE)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!Type.isUndefined(postData.PostDestinationHidden))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tPostFormOldManagerInstance.setExtraData({\n\t\t\t\t\t\t\t\thiddenRecipients: postData.PostDestinationHidden,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tPostFormOldManagerInstance.setParams({\n\t\t\t\t\t\t\tselectedRecipients: selectedDestinations,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (!Type.isUndefined(postData.PostFiles))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tPostFormOldManagerInstance.setParams({\n\t\t\t\t\t\t\t\tmessageFiles: postData.PostFiles,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!Type.isUndefined(postData.PostUFCode))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tPostFormOldManagerInstance.setExtraData({\n\t\t\t\t\t\t\t\tmessageUFCode: postData.PostUFCode,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tapp.exec('showPostForm', PostFormOldManagerInstance.show());\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic getData(params)\n\t{\n\t\tconst postId = (!Type.isUndefined(params.postId) ? parseInt(params.postId) : 0);\n\t\tif (postId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst callbackFunction = (Type.isFunction(params.callback) ? params.callback : null);\n\t\tif (Type.isNull(callbackFunction))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = {};\n\n\t\tif (postId > 0)\n\t\t{\n\t\t\tapp.showPopupLoader();\n\n\t\t\tAjax.wrap({\n\t\t\t\ttype: 'json',\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: `${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/ajax.php`,\n\t\t\t\tprocessData: true,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'get_blog_post_data',\n\t\t\t\t\tmobile_action: 'get_blog_post_data',\n\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid'),\n\t\t\t\t\tsite: Loc.getMessage('SITE_ID'),\n\t\t\t\t\tlang: Loc.getMessage('LANGUAGE_ID'),\n\t\t\t\t\tpost_id: postId,\n\t\t\t\t\tnt: Loc.getMessage('MSLNameTemplate'),\n\t\t\t\t\tsl: Loc.getMessage('MSLShowLogin')\n\t\t\t\t},\n\t\t\t\tcallback: (data) => {\n\t\t\t\t\tapp.hidePopupLoader();\n\n\t\t\t\t\tresult.id = postId;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!Type.isUndefined(data.log_id)\n\t\t\t\t\t\t&& parseInt(data.log_id) > 0\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.log_id = data.log_id;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!Type.isUndefined(data.post_user_id)\n\t\t\t\t\t\t&& parseInt(data.post_user_id) > 0\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.post_user_id = data.post_user_id;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isUndefined(data.PostPerm))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.PostPerm = data.PostPerm;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isUndefined(data.PostDestination))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.PostDestination = data.PostDestination;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isUndefined(data.PostDestinationHidden))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.PostDestinationHidden = data.PostDestinationHidden;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isUndefined(data.PostDetailText))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.PostDetailText = data.PostDetailText;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isUndefined(data.PostFiles))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.PostFiles = data.PostFiles;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isUndefined(data.PostBackgroundCode))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.PostBackgroundCode = data.PostBackgroundCode;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isUndefined(data.PostUFCode))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.PostUFCode = data.PostUFCode;\n\t\t\t\t\t}\n\n\t\t\t\t\tcallbackFunction(result);\n\t\t\t\t},\n\t\t\t\tcallback_failure: () => {\n\t\t\t\t\tapp.hidePopupLoader();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport {\n\tBlogPost\n}","import { Loc, Type } from 'main.core';\nimport { Post } from '../post';\nimport { BlogPost } from '../blogpost';\nimport { FollowManagerInstance, CommentsInstance } from '../feed';\nimport { sendData } from 'ui.analytics';\n\nclass PostMenu\n{\n\tinit(data)\n\t{\n\t\tthis.iconUrlFolderPath = '/bitrix/templates/mobile_app/images/lenta/menu/';\n\t\tthis.sectionCode = 'defaultSection';\n\n\t\tthis.logId = parseInt(data.logId, 10);\n\t\tthis.postId = parseInt(data.postId, 10);\n\t\tthis.postPerms = (Type.isStringFilled(data.postPerms) ? data.postPerms : 'R');\n\t\tthis.pageId = data.pageId;\n\t\tthis.contentTypeId = (Type.isStringFilled(data.contentTypeId) ? data.contentTypeId : null);\n\t\tthis.contentId = (Type.isInteger(data.contentId) ? data.contentId : 0);\n\n\t\tthis.useShare = Boolean(data.useShare) && (this.postId > 0);\n\t\tthis.useFavorites = Boolean(data.useFavorites) && (this.logId > 0);\n\t\tthis.useFollow = Boolean(data.useFollow) && (this.logId > 0);\n\t\tthis.usePinned = Boolean(data.usePinned) && (this.logId > 0);\n\t\tthis.useTasks = (Loc.getMessage('MOBILE_EXT_LIVEFEED_USE_TASKS') === 'Y');\n\t\tthis.useRefreshComments = Boolean(data.useRefreshComments);\n\n\t\tthis.favoritesValue = Boolean(data.favoritesValue);\n\t\tthis.followValue = Boolean(data.followValue);\n\t\tthis.pinnedValue = Boolean(data.pinnedValue);\n\n\t\tthis.target = (Type.isDomNode(data.target) ? data.target : null);\n\t\tthis.context = (Type.isStringFilled(data.context) ? data.context : 'list');\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tconst result = [];\n\n\t\tif (this.usePinned)\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: 'pinned',\n\t\t\t\ttitle: Loc.getMessage(`MOBILE_EXT_LIVEFEED_POST_MENU_PINNED_${this.pinnedValue ? 'Y' : 'N'}`),\n\t\t\t\ticonUrl: this.iconUrlFolderPath + (this.pinnedValue ? 'unpin.png' : 'pin.png'),\n\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\taction: () => {\n\t\t\t\t\tconst postInstance = new Post({\n\t\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn postInstance.setPinned({\n\t\t\t\t\t\tmenuNode: this.target,\n\t\t\t\t\t\tcontext: this.context,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (this.useShare)\n\t\t{\n\t\t\tvar selectedDestinations = {\n\t\t\t\ta_users: [],\n\t\t\t\tb_groups: [],\n\t\t\t};\n\n\t\t\tif (\n\t\t\t\tselectedDestinations.a_users.length > 0\n\t\t\t\t|| selectedDestinations.b_groups.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tid: 'sharePost',\n\t\t\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_SHARE'),\n\t\t\t\t\ticonName: 'add',\n\t\t\t\t\ticonUrl: `${this.iconUrlFolderPath}n_plus.png`,\n\t\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\t\taction: () => {\n\t\t\t\t\t\tapp.openTable({\n\t\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\t\toMSL.shareBlogPost();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\turl: `${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/index.php?mobile_action=${Loc.getMessage('MOBILE_EXT_LIVEFEED_CURRENT_EXTRANET_SITE') === 'Y' ? 'get_group_list' : 'get_usergroup_list'}&feature=blog`,\n\t\t\t\t\t\t\tmarkmode: true,\n\t\t\t\t\t\t\tmultiple: true,\n\t\t\t\t\t\t\treturn_full_mode: true,\n\t\t\t\t\t\t\tuser_all: true,\n\t\t\t\t\t\t\tshowtitle: true,\n\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\tselected: selectedDestinations,\n\t\t\t\t\t\t\talphabet_index: true,\n\t\t\t\t\t\t\tokname: Loc.getMessage('MOBILE_EXT_LIVEFEED_SHARE_TABLE_BUTTON_OK'),\n\t\t\t\t\t\t\tcancelname: Loc.getMessage('MOBILE_EXT_LIVEFEED_SHARE_TABLE_BUTTON_CANCEL'),\n\t\t\t\t\t\t\toutsection: (Loc.getMessage('MOBILE_EXT_LIVEFEED_DEST_TO_ALL_DENIED') !== 'Y'),\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tarrowFlag: false,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tthis.postId > 0\n\t\t\t&& this.postPerms === 'W'\n\t\t)\n\t\t{\n\t\t\tresult.push(\n\t\t\t\t{\n\t\t\t\t\tid: 'edit',\n\t\t\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_EDIT'),\n\t\t\t\t\ticonUrl: `${this.iconUrlFolderPath}pencil.png`,\n\t\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\t\taction: () => {\n\t\t\t\t\t\tBlogPost.edit({\n\t\t\t\t\t\t\tfeedId: window.LiveFeedID,\n\t\t\t\t\t\t\tpostId: this.postId,\n\t\t\t\t\t\t\tpinnedContext: Boolean(this.pinnedValue),\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tarrowFlag: false,\n\t\t\t\t\tfeature: 'edit',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'delete',\n\t\t\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_DELETE'),\n\t\t\t\t\ticonName: 'delete',\n\t\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\t\taction: () => {\n\t\t\t\t\t\tBlogPost.delete({\n\t\t\t\t\t\t\tpostId: this.postId,\n\t\t\t\t\t\t\tcontext: this.context,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tarrowFlag: false,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tif (this.useFavorites)\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: 'favorites',\n\t\t\t\ttitle: Loc.getMessage(`MOBILE_EXT_LIVEFEED_POST_MENU_FAVORITES_${this.favoritesValue ? 'Y' : 'N'}`),\n\t\t\t\ticonUrl: `${this.iconUrlFolderPath}favorite.png`,\n\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\taction: () => {\n\t\t\t\t\tconst postInstance = new Post({\n\t\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn postInstance.setFavorites({\n\t\t\t\t\t\tnode: this.target,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tarrowFlag: false,\n\t\t\t\tfeature: 'favorites',\n\t\t\t});\n\t\t}\n\n\t\tif (this.useFollow)\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: 'follow',\n\t\t\t\ttitle: Loc.getMessage(`MOBILE_EXT_LIVEFEED_POST_MENU_FOLLOW_${this.followValue ? 'Y' : 'N'}`),\n\t\t\t\ticonUrl: `${this.iconUrlFolderPath}eye.png`,\n\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\taction: () => {\n\t\t\t\t\tFollowManagerInstance.setFollow({\n\t\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\t\tmenuNode: this.target,\n\t\t\t\t\t\tpageId: this.pageId,\n\t\t\t\t\t\tbOnlyOn: false,\n\t\t\t\t\t\tbAjax: true,\n\t\t\t\t\t\tbRunEvent: true,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tarrowFlag: false,\n\t\t\t});\n\t\t}\n\n\t\tif (this.useRefreshComments)\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: 'refreshPostComments',\n\t\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_REFRESH_COMMENTS'),\n\t\t\t\ticonUrl: `${this.iconUrlFolderPath}n_refresh.png`,\n\t\t\t\taction: () => {\n\t\t\t\t\tif (oMSL.bDetailEmptyPage)\n\t\t\t\t\t{\n\t\t\t\t\t\t// get comments on refresh from detail page menu\n\t\t\t\t\t\tCommentsInstance.getComments({\n\t\t\t\t\t\t\tts: oMSL.iDetailTs,\n\t\t\t\t\t\t\tbPullDown: true,\n\t\t\t\t\t\t\tobFocus: {\n\t\t\t\t\t\t\t\tform: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.location.reload(true);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tarrowFlag: false,\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(this.contentTypeId)\n\t\t\t&& this.contentId > 0\n\t\t)\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: 'getPostLink',\n\t\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_GET_LINK'),\n\t\t\t\ticonUrl: `${this.iconUrlFolderPath}link.png`,\n\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\taction: () => {\n\t\t\t\t\toMSL.copyPostLink({\n\t\t\t\t\t\tcontentTypeId: this.contentTypeId,\n\t\t\t\t\t\tcontentId: this.contentId,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tarrowFlag: false,\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\tthis.useTasks\n\t\t\t\t&& this.logId > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tid: 'createTask',\n\t\t\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_CREATE_TASK'),\n\t\t\t\t\ticonUrl: `${this.iconUrlFolderPath}n_check.png`,\n\t\t\t\t\tsectionCode: this.sectionCode,\n\t\t\t\t\taction: () => {\n\t\t\t\t\t\toMSL.createTask({\n\t\t\t\t\t\t\tentityType: this.contentTypeId,\n\t\t\t\t\t\t\tentityId: this.contentId,\n\t\t\t\t\t\t\tlogId: this.logId,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tsendData({\n\t\t\t\t\t\t\ttool: 'tasks',\n\t\t\t\t\t\t\tcategory: 'task_operations',\n\t\t\t\t\t\t\tevent: 'task_create',\n\t\t\t\t\t\t\ttype: 'task',\n\t\t\t\t\t\t\tc_section: 'feed',\n\t\t\t\t\t\t\tc_element: 'create_button',\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t},\n\t\t\t\t\tarrowFlag: false,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nexport {\n\tPostMenu,\n};\n","import {Loc, Type} from 'main.core';\nimport {Instance,PostMenuInstance,FollowManagerInstance} from '../feed';\n\nclass PageMenu\n{\n\tconstructor()\n\t{\n\t\tthis.type = 'list';\n\t\tthis.listPageMenuItems = [];\n\t\tthis.detailPageMenuItems = [];\n\t}\n\n\tinit(data)\n\t{\n\t\tthis.type = (data.type === 'detail' ? 'detail' : 'list');\n\n\t\tconst menuItems = this.getPageMenuItems();\n\t\tconst title = (\n\t\t\tthis.type === 'detail'\n\t\t\t\t? (Type.isStringFilled(Loc.getMessage('MSLLogEntryTitle')) ? Loc.getMessage('MSLLogEntryTitle') : '')\n\t\t\t\t: (Type.isStringFilled(Loc.getMessage('MSLLogTitle')) ? Loc.getMessage('MSLLogTitle') : '')\n\t\t);\n\n\t\tif (menuItems.length > 0)\n\t\t{\n\t\t\tif (BXMobileAppContext.getApiVersion() >= Instance.getApiVersion('pageMenu'))\n\t\t\t{\n\t\t\t\tthis.initPagePopupMenu();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tapp.menuCreate({\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\t\t\t\tBXMobileApp.UI.Page.TopBar.title.setCallback(() => { app.menuShow(); });\n\t\t\t}\n\t\t}\n\t\telse if (BXMobileAppContext.getApiVersion() < Instance.getApiVersion('pageMenu'))\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TopBar.title.setCallback(\"\");\n\t\t}\n\n\t\tBXMobileApp.UI.Page.TopBar.title.setText(title);\n\t\tBXMobileApp.UI.Page.TopBar.title.show();\n\t}\n\n\tinitPagePopupMenu()\n\t{\n\t\tif (BXMobileAppContext.getApiVersion() < Instance.getApiVersion('pageMenu'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst buttons = [];\n\n\t\tif(!oMSL.logId)\n\t\t{\n\t\t\tbuttons.push({\n\t\t\t\ttype: 'search',\n\t\t\t\tcallback: function ()\n\t\t\t\t{\n\t\t\t\t\tapp.exec(\"showSearchBar\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar menuItems = this.getPageMenuItems(this.type);\n\n\t\tif (\n\t\t\tBX.type.isArray(menuItems)\n\t\t\t&& menuItems.length > 0\n\t\t)\n\t\t{\n\t\t\tbuttons.push({\n\t\t\t\ttype: 'more',\n\t\t\t\tcallback: () => {\n\t\t\t\t\tthis.showPageMenu(this.type);\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tapp.exec('setRightButtons', {\n\t\t\titems: buttons,\n\t\t});\n\t}\n\n\tshowPageMenu()\n\t{\n\t\tif (this.type === 'detail')\n\t\t{\n\t\t\tthis.detailPageMenuItems = this.buildDetailPageMenu(oMSL.menuData);\n\t\t}\n\n\t\tconst menuItems = this.getPageMenuItems();\n\t\tif (menuItems.length <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst popupMenuItems = [];\n\t\tconst popupMenuActions = {};\n\n\t\tmenuItems.forEach(menuItem => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\tid: menuItem.id,\n\t\t\t\ttitle: menuItem.name,\n\t\t\t\ticonUrl: (Type.isStringFilled(menuItem.image) ? menuItem.image : ''),\n\t\t\t\ticonName: (Type.isStringFilled(menuItem.iconName) ? menuItem.iconName : ''),\n\t\t\t\tsectionCode: 'defaultSection',\n\t\t\t});\n\n\t\t\tpopupMenuActions[menuItem.id] = menuItem.action;\n\t\t});\n\n\t\tapp.exec('setPopupMenuData', {\n\t\t\titems: popupMenuItems,\n\t\t\tsections: [\n\t\t\t\t{\n\t\t\t\t\tid: 'defaultSection',\n\t\t\t\t}\n\t\t\t],\n\t\t\tcallback: (event) => {\n\t\t\t\tif (event.eventName === 'onDataSet')\n\t\t\t\t{\n\t\t\t\t\tapp.exec('showPopupMenu');\n\t\t\t\t}\n\t\t\t\telse if (\n\t\t\t\t\tevent.eventName === 'onItemSelected'\n\t\t\t\t\t&& Type.isPlainObject(event.item)\n\t\t\t\t\t&& Type.isStringFilled(event.item.id)\n\t\t\t\t\t&& Type.isFunction(popupMenuActions[event.item.id])\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpopupMenuActions[event.item.id]();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetPageMenuItems()\n\t{\n\t\treturn (this.type === 'detail' ? this.detailPageMenuItems : this.listPageMenuItems);\n\t}\n\n\tbuildDetailPageMenu(data)\n\t{\n\t\tvar menuNode = null;\n\n\t\tif (BXMobileAppContext.getApiVersion() >= Instance.getApiVersion('pageMenu'))\n\t\t{\n\t\t\tmenuNode = document.getElementById(`log-entry-menu-${Instance.getLogId()}`);\n\t\t}\n\n\t\tPostMenuInstance.init({\n\t\t\tlogId: Instance.getLogId(),\n\t\t\tpostId: parseInt(data.post_id),\n\t\t\tpostPerms: data.post_perm,\n\t\t\tuseShare: (data.entry_type === 'blog'),\n\t\t\tuseFavorites: (menuNode && menuNode.getAttribute('data-use-favorites') === 'Y'),\n\t\t\tuseFollow: (data.read_only !== 'Y'),\n\t\t\tusePinned: (Instance.getLogId() > 0),\n\t\t\tuseRefreshComments: true,\n\t\t\tfavoritesValue: (menuNode && menuNode.getAttribute('data-favorites') === 'Y'),\n\t\t\tfollowValue: (FollowManagerInstance.getFollowValue()),\n\t\t\tpinnedValue: (menuNode && menuNode.getAttribute('data-pinned') === 'Y'),\n\t\t\tcontentTypeId: data.post_content_type_id,\n\t\t\tcontentId: parseInt(data.post_content_id),\n\t\t\ttarget: menuNode,\n\t\t\tcontext: 'detail',\n\t\t});\n\n\t\treturn PostMenuInstance.getMenuItems().map((item) => {\n\t\t\titem.name = item.title;\n\t\t\titem.image = item.iconUrl;\n\n\t\t\tdelete item.title;\n\t\t\tdelete item.iconUrl;\n\n\t\t\treturn item;\n\t\t});\n\t};\n}\n\nexport {\n\tPageMenu\n}","import {Instance, DatabaseUnsentPostInstance} from \"./feed\";\nimport {Type} from 'main.core';\n\nclass PostFormManager\n{\n\tconstructor()\n\t{\n\n\t}\n\n\tshow(params)\n\t{\n\t\tlet postData = {\n\t\t\ttype: (params.type ? params.type : 'post'),\n\t\t\tgroupId: (params.groupId ? parseInt(params.groupId) : 0),\n\t\t\tpostId: (params.postId ? parseInt(params.postId) : 0),\n\t\t\tpageId: (Type.isStringFilled(params.pageId) ? params.pageId : '')\n\t\t};\n\t\tthis.getDatabaseData(postData).then((postData) => {\n\t\t\treturn this.getWorkgroupData(postData);\n\t\t}).then((postData) => {\n\t\t\treturn this.getPostData(postData);\n\t\t}).then((postData) => {\n\t\t\treturn this.processPostData(postData);\n\t\t}).then((postData) => {\n\t\t\tapp.exec(\"openComponent\", {\n\t\t\t\tname: \"JSStackComponent\",\n\t\t\t\tcomponentCode: \"livefeed.postform\",\n\t\t\t\tscriptPath: BX.message('MOBILE_EXT_LIVEFEED_COMPONENT_URL'),\n\t\t\t\tparams: {\n\t\t\t\t\t'SERVER_NAME': BX.message('MOBILE_EXT_LIVEFEED_SERVER_NAME'),\n\t\t\t\t\t'DESTINATION_LIST': Instance.getOption('destinationList', {}),\n\t\t\t\t\t'DESTINATION_TO_ALL_DENY': Instance.getOption('destinationToAllDeny', false),\n\t\t\t\t\t'DESTINATION_TO_ALL_DEFAULT': Instance.getOption('destinationToAllDefault', true),\n\t\t\t\t\t'MODULE_DISK_INSTALLED': (BX.message('MOBILE_EXT_LIVEFEED_DISK_INSTALLED') == 'Y' ? 'Y' : 'N'),\n\t\t\t\t\t'MODULE_WEBDAV_INSTALLED': (BX.message('MOBILE_EXT_LIVEFEED_WEBDAV_INSTALLED') == 'Y' ? 'Y' : 'N'),\n\t\t\t\t\t'MODULE_VOTE_INSTALLED': (BX.message('MOBILE_EXT_LIVEFEED_VOTE_INSTALLED') == 'Y' ? 'Y' : 'N'),\n\t\t\t\t\t'USE_IMPORTANT': (BX.message('MOBILE_EXT_LIVEFEED_USE_IMPORTANT') === 'N' ? 'N' : 'Y'),\n\t\t\t\t\t'FILE_ATTACH_PATH': BX.message('MOBILE_EXT_LIVEFEED_FILE_ATTACH_PATH'),\n\t\t\t\t\t'BACKGROUND_IMAGES_DATA': Instance.getOption('backgroundImagesData', {}),\n\t\t\t\t\t'BACKGROUND_COMMON': Instance.getOption('backgroundCommon', {}),\n\t\t\t\t\t'MEDALS_LIST': Instance.getOption('medalsList', {}),\n\t\t\t\t\t'IMPORTANT_DATA': Instance.getOption('importantData', {}),\n\t\t\t\t\t'USER_FOLDER_FOR_SAVED_FILES': BX.message('MOBILE_EXT_UTILS_USER_FOLDER_FOR_SAVED_FILES'),\n\t\t\t\t\t'MAX_UPLOAD_CHUNK_SIZE': BX.message('MOBILE_EXT_UTILS_MAX_UPLOAD_CHUNK_SIZE'),\n\t\t\t\t\t'POST_FILE_UF_CODE': BX.message('MOBILE_EXT_LIVEFEED_POST_FILE_UF_CODE'),\n\t\t\t\t\t'POST_FORM_DATA': Instance.getOption('postFormData', {}),\n\t\t\t\t\t'POST_DATA': postData,\n\t\t\t\t\t'DEVICE_WIDTH': BX.message('MOBILE_EXT_LIVEFEED_DEVICE_WIDTH'),\n\t\t\t\t\t'DEVICE_HEIGHT': BX.message('MOBILE_EXT_LIVEFEED_DEVICE_HEIGHT'),\n\t\t\t\t\t'DEVICE_RATIO': BX.message('MOBILE_EXT_LIVEFEED_DEVICE_RATIO'),\n\t\t\t\t},\n\t\t\t\trootWidget: {\n\t\t\t\t\tname: \"layout\",\n\t\t\t\t\tsettings: {\n\t\t\t\t\t\tobjectName: \"postFormLayoutWidget\",\n\t\t\t\t\t\tmodal: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, false);\n\t\t});\n\t}\n\n\tgetDatabaseData(postData)\n\t{\n\t\tconst promise = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tconst postId = parseInt(postData.postId);\n\t\t\tif (postId > 0)\n\t\t\t{\n\t\t\t\tresolve(postData);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDatabaseUnsentPostInstance.load(\n\t\t\t\t{\n\t\t\t\t\tonLoad: (data) => {\n\n\t\t\t\t\t\tif (data.contentType !== postData.type)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve(postData);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpostData.groupId = 0;\n\n\t\t\t\t\t\tif (!Type.isPlainObject(postData.post))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post = {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isStringFilled(data.POST_TITLE))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post.PostTitle = data.POST_TITLE;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Type.isStringFilled(data.POST_MESSAGE))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post.PostDetailText = data.POST_MESSAGE;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tType.isArrayFilled(data.DEST)\n\t\t\t\t\t\t\t&& Type.isPlainObject(data.DEST_DATA)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post.PostDestination = [];\n\n\t\t\t\t\t\t\tconst patterns = [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpattern: /^SG(\\d+)$/i,\n\t\t\t\t\t\t\t\t\tstyle: 'sonetgroups'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpattern: /^U(\\d+|A)$/i,\n\t\t\t\t\t\t\t\t\tstyle: 'users'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpattern: /^DR(\\d+)$/i,\n\t\t\t\t\t\t\t\t\tstyle: 'department'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t];\n\n\t\t\t\t\t\t\tdata.DEST.forEach((item) => {\n\n\t\t\t\t\t\t\t\tlet id = null;\n\t\t\t\t\t\t\t\tlet style = null;\n\n\t\t\t\t\t\t\t\tfor (let i = 0; i < patterns.length; i++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst matches = item.match(patterns[i].pattern);\n\t\t\t\t\t\t\t\t\tif (matches)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid = matches[1];\n\t\t\t\t\t\t\t\t\t\tstyle = ((item === 'UA') ? 'all-users' : patterns[i].style);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (!Type.isNull(id))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpostData.post.PostDestination.push({\n\t\t\t\t\t\t\t\t\t\tSTYLE: style,\n\t\t\t\t\t\t\t\t\t\tID: id,\n\t\t\t\t\t\t\t\t\t\tTITLE: (Type.isPlainObject(data.DEST_DATA[item]) && Type.isStringFilled(data.DEST_DATA[item].title) ? data.DEST_DATA[item].title : '')\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isStringFilled(data.BACKGROUND_CODE))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post.PostBackgroundCode = data.BACKGROUND_CODE;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (data.IMPORTANT === 'Y')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post.PostImportantData = {\n\t\t\t\t\t\t\t\tvalue: 'Y'\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tif (Type.isStringFilled(data.IMPORTANT_DATE_END))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpostData.post.PostImportantData.endDate = Date.parse(data.IMPORTANT_DATE_END) / 1000;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isStringFilled(data.GRATITUDE_MEDAL))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post.PostGratitudeData = {\n\t\t\t\t\t\t\t\tgratitude: data.GRATITUDE_MEDAL,\n\t\t\t\t\t\t\t\temployees: []\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tArray.isArray(data.GRATITUDE_EMPLOYEES)\n\t\t\t\t\t\t\t\t&& Type.isPlainObject(data.GRATITUDE_EMPLOYEES_DATA)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdata.GRATITUDE_EMPLOYEES.forEach((userId) => {\n\n\t\t\t\t\t\t\t\t\tconst userData = data.GRATITUDE_EMPLOYEES_DATA[userId];\n\t\t\t\t\t\t\t\t\tif (!Type.isPlainObject(userData))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tpostData.post.PostGratitudeData.employees.push({\n\t\t\t\t\t\t\t\t\t\tid: userData.id,\n\t\t\t\t\t\t\t\t\t\timageUrl: (Type.isStringFilled(userData.imageUrl) ? userData.imageUrl : ''),\n\t\t\t\t\t\t\t\t\t\ttitle: (Type.isStringFilled(userData.title) ? userData.title : ''),\n\t\t\t\t\t\t\t\t\t\tsubtitle: (Type.isStringFilled(userData.subtitle) ? userData.subtitle : '')\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst voteId = 'n0';\n\t\t\t\t\t\tconst dataKey = 'UF_BLOG_POST_VOTE_' + voteId + '_DATA';\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tdata.UF_BLOG_POST_VOTE === voteId\n\t\t\t\t\t\t\t&& Type.isPlainObject(data[dataKey])\n\t\t\t\t\t\t\t&& Array.isArray(data[dataKey].QUESTIONS)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpostData.post.PostVoteData = {\n\t\t\t\t\t\t\t\tquestions: data[dataKey].QUESTIONS.map((question) => {\n\t\t\t\t\t\t\t\t\tconst result = {\n\t\t\t\t\t\t\t\t\t\tvalue: question.QUESTION,\n\t\t\t\t\t\t\t\t\t\tallowMultiSelect: question.FIELD_TYPE == 1 ? 'Y' : 'N',\n\t\t\t\t\t\t\t\t\t\tanswers: []\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tif (Array.isArray(question.ANSWERS))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tresult.answers = question.ANSWERS.map((answer) => {\n\t\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: answer.MESSAGE\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve(postData);\n\t\t\t\t\t},\n\t\t\t\t\tonEmpty: () => {\n\t\t\t\t\t\tresolve(postData);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpostData.groupId\n\t\t\t);\n\t\t});\n\n\t\tpromise.catch((error) => {console.error(error)});\n\n\t\treturn promise;\n\t}\n\n\tgetWorkgroupData(postData)\n\t{\n\t\tconst groupId = parseInt(postData.groupId);\n\n\t\tconst promise = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (groupId <= 0)\n\t\t\t{\n\t\t\t\tresolve(postData);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet promiseData = {\n\t\t\t\tresolve: resolve,\n\t\t\t\treject: reject\n\t\t\t};\n\n\t\t\tconst currentDateTime = new Date();\n\t\t\tconst returnEventName = 'Livefeed::returnWorkgroupData_' + currentDateTime.getTime();\n\n\t\t\tBXMobileApp.addCustomEvent(returnEventName, (function (result) {\n\t\t\t\tif (result.success)\n\t\t\t\t{\n\t\t\t\t\tthis.resolve(Object.assign(postData, {\n\t\t\t\t\t\tgroup: {\n\t\t\t\t\t\t\tID: parseInt(result.groupData.ID),\n\t\t\t\t\t\t\tNAME: result.groupData.NAME,\n//\t\t\t\t\t\t\tDESCRIPTION: result.groupData.DESCRIPTION\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.reject();\n\t\t\t\t}\n\t\t\t}).bind(promiseData));\n\n\t\t\tBXMobileApp.onCustomEvent('Livefeed::getWorkgroupData', {\n\t\t\t\tgroupId: groupId,\n\t\t\t\treturnEventName: returnEventName\n\t\t\t}, true);\n\t\t});\n\n\t\tpromise.catch((error) => {console.error(error)});\n\n\t\treturn promise;\n\t}\n\n\tgetPostData(postData)\n\t{\n\t\tconst postId = parseInt(postData.postId);\n\n\t\tconst promise = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (postId <= 0)\n\t\t\t{\n\t\t\t\tresolve(postData);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet promiseData = {\n\t\t\t\tresolve: resolve,\n\t\t\t\treject: reject\n\t\t\t};\n\n\t\t\tconst currentDateTime = new Date();\n\t\t\tconst returnEventName = 'Livefeed::returnPostFullData_' + currentDateTime.getTime();\n\n\t\t\tBXMobileApp.addCustomEvent(returnEventName, (function (result) {\n\t\t\t\tif (result.success)\n\t\t\t\t{\n\t\t\t\t\tthis.resolve(Object.assign(postData, {\n\t\t\t\t\t\tpost: result.postData\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.reject();\n\t\t\t\t}\n\t\t\t}).bind(promiseData));\n\n\t\t\tBXMobileApp.onCustomEvent('Livefeed::getPostFullData', {\n\t\t\t\tpostId: postId,\n\t\t\t\treturnEventName: returnEventName\n\t\t\t}, true);\n\t\t});\n\n\t\tpromise.catch((error) => {console.error(error)});\n\n\t\treturn promise;\n\t}\n\n\tprocessPostData(postData)\n\t{\n\t\tconst postId = parseInt(postData.postId);\n\n\t\tconst promise = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (Type.isPlainObject(postData.post))\n\t\t\t{\n\t\t\t\tif (Type.isArray(postData.post.PostDestination))\n\t\t\t\t{\n\t\t\t\t\tpostData.recipients = {};\n\n\t\t\t\t\tpostData.post.PostDestination.forEach((item) => {\n\n\t\t\t\t\t\tlet key = null;\n\t\t\t\t\t\tlet code = null;\n\n\t\t\t\t\t\tswitch (item.STYLE)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcase 'users':\n\t\t\t\t\t\t\t\tkey = 'users';\n\t\t\t\t\t\t\t\tcode = item.ID;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'all-users':\n\t\t\t\t\t\t\t\tkey = 'users';\n\t\t\t\t\t\t\t\tcode = 'A';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'sonetgroups':\n\t\t\t\t\t\t\t\tkey = 'groups';\n\t\t\t\t\t\t\t\tcode = item.ID;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'department':\n\t\t\t\t\t\t\t\tkey = 'departments';\n\t\t\t\t\t\t\t\tcode = item.ID;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (key)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!Type.isArray(postData.recipients[key]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpostData.recipients[key] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpostData.recipients[key].push({\n\t\t\t\t\t\t\t\tid: code,\n\t\t\t\t\t\t\t\ttitle: item.TITLE,\n\t\t\t\t\t\t\t\tshortTitle: (Type.isStringFilled(item.SHORT_TITLE) ? item.SHORT_TITLE : item.TITLE),\n\t\t\t\t\t\t\t\tavatar: (Type.isStringFilled(item.AVATAR) ? item.AVATAR : ''),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArray(postData.post.PostDestinationHidden))\n\t\t\t\t{\n\t\t\t\t\tpostData.hiddenRecipients = [];\n\n\t\t\t\t\tpostData.post.PostDestinationHidden.forEach((item) => {\n\t\t\t\t\t\tpostData.hiddenRecipients.push(item.TYPE + item.ID);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (Type.isPlainObject(postData.group))\n\t\t\t{\n\t\t\t\tpostData.recipients = {\n\t\t\t\t\tgroups: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: postData.group.ID,\n\t\t\t\t\t\t\ttitle: postData.group.NAME\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tresolve(postData);\n\t\t});\n\n\t\tpromise.catch((error) => {console.error(error)});\n\n\t\treturn promise;\n\t}\n}\n\nexport {\n\tPostFormManager\n}\n","import {Loc, Type} from 'main.core';\nimport {MobileUtils} from 'mobile.utils';\n\nimport {Instance} from './feed';\n\nclass PostFormOldManager\n{\n\tconstructor()\n\t{\n\t\tthis.postFormParams = {};\n\t\tthis.postFormExtraData = {};\n\t}\n\n\tsetExtraDataArray(extraData)\n\t{\n\t\tlet ob = null;\n\n\t\tfor (const [key, value] of Object.entries(extraData))\n\t\t{\n\t\t\tif (extraData.hasOwnProperty(key))\n\t\t\t{\n\t\t\t\tob = {};\n\t\t\t\tob[key] = value;\n\t\t\t\tthis.setExtraData(ob);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetExtraData(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const [key, value] of Object.entries(params))\n\t\t{\n\t\t\tif (\n\t\t\t\t(\n\t\t\t\t\tkey == 'hiddenRecipients'\n\t\t\t\t\t|| key == 'logId'\n\t\t\t\t\t|| key == 'postId'\n\t\t\t\t\t|| key == 'postAuthorId'\n\t\t\t\t\t|| key == 'messageUFCode'\n\t\t\t\t\t|| key == 'commentId'\n\t\t\t\t\t|| key == 'commentType'\n\t\t\t\t\t|| key == 'nodeId'\n\t\t\t\t\t|| key == 'pinnedContext'\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.postFormExtraData[key] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetExtraData()\n\t{\n\t\treturn this.postFormExtraData;\n\t}\n\n\tsetParams(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const [key, value] of Object.entries(params))\n\t\t{\n\t\t\tif ([ 'selectedRecipients', 'messageText', 'messageFiles' ].indexOf(key) !== -1)\n\t\t\t{\n\t\t\t\tthis.postFormParams[key] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\taddDestination(selectedDestinations, params)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(params)\n\t\t\t|| !Type.isStringFilled(params.type)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet searchRes = null;\n\n\t\tif (params.type === 'UA')\n\t\t{\n\t\t\tsearchRes = selectedDestinations.a_users.some(this.findDestinationCallBack, { value: 0 });\n\t\t\tif (!searchRes)\n\t\t\t{\n\t\t\t\tselectedDestinations.a_users.push({\n\t\t\t\t\tid: 0,\n\t\t\t\t\tname: Loc.getMessage('MSLPostDestUA'),\n\t\t\t\t\tbubble_background_color: '#A7F264',\n\t\t\t\t\tbubble_text_color: '#54901E',\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (params.type === 'U')\n\t\t{\n\t\t\tsearchRes = selectedDestinations.a_users.some(this.findDestinationCallBack, { value: params.id });\n\t\t\tif (!searchRes)\n\t\t\t{\n\t\t\t\tselectedDestinations.a_users.push({\n\t\t\t\t\tid: params.id,\n\t\t\t\t\tname: params.name,\n\t\t\t\t\tbubble_background_color: '#BCEDFC',\n\t\t\t\t\tbubble_text_color: '#1F6AB5',\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (params.type === 'SG')\n\t\t{\n\t\t\tsearchRes = selectedDestinations.b_groups.some(this.findDestinationCallBack, { value: params.id });\n\t\t\tif (!searchRes)\n\t\t\t{\n\t\t\t\tselectedDestinations.b_groups.push({\n\t\t\t\t\tid: params.id,\n\t\t\t\t\tname: params.name,\n\t\t\t\t\tbubble_background_color: '#FFD5D5',\n\t\t\t\t\tbubble_text_color: '#B54827',\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tfindDestinationCallBack(element, index, array)\n\t{\n\t\treturn (element.id == this.value);\n\t}\n\n\tshow(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst entityType = (\n\t\t\tType.isStringFilled(params.entityType)\n\t\t\t\t? params.entityType\n\t\t\t\t: 'post'\n\t\t);\n\n\t\tconst extraData = this.getExtraData();\n\n\t\tconst postFormParams = {\n\t\t\tattachButton: this.getAttachButton(),\n\t\t\tmentionButton: this.getMentionButton(),\n\t\t\tattachFileSettings: this.getAttachFileSettings(),\n\t\t\textraData: (extraData ? extraData : {}),\n\t\t\tsmileButton: {},\n\t\t\tsupportLocalFilesInText: (entityType === 'post'),\n\t\t\tokButton: {\n\t\t\t\tcallback: (data) => {\n\t\t\t\t\tif (!Type.isStringFilled(data.text))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst postData = this.buildRequestStub({\n\t\t\t\t\t\ttype: entityType,\n\t\t\t\t\t\textraData: data.extraData,\n\t\t\t\t\t\ttext: this.parseMentions(data.text),\n\t\t\t\t\t\tpinnedContext: (\n\t\t\t\t\t\t\tType.isStringFilled(data.extraData.pinnedContext)\n\t\t\t\t\t\t\t&&  data.extraData.pinnedContext === 'YES'\n\t\t\t\t\t\t)\n\t\t\t\t\t});\n\n\t\t\t\t\tconst ufCode = data.extraData.messageUFCode;\n\n\t\t\t\t\tthis.buildFiles(\n\t\t\t\t\t\tpostData,\n\t\t\t\t\t\tdata.attachedFiles,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tufCode: ufCode,\n\t\t\t\t\t\t}\n\t\t\t\t\t).then(() => {\n\t\t\t\t\t\tif (entityType !== 'post')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.buildDestinations(\n\t\t\t\t\t\t\tpostData,\n\t\t\t\t\t\t\tdata.selectedRecipients,\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tType.isPlainObject(data.extraData)\n\t\t\t\t\t\t\t\t&& !Type.isUndefined(data.extraData.hiddenRecipients)\n\t\t\t\t\t\t\t\t\t? data.extraData.hiddenRecipients\n\t\t\t\t\t\t\t\t\t: []\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (!postData.postVirtualId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpostData.ufCode = ufCode;\n\t\t\t\t\t\tpostData.contentType = 'post';\n\n\t\t\t\t\t\toMSL.initPostForm({\n\t\t\t\t\t\t\tgroupId: (params.groupId ? params.groupId : null),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tBXMobileApp.onCustomEvent('Livefeed.PublicationQueue::setItem', {\n\t\t\t\t\t\t\tkey: postData.postVirtualId,\n\t\t\t\t\t\t\tpinnedContext: !!postData.pinnedContext,\n\t\t\t\t\t\t\titem: postData,\n\t\t\t\t\t\t\tpageId: Instance.getPageId(),\n\t\t\t\t\t\t\tgroupId: (params.groupId ? params.groupId : null)\n\t\t\t\t\t\t}, true);\n\n\t\t\t\t\t}, () => {});\n\t\t\t\t},\n\t\t\t\tname: Loc.getMessage('MSLPostFormSend'),\n\t\t\t},\n\t\t\tcancelButton: {\n\t\t\t\tcallback: () => {\n\t\t\t\t\toMSL.initPostForm({\n\t\t\t\t\t\tgroupId: (params.groupId ? params.groupId : null),\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tname: Loc.getMessage('MSLPostFormCancel'),\n\t\t\t}\n\t\t};\n\n\t\tif (!Type.isUndefined(this.postFormParams.messageText))\n\t\t{\n\t\t\tpostFormParams.message = {\n\t\t\t\ttext: this.postFormParams.messageText,\n\t\t\t};\n\t\t}\n\n\t\tif (!Type.isUndefined(this.postFormParams.messageFiles))\n\t\t{\n\t\t\tpostFormParams.attachedFiles = this.postFormParams.messageFiles;\n\t\t}\n\n\t\tif (entityType === 'post')\n\t\t{\n\t\t\tpostFormParams.recipients = {\n\t\t\t\tdataSource: this.getRecipientsDataSource(),\n\t\t\t};\n\n\t\t\tif (!Type.isUndefined(this.postFormParams.selectedRecipients))\n\t\t\t{\n\t\t\t\tpostFormParams.recipients.selectedRecipients = this.postFormParams.selectedRecipients;\n\t\t\t}\n\n\t\t\tif (!Type.isUndefined(this.postFormParams.backgroundCode))\n\t\t\t{\n\t\t\t\tpostFormParams.backgroundCode = this.postFormParams.backgroundCode;\n\t\t\t}\n\t\t}\n\n\t\treturn postFormParams;\n\t}\n\n\tgetAttachButton()\n\t{\n\t\tconst attachButtonItems = [];\n\n\t\tif (\n\t\t\tLoc.getMessage('MOBILE_EXT_LIVEFEED_DISK_INSTALLED') === 'Y'\n\t\t\t|| Loc.getMessage('MOBILE_EXT_LIVEFEED_WEBDAV_INSTALLED') === 'Y'\n\t\t)\n\t\t{\n\t\t\tconst diskAttachParams = {\n\t\t\t\tid: 'disk',\n\t\t\t\tname: Loc.getMessage('MSLPostFormDisk'),\n\t\t\t\tdataSource: {\n\t\t\t\t\tmultiple: 'NO',\n\t\t\t\t\turl: (\n\t\t\t\t\t\tLoc.getMessage('MOBILE_EXT_LIVEFEED_DISK_INSTALLED') === 'Y'\n\t\t\t\t\t\t\t? `${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/?mobile_action=disk_folder_list&type=user&path=%2F&entityId=${Loc.getMessage('USER_ID')}`\n\t\t\t\t\t\t\t: `${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/webdav/user/${Loc.getMessage('USER_ID')}/`\n\t\t\t\t\t),\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst tableSettings = {\n\t\t\t\tsearchField: 'YES',\n\t\t\t\tshowtitle: 'YES',\n\t\t\t\tmodal: 'YES',\n\t\t\t\tname: Loc.getMessage('MSLPostFormDiskTitle'),\n\t\t\t};\n\n\t\t\t//FIXME temporary workaround\n\t\t\tif (window.platform === 'ios')\n\t\t\t{\n\t\t\t\tdiskAttachParams.dataSource.table_settings = tableSettings;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdiskAttachParams.dataSource.TABLE_SETTINGS = tableSettings;\n\t\t\t}\n\n\t\t\tattachButtonItems.push(diskAttachParams);\n\t\t}\n\n\t\tattachButtonItems.push({\n\t\t\tid: 'mediateka',\n\t\t\tname: Loc.getMessage('MSLPostFormPhotoGallery'),\n\t\t});\n\n\t\tattachButtonItems.push({\n\t\t\tid: 'camera',\n\t\t\tname: Loc.getMessage('MSLPostFormPhotoCamera'),\n\t\t});\n\n\t\treturn {\n\t\t\titems: attachButtonItems,\n\t\t};\n\t}\n\n\tgetMentionButton()\n\t{\n\t\treturn {\n\t\t\tdataSource: {\n\t\t\t\treturn_full_mode: 'YES',\n\t\t\t\toutsection: 'NO',\n\t\t\t\tokname: Loc.getMessage('MSLPostFormTableOk'),\n\t\t\t\tcancelname: Loc.getMessage('MSLPostFormTableCancel'),\n\t\t\t\tmultiple: 'NO',\n\t\t\t\talphabet_index: 'YES',\n\t\t\t\turl: `${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/index.php?mobile_action=get_user_list&use_name_format=Y`,\n\t\t\t}\n\t\t};\n\t}\n\n\tgetAttachFileSettings()\n\t{\n\t\treturn {\n\t\t\tresize: [\n\t\t\t\t40,\n\t\t\t\t1,\n\t\t\t\t1,\n\t\t\t\t1000,\n\t\t\t\t1000,\n\t\t\t\t0,\n\t\t\t\t2,\n\t\t\t\tfalse,\n\t\t\t\ttrue,\n\t\t\t\tfalse,\n\t\t\t\tnull,\n\t\t\t\t0\n\t\t\t],\n\t\t\tsaveToPhotoAlbum: true,\n\t\t};\n\t}\n\n\tbuildRequestStub(params)\n\t{\n\t\tlet request = null;\n\n\t\tif (params.type === 'post')\n\t\t{\n\t\t\trequest = {\n\t\t\t\tACTION: 'ADD_POST',\n\t\t\t\tAJAX_CALL: 'Y',\n\t\t\t\tPUBLISH_STATUS: 'P',\n\t\t\t\tis_sent: 'Y',\n\t\t\t\tapply: 'Y',\n\t\t\t\tsessid: Loc.getMessage('bitrix_sessid'),\n\t\t\t\tPOST_MESSAGE: params.text,\n\t\t\t\tdecode: 'Y',\n\t\t\t\tSPERM: {},\n\t\t\t\tSPERM_NAME: {},\n\t\t\t\tMOBILE: 'Y',\n\t\t\t\tPARSE_PREVIEW: 'Y',\n\t\t\t};\n\n\t\t\tif (\n\t\t\t\t!Type.isUndefined(params.extraData.postId)\n\t\t\t\t&& parseInt(params.extraData.postId) > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\trequest.post_id = parseInt(params.extraData.postId);\n\t\t\t\trequest.post_user_id = parseInt(params.extraData.postAuthorId);\n\t\t\t\trequest.pinnedContext = !!params.pinnedContext;\n\n\t\t\t\trequest.ACTION = 'EDIT_POST';\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isUndefined(params.extraData.logId)\n\t\t\t\t\t&& parseInt(params.extraData.logId) > 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\trequest.log_id = parseInt(params.extraData.logId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (\n\t\t\tparams.type === 'comment'\n\t\t\t&& !Type.isUndefined(params.extraData.commentId)\n\t\t\t&& parseInt(params.extraData.commentId) > 0\n\t\t\t&& Type.isStringFilled(params.extraData.commentType)\n\t\t)\n\t\t{\n\t\t\trequest = {\n\t\t\t\taction: 'EDIT_COMMENT',\n\t\t\t\ttext: this.parseMentions(params.text),\n\t\t\t\tcommentId: parseInt(params.extraData.commentId),\n\t\t\t\tnodeId: params.extraData.nodeId,\n\t\t\t\tsessid: Loc.getMessage('bitrix_sessid'),\n\t\t\t};\n\n\t\t\tif (params.extraData.commentType === 'blog')\n\t\t\t{\n\t\t\t\trequest.comment_post_id = null;\n\t\t\t}\n\t\t}\n\n\t\treturn request;\n\t}\n\n\tparseMentions(text)\n\t{\n\t\tlet parsedText = text;\n\n\t\tif (typeof oMSL.arMention != 'undefined')\n\t\t{\n\t\t\tfor (const [key, value] of Object.entries(oMSL.arMention))\n\t\t\t{\n\t\t\t\tparsedText = parsedText.replace(new RegExp(key, 'g'), value);\n\t\t\t}\n\n\t\t\toMSL.arMention = {};\n\t\t\toMSL.commentTextCurrent = '';\n\t\t}\n\n\t\treturn parsedText;\n\t}\n\n\tbuildFiles(postData, attachedFiles, params)\n\t{\n\t\tconst promise = new Promise((resolve, reject) => {\n\t\t\tconst ufCode = params.ufCode;\n\n\t\t\tpostData.postVirtualId = parseInt(Math.random() * 100000);\n\t\t\tpostData.tasksList = [];\n\n\t\t\tif (\n\t\t\t\tType.isArray(attachedFiles)\n\t\t\t\t&& attachedFiles.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet readedFileCount = 0;\n\t\t\t\tconst fileTotal = attachedFiles.length;\n\t\t\t\tconst fileCountIncrement = () => {\n\t\t\t\t\treadedFileCount++;\n\t\t\t\t\tif(readedFileCount >= fileTotal)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.postProgressingFiles(postData, attachedFiles, params);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tconst uploadTasks = [];\n\n\t\t\t\tattachedFiles.forEach((fileData) => {\n\t\t\t\t\tconst isFileFromBitrix24Disk = (\n\t\t\t\t\t\t!Type.isUndefined(fileData.VALUE) // Android\n\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\t!Type.isUndefined(fileData.id)\n\t\t\t\t\t\t\t&& parseInt(fileData.id) > 0\n\t\t\t\t\t\t) // disk object\n\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\tType.isPlainObject(fileData.dataAttributes)\n\t\t\t\t\t\t\t&& !Type.isUndefined(fileData.dataAttributes.VALUE)\n\t\t\t\t\t\t) // iOS and modern Android too\n\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\tType.isStringFilled(fileData.ufCode)\n\t\t\t\t\t\t\t&& fileData.ufCode === ufCode\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t\tconst isNewFileOnDevice = (\n\t\t\t\t\t\tType.isUndefined(fileData.url)\n\t\t\t\t\t\t|| !Type.isNumber(fileData.id)\n\t\t\t\t\t);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isStringFilled(fileData.url)\n\t\t\t\t\t\t&& isNewFileOnDevice\n\t\t\t\t\t\t&& !isFileFromBitrix24Disk\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst taskId = `postTask_${parseInt(Math.random() * 100000)}`;\n\t\t\t\t\t\tconst mimeType = MobileUtils.getFileMimeType(fileData.type);\n\n\t\t\t\t\t\tuploadTasks.push({\n\t\t\t\t\t\t\ttaskId: taskId,\n\t\t\t\t\t\t\ttype: fileData.type,\n\t\t\t\t\t\t\tmimeType: mimeType,\n\t\t\t\t\t\t\tfolderId: parseInt(Loc.getMessage('MOBILE_EXT_UTILS_USER_FOLDER_FOR_SAVED_FILES')),\n//\t\t\t\t\t\t\tchunk: parseInt(Loc.getMessage('MOBILE_EXT_UTILS_MAX_UPLOAD_CHUNK_SIZE')),\n\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\tpostVirtualId: postData.postVirtualId,\n\t\t\t\t\t\t\t\tpinnedContext: !!postData.pinnedContext\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tname: (MobileUtils.getUploadFilename(fileData.name, fileData.type)),\n\t\t\t\t\t\t\turl: fileData.url,\n\t\t\t\t\t\t\tpreviewUrl: (fileData.previewUrl ? fileData.previewUrl : null),\n\t\t\t\t\t\t\tresize: MobileUtils.getResizeOptions(fileData.type)\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tpostData.tasksList.push(taskId);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (isFileFromBitrix24Disk)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (Type.isUndefined(postData[ufCode]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpostData[ufCode] = [];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!Type.isUndefined(fileData.VALUE))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpostData[ufCode].push(fileData.VALUE);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (parseInt(fileData.id) > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpostData[ufCode].push(parseInt(fileData.id));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpostData[ufCode].push(fileData.dataAttributes.VALUE);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfileCountIncrement();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (uploadTasks.length > 0)\n\t\t\t\t{\n\t\t\t\t\tBXMobileApp.onCustomEvent('onFileUploadTaskReceived', {\n\t\t\t\t\t\tfiles: uploadTasks,\n\t\t\t\t\t}, true);\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.postProgressingFiles(postData, attachedFiles, params);\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\n\t\tpromise.catch((error) => {console.error(error)});\n\n\t\treturn promise;\n\t}\n\n\tbuildDestinations(postData, selectedRecipients, hiddenRecipients, params)\n\t{\n\t\tpostData['DEST'] = [];\n\n\t\tif (Type.isPlainObject(selectedRecipients.a_users))\n\t\t{\n\t\t\tfor (const [key, userData] of Object.entries(selectedRecipients.a_users))\n\t\t\t{\n\t\t\t\tconst prefix = 'U';\n\n\t\t\t\tif (Type.isUndefined(postData.SPERM[prefix]))\n\t\t\t\t{\n\t\t\t\t\tpostData.SPERM[prefix] = [];\n\t\t\t\t}\n\n\t\t\t\tif (Type.isUndefined(postData.SPERM_NAME[prefix]))\n\t\t\t\t{\n\t\t\t\t\tpostData.SPERM_NAME[prefix] = [];\n\t\t\t\t}\n\n\t\t\t\tconst id = (\n\t\t\t\t\t!Type.isUndefined(userData.ID)\n\t\t\t\t\t\t? userData.ID\n\t\t\t\t\t\t: userData.id\n\t\t\t\t);\n\n\t\t\t\tconst name = (\n\t\t\t\t\t!Type.isUndefined(userData.NAME)\n\t\t\t\t\t\t? userData.NAME\n\t\t\t\t\t\t: userData.name\n\t\t\t\t);\n\n\t\t\t\tconst value = (\n\t\t\t\t\tparseInt(id) === 0\n\t\t\t\t\t\t? 'UA'\n\t\t\t\t\t\t: `U${id}`\n\t\t\t\t);\n\n\t\t\t\tpostData.SPERM[prefix].push(value);\n\t\t\t\tpostData.DEST.push(value);\n\t\t\t\tpostData.SPERM_NAME[prefix].push(name);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(selectedRecipients.b_groups))\n\t\t{\n\t\t\tfor (const [key, groupData] of Object.entries(selectedRecipients.b_groups))\n\t\t\t{\n\t\t\t\tconst prefix = 'SG';\n\n\t\t\t\tif (Type.isUndefined(postData.SPERM[prefix]))\n\t\t\t\t{\n\t\t\t\t\tpostData.SPERM[prefix] = [];\n\t\t\t\t}\n\n\t\t\t\tif (Type.isUndefined(postData.SPERM_NAME[prefix]))\n\t\t\t\t{\n\t\t\t\t\tpostData.SPERM_NAME[prefix] = [];\n\t\t\t\t}\n\n\t\t\t\tconst id = (\n\t\t\t\t\t!Type.isUndefined(groupData.ID)\n\t\t\t\t\t\t? groupData.ID\n\t\t\t\t\t\t: groupData.id\n\t\t\t\t);\n\n\t\t\t\tconst name = (\n\t\t\t\t\t!Type.isUndefined(groupData.NAME)\n\t\t\t\t\t\t? groupData.NAME\n\t\t\t\t\t\t: groupData.name\n\t\t\t\t);\n\n\t\t\t\tconst value = `SG${id}`;\n\n\t\t\t\tpostData.SPERM[prefix].push(value);\n\t\t\t\tpostData.DEST.push(value);\n\t\t\t\tpostData.SPERM_NAME[prefix].push(name);\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in hiddenRecipients)\n\t\t{\n\t\t\tif (!hiddenRecipients.hasOwnProperty(key))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst prefix = hiddenRecipients[key].TYPE;\n\t\t\tif (Type.isUndefined(postData.SPERM[prefix]))\n\t\t\t{\n\t\t\t\tpostData.SPERM[prefix] = [];\n\t\t\t}\n\n\t\t\tconst value = `${hiddenRecipients[key].TYPE}${hiddenRecipients[key].ID}`;\n\n\t\t\tpostData.SPERM[prefix].push(value);\n\t\t\tpostData.DEST.push(value);\n\t\t}\n\t}\n\n\tgetRecipientsDataSource()\n\t{\n\t\treturn {\n\t\t\treturn_full_mode: 'YES',\n\t\t\toutsection: (Loc.getMessage('MOBILE_EXT_LIVEFEED_DEST_TO_ALL_DENIED') !== 'Y' ? 'YES' : 'NO'),\n\t\t\tokname: Loc.getMessage('MSLPostFormTableOk'),\n\t\t\tcancelname: Loc.getMessage('MSLPostFormTableCancel'),\n\t\t\tmultiple: 'YES',\n\t\t\talphabet_index: 'YES',\n\t\t\tshowtitle: 'YES',\n\t\t\tuser_all: 'YES',\n\t\t\turl: `${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/index.php?mobile_action=${(Loc.getmessage('MOBILE_EXT_LIVEFEED_CURRENT_EXTRANET_SITE') === 'Y' ? 'get_group_list' : 'get_usergroup_list')}&feature=blog`,\n\t\t};\n\t}\n\n\tpostProgressingFiles(postData, attachedFiles, params)\n\t{\n\t\tconst ufCode = params.ufCode;\n\t\tif (Type.isUndefined(postData[ufCode]))\n\t\t{\n\t\t\tpostData[ufCode] = [];\n\t\t}\n\n\t\tif (Type.isUndefined(attachedFiles))\n\t\t{\n\t\t\tattachedFiles = [];\n\t\t}\n\n\t\tfor (const keyOld in this.postFormParams.messageFiles) /* existing */\n\t\t{\n\t\t\tif (!this.postFormParams.messageFiles.hasOwnProperty(keyOld))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const keyNew in attachedFiles)\n\t\t\t{\n\t\t\t\tif (!attachedFiles.hasOwnProperty(keyNew))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tthis.postFormParams.messageFiles[keyOld].id == attachedFiles[keyNew].id\n\t\t\t\t\t|| this.postFormParams.messageFiles[keyOld].id == attachedFiles[keyNew].ID\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpostData[ufCode].push(this.postFormParams.messageFiles[keyOld].id);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (postData[ufCode].length <= 0)\n\t\t{\n\t\t\tpostData[ufCode].push('empty');\n\t\t}\n\t}\n}\n\nexport {\n\tPostFormOldManager,\n}","import {Dom, Type, Tag, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Post} from \"./post\";\nimport {Ajax} from 'mobile.ajax';\nimport {PageInstance} from './feed';\n\nclass PinnedPanel\n{\n\tconstructor()\n\t{\n\t\tthis.panelInitialized = false;\n\n\t\tthis.class = {\n\n\t\t\tpanel: 'lenta-pinned-panel',\n\t\t\tpanelCollapsed: 'lenta-pinned-panel-collapsed',\n\t\t\tpanelActive: 'lenta-pinned-panel-active',\n\n\t\t\tcollapsedPanel: 'lenta-pinned-collapsed-posts',\n\t\t\tcollapsedPanelPostsValue: 'lenta-pinned-collapsed-count-posts',\n\t\t\tcollapsedPanelComments: 'lenta-pinned-collapsed-posts-comments',\n\t\t\tcollapsedPanelCommentsShown: 'lenta-pinned-collapsed-posts-comments-active',\n\t\t\tcollapsedPanelCommentsValue: 'lenta-pinned-collapsed-count-comments',\n\t\t\tcollapsedPanelCommentsValueNew: 'post-item-inform-right-new-value',\n\n\t\t\tcollapsedPanelExpandButton: 'lenta-pinned-collapsed-posts-btn',\n\n\t\t\tpost: 'lenta-item',\n\n\t\t\tpostItemPinned: 'lenta-item-pinned',\n\t\t\tpostItemPinActive: 'lenta-item-pin-active',\n\n\t\t\tpostItemPinnedBlock: 'post-item-pinned-block',\n\t\t\tpostItemPinnedTitle: 'post-item-pinned-title',\n\t\t\tpostItemPinnedTextBox: 'post-item-pinned-text-box',\n\t\t\tpostItemPinnedDesc: 'post-item-pinned-desc',\n\n\t\t\tcancelPanel: 'post-pinned-cancel-panel',\n\t\t\tcancelPanelButton: 'post-pinned-cancel-panel-btn'\n\t\t};\n\n\t\tthis.init();\n\t\tEventEmitter.subscribe('onFrameDataProcessed', () => {\n\t\t\tthis.init();\n\t\t});\n\t}\n\n\tinit()\n\t{\n\t\tconst panel = document.querySelector(`.${this.class.panel}`);\n\t\tif (\n\t\t\t!panel\n\t\t\t|| this.panelInitialized\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.panelInitialized = true;\n\n\t\tthis.adjustCollapsedPostsPanel();\n\t\tconst collapsedPanel = document.querySelector(`.${this.class.collapsedPanel}`);\n\t\tif (collapsedPanel)\n\t\t{\n\t\t\tcollapsedPanel.addEventListener('touchend', (e) => {\n\t\t\t\tthis.expandCollapsedPostsPanel();\n\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn e.preventDefault();\n\t\t\t});\n\t\t}\n\t}\n\n\tresetFlags()\n\t{\n\t\tthis.panelInitialized = false;\n\t}\n\n\tgetPinnedPanelNode()\n\t{\n\t\treturn document.querySelector('[data-livefeed-pinned-panel]');\n\t}\n\n\trecalcPanel({type})\n\t{\n\t\tif (this.getPostsCount() > 0)\n\t\t{\n\t\t\tthis.getPinnedPanelNode().classList.add(`${this.class.panelActive}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getPinnedPanelNode().classList.remove(`${this.class.panelActive}`);\n\t\t}\n\n\t\tthis.recalcCollapsedPostsPanel({type})\n\t}\n\n\trecalcCollapsedPostsPanel({type})\n\t{\n\t\tif (this.getPostsCount() >= Loc.getMessage('MOBILE_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tif (\n\t\t\t\ttype === 'insert'\n\t\t\t\t|| this.getPinnedPanelNode().classList.contains(`${this.class.panelCollapsed}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.getPinnedPanelNode().classList.add(`${this.class.panelCollapsed}`);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getPinnedPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\t}\n\n\t\tthis.adjustCollapsedPostsPanel();\n\t}\n\n\texpandCollapsedPostsPanel()\n\t{\n\t\tthis.getPinnedPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t}\n\n\tgetPostsCount()\n\t{\n\t\treturn Array.from(this.getPinnedPanelNode().getElementsByClassName(`${this.class.post}`)).length;\n\t}\n\n\tadjustCollapsedPostsPanel()\n\t{\n\t\tconst postsCounter = this.getPostsCount();\n\t\tconst postsCounterNode = this.getPinnedPanelNode().querySelector(`.${this.class.collapsedPanelPostsValue}`);\n\n\t\tif (postsCounterNode)\n\t\t{\n\t\t\tpostsCounterNode.innerHTML = parseInt(postsCounter);\n\t\t}\n\n\t\tconst commentsCounterNode = this.getPinnedPanelNode().querySelector(`.${this.class.collapsedPanelComments}`);\n\t\tconst commentsCounterValueNode = this.getPinnedPanelNode().querySelector(`.${this.class.collapsedPanelCommentsValue}`);\n\n\t\tif (\n\t\t\tcommentsCounterNode\n\t\t\t&& commentsCounterValueNode\n\t\t)\n\t\t{\n\t\t\tconst newCommentCounter = Array.from(this.getPinnedPanelNode().querySelectorAll(`.${this.class.collapsedPanelCommentsValueNew}`)).reduce((acc, node) => {\n\t\t\t\treturn acc + parseInt(node.innerHTML);\n\t\t\t}, 0);\n\n\t\t\tcommentsCounterValueNode.innerHTML = '+' + newCommentCounter;\n\t\t\tif (newCommentCounter > 0)\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.add(`${this.class.collapsedPanelCommentsShown}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.remove(`${this.class.collapsedPanelCommentsShown}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetPinnedData(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax.runAction('socialnetwork.api.livefeed.logentry.getPinData', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\theaders: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('MOBILE_EXT_LIVEFEED_AJAX_ENTITY_HEADER_NAME'),\n\t\t\t\t\t\tvalue: params.entityValue || '',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('MOBILE_EXT_LIVEFEED_AJAX_TOKEN_HEADER_NAME'),\n\t\t\t\t\t\tvalue: params.tokenValue || '',\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tresolve(response.data);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treject(response.errors);\n\t\t\t\t}\n\t\t\t}, (response) => {\n\t\t\t\treject();\n\t\t\t});\n\t\t})\n\t}\n\n\tinsertEntry({\n\t\tlogId,\n\t\tpostNode,\n\t\tpinnedContent\n\t})\n\t{\n\t\tconst pinnedPanelNode = this.getPinnedPanelNode();\n\n\t\tif (\n\t\t\t!Type.isDomNode(postNode)\n\t\t\t|| !Type.isDomNode(pinnedPanelNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postItemPinnedBlock = postNode.querySelector(`.${this.class.postItemPinnedBlock}`);\n\n\t\tif (!Type.isDomNode(postItemPinnedBlock))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpostNode.classList.add(this.class.postItemPinned);\n\t\tpostNode.classList.add(this.class.postItemPinActive);\n\n\t\tpostItemPinnedBlock.innerHTML = `${(Type.isStringFilled(pinnedContent.TITLE) ? `<div class=\"${this.class.postItemPinnedTitle}\">${pinnedContent.TITLE}</div>` : '')}<div class=\"${this.class.postItemPinnedTextBox}\"><div class=\"${this.class.postItemPinnedDesc}\">${pinnedContent.DESCRIPTION}</div></div>`;\n\n\t\tconst cancelPinnedPanel = Tag.render`<div class=\"${this.class.cancelPanel}\" data-livefeed-id=\"${logId}\">\n\t\t\t<div class=\"post-pinned-cancel-panel-content\">\n\t\t\t\t<div class=\"post-pinned-cancel-panel-label\">${Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_PINNED_CANCEL_TITLE')}</div>\n\t\t\t\t\t<div class=\"post-pinned-cancel-panel-text\">${Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_PINNED_CANCEL_DESCRIPTION')}</div>\n\t\t\t\t</div>\n\t\t\t<div class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-sm ${this.class.cancelPanelButton}\">${Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_PINNED_CANCEL_BUTTON')}</div>\n\t\t</div>`;\n\n\t\tconst cancelButton = cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`);\n\t\tcancelButton.addEventListener('touchend', (event) => {\n\n\t\t\tconst cancelPanel = event.currentTarget.closest(`.${this.class.cancelPanel}`);\n\t\t\tif (!cancelPanel)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst logId = parseInt(cancelPanel.getAttribute('data-livefeed-id'));\n\t\t\tif (logId <= 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst postNode = document.querySelector(`.${this.class.post}[data-livefeed-id=\"${logId}\"]`);\n\t\t\tif (!postNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuNode = postNode.querySelector('[data-menu-type=\"post\"]');\n\t\t\tif (!menuNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst postInstance = new Post({\n\t\t\t\tlogId\n\t\t\t});\n\n\t\t\treturn postInstance.setPinned({\n\t\t\t\tmenuNode: menuNode,\n\t\t\t\tcontext: 'list'\n\t\t\t});\n\t\t});\n\n\t\tpostNode.parentNode.insertBefore(cancelPinnedPanel, postNode);\n\t\tDom.prepend(postNode, pinnedPanelNode);\n\n\t\tthis.recalcPanel({\n\t\t\ttype: 'insert'\n\t\t});\n\t\tPageInstance.onScroll();\n\t}\n\n\textractEntry({\n\t\tlogId,\n\t\tpostNode,\n\t\tcontainerNode\n\t})\n\t{\n\t\tconst pinnedPanelNode = this.getPinnedPanelNode();\n\n\t\tif (\n\t\t\t!Type.isDomNode(postNode)\n\t\t\t|| !Type.isDomNode(containerNode)\n\t\t\t|| !Type.isDomNode(pinnedPanelNode)\n\t\t\t|| postNode.parentNode !== pinnedPanelNode\n\t\t\t|| parseInt(logId) <= 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpostNode.classList.remove(this.class.postItemPinned);\n\t\tpostNode.classList.remove(this.class.postItemPinActive);\n\n\t\tconst cancelPanel = document.querySelector(`.${this.class.cancelPanel}[data-livefeed-id=\"${parseInt(logId)}\"]`);\n\t\tif (cancelPanel)\n\t\t{\n\t\t\tcancelPanel.parentNode.insertBefore(postNode, cancelPanel);\n\t\t\tDom.remove(cancelPanel);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.prepend(postNode, containerNode);\n\t\t}\n\n\t\tthis.recalcPanel({\n\t\t\ttype: 'extract'\n\t\t});\n\t}\n}\n\nexport {\n\tPinnedPanel\n}","import {EventEmitter} from 'main.core.events';\n\nclass Rating extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.setEventNamespace('BX.Mobile.Livefeed');\n\t\tthis.subscribe('onFeedInit', this.onFeedInit.bind(this));\n\t}\n\n\tonFeedInit()\n\t{\n\t\tif (!window.BXRL)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tObject.keys(window.BXRL).forEach((key) => {\n\t\t\tif (\n\t\t\t\tkey !== 'manager'\n\t\t\t\t&& key !== 'render'\n\t\t\t)\n\t\t\t{\n\t\t\t\tdelete window.BXRL[key];\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport {\n\tRating\n}","import {Event, Type} from 'main.core';\nimport {Ajax} from 'mobile.ajax';\n\nclass ImportantManager\n{\n\tconstructor()\n\t{\n\n\t}\n\n\tsetPostRead(node)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n\t\t\t|| node.hasAttribute('done')\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst postId = parseInt(node.getAttribute('bx-data-post-id'));\n\t\tif (postId <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.renderRead({\n\t\t\tnode: node,\n\t\t\tvalue: true,\n\t\t});\n\n\t\tAjax.runAction('socialnetwork.api.livefeed.blogpost.important.vote', {\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tPOST_ID : postId,\n\t\t\t\t}\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (\n\t\t\t\t!Type.isStringFilled(response.data.success)\n\t\t\t\t|| response.data.success !== 'Y'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.renderRead({\n\t\t\t\t\tnode: node,\n\t\t\t\t\tvalue: false,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBXMobileApp.onCustomEvent('onLogEntryImpPostRead', {\n\t\t\t\t\tpostId: postId,\n\t\t\t\t}, true);\n\t\t\t}\n\t\t}, (response) => {\n\t\t\tthis.renderRead({\n\t\t\t\tnode: node,\n\t\t\t\tvalue: false,\n\t\t\t});\n\t\t});\n\n\t\treturn true;\n\t}\n\n\trenderRead(params)\n\t{\n\t\tif (\n\t\t\t!Type.isObject(params)\n\t\t\t|| !Type.isDomNode(params.node)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst node = params.node;\n\t\tconst value = !!params.value;\n\n\t\tif (value)\n\t\t{\n\t\t\tnode.checked = true;\n\t\t\tnode.setAttribute('done', 'Y');\n\t\t\tEvent.unbindAll(node);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.checked = false;\n\t\t\tdelete node.checked;\n\t\t\tnode.removeAttribute('done');\n\t\t}\n\n\t\tconst container = node.closest('.post-item-important');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst listNode = container.querySelector('.post-item-important-list');\n\t\tif (!listNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistNode.classList.add('post-item-important-list-read');\n\t}\n}\n\nexport {\n\tImportantManager,\n}","import {Instance, PageInstance} from './feed';\nimport {Post} from './post';\nimport {Type, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nclass SearchBar extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.findTextMode = false;\n\t\tthis.ftMinTokenSize = 3;\n\t\tthis.hideByRefresh = false;\n\t}\n\n\tinit(params)\n\t{\n\t\tif (BXMobileAppContext.getApiVersion() < Instance.getApiVersion('pageMenu'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isPlainObject(params) && parseInt(params.ftMinTokenSize) > 0)\n\t\t{\n\t\t\tthis.ftMinTokenSize = parseInt(params.ftMinTokenSize);\n\t\t}\n\n\t\tthis.subscribe('onSearchBarCancelButtonClicked', this.searchBarEventCallback.bind(this));\n\t\tthis.subscribe('onSearchBarSearchButtonClicked', this.searchBarEventCallback.bind(this));\n\t\tEventEmitter.subscribe('BX.MobileLivefeed.SearchBar::setHideByRefresh', this.setHideByRefresh.bind(this));\n\t\tEventEmitter.subscribe('BX.MobileLivefeed.SearchBar::unsetHideByRefresh', this.unsetHideByRefresh.bind(this));\n\n\t\tBXMobileApp.UI.Page.params.set({\n\t\t\tuseSearchBar: true,\n\t\t});\n\n\t\tapp.exec('setParamsSearchBar', {\n\t\t\tparams: {\n\t\t\t\tcallback: (event) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\tevent.eventName === 'onSearchButtonClicked'\n\t\t\t\t\t\t&& Type.isPlainObject(event.data)\n\t\t\t\t\t\t&& Type.isStringFilled(event.data.text)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (event.data.text.length >= this.ftMinTokenSize)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.findTextMode = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.emit('onSearchBarSearchButtonClicked', new BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\ttext: event.data.text,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t\telse if ([ 'onCancelButtonClicked', 'onSearchHide' ].includes(event.eventName))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('onSearchBarCancelButtonClicked', new BaseEvent({\n\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tsearchBarEventCallback(event)\n\t{\n\t\tconst eventData = event.getData();\n\t\tconst text = (Type.isPlainObject(eventData) && Type.isStringFilled(eventData.text) ? eventData.text : '');\n\n\t\tif (text.length >= this.ftMinTokenSize)\n\t\t{\n\t\t\tapp.exec('showSearchBarProgress');\n\t\t\tthis.emitRefreshEvent(text);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.findTextMode)\n\t\t\t{\n\t\t\t\tif (!this.hideByRefresh)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit('BX.MobileLF:onSearchBarRefreshAbort');\n\t\t\t\t}\n\n\t\t\t\tif (BX.frameCache)\n\t\t\t\t{\n\t\t\t\t\tapp.exec('hideSearchBarProgress');\n\n\t\t\t\t\tBX.frameCache.readCacheWithID('framecache-block-feed', (params) => {\n\n\t\t\t\t\t\tconst container = document.getElementById('bxdynamic_feed_refresh');\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!Type.isArray(params.items)\n\t\t\t\t\t\t\t|| !container\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emitRefreshEvent();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst block = params.items.find(item => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\tType.isStringFilled(item.ID)\n\t\t\t\t\t\t\t\t&& item.ID === 'framecache-block-feed'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (Type.isUndefined(block))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tRuntime.html(container, block.CONTENT).then(() => {\n\t\t\t\t\t\t\tBX.processHTML(block.CONTENT, true);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tPost.moveTop();\n\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tBitrixMobile.LazyLoad.showImages();\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.emitRefreshEvent();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.findTextMode = false;\n\t\t}\n\t}\n\n\tsetHideByRefresh()\n\t{\n\t\tthis.hideByRefresh = true;\n\t}\n\n\tunsetHideByRefresh()\n\t{\n\t\tthis.hideByRefresh = false;\n\t}\n\n\n\temitRefreshEvent(text)\n\t{\n\t\tif (PageInstance.refreshXhr)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttext = text || '';\n\n\t\tconst event = new BaseEvent({\n\t\t\tcompatData: [{\n\t\t\t\ttext: text,\n\t\t\t}],\n\t\t});\n\t\tEventEmitter.emit('BX.MobileLF:onSearchBarRefreshStart', event);\n\t}\n}\n\nexport {\n\tSearchBar\n}","import {Instance} from './feed';\n\nclass PageScroll\n{\n\tconstructor()\n\t{\n\t\tthis.canCheckScrollButton = true;\n\t\tthis.showScrollButtonTimeout = null;\n\t\tthis.showScrollButtonBottom = false;\n\t\tthis.showScrollButtonTop = false;\n\n\t\tthis.class = {\n\t\t\tscrollButton: 'post-comment-block-scroll',\n\t\t\tscrollButtonTop: 'post-comment-block-scroll-top',\n\t\t\tscrollButtonBottom: 'post-comment-block-scroll-bottom',\n\t\t\tscrollButtonTopActive: 'post-comment-block-scroll-top-active',\n\t\t\tscrollButtonBottomActive: 'post-comment-block-scroll-bottom-active',\n\t\t};\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tif (window.platform === 'ios')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdocument.addEventListener('scroll', this.onScrollDetail.bind(this));\n\t}\n\n\tonScrollDetail()\n\t{\n\t\tif (!this.canCheckScrollButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tclearTimeout(this.showScrollButtonTimeout);\n\t\tthis.showScrollButtonTimeout = setTimeout(() => {\n\t\t\tInstance.setLastActivityDate();\n\t\t\tthis.checkScrollButton();\n\t\t}, 200);\n\t}\n\n\tcheckScrollButton()\n\t{\n\t\tconst scrollTop = window.scrollY; // document.body.scrollTop\n\t\tconst maxScroll = (document.documentElement.scrollHeight - window.innerHeight - 100); // (this.keyboardShown ? 500 : 300)\n\n\t\tthis.showScrollButtonBottom = !(\n\t\t\t((document.documentElement.scrollHeight - window.innerHeight) <= 0) // short page\n\t\t\t|| (\n\t\t\t\tscrollTop >= maxScroll // too much low\n\t\t\t\t&& (\n\t\t\t\t\tscrollTop > 0 // refresh patch\n\t\t\t\t\t|| maxScroll > 0\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\n\t\tthis.showScrollButtonTop = (scrollTop > 200);\n\t\tthis.showHideScrollButton();\n\t}\n\n\tshowHideScrollButton()\n\t{\n\t\tconst postScrollButtonBottom = document.querySelector(`.${this.class.scrollButtonBottom}`);\n\t\tconst postScrollButtonTop = document.querySelector(`.${this.class.scrollButtonTop}`);\n\n\t\tif (postScrollButtonBottom)\n\t\t{\n\t\t\tif (this.showScrollButtonBottom)\n\t\t\t{\n\t\t\t\tif (!postScrollButtonBottom.classList.contains(`${this.class.scrollButtonBottomActive}`))\n\t\t\t\t{\n\t\t\t\t\tpostScrollButtonBottom.classList.add(`${this.class.scrollButtonBottomActive}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (postScrollButtonBottom.classList.contains(`${this.class.scrollButtonBottomActive}`))\n\t\t\t\t{\n\t\t\t\t\tpostScrollButtonBottom.classList.remove(`${this.class.scrollButtonBottomActive}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (postScrollButtonTop)\n\t\t{\n\t\t\tif (this.showScrollButtonTop)\n\t\t\t{\n\t\t\t\tif (!postScrollButtonTop.classList.contains(`${this.class.scrollButtonTopActive}`))\n\t\t\t\t{\n\t\t\t\t\tpostScrollButtonTop.classList.add(`${this.class.scrollButtonTopActive}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (postScrollButtonTop.classList.contains(`${this.class.scrollButtonTopActive}`))\n\t\t\t\t{\n\t\t\t\t\tpostScrollButtonTop.classList.remove(`${this.class.scrollButtonTopActive}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tscrollTo(type)\n\t{\n\t\tif (type !== 'top')\n\t\t{\n\t\t\ttype = 'bottom';\n\t\t}\n\n\t\tthis.canCheckScrollButton = false;\n\t\tthis.showScrollButtonBottom = false;\n\t\tthis.showScrollButtonTop = false;\n\n\t\tthis.showHideScrollButton();\n\n\t\tconst startValue = window.scrollY; // document.body.scrollTop\n\t\tconst finishValue = (type == 'bottom' ? document.documentElement.scrollHeight : 0);\n\n\t\tBitrixAnimation.animate({\n\t\t\tduration : 500,\n\t\t\tstart : { scroll : startValue },\n\t\t\tfinish : { scroll : finishValue },\n\t\t\ttransition : BitrixAnimation.makeEaseOut(BitrixAnimation.transitions.quart),\n\t\t\tstep : function(state)\n\t\t\t{\n\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t},\n\t\t\tcomplete : () => {\n\t\t\t\tthis.canCheckScrollButton = true;\n\t\t\t\tthis.checkScrollButton();\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport {\n\tPageScroll,\n}","import {Type,Loc} from 'main.core';\nimport {Ajax} from 'mobile.ajax';\nimport {Instance,PageMenuInstance} from './feed';\n\nclass FollowManager\n{\n\tconstructor()\n\t{\n\t\tthis.defaultValue = true;\n\t\tthis.value = true;\n\n\t\tthis.class = {\n\t\t\tpostItemFollow: 'post-item-follow',\n\t\t\tpostItemFollowActive: 'post-item-follow-active',\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t}\n\n\tsetFollow(params)\n\t{\n\t\tconst logId = (!Type.isUndefined(params.logId) ? parseInt(params.logId) : 0);\n\t\tconst pageId = (!Type.isUndefined(params.pageId) ? params.pageId : false);\n\t\tconst runEvent = (!Type.isUndefined(params.bRunEvent) ? params.bRunEvent : true);\n\t\tconst useAjax = (!Type.isUndefined(params.bAjax) ? params.bAjax : false);\n\n\t\tlet turnOnOnly = (typeof params.bOnlyOn != 'undefined' ? params.bOnlyOn : false);\n\t\tif (turnOnOnly == 'NO')\n\t\t{\n\t\t\tturnOnOnly = false;\n\t\t}\n\n\t\tlet menuNode = null;\n\t\tif (Type.isDomNode(params.menuNode))\n\t\t{\n\t\t\tmenuNode = params.menuNode;\n\t\t}\n\t\telse if (Type.isStringFilled(params.menuNode))\n\t\t{\n\t\t\tmenuNode = document.getElementById(params.menuNode);\n\t\t}\n\n\t\tif (!menuNode)\n\t\t{\n\t\t\tmenuNode = document.getElementById(`log-entry-menu-${logId}`);\n\t\t}\n\n\t\tlet followBlock = document.getElementById(`log_entry_follow_${logId}`);\n\t\tif (!followBlock)\n\t\t{\n\t\t\tfollowBlock = document.getElementById(`log_entry_follow`);\n\t\t}\n\n\t\tlet followWrap = document.getElementById(`post_item_top_wrap_${logId}`);\n\t\tif (!followWrap)\n\t\t{\n\t\t\tfollowWrap = document.getElementById(`post_item_top_wrap`);\n\t\t}\n\n\t\tlet oldValue = null;\n\t\tif (menuNode)\n\t\t{\n\t\t\toldValue = (menuNode.getAttribute('data-follow') === 'Y' ? 'Y' : 'N');\n\t\t}\n\t\telse if (followBlock)\n\t\t{\n\t\t\toldValue = (followBlock.getAttribute('data-follow') == 'Y' ? 'Y' : 'N');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newValue = (oldValue === 'Y' ? 'N' : 'Y');\n\n\t\tif (\n\t\t\t(\n\t\t\t\t!Type.isStringFilled(Instance.getOption('detailPageId'))\n\t\t\t\t|| Instance.getOption('detailPageId') !== pageId\n\t\t\t)\n\t\t\t&& (\n\t\t\t\t!turnOnOnly\n\t\t\t\t|| oldValue === 'N'\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.drawFollow({\n\t\t\t\tvalue: (oldValue !== 'Y'),\n\t\t\t\tfollowBlock: followBlock,\n\t\t\t\tfollowWrap: followWrap,\n\t\t\t\tmenuNode: menuNode,\n\t\t\t\trunEvent: runEvent,\n\t\t\t\tturnOnOnly: turnOnOnly,\n\t\t\t\tlogId: logId,\n\t\t\t});\n\t\t}\n\n\t\tif (useAjax)\n\t\t{\n\t\t\tAjax.runAction('socialnetwork.api.livefeed.changeFollow', {\n\t\t\t\tdata: {\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tvalue: newValue,\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newValue === 'Y' ? 'setFollow' : 'setUnfollow'),\n\t\t\t\t}\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.data.success)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.drawFollow({\n\t\t\t\t\tvalue: (oldValue === 'Y'),\n\t\t\t\t\tfollowBlock: followBlock,\n\t\t\t\t\tfollowWrap: followWrap,\n\t\t\t\t\tmenuNode: menuNode,\n\t\t\t\t\trunEvent: true,\n\t\t\t\t\tturnOnOnly: turnOnOnly,\n\t\t\t\t\tlogId: logId,\n\t\t\t\t});\n\t\t\t}, (response) => {\n\t\t\t\tthis.drawFollow({\n\t\t\t\t\tvalue: (oldValue === 'Y'),\n\t\t\t\t\tfollowBlock: followBlock,\n\t\t\t\t\tfollowWrap: followWrap,\n\t\t\t\t\tmenuNode: menuNode,\n\t\t\t\t\trunEvent: false,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tdrawFollow(params)\n\t{\n\t\tconst value = (Type.isBoolean(params.value) ? params.value : null);\n\t\tif (Type.isNull(value))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst followBlock = (Type.isDomNode(params.followBlock) ? params.followBlock : null);\n\t\tif (followBlock)\n\t\t{\n\t\t\tfollowBlock.classList.remove(value ? this.class.postItemFollow : this.class.postItemFollowActive);\n\t\t\tfollowBlock.classList.add(value ? this.class.postItemFollowActive : this.class.postItemFollow);\n\t\t\tfollowBlock.setAttribute('data-follow', (value ? 'Y' : 'N'));\n\t\t}\n\n\t\tconst followWrap = (Type.isDomNode(params.followWrap) ? params.followWrap : null);\n\t\tif (\n\t\t\tfollowWrap\n\t\t\t&& !this.getFollowDefaultValue()\n\t\t)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tfollowWrap.classList.add(this.class.postItemFollow);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfollowWrap.classList.remove(this.class.postItemFollow);\n\t\t\t}\n\t\t}\n\n\t\tconst menuNode = (Type.isDomNode(params.menuNode) ? params.menuNode : null);\n\t\tif (menuNode)\n\t\t{\n\t\t\tmenuNode.setAttribute('data-follow', (value ? 'Y' : 'N'));\n\t\t}\n\n\t\tconst detailPageId = Instance.getOption('detailPageId');\n\n\t\tif (Type.isStringFilled(detailPageId))\n\t\t{\n\t\t\tthis.setFollowValue(value);\n\t\t\tthis.setFollowMenuItemName();\n\t\t}\n\n\t\tconst runEvent = (Type.isBoolean(params.runEvent) ? params.runEvent : false);\n\t\tconst logId = (!Type.isUndefined(params.logId) ? parseInt(params.logId) : 0);\n\t\tconst turnOnOnly = (Type.isBoolean(params.turnOnOnly) ? params.turnOnOnly : false);\n\n\t\tif (\n\t\t\trunEvent\n\t\t\t&& logId > 0\n\t\t)\n\t\t{\n\t\t\tBXMobileApp.onCustomEvent('onLogEntryFollow', {\n\t\t\t\tlogId: logId,\n\t\t\t\tpageId: (Type.isStringFilled(detailPageId) ? detailPageId : ''),\n\t\t\t\tbOnlyOn: (turnOnOnly ? 'Y' : 'N')\n\t\t\t}, true);\n\t\t}\n\t}\n\n\tsetFollowDefault(params)\n\t{\n\t\tif (Type.isUndefined(params.value))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst value = !!params.value;\n\n\t\tif (!Type.isStringFilled(Instance.getOption('detailPageId')))\n\t\t{\n\t\t\tthis.setFollowDefaultValue(value);\n\t\t\tthis.setDefaultFollowMenuItemName();\n\t\t}\n\n\t\tvar postData = {\n\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\tsite: Loc.getMessage('SITE_ID'),\n\t\t\tlang: Loc.getMessage('LANGUAGE_ID'),\n\t\t\tvalue: (value ? 'Y' : 'N'),\n\t\t\taction: 'change_follow_default',\n\t\t\tmobile_action: 'change_follow_default',\n\t\t};\n\n\t\toMSL.changeListMode(\n\t\t\tpostData,\n\t\t\t() => {\n\t\t\t\toMSL.pullDownAndRefresh();\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tthis.setFollowDefaultValue(response.value !== 'Y');\n\t\t\t\tthis.setDefaultFollowMenuItemName();\n\t\t\t}\n\t\t);\n\t}\n\n\tsetFollowValue(value)\n\t{\n\t\tthis.value = !!value;\n\t}\n\n\tgetFollowValue()\n\t{\n\t\treturn this.value;\n\t}\n\n\tsetFollowDefaultValue(value)\n\t{\n\t\tthis.defaultValue = !!value;\n\t}\n\n\tgetFollowDefaultValue()\n\t{\n\t\treturn this.defaultValue;\n\t}\n\n\tsetFollowMenuItemName()\n\t{\n\t\tconst menuItemIndex = PageMenuInstance.detailPageMenuItems.findIndex(item => {\n\t\t\treturn (\n\t\t\t\tType.isStringFilled(item.feature)\n\t\t\t\t&& item.feature === 'follow'\n\t\t\t);\n\t\t});\n\n\t\tif (menuItemIndex < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItem = PageMenuInstance.detailPageMenuItems[menuItemIndex];\n\n\t\tmenuItem.name = (\n\t\t\tthis.getFollowValue()\n\t\t\t\t? Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_FOLLOW_Y')\n\t\t\t\t: Loc.getMessage('MOBILE_EXT_LIVEFEED_POST_MENU_FOLLOW_N')\n\t\t);\n\t\tPageMenuInstance.detailPageMenuItems[menuItemIndex] = menuItem;\n\t\tPageMenuInstance.init({\n\t\t\ttype: 'detail',\n\t\t});\n\t}\n\n\tsetDefaultFollowMenuItemName ()\n\t{\n\t\tconst menuItemIndex = PageMenuInstance.listPageMenuItems.findIndex(item => {\n\t\t\treturn (\n\t\t\t\tType.isStringFilled(item.feature)\n\t\t\t\t&& item.feature === 'follow'\n\t\t\t);\n\t\t});\n\n\t\tif (menuItemIndex < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItem = PageMenuInstance.listPageMenuItems[menuItemIndex];\n\n\t\tmenuItem.name = (\n\t\t\tthis.getFollowDefaultValue()\n\t\t\t\t? Loc.getMessage('MSLMenuItemFollowDefaultY')\n\t\t\t\t: Loc.getMessage('MSLMenuItemFollowDefaultN')\n\t\t);\n\t\tPageMenuInstance.listPageMenuItems[menuItemIndex] = menuItem;\n\t\tPageMenuInstance.init({\n\t\t\ttype: 'list',\n\t\t});\n\t}\n}\n\nexport {\n\tFollowManager\n}","import {Instance, PageMenuInstance, PageScrollInstance} from './feed';\nimport {Post} from './post';\n\nimport {Loc, Type, Dom, Tag, Runtime} from 'main.core';\nimport {Ajax} from 'mobile.ajax';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nclass Comments\n{\n\tconstructor()\n\t{\n\t\tthis.emptyCommentsXhr = null;\n\t\tthis.repoLog = {};\n\t\tthis.mid = {};\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tEventEmitter.subscribe('OnUCommentWasDeleted', this.deleteHandler.bind(this));\n\t\tEventEmitter.subscribe('OnUCommentWasHidden', this.deleteHandler.bind(this));\n\t\tEventEmitter.subscribe('OnUCRecordHasDrawn', this.drawHandler.bind(this));\n\t\tEventEmitter.subscribe('OnUCFormSubmit', this.submitHandler.bind(this));\n\t}\n\n\tdeleteHandler(event)\n\t{\n\t\tconst [ ENTITY_XML_ID, id ] = event.getData();\n\t\tconst logId = Instance.getLogId();\n\n\t\tif (this.mid[id.join('-')] !== 'hidden')\n\t\t{\n\t\t\tthis.mid[id.join('-')] = 'hidden';\n\n\t\t\tif (this.repoLog[logId])\n\t\t\t{\n\t\t\t\tthis.repoLog[logId]['POST_NUM_COMMENTS']--;\n\t\t\t\tBXMobileApp.onCustomEvent('onLogEntryCommentsNumRefresh', {\n\t\t\t\t\tlog_id: logId,\n\t\t\t\t\tnum: this.repoLog[logId]['POST_NUM_COMMENTS']\n\t\t\t\t}, true);\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawHandler(event)\n\t{\n\t\tconst [ ENTITY_XML_ID, id ] = event.getData();\n\t\tconst logId = Instance.getLogId();\n\n\t\tthis.mid[ENTITY_XML_ID] = (this.mid[ENTITY_XML_ID] || {});\n\t\tif (this.mid[id.join('-')] !== 'drawn')\n\t\t{\n\t\t\tthis.mid[id.join('-')] = 'drawn';\n\t\t\tlet node = false;\n\n\t\t\tif (\n\t\t\t\tthis.repoLog[logId]\n\t\t\t\t&& (node = document.getElementById(`record-${id.join('-')}-cover`))\n\t\t\t\t&& node\n\t\t\t\t&& node.parentNode == document.getElementById(`record-${ENTITY_XML_ID}-new`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.repoLog[logId]['POST_NUM_COMMENTS']++;\n\t\t\t\tBXMobileApp.onCustomEvent('onLogEntryCommentsNumRefresh', {\n\t\t\t\t\tlog_id: logId,\n\t\t\t\t\tnum: this.repoLog[logId]['POST_NUM_COMMENTS']\n\t\t\t\t}, true);\n\t\t\t}\n\t\t}\n\t}\n\n\tsubmitHandler(event)\n\t{\n\t\tconst [ entity_xml_id, id, obj, post_data ] = event.getData();\n\n\t\tif (\n\t\t\tpost_data\n\t\t\t&& post_data.mobile_action\n\t\t\t&& post_data.mobile_action === 'add_comment'\n\t\t\t&& id > 0\n\t\t)\n\t\t{\n\t\t\tpost_data.mobile_action = post_data.action = 'edit_comment';\n\t\t\tpost_data.edit_id = id;\n\t\t}\n\t}\n\n\tsetRepoItem(id, data)\n\t{\n\t\tthis.repoLog[id] = data;\n\t}\n\n\tgetList(params)\n\t{\n\t\tconst timestampValue = params.ts;\n\t\tconst pullDown = !!params.bPullDown;\n\t\tconst pullDownTop = (Type.isUndefined(params.bPullDownTop) || params.bPullDownTop);\n\n\t\tconst moveBottom = (\n\t\t\tType.isUndefined(params.obFocus.form)\n\t\t\t|| params.obFocus.form === 'NO'\n\t\t\t\t? 'NO'\n\t\t\t\t: 'YES'\n\t\t);\n\t\tconst moveTop = (\n\t\t\tType.isUndefined(params.obFocus.comments)\n\t\t\t|| params.obFocus.comments === 'NO'\n\t\t\t\t? 'NO'\n\t\t\t\t: 'YES'\n\t\t);\n\t\tconst logId = oMSL.logId;\n\t\tconst container = document.getElementById('post-comments-wrap');\n\n\t\tif (!pullDown)\n\t\t{\n\t\t\tif (pullDownTop)\n\t\t\t{\n\t\t\t\tBXMobileApp.UI.Page.Refresh.start();\n\t\t\t}\n\n\t\t\tDom.clean(container);\n\t\t\tcontainer.appendChild(Tag.render`<span id=\"post-comment-last-after\"></span>`);\n\t\t}\n\n\t\tthis.showEmptyListWaiter({\n\t\t\tcontainer: container,\n\t\t\tenable: true,\n\t\t});\n\n\t\tEventEmitter.emit('BX.MobileLF:onCommentsGet');\n\t\tBXMobileApp.UI.Page.TextPanel.hide();\n\n\t\tthis.emptyCommentsXhr = Ajax.wrap({\n\t\t\ttype: 'json',\n\t\t\tmethod: 'POST',\n\t\t\turl: `${Loc.getMessage('MSLPathToLogEntry').replace(\"#log_id#\", logId)}&empty_get_comments=Y${(!Type.isNil(timestampValue) ? `&LAST_LOG_TS=${timestampValue}` : '')}`,\n\t\t\tdata: {},\n\t\t\tprocessData: true,\n\t\t\tcallback: (response) => {\n\n\t\t\t\tconst formWrap = document.getElementById('post-comments-form-wrap');\n\n\t\t\t\tif (pullDown)\n\t\t\t\t{\n\t\t\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\t\t}\n\t\t\t\telse if (pullDownTop)\n\t\t\t\t{\n\t\t\t\t\tBXMobileApp.UI.Page.Refresh.stop();\n\t\t\t\t}\n\n\t\t\t\tthis.showEmptyListWaiter({\n\t\t\t\t\tcontainer: container,\n\t\t\t\t\tenable: false,\n\t\t\t\t});\n\n\t\t\t\tif (Type.isStringFilled(response.POST_PERM))\n\t\t\t\t{\n\t\t\t\t\toMSL.menuData.post_perm = response.POST_PERM;\n\t\t\t\t\tPageMenuInstance.detailPageMenuItems = PageMenuInstance.buildDetailPageMenu(oMSL.menuData);\n\t\t\t\t\tPageMenuInstance.init({\n\t\t\t\t\t\ttype: 'detail',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(response.TEXT))\n\t\t\t\t{\n\t\t\t\t\tif (pullDown)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.clean(container);\n\t\t\t\t\t\tif (!Type.isUndefined(response.POST_NUM_COMMENTS))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBXMobileApp.onCustomEvent('onLogEntryCommentsNumRefresh', {\n\t\t\t\t\t\t\t\tlog_id: logId,\n\t\t\t\t\t\t\t\tnum: parseInt(response.POST_NUM_COMMENTS)\n\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setRepoItem(logId, {\n\t\t\t\t\t\tPOST_NUM_COMMENTS: response.POST_NUM_COMMENTS\n\t\t\t\t\t});\n\n\t\t\t\t\tconst contentData = BX.processHTML(response.TEXT, true);\n\n\t\t\t\t\tRuntime.html(container, contentData.HTML).then(() => {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tBitrixMobile.LazyLoad.showImages();\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t});\n\t\t\t\t\tcontainer.appendChild(Tag.render`<span id=\"post-comment-last-after\"></span>`);\n\n\t\t\t\t\tlet cnt = 0;\n\t\t\t\t\tconst func = () => {\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tif (cnt < 100)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (container.childNodes.length > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.ajax.processScripts(contentData.SCRIPT);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.defer(func, this)();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tBX.defer(func, this)();\n\n\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\tmobile: true,\n\t\t\t\t\t\t\tajaxUrl: `${Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_DIR')}mobile/ajax.php`,\n\t\t\t\t\t\t\tcommentsContainerId: 'post-comments-wrap',\n\t\t\t\t\t\t\tcommentsClassName: 'post-comment-wrap',\n\t\t\t\t\t\t}],\n\t\t\t\t\t});\n\t\t\t\t\tEventEmitter.emit('BX.UserContentView.onInitCall', event);\n\t\t\t\t\tEventEmitter.emit('BX.UserContentView.onClearCall', event);\n\n\t\t\t\t\tif (!pullDown) // redraw form\n\t\t\t\t\t{\n\t\t\t\t\t\tif (formWrap)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformWrap.innerHTML = '';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t__MSLDetailPullDownInit(true);\n\n\t\t\t\t\t\tif (moveBottom === 'YES')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setFocusOnComments('form');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (moveTop == 'YES')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setFocusOnComments('list');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tInstance.setLastActivityDate();\n\t\t\t\t\tPageScrollInstance.checkScrollButton();\n\n\t\t\t\t\tconst logIdContainer = document.getElementById('post_log_id');\n\t\t\t\t\tif (\n\t\t\t\t\t\t!Type.isUndefined(response.TS)\n\t\t\t\t\t\t&& logIdContainer\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tlogIdContainer.setAttribute('data-ts', response.TS);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (!pullDown)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showEmptyListWaiter({\n\t\t\t\t\t\t\tcontainer: container,\n\t\t\t\t\t\t\tenable: false,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tapp.alert({\n\t\t\t\t\t\ttitle: Loc.getMessage('MOBILE_EXT_LIVEFEED_ALERT_ERROR_TITLE'),\n\t\t\t\t\t\ttext: Loc.getMessage('MOBILE_EXT_LIVEFEED_ALERT_ERROR_POST_NOT_FOUND_TEXT'),\n\t\t\t\t\t\tbutton: Loc.getMessage('MOBILE_EXT_LIVEFEED_ALERT_ERROR_BUTTON'),\n\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\tBXMobileApp.onCustomEvent('Livefeed::onLogEntryDetailNotFound', {\n\t\t\t\t\t\t\t\tlogId: logId,\n\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\tBXMPage.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tcallback_failure: () => {\n\t\t\t\tif (pullDown)\n\t\t\t\t{\n\t\t\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBXMobileApp.UI.Page.Refresh.stop();\n\t\t\t\t}\n\t\t\t\tthis.showEmptyListWaiter({\n\t\t\t\t\tcontainer: container,\n\t\t\t\t\tenable: false,\n\t\t\t\t});\n\t\t\t\tthis.showEmptyListFailed({\n\t\t\t\t\tcontainer,\n\t\t\t\t\ttimestampValue,\n\t\t\t\t\tpullDown,\n\t\t\t\t\tmoveBottom\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tshowEmptyListWaiter(params)\n\t{\n\t\tconst container = params.container;\n\t\tconst enable = !!params.enable;\n\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst waiterNode = container.querySelector('.post-comments-load-btn-wrap');\n\t\tif (waiterNode)\n\t\t{\n\t\t\tDom.clean(waiterNode);\n\t\t\tDom.remove(waiterNode);\n\t\t}\n\n\t\tif (!enable)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcontainer.appendChild(Tag.render`<div class=\"post-comments-load-btn-wrap\"><div class=\"post-comments-loader\"></div><div class=\"post-comments-load-text\">${Loc.getMessage('MSLDetailCommentsLoading')}</div></div>`);\n\t}\n\n\tshowEmptyListFailed(params)\n\t{\n\t\tconst {\n\t\t\tcontainer,\n\t\t\ttimestampValue,\n\t\t\tpullDown,\n\t\t\tmoveBottom,\n\t\t\tdata,\n\t\t} = params;\n\n\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorMessage = (\n\t\t\tType.isObject(data)\n\t\t\t&& Type.isStringFilled(data.ERROR_MESSAGE)\n\t\t\t\t? data.ERROR_MESSAGE\n\t\t\t\t: Loc.getMessage('MSLDetailCommentsFailed')\n\t\t);\n\n\t\tcontainer.appendChild(Tag.render`<div class=\"post-comments-load-btn-wrap\"><div class=\"post-comments-load-text\">${errorMessage}</div><a class=\"post-comments-load-btn\">${Loc.getMessage('MSLDetailCommentsReload')}</a></div>`);\n\t\tconst button = container.querySelector('.post-comments-load-btn');\n\t\tif (!button)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tbutton.addEventListener('click', (event) => {\n\t\t\tif (Type.isDomNode(event.target.parent))\n\t\t\t{\n\t\t\t\tDom.clean(event.target.parent);\n\t\t\t\tDom.remove(event.target.parent);\n\t\t\t}\n\n\t\t\t// repeat get comments request (after error shown)\n\t\t\tthis.getList({\n\t\t\t\tts: timestampValue,\n\t\t\t\tbPullDown: pullDown,\n\t\t\t\tobFocus: {\n\t\t\t\t\tform: false,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tbutton.addEventListener('touchstart', (event) => { event.target.classList.add('post-comments-load-btn-active'); });\n\t\tbutton.addEventListener('touchend', (event) => { event.target.classList.remove('post-comments-load-btn-active'); });\n\t}\n\n\tabortXhr()\n\t{\n\t\tif (this.emptyCommentsXhr)\n\t\t{\n\t\t\tthis.emptyCommentsXhr.abort();\n\t\t}\n\t}\n\n\tsetFocusOnComments(type)\n\t{\n\t\ttype = (type === 'list' ? 'list' : 'form');\n\n\t\tif (type === 'form')\n\t\t{\n\t\t\tthis.setFocusOnCommentForm();\n\t\t\tPost.moveBottom();\n\t\t}\n\t\telse if (type === 'list')\n\t\t{\n\t\t\tconst container = document.getElementById('post-comments-wrap');\n\t\t\tif (!container)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst firstNewComment = container.querySelector('.post-comment-block-new');\n\t\t\tif (firstNewComment)\n\t\t\t{\n\t\t\t\twindow.scrollTo(0, firstNewComment.offsetTop);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvar firstComment = BX.findChild(container, { className : 'post-comment-block' }, true);\n\t\t\t\twindow.scrollTo(0, (firstComment ? firstComment.offsetTop : 0));\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetFocusOnCommentForm()\n\t{\n\t\tBXMobileApp.UI.Page.TextPanel.focus();\n\t\treturn false;\n\t}\n\n\tonLogEntryCommentAdd(logId, value) // for the feed\n\t{\n\t\tlet newValue;\n\n\t\tconst valuePassed = (!Type.isUndefined(value));\n\n\t\tvalue = (!Type.isUndefined(value) ? parseInt(value) : 0);\n\n\t\tconst container = document.getElementById(`informer_comments_${logId}`);\n\t\tconst containerNew = document.getElementById(`informer_comments_new_${logId}`);\n\n\t\tif (\n\t\t\tcontainer\n\t\t\t&& !containerNew\n\t\t) // detail page\n\t\t{\n\t\t\tif (value > 0)\n\t\t\t{\n\t\t\t\tnewValue = value;\n\t\t\t}\n\t\t\telse if (!valuePassed)\n\t\t\t{\n\t\t\t\tnewValue = (container.innerHTML.length > 0 ? parseInt(container.innerHTML) : 0) + 1;\n\t\t\t}\n\n\t\t\tif (parseInt(newValue) > 0)\n\t\t\t{\n\t\t\t\tcontainer.innerHTML = newValue;\n\t\t\t\tcontainer.style.display = 'inline-block';\n\n\t\t\t\tif (document.getElementById(`informer_comments_text2_${logId}`))\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById(`informer_comments_text2_${logId}`).style.display = 'inline-block';\n\t\t\t\t}\n\t\t\t\tif (document.getElementById(`informer_comments_text_${logId}`))\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById(`informer_comments_text_${logId}`).style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst containerAll = document.getElementById('comcntleave-all');\n\t\tif (containerAll) // more comments\n\t\t{\n\t\t\tif (value > 0)\n\t\t\t{\n\t\t\t\tnewValue = value;\n\t\t\t}\n\t\t\telse if (!valuePassed)\n\t\t\t{\n\t\t\t\tnewValue = (containerAll.innerHTML.length > 0 ? parseInt(containerAll.innerHTML) : 0) + 1;\n\t\t\t}\n\t\t\tcontainerAll.innerHTML = newValue;\n\t\t}\n\t}\n}\n\nexport {\n\tComments\n}","import {Type, Dom, Loc, Uri, ajax} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Ajax} from 'mobile.ajax';\n\nimport {\n\tInstance,\n\tBalloonNotifierInstance,\n\tNextPageLoaderInstance,\n\tNotificationBarInstance,\n\tPinnedPanelInstance,\n} from './feed';\n\nclass Page\n{\n\tconstructor()\n\t{\n\t\tthis.isBusyGettingNextPage = false;\n\t\tthis.isBusyRefreshing = false;\n\n\t\tthis.pageNumber = 1;\n\t\tthis.nextPageXhr = null;\n\t\tthis.refreshXhr = null;\n\n\t\tthis.nextUrl = '';\n\n\t\tthis.requestErrorTimeout = {\n\t\t\trefresh: null,\n\t\t\tnextPage: null,\n\t\t};\n\n\t\tthis.class = {\n\t\t\tnotifier: 'lenta-notifier-waiter',\n\t\t\tnotifierActive: 'lenta-notifier-shown',\n\t\t};\n\n\t\tthis.onScroll = this.onScroll.bind(this);\n\t\tthis.refreshErrorScroll = this.refreshErrorScroll.bind(this);\n\t\tthis.nextPageErrorScroll = this.nextPageErrorScroll.bind(this);\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.setPageNumber(1);\n\t}\n\n\tinitScroll(enable, process_waiter)\n\t{\n\t\tenable = !!enable;\n\t\tprocess_waiter = !!process_waiter;\n\n\t\tif (enable)\n\t\t{\n\t\t\tdocument.removeEventListener('scroll', this.onScroll);\n\t\t\tdocument.addEventListener('scroll', this.onScroll);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdocument.removeEventListener('scroll', this.onScroll);\n\t\t}\n\n\t\tif (\n\t\t\tprocess_waiter\n\t\t\t&& document.getElementById('next_post_more')\n\t\t)\n\t\t{\n\t\t\tdocument.getElementById('next_post_more').style.display = (enable ? 'block' : 'none');\n\t\t}\n\t};\n\n\tonScroll()\n\t{\n\t\tconst deviceMaxScroll = Instance.getMaxScroll();\n\n\t\tif (!(\n\t\t\t(\n\t\t\t\twindow.pageYOffset >= deviceMaxScroll\n\t\t\t\t|| document.documentElement.scrollHeight <= window.innerHeight // when small workarea\n\t\t\t)\n\t\t\t&& (\n\t\t\t\twindow.pageYOffset > 0 // refresh patch\n\t\t\t\t|| deviceMaxScroll > 0\n\t\t\t)\n\t\t\t&& !this.isBusyRefreshing\n\t\t\t&& !this.isBusyGettingNextPage\n\t\t))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Instance.getOption('refreshFrameCacheNeeded', false) === true)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdocument.removeEventListener('scroll', this.onScroll);\n\n\t\tthis.isBusyGettingNextPage = true;\n\n\t\tthis.nextPageXhr = Ajax.wrap({\n\t\t\ttype: 'json',\n\t\t\tmethod: 'POST',\n\t\t\turl: this.getNextPageUrl(),\n\t\t\tdata: {},\n\t\t\tcallback: (data) => {\n\t\t\t\tthis.nextPageXhr = null;\n\n\t\t\t\tif (\n\t\t\t\t\tType.isPlainObject(data)\n\t\t\t\t\t&& Type.isPlainObject(data.PROPS)\n\t\t\t\t\t&& Type.isStringFilled(data.PROPS.CONTENT)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isUndefined(data.LAST_TS)\n\t\t\t\t\t\t|| parseInt(data.LAST_TS) <= 0\n\t\t\t\t\t\t|| parseInt(Loc.getMessage('MSLFirstPageLastTS')) <= 0\n\t\t\t\t\t\t|| parseInt(data.LAST_TS) < parseInt(Loc.getMessage('MSLFirstPageLastTS'))\n\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\tparseInt(data.LAST_TS) === parseInt(Loc.getMessage('MSLFirstPageLastTS'))\n\t\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t\tparseInt(data.LAST_ID) <= 0\n\t\t\t\t\t\t\t\t|| parseInt(Loc.getMessage('MSLFirstPageLastId')) <= 0\n\t\t\t\t\t\t\t\t|| parseInt(data.LAST_ID) !== parseInt(Loc.getMessage('MSLFirstPageLastId'))\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.processAjaxBlock(data.PROPS, {\n\t\t\t\t\t\t\ttype: 'next',\n\t\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\t\tInstance.recalcMaxScroll();\n\n\t\t\t\t\t\t\t\toMSL.registerBlocksToCheck();\n\t\t\t\t\t\t\t\tsetTimeout(oMSL.checkNodesHeight.bind(oMSL), 100);\n\n\t\t\t\t\t\t\t\tEventEmitter.emit('BX.UserContentView.onRegisterViewAreaListCall', new BaseEvent({\n\t\t\t\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\t\t\t\tcontainerId: 'lenta_wrapper',\n\t\t\t\t\t\t\t\t\t\tclassName: 'post-item-contentview',\n\t\t\t\t\t\t\t\t\t\tfullContentClassName: 'post-item-full-content',\n\t\t\t\t\t\t\t\t\t}],\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tlet pageNumber = this.getPageNumber();\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tparseInt(Loc.getMessage('MSLPageNavNum')) > 0\n\t\t\t\t\t\t\t&& pageNumber > 0\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setPageNumber(pageNumber + 1);\n\t\t\t\t\t\t\tlet nextUrl = Uri.removeParam(this.getNextPageUrl(), ['PAGEN_' + Loc.getMessage('MSLPageNavNum')]);\n\t\t\t\t\t\t\tnextUrl = Uri.addParam(nextUrl, {\n\t\t\t\t\t\t\t\t[`PAGEN_${parseInt(Loc.getMessage('MSLPageNavNum'))}`]: (this.getPageNumber() + 1),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.setNextPageUrl(nextUrl);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.addEventListener('scroll', this.onScroll);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.requestError('nextPage', true);\n\t\t\t\t}\n\n\t\t\t\tthis.isBusyGettingNextPage = false;\n\t\t\t},\n\t\t\tcallback_failure: () => {\n\t\t\t\tthis.requestError('nextPage', true);\n\t\t\t\tthis.nextPageXhr = null;\n\t\t\t\tthis.isBusyGettingNextPage = false;\n\t\t\t}\n\t\t});\n\t}\n\n\trefresh(bScroll, params)\n\t{\n\t\tbScroll = !!bScroll;\n\n\t\tif (\n\t\t\tthis.isBusyGettingNextPage\n\t\t\t&& !Type.isNull(this.nextPageXhr)\n\t\t)\n\t\t{\n\t\t\tthis.nextPageXhr.abort();\n\t\t}\n\n\t\tconst notifier = document.getElementById('lenta_notifier');\n\t\tif (notifier)\n\t\t{\n\t\t\tnotifier.classList.add(this.class.notifier);\n\t\t}\n\n\t\tInstance.setRefreshNeeded(false);\n\t\tInstance.setRefreshStarted(true);\n\t\tBalloonNotifierInstance.hideRefreshNeededNotifier();\n\t\tNextPageLoaderInstance.startWaiter();\n\t\tNotificationBarInstance.hideAll();\n\n\t\tthis.isBusyRefreshing = true;\n\n\t\tlet reloadUrl = Uri.removeParam(document.location.href, [ 'RELOAD', 'RELOAD_JSON', 'FIND' ]);\n\t\treloadUrl = Uri.addParam(reloadUrl, {\n\t\t\tRELOAD: 'Y',\n\t\t\tRELOAD_JSON: 'Y',\n\t\t});\n\n\t\tif (\n\t\t\tType.isPlainObject(params)\n\t\t\t&& Type.isStringFilled(params.find)\n\t\t)\n\t\t{\n\t\t\treloadUrl = Uri.addParam(reloadUrl, {\n\t\t\t\tFIND: params.find,\n\t\t\t});\n\t\t}\n\n\t\tconst headers = [\n\t\t\t{ name: 'BX-ACTION-TYPE', value: 'get_dynamic' },\n\t\t\t{ name: 'BX-REF', value: document.referrer },\n\t\t\t{ name: 'BX-CACHE-MODE', value: 'APPCACHE' },\n\t\t\t{ name: 'BX-APPCACHE-PARAMS', value: JSON.stringify(window.appCacheVars) },\n\t\t\t{ name: 'BX-APPCACHE-URL', value: (\n\t\t\t\t!Type.isUndefined(BX.frameCache)\n\t\t\t\t&& Type.isPlainObject(BX.frameCache.vars)\n\t\t\t\t&& Type.isStringFilled(BX.frameCache.vars.PAGE_URL)\n\t\t\t\t\t? BX.frameCache.vars.PAGE_URL\n\t\t\t\t\t: oMSL.curUrl\n\t\t\t\t) }\n\t\t];\n\n\t\tthis.refreshXhr = Ajax.wrap({\n\t\t\ttype: 'json',\n\t\t\tmethod: 'POST',\n\t\t\turl: reloadUrl,\n\t\t\tdata: {},\n\t\t\theaders: headers,\n\t\t\tcallback: (data) => {\n\t\t\t\tthis.refreshXhr = null;\n\t\t\t\tthis.setPageNumber(1);\n\t\t\t\tInstance.setRefreshStarted(false);\n\t\t\t\tInstance.setRefreshNeeded(false);\n\t\t\t\tNextPageLoaderInstance.stopWaiter();\n\n\t\t\t\tif (document.getElementById('lenta_notifier'))\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('lenta_notifier').classList.remove(this.class.notifier);\n\t\t\t\t}\n\n\t\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\t\tapp.exec('hideSearchBarProgress');\n\n\t\t\t\tif (\n\t\t\t\t\tType.isPlainObject(data)\n\t\t\t\t\t&& Type.isPlainObject(data.PROPS)\n\t\t\t\t\t&& Type.isStringFilled(data.PROPS.CONTENT)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.setRefreshFrameCacheNeeded(false);\n\n\t\t\t\t\tBitrixMobile.LazyLoad.clearImages();\n\t\t\t\t\tapp.hidePopupLoader();\n\n\t\t\t\t\tBalloonNotifierInstance.hideNotifier();\n\t\t\t\t\tBalloonNotifierInstance.hideRefreshNeededNotifier();\n\n\t\t\t\t\tif (!Type.isUndefined(data.COUNTER_TO_CLEAR))\n\t\t\t\t\t{\n\t\t\t\t\t\tBXMobileApp.onCustomEvent('onClearLFCounter', [ data.COUNTER_TO_CLEAR ], true);\n\n\t\t\t\t\t\tBXMobileApp.Events.postToComponent('onClearLiveFeedCounter', {\n\t\t\t\t\t\t\tcounterCode: data.COUNTER_TO_CLEAR,\n\t\t\t\t\t\t\tserverTime: data.COUNTER_SERVER_TIME,\n\t\t\t\t\t\t\tserverTimeUnix: data.COUNTER_SERVER_TIME_UNIX,\n\t\t\t\t\t\t}, 'communication');\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.processAjaxBlock(data.PROPS, {\n\t\t\t\t\t\ttype: 'refresh',\n\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\t\t\tPinnedPanelInstance.init();\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t!Type.isUndefined(BX.frameCache)\n\t\t\t\t\t\t\t\t&& document.getElementById('bxdynamic_feed_refresh')\n\t\t\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t\t\tType.isUndefined(data.REWRITE_FRAMECACHE)\n\t\t\t\t\t\t\t\t\t|| data.REWRITE_FRAMECACHE !== 'N'\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst serverTimestamp = (\n\t\t\t\t\t\t\t\t\t!Type.isUndefined(data.TS)\n\t\t\t\t\t\t\t\t\t&& parseInt(data.TS) > 0\n\t\t\t\t\t\t\t\t\t\t? parseInt(data.TS)\n\t\t\t\t\t\t\t\t\t\t: 0\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (serverTimestamp > 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tInstance.setOptions({\n\t\t\t\t\t\t\t\t\t\tframeCacheTs: serverTimestamp,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tInstance.updateFrameCache({\n\t\t\t\t\t\t\t\t\ttimestamp: serverTimestamp,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\toMSL.registerBlocksToCheck();\n\n\t\t\t\t\t\t\t//Android hack.\n\t\t\t\t\t\t\t//The processing of javascript and insertion of html works not so fast as expected\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tBitrixMobile.LazyLoad.showImages(); // when refresh\n\t\t\t\t\t\t\t}, 1000);\n\n\t\t\t\t\t\t\tBalloonNotifierInstance.initEvents();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (bScroll)\n\t\t\t\t\t{\n\t\t\t\t\t\tBitrixAnimation.animate({\n\t\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\t\tstart: {\n\t\t\t\t\t\t\t\tscroll: window.pageYOffset,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfinish: {\n\t\t\t\t\t\t\t\tscroll: 0\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttransition: BitrixAnimation.makeEaseOut(BitrixAnimation.transitions.quart),\n\t\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcomplete: () => {}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\twindow.applicationCache\n\t\t\t\t\t\t&& data.isManifestUpdated == '1'\n\t\t\t\t\t\t&& !oMSL.appCacheDebug\n\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\twindow.applicationCache.status == window.applicationCache.IDLE\n\t\t\t\t\t\t\t|| window.applicationCache.status == window.applicationCache.UPDATEREADY\n\t\t\t\t\t\t)\n\t\t\t\t\t)//the manifest has been changed\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.applicationCache.update();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.requestError('refresh', true);\n\t\t\t\t}\n\n\t\t\t\tthis.isBusyRefreshing = false;\n\t\t\t},\n\t\t\tcallback_failure: () => {\n\t\t\t\tthis.refreshXhr = null;\n\n\t\t\t\tInstance.setRefreshStarted(false);\n\t\t\t\tInstance.setRefreshNeeded(false);\n\t\t\t\tNextPageLoaderInstance.stopWaiter();\n\n\t\t\t\tif (document.getElementById('lenta_notifier'))\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('lenta_notifier').classList.remove(this.class.notifier);\n\t\t\t\t}\n\n\t\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\t\tapp.exec('hideSearchBarProgress');\n\n\t\t\t\tthis.requestError('refresh', true);\n\t\t\t\tthis.isBusyRefreshing = false;\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessAjaxBlock(block, params)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(params)\n\t\t\t|| !Type.isStringFilled(params.type)\n\t\t\t|| ['refresh', 'next'].indexOf(params.type) < 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet htmlWasInserted = false;\n\t\tlet scriptsLoaded = false;\n\n\t\tprocessCSS(insertHTML);\n\t\tprocessExternalJS(processInlineJS);\n\n\t\tfunction processCSS(callback)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isArray(block.CSS)\n\t\t\t\t&& block.CSS.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tBX.load(block.CSS, callback);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\n\t\tfunction insertHTML()\n\t\t{\n\t\t\tif (params.type === 'refresh')\n\t\t\t{\n\t\t\t\tdocument.getElementById('lenta_wrapper_global').innerHTML = block.CONTENT;\n\t\t\t}\n\t\t\telse // next\n\t\t\t{\n\t\t\t\tdocument.getElementById('lenta_wrapper').insertBefore(\n\t\t\t\t\tDom.create('div', {\n\t\t\t\t\t\thtml: block.CONTENT\n\t\t\t\t\t}),\n\t\t\t\t\tdocument.getElementById('next_post_more')\n\t\t\t\t);\n\t\t\t}\n\n\t\t\thtmlWasInserted = true;\n\t\t\tif (scriptsLoaded)\n\t\t\t{\n\t\t\t\tprocessInlineJS();\n\t\t\t}\n\t\t}\n\n\t\tfunction processExternalJS(callback)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isArray(block.JS)\n\t\t\t\t&& block.JS.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tBX.load(block.JS, callback); // to initialize\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\n\t\tfunction processInlineJS()\n\t\t{\n\t\t\tscriptsLoaded = true;\n\n\t\t\tif (htmlWasInserted)\n\t\t\t{\n\t\t\t\tajax.processRequestData(block.CONTENT, {\n\t\t\t\t\tscriptsRunFirst: false,\n\t\t\t\t\tdataType: 'HTML',\n\t\t\t\t\tonsuccess: () => {\n\t\t\t\t\t\tif (Type.isFunction(params.callback))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparams.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\trequestError(type, show)\n\t{\n\t\tif (!['refresh', 'nextPage'].includes(type))\n\t\t{\n\t\t\ttype = 'refresh';\n\t\t}\n\n\t\tshow = !!show;\n\n\t\tconst errorBlock = document.getElementById(`lenta_${type.toLowerCase()}_error`);\n\n\t\tif (this.requestErrorTimeout[type])\n\t\t{\n\t\t\tclearTimeout(this.requestErrorTimeout[type]);\n\t\t}\n\n\t\tif (errorBlock)\n\t\t{\n\t\t\tif (show)\n\t\t\t{\n\t\t\t\terrorBlock.classList.add(this.class.notifierActive);\n\t\t\t\tif (type === 'refresh')\n\t\t\t\t{\n\t\t\t\t\tdocument.addEventListener('scroll', this.refreshErrorScroll);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (type === 'refresh')\n\t\t\t\t{\n\t\t\t\t\tdocument.removeEventListener('scroll', this.refreshErrorScroll);\n\t\t\t\t}\n\t\t\t\terrorBlock.classList.remove(this.class.notifierActive);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.requestErrorTimeout[type] = setTimeout(() => {\n\t\t\t\tthis.requestError(type, show);\n\t\t\t}, 500);\n\t\t}\n\n\t\tif (type === 'nextPage')\n\t\t{\n\t\t\tthis.initScroll(!show, true);\n\t\t}\n\t}\n\n\trefreshErrorScroll()\n\t{\n\t\tthis.requestError('refresh', false);\n\t}\n\n\tnextPageErrorScroll()\n\t{\n\t\tthis.requestError('nextPage', false);\n\t}\n\n\tsetPageNumber(value)\n\t{\n\t\tthis.pageNumber = parseInt(value);\n\t}\n\n\tgetPageNumber()\n\t{\n\t\treturn this.pageNumber;\n\t}\n\n\tsetNextPageUrl(value)\n\t{\n\t\tthis.nextUrl = value;\n\t}\n\n\tgetNextPageUrl()\n\t{\n\t\treturn this.nextUrl;\n\t}\n\n\tsetRefreshFrameCacheNeeded(status)\n\t{\n\t\tInstance.setOptions({\n\t\t\trefreshFrameCacheNeeded: !!status\n\t\t});\n\n\t\tconst refreshNeededNode = document.getElementById('next_page_refresh_needed');\n\t\tconst nextPageCurtainNode = document.getElementById('next_post_more');\n\n\t\tif (\n\t\t\trefreshNeededNode\n\t\t\t&& nextPageCurtainNode\n\t\t)\n\t\t{\n\t\t\trefreshNeededNode.style.display = (!!status ? 'block' : 'none');\n\t\t\tnextPageCurtainNode.style.display = (!!status ? 'none' : 'block');\n\t\t}\n\n\t\tEventEmitter.emit('BX.UserContentView.onSetPreventNextPage', new BaseEvent({\n\t\t\tcompatData: [ !!status ],\n\t\t}));\n\t}\n}\n\nexport {\n\tPage\n}","import {BalloonNotifier} from \"./balloonnotifier\";\nimport {NextPageLoader} from './nextpageloader';\nimport {NotificationBar} from \"./notificationbar\";\nimport {Database} from \"./database\";\nimport {PublicationQueue} from \"./publicationqueue\";\nimport {PostMenu} from \"./menu/postmenu\";\nimport {PageMenu} from \"./menu/pagemenu\";\nimport {PostFormManager} from \"./postform\";\nimport {PostFormOldManager} from \"./postformold\";\nimport {PinnedPanel} from \"./pinned\";\nimport {Rating} from \"./rating\";\nimport {ImportantManager} from \"./important\";\nimport {SearchBar} from \"./searchbar\";\nimport {PageScroll} from \"./pagescroll\";\nimport {FollowManager} from './followmanager';\nimport {Comments} from './comments';\nimport {Post} from './post';\nimport {BlogPost} from './blogpost';\nimport {Page} from \"./page\";\n\nimport {Dom, Tag, Loc, Type, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {Utils} from \"mobile.utils\";\nimport {Ajax} from 'mobile.ajax';\n\nimport 'mobile.imageviewer';\n\nclass Feed\n{\n\tconstructor()\n\t{\n\t\tthis.pageId = null;\n\t\tthis.logId = false;\n\t\tthis.refreshNeeded = false;\n\t\tthis.refreshStarted = false;\n\t\tthis.options = {};\n\t\tthis.nodeId = {\n\t\t\tfeedContainer: 'lenta_wrapper'\n\t\t};\n\t\tthis.class = {\n\t\t\tlistWrapper: 'lenta-list-wrap',\n\t\t\tpostWrapper: 'post-wrap',\n\t\t\tpinnedPanel: 'lenta-pinned-panel',\n\t\t\tpin: 'lenta-item-pin',\n\n\t\t\tpostNewContainerTransformNew: 'lenta-item-new-cont',\n\t\t\tpostNewContainerTransform: 'lenta-item-transform-cont',\n\t\t\tpostLazyLoadCheck: 'lenta-item-lazyload-check',\n\t\t\tlistPost: 'lenta-item',\n\t\t\tdetailPost: 'post-wrap',\n\t\t\tpostItemTopWrap: 'post-item-top-wrap',\n\t\t\tpostItemTop: 'post-item-top',\n\t\t\tpostItemPostBlock: 'post-item-post-block',\n\t\t\tpostItemPostContentView: 'post-item-contentview',\n\t\t\tpostItemDescriptionBlock: 'post-item-description',\n\t\t\tpostItemAttachedFileWrap: 'post-item-attached-disk-file-wrap',\n\t\t\tpostItemInformWrap: 'post-item-inform-wrap',\n\t\t\tpostItemInformWrapTree: 'post-item-inform-wrap-tree',\n\t\t\tpostItemInformComments: 'post-item-inform-comments',\n\t\t\tpostItemInformMore: 'post-item-more',\n\t\t\tpostItemMore: 'post-more-block',\n\t\t\tpostItemPinnedBlock: 'post-item-pinned-block',\n\t\t\tpostItemPinActive: 'lenta-item-pin-active',\n\t\t\tpostItemGratitudeUsersSmallContainer: 'lenta-block-grat-users-small-cont',\n\t\t\tpostItemGratitudeUsersSmallHidden: 'lenta-block-grat-users-small-hidden',\n\t\t\tpostItemImportantUserList: 'post-item-important-list',\n\n\t\t\taddPostButton: 'feed-add-post-button'\n\t\t};\n\n\t\tthis.newPostContainer = null;\n\t\tthis.maxScroll = 0;\n\n\t\tthis.lastActivityDate = 0;\n\t\tthis.availableGroupList = {};\n\n\t\tthis.isPullDownEnabled = false;\n\t\tthis.isPullDownLocked = false;\n\t\tthis.isFrameDataReceived = false;\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostAdd', this.afterPostAdd.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostAddError', this.afterPostAddError.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostUpdate', this.afterPostUpdate.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PublicationQueue::afterPostUpdateError', this.afterPostUpdateError.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed::showLoader', this.showLoader.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed::hideLoader', this.hideLoader.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed::scrollTop', this.scrollTop.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed::onLogEntryDetailNotFound', this.removePost.bind(this)); // from detail page\n\t\tBXMobileApp.addCustomEvent('Livefeed.PinnedPanel::change', this.onPinnedPanelChange.bind(this));\n\t\tBXMobileApp.addCustomEvent('Livefeed.PostDetail::pinChanged', this.onPostPinChanged.bind(this));\n\n\t\tEventEmitter.subscribe('BX.LazyLoad:ImageLoaded', this.onLazyLoadImageLoaded.bind(this));\n\t\tEventEmitter.subscribe('MobileBizProc:onRenderLogMessages', this.onMobileBizProcRenderLogMessages.bind(this));\n\t\tEventEmitter.subscribe('MobilePlayer:onError', this.onMobilePlayerError);\n\n\t\tdocument.addEventListener('DOMContentLoaded', () =>\n\t\t{\n\t\t\tdocument.addEventListener('click', this.handleClick.bind(this));\n\t\t});\n\t}\n\n\tinitListOnce(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (!Type.isUndefined(params.arAvailableGroup))\n\t\t{\n\t\t\tthis.availableGroupList = params.arAvailableGroup;\n\t\t}\n\n\t\tEventEmitter.subscribe('onFrameDataReceivedBefore', BitrixMobile.LazyLoad.clearImages);\n\n\t\tEventEmitter.subscribe('BX.LazyLoad:ImageLoaded', () => {\n\t\t\tthis.recalcMaxScroll();\n\t\t});\n\n\t\tEventEmitter.subscribe('onFrameDataReceived', () => {\n\t\t\tthis.isPullDownEnabled = false;\n\t\t\tthis.isPullDownLocked = false;\n\t\t\tthis.isFrameDataReceived = true;\n\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\tBitrixMobile.LazyLoad.showImages(true);\n\t\t});\n\n\t\tEventEmitter.subscribe('onFrameDataProcessed', (event: BaseEvent) => {\n\t\t\tconst [ blocks, bFromCache ] = event.getCompatData();\n\n\t\t\tif (\n\t\t\t\t!Type.isUndefined(blocks)\n\t\t\t\t&& !Type.isUndefined(blocks[0])\n\t\t\t\t&& !Type.isUndefined(bFromCache)\n\t\t\t\t&& !!bFromCache\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!Type.isUndefined(blocks[0].PROPS)\n\t\t\t\t\t&& !Type.isUndefined(blocks[0].PROPS.TS)\n\t\t\t\t\t&& parseInt(blocks[0].PROPS.TS) > 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\tframeCacheTs: parseInt(blocks[0].PROPS.TS),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBitrixMobile.LazyLoad.showImages(true);\n\n\t\t\tif (!!bFromCache)\n\t\t\t{\n\t\t\t\tPageInstance.setRefreshFrameCacheNeeded(true);\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('onCacheDataRequestStart', () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!this.isFrameDataReceived)\n\t\t\t\t{\n\t\t\t\t\tthis.isPullDownLocked = true;\n\t\t\t\t\tapp.exec('pullDownLoadingStart');\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t});\n\n\t\tEventEmitter.subscribe('onFrameDataReceivedError', () => {\n\t\t\tapp.BasicAuth({\n\t\t\t\tsuccess: () => {\n\t\t\t\t\tBX.frameCache.update(true);\n\t\t\t\t},\n\t\t\t\tfailture: () => {\n\t\t\t\t\tthis.isPullDownLocked = false;\n\t\t\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\t\t\tPageInstance.requestError('refresh', true);\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tEventEmitter.subscribe('onFrameDataRequestFail', (event: BaseEvent) => {\n\t\t\tconst [ response ] = event.getCompatData();\n\n\t\t\tif (\n\t\t\t\t!Type.isUndefined(response)\n\t\t\t\t&& Type.isStringFilled(response.reason)\n\t\t\t\t&& response.reason === 'bad_eval'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.isPullDownLocked = false;\n\t\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\t\tPageInstance.requestError('refresh', true);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tapp.BasicAuth({\n\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\tBX.frameCache.update(true);\n\t\t\t\t\t},\n\t\t\t\t\tfailture: () => {\n\t\t\t\t\t\tthis.isPullDownLocked = false;\n\t\t\t\t\t\tapp.exec('pullDownLoadingStop');\n\t\t\t\t\t\tPageInstance.requestError('refresh', true)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('onCacheInvokeAfter', (event: BaseEvent) => {\n\t\t\tconst [ storageBlocks, resultSet ] = event.getCompatData();\n\n\t\t\tif (resultSet.items.length <= 0)\n\t\t\t{\n\t\t\t\tBX.frameCache.update(true, true);\n\t\t\t}\n\t\t});\n\n\t\tBXMobileApp.addCustomEvent('onAfterEdit', (params) => {\n\t\t\tthis.afterEdit({\n\t\t\t\tresponseData: params.postResponseData,\n\t\t\t\tlogId: params.postData.data.log_id,\n\t\t\t});\n\t\t});\n\n\t\tEventEmitter.subscribe('onPullDownDisable', () => {\n\t\t\tBXMobileApp.UI.Page.Refresh.setEnabled(false);\n\t\t});\n\t\tEventEmitter.subscribe('onPullDownEnable', () => {\n\t\t\tBXMobileApp.UI.Page.Refresh.setEnabled(true);\n\t\t});\n\n\t\tBXMobileApp.UI.Page.Refresh.setParams({\n\t\t\tcallback: () => {\n\t\t\t\tif (!this.isPullDownLocked)\n\t\t\t\t{\n\t\t\t\t\tPageInstance.refresh(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\tbackgroundColor: '#E7E9EB',\n\t\t});\n\n\t\tBXMobileApp.UI.Page.Refresh.setEnabled(true);\n\t}\n\n\tsetPageId(value)\n\t{\n\t\tthis.pageId = value;\n\t}\n\n\tgetPageId()\n\t{\n\t\treturn this.pageId;\n\t};\n\n\tsetLogId(value)\n\t{\n\t\tthis.logId = parseInt(value);\n\t}\n\n\tgetLogId()\n\t{\n\t\treturn parseInt(this.logId);\n\t}\n\n\tsetOptions(optionsList)\n\t{\n\t\tfor (let key in optionsList)\n\t\t{\n\t\t\tif (!optionsList.hasOwnProperty(key))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.options[key] = optionsList[key];\n\t\t}\n\t}\n\n\tgetOption(key, defaultValue)\n\t{\n\t\tif (Type.isUndefined(defaultValue))\n\t\t{\n\t\t\tdefaultValue = null;\n\t\t}\n\n\t\tif (!Type.isStringFilled(key))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (!Type.isUndefined(this.options[key]) ? this.options[key] : defaultValue);\n\t}\n\n\tsetRefreshNeeded(value)\n\t{\n\t\tthis.refreshNeeded = value;\n\t}\n\n\tgetRefreshNeeded()\n\t{\n\t\treturn this.refreshNeeded;\n\t};\n\n\tsetRefreshStarted(value)\n\t{\n\t\tthis.refreshStarted = value;\n\t}\n\n\tgetRefreshStarted()\n\t{\n\t\treturn this.refreshStarted;\n\t};\n\n\tsetNewPostContainer(value)\n\t{\n\t\tthis.newPostContainer = value;\n\t};\n\n\tgetNewPostContainer()\n\t{\n\t\treturn this.newPostContainer;\n\t};\n\n\tsetMaxScroll(value)\n\t{\n\t\tthis.maxScroll = value;\n\t};\n\n\tgetMaxScroll()\n\t{\n\t\treturn this.maxScroll;\n\t};\n\n\tafterPostAdd(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst postId = (typeof params.postId != 'undefined' ? parseInt(params.postId) : 0);\n\t\tconst context = (typeof params.context != 'undefined' ? params.context : '');\n\t\tconst pageId = (typeof params.pageId != 'undefined' ? params.pageId : '');\n\t\tconst groupId = (typeof params.groupId != 'undefined' ? params.groupId : null);\n\n\t\tif (pageId !== this.pageId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDatabaseUnsentPostInstance.delete(groupId);\n\n\t\tif (\n\t\t\tpostId <= 0\n\t\t\t|| Type.isStringFilled(params.warningText)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getEntryContent({\n\t\t\tentityType: 'BLOG_POST',\n\t\t\tentityId: postId,\n\t\t\tqueueKey: params.key,\n\t\t\taction: 'add'\n\t\t});\n\t}\n\n\tafterPostUpdate(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst context = (typeof params.context != 'undefined' ? params.context : '');\n\t\tconst pageId = (typeof params.pageId != 'undefined' ? params.pageId : '');\n\t\tconst postId = (typeof params.postId != 'undefined' ? parseInt(params.postId) : 0);\n\t\tconst pinned = (typeof params.pinned != 'undefined' && !!params.pinned);\n\n\t\tthis.getEntryContent({\n\t\t\tentityType: 'BLOG_POST',\n\t\t\tentityId: postId,\n\t\t\tqueueKey: params.key,\n\t\t\taction: 'update',\n\t\t\tpinned: pinned\n\t\t});\n\t}\n\n\tafterPostAddError(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst context = (Type.isStringFilled(params.context) ? params.context : '');\n\t\tconst groupId = (params.groupId ? params.groupId : '');\n\t\tconst selectedDestinations = {\n\t\t\ta_users: [],\n\t\t\tb_groups: []\n\t\t};\n\n\t\toMSL.buildSelectedDestinations(\n\t\t\tparams.postData,\n\t\t\tselectedDestinations\n\t\t);\n\n\t\tPostFormOldManagerInstance.setParams({\n\t\t\tselectedRecipients: selectedDestinations,\n\t\t});\n\n\t\tPostFormOldManagerInstance.setParams({\n\t\t\tmessageText: params.postData.POST_MESSAGE\n\t\t});\n\n\t\tDatabaseUnsentPostInstance.save(params.postData, groupId);\n\n\t\tparams.callback = () =>\n\t\t{\n\t\t\tif (BXMobileAppContext.getApiVersion() >= this.getApiVersion('layoutPostForm'))\n\t\t\t{\n\t\t\t\tPostFormManagerInstance.show({\n\t\t\t\t\tpageId: this.getPageId(),\n\t\t\t\t\tpostId: 0\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tapp.exec('showPostForm', PostFormOldManagerInstance.show());\n\t\t\t}\n\t\t};\n\t\tthis.showPostError(params);\n\t}\n\n\tafterPostUpdateError(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst context = (Type.isStringFilled(params.context) ? params.context : '');\n\n\t\tparams.callback = () =>\n\t\t{\n\t\t\tBlogPost.edit({\n\t\t\t\tpostId: parseInt(params.postId),\n\t\t\t});\n\t\t};\n\t\tthis.showPostError(params);\n\t}\n\n\tshowPostError(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tparams.callback = (Type.isFunction(params.callback) ? params.callback : () =>\n\t\t{\n\t\t});\n\n\t\tconst errorText = (Type.isStringFilled(params.errorText) ? params.errorText : false);\n\n\t\tNotificationBarInstance.showError({\n\t\t\ttext: (errorText ? errorText : Loc.getMessage('MOBILE_EXT_LIVEFEED_PUBLICATION_ERROR')),\n\t\t\tonTap: (notificationParams) =>\n\t\t\t{\n\t\t\t\tparams.callback(notificationParams);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowLoader(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (\n\t\t\tparams.pageId\n\t\t\t&& this.pageId !== null\n\t\t\t&& params.pageId != this.pageId\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tapp.showPopupLoader({\n\t\t\ttext: (\n\t\t\t\tType.isStringFilled(params.text)\n\t\t\t\t\t? params.text\n\t\t\t\t\t: ''\n\t\t\t)\n\t\t});\n\t}\n\n\thideLoader()\n\t{\n\t\tapp.hidePopupLoader();\n\t}\n\n\tscrollTop(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (\n\t\t\tparams.pageId\n\t\t\t&& this.pageId !== null\n\t\t\t&& params.pageId != this.pageId\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\twindow.scrollTo(0, 0);\n\t};\n\n\tgetEntryContent(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\n\t\tif (\n\t\t\tlogId <= 0\n\t\t\t&& !(\n\t\t\t\tType.isStringFilled(params.entityType)\n\t\t\t\t&& parseInt(params.entityId) > 0\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tAjax.runComponentAction('bitrix:mobile.socialnetwork.log.ex', 'getEntryContent', {\n\t\t\tmode: 'class',\n\t\t\tsignedParameters: this.getOption('signedParameters', {}),\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tlogId: (parseInt(params.logId) > 0 ? parseInt(params.logId) : 0),\n\t\t\t\t\tpinned: (!!params.pinned ? 'Y' : 'N'),\n\t\t\t\t\tentityType: (Type.isStringFilled(params.entityType) ? params.entityType : ''),\n\t\t\t\t\tentityId: (parseInt(params.entityId) > 0 ? parseInt(params.entityId) : 0),\n\t\t\t\t\tsiteTemplateId: Loc.getMessage('MOBILE_EXT_LIVEFEED_SITE_TEMPLATE_ID')\n\t\t\t\t}\n\t\t\t}\n\t\t}).then((response) =>\n\t\t{\n\t\t\tif (logId <= 0)\n\t\t\t{\n\t\t\t\tAjax.runComponentAction('bitrix:mobile.socialnetwork.log.ex', 'getEntryLogId', {\n\t\t\t\t\tmode: 'class',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tentityType: (Type.isStringFilled(params.entityType) ? params.entityType : ''),\n\t\t\t\t\t\t\tentityId: (parseInt(params.entityId) > 0 ? parseInt(params.entityId) : 0)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).then((responseLogId) =>\n\t\t\t\t{\n\t\t\t\t\tif (responseLogId.data.logId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.insertPost({\n\t\t\t\t\t\t\tlogId: responseLogId.data.logId,\n\t\t\t\t\t\t\tcontent: response.data.html,\n\t\t\t\t\t\t\tpostId: params.postId,\n\t\t\t\t\t\t\tqueueKey: params.queueKey,\n\t\t\t\t\t\t\taction: params.action,\n\t\t\t\t\t\t\tserverTimestamp: parseInt(response.data.componentResult.serverTimestamp)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.insertPost({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tcontent: response.data.html,\n\t\t\t\t\tpostId: params.postId,\n\t\t\t\t\tqueueKey: params.queueKey,\n\t\t\t\t\taction: params.action,\n\t\t\t\t\tserverTimestamp: parseInt(response.data.componentResult.serverTimestamp)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tprocessDetailBlock(postContainer, contentWrapper, selector)\n\t{\n\t\tif (\n\t\t\t!postContainer\n\t\t\t|| !contentWrapper\n\t\t)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\tconst content = contentWrapper.querySelector(selector);\n\t\tconst container = postContainer.querySelector(selector);\n\n\t\tif (container && content)\n\t\t{\n\t\t\treturn Runtime.html(container, content.innerHTML);\n\t\t}\n\n\t\treturn Promise.reject();\n\t}\n\n\tinsertPost(params)\n\t{\n\t\tconst containerNode = document.getElementById(this.nodeId.feedContainer);\n\t\tconst content = params.content;\n\t\tconst logId = params.logId;\n\t\tconst queueKey = params.queueKey;\n\t\tconst action = params.action;\n\n\t\tif (\n\t\t\t!Type.isDomNode(containerNode)\n\t\t\t|| !Type.isStringFilled(content)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst serverTimestamp = (\n\t\t\ttypeof (params.serverTimestamp) != 'undefined'\n\t\t\t&& parseInt(params.serverTimestamp) > 0\n\t\t\t\t? parseInt(params.serverTimestamp)\n\t\t\t\t: 0\n\t\t);\n\n\t\tif (action === 'update')\n\t\t{\n\t\t\tlet postContainer = document.getElementById('lenta_item_' + logId);\n\t\t\tif (!postContainer)\n\t\t\t{\n\t\t\t\tpostContainer = document.getElementById('lenta_item');\n\t\t\t}\n\n\t\t\tif (!postContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst matches = this.pageId.match(/^detail_(\\d+)/i);\n\t\t\tif (\n\t\t\t\tmatches\n\t\t\t\t&& logId != matches[1]\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst contentWrapper = postContainer.appendChild(document.createElement('div'));\n\t\t\tcontentWrapper.style.display = 'none';\n\t\t\tRuntime.html(contentWrapper, content);\n\n\t\t\tif (postContainer.id === 'lenta_item') // empty detail\n\t\t\t{\n\t\t\t\tthis.processDetailBlock(postContainer, contentWrapper, `.${this.class.postItemTop}`);\n\t\t\t\tthis.processDetailBlock(postContainer, contentWrapper, `.${this.class.postItemPostBlock}`).then(() =>\n\t\t\t\t{\n\t\t\t\t\tconst pageBlockNode = postContainer.querySelector(`.${this.class.postItemPostBlock}`);\n\t\t\t\t\tconst resultBlockNode = contentWrapper.querySelector(`.${this.class.postItemPostBlock}`);\n\n\t\t\t\t\tif (pageBlockNode || resultBlockNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst pageClassList = this.filterPostBlockClassList(pageBlockNode.classList);\n\t\t\t\t\t\tconst resultClassList = this.filterPostBlockClassList(resultBlockNode.classList);\n\n\t\t\t\t\t\tpageClassList.forEach((className) => {\n\t\t\t\t\t\t\tpageBlockNode.classList.remove(className);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresultClassList.forEach((className) => {\n\t\t\t\t\t\t\tpageBlockNode.classList.add(className);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tBitrixMobile.LazyLoad.showImages();\n\t\t\t\t});\n\t\t\t\tthis.processDetailBlock(postContainer, contentWrapper, `.${this.class.postItemAttachedFileWrap}`).then(() =>\n\t\t\t\t{\n\t\t\t\t\tBitrixMobile.LazyLoad.showImages();\n\t\t\t\t});\n\t\t\t\tthis.processDetailBlock(postContainer, contentWrapper, `.${this.class.postItemInformWrap}`);\n\t\t\t\tthis.processDetailBlock(postContainer, contentWrapper, `.${this.class.postItemInformWrapTree}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpostContainer = postContainer.querySelector(`div.${this.class.postItemTopWrap}`);\n\n\t\t\t\tconst contentPostItemTopWrap = contentWrapper.querySelector(`div.${this.class.postItemTopWrap}`);\n\n\t\t\t\tRuntime.html(postContainer, contentPostItemTopWrap.innerHTML).then(() => {\n\t\t\t\t\toMSL.checkNodesHeight();\n\t\t\t\t\tBitrixMobile.LazyLoad.showImages();\n\n\t\t\t\t\tif (document.getElementById('framecache-block-feed'))\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.updateFrameCache({\n\t\t\t\t\t\t\t\ttimestamp: serverTimestamp\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, 750);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tcontentWrapper.remove();\n\t\t}\n\t\telse if (action === 'add')\n\t\t{\n\t\t\tthis.setNewPostContainer(Tag.render`<div class=\"${this.class.postNewContainerTransformNew} ${this.class.postLazyLoadCheck}\" ontransitionend=\"${this.handleInsertPostTransitionEnd.bind(this)}\"></div>`);\n\t\t\tDom.prepend(this.getNewPostContainer(), containerNode);\n\t\t\tUtils.htmlWithInlineJS(this.getNewPostContainer(), content).then(() =>\n\t\t\t{\n\t\t\t\tconst postNode = this.getNewPostContainer().querySelector(`div.${this.class.listPost}`);\n\t\t\t\tDom.style(this.getNewPostContainer(), 'height', `${postNode.scrollHeight + 12/*margin-bottom*/}px`);\n\n\t\t\t\tif (serverTimestamp > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\tframeCacheTs: serverTimestamp\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\toMSL.registerBlocksToCheck();\n\t\t\t\tsetTimeout(() => { oMSL.checkNodesHeight(); }, 100);\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.updateFrameCache({\n\t\t\t\t\t\ttimestamp: serverTimestamp\n\t\t\t\t\t});\n\t\t\t\t}, 750);\n\t\t\t});\n\t\t}\n\n\t\tPublicationQueueInstance.emit('onPostInserted', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tkey: queueKey\n\t\t\t}\n\t\t}));\n\t}\n\n\tremovePost(params)\n\t{\n\t\tconst logId = parseInt(params.logId);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemNode = document.getElementById('lenta_item_' + logId);\n\n\t\tif (!itemNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titemNode.remove();\n\t}\n\n\tfilterPostBlockClassList(classList)\n\t{\n\t\tconst result = [];\n\n\t\tArray.from(classList).forEach((className) => {\n\t\t\tif (\n\t\t\t\tclassName === 'info-block-background'\n\t\t\t\t|| className === 'info-block-background-with-title'\n\t\t\t\t|| className === 'info-block-gratitude'\n\t\t\t\t|| className === 'info-block-important'\n\t\t\t\t|| className === 'ui-livefeed-background'\n\t\t\t\t|| className.match(/info-block-gratitude-(.+)/i)\n\t\t\t\t|| className.match(/ui-livefeed-background-(.+)/i)\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.push(className);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\thandleInsertPostTransitionEnd(event)\n\t{\n\t\tif (event.propertyName === 'height')\n\t\t{\n\t\t\tthis.getNewPostContainer().classList.remove(this.class.postNewContainerTransformNew);\n\t\t\tthis.getNewPostContainer().classList.remove(this.class.postNewContainerTransform);\n\t\t\tDom.style(this.getNewPostContainer(), 'height', null);\n\n\t\t\tthis.recalcMaxScroll();\n\t\t\tBitrixMobile.LazyLoad.showImages();\n\t\t}\n\t}\n\n\tonLazyLoadImageLoaded(event)\n\t{\n\t\tthis.recalcMaxScroll();\n\n\t\tconst [imageNode] = event.getData();\n\t\tif (imageNode)\n\t\t{\n\t\t\tconst postCheckNode = imageNode.closest(`.${this.class.postLazyLoadCheck}`);\n\t\t\tif (postCheckNode)\n\t\t\t{\n\t\t\t\tconst postNode = postCheckNode.querySelector(`div.${this.class.listPost}`);\n\n\t\t\t\tif (postNode)\n\t\t\t\t{\n\t\t\t\t\tpostCheckNode.classList.add(this.class.postNewContainerTransform);\n\t\t\t\t\tDom.style(postCheckNode, 'height', `${postNode.scrollHeight}px`);\n\t\t\t\t\tsetTimeout(() =>\n\t\t\t\t\t{\n\t\t\t\t\t\tpostCheckNode.classList.remove(this.class.postNewContainerTransform);\n\t\t\t\t\t\tDom.style(postCheckNode, 'height', null);\n\t\t\t\t\t}, 500);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trecalcMaxScroll()\n\t{\n\t\tthis.setMaxScroll(document.documentElement.scrollHeight - (2 * window.innerHeight));\n\t}\n\n\tonMobileBizProcRenderLogMessages()\n\t{\n\t\tthis.recalcMaxScroll();\n\t}\n\n\tonPinnedPanelChange(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst value = (['Y', 'N'].indexOf(params.value) !== -1 ? params.value : null);\n\n\t\tif (\n\t\t\t!logId\n\t\t\t|| !value\n\t\t\t|| !PinnedPanelInstance.getPinnedPanelNode()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet postNode = (Type.isDomNode(params.postNode) ? params.postNode: null);\n\t\tif (!Type.isDomNode(params.postNode)) // from detail in list\n\t\t{\n\t\t\tpostNode = document.getElementById(`lenta_item_${logId}`);\n\t\t}\n\n\t\tif (!Type.isDomNode(postNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (value === 'N')\n\t\t{\n\t\t\tPinnedPanelInstance.extractEntry({\n\t\t\t\tlogId: logId,\n\t\t\t\tpostNode: postNode,\n\t\t\t\tcontainerNode: document.getElementById(this.nodeId.feedContainer)\n\t\t\t});\n\t\t}\n\t\telse if (\n\t\t\tvalue === 'Y'\n\t\t\t&& Type.isDomNode(params.postNode)\n\t\t)\n\t\t{\n\t\t\tapp.showPopupLoader({text:\"\"});\n\n\t\t\tif (this.getOption('refreshFrameCacheNeeded', false) === true)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst entityValue = postNode.getAttribute('data-security-entity-pin');\n\t\t\tconst tokenValue = postNode.getAttribute('data-security-token-pin');\n\n\t\t\tPinnedPanelInstance.getPinnedData({\n\t\t\t\tlogId: logId,\n\t\t\t\tentityValue: entityValue,\n\t\t\t\ttokenValue: tokenValue,\n\t\t\t}).then((pinnedData) => {\n\t\t\t\tapp.hidePopupLoader();\n\n\t\t\t\tPinnedPanelInstance.insertEntry({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tpostNode: params.postNode,\n\t\t\t\t\tpinnedContent: pinnedData\n\t\t\t\t});\n\n\t\t\t}, (response) => {\n\t\t\t\tapp.hidePopupLoader();\n\t\t\t})\n\t\t}\n\t}\n\n\tonPostPinChanged(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst value = (['Y', 'N'].indexOf(params.value) !== -1 ? params.value : null);\n\n\t\tif (\n\t\t\t!logId\n\t\t\t|| !value\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuNode = document.getElementById('log-entry-menu-' + logId);\n\t\tif (!menuNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet postNode = menuNode.closest(`.${this.class.detailPost}`);\n\t\tif (!postNode)\n\t\t{\n\t\t\tpostNode = menuNode.closest(`.${this.class.listPost}`);\n\t\t}\n\t\tif (!postNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (value === 'Y')\n\t\t{\n\t\t\tpostNode.classList.add(this.class.postItemPinActive);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpostNode.classList.remove(this.class.postItemPinActive);\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tif (e.target.classList.contains(this.class.pin))\n\t\t{\n\t\t\tlet post = null;\n\t\t\tlet menuNode = null;\n\t\t\tlet context = 'list';\n\n\t\t\tlet postNode = e.target.closest(`.${this.class.listPost}`);\n\t\t\tif (postNode) // list\n\t\t\t{\n\t\t\t\tmenuNode = postNode.querySelector('[data-menu-type=\"post\"]');\n\t\t\t\tpost = this.getPostFromNode(postNode);\n\t\t\t}\n\t\t\telse // detail\n\t\t\t{\n\t\t\t\tcontext = 'detail';\n\t\t\t\tpostNode = e.target.closest(`.${this.class.detailPost}`);\n\t\t\t\tif (postNode)\n\t\t\t\t{\n\t\t\t\t\tmenuNode = postNode.querySelector('[data-menu-type=\"post\"]');\n\t\t\t\t\tif (menuNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpost = this.getPostFromLogId(menuNode.getAttribute('data-log-id'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tpost\n\t\t\t\t&& menuNode\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn post.setPinned({\n\t\t\t\t\tmenuNode,\n\t\t\t\t\tcontext\n\t\t\t\t});\n\t\t\t}\n\n\t\t\te.stopPropagation();\n\t\t\treturn e.preventDefault();\n\t\t}\n\t\telse if (e.target.classList.contains(this.class.addPostButton))\n\t\t{\n\t\t\tif (BXMobileAppContext.getApiVersion() >= this.getApiVersion('layoutPostForm'))\n\t\t\t{\n\t\t\t\tconst formManager = new PostFormManager();\n\t\t\t\tformManager.show({\n\t\t\t\t\tpageId: this.getPageId(),\n\t\t\t\t\tgroupId: this.getOption('groupId', 0),\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tapp.exec('showPostForm', PostFormOldManagerInstance.show());\n\t\t\t}\n\t\t}\n\t\telse if (\n\t\t\te.target.classList.contains(`.${PageScrollInstance.class.scrollButton}`)\n\t\t\t|| e.target.closest(`.${PageScrollInstance.class.scrollButton}`)\n\t\t)\n\t\t{\n\t\t\tif (\n\t\t\t\te.target.classList.contains(`.${PageScrollInstance.class.scrollButtonTop}`)\n\t\t\t\t|| e.target.closest(`.${PageScrollInstance.class.scrollButtonTop}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tPageScrollInstance.scrollTo('top');\n\t\t\t}\n\t\t\telse if (\n\t\t\t\te.target.classList.contains(`.${PageScrollInstance.class.scrollButtonBottom}`)\n\t\t\t\t|| e.target.closest(`.${PageScrollInstance.class.scrollButtonBottom}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tPageScrollInstance.scrollTo('bottom');\n\t\t\t}\n\t\t}\n\t\telse if (\n\t\t\t(\n\t\t\t\te.target.closest(`.${this.class.listWrapper}`)\n\t\t\t\t|| e.target.closest(`.${this.class.pinnedPanel}`)\n\t\t\t)\n\t\t\t&& !(\n\t\t\t\te.target.tagName.toLowerCase() === 'a'\n\t\t\t\t&& Type.isStringFilled(e.target.getAttribute('target'))\n\t\t\t\t&& e.target.getAttribute('target').toLowerCase() === '_blank'\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tconst detailFromPinned = !!(\n\t\t\t\te.target.classList.contains(this.class.postItemPinnedBlock)\n\t\t\t\t|| e.target.closest(`.${this.class.postItemPinnedBlock}`)\n\t\t\t);\n\t\t\tconst detailFromNormal = !!(!detailFromPinned && (\n\t\t\t\te.target.classList.contains(this.class.postItemPostContentView)\n\t\t\t\t|| e.target.closest(`.${this.class.postItemPostContentView}`)\n\t\t\t\t|| e.target.classList.contains(this.class.postItemDescriptionBlock) // tasks\n\t\t\t\t|| e.target.closest(`.${this.class.postItemDescriptionBlock}`)\n\t\t\t));\n\t\t\tconst detailToComments = !!(!detailFromPinned && !detailFromNormal && (\n\t\t\t\te.target.classList.contains(this.class.postItemInformComments)\n\t\t\t\t|| e.target.closest(`.${this.class.postItemInformComments}`)\n\t\t\t));\n\t\t\tconst detailToExpanded = !!(!detailFromPinned && !detailFromNormal && !detailToComments && (\n\t\t\t\te.target.classList.contains(this.class.postItemInformMore)\n\t\t\t\t|| e.target.closest(`.${this.class.postItemInformMore}`)\n\t\t\t));\n\n\t\t\tif (\n\t\t\t\tdetailFromPinned\n\t\t\t\t|| detailFromNormal\n\t\t\t\t|| detailToComments\n\t\t\t\t|| detailToExpanded\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst postNode = e.target.closest(`.${this.class.listPost}`);\n\t\t\t\tif (postNode)\n\t\t\t\t{\n\t\t\t\t\tconst post = this.getPostFromNode(postNode);\n\t\t\t\t\tif (post)\n\t\t\t\t\t{\n\t\t\t\t\t\tpost.openDetail({\n\t\t\t\t\t\t\tpathToEmptyPage: this.getOption('pathToEmptyPage', ''),\n\t\t\t\t\t\t\tpathToCalendarEvent: this.getOption('pathToCalendarEvent', ''),\n\t\t\t\t\t\t\tpathToTasksRouter: this.getOption('pathToTasksRouter', ''),\n\t\t\t\t\t\t\tevent: e,\n\t\t\t\t\t\t\tfocusComments: detailToComments,\n\t\t\t\t\t\t\tshowFull: detailToExpanded,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn e.preventDefault();\n\t\t\t}\n\t\t}\n\t\telse if (e.target.closest(`.${this.class.postWrapper}`))\n\t\t{\n\t\t\tconst expand = !!(\n\t\t\t\te.target.classList.contains(this.class.postItemInformMore)\n\t\t\t\t|| e.target.closest(`.${this.class.postItemInformMore}`)\n\t\t\t\t|| e.target.classList.contains(this.class.postItemMore)\n\t\t\t\t|| e.target.closest(`.${this.class.postItemMore}`)\n\t\t\t);\n\n\t\t\tlet postItemGratitudeUsersSmallContainer = null;\n\t\t\tif (e.target.classList.contains(this.class.postItemGratitudeUsersSmallContainer))\n\t\t\t{\n\t\t\t\tpostItemGratitudeUsersSmallContainer = e.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpostItemGratitudeUsersSmallContainer = e.target.closest(`.${this.class.postItemGratitudeUsersSmallContainer}`);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\texpand\n\t\t\t\t|| Type.isDomNode(postItemGratitudeUsersSmallContainer)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (Type.isDomNode(postItemGratitudeUsersSmallContainer))\n\t\t\t\t{\n\t\t\t\t\tpostItemGratitudeUsersSmallContainer.style.display = 'none';\n\t\t\t\t\tconst postItemGratitudeUsersSmallHidden = postItemGratitudeUsersSmallContainer.parentNode.querySelector(`.${this.class.postItemGratitudeUsersSmallHidden}`);\n\t\t\t\t\tif (postItemGratitudeUsersSmallHidden)\n\t\t\t\t\t{\n\t\t\t\t\t\tpostItemGratitudeUsersSmallHidden.style.display = 'block';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst logId = this.getOption('logId', 0);\n\t\t\t\tconst post = new Post({\n\t\t\t\t\tlogId: logId\n\t\t\t\t});\n\n\t\t\t\tpost.expandText();\n\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn e.preventDefault();\n\t\t\t}\n\n\t\t\tlet importantUserListNode = null;\n\t\t\tif (e.target.classList.contains(this.class.postItemImportantUserList))\n\t\t\t{\n\t\t\t\timportantUserListNode = e.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\timportantUserListNode = e.target.closest(`.${this.class.postItemImportantUserList}`)\n\t\t\t}\n\n\t\t\tif (importantUserListNode)\n\t\t\t{\n\t\t\t\tconst inputNode = importantUserListNode.parentNode.querySelector('input');\n\t\t\t\tlet postId = 0;\n\t\t\t\tif (Type.isDomNode(inputNode))\n\t\t\t\t{\n\t\t\t\t\tpostId = parseInt(inputNode.getAttribute('bx-data-post-id'));\n\t\t\t\t}\n\n\t\t\t\tif (postId > 0)\n\t\t\t\t{\n\t\t\t\t\tapp.exec(\"openComponent\", {\n\t\t\t\t\t\tname: \"JSStackComponent\",\n\t\t\t\t\t\tcomponentCode: \"livefeed.important.list\",\n\t\t\t\t\t\tscriptPath: \"/mobileapp/jn/livefeed.important.list/?version=1.0.0\",\n\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tPOST_ID: postId,\n\t\t\t\t\t\t\tSETTINGS: this.getOption('importantData', {}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\trootWidget: {\n\t\t\t\t\t\t\tname: 'list',\n\t\t\t\t\t\t\tsettings: {\n\t\t\t\t\t\t\t\tobjectName: \"livefeedImportantListWidget\",\n\t\t\t\t\t\t\t\ttitle: BX.message('MOBILE_EXT_LIVEFEED_USERS_LIST_TITLE'),\n\t\t\t\t\t\t\t\tmodal: false,\n\t\t\t\t\t\t\t\tbackdrop: {\n\t\t\t\t\t\t\t\t\tmediumPositionPercent: 75\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, false);\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetPostFromNode(node)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst logId = parseInt(node.getAttribute('data-livefeed-id'));\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn new Post({\n\t\t\tlogId: logId,\n\t\t\tentryType: node.getAttribute('data-livefeed-post-entry-type'),\n\t\t\tuseFollow: (node.getAttribute('data-livefeed-post-use-follow') === 'Y'),\n\t\t\tuseTasks: (node.getAttribute('data-livefeed-post-use-tasks') === 'Y'),\n\t\t\tperm: node.getAttribute('data-livefeed-post-perm'),\n\t\t\tdestinations: node.getAttribute('data-livefeed-post-destinations'),\n\t\t\tpostId: parseInt(node.getAttribute('data-livefeed-post-id')),\n\t\t\turl: node.getAttribute('data-livefeed-post-url'),\n\t\t\tentityXmlId: node.getAttribute('data-livefeed-post-entity-xml-id'),\n\t\t\treadOnly: (node.getAttribute('data-livefeed-post-read-only') === 'Y'),\n\t\t\tcontentTypeId: node.getAttribute('data-livefeed-post-content-type-id'),\n\t\t\tcontentId: node.getAttribute('data-livefeed-post-content-id'),\n\t\t\tshowFull: (node.getAttribute('data-livefeed-post-show-full') === 'Y'),\n\n\t\t\ttaskId: parseInt(node.getAttribute('data-livefeed-task-id')),\n\t\t\ttaskData: node.getAttribute('data-livefeed-task-data'),\n\n\t\t\tcalendarEventId: parseInt(node.getAttribute('data-livefeed-calendar-event-id'))\n\t\t});\n\t}\n\n\tgetPostFromLogId(logId)\n\t{\n\t\tlet result = null;\n\n\t\tlogId = parseInt(logId);\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = new Post({\n\t\t\tlogId\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tupdateFrameCache(params)\n\t{\n\t\tlet contentNode = document.getElementById('framecache-block-feed');\n\t\tif (!Type.isDomNode(contentNode))\n\t\t{\n\t\t\tcontentNode = document.getElementById('bxdynamic_feed_refresh');\n\t\t}\n\t\tif (!Type.isDomNode(contentNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst props = {\n\t\t\tUSE_BROWSER_STORAGE: true,\n\t\t\tAUTO_UPDATE: true,\n\t\t\tUSE_ANIMATION: false\n\t\t};\n\n\t\tconst timestamp = (typeof params.timestamp != 'undefined' ? parseInt(params.timestamp) : 0);\n\t\tif (timestamp > 0)\n\t\t{\n\t\t\tprops.TS = timestamp;\n\t\t}\n\n\t\tBX.frameCache.writeCacheWithID(\n\t\t\t'framecache-block-feed',\n\t\t\tcontentNode.innerHTML,\n\t\t\tparseInt(Math.random() * 100000),\n\t\t\tJSON.stringify(props)\n\t\t);\n\t}\n\n\tonMobilePlayerError(event)\n\t{\n\t\tconst [player, src] = event.getData();\n\n\t\tif (!Type.isDomNode(player))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isStringFilled(src))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst container = player.parentNode;\n\t\tif (container)\n\t\t{\n\t\t\tif (container.querySelector('.disk-mobile-player-error-container'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (player.querySelector('.disk-mobile-player-error-container'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst sources = player.getElementsByTagName('source');\n\t\tlet sourcesLeft = sources.length;\n\n\t\tArray.from(sources).forEach((source) => {\n\t\t\tif (\n\t\t\t\tType.isStringFilled(source.src)\n\t\t\t\t&& source.src === src\n\t\t\t)\n\t\t\t{\n\t\t\t\tDom.remove(source);\n\t\t\t\tsourcesLeft--;\n\t\t\t}\n\t\t});\n\n\t\tif (sourcesLeft > 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorContainer = Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'disk-mobile-player-error-container'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'disk-mobile-player-error-icon'\n\t\t\t\t\t},\n\t\t\t\t\thtml: ''\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'disk-mobile-player-error-message'\n\t\t\t\t\t},\n\t\t\t\t\thtml: Loc.getMessage('MOBILE_EXT_LIVEFEED_PLAYER_ERROR_MESSAGE')\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tconst downloadLink = errorContainer.querySelector('.disk-mobile-player-download');\n\t\tif (downloadLink)\n\t\t{\n\t\t\tDom.adjust(downloadLink, {\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tapp.openDocument({\n\t\t\t\t\t\t\turl: src\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (container)\n\t\t{\n\t\t\tplayer.style.display = 'none';\n\t\t\tcontainer.appendChild(errorContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.adjust(player, {\n\t\t\t\tchildren: [ errorContainer ]\n\t\t\t});\n\t\t}\n\t}\n\n\tgetApiVersion(feature)\n\t{\n\t\tlet result = 0;\n\t\tswitch (feature)\n\t\t{\n\t\t\tcase 'layoutPostForm':\n\t\t\t\tresult = 37;\n\t\t\t\tbreak;\n\t\t\tcase 'pageMenu':\n\t\t\t\tresult = 34;\n\t\t\t\tbreak;\n\t\t\tcase 'tabs':\n\t\t\t\tresult = 41;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsendErrorEval(script)\n\t{\n\t\tBX.evalGlobal('try { ' + script + ' } catch (e) { this.sendError(e.message, e.name, e.number); }');\n\t};\n\n\tsendError(message, url, linenumber)\n\t{\n\t\tAjax.runAction('socialnetwork.api.livefeed.mobileLogError', {\n\t\t\tdata: {\n\t\t\t\tmessage: message,\n\t\t\t\turl: url,\n\t\t\t\tlineNumber: linenumber,\n\t\t\t}\n\t\t}).then((response) => {\n\t\t}, (response) => {\n\t\t});\n\t}\n\n\tsetLastActivityDate()\n\t{\n\t\tthis.lastActivityDate = Math.round(new Date().getTime() / 1000);\n\t}\n\n\tgetLastActivityDate()\n\t{\n\t\treturn this.lastActivityDate;\n\t}\n\n\tafterEdit({\n\t\tresponseData,\n\t\tlogId\n\t})\n\t{\n\t\tlogId = (!Type.isUndefined(logId) ? parseInt(logId) : 0);\n\n\t\tconst newPostNode = Tag.render`<div>${responseData.text}</div>`;\n\n\t\tconst container = document.getElementById('blog-post-first-after');\n\t\tif (container)\n\t\t{\n\t\t\tcontainer.parentNode.insertBefore(newPostNode, container.nextSibling);\n\t\t}\n\n\t\tconst detailTextNode = newPostNode.querySelector(`.post-item-post-block`);\n\t\tconst topNode = newPostNode.querySelector(`.post-item-top`);\n\t\tconst filesNode = newPostNode.querySelector(`.post-item-attached-file-wrap`);\n\n\t\tif (\n\t\t\tlogId > 0\n\t\t\t&& detailTextNode\n\t\t\t&& topNode\n\t\t)\n\t\t{\n\t\t\tconst postData = {\n\t\t\t\tdetailText: detailTextNode.innerHTML,\n\t\t\t\ttopText: topNode.innerHTML,\n\t\t\t\tlogID: logId\n\t\t\t};\n\n\t\t\tif (filesNode)\n\t\t\t{\n\t\t\t\tpostData.filesBlockText = filesNode.innerHTML;\n\t\t\t}\n\n\t\t\tBXMobileApp.onCustomEvent('onEditedPostInserted', postData, true, true);\n\t\t}\n\n\t\tBitrixMobile.LazyLoad.showImages();\n\t}\n}\n\nconst Instance = new Feed();\nconst BalloonNotifierInstance = new BalloonNotifier();\nconst NextPageLoaderInstance = new NextPageLoader();\nconst NotificationBarInstance = new NotificationBar();\nconst DatabaseUnsentPostInstance = new Database();\nconst PublicationQueueInstance = new PublicationQueue();\nconst PostMenuInstance = new PostMenu();\nconst PageMenuInstance = new PageMenu();\nconst PostFormManagerInstance = new PostFormManager();\nconst PostFormOldManagerInstance = new PostFormOldManager();\nconst PinnedPanelInstance = new PinnedPanel();\nconst RatingInstance = new Rating();\nconst ImportantManagerInstance = new ImportantManager();\nconst SearchBarInstance = new SearchBar();\nconst PageScrollInstance = new PageScroll();\nconst FollowManagerInstance = new FollowManager();\nconst CommentsInstance = new Comments();\nconst PageInstance = new Page();\n\nexport {\n\tPost,\n\tBlogPost,\n\n\tInstance,\n\tBalloonNotifierInstance,\n\tNextPageLoaderInstance,\n\tNotificationBarInstance,\n\tDatabaseUnsentPostInstance,\n\tPublicationQueueInstance,\n\tPostMenuInstance,\n\tPageMenuInstance,\n\tPostFormManagerInstance,\n\tPostFormOldManagerInstance,\n\tPinnedPanelInstance,\n\tRatingInstance,\n\tImportantManagerInstance,\n\tSearchBarInstance,\n\tPageScrollInstance,\n\tFollowManagerInstance,\n\tCommentsInstance,\n\tPageInstance,\n};\n"],"names":["BalloonNotifier","initialized","classes","show","nodeIdList","notifier","notifierCounter","notifierCounterTitle","refreshNeeded","refreshError","nextPageError","init","EventEmitter","subscribe","notifierNode","getNotifierNode","initEvents","addEventListener","PageInstance","refresh","refreshNeededNode","getRefreshNeededNode","app","exec","refreshErrorNode","getRefreshErrorNode","requestError","nextPageErrorNode","getNextPageErrorNode","document","getElementById","refreshNeededBlock","classList","add","remove","params","cnt","parseInt","counterValue","cnt_cent","reminder","suffix","Instance","getRefreshNeeded","getNotifierCounterNode","innerHTML","hideRefreshNeededNotifier","getNotifierCounterTitleNode","Loc","getMessage","NextPageLoader","buttonNode","getButtonNode","e","button","NotificationBar","repo","color","background","error","info","text","filter","notifyBar","forEach","hide","bar","BXMobileApp","UI","message","textColor","useLoader","groupId","align","textAlign","autoHideTimeout","hideOnTap","onTap","id","Math","random","push","maxLines","isGlobal","useCloseButton","Database","tableName","keyName","setTableName","Type","isPlainObject","isStringFilled","setKeyName","addCustomEvent","onClear","bind","value","storageId","getTableName","key","getKeyName","callback","res","data","x","hasOwnProperty","JSON","parse","Object","keys","length","onLoad","onEmpty","PublicationQueue","nodeId","container","balloonHidden","balloonFixed","balloonPublished","balloonShow","balloonHide","timeout","afterSetItem","afterPostAdd","afterPostAddError","afterPostUpdate","afterPostUpdateError","setEventNamespace","onFeedLoaded","onPostInserted","Event","onScroll","containerNode","isDomNode","window","pageYOffset","queue","addToTray","drawList","event","removeFromTray","node","drawItem","hideItem","setTimeout","warningText","lastElementChild","title","Tag","render","Dom","clean","append","pageId","contentType","getPageId","addSuccess","Post","scrollTo","body","scrollHeight","logId","entryType","useFollow","useTasks","perm","destinations","postId","url","entityXmlId","readOnly","contentTypeId","contentId","showFull","taskId","taskData","calendarEventId","oldValue","getAttribute","newValue","contains","setAttribute","Ajax","runAction","analyticsLabel","b24statAction","b24statContext","then","response","success","FollowManagerInstance","setFollow","bOnlyOn","bRunEvent","bAjax","onCustomEvent","log_id","page_id","preventDefault","stopPropagation","menuNode","context","action","postNode","closest","pinActionContext","pathToEmptyPage","pathToCalendarEvent","pathToTasksRouter","focusComments","BXMobileAppContext","getApiVersion","Events","postToComponent","taskInfo","creatorIcon","responsibleIcon","getTaskInfo","path","replace","__MSLOpenLogEntryNew","entry_type","use_follow","use_tasks","post_perm","post_id","post_url","entity_xml_id","focus_comments","focus_form","show_full","read_only","post_content_type_id","post_content_id","pinnedValue","oMSL","expandText","BlogPost","isUndefined","confirm","buttons","btnNum","showPopupLoader","actionUrl","Uri","addParam","wrap","type","method","mobile_action","sessid","site","lang","processData","hidePopupLoader","SUCCESS","closeController","drop","callback_failure","pinnedContext","Application","PostFormManagerInstance","getData","postData","PostFormOldManagerInstance","formParams","PostPerm","selectedDestinations","a_users","b_groups","setExtraDataArray","postAuthorId","post_user_id","PostDetailText","setParams","messageText","PostDestination","entries","STYLE","addDestination","TYPE","includes","ID","name","Text","decode","TITLE","PostDestinationHidden","setExtraData","hiddenRecipients","selectedRecipients","PostFiles","messageFiles","PostUFCode","messageUFCode","callbackFunction","isFunction","isNull","result","nt","sl","PostBackgroundCode","PostMenu","iconUrlFolderPath","sectionCode","postPerms","isInteger","useShare","Boolean","useFavorites","usePinned","useRefreshComments","favoritesValue","followValue","target","iconUrl","postInstance","setPinned","iconName","openTable","shareBlogPost","markmode","multiple","return_full_mode","user_all","showtitle","modal","selected","alphabet_index","okname","cancelname","outsection","arrowFlag","edit","feedId","LiveFeedID","feature","setFavorites","bDetailEmptyPage","CommentsInstance","getComments","ts","iDetailTs","bPullDown","obFocus","form","location","reload","copyPostLink","createTask","entityType","entityId","sendData","tool","category","c_section","c_element","PageMenu","listPageMenuItems","detailPageMenuItems","menuItems","getPageMenuItems","initPagePopupMenu","menuCreate","items","Page","TopBar","setCallback","menuShow","setText","BX","isArray","showPageMenu","buildDetailPageMenu","menuData","popupMenuItems","popupMenuActions","menuItem","image","sections","eventName","item","getLogId","PostMenuInstance","getFollowValue","getMenuItems","map","PostFormManager","getDatabaseData","getWorkgroupData","getPostData","processPostData","componentCode","scriptPath","getOption","rootWidget","settings","objectName","promise","Promise","resolve","reject","DatabaseUnsentPostInstance","load","post","POST_TITLE","PostTitle","POST_MESSAGE","isArrayFilled","DEST","DEST_DATA","patterns","pattern","style","i","matches","match","BACKGROUND_CODE","IMPORTANT","PostImportantData","IMPORTANT_DATE_END","endDate","Date","GRATITUDE_MEDAL","PostGratitudeData","gratitude","employees","Array","GRATITUDE_EMPLOYEES","GRATITUDE_EMPLOYEES_DATA","userId","userData","imageUrl","subtitle","voteId","dataKey","UF_BLOG_POST_VOTE","QUESTIONS","PostVoteData","questions","question","QUESTION","allowMultiSelect","FIELD_TYPE","answers","ANSWERS","answer","MESSAGE","console","promiseData","currentDateTime","returnEventName","getTime","assign","group","groupData","NAME","recipients","code","shortTitle","SHORT_TITLE","avatar","AVATAR","groups","PostFormOldManager","postFormParams","postFormExtraData","extraData","ob","indexOf","searchRes","some","findDestinationCallBack","bubble_background_color","bubble_text_color","element","index","array","getExtraData","attachButton","getAttachButton","mentionButton","getMentionButton","attachFileSettings","getAttachFileSettings","smileButton","supportLocalFilesInText","okButton","buildRequestStub","parseMentions","ufCode","buildFiles","attachedFiles","buildDestinations","postVirtualId","initPostForm","cancelButton","dataSource","getRecipientsDataSource","backgroundCode","attachButtonItems","diskAttachParams","tableSettings","searchField","platform","table_settings","TABLE_SETTINGS","resize","saveToPhotoAlbum","request","ACTION","AJAX_CALL","PUBLISH_STATUS","is_sent","apply","SPERM","SPERM_NAME","MOBILE","PARSE_PREVIEW","commentId","commentType","comment_post_id","parsedText","arMention","RegExp","commentTextCurrent","tasksList","readedFileCount","fileTotal","fileCountIncrement","postProgressingFiles","uploadTasks","fileData","isFileFromBitrix24Disk","VALUE","dataAttributes","isNewFileOnDevice","isNumber","mimeType","MobileUtils","getFileMimeType","folderId","getUploadFilename","previewUrl","getResizeOptions","files","prefix","getmessage","keyOld","keyNew","PinnedPanel","panelInitialized","panel","panelCollapsed","panelActive","collapsedPanel","collapsedPanelPostsValue","collapsedPanelComments","collapsedPanelCommentsShown","collapsedPanelCommentsValue","collapsedPanelCommentsValueNew","collapsedPanelExpandButton","postItemPinned","postItemPinActive","postItemPinnedBlock","postItemPinnedTitle","postItemPinnedTextBox","postItemPinnedDesc","cancelPanel","cancelPanelButton","querySelector","adjustCollapsedPostsPanel","expandCollapsedPostsPanel","getPostsCount","getPinnedPanelNode","recalcCollapsedPostsPanel","from","getElementsByClassName","postsCounter","postsCounterNode","commentsCounterNode","commentsCounterValueNode","newCommentCounter","querySelectorAll","reduce","acc","headers","entityValue","tokenValue","status","errors","pinnedContent","pinnedPanelNode","DESCRIPTION","cancelPinnedPanel","currentTarget","parentNode","insertBefore","prepend","recalcPanel","Rating","onFeedInit","BXRL","ImportantManager","hasAttribute","renderRead","POST_ID","isObject","checked","unbindAll","removeAttribute","listNode","SearchBar","findTextMode","ftMinTokenSize","hideByRefresh","searchBarEventCallback","setHideByRefresh","unsetHideByRefresh","set","useSearchBar","emit","BaseEvent","eventData","emitRefreshEvent","frameCache","readCacheWithID","block","find","Runtime","html","CONTENT","processHTML","moveTop","BitrixMobile","LazyLoad","showImages","refreshXhr","compatData","PageScroll","canCheckScrollButton","showScrollButtonTimeout","showScrollButtonBottom","showScrollButtonTop","scrollButton","scrollButtonTop","scrollButtonBottom","scrollButtonTopActive","scrollButtonBottomActive","onScrollDetail","clearTimeout","setLastActivityDate","checkScrollButton","scrollTop","scrollY","maxScroll","documentElement","innerHeight","showHideScrollButton","postScrollButtonBottom","postScrollButtonTop","startValue","finishValue","BitrixAnimation","animate","duration","start","scroll","finish","transition","makeEaseOut","transitions","quart","step","state","complete","FollowManager","defaultValue","postItemFollow","postItemFollowActive","runEvent","useAjax","turnOnOnly","followBlock","followWrap","drawFollow","isBoolean","getFollowDefaultValue","detailPageId","setFollowValue","setFollowMenuItemName","setFollowDefaultValue","setDefaultFollowMenuItemName","bitrix_sessid","changeListMode","pullDownAndRefresh","menuItemIndex","PageMenuInstance","findIndex","Comments","emptyCommentsXhr","repoLog","mid","deleteHandler","drawHandler","submitHandler","ENTITY_XML_ID","join","num","obj","post_data","edit_id","timestampValue","pullDown","pullDownTop","bPullDownTop","moveBottom","comments","Refresh","appendChild","showEmptyListWaiter","enable","TextPanel","isNil","formWrap","stop","POST_PERM","TEXT","POST_NUM_COMMENTS","setRepoItem","contentData","HTML","func","childNodes","ajax","processScripts","SCRIPT","defer","mobile","ajaxUrl","commentsContainerId","commentsClassName","__MSLDetailPullDownInit","setFocusOnComments","PageScrollInstance","logIdContainer","TS","alert","BXMPage","close","showEmptyListFailed","waiterNode","errorMessage","ERROR_MESSAGE","parent","getList","abort","setFocusOnCommentForm","firstNewComment","offsetTop","firstComment","findChild","className","focus","valuePassed","containerNew","display","containerAll","isBusyGettingNextPage","isBusyRefreshing","pageNumber","nextPageXhr","nextUrl","requestErrorTimeout","nextPage","notifierActive","refreshErrorScroll","nextPageErrorScroll","setPageNumber","process_waiter","removeEventListener","deviceMaxScroll","getMaxScroll","getNextPageUrl","PROPS","LAST_TS","LAST_ID","processAjaxBlock","recalcMaxScroll","registerBlocksToCheck","checkNodesHeight","containerId","fullContentClassName","getPageNumber","removeParam","setNextPageUrl","bScroll","setRefreshNeeded","setRefreshStarted","BalloonNotifierInstance","NextPageLoaderInstance","startWaiter","NotificationBarInstance","hideAll","reloadUrl","href","RELOAD","RELOAD_JSON","FIND","referrer","stringify","appCacheVars","vars","PAGE_URL","curUrl","stopWaiter","setRefreshFrameCacheNeeded","clearImages","hideNotifier","COUNTER_TO_CLEAR","counterCode","serverTime","COUNTER_SERVER_TIME","serverTimeUnix","COUNTER_SERVER_TIME_UNIX","PinnedPanelInstance","resetFlags","REWRITE_FRAMECACHE","serverTimestamp","setOptions","frameCacheTs","updateFrameCache","timestamp","applicationCache","isManifestUpdated","appCacheDebug","IDLE","UPDATEREADY","update","htmlWasInserted","scriptsLoaded","processCSS","insertHTML","processExternalJS","processInlineJS","CSS","create","JS","processRequestData","scriptsRunFirst","dataType","onsuccess","errorBlock","toLowerCase","initScroll","refreshFrameCacheNeeded","nextPageCurtainNode","Feed","refreshStarted","options","feedContainer","listWrapper","postWrapper","pinnedPanel","pin","postNewContainerTransformNew","postNewContainerTransform","postLazyLoadCheck","listPost","detailPost","postItemTopWrap","postItemTop","postItemPostBlock","postItemPostContentView","postItemDescriptionBlock","postItemAttachedFileWrap","postItemInformWrap","postItemInformWrapTree","postItemInformComments","postItemInformMore","postItemMore","postItemGratitudeUsersSmallContainer","postItemGratitudeUsersSmallHidden","postItemImportantUserList","addPostButton","newPostContainer","lastActivityDate","availableGroupList","isPullDownEnabled","isPullDownLocked","isFrameDataReceived","showLoader","hideLoader","removePost","onPinnedPanelChange","onPostPinChanged","onLazyLoadImageLoaded","onMobileBizProcRenderLogMessages","onMobilePlayerError","handleClick","arAvailableGroup","getCompatData","blocks","bFromCache","BasicAuth","failture","reason","storageBlocks","resultSet","afterEdit","responseData","postResponseData","setEnabled","backgroundColor","optionsList","getEntryContent","queueKey","pinned","buildSelectedDestinations","save","showPostError","errorText","showError","notificationParams","runComponentAction","mode","signedParameters","siteTemplateId","responseLogId","insertPost","content","componentResult","postContainer","contentWrapper","selector","createElement","processDetailBlock","pageBlockNode","resultBlockNode","pageClassList","filterPostBlockClassList","resultClassList","contentPostItemTopWrap","setNewPostContainer","handleInsertPostTransitionEnd","getNewPostContainer","Utils","htmlWithInlineJS","PublicationQueueInstance","itemNode","propertyName","imageNode","postCheckNode","setMaxScroll","extractEntry","getPinnedData","pinnedData","insertEntry","getPostFromNode","getPostFromLogId","formManager","tagName","detailFromPinned","detailFromNormal","detailToComments","detailToExpanded","openDetail","expand","importantUserListNode","inputNode","SETTINGS","backdrop","mediumPositionPercent","contentNode","props","USE_BROWSER_STORAGE","AUTO_UPDATE","USE_ANIMATION","writeCacheWithID","player","src","sources","getElementsByTagName","sourcesLeft","source","errorContainer","children","downloadLink","adjust","events","click","openDocument","script","evalGlobal","linenumber","lineNumber","round","newPostNode","nextSibling","detailTextNode","topNode","filesNode","detailText","topText","logID","filesBlockText","RatingInstance","ImportantManagerInstance","SearchBarInstance"],"mappings":";;;;;CAE8C,IAExCA,eAAe;GAEpB,2BACA;KAAA;KAAA;KACC,IAAI,CAACC,WAAW,GAAG,KAAK;KACxB,IAAI,CAACC,OAAO,GAAG;OACdC,IAAI,EAAE;MACN;KACD,IAAI,CAACC,UAAU,GAAG;OACjBC,QAAQ,EAAE,gBAAgB;OAC1BC,eAAe,EAAE,oBAAoB;OACrCC,oBAAoB,EAAE,0BAA0B;OAChDC,aAAa,EAAE,kBAAkB;OACjCC,YAAY,EAAE,qBAAqB;OACnCC,aAAa,EAAE;MACf;KAED,IAAI,CAACC,IAAI,EAAE;KACXC,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,YAAM;OACpD,KAAI,CAACF,IAAI,EAAE;MACX,CAAC;;GACF;KAAA;KAAA,uBAGD;OACC,IAAMG,YAAY,GAAG,IAAI,CAACC,eAAe,EAAE;OAC3C,IACC,CAACD,YAAY,IACV,IAAI,CAACb,WAAW,EAEpB;SACC;;OAGD,IAAI,CAACA,WAAW,GAAG,IAAI;OACvB,IAAI,CAACe,UAAU,EAAE;;;KACjB;KAAA,6BAGD;OACC,IAAMF,YAAY,GAAG,IAAI,CAACC,eAAe,EAAE;OAE3CD,YAAY,CAACG,gBAAgB,CAAC,OAAO,EAAE,YAAM;SAC5CC,YAAY,CAACC,OAAO,CAAC,IAAI,CAAC;SAC1B,OAAO,KAAK;QACZ,CAAC;OAEF,IAAMC,iBAAiB,GAAG,IAAI,CAACC,oBAAoB,EAAE;OACrD,IAAID,iBAAiB,EACrB;SACCA,iBAAiB,CAACH,gBAAgB,CAAC,OAAO,EAAE,YAAM;WACjDK,GAAG,CAACC,IAAI,CAAC,sBAAsB,CAAC;WAChCL,YAAY,CAACC,OAAO,CAAC,IAAI,CAAC;WAC1B,OAAO,KAAK;UACZ,CAAC;;OAGH,IAAMK,gBAAgB,GAAG,IAAI,CAACC,mBAAmB,EAAE;OACnD,IAAID,gBAAgB,EACpB;SACCA,gBAAgB,CAACP,gBAAgB,CAAC,OAAO,EAAE,YAAM;WAChDC,YAAY,CAACQ,YAAY,CAAC,SAAS,EAAE,KAAK,CAAC;UAC3C,CAAC;;OAGH,IAAMC,iBAAiB,GAAG,IAAI,CAACC,oBAAoB,EAAE;OACrD,IAAID,iBAAiB,EACrB;SACCA,iBAAiB,CAACV,gBAAgB,CAAC,OAAO,EAAE,YAAM;WACjDC,YAAY,CAACQ,YAAY,CAAC,UAAU,EAAE,KAAK,CAAC;UAC5C,CAAC;;;;KAEH;KAAA,kCAGD;OACC,OAAOG,QAAQ,CAACC,cAAc,CAAC,IAAI,CAAC1B,UAAU,CAACC,QAAQ,CAAC;;;KACxD;KAAA,yCAED;OACC,OAAOwB,QAAQ,CAACC,cAAc,CAAC,IAAI,CAAC1B,UAAU,CAACE,eAAe,CAAC;;;KAC/D;KAAA,8CAED;OACC,OAAOuB,QAAQ,CAACC,cAAc,CAAC,IAAI,CAAC1B,UAAU,CAACG,oBAAoB,CAAC;;;KACpE;KAAA,uCAED;OACC,OAAOsB,QAAQ,CAACC,cAAc,CAAC,IAAI,CAAC1B,UAAU,CAACI,aAAa,CAAC;;;KAC7D;KAAA,sCAED;OACC,OAAOqB,QAAQ,CAACC,cAAc,CAAC,IAAI,CAAC1B,UAAU,CAACK,YAAY,CAAC;;;KAC5D;KAAA,uCAED;OACC,OAAOoB,QAAQ,CAACC,cAAc,CAAC,IAAI,CAAC1B,UAAU,CAACM,aAAa,CAAC;;;KAC7D;KAAA,4CAGD;OACC,IAAMqB,kBAAkB,GAAG,IAAI,CAACV,oBAAoB,EAAE;OACtD,IAAIU,kBAAkB,EACtB;SACCA,kBAAkB,CAACC,SAAS,CAACC,GAAG,CAAC,IAAI,CAAC/B,OAAO,CAACC,IAAI,CAAC;;;;KAEpD;KAAA,4CAGD;OACC,IAAMiB,iBAAiB,GAAG,IAAI,CAACC,oBAAoB,EAAE;OACrD,IAAID,iBAAiB,EACrB;SACCA,iBAAiB,CAACY,SAAS,CAACE,MAAM,CAAC,IAAI,CAAChC,OAAO,CAACC,IAAI,CAAC;;;;KAEtD;KAAA,6BAEYgC,MAAM,EACnB;OACC,IAAIC,GAAG,GAAGC,QAAQ,CAACF,MAAM,CAACG,YAAY,CAAC;OAEvC,IACCC,QAAQ,GAAGH,GAAG,GAAG,GAAG;SACpBI,QAAQ,GAAGJ,GAAG,GAAG,EAAE;OAEpB,IAAIK,MAAM,GAAG,EAAE;OAEf,IACCF,QAAQ,IAAI,EAAE,IACXA,QAAQ,GAAG,EAAE,EAEjB;SACCE,MAAM,GAAG,CAAC;QACV,MACI,IAAID,QAAQ,IAAI,CAAC,EACtB;SACCC,MAAM,GAAG,CAAC;QACV,MACI,IAAID,QAAQ,IAAI,CAAC,EACtB;SACCC,MAAM,GAAG,CAAC;QACV,MACI,IACJD,QAAQ,IAAI,CAAC,IACVA,QAAQ,IAAI,CAAC,IACbA,QAAQ,IAAI,CAAC,EAEjB;SACCC,MAAM,GAAG,CAAC;QACV,MAED;SACCA,MAAM,GAAG,CAAC;;OAGX,IAAIC,QAAQ,CAACC,gBAAgB,EAAE,EAC/B;SACC,IAAI,CAACC,sBAAsB,EAAE,CAACC,SAAS,GAAIT,GAAG,GAAGA,GAAG,GAAG,GAAG,GAAG,EAAG;SAChE,IAAI,CAACU,yBAAyB,EAAE;QAChC,MAED;SACC,IAAI,CAACF,sBAAsB,EAAE,CAACC,SAAS,GAAGT,GAAG,IAAI,EAAE;;OAGpD,IAAI,CAACW,2BAA2B,EAAE,CAACF,SAAS,GAAGG,aAAG,CAACC,UAAU,CAAC,oCAAoC,GAAGR,MAAM,CAAC;OAC5G,IAAI,CAAC1B,eAAe,EAAE,CAACiB,SAAS,CAACC,GAAG,CAAC,IAAI,CAAC/B,OAAO,CAACC,IAAI,CAAC;;;KACvD;KAAA,+BAGD;OACC,IAAMW,YAAY,GAAG,IAAI,CAACC,eAAe,EAAE;OAC3C,IAAID,YAAY,EAChB;SACCA,YAAY,CAACkB,SAAS,CAACE,MAAM,CAAC,IAAI,CAAChC,OAAO,CAACC,IAAI,CAAC;;;;GAEjD;CAAA;;CCnL4C,IAExC+C,cAAc;GAEnB,0BACA;KAAA;KAAA;KACC,IAAI,CAACjD,WAAW,GAAG,KAAK;KAExB,IAAI,CAACU,IAAI,EAAE;KACXC,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,YAAM;OACpD,KAAI,CAACF,IAAI,EAAE;MACX,CAAC;;GACF;KAAA;KAAA,uBAGD;OACC,IAAMwC,UAAU,GAAG,IAAI,CAACC,aAAa,EAAE;OAEvC,IACC,CAACD,UAAU,IACR,IAAI,CAAClD,WAAW,EAEpB;SACC;;OAGD,IAAI,CAACA,WAAW,GAAG,IAAI;OACvB,IAAI,CAACe,UAAU,EAAE;;;KACjB;KAAA,6BAGD;OACC,IAAMmC,UAAU,GAAG,IAAI,CAACC,aAAa,EAAE;OAEvCD,UAAU,CAAClC,gBAAgB,CAAC,OAAO,EAAE,UAACoC,CAAC,EAAK;SAC3CnC,YAAY,CAACC,OAAO,CAAC,IAAI,CAAC;SAC1B,OAAO,KAAK;QACZ,CAAC;;;KACF;KAAA,gCAGD;OACC,OAAOU,QAAQ,CAACC,cAAc,CAAC,iCAAiC,CAAC;;;KACjE;KAAA,8BAGD;OACC,IAAMwB,MAAM,GAAG,IAAI,CAACF,aAAa,EAAE;OACnC,IAAIE,MAAM,EACV;SACCA,MAAM,CAACtB,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;;;;KAElC;KAAA,6BAGD;OACC,IAAMqB,MAAM,GAAG,IAAI,CAACF,aAAa,EAAE;OACnC,IAAIE,MAAM,EACV;SACCA,MAAM,CAACtB,SAAS,CAACE,MAAM,CAAC,WAAW,CAAC;;;;GAErC;CAAA;;KC9DIqB,eAAe;GAEpB,2BACA;KAAA;KACC,IAAI,CAACC,IAAI,GAAG,EAAE;KACd,IAAI,CAACC,KAAK,GAAG;OACZC,UAAU,EAAE;SACXC,KAAK,EAAE,WAAW;SAClBC,IAAI,EAAE;QACN;OACDC,IAAI,EAAE;SACLF,KAAK,EAAE,SAAS;SAChBC,IAAI,EAAE;;MAEP;;GACD;KAAA;KAAA,0BAGD;OACC,IAAI,CAACJ,IAAI,GAAG,IAAI,CAACA,IAAI,CAACM,MAAM,CAAC,UAAAC,SAAS,EAAI;SACzC,OAAOA,SAAS;QAChB,CAAC;OACF,IAAI,CAACP,IAAI,CAACQ,OAAO,CAAC,UAAAD,SAAS,EAAI;SAC9BA,SAAS,CAACE,IAAI,EAAE;QAChB,CAAC;;;KACF;KAAA,0BAES9B,MAAM,EAChB;OACC,IAAM+B,GAAG,GAAG,IAAIC,WAAW,CAACC,EAAE,CAACb,eAAe,CAAC;SAC7Cc,OAAO,EAAElC,MAAM,CAAC0B,IAAI,GAAG1B,MAAM,CAAC0B,IAAI,GAAG,EAAE;SACvCJ,KAAK,EAAE,IAAI,CAACA,KAAK,CAACC,UAAU,CAACC,KAAK;SAClCW,SAAS,EAAE,IAAI,CAACb,KAAK,CAACI,IAAI,CAACF,KAAK;SAChCY,SAAS,EAAGpC,MAAM,CAACoC,SAAS,GAAG,CAAC,CAACpC,MAAM,CAACoC,SAAS,GAAG,KAAM;SAC1DC,OAAO,EAAGrC,MAAM,CAACqC,OAAO,GAAGrC,MAAM,CAACqC,OAAO,GAAG,EAAG;SAC/CC,KAAK,EAAGtC,MAAM,CAACuC,SAAS,GAAGvC,MAAM,CAACuC,SAAS,GAAG,QAAS;SACvDC,eAAe,EAAGxC,MAAM,CAACwC,eAAe,GAAGxC,MAAM,CAACwC,eAAe,GAAG,KAAM;SAC1EC,SAAS,EAAGzC,MAAM,CAACyC,SAAS,GAAG,CAAC,CAACzC,MAAM,CAACyC,SAAS,GAAG,IAAK;SACzDC,KAAK,EAAE1C,MAAM,CAAC0C,KAAK,GAAG1C,MAAM,CAAC0C,KAAK,GAAG,YAAM;QAC3C,EAAG1C,MAAM,CAAC2C,EAAE,GAAG3C,MAAM,CAAC2C,EAAE,GAAGzC,QAAQ,CAAC0C,IAAI,CAACC,MAAM,EAAE,GAAG,MAAM,CAAC,CAAE;OAE/D,IAAI,CAACxB,IAAI,CAACyB,IAAI,CAACf,GAAG,CAAC;OACnBA,GAAG,CAAC/D,IAAI,EAAE;;;KACV;KAAA,yBAEQgC,MAAM,EACf;OACC,IAAM+B,GAAG,GAAG,IAAIC,WAAW,CAACC,EAAE,CAACb,eAAe,CAAC;SAC7Cc,OAAO,EAAElC,MAAM,CAAC0B,IAAI,GAAG1B,MAAM,CAAC0B,IAAI,GAAG,EAAE;SACvCJ,KAAK,EAAE,IAAI,CAACA,KAAK,CAACC,UAAU,CAACE,IAAI;SACjCU,SAAS,EAAE,IAAI,CAACb,KAAK,CAACI,IAAI,CAACD,IAAI;SAC/BW,SAAS,EAAGpC,MAAM,CAACoC,SAAS,GAAG,CAAC,CAACpC,MAAM,CAACoC,SAAS,GAAG,KAAM;SAC1DC,OAAO,EAAGrC,MAAM,CAACqC,OAAO,GAAGrC,MAAM,CAACqC,OAAO,GAAG,EAAG;SAC/CU,QAAQ,EAAG/C,MAAM,CAAC+C,QAAQ,GAAG/C,MAAM,CAAC+C,QAAQ,GAAG,KAAM;SACrDT,KAAK,EAAGtC,MAAM,CAACuC,SAAS,GAAGvC,MAAM,CAACuC,SAAS,GAAG,QAAS;SACvDS,QAAQ,EAAGhD,MAAM,CAACgD,QAAQ,GAAG,CAAC,CAAChD,MAAM,CAACgD,QAAQ,GAAG,IAAK;SACtDC,cAAc,EAAGjD,MAAM,CAACiD,cAAc,GAAG,CAAC,CAACjD,MAAM,CAACiD,cAAc,GAAG,IAAK;SACxET,eAAe,EAAGxC,MAAM,CAACwC,eAAe,GAAGxC,MAAM,CAACwC,eAAe,GAAG,IAAK;SACzEC,SAAS,EAAGzC,MAAM,CAACyC,SAAS,GAAG,CAAC,CAACzC,MAAM,CAACyC,SAAS,GAAG;QACpD,EAAGzC,MAAM,CAAC2C,EAAE,GAAG3C,MAAM,CAAC2C,EAAE,GAAGzC,QAAQ,CAAC0C,IAAI,CAACC,MAAM,EAAE,GAAG,MAAM,CAAC,CAAE;OAE/D,IAAI,CAACxB,IAAI,CAACyB,IAAI,CAACf,GAAG,CAAC;OACnBA,GAAG,CAAC/D,IAAI,EAAE;;;GACV;CAAA;;CC/D6B,IAEzBkF,QAAQ;GAEb,kBAAYlD,MAAM,EAClB;KAAA;KACC,IAAI,CAACmD,SAAS,GAAG,IAAI;KACrB,IAAI,CAACC,OAAO,GAAG,IAAI;KAEnB,IAAI,CAACC,YAAY,CAACC,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,IAAIsD,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACmD,SAAS,CAAC,GAAGnD,MAAM,CAACmD,SAAS,GAAG,UAAU,CAAC;KACtH,IAAI,CAACM,UAAU,CAACH,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,IAAIsD,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACoD,OAAO,CAAC,GAAGpD,MAAM,CAACoD,OAAO,GAAG,YAAY,CAAC;KAElH,IAAI,CAAC5E,IAAI,EAAE;;GACX;KAAA;KAAA,uBAGD;OACCwD,WAAW,CAAC0B,cAAc,CAAC,0BAA0B,EAAE,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;;;KAC/E;KAAA,6BAEYC,KAAK,EAClB;OACC,IAAI,CAACV,SAAS,GAAGU,KAAK;;;KACtB;KAAA,+BAED;OACC,OAAO,IAAI,CAACV,SAAS;;;KACrB;KAAA,2BAEUU,KAAK,EAChB;OACC,IAAI,CAACT,OAAO,GAAGS,KAAK;;;KACpB;KAAA,6BAED;OACC,OAAO,IAAI,CAACT,OAAO;;;KACnB;KAAA,wBAEOpD,MAAM,EACd;OACC,IAAI,UAAO,CAACA,MAAM,CAACqC,OAAO,CAAC;;;KAC3B;KAAA,wBAEMA,OAAO,EACd;OACC,IAAInC,QAAQ,CAACmC,OAAO,CAAC,IAAI,CAAC,EAC1B;SACCA,OAAO,GAAG,KAAK;;OAGhBlD,GAAG,CAACC,IAAI,CAAC,iBAAiB,EAAE;SAC3B0E,SAAS,EAAE,IAAI,CAACC,YAAY,EAAE;SAC9BC,GAAG,EAAE,IAAI,CAACC,UAAU,EAAE,IAAI5B,OAAO,GAAG,GAAG,GAAGA,OAAO,GAAG,EAAE,CAAC;SACvDwB,KAAK,EAAE,EAAE;SACTK,QAAQ,EAAE,kBAACC,GAAG,EAAK;QAEnB,CAAC;;;KACF;KAAA,qBAEIC,IAAI,EAAE/B,OAAO,EAClB;OACC,IAAInC,QAAQ,CAACmC,OAAO,CAAC,IAAI,CAAC,EAC1B;SACCA,OAAO,GAAG,KAAK;;OAGhB,KAAK,IAAIgC,CAAC,IAAID,IAAI,EAClB;SACC,IAAI,CAACA,IAAI,CAACE,cAAc,CAACD,CAAC,CAAC,EAC3B;WACC;;SAGD,IAAIA,CAAC,KAAK,QAAQ,EAClB;WACC,OAAOD,IAAI,CAACC,CAAC,CAAC;WACd;;;OAIFlF,GAAG,CAACC,IAAI,CAAC,iBAAiB,EAAE;SAC3B0E,SAAS,EAAE,IAAI,CAACC,YAAY,EAAE;SAC9BC,GAAG,EAAE,IAAI,CAACC,UAAU,EAAE,IAAI5B,OAAO,GAAG,GAAG,GAAGA,OAAO,GAAG,EAAE,CAAC;SACvDwB,KAAK,EAAEO,IAAI;SACXF,QAAQ,EAAE,kBAACC,GAAG,EAAK;QAEnB,CAAC;;;KACF;KAAA,qBAEID,SAAQ,EAAE7B,OAAO,EACtB;OACC,IAAInC,QAAQ,CAACmC,OAAO,CAAC,IAAI,CAAC,EAC1B;SACCA,OAAO,GAAG,KAAK;;OAGhBlD,GAAG,CAACC,IAAI,CAAC,iBAAiB,EAAE;SAC3B0E,SAAS,EAAE,IAAI,CAACC,YAAY,EAAE;SAC9BC,GAAG,EAAE,IAAI,CAACC,UAAU,EAAE,IAAI5B,OAAO,GAAG,GAAG,GAAGA,OAAO,GAAG,EAAE,CAAC;SACvD6B,QAAQ,EAAE,kBAACL,KAAK,EAChB;WACCA,KAAK,GAAIP,cAAI,CAACC,aAAa,CAACM,KAAK,CAAC,GAAGA,KAAK,GAAIP,cAAI,CAACE,cAAc,CAACK,KAAK,CAAC,GAAGU,IAAI,CAACC,KAAK,CAACX,KAAK,CAAC,GAAG,EAAI;WACnG,IACCP,cAAI,CAACC,aAAa,CAACM,KAAK,CAAC,IACtBY,MAAM,CAACC,IAAI,CAACb,KAAK,CAAC,CAACc,MAAM,GAAG,CAAC,EAEjC;aACCT,SAAQ,CAACU,MAAM,CAACf,KAAK,CAAC;YACtB,MAED;aACCK,SAAQ,CAACW,OAAO,EAAE;;;QAGpB,CAAC;;;GAEF;CAAA;;;ACpHF,CAE8C,IAExCC,gBAAgB;GAAA;GAErB,4BACA;KAAA;KAAA;KACC;KAEA,MAAKzD,IAAI,GAAG,EAAE;KAEd,MAAK0D,MAAM,GAAG;OACbC,SAAS,EAAE;MACX;KAED,cAAU,GAAG;OACZC,aAAa,EAAE,qBAAqB;OACpCC,YAAY,EAAE,wBAAwB;OACtCC,gBAAgB,EAAE,mBAAmB;OACrCC,WAAW,EAAE,mBAAmB;OAChCC,WAAW,EAAE;MACb;KAED,MAAKC,OAAO,GAAG;OACdtH,IAAI,EAAE;MACN;KAED,MAAKQ,IAAI,EAAE;KAAC;;GACZ;KAAA;KAAA,uBAGD;OACCwD,WAAW,CAAC0B,cAAc,CAAC,yCAAyC,EAAE,IAAI,CAAC6B,YAAY,CAAC3B,IAAI,CAAC,IAAI,CAAC,CAAC;OACnG5B,WAAW,CAAC0B,cAAc,CAAC,yCAAyC,EAAE,IAAI,CAAC8B,YAAY,CAAC5B,IAAI,CAAC,IAAI,CAAC,CAAC;OACnG5B,WAAW,CAAC0B,cAAc,CAAC,8CAA8C,EAAE,IAAI,CAAC+B,iBAAiB,CAAC7B,IAAI,CAAC,IAAI,CAAC,CAAC;OAC7G5B,WAAW,CAAC0B,cAAc,CAAC,4CAA4C,EAAE,IAAI,CAACgC,eAAe,CAAC9B,IAAI,CAAC,IAAI,CAAC,CAAC;OACzG5B,WAAW,CAAC0B,cAAc,CAAC,iDAAiD,EAAE,IAAI,CAACiC,oBAAoB,CAAC/B,IAAI,CAAC,IAAI,CAAC,CAAC;OAEnH,IAAI,CAACgC,iBAAiB,CAAC,oBAAoB,CAAC;OAC5C,IAAI,CAAClH,SAAS,CAAC,aAAa,EAAE,IAAI,CAACmH,YAAY,CAACjC,IAAI,CAAC,IAAI,CAAC,CAAC;OAC3D,IAAI,CAAClF,SAAS,CAAC,gBAAgB,EAAE,IAAI,CAACoH,cAAc,CAAClC,IAAI,CAAC,IAAI,CAAC,CAAC;OAEhEmC,eAAK,CAACnC,IAAI,CAAClE,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAACsG,QAAQ,CAACpC,IAAI,CAAC,IAAI,CAAC,CAAC;;;KACxD;KAAA,2BAGD;OACC,IACCqC,aAAa,GAAGvG,QAAQ,CAACC,cAAc,CAAC,IAAI,CAACoF,MAAM,CAACC,SAAS,CAAC;OAE/D,IAAI,CAAC1B,cAAI,CAAC4C,SAAS,CAACD,aAAa,CAAC,EAClC;SACC;;OAGD,IAAIE,MAAM,CAACC,WAAW,GAAG,CAAC,EAC1B;SACCH,aAAa,CAACpG,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACoF,YAAY,CAAC;QACpD,MAED;SACCe,aAAa,CAACpG,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACmF,YAAY,CAAC;;;;KAExD;KAAA,+BAGD;OAAA;OACC/F,GAAG,CAACC,IAAI,CAAC,iBAAiB,EAAE;SAC3B0E,SAAS,EAAE,UAAU;SACrBE,GAAG,EAAE,kBAAkB;SACvBE,QAAQ,EAAE,kBAACmC,KAAK,EAChB;WACCA,KAAK,GAAI/C,cAAI,CAACC,aAAa,CAAC8C,KAAK,CAAC,GAAGA,KAAK,GAAI/C,cAAI,CAACE,cAAc,CAAC6C,KAAK,CAAC,GAAG9B,IAAI,CAACC,KAAK,CAAC6B,KAAK,CAAC,GAAG,EAAI;WAEnG,IAAI,CAAC/C,cAAI,CAACC,aAAa,CAAC8C,KAAK,CAAC,EAC9B;aACC;;WAGD,KAAK,IAAIrC,GAAG,IAAIqC,KAAK,EACrB;aACC,IAAI,CAACA,KAAK,CAAC/B,cAAc,CAACN,GAAG,CAAC,EAC9B;eACC;;aAGD,MAAI,CAACsC,SAAS,CAACtC,GAAG,EAAE,EAAE,CAAC;;WAGxB,MAAI,CAACuC,QAAQ,EAAE;;QAEhB,CAAC;;;KACF;KAAA,+BAEcC,KAAK,EACpB;OACC,IAAI,CAACC,cAAc,CAACD,KAAK,CAACpC,IAAI,CAACJ,GAAG,CAAC;;;KACnC;KAAA,0BAESA,GAAG,EAAEhE,MAAM,EACrB;OACC,IAAI,CAACqB,IAAI,CAAC2C,GAAG,CAAC,GAAGhE,MAAM;OACvB,IAAI,CAACqB,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,GAAG,IAAI,CAACC,QAAQ,EAAE;OACrC,IAAI,CAACtF,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,CAAC7G,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACsF,WAAW,CAAC;;;KACzD;KAAA,+BACcpB,GAAG,EAAEhE,MAAM,EAC1B;OAAA;OACC,IAAI,CAAC4G,QAAQ,CAAC5C,GAAG,CAAC;OAElB6C,UAAU,CAAC,YAAM;SAChB,IAAI,MAAI,CAACxF,IAAI,CAAC2C,GAAG,CAAC,EAClB;WACC,OAAO,MAAI,CAAC3C,IAAI,CAAC2C,GAAG,CAAC;;QAEtB,EAAE,IAAI,CAAC;;;KACR;KAAA,2BAEUA,GAAG,EAAE8C,WAAW,EAC3B;OAAA;OACC,IACC,IAAI,CAACzF,IAAI,CAAC2C,GAAG,CAAC,IACX,IAAI,CAAC3C,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,EAEvB;SACC,IAAI,CAACrF,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,CAAC7G,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACkF,aAAa,CAAC;SAC9D,IAAI,CAAC5D,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,CAAC7G,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACqF,WAAW,CAAC;SAC5D,IAAI,CAAC/D,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,CAAC7G,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACqF,gBAAgB,CAAC;SAC9D,IAAI,CAAC9D,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,CAACK,gBAAgB,CAACrG,SAAS,GAAI4C,cAAI,CAACE,cAAc,CAACsD,WAAW,CAAC,GAAGA,WAAW,GAAGjG,aAAG,CAACC,UAAU,CAAC,qDAAqD,CAAE;;OAG1K+F,UAAU,CAAC,YAAM;SAChB,MAAI,CAACJ,cAAc,CAACzC,GAAG,CAAC;QACxB,EAAE,IAAI,CAAC;;;KACR;KAAA,2BAGD;OACC,IACCgD,KAAK,GAAGnG,aAAG,CAACC,UAAU,CAAC,kDAAkD,CAAC;OAE3E,OAAOmG,aAAG,CAACC,MAAM,oQAC4HF,KAAK;;;KAElJ;KAAA,yBAEQhD,GAAG,EAAEhE,MAAM,EACpB;OACC,IAAI,IAAI,CAACqB,IAAI,CAAC2C,GAAG,CAAC,EAClB;SACC,IAAI,CAAC3C,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,CAAC7G,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACuF,WAAW,CAAC;;;;KAE1D;KAAA,2BAGD;OACC,IACCY,aAAa,GAAGvG,QAAQ,CAACC,cAAc,CAAC,IAAI,CAACoF,MAAM,CAACC,SAAS,CAAC;OAE/D,IAAI,CAAC1B,cAAI,CAAC4C,SAAS,CAACD,aAAa,CAAC,EAClC;SACC;;OAGDkB,aAAG,CAACC,KAAK,CAACnB,aAAa,CAAC;OAExB,KAAK,IAAIjC,GAAG,IAAI,IAAI,CAAC3C,IAAI,EACzB;SACC,IACC,CAAC,IAAI,CAACA,IAAI,CAACiD,cAAc,CAACN,GAAG,CAAC,IAC3B,CAACV,cAAI,CAAC4C,SAAS,CAAC,IAAI,CAAC7E,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,CAAC,EAExC;WACC;;SAGDS,aAAG,CAACE,MAAM,CAAC,IAAI,CAAChG,IAAI,CAAC2C,GAAG,CAAC,CAAC0C,IAAI,EAAET,aAAa,CAAC;;;;KAE/C;KAAA,6BAEYjG,MAAM,EACnB;OAAA;OACC,IACCgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAG,EAAE;SAClCsD,MAAM,GAAGtH,MAAM,CAACsH,MAAM,GAAGtH,MAAM,CAACsH,MAAM,GAAG,EAAE;SAC3CC,WAAW,GAAGvH,MAAM,CAACuH,WAAW,GAAGvH,MAAM,CAACuH,WAAW,GAAG,EAAE;OAE3D,IACCD,MAAM,IAAI/G,QAAQ,CAACiH,SAAS,EAAE,IAC3B,CAACxD,GAAG,IACJ,CAACV,cAAI,CAACE,cAAc,CAAC+D,WAAW,CAAC,EAErC;SACC;;OAGD,IAAIA,WAAW,IAAI,MAAM,EACzB;SACC,IAAI,CAACjB,SAAS,CAACtC,GAAG,EAAE;WACnBA,GAAG,EAAEA;UACL,CAAC;SAEF6C,UAAU,CAAC,YAAM;WAChB,MAAI,CAACN,QAAQ,EAAE;UACf,EAAE,IAAI,CAACjB,OAAO,CAACtH,IAAI,CAAC;;;;KAEtB;KAAA,6BAEYgC,MAAM,EACnB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAI,CAACyH,UAAU,CAAEzH,MAAM,CAACgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAG,EAAE,EAAGhE,MAAM,CAAC8G,WAAW,CAAC;OACnE,IAAI,CAACP,QAAQ,EAAE;;;KACf;KAAA,gCAEevG,MAAM,EACtB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAI,CAACyH,UAAU,CAACzH,MAAM,CAACgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAG,EAAE,CAAC;OAC7C,IAAI,CAACuC,QAAQ,EAAE;;;KACf;KAAA,kCAEiBvG,MAAM,EACxB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IACCgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAG,EAAE;OAEnC,IAAI,CAACyC,cAAc,CAACzC,GAAG,EAAE;SACxBA,GAAG,EAAEA;QACL,CAAC;OACF,IAAI,CAACuC,QAAQ,EAAE;;;KACf;KAAA,qCAEoBvG,MAAM,EAC3B;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IACCgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAGhE,MAAM,CAACgE,GAAG,GAAG,EAAE;OAEnC,IAAI,CAACyC,cAAc,CAACzC,GAAG,EAAE;SACxBA,GAAG,EAAEA;QACL,CAAC;OACF,IAAI,CAACuC,QAAQ,EAAE;;;GACf;CAAA,EAhQ6B9H,6BAAY;;KCArCiJ,OAAI;GAAA;KAAA;KAAA,6BAGT;OACCvB,MAAM,CAACwB,QAAQ,CAAC,CAAC,EAAEjI,QAAQ,CAACkI,IAAI,CAACC,YAAY,CAAC;;;KAC9C;KAAA,0BAGD;OACC1B,MAAM,CAACwB,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;;;GAGtB,iBAAYvD,IAAI,EAChB;KAAA;KACC,IAAI,CAAC0D,KAAK,GAAG,CAAC;KACd,IAAI,CAACC,SAAS,GAAG,EAAE;KACnB,IAAI,CAACC,SAAS,GAAG,KAAK;KACtB,IAAI,CAACC,QAAQ,GAAG,KAAK;KACrB,IAAI,CAACC,IAAI,GAAG,EAAE;KACd,IAAI,CAACC,YAAY,GAAG,EAAE;KACtB,IAAI,CAACC,MAAM,GAAG,CAAC;KACf,IAAI,CAACC,GAAG,GAAG,EAAE;KACb,IAAI,CAACC,WAAW,GAAG,EAAE;KACrB,IAAI,CAACC,QAAQ,GAAG,KAAK;KACrB,IAAI,CAACC,aAAa,GAAG,EAAE;KACvB,IAAI,CAACC,SAAS,GAAG,CAAC;KAClB,IAAI,CAACC,QAAQ,GAAG,KAAK;KAErB,IAAI,CAACC,MAAM,GAAG,CAAC;KACf,IAAI,CAACC,QAAQ,GAAG,IAAI;KAEpB,IAAI,CAACC,eAAe,GAAG,CAAC;KAExB,IAAI,CAACrK,IAAI,CAAC4F,IAAI,CAAC;;GACf;KAAA;KAAA,qBAEIA,IAAI,EACT;OACC,IACC0D,KAAK,GAkBF1D,IAAI,CAlBP0D,KAAK;SACLC,SAAS,GAiBN3D,IAAI,CAjBP2D,SAAS;SACTC,SAAS,GAgBN5D,IAAI,CAhBP4D,SAAS;SACTC,QAAQ,GAeL7D,IAAI,CAfP6D,QAAQ;SACRC,IAAI,GAcD9D,IAAI,CAdP8D,IAAI;SACJC,YAAY,GAaT/D,IAAI,CAbP+D,YAAY;SACZC,MAAM,GAYHhE,IAAI,CAZPgE,MAAM;SACNC,GAAG,GAWAjE,IAAI,CAXPiE,GAAG;SACHC,WAAW,GAURlE,IAAI,CAVPkE,WAAW;SACXC,QAAQ,GASLnE,IAAI,CATPmE,QAAQ;SACRC,aAAa,GAQVpE,IAAI,CARPoE,aAAa;SACbC,SAAS,GAONrE,IAAI,CAPPqE,SAAS;SACTC,QAAQ,GAMLtE,IAAI,CANPsE,QAAQ;SAERC,MAAM,GAIHvE,IAAI,CAJPuE,MAAM;SACNC,QAAQ,GAGLxE,IAAI,CAHPwE,QAAQ;SAERC,eAAe,GACZzE,IAAI,CADPyE,eAAe;OAGhBf,KAAK,GAAG5H,QAAQ,CAAC4H,KAAK,CAAC;OAEvB,IAAIA,KAAK,IAAI,CAAC,EACd;SACC;;OAGD,IAAI,CAACA,KAAK,GAAGA,KAAK;OAElB,IAAI,CAACM,MAAM,GAAGlI,QAAQ,CAACkI,MAAM,CAAC;OAC9B,IAAI,CAACK,SAAS,GAAGvI,QAAQ,CAACuI,SAAS,CAAC;OACpC,IAAI,CAACE,MAAM,GAAGzI,QAAQ,CAACyI,MAAM,CAAC;OAC9B,IAAI,CAACE,eAAe,GAAG3I,QAAQ,CAAC2I,eAAe,CAAC;OAEhD,IAAI,CAACb,SAAS,GAAG,CAAC,CAACA,SAAS;OAC5B,IAAI,CAACC,QAAQ,GAAG,CAAC,CAACA,QAAQ;OAC1B,IAAI,CAACM,QAAQ,GAAG,CAAC,CAACA,QAAQ;OAC1B,IAAI,CAACG,QAAQ,GAAG,CAAC,CAACA,QAAQ;OAE1B,IAAIpF,cAAI,CAACE,cAAc,CAACuE,SAAS,CAAC,EAClC;SACC,IAAI,CAACA,SAAS,GAAGA,SAAS;;OAE3B,IAAIzE,cAAI,CAACE,cAAc,CAAC0E,IAAI,CAAC,EAC7B;SACC,IAAI,CAACA,IAAI,GAAGA,IAAI;;OAEjB,IAAI5E,cAAI,CAACE,cAAc,CAAC6E,GAAG,CAAC,EAC5B;SACC,IAAI,CAACA,GAAG,GAAGA,GAAG;;OAEf,IAAI/E,cAAI,CAACE,cAAc,CAAC8E,WAAW,CAAC,EACpC;SACC,IAAI,CAACA,WAAW,GAAGA,WAAW;;OAE/B,IAAIhF,cAAI,CAACE,cAAc,CAACgF,aAAa,CAAC,EACtC;SACC,IAAI,CAACA,aAAa,GAAGA,aAAa;;OAEnC,IAAIlF,cAAI,CAACE,cAAc,CAACoF,QAAQ,CAAC,EACjC;SACC,IACA;WACC,IAAI,CAACA,QAAQ,GAAGrE,IAAI,CAACC,KAAK,CAACoE,QAAQ,CAAC;UACpC,CACD,OAAM1H,CAAC,EACP;WACC,IAAI,CAAC0H,QAAQ,GAAG,IAAI;;;OAItB,IAAItF,cAAI,CAACC,aAAa,CAAC4E,YAAY,CAAC,EACpC;SACC,IAAI,CAACA,YAAY,GAAGA,YAAY;;;;KAEjC;KAAA,6BAEY/D,IAAI,EACjB;OAAA;OACC,IAAI,IAAI,CAAC0D,KAAK,IAAI,CAAC,EACnB;SACC;;OAGD,IAAKpB,IAAI,GAAWtC,IAAI,CAAnBsC,IAAI;SAAEF,KAAK,GAAIpC,IAAI,CAAboC,KAAK;;;OAGhB,IAAI,CAAClD,cAAI,CAAC4C,SAAS,CAACQ,IAAI,CAAC,EACzB;SACCA,IAAI,GAAGhH,QAAQ,CAACC,cAAc,CAAC,sBAAsB,GAAG,IAAI,CAACmI,KAAK,CAAC;;OAGpE,IAAIxE,cAAI,CAAC4C,SAAS,CAACQ,IAAI,CAAC,EACxB;SACC,IAAMoC,QAAQ,GAAIpC,IAAI,CAACqC,YAAY,CAAC,gBAAgB,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,GAAI;SAC1E,IAAMC,QAAQ,GAAIF,QAAQ,KAAK,GAAG,GAAG,GAAG,GAAG,GAAI;;;SAG/C,IAAIpC,IAAI,CAAC7G,SAAS,CAACoJ,QAAQ,CAAC,gBAAgB,CAAC,EAC7C;WACC,IAAIH,QAAQ,KAAK,GAAG,EACpB;aACCpC,IAAI,CAAC7G,SAAS,CAACE,MAAM,CAAC,uBAAuB,CAAC;YAC9C,MAED;aACC2G,IAAI,CAAC7G,SAAS,CAACC,GAAG,CAAC,uBAAuB,CAAC;;;SAI7C4G,IAAI,CAACwC,YAAY,CAAC,gBAAgB,EAAEF,QAAQ,CAAC;SAE7CG,gBAAI,CAACC,SAAS,CAAC,4CAA4C,EAAE;WAC5DhF,IAAI,EAAE;aACL0D,KAAK,EAAE,IAAI,CAACA,KAAK;aACjBjE,KAAK,EAAEmF;YACP;WACDK,cAAc,EAAE;aACfC,aAAa,EAAGN,QAAQ,KAAK,GAAG,GAAG,cAAc,GAAG,iBAAkB;aACtEO,cAAc,EAAE;;UAEjB,CAAC,CAACC,IAAI,CAAC,UAACC,QAAQ,EAAK;WACrB,IAAIA,QAAQ,CAACrF,IAAI,CAACsF,OAAO,EACzB;aACC,IAAIV,QAAQ,KAAK,GAAG,EACpB;eACCW,qBAAqB,CAACC,SAAS,CAAC;iBAC/B9B,KAAK,EAAE,KAAI,CAACA,KAAK;iBACjB+B,OAAO,EAAE,IAAI;iBACbC,SAAS,EAAE,IAAI;iBACfC,KAAK,EAAE;gBACP,CAAC;;aAGH/H,WAAW,CAACgI,aAAa,CAAC,qBAAqB,EAAE;eAChDC,MAAM,EAAE,KAAI,CAACnC,KAAK;eAClBoC,OAAO,EAAErJ,aAAG,CAACC,UAAU,CAAC,WAAW;cACnC,EAAE,IAAI,CAAC;YACR,MAED;aACC4F,IAAI,CAACwC,YAAY,CAAC,gBAAgB,EAAEJ,QAAQ,CAAC;;UAE9C,EAAE,YAAM;WACRpC,IAAI,CAACwC,YAAY,CAAC,gBAAgB,EAAEJ,QAAQ,CAAC;UAC7C,CAAC;;OAGH,IAAItC,KAAK,YAAYT,KAAK,EAC1B;SACCS,KAAK,CAAC2D,cAAc,EAAE;SACtB3D,KAAK,CAAC4D,eAAe,EAAE;;;;KAExB;KAAA,0BAEShG,IAAI,EACd;OAAA;OACC,IAAI,IAAI,CAAC0D,KAAK,IAAI,CAAC,EACnB;SACC;;OAGD,IACCuC,QAAQ,GAELjG,IAAI,CAFPiG,QAAQ;SACRC,OAAO,GACJlG,IAAI,CADPkG,OAAO;OAGR,IAAIhH,cAAI,CAAC4C,SAAS,CAACmE,QAAQ,CAAC,EAC5B;SACC,IAAMvB,QAAQ,GAAIuB,QAAQ,CAACtB,YAAY,CAAC,aAAa,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,GAAI;SAC3E,IAAMC,QAAQ,GAAIF,QAAQ,KAAK,GAAG,GAAG,GAAG,GAAG,GAAI;SAE/CuB,QAAQ,CAACnB,YAAY,CAAC,aAAa,EAAEF,QAAQ,CAAC;SAE9ChH,WAAW,CAACgI,aAAa,CAAC,sBAAsB,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC;SAEjE,IAAMO,MAAM,GACXvB,QAAQ,KAAK,GAAG,GACb,yCAAyC,GACzC,2CACH;SAEDG,gBAAI,CAACC,SAAS,CAACmB,MAAM,EAAE;WACtBnG,IAAI,EAAE;aACLpE,MAAM,EAAE;eACP8H,KAAK,EAAE,IAAI,CAACA;;YAEb;WACDuB,cAAc,EAAE;aACfC,aAAa,EAAGN,QAAQ,KAAK,GAAG,GAAG,kBAAkB,GAAG,oBAAqB;aAC7EO,cAAc,EAAE;;UAEjB,CAAC,CAACC,IAAI,CAAC,UAACC,QAAQ,EAAK;WACrBzH,WAAW,CAACgI,aAAa,CAAC,sBAAsB,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC;WACjE,IAAIP,QAAQ,CAACrF,IAAI,CAACsF,OAAO,EACzB;aACC1H,WAAW,CAACgI,aAAa,CAAC,8BAA8B,EAAE;eACzDlC,KAAK,EAAE,MAAI,CAACA,KAAK;eACjBjE,KAAK,EAAEmF,QAAQ;eACfwB,QAAQ,EAAEH,QAAQ,CAACI,OAAO,CAAC,aAAa,CAAC;eACzCC,gBAAgB,EAAEJ;cAClB,EAAE,IAAI,EAAE,IAAI,CAAC;aACdtI,WAAW,CAACgI,aAAa,CAAC,iCAAiC,EAAE;eAC5DlC,KAAK,EAAE,MAAI,CAACA,KAAK;eACjBjE,KAAK,EAAEmF;cACP,EAAE,IAAI,EAAE,IAAI,CAAC;YACd,MAED;aACCqB,QAAQ,CAACnB,YAAY,CAAC,aAAa,EAAEJ,QAAQ,CAAC;;UAE/C,EAAE,YAAM;WACR9G,WAAW,CAACgI,aAAa,CAAC,sBAAsB,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC;WACjEK,QAAQ,CAACnB,YAAY,CAAC,aAAa,EAAEJ,QAAQ,CAAC;UAC9C,CAAC;;;;KAEH;KAAA,2BAEU9I,MAAM,EACjB;OACC,IACC2K,eAAe,GAMZ3K,MAAM,CANT2K,eAAe;SACfC,mBAAmB,GAKhB5K,MAAM,CALT4K,mBAAmB;SACnBC,iBAAiB,GAId7K,MAAM,CAJT6K,iBAAiB;SACjBrE,KAAK,GAGFxG,MAAM,CAHTwG,KAAK;SACLsE,aAAa,GAEV9K,MAAM,CAFT8K,aAAa;SACbpC,QAAQ,GACL1I,MAAM,CADT0I,QAAQ;OAGT,IAAI,CAACpF,cAAI,CAACE,cAAc,CAACmH,eAAe,CAAC,EACzC;SACC;;OAGD,IACC,IAAI,CAAChC,MAAM,GAAG,CAAC,IACZoC,kBAAkB,CAACC,aAAa,EAAE,IAAI,EAAE,IACxC,IAAI,CAACpC,QAAQ,EAEjB;SACC5G,WAAW,CAACiJ,MAAM,CAACC,eAAe,CAAC,4BAA4B,EAAE,CAChE;WACCvI,EAAE,EAAE,IAAI,CAACgG,MAAM;WACfA,MAAM,EAAE,IAAI,CAACA,MAAM;WACnB3B,KAAK,EAAE,MAAM;WACbmE,QAAQ,EAAE;aACTnE,KAAK,EAAE,IAAI,CAAC4B,QAAQ,CAAC5B,KAAK;aAC1BoE,WAAW,EAAE,IAAI,CAACxC,QAAQ,CAACwC,WAAW;aACtCC,eAAe,EAAE,IAAI,CAACzC,QAAQ,CAACyC;;UAEhC,EACD;WACC1C,MAAM,EAAE,IAAI,CAACA,MAAM;WACnB2C,WAAW,EAAE;UACb,CACD,CAAC;QACF,MAED;SACC,IAAIC,IAAI,GAAGZ,eAAe;SAE1B,IACC,IAAI,CAAC9B,eAAe,GAAG,CAAC,IACrB,CAACiC,aAAa,IACdF,mBAAmB,CAACjG,MAAM,GAAG,CAAC,EAElC;WACC4G,IAAI,GAAGX,mBAAmB,CAACY,OAAO,CAAC,YAAY,EAAE,IAAI,CAAC3C,eAAe,CAAC;UACtE,MACI,IACJ,IAAI,CAACF,MAAM,GAAG,CAAC,IACZ,IAAI,CAACC,QAAQ,IACbiC,iBAAiB,CAAClG,MAAM,GAAG,CAAC;;WAEhC;aACC4G,IAAI,GAAGV,iBAAiB,CACtBW,OAAO,CAAC,gBAAgB,EAAE,MAAM,CAAC,CACjCA,OAAO,CAAC,WAAW,EAAE3K,aAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC,CAAC,GAAG,WAAW,GAAG,IAAI,CAAC6H,MAAM;;SAG1G8C,oBAAoB,CAAC;WACpBF,IAAI,EAAEA,IAAI;WACVtB,MAAM,EAAE,IAAI,CAACnC,KAAK;WAClB4D,UAAU,EAAE,IAAI,CAAC3D,SAAS;WAC1B4D,UAAU,EAAG,IAAI,CAAC3D,SAAS,GAAG,GAAG,GAAG,GAAI;WACxC4D,SAAS,EAAG,IAAI,CAAC3D,QAAQ,GAAG,GAAG,GAAG,GAAI;WACtC4D,SAAS,EAAE,IAAI,CAAC3D,IAAI;WACpBC,YAAY,EAAE,IAAI,CAACA,YAAY;WAC/B2D,OAAO,EAAE,IAAI,CAAC1D,MAAM;WACpB2D,QAAQ,EAAE,IAAI,CAAC1D,GAAG;WAClB2D,aAAa,EAAE,IAAI,CAAC1D,WAAW;WAC/B2D,cAAc,EAAEnB,aAAa;WAC7BoB,UAAU,EAAE,KAAK;WACjBC,SAAS,EAAG,IAAI,CAACzD,QAAQ,IAAIA,QAAS;WACtC0D,SAAS,EAAG,IAAI,CAAC7D,QAAQ,GAAG,GAAG,GAAG,GAAI;WACtC8D,oBAAoB,EAAE,IAAI,CAAC7D,aAAa;WACxC8D,eAAe,EAAE,IAAI,CAAC7D;UACtB,EAAEjC,KAAK,CAAC;;;;KAEV;KAAA,gCAGD;OACC,IAAM6D,QAAQ,GAAG3K,QAAQ,CAACC,cAAc,CAAC,iBAAiB,GAAG,IAAI,CAACmI,KAAK,CAAC;OACxE,IAAI,CAACuC,QAAQ,EACb;SACC;;OAGD,IAAMG,QAAQ,GAAGH,QAAQ,CAACI,OAAO,CAAC,YAAY,CAAC;OAC/C,IAAI,CAACD,QAAQ,EACb;SACC;;OAGD,IAAM+B,WAAW,GAAGlC,QAAQ,CAACtB,YAAY,CAAC,aAAa,CAAC;OACxD,IAAIwD,WAAW,KAAK,GAAG,EACvB;SACC/B,QAAQ,CAAC3K,SAAS,CAACC,GAAG,CAAC,uBAAuB,CAAC;QAC/C,MAED;SACC0K,QAAQ,CAAC3K,SAAS,CAACE,MAAM,CAAC,uBAAuB,CAAC;;;;KAEnD;KAAA,6BAGD;OACCyM,IAAI,CAACC,UAAU,CAAC,IAAI,CAAC3E,KAAK,CAAC;;;GAC3B;CAAA;;KC/WI4E,WAAQ;GAAA;KAAA;;GAAA;KAAA;KAAA,wBAEC1M,MAAM,EACpB;OACC,IAAMsK,OAAO,GAAIhH,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACsK,OAAO,CAAC,GAAGtK,MAAM,CAACsK,OAAO,GAAG,MAAO;OAC/E,IAAMlC,MAAM,GAAI,CAAC9E,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACoI,MAAM,CAAC,GAAGlI,QAAQ,CAACF,MAAM,CAACoI,MAAM,CAAC,GAAG,CAAE;OAC/E,IAAIA,MAAM,IAAI,CAAC,EACf;SACC,OAAO,KAAK;;OAGbjJ,GAAG,CAACyN,OAAO,CAAC;SACX5F,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC;SACjEY,IAAI,EAAGb,aAAG,CAACC,UAAU,CAAC,gDAAgD,CAAC;SACvE+L,OAAO,EAAG,CACThM,aAAG,CAACC,UAAU,CAAC,8CAA8C,CAAC,EAC9DD,aAAG,CAACC,UAAU,CAAC,kDAAkD,CAAC,CAClE;SACDoD,QAAQ,EAAG,kBAAC4I,MAAM,EAAK;WACtB,IAAI5M,QAAQ,CAAC4M,MAAM,CAAC,KAAK,CAAC,EAC1B;aACC,OAAO,KAAK;;WAEb3N,GAAG,CAAC4N,eAAe,CAAC;aACnBrL,IAAI,EAAE;YACN,CAAC;WAEF,IAAMsL,SAAS,GAAGC,aAAG,CAACC,QAAQ,WAAIrM,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,sBAAmB;aAClGwI,aAAa,EAAE,gBAAgB;aAC/BC,cAAc,EAAE;YAChB,CAAC;WAEFJ,gBAAI,CAACgE,IAAI,CAAC;aACTC,IAAI,EAAE,MAAM;aACZC,MAAM,EAAE,MAAM;aACdhF,GAAG,EAAE2E,SAAS;aACd5I,IAAI,EAAE;eACLmG,MAAM,EAAE,aAAa;eACrB+C,aAAa,EAAE,aAAa;eAC5BC,MAAM,EAAE1M,aAAG,CAACC,UAAU,CAAC,eAAe,CAAC;eACvC0M,IAAI,EAAE3M,aAAG,CAACC,UAAU,CAAC,SAAS,CAAC;eAC/B2M,IAAI,EAAE5M,aAAG,CAACC,UAAU,CAAC,aAAa,CAAC;eACnCgL,OAAO,EAAE1D;cACT;aACDsF,WAAW,EAAE,IAAI;aACjBxJ,QAAQ,EAAE,kBAACuF,QAAQ,EAAK;eACvBtK,GAAG,CAACwO,eAAe,EAAE;eAErB,IACC,CAACrK,cAAI,CAACE,cAAc,CAACiG,QAAQ,CAACmE,OAAO,CAAC,IACnCnE,QAAQ,CAACmE,OAAO,KAAK,GAAG,EAE5B;iBACC;;eAGD5L,WAAW,CAACgI,aAAa,CAAC,kBAAkB,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC;eAC7D,IAAIM,OAAO,KAAK,QAAQ,EACxB;iBACCnL,GAAG,CAAC0O,eAAe,CAAC;mBACnBC,IAAI,EAAE;kBACN,CAAC;;cAEH;aACDC,gBAAgB,EAAE,4BAAM;eACvB5O,GAAG,CAACwO,eAAe,EAAE;;YAEtB,CAAC;WAEF,OAAO,KAAK;;QAEb,CAAC;;;KACF;KAAA,qBAEW3N,MAAM,EAClB;OACC,IAAMoI,MAAM,GAAI,CAAC9E,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACoI,MAAM,CAAC,GAAGlI,QAAQ,CAACF,MAAM,CAACoI,MAAM,CAAC,GAAG,CAAE;OAC/E,IAAIA,MAAM,IAAI,CAAC,EACf;SACC;;OAGD,IAAM4F,aAAa,GAAI,CAAC1K,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACgO,aAAa,CAAC,GAAG,CAAC,CAAChO,MAAM,CAACgO,aAAa,GAAG,KAAM;OAEhG,IAAIC,WAAW,CAACjD,aAAa,EAAE,IAAIzK,QAAQ,CAACyK,aAAa,CAAC,gBAAgB,CAAC,EAC3E;SACCkD,uBAAuB,CAAClQ,IAAI,CAAC;WAC5BsJ,MAAM,EAAE/G,QAAQ,CAACiH,SAAS,EAAE;WAC5BY,MAAM,EAAEA;UACR,CAAC;QACF,MAED;SACC,IAAI,CAAC+F,OAAO,CAAC;WACZ/F,MAAM,EAAEA,MAAM;WACdlE,QAAQ,EAAE,kBAACkK,QAAQ,EAAK;aACvBC,0BAA0B,CAACC,UAAU,GAAG,EAAE;aAE1C,IACC,CAAChL,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAACG,QAAQ,CAAC,IACjCH,QAAQ,CAACG,QAAQ,IAAI,GAAG,EAE5B;eACC,IAAMC,oBAAoB,GAAG;iBAC5BC,OAAO,EAAE,EAAE;iBACXC,QAAQ,EAAE;gBACV;eAEDL,0BAA0B,CAACM,iBAAiB,CAAC;iBAC5CvG,MAAM,EAAEA,MAAM;iBACdwG,YAAY,EAAER,QAAQ,CAACS,YAAY;iBACnC/G,KAAK,EAAEsG,QAAQ,CAACnE,MAAM;iBACtB+D,aAAa,EAAEA;gBACf,CAAC;eAEF,IAAI,CAAC1K,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAACU,cAAc,CAAC,EAC9C;iBACCT,0BAA0B,CAACU,SAAS,CAAC;mBACpCC,WAAW,EAAEZ,QAAQ,CAACU;kBACtB,CAAC;;eAGH,IAAIxL,cAAI,CAACC,aAAa,CAAC6K,QAAQ,CAACa,eAAe,CAAC,EAChD;iBACC,mCAA2BxK,MAAM,CAACyK,OAAO,CAACd,QAAQ,CAACa,eAAe,CAAC,qCACnE;mBADK;qBAAOjL,GAAG;qBAAEH,KAAK;mBAErB,IACCP,cAAI,CAACE,cAAc,CAAC4K,QAAQ,CAACa,eAAe,CAACjL,GAAG,CAAC,CAACmL,KAAK,CAAC,IACrDf,QAAQ,CAACa,eAAe,CAACjL,GAAG,CAAC,CAACmL,KAAK,KAAK,WAAW,EAEvD;qBACCd,0BAA0B,CAACe,cAAc,CACxCZ,oBAAoB,EACpB;uBACCpB,IAAI,EAAE;sBACN,CACD;oBACD,MACI,IACJ9J,cAAI,CAACE,cAAc,CAAC4K,QAAQ,CAACa,eAAe,CAACjL,GAAG,CAAC,CAACqL,IAAI,CAAC,IACpD,CAAE,GAAG,EAAE,IAAI,CAAE,CAACC,QAAQ,CAAClB,QAAQ,CAACa,eAAe,CAACjL,GAAG,CAAC,CAACqL,IAAI,CAAC,EAE9D;qBACChB,0BAA0B,CAACe,cAAc,CACxCZ,oBAAoB,EACpB;uBACCpB,IAAI,EAAEgB,QAAQ,CAACa,eAAe,CAACjL,GAAG,CAAC,CAACqL,IAAI;uBACxC1M,EAAE,EAAEyL,QAAQ,CAACa,eAAe,CAACjL,GAAG,CAAC,CAACuL,EAAE;uBACpCC,IAAI,EAAEC,cAAI,CAACC,MAAM,CAACtB,QAAQ,CAACa,eAAe,CAACjL,GAAG,CAAC,CAAC2L,KAAK;sBACrD,CACD;;;;eAKJ,IAAI,CAACrM,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAACwB,qBAAqB,CAAC,EACrD;iBACCvB,0BAA0B,CAACwB,YAAY,CAAC;mBACvCC,gBAAgB,EAAE1B,QAAQ,CAACwB;kBAC3B,CAAC;;eAGHvB,0BAA0B,CAACU,SAAS,CAAC;iBACpCgB,kBAAkB,EAAEvB;gBACpB,CAAC;eAEF,IAAI,CAAClL,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAAC4B,SAAS,CAAC,EACzC;iBACC3B,0BAA0B,CAACU,SAAS,CAAC;mBACpCkB,YAAY,EAAE7B,QAAQ,CAAC4B;kBACvB,CAAC;;eAGH,IAAI,CAAC1M,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAAC8B,UAAU,CAAC,EAC1C;iBACC7B,0BAA0B,CAACwB,YAAY,CAAC;mBACvCM,aAAa,EAAE/B,QAAQ,CAAC8B;kBACxB,CAAC;;eAGH/Q,GAAG,CAACC,IAAI,CAAC,cAAc,EAAEiP,0BAA0B,CAACrQ,IAAI,EAAE,CAAC;;;UAI7D,CAAC;;;;KAEH;KAAA,wBAEcgC,MAAM,EACrB;OACC,IAAMoI,MAAM,GAAI,CAAC9E,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACoI,MAAM,CAAC,GAAGlI,QAAQ,CAACF,MAAM,CAACoI,MAAM,CAAC,GAAG,CAAE;OAC/E,IAAIA,MAAM,IAAI,CAAC,EACf;SACC;;OAGD,IAAMgI,gBAAgB,GAAI9M,cAAI,CAAC+M,UAAU,CAACrQ,MAAM,CAACkE,QAAQ,CAAC,GAAGlE,MAAM,CAACkE,QAAQ,GAAG,IAAK;OACpF,IAAIZ,cAAI,CAACgN,MAAM,CAACF,gBAAgB,CAAC,EACjC;SACC;;OAGD,IAAMG,MAAM,GAAG,EAAE;OAEjB,IAAInI,MAAM,GAAG,CAAC,EACd;SACCjJ,GAAG,CAAC4N,eAAe,EAAE;SAErB5D,gBAAI,CAACgE,IAAI,CAAC;WACTC,IAAI,EAAE,MAAM;WACZC,MAAM,EAAE,MAAM;WACdhF,GAAG,YAAKxH,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,oBAAiB;WACvE4M,WAAW,EAAE,IAAI;WACjBtJ,IAAI,EAAE;aACLmG,MAAM,EAAE,oBAAoB;aAC5B+C,aAAa,EAAE,oBAAoB;aACnCC,MAAM,EAAE1M,aAAG,CAACC,UAAU,CAAC,eAAe,CAAC;aACvC0M,IAAI,EAAE3M,aAAG,CAACC,UAAU,CAAC,SAAS,CAAC;aAC/B2M,IAAI,EAAE5M,aAAG,CAACC,UAAU,CAAC,aAAa,CAAC;aACnCgL,OAAO,EAAE1D,MAAM;aACfoI,EAAE,EAAE3P,aAAG,CAACC,UAAU,CAAC,iBAAiB,CAAC;aACrC2P,EAAE,EAAE5P,aAAG,CAACC,UAAU,CAAC,cAAc;YACjC;WACDoD,QAAQ,EAAE,kBAACE,IAAI,EAAK;aACnBjF,GAAG,CAACwO,eAAe,EAAE;aAErB4C,MAAM,CAAC5N,EAAE,GAAGyF,MAAM;aAElB,IACC,CAAC9E,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC6F,MAAM,CAAC,IAC3B/J,QAAQ,CAACkE,IAAI,CAAC6F,MAAM,CAAC,GAAG,CAAC,EAE7B;eACCsG,MAAM,CAACtG,MAAM,GAAG7F,IAAI,CAAC6F,MAAM;;aAG5B,IACC,CAAC3G,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAACyK,YAAY,CAAC,IACjC3O,QAAQ,CAACkE,IAAI,CAACyK,YAAY,CAAC,GAAG,CAAC,EAEnC;eACC0B,MAAM,CAAC1B,YAAY,GAAGzK,IAAI,CAACyK,YAAY;;aAGxC,IAAI,CAACvL,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAACmK,QAAQ,CAAC,EACpC;eACCgC,MAAM,CAAChC,QAAQ,GAAGnK,IAAI,CAACmK,QAAQ;;aAGhC,IAAI,CAACjL,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC6K,eAAe,CAAC,EAC3C;eACCsB,MAAM,CAACtB,eAAe,GAAG7K,IAAI,CAAC6K,eAAe;;aAG9C,IAAI,CAAC3L,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAACwL,qBAAqB,CAAC,EACjD;eACCW,MAAM,CAACX,qBAAqB,GAAGxL,IAAI,CAACwL,qBAAqB;;aAG1D,IAAI,CAACtM,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC0K,cAAc,CAAC,EAC1C;eACCyB,MAAM,CAACzB,cAAc,GAAG1K,IAAI,CAAC0K,cAAc;;aAG5C,IAAIxL,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC4L,SAAS,CAAC,EACpC;eACCO,MAAM,CAACP,SAAS,GAAG5L,IAAI,CAAC4L,SAAS;;aAGlC,IAAI,CAAC1M,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAACsM,kBAAkB,CAAC,EAC9C;eACCH,MAAM,CAACG,kBAAkB,GAAGtM,IAAI,CAACsM,kBAAkB;;aAGpD,IAAI,CAACpN,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC8L,UAAU,CAAC,EACtC;eACCK,MAAM,CAACL,UAAU,GAAG9L,IAAI,CAAC8L,UAAU;;aAGpCE,gBAAgB,CAACG,MAAM,CAAC;YACxB;WACDxC,gBAAgB,EAAE,4BAAM;aACvB5O,GAAG,CAACwO,eAAe,EAAE;;UAEtB,CAAC;;;;GAEH;CAAA;;CC/RsC,IAElCgD,QAAQ;GAAA;KAAA;;GAAA;KAAA;KAAA,qBAERvM,IAAI,EACT;OACC,IAAI,CAACwM,iBAAiB,GAAG,iDAAiD;OAC1E,IAAI,CAACC,WAAW,GAAG,gBAAgB;OAEnC,IAAI,CAAC/I,KAAK,GAAG5H,QAAQ,CAACkE,IAAI,CAAC0D,KAAK,EAAE,EAAE,CAAC;OACrC,IAAI,CAACM,MAAM,GAAGlI,QAAQ,CAACkE,IAAI,CAACgE,MAAM,EAAE,EAAE,CAAC;OACvC,IAAI,CAAC0I,SAAS,GAAIxN,cAAI,CAACE,cAAc,CAACY,IAAI,CAAC0M,SAAS,CAAC,GAAG1M,IAAI,CAAC0M,SAAS,GAAG,GAAI;OAC7E,IAAI,CAACxJ,MAAM,GAAGlD,IAAI,CAACkD,MAAM;OACzB,IAAI,CAACkB,aAAa,GAAIlF,cAAI,CAACE,cAAc,CAACY,IAAI,CAACoE,aAAa,CAAC,GAAGpE,IAAI,CAACoE,aAAa,GAAG,IAAK;OAC1F,IAAI,CAACC,SAAS,GAAInF,cAAI,CAACyN,SAAS,CAAC3M,IAAI,CAACqE,SAAS,CAAC,GAAGrE,IAAI,CAACqE,SAAS,GAAG,CAAE;OAEtE,IAAI,CAACuI,QAAQ,GAAGC,OAAO,CAAC7M,IAAI,CAAC4M,QAAQ,CAAC,IAAK,IAAI,CAAC5I,MAAM,GAAG,CAAE;OAC3D,IAAI,CAAC8I,YAAY,GAAGD,OAAO,CAAC7M,IAAI,CAAC8M,YAAY,CAAC,IAAK,IAAI,CAACpJ,KAAK,GAAG,CAAE;OAClE,IAAI,CAACE,SAAS,GAAGiJ,OAAO,CAAC7M,IAAI,CAAC4D,SAAS,CAAC,IAAK,IAAI,CAACF,KAAK,GAAG,CAAE;OAC5D,IAAI,CAACqJ,SAAS,GAAGF,OAAO,CAAC7M,IAAI,CAAC+M,SAAS,CAAC,IAAK,IAAI,CAACrJ,KAAK,GAAG,CAAE;OAC5D,IAAI,CAACG,QAAQ,GAAIpH,aAAG,CAACC,UAAU,CAAC,+BAA+B,CAAC,KAAK,GAAI;OACzE,IAAI,CAACsQ,kBAAkB,GAAGH,OAAO,CAAC7M,IAAI,CAACgN,kBAAkB,CAAC;OAE1D,IAAI,CAACC,cAAc,GAAGJ,OAAO,CAAC7M,IAAI,CAACiN,cAAc,CAAC;OAClD,IAAI,CAACC,WAAW,GAAGL,OAAO,CAAC7M,IAAI,CAACkN,WAAW,CAAC;OAC5C,IAAI,CAAC/E,WAAW,GAAG0E,OAAO,CAAC7M,IAAI,CAACmI,WAAW,CAAC;OAE5C,IAAI,CAACgF,MAAM,GAAIjO,cAAI,CAAC4C,SAAS,CAAC9B,IAAI,CAACmN,MAAM,CAAC,GAAGnN,IAAI,CAACmN,MAAM,GAAG,IAAK;OAChE,IAAI,CAACjH,OAAO,GAAIhH,cAAI,CAACE,cAAc,CAACY,IAAI,CAACkG,OAAO,CAAC,GAAGlG,IAAI,CAACkG,OAAO,GAAG,MAAO;;;KAC1E;KAAA,+BAGD;OAAA;OACC,IAAMiG,MAAM,GAAG,EAAE;OAEjB,IAAI,IAAI,CAACY,SAAS,EAClB;SACCZ,MAAM,CAACzN,IAAI,CAAC;WACXH,EAAE,EAAE,QAAQ;WACZqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,gDAAyC,IAAI,CAACyL,WAAW,GAAG,GAAG,GAAG,GAAG,EAAG;WAC7FiF,OAAO,EAAE,IAAI,CAACZ,iBAAiB,IAAI,IAAI,CAACrE,WAAW,GAAG,WAAW,GAAG,SAAS,CAAC;WAC9EsE,WAAW,EAAE,IAAI,CAACA,WAAW;WAC7BtG,MAAM,EAAE,kBAAM;aACb,IAAMkH,YAAY,GAAG,IAAI/J,OAAI,CAAC;eAC7BI,KAAK,EAAE,KAAI,CAACA;cACZ,CAAC;aAEF,OAAO2J,YAAY,CAACC,SAAS,CAAC;eAC7BrH,QAAQ,EAAE,KAAI,CAACkH,MAAM;eACrBjH,OAAO,EAAE,KAAI,CAACA;cACd,CAAC;;UAEH,CAAC;;OAGH,IAAI,IAAI,CAAC0G,QAAQ,EACjB;SACC,IAAIxC,oBAAoB,GAAG;WAC1BC,OAAO,EAAE,EAAE;WACXC,QAAQ,EAAE;UACV;SAED,IACCF,oBAAoB,CAACC,OAAO,CAAC9J,MAAM,GAAG,CAAC,IACpC6J,oBAAoB,CAACE,QAAQ,CAAC/J,MAAM,GAAG,CAAC,EAE5C;WACC4L,MAAM,CAACzN,IAAI,CAAC;aACXH,EAAE,EAAE,WAAW;aACfqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC;aAC5D6Q,QAAQ,EAAE,KAAK;aACfH,OAAO,YAAK,IAAI,CAACZ,iBAAiB,eAAY;aAC9CC,WAAW,EAAE,IAAI,CAACA,WAAW;aAC7BtG,MAAM,EAAE,kBAAM;eACbpL,GAAG,CAACyS,SAAS,CAAC;iBACb1N,QAAQ,EAAE,oBAAM;mBACfsI,IAAI,CAACqF,aAAa,EAAE;kBACpB;iBACDxJ,GAAG,YAAKxH,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,4CAAkCD,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC,KAAK,GAAG,GAAG,gBAAgB,GAAG,oBAAoB,kBAAe;iBACpNgR,QAAQ,EAAE,IAAI;iBACdC,QAAQ,EAAE,IAAI;iBACdC,gBAAgB,EAAE,IAAI;iBACtBC,QAAQ,EAAE,IAAI;iBACdC,SAAS,EAAE,IAAI;iBACfC,KAAK,EAAE,IAAI;iBACXC,QAAQ,EAAE5D,oBAAoB;iBAC9B6D,cAAc,EAAE,IAAI;iBACpBC,MAAM,EAAEzR,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;iBACnEyR,UAAU,EAAE1R,aAAG,CAACC,UAAU,CAAC,+CAA+C,CAAC;iBAC3E0R,UAAU,EAAG3R,aAAG,CAACC,UAAU,CAAC,wCAAwC,CAAC,KAAK;gBAC1E,CAAC;cACF;aACD2R,SAAS,EAAE;YACX,CAAC;;;OAIJ,IACC,IAAI,CAACrK,MAAM,GAAG,CAAC,IACZ,IAAI,CAAC0I,SAAS,KAAK,GAAG,EAE1B;SACCP,MAAM,CAACzN,IAAI,CACV;WACCH,EAAE,EAAE,MAAM;WACVqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,oCAAoC,CAAC;WAC3D0Q,OAAO,YAAK,IAAI,CAACZ,iBAAiB,eAAY;WAC9CC,WAAW,EAAE,IAAI,CAACA,WAAW;WAC7BtG,MAAM,EAAE,kBAAM;aACbmC,WAAQ,CAACgG,IAAI,CAAC;eACbC,MAAM,EAAExM,MAAM,CAACyM,UAAU;eACzBxK,MAAM,EAAE,KAAI,CAACA,MAAM;eACnB4F,aAAa,EAAEiD,OAAO,CAAC,KAAI,CAAC1E,WAAW;cACvC,CAAC;YACF;WACDkG,SAAS,EAAE,KAAK;WAChBI,OAAO,EAAE;UACT,EACD;WACClQ,EAAE,EAAE,QAAQ;WACZqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC;WAC7D6Q,QAAQ,EAAE,QAAQ;WAClBd,WAAW,EAAE,IAAI,CAACA,WAAW;WAC7BtG,MAAM,EAAE,kBAAM;aACbmC,WAAQ,UAAO,CAAC;eACftE,MAAM,EAAE,KAAI,CAACA,MAAM;eACnBkC,OAAO,EAAE,KAAI,CAACA;cACd,CAAC;YACF;WACDmI,SAAS,EAAE;UACX,CACD;;OAGF,IAAI,IAAI,CAACvB,YAAY,EACrB;SACCX,MAAM,CAACzN,IAAI,CAAC;WACXH,EAAE,EAAE,WAAW;WACfqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,mDAA4C,IAAI,CAACuQ,cAAc,GAAG,GAAG,GAAG,GAAG,EAAG;WACnGG,OAAO,YAAK,IAAI,CAACZ,iBAAiB,iBAAc;WAChDC,WAAW,EAAE,IAAI,CAACA,WAAW;WAC7BtG,MAAM,EAAE,kBAAM;aACb,IAAMkH,YAAY,GAAG,IAAI/J,OAAI,CAAC;eAC7BI,KAAK,EAAE,KAAI,CAACA;cACZ,CAAC;aAEF,OAAO2J,YAAY,CAACqB,YAAY,CAAC;eAChCpM,IAAI,EAAE,KAAI,CAAC6K;cACX,CAAC;YACF;WACDkB,SAAS,EAAE,KAAK;WAChBI,OAAO,EAAE;UACT,CAAC;;OAGH,IAAI,IAAI,CAAC7K,SAAS,EAClB;SACCuI,MAAM,CAACzN,IAAI,CAAC;WACXH,EAAE,EAAE,QAAQ;WACZqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,gDAAyC,IAAI,CAACwQ,WAAW,GAAG,GAAG,GAAG,GAAG,EAAG;WAC7FE,OAAO,YAAK,IAAI,CAACZ,iBAAiB,YAAS;WAC3CC,WAAW,EAAE,IAAI,CAACA,WAAW;WAC7BtG,MAAM,EAAE,kBAAM;aACbZ,qBAAqB,CAACC,SAAS,CAAC;eAC/B9B,KAAK,EAAE,KAAI,CAACA,KAAK;eACjBuC,QAAQ,EAAE,KAAI,CAACkH,MAAM;eACrBjK,MAAM,EAAE,KAAI,CAACA,MAAM;eACnBuC,OAAO,EAAE,KAAK;eACdE,KAAK,EAAE,IAAI;eACXD,SAAS,EAAE;cACX,CAAC;YACF;WACD2I,SAAS,EAAE;UACX,CAAC;;OAGH,IAAI,IAAI,CAACrB,kBAAkB,EAC3B;SACCb,MAAM,CAACzN,IAAI,CAAC;WACXH,EAAE,EAAE,qBAAqB;WACzBqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,gDAAgD,CAAC;WACvE0Q,OAAO,YAAK,IAAI,CAACZ,iBAAiB,kBAAe;WACjDrG,MAAM,EAAE,kBAAM;aACb,IAAIiC,IAAI,CAACuG,gBAAgB,EACzB;;eAECC,gBAAgB,CAACC,WAAW,CAAC;iBAC5BC,EAAE,EAAE1G,IAAI,CAAC2G,SAAS;iBAClBC,SAAS,EAAE,IAAI;iBACfC,OAAO,EAAE;mBACRC,IAAI,EAAE;;gBAEP,CAAC;cACF,MAED;eACC5T,QAAQ,CAAC6T,QAAQ,CAACC,MAAM,CAAC,IAAI,CAAC;;YAE/B;WACDf,SAAS,EAAE;UACX,CAAC;;OAGH,IACCnP,cAAI,CAACE,cAAc,CAAC,IAAI,CAACgF,aAAa,CAAC,IACpC,IAAI,CAACC,SAAS,GAAG,CAAC,EAEtB;SACC8H,MAAM,CAACzN,IAAI,CAAC;WACXH,EAAE,EAAE,aAAa;WACjBqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,wCAAwC,CAAC;WAC/D0Q,OAAO,YAAK,IAAI,CAACZ,iBAAiB,aAAU;WAC5CC,WAAW,EAAE,IAAI,CAACA,WAAW;WAC7BtG,MAAM,EAAE,kBAAM;aACbiC,IAAI,CAACiH,YAAY,CAAC;eACjBjL,aAAa,EAAE,KAAI,CAACA,aAAa;eACjCC,SAAS,EAAE,KAAI,CAACA;cAChB,CAAC;YACF;WACDgK,SAAS,EAAE;UACX,CAAC;SAEF,IACC,IAAI,CAACxK,QAAQ,IACV,IAAI,CAACH,KAAK,GAAG,CAAC,EAElB;WACCyI,MAAM,CAACzN,IAAI,CAAC;aACXH,EAAE,EAAE,YAAY;aAChBqE,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;aAClE0Q,OAAO,YAAK,IAAI,CAACZ,iBAAiB,gBAAa;aAC/CC,WAAW,EAAE,IAAI,CAACA,WAAW;aAC7BtG,MAAM,EAAE,kBAAM;eACbiC,IAAI,CAACkH,UAAU,CAAC;iBACfC,UAAU,EAAE,KAAI,CAACnL,aAAa;iBAC9BoL,QAAQ,EAAE,KAAI,CAACnL,SAAS;iBACxBX,KAAK,EAAE,KAAI,CAACA;gBACZ,CAAC;eAEF+L,qBAAQ,CAAC;iBACRC,IAAI,EAAE,OAAO;iBACbC,QAAQ,EAAE,iBAAiB;iBAC3BvN,KAAK,EAAE,aAAa;iBACpB4G,IAAI,EAAE,MAAM;iBACZ4G,SAAS,EAAE,MAAM;iBACjBC,SAAS,EAAE;gBACX,CAAC;eAEF,OAAO,KAAK;cACZ;aACDxB,SAAS,EAAE;YACX,CAAC;;;OAIJ,OAAOlC,MAAM;;;GACb;CAAA;;CCnQsE,IAElE2D,QAAQ;GAEb,oBACA;KAAA;KACC,IAAI,CAAC9G,IAAI,GAAG,MAAM;KAClB,IAAI,CAAC+G,iBAAiB,GAAG,EAAE;KAC3B,IAAI,CAACC,mBAAmB,GAAG,EAAE;;GAC7B;KAAA;KAAA,qBAEIhQ,IAAI,EACT;OACC,IAAI,CAACgJ,IAAI,GAAIhJ,IAAI,CAACgJ,IAAI,KAAK,QAAQ,GAAG,QAAQ,GAAG,MAAO;OAExD,IAAMiH,SAAS,GAAG,IAAI,CAACC,gBAAgB,EAAE;OACzC,IAAMtN,KAAK,GACV,IAAI,CAACoG,IAAI,KAAK,QAAQ,GAClB9J,cAAI,CAACE,cAAc,CAAC3C,aAAG,CAACC,UAAU,CAAC,kBAAkB,CAAC,CAAC,GAAGD,aAAG,CAACC,UAAU,CAAC,kBAAkB,CAAC,GAAG,EAAE,GACjGwC,cAAI,CAACE,cAAc,CAAC3C,aAAG,CAACC,UAAU,CAAC,aAAa,CAAC,CAAC,GAAGD,aAAG,CAACC,UAAU,CAAC,aAAa,CAAC,GAAG,EACzF;OAED,IAAIuT,SAAS,CAAC1P,MAAM,GAAG,CAAC,EACxB;SACC,IAAIoG,kBAAkB,CAACC,aAAa,EAAE,IAAIzK,QAAQ,CAACyK,aAAa,CAAC,UAAU,CAAC,EAC5E;WACC,IAAI,CAACuJ,iBAAiB,EAAE;UACxB,MAED;WACCpV,GAAG,CAACqV,UAAU,CAAC;aACdC,KAAK,EAAEJ;YACP,CAAC;WACFrS,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACC,MAAM,CAAC3N,KAAK,CAAC4N,WAAW,CAAC,YAAM;aAAEzV,GAAG,CAAC0V,QAAQ,EAAE;YAAG,CAAC;;QAExE,MACI,IAAI9J,kBAAkB,CAACC,aAAa,EAAE,GAAGzK,QAAQ,CAACyK,aAAa,CAAC,UAAU,CAAC,EAChF;SACChJ,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACC,MAAM,CAAC3N,KAAK,CAAC4N,WAAW,CAAC,EAAE,CAAC;;OAGjD5S,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACC,MAAM,CAAC3N,KAAK,CAAC8N,OAAO,CAAC9N,KAAK,CAAC;OAC/ChF,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACC,MAAM,CAAC3N,KAAK,CAAChJ,IAAI,EAAE;;;KACvC;KAAA,oCAGD;OAAA;OACC,IAAI+M,kBAAkB,CAACC,aAAa,EAAE,GAAGzK,QAAQ,CAACyK,aAAa,CAAC,UAAU,CAAC,EAC3E;SACC;;OAGD,IAAM6B,OAAO,GAAG,EAAE;OAElB,IAAG,CAACL,IAAI,CAAC1E,KAAK,EACd;SACC+E,OAAO,CAAC/J,IAAI,CAAC;WACZsK,IAAI,EAAE,QAAQ;WACdlJ,QAAQ,EAAE,oBACV;aACC/E,GAAG,CAACC,IAAI,CAAC,eAAe,CAAC;;UAE1B,CAAC;;OAGH,IAAIiV,SAAS,GAAG,IAAI,CAACC,gBAAgB,CAAC,IAAI,CAAClH,IAAI,CAAC;OAEhD,IACC2H,EAAE,CAAC3H,IAAI,CAAC4H,OAAO,CAACX,SAAS,CAAC,IACvBA,SAAS,CAAC1P,MAAM,GAAG,CAAC,EAExB;SACCkI,OAAO,CAAC/J,IAAI,CAAC;WACZsK,IAAI,EAAE,MAAM;WACZlJ,QAAQ,EAAE,oBAAM;aACf,KAAI,CAAC+Q,YAAY,CAAC,KAAI,CAAC7H,IAAI,CAAC;;UAE7B,CAAC;;OAGHjO,GAAG,CAACC,IAAI,CAAC,iBAAiB,EAAE;SAC3BqV,KAAK,EAAE5H;QACP,CAAC;;;KACF;KAAA,+BAGD;OACC,IAAI,IAAI,CAACO,IAAI,KAAK,QAAQ,EAC1B;SACC,IAAI,CAACgH,mBAAmB,GAAG,IAAI,CAACc,mBAAmB,CAAC1I,IAAI,CAAC2I,QAAQ,CAAC;;OAGnE,IAAMd,SAAS,GAAG,IAAI,CAACC,gBAAgB,EAAE;OACzC,IAAID,SAAS,CAAC1P,MAAM,IAAI,CAAC,EACzB;SACC;;OAGD,IAAMyQ,cAAc,GAAG,EAAE;OACzB,IAAMC,gBAAgB,GAAG,EAAE;OAE3BhB,SAAS,CAACxS,OAAO,CAAC,UAAAyT,QAAQ,EAAI;SAC7BF,cAAc,CAACtS,IAAI,CAAC;WACnBH,EAAE,EAAE2S,QAAQ,CAAC3S,EAAE;WACfqE,KAAK,EAAEsO,QAAQ,CAAC9F,IAAI;WACpBgC,OAAO,EAAGlO,cAAI,CAACE,cAAc,CAAC8R,QAAQ,CAACC,KAAK,CAAC,GAAGD,QAAQ,CAACC,KAAK,GAAG,EAAG;WACpE5D,QAAQ,EAAGrO,cAAI,CAACE,cAAc,CAAC8R,QAAQ,CAAC3D,QAAQ,CAAC,GAAG2D,QAAQ,CAAC3D,QAAQ,GAAG,EAAG;WAC3Ed,WAAW,EAAE;UACb,CAAC;SAEFwE,gBAAgB,CAACC,QAAQ,CAAC3S,EAAE,CAAC,GAAG2S,QAAQ,CAAC/K,MAAM;QAC/C,CAAC;OAEFpL,GAAG,CAACC,IAAI,CAAC,kBAAkB,EAAE;SAC5BqV,KAAK,EAAEW,cAAc;SACrBI,QAAQ,EAAE,CACT;WACC7S,EAAE,EAAE;UACJ,CACD;SACDuB,QAAQ,EAAE,kBAACsC,KAAK,EAAK;WACpB,IAAIA,KAAK,CAACiP,SAAS,KAAK,WAAW,EACnC;aACCtW,GAAG,CAACC,IAAI,CAAC,eAAe,CAAC;YACzB,MACI,IACJoH,KAAK,CAACiP,SAAS,KAAK,gBAAgB,IACjCnS,cAAI,CAACC,aAAa,CAACiD,KAAK,CAACkP,IAAI,CAAC,IAC9BpS,cAAI,CAACE,cAAc,CAACgD,KAAK,CAACkP,IAAI,CAAC/S,EAAE,CAAC,IAClCW,cAAI,CAAC+M,UAAU,CAACgF,gBAAgB,CAAC7O,KAAK,CAACkP,IAAI,CAAC/S,EAAE,CAAC,CAAC,EAEpD;aACC0S,gBAAgB,CAAC7O,KAAK,CAACkP,IAAI,CAAC/S,EAAE,CAAC,EAAE;;;QAGnC,CAAC;;;KACF;KAAA,mCAGD;OACC,OAAQ,IAAI,CAACyK,IAAI,KAAK,QAAQ,GAAG,IAAI,CAACgH,mBAAmB,GAAG,IAAI,CAACD,iBAAiB;;;KAClF;KAAA,oCAEmB/P,IAAI,EACxB;OACC,IAAIiG,QAAQ,GAAG,IAAI;OAEnB,IAAIU,kBAAkB,CAACC,aAAa,EAAE,IAAIzK,QAAQ,CAACyK,aAAa,CAAC,UAAU,CAAC,EAC5E;SACCX,QAAQ,GAAG3K,QAAQ,CAACC,cAAc,0BAAmBY,QAAQ,CAACoV,QAAQ,EAAE,EAAG;;OAG5EC,gBAAgB,CAACpX,IAAI,CAAC;SACrBsJ,KAAK,EAAEvH,QAAQ,CAACoV,QAAQ,EAAE;SAC1BvN,MAAM,EAAElI,QAAQ,CAACkE,IAAI,CAAC0H,OAAO,CAAC;SAC9BgF,SAAS,EAAE1M,IAAI,CAACyH,SAAS;SACzBmF,QAAQ,EAAG5M,IAAI,CAACsH,UAAU,KAAK,MAAO;SACtCwF,YAAY,EAAG7G,QAAQ,IAAIA,QAAQ,CAACtB,YAAY,CAAC,oBAAoB,CAAC,KAAK,GAAI;SAC/Ef,SAAS,EAAG5D,IAAI,CAACgI,SAAS,KAAK,GAAI;SACnC+E,SAAS,EAAG5Q,QAAQ,CAACoV,QAAQ,EAAE,GAAG,CAAE;SACpCvE,kBAAkB,EAAE,IAAI;SACxBC,cAAc,EAAGhH,QAAQ,IAAIA,QAAQ,CAACtB,YAAY,CAAC,gBAAgB,CAAC,KAAK,GAAI;SAC7EuI,WAAW,EAAG3H,qBAAqB,CAACkM,cAAc,EAAG;SACrDtJ,WAAW,EAAGlC,QAAQ,IAAIA,QAAQ,CAACtB,YAAY,CAAC,aAAa,CAAC,KAAK,GAAI;SACvEP,aAAa,EAAEpE,IAAI,CAACiI,oBAAoB;SACxC5D,SAAS,EAAEvI,QAAQ,CAACkE,IAAI,CAACkI,eAAe,CAAC;SACzCiF,MAAM,EAAElH,QAAQ;SAChBC,OAAO,EAAE;QACT,CAAC;OAEF,OAAOsL,gBAAgB,CAACE,YAAY,EAAE,CAACC,GAAG,CAAC,UAACL,IAAI,EAAK;SACpDA,IAAI,CAAClG,IAAI,GAAGkG,IAAI,CAAC1O,KAAK;SACtB0O,IAAI,CAACH,KAAK,GAAGG,IAAI,CAAClE,OAAO;SAEzB,OAAOkE,IAAI,CAAC1O,KAAK;SACjB,OAAO0O,IAAI,CAAClE,OAAO;SAEnB,OAAOkE,IAAI;QACX,CAAC;;;GACF;CAAA;;CCnL6B,IAEzBM,eAAe;GAEpB,2BACA;KAAA;;GAEC;KAAA;KAAA,qBAEIhW,MAAM,EACX;OAAA;OACC,IAAIoO,QAAQ,GAAG;SACdhB,IAAI,EAAGpN,MAAM,CAACoN,IAAI,GAAGpN,MAAM,CAACoN,IAAI,GAAG,MAAO;SAC1C/K,OAAO,EAAGrC,MAAM,CAACqC,OAAO,GAAGnC,QAAQ,CAACF,MAAM,CAACqC,OAAO,CAAC,GAAG,CAAE;SACxD+F,MAAM,EAAGpI,MAAM,CAACoI,MAAM,GAAGlI,QAAQ,CAACF,MAAM,CAACoI,MAAM,CAAC,GAAG,CAAE;SACrDd,MAAM,EAAGhE,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACsH,MAAM,CAAC,GAAGtH,MAAM,CAACsH,MAAM,GAAG;QAC9D;OACD,IAAI,CAAC2O,eAAe,CAAC7H,QAAQ,CAAC,CAAC5E,IAAI,CAAC,UAAC4E,QAAQ,EAAK;SACjD,OAAO,KAAI,CAAC8H,gBAAgB,CAAC9H,QAAQ,CAAC;QACtC,CAAC,CAAC5E,IAAI,CAAC,UAAC4E,QAAQ,EAAK;SACrB,OAAO,KAAI,CAAC+H,WAAW,CAAC/H,QAAQ,CAAC;QACjC,CAAC,CAAC5E,IAAI,CAAC,UAAC4E,QAAQ,EAAK;SACrB,OAAO,KAAI,CAACgI,eAAe,CAAChI,QAAQ,CAAC;QACrC,CAAC,CAAC5E,IAAI,CAAC,UAAC4E,QAAQ,EAAK;SACrBjP,GAAG,CAACC,IAAI,CAAC,eAAe,EAAE;WACzBoQ,IAAI,EAAE,kBAAkB;WACxB6G,aAAa,EAAE,mBAAmB;WAClCC,UAAU,EAAEvB,EAAE,CAAC7S,OAAO,CAAC,mCAAmC,CAAC;WAC3DlC,MAAM,EAAE;aACP,aAAa,EAAE+U,EAAE,CAAC7S,OAAO,CAAC,iCAAiC,CAAC;aAC5D,kBAAkB,EAAE3B,QAAQ,CAACgW,SAAS,CAAC,iBAAiB,EAAE,EAAE,CAAC;aAC7D,yBAAyB,EAAEhW,QAAQ,CAACgW,SAAS,CAAC,sBAAsB,EAAE,KAAK,CAAC;aAC5E,4BAA4B,EAAEhW,QAAQ,CAACgW,SAAS,CAAC,yBAAyB,EAAE,IAAI,CAAC;aACjF,uBAAuB,EAAGxB,EAAE,CAAC7S,OAAO,CAAC,oCAAoC,CAAC,IAAI,GAAG,GAAG,GAAG,GAAG,GAAI;aAC9F,yBAAyB,EAAG6S,EAAE,CAAC7S,OAAO,CAAC,sCAAsC,CAAC,IAAI,GAAG,GAAG,GAAG,GAAG,GAAI;aAClG,uBAAuB,EAAG6S,EAAE,CAAC7S,OAAO,CAAC,oCAAoC,CAAC,IAAI,GAAG,GAAG,GAAG,GAAG,GAAI;aAC9F,eAAe,EAAG6S,EAAE,CAAC7S,OAAO,CAAC,mCAAmC,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,GAAI;aACtF,kBAAkB,EAAE6S,EAAE,CAAC7S,OAAO,CAAC,sCAAsC,CAAC;aACtE,wBAAwB,EAAE3B,QAAQ,CAACgW,SAAS,CAAC,sBAAsB,EAAE,EAAE,CAAC;aACxE,mBAAmB,EAAEhW,QAAQ,CAACgW,SAAS,CAAC,kBAAkB,EAAE,EAAE,CAAC;aAC/D,aAAa,EAAEhW,QAAQ,CAACgW,SAAS,CAAC,YAAY,EAAE,EAAE,CAAC;aACnD,gBAAgB,EAAEhW,QAAQ,CAACgW,SAAS,CAAC,eAAe,EAAE,EAAE,CAAC;aACzD,6BAA6B,EAAExB,EAAE,CAAC7S,OAAO,CAAC,8CAA8C,CAAC;aACzF,uBAAuB,EAAE6S,EAAE,CAAC7S,OAAO,CAAC,wCAAwC,CAAC;aAC7E,mBAAmB,EAAE6S,EAAE,CAAC7S,OAAO,CAAC,uCAAuC,CAAC;aACxE,gBAAgB,EAAE3B,QAAQ,CAACgW,SAAS,CAAC,cAAc,EAAE,EAAE,CAAC;aACxD,WAAW,EAAEnI,QAAQ;aACrB,cAAc,EAAE2G,EAAE,CAAC7S,OAAO,CAAC,kCAAkC,CAAC;aAC9D,eAAe,EAAE6S,EAAE,CAAC7S,OAAO,CAAC,mCAAmC,CAAC;aAChE,cAAc,EAAE6S,EAAE,CAAC7S,OAAO,CAAC,kCAAkC;YAC7D;WACDsU,UAAU,EAAE;aACXhH,IAAI,EAAE,QAAQ;aACdiH,QAAQ,EAAE;eACTC,UAAU,EAAE,sBAAsB;eAClCvE,KAAK,EAAE;;;UAGT,EAAE,KAAK,CAAC;QACT,CAAC;;;KACF;KAAA,gCAEe/D,QAAQ,EACxB;OACC,IAAMuI,OAAO,GAAG,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAC5C;SACC,IAAM1O,MAAM,GAAGlI,QAAQ,CAACkO,QAAQ,CAAChG,MAAM,CAAC;SACxC,IAAIA,MAAM,GAAG,CAAC,EACd;WACCyO,OAAO,CAACzI,QAAQ,CAAC;WACjB;;SAGD2I,0BAA0B,CAACC,IAAI,CAC9B;WACCpS,MAAM,EAAE,gBAACR,IAAI,EAAK;aAEjB,IAAIA,IAAI,CAACmD,WAAW,KAAK6G,QAAQ,CAAChB,IAAI,EACtC;eACCyJ,OAAO,CAACzI,QAAQ,CAAC;eACjB;;aAGDA,QAAQ,CAAC/L,OAAO,GAAG,CAAC;aAEpB,IAAI,CAACiB,cAAI,CAACC,aAAa,CAAC6K,QAAQ,CAAC6I,IAAI,CAAC,EACtC;eACC7I,QAAQ,CAAC6I,IAAI,GAAG,EAAE;;aAGnB,IAAI3T,cAAI,CAACE,cAAc,CAACY,IAAI,CAAC8S,UAAU,CAAC,EACxC;eACC9I,QAAQ,CAAC6I,IAAI,CAACE,SAAS,GAAG/S,IAAI,CAAC8S,UAAU;;aAE1C,IAAI5T,cAAI,CAACE,cAAc,CAACY,IAAI,CAACgT,YAAY,CAAC,EAC1C;eACChJ,QAAQ,CAAC6I,IAAI,CAACnI,cAAc,GAAG1K,IAAI,CAACgT,YAAY;;aAGjD,IACC9T,cAAI,CAAC+T,aAAa,CAACjT,IAAI,CAACkT,IAAI,CAAC,IAC1BhU,cAAI,CAACC,aAAa,CAACa,IAAI,CAACmT,SAAS,CAAC,EAEtC;eACCnJ,QAAQ,CAAC6I,IAAI,CAAChI,eAAe,GAAG,EAAE;eAElC,IAAMuI,QAAQ,GAAG,CAChB;iBACCC,OAAO,EAAE,YAAY;iBACrBC,KAAK,EAAE;gBACP,EACD;iBACCD,OAAO,EAAE,aAAa;iBACtBC,KAAK,EAAE;gBACP,EACD;iBACCD,OAAO,EAAE,YAAY;iBACrBC,KAAK,EAAE;gBACP,CACD;eAEDtT,IAAI,CAACkT,IAAI,CAACzV,OAAO,CAAC,UAAC6T,IAAI,EAAK;iBAE3B,IAAI/S,EAAE,GAAG,IAAI;iBACb,IAAI+U,KAAK,GAAG,IAAI;iBAEhB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,QAAQ,CAAC7S,MAAM,EAAEgT,CAAC,EAAE,EACxC;mBACC,IAAMC,OAAO,GAAGlC,IAAI,CAACmC,KAAK,CAACL,QAAQ,CAACG,CAAC,CAAC,CAACF,OAAO,CAAC;mBAC/C,IAAIG,OAAO,EACX;qBACCjV,EAAE,GAAGiV,OAAO,CAAC,CAAC,CAAC;qBACfF,KAAK,GAAKhC,IAAI,KAAK,IAAI,GAAI,WAAW,GAAG8B,QAAQ,CAACG,CAAC,CAAC,CAACD,KAAM;qBAC3D;;;iBAIF,IAAI,CAACpU,cAAI,CAACgN,MAAM,CAAC3N,EAAE,CAAC,EACpB;mBACCyL,QAAQ,CAAC6I,IAAI,CAAChI,eAAe,CAACnM,IAAI,CAAC;qBAClCqM,KAAK,EAAEuI,KAAK;qBACZnI,EAAE,EAAE5M,EAAE;qBACNgN,KAAK,EAAGrM,cAAI,CAACC,aAAa,CAACa,IAAI,CAACmT,SAAS,CAAC7B,IAAI,CAAC,CAAC,IAAIpS,cAAI,CAACE,cAAc,CAACY,IAAI,CAACmT,SAAS,CAAC7B,IAAI,CAAC,CAAC1O,KAAK,CAAC,GAAG5C,IAAI,CAACmT,SAAS,CAAC7B,IAAI,CAAC,CAAC1O,KAAK,GAAG;oBACnI,CAAC;;gBAEH,CAAC;;aAGH,IAAI1D,cAAI,CAACE,cAAc,CAACY,IAAI,CAAC0T,eAAe,CAAC,EAC7C;eACC1J,QAAQ,CAAC6I,IAAI,CAACvG,kBAAkB,GAAGtM,IAAI,CAAC0T,eAAe;;aAGxD,IAAI1T,IAAI,CAAC2T,SAAS,KAAK,GAAG,EAC1B;eACC3J,QAAQ,CAAC6I,IAAI,CAACe,iBAAiB,GAAG;iBACjCnU,KAAK,EAAE;gBACP;eAED,IAAIP,cAAI,CAACE,cAAc,CAACY,IAAI,CAAC6T,kBAAkB,CAAC,EAChD;iBACC7J,QAAQ,CAAC6I,IAAI,CAACe,iBAAiB,CAACE,OAAO,GAAGC,IAAI,CAAC3T,KAAK,CAACJ,IAAI,CAAC6T,kBAAkB,CAAC,GAAG,IAAI;;;aAItF,IAAI3U,cAAI,CAACE,cAAc,CAACY,IAAI,CAACgU,eAAe,CAAC,EAC7C;eACChK,QAAQ,CAAC6I,IAAI,CAACoB,iBAAiB,GAAG;iBACjCC,SAAS,EAAElU,IAAI,CAACgU,eAAe;iBAC/BG,SAAS,EAAE;gBACX;eAED,IACCC,KAAK,CAACxD,OAAO,CAAC5Q,IAAI,CAACqU,mBAAmB,CAAC,IACpCnV,cAAI,CAACC,aAAa,CAACa,IAAI,CAACsU,wBAAwB,CAAC,EAErD;iBACCtU,IAAI,CAACqU,mBAAmB,CAAC5W,OAAO,CAAC,UAAC8W,MAAM,EAAK;mBAE5C,IAAMC,QAAQ,GAAGxU,IAAI,CAACsU,wBAAwB,CAACC,MAAM,CAAC;mBACtD,IAAI,CAACrV,cAAI,CAACC,aAAa,CAACqV,QAAQ,CAAC,EACjC;qBACC;;mBAGDxK,QAAQ,CAAC6I,IAAI,CAACoB,iBAAiB,CAACE,SAAS,CAACzV,IAAI,CAAC;qBAC9CH,EAAE,EAAEiW,QAAQ,CAACjW,EAAE;qBACfkW,QAAQ,EAAGvV,cAAI,CAACE,cAAc,CAACoV,QAAQ,CAACC,QAAQ,CAAC,GAAGD,QAAQ,CAACC,QAAQ,GAAG,EAAG;qBAC3E7R,KAAK,EAAG1D,cAAI,CAACE,cAAc,CAACoV,QAAQ,CAAC5R,KAAK,CAAC,GAAG4R,QAAQ,CAAC5R,KAAK,GAAG,EAAG;qBAClE8R,QAAQ,EAAGxV,cAAI,CAACE,cAAc,CAACoV,QAAQ,CAACE,QAAQ,CAAC,GAAGF,QAAQ,CAACE,QAAQ,GAAG;oBACxE,CAAC;kBACF,CAAC;;;aAIJ,IAAMC,MAAM,GAAG,IAAI;aACnB,IAAMC,OAAO,GAAG,oBAAoB,GAAGD,MAAM,GAAG,OAAO;aAEvD,IACC3U,IAAI,CAAC6U,iBAAiB,KAAKF,MAAM,IAC9BzV,cAAI,CAACC,aAAa,CAACa,IAAI,CAAC4U,OAAO,CAAC,CAAC,IACjCR,KAAK,CAACxD,OAAO,CAAC5Q,IAAI,CAAC4U,OAAO,CAAC,CAACE,SAAS,CAAC,EAE1C;eACC9K,QAAQ,CAAC6I,IAAI,CAACkC,YAAY,GAAG;iBAC5BC,SAAS,EAAEhV,IAAI,CAAC4U,OAAO,CAAC,CAACE,SAAS,CAACnD,GAAG,CAAC,UAACsD,QAAQ,EAAK;mBACpD,IAAM9I,MAAM,GAAG;qBACd1M,KAAK,EAAEwV,QAAQ,CAACC,QAAQ;qBACxBC,gBAAgB,EAAEF,QAAQ,CAACG,UAAU,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG;qBACtDC,OAAO,EAAE;oBACT;mBAED,IAAIjB,KAAK,CAACxD,OAAO,CAACqE,QAAQ,CAACK,OAAO,CAAC,EACnC;qBACCnJ,MAAM,CAACkJ,OAAO,GAAGJ,QAAQ,CAACK,OAAO,CAAC3D,GAAG,CAAC,UAAC4D,MAAM,EAAK;uBACjD,OAAO;yBACN9V,KAAK,EAAE8V,MAAM,CAACC;wBACd;sBACD,CAAC;;mBAGH,OAAOrJ,MAAM;kBACb;gBACD;;aAGFsG,OAAO,CAACzI,QAAQ,CAAC;YACjB;WACDvJ,OAAO,EAAE,mBAAM;aACdgS,OAAO,CAACzI,QAAQ,CAAC;;UAElB,EACDA,QAAQ,CAAC/L,OAAO,CAChB;QACD,CAAC;OAEFsU,OAAO,SAAM,CAAC,UAACnV,KAAK,EAAK;SAACqY,OAAO,CAACrY,KAAK,CAACA,KAAK,CAAC;QAAC,CAAC;OAEhD,OAAOmV,OAAO;;;KACd;KAAA,iCAEgBvI,QAAQ,EACzB;OACC,IAAM/L,OAAO,GAAGnC,QAAQ,CAACkO,QAAQ,CAAC/L,OAAO,CAAC;OAE1C,IAAMsU,OAAO,GAAG,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAC5C;SACC,IAAIzU,OAAO,IAAI,CAAC,EAChB;WACCwU,OAAO,CAACzI,QAAQ,CAAC;WACjB;;SAGD,IAAI0L,WAAW,GAAG;WACjBjD,OAAO,EAAEA,OAAO;WAChBC,MAAM,EAAEA;UACR;SAED,IAAMiD,eAAe,GAAG,IAAI5B,IAAI,EAAE;SAClC,IAAM6B,eAAe,GAAG,gCAAgC,GAAGD,eAAe,CAACE,OAAO,EAAE;SAEpFjY,WAAW,CAAC0B,cAAc,CAACsW,eAAe,EAAG,UAAUzJ,MAAM,EAAE;WAC9D,IAAIA,MAAM,CAAC7G,OAAO,EAClB;aACC,IAAI,CAACmN,OAAO,CAACpS,MAAM,CAACyV,MAAM,CAAC9L,QAAQ,EAAE;eACpC+L,KAAK,EAAE;iBACN5K,EAAE,EAAErP,QAAQ,CAACqQ,MAAM,CAAC6J,SAAS,CAAC7K,EAAE,CAAC;iBACjC8K,IAAI,EAAE9J,MAAM,CAAC6J,SAAS,CAACC;;;cAGxB,CAAC,CAAC;YACH,MAED;aACC,IAAI,CAACvD,MAAM,EAAE;;UAEd,CAAElT,IAAI,CAACkW,WAAW,CAAC,CAAC;SAErB9X,WAAW,CAACgI,aAAa,CAAC,4BAA4B,EAAE;WACvD3H,OAAO,EAAEA,OAAO;WAChB2X,eAAe,EAAEA;UACjB,EAAE,IAAI,CAAC;QACR,CAAC;OAEFrD,OAAO,SAAM,CAAC,UAACnV,KAAK,EAAK;SAACqY,OAAO,CAACrY,KAAK,CAACA,KAAK,CAAC;QAAC,CAAC;OAEhD,OAAOmV,OAAO;;;KACd;KAAA,4BAEWvI,QAAQ,EACpB;OACC,IAAMhG,MAAM,GAAGlI,QAAQ,CAACkO,QAAQ,CAAChG,MAAM,CAAC;OAExC,IAAMuO,OAAO,GAAG,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAC5C;SACC,IAAI1O,MAAM,IAAI,CAAC,EACf;WACCyO,OAAO,CAACzI,QAAQ,CAAC;WACjB;;SAGD,IAAI0L,WAAW,GAAG;WACjBjD,OAAO,EAAEA,OAAO;WAChBC,MAAM,EAAEA;UACR;SAED,IAAMiD,eAAe,GAAG,IAAI5B,IAAI,EAAE;SAClC,IAAM6B,eAAe,GAAG,+BAA+B,GAAGD,eAAe,CAACE,OAAO,EAAE;SAEnFjY,WAAW,CAAC0B,cAAc,CAACsW,eAAe,EAAG,UAAUzJ,MAAM,EAAE;WAC9D,IAAIA,MAAM,CAAC7G,OAAO,EAClB;aACC,IAAI,CAACmN,OAAO,CAACpS,MAAM,CAACyV,MAAM,CAAC9L,QAAQ,EAAE;eACpC6I,IAAI,EAAE1G,MAAM,CAACnC;cACb,CAAC,CAAC;YACH,MAED;aACC,IAAI,CAAC0I,MAAM,EAAE;;UAEd,CAAElT,IAAI,CAACkW,WAAW,CAAC,CAAC;SAErB9X,WAAW,CAACgI,aAAa,CAAC,2BAA2B,EAAE;WACtD5B,MAAM,EAAEA,MAAM;WACd4R,eAAe,EAAEA;UACjB,EAAE,IAAI,CAAC;QACR,CAAC;OAEFrD,OAAO,SAAM,CAAC,UAACnV,KAAK,EAAK;SAACqY,OAAO,CAACrY,KAAK,CAACA,KAAK,CAAC;QAAC,CAAC;OAEhD,OAAOmV,OAAO;;;KACd;KAAA,gCAEevI,QAAQ,EACxB;OACC,IAAMhG,MAAM,GAAGlI,QAAQ,CAACkO,QAAQ,CAAChG,MAAM,CAAC;OAExC,IAAMuO,OAAO,GAAG,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAC5C;SACC,IAAIxT,cAAI,CAACC,aAAa,CAAC6K,QAAQ,CAAC6I,IAAI,CAAC,EACrC;WACC,IAAI3T,cAAI,CAAC0R,OAAO,CAAC5G,QAAQ,CAAC6I,IAAI,CAAChI,eAAe,CAAC,EAC/C;aACCb,QAAQ,CAACkM,UAAU,GAAG,EAAE;aAExBlM,QAAQ,CAAC6I,IAAI,CAAChI,eAAe,CAACpN,OAAO,CAAC,UAAC6T,IAAI,EAAK;eAE/C,IAAI1R,GAAG,GAAG,IAAI;eACd,IAAIuW,IAAI,GAAG,IAAI;eAEf,QAAQ7E,IAAI,CAACvG,KAAK;iBAEjB,KAAK,OAAO;mBACXnL,GAAG,GAAG,OAAO;mBACbuW,IAAI,GAAG7E,IAAI,CAACnG,EAAE;mBACd;iBACD,KAAK,WAAW;mBACfvL,GAAG,GAAG,OAAO;mBACbuW,IAAI,GAAG,GAAG;mBACV;iBACD,KAAK,aAAa;mBACjBvW,GAAG,GAAG,QAAQ;mBACduW,IAAI,GAAG7E,IAAI,CAACnG,EAAE;mBACd;iBACD,KAAK,YAAY;mBAChBvL,GAAG,GAAG,aAAa;mBACnBuW,IAAI,GAAG7E,IAAI,CAACnG,EAAE;mBACd;iBACD;;eAGD,IAAIvL,GAAG,EACP;iBACC,IAAI,CAACV,cAAI,CAAC0R,OAAO,CAAC5G,QAAQ,CAACkM,UAAU,CAACtW,GAAG,CAAC,CAAC,EAC3C;mBACCoK,QAAQ,CAACkM,UAAU,CAACtW,GAAG,CAAC,GAAG,EAAE;;iBAE9BoK,QAAQ,CAACkM,UAAU,CAACtW,GAAG,CAAC,CAAClB,IAAI,CAAC;mBAC7BH,EAAE,EAAE4X,IAAI;mBACRvT,KAAK,EAAE0O,IAAI,CAAC/F,KAAK;mBACjB6K,UAAU,EAAGlX,cAAI,CAACE,cAAc,CAACkS,IAAI,CAAC+E,WAAW,CAAC,GAAG/E,IAAI,CAAC+E,WAAW,GAAG/E,IAAI,CAAC/F,KAAM;mBACnF+K,MAAM,EAAGpX,cAAI,CAACE,cAAc,CAACkS,IAAI,CAACiF,MAAM,CAAC,GAAGjF,IAAI,CAACiF,MAAM,GAAG;kBAC1D,CAAC;;cAEH,CAAC;;WAGH,IAAIrX,cAAI,CAAC0R,OAAO,CAAC5G,QAAQ,CAAC6I,IAAI,CAACrH,qBAAqB,CAAC,EACrD;aACCxB,QAAQ,CAAC0B,gBAAgB,GAAG,EAAE;aAE9B1B,QAAQ,CAAC6I,IAAI,CAACrH,qBAAqB,CAAC/N,OAAO,CAAC,UAAC6T,IAAI,EAAK;eACrDtH,QAAQ,CAAC0B,gBAAgB,CAAChN,IAAI,CAAC4S,IAAI,CAACrG,IAAI,GAAGqG,IAAI,CAACnG,EAAE,CAAC;cACnD,CAAC;;UAEH,MACI,IAAIjM,cAAI,CAACC,aAAa,CAAC6K,QAAQ,CAAC+L,KAAK,CAAC,EAC3C;WACC/L,QAAQ,CAACkM,UAAU,GAAG;aACrBM,MAAM,EAAE,CACP;eACCjY,EAAE,EAAEyL,QAAQ,CAAC+L,KAAK,CAAC5K,EAAE;eACrBvI,KAAK,EAAEoH,QAAQ,CAAC+L,KAAK,CAACE;cACtB;YAEF;;SAGFxD,OAAO,CAACzI,QAAQ,CAAC;QACjB,CAAC;OAEFuI,OAAO,SAAM,CAAC,UAACnV,KAAK,EAAK;SAACqY,OAAO,CAACrY,KAAK,CAACA,KAAK,CAAC;QAAC,CAAC;OAEhD,OAAOmV,OAAO;;;GACd;CAAA;;CC5Z8B,IAE1BkE,kBAAkB;GAEvB,8BACA;KAAA;KACC,IAAI,CAACC,cAAc,GAAG,EAAE;KACxB,IAAI,CAACC,iBAAiB,GAAG,EAAE;;GAC3B;KAAA;KAAA,kCAEiBC,SAAS,EAC3B;OACC,IAAIC,EAAE,GAAG,IAAI;OAEb,mCAA2BxW,MAAM,CAACyK,OAAO,CAAC8L,SAAS,CAAC,qCACpD;SADK;WAAOhX,GAAG;WAAEH,KAAK;SAErB,IAAImX,SAAS,CAAC1W,cAAc,CAACN,GAAG,CAAC,EACjC;WACCiX,EAAE,GAAG,EAAE;WACPA,EAAE,CAACjX,GAAG,CAAC,GAAGH,KAAK;WACf,IAAI,CAACgM,YAAY,CAACoL,EAAE,CAAC;;;;;KAGvB;KAAA,6BAEYjb,MAAM,EACnB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACC;;OAGD,qCAA2ByE,MAAM,CAACyK,OAAO,CAAClP,MAAM,CAAC,wCACjD;SADK;WAAOgE,GAAG;WAAEH,KAAK;SAErB,IAEEG,GAAG,IAAI,kBAAkB,IACtBA,GAAG,IAAI,OAAO,IACdA,GAAG,IAAI,QAAQ,IACfA,GAAG,IAAI,cAAc,IACrBA,GAAG,IAAI,eAAe,IACtBA,GAAG,IAAI,WAAW,IAClBA,GAAG,IAAI,aAAa,IACpBA,GAAG,IAAI,QAAQ,IACfA,GAAG,IAAI,eAAe,EAG3B;WACC,IAAI,CAAC+W,iBAAiB,CAAC/W,GAAG,CAAC,GAAGH,KAAK;;;;;KAGrC;KAAA,+BAGD;OACC,OAAO,IAAI,CAACkX,iBAAiB;;;KAC7B;KAAA,0BAES/a,MAAM,EAChB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACC;;OAGD,qCAA2ByE,MAAM,CAACyK,OAAO,CAAClP,MAAM,CAAC,wCACjD;SADK;WAAOgE,GAAG;WAAEH,KAAK;SAErB,IAAI,CAAE,oBAAoB,EAAE,aAAa,EAAE,cAAc,CAAE,CAACqX,OAAO,CAAClX,GAAG,CAAC,KAAK,CAAC,CAAC,EAC/E;WACC,IAAI,CAAC8W,cAAc,CAAC9W,GAAG,CAAC,GAAGH,KAAK;;;;;KAGlC;KAAA,+BAEc2K,oBAAoB,EAAExO,MAAM,EAC3C;OACC,IACC,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,IACxB,CAACsD,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACoN,IAAI,CAAC,EAErC;SACC;;OAGD,IAAI+N,SAAS,GAAG,IAAI;OAEpB,IAAInb,MAAM,CAACoN,IAAI,KAAK,IAAI,EACxB;SACC+N,SAAS,GAAG3M,oBAAoB,CAACC,OAAO,CAAC2M,IAAI,CAAC,IAAI,CAACC,uBAAuB,EAAE;WAAExX,KAAK,EAAE;UAAG,CAAC;SACzF,IAAI,CAACsX,SAAS,EACd;WACC3M,oBAAoB,CAACC,OAAO,CAAC3L,IAAI,CAAC;aACjCH,EAAE,EAAE,CAAC;aACL6M,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,eAAe,CAAC;aACrCwa,uBAAuB,EAAE,SAAS;aAClCC,iBAAiB,EAAE;YACnB,CAAC;;QAEH,MACI,IAAIvb,MAAM,CAACoN,IAAI,KAAK,GAAG,EAC5B;SACC+N,SAAS,GAAG3M,oBAAoB,CAACC,OAAO,CAAC2M,IAAI,CAAC,IAAI,CAACC,uBAAuB,EAAE;WAAExX,KAAK,EAAE7D,MAAM,CAAC2C;UAAI,CAAC;SACjG,IAAI,CAACwY,SAAS,EACd;WACC3M,oBAAoB,CAACC,OAAO,CAAC3L,IAAI,CAAC;aACjCH,EAAE,EAAE3C,MAAM,CAAC2C,EAAE;aACb6M,IAAI,EAAExP,MAAM,CAACwP,IAAI;aACjB8L,uBAAuB,EAAE,SAAS;aAClCC,iBAAiB,EAAE;YACnB,CAAC;;QAEH,MACI,IAAIvb,MAAM,CAACoN,IAAI,KAAK,IAAI,EAC7B;SACC+N,SAAS,GAAG3M,oBAAoB,CAACE,QAAQ,CAAC0M,IAAI,CAAC,IAAI,CAACC,uBAAuB,EAAE;WAAExX,KAAK,EAAE7D,MAAM,CAAC2C;UAAI,CAAC;SAClG,IAAI,CAACwY,SAAS,EACd;WACC3M,oBAAoB,CAACE,QAAQ,CAAC5L,IAAI,CAAC;aAClCH,EAAE,EAAE3C,MAAM,CAAC2C,EAAE;aACb6M,IAAI,EAAExP,MAAM,CAACwP,IAAI;aACjB8L,uBAAuB,EAAE,SAAS;aAClCC,iBAAiB,EAAE;YACnB,CAAC;;;;;KAGJ;KAAA,wCAEuBC,OAAO,EAAEC,KAAK,EAAEC,KAAK,EAC7C;OACC,OAAQF,OAAO,CAAC7Y,EAAE,IAAI,IAAI,CAACkB,KAAK;;;KAChC;KAAA,qBAEI7D,MAAM,EACX;OAAA;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAM2T,UAAU,GACfrQ,cAAI,CAACE,cAAc,CAACxD,MAAM,CAAC2T,UAAU,CAAC,GACnC3T,MAAM,CAAC2T,UAAU,GACjB,MACH;OAED,IAAMqH,SAAS,GAAG,IAAI,CAACW,YAAY,EAAE;OAErC,IAAMb,cAAc,GAAG;SACtBc,YAAY,EAAE,IAAI,CAACC,eAAe,EAAE;SACpCC,aAAa,EAAE,IAAI,CAACC,gBAAgB,EAAE;SACtCC,kBAAkB,EAAE,IAAI,CAACC,qBAAqB,EAAE;SAChDjB,SAAS,EAAGA,SAAS,GAAGA,SAAS,GAAG,EAAG;SACvCkB,WAAW,EAAE,EAAE;SACfC,uBAAuB,EAAGxI,UAAU,KAAK,MAAO;SAChDyI,QAAQ,EAAE;WACTlY,QAAQ,EAAE,kBAACE,IAAI,EAAK;aACnB,IAAI,CAACd,cAAI,CAACE,cAAc,CAACY,IAAI,CAAC1C,IAAI,CAAC,EACnC;eACC;;aAGD,IAAM0M,QAAQ,GAAG,KAAI,CAACiO,gBAAgB,CAAC;eACtCjP,IAAI,EAAEuG,UAAU;eAChBqH,SAAS,EAAE5W,IAAI,CAAC4W,SAAS;eACzBtZ,IAAI,EAAE,KAAI,CAAC4a,aAAa,CAAClY,IAAI,CAAC1C,IAAI,CAAC;eACnCsM,aAAa,EACZ1K,cAAI,CAACE,cAAc,CAACY,IAAI,CAAC4W,SAAS,CAAChN,aAAa,CAAC,IAC7C5J,IAAI,CAAC4W,SAAS,CAAChN,aAAa,KAAK;cAEtC,CAAC;aAEF,IAAMuO,MAAM,GAAGnY,IAAI,CAAC4W,SAAS,CAAC7K,aAAa;aAE3C,KAAI,CAACqM,UAAU,CACdpO,QAAQ,EACRhK,IAAI,CAACqY,aAAa,EAClB;eACCF,MAAM,EAAEA;cACR,CACD,CAAC/S,IAAI,CAAC,YAAM;eACZ,IAAImK,UAAU,KAAK,MAAM,EACzB;iBACC;;eAGD,KAAI,CAAC+I,iBAAiB,CACrBtO,QAAQ,EACRhK,IAAI,CAAC2L,kBAAkB,EAEtBzM,cAAI,CAACC,aAAa,CAACa,IAAI,CAAC4W,SAAS,CAAC,IAC/B,CAAC1X,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC4W,SAAS,CAAClL,gBAAgB,CAAC,GAClD1L,IAAI,CAAC4W,SAAS,CAAClL,gBAAgB,GAC/B,EAAE,EAEN,EAAE,CACF;eAED,IAAI,CAAC1B,QAAQ,CAACuO,aAAa,EAC3B;iBACC;;eAGDvO,QAAQ,CAACmO,MAAM,GAAGA,MAAM;eACxBnO,QAAQ,CAAC7G,WAAW,GAAG,MAAM;eAE7BiF,IAAI,CAACoQ,YAAY,CAAC;iBACjBva,OAAO,EAAGrC,MAAM,CAACqC,OAAO,GAAGrC,MAAM,CAACqC,OAAO,GAAG;gBAC5C,CAAC;eAEFL,WAAW,CAACgI,aAAa,CAAC,oCAAoC,EAAE;iBAC/DhG,GAAG,EAAEoK,QAAQ,CAACuO,aAAa;iBAC3B3O,aAAa,EAAE,CAAC,CAACI,QAAQ,CAACJ,aAAa;iBACvC0H,IAAI,EAAEtH,QAAQ;iBACd9G,MAAM,EAAE/G,QAAQ,CAACiH,SAAS,EAAE;iBAC5BnF,OAAO,EAAGrC,MAAM,CAACqC,OAAO,GAAGrC,MAAM,CAACqC,OAAO,GAAG;gBAC5C,EAAE,IAAI,CAAC;cAER,EAAE,YAAM,EAAE,CAAC;YACZ;WACDmN,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,iBAAiB;UACtC;SACD+b,YAAY,EAAE;WACb3Y,QAAQ,EAAE,oBAAM;aACfsI,IAAI,CAACoQ,YAAY,CAAC;eACjBva,OAAO,EAAGrC,MAAM,CAACqC,OAAO,GAAGrC,MAAM,CAACqC,OAAO,GAAG;cAC5C,CAAC;YACF;WACDmN,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,mBAAmB;;QAEzC;OAED,IAAI,CAACwC,cAAI,CAACqJ,WAAW,CAAC,IAAI,CAACmO,cAAc,CAAC9L,WAAW,CAAC,EACtD;SACC8L,cAAc,CAAC5Y,OAAO,GAAG;WACxBR,IAAI,EAAE,IAAI,CAACoZ,cAAc,CAAC9L;UAC1B;;OAGF,IAAI,CAAC1L,cAAI,CAACqJ,WAAW,CAAC,IAAI,CAACmO,cAAc,CAAC7K,YAAY,CAAC,EACvD;SACC6K,cAAc,CAAC2B,aAAa,GAAG,IAAI,CAAC3B,cAAc,CAAC7K,YAAY;;OAGhE,IAAI0D,UAAU,KAAK,MAAM,EACzB;SACCmH,cAAc,CAACR,UAAU,GAAG;WAC3BwC,UAAU,EAAE,IAAI,CAACC,uBAAuB;UACxC;SAED,IAAI,CAACzZ,cAAI,CAACqJ,WAAW,CAAC,IAAI,CAACmO,cAAc,CAAC/K,kBAAkB,CAAC,EAC7D;WACC+K,cAAc,CAACR,UAAU,CAACvK,kBAAkB,GAAG,IAAI,CAAC+K,cAAc,CAAC/K,kBAAkB;;SAGtF,IAAI,CAACzM,cAAI,CAACqJ,WAAW,CAAC,IAAI,CAACmO,cAAc,CAACkC,cAAc,CAAC,EACzD;WACClC,cAAc,CAACkC,cAAc,GAAG,IAAI,CAAClC,cAAc,CAACkC,cAAc;;;OAIpE,OAAOlC,cAAc;;;KACrB;KAAA,kCAGD;OACC,IAAMmC,iBAAiB,GAAG,EAAE;OAE5B,IACCpc,aAAG,CAACC,UAAU,CAAC,oCAAoC,CAAC,KAAK,GAAG,IACzDD,aAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC,KAAK,GAAG,EAElE;SACC,IAAMoc,gBAAgB,GAAG;WACxBva,EAAE,EAAE,MAAM;WACV6M,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,iBAAiB,CAAC;WACvCgc,UAAU,EAAE;aACX/K,QAAQ,EAAE,IAAI;aACd1J,GAAG,EACFxH,aAAG,CAACC,UAAU,CAAC,oCAAoC,CAAC,KAAK,GAAG,aACtDD,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,gFAAsED,aAAG,CAACC,UAAU,CAAC,SAAS,CAAC,cAC7ID,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,gCAAsBD,aAAG,CAACC,UAAU,CAAC,SAAS,CAAC;;UAGrG;SAED,IAAMqc,aAAa,GAAG;WACrBC,WAAW,EAAE,KAAK;WAClBlL,SAAS,EAAE,KAAK;WAChBC,KAAK,EAAE,KAAK;WACZ3C,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,sBAAsB;UAC3C;;;SAGD,IAAIqF,MAAM,CAACkX,QAAQ,KAAK,KAAK,EAC7B;WACCH,gBAAgB,CAACJ,UAAU,CAACQ,cAAc,GAAGH,aAAa;UAC1D,MAED;WACCD,gBAAgB,CAACJ,UAAU,CAACS,cAAc,GAAGJ,aAAa;;SAG3DF,iBAAiB,CAACna,IAAI,CAACoa,gBAAgB,CAAC;;OAGzCD,iBAAiB,CAACna,IAAI,CAAC;SACtBH,EAAE,EAAE,WAAW;SACf6M,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,yBAAyB;QAC9C,CAAC;OAEFmc,iBAAiB,CAACna,IAAI,CAAC;SACtBH,EAAE,EAAE,QAAQ;SACZ6M,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,wBAAwB;QAC7C,CAAC;OAEF,OAAO;SACN2T,KAAK,EAAEwI;QACP;;;KACD;KAAA,mCAGD;OACC,OAAO;SACNH,UAAU,EAAE;WACX9K,gBAAgB,EAAE,KAAK;WACvBQ,UAAU,EAAE,IAAI;WAChBF,MAAM,EAAEzR,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC;WAC5CyR,UAAU,EAAE1R,aAAG,CAACC,UAAU,CAAC,wBAAwB,CAAC;WACpDiR,QAAQ,EAAE,IAAI;WACdM,cAAc,EAAE,KAAK;WACrBhK,GAAG,YAAKxH,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC;;QAEvD;;;KACD;KAAA,wCAGD;OACC,OAAO;SACN0c,MAAM,EAAE,CACP,EAAE,EACF,CAAC,EACD,CAAC,EACD,IAAI,EACJ,IAAI,EACJ,CAAC,EACD,CAAC,EACD,KAAK,EACL,IAAI,EACJ,KAAK,EACL,IAAI,EACJ,CAAC,CACD;SACDC,gBAAgB,EAAE;QAClB;;;KACD;KAAA,iCAEgBzd,MAAM,EACvB;OACC,IAAI0d,OAAO,GAAG,IAAI;OAElB,IAAI1d,MAAM,CAACoN,IAAI,KAAK,MAAM,EAC1B;SACCsQ,OAAO,GAAG;WACTC,MAAM,EAAE,UAAU;WAClBC,SAAS,EAAE,GAAG;WACdC,cAAc,EAAE,GAAG;WACnBC,OAAO,EAAE,GAAG;WACZC,KAAK,EAAE,GAAG;WACVxQ,MAAM,EAAE1M,aAAG,CAACC,UAAU,CAAC,eAAe,CAAC;WACvCsW,YAAY,EAAEpX,MAAM,CAAC0B,IAAI;WACzBgO,MAAM,EAAE,GAAG;WACXsO,KAAK,EAAE,EAAE;WACTC,UAAU,EAAE,EAAE;WACdC,MAAM,EAAE,GAAG;WACXC,aAAa,EAAE;UACf;SAED,IACC,CAAC7a,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACgb,SAAS,CAAC5S,MAAM,CAAC,IACvClI,QAAQ,CAACF,MAAM,CAACgb,SAAS,CAAC5S,MAAM,CAAC,GAAG,CAAC,EAEzC;WACCsV,OAAO,CAAC5R,OAAO,GAAG5L,QAAQ,CAACF,MAAM,CAACgb,SAAS,CAAC5S,MAAM,CAAC;WACnDsV,OAAO,CAAC7O,YAAY,GAAG3O,QAAQ,CAACF,MAAM,CAACgb,SAAS,CAACpM,YAAY,CAAC;WAC9D8O,OAAO,CAAC1P,aAAa,GAAG,CAAC,CAAChO,MAAM,CAACgO,aAAa;WAE9C0P,OAAO,CAACC,MAAM,GAAG,WAAW;WAE5B,IACC,CAACra,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACgb,SAAS,CAAClT,KAAK,CAAC,IACtC5H,QAAQ,CAACF,MAAM,CAACgb,SAAS,CAAClT,KAAK,CAAC,GAAG,CAAC,EAExC;aACC4V,OAAO,CAACzT,MAAM,GAAG/J,QAAQ,CAACF,MAAM,CAACgb,SAAS,CAAClT,KAAK,CAAC;;;QAGnD,MACI,IACJ9H,MAAM,CAACoN,IAAI,KAAK,SAAS,IACtB,CAAC9J,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACgb,SAAS,CAACoD,SAAS,CAAC,IAC7Cle,QAAQ,CAACF,MAAM,CAACgb,SAAS,CAACoD,SAAS,CAAC,GAAG,CAAC,IACxC9a,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACgb,SAAS,CAACqD,WAAW,CAAC,EAErD;SACCX,OAAO,GAAG;WACTnT,MAAM,EAAE,cAAc;WACtB7I,IAAI,EAAE,IAAI,CAAC4a,aAAa,CAACtc,MAAM,CAAC0B,IAAI,CAAC;WACrC0c,SAAS,EAAEle,QAAQ,CAACF,MAAM,CAACgb,SAAS,CAACoD,SAAS,CAAC;WAC/CrZ,MAAM,EAAE/E,MAAM,CAACgb,SAAS,CAACjW,MAAM;WAC/BwI,MAAM,EAAE1M,aAAG,CAACC,UAAU,CAAC,eAAe;UACtC;SAED,IAAId,MAAM,CAACgb,SAAS,CAACqD,WAAW,KAAK,MAAM,EAC3C;WACCX,OAAO,CAACY,eAAe,GAAG,IAAI;;;OAIhC,OAAOZ,OAAO;;;KACd;KAAA,8BAEahc,IAAI,EAClB;OACC,IAAI6c,UAAU,GAAG7c,IAAI;OAErB,IAAI,OAAO8K,IAAI,CAACgS,SAAS,IAAI,WAAW,EACxC;SACC,qCAA2B/Z,MAAM,CAACyK,OAAO,CAAC1C,IAAI,CAACgS,SAAS,CAAC,wCACzD;WADK;aAAOxa,GAAG;aAAEH,KAAK;WAErB0a,UAAU,GAAGA,UAAU,CAAC/S,OAAO,CAAC,IAAIiT,MAAM,CAACza,GAAG,EAAE,GAAG,CAAC,EAAEH,KAAK,CAAC;;SAG7D2I,IAAI,CAACgS,SAAS,GAAG,EAAE;SACnBhS,IAAI,CAACkS,kBAAkB,GAAG,EAAE;;OAG7B,OAAOH,UAAU;;;KACjB;KAAA,2BAEUnQ,QAAQ,EAAEqO,aAAa,EAAEzc,MAAM,EAC1C;OAAA;OACC,IAAM2W,OAAO,GAAG,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;SAChD,IAAMyF,MAAM,GAAGvc,MAAM,CAACuc,MAAM;SAE5BnO,QAAQ,CAACuO,aAAa,GAAGzc,QAAQ,CAAC0C,IAAI,CAACC,MAAM,EAAE,GAAG,MAAM,CAAC;SACzDuL,QAAQ,CAACuQ,SAAS,GAAG,EAAE;SAEvB,IACCrb,cAAI,CAAC0R,OAAO,CAACyH,aAAa,CAAC,IACxBA,aAAa,CAAC9X,MAAM,GAAG,CAAC,EAE5B;WACC,IAAIia,eAAe,GAAG,CAAC;WACvB,IAAMC,SAAS,GAAGpC,aAAa,CAAC9X,MAAM;WACtC,IAAMma,kBAAkB,GAAG,SAArBA,kBAAkB,GAAS;aAChCF,eAAe,EAAE;aACjB,IAAGA,eAAe,IAAIC,SAAS,EAC/B;eACC,MAAI,CAACE,oBAAoB,CAAC3Q,QAAQ,EAAEqO,aAAa,EAAEzc,MAAM,CAAC;eAC1D6W,OAAO,EAAE;;YAEV;WAED,IAAMmI,WAAW,GAAG,EAAE;WAEtBvC,aAAa,CAAC5a,OAAO,CAAC,UAACod,QAAQ,EAAK;aACnC,IAAMC,sBAAsB,GAC3B,CAAC5b,cAAI,CAACqJ,WAAW,CAACsS,QAAQ,CAACE,KAAK,CAAC;gBAEhC,CAAC7b,cAAI,CAACqJ,WAAW,CAACsS,QAAQ,CAACtc,EAAE,CAAC,IAC3BzC,QAAQ,CAAC+e,QAAQ,CAACtc,EAAE,CAAC,GAAG,CAC3B;gBAEAW,cAAI,CAACC,aAAa,CAAC0b,QAAQ,CAACG,cAAc,CAAC,IACxC,CAAC9b,cAAI,CAACqJ,WAAW,CAACsS,QAAQ,CAACG,cAAc,CAACD,KAAK,CAClD;gBAEA7b,cAAI,CAACE,cAAc,CAACyb,QAAQ,CAAC1C,MAAM,CAAC,IACjC0C,QAAQ,CAAC1C,MAAM,KAAKA,MAExB;aAED,IAAM8C,iBAAiB,GACtB/b,cAAI,CAACqJ,WAAW,CAACsS,QAAQ,CAAC5W,GAAG,CAAC,IAC3B,CAAC/E,cAAI,CAACgc,QAAQ,CAACL,QAAQ,CAACtc,EAAE,CAC7B;aAED,IACCW,cAAI,CAACE,cAAc,CAACyb,QAAQ,CAAC5W,GAAG,CAAC,IAC9BgX,iBAAiB,IACjB,CAACH,sBAAsB,EAE3B;eACC,IAAMvW,MAAM,sBAAezI,QAAQ,CAAC0C,IAAI,CAACC,MAAM,EAAE,GAAG,MAAM,CAAC,CAAE;eAC7D,IAAM0c,QAAQ,GAAGC,wBAAW,CAACC,eAAe,CAACR,QAAQ,CAAC7R,IAAI,CAAC;eAE3D4R,WAAW,CAAClc,IAAI,CAAC;iBAChB6F,MAAM,EAAEA,MAAM;iBACdyE,IAAI,EAAE6R,QAAQ,CAAC7R,IAAI;iBACnBmS,QAAQ,EAAEA,QAAQ;iBAClBG,QAAQ,EAAExf,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,8CAA8C,CAAC,CAAC;;iBAElFd,MAAM,EAAE;mBACP2c,aAAa,EAAEvO,QAAQ,CAACuO,aAAa;mBACrC3O,aAAa,EAAE,CAAC,CAACI,QAAQ,CAACJ;kBAC1B;iBACDwB,IAAI,EAAGgQ,wBAAW,CAACG,iBAAiB,CAACV,QAAQ,CAACzP,IAAI,EAAEyP,QAAQ,CAAC7R,IAAI,CAAE;iBACnE/E,GAAG,EAAE4W,QAAQ,CAAC5W,GAAG;iBACjBuX,UAAU,EAAGX,QAAQ,CAACW,UAAU,GAAGX,QAAQ,CAACW,UAAU,GAAG,IAAK;iBAC9DpC,MAAM,EAAEgC,wBAAW,CAACK,gBAAgB,CAACZ,QAAQ,CAAC7R,IAAI;gBAClD,CAAC;eAEFgB,QAAQ,CAACuQ,SAAS,CAAC7b,IAAI,CAAC6F,MAAM,CAAC;cAC/B,MAED;eACC,IAAIuW,sBAAsB,EAC1B;iBACC,IAAI5b,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAACmO,MAAM,CAAC,CAAC,EACtC;mBACCnO,QAAQ,CAACmO,MAAM,CAAC,GAAG,EAAE;;iBAGtB,IAAI,CAACjZ,cAAI,CAACqJ,WAAW,CAACsS,QAAQ,CAACE,KAAK,CAAC,EACrC;mBACC/Q,QAAQ,CAACmO,MAAM,CAAC,CAACzZ,IAAI,CAACmc,QAAQ,CAACE,KAAK,CAAC;kBACrC,MACI,IAAIjf,QAAQ,CAAC+e,QAAQ,CAACtc,EAAE,CAAC,GAAG,CAAC,EAClC;mBACCyL,QAAQ,CAACmO,MAAM,CAAC,CAACzZ,IAAI,CAAC5C,QAAQ,CAAC+e,QAAQ,CAACtc,EAAE,CAAC,CAAC;kBAC5C,MAED;mBACCyL,QAAQ,CAACmO,MAAM,CAAC,CAACzZ,IAAI,CAACmc,QAAQ,CAACG,cAAc,CAACD,KAAK,CAAC;;;eAItDL,kBAAkB,EAAE;;YAErB,CAAC;WAEF,IAAIE,WAAW,CAACra,MAAM,GAAG,CAAC,EAC1B;aACC3C,WAAW,CAACgI,aAAa,CAAC,0BAA0B,EAAE;eACrD8V,KAAK,EAAEd;cACP,EAAE,IAAI,CAAC;;WAETnI,OAAO,EAAE;UACT,MAED;WACC,MAAI,CAACkI,oBAAoB,CAAC3Q,QAAQ,EAAEqO,aAAa,EAAEzc,MAAM,CAAC;WAC1D6W,OAAO,EAAE;;QAEV,CAAC;OAEFF,OAAO,SAAM,CAAC,UAACnV,KAAK,EAAK;SAACqY,OAAO,CAACrY,KAAK,CAACA,KAAK,CAAC;QAAC,CAAC;OAEhD,OAAOmV,OAAO;;;KACd;KAAA,kCAEiBvI,QAAQ,EAAE2B,kBAAkB,EAAED,gBAAgB,EAAE9P,MAAM,EACxE;OACCoO,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE;OAErB,IAAI9K,cAAI,CAACC,aAAa,CAACwM,kBAAkB,CAACtB,OAAO,CAAC,EAClD;SACC,qCAA8BhK,MAAM,CAACyK,OAAO,CAACa,kBAAkB,CAACtB,OAAO,CAAC,wCACxE;WADK;aAAOzK,GAAG;aAAE4U,QAAQ;WAExB,IAAMmH,MAAM,GAAG,GAAG;WAElB,IAAIzc,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAAC4P,KAAK,CAAC+B,MAAM,CAAC,CAAC,EAC5C;aACC3R,QAAQ,CAAC4P,KAAK,CAAC+B,MAAM,CAAC,GAAG,EAAE;;WAG5B,IAAIzc,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAAC6P,UAAU,CAAC8B,MAAM,CAAC,CAAC,EACjD;aACC3R,QAAQ,CAAC6P,UAAU,CAAC8B,MAAM,CAAC,GAAG,EAAE;;WAGjC,IAAMpd,EAAE,GACP,CAACW,cAAI,CAACqJ,WAAW,CAACiM,QAAQ,CAACrJ,EAAE,CAAC,GAC3BqJ,QAAQ,CAACrJ,EAAE,GACXqJ,QAAQ,CAACjW,EACZ;WAED,IAAM6M,IAAI,GACT,CAAClM,cAAI,CAACqJ,WAAW,CAACiM,QAAQ,CAACyB,IAAI,CAAC,GAC7BzB,QAAQ,CAACyB,IAAI,GACbzB,QAAQ,CAACpJ,IACZ;WAED,IAAM3L,KAAK,GACV3D,QAAQ,CAACyC,EAAE,CAAC,KAAK,CAAC,GACf,IAAI,cACAA,EAAE,CACT;WAEDyL,QAAQ,CAAC4P,KAAK,CAAC+B,MAAM,CAAC,CAACjd,IAAI,CAACe,KAAK,CAAC;WAClCuK,QAAQ,CAACkJ,IAAI,CAACxU,IAAI,CAACe,KAAK,CAAC;WACzBuK,QAAQ,CAAC6P,UAAU,CAAC8B,MAAM,CAAC,CAACjd,IAAI,CAAC0M,IAAI,CAAC;;;OAIxC,IAAIlM,cAAI,CAACC,aAAa,CAACwM,kBAAkB,CAACrB,QAAQ,CAAC,EACnD;SACC,qCAA+BjK,MAAM,CAACyK,OAAO,CAACa,kBAAkB,CAACrB,QAAQ,CAAC,wCAC1E;WADK;aAAO1K,IAAG;aAAEoW,SAAS;WAEzB,IAAM2F,OAAM,GAAG,IAAI;WAEnB,IAAIzc,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAAC4P,KAAK,CAAC+B,OAAM,CAAC,CAAC,EAC5C;aACC3R,QAAQ,CAAC4P,KAAK,CAAC+B,OAAM,CAAC,GAAG,EAAE;;WAG5B,IAAIzc,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAAC6P,UAAU,CAAC8B,OAAM,CAAC,CAAC,EACjD;aACC3R,QAAQ,CAAC6P,UAAU,CAAC8B,OAAM,CAAC,GAAG,EAAE;;WAGjC,IAAMpd,GAAE,GACP,CAACW,cAAI,CAACqJ,WAAW,CAACyN,SAAS,CAAC7K,EAAE,CAAC,GAC5B6K,SAAS,CAAC7K,EAAE,GACZ6K,SAAS,CAACzX,EACb;WAED,IAAM6M,KAAI,GACT,CAAClM,cAAI,CAACqJ,WAAW,CAACyN,SAAS,CAACC,IAAI,CAAC,GAC9BD,SAAS,CAACC,IAAI,GACdD,SAAS,CAAC5K,IACb;WAED,IAAM3L,MAAK,eAAQlB,GAAE,CAAE;WAEvByL,QAAQ,CAAC4P,KAAK,CAAC+B,OAAM,CAAC,CAACjd,IAAI,CAACe,MAAK,CAAC;WAClCuK,QAAQ,CAACkJ,IAAI,CAACxU,IAAI,CAACe,MAAK,CAAC;WACzBuK,QAAQ,CAAC6P,UAAU,CAAC8B,OAAM,CAAC,CAACjd,IAAI,CAAC0M,KAAI,CAAC;;;OAIxC,KAAK,IAAMxL,KAAG,IAAI8L,gBAAgB,EAClC;SACC,IAAI,CAACA,gBAAgB,CAACxL,cAAc,CAACN,KAAG,CAAC,EACzC;WACC;;SAGD,IAAM+b,QAAM,GAAGjQ,gBAAgB,CAAC9L,KAAG,CAAC,CAACqL,IAAI;SACzC,IAAI/L,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAAC4P,KAAK,CAAC+B,QAAM,CAAC,CAAC,EAC5C;WACC3R,QAAQ,CAAC4P,KAAK,CAAC+B,QAAM,CAAC,GAAG,EAAE;;SAG5B,IAAMlc,OAAK,aAAMiM,gBAAgB,CAAC9L,KAAG,CAAC,CAACqL,IAAI,SAAGS,gBAAgB,CAAC9L,KAAG,CAAC,CAACuL,EAAE,CAAE;SAExEnB,QAAQ,CAAC4P,KAAK,CAAC+B,QAAM,CAAC,CAACjd,IAAI,CAACe,OAAK,CAAC;SAClCuK,QAAQ,CAACkJ,IAAI,CAACxU,IAAI,CAACe,OAAK,CAAC;;;;KAE1B;KAAA,0CAGD;OACC,OAAO;SACNmO,gBAAgB,EAAE,KAAK;SACvBQ,UAAU,EAAG3R,aAAG,CAACC,UAAU,CAAC,wCAAwC,CAAC,KAAK,GAAG,GAAG,KAAK,GAAG,IAAK;SAC7FwR,MAAM,EAAEzR,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC;SAC5CyR,UAAU,EAAE1R,aAAG,CAACC,UAAU,CAAC,wBAAwB,CAAC;SACpDiR,QAAQ,EAAE,KAAK;SACfM,cAAc,EAAE,KAAK;SACrBH,SAAS,EAAE,KAAK;SAChBD,QAAQ,EAAE,KAAK;SACf5J,GAAG,YAAKxH,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,4CAAmCD,aAAG,CAACmf,UAAU,CAAC,2CAA2C,CAAC,KAAK,GAAG,GAAG,gBAAgB,GAAG,oBAAoB;QACtM;;;KACD;KAAA,qCAEoB5R,QAAQ,EAAEqO,aAAa,EAAEzc,MAAM,EACpD;OACC,IAAMuc,MAAM,GAAGvc,MAAM,CAACuc,MAAM;OAC5B,IAAIjZ,cAAI,CAACqJ,WAAW,CAACyB,QAAQ,CAACmO,MAAM,CAAC,CAAC,EACtC;SACCnO,QAAQ,CAACmO,MAAM,CAAC,GAAG,EAAE;;OAGtB,IAAIjZ,cAAI,CAACqJ,WAAW,CAAC8P,aAAa,CAAC,EACnC;SACCA,aAAa,GAAG,EAAE;;OAGnB,KAAK,IAAMwD,MAAM,IAAI,IAAI,CAACnF,cAAc,CAAC7K,YAAY;OACrD;SACC,IAAI,CAAC,IAAI,CAAC6K,cAAc,CAAC7K,YAAY,CAAC3L,cAAc,CAAC2b,MAAM,CAAC,EAC5D;WACC;;SAGD,KAAK,IAAMC,MAAM,IAAIzD,aAAa,EAClC;WACC,IAAI,CAACA,aAAa,CAACnY,cAAc,CAAC4b,MAAM,CAAC,EACzC;aACC;;WAGD,IACC,IAAI,CAACpF,cAAc,CAAC7K,YAAY,CAACgQ,MAAM,CAAC,CAACtd,EAAE,IAAI8Z,aAAa,CAACyD,MAAM,CAAC,CAACvd,EAAE,IACpE,IAAI,CAACmY,cAAc,CAAC7K,YAAY,CAACgQ,MAAM,CAAC,CAACtd,EAAE,IAAI8Z,aAAa,CAACyD,MAAM,CAAC,CAAC3Q,EAAE,EAE3E;aACCnB,QAAQ,CAACmO,MAAM,CAAC,CAACzZ,IAAI,CAAC,IAAI,CAACgY,cAAc,CAAC7K,YAAY,CAACgQ,MAAM,CAAC,CAACtd,EAAE,CAAC;aAClE;;;;OAKH,IAAIyL,QAAQ,CAACmO,MAAM,CAAC,CAAC5X,MAAM,IAAI,CAAC,EAChC;SACCyJ,QAAQ,CAACmO,MAAM,CAAC,CAACzZ,IAAI,CAAC,OAAO,CAAC;;;;GAE/B;CAAA;;;ACjtBF,CAIoC,IAE9Bqd,WAAW;GAEhB,uBACA;KAAA;KAAA;KACC,IAAI,CAACC,gBAAgB,GAAG,KAAK;KAE7B,IAAI,SAAM,GAAG;OAEZC,KAAK,EAAE,oBAAoB;OAC3BC,cAAc,EAAE,8BAA8B;OAC9CC,WAAW,EAAE,2BAA2B;OAExCC,cAAc,EAAE,8BAA8B;OAC9CC,wBAAwB,EAAE,oCAAoC;OAC9DC,sBAAsB,EAAE,uCAAuC;OAC/DC,2BAA2B,EAAE,8CAA8C;OAC3EC,2BAA2B,EAAE,uCAAuC;OACpEC,8BAA8B,EAAE,kCAAkC;OAElEC,0BAA0B,EAAE,kCAAkC;OAE9D7J,IAAI,EAAE,YAAY;OAElB8J,cAAc,EAAE,mBAAmB;OACnCC,iBAAiB,EAAE,uBAAuB;OAE1CC,mBAAmB,EAAE,wBAAwB;OAC7CC,mBAAmB,EAAE,wBAAwB;OAC7CC,qBAAqB,EAAE,2BAA2B;OAClDC,kBAAkB,EAAE,uBAAuB;OAE3CC,WAAW,EAAE,0BAA0B;OACvCC,iBAAiB,EAAE;MACnB;KAED,IAAI,CAAC9iB,IAAI,EAAE;KACXC,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,YAAM;OACpD,KAAI,CAACF,IAAI,EAAE;MACX,CAAC;;GACF;KAAA;KAAA,uBAGD;OAAA;OACC,IAAM6hB,KAAK,GAAG3gB,QAAQ,CAAC6hB,aAAa,YAAK,IAAI,SAAM,CAAClB,KAAK,EAAG;OAC5D,IACC,CAACA,KAAK,IACH,IAAI,CAACD,gBAAgB,EAEzB;SACC;;OAGD,IAAI,CAACA,gBAAgB,GAAG,IAAI;OAE5B,IAAI,CAACoB,yBAAyB,EAAE;OAChC,IAAMhB,cAAc,GAAG9gB,QAAQ,CAAC6hB,aAAa,YAAK,IAAI,SAAM,CAACf,cAAc,EAAG;OAC9E,IAAIA,cAAc,EAClB;SACCA,cAAc,CAAC1hB,gBAAgB,CAAC,UAAU,EAAE,UAACoC,CAAC,EAAK;WAClD,MAAI,CAACugB,yBAAyB,EAAE;WAEhCvgB,CAAC,CAACkJ,eAAe,EAAE;WACnB,OAAOlJ,CAAC,CAACiJ,cAAc,EAAE;UACzB,CAAC;;;;KAEH;KAAA,6BAGD;OACC,IAAI,CAACiW,gBAAgB,GAAG,KAAK;;;KAC7B;KAAA,qCAGD;OACC,OAAO1gB,QAAQ,CAAC6hB,aAAa,CAAC,8BAA8B,CAAC;;;KAC7D;KAAA,kCAGD;OAAA,IADanU,IAAI,QAAJA,IAAI;OAEhB,IAAI,IAAI,CAACsU,aAAa,EAAE,GAAG,CAAC,EAC5B;SACC,IAAI,CAACC,kBAAkB,EAAE,CAAC9hB,SAAS,CAACC,GAAG,WAAI,IAAI,SAAM,CAACygB,WAAW,EAAG;QACpE,MAED;SACC,IAAI,CAACoB,kBAAkB,EAAE,CAAC9hB,SAAS,CAACE,MAAM,WAAI,IAAI,SAAM,CAACwgB,WAAW,EAAG;;OAGxE,IAAI,CAACqB,yBAAyB,CAAC;SAACxU,IAAI,EAAJA;QAAK,CAAC;;;KACtC;KAAA,iDAGD;OAAA,IAD2BA,IAAI,SAAJA,IAAI;OAE9B,IAAI,IAAI,CAACsU,aAAa,EAAE,IAAI7gB,aAAG,CAACC,UAAU,CAAC,wDAAwD,CAAC,EACpG;SACC,IACCsM,IAAI,KAAK,QAAQ,IACd,IAAI,CAACuU,kBAAkB,EAAE,CAAC9hB,SAAS,CAACoJ,QAAQ,WAAI,IAAI,SAAM,CAACqX,cAAc,EAAG,EAEhF;WACC,IAAI,CAACqB,kBAAkB,EAAE,CAAC9hB,SAAS,CAACC,GAAG,WAAI,IAAI,SAAM,CAACwgB,cAAc,EAAG;;QAExE,MAED;SACC,IAAI,CAACqB,kBAAkB,EAAE,CAAC9hB,SAAS,CAACE,MAAM,WAAI,IAAI,SAAM,CAACugB,cAAc,EAAG;;OAG3E,IAAI,CAACkB,yBAAyB,EAAE;;;KAChC;KAAA,4CAGD;OACC,IAAI,CAACG,kBAAkB,EAAE,CAAC9hB,SAAS,CAACE,MAAM,WAAI,IAAI,SAAM,CAACugB,cAAc,EAAG;;;KAC1E;KAAA,gCAGD;OACC,OAAO9H,KAAK,CAACqJ,IAAI,CAAC,IAAI,CAACF,kBAAkB,EAAE,CAACG,sBAAsB,WAAI,IAAI,SAAM,CAAC7K,IAAI,EAAG,CAAC,CAACtS,MAAM;;;KAChG;KAAA,4CAGD;OACC,IAAMod,YAAY,GAAG,IAAI,CAACL,aAAa,EAAE;OACzC,IAAMM,gBAAgB,GAAG,IAAI,CAACL,kBAAkB,EAAE,CAACJ,aAAa,YAAK,IAAI,SAAM,CAACd,wBAAwB,EAAG;OAE3G,IAAIuB,gBAAgB,EACpB;SACCA,gBAAgB,CAACthB,SAAS,GAAGR,QAAQ,CAAC6hB,YAAY,CAAC;;OAGpD,IAAME,mBAAmB,GAAG,IAAI,CAACN,kBAAkB,EAAE,CAACJ,aAAa,YAAK,IAAI,SAAM,CAACb,sBAAsB,EAAG;OAC5G,IAAMwB,wBAAwB,GAAG,IAAI,CAACP,kBAAkB,EAAE,CAACJ,aAAa,YAAK,IAAI,SAAM,CAACX,2BAA2B,EAAG;OAEtH,IACCqB,mBAAmB,IAChBC,wBAAwB,EAE5B;SACC,IAAMC,iBAAiB,GAAG3J,KAAK,CAACqJ,IAAI,CAAC,IAAI,CAACF,kBAAkB,EAAE,CAACS,gBAAgB,YAAK,IAAI,SAAM,CAACvB,8BAA8B,EAAG,CAAC,CAACwB,MAAM,CAAC,UAACC,GAAG,EAAE5b,IAAI,EAAK;WACvJ,OAAO4b,GAAG,GAAGpiB,QAAQ,CAACwG,IAAI,CAAChG,SAAS,CAAC;UACrC,EAAE,CAAC,CAAC;SAELwhB,wBAAwB,CAACxhB,SAAS,GAAG,GAAG,GAAGyhB,iBAAiB;SAC5D,IAAIA,iBAAiB,GAAG,CAAC,EACzB;WACCF,mBAAmB,CAACpiB,SAAS,CAACC,GAAG,WAAI,IAAI,SAAM,CAAC6gB,2BAA2B,EAAG;UAC9E,MAED;WACCsB,mBAAmB,CAACpiB,SAAS,CAACE,MAAM,WAAI,IAAI,SAAM,CAAC4gB,2BAA2B,EAAG;;;;;KAGnF;KAAA,8BAEa3gB,MAAM,EACpB;OACC,IAAM8H,KAAK,GAAI9H,MAAM,CAAC8H,KAAK,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAE;OAEzD,IAAIA,KAAK,IAAI,CAAC,EACd;SACC,OAAO8O,OAAO,CAACE,MAAM,EAAE;;OAGxB,OAAO,IAAIF,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;SACvC3N,gBAAI,CAACC,SAAS,CAAC,gDAAgD,EAAE;WAChEhF,IAAI,EAAE;aACLpE,MAAM,EAAE;eACP8H,KAAK,EAAEA;;YAER;WACDya,OAAO,EAAE,CACR;aACC/S,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;aACnE+C,KAAK,EAAE7D,MAAM,CAACwiB,WAAW,IAAI;YAC7B,EACD;aACChT,IAAI,EAAE3O,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;aAClE+C,KAAK,EAAE7D,MAAM,CAACyiB,UAAU,IAAI;YAC5B;UAEF,CAAC,CAACjZ,IAAI,CAAC,UAACC,QAAQ,EAAK;WACrB,IAAIA,QAAQ,CAACiZ,MAAM,KAAK,SAAS,EACjC;aACC7L,OAAO,CAACpN,QAAQ,CAACrF,IAAI,CAAC;YACtB,MAED;aACC0S,MAAM,CAACrN,QAAQ,CAACkZ,MAAM,CAAC;;UAExB,EAAE,UAAClZ,QAAQ,EAAK;WAChBqN,MAAM,EAAE;UACR,CAAC;QACF,CAAC;;;KACF;KAAA,mCAOD;OAAA;OAAA,IAJChP,KAAK,SAALA,KAAK;SACL0C,QAAQ,SAARA,QAAQ;SACRoY,aAAa,SAAbA,aAAa;OAGb,IAAMC,eAAe,GAAG,IAAI,CAAClB,kBAAkB,EAAE;OAEjD,IACC,CAACre,cAAI,CAAC4C,SAAS,CAACsE,QAAQ,CAAC,IACtB,CAAClH,cAAI,CAAC4C,SAAS,CAAC2c,eAAe,CAAC,EAEpC;SACC;;OAGD,IAAM5B,mBAAmB,GAAGzW,QAAQ,CAAC+W,aAAa,YAAK,IAAI,SAAM,CAACN,mBAAmB,EAAG;OAExF,IAAI,CAAC3d,cAAI,CAAC4C,SAAS,CAAC+a,mBAAmB,CAAC,EACxC;SACC;;OAGDzW,QAAQ,CAAC3K,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACihB,cAAc,CAAC;OACjDvW,QAAQ,CAAC3K,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACkhB,iBAAiB,CAAC;OAEpDC,mBAAmB,CAACvgB,SAAS,aAAO4C,cAAI,CAACE,cAAc,CAACof,aAAa,CAACjT,KAAK,CAAC,0BAAkB,IAAI,SAAM,CAACuR,mBAAmB,gBAAK0B,aAAa,CAACjT,KAAK,cAAW,EAAE,0BAAgB,IAAI,SAAM,CAACwR,qBAAqB,6BAAiB,IAAI,SAAM,CAACC,kBAAkB,gBAAKwB,aAAa,CAACE,WAAW,iBAAc;OAE3S,IAAMC,iBAAiB,GAAG9b,aAAG,CAACC,MAAM,qbAAe,IAAI,SAAM,CAACma,WAAW,EAAuBvZ,KAAK,EAErDjH,aAAG,CAACC,UAAU,CAAC,8CAA8C,CAAC,EAC9DD,aAAG,CAACC,UAAU,CAAC,oDAAoD,CAAC,EAEnD,IAAI,SAAM,CAACwgB,iBAAiB,EAAKzgB,aAAG,CAACC,UAAU,CAAC,+CAA+C,CAAC,CAC1J;OAEP,IAAM+b,YAAY,GAAGkG,iBAAiB,CAACxB,aAAa,YAAK,IAAI,SAAM,CAACD,iBAAiB,EAAG;OACxFzE,YAAY,CAAC/d,gBAAgB,CAAC,UAAU,EAAE,UAAC0H,KAAK,EAAK;SAEpD,IAAM6a,WAAW,GAAG7a,KAAK,CAACwc,aAAa,CAACvY,OAAO,YAAK,MAAI,SAAM,CAAC4W,WAAW,EAAG;SAC7E,IAAI,CAACA,WAAW,EAChB;WACC;;SAGD,IAAMvZ,KAAK,GAAG5H,QAAQ,CAACmhB,WAAW,CAACtY,YAAY,CAAC,kBAAkB,CAAC,CAAC;SACpE,IAAIjB,KAAK,IAAI,CAAC,EACd;WACC;;SAGD,IAAM0C,QAAQ,GAAG9K,QAAQ,CAAC6hB,aAAa,YAAK,MAAI,SAAM,CAACtK,IAAI,iCAAsBnP,KAAK,SAAK;SAC3F,IAAI,CAAC0C,QAAQ,EACb;WACC;;SAGD,IAAMH,QAAQ,GAAGG,QAAQ,CAAC+W,aAAa,CAAC,yBAAyB,CAAC;SAClE,IAAI,CAAClX,QAAQ,EACb;WACC;;SAGD,IAAMoH,YAAY,GAAG,IAAI/J,OAAI,CAAC;WAC7BI,KAAK,EAALA;UACA,CAAC;SAEF,OAAO2J,YAAY,CAACC,SAAS,CAAC;WAC7BrH,QAAQ,EAAEA,QAAQ;WAClBC,OAAO,EAAE;UACT,CAAC;QACF,CAAC;OAEFE,QAAQ,CAACyY,UAAU,CAACC,YAAY,CAACH,iBAAiB,EAAEvY,QAAQ,CAAC;OAC7DrD,aAAG,CAACgc,OAAO,CAAC3Y,QAAQ,EAAEqY,eAAe,CAAC;OAEtC,IAAI,CAACO,WAAW,CAAC;SAChBhW,IAAI,EAAE;QACN,CAAC;OACFrO,YAAY,CAACiH,QAAQ,EAAE;;;KACvB;KAAA,oCAOD;OAAA,IAJC8B,KAAK,SAALA,KAAK;SACL0C,QAAQ,SAARA,QAAQ;SACRvE,aAAa,SAAbA,aAAa;OAGb,IAAM4c,eAAe,GAAG,IAAI,CAAClB,kBAAkB,EAAE;OAEjD,IACC,CAACre,cAAI,CAAC4C,SAAS,CAACsE,QAAQ,CAAC,IACtB,CAAClH,cAAI,CAAC4C,SAAS,CAACD,aAAa,CAAC,IAC9B,CAAC3C,cAAI,CAAC4C,SAAS,CAAC2c,eAAe,CAAC,IAChCrY,QAAQ,CAACyY,UAAU,KAAKJ,eAAe,IACvC3iB,QAAQ,CAAC4H,KAAK,CAAC,IAAI,CAAC,EAExB;SACC;;OAGD0C,QAAQ,CAAC3K,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACghB,cAAc,CAAC;OACpDvW,QAAQ,CAAC3K,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACihB,iBAAiB,CAAC;OAEvD,IAAMK,WAAW,GAAG3hB,QAAQ,CAAC6hB,aAAa,YAAK,IAAI,SAAM,CAACF,WAAW,iCAAsBnhB,QAAQ,CAAC4H,KAAK,CAAC,SAAK;OAC/G,IAAIuZ,WAAW,EACf;SACCA,WAAW,CAAC4B,UAAU,CAACC,YAAY,CAAC1Y,QAAQ,EAAE6W,WAAW,CAAC;SAC1Dla,aAAG,CAACpH,MAAM,CAACshB,WAAW,CAAC;QACvB,MAED;SACCla,aAAG,CAACgc,OAAO,CAAC3Y,QAAQ,EAAEvE,aAAa,CAAC;;OAGrC,IAAI,CAACmd,WAAW,CAAC;SAChBhW,IAAI,EAAE;QACN,CAAC;;;GACF;CAAA;;CChU4C,IAExCiW,MAAM;GAAA;GAEX,kBACA;KAAA;KAAA;KACC;KACA,MAAK7kB,IAAI,EAAE;KAAC;;GACZ;KAAA;KAAA,uBAGD;OACC,IAAI,CAACoH,iBAAiB,CAAC,oBAAoB,CAAC;OAC5C,IAAI,CAAClH,SAAS,CAAC,YAAY,EAAE,IAAI,CAAC4kB,UAAU,CAAC1f,IAAI,CAAC,IAAI,CAAC,CAAC;;;KACxD;KAAA,6BAGD;OACC,IAAI,CAACuC,MAAM,CAACod,IAAI,EAChB;SACC;;OAGD9e,MAAM,CAACC,IAAI,CAACyB,MAAM,CAACod,IAAI,CAAC,CAAC1hB,OAAO,CAAC,UAACmC,GAAG,EAAK;SACzC,IACCA,GAAG,KAAK,SAAS,IACdA,GAAG,KAAK,QAAQ,EAEpB;WACC,OAAOmC,MAAM,CAACod,IAAI,CAACvf,GAAG,CAAC;;QAExB,CAAC;;;GACF;CAAA,EA9BmBvF,6BAAY;;CCDA,IAE3B+kB,gBAAgB;GAErB,4BACA;KAAA;;GAEC;KAAA;KAAA,4BAEW9c,IAAI,EAChB;OAAA;OACC,IACC,CAACpD,cAAI,CAAC4C,SAAS,CAACQ,IAAI,CAAC,IAClBA,IAAI,CAAC+c,YAAY,CAAC,MAAM,CAAC,EAE7B;SACC,OAAO,KAAK;;OAGb,IAAMrb,MAAM,GAAGlI,QAAQ,CAACwG,IAAI,CAACqC,YAAY,CAAC,iBAAiB,CAAC,CAAC;OAC7D,IAAIX,MAAM,IAAI,CAAC,EACf;SACC,OAAO,KAAK;;OAGb,IAAI,CAACsb,UAAU,CAAC;SACfhd,IAAI,EAAEA,IAAI;SACV7C,KAAK,EAAE;QACP,CAAC;OAEFsF,gBAAI,CAACC,SAAS,CAAC,oDAAoD,EAAE;SACpEhF,IAAI,EAAE;WACLpE,MAAM,EAAE;aACP2jB,OAAO,EAAGvb;;;QAGZ,CAAC,CAACoB,IAAI,CAAC,UAACC,QAAQ,EAAK;SACrB,IACC,CAACnG,cAAI,CAACE,cAAc,CAACiG,QAAQ,CAACrF,IAAI,CAACsF,OAAO,CAAC,IACxCD,QAAQ,CAACrF,IAAI,CAACsF,OAAO,KAAK,GAAG,EAEjC;WACC,KAAI,CAACga,UAAU,CAAC;aACfhd,IAAI,EAAEA,IAAI;aACV7C,KAAK,EAAE;YACP,CAAC;UACF,MAED;WACC7B,WAAW,CAACgI,aAAa,CAAC,uBAAuB,EAAE;aAClD5B,MAAM,EAAEA;YACR,EAAE,IAAI,CAAC;;QAET,EAAE,UAACqB,QAAQ,EAAK;SAChB,KAAI,CAACia,UAAU,CAAC;WACfhd,IAAI,EAAEA,IAAI;WACV7C,KAAK,EAAE;UACP,CAAC;QACF,CAAC;OAEF,OAAO,IAAI;;;KACX;KAAA,2BAEU7D,MAAM,EACjB;OACC,IACC,CAACsD,cAAI,CAACsgB,QAAQ,CAAC5jB,MAAM,CAAC,IACnB,CAACsD,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAAC0G,IAAI,CAAC,EAEhC;SACC;;OAGD,IAAMA,IAAI,GAAG1G,MAAM,CAAC0G,IAAI;OACxB,IAAM7C,KAAK,GAAG,CAAC,CAAC7D,MAAM,CAAC6D,KAAK;OAE5B,IAAIA,KAAK,EACT;SACC6C,IAAI,CAACmd,OAAO,GAAG,IAAI;SACnBnd,IAAI,CAACwC,YAAY,CAAC,MAAM,EAAE,GAAG,CAAC;SAC9BnD,eAAK,CAAC+d,SAAS,CAACpd,IAAI,CAAC;QACrB,MAED;SACCA,IAAI,CAACmd,OAAO,GAAG,KAAK;SACpB,OAAOnd,IAAI,CAACmd,OAAO;SACnBnd,IAAI,CAACqd,eAAe,CAAC,MAAM,CAAC;;OAG7B,IAAM/e,SAAS,GAAG0B,IAAI,CAAC+D,OAAO,CAAC,sBAAsB,CAAC;OACtD,IAAI,CAACzF,SAAS,EACd;SACC;;OAGD,IAAMgf,QAAQ,GAAGhf,SAAS,CAACuc,aAAa,CAAC,2BAA2B,CAAC;OACrE,IAAI,CAACyC,QAAQ,EACb;SACC;;OAGDA,QAAQ,CAACnkB,SAAS,CAACC,GAAG,CAAC,+BAA+B,CAAC;;;GACvD;CAAA;;CCpGuD,IAEnDmkB,SAAS;GAAA;GAEd,qBACA;KAAA;KAAA;KACC;KACA,MAAKC,YAAY,GAAG,KAAK;KACzB,MAAKC,cAAc,GAAG,CAAC;KACvB,MAAKC,aAAa,GAAG,KAAK;KAAC;;GAC3B;KAAA;KAAA,qBAEIpkB,MAAM,EACX;OAAA;OACC,IAAI+K,kBAAkB,CAACC,aAAa,EAAE,GAAGzK,QAAQ,CAACyK,aAAa,CAAC,UAAU,CAAC,EAC3E;SACC;;OAGD,IAAI1H,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,IAAIE,QAAQ,CAACF,MAAM,CAACmkB,cAAc,CAAC,GAAG,CAAC,EACrE;SACC,IAAI,CAACA,cAAc,GAAGjkB,QAAQ,CAACF,MAAM,CAACmkB,cAAc,CAAC;;OAGtD,IAAI,CAACzlB,SAAS,CAAC,gCAAgC,EAAE,IAAI,CAAC2lB,sBAAsB,CAACzgB,IAAI,CAAC,IAAI,CAAC,CAAC;OACxF,IAAI,CAAClF,SAAS,CAAC,gCAAgC,EAAE,IAAI,CAAC2lB,sBAAsB,CAACzgB,IAAI,CAAC,IAAI,CAAC,CAAC;OACxFnF,6BAAY,CAACC,SAAS,CAAC,+CAA+C,EAAE,IAAI,CAAC4lB,gBAAgB,CAAC1gB,IAAI,CAAC,IAAI,CAAC,CAAC;OACzGnF,6BAAY,CAACC,SAAS,CAAC,iDAAiD,EAAE,IAAI,CAAC6lB,kBAAkB,CAAC3gB,IAAI,CAAC,IAAI,CAAC,CAAC;OAE7G5B,WAAW,CAACC,EAAE,CAACyS,IAAI,CAAC1U,MAAM,CAACwkB,GAAG,CAAC;SAC9BC,YAAY,EAAE;QACd,CAAC;OAEFtlB,GAAG,CAACC,IAAI,CAAC,oBAAoB,EAAE;SAC9BY,MAAM,EAAE;WACPkE,QAAQ,EAAE,kBAACsC,KAAK,EAAK;aACpB,IACCA,KAAK,CAACiP,SAAS,KAAK,uBAAuB,IACxCnS,cAAI,CAACC,aAAa,CAACiD,KAAK,CAACpC,IAAI,CAAC,IAC9Bd,cAAI,CAACE,cAAc,CAACgD,KAAK,CAACpC,IAAI,CAAC1C,IAAI,CAAC,EAExC;eACC,IAAI8E,KAAK,CAACpC,IAAI,CAAC1C,IAAI,CAACiD,MAAM,IAAI,MAAI,CAACwf,cAAc,EACjD;iBACC,MAAI,CAACD,YAAY,GAAG,IAAI;;eAGzB,MAAI,CAACQ,IAAI,CAAC,gCAAgC,EAAE,IAAIC,0BAAS,CAAC;iBACzDvgB,IAAI,EAAE;mBACL1C,IAAI,EAAE8E,KAAK,CAACpC,IAAI,CAAC1C;;gBAElB,CAAC,CAAC;cACH,MACI,IAAI,CAAE,uBAAuB,EAAE,cAAc,CAAE,CAAC4N,QAAQ,CAAC9I,KAAK,CAACiP,SAAS,CAAC,EAC9E;eACC,MAAI,CAACiP,IAAI,CAAC,gCAAgC,EAAE,IAAIC,0BAAS,CAAC;iBACzDvgB,IAAI,EAAE;gBACN,CAAC,CAAC;;;;QAIN,CAAC;;;KACF;KAAA,uCAEsBoC,KAAK,EAC5B;OAAA;OACC,IAAMoe,SAAS,GAAGpe,KAAK,CAAC2H,OAAO,EAAE;OACjC,IAAMzM,IAAI,GAAI4B,cAAI,CAACC,aAAa,CAACqhB,SAAS,CAAC,IAAIthB,cAAI,CAACE,cAAc,CAACohB,SAAS,CAACljB,IAAI,CAAC,GAAGkjB,SAAS,CAACljB,IAAI,GAAG,EAAG;OAEzG,IAAIA,IAAI,CAACiD,MAAM,IAAI,IAAI,CAACwf,cAAc,EACtC;SACChlB,GAAG,CAACC,IAAI,CAAC,uBAAuB,CAAC;SACjC,IAAI,CAACylB,gBAAgB,CAACnjB,IAAI,CAAC;QAC3B,MAED;SACC,IAAI,IAAI,CAACwiB,YAAY,EACrB;WACC,IAAI,CAAC,IAAI,CAACE,aAAa,EACvB;aACC3lB,6BAAY,CAACimB,IAAI,CAAC,qCAAqC,CAAC;;WAGzD,IAAI3P,EAAE,CAAC+P,UAAU,EACjB;aACC3lB,GAAG,CAACC,IAAI,CAAC,uBAAuB,CAAC;aAEjC2V,EAAE,CAAC+P,UAAU,CAACC,eAAe,CAAC,uBAAuB,EAAE,UAAC/kB,MAAM,EAAK;eAElE,IAAMgF,SAAS,GAAGtF,QAAQ,CAACC,cAAc,CAAC,wBAAwB,CAAC;eACnE,IACC,CAAC2D,cAAI,CAAC0R,OAAO,CAAChV,MAAM,CAACyU,KAAK,CAAC,IACxB,CAACzP,SAAS,EAEd;iBACC,MAAI,CAAC6f,gBAAgB,EAAE;iBACvB;;eAGD,IAAMG,KAAK,GAAGhlB,MAAM,CAACyU,KAAK,CAACwQ,IAAI,CAAC,UAAAvP,IAAI,EAAI;iBACvC,OACCpS,cAAI,CAACE,cAAc,CAACkS,IAAI,CAACnG,EAAE,CAAC,IACzBmG,IAAI,CAACnG,EAAE,KAAK,uBAAuB;gBAEvC,CAAC;eAEF,IAAIjM,cAAI,CAACqJ,WAAW,CAACqY,KAAK,CAAC,EAC3B;iBACC;;eAGDE,iBAAO,CAACC,IAAI,CAACngB,SAAS,EAAEggB,KAAK,CAACI,OAAO,CAAC,CAAC5b,IAAI,CAAC,YAAM;iBACjDuL,EAAE,CAACsQ,WAAW,CAACL,KAAK,CAACI,OAAO,EAAE,IAAI,CAAC;gBACnC,CAAC;eAEF1d,OAAI,CAAC4d,OAAO,EAAE;eAEdze,UAAU,CAAC,YAAM;iBAChB0e,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE;gBAClC,EAAE,IAAI,CAAC;cACR,CAAC;YACF,MAED;aACC,IAAI,CAACZ,gBAAgB,EAAE;;;SAIzB,IAAI,CAACX,YAAY,GAAG,KAAK;;;;KAE1B;KAAA,mCAGD;OACC,IAAI,CAACE,aAAa,GAAG,IAAI;;;KACzB;KAAA,qCAGD;OACC,IAAI,CAACA,aAAa,GAAG,KAAK;;;KAC1B;KAAA,iCAGgB1iB,IAAI,EACrB;OACC,IAAI3C,YAAY,CAAC2mB,UAAU,EAC3B;SACC;;OAGDhkB,IAAI,GAAGA,IAAI,IAAI,EAAE;OAEjB,IAAM8E,KAAK,GAAG,IAAIme,0BAAS,CAAC;SAC3BgB,UAAU,EAAE,CAAC;WACZjkB,IAAI,EAAEA;UACN;QACD,CAAC;OACFjD,6BAAY,CAACimB,IAAI,CAAC,qCAAqC,EAAEle,KAAK,CAAC;;;GAC/D;CAAA,EA5JsB/H,6BAAY;;CCLJ,IAE1BmnB,UAAU;GAEf,sBACA;KAAA;KACC,IAAI,CAACC,oBAAoB,GAAG,IAAI;KAChC,IAAI,CAACC,uBAAuB,GAAG,IAAI;KACnC,IAAI,CAACC,sBAAsB,GAAG,KAAK;KACnC,IAAI,CAACC,mBAAmB,GAAG,KAAK;KAEhC,IAAI,SAAM,GAAG;OACZC,YAAY,EAAE,2BAA2B;OACzCC,eAAe,EAAE,+BAA+B;OAChDC,kBAAkB,EAAE,kCAAkC;OACtDC,qBAAqB,EAAE,sCAAsC;OAC7DC,wBAAwB,EAAE;MAC1B;KAED,IAAI,CAAC7nB,IAAI,EAAE;;GACX;KAAA;KAAA,uBAGD;OACC,IAAI2H,MAAM,CAACkX,QAAQ,KAAK,KAAK,EAC7B;SACC;;OAGD3d,QAAQ,CAACZ,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAACwnB,cAAc,CAAC1iB,IAAI,CAAC,IAAI,CAAC,CAAC;;;KACnE;KAAA,iCAGD;OAAA;OACC,IAAI,CAAC,IAAI,CAACiiB,oBAAoB,EAC9B;SACC;;OAGDU,YAAY,CAAC,IAAI,CAACT,uBAAuB,CAAC;OAC1C,IAAI,CAACA,uBAAuB,GAAGjf,UAAU,CAAC,YAAM;SAC/CtG,QAAQ,CAACimB,mBAAmB,EAAE;SAC9B,KAAI,CAACC,iBAAiB,EAAE;QACxB,EAAE,GAAG,CAAC;;;KACP;KAAA,oCAGD;OACC,IAAMC,SAAS,GAAGvgB,MAAM,CAACwgB,OAAO,CAAC;OACjC,IAAMC,SAAS,GAAIlnB,QAAQ,CAACmnB,eAAe,CAAChf,YAAY,GAAG1B,MAAM,CAAC2gB,WAAW,GAAG,GAAI,CAAC;;OAErF,IAAI,CAACf,sBAAsB,GAAG,EAC3BrmB,QAAQ,CAACmnB,eAAe,CAAChf,YAAY,GAAG1B,MAAM,CAAC2gB,WAAW,IAAK,CAAC;UAEjEJ,SAAS,IAAIE,SAAS;WAErBF,SAAS,GAAG,CAAC;UACVE,SAAS,GAAG,CAAC,CAEjB,CACD;OAED,IAAI,CAACZ,mBAAmB,GAAIU,SAAS,GAAG,GAAI;OAC5C,IAAI,CAACK,oBAAoB,EAAE;;;KAC3B;KAAA,uCAGD;OACC,IAAMC,sBAAsB,GAAGtnB,QAAQ,CAAC6hB,aAAa,YAAK,IAAI,SAAM,CAAC4E,kBAAkB,EAAG;OAC1F,IAAMc,mBAAmB,GAAGvnB,QAAQ,CAAC6hB,aAAa,YAAK,IAAI,SAAM,CAAC2E,eAAe,EAAG;OAEpF,IAAIc,sBAAsB,EAC1B;SACC,IAAI,IAAI,CAACjB,sBAAsB,EAC/B;WACC,IAAI,CAACiB,sBAAsB,CAACnnB,SAAS,CAACoJ,QAAQ,WAAI,IAAI,SAAM,CAACod,wBAAwB,EAAG,EACxF;aACCW,sBAAsB,CAACnnB,SAAS,CAACC,GAAG,WAAI,IAAI,SAAM,CAACumB,wBAAwB,EAAG;;UAE/E,MAED;WACC,IAAIW,sBAAsB,CAACnnB,SAAS,CAACoJ,QAAQ,WAAI,IAAI,SAAM,CAACod,wBAAwB,EAAG,EACvF;aACCW,sBAAsB,CAACnnB,SAAS,CAACE,MAAM,WAAI,IAAI,SAAM,CAACsmB,wBAAwB,EAAG;;;;OAKpF,IAAIY,mBAAmB,EACvB;SACC,IAAI,IAAI,CAACjB,mBAAmB,EAC5B;WACC,IAAI,CAACiB,mBAAmB,CAACpnB,SAAS,CAACoJ,QAAQ,WAAI,IAAI,SAAM,CAACmd,qBAAqB,EAAG,EAClF;aACCa,mBAAmB,CAACpnB,SAAS,CAACC,GAAG,WAAI,IAAI,SAAM,CAACsmB,qBAAqB,EAAG;;UAEzE,MAED;WACC,IAAIa,mBAAmB,CAACpnB,SAAS,CAACoJ,QAAQ,WAAI,IAAI,SAAM,CAACmd,qBAAqB,EAAG,EACjF;aACCa,mBAAmB,CAACpnB,SAAS,CAACE,MAAM,WAAI,IAAI,SAAM,CAACqmB,qBAAqB,EAAG;;;;;;KAI9E;KAAA,yBAEQhZ,IAAI,EACb;OAAA;OACC,IAAIA,IAAI,KAAK,KAAK,EAClB;SACCA,IAAI,GAAG,QAAQ;;OAGhB,IAAI,CAACyY,oBAAoB,GAAG,KAAK;OACjC,IAAI,CAACE,sBAAsB,GAAG,KAAK;OACnC,IAAI,CAACC,mBAAmB,GAAG,KAAK;OAEhC,IAAI,CAACe,oBAAoB,EAAE;OAE3B,IAAMG,UAAU,GAAG/gB,MAAM,CAACwgB,OAAO,CAAC;OAClC,IAAMQ,WAAW,GAAI/Z,IAAI,IAAI,QAAQ,GAAG1N,QAAQ,CAACmnB,eAAe,CAAChf,YAAY,GAAG,CAAE;OAElFuf,eAAe,CAACC,OAAO,CAAC;SACvBC,QAAQ,EAAG,GAAG;SACdC,KAAK,EAAG;WAAEC,MAAM,EAAGN;UAAY;SAC/BO,MAAM,EAAG;WAAED,MAAM,EAAGL;UAAa;SACjCO,UAAU,EAAGN,eAAe,CAACO,WAAW,CAACP,eAAe,CAACQ,WAAW,CAACC,KAAK,CAAC;SAC3EC,IAAI,EAAG,cAASC,KAAK,EACrB;WACC5hB,MAAM,CAACwB,QAAQ,CAAC,CAAC,EAAEogB,KAAK,CAACP,MAAM,CAAC;UAChC;SACDQ,QAAQ,EAAG,oBAAM;WAChB,MAAI,CAACnC,oBAAoB,GAAG,IAAI;WAChC,MAAI,CAACY,iBAAiB,EAAE;;QAEzB,CAAC;;;GACF;CAAA;;CCxI+C,IAE3CwB,aAAa;GAElB,yBACA;KAAA;KACC,IAAI,CAACC,YAAY,GAAG,IAAI;KACxB,IAAI,CAACrkB,KAAK,GAAG,IAAI;KAEjB,IAAI,SAAM,GAAG;OACZskB,cAAc,EAAE,kBAAkB;OAClCC,oBAAoB,EAAE;MACtB;;GACD;KAAA;KAAA,uBAGD;;KACC;KAAA,0BAESpoB,MAAM,EAChB;OAAA;OACC,IAAM8H,KAAK,GAAI,CAACxE,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAAC8H,KAAK,CAAC,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAE;OAC5E,IAAMR,MAAM,GAAI,CAAChE,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACsH,MAAM,CAAC,GAAGtH,MAAM,CAACsH,MAAM,GAAG,KAAM;OACzE,IAAM+gB,QAAQ,GAAI,CAAC/kB,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAAC8J,SAAS,CAAC,GAAG9J,MAAM,CAAC8J,SAAS,GAAG,IAAK;OAChF,IAAMwe,OAAO,GAAI,CAAChlB,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAAC+J,KAAK,CAAC,GAAG/J,MAAM,CAAC+J,KAAK,GAAG,KAAM;OAExE,IAAIwe,UAAU,GAAI,OAAOvoB,MAAM,CAAC6J,OAAO,IAAI,WAAW,GAAG7J,MAAM,CAAC6J,OAAO,GAAG,KAAM;OAChF,IAAI0e,UAAU,IAAI,IAAI,EACtB;SACCA,UAAU,GAAG,KAAK;;OAGnB,IAAIle,QAAQ,GAAG,IAAI;OACnB,IAAI/G,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAACqK,QAAQ,CAAC,EACnC;SACCA,QAAQ,GAAGrK,MAAM,CAACqK,QAAQ;QAC1B,MACI,IAAI/G,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACqK,QAAQ,CAAC,EAC7C;SACCA,QAAQ,GAAG3K,QAAQ,CAACC,cAAc,CAACK,MAAM,CAACqK,QAAQ,CAAC;;OAGpD,IAAI,CAACA,QAAQ,EACb;SACCA,QAAQ,GAAG3K,QAAQ,CAACC,cAAc,0BAAmBmI,KAAK,EAAG;;OAG9D,IAAI0gB,WAAW,GAAG9oB,QAAQ,CAACC,cAAc,4BAAqBmI,KAAK,EAAG;OACtE,IAAI,CAAC0gB,WAAW,EAChB;SACCA,WAAW,GAAG9oB,QAAQ,CAACC,cAAc,oBAAoB;;OAG1D,IAAI8oB,UAAU,GAAG/oB,QAAQ,CAACC,cAAc,8BAAuBmI,KAAK,EAAG;OACvE,IAAI,CAAC2gB,UAAU,EACf;SACCA,UAAU,GAAG/oB,QAAQ,CAACC,cAAc,sBAAsB;;OAG3D,IAAImJ,QAAQ,GAAG,IAAI;OACnB,IAAIuB,QAAQ,EACZ;SACCvB,QAAQ,GAAIuB,QAAQ,CAACtB,YAAY,CAAC,aAAa,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,GAAI;QACrE,MACI,IAAIyf,WAAW,EACpB;SACC1f,QAAQ,GAAI0f,WAAW,CAACzf,YAAY,CAAC,aAAa,CAAC,IAAI,GAAG,GAAG,GAAG,GAAG,GAAI;QACvE,MAED;SACC,OAAO,KAAK;;OAGb,IAAMC,QAAQ,GAAIF,QAAQ,KAAK,GAAG,GAAG,GAAG,GAAG,GAAI;OAE/C,IACC,CACC,CAACxF,cAAI,CAACE,cAAc,CAACjD,QAAQ,CAACgW,SAAS,CAAC,cAAc,CAAC,CAAC,IACrDhW,QAAQ,CAACgW,SAAS,CAAC,cAAc,CAAC,KAAKjP,MAAM,MAGhD,CAACihB,UAAU,IACRzf,QAAQ,KAAK,GAAG,CACnB,EAEF;SACC,IAAI,CAAC4f,UAAU,CAAC;WACf7kB,KAAK,EAAGiF,QAAQ,KAAK,GAAI;WACzB0f,WAAW,EAAEA,WAAW;WACxBC,UAAU,EAAEA,UAAU;WACtBpe,QAAQ,EAAEA,QAAQ;WAClBge,QAAQ,EAAEA,QAAQ;WAClBE,UAAU,EAAEA,UAAU;WACtBzgB,KAAK,EAAEA;UACP,CAAC;;OAGH,IAAIwgB,OAAO,EACX;SACCnf,gBAAI,CAACC,SAAS,CAAC,yCAAyC,EAAE;WACzDhF,IAAI,EAAE;aACL0D,KAAK,EAAEA,KAAK;aACZjE,KAAK,EAAEmF;YACP;WACDK,cAAc,EAAE;aACfC,aAAa,EAAGN,QAAQ,KAAK,GAAG,GAAG,WAAW,GAAG;;UAElD,CAAC,CAACQ,IAAI,CAAC,UAACC,QAAQ,EAAK;WACrB,IAAIA,QAAQ,CAACrF,IAAI,CAACsF,OAAO,EACzB;aACC;;WAGD,KAAI,CAACgf,UAAU,CAAC;aACf7kB,KAAK,EAAGiF,QAAQ,KAAK,GAAI;aACzB0f,WAAW,EAAEA,WAAW;aACxBC,UAAU,EAAEA,UAAU;aACtBpe,QAAQ,EAAEA,QAAQ;aAClBge,QAAQ,EAAE,IAAI;aACdE,UAAU,EAAEA,UAAU;aACtBzgB,KAAK,EAAEA;YACP,CAAC;UACF,EAAE,UAAC2B,QAAQ,EAAK;WAChB,KAAI,CAACif,UAAU,CAAC;aACf7kB,KAAK,EAAGiF,QAAQ,KAAK,GAAI;aACzB0f,WAAW,EAAEA,WAAW;aACxBC,UAAU,EAAEA,UAAU;aACtBpe,QAAQ,EAAEA,QAAQ;aAClBge,QAAQ,EAAE;YACV,CAAC;UACF,CAAC;;OAGH,OAAO,KAAK;;;KACZ;KAAA,2BAEUroB,MAAM,EACjB;OACC,IAAM6D,KAAK,GAAIP,cAAI,CAACqlB,SAAS,CAAC3oB,MAAM,CAAC6D,KAAK,CAAC,GAAG7D,MAAM,CAAC6D,KAAK,GAAG,IAAK;OAClE,IAAIP,cAAI,CAACgN,MAAM,CAACzM,KAAK,CAAC,EACtB;SACC;;OAGD,IAAM2kB,WAAW,GAAIllB,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAACwoB,WAAW,CAAC,GAAGxoB,MAAM,CAACwoB,WAAW,GAAG,IAAK;OACpF,IAAIA,WAAW,EACf;SACCA,WAAW,CAAC3oB,SAAS,CAACE,MAAM,CAAC8D,KAAK,GAAG,IAAI,SAAM,CAACskB,cAAc,GAAG,IAAI,SAAM,CAACC,oBAAoB,CAAC;SACjGI,WAAW,CAAC3oB,SAAS,CAACC,GAAG,CAAC+D,KAAK,GAAG,IAAI,SAAM,CAACukB,oBAAoB,GAAG,IAAI,SAAM,CAACD,cAAc,CAAC;SAC9FK,WAAW,CAACtf,YAAY,CAAC,aAAa,EAAGrF,KAAK,GAAG,GAAG,GAAG,GAAG,CAAE;;OAG7D,IAAM4kB,UAAU,GAAInlB,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAACyoB,UAAU,CAAC,GAAGzoB,MAAM,CAACyoB,UAAU,GAAG,IAAK;OACjF,IACCA,UAAU,IACP,CAAC,IAAI,CAACG,qBAAqB,EAAE,EAEjC;SACC,IAAI/kB,KAAK,EACT;WACC4kB,UAAU,CAAC5oB,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACqoB,cAAc,CAAC;UACnD,MAED;WACCM,UAAU,CAAC5oB,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACooB,cAAc,CAAC;;;OAIxD,IAAM9d,QAAQ,GAAI/G,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAACqK,QAAQ,CAAC,GAAGrK,MAAM,CAACqK,QAAQ,GAAG,IAAK;OAC3E,IAAIA,QAAQ,EACZ;SACCA,QAAQ,CAACnB,YAAY,CAAC,aAAa,EAAGrF,KAAK,GAAG,GAAG,GAAG,GAAG,CAAE;;OAG1D,IAAMglB,YAAY,GAAGtoB,QAAQ,CAACgW,SAAS,CAAC,cAAc,CAAC;OAEvD,IAAIjT,cAAI,CAACE,cAAc,CAACqlB,YAAY,CAAC,EACrC;SACC,IAAI,CAACC,cAAc,CAACjlB,KAAK,CAAC;SAC1B,IAAI,CAACklB,qBAAqB,EAAE;;OAG7B,IAAMV,QAAQ,GAAI/kB,cAAI,CAACqlB,SAAS,CAAC3oB,MAAM,CAACqoB,QAAQ,CAAC,GAAGroB,MAAM,CAACqoB,QAAQ,GAAG,KAAM;OAC5E,IAAMvgB,KAAK,GAAI,CAACxE,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAAC8H,KAAK,CAAC,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAE;OAC5E,IAAMygB,UAAU,GAAIjlB,cAAI,CAACqlB,SAAS,CAAC3oB,MAAM,CAACuoB,UAAU,CAAC,GAAGvoB,MAAM,CAACuoB,UAAU,GAAG,KAAM;OAElF,IACCF,QAAQ,IACLvgB,KAAK,GAAG,CAAC,EAEb;SACC9F,WAAW,CAACgI,aAAa,CAAC,kBAAkB,EAAE;WAC7ClC,KAAK,EAAEA,KAAK;WACZR,MAAM,EAAGhE,cAAI,CAACE,cAAc,CAACqlB,YAAY,CAAC,GAAGA,YAAY,GAAG,EAAG;WAC/Dhf,OAAO,EAAG0e,UAAU,GAAG,GAAG,GAAG;UAC7B,EAAE,IAAI,CAAC;;;;KAET;KAAA,iCAEgBvoB,MAAM,EACvB;OAAA;OACC,IAAIsD,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAAC6D,KAAK,CAAC,EAClC;SACC;;OAGD,IAAMA,KAAK,GAAG,CAAC,CAAC7D,MAAM,CAAC6D,KAAK;OAE5B,IAAI,CAACP,cAAI,CAACE,cAAc,CAACjD,QAAQ,CAACgW,SAAS,CAAC,cAAc,CAAC,CAAC,EAC5D;SACC,IAAI,CAACyS,qBAAqB,CAACnlB,KAAK,CAAC;SACjC,IAAI,CAAColB,4BAA4B,EAAE;;OAGpC,IAAI7a,QAAQ,GAAG;SACdb,MAAM,EAAEwH,EAAE,CAACmU,aAAa,EAAE;SAC1B1b,IAAI,EAAE3M,aAAG,CAACC,UAAU,CAAC,SAAS,CAAC;SAC/B2M,IAAI,EAAE5M,aAAG,CAACC,UAAU,CAAC,aAAa,CAAC;SACnC+C,KAAK,EAAGA,KAAK,GAAG,GAAG,GAAG,GAAI;SAC1B0G,MAAM,EAAE,uBAAuB;SAC/B+C,aAAa,EAAE;QACf;OAEDd,IAAI,CAAC2c,cAAc,CAClB/a,QAAQ,EACR,YAAM;SACL5B,IAAI,CAAC4c,kBAAkB,EAAE;QACzB,EACD,UAAC3f,QAAQ,EAAK;SACb,MAAI,CAACuf,qBAAqB,CAACvf,QAAQ,CAAC5F,KAAK,KAAK,GAAG,CAAC;SAClD,MAAI,CAAColB,4BAA4B,EAAE;QACnC,CACD;;;KACD;KAAA,+BAEcplB,KAAK,EACpB;OACC,IAAI,CAACA,KAAK,GAAG,CAAC,CAACA,KAAK;;;KACpB;KAAA,iCAGD;OACC,OAAO,IAAI,CAACA,KAAK;;;KACjB;KAAA,sCAEqBA,KAAK,EAC3B;OACC,IAAI,CAACqkB,YAAY,GAAG,CAAC,CAACrkB,KAAK;;;KAC3B;KAAA,wCAGD;OACC,OAAO,IAAI,CAACqkB,YAAY;;;KACxB;KAAA,wCAGD;OACC,IAAMmB,aAAa,GAAGC,gBAAgB,CAAClV,mBAAmB,CAACmV,SAAS,CAAC,UAAA7T,IAAI,EAAI;SAC5E,OACCpS,cAAI,CAACE,cAAc,CAACkS,IAAI,CAAC7C,OAAO,CAAC,IAC9B6C,IAAI,CAAC7C,OAAO,KAAK,QAAQ;QAE7B,CAAC;OAEF,IAAIwW,aAAa,GAAG,CAAC,EACrB;SACC;;OAGD,IAAM/T,QAAQ,GAAGgU,gBAAgB,CAAClV,mBAAmB,CAACiV,aAAa,CAAC;OAEpE/T,QAAQ,CAAC9F,IAAI,GACZ,IAAI,CAACqG,cAAc,EAAE,GAClBhV,aAAG,CAACC,UAAU,CAAC,wCAAwC,CAAC,GACxDD,aAAG,CAACC,UAAU,CAAC,wCAAwC,CAC1D;OACDwoB,gBAAgB,CAAClV,mBAAmB,CAACiV,aAAa,CAAC,GAAG/T,QAAQ;OAC9DgU,gBAAgB,CAAC9qB,IAAI,CAAC;SACrB4O,IAAI,EAAE;QACN,CAAC;;;KACF;KAAA,+CAGD;OACC,IAAMic,aAAa,GAAGC,gBAAgB,CAACnV,iBAAiB,CAACoV,SAAS,CAAC,UAAA7T,IAAI,EAAI;SAC1E,OACCpS,cAAI,CAACE,cAAc,CAACkS,IAAI,CAAC7C,OAAO,CAAC,IAC9B6C,IAAI,CAAC7C,OAAO,KAAK,QAAQ;QAE7B,CAAC;OAEF,IAAIwW,aAAa,GAAG,CAAC,EACrB;SACC;;OAGD,IAAM/T,QAAQ,GAAGgU,gBAAgB,CAACnV,iBAAiB,CAACkV,aAAa,CAAC;OAElE/T,QAAQ,CAAC9F,IAAI,GACZ,IAAI,CAACoZ,qBAAqB,EAAE,GACzB/nB,aAAG,CAACC,UAAU,CAAC,2BAA2B,CAAC,GAC3CD,aAAG,CAACC,UAAU,CAAC,2BAA2B,CAC7C;OACDwoB,gBAAgB,CAACnV,iBAAiB,CAACkV,aAAa,CAAC,GAAG/T,QAAQ;OAC5DgU,gBAAgB,CAAC9qB,IAAI,CAAC;SACrB4O,IAAI,EAAE;QACN,CAAC;;;GACF;CAAA;;;ACrTF,CAKyD,IAEnDoc,QAAQ;GAEb,oBACA;KAAA;KACC,IAAI,CAACC,gBAAgB,GAAG,IAAI;KAC5B,IAAI,CAACC,OAAO,GAAG,EAAE;KACjB,IAAI,CAACC,GAAG,GAAG,EAAE;KAEb,IAAI,CAACnrB,IAAI,EAAE;;GACX;KAAA;KAAA,uBAGD;OACCC,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,IAAI,CAACkrB,aAAa,CAAChmB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC7EnF,6BAAY,CAACC,SAAS,CAAC,qBAAqB,EAAE,IAAI,CAACkrB,aAAa,CAAChmB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC5EnF,6BAAY,CAACC,SAAS,CAAC,oBAAoB,EAAE,IAAI,CAACmrB,WAAW,CAACjmB,IAAI,CAAC,IAAI,CAAC,CAAC;OACzEnF,6BAAY,CAACC,SAAS,CAAC,gBAAgB,EAAE,IAAI,CAACorB,aAAa,CAAClmB,IAAI,CAAC,IAAI,CAAC,CAAC;;;KACvE;KAAA,8BAEa4C,KAAK,EACnB;OACC,qBAA8BA,KAAK,CAAC2H,OAAO,EAAE;SAAA;SAArC4b,aAAa;SAAEpnB,EAAE;OACzB,IAAMmF,KAAK,GAAGvH,QAAQ,CAACoV,QAAQ,EAAE;OAEjC,IAAI,IAAI,CAACgU,GAAG,CAAChnB,EAAE,CAACqnB,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,QAAQ,EACvC;SACC,IAAI,CAACL,GAAG,CAAChnB,EAAE,CAACqnB,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,QAAQ;SAEjC,IAAI,IAAI,CAACN,OAAO,CAAC5hB,KAAK,CAAC,EACvB;WACC,IAAI,CAAC4hB,OAAO,CAAC5hB,KAAK,CAAC,CAAC,mBAAmB,CAAC,EAAE;WAC1C9F,WAAW,CAACgI,aAAa,CAAC,8BAA8B,EAAE;aACzDC,MAAM,EAAEnC,KAAK;aACbmiB,GAAG,EAAE,IAAI,CAACP,OAAO,CAAC5hB,KAAK,CAAC,CAAC,mBAAmB;YAC5C,EAAE,IAAI,CAAC;;;;;KAGV;KAAA,4BAEWtB,KAAK,EACjB;OACC,sBAA8BA,KAAK,CAAC2H,OAAO,EAAE;SAAA;SAArC4b,aAAa;SAAEpnB,EAAE;OACzB,IAAMmF,KAAK,GAAGvH,QAAQ,CAACoV,QAAQ,EAAE;OAEjC,IAAI,CAACgU,GAAG,CAACI,aAAa,CAAC,GAAI,IAAI,CAACJ,GAAG,CAACI,aAAa,CAAC,IAAI,EAAG;OACzD,IAAI,IAAI,CAACJ,GAAG,CAAChnB,EAAE,CAACqnB,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,OAAO,EACtC;SACC,IAAI,CAACL,GAAG,CAAChnB,EAAE,CAACqnB,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,OAAO;SAChC,IAAItjB,IAAI,GAAG,KAAK;SAEhB,IACC,IAAI,CAACgjB,OAAO,CAAC5hB,KAAK,CAAC,KACfpB,IAAI,GAAGhH,QAAQ,CAACC,cAAc,kBAAWgD,EAAE,CAACqnB,IAAI,CAAC,GAAG,CAAC,YAAS,CAAC,IAChEtjB,IAAI,IACJA,IAAI,CAACuc,UAAU,IAAIvjB,QAAQ,CAACC,cAAc,kBAAWoqB,aAAa,UAAO,EAE7E;WACC,IAAI,CAACL,OAAO,CAAC5hB,KAAK,CAAC,CAAC,mBAAmB,CAAC,EAAE;WAC1C9F,WAAW,CAACgI,aAAa,CAAC,8BAA8B,EAAE;aACzDC,MAAM,EAAEnC,KAAK;aACbmiB,GAAG,EAAE,IAAI,CAACP,OAAO,CAAC5hB,KAAK,CAAC,CAAC,mBAAmB;YAC5C,EAAE,IAAI,CAAC;;;;;KAGV;KAAA,8BAEatB,KAAK,EACnB;OACC,sBAA8CA,KAAK,CAAC2H,OAAO,EAAE;SAAA;SAArDnC,aAAa;SAAErJ,EAAE;SAAEunB,GAAG;SAAEC,SAAS;OAEzC,IACCA,SAAS,IACNA,SAAS,CAAC7c,aAAa,IACvB6c,SAAS,CAAC7c,aAAa,KAAK,aAAa,IACzC3K,EAAE,GAAG,CAAC,EAEV;SACCwnB,SAAS,CAAC7c,aAAa,GAAG6c,SAAS,CAAC5f,MAAM,GAAG,cAAc;SAC3D4f,SAAS,CAACC,OAAO,GAAGznB,EAAE;;;;KAEvB;KAAA,4BAEWA,EAAE,EAAEyB,IAAI,EACpB;OACC,IAAI,CAACslB,OAAO,CAAC/mB,EAAE,CAAC,GAAGyB,IAAI;;;KACvB;KAAA,wBAEOpE,MAAM,EACd;OAAA;OACC,IAAMqqB,cAAc,GAAGrqB,MAAM,CAACkT,EAAE;OAChC,IAAMoX,QAAQ,GAAG,CAAC,CAACtqB,MAAM,CAACoT,SAAS;OACnC,IAAMmX,WAAW,GAAIjnB,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACwqB,YAAY,CAAC,IAAIxqB,MAAM,CAACwqB,YAAa;OAElF,IAAMC,UAAU,GACfnnB,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACqT,OAAO,CAACC,IAAI,CAAC,IAClCtT,MAAM,CAACqT,OAAO,CAACC,IAAI,KAAK,IAAI,GAC5B,IAAI,GACJ,KACH;OACD,IAAMgS,OAAO,GACZhiB,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACqT,OAAO,CAACqX,QAAQ,CAAC,IACtC1qB,MAAM,CAACqT,OAAO,CAACqX,QAAQ,KAAK,IAAI,GAChC,IAAI,GACJ,KACH;OACD,IAAM5iB,KAAK,GAAG0E,IAAI,CAAC1E,KAAK;OACxB,IAAM9C,SAAS,GAAGtF,QAAQ,CAACC,cAAc,CAAC,oBAAoB,CAAC;OAE/D,IAAI,CAAC2qB,QAAQ,EACb;SACC,IAAIC,WAAW,EACf;WACCvoB,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACiW,OAAO,CAACpD,KAAK,EAAE;;SAGpCpgB,aAAG,CAACC,KAAK,CAACpC,SAAS,CAAC;SACpBA,SAAS,CAAC4lB,WAAW,CAAC3jB,aAAG,CAACC,MAAM,kIAA6C;;OAG9E,IAAI,CAAC2jB,mBAAmB,CAAC;SACxB7lB,SAAS,EAAEA,SAAS;SACpB8lB,MAAM,EAAE;QACR,CAAC;OAEFrsB,6BAAY,CAACimB,IAAI,CAAC,2BAA2B,CAAC;OAC9C1iB,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACqW,SAAS,CAACjpB,IAAI,EAAE;OAEpC,IAAI,CAAC2nB,gBAAgB,GAAGtgB,gBAAI,CAACgE,IAAI,CAAC;SACjCC,IAAI,EAAE,MAAM;SACZC,MAAM,EAAE,MAAM;SACdhF,GAAG,YAAKxH,aAAG,CAACC,UAAU,CAAC,mBAAmB,CAAC,CAAC0K,OAAO,CAAC,UAAU,EAAE1D,KAAK,CAAC,kCAAyB,CAACxE,cAAI,CAAC0nB,KAAK,CAACX,cAAc,CAAC,0BAAmBA,cAAc,IAAK,EAAE,CAAG;SACrKjmB,IAAI,EAAE,EAAE;SACRsJ,WAAW,EAAE,IAAI;SACjBxJ,QAAQ,EAAE,kBAACuF,QAAQ,EAAK;WAEvB,IAAMwhB,QAAQ,GAAGvrB,QAAQ,CAACC,cAAc,CAAC,yBAAyB,CAAC;WAEnE,IAAI2qB,QAAQ,EACZ;aACCnrB,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;YAC/B,MACI,IAAImrB,WAAW,EACpB;aACCvoB,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACiW,OAAO,CAACO,IAAI,EAAE;;WAGnC,KAAI,CAACL,mBAAmB,CAAC;aACxB7lB,SAAS,EAAEA,SAAS;aACpB8lB,MAAM,EAAE;YACR,CAAC;WAEF,IAAIxnB,cAAI,CAACE,cAAc,CAACiG,QAAQ,CAAC0hB,SAAS,CAAC,EAC3C;aACC3e,IAAI,CAAC2I,QAAQ,CAACtJ,SAAS,GAAGpC,QAAQ,CAAC0hB,SAAS;aAC5C7B,gBAAgB,CAAClV,mBAAmB,GAAGkV,gBAAgB,CAACpU,mBAAmB,CAAC1I,IAAI,CAAC2I,QAAQ,CAAC;aAC1FmU,gBAAgB,CAAC9qB,IAAI,CAAC;eACrB4O,IAAI,EAAE;cACN,CAAC;;WAGH,IAAI9J,cAAI,CAACE,cAAc,CAACiG,QAAQ,CAAC2hB,IAAI,CAAC,EACtC;aACC,IAAId,QAAQ,EACZ;eACCnjB,aAAG,CAACC,KAAK,CAACpC,SAAS,CAAC;eACpB,IAAI,CAAC1B,cAAI,CAACqJ,WAAW,CAAClD,QAAQ,CAAC4hB,iBAAiB,CAAC,EACjD;iBACCrpB,WAAW,CAACgI,aAAa,CAAC,8BAA8B,EAAE;mBACzDC,MAAM,EAAEnC,KAAK;mBACbmiB,GAAG,EAAE/pB,QAAQ,CAACuJ,QAAQ,CAAC4hB,iBAAiB;kBACxC,EAAE,IAAI,CAAC;;;aAIV,KAAI,CAACC,WAAW,CAACxjB,KAAK,EAAE;eACvBujB,iBAAiB,EAAE5hB,QAAQ,CAAC4hB;cAC5B,CAAC;aAEF,IAAME,WAAW,GAAGxW,EAAE,CAACsQ,WAAW,CAAC5b,QAAQ,CAAC2hB,IAAI,EAAE,IAAI,CAAC;aAEvDlG,iBAAO,CAACC,IAAI,CAACngB,SAAS,EAAEumB,WAAW,CAACC,IAAI,CAAC,CAAChiB,IAAI,CAAC,YAAM;eACpD3C,UAAU,CAAC,YAAM;iBAChB0e,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE;gBAClC,EAAE,IAAI,CAAC;cACR,CAAC;aACFzgB,SAAS,CAAC4lB,WAAW,CAAC3jB,aAAG,CAACC,MAAM,gIAA6C;aAE7E,IAAIjH,GAAG,GAAG,CAAC;aACX,IAAMwrB,IAAI,GAAG,SAAPA,IAAI,GAAS;eAClBxrB,GAAG,EAAE;eACL,IAAIA,GAAG,GAAG,GAAG,EACb;iBACC,IAAI+E,SAAS,CAAC0mB,UAAU,CAAC/mB,MAAM,GAAG,CAAC,EACnC;mBACCoQ,EAAE,CAAC4W,IAAI,CAACC,cAAc,CAACL,WAAW,CAACM,MAAM,CAAC;kBAC1C,MAED;mBACC9W,EAAE,CAAC+W,KAAK,CAACL,IAAI,EAAE,KAAI,CAAC,EAAE;;;cAGxB;aACD1W,EAAE,CAAC+W,KAAK,CAACL,IAAI,EAAE,KAAI,CAAC,EAAE;aAEtB,IAAMjlB,KAAK,GAAG,IAAIme,0BAAS,CAAC;eAC3BgB,UAAU,EAAE,CAAC;iBACZoG,MAAM,EAAE,IAAI;iBACZC,OAAO,YAAKnrB,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,oBAAiB;iBAC3EmrB,mBAAmB,EAAE,oBAAoB;iBACzCC,iBAAiB,EAAE;gBACnB;cACD,CAAC;aACFztB,6BAAY,CAACimB,IAAI,CAAC,+BAA+B,EAAEle,KAAK,CAAC;aACzD/H,6BAAY,CAACimB,IAAI,CAAC,gCAAgC,EAAEle,KAAK,CAAC;aAE1D,IAAI,CAAC8jB,QAAQ;;eACb;iBACC,IAAIW,QAAQ,EACZ;mBACCA,QAAQ,CAACvqB,SAAS,GAAG,EAAE;;iBAGxByrB,uBAAuB,CAAC,IAAI,CAAC;iBAE7B,IAAI1B,UAAU,KAAK,KAAK,EACxB;mBACC,KAAI,CAAC2B,kBAAkB,CAAC,MAAM,CAAC;kBAC/B,MACI,IAAI9G,OAAO,IAAI,KAAK,EACzB;mBACC,KAAI,CAAC8G,kBAAkB,CAAC,MAAM,CAAC;;;aAIjC7rB,QAAQ,CAACimB,mBAAmB,EAAE;aAC9B6F,kBAAkB,CAAC5F,iBAAiB,EAAE;aAEtC,IAAM6F,cAAc,GAAG5sB,QAAQ,CAACC,cAAc,CAAC,aAAa,CAAC;aAC7D,IACC,CAAC2D,cAAI,CAACqJ,WAAW,CAAClD,QAAQ,CAAC8iB,EAAE,CAAC,IAC3BD,cAAc,EAElB;eACCA,cAAc,CAACpjB,YAAY,CAAC,SAAS,EAAEO,QAAQ,CAAC8iB,EAAE,CAAC;;YAEpD,MAED;aACC,IAAI,CAACjC,QAAQ,EACb;eACC,KAAI,CAACO,mBAAmB,CAAC;iBACxB7lB,SAAS,EAAEA,SAAS;iBACpB8lB,MAAM,EAAE;gBACR,CAAC;;aAGH3rB,GAAG,CAACqtB,KAAK,CAAC;eACTxlB,KAAK,EAAEnG,aAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC;eAC9DY,IAAI,EAAEb,aAAG,CAACC,UAAU,CAAC,qDAAqD,CAAC;eAC3EK,MAAM,EAAEN,aAAG,CAACC,UAAU,CAAC,wCAAwC,CAAC;eAChEoD,QAAQ,EAAE,oBAAM;iBACflC,WAAW,CAACgI,aAAa,CAAC,oCAAoC,EAAE;mBAC/DlC,KAAK,EAAEA;kBACP,EAAE,IAAI,CAAC;iBACR2kB,OAAO,CAACC,KAAK,EAAE;;cAEhB,CAAC;;UAEH;SACD3e,gBAAgB,EAAE,4BAAM;WACvB,IAAIuc,QAAQ,EACZ;aACCnrB,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;YAC/B,MAED;aACC4C,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACiW,OAAO,CAACO,IAAI,EAAE;;WAEnC,KAAI,CAACL,mBAAmB,CAAC;aACxB7lB,SAAS,EAAEA,SAAS;aACpB8lB,MAAM,EAAE;YACR,CAAC;WACF,KAAI,CAAC6B,mBAAmB,CAAC;aACxB3nB,SAAS,EAATA,SAAS;aACTqlB,cAAc,EAAdA,cAAc;aACdC,QAAQ,EAARA,QAAQ;aACRG,UAAU,EAAVA;YACA,CAAC;;QAEH,CAAC;;;KACF;KAAA,oCAEmBzqB,MAAM,EAC1B;OACC,IAAMgF,SAAS,GAAGhF,MAAM,CAACgF,SAAS;OAClC,IAAM8lB,MAAM,GAAG,CAAC,CAAC9qB,MAAM,CAAC8qB,MAAM;OAE9B,IAAI,CAACxnB,cAAI,CAAC4C,SAAS,CAAClB,SAAS,CAAC,EAC9B;SACC;;OAGD,IAAM4nB,UAAU,GAAG5nB,SAAS,CAACuc,aAAa,CAAC,8BAA8B,CAAC;OAC1E,IAAIqL,UAAU,EACd;SACCzlB,aAAG,CAACC,KAAK,CAACwlB,UAAU,CAAC;SACrBzlB,aAAG,CAACpH,MAAM,CAAC6sB,UAAU,CAAC;;OAGvB,IAAI,CAAC9B,MAAM,EACX;SACC;;OAGD9lB,SAAS,CAAC4lB,WAAW,CAAC3jB,aAAG,CAACC,MAAM,gOAAyHrG,aAAG,CAACC,UAAU,CAAC,0BAA0B,CAAC,EAAe;;;KAClN;KAAA,oCAEmBd,MAAM,EAC1B;OAAA;OACC,IACCgF,SAAS,GAKNhF,MAAM,CALTgF,SAAS;SACTqlB,cAAc,GAIXrqB,MAAM,CAJTqqB,cAAc;SACdC,QAAQ,GAGLtqB,MAAM,CAHTsqB,QAAQ;SACRG,UAAU,GAEPzqB,MAAM,CAFTyqB,UAAU;SACVrmB,IAAI,GACDpE,MAAM,CADToE,IAAI;OAIL,IAAI,CAACd,cAAI,CAAC4C,SAAS,CAAClB,SAAS,CAAC,EAC9B;SACC;;OAGD,IAAM6nB,YAAY,GACjBvpB,cAAI,CAACsgB,QAAQ,CAACxf,IAAI,CAAC,IAChBd,cAAI,CAACE,cAAc,CAACY,IAAI,CAAC0oB,aAAa,CAAC,GACvC1oB,IAAI,CAAC0oB,aAAa,GAClBjsB,aAAG,CAACC,UAAU,CAAC,yBAAyB,CAC3C;OAEDkE,SAAS,CAAC4lB,WAAW,CAAC3jB,aAAG,CAACC,MAAM,kOAAiF2lB,YAAY,EAA2ChsB,aAAG,CAACC,UAAU,CAAC,yBAAyB,CAAC,EAAa;OAC9N,IAAMK,MAAM,GAAG6D,SAAS,CAACuc,aAAa,CAAC,yBAAyB,CAAC;OACjE,IAAI,CAACpgB,MAAM,EACX;SACC;;OAEDA,MAAM,CAACrC,gBAAgB,CAAC,OAAO,EAAE,UAAC0H,KAAK,EAAK;SAC3C,IAAIlD,cAAI,CAAC4C,SAAS,CAACM,KAAK,CAAC+K,MAAM,CAACwb,MAAM,CAAC,EACvC;WACC5lB,aAAG,CAACC,KAAK,CAACZ,KAAK,CAAC+K,MAAM,CAACwb,MAAM,CAAC;WAC9B5lB,aAAG,CAACpH,MAAM,CAACyG,KAAK,CAAC+K,MAAM,CAACwb,MAAM,CAAC;;;;SAIhC,MAAI,CAACC,OAAO,CAAC;WACZ9Z,EAAE,EAAEmX,cAAc;WAClBjX,SAAS,EAAEkX,QAAQ;WACnBjX,OAAO,EAAE;aACRC,IAAI,EAAE;;UAEP,CAAC;QACF,CAAC;OAEFnS,MAAM,CAACrC,gBAAgB,CAAC,YAAY,EAAE,UAAC0H,KAAK,EAAK;SAAEA,KAAK,CAAC+K,MAAM,CAAC1R,SAAS,CAACC,GAAG,CAAC,+BAA+B,CAAC;QAAG,CAAC;OAClHqB,MAAM,CAACrC,gBAAgB,CAAC,UAAU,EAAE,UAAC0H,KAAK,EAAK;SAAEA,KAAK,CAAC+K,MAAM,CAAC1R,SAAS,CAACE,MAAM,CAAC,+BAA+B,CAAC;QAAG,CAAC;;;KACnH;KAAA,2BAGD;OACC,IAAI,IAAI,CAAC0pB,gBAAgB,EACzB;SACC,IAAI,CAACA,gBAAgB,CAACwD,KAAK,EAAE;;;;KAE9B;KAAA,mCAEkB7f,IAAI,EACvB;OACCA,IAAI,GAAIA,IAAI,KAAK,MAAM,GAAG,MAAM,GAAG,MAAO;OAE1C,IAAIA,IAAI,KAAK,MAAM,EACnB;SACC,IAAI,CAAC8f,qBAAqB,EAAE;SAC5BxlB,OAAI,CAAC+iB,UAAU,EAAE;QACjB,MACI,IAAIrd,IAAI,KAAK,MAAM,EACxB;SACC,IAAMpI,SAAS,GAAGtF,QAAQ,CAACC,cAAc,CAAC,oBAAoB,CAAC;SAC/D,IAAI,CAACqF,SAAS,EACd;WACC,OAAO,KAAK;;SAGb,IAAMmoB,eAAe,GAAGnoB,SAAS,CAACuc,aAAa,CAAC,yBAAyB,CAAC;SAC1E,IAAI4L,eAAe,EACnB;WACChnB,MAAM,CAACwB,QAAQ,CAAC,CAAC,EAAEwlB,eAAe,CAACC,SAAS,CAAC;UAC7C,MAED;WACC,IAAIC,YAAY,GAAGtY,EAAE,CAACuY,SAAS,CAACtoB,SAAS,EAAE;aAAEuoB,SAAS,EAAG;YAAsB,EAAE,IAAI,CAAC;WACtFpnB,MAAM,CAACwB,QAAQ,CAAC,CAAC,EAAG0lB,YAAY,GAAGA,YAAY,CAACD,SAAS,GAAG,CAAC,CAAE;;;OAIjE,OAAO,KAAK;;;KACZ;KAAA,wCAGD;OACCprB,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACqW,SAAS,CAACyC,KAAK,EAAE;OACrC,OAAO,KAAK;;;KACZ;KAAA,qCAEoB1lB,KAAK,EAAEjE,KAAK;;KACjC;OACC,IAAImF,QAAQ;OAEZ,IAAMykB,WAAW,GAAI,CAACnqB,cAAI,CAACqJ,WAAW,CAAC9I,KAAK,CAAE;OAE9CA,KAAK,GAAI,CAACP,cAAI,CAACqJ,WAAW,CAAC9I,KAAK,CAAC,GAAG3D,QAAQ,CAAC2D,KAAK,CAAC,GAAG,CAAE;OAExD,IAAMmB,SAAS,GAAGtF,QAAQ,CAACC,cAAc,6BAAsBmI,KAAK,EAAG;OACvE,IAAM4lB,YAAY,GAAGhuB,QAAQ,CAACC,cAAc,iCAA0BmI,KAAK,EAAG;OAE9E,IACC9C,SAAS,IACN,CAAC0oB,YAAY;;SAEjB;WACC,IAAI7pB,KAAK,GAAG,CAAC,EACb;aACCmF,QAAQ,GAAGnF,KAAK;YAChB,MACI,IAAI,CAAC4pB,WAAW,EACrB;aACCzkB,QAAQ,GAAG,CAAChE,SAAS,CAACtE,SAAS,CAACiE,MAAM,GAAG,CAAC,GAAGzE,QAAQ,CAAC8E,SAAS,CAACtE,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC;;WAGpF,IAAIR,QAAQ,CAAC8I,QAAQ,CAAC,GAAG,CAAC,EAC1B;aACChE,SAAS,CAACtE,SAAS,GAAGsI,QAAQ;aAC9BhE,SAAS,CAAC0S,KAAK,CAACiW,OAAO,GAAG,cAAc;aAExC,IAAIjuB,QAAQ,CAACC,cAAc,mCAA4BmI,KAAK,EAAG,EAC/D;eACCpI,QAAQ,CAACC,cAAc,mCAA4BmI,KAAK,EAAG,CAAC4P,KAAK,CAACiW,OAAO,GAAG,cAAc;;aAE3F,IAAIjuB,QAAQ,CAACC,cAAc,kCAA2BmI,KAAK,EAAG,EAC9D;eACCpI,QAAQ,CAACC,cAAc,kCAA2BmI,KAAK,EAAG,CAAC4P,KAAK,CAACiW,OAAO,GAAG,MAAM;;;;OAKpF,IAAMC,YAAY,GAAGluB,QAAQ,CAACC,cAAc,CAAC,iBAAiB,CAAC;OAC/D,IAAIiuB,YAAY;;SAChB;WACC,IAAI/pB,KAAK,GAAG,CAAC,EACb;aACCmF,QAAQ,GAAGnF,KAAK;YAChB,MACI,IAAI,CAAC4pB,WAAW,EACrB;aACCzkB,QAAQ,GAAG,CAAC4kB,YAAY,CAACltB,SAAS,CAACiE,MAAM,GAAG,CAAC,GAAGzE,QAAQ,CAAC0tB,YAAY,CAACltB,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC;;WAE1FktB,YAAY,CAACltB,SAAS,GAAGsI,QAAQ;;;;GAElC;CAAA;;CChdc,IAEV0L,IAAI;GAET,gBACA;KAAA;KACC,IAAI,CAACmZ,qBAAqB,GAAG,KAAK;KAClC,IAAI,CAACC,gBAAgB,GAAG,KAAK;KAE7B,IAAI,CAACC,UAAU,GAAG,CAAC;KACnB,IAAI,CAACC,WAAW,GAAG,IAAI;KACvB,IAAI,CAACtI,UAAU,GAAG,IAAI;KAEtB,IAAI,CAACuI,OAAO,GAAG,EAAE;KAEjB,IAAI,CAACC,mBAAmB,GAAG;OAC1BlvB,OAAO,EAAE,IAAI;OACbmvB,QAAQ,EAAE;MACV;KAED,IAAI,SAAM,GAAG;OACZjwB,QAAQ,EAAE,uBAAuB;OACjCkwB,cAAc,EAAE;MAChB;KAED,IAAI,CAACpoB,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAACpC,IAAI,CAAC,IAAI,CAAC;KACxC,IAAI,CAACyqB,kBAAkB,GAAG,IAAI,CAACA,kBAAkB,CAACzqB,IAAI,CAAC,IAAI,CAAC;KAC5D,IAAI,CAAC0qB,mBAAmB,GAAG,IAAI,CAACA,mBAAmB,CAAC1qB,IAAI,CAAC,IAAI,CAAC;KAE9D,IAAI,CAACpF,IAAI,EAAE;;GACX;KAAA;KAAA,uBAGD;OACC,IAAI,CAAC+vB,aAAa,CAAC,CAAC,CAAC;;;KACrB;KAAA,2BAEUzD,MAAM,EAAE0D,cAAc,EACjC;OACC1D,MAAM,GAAG,CAAC,CAACA,MAAM;OACjB0D,cAAc,GAAG,CAAC,CAACA,cAAc;OAEjC,IAAI1D,MAAM,EACV;SACCprB,QAAQ,CAAC+uB,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAACzoB,QAAQ,CAAC;SACrDtG,QAAQ,CAACZ,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAACkH,QAAQ,CAAC;QAClD,MAED;SACCtG,QAAQ,CAAC+uB,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAACzoB,QAAQ,CAAC;;OAGtD,IACCwoB,cAAc,IACX9uB,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,EAE7C;SACCD,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,CAAC+X,KAAK,CAACiW,OAAO,GAAI7C,MAAM,GAAG,OAAO,GAAG,MAAO;;;;KAEtF;KAAA,2BAGD;OAAA;OACC,IAAM4D,eAAe,GAAGnuB,QAAQ,CAACouB,YAAY,EAAE;OAE/C,IAAI,EACH,CACCxoB,MAAM,CAACC,WAAW,IAAIsoB,eAAe,IAClChvB,QAAQ,CAACmnB,eAAe,CAAChf,YAAY,IAAI1B,MAAM,CAAC2gB,WAAW;aAG9D3gB,MAAM,CAACC,WAAW,GAAG,CAAC;UACnBsoB,eAAe,GAAG,CAAC,CACtB,IACE,CAAC,IAAI,CAACZ,gBAAgB,IACtB,CAAC,IAAI,CAACD,qBAAqB,CAC9B,EACD;SACC;;OAGD,IAAIttB,QAAQ,CAACgW,SAAS,CAAC,yBAAyB,EAAE,KAAK,CAAC,KAAK,IAAI,EACjE;SACC;;OAGD7W,QAAQ,CAAC+uB,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAACzoB,QAAQ,CAAC;OAErD,IAAI,CAAC6nB,qBAAqB,GAAG,IAAI;OAEjC,IAAI,CAACG,WAAW,GAAG7kB,gBAAI,CAACgE,IAAI,CAAC;SAC5BC,IAAI,EAAE,MAAM;SACZC,MAAM,EAAE,MAAM;SACdhF,GAAG,EAAE,IAAI,CAACumB,cAAc,EAAE;SAC1BxqB,IAAI,EAAE,EAAE;SACRF,QAAQ,EAAE,kBAACE,IAAI,EAAK;WACnB,KAAI,CAAC4pB,WAAW,GAAG,IAAI;WAEvB,IACC1qB,cAAI,CAACC,aAAa,CAACa,IAAI,CAAC,IACrBd,cAAI,CAACC,aAAa,CAACa,IAAI,CAACyqB,KAAK,CAAC,IAC9BvrB,cAAI,CAACE,cAAc,CAACY,IAAI,CAACyqB,KAAK,CAACzJ,OAAO,CAAC,EAE3C;aACC,IACC9hB,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC0qB,OAAO,CAAC,IAC3B5uB,QAAQ,CAACkE,IAAI,CAAC0qB,OAAO,CAAC,IAAI,CAAC,IAC3B5uB,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC,CAAC,IAAI,CAAC,IACnDZ,QAAQ,CAACkE,IAAI,CAAC0qB,OAAO,CAAC,GAAG5uB,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC,CAAC,IAEzEZ,QAAQ,CAACkE,IAAI,CAAC0qB,OAAO,CAAC,KAAK5uB,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC,CAAC,KAExEZ,QAAQ,CAACkE,IAAI,CAAC2qB,OAAO,CAAC,IAAI,CAAC,IACxB7uB,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC,CAAC,IAAI,CAAC,IACnDZ,QAAQ,CAACkE,IAAI,CAAC2qB,OAAO,CAAC,KAAK7uB,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC,CAAC,CAE7E,EAEF;eACC,KAAI,CAACkuB,gBAAgB,CAAC5qB,IAAI,CAACyqB,KAAK,EAAE;iBACjCzhB,IAAI,EAAE,MAAM;iBACZlJ,QAAQ,EAAE,oBAAM;mBACf3D,QAAQ,CAAC0uB,eAAe,EAAE;mBAE1BziB,IAAI,CAAC0iB,qBAAqB,EAAE;mBAC5BroB,UAAU,CAAC2F,IAAI,CAAC2iB,gBAAgB,CAACvrB,IAAI,CAAC4I,IAAI,CAAC,EAAE,GAAG,CAAC;mBAEjD/N,6BAAY,CAACimB,IAAI,CAAC,+CAA+C,EAAE,IAAIC,0BAAS,CAAC;qBAChFgB,UAAU,EAAE,CAAC;uBACZyJ,WAAW,EAAE,eAAe;uBAC5B7B,SAAS,EAAE,uBAAuB;uBAClC8B,oBAAoB,EAAE;sBACtB;oBACD,CAAC,CAAC;;gBAEJ,CAAC;eAEF,IAAItB,UAAU,GAAG,KAAI,CAACuB,aAAa,EAAE;eAErC,IACCpvB,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,IAC1CitB,UAAU,GAAG,CAAC,EAElB;iBACC,KAAI,CAACQ,aAAa,CAACR,UAAU,GAAG,CAAC,CAAC;iBAClC,IAAIE,OAAO,GAAGhhB,aAAG,CAACsiB,WAAW,CAAC,KAAI,CAACX,cAAc,EAAE,EAAE,CAAC,QAAQ,GAAG/tB,aAAG,CAACC,UAAU,CAAC,eAAe,CAAC,CAAC,CAAC;iBAClGmtB,OAAO,GAAGhhB,aAAG,CAACC,QAAQ,CAAC+gB,OAAO,kDACnB/tB,QAAQ,CAACW,aAAG,CAACC,UAAU,CAAC,eAAe,CAAC,CAAC,GAAM,KAAI,CAACwuB,aAAa,EAAE,GAAG,CAAC,EAChF;iBAEF,KAAI,CAACE,cAAc,CAACvB,OAAO,CAAC;;eAG7BvuB,QAAQ,CAACZ,gBAAgB,CAAC,QAAQ,EAAE,KAAI,CAACkH,QAAQ,CAAC;;YAEnD,MAED;aACC,KAAI,CAACzG,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;;WAGpC,KAAI,CAACsuB,qBAAqB,GAAG,KAAK;UAClC;SACD9f,gBAAgB,EAAE,4BAAM;WACvB,KAAI,CAACxO,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;WACnC,KAAI,CAACyuB,WAAW,GAAG,IAAI;WACvB,KAAI,CAACH,qBAAqB,GAAG,KAAK;;QAEnC,CAAC;;;KACF;KAAA,wBAEO4B,OAAO,EAAEzvB,MAAM,EACvB;OAAA;OACCyvB,OAAO,GAAG,CAAC,CAACA,OAAO;OAEnB,IACC,IAAI,CAAC5B,qBAAqB,IACvB,CAACvqB,cAAI,CAACgN,MAAM,CAAC,IAAI,CAAC0d,WAAW,CAAC,EAElC;SACC,IAAI,CAACA,WAAW,CAACf,KAAK,EAAE;;OAGzB,IAAM/uB,QAAQ,GAAGwB,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC;OAC1D,IAAIzB,QAAQ,EACZ;SACCA,QAAQ,CAAC2B,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAAC5B,QAAQ,CAAC;;OAG5CqC,QAAQ,CAACmvB,gBAAgB,CAAC,KAAK,CAAC;OAChCnvB,QAAQ,CAACovB,iBAAiB,CAAC,IAAI,CAAC;OAChCC,uBAAuB,CAACjvB,yBAAyB,EAAE;OACnDkvB,sBAAsB,CAACC,WAAW,EAAE;OACpCC,uBAAuB,CAACC,OAAO,EAAE;OAEjC,IAAI,CAAClC,gBAAgB,GAAG,IAAI;OAE5B,IAAImC,SAAS,GAAGhjB,aAAG,CAACsiB,WAAW,CAAC7vB,QAAQ,CAAC6T,QAAQ,CAAC2c,IAAI,EAAE,CAAE,QAAQ,EAAE,aAAa,EAAE,MAAM,CAAE,CAAC;OAC5FD,SAAS,GAAGhjB,aAAG,CAACC,QAAQ,CAAC+iB,SAAS,EAAE;SACnCE,MAAM,EAAE,GAAG;SACXC,WAAW,EAAE;QACb,CAAC;OAEF,IACC9sB,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,IACvBsD,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACilB,IAAI,CAAC,EAEpC;SACCgL,SAAS,GAAGhjB,aAAG,CAACC,QAAQ,CAAC+iB,SAAS,EAAE;WACnCI,IAAI,EAAErwB,MAAM,CAACilB;UACb,CAAC;;OAGH,IAAM1C,OAAO,GAAG,CACf;SAAE/S,IAAI,EAAE,gBAAgB;SAAE3L,KAAK,EAAE;QAAe,EAChD;SAAE2L,IAAI,EAAE,QAAQ;SAAE3L,KAAK,EAAEnE,QAAQ,CAAC4wB;QAAU,EAC5C;SAAE9gB,IAAI,EAAE,eAAe;SAAE3L,KAAK,EAAE;QAAY,EAC5C;SAAE2L,IAAI,EAAE,oBAAoB;SAAE3L,KAAK,EAAEU,IAAI,CAACgsB,SAAS,CAACpqB,MAAM,CAACqqB,YAAY;QAAG,EAC1E;SAAEhhB,IAAI,EAAE,iBAAiB;SAAE3L,KAAK,EAC/B,CAACP,cAAI,CAACqJ,WAAW,CAACoI,EAAE,CAAC+P,UAAU,CAAC,IAC7BxhB,cAAI,CAACC,aAAa,CAACwR,EAAE,CAAC+P,UAAU,CAAC2L,IAAI,CAAC,IACtCntB,cAAI,CAACE,cAAc,CAACuR,EAAE,CAAC+P,UAAU,CAAC2L,IAAI,CAACC,QAAQ,CAAC,GAChD3b,EAAE,CAAC+P,UAAU,CAAC2L,IAAI,CAACC,QAAQ,GAC3BlkB,IAAI,CAACmkB;QACL,CACJ;OAED,IAAI,CAACjL,UAAU,GAAGvc,gBAAI,CAACgE,IAAI,CAAC;SAC3BC,IAAI,EAAE,MAAM;SACZC,MAAM,EAAE,MAAM;SACdhF,GAAG,EAAE4nB,SAAS;SACd7rB,IAAI,EAAE,EAAE;SACRme,OAAO,EAAEA,OAAO;SAChBre,QAAQ,EAAE,kBAACE,IAAI,EAAK;WACnB,MAAI,CAACshB,UAAU,GAAG,IAAI;WACtB,MAAI,CAAC6I,aAAa,CAAC,CAAC,CAAC;WACrBhuB,QAAQ,CAACovB,iBAAiB,CAAC,KAAK,CAAC;WACjCpvB,QAAQ,CAACmvB,gBAAgB,CAAC,KAAK,CAAC;WAChCG,sBAAsB,CAACe,UAAU,EAAE;WAEnC,IAAIlxB,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,EAC7C;aACCD,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,CAACE,SAAS,CAACE,MAAM,CAAC,MAAI,SAAM,CAAC7B,QAAQ,CAAC;;WAGhFiB,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;WAC/BD,GAAG,CAACC,IAAI,CAAC,uBAAuB,CAAC;WAEjC,IACCkE,cAAI,CAACC,aAAa,CAACa,IAAI,CAAC,IACrBd,cAAI,CAACC,aAAa,CAACa,IAAI,CAACyqB,KAAK,CAAC,IAC9BvrB,cAAI,CAACE,cAAc,CAACY,IAAI,CAACyqB,KAAK,CAACzJ,OAAO,CAAC,EAE3C;aACC,MAAI,CAACyL,0BAA0B,CAAC,KAAK,CAAC;aAEtCtL,YAAY,CAACC,QAAQ,CAACsL,WAAW,EAAE;aACnC3xB,GAAG,CAACwO,eAAe,EAAE;aAErBiiB,uBAAuB,CAACmB,YAAY,EAAE;aACtCnB,uBAAuB,CAACjvB,yBAAyB,EAAE;aAEnD,IAAI,CAAC2C,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAAC4sB,gBAAgB,CAAC,EAC5C;eACChvB,WAAW,CAACgI,aAAa,CAAC,kBAAkB,EAAE,CAAE5F,IAAI,CAAC4sB,gBAAgB,CAAE,EAAE,IAAI,CAAC;eAE9EhvB,WAAW,CAACiJ,MAAM,CAACC,eAAe,CAAC,wBAAwB,EAAE;iBAC5D+lB,WAAW,EAAE7sB,IAAI,CAAC4sB,gBAAgB;iBAClCE,UAAU,EAAE9sB,IAAI,CAAC+sB,mBAAmB;iBACpCC,cAAc,EAAEhtB,IAAI,CAACitB;gBACrB,EAAE,eAAe,CAAC;;aAGpB,MAAI,CAACrC,gBAAgB,CAAC5qB,IAAI,CAACyqB,KAAK,EAAE;eACjCzhB,IAAI,EAAE,SAAS;eACflJ,QAAQ,EAAE,oBAAM;iBACfotB,mBAAmB,CAACC,UAAU,EAAE;iBAChCD,mBAAmB,CAAC9yB,IAAI,EAAE;iBAE1B,IACC,CAAC8E,cAAI,CAACqJ,WAAW,CAACoI,EAAE,CAAC+P,UAAU,CAAC,IAC7BplB,QAAQ,CAACC,cAAc,CAAC,wBAAwB,CAAC,KAEnD2D,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAACotB,kBAAkB,CAAC,IACtCptB,IAAI,CAACotB,kBAAkB,KAAK,GAAG,CAClC,EAEF;mBACC,IAAMC,eAAe,GACpB,CAACnuB,cAAI,CAACqJ,WAAW,CAACvI,IAAI,CAACmoB,EAAE,CAAC,IACvBrsB,QAAQ,CAACkE,IAAI,CAACmoB,EAAE,CAAC,GAAG,CAAC,GACrBrsB,QAAQ,CAACkE,IAAI,CAACmoB,EAAE,CAAC,GACjB,CACH;mBAED,IAAIkF,eAAe,GAAG,CAAC,EACvB;qBACClxB,QAAQ,CAACmxB,UAAU,CAAC;uBACnBC,YAAY,EAAEF;sBACd,CAAC;;mBAGHlxB,QAAQ,CAACqxB,gBAAgB,CAAC;qBACzBC,SAAS,EAAEJ;oBACX,CAAC;;iBAGHjlB,IAAI,CAAC0iB,qBAAqB,EAAE;;;;iBAI5BroB,UAAU,CAAC,YAAM;mBAChB0e,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE,CAAC;kBACnC,EAAE,IAAI,CAAC;iBAERmK,uBAAuB,CAAC/wB,UAAU,EAAE;;cAErC,CAAC;aAEF,IAAI4wB,OAAO,EACX;eACCrI,eAAe,CAACC,OAAO,CAAC;iBACvBC,QAAQ,EAAE,IAAI;iBACdC,KAAK,EAAE;mBACNC,MAAM,EAAErhB,MAAM,CAACC;kBACf;iBACDqhB,MAAM,EAAE;mBACPD,MAAM,EAAE;kBACR;iBACDE,UAAU,EAAEN,eAAe,CAACO,WAAW,CAACP,eAAe,CAACQ,WAAW,CAACC,KAAK,CAAC;iBAC1EC,IAAI,EAAE,cAACC,KAAK,EAAK;mBAChB5hB,MAAM,CAACwB,QAAQ,CAAC,CAAC,EAAEogB,KAAK,CAACP,MAAM,CAAC;kBAChC;iBACDQ,QAAQ,EAAE,oBAAM;gBAChB,CAAC;;aAGH,IACC7hB,MAAM,CAAC2rB,gBAAgB,IACpB1tB,IAAI,CAAC2tB,iBAAiB,IAAI,GAAG,IAC7B,CAACvlB,IAAI,CAACwlB,aAAa,KAErB7rB,MAAM,CAAC2rB,gBAAgB,CAACpP,MAAM,IAAIvc,MAAM,CAAC2rB,gBAAgB,CAACG,IAAI,IAC3D9rB,MAAM,CAAC2rB,gBAAgB,CAACpP,MAAM,IAAIvc,MAAM,CAAC2rB,gBAAgB,CAACI,WAAW,CACxE;;eAEF;iBACC/rB,MAAM,CAAC2rB,gBAAgB,CAACK,MAAM,EAAE;;YAEjC,MAED;aACC,MAAI,CAAC5yB,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC;;WAGnC,MAAI,CAACuuB,gBAAgB,GAAG,KAAK;UAC7B;SACD/f,gBAAgB,EAAE,4BAAM;WACvB,MAAI,CAAC2X,UAAU,GAAG,IAAI;WAEtBnlB,QAAQ,CAACovB,iBAAiB,CAAC,KAAK,CAAC;WACjCpvB,QAAQ,CAACmvB,gBAAgB,CAAC,KAAK,CAAC;WAChCG,sBAAsB,CAACe,UAAU,EAAE;WAEnC,IAAIlxB,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,EAC7C;aACCD,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,CAACE,SAAS,CAACE,MAAM,CAAC,MAAI,SAAM,CAAC7B,QAAQ,CAAC;;WAGhFiB,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;WAC/BD,GAAG,CAACC,IAAI,CAAC,uBAAuB,CAAC;WAEjC,MAAI,CAACG,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC;WAClC,MAAI,CAACuuB,gBAAgB,GAAG,KAAK;;QAE9B,CAAC;;;KACF;KAAA,iCAEgB9I,KAAK,EAAEhlB,MAAM,EAC9B;OACC,IACC,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,IACxB,CAACsD,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACoN,IAAI,CAAC,IACjC,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC8N,OAAO,CAAClb,MAAM,CAACoN,IAAI,CAAC,GAAG,CAAC,EAEhD;SACC;;OAGD,IAAIglB,eAAe,GAAG,KAAK;OAC3B,IAAIC,aAAa,GAAG,KAAK;OAEzBC,UAAU,CAACC,UAAU,CAAC;OACtBC,iBAAiB,CAACC,eAAe,CAAC;OAElC,SAASH,UAAU,CAACpuB,QAAQ,EAC5B;SACC,IACCZ,cAAI,CAAC0R,OAAO,CAACgQ,KAAK,CAAC0N,GAAG,CAAC,IACpB1N,KAAK,CAAC0N,GAAG,CAAC/tB,MAAM,GAAG,CAAC,EAExB;WACCoQ,EAAE,CAACiC,IAAI,CAACgO,KAAK,CAAC0N,GAAG,EAAExuB,QAAQ,CAAC;UAC5B,MAED;WACCA,QAAQ,EAAE;;;OAIZ,SAASquB,UAAU,GACnB;SACC,IAAIvyB,MAAM,CAACoN,IAAI,KAAK,SAAS,EAC7B;WACC1N,QAAQ,CAACC,cAAc,CAAC,sBAAsB,CAAC,CAACe,SAAS,GAAGskB,KAAK,CAACI,OAAO;UACzE;;WAED;aACC1lB,QAAQ,CAACC,cAAc,CAAC,eAAe,CAAC,CAACujB,YAAY,CACpD/b,aAAG,CAACwrB,MAAM,CAAC,KAAK,EAAE;eACjBxN,IAAI,EAAEH,KAAK,CAACI;cACZ,CAAC,EACF1lB,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,CACzC;;SAGFyyB,eAAe,GAAG,IAAI;SACtB,IAAIC,aAAa,EACjB;WACCI,eAAe,EAAE;;;OAInB,SAASD,iBAAiB,CAACtuB,QAAQ,EACnC;SACC,IACCZ,cAAI,CAAC0R,OAAO,CAACgQ,KAAK,CAAC4N,EAAE,CAAC,IACnB5N,KAAK,CAAC4N,EAAE,CAACjuB,MAAM,GAAG,CAAC,EAEvB;WACCoQ,EAAE,CAACiC,IAAI,CAACgO,KAAK,CAAC4N,EAAE,EAAE1uB,QAAQ,CAAC,CAAC;UAC5B,MAED;WACCA,QAAQ,EAAE;;;OAIZ,SAASuuB,eAAe,GACxB;SACCJ,aAAa,GAAG,IAAI;SAEpB,IAAID,eAAe,EACnB;WACCzG,cAAI,CAACkH,kBAAkB,CAAC7N,KAAK,CAACI,OAAO,EAAE;aACtC0N,eAAe,EAAE,KAAK;aACtBC,QAAQ,EAAE,MAAM;aAChBC,SAAS,EAAE,qBAAM;eAChB,IAAI1vB,cAAI,CAAC+M,UAAU,CAACrQ,MAAM,CAACkE,QAAQ,CAAC,EACpC;iBACClE,MAAM,CAACkE,QAAQ,EAAE;;;YAGnB,CAAC;;;;;KAGJ;KAAA,6BAEYkJ,IAAI,EAAEpP,IAAI,EACvB;OAAA;OACC,IAAI,CAAC,CAAC,SAAS,EAAE,UAAU,CAAC,CAACsR,QAAQ,CAAClC,IAAI,CAAC,EAC3C;SACCA,IAAI,GAAG,SAAS;;OAGjBpP,IAAI,GAAG,CAAC,CAACA,IAAI;OAEb,IAAMi1B,UAAU,GAAGvzB,QAAQ,CAACC,cAAc,iBAAUyN,IAAI,CAAC8lB,WAAW,EAAE,YAAS;OAE/E,IAAI,IAAI,CAAChF,mBAAmB,CAAC9gB,IAAI,CAAC,EAClC;SACCmZ,YAAY,CAAC,IAAI,CAAC2H,mBAAmB,CAAC9gB,IAAI,CAAC,CAAC;;OAG7C,IAAI6lB,UAAU,EACd;SACC,IAAIj1B,IAAI,EACR;WACCi1B,UAAU,CAACpzB,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACsuB,cAAc,CAAC;WACnD,IAAIhhB,IAAI,KAAK,SAAS,EACtB;aACC1N,QAAQ,CAACZ,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAACuvB,kBAAkB,CAAC;;UAE7D,MAED;WACC,IAAIjhB,IAAI,KAAK,SAAS,EACtB;aACC1N,QAAQ,CAAC+uB,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAACJ,kBAAkB,CAAC;;WAEhE4E,UAAU,CAACpzB,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACquB,cAAc,CAAC;;QAEvD,MAED;SACC,IAAI,CAACF,mBAAmB,CAAC9gB,IAAI,CAAC,GAAGvG,UAAU,CAAC,YAAM;WACjD,MAAI,CAACtH,YAAY,CAAC6N,IAAI,EAAEpP,IAAI,CAAC;UAC7B,EAAE,GAAG,CAAC;;OAGR,IAAIoP,IAAI,KAAK,UAAU,EACvB;SACC,IAAI,CAAC+lB,UAAU,CAAC,CAACn1B,IAAI,EAAE,IAAI,CAAC;;;;KAE7B;KAAA,qCAGD;OACC,IAAI,CAACuB,YAAY,CAAC,SAAS,EAAE,KAAK,CAAC;;;KACnC;KAAA,sCAGD;OACC,IAAI,CAACA,YAAY,CAAC,UAAU,EAAE,KAAK,CAAC;;;KACpC;KAAA,8BAEasE,KAAK,EACnB;OACC,IAAI,CAACkqB,UAAU,GAAG7tB,QAAQ,CAAC2D,KAAK,CAAC;;;KACjC;KAAA,gCAGD;OACC,OAAO,IAAI,CAACkqB,UAAU;;;KACtB;KAAA,+BAEclqB,KAAK,EACpB;OACC,IAAI,CAACoqB,OAAO,GAAGpqB,KAAK;;;KACpB;KAAA,iCAGD;OACC,OAAO,IAAI,CAACoqB,OAAO;;;KACnB;KAAA,2CAE0BvL,MAAM,EACjC;OACCniB,QAAQ,CAACmxB,UAAU,CAAC;SACnB0B,uBAAuB,EAAE,CAAC,CAAC1Q;QAC3B,CAAC;OAEF,IAAMzjB,iBAAiB,GAAGS,QAAQ,CAACC,cAAc,CAAC,0BAA0B,CAAC;OAC7E,IAAM0zB,mBAAmB,GAAG3zB,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC;OAErE,IACCV,iBAAiB,IACdo0B,mBAAmB,EAEvB;SACCp0B,iBAAiB,CAACyY,KAAK,CAACiW,OAAO,GAAI,CAAC,CAACjL,MAAM,GAAG,OAAO,GAAG,MAAO;SAC/D2Q,mBAAmB,CAAC3b,KAAK,CAACiW,OAAO,GAAI,CAAC,CAACjL,MAAM,GAAG,MAAM,GAAG,OAAQ;;OAGlEjkB,6BAAY,CAACimB,IAAI,CAAC,yCAAyC,EAAE,IAAIC,0BAAS,CAAC;SAC1EgB,UAAU,EAAE,CAAE,CAAC,CAACjD,MAAM;QACtB,CAAC,CAAC;;;GACH;CAAA;;;ACjkBF,CAyB4B,IAEtB4Q,IAAI;GAET,gBACA;KAAA;KACC,IAAI,CAAChsB,MAAM,GAAG,IAAI;KAClB,IAAI,CAACQ,KAAK,GAAG,KAAK;KAClB,IAAI,CAACzJ,aAAa,GAAG,KAAK;KAC1B,IAAI,CAACk1B,cAAc,GAAG,KAAK;KAC3B,IAAI,CAACC,OAAO,GAAG,EAAE;KACjB,IAAI,CAACzuB,MAAM,GAAG;OACb0uB,aAAa,EAAE;MACf;KACD,IAAI,SAAM,GAAG;OACZC,WAAW,EAAE,iBAAiB;OAC9BC,WAAW,EAAE,WAAW;OACxBC,WAAW,EAAE,oBAAoB;OACjCC,GAAG,EAAE,gBAAgB;OAErBC,4BAA4B,EAAE,qBAAqB;OACnDC,yBAAyB,EAAE,2BAA2B;OACtDC,iBAAiB,EAAE,2BAA2B;OAC9CC,QAAQ,EAAE,YAAY;OACtBC,UAAU,EAAE,WAAW;OACvBC,eAAe,EAAE,oBAAoB;OACrCC,WAAW,EAAE,eAAe;OAC5BC,iBAAiB,EAAE,sBAAsB;OACzCC,uBAAuB,EAAE,uBAAuB;OAChDC,wBAAwB,EAAE,uBAAuB;OACjDC,wBAAwB,EAAE,mCAAmC;OAC7DC,kBAAkB,EAAE,uBAAuB;OAC3CC,sBAAsB,EAAE,4BAA4B;OACpDC,sBAAsB,EAAE,2BAA2B;OACnDC,kBAAkB,EAAE,gBAAgB;OACpCC,YAAY,EAAE,iBAAiB;OAC/B5T,mBAAmB,EAAE,wBAAwB;OAC7CD,iBAAiB,EAAE,uBAAuB;OAC1C8T,oCAAoC,EAAE,mCAAmC;OACzEC,iCAAiC,EAAE,qCAAqC;OACxEC,yBAAyB,EAAE,0BAA0B;OAErDC,aAAa,EAAE;MACf;KAED,IAAI,CAACC,gBAAgB,GAAG,IAAI;KAC5B,IAAI,CAACtO,SAAS,GAAG,CAAC;KAElB,IAAI,CAACuO,gBAAgB,GAAG,CAAC;KACzB,IAAI,CAACC,kBAAkB,GAAG,EAAE;KAE5B,IAAI,CAACC,iBAAiB,GAAG,KAAK;KAC9B,IAAI,CAACC,gBAAgB,GAAG,KAAK;KAC7B,IAAI,CAACC,mBAAmB,GAAG,KAAK;KAEhC,IAAI,CAAC/2B,IAAI,EAAE;;GACX;KAAA;KAAA,uBAGD;OAAA;OACCwD,WAAW,CAAC0B,cAAc,CAAC,yCAAyC,EAAE,IAAI,CAAC8B,YAAY,CAAC5B,IAAI,CAAC,IAAI,CAAC,CAAC;OACnG5B,WAAW,CAAC0B,cAAc,CAAC,8CAA8C,EAAE,IAAI,CAAC+B,iBAAiB,CAAC7B,IAAI,CAAC,IAAI,CAAC,CAAC;OAC7G5B,WAAW,CAAC0B,cAAc,CAAC,4CAA4C,EAAE,IAAI,CAACgC,eAAe,CAAC9B,IAAI,CAAC,IAAI,CAAC,CAAC;OACzG5B,WAAW,CAAC0B,cAAc,CAAC,iDAAiD,EAAE,IAAI,CAACiC,oBAAoB,CAAC/B,IAAI,CAAC,IAAI,CAAC,CAAC;OACnH5B,WAAW,CAAC0B,cAAc,CAAC,sBAAsB,EAAE,IAAI,CAAC8xB,UAAU,CAAC5xB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC9E5B,WAAW,CAAC0B,cAAc,CAAC,sBAAsB,EAAE,IAAI,CAAC+xB,UAAU,CAAC7xB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC9E5B,WAAW,CAAC0B,cAAc,CAAC,qBAAqB,EAAE,IAAI,CAACgjB,SAAS,CAAC9iB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC5E5B,WAAW,CAAC0B,cAAc,CAAC,oCAAoC,EAAE,IAAI,CAACgyB,UAAU,CAAC9xB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;OAC7F5B,WAAW,CAAC0B,cAAc,CAAC,8BAA8B,EAAE,IAAI,CAACiyB,mBAAmB,CAAC/xB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC/F5B,WAAW,CAAC0B,cAAc,CAAC,iCAAiC,EAAE,IAAI,CAACkyB,gBAAgB,CAAChyB,IAAI,CAAC,IAAI,CAAC,CAAC;OAE/FnF,6BAAY,CAACC,SAAS,CAAC,yBAAyB,EAAE,IAAI,CAACm3B,qBAAqB,CAACjyB,IAAI,CAAC,IAAI,CAAC,CAAC;OACxFnF,6BAAY,CAACC,SAAS,CAAC,mCAAmC,EAAE,IAAI,CAACo3B,gCAAgC,CAAClyB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC7GnF,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,IAAI,CAACq3B,mBAAmB,CAAC;OAExEr2B,QAAQ,CAACZ,gBAAgB,CAAC,kBAAkB,EAAE,YAC9C;SACCY,QAAQ,CAACZ,gBAAgB,CAAC,OAAO,EAAE,KAAI,CAACk3B,WAAW,CAACpyB,IAAI,CAAC,KAAI,CAAC,CAAC;QAC/D,CAAC;;;KACF;KAAA,6BAEY5D,MAAM,EACnB;OAAA;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAI,CAACsD,cAAI,CAACqJ,WAAW,CAAC3M,MAAM,CAACi2B,gBAAgB,CAAC,EAC9C;SACC,IAAI,CAACb,kBAAkB,GAAGp1B,MAAM,CAACi2B,gBAAgB;;OAGlDx3B,6BAAY,CAACC,SAAS,CAAC,2BAA2B,EAAE6mB,YAAY,CAACC,QAAQ,CAACsL,WAAW,CAAC;OAEtFryB,6BAAY,CAACC,SAAS,CAAC,yBAAyB,EAAE,YAAM;SACvD,MAAI,CAACuwB,eAAe,EAAE;QACtB,CAAC;OAEFxwB,6BAAY,CAACC,SAAS,CAAC,qBAAqB,EAAE,YAAM;SACnD,MAAI,CAAC22B,iBAAiB,GAAG,KAAK;SAC9B,MAAI,CAACC,gBAAgB,GAAG,KAAK;SAC7B,MAAI,CAACC,mBAAmB,GAAG,IAAI;SAC/Bp2B,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;SAC/BmmB,YAAY,CAACC,QAAQ,CAACC,UAAU,CAAC,IAAI,CAAC;QACtC,CAAC;OAEFhnB,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,UAAC8H,KAAgB,EAAK;SACpE,2BAA+BA,KAAK,CAAC0vB,aAAa,EAAE;WAAA;WAA5CC,MAAM;WAAEC,UAAU;SAE1B,IACC,CAAC9yB,cAAI,CAACqJ,WAAW,CAACwpB,MAAM,CAAC,IACtB,CAAC7yB,cAAI,CAACqJ,WAAW,CAACwpB,MAAM,CAAC,CAAC,CAAC,CAAC,IAC5B,CAAC7yB,cAAI,CAACqJ,WAAW,CAACypB,UAAU,CAAC,IAC7B,CAAC,CAACA,UAAU,EAEhB;WACC,IACC,CAAC9yB,cAAI,CAACqJ,WAAW,CAACwpB,MAAM,CAAC,CAAC,CAAC,CAACtH,KAAK,CAAC,IAC/B,CAACvrB,cAAI,CAACqJ,WAAW,CAACwpB,MAAM,CAAC,CAAC,CAAC,CAACtH,KAAK,CAACtC,EAAE,CAAC,IACrCrsB,QAAQ,CAACi2B,MAAM,CAAC,CAAC,CAAC,CAACtH,KAAK,CAACtC,EAAE,CAAC,GAAG,CAAC,EAEpC;aACC,MAAI,CAACmF,UAAU,CAAC;eACfC,YAAY,EAAEzxB,QAAQ,CAACi2B,MAAM,CAAC,CAAC,CAAC,CAACtH,KAAK,CAACtC,EAAE;cACzC,CAAC;;;SAIJhH,YAAY,CAACC,QAAQ,CAACC,UAAU,CAAC,IAAI,CAAC;SAEtC,IAAI,CAAC,CAAC2Q,UAAU,EAChB;WACCr3B,YAAY,CAAC8xB,0BAA0B,CAAC,IAAI,CAAC;;QAE9C,CAAC;OAEFpyB,6BAAY,CAACC,SAAS,CAAC,yBAAyB,EAAE,YAAM;SACvDmI,UAAU,CAAC,YAAM;WAChB,IAAI,CAAC,MAAI,CAAC0uB,mBAAmB,EAC7B;aACC,MAAI,CAACD,gBAAgB,GAAG,IAAI;aAC5Bn2B,GAAG,CAACC,IAAI,CAAC,sBAAsB,CAAC;;UAEjC,EAAE,IAAI,CAAC;QACR,CAAC;OAEFX,6BAAY,CAACC,SAAS,CAAC,0BAA0B,EAAE,YAAM;SACxDS,GAAG,CAACk3B,SAAS,CAAC;WACb3sB,OAAO,EAAE,mBAAM;aACdqL,EAAE,CAAC+P,UAAU,CAACqN,MAAM,CAAC,IAAI,CAAC;YAC1B;WACDmE,QAAQ,EAAE,oBAAM;aACf,MAAI,CAAChB,gBAAgB,GAAG,KAAK;aAC7Bn2B,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;aAC/BL,YAAY,CAACQ,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC;;UAE3C,CAAC;QACF,CAAC;OAEFd,6BAAY,CAACC,SAAS,CAAC,wBAAwB,EAAE,UAAC8H,KAAgB,EAAK;SACtE,4BAAqBA,KAAK,CAAC0vB,aAAa,EAAE;WAAA;WAAlCzsB,QAAQ;SAEhB,IACC,CAACnG,cAAI,CAACqJ,WAAW,CAAClD,QAAQ,CAAC,IACxBnG,cAAI,CAACE,cAAc,CAACiG,QAAQ,CAAC8sB,MAAM,CAAC,IACpC9sB,QAAQ,CAAC8sB,MAAM,KAAK,UAAU,EAElC;WACC,MAAI,CAACjB,gBAAgB,GAAG,KAAK;WAC7Bn2B,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;WAC/BL,YAAY,CAACQ,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC;UAC1C,MAED;WACCJ,GAAG,CAACk3B,SAAS,CAAC;aACb3sB,OAAO,EAAE,mBAAM;eACdqL,EAAE,CAAC+P,UAAU,CAACqN,MAAM,CAAC,IAAI,CAAC;cAC1B;aACDmE,QAAQ,EAAE,oBAAM;eACf,MAAI,CAAChB,gBAAgB,GAAG,KAAK;eAC7Bn2B,GAAG,CAACC,IAAI,CAAC,qBAAqB,CAAC;eAC/BL,YAAY,CAACQ,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC;;YAE3C,CAAC;;QAEH,CAAC;OAEFd,6BAAY,CAACC,SAAS,CAAC,oBAAoB,EAAE,UAAC8H,KAAgB,EAAK;SAClE,4BAAqCA,KAAK,CAAC0vB,aAAa,EAAE;WAAA;WAAlDM,aAAa;WAAEC,SAAS;SAEhC,IAAIA,SAAS,CAAChiB,KAAK,CAAC9P,MAAM,IAAI,CAAC,EAC/B;WACCoQ,EAAE,CAAC+P,UAAU,CAACqN,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC;;QAEjC,CAAC;OAEFnwB,WAAW,CAAC0B,cAAc,CAAC,aAAa,EAAE,UAAC1D,MAAM,EAAK;SACrD,MAAI,CAAC02B,SAAS,CAAC;WACdC,YAAY,EAAE32B,MAAM,CAAC42B,gBAAgB;WACrC9uB,KAAK,EAAE9H,MAAM,CAACoO,QAAQ,CAAChK,IAAI,CAAC6F;UAC5B,CAAC;QACF,CAAC;OAEFxL,6BAAY,CAACC,SAAS,CAAC,mBAAmB,EAAE,YAAM;SACjDsD,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACiW,OAAO,CAACkM,UAAU,CAAC,KAAK,CAAC;QAC7C,CAAC;OACFp4B,6BAAY,CAACC,SAAS,CAAC,kBAAkB,EAAE,YAAM;SAChDsD,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACiW,OAAO,CAACkM,UAAU,CAAC,IAAI,CAAC;QAC5C,CAAC;OAEF70B,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACiW,OAAO,CAAC5b,SAAS,CAAC;SACrC7K,QAAQ,EAAE,oBAAM;WACf,IAAI,CAAC,MAAI,CAACoxB,gBAAgB,EAC1B;aACCv2B,YAAY,CAACC,OAAO,CAAC,IAAI,CAAC;;UAE3B;SACD83B,eAAe,EAAE;QACjB,CAAC;OAEF90B,WAAW,CAACC,EAAE,CAACyS,IAAI,CAACiW,OAAO,CAACkM,UAAU,CAAC,IAAI,CAAC;;;KAC5C;KAAA,0BAEShzB,KAAK,EACf;OACC,IAAI,CAACyD,MAAM,GAAGzD,KAAK;;;KACnB;KAAA,4BAGD;OACC,OAAO,IAAI,CAACyD,MAAM;;;KAClB;KAAA,yBAEQzD,KAAK,EACd;OACC,IAAI,CAACiE,KAAK,GAAG5H,QAAQ,CAAC2D,KAAK,CAAC;;;KAC5B;KAAA,2BAGD;OACC,OAAO3D,QAAQ,CAAC,IAAI,CAAC4H,KAAK,CAAC;;;KAC3B;KAAA,2BAEUivB,WAAW,EACtB;OACC,KAAK,IAAI/yB,GAAG,IAAI+yB,WAAW,EAC3B;SACC,IAAI,CAACA,WAAW,CAACzyB,cAAc,CAACN,GAAG,CAAC,EACpC;WACC;;SAGD,IAAI,CAACwvB,OAAO,CAACxvB,GAAG,CAAC,GAAG+yB,WAAW,CAAC/yB,GAAG,CAAC;;;;KAErC;KAAA,0BAESA,GAAG,EAAEkkB,YAAY,EAC3B;OACC,IAAI5kB,cAAI,CAACqJ,WAAW,CAACub,YAAY,CAAC,EAClC;SACCA,YAAY,GAAG,IAAI;;OAGpB,IAAI,CAAC5kB,cAAI,CAACE,cAAc,CAACQ,GAAG,CAAC,EAC7B;SACC,OAAO,IAAI;;OAGZ,OAAQ,CAACV,cAAI,CAACqJ,WAAW,CAAC,IAAI,CAAC6mB,OAAO,CAACxvB,GAAG,CAAC,CAAC,GAAG,IAAI,CAACwvB,OAAO,CAACxvB,GAAG,CAAC,GAAGkkB,YAAY;;;KAC/E;KAAA,iCAEgBrkB,KAAK,EACtB;OACC,IAAI,CAACxF,aAAa,GAAGwF,KAAK;;;KAC1B;KAAA,mCAGD;OACC,OAAO,IAAI,CAACxF,aAAa;;;KACzB;KAAA,kCAEiBwF,KAAK,EACvB;OACC,IAAI,CAAC0vB,cAAc,GAAG1vB,KAAK;;;KAC3B;KAAA,oCAGD;OACC,OAAO,IAAI,CAAC0vB,cAAc;;;KAC1B;KAAA,oCAEmB1vB,KAAK,EACzB;OACC,IAAI,CAACqxB,gBAAgB,GAAGrxB,KAAK;;;KAC7B;KAAA,sCAGD;OACC,OAAO,IAAI,CAACqxB,gBAAgB;;;KAC5B;KAAA,6BAEYrxB,KAAK,EAClB;OACC,IAAI,CAAC+iB,SAAS,GAAG/iB,KAAK;;;KACtB;KAAA,+BAGD;OACC,OAAO,IAAI,CAAC+iB,SAAS;;;KACrB;KAAA,6BAEY5mB,MAAM,EACnB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAMoI,MAAM,GAAI,OAAOpI,MAAM,CAACoI,MAAM,IAAI,WAAW,GAAGlI,QAAQ,CAACF,MAAM,CAACoI,MAAM,CAAC,GAAG,CAAE;OAClF,IAAMkC,OAAO,GAAI,OAAOtK,MAAM,CAACsK,OAAO,IAAI,WAAW,GAAGtK,MAAM,CAACsK,OAAO,GAAG,EAAG;OAC5E,IAAMhD,MAAM,GAAI,OAAOtH,MAAM,CAACsH,MAAM,IAAI,WAAW,GAAGtH,MAAM,CAACsH,MAAM,GAAG,EAAG;OACzE,IAAMjF,OAAO,GAAI,OAAOrC,MAAM,CAACqC,OAAO,IAAI,WAAW,GAAGrC,MAAM,CAACqC,OAAO,GAAG,IAAK;OAE9E,IAAIiF,MAAM,KAAK,IAAI,CAACA,MAAM,EAC1B;SACC;;OAGDyP,0BAA0B,UAAO,CAAC1U,OAAO,CAAC;OAE1C,IACC+F,MAAM,IAAI,CAAC,IACR9E,cAAI,CAACE,cAAc,CAACxD,MAAM,CAAC8G,WAAW,CAAC,EAE3C;SACC;;OAGD,IAAI,CAACkwB,eAAe,CAAC;SACpBrjB,UAAU,EAAE,WAAW;SACvBC,QAAQ,EAAExL,MAAM;SAChB6uB,QAAQ,EAAEj3B,MAAM,CAACgE,GAAG;SACpBuG,MAAM,EAAE;QACR,CAAC;;;KACF;KAAA,gCAEevK,MAAM,EACtB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAMsK,OAAO,GAAI,OAAOtK,MAAM,CAACsK,OAAO,IAAI,WAAW,GAAGtK,MAAM,CAACsK,OAAO,GAAG,EAAG;OAC5E,IAAMhD,MAAM,GAAI,OAAOtH,MAAM,CAACsH,MAAM,IAAI,WAAW,GAAGtH,MAAM,CAACsH,MAAM,GAAG,EAAG;OACzE,IAAMc,MAAM,GAAI,OAAOpI,MAAM,CAACoI,MAAM,IAAI,WAAW,GAAGlI,QAAQ,CAACF,MAAM,CAACoI,MAAM,CAAC,GAAG,CAAE;OAClF,IAAM8uB,MAAM,GAAI,OAAOl3B,MAAM,CAACk3B,MAAM,IAAI,WAAW,IAAI,CAAC,CAACl3B,MAAM,CAACk3B,MAAO;OAEvE,IAAI,CAACF,eAAe,CAAC;SACpBrjB,UAAU,EAAE,WAAW;SACvBC,QAAQ,EAAExL,MAAM;SAChB6uB,QAAQ,EAAEj3B,MAAM,CAACgE,GAAG;SACpBuG,MAAM,EAAE,QAAQ;SAChB2sB,MAAM,EAAEA;QACR,CAAC;;;KACF;KAAA,kCAEiBl3B,MAAM,EACxB;OAAA;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAMsK,OAAO,GAAIhH,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACsK,OAAO,CAAC,GAAGtK,MAAM,CAACsK,OAAO,GAAG,EAAG;OAC3E,IAAMjI,OAAO,GAAIrC,MAAM,CAACqC,OAAO,GAAGrC,MAAM,CAACqC,OAAO,GAAG,EAAG;OACtD,IAAMmM,oBAAoB,GAAG;SAC5BC,OAAO,EAAE,EAAE;SACXC,QAAQ,EAAE;QACV;OAEDlC,IAAI,CAAC2qB,yBAAyB,CAC7Bn3B,MAAM,CAACoO,QAAQ,EACfI,oBAAoB,CACpB;OAEDH,0BAA0B,CAACU,SAAS,CAAC;SACpCgB,kBAAkB,EAAEvB;QACpB,CAAC;OAEFH,0BAA0B,CAACU,SAAS,CAAC;SACpCC,WAAW,EAAEhP,MAAM,CAACoO,QAAQ,CAACgJ;QAC7B,CAAC;OAEFL,0BAA0B,CAACqgB,IAAI,CAACp3B,MAAM,CAACoO,QAAQ,EAAE/L,OAAO,CAAC;OAEzDrC,MAAM,CAACkE,QAAQ,GAAG,YAClB;SACC,IAAI6G,kBAAkB,CAACC,aAAa,EAAE,IAAI,MAAI,CAACA,aAAa,CAAC,gBAAgB,CAAC,EAC9E;WACCkD,uBAAuB,CAAClQ,IAAI,CAAC;aAC5BsJ,MAAM,EAAE,MAAI,CAACE,SAAS,EAAE;aACxBY,MAAM,EAAE;YACR,CAAC;UACF,MAED;WACCjJ,GAAG,CAACC,IAAI,CAAC,cAAc,EAAEiP,0BAA0B,CAACrQ,IAAI,EAAE,CAAC;;QAE5D;OACD,IAAI,CAACq5B,aAAa,CAACr3B,MAAM,CAAC;;;KAC1B;KAAA,qCAEoBA,MAAM,EAC3B;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAMsK,OAAO,GAAIhH,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACsK,OAAO,CAAC,GAAGtK,MAAM,CAACsK,OAAO,GAAG,EAAG;OAE3EtK,MAAM,CAACkE,QAAQ,GAAG,YAClB;SACCwI,WAAQ,CAACgG,IAAI,CAAC;WACbtK,MAAM,EAAElI,QAAQ,CAACF,MAAM,CAACoI,MAAM;UAC9B,CAAC;QACF;OACD,IAAI,CAACivB,aAAa,CAACr3B,MAAM,CAAC;;;KAC1B;KAAA,8BAEaA,MAAM,EACpB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZA,MAAM,CAACkE,QAAQ,GAAIZ,cAAI,CAAC+M,UAAU,CAACrQ,MAAM,CAACkE,QAAQ,CAAC,GAAGlE,MAAM,CAACkE,QAAQ,GAAG,YACxE,EACE;OAEF,IAAMozB,SAAS,GAAIh0B,cAAI,CAACE,cAAc,CAACxD,MAAM,CAACs3B,SAAS,CAAC,GAAGt3B,MAAM,CAACs3B,SAAS,GAAG,KAAM;OAEpFvH,uBAAuB,CAACwH,SAAS,CAAC;SACjC71B,IAAI,EAAG41B,SAAS,GAAGA,SAAS,GAAGz2B,aAAG,CAACC,UAAU,CAAC,uCAAuC,CAAE;SACvF4B,KAAK,EAAE,eAAC80B,kBAAkB,EAC1B;WACCx3B,MAAM,CAACkE,QAAQ,CAACszB,kBAAkB,CAAC;;QAEpC,CAAC;;;KACF;KAAA,2BAEUx3B,MAAM,EACjB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IACCA,MAAM,CAACsH,MAAM,IACV,IAAI,CAACA,MAAM,KAAK,IAAI,IACpBtH,MAAM,CAACsH,MAAM,IAAI,IAAI,CAACA,MAAM,EAEhC;SACC;;OAGDnI,GAAG,CAAC4N,eAAe,CAAC;SACnBrL,IAAI,EACH4B,cAAI,CAACE,cAAc,CAACxD,MAAM,CAAC0B,IAAI,CAAC,GAC7B1B,MAAM,CAAC0B,IAAI,GACX;QAEJ,CAAC;;;KACF;KAAA,6BAGD;OACCvC,GAAG,CAACwO,eAAe,EAAE;;;KACrB;KAAA,0BAES3N,MAAM,EAChB;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IACCA,MAAM,CAACsH,MAAM,IACV,IAAI,CAACA,MAAM,KAAK,IAAI,IACpBtH,MAAM,CAACsH,MAAM,IAAI,IAAI,CAACA,MAAM,EAEhC;SACC;;OAGDnB,MAAM,CAACwB,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;;;KACrB;KAAA,gCAEe3H,MAAM,EACtB;OAAA;OACC,IAAI,CAACsD,cAAI,CAACC,aAAa,CAACvD,MAAM,CAAC,EAC/B;SACCA,MAAM,GAAG,EAAE;;OAGZ,IAAM8H,KAAK,GAAI9H,MAAM,CAAC8H,KAAK,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAE;OAEzD,IACCA,KAAK,IAAI,CAAC,IACP,EACFxE,cAAI,CAACE,cAAc,CAACxD,MAAM,CAAC2T,UAAU,CAAC,IACnCzT,QAAQ,CAACF,MAAM,CAAC4T,QAAQ,CAAC,GAAG,CAAC,CAChC,EAEF;SACC;;OAGDzK,gBAAI,CAACsuB,kBAAkB,CAAC,oCAAoC,EAAE,iBAAiB,EAAE;SAChFC,IAAI,EAAE,OAAO;SACbC,gBAAgB,EAAE,IAAI,CAACphB,SAAS,CAAC,kBAAkB,EAAE,EAAE,CAAC;SACxDnS,IAAI,EAAE;WACLpE,MAAM,EAAE;aACP8H,KAAK,EAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAC,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAE;aAChEovB,MAAM,EAAG,CAAC,CAACl3B,MAAM,CAACk3B,MAAM,GAAG,GAAG,GAAG,GAAI;aACrCvjB,UAAU,EAAGrQ,cAAI,CAACE,cAAc,CAACxD,MAAM,CAAC2T,UAAU,CAAC,GAAG3T,MAAM,CAAC2T,UAAU,GAAG,EAAG;aAC7EC,QAAQ,EAAG1T,QAAQ,CAACF,MAAM,CAAC4T,QAAQ,CAAC,GAAG,CAAC,GAAG1T,QAAQ,CAACF,MAAM,CAAC4T,QAAQ,CAAC,GAAG,CAAE;aACzEgkB,cAAc,EAAE/2B,aAAG,CAACC,UAAU,CAAC,sCAAsC;;;QAGvE,CAAC,CAAC0I,IAAI,CAAC,UAACC,QAAQ,EACjB;SACC,IAAI3B,KAAK,IAAI,CAAC,EACd;WACCqB,gBAAI,CAACsuB,kBAAkB,CAAC,oCAAoC,EAAE,eAAe,EAAE;aAC9EC,IAAI,EAAE,OAAO;aACbtzB,IAAI,EAAE;eACLpE,MAAM,EAAE;iBACP2T,UAAU,EAAGrQ,cAAI,CAACE,cAAc,CAACxD,MAAM,CAAC2T,UAAU,CAAC,GAAG3T,MAAM,CAAC2T,UAAU,GAAG,EAAG;iBAC7EC,QAAQ,EAAG1T,QAAQ,CAACF,MAAM,CAAC4T,QAAQ,CAAC,GAAG,CAAC,GAAG1T,QAAQ,CAACF,MAAM,CAAC4T,QAAQ,CAAC,GAAG;;;YAGzE,CAAC,CAACpK,IAAI,CAAC,UAACquB,aAAa,EACtB;aACC,IAAIA,aAAa,CAACzzB,IAAI,CAAC0D,KAAK,EAC5B;eACC,MAAI,CAACgwB,UAAU,CAAC;iBACfhwB,KAAK,EAAE+vB,aAAa,CAACzzB,IAAI,CAAC0D,KAAK;iBAC/BiwB,OAAO,EAAEtuB,QAAQ,CAACrF,IAAI,CAAC+gB,IAAI;iBAC3B/c,MAAM,EAAEpI,MAAM,CAACoI,MAAM;iBACrB6uB,QAAQ,EAAEj3B,MAAM,CAACi3B,QAAQ;iBACzB1sB,MAAM,EAAEvK,MAAM,CAACuK,MAAM;iBACrBknB,eAAe,EAAEvxB,QAAQ,CAACuJ,QAAQ,CAACrF,IAAI,CAAC4zB,eAAe,CAACvG,eAAe;gBACvE,CAAC;;YAEH,CAAC;UACF,MAED;WACC,MAAI,CAACqG,UAAU,CAAC;aACfhwB,KAAK,EAAEA,KAAK;aACZiwB,OAAO,EAAEtuB,QAAQ,CAACrF,IAAI,CAAC+gB,IAAI;aAC3B/c,MAAM,EAAEpI,MAAM,CAACoI,MAAM;aACrB6uB,QAAQ,EAAEj3B,MAAM,CAACi3B,QAAQ;aACzB1sB,MAAM,EAAEvK,MAAM,CAACuK,MAAM;aACrBknB,eAAe,EAAEvxB,QAAQ,CAACuJ,QAAQ,CAACrF,IAAI,CAAC4zB,eAAe,CAACvG,eAAe;YACvE,CAAC;;QAEH,CAAC;;;KACF;KAAA,mCAEkBwG,aAAa,EAAEC,cAAc,EAAEC,QAAQ,EAC1D;OACC,IACC,CAACF,aAAa,IACX,CAACC,cAAc,EAEnB;SACC,OAAOthB,OAAO,CAACE,MAAM,EAAE;;OAGxB,IAAMihB,OAAO,GAAGG,cAAc,CAAC3W,aAAa,CAAC4W,QAAQ,CAAC;OACtD,IAAMnzB,SAAS,GAAGizB,aAAa,CAAC1W,aAAa,CAAC4W,QAAQ,CAAC;OAEvD,IAAInzB,SAAS,IAAI+yB,OAAO,EACxB;SACC,OAAO7S,iBAAO,CAACC,IAAI,CAACngB,SAAS,EAAE+yB,OAAO,CAACr3B,SAAS,CAAC;;OAGlD,OAAOkW,OAAO,CAACE,MAAM,EAAE;;;KACvB;KAAA,2BAEU9W,MAAM,EACjB;OAAA;OACC,IAAMiG,aAAa,GAAGvG,QAAQ,CAACC,cAAc,CAAC,IAAI,CAACoF,MAAM,CAAC0uB,aAAa,CAAC;OACxE,IAAMsE,OAAO,GAAG/3B,MAAM,CAAC+3B,OAAO;OAC9B,IAAMjwB,KAAK,GAAG9H,MAAM,CAAC8H,KAAK;OAC1B,IAAMmvB,QAAQ,GAAGj3B,MAAM,CAACi3B,QAAQ;OAChC,IAAM1sB,MAAM,GAAGvK,MAAM,CAACuK,MAAM;OAE5B,IACC,CAACjH,cAAI,CAAC4C,SAAS,CAACD,aAAa,CAAC,IAC3B,CAAC3C,cAAI,CAACE,cAAc,CAACu0B,OAAO,CAAC,EAEjC;SACC;;OAGD,IAAMtG,eAAe,GACpB,OAAQzxB,MAAM,CAACyxB,eAAgB,IAAI,WAAW,IAC3CvxB,QAAQ,CAACF,MAAM,CAACyxB,eAAe,CAAC,GAAG,CAAC,GACpCvxB,QAAQ,CAACF,MAAM,CAACyxB,eAAe,CAAC,GAChC,CACH;OAED,IAAIlnB,MAAM,KAAK,QAAQ,EACvB;SACC,IAAI0tB,aAAa,GAAGv4B,QAAQ,CAACC,cAAc,CAAC,aAAa,GAAGmI,KAAK,CAAC;SAClE,IAAI,CAACmwB,aAAa,EAClB;WACCA,aAAa,GAAGv4B,QAAQ,CAACC,cAAc,CAAC,YAAY,CAAC;;SAGtD,IAAI,CAACs4B,aAAa,EAClB;WACC;;SAGD,IAAMrgB,OAAO,GAAG,IAAI,CAACtQ,MAAM,CAACuQ,KAAK,CAAC,gBAAgB,CAAC;SACnD,IACCD,OAAO,IACJ9P,KAAK,IAAI8P,OAAO,CAAC,CAAC,CAAC,EAEvB;WACC;;SAGD,IAAMsgB,cAAc,GAAGD,aAAa,CAACrN,WAAW,CAAClrB,QAAQ,CAAC04B,aAAa,CAAC,KAAK,CAAC,CAAC;SAC/EF,cAAc,CAACxgB,KAAK,CAACiW,OAAO,GAAG,MAAM;SACrCzI,iBAAO,CAACC,IAAI,CAAC+S,cAAc,EAAEH,OAAO,CAAC;SAErC,IAAIE,aAAa,CAACt1B,EAAE,KAAK,YAAY;;WACrC;aACC,IAAI,CAAC01B,kBAAkB,CAACJ,aAAa,EAAEC,cAAc,aAAM,IAAI,SAAM,CAAC9D,WAAW,EAAG;aACpF,IAAI,CAACiE,kBAAkB,CAACJ,aAAa,EAAEC,cAAc,aAAM,IAAI,SAAM,CAAC7D,iBAAiB,EAAG,CAAC7qB,IAAI,CAAC,YAChG;eACC,IAAM8uB,aAAa,GAAGL,aAAa,CAAC1W,aAAa,YAAK,MAAI,SAAM,CAAC8S,iBAAiB,EAAG;eACrF,IAAMkE,eAAe,GAAGL,cAAc,CAAC3W,aAAa,YAAK,MAAI,SAAM,CAAC8S,iBAAiB,EAAG;eAExF,IAAIiE,aAAa,IAAIC,eAAe,EACpC;iBACC,IAAMC,aAAa,GAAG,MAAI,CAACC,wBAAwB,CAACH,aAAa,CAACz4B,SAAS,CAAC;iBAC5E,IAAM64B,eAAe,GAAG,MAAI,CAACD,wBAAwB,CAACF,eAAe,CAAC14B,SAAS,CAAC;iBAEhF24B,aAAa,CAAC32B,OAAO,CAAC,UAAC0rB,SAAS,EAAK;mBACpC+K,aAAa,CAACz4B,SAAS,CAACE,MAAM,CAACwtB,SAAS,CAAC;kBACzC,CAAC;iBACFmL,eAAe,CAAC72B,OAAO,CAAC,UAAC0rB,SAAS,EAAK;mBACtC+K,aAAa,CAACz4B,SAAS,CAACC,GAAG,CAACytB,SAAS,CAAC;kBACtC,CAAC;;eAGHhI,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE;cAClC,CAAC;aACF,IAAI,CAAC4S,kBAAkB,CAACJ,aAAa,EAAEC,cAAc,aAAM,IAAI,SAAM,CAAC1D,wBAAwB,EAAG,CAAChrB,IAAI,CAAC,YACvG;eACC+b,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE;cAClC,CAAC;aACF,IAAI,CAAC4S,kBAAkB,CAACJ,aAAa,EAAEC,cAAc,aAAM,IAAI,SAAM,CAACzD,kBAAkB,EAAG;aAC3F,IAAI,CAAC4D,kBAAkB,CAACJ,aAAa,EAAEC,cAAc,aAAM,IAAI,SAAM,CAACxD,sBAAsB,EAAG;YAC/F,MAED;WACCuD,aAAa,GAAGA,aAAa,CAAC1W,aAAa,eAAQ,IAAI,SAAM,CAAC4S,eAAe,EAAG;WAEhF,IAAMwE,sBAAsB,GAAGT,cAAc,CAAC3W,aAAa,eAAQ,IAAI,SAAM,CAAC4S,eAAe,EAAG;WAEhGjP,iBAAO,CAACC,IAAI,CAAC8S,aAAa,EAAEU,sBAAsB,CAACj4B,SAAS,CAAC,CAAC8I,IAAI,CAAC,YAAM;aACxEgD,IAAI,CAAC2iB,gBAAgB,EAAE;aACvB5J,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE;aAElC,IAAI/lB,QAAQ,CAACC,cAAc,CAAC,uBAAuB,CAAC,EACpD;eACCkH,UAAU,CAAC,YAAM;iBAChB,MAAI,CAAC+qB,gBAAgB,CAAC;mBACrBC,SAAS,EAAEJ;kBACX,CAAC;gBACF,EAAE,GAAG,CAAC;;YAER,CAAC;;SAGHyG,cAAc,CAACn4B,MAAM,EAAE;QACvB,MACI,IAAIwK,MAAM,KAAK,KAAK,EACzB;SACC,IAAI,CAACquB,mBAAmB,CAAC3xB,aAAG,CAACC,MAAM,8IAAe,IAAI,SAAM,CAAC4sB,4BAA4B,EAAI,IAAI,SAAM,CAACE,iBAAiB,EAAsB,IAAI,CAAC6E,6BAA6B,CAACj1B,IAAI,CAAC,IAAI,CAAC,EAAW;SACvMuD,aAAG,CAACgc,OAAO,CAAC,IAAI,CAAC2V,mBAAmB,EAAE,EAAE7yB,aAAa,CAAC;SACtD8yB,kBAAK,CAACC,gBAAgB,CAAC,IAAI,CAACF,mBAAmB,EAAE,EAAEf,OAAO,CAAC,CAACvuB,IAAI,CAAC,YACjE;WACC,IAAMgB,QAAQ,GAAG,MAAI,CAACsuB,mBAAmB,EAAE,CAACvX,aAAa,eAAQ,MAAI,SAAM,CAAC0S,QAAQ,EAAG;WACvF9sB,aAAG,CAACuQ,KAAK,CAAC,MAAI,CAACohB,mBAAmB,EAAE,EAAE,QAAQ,YAAKtuB,QAAQ,CAAC3C,YAAY,GAAG,EAAE,0BAAsB;WAEnG,IAAI4pB,eAAe,GAAG,CAAC,EACvB;aACC,MAAI,CAACC,UAAU,CAAC;eACfC,YAAY,EAAEF;cACd,CAAC;;WAGHjlB,IAAI,CAAC0iB,qBAAqB,EAAE;WAC5BroB,UAAU,CAAC,YAAM;aAAE2F,IAAI,CAAC2iB,gBAAgB,EAAE;YAAG,EAAE,GAAG,CAAC;WAEnDtoB,UAAU,CAAC,YAAM;aAChB,MAAI,CAAC+qB,gBAAgB,CAAC;eACrBC,SAAS,EAAEJ;cACX,CAAC;YACF,EAAE,GAAG,CAAC;UACP,CAAC;;OAGHwH,wBAAwB,CAACvU,IAAI,CAAC,gBAAgB,EAAE,IAAIC,0BAAS,CAAC;SAC7DvgB,IAAI,EAAE;WACLJ,GAAG,EAAEizB;;QAEN,CAAC,CAAC;;;KACH;KAAA,2BAEUj3B,MAAM,EACjB;OACC,IAAM8H,KAAK,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC;OAEpC,IAAIA,KAAK,IAAI,CAAC,EACd;SACC;;OAGD,IAAMoxB,QAAQ,GAAGx5B,QAAQ,CAACC,cAAc,CAAC,aAAa,GAAGmI,KAAK,CAAC;OAE/D,IAAI,CAACoxB,QAAQ,EACb;SACC;;OAGDA,QAAQ,CAACn5B,MAAM,EAAE;;;KACjB;KAAA,yCAEwBF,SAAS,EAClC;OACC,IAAM0Q,MAAM,GAAG,EAAE;OAEjBiI,KAAK,CAACqJ,IAAI,CAAChiB,SAAS,CAAC,CAACgC,OAAO,CAAC,UAAC0rB,SAAS,EAAK;SAC5C,IACCA,SAAS,KAAK,uBAAuB,IAClCA,SAAS,KAAK,kCAAkC,IAChDA,SAAS,KAAK,sBAAsB,IACpCA,SAAS,KAAK,sBAAsB,IACpCA,SAAS,KAAK,wBAAwB,IACtCA,SAAS,CAAC1V,KAAK,CAAC,4BAA4B,CAAC,IAC7C0V,SAAS,CAAC1V,KAAK,CAAC,8BAA8B,CAAC,EAEnD;WACCtH,MAAM,CAACzN,IAAI,CAACyqB,SAAS,CAAC;;QAEvB,CAAC;OAEF,OAAOhd,MAAM;;;KACb;KAAA,8CAE6B/J,KAAK,EACnC;OACC,IAAIA,KAAK,CAAC2yB,YAAY,KAAK,QAAQ,EACnC;SACC,IAAI,CAACL,mBAAmB,EAAE,CAACj5B,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAAC+zB,4BAA4B,CAAC;SACpF,IAAI,CAACgF,mBAAmB,EAAE,CAACj5B,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACg0B,yBAAyB,CAAC;SACjF5sB,aAAG,CAACuQ,KAAK,CAAC,IAAI,CAACohB,mBAAmB,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC;SAErD,IAAI,CAAC7J,eAAe,EAAE;SACtB1J,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE;;;;KAEnC;KAAA,sCAEqBjf,KAAK,EAC3B;OAAA;OACC,IAAI,CAACyoB,eAAe,EAAE;OAEtB,qBAAoBzoB,KAAK,CAAC2H,OAAO,EAAE;SAAA;SAA5BirB,SAAS;OAChB,IAAIA,SAAS,EACb;SACC,IAAMC,aAAa,GAAGD,SAAS,CAAC3uB,OAAO,YAAK,IAAI,SAAM,CAACupB,iBAAiB,EAAG;SAC3E,IAAIqF,aAAa,EACjB;WACC,IAAM7uB,QAAQ,GAAG6uB,aAAa,CAAC9X,aAAa,eAAQ,IAAI,SAAM,CAAC0S,QAAQ,EAAG;WAE1E,IAAIzpB,QAAQ,EACZ;aACC6uB,aAAa,CAACx5B,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACi0B,yBAAyB,CAAC;aACjE5sB,aAAG,CAACuQ,KAAK,CAAC2hB,aAAa,EAAE,QAAQ,YAAK7uB,QAAQ,CAAC3C,YAAY,QAAK;aAChEhB,UAAU,CAAC,YACX;eACCwyB,aAAa,CAACx5B,SAAS,CAACE,MAAM,CAAC,MAAI,SAAM,CAACg0B,yBAAyB,CAAC;eACpE5sB,aAAG,CAACuQ,KAAK,CAAC2hB,aAAa,EAAE,QAAQ,EAAE,IAAI,CAAC;cACxC,EAAE,GAAG,CAAC;;;;;;KAIV;KAAA,kCAGD;OACC,IAAI,CAACC,YAAY,CAAC55B,QAAQ,CAACmnB,eAAe,CAAChf,YAAY,GAAI,CAAC,GAAG1B,MAAM,CAAC2gB,WAAY,CAAC;;;KACnF;KAAA,mDAGD;OACC,IAAI,CAACmI,eAAe,EAAE;;;KACtB;KAAA,oCAEmBjvB,MAAM,EAC1B;OACC,IAAM8H,KAAK,GAAI9H,MAAM,CAAC8H,KAAK,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAE;OACzD,IAAMjE,KAAK,GAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAACqX,OAAO,CAAClb,MAAM,CAAC6D,KAAK,CAAC,KAAK,CAAC,CAAC,GAAG7D,MAAM,CAAC6D,KAAK,GAAG,IAAK;OAE7E,IACC,CAACiE,KAAK,IACH,CAACjE,KAAK,IACN,CAACytB,mBAAmB,CAAC3P,kBAAkB,EAAE,EAE7C;SACC;;OAGD,IAAInX,QAAQ,GAAIlH,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAACwK,QAAQ,CAAC,GAAGxK,MAAM,CAACwK,QAAQ,GAAE,IAAK;OACxE,IAAI,CAAClH,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAACwK,QAAQ,CAAC;;SACpC;WACCA,QAAQ,GAAG9K,QAAQ,CAACC,cAAc,sBAAemI,KAAK,EAAG;;OAG1D,IAAI,CAACxE,cAAI,CAAC4C,SAAS,CAACsE,QAAQ,CAAC,EAC7B;SACC;;OAGD,IAAI3G,KAAK,KAAK,GAAG,EACjB;SACCytB,mBAAmB,CAACiI,YAAY,CAAC;WAChCzxB,KAAK,EAAEA,KAAK;WACZ0C,QAAQ,EAAEA,QAAQ;WAClBvE,aAAa,EAAEvG,QAAQ,CAACC,cAAc,CAAC,IAAI,CAACoF,MAAM,CAAC0uB,aAAa;UAChE,CAAC;QACF,MACI,IACJ5vB,KAAK,KAAK,GAAG,IACVP,cAAI,CAAC4C,SAAS,CAAClG,MAAM,CAACwK,QAAQ,CAAC,EAEnC;SACCrL,GAAG,CAAC4N,eAAe,CAAC;WAACrL,IAAI,EAAC;UAAG,CAAC;SAE9B,IAAI,IAAI,CAAC6U,SAAS,CAAC,yBAAyB,EAAE,KAAK,CAAC,KAAK,IAAI,EAC7D;WACC;;SAGD,IAAMiM,WAAW,GAAGhY,QAAQ,CAACzB,YAAY,CAAC,0BAA0B,CAAC;SACrE,IAAM0Z,UAAU,GAAGjY,QAAQ,CAACzB,YAAY,CAAC,yBAAyB,CAAC;SAEnEuoB,mBAAmB,CAACkI,aAAa,CAAC;WACjC1xB,KAAK,EAAEA,KAAK;WACZ0a,WAAW,EAAEA,WAAW;WACxBC,UAAU,EAAEA;UACZ,CAAC,CAACjZ,IAAI,CAAC,UAACiwB,UAAU,EAAK;WACvBt6B,GAAG,CAACwO,eAAe,EAAE;WAErB2jB,mBAAmB,CAACoI,WAAW,CAAC;aAC/B5xB,KAAK,EAAEA,KAAK;aACZ0C,QAAQ,EAAExK,MAAM,CAACwK,QAAQ;aACzBoY,aAAa,EAAE6W;YACf,CAAC;UAEF,EAAE,UAAChwB,QAAQ,EAAK;WAChBtK,GAAG,CAACwO,eAAe,EAAE;UACrB,CAAC;;;;KAEH;KAAA,iCAEgB3N,MAAM,EACvB;OACC,IAAM8H,KAAK,GAAI9H,MAAM,CAAC8H,KAAK,GAAG5H,QAAQ,CAACF,MAAM,CAAC8H,KAAK,CAAC,GAAG,CAAE;OACzD,IAAMjE,KAAK,GAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAACqX,OAAO,CAAClb,MAAM,CAAC6D,KAAK,CAAC,KAAK,CAAC,CAAC,GAAG7D,MAAM,CAAC6D,KAAK,GAAG,IAAK;OAE7E,IACC,CAACiE,KAAK,IACH,CAACjE,KAAK,EAEV;SACC;;OAGD,IAAMwG,QAAQ,GAAG3K,QAAQ,CAACC,cAAc,CAAC,iBAAiB,GAAGmI,KAAK,CAAC;OACnE,IAAI,CAACuC,QAAQ,EACb;SACC;;OAGD,IAAIG,QAAQ,GAAGH,QAAQ,CAACI,OAAO,YAAK,IAAI,SAAM,CAACypB,UAAU,EAAG;OAC5D,IAAI,CAAC1pB,QAAQ,EACb;SACCA,QAAQ,GAAGH,QAAQ,CAACI,OAAO,YAAK,IAAI,SAAM,CAACwpB,QAAQ,EAAG;;OAEvD,IAAI,CAACzpB,QAAQ,EACb;SACC;;OAGD,IAAI3G,KAAK,KAAK,GAAG,EACjB;SACC2G,QAAQ,CAAC3K,SAAS,CAACC,GAAG,CAAC,IAAI,SAAM,CAACkhB,iBAAiB,CAAC;QACpD,MAED;SACCxW,QAAQ,CAAC3K,SAAS,CAACE,MAAM,CAAC,IAAI,SAAM,CAACihB,iBAAiB,CAAC;;;;KAExD;KAAA,4BAEW9f,CAAC,EACb;OACC,IAAIA,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAAC4qB,GAAG,CAAC,EAC/C;SACC,IAAI5c,IAAI,GAAG,IAAI;SACf,IAAI5M,QAAQ,GAAG,IAAI;SACnB,IAAIC,OAAO,GAAG,MAAM;SAEpB,IAAIE,QAAQ,GAAGtJ,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACwpB,QAAQ,EAAG;SAC1D,IAAIzpB,QAAQ;;WACZ;aACCH,QAAQ,GAAGG,QAAQ,CAAC+W,aAAa,CAAC,yBAAyB,CAAC;aAC5DtK,IAAI,GAAG,IAAI,CAAC0iB,eAAe,CAACnvB,QAAQ,CAAC;YACrC;;WAED;aACCF,OAAO,GAAG,QAAQ;aAClBE,QAAQ,GAAGtJ,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACypB,UAAU,EAAG;aACxD,IAAI1pB,QAAQ,EACZ;eACCH,QAAQ,GAAGG,QAAQ,CAAC+W,aAAa,CAAC,yBAAyB,CAAC;eAC5D,IAAIlX,QAAQ,EACZ;iBACC4M,IAAI,GAAG,IAAI,CAAC2iB,gBAAgB,CAACvvB,QAAQ,CAACtB,YAAY,CAAC,aAAa,CAAC,CAAC;;;;SAKrE,IACCkO,IAAI,IACD5M,QAAQ,EAEZ;WACC,OAAO4M,IAAI,CAACvF,SAAS,CAAC;aACrBrH,QAAQ,EAARA,QAAQ;aACRC,OAAO,EAAPA;YACA,CAAC;;SAGHpJ,CAAC,CAACkJ,eAAe,EAAE;SACnB,OAAOlJ,CAAC,CAACiJ,cAAc,EAAE;QACzB,MACI,IAAIjJ,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAACgsB,aAAa,CAAC,EAC9D;SACC,IAAIlqB,kBAAkB,CAACC,aAAa,EAAE,IAAI,IAAI,CAACA,aAAa,CAAC,gBAAgB,CAAC,EAC9E;WACC,IAAM6uB,WAAW,GAAG,IAAI7jB,eAAe,EAAE;WACzC6jB,WAAW,CAAC77B,IAAI,CAAC;aAChBsJ,MAAM,EAAE,IAAI,CAACE,SAAS,EAAE;aACxBnF,OAAO,EAAE,IAAI,CAACkU,SAAS,CAAC,SAAS,EAAE,CAAC;YACpC,CAAC;UACF,MAED;WACCpX,GAAG,CAACC,IAAI,CAAC,cAAc,EAAEiP,0BAA0B,CAACrQ,IAAI,EAAE,CAAC;;QAE5D,MACI,IACJkD,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,YAAKojB,kBAAkB,SAAM,CAACpG,YAAY,EAAG,IACrE/kB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK4hB,kBAAkB,SAAM,CAACpG,YAAY,EAAG,EAEjE;SACC,IACC/kB,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,YAAKojB,kBAAkB,SAAM,CAACnG,eAAe,EAAG,IACxEhlB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK4hB,kBAAkB,SAAM,CAACnG,eAAe,EAAG,EAEpE;WACCmG,kBAAkB,CAAC1kB,QAAQ,CAAC,KAAK,CAAC;UAClC,MACI,IACJzG,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,YAAKojB,kBAAkB,SAAM,CAAClG,kBAAkB,EAAG,IAC3EjlB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK4hB,kBAAkB,SAAM,CAAClG,kBAAkB,EAAG,EAEvE;WACCkG,kBAAkB,CAAC1kB,QAAQ,CAAC,QAAQ,CAAC;;QAEtC,MACI,IACJ,CACCzG,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACipB,WAAW,EAAG,IAC3CxyB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACmpB,WAAW,EAAG,KAE/C,EACF1yB,CAAC,CAACqQ,MAAM,CAACuoB,OAAO,CAAC5G,WAAW,EAAE,KAAK,GAAG,IACnC5vB,cAAI,CAACE,cAAc,CAACtC,CAAC,CAACqQ,MAAM,CAACxI,YAAY,CAAC,QAAQ,CAAC,CAAC,IACpD7H,CAAC,CAACqQ,MAAM,CAACxI,YAAY,CAAC,QAAQ,CAAC,CAACmqB,WAAW,EAAE,KAAK,QAAQ,CAC7D,EAEF;SACC,IAAM6G,gBAAgB,GAAG,CAAC,EACzB74B,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAACgY,mBAAmB,CAAC,IACxD/f,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACwW,mBAAmB,EAAG,CACzD;SACD,IAAM+Y,gBAAgB,GAAG,CAAC,EAAE,CAACD,gBAAgB,KAC5C74B,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAACqrB,uBAAuB,CAAC,IAC5DpzB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAAC6pB,uBAAuB,EAAG,IAC1DpzB,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAACsrB,wBAAwB,CAAC;YAChErzB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAAC8pB,wBAAwB,EAAG,CAC9D,CAAC;SACF,IAAM0F,gBAAgB,GAAG,CAAC,EAAE,CAACF,gBAAgB,IAAI,CAACC,gBAAgB,KACjE94B,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAAC0rB,sBAAsB,CAAC,IAC3DzzB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACkqB,sBAAsB,EAAG,CAC5D,CAAC;SACF,IAAMuF,gBAAgB,GAAG,CAAC,EAAE,CAACH,gBAAgB,IAAI,CAACC,gBAAgB,IAAI,CAACC,gBAAgB,KACtF/4B,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAAC2rB,kBAAkB,CAAC,IACvD1zB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACmqB,kBAAkB,EAAG,CACxD,CAAC;SAEF,IACCmF,gBAAgB,IACbC,gBAAgB,IAChBC,gBAAgB,IAChBC,gBAAgB,EAEpB;WACC,IAAM1vB,SAAQ,GAAGtJ,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACwpB,QAAQ,EAAG;WAC5D,IAAIzpB,SAAQ,EACZ;aACC,IAAMyM,KAAI,GAAG,IAAI,CAAC0iB,eAAe,CAACnvB,SAAQ,CAAC;aAC3C,IAAIyM,KAAI,EACR;eACCA,KAAI,CAACkjB,UAAU,CAAC;iBACfxvB,eAAe,EAAE,IAAI,CAAC4L,SAAS,CAAC,iBAAiB,EAAE,EAAE,CAAC;iBACtD3L,mBAAmB,EAAE,IAAI,CAAC2L,SAAS,CAAC,qBAAqB,EAAE,EAAE,CAAC;iBAC9D1L,iBAAiB,EAAE,IAAI,CAAC0L,SAAS,CAAC,mBAAmB,EAAE,EAAE,CAAC;iBAC1D/P,KAAK,EAAEtF,CAAC;iBACR4J,aAAa,EAAEmvB,gBAAgB;iBAC/BvxB,QAAQ,EAAEwxB;gBACV,CAAC;;;WAIJh5B,CAAC,CAACkJ,eAAe,EAAE;WACnB,OAAOlJ,CAAC,CAACiJ,cAAc,EAAE;;QAE1B,MACI,IAAIjJ,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACkpB,WAAW,EAAG,EACvD;SACC,IAAMyG,MAAM,GAAG,CAAC,EACfl5B,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAAC2rB,kBAAkB,CAAC,IACvD1zB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACmqB,kBAAkB,EAAG,IACrD1zB,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAAC4rB,YAAY,CAAC,IACpD3zB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACoqB,YAAY,EAAG,CAClD;SAED,IAAIC,oCAAoC,GAAG,IAAI;SAC/C,IAAI5zB,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAAC6rB,oCAAoC,CAAC,EAChF;WACCA,oCAAoC,GAAG5zB,CAAC,CAACqQ,MAAM;UAC/C,MAED;WACCujB,oCAAoC,GAAG5zB,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACqqB,oCAAoC,EAAG;;SAG/G,IACCsF,MAAM,IACH92B,cAAI,CAAC4C,SAAS,CAAC4uB,oCAAoC,CAAC,EAExD;WACC,IAAIxxB,cAAI,CAAC4C,SAAS,CAAC4uB,oCAAoC,CAAC,EACxD;aACCA,oCAAoC,CAACpd,KAAK,CAACiW,OAAO,GAAG,MAAM;aAC3D,IAAMoH,iCAAiC,GAAGD,oCAAoC,CAAC7R,UAAU,CAAC1B,aAAa,YAAK,IAAI,SAAM,CAACwT,iCAAiC,EAAG;aAC3J,IAAIA,iCAAiC,EACrC;eACCA,iCAAiC,CAACrd,KAAK,CAACiW,OAAO,GAAG,OAAO;;;WAI3D,IAAM7lB,KAAK,GAAG,IAAI,CAACyO,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC;WACxC,IAAMU,MAAI,GAAG,IAAIvP,OAAI,CAAC;aACrBI,KAAK,EAAEA;YACP,CAAC;WAEFmP,MAAI,CAACxK,UAAU,EAAE;WAEjBvL,CAAC,CAACkJ,eAAe,EAAE;WACnB,OAAOlJ,CAAC,CAACiJ,cAAc,EAAE;;SAG1B,IAAIkwB,qBAAqB,GAAG,IAAI;SAChC,IAAIn5B,CAAC,CAACqQ,MAAM,CAAC1R,SAAS,CAACoJ,QAAQ,CAAC,IAAI,SAAM,CAAC+rB,yBAAyB,CAAC,EACrE;WACCqF,qBAAqB,GAAGn5B,CAAC,CAACqQ,MAAM;UAChC,MAED;WACC8oB,qBAAqB,GAAGn5B,CAAC,CAACqQ,MAAM,CAAC9G,OAAO,YAAK,IAAI,SAAM,CAACuqB,yBAAyB,EAAG;;SAGrF,IAAIqF,qBAAqB,EACzB;WACC,IAAMC,SAAS,GAAGD,qBAAqB,CAACpX,UAAU,CAAC1B,aAAa,CAAC,OAAO,CAAC;WACzE,IAAInZ,MAAM,GAAG,CAAC;WACd,IAAI9E,cAAI,CAAC4C,SAAS,CAACo0B,SAAS,CAAC,EAC7B;aACClyB,MAAM,GAAGlI,QAAQ,CAACo6B,SAAS,CAACvxB,YAAY,CAAC,iBAAiB,CAAC,CAAC;;WAG7D,IAAIX,MAAM,GAAG,CAAC,EACd;aACCjJ,GAAG,CAACC,IAAI,CAAC,eAAe,EAAE;eACzBoQ,IAAI,EAAE,kBAAkB;eACxB6G,aAAa,EAAE,yBAAyB;eACxCC,UAAU,EAAE,sDAAsD;eAElEtW,MAAM,EAAE;iBACP2jB,OAAO,EAAEvb,MAAM;iBACfmyB,QAAQ,EAAE,IAAI,CAAChkB,SAAS,CAAC,eAAe,EAAE,EAAE;gBAC5C;eACDC,UAAU,EAAE;iBACXhH,IAAI,EAAE,MAAM;iBACZiH,QAAQ,EAAE;mBACTC,UAAU,EAAE,6BAA6B;mBACzC1P,KAAK,EAAE+N,EAAE,CAAC7S,OAAO,CAAC,sCAAsC,CAAC;mBACzDiQ,KAAK,EAAE,KAAK;mBACZqoB,QAAQ,EAAE;qBACTC,qBAAqB,EAAE;;;;cAI1B,EAAE,KAAK,CAAC;;;;;;KAKZ;KAAA,gCAEe/zB,IAAI,EACpB;OACC,IAAI,CAACpD,cAAI,CAAC4C,SAAS,CAACQ,IAAI,CAAC,EACzB;SACC;;OAGD,IAAMoB,KAAK,GAAG5H,QAAQ,CAACwG,IAAI,CAACqC,YAAY,CAAC,kBAAkB,CAAC,CAAC;OAE7D,IAAIjB,KAAK,IAAI,CAAC,EACd;SACC;;OAGD,OAAO,IAAIJ,OAAI,CAAC;SACfI,KAAK,EAAEA,KAAK;SACZC,SAAS,EAAErB,IAAI,CAACqC,YAAY,CAAC,+BAA+B,CAAC;SAC7Df,SAAS,EAAGtB,IAAI,CAACqC,YAAY,CAAC,+BAA+B,CAAC,KAAK,GAAI;SACvEd,QAAQ,EAAGvB,IAAI,CAACqC,YAAY,CAAC,8BAA8B,CAAC,KAAK,GAAI;SACrEb,IAAI,EAAExB,IAAI,CAACqC,YAAY,CAAC,yBAAyB,CAAC;SAClDZ,YAAY,EAAEzB,IAAI,CAACqC,YAAY,CAAC,iCAAiC,CAAC;SAClEX,MAAM,EAAElI,QAAQ,CAACwG,IAAI,CAACqC,YAAY,CAAC,uBAAuB,CAAC,CAAC;SAC5DV,GAAG,EAAE3B,IAAI,CAACqC,YAAY,CAAC,wBAAwB,CAAC;SAChDT,WAAW,EAAE5B,IAAI,CAACqC,YAAY,CAAC,kCAAkC,CAAC;SAClER,QAAQ,EAAG7B,IAAI,CAACqC,YAAY,CAAC,8BAA8B,CAAC,KAAK,GAAI;SACrEP,aAAa,EAAE9B,IAAI,CAACqC,YAAY,CAAC,oCAAoC,CAAC;SACtEN,SAAS,EAAE/B,IAAI,CAACqC,YAAY,CAAC,+BAA+B,CAAC;SAC7DL,QAAQ,EAAGhC,IAAI,CAACqC,YAAY,CAAC,8BAA8B,CAAC,KAAK,GAAI;SAErEJ,MAAM,EAAEzI,QAAQ,CAACwG,IAAI,CAACqC,YAAY,CAAC,uBAAuB,CAAC,CAAC;SAC5DH,QAAQ,EAAElC,IAAI,CAACqC,YAAY,CAAC,yBAAyB,CAAC;SAEtDF,eAAe,EAAE3I,QAAQ,CAACwG,IAAI,CAACqC,YAAY,CAAC,iCAAiC,CAAC;QAC9E,CAAC;;;KACF;KAAA,iCAEgBjB,KAAK,EACtB;OACC,IAAIyI,MAAM,GAAG,IAAI;OAEjBzI,KAAK,GAAG5H,QAAQ,CAAC4H,KAAK,CAAC;OACvB,IAAIA,KAAK,IAAI,CAAC,EACd;SACC,OAAOyI,MAAM;;OAGdA,MAAM,GAAG,IAAI7I,OAAI,CAAC;SACjBI,KAAK,EAALA;QACA,CAAC;OAEF,OAAOyI,MAAM;;;KACb;KAAA,iCAEgBvQ,MAAM,EACvB;OACC,IAAI06B,WAAW,GAAGh7B,QAAQ,CAACC,cAAc,CAAC,uBAAuB,CAAC;OAClE,IAAI,CAAC2D,cAAI,CAAC4C,SAAS,CAACw0B,WAAW,CAAC,EAChC;SACCA,WAAW,GAAGh7B,QAAQ,CAACC,cAAc,CAAC,wBAAwB,CAAC;;OAEhE,IAAI,CAAC2D,cAAI,CAAC4C,SAAS,CAACw0B,WAAW,CAAC,EAChC;SACC;;OAGD,IAAMC,KAAK,GAAG;SACbC,mBAAmB,EAAE,IAAI;SACzBC,WAAW,EAAE,IAAI;SACjBC,aAAa,EAAE;QACf;OAED,IAAMjJ,SAAS,GAAI,OAAO7xB,MAAM,CAAC6xB,SAAS,IAAI,WAAW,GAAG3xB,QAAQ,CAACF,MAAM,CAAC6xB,SAAS,CAAC,GAAG,CAAE;OAC3F,IAAIA,SAAS,GAAG,CAAC,EACjB;SACC8I,KAAK,CAACpO,EAAE,GAAGsF,SAAS;;OAGrB9c,EAAE,CAAC+P,UAAU,CAACiW,gBAAgB,CAC7B,uBAAuB,EACvBL,WAAW,CAACh6B,SAAS,EACrBR,QAAQ,CAAC0C,IAAI,CAACC,MAAM,EAAE,GAAG,MAAM,CAAC,EAChC0B,IAAI,CAACgsB,SAAS,CAACoK,KAAK,CAAC,CACrB;;;KACD;KAAA,oCAEmBn0B,KAAK,EACzB;OACC,sBAAsBA,KAAK,CAAC2H,OAAO,EAAE;SAAA;SAA9B6sB,MAAM;SAAEC,GAAG;OAElB,IAAI,CAAC33B,cAAI,CAAC4C,SAAS,CAAC80B,MAAM,CAAC,EAC3B;SACC;;OAGD,IAAI,CAAC13B,cAAI,CAACE,cAAc,CAACy3B,GAAG,CAAC,EAC7B;SACC;;OAGD,IAAMj2B,SAAS,GAAGg2B,MAAM,CAAC/X,UAAU;OACnC,IAAIje,SAAS,EACb;SACC,IAAIA,SAAS,CAACuc,aAAa,CAAC,qCAAqC,CAAC,EAClE;WACC;;QAED,MAED;SACC,IAAIyZ,MAAM,CAACzZ,aAAa,CAAC,qCAAqC,CAAC,EAC/D;WACC;;;OAIF,IAAM2Z,OAAO,GAAGF,MAAM,CAACG,oBAAoB,CAAC,QAAQ,CAAC;OACrD,IAAIC,WAAW,GAAGF,OAAO,CAACv2B,MAAM;OAEhC6T,KAAK,CAACqJ,IAAI,CAACqZ,OAAO,CAAC,CAACr5B,OAAO,CAAC,UAACw5B,MAAM,EAAK;SACvC,IACC/3B,cAAI,CAACE,cAAc,CAAC63B,MAAM,CAACJ,GAAG,CAAC,IAC5BI,MAAM,CAACJ,GAAG,KAAKA,GAAG,EAEtB;WACC9zB,aAAG,CAACpH,MAAM,CAACs7B,MAAM,CAAC;WAClBD,WAAW,EAAE;;QAEd,CAAC;OAEF,IAAIA,WAAW,GAAG,CAAC,EACnB;SACC;;OAGD,IAAME,cAAc,GAAGn0B,aAAG,CAACwrB,MAAM,CAAC,KAAK,EAAE;SACxCgI,KAAK,EAAE;WACNpN,SAAS,EAAE;UACX;SACDgO,QAAQ,EAAE,CACTp0B,aAAG,CAACwrB,MAAM,CAAC,KAAK,EAAE;WACjBgI,KAAK,EAAE;aACNpN,SAAS,EAAE;YACX;WACDpI,IAAI,EAAE;UACN,CAAC,EACFhe,aAAG,CAACwrB,MAAM,CAAC,KAAK,EAAE;WACjBgI,KAAK,EAAE;aACNpN,SAAS,EAAE;YACX;WACDpI,IAAI,EAAEtkB,aAAG,CAACC,UAAU,CAAC,0CAA0C;UAC/D,CAAC;QAEH,CAAC;OAEF,IAAM06B,YAAY,GAAGF,cAAc,CAAC/Z,aAAa,CAAC,8BAA8B,CAAC;OACjF,IAAIia,YAAY,EAChB;SACCr0B,aAAG,CAACs0B,MAAM,CAACD,YAAY,EAAE;WACxBE,MAAM,EAAE;aACPC,KAAK,EAAE,iBAAM;eACZx8B,GAAG,CAACy8B,YAAY,CAAC;iBAChBvzB,GAAG,EAAE4yB;gBACL,CAAC;;;UAGJ,CAAC;;OAGH,IAAIj2B,SAAS,EACb;SACCg2B,MAAM,CAACtjB,KAAK,CAACiW,OAAO,GAAG,MAAM;SAC7B3oB,SAAS,CAAC4lB,WAAW,CAAC0Q,cAAc,CAAC;QACrC,MAED;SACCn0B,aAAG,CAACs0B,MAAM,CAACT,MAAM,EAAE;WAClBO,QAAQ,EAAE,CAAED,cAAc;UAC1B,CAAC;;;;KAEH;KAAA,8BAEazoB,OAAO,EACrB;OACC,IAAItC,MAAM,GAAG,CAAC;OACd,QAAQsC,OAAO;SAEd,KAAK,gBAAgB;WACpBtC,MAAM,GAAG,EAAE;WACX;SACD,KAAK,UAAU;WACdA,MAAM,GAAG,EAAE;WACX;SACD,KAAK,MAAM;WACVA,MAAM,GAAG,EAAE;WACX;SACD;;OAGD,OAAOA,MAAM;;;KACb;KAAA,8BAEasrB,MAAM,EACpB;OACC9mB,EAAE,CAAC+mB,UAAU,CAAC,QAAQ,GAAGD,MAAM,GAAG,+DAA+D,CAAC;;;KAClG;KAAA,0BAES35B,OAAO,EAAEmG,GAAG,EAAE0zB,UAAU,EAClC;OACC5yB,gBAAI,CAACC,SAAS,CAAC,2CAA2C,EAAE;SAC3DhF,IAAI,EAAE;WACLlC,OAAO,EAAEA,OAAO;WAChBmG,GAAG,EAAEA,GAAG;WACR2zB,UAAU,EAAED;;QAEb,CAAC,CAACvyB,IAAI,CAAC,UAACC,QAAQ,EAAK,EACrB,EAAE,UAACA,QAAQ,EAAK,EAChB,CAAC;;;KACF;KAAA,sCAGD;OACC,IAAI,CAAC0rB,gBAAgB,GAAGvyB,IAAI,CAACq5B,KAAK,CAAC,IAAI9jB,IAAI,EAAE,CAAC8B,OAAO,EAAE,GAAG,IAAI,CAAC;;;KAC/D;KAAA,sCAGD;OACC,OAAO,IAAI,CAACkb,gBAAgB;;;KAC5B;KAAA,gCAMD;OAAA,IAHCwB,YAAY,QAAZA,YAAY;SACZ7uB,KAAK,QAALA,KAAK;OAGLA,KAAK,GAAI,CAACxE,cAAI,CAACqJ,WAAW,CAAC7E,KAAK,CAAC,GAAG5H,QAAQ,CAAC4H,KAAK,CAAC,GAAG,CAAE;OAExD,IAAMo0B,WAAW,GAAGj1B,aAAG,CAACC,MAAM,uGAAQyvB,YAAY,CAACj1B,IAAI,CAAQ;OAE/D,IAAMsD,SAAS,GAAGtF,QAAQ,CAACC,cAAc,CAAC,uBAAuB,CAAC;OAClE,IAAIqF,SAAS,EACb;SACCA,SAAS,CAACie,UAAU,CAACC,YAAY,CAACgZ,WAAW,EAAEl3B,SAAS,CAACm3B,WAAW,CAAC;;OAGtE,IAAMC,cAAc,GAAGF,WAAW,CAAC3a,aAAa,yBAAyB;OACzE,IAAM8a,OAAO,GAAGH,WAAW,CAAC3a,aAAa,kBAAkB;OAC3D,IAAM+a,SAAS,GAAGJ,WAAW,CAAC3a,aAAa,iCAAiC;OAE5E,IACCzZ,KAAK,GAAG,CAAC,IACNs0B,cAAc,IACdC,OAAO,EAEX;SACC,IAAMjuB,QAAQ,GAAG;WAChBmuB,UAAU,EAAEH,cAAc,CAAC17B,SAAS;WACpC87B,OAAO,EAAEH,OAAO,CAAC37B,SAAS;WAC1B+7B,KAAK,EAAE30B;UACP;SAED,IAAIw0B,SAAS,EACb;WACCluB,QAAQ,CAACsuB,cAAc,GAAGJ,SAAS,CAAC57B,SAAS;;SAG9CsB,WAAW,CAACgI,aAAa,CAAC,sBAAsB,EAAEoE,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC;;OAGxEmX,YAAY,CAACC,QAAQ,CAACC,UAAU,EAAE;;;GAClC;CAAA;AAGF,KAAMllB,QAAQ,GAAG,IAAI+yB,IAAI,EAAE;AAC3B,KAAM1D,uBAAuB,GAAG,IAAI/xB,eAAe,EAAE;AACrD,KAAMgyB,sBAAsB,GAAG,IAAI9uB,cAAc,EAAE;AACnD,KAAMgvB,uBAAuB,GAAG,IAAI3uB,eAAe,EAAE;AACrD,KAAM2V,0BAA0B,GAAG,IAAI7T,QAAQ,EAAE;AACjD,KAAM+1B,wBAAwB,GAAG,IAAIn0B,gBAAgB,EAAE;AACvD,KAAM8Q,gBAAgB,GAAG,IAAIjF,QAAQ,EAAE;AACvC,KAAM2Y,gBAAgB,GAAG,IAAIpV,QAAQ,EAAE;AACvC,KAAMhG,uBAAuB,GAAG,IAAI8H,eAAe,EAAE;AACrD,KAAM3H,0BAA0B,GAAG,IAAIwM,kBAAkB,EAAE;AAC3D,KAAMyW,mBAAmB,GAAG,IAAInR,WAAW,EAAE;AAC7C,KAAMwc,cAAc,GAAG,IAAItZ,MAAM,EAAE;AACnC,KAAMuZ,wBAAwB,GAAG,IAAIpZ,gBAAgB,EAAE;AACvD,KAAMqZ,iBAAiB,GAAG,IAAI5Y,SAAS,EAAE;AACzC,KAAMoI,kBAAkB,GAAG,IAAIzG,UAAU,EAAE;AAC3C,KAAMjc,qBAAqB,GAAG,IAAIse,aAAa,EAAE;AACjD,KAAMjV,gBAAgB,GAAG,IAAIwW,QAAQ,EAAE;AACvC,KAAMzqB,YAAY,GAAG,IAAI2V,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;"}