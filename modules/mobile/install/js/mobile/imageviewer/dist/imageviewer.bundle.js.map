{"version":3,"file":"imageviewer.bundle.js","sources":["../src/imageviewer.js"],"sourcesContent":["import {Type, Event} from \"main.core\";\n\nclass ImageViewer\n{\n\tconstructor()\n\t{\n\t}\n\n\tviewImageBind(div, targetCriteria)\n\t{\n\t\tif (Type.isStringFilled(div))\n\t\t{\n\t\t\tdiv = document.getElementById(div);\n\t\t}\n\n\t\tif (!Type.isDomNode(div))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet targetSelector = '';\n\n\t\tif (Type.isPlainObject(targetCriteria))\n\t\t{\n\t\t\tlet\n\t\t\t\ttagString = '',\n\t\t\t\tattrString = '';\n\n\t\t\tfor (let key in targetCriteria)\n\t\t\t{\n\t\t\t\tif (!targetCriteria.hasOwnProperty(key))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tswitch(key)\n\t\t\t\t{\n\t\t\t\t\tcase 'tag':\n\t\t\t\t\t\ttagString = targetCriteria[key];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'attr':\n\t\t\t\t\t\tattrString = targetCriteria[key];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttargetSelector = (Type.isStringFilled(tagString) ? tagString : '') + (Type.isStringFilled(attrString) ? '[' + attrString + ']' : '');\n\t\t}\n\t\telse if (Type.isStringFilled(targetCriteria))\n\t\t{\n\t\t\ttargetSelector = targetCriteria;\n\t\t}\n\n\t\tif (!Type.isStringFilled(targetSelector))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEvent.bind(div, 'click', (e) => {\n\n\t\t\tif (e.target.tagName.toUpperCase() === 'A')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet found = false;\n\t\t\tconst siblings = e.target.parentNode.querySelectorAll(targetSelector);\n\t\t\tfor(let i=0; i<siblings.length; i++)\n\t\t\t{\n\t\t\t\tif (siblings[i].parentNode === e.target.parentNode)\n\t\t\t\t{\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst imgNodeList = e.currentTarget.querySelectorAll(targetSelector);\n\t\t\tlet\n\t\t\t\timgList = [],\n\t\t\t\tphotosList = [],\n\t\t\t\tcurrentImage = false,\n\t\t\t\tcurrentPreview = false;\n\n\t\t\tfor(let i=0; i<imgNodeList.length; i++)\n\t\t\t{\n\t\t\t\tcurrentImage = imgNodeList[i].getAttribute('data-bx-image');\n\n\t\t\t\tif (!imgList.includes(currentImage))\n\t\t\t\t{\n\t\t\t\t\tcurrentPreview = imgNodeList[i].getAttribute('data-bx-preview');\n\t\t\t\t\timgList.push(imgNodeList[i].getAttribute('data-bx-image'));\n\t\t\t\t\tphotosList.push({\n\t\t\t\t\t\turl: currentImage,\n\t\t\t\t\t\tpreview: (Type.isStringFilled(currentPreview) ? currentPreview : ''),\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar viewerParams = {\n\t\t\t\tphotos: photosList\n\t\t\t};\n\n\t\t\tlet target = null;\n\n\t\t\tif (e.target.tagName.toUpperCase() == 'IMG')\n\t\t\t{\n\t\t\t\ttarget = e.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tcontainer = e.target.closest('[data-bx-disk-image-container]');\n\n\t\t\t\tif (!container)\n\t\t\t\t{\n\t\t\t\t\tcontainer = e.target.closest('div');\n\t\t\t\t}\n\n\t\t\t\tif (container)\n\t\t\t\t{\n\t\t\t\t\ttarget = container.querySelector('img');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (target)\n\t\t\t{\n\t\t\t\tcurrentImage = target.getAttribute('data-bx-image');\n\t\t\t\tif (Type.isStringFilled(currentImage))\n\t\t\t\t{\n\t\t\t\t\tviewerParams.default_photo = currentImage;\n\t\t\t\t}\n\n\t\t\t\tcurrentPreview = target.getAttribute('data-bx-preview');\n\t\t\t\tif (Type.isStringFilled(currentPreview))\n\t\t\t\t{\n\t\t\t\t\tviewerParams.default_preview = currentPreview;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBXMobileApp.UI.Photo.show(viewerParams);\n\n\t\t\te.stopPropagation();\n\t\t\treturn e.preventDefault();\n\t\t});\n\t}\n\n\tview(e)\n\t{\n\t\te.currentTarget\n\t}\n\n}\n\nvar MobileImageViewer = new ImageViewer;\n\nexport {\n\tMobileImageViewer\n};"],"names":["ImageViewer","div","targetCriteria","Type","isStringFilled","document","getElementById","isDomNode","targetSelector","isPlainObject","tagString","attrString","key","hasOwnProperty","Event","bind","e","target","tagName","toUpperCase","found","siblings","parentNode","querySelectorAll","i","length","imgNodeList","currentTarget","imgList","photosList","currentImage","currentPreview","getAttribute","includes","push","url","preview","description","viewerParams","photos","container","closest","querySelector","default_photo","default_preview","BXMobileApp","UI","Photo","show","stopPropagation","preventDefault","MobileImageViewer"],"mappings":"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"}