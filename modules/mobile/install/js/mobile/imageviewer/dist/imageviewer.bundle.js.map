{"version":3,"file":"imageviewer.bundle.js","sources":["../src/imageviewer.js"],"sourcesContent":["import {Type, Event} from \"main.core\";\n\nclass ImageViewer\n{\n\tconstructor()\n\t{\n\t}\n\n\tviewImageBind(div, targetCriteria)\n\t{\n\t\tif (Type.isStringFilled(div))\n\t\t{\n\t\t\tdiv = document.getElementById(div);\n\t\t}\n\n\t\tif (!Type.isDomNode(div))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet targetSelector = '';\n\n\t\tif (Type.isPlainObject(targetCriteria))\n\t\t{\n\t\t\tlet\n\t\t\t\ttagString = '',\n\t\t\t\tattrString = '';\n\n\t\t\tfor (let key in targetCriteria)\n\t\t\t{\n\t\t\t\tif (!targetCriteria.hasOwnProperty(key))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tswitch(key)\n\t\t\t\t{\n\t\t\t\t\tcase 'tag':\n\t\t\t\t\t\ttagString = targetCriteria[key];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'attr':\n\t\t\t\t\t\tattrString = targetCriteria[key];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttargetSelector = (Type.isStringFilled(tagString) ? tagString : '') + (Type.isStringFilled(attrString) ? '[' + attrString + ']' : '');\n\t\t}\n\t\telse if (Type.isStringFilled(targetCriteria))\n\t\t{\n\t\t\ttargetSelector = targetCriteria;\n\t\t}\n\n\t\tif (!Type.isStringFilled(targetSelector))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEvent.bind(div, 'click', (e) => {\n\n\t\t\tif (e.target.tagName.toUpperCase() === 'A')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet found = false;\n\t\t\tconst siblings = e.target.parentNode.querySelectorAll(targetSelector);\n\t\t\tfor(let i=0; i<siblings.length; i++)\n\t\t\t{\n\t\t\t\tif (siblings[i].parentNode === e.target.parentNode)\n\t\t\t\t{\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst imgNodeList = e.currentTarget.querySelectorAll(targetSelector);\n\t\t\tlet\n\t\t\t\timgList = [],\n\t\t\t\tphotosList = [],\n\t\t\t\tcurrentImage = false,\n\t\t\t\tcurrentPreview = false;\n\n\t\t\tfor(let i=0; i<imgNodeList.length; i++)\n\t\t\t{\n\t\t\t\tcurrentImage = imgNodeList[i].getAttribute('data-bx-image');\n\n\t\t\t\tif (!imgList.includes(currentImage))\n\t\t\t\t{\n\t\t\t\t\tcurrentPreview = imgNodeList[i].getAttribute('data-bx-preview');\n\t\t\t\t\timgList.push(imgNodeList[i].getAttribute('data-bx-image'));\n\t\t\t\t\tphotosList.push({\n\t\t\t\t\t\turl: currentImage,\n\t\t\t\t\t\tpreview: (Type.isStringFilled(currentPreview) ? currentPreview : ''),\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar viewerParams = {\n\t\t\t\tphotos: photosList\n\t\t\t};\n\n\t\t\tlet target = null;\n\n\t\t\tif (e.target.tagName.toUpperCase() == 'IMG')\n\t\t\t{\n\t\t\t\ttarget = e.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tcontainer = e.target.closest('[data-bx-disk-image-container]');\n\n\t\t\t\tif (!container)\n\t\t\t\t{\n\t\t\t\t\tcontainer = e.target.closest('div');\n\t\t\t\t}\n\n\t\t\t\tif (container)\n\t\t\t\t{\n\t\t\t\t\ttarget = container.querySelector('img');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (target)\n\t\t\t{\n\t\t\t\tcurrentImage = target.getAttribute('data-bx-image');\n\t\t\t\tif (Type.isStringFilled(currentImage))\n\t\t\t\t{\n\t\t\t\t\tviewerParams.default_photo = currentImage;\n\t\t\t\t}\n\n\t\t\t\tcurrentPreview = target.getAttribute('data-bx-preview');\n\t\t\t\tif (Type.isStringFilled(currentPreview))\n\t\t\t\t{\n\t\t\t\t\tviewerParams.default_preview = currentPreview;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBXMobileApp.UI.Photo.show(viewerParams);\n\n\t\t\te.stopPropagation();\n\t\t\treturn e.preventDefault();\n\t\t});\n\t}\n\n\tview(e)\n\t{\n\t\te.currentTarget\n\t}\n\n}\n\nvar MobileImageViewer = new ImageViewer;\n\nexport {\n\tMobileImageViewer\n};"],"names":["ImageViewer","div","targetCriteria","Type","isStringFilled","document","getElementById","isDomNode","targetSelector","isPlainObject","tagString","attrString","key","hasOwnProperty","Event","bind","e","target","tagName","toUpperCase","found","siblings","parentNode","querySelectorAll","i","length","imgNodeList","currentTarget","imgList","photosList","currentImage","currentPreview","getAttribute","includes","push","url","preview","description","viewerParams","photos","container","closest","querySelector","default_photo","default_preview","BXMobileApp","UI","Photo","show","stopPropagation","preventDefault","MobileImageViewer"],"mappings":"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"}