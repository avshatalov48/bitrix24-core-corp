this.BX=this.BX||{};(function(e,i,t,a,r,n){"use strict";var s=function(){function e(i){var t=this;babelHelpers.classCallCheck(this,e);var a=i.imagesNode&&n.Type.isDomNode(i.imagesNode)?i.imagesNode:null,r=i.moreFilesNode&&n.Type.isDomNode(i.moreFilesNode)?i.moreFilesNode:null,s=i.toggleViewNode&&n.Type.isDomNode(i.toggleViewNode)?i.toggleViewNode:null,l=i.imagesIdList&&n.Type.isArray(i.imagesIdList)?i.imagesIdList:[];this.signedParameters=i.signedParameters&&n.Type.isStringFilled(i.signedParameters)?i.signedParameters:"";if(l.length>0){BitrixMobile.LazyLoad.registerImages(l,typeof oMSL!="undefined"?oMSL.checkVisibility:false)}if(a){this.initViewer(a)}if(r){n.Event.bind(r,"click",function(e){t.showMoreDiskFiles(e.currentTarget);e.preventDefault()})}if(s){n.Event.bind(s,"click",function(e){var i=e.currentTarget.getAttribute("data-bx-view-type"),a=e.currentTarget.closest(".disk-ui-file-container");if(a){t.toggleViewType({viewType:i,container:a})}e.preventDefault()})}}babelHelpers.createClass(e,[{key:"initViewer",value:function e(t){if(!n.Type.isDomNode(t)){return}i.MobileImageViewer.viewImageBind(t,"img[data-bx-image]")}},{key:"showMoreDiskFiles",value:function e(i){if(!n.Type.isDomNode(i)){return}var t=i.closest(".post-item-attached-file-wrap");if(t){var a=t.querySelectorAll(".post-item-attached-file"),r=t.querySelector(".post-item-attached-file-more");for(var s=0;s<a.length;s++){a[s].classList.remove("post-item-attached-file-hidden")}if(r){r.parentNode.removeChild(r)}}}},{key:"toggleViewType",value:function e(i){var a=i.container&&n.Type.isDomNode(i.container)?i.container:null;if(!a){return}app.showPopupLoader({text:""});t.Ajax.runComponentAction("bitrix:disk.uf.file","toggleViewType",{mode:"class",signedParameters:this.signedParameters,data:{params:{viewType:i.viewType}}}).then(function(e){app.hidePopupLoader();n.Dom.clean(a);n.Runtime.html(a,e.data.html).then(function(){BitrixMobile.LazyLoad.showImages()})},function(){app.hidePopupLoader()})}}]);return e}();var l=function(){babelHelpers.createClass(e,null,[{key:"checkForPaternity",value:function e(){return true}}]);function e(i,t,a){babelHelpers.classCallCheck(this,e);this.id=i["id"];this.data=i;this.container=t;this.options=a}babelHelpers.createClass(e,[{key:"getId",value:function e(){return this.id}},{key:"getNode",value:function e(){return this.container.querySelector("#wdif-doc-".concat(this.id))}}]);return e}();var o=function(e){babelHelpers.inherits(i,e);babelHelpers.createClass(i,null,[{key:"checkForPaternity",value:function e(i){return i["extension"]==="mp3"}}]);function i(e,t,a){var r;babelHelpers.classCallCheck(this,i);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this,e,t,a));setTimeout(r.renderPlayer.bind(babelHelpers.assertThisInitialized(r)),10);return r}babelHelpers.createClass(i,[{key:"renderPlayer",value:function e(){this.getNode().classList.add("post-item-attached-audio");this.getNode().innerHTML="";r.Vue.create({el:this.getNode().appendChild(document.createElement("DIV")),template:'<bx-audioplayer src="'.concat(this.data.downloadUrl,'" background="dark"/>')})}}]);return i}(l);var c=function(e){babelHelpers.inherits(i,e);babelHelpers.createClass(i,null,[{key:"checkForPaternity",value:function e(i){return i["preview"]!==undefined}}]);function i(e,t,a){var r;babelHelpers.classCallCheck(this,i);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this,e,t,a));BitrixMobile.LazyLoad.registerImages([r.id],typeof oMSL!="undefined"?oMSL.checkVisibility:false);return r}return i}(l);var d=[l,c,o];var u=function(){function e(i){var t=i.files,a=i.container;babelHelpers.classCallCheck(this,e);this.container=a;if(n.Type.isDomNode(this.container)){this.initFiles(t);this.bindInterface()}}babelHelpers.createClass(e,[{key:"initFiles",value:function e(i){var t=this;if(i&&i.length>0){i.forEach(function(e){var i=l;d.forEach(function(t){if(t.checkForPaternity(e)){i=t}});new i(e,t.container)})}}},{key:"bindInterface",value:function e(){var i=this.container.querySelector(".post-item-attached-file-more");if(n.Type.isDomNode(i)){n.Event.bindOnce(i,"click",function(){this.container.querySelectorAll(".post-item-attached-file").forEach(function(e){e.classList.remove("post-item-attached-file-hidden")});i.parentNode.removeChild(i)}.bind(this))}}}]);return e}();var h=function e(i){babelHelpers.classCallCheck(this,e);this.signedParameters=n.Type.isStringFilled(i.signedParameters)?i.signedParameters:"";if(i.images){new s(Object.assign({signedParameters:this.signedParameters},i.images));new u(i.files)}else{new s(i)}};e.DiskFile=h})(this.BX.Mobile=this.BX.Mobile||{},BX,BX.Mobile,window,BX,BX);
//# sourceMappingURL=diskfile.bundle.map.js