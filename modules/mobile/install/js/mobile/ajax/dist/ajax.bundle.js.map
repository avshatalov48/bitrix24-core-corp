{"version":3,"file":"ajax.bundle.js","sources":["../src/ajax.js"],"sourcesContent":["import { Loc, Type, ajax, Event } from \"main.core\";\n\nclass Ajax\n{\n\tconstructor()\n\t{\n\t\tthis.type = null;\n\t\tthis.method = null;\n\t\tthis.url = null;\n\t\tthis.callback = () => {};\n\t\tthis.failure_callback = () => {};\n\t\tthis.progress_callback = null;\n\t\tthis.loadstart_callback = null;\n\t\tthis.loadend_callback = null;\n\t\tthis.offline = null;\n\t\tthis.processData = null;\n\t\tthis.xhr = null;\n\t\tthis.data = null;\n\t\tthis.headers = null;\n\t\tthis.aborted = null;\n\t\tthis.formData = null;\n\t}\n\n\tstatic wrap(params)\n\t{\n\t\tconst instance = new Ajax();\n\t\treturn instance.instanceWrap(params);\n\t}\n\n\tinstanceWrap(params)\n\t{\n\t\tthis.init(params);\n\n\t\tthis.xhr = ajax({\n\t\t\ttimeout: 30,\n\t\t\tstart: this.start,\n\t\t\tpreparePost: this.preparePost,\n\t\t\tmethod: this.method,\n\t\t\tdataType: this.type,\n\t\t\turl: this.url,\n\t\t\tdata: this.data,\n\t\t\theaders: this.headers,\n\t\t\tprocessData: this.processData,\n\t\t\tonsuccess: (response) => {\n\t\t\t\tlet failed = false;\n\n\t\t\t\tif (this.xhr.status === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.failure_callback();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\telse if (this.type == 'json')\n\t\t\t\t{\n\t\t\t\t\tfailed = (\n\t\t\t\t\t\tType.isPlainObject(response)\n\t\t\t\t\t\t&& !Type.isNull(response)\n\t\t\t\t\t\t&& Type.isStringFilled(response.status)\n\t\t\t\t\t\t&& response.status === 'failed'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if (this.type == 'html')\n\t\t\t\t{\n\t\t\t\t\tfailed = (response === '{\"status\":\"failed\"}');\n\t\t\t\t}\n\n\t\t\t\tif (failed)\n\t\t\t\t{\n\t\t\t\t\tif (!this.aborted)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.repeatRequest();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.callback(response);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonfailure: (errorCode, requestStatus) => {\n\t\t\t\tif (\n\t\t\t\t\tType.isStringFilled(errorCode)\n\t\t\t\t\t&& errorCode === 'status'\n\t\t\t\t\t&& typeof requestStatus !== 'undefined'\n\t\t\t\t\t&& requestStatus == 401\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.repeatRequest();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.failure_callback();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.bindHandlers();\n\n\t\tEvent.bind(this.xhr, 'abort', () => {\n\t\t\tthis.aborted = true;\n\t\t});\n\n\t\treturn this.xhr;\n\t};\n\n\tinit(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tthis.type = (params.type !== 'json' ? 'html' : 'json');\n\t\tthis.method = (params.method !== 'POST' ? 'GET' : 'POST');\n\t\tthis.url = params.url;\n\t\tthis.data = params.data;\n\t\tthis.headers = (typeof params.headers !== 'undefined' ? params.headers : []);\n\t\tthis.processData = (Type.isBoolean(params.processData) ? params.processData : true);\n\t\tthis.start = params.start;\n\t\tthis.preparePost = params.preparePost;\n\t\tthis.callback = params.callback;\n\n\t\tif (Type.isFunction(params.callback_failure))\n\t\t{\n\t\t\tthis.failure_callback = params.callback_failure;\n\t\t}\n\t\tif (Type.isFunction(params.callback_progress))\n\t\t{\n\t\t\tthis.progress_callback = params.callback_progress;\n\t\t}\n\t\tif (Type.isFunction(params.callback_loadstart))\n\t\t{\n\t\t\tthis.loadstart_callback = params.callback_loadstart;\n\t\t}\n\t\tif (Type.isFunction(params.callback_loadend))\n\t\t{\n\t\t\tthis.loadend_callback = params.callback_loadend;\n\t\t}\n\t\tif (typeof params.formData !== 'undefined')\n\t\t{\n\t\t\tthis.formData = params.formData;\n\t\t}\n\t}\n\n\tstatic runComponentAction(component, action, config, callbacks)\n\t{\n\t\tconst instance = new Ajax();\n\t\treturn instance.instanceRunComponentAction(component, action, config, callbacks);\n\t}\n\n\tinstanceRunComponentAction(component, action, config, callbacks)\n\t{\n\t\tif (!Type.isPlainObject(callbacks))\n\t\t{\n\t\t\tcallbacks = {};\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconfig.onrequeststart = (requestXhr) => {\n\t\t\t\tthis.xhr = requestXhr;\n\t\t\t};\n\n\t\t\tajax.runComponentAction(component, action, config).then((response) => {\n\t\t\t\tif (Type.isFunction(callbacks.success))\n\t\t\t\t{\n\t\t\t\t\tcallbacks.success(response);\n\t\t\t\t}\n\t\t\t\tresolve(response);\n\t\t\t}, (response) => {\n\t\t\t\tif (this.xhr.status == 401)\n\t\t\t\t{\n\t\t\t\t\tthis.repeatComponentAction(component, action, config, callbacks);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (Type.isFunction(callbacks.failure))\n\t\t\t\t\t{\n\t\t\t\t\t\tcallbacks.failure(response);\n\t\t\t\t\t}\n\t\t\t\t\treject(response)\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bindHandlers();\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\trepeatComponentAction(component, action, config, callbacks)\n\t{\n\t\tif (!Type.isPlainObject(callbacks))\n\t\t{\n\t\t\tcallbacks = {};\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tapp.BasicAuth({\n\t\t\t\tsuccess: (auth_data) => {\n\t\t\t\t\tajax.runComponentAction(component, action, config).then((response) => {\n\t\t\t\t\t\tif (Type.isFunction(callbacks.success))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallbacks.success(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t}, (response) => {\n\t\t\t\t\t\tif (Type.isFunction(callbacks.failure))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallbacks.failure(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treject(response);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfailture: () => {\n\t\t\t\t\tif (Type.isFunction(callbacks.failure))\n\t\t\t\t\t{\n\t\t\t\t\t\tcallbacks.failure();\n\t\t\t\t\t}\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic runAction(action, config, callbacks)\n\t{\n\t\tconst instance = new Ajax();\n\t\treturn instance.instanceRunAction(action, config, callbacks);\n\t}\n\n\tinstanceRunAction(action, config, callbacks)\n\t{\n\t\tif (!Type.isPlainObject(callbacks))\n\t\t{\n\t\t\tcallbacks = {};\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconfig.onrequeststart = (requestXhr) => {\n\t\t\t\tthis.xhr = requestXhr;\n\t\t\t};\n\n\t\t\tajax.runAction(action, config).then((response) => {\n\t\t\t\tif (Type.isFunction(callbacks.success))\n\t\t\t\t{\n\t\t\t\t\tcallbacks.success(response);\n\t\t\t\t}\n\t\t\t\tresolve(response);\n\t\t\t}, (response) => {\n\t\t\t\tif (this.xhr.status == 401)\n\t\t\t\t{\n\t\t\t\t\treturn this.repeatAction(action, config, callbacks);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (Type.isFunction(callbacks.failure))\n\t\t\t\t\t{\n\t\t\t\t\t\tcallbacks.failure(response);\n\t\t\t\t\t}\n\t\t\t\t\treject(response)\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bindHandlers();\n\t\t});\n\t}\n\n\trepeatAction(action, config, callbacks)\n\t{\n\t\tif (!Type.isPlainObject(callbacks))\n\t\t{\n\t\t\tcallbacks = {};\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tapp.BasicAuth({\n\t\t\t\tsuccess: (auth_data) => {\n\t\t\t\t\tajax.runAction(action, config).then((response) => {\n\t\t\t\t\t\tif (Type.isFunction(callbacks.success))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallbacks.success(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t}, (response) => {\n\t\t\t\t\t\tif (Type.isFunction(callbacks.failure))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallbacks.failure(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treject(response);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfailture: () => {\n\t\t\t\t\tif (Type.isFunction(callbacks.failure))\n\t\t\t\t\t{\n\t\t\t\t\t\tcallbacks.failure();\n\t\t\t\t\t}\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\trepeatRequest()\n\t{\n\t\tapp.BasicAuth({\n\t\t\tsuccess: (auth_data) => {\n\t\t\t\tthis.data.sessid = auth_data.sessid_md5;\n\n\t\t\t\tif (\n\t\t\t\t\tthis.formData !== null\n\t\t\t\t\t&& this.formData.get('sessid') !== null\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.formData.set('sessid', auth_data.sessid_md5);\n\t\t\t\t}\n\n\t\t\t\tthis.xhr = ajax({\n\t\t\t\t\ttimeout: 30,\n\t\t\t\t\tpreparePost: this.preparePost,\n\t\t\t\t\tstart: this.start,\n\t\t\t\t\tmethod: this.method,\n\t\t\t\t\tdataType: this.type,\n\t\t\t\t\turl: this.url,\n\t\t\t\t\tdata: this.data,\n\t\t\t\t\tonsuccess: (response_ii) => {\n\t\t\t\t\t\tlet failed = false;\n\n\t\t\t\t\t\tif (this.xhr.status === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfailed = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.type === 'json')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfailed = (\n\t\t\t\t\t\t\t\tType.isPlainObject(response_ii)\n\t\t\t\t\t\t\t\t&& Type.isStringFilled(response_ii.status)\n\t\t\t\t\t\t\t\t&& response_ii.status === 'failed'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.type === 'html')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfailed = (response_ii === '{\"status\":\"failed\"}');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (failed)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.failure_callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callback(response_ii);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonfailure: (response) => {\n\t\t\t\t\t\tthis.failure_callback();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (\n\t\t\t\t\t!this.start\n\t\t\t\t\t&& this.formData !== null\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.xhr.send(this.formData);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfailture: () => {\n\t\t\t\tthis.failure_callback();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindHandlers()\n\t{\n\t\tif (Type.isFunction(this.progress_callback))\n\t\t{\n\t\t\tEvent.bind(this.xhr, 'progress', this.progress_callback);\n\t\t}\n\n\t\tif (Type.isFunction(this.load_callback))\n\t\t{\n\t\t\tEvent.bind(this.xhr, 'load', this.load_callback);\n\t\t}\n\n\t\tif (Type.isFunction(this.loadstart_callback))\n\t\t{\n\t\t\tEvent.bind(this.xhr, 'loadstart', this.loadstart_callback);\n\t\t}\n\n\t\tif (Type.isFunction(this.loadend_callback))\n\t\t{\n\t\t\tEvent.bind(this.xhr, 'loadend', this.loadend_callback);\n\t\t}\n\n\t\tif (Type.isFunction(this.error_callback))\n\t\t{\n\t\t\tEvent.bind(this.xhr, 'error', this.error_callback);\n\t\t}\n\n\t\tif (Type.isFunction(this.abort_callback))\n\t\t{\n\t\t\tEvent.bind(this.xhr, 'abort', this.abort_callback);\n\t\t}\n\t}\n}\n\nexport {Ajax};\n"],"names":["Ajax","type","method","url","callback","failure_callback","progress_callback","loadstart_callback","loadend_callback","offline","processData","xhr","data","headers","aborted","formData","params","init","ajax","timeout","start","preparePost","dataType","onsuccess","response","failed","status","Type","isPlainObject","isNull","isStringFilled","repeatRequest","onfailure","errorCode","requestStatus","bindHandlers","Event","bind","isBoolean","isFunction","callback_failure","callback_progress","callback_loadstart","callback_loadend","component","action","config","callbacks","Promise","resolve","reject","onrequeststart","requestXhr","runComponentAction","then","success","repeatComponentAction","failure","app","BasicAuth","auth_data","failture","runAction","repeatAction","sessid","sessid_md5","get","set","response_ii","send","load_callback","error_callback","abort_callback","instance","instanceWrap","instanceRunComponentAction","instanceRunAction"],"mappings":"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"}