{"version":3,"file":"dialog.bundle.js","sources":["../src/pull.handler.js","../src/rest.handler.js","../src/component/bx-messenger.js","../src/component/bx-messenger-body-error.js","../src/component/bx-messenger-body-loading.js","../src/component/bx-messenger-body-empty.js","../src/dialog.js"],"sourcesContent":["/**\n * Bitrix Mobile Dialog\n * Dialog Pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2020 Bitrix\n */\n\nexport class MobileImCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.dialog = params.dialog;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\thandleUserInvite(params, extra, command)\n\t{\n\t\tif (!params.invited)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.dialog.redrawHeader();\n\t\t\t}, 100);\n\t\t}\n\t}\n\n\thandleMessage(params, extra, command)\n\t{\n\t\tlet currentHeaderName = BXMobileApp.UI.Page.TopBar.title.params.text;\n\t\tlet senderId = params.message.senderId;\n\t\tif (params.users[senderId].name !== currentHeaderName)\n\t\t{\n\t\t\tthis.dialog.redrawHeader();\n\t\t}\n\t}\n}","/**\n * Bitrix Mobile Dialog\n * Dialog Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {EventType} from \"im.const\";\n\nexport class MobileRestAnswerHandler extends BaseRestHandler\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tif (typeof params.context === 'object' && params.context)\n\t\t{\n\t\t\tthis.context = params.context;\n\t\t}\n\t}\n\n\thandleImChatGetSuccess(data)\n\t{\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.id,\n\t\t\tdialogId: data.dialog_id,\n\t\t\tdiskFolderId: data.disk_folder_id,\n\t\t}});\n\n\t\tif (data.restrictions)\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: data.dialog_id,\n\t\t\t\tfields: data.restrictions\n\t\t\t});\n\t\t}\n\n\t\tthis.context.redrawHeader();\n\t}\n\thandleImChatGetError(error)\n\t{\n\t\tif (error.ex.error === 'ACCESS_ERROR')\n\t\t{\n\t\t\tapp.closeController();\n\t\t}\n\t}\n\n\thandleMobileBrowserConstGetSuccess(data)\n\t{\n\t\tthis.store.commit('application/set', {disk: {\n\t\t\tenabled: true,\n\t\t\tmaxFileSize: data.phpUploadMaxFilesize\n\t\t}});\n\n\t\tthis.context.addLocalize(data);\n\t\tBX.message(data);\n\n\t\tLocalStorage.set(this.controller.getSiteId(), 0, 'serverVariables', data || {});\n\t}\n\n\thandleImDialogMessagesGetInitSuccess()\n\t{\n\t\tthis.controller.application.emit(EventType.dialog.sendReadMessages);\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.context.messagesQueue = this.context.messagesQueue.filter(el => el.id !== message.id);\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.context.messagesQueue = this.context.messagesQueue.filter(el => el.id !== message.id);\n\t}\n\n\thandleImDiskFileCommitSuccess(result, message)\n\t{\n\t\tthis.context.messagesQueue = this.context.messagesQueue.filter(el => el.id !== message.id);\n\t}\n}","/**\n * Bitrix im dialog mobile\n * Dialog vue component\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Logger} from \"im.lib.logger\";\nimport {EventType, RestMethod} from \"im.const\";\nimport {Utils} from \"im.lib.utils\";\nimport \"im.view.dialog\";\nimport \"im.view.quotepanel\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\nVue.component('bx-mobile-im-component-dialog',\n{\n\tdata: function()\n\t{\n\t\treturn {\n\t\t\tdialogState: 'loading'\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tEventType: () => EventType,\n\t\tlocalize()\n\t\t{\n\t\t\treturn Object.assign({},\n\t\t\t\tVue.getFilteredPhrases('MOBILE_CHAT_', this.$root.$bitrixMessages),\n\t\t\t\tVue.getFilteredPhrases('IM_UTILS_', this.$root.$bitrixMessages),\n\t\t\t);\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-mobilechat-wrapper'];\n\n\t\t\tif (this.showMessageDialog)\n\t\t\t{\n\t\t\t\tclassName.push('bx-mobilechat-chat-start');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tquotePanelData()\n\t\t{\n\t\t\tlet result = {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdescription: '',\n\t\t\t\tcolor: ''\n\t\t\t};\n\n\t\t\tif (!this.showMessageDialog || !this.dialog.quoteId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet message = this.$store.getters['messages/getMessage'](this.dialog.chatId, this.dialog.quoteId);\n\t\t\tif (!message)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet user = this.$store.getters['users/get'](message.authorId);\n\t\t\tlet files = this.$store.getters['files/getList'](this.dialog.chatId);\n\t\t\tlet editId = this.$store.getters['dialogues/getEditId'](this.dialog.dialogId);\n\n\t\t\treturn {\n\t\t\t\tid: this.dialog.quoteId,\n\t\t\t\ttitle: editId? this.localize.MOBILE_CHAT_EDIT_TITLE : (message.params.NAME ? message.params.NAME : (user ? user.name: '')),\n\t\t\t\tcolor: user? user.color: '',\n\t\t\t\tdescription: Utils.text.purify(message.text, message.params, files, this.localize)\n\t\t\t};\n\t\t},\n\n\t\tisDialog()\n\t\t{\n\t\t\treturn Utils.dialog.isChatId(this.dialog.dialogId);\n\t\t},\n\n\t\tisGestureQuoteSupported()\n\t\t{\n\t\t\tif (this.dialog && this.dialog.type === 'announcement' && !this.dialog.managerList.includes(this.application.common.userId))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn ChatPerformance.isGestureQuoteSupported();\n\t\t},\n\t\tisDarkBackground()\n\t\t{\n\t\t\treturn this.application.options.darkBackground;\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\tlet result = this.messageCollection && this.messageCollection.length > 0;\n\t\t\tlet timeout = ChatPerformance.getDialogShowTimeout();\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\tif (timeout > 0)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(this.dialogStateTimeout);\n\t\t\t\t\tthis.dialogStateTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.dialogState = 'show';\n\t\t\t\t\t}, timeout);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.dialogState = 'show';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.dialog && this.dialog.init)\n\t\t\t{\n\t\t\t\tif (timeout > 0)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(this.dialogStateTimeout);\n\t\t\t\t\tthis.dialogStateTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.dialogState = 'empty';\n\t\t\t\t\t}, timeout);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.dialogState = 'empty';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.dialogState = 'loading';\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.getDialogUnread(event.lastId);\n\t\t},\n\t\tonDialogMessageClickByUserName(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.replyToUser(event.user.id, event.user);\n\t\t},\n\t\tonDialogMessageClickByUploadCancel(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.cancelUploadFile(event.file.id);\n\t\t},\n\t\tonDialogMessageClickByCommand(event)\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.insertText({text: event.value+' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonDialogMessageClickByMention(event)\n\t\t{\n\t\t\tif (event.type === 'USER')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.openProfile(event.value);\n\t\t\t}\n\t\t\telse if (event.type === 'CHAT')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.openDialog(event.value);\n\t\t\t}\n\t\t\telse if (event.type === 'CALL')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.openPhoneMenu(event.value);\n\t\t\t}\n\t\t},\n\t\tonDialogMessageMenuClick(event)\n\t\t{\n\t\t\tLogger.warn('Message menu:', event);\n\t\t\tthis.$root.$bitrixApplication.openMessageMenu(event.message);\n\t\t},\n\t\tonDialogMessageRetryClick(event)\n\t\t{\n\t\t\tLogger.warn('Message retry:', event);\n\t\t\tthis.$root.$bitrixApplication.retrySendMessage(event.message);\n\t\t},\n\t\tonDialogReadMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.readMessage(event.id);\n\t\t},\n\t\tonDialogReadedListClick(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.openReadedList(event.list);\n\t\t},\n\t\tonDialogQuoteMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.quoteMessage(event.message.id);\n\t\t},\n\t\tonDialogMessageReactionSet(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.reactMessage(event.message.id, event.reaction);\n\t\t},\n\t\tonDialogMessageReactionListOpen(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.openMessageReactionList(event.message.id, event.values);\n\t\t},\n\t\tonDialogMessageClickByKeyboardButton(data)\n\t\t{\n\t\t\tif (data.action === 'ACTION')\n\t\t\t{\n\t\t\t\tlet {dialogId, messageId, botId, action, value} = data.params;\n\n\t\t\t\tif (action === 'SEND')\n\t\t\t\t{\n\t\t\t\t\tthis.$root.$bitrixApplication.addMessage(value);\n\t\t\t\t\tsetTimeout(() => this.$root.$bitrixController.application.emit(EventType.dialog.scrollToBottom, {duration: 300, cancelIfScrollChange: false}), 300);\n\t\t\t\t}\n\t\t\t\telse if (action === 'PUT')\n\t\t\t\t{\n\t\t\t\t\tthis.$root.$bitrixApplication.insertText({text: value+' '});\n\t\t\t\t}\n\t\t\t\telse if (action === 'CALL')\n\t\t\t\t{\n\t\t\t\t\tthis.$root.$bitrixApplication.openPhoneMenu(value);\n\t\t\t\t}\n\t\t\t\telse if (action === 'COPY')\n\t\t\t\t{\n\t\t\t\t\tapp.exec(\"copyToClipboard\", {text: value});\n\n\t\t\t\t\t(new BXMobileApp.UI.NotificationBar({\n\t\t\t\t\t\tmessage: BX.message(\"MOBILE_MESSAGE_MENU_COPY_SUCCESS\"),\n\t\t\t\t\t\tcolor: \"#af000000\",\n\t\t\t\t\t\ttextColor: \"#ffffff\",\n\t\t\t\t\t\tgroupId: \"clipboard\",\n\t\t\t\t\t\tmaxLines: 1,\n\t\t\t\t\t\talign: \"center\",\n\t\t\t\t\t\tisGlobal: true,\n\t\t\t\t\t\tuseCloseButton: true,\n\t\t\t\t\t\tautoHideTimeout: 1500,\n\t\t\t\t\t\thideOnTap: true\n\t\t\t\t\t}, \"copy\")).show();\n\n\t\t\t\t}\n\t\t\t\telse if (action === 'DIALOG')\n\t\t\t\t{\n\t\t\t\t\tthis.$root.$bitrixApplication.openDialog(value);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (data.action === 'COMMAND')\n\t\t\t{\n\t\t\t\tlet {dialogId, messageId, botId, command, params} = data.params;\n\n\t\t\t\tthis.$root.$bitrixController.restClient.callMethod(RestMethod.imMessageCommand, {\n\t\t\t\t\t'MESSAGE_ID': messageId,\n\t\t\t\t\t'DIALOG_ID': dialogId,\n\t\t\t\t\t'BOT_ID': botId,\n\t\t\t\t\t'COMMAND': command,\n\t\t\t\t\t'COMMAND_PARAMS': params,\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tonDialogMessageClickByChatTeaser(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.execMessageOpenChatTeaser(event);\n\t\t},\n\t\tonDialogClick(event)\n\t\t{\n\t\t\t//this.$root.$bitrixApplication.controller.hideSmiles();\n\t\t},\n\t\tonQuotePanelClose()\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.quoteMessageClear();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tconsole.warn('Smile selected:', event);\n\t\t\tthis.$root.$bitrixApplication.insertText({text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tconsole.warn('Set selected');\n\t\t\tthis.$root.$bitrixApplication.setTextFocus();\n\t\t},\n\t\tonHideSmiles()\n\t\t{\n\t\t\t//this.$root.$bitrixApplication.controller.hideSmiles();\n\t\t\tthis.$root.$bitrixApplication.setTextFocus();\n\t\t}\n\n\t},\n\ttemplate: `\n\t\t<div :class=\"widgetClassName\">\n\t\t\t<div :class=\"['bx-mobilechat-box', {'bx-mobilechat-box-dark-background': isDarkBackground}]\">\n\t\t\t\t<template v-if=\"application.error.active\">\n\t\t\t\t\t<bx-im-view-body-error/>\n\t\t\t\t</template>\t\t\t\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div :class=\"['bx-mobilechat-body', {'bx-mobilechat-body-with-message': dialogState == 'show'}]\" key=\"with-message\">\n\t\t\t\t\t\t<template v-if=\"dialogState == 'loading'\">\n\t\t\t\t\t\t\t<bx-im-view-body-loading/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else-if=\"dialogState == 'empty'\">\n\t\t\t\t\t\t\t<bx-im-view-body-empty/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-mobilechat-dialog\">\n\t\t\t\t\t\t\t\t<bx-im-view-dialog\n\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\" \n\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t:chatId=\"application.dialog.chatId\"\n\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t:messageExtraCount=\"application.dialog.messageExtraCount\"\n\t\t\t\t\t\t\t\t\t:enableReadMessages=\"application.dialog.enableReadMessages\"\n\t\t\t\t\t\t\t\t\t:enableReactions=\"true\"\n\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t:enableGestureQuote=\"application.options.quoteEnable\"\n\t\t\t\t\t\t\t\t\t:enableGestureQuoteFromRight=\"application.options.quoteFromRight\"\n\t\t\t\t\t\t\t\t\t:enableGestureMenu=\"true\"\n\t\t\t\t\t\t\t\t\t:showMessageUserName=\"isDialog\"\n\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"isDialog\"\n\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t:listenEventScrollToBottom=\"EventType.dialog.scrollToBottom\"\n\t\t\t\t\t\t\t\t\t:listenEventRequestHistory=\"EventType.dialog.requestHistoryResult\"\n\t\t\t\t\t\t\t\t\t:listenEventRequestUnread=\"EventType.dialog.requestUnreadResult\"\n\t\t\t\t\t\t\t\t\t:listenEventSendReadMessages=\"EventType.dialog.sendReadMessages\"\n\t\t\t\t\t\t\t\t\t@readMessage=\"onDialogReadMessage\"\n\t\t\t\t\t\t\t\t\t@quoteMessage=\"onDialogQuoteMessage\"\n\t\t\t\t\t\t\t\t\t@requestHistory=\"onDialogRequestHistory\"\n\t\t\t\t\t\t\t\t\t@requestUnread=\"onDialogRequestUnread\"\n\t\t\t\t\t\t\t\t\t@clickByCommand=\"onDialogMessageClickByCommand\"\n\t\t\t\t\t\t\t\t\t@clickByMention=\"onDialogMessageClickByMention\"\n\t\t\t\t\t\t\t\t\t@clickByUserName=\"onDialogMessageClickByUserName\"\n\t\t\t\t\t\t\t\t\t@clickByMessageMenu=\"onDialogMessageMenuClick\"\n\t\t\t\t\t\t\t\t\t@clickByMessageRetry=\"onDialogMessageRetryClick\"\n\t\t\t\t\t\t\t\t\t@clickByUploadCancel=\"onDialogMessageClickByUploadCancel\"\n\t\t\t\t\t\t\t\t\t@clickByReadedList=\"onDialogReadedListClick\"\n\t\t\t\t\t\t\t\t\t@setMessageReaction=\"onDialogMessageReactionSet\"\n\t\t\t\t\t\t\t\t\t@openMessageReactionList=\"onDialogMessageReactionListOpen\"\n\t\t\t\t\t\t\t\t\t@clickByKeyboardButton=\"onDialogMessageClickByKeyboardButton\"\n\t\t\t\t\t\t\t\t\t@clickByChatTeaser=\"onDialogMessageClickByChatTeaser\"\n\t\t\t\t\t\t\t\t\t@click=\"onDialogClick\"\n\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<template v-if=\"application.options.showSmiles\">\n<!--\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t-->\n\t\t\t\t\t\t\t\t<bx-messenger-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\" @hideSmiles=\"onHideSmiles\" />\t\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<bx-im-view-quote-panel :id=\"quotePanelData.id\" :title=\"quotePanelData.title\" :description=\"quotePanelData.description\" :color=\"quotePanelData.color\" @close=\"onQuotePanelClose\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-im-view-body-error',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tMOBILE_CHAT_ERROR_TITLE: this.$root.$bitrixMessages.MOBILE_CHAT_ERROR_TITLE,\n\t\t\t\tMOBILE_CHAT_ERROR_DESC: this.$root.$bitrixMessages.MOBILE_CHAT_ERROR_DESC\n\t\t\t});\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-mobilechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-mobilechat-warning-window\">\n\t\t\t\t<div class=\"bx-mobilechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-mobilechat-help-title bx-mobilechat-help-title-sm bx-mobilechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-mobilechat-help-title bx-mobilechat-help-title-md bx-mobilechat-warning-msg\">{{localize.MOBILE_CHAT_ERROR_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-mobilechat-help-title bx-mobilechat-help-title-sm bx-mobilechat-warning-msg\">{{localize.MOBILE_CHAT_ERROR_DESC}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-im-view-body-loading',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tMOBILE_CHAT_LOADING: this.$root.$bitrixMessages.MOBILE_CHAT_LOADING\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-mobilechat-loading-window\">\n\t\t\t<svg class=\"bx-mobilechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-mobilechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-mobilechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-mobilechat-help-title bx-mobilechat-help-title-md bx-mobilechat-loading-msg\">{{localize.MOBILE_CHAT_LOADING}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-im-view-body-empty',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tMOBILE_CHAT_EMPTY: this.$root.$bitrixMessages.MOBILE_CHAT_EMPTY\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-mobilechat-loading-window\">\n\t\t\t<h3 class=\"bx-mobilechat-help-title bx-mobilechat-help-title-md bx-mobilechat-loading-msg\">{{localize.MOBILE_CHAT_EMPTY}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix Im mobile\n * Dialog application\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2020 Bitrix\n */\n\n// vue\nimport {VueVendorV2, Vue} from \"ui.vue\";\nimport {Core} from \"mobile.im.application.core\";\n\n// main\nimport \"main.date\";\n\n// pull\nimport {PULL as Pull, PullClient} from \"mobile.pull.client\";\n\n// messenger files\nimport {FilesModel} from 'im.model';\n\nimport {\n\tRestMethod,\n\tRestMethodHandler,\n\tEventType,\n\tDialogType,\n\tFileStatus,\n\tFileType, DialogCrmType,\n} from 'im.const';\nimport {Utils} from \"im.lib.utils\";\nimport {LocalStorage} from \"im.lib.localstorage\";\n\nimport {MobileImCommandHandler} from \"./pull.handler\";\nimport {MobileRestAnswerHandler} from \"./rest.handler\";\nimport {Timer} from \"im.lib.timer\";\n\n// TODO change BX.Promise, BX.Main.Date to IMPORT\n\n// vue components\nimport 'pull.component.status';\nimport 'im.view.dialog';\n\n// dialog files\nimport \"./dialog.css\";\n\n// widget components\nimport \"./component/bx-messenger\";\nimport \"./component/bx-messenger-body-error\";\nimport \"./component/bx-messenger-body-loading\";\nimport \"./component/bx-messenger-body-empty\";\n\n\nexport class MobileDialogApplication\n{\n\t/* region 01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.inited = false;\n\t\tthis.initPromise = new BX.Promise;\n\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.eventBus = new VueVendorV2;\n\t\tthis.timer = new Timer();\n\n\t\tthis.messagesQueue = [];\n\t\tthis.windowFocused = true;\n\n\t\t//alert('Pause: open console for debug');\n\n\t\tthis.initCore()\n\t\t\t.then(() => this.initComponentParams())\n\t\t\t.then(result => this.initMobileSettings(result))\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initEnvironment())\n\t\t\t.then(() => this.initMobileEnvironment())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitCore()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tCore.ready().then(controller => {\n\t\t\t\tthis.controller = controller;\n\t\t\t\tresolve();\n\t\t\t})\n\t\t});\n\t}\n\n\tinitComponentParams()\n\t{\n\t\treturn BX.componentParameters.init();\n\t}\n\n\tinitMobileSettings(data)\n\t{\n\t\tconsole.log('1. initMobileSettings');\n\n\t\t// todo change to dynamic storage (LocalStorage web, PageParams for mobile)\n\t\tlet serverVariables = LocalStorage.get(this.controller.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\tthis.storedEvents = data.STORED_EVENTS || [];\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tApplicationStorage.getObject('settings.chat', {\n\t\t\t\tquoteEnable: ChatPerformance.isGestureQuoteSupported(),\n\t\t\t\tquoteFromRight: false,\n\t\t\t\tautoplayVideo: ChatPerformance.isAutoPlayVideoSupported(),\n\t\t\t\tbackgroundType: 'LIGHT_GRAY'\n\t\t\t}).then(options => {\n\t\t\t\tthis.controller.getStore().commit('application/set', {\n\t\t\t\t\tdialog: {\n\t\t\t\t\t\tdialogId: data.DIALOG_ID\n\t\t\t\t\t},\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tquoteEnable: options.quoteEnable,\n\t\t\t\t\t\tquoteFromRight: options.quoteFromRight,\n\t\t\t\t\t\tautoplayVideo: options.autoplayVideo,\n\t\t\t\t\t\tdarkBackground: ChatDialogBackground && ChatDialogBackground[options.backgroundType] && ChatDialogBackground[options.backgroundType].dark\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tresolve();\n\t\t\t})\n\t\t});\n\t}\n\n\tinitComponent()\n\t{\n\t\tconsole.log('2. initComponent');\n\t\tthis.controller.getStore().subscribe(mutation => this.eventStoreInteraction(mutation));\n\n\n\t\tthis.controller.application.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\tthis.controller.addRestAnswerHandler(\n\t\t\tMobileRestAnswerHandler.create({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\tcontext: this,\n\t\t\t})\n\t\t);\n\n\t\tlet dialog = this.controller.getStore().getters['dialogues/get'](this.controller.application.getDialogId());\n\t\tif (dialog)\n\t\t{\n\t\t\tthis.controller.getStore().commit('application/set', {dialog: {\n\t\t\t\tchatId: dialog.chatId,\n\t\t\t\tdiskFolderId: dialog.diskFolderId || 0\n\t\t\t}});\n\t\t}\n\n\t\treturn this.controller.createVue(this, {\n\t\t\tel: this.rootNode,\n\t\t\ttemplate: `<bx-mobile-im-component-dialog/>`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.template = vue;\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tinitEnvironment()\n\t{\n\t\tconsole.log('5. initEnvironment');\n\n\t\tthis.setTextareaMessage = Utils.debounce(this.controller.application.setTextareaMessage, 300, this.controller.application);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitMobileEnvironment()\n\t{\n\t\tconsole.log('6. initMobileEnvironment');\n\n\t\tBXMobileApp.UI.Page.Scroll.setEnabled(false);\n\t\tBXMobileApp.UI.Page.captureKeyboardEvents(true);\n\n\t\tBX.addCustomEvent(\"onKeyboardWillShow\", () => {\n\t\t\tthis.controller.getStore().dispatch('application/set', {mobile: {\n\t\t\t\tkeyboardShow: true,\n\t\t\t}});\n\t\t});\n\t\tBX.addCustomEvent(\"onKeyboardDidShow\", () => {\n\t\t\tconsole.log('did show');\n\t\t\tthis.controller.application.emit('EventType.dialog.scrollToBottom', {duration: 300, cancelIfScrollChange: true});\n\t\t});\n\t\tBX.addCustomEvent(\"onKeyboardWillHide\", () => {\n\t\t\tclearInterval(this.keyboardOpeningInterval);\n\t\t\tthis.controller.getStore().dispatch('application/set', {mobile: {\n\t\t\t\tkeyboardShow: false,\n\t\t\t}});\n\t\t});\n\n\t\tconst checkWindowFocused = () =>\n\t\t{\n\t\t\tBXMobileApp.UI.Page.isVisible({callback: (data) =>\n\t\t\t{\n\t\t\t\tthis.windowFocused = data.status === 'visible';\n\t\t\t\tif (this.windowFocused)\n\t\t\t\t{\n\t\t\t\t\tVue.event.$emit('bitrixmobile:controller:focus');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tVue.event.$emit('bitrixmobile:controller:blur');\n\t\t\t\t}\n\t\t\t}});\n\t\t};\n\n\t\tBX.addCustomEvent(\"onAppActive\", () =>\n\t\t{\n\t\t\tcheckWindowFocused();\n\n\t\t\tBXMobileApp.UI.Page.isVisible({callback: (data) =>\n\t\t\t{\n\t\t\t\tif (data.status !== 'visible')\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.getDialogUnread().then(() => {\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t\tthis.controller.application.emit(EventType.dialog.sendReadMessages);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t});\n\t\t\t}});\n\t\t});\n\t\tBX.addCustomEvent(\"onAppPaused\", () => {\n\t\t\tthis.windowFocused = false;\n\t\t\tVue.event.$emit('bitrixmobile:controller:blur');\n\t\t\t//app.closeController();z\n\t\t});\n\n\t\tBX.addCustomEvent(\"onOpenPageAfter\", checkWindowFocused);\n\t\tBX.addCustomEvent(\"onHidePageBefore\", () => {\n\t\t\tthis.windowFocused = false;\n\t\t\tVue.event.$emit('bitrixmobile:controller:blur');\n\t\t});\n\n\t\tBXMobileApp.addCustomEvent(\"chatbackground::task::status::success\", (params) => {\n\t\t\tlet action = params.taskId.toString().split('|')[0];\n\t\t\tthis.executeBackgroundTaskSuccess(action, params);\n\t\t});\n\t\tBXMobileApp.addCustomEvent(\"chatbackground::task::status::failure\", (params) => {\n\t\t\tlet action = params.taskId.toString().split('|')[0];\n\t\t\tthis.executeBackgroundTaskFailure(action, params);\n\t\t});\n\t\tBXMobileApp.addCustomEvent(\"chatrecent::push::get\", (params) => {\n\t\t\tPull.emit({\n\t\t\t\ttype: PullClient.SubscriptionType.Server,\n\t\t\t\tmoduleId: this.pullMobileHandler.getModuleId(),\n\t\t\t\tdata: {command: 'messageAdd', params: {...params, optionImportant: true}}\n\t\t\t});\n\t\t});\n\n\t\tBXMobileApp.UI.Page.TextPanel.setParams(this.getKeyboardParams());\n\t\tthis.changeChatKeyboardStatus();\n\n\t\tBX.MobileUploadProvider.setListener(this.executeUploaderEvent.bind(this));\n\n\t\tthis.fileUpdateProgress = Utils.throttle((chatId, fileId, progress, size) => {\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: fileId,\n\t\t\t\tfields: {\n\t\t\t\t\tsize: size,\n\t\t\t\t\tprogress: progress\n\t\t\t\t}\n\t\t\t});\n\t\t}, 500);\n\n\t\tif (Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\tlet dialogData = this.controller.application.getDialogData();\n\t\t\tlet type = dialogData.type;\n\t\t\tif (type !== DialogType.call && dialogData.restrictions.extend)\n\t\t\t{\n\t\t\t\tapp.exec(\"setRightButtons\", {items:[\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"user_plus\",\n\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\tfabric.Answers.sendCustomEvent(\"vueChatAddUserButton\", {});\n\t\t\t\t\t\t\tthis.openAddUserDialog()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]});\n\t\t\t}\n\t\t}\n\n\t\tif (!Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\tthis.userShowWorkPosition = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.userShowWorkPosition = false;\n\t\t\t\tthis.redrawHeader();\n\t\t\t}, 1500);\n\n\t\t\tsetInterval(() => {\n\t\t\t\tthis.redrawHeader();\n\t\t\t}, 60000);\n\t\t}\n\n\t\tthis.redrawHeader();\n\n\t\tthis.widgetCache = new ChatWidgetCache(this.controller.getUserId(), this.controller.getLanguageId());\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitPullClient()\n\t{\n\t\tconsole.log('7. initPullClient');\n\n\t\tif (this.storedEvents && this.storedEvents.length > 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.storedEvents = this.storedEvents.filter(event => {\n\t\t\t\t\tBX.onCustomEvent('chatrecent::push::get', [event]);\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t}, 50);\n\t\t}\n\n\t\tPull.subscribe(\n\t\t\tthis.pullMobileHandler = new MobileImCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\tdialog: this,\n\t\t\t})\n\t\t);\n\t\tPull.subscribe({\n\t\t\ttype: BX.PullClient.SubscriptionType.Server,\n\t\t\tmoduleId: 'im',\n\t\t\tcommand: 'chatUserLeave',\n\t\t\tcallback: (params) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tparams.userId === this.controller.application.getUserId()\n\t\t\t\t\t&& params.dialogId === this.controller.application.getDialogId()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tapp.closeController();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tPull.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tif (!Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\tPull.subscribe({\n\t\t\t\ttype: PullClient.SubscriptionType.Online,\n\t\t\t\tcallback: this.eventOnlineInteraction.bind(this)\n\t\t\t});\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.inited = true;\n\t\tthis.initPromise.resolve(this);\n\n\t\tBXMobileApp.Events.postToComponent(\"chatdialog::init::complete\", [{\n\t\t\tdialogId: this.controller.application.getDialogId()\n\t\t}, true], 'im.recent');\n\n\t\treturn this.requestData();\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\tlet promise = new BX.Promise;\n\t\t\tpromise.resolve(this);\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n\n\trequestData()\n\t{\n\t\tconsole.log('4. requestData');\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn this.requestDataSend;\n\t\t}\n\n\t\tthis.timer.start('data', 'load', .5, () => {\n\t\t\tconsole.warn(\"ChatDialog.requestData: slow connection show progress icon\");\n\t\t\tapp.titleAction(\"setParams\", {useProgress: true, useLetterImage: false});\n\t\t});\n\n\t\tthis.requestDataSend = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet query = {\n\t\t\t\t[RestMethodHandler.mobileBrowserConstGet]: [RestMethod.mobileBrowserConstGet, {}],\n\t\t\t\t[RestMethodHandler.imChatGet]: [RestMethod.imChatGet, {dialog_id: this.controller.application.getDialogId()}],\n\t\t\t\t[RestMethodHandler.imDialogMessagesGetInit]: [RestMethod.imDialogMessagesGet, {\n\t\t\t\t\tdialog_id: this.controller.application.getDialogId(),\n\t\t\t\t\tlimit: this.controller.application.getRequestMessageLimit(),\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}],\n\t\t\t\t[RestMethodHandler.imRecentUnread]: [RestMethod.imRecentUnread, {dialog_id: this.controller.application.getDialogId(), action: 'N'}],\n\t\t\t};\n\t\t\tif (Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t\t{\n\t\t\t\tquery[RestMethodHandler.imUserGet] = [RestMethod.imUserGet, {}];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tquery[RestMethodHandler.imUserListGet] = [RestMethod.imUserListGet, {id: [this.controller.application.getUserId(), this.controller.application.getDialogId()]}];\n\t\t\t}\n\n\t\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t\t{\n\t\t\t\tif (!response)\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = null;\n\t\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet constGet = response[RestMethodHandler.mobileBrowserConstGet];\n\t\t\t\tif (constGet.error())\n\t\t\t\t{\n\t\t\t\t\t// this.setError(constGet.error().ex.error, constGet.error().ex.error_description);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.mobileBrowserConstGet, constGet);\n\t\t\t\t}\n\n\t\t\t\tlet userGet = response[RestMethodHandler.imUserGet];\n\t\t\t\tif (userGet && !userGet.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imUserGet, userGet);\n\t\t\t\t}\n\n\t\t\t\tlet userListGet = response[RestMethodHandler.imUserListGet];\n\t\t\t\tif (userListGet && !userListGet.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imUserListGet, userListGet);\n\t\t\t\t}\n\n\t\t\t\tlet chatGetResult = response[RestMethodHandler.imChatGet];\n\t\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imChatGet, chatGetResult);\n\n\t\t\t\tlet dialogMessagesGetResult = response[RestMethodHandler.imDialogMessagesGetInit];\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\t//this.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tapp.titleAction(\"setParams\", {useProgress: false, useLetterImage: true});\n\t\t\t\t\tthis.timer.stop('data', 'load', true);\n\n\t\t\t\t\tthis.controller.getStore().dispatch('dialogues/saveDialog', {\n\t\t\t\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\t\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\t\t\t});\n\n\t\t\t\t\tif (this.controller.pullBaseHandler)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.controller.getStore().dispatch('application/set', {dialog: {\n\t\t\t\t\t\tenableReadMessages: true\n\t\t\t\t\t}}).then(() => {\n\t\t\t\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imDialogMessagesGetInit, dialogMessagesGetResult);\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t}\n\n\t\t\t\tthis.requestDataSend = null;\n\t\t\t\tresolve();\n\n\t\t\t}, false, false, Utils.getLogTrackingParams({name: 'mobile.im.dialog', dialog: this.controller.application.getDialogData()}));\n\t\t});\n\n\t\treturn this.requestDataSend;\n\t}\n\n\texecuteUploaderEvent(eventName, eventData, taskId)\n\t{\n\t\tif (eventName !== BX.MobileUploaderConst.FILE_UPLOAD_PROGRESS)\n\t\t{\n\t\t\tconsole.log(\"ChatDialog.disk.eventRouter: \", eventName, taskId, eventData);\n\t\t}\n\n\t\tif (eventName === BX.MobileUploaderConst.FILE_UPLOAD_PROGRESS)\n\t\t{\n\t\t\tif (eventData.percent > 95)\n\t\t\t{\n\t\t\t\teventData.percent = 95;\n\t\t\t}\n\t\t\tthis.fileUpdateProgress(eventData.file.params.chatId, eventData.file.params.file.id, eventData.percent, eventData.byteTotal);\n\t\t}\n\t\telse if (eventName === BX.MobileUploaderConst.FILE_CREATED)\n\t\t{\n\t\t\tif (eventData.result.status === 'error')\n\t\t\t{\n\t\t\t\tthis.fileError(eventData.file.params.chatId, eventData.file.params.file.id, eventData.file.params.id);\n\t\t\t\tconsole.error('File upload error', eventData.result.errors[0].message);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\t\tchatId: eventData.file.params.chatId,\n\t\t\t\t\tid: eventData.file.params.file.id,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tstatus: FileStatus.wait,\n\t\t\t\t\t\tprogress: 95\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (eventName === 'onimdiskmessageaddsuccess')\n\t\t{\n\t\t\tconsole.info('ChatDialog.disk.eventRouter: DISK_MESSAGE_ADD_SUCCESS: ', eventData, taskId);\n\n\t\t\tlet file = eventData.result.FILES['upload'+eventData.result.DISK_ID[0]];\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: eventData.file.params.chatId,\n\t\t\t\tid: eventData.file.params.file.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: 100,\n\t\t\t\t\tid: file.id,\n\t\t\t\t\tsize: file.size,\n\t\t\t\t\turlDownload: file.urlDownload,\n\t\t\t\t\turlPreview: file.urlPreview,\n\t\t\t\t\turlShow: file.urlShow,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (eventName === 'onimdiskmessageaddfail')\n\t\t{\n\t\t\tconsole.error('ChatDialog.disk.eventRouter: DISK_MESSAGE_ADD_FAIL: ', eventData, taskId);\n\t\t\tthis.fileError(eventData.file.params.chatId, eventData.file.params.file.id, eventData.file.params.id);\n\t\t}\n\t\telse if (\n\t\t\teventName === BX.MobileUploaderConst.TASK_CANCELLED\n\t\t\t|| eventName === BX.MobileUploaderConst.TASK_NOT_FOUND\n\t\t)\n\t\t{\n\t\t\tthis.cancelUploadFile(eventData.file.params.file.id);\n\t\t}\n\t\telse if (\n\t\t\teventName === BX.MobileUploaderConst.FILE_CREATED_FAILED\n\t\t\t|| eventName === BX.MobileUploaderConst.FILE_UPLOAD_FAILED\n\t\t\t|| eventName === BX.MobileUploaderConst.FILE_READ_ERROR\n\t\t\t|| eventName === BX.MobileUploaderConst.TASK_STARTED_FAILED\n\t\t)\n\t\t{\n\t\t\tconsole.error('ChatDialog.disk.eventRouter: ', eventName, eventData, taskId);\n\t\t\tthis.fileError(eventData.file.params.chatId, eventData.file.params.file.id, eventData.file.params.id);\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tprepareFileData(files)\n\t{\n\t\tlet prepareFunction = (file) =>\n\t\t{\n\t\t\tif (file.urlPreview && file.urlPreview.startsWith('file://'))\n\t\t\t{\n\t\t\t\tfile.urlPreview = 'bx'+file.urlPreview;\n\t\t\t}\n\t\t\tif (file.urlShow && file.urlShow.startsWith('file://'))\n\t\t\t{\n\t\t\t\tfile.urlShow = 'bx'+file.urlShow;\n\t\t\t}\n\n\t\t\tif (file.type !== FileType.image)\n\t\t\t{\n\t\t\t\treturn file;\n\t\t\t}\n\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tif (file.urlPreview.startsWith('/'))\n\t\t\t\t{\n\t\t\t\t\tfile.urlPreview = currentDomain+file.urlPreview;\n\t\t\t\t}\n\n\t\t\t\tfile.urlPreview = file.urlPreview\n\t\t\t\t\t.replace('http://', 'bxhttp://')\n\t\t\t\t\t.replace('https://', 'bxhttps://');\n\t\t\t}\n\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tif (file.urlShow.startsWith('/'))\n\t\t\t\t{\n\t\t\t\t\tfile.urlShow = currentDomain+file.urlShow;\n\t\t\t\t}\n\n\t\t\t\tfile.urlShow = file.urlShow\n\t\t\t\t\t.replace('http://', 'bxhttp://')\n\t\t\t\t\t.replace('https://', 'bxhttps://');\n\t\t\t}\n\n\t\t\treturn file;\n\t\t};\n\n\t\tif (files instanceof Array)\n\t\t{\n\t\t\treturn files.map(file => prepareFunction(file));\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn prepareFunction(files);\n\t\t}\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Mobile environment methods */\n\tredrawHeader()\n\t{\n\t\tlet headerProperties;\n\t\tif (Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\theaderProperties = this.getChatHeaderParams();\n\n\t\t\tthis.changeChatKeyboardStatus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\theaderProperties = this.getUserHeaderParams();\n\t\t\tthis.setCallMenu();\n\t\t}\n\n\t\tif (!headerProperties)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.headerMenuInited)\n\t\t{\n\t\t\t//BXMobileApp.UI.Page.TopBar.title.setUseLetterImage();\n\t\t\tBXMobileApp.UI.Page.TopBar.title.params.useLetterImage = true; // TODO remove this\n\t\t\tBXMobileApp.UI.Page.TopBar.title.setCallback(() => this.openHeaderMenu());\n\n\t\t\tthis.headerMenuInited = true;\n\t\t}\n\n\t\tif (headerProperties.name)\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TopBar.title.setText(headerProperties.name);\n\t\t}\n\t\tif (headerProperties.desc)\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TopBar.title.setDetailText(headerProperties.desc);\n\t\t}\n\t\tif (headerProperties.avatar)\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TopBar.title.setImage(headerProperties.avatar);\n\t\t}\n\t\telse if (headerProperties.color)\n\t\t{\n\t\t\t//BXMobileApp.UI.Page.TopBar.title.setImageColor(dialog.color);\n\t\t\tBXMobileApp.UI.Page.TopBar.title.params.imageColor = headerProperties.color;\n\t\t}\n\n\t\tif (Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\tlet dialogData = this.controller.application.getDialogData();\n\t\t\tif (!dialogData.restrictions.extend)\n\t\t\t{\n\t\t\t\tapp.exec(\"setRightButtons\", {items:[]});\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetUserHeaderParams()\n\t{\n\t\tlet user = this.controller.getStore().getters['users/get'](this.controller.application.getDialogId());\n\t\tif (!user || !user.init)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet result = {\n\t\t\t'name': null,\n\t\t\t'desc': null,\n\t\t\t'avatar': null,\n\t\t\t'color': null,\n\t\t};\n\n\t\tif (user.avatar)\n\t\t{\n\t\t\tresult.avatar = user.avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.color = user.color;\n\t\t}\n\n\t\tresult.name = user.name;\n\n\t\tlet showLastDate = false;\n\n\t\tif (!this.userShowWorkPosition && user.lastActivityDate)\n\t\t{\n\t\t\tshowLastDate = Utils.user.getLastDateText(user, this.getLocalize());\n\t\t}\n\n\t\tif (showLastDate)\n\t\t{\n\t\t\tresult.desc = showLastDate;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (user.workPosition)\n\t\t\t{\n\t\t\t\tresult.desc = user.workPosition;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.desc = this.getLocalize('MOBILE_HEADER_MENU_CHAT_TYPE_USER');\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetChatHeaderParams()\n\t{\n\t\tlet dialog = this.controller.getStore().getters['dialogues/get'](this.controller.application.getDialogId());\n\t\tif (!dialog || !dialog.init)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet result = {\n\t\t\t'name': null,\n\t\t\t'desc': null,\n\t\t\t'avatar': null,\n\t\t\t'color': null,\n\t\t};\n\n\t\tif (dialog.avatar)\n\t\t{\n\t\t\tresult.avatar = dialog.avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.color = dialog.color;\n\t\t}\n\n\t\tif (dialog.entityType === 'GENERAL')\n\t\t{\n\t\t\tresult.avatar = encodeURI(\n\t\t\t\tthis.controller.getHost() + \"/bitrix/mobileapp/mobile/components/bitrix/im.recent/images/avatar_general_x3.png\"\n\t\t\t);\n\t\t}\n\n\t\tresult.name = dialog.name;\n\n\t\tlet chatTypeTitle = this.getLocalize('MOBILE_HEADER_MENU_CHAT_TYPE_CHAT_NEW');\n\t\tif (this.getLocalize()['MOBILE_HEADER_MENU_CHAT_TYPE_'+dialog.type.toUpperCase()+'_NEW'])\n\t\t{\n\t\t\tchatTypeTitle = this.getLocalize('MOBILE_HEADER_MENU_CHAT_TYPE_'+dialog.type.toUpperCase()+'_NEW');\n\t\t}\n\t\tresult.desc = chatTypeTitle;\n\n\t\treturn result;\n\t}\n\n\tchangeChatKeyboardStatus()\n\t{\n\t\tlet dialog = this.controller.getStore().getters['dialogues/get'](this.controller.application.getDialogId());\n\t\tif (!dialog || !dialog.init)\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TextPanel.show();\n\t\t\treturn true;\n\t\t}\n\n\t\tlet keyboardShow = true;\n\n\t\tif (dialog.type === 'announcement' && !dialog.managerList.includes(this.controller.application.getUserId()))\n\t\t{\n\t\t\tkeyboardShow = false;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof this.keyboardShowFlag !== 'undefined'\n\t\t\t&& (\n\t\t\t\tthis.keyboardShowFlag && keyboardShow\n\t\t\t\t|| !this.keyboardShowFlag && !keyboardShow\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn this.keyboardShowFlag;\n\t\t}\n\n\t\tif (keyboardShow)\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TextPanel.show();\n\t\t\tthis.keyboardShowFlag = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TextPanel.hide();\n\t\t\tthis.keyboardShowFlag = false;\n\t\t}\n\n\t\treturn this.keyboardShowFlag;\n\t}\n\n\tsetCallMenu()\n\t{\n\t\tif (this.callMenuSetted)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet userData = this.controller.getStore().getters['users/get'](this.controller.application.getDialogId(), true);\n\t\tif (!userData.init)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tthis.controller.application.getUserId() === parseInt(this.controller.application.getDialogId())\n\t\t\t|| userData.bot\n\t\t\t|| userData.network\n\t\t)\n\t\t{\n\t\t\tapp.exec(\"setRightButtons\", {items: []});\n\n\t\t\tthis.callMenuSetted = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tapp.exec(\"setRightButtons\", {items: [\n\t\t\t{\n\t\t\t\ttype: \"call_audio\",\n\t\t\t\tcallback: () => {\n\t\t\t\t\tthis.openCallMenu();\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: \"call_video\",\n\t\t\t\tbadgeCode: \"call_video\",\n\t\t\t\tcallback: () => {\n\n\t\t\t\t\tfabric.Answers.sendCustomEvent(\"vueChatCallVideoButton\", {});\n\n\t\t\t\t\tlet userData = {};\n\t\t\t\t\tuserData[this.controller.application.getDialogId()] = this.controller.getStore().getters['users/get'](this.controller.application.getDialogId(), true);\n\n\t\t\t\t\tBXMobileApp.Events.postToComponent(\"onCallInvite\", {\n\t\t\t\t\t\tuserId: this.controller.application.getDialogId(),\n\t\t\t\t\t\tvideo: true,\n\t\t\t\t\t\tuserData\n\t\t\t\t\t}, \"calls\")\n\t\t\t\t}\n\t\t\t}\n\t\t]});\n\n\t\tthis.callMenuSetted = true;\n\n\t\treturn true;\n\t}\n\n\topenUserList(params = {})\n\t{\n\t\tlet {users = false, title = '', listType = 'LIST', backdrop = true} = params;\n\n\t\tlet settings = {\n\t\t\ttitle,\n\t\t\tobjectName: \"ChatUserListInterface\",\n\t\t};\n\t\tif (backdrop)\n\t\t{\n\t\t\tsettings.backdrop = {};\n\t\t}\n\n\t\tapp.exec(\"openComponent\", {\n\t\t\tname: \"JSStackComponent\",\n\t\t\tcomponentCode: 'im.dialog.list',\n\t\t\tscriptPath: \"/mobileapp/jn/im.chat.user.list/?version=\"+BX.componentParameters.get('WIDGET_CHAT_USERS_VERSION', '1.0.0'),\n\t\t\tparams: {\n\t\t\t\t\"DIALOG_ID\": this.controller.application.getDialogId(),\n\t\t\t\t\"DIALOG_OWNER_ID\": this.controller.application.getDialogData().ownerId,\n\t\t\t\t\"USER_ID\": this.controller.application.getUserId(),\n\t\t\t\t\"LIST_TYPE\": listType,\n\t\t\t\t\"USERS\": users,\n\t\t\t\t\"IS_BACKDROP\": true,\n\t\t\t},\n\t\t\trootWidget: {name: \"list\", settings}\n\t\t}, false);\n\t}\n\n\topenCallMenu()\n\t{\n\t\tfabric.Answers.sendCustomEvent(\"vueChatCallAudioButton\", {});\n\n\t\tlet userData = this.controller.getStore().getters['users/get'](this.controller.application.getDialogId(), true);\n\n\t\tif (\n\t\t\tuserData.phones.personalMobile\n\t\t\t|| userData.phones.workPhone\n\t\t\t|| userData.phones.personalPhone\n\t\t\t|| userData.phones.innerPhone\n\t\t)\n\t\t{\n\t\t\tBackdropMenu\n\t\t\t\t.create('im.dialog.menu.call|'+this.controller.application.getDialogId())\n\t\t\t\t.setItems([\n\t\t\t\t\tBackdropMenuItem.create('audio')\n\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_AUDIO_CALL'))\n\t\t\t\t\t,\n\t\t\t\t\tBackdropMenuItem.create('personalMobile')\n\t\t\t\t\t\t.setTitle(userData.phones.personalMobile)\n\t\t\t\t\t\t.setSubTitle(this.getLocalize('MOBILE_MENU_CALL_MOBILE'))\n\t\t\t\t\t\t.skip(!userData.phones.personalMobile)\n\t\t\t\t\t,\n\t\t\t\t\tBackdropMenuItem.create('workPhone')\n\t\t\t\t\t\t.setTitle(userData.phones.workPhone)\n\t\t\t\t\t\t.setSubTitle(this.getLocalize('MOBILE_MENU_CALL_WORK'))\n\t\t\t\t\t\t.skip(!userData.phones.workPhone)\n\t\t\t\t\t,\n\t\t\t\t\tBackdropMenuItem.create('personalPhone')\n\t\t\t\t\t\t.setTitle(userData.phones.personalPhone)\n\t\t\t\t\t\t.setSubTitle(this.getLocalize('MOBILE_MENU_CALL_PHONE'))\n\t\t\t\t\t\t.skip(!userData.phones.personalPhone)\n\t\t\t\t\t,\n\t\t\t\t\tBackdropMenuItem.create('innerPhone')\n\t\t\t\t\t\t.setTitle(userData.phones.innerPhone)\n\t\t\t\t\t\t.setSubTitle(this.getLocalize('MOBILE_MENU_CALL_PHONE'))\n\t\t\t\t\t\t.skip(!userData.phones.innerPhone)\n\t\t\t\t\t,\n\t\t\t\t])\n\t\t\t\t.setVersion(BX.componentParameters.get('WIDGET_BACKDROP_MENU_VERSION', '1.0.0'))\n\t\t\t\t.setEventListener((name, params, user, backdrop) =>\n\t\t\t\t{\n\t\t\t\t\tif (name !== 'selected')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (params.id === 'audio')\n\t\t\t\t\t{\n\t\t\t\t\t\tBXMobileApp.Events.postToComponent(\"onCallInvite\", {\n\t\t\t\t\t\t\tuserId: this.controller.application.getDialogId(),\n\t\t\t\t\t\t\tvideo: false,\n\t\t\t\t\t\t\tuserData: {[user.id]: user}\n\t\t\t\t\t\t}, \"calls\");\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'innerPhone')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.MobileTools.phoneTo(user.phones[params.id], {callMethod: 'telephony'});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.MobileTools.phoneTo(user.phones[params.id], {callMethod: 'device'});\n\n\t\t\t\t\t\t// items options\n\t\t\t\t\t\t//.setType(BackdropMenuItemType.menu)\n\t\t\t\t\t\t//.disableClose(BX.MobileTools.canUseTelephony())\n\t\t\t\t\t\t// if (!BX.MobileTools.canUseTelephony())\n\t\t\t\t\t\t// {\n\t\t\t\t\t\t// \tBX.MobileTools.phoneTo(user.phones[params.id], {callMethod: 'device'});\n\t\t\t\t\t\t// \treturn false\n\t\t\t\t\t\t// }\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// let subMenu = BackdropMenu\n\t\t\t\t\t\t// \t.create('im.dialog.menu.call.submenu|'+this.controller.application.getDialogId())\n\t\t\t\t\t\t// \t.setItems([\n\t\t\t\t\t\t// \t\tBackdropMenuItem.create('number')\n\t\t\t\t\t\t// \t\t\t.setType(BackdropMenuItemType.info)\n\t\t\t\t\t\t// \t\t\t.setTitle(this.getLocalize(\"MOBILE_MENU_CALL_TO\")\n\t\t\t\t\t\t// \t\t\t.replace('#PHONE_NUMBER#', user.phones[params.id]))\n\t\t\t\t\t\t// \t\t\t.setHeight(50)\n\t\t\t\t\t\t// \t\t\t.setStyles(BackdropMenuStyle.create().setFont(WidgetListItemFont.create().setFontStyle('bold')))\n\t\t\t\t\t\t// \t\t\t.setDisabled(),\n\t\t\t\t\t\t// \t\tBackdropMenuItem.create('telephony').setTitle(this.getLocalize(\"MOBILE_CALL_BY_B24\")),\n\t\t\t\t\t\t// \t\tBackdropMenuItem.create('device').setTitle(this.getLocalize(\"MOBILE_CALL_BY_MOBILE\")),\n\t\t\t\t\t\t// \t])\n\t\t\t\t\t\t// \t.setEventListener((name, params, options, backdrop) =>\n\t\t\t\t\t\t// \t{\n\t\t\t\t\t\t// \t\tif (name !== 'selected')\n\t\t\t\t\t\t// \t\t{\n\t\t\t\t\t\t// \t\t\treturn false;\n\t\t\t\t\t\t// \t\t}\n\t\t\t\t\t\t// \t\tBX.MobileTools.phoneTo(options.phone, {callMethod: params.id});\n\t\t\t\t\t\t// \t})\n\t\t\t\t\t\t// \t.setCustomParams({phone: user.phones[params.id]})\n\t\t\t\t\t\t// ;\n\t\t\t\t\t\t// backdrop.showSubMenu(subMenu);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.setCustomParams(userData)\n\t\t\t\t.show()\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBXMobileApp.Events.postToComponent(\"onCallInvite\", {\n\t\t\t\tuserId: this.controller.application.getDialogId(),\n\t\t\t\tvideo: false,\n\t\t\t\tuserData: {[this.controller.application.getDialogId()]: userData}\n\t\t\t}, \"calls\");\n\t\t}\n\t}\n\n\tleaveChat(confirm = false)\n\t{\n\t\tif (!confirm)\n\t\t{\n\t\t\tapp.confirm({\n\t\t\t\ttitle: this.getLocalize('MOBILE_HEADER_MENU_LEAVE_CONFIRM'),\n\t\t\t\ttext: '',\n\t\t\t\tbuttons: [\n\t\t\t\t\tthis.getLocalize('MOBILE_HEADER_MENU_LEAVE_YES'),\n\t\t\t\t\tthis.getLocalize('MOBILE_HEADER_MENU_LEAVE_NO')\n\t\t\t\t],\n\t\t\t\tcallback: (button) =>\n\t\t\t\t{\n\t\t\t\t\tif (button === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.leaveChat(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tlet dialogId = this.controller.application.getDialogId();\n\n\t\tthis.controller.restClient.callMethod(RestMethod.imChatLeave, {DIALOG_ID: dialogId}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: RestMethod.imChatLeave,\n\t\t\tdialog: this.controller.application.getDialogData(dialogId)\n\t\t})).then(response => {\n\t\t\tapp.closeController();\n\t\t});\n\t}\n\n\topenAddUserDialog()\n\t{\n\t\tlet listUsers = this.getItemsForAddUserDialog();\n\n\t\tapp.exec(\"openComponent\", {\n\t\t\tname: \"JSStackComponent\",\n\t\t\tcomponentCode: \"im.chat.user.selector\",\n\t\t\tscriptPath: \"/mobileapp/jn/im.chat.user.selector/?version=\"+BX.componentParameters.get('WIDGET_CHAT_RECIPIENTS_VERSION', '1.0.0'),\n\t\t\tparams: {\n\t\t\t\t\"DIALOG_ID\": this.controller.application.getDialogId(),\n\t\t\t\t\"USER_ID\": this.controller.application.getUserId(),\n\n\t\t\t\t\"LIST_USERS\": listUsers,\n\t\t\t\t\"LIST_DEPARTMENTS\": [],\n\t\t\t\t\"SKIP_LIST\": [],\n\n\t\t\t\t\"SEARCH_MIN_SIZE\": BX.componentParameters.get('SEARCH_MIN_TOKEN_SIZE', 3),\n\t\t\t},\n\t\t\trootWidget: {\n\t\t\t\tname: \"chat.recipients\",\n\t\t\t\tsettings: {\n\t\t\t\t\tobjectName: \"ChatUserSelectorInterface\",\n\t\t\t\t\ttitle: BX.message('MOBILE_HEADER_MENU_USER_ADD'),\n\t\t\t\t\tlimit: 100,\n\t\t\t\t\titems: listUsers.map(element => ChatDataConverter.getListElementByUser(element)),\n\t\t\t\t\tscopes: [\n\t\t\t\t\t\t{ title: BX.message('MOBILE_SCOPE_USERS'), id: \"user\" },\n\t\t\t\t\t\t{ title: BX.message('MOBILE_SCOPE_DEPARTMENTS'), id: \"department\" }\n\t\t\t\t\t],\n\t\t\t\t\tbackdrop: {showOnTop: true}\n\t\t\t\t}\n\t\t\t}\n\t\t}, false);\n\t}\n\n\tgetItemsForAddUserDialog()\n\t{\n\t\tlet items = [];\n\t\tlet itemsIndex = {};\n\n\t\tif (this.widgetCache.recentList.length > 0)\n\t\t{\n\t\t\tthis.widgetCache.recentList.map(element =>\n\t\t\t{\n\t\t\t\tif (!element || itemsIndex[element.id])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (element.type === 'user')\n\t\t\t\t{\n\t\t\t\t\titems.push(element.user);\n\t\t\t\t\titemsIndex[element.id] = true;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tthis.widgetCache.colleaguesList.map(element =>\n\t\t{\n\t\t\tif (!element || itemsIndex[element.id])\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\titems.push(element);\n\t\t\titemsIndex[element.id] = true;\n\t\t});\n\n\t\tthis.widgetCache.lastSearchList.map(element =>\n\t\t{\n\t\t\tif (!element || itemsIndex[element.id])\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (element.type === 'user')\n\t\t\t{\n\t\t\t\titems.push(element.user);\n\t\t\t\titemsIndex[element.id] = true;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\n\t\t/*\n\t\tlet skipList = ChatMessengerCommon.getChatUsers();\n\t\tif (skipList.indexOf(this.base.userId) === -1)\n\t\t{\n\t\t\tskipList.push(this.base.userId)\n\t\t}\n\t\titems = items.filter((element) => skipList.indexOf(element.id) === -1);\n\t\t*/\n\n\t\treturn items;\n\t};\n\n/* endregion 02. Mobile environment methods */\n\n/* region 02. Push & Pull */\n\n\teventStoreInteraction(data)\n\t{\n\t\tif (data.type === 'dialogues/update' && data.payload && data.payload.fields)\n\t\t{\n\t\t\t if (\n\t\t\t \ttypeof data.payload.fields.counter !== 'undefined'\n\t\t\t\t&& typeof data.payload.dialogId !== 'undefined'\n\t\t\t )\n\t\t\t {\n\t\t\t \tBXMobileApp.Events.postToComponent(\"chatdialog::counter::change\", [{\n\t\t\t \t\tdialogId: data.payload.dialogId,\n\t\t\t \t\tcounter: data.payload.fields.counter,\n\t\t\t\t}, true], 'im.recent');\n\t\t\t }\n\t\t}\n\t\telse if (data.type === 'dialogues/set')\n\t\t{\n\t\t\tdata.payload.forEach((dialog) => {\n\t\t\t\tBXMobileApp.Events.postToComponent(\"chatdialog::counter::change\", [{\n\t\t\t \t\tdialogId: dialog.dialogId,\n\t\t\t \t\tcounter: dialog.counter,\n\t\t\t\t}, true], 'im.recent');\n\t\t\t});\n\t\t}\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.controller.pullBaseHandler.option.skip = true;\n\n\t\t\t\tthis.getDialogUnread().then(() => {\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t\tthis.controller.application.emit(EventType.dialog.sendReadMessages);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t});\n\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t}\n\t}\n\n\teventOnlineInteraction(data)\n\t{\n\t\tif (data.command === 'list' || data.command === 'userStatus')\n\t\t{\n\t\t\tfor (let userId in data.params.users)\n\t\t\t{\n\t\t\t\tif (!data.params.users.hasOwnProperty(userId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().dispatch('users/update', {\n\t\t\t\t\tid: data.params.users[userId].id,\n\t\t\t\t\tfields: data.params.users[userId]\n\t\t\t\t});\n\n\t\t\t\tif (userId.toString() === this.controller.application.getDialogId())\n\t\t\t\t{\n\t\t\t\t\tthis.redrawHeader();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n\tgetKeyboardParams()\n\t{\n\t\tlet dialogData = this.controller.application.getDialogData();\n\n\t\tlet siteDir = this.getLocalize('SITE_DIR');\n\n\t\treturn {\n\t\t\ttext: dialogData? dialogData.textareaMessage: '',\n\t\t\tplaceholder: this.getLocalize('MOBILE_CHAT_PANEL_PLACEHOLDER'),\n\t\t\tsmileButton: {},\n\t\t\tuseImageButton:true,\n\t\t\tuseAudioMessages: true,\n\t\t\tmentionDataSource:\n\t\t\t{\n\t\t\t\toutsection: \"NO\",\n\t\t\t\turl: siteDir + \"mobile/index.php?mobile_action=get_user_list&use_name_format=Y&with_bots\"\n\t\t\t},\n\t\t\tattachFileSettings:\n\t\t\t{\n\t\t\t\tpreviewMaxWidth: 640,\n\t\t\t\tpreviewMaxHeight: 640,\n\t\t\t\tresize:\n\t\t\t\t{\n\t\t\t\t\ttargetWidth: -1,\n\t\t\t\t\ttargetHeight: -1,\n\t\t\t\t\tsourceType: 1,\n\t\t\t\t\tencodingType: 0,\n\t\t\t\t\tmediaType: 2,\n\t\t\t\t\tallowsEdit: false,\n\t\t\t\t\tsaveToPhotoAlbum: true,\n\t\t\t\t\tpopoverOptions: false,\n\t\t\t\t\tcameraDirection: 0,\n\t\t\t\t},\n\t\t\t\tsendFileSeparately: true,\n\t\t\t\tshowAttachedFiles: true,\n\t\t\t\teditingMediaFiles:false,\n\t\t\t\tmaxAttachedFilesCount: 100\n\t\t\t},\n\t\t\tattachButton: {items:\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tid:\"disk\",\n\t\t\t\t\tname: this.getLocalize(\"MOBILE_CHAT_PANEL_UPLOAD_DISK\"),\n\t\t\t\t\tdataSource:\n\t\t\t\t\t{\n\t\t\t\t\t\tmultiple:false,\n\t\t\t\t\t\turl: siteDir + \"mobile/?mobile_action=disk_folder_list&type=user&path=%2F&entityId=\"+this.controller.application.getUserId(),\n\t\t\t\t\t\tTABLE_SETTINGS:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsearchField: true,\n\t\t\t\t\t\t\tshowtitle: true,\n\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\tname: this.getLocalize(\"MOBILE_CHAT_PANEL_UPLOAD_DISK_FILES\")\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"mediateka\",\n\t\t\t\t\tname: this.getLocalize(\"MOBILE_CHAT_PANEL_UPLOAD_GALLERY\")\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"camera\",\n\t\t\t\t\tname: this.getLocalize(\"MOBILE_CHAT_PANEL_UPLOAD_CAMERA\")\n\t\t\t\t}\n\t\t\t]},\n\t\t\taction: (data) =>\n\t\t\t{\n\t\t\t\tif (typeof data === \"string\")\n\t\t\t\t{\n\t\t\t\t\tdata = {text: data, attachedFiles: []};\n\t\t\t\t}\n\n\t\t\t\tconst text = data.text.toString().trim();\n\t\t\t\tconst attachedFiles = data.attachedFiles instanceof Array? data.attachedFiles: [];\n\n\t\t\t\tif (attachedFiles.length <= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.clearText();\n\t\t\t\t\tthis.hideSmiles();\n\n\t\t\t\t\tlet editId = this.controller.getStore().getters['dialogues/getEditId'](this.controller.application.getDialogId());\n\t\t\t\t\tif (editId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.updateMessage(editId, text);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.addMessage(text);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tattachedFiles.forEach(file => {\n\t\t\t\t\t\t// disk\n\t\t\t\t\t\tif (typeof file.dataAttributes !== 'undefined')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfabric.Answers.sendCustomEvent(\"vueChatFileDisk\", {});\n\n\t\t\t\t\t\t\treturn this.uploadFile({\n\t\t\t\t\t\t\t\tsource: 'disk',\n\t\t\t\t\t\t\t\tname: file.name,\n\t\t\t\t\t\t\t\ttype: file.type.toString().toLowerCase(),\n\t\t\t\t\t\t\t\tpreview: !file.dataAttributes.URL || !file.dataAttributes.URL.PREVIEW? null: {\n\t\t\t\t\t\t\t\t\turl: file.dataAttributes.URL.PREVIEW,\n\t\t\t\t\t\t\t\t\twidth: file.dataAttributes.URL.PREVIEW.match(/(width=(\\d+))/i)[2],\n\t\t\t\t\t\t\t\t\theight: file.dataAttributes.URL.PREVIEW.match(/(height=(\\d+))/i)[2]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tuploadLink: parseInt(file.dataAttributes.ID),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// audio\n\t\t\t\t\t\tif (file.type === 'audio/mp4')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfabric.Answers.sendCustomEvent(\"vueChatFileAudio\", {});\n\n\t\t\t\t\t\t\treturn this.uploadFile({\n\t\t\t\t\t\t\t\tsource: 'audio',\n\t\t\t\t\t\t\t\tname: 'mobile_audio_'+(new Date).toJSON().slice(0, 19).replace('T', '_').split(':').join('-')+'.mp3',\n\t\t\t\t\t\t\t\ttype: 'mp3',\n\t\t\t\t\t\t\t\tpreview: null,\n\t\t\t\t\t\t\t\tuploadLink: file.url,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet filename = file.name;\n\t\t\t\t\t\tlet fileType = FilesModel.getType(file.name);\n\n\t\t\t\t\t\tif (fileType === FileType.video)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfabric.Answers.sendCustomEvent(\"vueChatFileVideo\", {});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (fileType === FileType.image)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfabric.Answers.sendCustomEvent(\"vueChatFileImage\", {});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfabric.Answers.sendCustomEvent(\"vueChatFileOther\", {});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tfileType === FileType.image\n\t\t\t\t\t\t\t|| fileType === FileType.video\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet extension = file.name.split('.').slice(-1)[0].toLowerCase();\n\t\t\t\t\t\t\tif (file.type === 'image/heic')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\textension = 'jpg';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfilename = 'mobile_file_'+(new Date).toJSON().slice(0, 19).replace('T', '_').split(':').join('-')+'.'+extension;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// file\n\t\t\t\t\t\treturn this.uploadFile({\n\t\t\t\t\t\t\tsource: 'gallery',\n\t\t\t\t\t\t\tname: filename,\n\t\t\t\t\t\t\ttype: file.type.toString().toLowerCase(),\n\t\t\t\t\t\t\tpreview: !file.previewUrl? null: {\n\t\t\t\t\t\t\t\turl: file.previewUrl,\n\t\t\t\t\t\t\t\twidth: file.previewWidth,\n\t\t\t\t\t\t\t\theight: file.previewHeight\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tuploadLink: file.url,\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tconsole.log('Textpanel callback', data);\n\t\t\t\tif (!data.event)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (data.event === \"onKeyPress\")\n\t\t\t\t{\n\t\t\t\t\tlet text = data.text.toString();\n\t\t\t\t\tif (text.trim().length > 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.controller.application.startWriting();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (text.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.controller.application.setTextareaMessage({message: ''});\n\t\t\t\t\t\tthis.controller.application.stopWriting();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setTextareaMessage({message: text});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (data.event === \"onSmileSelect\")\n\t\t\t\t{\n\t\t\t\t\tthis.controller.showSmiles();\n\t\t\t\t}\n\t\t\t\telse if (Application.getPlatform() !== \"android\")\n\t\t\t\t{\n\t\t\t\t\tif (data.event === \"getFocus\")\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Utils.platform.isIos() && Utils.platform.getIosVersion() > 12)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.controller.application.emit(EventType.dialog.scrollToBottom, {duration: 300, cancelIfScrollChange: true})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (data.event === \"removeFocus\")\n\t\t\t\t\t{\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n/* region 04. Rest methods */\n\n\taddMessage(text, file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet quiteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.controller.application.getDialogId());\n\t\tif (quiteId)\n\t\t{\n\t\t\tlet quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.controller.application.getChatId(), quiteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = null;\n\t\t\t\tif (quoteMessage.authorId)\n\t\t\t\t{\n\t\t\t\t\tuser = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\t\t\t\t}\n\n\t\t\t\tlet files = this.controller.getStore().getters['files/getList'](this.controller.application.getChatId());\n\n\t\t\t\tlet message = [];\n\t\t\t\tmessage.push('-'.repeat(54));\n\t\t\t\tmessage.push((user && user.name? user.name: this.getLocalize('MOBILE_CHAT_SYSTEM_MESSAGE'))+' ['+Utils.date.format(quoteMessage.date, null, this.getLocalize())+']');\n\t\t\t\tmessage.push(Utils.text.quote(quoteMessage.text, quoteMessage.params, files, this.getLocalize()));\n\t\t\t\tmessage.push('-'.repeat(54));\n\t\t\t\tmessage.push(text);\n\t\t\t\ttext = message.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tconsole.warn('addMessage', text, file);\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, chatId: this.controller.application.getChatId(), dialogId: this.controller.application.getDialogId(), text, file});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/increaseDialogExtraCount');\n\n\t\tlet params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('messages/add', {\n\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\tauthorId: this.controller.application.getUserId(),\n\t\t\ttext: text,\n\t\t\tparams,\n\t\t\tsending: !file,\n\t\t}).then(messageId => {\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\t\ttext,\n\t\t\t\tfile,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.controller.application.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tuploadFile(file, text = '')\n\t{\n\t\tif (!file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconsole.warn('addFile', file, text);\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.addMessage(text, {id: 0, source: file});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('files/add', this.controller.application.prepareFilesBeforeSave({\n\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\tauthorId: this.controller.application.getUserId(),\n\t\t\tname: file.name,\n\t\t\ttype: FilesModel.getType(file.name),\n\t\t\textension: file.name.split('.').splice(-1)[0],\n\t\t\tsize: 0,\n\t\t\timage: !file.preview? false: {\n\t\t\t\twidth: file.preview.width,\n\t\t\t\theight: file.preview.height,\n\t\t\t},\n\t\t\tstatus: file.source === 'disk'? FileStatus.wait: FileStatus.upload,\n\t\t\tprogress: 0,\n\t\t\tauthorName: this.controller.application.getCurrentUser().name,\n\t\t\turlPreview: !file.preview? '': file.preview.url,\n\t\t})).then(fileId => this.addMessage(text, {id: fileId, ...file}));\n\n\t\treturn true;\n\t}\n\n\tcancelUploadFile(fileId)\n\t{\n\t\tlet element = this.messagesQueue.find(element => element.file && element.file.id === fileId);\n\t\tif (element)\n\t\t{\n\t\t\tBX.MobileUploadProvider.cancelTasks(['imDialog'+fileId]);\n\n\t\t\tthis.controller.getStore().dispatch('messages/delete', {\n\t\t\t\tchatId: element.chatId,\n\t\t\t\tid: element.id,\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.getStore().dispatch('files/delete', {\n\t\t\t\t\tchatId: element.chatId,\n\t\t\t\t\tid: element.file.id,\n\t\t\t\t});\n\t\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id !== element.id);\n\t\t\t});\n\t\t}\n\t}\n\n\tretryUploadFile(fileId)\n\t{\n\t\tlet element = this.messagesQueue.find(element => element.file && element.file.id === fileId);\n\t\tif (!element)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('messages/actionStart', {\n\t\t\tchatId: element.chatId,\n\t\t\tid: element.id\n\t\t}).then(() => {\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: element.chatId,\n\t\t\t\tid: element.file.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: 0\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\telement.sending = false;\n\t\tthis.processSendMessages();\n\n\t\treturn true;\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element =>\n\t\t{\n\t\t\telement.sending = true;\n\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tif (element.file.source === 'disk')\n\t\t\t\t{\n\t\t\t\t\tthis.fileCommit({\n\t\t\t\t\t\tchatId: element.chatId,\n\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\tdiskId: element.file.uploadLink,\n\t\t\t\t\t\tmessageText: element.text,\n\t\t\t\t\t\tmessageId: element.id,\n\t\t\t\t\t\tfileId: element.file.id,\n\t\t\t\t\t\tfileType: FilesModel.getType(element.file.name),\n\t\t\t\t\t}, element);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.controller.application.getDiskFolderId())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sendMessageWithFile(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\telement.sending = false;\n\t\t\t\t\t\tthis.requestDiskFolderId();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\telement.sending = true;\n\t\t\t\tthis.sendMessage(element);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tprocessMarkReadMessages()\n\t{\n\t\tthis.controller.application.readMessageExecute(this.controller.application.getChatId(), true);\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tmessage.text = message.text.replace(/^([-]{21}\\n)/gm, '-'.repeat(54)+'\\n');\n\n\t\tthis.controller.application.stopWriting(message.dialogId);\n\n\t\tBXMobileApp.Events.postToComponent('chatbackground::task::add', [\n\t\t\t'sendMessage|'+message.id,\n\t\t\t[RestMethod.imMessageAdd, {\n\t\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t\t'DIALOG_ID': message.dialogId,\n\t\t\t\t'MESSAGE': message.text\n\t\t\t}],\n\t\t\tmessage\n\t\t], 'background');\n\t}\n\n\tsendMessageWithFile(message)\n\t{\n\t\tlet fileType = FilesModel.getType(message.file.name);\n\t\tlet fileExtension = message.file.name.toString().toLowerCase().split('.').splice(-1)[0];\n\t\tlet attachPreviewFile = fileType !== FileType.image && message.file.preview;\n\t\tlet needConvert = fileType === FileType.image && message.file.type !== 'image/gif' || fileType === FileType.video;\n\n\t\tBX.MobileUploadProvider.addTasks([{\n\t\t\turl: message.file.uploadLink,\n\t\t\tparams: message,\n\t\t\tname: message.file.name,\n\t\t\ttype: fileExtension,\n\t\t\tmimeType: fileType === FileType.audio? 'audio/mp4': null,\n\t\t\tresize: !needConvert? null: {\n\t\t\t\t\"quality\":80,\n\t\t\t\t\"width\":1920,\n\t\t\t\t\"height\":1080,\n\t\t\t},\n\t\t\tpreviewUrl: attachPreviewFile? message.file.preview.url: '',\n\t\t\tfolderId: this.controller.application.getDiskFolderId(),\n\t\t\ttaskId: 'imDialog'+message.file.id,\n\t\t\tonDestroyEventName: 'onimdiskmessageaddsuccess'\n\t\t}]);\n\t}\n\n\tfileError(chatId, fileId, messageId = 0)\n\t{\n\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\tchatId: chatId,\n\t\t\tid: fileId,\n\t\t\tfields: {\n\t\t\t\tstatus: FileStatus.error,\n\t\t\t\tprogress: 0\n\t\t\t}\n\t\t});\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('messages/actionError', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: messageId,\n\t\t\t\tretry: true,\n\t\t\t});\n\t\t}\n\t}\n\n\tfileCommit(params, message)\n\t{\n\t\tlet queryParams = {\n\t\t\tchat_id: params.chatId,\n\t\t\tmessage: params.messageText,\n\t\t\ttemplate_id: params.messageId? params.messageId: 0,\n\t\t\tfile_template_id: params.fileId? params.fileId: 0,\n\t\t};\n\t\tif (params.uploadId)\n\t\t{\n\t\t\tqueryParams.upload_id = params.uploadId;\n\t\t}\n\t\telse if (params.diskId)\n\t\t{\n\t\t\tqueryParams.disk_id = params.diskId;\n\t\t}\n\n\t\tthis.controller.restClient.callMethod(RestMethod.imDiskFileCommit, queryParams, null, null, Utils.getLogTrackingParams({\n\t\t\tname: RestMethod.imDiskFileCommit,\n\t\t\tdata: {timMessageType: params.fileType},\n\t\t\tdialog: this.controller.application.getDialogData(params.dialogId)\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imDiskFileCommit, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imDiskFileCommit, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\trequestDiskFolderId()\n\t{\n\t\tif (this.flagRequestDiskFolderIdSended || this.controller.application.getDiskFolderId())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.flagRequestDiskFolderIdSended = true;\n\n\t\tthis.controller.restClient.callMethod(RestMethod.imDiskFolderGet, {chat_id: this.controller.application.getChatId()}).then(response => {\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imDiskFolderGet, response);\n\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\tthis.processSendMessages();\n\t\t}).catch(error => {\n\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imDiskFolderGet, error);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tgetDialogHistory(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tthis.controller.restClient.callMethod(RestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.controller.application.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imDialogMessagesGet, result);\n\t\t\tthis.controller.application.emit(EventType.dialog.requestHistoryResult, {count: result.data().messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.controller.emit(EventType.dialog.requestHistoryResult, {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tif (this.promiseGetDialogUnreadWait)\n\t\t{\n\t\t\treturn this.promiseGetDialogUnread;\n\t\t}\n\n\t\tthis.promiseGetDialogUnread = new BX.Promise();\n\t\tthis.promiseGetDialogUnreadWait = true;\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.controller.getStore().getters['messages/getLastId'](this.controller.application.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.controller.application.emit(EventType.dialog.requestUnreadResult, {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\n\t\t\tthis.promiseGetDialogUnread.reject();\n\t\t\tthis.promiseGetDialogUnreadWait = false;\n\n\t\t\treturn this.promiseGetDialogUnread;\n\t\t}\n\n\t\tthis.controller.application.readMessage(lastId, true, true).then(() =>\n\t\t{\n\t\t\tthis.timer.start('data', 'load', .5, () => {\n\t\t\t\tconsole.warn(\"ChatDialog.requestData: slow connection show progress icon\");\n\t\t\t\tapp.titleAction(\"setParams\", {useProgress: true, useLetterImage: false});\n\t\t\t});\n\n\t\t\tlet query = {\n\t\t\t\t[RestMethodHandler.imDialogRead]: [RestMethod.imDialogRead, {\n\t\t\t\t\tdialog_id: this.controller.application.getDialogId(),\n\t\t\t\t\tmessage_id: lastId\n\t\t\t\t}],\n\t\t\t\t[RestMethodHandler.imChatGet]: [RestMethod.imChatGet, {\n\t\t\t\t\tdialog_id: this.controller.application.getDialogId()\n\t\t\t\t}],\n\t\t\t\t[RestMethodHandler.imDialogMessagesGetUnread]: [RestMethod.imDialogMessagesGet, {\n\t\t\t\t\tchat_id: this.controller.application.getChatId(),\n\t\t\t\t\tfirst_id: lastId,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t\t{\n\t\t\t\tif (!response)\n\t\t\t\t{\n\t\t\t\t\tthis.controller.application.emit(EventType.dialog.requestUnreadResult, {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\t\tthis.promiseGetDialogUnread.reject();\n\t\t\t\t\tthis.promiseGetDialogUnreadWait = false;\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet chatGetResult = response[RestMethodHandler.imChatGet];\n\t\t\t\tif (!chatGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imChatGet, chatGetResult);\n\t\t\t\t}\n\n\t\t\t\tlet dialogMessageUnread = response[RestMethodHandler.imDialogMessagesGetUnread];\n\t\t\t\tif (dialogMessageUnread.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.application.emit(EventType.dialog.requestUnreadResult, {error: dialogMessageUnread.error().ex});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imDialogMessagesGetUnread, dialogMessageUnread);\n\n\t\t\t\t\tthis.controller.application.emit(EventType.dialog.requestUnreadResult, {\n\t\t\t\t\t\tfirstMessageId: dialogMessageUnread.data().messages.length > 0? dialogMessageUnread.data().messages[0].id: 0,\n\t\t\t\t\t\tcount: dialogMessageUnread.data().messages.length\n\t\t\t\t\t});\n\n\t\t\t\t\tapp.titleAction(\"setParams\", {useProgress: false, useLetterImage: true});\n\t\t\t\t\tthis.timer.stop('data', 'load', true);\n\t\t\t\t}\n\n\t\t\t\tthis.promiseGetDialogUnread.fulfill(response);\n\t\t\t\tthis.promiseGetDialogUnreadWait = false;\n\n\t\t\t}, false, false, Utils.getLogTrackingParams({name: RestMethodHandler.imDialogMessagesGetUnread, dialog: this.controller.application.getDialogData()}));\n\t\t});\n\n\t\treturn this.promiseGetDialogUnread;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tlet element = this.messagesQueue.find(el => el.id === message.id);\n\t\tif (element)\n\t\t{\n\t\t\tif (element.file && element.file.id)\n\t\t\t{\n\t\t\t\tthis.retryUploadFile(element.file.id)\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.controller.application.setSendingMessageFlag(message.id);\n\n\t\tthis.processSendMessages();\n\t}\n\n\topenProfile(userId)\n\t{\n\t\tBXMobileApp.Events.postToComponent(\"onUserProfileOpen\", [userId, {backdrop: true}], 'communication');\n\t}\n\n\topenDialog(dialogId)\n\t{\n\t\tBXMobileApp.Events.postToComponent(\"onOpenDialog\", [{dialogId}, true], 'im.recent');\n\t}\n\n\topenPhoneMenu(number)\n\t{\n\t\tBX.MobileTools.phoneTo(number);\n\t}\n\n\topenMessageMenu(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id === message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('messages/update', {\n\t\t\tid: message.id,\n\t\t\tchatId: message.chatId,\n\t\t\tfields: {\n\t\t\t\tblink: true\n\t\t\t}\n\t\t});\n\n\t\tlet currentUser = this.controller.application.getCurrentUser();\n\t\tlet dialog = this.controller.application.getDialogData();\n\t\tlet messageUser = message.authorId > 0? this.controller.getStore().getters['users/get'](message.authorId, true): null;\n\n\t\tthis.messageMenuInstance = BackdropMenu\n\t\t\t.create('im.dialog.menu.mess|'+this.controller.application.getDialogId())\n\t\t\t.setItems([\n\t\t\t\tBackdropMenuItem.create('reply')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_REPLY'))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.reply)\n\t\t\t\t\t.skip((message) => {\n\t\t\t\t\t\tlet dialog = this.controller.application.getDialogData();\n\t\t\t\t\t\tif (dialog.type === 'announcement' && !dialog.managerList.includes(this.controller.application.getUserId()))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn !message.authorId || message.authorId === this.controller.application.getUserId()\n\t\t\t\t\t})\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('copy')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_COPY'))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.copy)\n\t\t\t\t\t.skip((message) => message.params.IS_DELETED === 'Y')\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('quote')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_QUOTE'))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.quote)\n\t\t\t\t\t.skip((message) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tlet dialog = this.controller.application.getDialogData();\n\t\t\t\t\t\tif (dialog.type === 'announcement' && !dialog.managerList.includes(this.controller.application.getUserId()))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn message.params.IS_DELETED === 'Y';\n\t\t\t\t\t})\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('unread')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_UNREAD'))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.unread)\n\t\t\t\t\t.skip((message) => message.authorId === this.controller.application.getUserId() || message.unread)\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('read')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_READ'))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.checked)\n\t\t\t\t\t.skip((message) => !message.unread)\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('edit')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_EDIT'))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.edit)\n\t\t\t\t\t.skip((message) => message.authorId !== this.controller.application.getUserId() || message.params.IS_DELETED === 'Y')\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('share')\n\t\t\t\t\t.setType(BackdropMenuItemType.menu)\n\t\t\t\t\t.setIcon(BackdropMenuIcon.circle_plus)\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_SHARE_MENU'))\n\t\t\t\t\t.disableClose()\n\t\t\t\t\t.skip(currentUser.extranet || dialog.type === 'announcement')\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('profile')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_PROFILE'))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.user)\n\t\t\t\t\t.skip((message) => {\n\n\t\t\t\t\t\tif (message.authorId <= 0 || !messageUser)\n\t\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t\tif (!Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t\tif (message.authorId === this.controller.application.getUserId())\n\t\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tmessageUser.externalAuthId === 'imconnector'\n\t\t\t\t\t\t\t|| messageUser.externalAuthId === 'call'\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn  false;\n\t\t\t\t\t})\n\t\t\t\t,\n\n\t\t\t\tBackdropMenuItem.create('delete')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_DELETE'))\n\t\t\t\t\t.setStyles(BackdropMenuStyle.create().setFont(WidgetListItemFont.create().setColor('#c50000')))\n\t\t\t\t\t.setIcon(BackdropMenuIcon.trash)\n\t\t\t\t\t.skip((message) => message.authorId !== this.controller.application.getUserId() || message.params.IS_DELETED === 'Y')\n\t\t\t\t,\n\t\t\t])\n\t\t\t.setVersion(BX.componentParameters.get('WIDGET_BACKDROP_MENU_VERSION', '1.0.0'))\n\t\t\t.setEventListener((name, params, message, backdrop) => {\n\t\t\t\tif (name === 'destroyed')\n\t\t\t\t{\n\t\t\t\t\tVue.event.$emit('bitrixmobile:controller:focus');\n\t\t\t\t}\n\n\t\t\t\tif (name !== 'selected')\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (params.id === 'reply')\n\t\t\t\t{\n\t\t\t\t\tthis.replyToUser(message.authorId);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'copy')\n\t\t\t\t{\n\t\t\t\t\tthis.copyMessage(message.id);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'quote')\n\t\t\t\t{\n\t\t\t\t\tthis.quoteMessageClear();\n\t\t\t\t\tthis.quoteMessage(message.id);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'edit')\n\t\t\t\t{\n\t\t\t\t\tthis.quoteMessageClear();\n\t\t\t\t\tthis.editMessage(message.id);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'delete')\n\t\t\t\t{\n\t\t\t\t\tthis.deleteMessage(message.id);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'unread')\n\t\t\t\t{\n\t\t\t\t\tthis.unreadMessage(message.id);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'read')\n\t\t\t\t{\n\t\t\t\t\tthis.readMessage(message.id);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'share')\n\t\t\t\t{\n\t\t\t\t\tlet dialog = this.controller.application.getDialogData();\n\t\t\t\t\tlet subMenu = BackdropMenu\n\t\t\t\t\t\t.create('im.dialog.menu.mess.submenu|'+this.controller.application.getDialogId())\n\t\t\t\t\t\t.setItems([\n\t\t\t\t\t\t\tBackdropMenuItem.create('share_task')\n\t\t\t\t\t\t\t\t.setIcon(BackdropMenuIcon.task)\n\t\t\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_SHARE_TASK'))\n\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\tBackdropMenuItem.create('share_post')\n\t\t\t\t\t\t\t\t.setIcon(BackdropMenuIcon.lifefeed)\n\t\t\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_SHARE_POST_NEWS'))\n\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\tBackdropMenuItem.create('share_chat')\n\t\t\t\t\t\t\t\t.setIcon(BackdropMenuIcon.chat)\n\t\t\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_MESSAGE_MENU_SHARE_CHAT'))\n\t\t\t\t\t\t\t,\n\t\t\t\t\t\t])\n\t\t\t\t\t\t.setEventListener((name, params, options, backdrop) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (name !== 'selected')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tif (params.id === 'share_task')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.shareMessage(message.id, 'TASK');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (params.id === 'share_post')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.shareMessage(message.id, 'POST');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (params.id === 'share_chat')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.shareMessage(message.id, 'CHAT');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t\tbackdrop.showSubMenu(subMenu);\n\t\t\t\t}\n\t\t\t\telse if (params.id === 'profile')\n\t\t\t\t{\n\t\t\t\t\tthis.openProfile(message.authorId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BackdropMenuItem is not implemented', params);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tthis.messageMenuInstance.setCustomParams(message).show();\n\n\t\tfabric.Answers.sendCustomEvent(\"vueChatOpenDropdown\", {});\n\t}\n\n\topenHeaderMenu()\n\t{\n\t\tfabric.Answers.sendCustomEvent(\"vueChatOpenHeaderMenu\", {});\n\n\t\tif (!this.headerMenu)\n\t\t{\n\t\t\tthis.headerMenu = HeaderMenu.create()\n\t\t\t\t.setUseNavigationBarColor()\n\t\t\t\t.setEventListener((name, params, customParams) => {\n\t\t\t\t\tif (name !== 'selected')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (params.id === 'profile')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.openProfile(this.controller.application.getDialogId());\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'user_list')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.openUserList({listType: 'USERS', title: this.getLocalize('MOBILE_HEADER_MENU_USER_LIST'), backdrop: true});\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'user_add')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.openAddUserDialog();\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'leave')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.leaveChat();\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'notify')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.controller.application.muteDialog();\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'call_chat_call')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.MobileTools.phoneTo(this.controller.application.getDialogData().entityId);\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'goto_crm')\n\t\t\t\t\t{\n\t\t\t\t\t\tlet crmData = this.controller.application.getDialogCrmData();\n\t\t\t\t\t\tlet openWidget = BX.MobileTools.resolveOpenFunction('/crm/'+crmData.entityType+'/show/'+crmData.entityId+'/');\n\t\t\t\t\t\tif (openWidget)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\topenWidget();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.id === 'reload')\n\t\t\t\t\t{\n\t\t\t\t\t\t(new BXMobileApp.UI.NotificationBar({\n\t\t\t\t\t\t\tmessage: this.getLocalize('MOBILE_HEADER_MENU_RELOAD_WAIT'),\n\t\t\t\t\t\t\tcolor: \"#d920b0ff\",\n\t\t\t\t\t\t\ttextColor: \"#ffffff\",\n\t\t\t\t\t\t\tgroupId: \"refresh\",\n\t\t\t\t\t\t\tuseLoader: true,\n\t\t\t\t\t\t\tmaxLines: 1,\n\t\t\t\t\t\t\talign: \"center\",\n\t\t\t\t\t\t\thideOnTap: true\n\t\t\t\t\t\t}, \"copy\")).show();\n\n\t\t\t\t\t\tthis.controller.getStoreBuilder().clearDatabase();\n\n\t\t\t\t\t\treload();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\tif (Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\tlet dialogData = this.controller.application.getDialogData();\n\t\t\tlet notifyToggleText = !this.controller.application.isDialogMuted()? this.getLocalize('MOBILE_HEADER_MENU_NOTIFY_DISABLE'): this.getLocalize('MOBILE_HEADER_MENU_NOTIFY_ENABLE');\n\t\t\tlet notifyToggleIcon = !this.controller.application.isDialogMuted()? HeaderMenuIcon.notify: HeaderMenuIcon.notify_off;\n\n\t\t\tlet gotoCrmLocalize = '';\n\t\t\tif (\n\t\t\t\tdialogData.type === DialogType.call\n\t\t\t\t|| dialogData.type === DialogType.crm\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet crmData = this.controller.application.getDialogCrmData();\n\t\t\t\tif (crmData.enabled)\n\t\t\t\t{\n\t\t\t\t\tif (crmData.entityType === DialogCrmType.lead)\n\t\t\t\t\t{\n\t\t\t\t\t\tgotoCrmLocalize = this.getLocalize('MOBILE_GOTO_CRM_LEAD');\n\t\t\t\t\t}\n\t\t\t\t\telse if (crmData.entityType === DialogCrmType.company)\n\t\t\t\t\t{\n\t\t\t\t\t\tgotoCrmLocalize = this.getLocalize('MOBILE_GOTO_CRM_COMPANY');\n\t\t\t\t\t}\n\t\t\t\t\telse if (crmData.entityType === DialogCrmType.contact)\n\t\t\t\t\t{\n\t\t\t\t\t\tgotoCrmLocalize = this.getLocalize('MOBILE_GOTO_CRM_CONTACT');\n\t\t\t\t\t}\n\t\t\t\t\telse if (crmData.entityType === DialogCrmType.deal)\n\t\t\t\t\t{\n\t\t\t\t\t\tgotoCrmLocalize = this.getLocalize('MOBILE_GOTO_CRM_DEAL');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tgotoCrmLocalize = this.getLocalize('MOBILE_GOTO_CRM');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dialogData.type === DialogType.call)\n\t\t\t{\n\t\t\t\tthis.headerMenu.setItems([\n\t\t\t\t\tHeaderMenuItem.create('call_chat_call')\n\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_AUDIO_CALL'))\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.phone)\n\t\t\t\t\t\t.skip(dialogData.entityId === 'UNIFY_CALL_CHAT')\n\t\t\t\t\t,\n\t\t\t\t\tHeaderMenuItem.create('goto_crm')\n\t\t\t\t\t\t.setTitle(gotoCrmLocalize)\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.lifefeed)\n\t\t\t\t\t\t.skip(dialogData.entityId === 'UNIFY_CALL_CHAT' || !gotoCrmLocalize)\n\t\t\t\t\t,\n\t\t\t\t\tHeaderMenuItem.create('reload')\n\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_RELOAD'))\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.reload)\n\t\t\t\t\t,\n\t\t\t\t]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet items = [\n\t\t\t\t\tHeaderMenuItem.create('notify')\n\t\t\t\t\t\t.setTitle(notifyToggleText)\n\t\t\t\t\t\t.setIcon(notifyToggleIcon)\n\t\t\t\t\t,\n\t\t\t\t\tHeaderMenuItem.create('user_list')\n\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_USER_LIST'))\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.user)\n\t\t\t\t\t,\n\t\t\t\t\tHeaderMenuItem.create('user_add')\n\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_USER_ADD'))\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.user_plus)\n\t\t\t\t\t\t.skip(!dialogData.restrictions.extend)\n\t\t\t\t\t,\n\t\t\t\t\tHeaderMenuItem.create('leave')\n\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_LEAVE'))\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.cross)\n\t\t\t\t\t\t.skip(!dialogData.restrictions.leave)\n\t\t\t\t\t,\n\t\t\t\t\tHeaderMenuItem.create('reload')\n\t\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_RELOAD'))\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.reload)\n\t\t\t\t\t,\n\t\t\t\t];\n\n\t\t\t\titems.push(HeaderMenuItem.create('reload')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_RELOAD'))\n\t\t\t\t\t.setIcon(HeaderMenuIcon.reload));\n\n\t\t\t\tif (\n\t\t\t\t\tdialogData.type === DialogType.crm\n\t\t\t\t\t&& gotoCrmLocalize\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\titems.unshift(HeaderMenuItem.create('goto_crm')\n\t\t\t\t\t\t.setTitle(gotoCrmLocalize)\n\t\t\t\t\t\t.setIcon(HeaderMenuIcon.lifefeed)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.headerMenu.setItems(items);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.headerMenu.setItems([\n\t\t\t\tHeaderMenuItem.create('profile')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_PROFILE'))\n\t\t\t\t\t.setIcon('user')\n\t\t\t\t\t.skip(Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t\t\t,\n\t\t\t\tHeaderMenuItem.create('user_add')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_USER_ADD'))\n\t\t\t\t\t.setIcon(HeaderMenuIcon.user_plus)\n\t\t\t\t,\n\t\t\t\tHeaderMenuItem.create('reload')\n\t\t\t\t\t.setTitle(this.getLocalize('MOBILE_HEADER_MENU_RELOAD'))\n\t\t\t\t\t.setIcon(HeaderMenuIcon.reload)\n\t\t\t\t,\n\t\t\t]);\n\t\t}\n\n\t\tthis.headerMenu.show(true);\n\t}\n\n\tshareMessage(messageId, type)\n\t{\n\t\tif (!this.controller.isOnline())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.application.shareMessage(messageId, type);\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\t// if (this.controller.isOnline())\n\t\t// {\n\t\t// \treturn false;\n\t\t// }\n\n\t\tthis.controller.application.readMessage(messageId, true, true).then((result) =>\n\t\t{\n\t\t\tif (result.lastId <= 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tBXMobileApp.Events.postToComponent('chatbackground::task::action', [\n\t\t\t\t'readMessage',\n\t\t\t\t'readMessage|'+result.dialogId,\n\t\t\t\tresult,\n\t\t\t\tfalse,\n\t\t\t\t200\n\t\t\t], 'background');\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tunreadMessage(messageId)\n\t{\n\t\tif (!this.controller.isOnline())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.application.unreadMessage(messageId);\n\t}\n\n\topenReadedList(list)\n\t{\n\t\tif (!Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!list || list.length <= 1)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.openUserList({\n\t\t\tusers: list.map(element => element.userId),\n\t\t\ttitle: this.getLocalize('MOBILE_MESSAGE_LIST_VIEW')\n\t\t});\n\t}\n\n\treplyToUser(userId, userData = null)\n\t{\n\t\tif (!this.controller.isOnline())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!userData)\n\t\t{\n\t\t\tuserData = this.controller.getStore().getters['users/get'](userId);\n\t\t}\n\n\t\treturn this.insertText({text: `[USER=${userId}]${userData.firstName}[/USER] `});\n\t}\n\n\tcopyMessage(id)\n\t{\n\t\tlet quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.controller.application.getChatId(), id);\n\n\t\tlet text = '';\n\n\t\tif (quoteMessage.params.FILE_ID && quoteMessage.params.FILE_ID.length)\n\t\t{\n\t\t\ttext = quoteMessage.params.FILE_ID.map(fileId => '[DISK='+fileId+']').join(\" \");\n\t\t}\n\n\t\tif (quoteMessage.text)\n\t\t{\n\t\t\tif (text)\n\t\t\t{\n\t\t\t\ttext += '\\n';\n\t\t\t}\n\n\t\t\ttext += quoteMessage.text.replace(/^([-]{54}\\n)/gm, '-'.repeat(21)+'\\n');\n\t\t}\n\n\t\tapp.exec(\"copyToClipboard\", {text});\n\n\t\t(new BXMobileApp.UI.NotificationBar({\n\t\t\tmessage: BX.message(\"MOBILE_MESSAGE_MENU_COPY_SUCCESS\"),\n\t\t\tcolor: \"#af000000\",\n\t\t\ttextColor: \"#ffffff\",\n\t\t\tgroupId: \"clipboard\",\n\t\t\tmaxLines: 1,\n\t\t\talign: \"center\",\n\t\t\tisGlobal: true,\n\t\t\tuseCloseButton: true,\n\t\t\tautoHideTimeout: 1500,\n\t\t\thideOnTap: true\n\t\t}, \"copy\")).show();\n\t}\n\n\tquoteMessage(id)\n\t{\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: id\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tif (this.controller.getStore().state.application.mobile.keyboardShow)\n\t\t\t{\n\t\t\t\tsetTimeout(() => this.controller.application.emit(EventType.dialog.scrollToBottom, {duration: 300, cancelIfScrollChange: true, force: true}), 300);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setTextFocus();\n\t\t\t}\n\t\t});\n\t}\n\n\treactMessage(id, reaction)\n\t{\n\t\tBXMobileApp.Events.postToComponent('chatbackground::task::action', [\n\t\t\t'reactMessage',\n\t\t\t'reactMessage|'+id,\n\t\t\t{\n\t\t\t\tmessageId: id,\n\t\t\t\taction: reaction.action === 'auto'? 'auto': (reaction.action === 'set'? 'plus': 'minus')\n\t\t\t},\n\t\t\tfalse,\n\t\t\t1000\n\t\t], 'background');\n\n\t\tif (reaction.action === 'set')\n\t\t{\n\t\t\tsetTimeout(() => app.exec(\"callVibration\"), 200);\n\t\t}\n\t}\n\n\topenMessageReactionList(id, reactions)\n\t{\n\t\tif (!Utils.dialog.isChatId(this.controller.application.getDialogId()))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet users = [];\n\t\tfor (let reaction in reactions)\n\t\t{\n\t\t\tif (!reactions.hasOwnProperty(reaction))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tusers = users.concat(reactions[reaction]);\n\t\t}\n\n\t\tthis.openUserList({\n\t\t\tusers: users,\n\t\t\ttitle: this.getLocalize('MOBILE_MESSAGE_LIST_LIKE')\n\t\t});\n\t}\n\n\tquoteMessageClear()\n\t{\n\t\tthis.setText('');\n\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: 0,\n\t\t\t\teditId: 0\n\t\t\t}\n\t\t});\n\t}\n\n\teditMessage(id)\n\t{\n\t\tlet message = this.controller.getStore().getters['messages/getMessage'](this.controller.application.getChatId(), id);\n\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: id,\n\t\t\t\teditId: id\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tsetTimeout(() => this.controller.application.emit(EventType.dialog.scrollToBottom, {duration: 300, cancelIfScrollChange: false, force: true}), 300);\n\t\t\tthis.setTextFocus();\n\t\t});\n\n\t\tthis.setText(message.text);\n\t}\n\n\tupdateMessage(id, text)\n\t{\n\t\tthis.quoteMessageClear();\n\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\teditId: 0\n\t\t\t}\n\t\t});\n\n\t\tthis.editMessageSend(id, text);\n\t}\n\n\teditMessageSend(id, text)\n\t{\n\t\tthis.controller.restClient.callMethod(RestMethod.imMessageUpdate, {\n\t\t\t'MESSAGE_ID': id,\n\t\t\t'MESSAGE': text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: RestMethod.imMessageUpdate,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.controller.application.getDialogData()\n\t\t}));\n\t}\n\n\tdeleteMessage(id)\n\t{\n\t\tlet message = this.controller.getStore().getters['messages/getMessage'](this.controller.application.getChatId(), id);\n\t\tlet files = this.controller.getStore().getters['files/getList'](this.controller.application.getChatId());\n\n\t\tlet messageText = Utils.text.purify(message.text, message.params, files, this.getLocalize());\n\t\tmessageText = messageText.length > 50? messageText.substr(0, 47) + '...': messageText;\n\n\t\tapp.confirm({\n\t\t\ttitle: this.getLocalize('MOBILE_MESSAGE_MENU_DELETE_CONFIRM'),\n\t\t\ttext: messageText? '\"' + messageText + '\"': '',\n\t\t\tbuttons: [\n\t\t\t\tthis.getLocalize('MOBILE_MESSAGE_MENU_DELETE_YES'),\n\t\t\t\tthis.getLocalize('MOBILE_MESSAGE_MENU_DELETE_NO')\n\t\t\t],\n\t\t\tcallback: (button) =>\n\t\t\t{\n\t\t\t\tif (button === 1)\n\t\t\t\t{\n\t\t\t\t\tthis.quoteMessageClear();\n\t\t\t\t\tthis.deleteMessageSend(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tdeleteMessageSend(id)\n\t{\n\t\tthis.controller.restClient.callMethod(RestMethod.imMessageDelete, {\n\t\t\t'MESSAGE_ID': id\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: RestMethod.imMessageDelete,\n\t\t\tdata: {},\n\t\t\tdialog: this.controller.application.getDialogData(this.controller.application.getDialogId())\n\t\t}));\n\t}\n\n\tinsertText(params)\n\t{\n\t\tBXMobileApp.UI.Page.TextPanel.getText((text) => {\n\t\t\ttext = text.toString().trim();\n\n\t\t\ttext = text? text+' '+params.text: params.text;\n\n\t\t\tthis.setText(text);\n\t\t\tthis.setTextFocus();\n\t\t});\n\t}\n\n\tsetText(text = '')\n\t{\n\t\ttext = text.toString();\n\n\t\tif (text)\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TextPanel.setText(text);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TextPanel.clear();\n\t\t}\n\n\t\tthis.setTextareaMessage({message: text});\n\n\t\tconsole.log('Set new text in textarea', text? text: '-- empty --');\n\t}\n\n\tclearText()\n\t{\n\t\tthis.setText();\n\t}\n\n\tsetTextFocus()\n\t{\n\t\tif (!this.controller.getStore().state.application.mobile.keyboardShow)\n\t\t{\n\t\t\tBXMobileApp.UI.Page.TextPanel.focus();\n\t\t}\n\t}\n\n\tisBackground()\n\t{\n\t\tif (typeof BXMobileAppContext !== \"object\")\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof BXMobileAppContext.isAppActive === \"function\"\n\t\t\t&& !BXMobileAppContext.isAppActive()\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (typeof BXMobileAppContext.isBackground === \"function\")\n\t\t{\n\t\t\treturn BXMobileAppContext.isBackground();\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thideSmiles()\n\t{\n\t\t// this.controller.hideSmiles();\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 05. Interaction and utils */\n\n\texecuteBackgroundTaskSuccess(action, data)\n\t{\n\t\tlet successObject =\n\t\t{\n\t\t\terror: () => false,\n\t\t\tdata: () => data.result,\n\t\t};\n\n\t\tconsole.log('Dialog.executeBackgroundTaskSuccess', action, data);\n\n\t\tif (action === 'sendMessage')\n\t\t{\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imMessageAdd, successObject, data.extra);\n\t\t}\n\t\telse if (action === 'readMessage')\n\t\t{\n\t\t\tthis.processMarkReadMessages();\n\t\t}\n\t}\n\n\texecuteBackgroundTaskFailure(action, data)\n\t{\n\t\tlet errorObject =\n\t\t{\n\t\t\terror: () => {\n\t\t\t\treturn {\n\t\t\t\t\terror: data.code,\n\t\t\t\t\terror_description: data.text,\n\t\t\t\t\tex: {\n\t\t\t\t\t\tstatus: data.status,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdata: () => false,\n\t\t};\n\n\t\tconsole.log('Dialog.executeBackgroundTaskFailure', action, data);\n\n\t\tif (action === 'sendMessage')\n\t\t{\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imMessageAdd, errorObject, data.extra);\n\t\t}\n\t}\n\n/* endregion 05. Interaction and utils */\n\n/* region 06. Interaction and utils */\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`MobileChat.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.controller.addLocalize(phrases);\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\treturn this.controller.getLocalize(name);\n\t}\n\n/* endregion 06. Interaction and utils */\n}\n"],"names":["MobileImCommandHandler","params","controller","store","dialog","extra","command","invited","setTimeout","redrawHeader","currentHeaderName","BXMobileApp","UI","Page","TopBar","title","text","senderId","message","users","name","MobileRestAnswerHandler","context","data","commit","chatId","id","dialogId","dialog_id","diskFolderId","disk_folder_id","restrictions","dispatch","fields","error","ex","app","closeController","disk","enabled","maxFileSize","phpUploadMaxFilesize","addLocalize","BX","LocalStorage","set","getSiteId","application","emit","EventType","sendReadMessages","messageId","messagesQueue","filter","el","result","BaseRestHandler","Vue","component","dialogState","computed","localize","Object","assign","getFilteredPhrases","$root","$bitrixMessages","widgetClassName","state","className","showMessageDialog","push","join","quotePanelData","description","color","quoteId","$store","getters","user","authorId","files","editId","MOBILE_CHAT_EDIT_TITLE","NAME","Utils","purify","isDialog","isChatId","isGestureQuoteSupported","type","managerList","includes","common","userId","ChatPerformance","isDarkBackground","options","darkBackground","messageCollection","length","timeout","getDialogShowTimeout","clearTimeout","dialogStateTimeout","init","Vuex","mapState","dialogues","collection","messages","methods","logEvent","Logger","info","onDialogRequestHistory","event","$bitrixApplication","getDialogHistory","lastId","onDialogRequestUnread","getDialogUnread","onDialogMessageClickByUserName","replyToUser","onDialogMessageClickByUploadCancel","cancelUploadFile","file","onDialogMessageClickByCommand","insertText","value","addMessage","warn","onDialogMessageClickByMention","openProfile","openDialog","openPhoneMenu","onDialogMessageMenuClick","openMessageMenu","onDialogMessageRetryClick","retrySendMessage","onDialogReadMessage","readMessage","onDialogReadedListClick","openReadedList","list","onDialogQuoteMessage","quoteMessage","onDialogMessageReactionSet","reactMessage","reaction","onDialogMessageReactionListOpen","openMessageReactionList","values","onDialogMessageClickByKeyboardButton","action","botId","$bitrixController","scrollToBottom","duration","cancelIfScrollChange","exec","NotificationBar","textColor","groupId","maxLines","align","isGlobal","useCloseButton","autoHideTimeout","hideOnTap","show","restClient","callMethod","RestMethod","imMessageCommand","onDialogMessageClickByChatTeaser","execMessageOpenChatTeaser","onDialogClick","onQuotePanelClose","quoteMessageClear","onSmilesSelectSmile","console","onSmilesSelectSet","setTextFocus","onHideSmiles","template","freeze","MOBILE_CHAT_ERROR_TITLE","MOBILE_CHAT_ERROR_DESC","MOBILE_CHAT_LOADING","MOBILE_CHAT_EMPTY","MobileDialogApplication","inited","initPromise","Promise","rootNode","node","document","createElement","eventBus","VueVendorV2","timer","Timer","windowFocused","initCore","then","initComponentParams","initMobileSettings","initComponent","initEnvironment","initMobileEnvironment","initPullClient","initComplete","resolve","reject","Core","ready","componentParameters","log","serverVariables","get","storedEvents","STORED_EVENTS","ApplicationStorage","getObject","quoteEnable","quoteFromRight","autoplayVideo","isAutoPlayVideoSupported","backgroundType","getStore","DIALOG_ID","ChatDialogBackground","dark","subscribe","mutation","eventStoreInteraction","setPrepareFilesBeforeSaveFunction","prepareFileData","bind","addRestAnswerHandler","create","getDialogId","createVue","vue","setTextareaMessage","debounce","Scroll","setEnabled","captureKeyboardEvents","addCustomEvent","mobile","keyboardShow","clearInterval","keyboardOpeningInterval","checkWindowFocused","isVisible","callback","status","$emit","processSendMessages","catch","taskId","toString","split","executeBackgroundTaskSuccess","executeBackgroundTaskFailure","Pull","PullClient","SubscriptionType","Server","moduleId","pullMobileHandler","getModuleId","optionImportant","TextPanel","setParams","getKeyboardParams","changeChatKeyboardStatus","MobileUploadProvider","setListener","executeUploaderEvent","fileUpdateProgress","throttle","fileId","progress","size","dialogData","getDialogData","DialogType","call","extend","items","fabric","Answers","sendCustomEvent","openAddUserDialog","userShowWorkPosition","setInterval","widgetCache","ChatWidgetCache","getUserId","getLanguageId","onCustomEvent","Status","eventStatusInteraction","Online","eventOnlineInteraction","Events","postToComponent","requestData","promise","requestDataSend","start","titleAction","useProgress","useLetterImage","query","RestMethodHandler","mobileBrowserConstGet","imChatGet","imDialogMessagesGetInit","imDialogMessagesGet","limit","getRequestMessageLimit","convert_text","imRecentUnread","imUserGet","imUserListGet","callBatch","response","setError","constGet","executeRestAnswer","userGet","userListGet","chatGetResult","dialogMessagesGetResult","stop","getChatId","pullBaseHandler","option","skip","enableReadMessages","getLogTrackingParams","eventName","eventData","MobileUploaderConst","FILE_UPLOAD_PROGRESS","percent","byteTotal","FILE_CREATED","fileError","errors","FileStatus","wait","FILES","DISK_ID","upload","urlDownload","urlPreview","urlShow","TASK_CANCELLED","TASK_NOT_FOUND","FILE_CREATED_FAILED","FILE_UPLOAD_FAILED","FILE_READ_ERROR","TASK_STARTED_FAILED","prepareFunction","startsWith","FileType","image","currentDomain","replace","Array","map","headerProperties","getChatHeaderParams","getUserHeaderParams","setCallMenu","headerMenuInited","setCallback","openHeaderMenu","setText","desc","setDetailText","avatar","setImage","imageColor","showLastDate","lastActivityDate","getLastDateText","getLocalize","workPosition","entityType","encodeURI","getHost","chatTypeTitle","toUpperCase","keyboardShowFlag","hide","callMenuSetted","userData","parseInt","bot","network","openCallMenu","badgeCode","video","listType","backdrop","settings","objectName","componentCode","scriptPath","ownerId","rootWidget","phones","personalMobile","workPhone","personalPhone","innerPhone","BackdropMenu","setItems","BackdropMenuItem","setTitle","setSubTitle","setVersion","setEventListener","MobileTools","phoneTo","setCustomParams","confirm","buttons","button","leaveChat","imChatLeave","listUsers","getItemsForAddUserDialog","element","ChatDataConverter","getListElementByUser","scopes","showOnTop","itemsIndex","recentList","colleaguesList","lastSearchList","payload","counter","forEach","PullStatus","pullRequestMessage","Offline","hasOwnProperty","siteDir","textareaMessage","placeholder","smileButton","useImageButton","useAudioMessages","mentionDataSource","outsection","url","attachFileSettings","previewMaxWidth","previewMaxHeight","resize","targetWidth","targetHeight","sourceType","encodingType","mediaType","allowsEdit","saveToPhotoAlbum","popoverOptions","cameraDirection","sendFileSeparately","showAttachedFiles","editingMediaFiles","maxAttachedFilesCount","attachButton","dataSource","multiple","TABLE_SETTINGS","searchField","showtitle","modal","attachedFiles","trim","clearText","hideSmiles","updateMessage","dataAttributes","uploadFile","source","toLowerCase","preview","URL","PREVIEW","width","match","height","uploadLink","ID","Date","toJSON","slice","filename","fileType","FilesModel","getType","extension","previewUrl","previewWidth","previewHeight","startWriting","stopWriting","showSmiles","Application","getPlatform","platform","isIos","getIosVersion","quiteId","repeat","date","format","quote","isUnreadMessagesLoaded","sendMessage","FILE_ID","sending","prepareFilesBeforeSave","splice","authorName","getCurrentUser","find","cancelTasks","fileCommit","diskId","messageText","getDiskFolderId","sendMessageWithFile","requestDiskFolderId","readMessageExecute","imMessageAdd","fileExtension","attachPreviewFile","needConvert","addTasks","mimeType","audio","folderId","onDestroyEventName","retry","queryParams","chat_id","template_id","file_template_id","uploadId","upload_id","disk_id","imDiskFileCommit","timMessageType","flagRequestDiskFolderIdSended","imDiskFolderGet","requestHistoryResult","count","promiseGetDialogUnreadWait","promiseGetDialogUnread","requestUnreadResult","error_description","imDialogRead","message_id","imDialogMessagesGetUnread","first_id","dialogMessageUnread","firstMessageId","fulfill","retryUploadFile","setSendingMessageFlag","number","blink","currentUser","messageUser","messageMenuInstance","setIcon","BackdropMenuIcon","reply","copy","IS_DELETED","unread","checked","edit","setType","BackdropMenuItemType","menu","circle_plus","disableClose","extranet","externalAuthId","setStyles","BackdropMenuStyle","setFont","WidgetListItemFont","setColor","trash","copyMessage","editMessage","deleteMessage","unreadMessage","subMenu","task","lifefeed","chat","shareMessage","showSubMenu","headerMenu","HeaderMenu","setUseNavigationBarColor","customParams","openUserList","muteDialog","entityId","crmData","getDialogCrmData","openWidget","resolveOpenFunction","useLoader","getStoreBuilder","clearDatabase","reload","notifyToggleText","isDialogMuted","notifyToggleIcon","HeaderMenuIcon","notify","notify_off","gotoCrmLocalize","crm","DialogCrmType","lead","company","contact","deal","HeaderMenuItem","phone","user_plus","cross","leave","unshift","isOnline","firstName","force","reactions","concat","editMessageSend","imMessageUpdate","substr","deleteMessageSend","imMessageDelete","getText","clear","focus","BXMobileAppContext","isAppActive","isBackground","successObject","processMarkReadMessages","errorObject","code","localizeDescription","endsWith","active","phrases"],"mappings":";;;;;CAAA;;;;;;;;AASA,KAAaA,sBAAb;CAAA;CAAA;CAAA,6BAGC;CAAA,UADcC,MACd,uEADuB,EACvB;CACC,aAAO,IAAI,IAAJ,CAASA,MAAT,CAAP;CACA;CALF;;CAOC,oCACA;CAAA,QADYA,MACZ,uEADqB,EACrB;CAAA;CACC,SAAKC,UAAL,GAAkBD,MAAM,CAACC,UAAzB;CACA,SAAKC,KAAL,GAAaF,MAAM,CAACE,KAApB;CACA,SAAKC,MAAL,GAAcH,MAAM,CAACG,MAArB;CACA;;CAZF;CAAA;CAAA,kCAeC;CACC,aAAO,IAAP;CACA;CAjBF;CAAA;CAAA,qCAmBkBH,MAnBlB,EAmB0BI,KAnB1B,EAmBiCC,OAnBjC,EAoBC;CAAA;;CACC,UAAI,CAACL,MAAM,CAACM,OAAZ,EACA;CACCC,QAAAA,UAAU,CAAC,YAAM;CAChB,UAAA,KAAI,CAACJ,MAAL,CAAYK,YAAZ;CACA,SAFS,EAEP,GAFO,CAAV;CAGA;CACD;CA3BF;CAAA;CAAA,kCA6BeR,MA7Bf,EA6BuBI,KA7BvB,EA6B8BC,OA7B9B,EA8BC;CACC,UAAII,iBAAiB,GAAGC,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiCd,MAAjC,CAAwCe,IAAhE;CACA,UAAIC,QAAQ,GAAGhB,MAAM,CAACiB,OAAP,CAAeD,QAA9B;;CACA,UAAIhB,MAAM,CAACkB,KAAP,CAAaF,QAAb,EAAuBG,IAAvB,KAAgCV,iBAApC,EACA;CACC,aAAKN,MAAL,CAAYK,YAAZ;CACA;CACD;CArCF;CAAA;CAAA;;CCTA;;;;;;;;AASA,KAIaY,uBAAb;CAAA;;CAEC,mCAAYpB,MAAZ,EACA;CAAA;;CAAA;CACC,yHAAMA,MAAN;;CAEA,QAAI,oBAAOA,MAAM,CAACqB,OAAd,MAA0B,QAA1B,IAAsCrB,MAAM,CAACqB,OAAjD,EACA;CACC,YAAKA,OAAL,GAAerB,MAAM,CAACqB,OAAtB;CACA;;CANF;CAOC;;CAVF;CAAA;CAAA,2CAYwBC,IAZxB,EAaC;CACC,WAAKpB,KAAL,CAAWqB,MAAX,CAAkB,iBAAlB,EAAqC;CAACpB,QAAAA,MAAM,EAAE;CAC7CqB,UAAAA,MAAM,EAAEF,IAAI,CAACG,EADgC;CAE7CC,UAAAA,QAAQ,EAAEJ,IAAI,CAACK,SAF8B;CAG7CC,UAAAA,YAAY,EAAEN,IAAI,CAACO;CAH0B;CAAT,OAArC;;CAMA,UAAIP,IAAI,CAACQ,YAAT,EACA;CACC,aAAK5B,KAAL,CAAW6B,QAAX,CAAoB,kBAApB,EAAwC;CACvCL,UAAAA,QAAQ,EAAEJ,IAAI,CAACK,SADwB;CAEvCK,UAAAA,MAAM,EAAEV,IAAI,CAACQ;CAF0B,SAAxC;CAIA;;CAED,WAAKT,OAAL,CAAab,YAAb;CACA;CA7BF;CAAA;CAAA,yCA8BsByB,KA9BtB,EA+BC;CACC,UAAIA,KAAK,CAACC,EAAN,CAASD,KAAT,KAAmB,cAAvB,EACA;CACCE,QAAAA,GAAG,CAACC,eAAJ;CACA;CACD;CApCF;CAAA;CAAA,uDAsCoCd,IAtCpC,EAuCC;CACC,WAAKpB,KAAL,CAAWqB,MAAX,CAAkB,iBAAlB,EAAqC;CAACc,QAAAA,IAAI,EAAE;CAC3CC,UAAAA,OAAO,EAAE,IADkC;CAE3CC,UAAAA,WAAW,EAAEjB,IAAI,CAACkB;CAFyB;CAAP,OAArC;CAKA,WAAKnB,OAAL,CAAaoB,WAAb,CAAyBnB,IAAzB;CACAoB,MAAAA,EAAE,CAACzB,OAAH,CAAWK,IAAX;CAEAqB,MAAAA,gCAAY,CAACC,GAAb,CAAiB,KAAK3C,UAAL,CAAgB4C,SAAhB,EAAjB,EAA8C,CAA9C,EAAiD,iBAAjD,EAAoEvB,IAAI,IAAI,EAA5E;CACA;CAjDF;CAAA;CAAA,2DAoDC;CACC,WAAKrB,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiB8C,gBAAlD;CACA;CAtDF;CAAA;CAAA,8CAwD2BC,SAxD3B,EAwDsCjC,OAxDtC,EAyDC;CACC,WAAKI,OAAL,CAAa8B,aAAb,GAA6B,KAAK9B,OAAL,CAAa8B,aAAb,CAA2BC,MAA3B,CAAkC,UAAAC,EAAE;CAAA,eAAIA,EAAE,CAAC5B,EAAH,KAAUR,OAAO,CAACQ,EAAtB;CAAA,OAApC,CAA7B;CACA;CA3DF;CAAA;CAAA,4CA6DyBQ,KA7DzB,EA6DgChB,OA7DhC,EA8DC;CACC,WAAKI,OAAL,CAAa8B,aAAb,GAA6B,KAAK9B,OAAL,CAAa8B,aAAb,CAA2BC,MAA3B,CAAkC,UAAAC,EAAE;CAAA,eAAIA,EAAE,CAAC5B,EAAH,KAAUR,OAAO,CAACQ,EAAtB;CAAA,OAApC,CAA7B;CACA;CAhEF;CAAA;CAAA,kDAkE+B6B,MAlE/B,EAkEuCrC,OAlEvC,EAmEC;CACC,WAAKI,OAAL,CAAa8B,aAAb,GAA6B,KAAK9B,OAAL,CAAa8B,aAAb,CAA2BC,MAA3B,CAAkC,UAAAC,EAAE;CAAA,eAAIA,EAAE,CAAC5B,EAAH,KAAUR,OAAO,CAACQ,EAAtB;CAAA,OAApC,CAA7B;CACA;CArEF;CAAA;CAAA,EAA6C8B,gCAA7C;;CCbA;;;;;;;;AASA,CAQA;;;;AAGAC,WAAG,CAACC,SAAJ,CAAc,+BAAd,EACA;CACCnC,EAAAA,IAAI,EAAE,gBACN;CACC,WAAO;CACNoC,MAAAA,WAAW,EAAE;CADP,KAAP;CAGA,GANF;CAOCC,EAAAA,QAAQ;CAEPX,IAAAA,SAAS,EAAE;CAAA,aAAMA,kBAAN;CAAA,KAFJ;CAGPY,IAAAA,QAHO,sBAIP;CACC,aAAOC,MAAM,CAACC,MAAP,CAAc,EAAd,EACNN,UAAG,CAACO,kBAAJ,CAAuB,cAAvB,EAAuC,KAAKC,KAAL,CAAWC,eAAlD,CADM,EAENT,UAAG,CAACO,kBAAJ,CAAuB,WAAvB,EAAoC,KAAKC,KAAL,CAAWC,eAA/C,CAFM,CAAP;CAIA,KATM;CAUPC,IAAAA,eAVO,2BAUSC,KAVT,EAWP;CACC,UAAIC,SAAS,GAAG,CAAC,uBAAD,CAAhB;;CAEA,UAAI,KAAKC,iBAAT,EACA;CACCD,QAAAA,SAAS,CAACE,IAAV,CAAe,0BAAf;CACA;;CAED,aAAOF,SAAS,CAACG,IAAV,CAAe,GAAf,CAAP;CACA,KApBM;CAqBPC,IAAAA,cArBO,4BAsBP;CACC,UAAIlB,MAAM,GAAG;CACZ7B,QAAAA,EAAE,EAAE,CADQ;CAEZX,QAAAA,KAAK,EAAE,EAFK;CAGZ2D,QAAAA,WAAW,EAAE,EAHD;CAIZC,QAAAA,KAAK,EAAE;CAJK,OAAb;;CAOA,UAAI,CAAC,KAAKL,iBAAN,IAA2B,CAAC,KAAKlE,MAAL,CAAYwE,OAA5C,EACA;CACC,eAAOrB,MAAP;CACA;;CAED,UAAIrC,OAAO,GAAG,KAAK2D,MAAL,CAAYC,OAAZ,CAAoB,qBAApB,EAA2C,KAAK1E,MAAL,CAAYqB,MAAvD,EAA+D,KAAKrB,MAAL,CAAYwE,OAA3E,CAAd;;CACA,UAAI,CAAC1D,OAAL,EACA;CACC,eAAOqC,MAAP;CACA;;CAED,UAAIwB,IAAI,GAAG,KAAKF,MAAL,CAAYC,OAAZ,CAAoB,WAApB,EAAiC5D,OAAO,CAAC8D,QAAzC,CAAX;CACA,UAAIC,KAAK,GAAG,KAAKJ,MAAL,CAAYC,OAAZ,CAAoB,eAApB,EAAqC,KAAK1E,MAAL,CAAYqB,MAAjD,CAAZ;CACA,UAAIyD,MAAM,GAAG,KAAKL,MAAL,CAAYC,OAAZ,CAAoB,qBAApB,EAA2C,KAAK1E,MAAL,CAAYuB,QAAvD,CAAb;CAEA,aAAO;CACND,QAAAA,EAAE,EAAE,KAAKtB,MAAL,CAAYwE,OADV;CAEN7D,QAAAA,KAAK,EAAEmE,MAAM,GAAE,KAAKrB,QAAL,CAAcsB,sBAAhB,GAA0CjE,OAAO,CAACjB,MAAR,CAAemF,IAAf,GAAsBlE,OAAO,CAACjB,MAAR,CAAemF,IAArC,GAA6CL,IAAI,GAAGA,IAAI,CAAC3D,IAAR,GAAc,EAFhH;CAGNuD,QAAAA,KAAK,EAAEI,IAAI,GAAEA,IAAI,CAACJ,KAAP,GAAc,EAHnB;CAIND,QAAAA,WAAW,EAAEW,kBAAK,CAACrE,IAAN,CAAWsE,MAAX,CAAkBpE,OAAO,CAACF,IAA1B,EAAgCE,OAAO,CAACjB,MAAxC,EAAgDgF,KAAhD,EAAuD,KAAKpB,QAA5D;CAJP,OAAP;CAMA,KAnDM;CAqDP0B,IAAAA,QArDO,sBAsDP;CACC,aAAOF,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKpF,MAAL,CAAYuB,QAAlC,CAAP;CACA,KAxDM;CA0DP8D,IAAAA,uBA1DO,qCA2DP;CACC,UAAI,KAAKrF,MAAL,IAAe,KAAKA,MAAL,CAAYsF,IAAZ,KAAqB,cAApC,IAAsD,CAAC,KAAKtF,MAAL,CAAYuF,WAAZ,CAAwBC,QAAxB,CAAiC,KAAK7C,WAAL,CAAiB8C,MAAjB,CAAwBC,MAAzD,CAA3D,EACA;CACC,eAAO,KAAP;CACA;;CAED,aAAOC,eAAe,CAACN,uBAAhB,EAAP;CACA,KAlEM;CAmEPO,IAAAA,gBAnEO,8BAoEP;CACC,aAAO,KAAKjD,WAAL,CAAiBkD,OAAjB,CAAyBC,cAAhC;CACA,KAtEM;CAuEP5B,IAAAA,iBAvEO,+BAwEP;CAAA;;CACC,UAAIf,MAAM,GAAG,KAAK4C,iBAAL,IAA0B,KAAKA,iBAAL,CAAuBC,MAAvB,GAAgC,CAAvE;CACA,UAAIC,OAAO,GAAGN,eAAe,CAACO,oBAAhB,EAAd;;CACA,UAAI/C,MAAJ,EACA;CACC,YAAI8C,OAAO,GAAG,CAAd,EACA;CACCE,UAAAA,YAAY,CAAC,KAAKC,kBAAN,CAAZ;CACA,eAAKA,kBAAL,GAA0BhG,UAAU,CAAC,YAAM;CAC1C,YAAA,KAAI,CAACmD,WAAL,GAAmB,MAAnB;CACA,WAFmC,EAEjC0C,OAFiC,CAApC;CAGA,SAND,MAQA;CACC,eAAK1C,WAAL,GAAmB,MAAnB;CACA;CACD,OAbD,MAcK,IAAI,KAAKvD,MAAL,IAAe,KAAKA,MAAL,CAAYqG,IAA/B,EACL;CACC,YAAIJ,OAAO,GAAG,CAAd,EACA;CACCE,UAAAA,YAAY,CAAC,KAAKC,kBAAN,CAAZ;CACA,eAAKA,kBAAL,GAA0BhG,UAAU,CAAC,YAAM;CAC1C,YAAA,KAAI,CAACmD,WAAL,GAAmB,OAAnB;CACA,WAFmC,EAEjC0C,OAFiC,CAApC;CAGA,SAND,MAQA;CACC,eAAK1C,WAAL,GAAmB,OAAnB;CACA;CACD,OAbI,MAeL;CACC,aAAKA,WAAL,GAAmB,SAAnB;CACA;;CAED,aAAOJ,MAAP;CACA;CA7GM,KA8GJmD,gBAAI,CAACC,QAAL,CAAc;CAChB5D,IAAAA,WAAW,EAAE,qBAAAqB,KAAK;CAAA,aAAIA,KAAK,CAACrB,WAAV;CAAA,KADF;CAEhB3C,IAAAA,MAAM,EAAE,gBAAAgE,KAAK;CAAA,aAAIA,KAAK,CAACwC,SAAN,CAAgBC,UAAhB,CAA2BzC,KAAK,CAACrB,WAAN,CAAkB3C,MAAlB,CAAyBuB,QAApD,CAAJ;CAAA,KAFG;CAGhBwE,IAAAA,iBAAiB,EAAE,2BAAA/B,KAAK;CAAA,aAAIA,KAAK,CAAC0C,QAAN,CAAeD,UAAf,CAA0BzC,KAAK,CAACrB,WAAN,CAAkB3C,MAAlB,CAAyBqB,MAAnD,CAAJ;CAAA;CAHR,GAAd,CA9GI,CAPT;CA2HCsF,EAAAA,OAAO,EACP;CACCC,IAAAA,QADD,oBACU5F,IADV,EAEC;CAAA,wCADkBnB,MAClB;CADkBA,QAAAA,MAClB;CAAA;;CACCgH,MAAAA,oBAAM,CAACC,IAAP,OAAAD,oBAAM,GAAM7F,IAAN,SAAenB,MAAf,EAAN;CACA,KAJF;CAKCkH,IAAAA,sBALD,kCAKwBC,KALxB,EAMC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BC,gBAA9B,CAA+CF,KAAK,CAACG,MAArD;CACA,KARF;CASCC,IAAAA,qBATD,iCASuBJ,KATvB,EAUC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BI,eAA9B,CAA8CL,KAAK,CAACG,MAApD;CACA,KAZF;CAaCG,IAAAA,8BAbD,0CAagCN,KAbhC,EAcC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BM,WAA9B,CAA0CP,KAAK,CAACrC,IAAN,CAAWrD,EAArD,EAAyD0F,KAAK,CAACrC,IAA/D;CACA,KAhBF;CAiBC6C,IAAAA,kCAjBD,8CAiBoCR,KAjBpC,EAkBC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BQ,gBAA9B,CAA+CT,KAAK,CAACU,IAAN,CAAWpG,EAA1D;CACA,KApBF;CAqBCqG,IAAAA,6BArBD,yCAqB+BX,KArB/B,EAsBC;CACC,UAAIA,KAAK,CAAC1B,IAAN,KAAe,KAAnB,EACA;CACC,aAAKzB,KAAL,CAAWoD,kBAAX,CAA8BW,UAA9B,CAAyC;CAAChH,UAAAA,IAAI,EAAEoG,KAAK,CAACa,KAAN,GAAY;CAAnB,SAAzC;CACA,OAHD,MAIK,IAAIb,KAAK,CAAC1B,IAAN,KAAe,MAAnB,EACL;CACC,aAAKzB,KAAL,CAAWoD,kBAAX,CAA8Ba,UAA9B,CAAyCd,KAAK,CAACa,KAA/C;CACA,OAHI,MAKL;CACChB,QAAAA,oBAAM,CAACkB,IAAP,CAAY,qBAAZ,EAAmCf,KAAnC;CACA;CACD,KAnCF;CAoCCgB,IAAAA,6BApCD,yCAoC+BhB,KApC/B,EAqCC;CACC,UAAIA,KAAK,CAAC1B,IAAN,KAAe,MAAnB,EACA;CACC,aAAKzB,KAAL,CAAWoD,kBAAX,CAA8BgB,WAA9B,CAA0CjB,KAAK,CAACa,KAAhD;CACA,OAHD,MAIK,IAAIb,KAAK,CAAC1B,IAAN,KAAe,MAAnB,EACL;CACC,aAAKzB,KAAL,CAAWoD,kBAAX,CAA8BiB,UAA9B,CAAyClB,KAAK,CAACa,KAA/C;CACA,OAHI,MAIA,IAAIb,KAAK,CAAC1B,IAAN,KAAe,MAAnB,EACL;CACC,aAAKzB,KAAL,CAAWoD,kBAAX,CAA8BkB,aAA9B,CAA4CnB,KAAK,CAACa,KAAlD;CACA;CACD,KAlDF;CAmDCO,IAAAA,wBAnDD,oCAmD0BpB,KAnD1B,EAoDC;CACCH,MAAAA,oBAAM,CAACkB,IAAP,CAAY,eAAZ,EAA6Bf,KAA7B;CACA,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BoB,eAA9B,CAA8CrB,KAAK,CAAClG,OAApD;CACA,KAvDF;CAwDCwH,IAAAA,yBAxDD,qCAwD2BtB,KAxD3B,EAyDC;CACCH,MAAAA,oBAAM,CAACkB,IAAP,CAAY,gBAAZ,EAA8Bf,KAA9B;CACA,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BsB,gBAA9B,CAA+CvB,KAAK,CAAClG,OAArD;CACA,KA5DF;CA6DC0H,IAAAA,mBA7DD,+BA6DqBxB,KA7DrB,EA8DC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BwB,WAA9B,CAA0CzB,KAAK,CAAC1F,EAAhD;CACA,KAhEF;CAiECoH,IAAAA,uBAjED,mCAiEyB1B,KAjEzB,EAkEC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8B0B,cAA9B,CAA6C3B,KAAK,CAAC4B,IAAnD;CACA,KApEF;CAqECC,IAAAA,oBArED,gCAqEsB7B,KArEtB,EAsEC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8B6B,YAA9B,CAA2C9B,KAAK,CAAClG,OAAN,CAAcQ,EAAzD;CACA,KAxEF;CAyECyH,IAAAA,0BAzED,sCAyE4B/B,KAzE5B,EA0EC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8B+B,YAA9B,CAA2ChC,KAAK,CAAClG,OAAN,CAAcQ,EAAzD,EAA6D0F,KAAK,CAACiC,QAAnE;CACA,KA5EF;CA6ECC,IAAAA,+BA7ED,2CA6EiClC,KA7EjC,EA8EC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BkC,uBAA9B,CAAsDnC,KAAK,CAAClG,OAAN,CAAcQ,EAApE,EAAwE0F,KAAK,CAACoC,MAA9E;CACA,KAhFF;CAiFCC,IAAAA,oCAjFD,gDAiFsClI,IAjFtC,EAkFC;CAAA;;CACC,UAAIA,IAAI,CAACmI,MAAL,KAAgB,QAApB,EACA;CAAA,2BACmDnI,IAAI,CAACtB,MADxD;CAAA,YACM0B,QADN,gBACMA,QADN;CAAA,YACgBwB,SADhB,gBACgBA,SADhB;CAAA,YAC2BwG,KAD3B,gBAC2BA,KAD3B;CAAA,YACkCD,MADlC,gBACkCA,MADlC;CAAA,YAC0CzB,KAD1C,gBAC0CA,KAD1C;;CAGC,YAAIyB,MAAM,KAAK,MAAf,EACA;CACC,eAAKzF,KAAL,CAAWoD,kBAAX,CAA8Ba,UAA9B,CAAyCD,KAAzC;CACAzH,UAAAA,UAAU,CAAC;CAAA,mBAAM,MAAI,CAACyD,KAAL,CAAW2F,iBAAX,CAA6B7G,WAA7B,CAAyCC,IAAzC,CAA8CC,kBAAS,CAAC7C,MAAV,CAAiByJ,cAA/D,EAA+E;CAACC,cAAAA,QAAQ,EAAE,GAAX;CAAgBC,cAAAA,oBAAoB,EAAE;CAAtC,aAA/E,CAAN;CAAA,WAAD,EAAqI,GAArI,CAAV;CACA,SAJD,MAKK,IAAIL,MAAM,KAAK,KAAf,EACL;CACC,eAAKzF,KAAL,CAAWoD,kBAAX,CAA8BW,UAA9B,CAAyC;CAAChH,YAAAA,IAAI,EAAEiH,KAAK,GAAC;CAAb,WAAzC;CACA,SAHI,MAIA,IAAIyB,MAAM,KAAK,MAAf,EACL;CACC,eAAKzF,KAAL,CAAWoD,kBAAX,CAA8BkB,aAA9B,CAA4CN,KAA5C;CACA,SAHI,MAIA,IAAIyB,MAAM,KAAK,MAAf,EACL;CACCtH,UAAAA,GAAG,CAAC4H,IAAJ,CAAS,iBAAT,EAA4B;CAAChJ,YAAAA,IAAI,EAAEiH;CAAP,WAA5B;CAEC,cAAItH,WAAW,CAACC,EAAZ,CAAeqJ,eAAnB,CAAmC;CACnC/I,YAAAA,OAAO,EAAEyB,EAAE,CAACzB,OAAH,CAAW,kCAAX,CAD0B;CAEnCyD,YAAAA,KAAK,EAAE,WAF4B;CAGnCuF,YAAAA,SAAS,EAAE,SAHwB;CAInCC,YAAAA,OAAO,EAAE,WAJ0B;CAKnCC,YAAAA,QAAQ,EAAE,CALyB;CAMnCC,YAAAA,KAAK,EAAE,QAN4B;CAOnCC,YAAAA,QAAQ,EAAE,IAPyB;CAQnCC,YAAAA,cAAc,EAAE,IARmB;CASnCC,YAAAA,eAAe,EAAE,IATkB;CAUnCC,YAAAA,SAAS,EAAE;CAVwB,WAAnC,EAWE,MAXF,CAAD,CAWYC,IAXZ;CAaA,SAjBI,MAkBA,IAAIhB,MAAM,KAAK,QAAf,EACL;CACC,eAAKzF,KAAL,CAAWoD,kBAAX,CAA8BiB,UAA9B,CAAyCL,KAAzC;CACA;;CAED,eAAO,IAAP;CACA;;CAED,UAAI1G,IAAI,CAACmI,MAAL,KAAgB,SAApB,EACA;CAAA,4BACqDnI,IAAI,CAACtB,MAD1D;CAAA,YACM0B,SADN,iBACMA,QADN;CAAA,YACgBwB,UADhB,iBACgBA,SADhB;CAAA,YAC2BwG,MAD3B,iBAC2BA,KAD3B;CAAA,YACkCrJ,OADlC,iBACkCA,OADlC;CAAA,YAC2CL,MAD3C,iBAC2CA,MAD3C;CAGC,aAAKgE,KAAL,CAAW2F,iBAAX,CAA6Be,UAA7B,CAAwCC,UAAxC,CAAmDC,mBAAU,CAACC,gBAA9D,EAAgF;CAC/E,wBAAc3H,UADiE;CAE/E,uBAAaxB,SAFkE;CAG/E,oBAAUgI,MAHqE;CAI/E,qBAAWrJ,OAJoE;CAK/E,4BAAkBL;CAL6D,SAAhF;CAQA,eAAO,IAAP;CACA;;CAED,aAAO,KAAP;CACA,KA9IF;CA+IC8K,IAAAA,gCA/ID,4CA+IkC3D,KA/IlC,EAgJC;CACC,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8B2D,yBAA9B,CAAwD5D,KAAxD;CACA,KAlJF;CAmJC6D,IAAAA,aAnJD,yBAmJe7D,KAnJf,EAoJC;CAEC,KAtJF;CAuJC8D,IAAAA,iBAvJD,+BAwJC;CACC,WAAKjH,KAAL,CAAWoD,kBAAX,CAA8B8D,iBAA9B;CACA,KA1JF;CA2JCC,IAAAA,mBA3JD,+BA2JqBhE,KA3JrB,EA4JC;CACCiE,MAAAA,OAAO,CAAClD,IAAR,CAAa,iBAAb,EAAgCf,KAAhC;CACA,WAAKnD,KAAL,CAAWoD,kBAAX,CAA8BW,UAA9B,CAAyC;CAAChH,QAAAA,IAAI,EAAEoG,KAAK,CAACpG;CAAb,OAAzC;CACA,KA/JF;CAgKCsK,IAAAA,iBAhKD,+BAiKC;CACCD,MAAAA,OAAO,CAAClD,IAAR,CAAa,cAAb;CACA,WAAKlE,KAAL,CAAWoD,kBAAX,CAA8BkE,YAA9B;CACA,KApKF;CAqKCC,IAAAA,YArKD,0BAsKC;CACC;CACA,WAAKvH,KAAL,CAAWoD,kBAAX,CAA8BkE,YAA9B;CACA;CAzKF,GA5HD;CAwSCE,EAAAA,QAAQ;CAxST,CADA;;CCpBA;;;;;;;;AASA,AAGAhI,WAAG,CAACC,SAAJ,CAAc,uBAAd,EACA;CACCE,EAAAA,QAAQ;CAEPC,IAAAA,QAFO,sBAGP;CACC,aAAQC,MAAM,CAAC4H,MAAP,CAAc;CACrBC,QAAAA,uBAAuB,EAAE,KAAK1H,KAAL,CAAWC,eAAX,CAA2ByH,uBAD/B;CAErBC,QAAAA,sBAAsB,EAAE,KAAK3H,KAAL,CAAWC,eAAX,CAA2B0H;CAF9B,OAAd,CAAR;CAIA;CARM,KASJlF,gBAAI,CAACC,QAAL,CAAc;CAChB5D,IAAAA,WAAW,EAAE,qBAAAqB,KAAK;CAAA,aAAIA,KAAK,CAACrB,WAAV;CAAA;CADF,GAAd,CATI,CADT;CAcC0I,EAAAA,QAAQ;CAdT,CADA;;CCZA;;;;;;;;AASA,AAEAhI,WAAG,CAACC,SAAJ,CAAc,yBAAd,EACA;CACCE,EAAAA,QAAQ,EACR;CACCC,IAAAA,QADD,sBAEC;CACC,aAAQC,MAAM,CAAC4H,MAAP,CAAc;CACrBG,QAAAA,mBAAmB,EAAE,KAAK5H,KAAL,CAAWC,eAAX,CAA2B2H;CAD3B,OAAd,CAAR;CAGA;CANF,GAFD;CAUCJ,EAAAA,QAAQ;CAVT,CADA;;CCXA;;;;;;;;AASA,AAEAhI,WAAG,CAACC,SAAJ,CAAc,uBAAd,EACA;CACCE,EAAAA,QAAQ,EACR;CACCC,IAAAA,QADD,sBAEC;CACC,aAAQC,MAAM,CAAC4H,MAAP,CAAc;CACrBI,QAAAA,iBAAiB,EAAE,KAAK7H,KAAL,CAAWC,eAAX,CAA2B4H;CADzB,OAAd,CAAR;CAGA;CANF,GAFD;CAUCL,EAAAA,QAAQ;CAVT,CADA;;CCXA;;;;;;;;AASA,KA4CaM,uBAAb;CAEC;CAEA,qCACA;CAAA;;CAAA,QADY9L,MACZ,uEADqB,EACrB;CAAA;CACC,SAAK+L,MAAL,GAAc,KAAd;CACA,SAAKC,WAAL,GAAmB,IAAItJ,EAAE,CAACuJ,OAAP,EAAnB;CAEA,SAAKjM,MAAL,GAAcA,MAAd;CAEA,SAAKwL,QAAL,GAAgB,IAAhB;CACA,SAAKU,QAAL,GAAgB,KAAKlM,MAAL,CAAYmM,IAAZ,IAAoBC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAApC;CAEA,SAAKC,QAAL,GAAgB,IAAIC,kBAAJ,EAAhB;CACA,SAAKC,KAAL,GAAa,IAAIC,kBAAJ,EAAb;CAEA,SAAKtJ,aAAL,GAAqB,EAArB;CACA,SAAKuJ,aAAL,GAAqB,IAArB,CAbD;;CAiBC,SAAKC,QAAL,GACEC,IADF,CACO;CAAA,aAAM,KAAI,CAACC,mBAAL,EAAN;CAAA,KADP,EAEED,IAFF,CAEO,UAAAtJ,MAAM;CAAA,aAAI,KAAI,CAACwJ,kBAAL,CAAwBxJ,MAAxB,CAAJ;CAAA,KAFb,EAGEsJ,IAHF,CAGO;CAAA,aAAM,KAAI,CAACG,aAAL,EAAN;CAAA,KAHP,EAIEH,IAJF,CAIO;CAAA,aAAM,KAAI,CAACI,eAAL,EAAN;CAAA,KAJP,EAKEJ,IALF,CAKO;CAAA,aAAM,KAAI,CAACK,qBAAL,EAAN;CAAA,KALP,EAMEL,IANF,CAMO;CAAA,aAAM,KAAI,CAACM,cAAL,EAAN;CAAA,KANP,EAOEN,IAPF,CAOO;CAAA,aAAM,KAAI,CAACO,YAAL,EAAN;CAAA,KAPP;CASA;;CA/BF;CAAA;CAAA,+BAkCC;CAAA;;CACC,aAAO,IAAIlB,OAAJ,CAAY,UAACmB,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,+BAAI,CAACC,KAAL,GAAaX,IAAb,CAAkB,UAAA3M,UAAU,EAAI;CAC/B,UAAA,MAAI,CAACA,UAAL,GAAkBA,UAAlB;CACAmN,UAAAA,OAAO;CACP,SAHD;CAIA,OALM,CAAP;CAMA;CAzCF;CAAA;CAAA,0CA4CC;CACC,aAAO1K,EAAE,CAAC8K,mBAAH,CAAuBhH,IAAvB,EAAP;CACA;CA9CF;CAAA;CAAA,uCAgDoBlF,IAhDpB,EAiDC;CAAA;;CACC8J,MAAAA,OAAO,CAACqC,GAAR,CAAY,uBAAZ,EADD;;CAIC,UAAIC,eAAe,GAAG/K,gCAAY,CAACgL,GAAb,CAAiB,KAAK1N,UAAL,CAAgB4C,SAAhB,EAAjB,EAA8C,CAA9C,EAAiD,iBAAjD,EAAoE,KAApE,CAAtB;;CACA,UAAI6K,eAAJ,EACA;CACC,aAAKjL,WAAL,CAAiBiL,eAAjB;CACA;;CAED,WAAKE,YAAL,GAAoBtM,IAAI,CAACuM,aAAL,IAAsB,EAA1C;CAEA,aAAO,IAAI5B,OAAJ,CAAY,UAACmB,OAAD,EAAUC,MAAV,EAAqB;CACvCS,QAAAA,kBAAkB,CAACC,SAAnB,CAA6B,eAA7B,EAA8C;CAC7CC,UAAAA,WAAW,EAAElI,eAAe,CAACN,uBAAhB,EADgC;CAE7CyI,UAAAA,cAAc,EAAE,KAF6B;CAG7CC,UAAAA,aAAa,EAAEpI,eAAe,CAACqI,wBAAhB,EAH8B;CAI7CC,UAAAA,cAAc,EAAE;CAJ6B,SAA9C,EAKGxB,IALH,CAKQ,UAAA5G,OAAO,EAAI;CAClB,UAAA,MAAI,CAAC/F,UAAL,CAAgBoO,QAAhB,GAA2B9M,MAA3B,CAAkC,iBAAlC,EAAqD;CACpDpB,YAAAA,MAAM,EAAE;CACPuB,cAAAA,QAAQ,EAAEJ,IAAI,CAACgN;CADR,aAD4C;CAIpDtI,YAAAA,OAAO,EAAE;CACRgI,cAAAA,WAAW,EAAEhI,OAAO,CAACgI,WADb;CAERC,cAAAA,cAAc,EAAEjI,OAAO,CAACiI,cAFhB;CAGRC,cAAAA,aAAa,EAAElI,OAAO,CAACkI,aAHf;CAIRjI,cAAAA,cAAc,EAAEsI,oBAAoB,IAAIA,oBAAoB,CAACvI,OAAO,CAACoI,cAAT,CAA5C,IAAwEG,oBAAoB,CAACvI,OAAO,CAACoI,cAAT,CAApB,CAA6CI;CAJ7H;CAJ2C,WAArD;;CAWApB,UAAAA,OAAO;CACP,SAlBD;CAmBA,OApBM,CAAP;CAqBA;CAlFF;CAAA;CAAA,oCAqFC;CAAA;;CACChC,MAAAA,OAAO,CAACqC,GAAR,CAAY,kBAAZ;CACA,WAAKxN,UAAL,CAAgBoO,QAAhB,GAA2BI,SAA3B,CAAqC,UAAAC,QAAQ;CAAA,eAAI,MAAI,CAACC,qBAAL,CAA2BD,QAA3B,CAAJ;CAAA,OAA7C;CAGA,WAAKzO,UAAL,CAAgB6C,WAAhB,CAA4B8L,iCAA5B,CAA8D,KAAKC,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAA9D;CAEA,WAAK7O,UAAL,CAAgB8O,oBAAhB,CACC3N,uBAAuB,CAAC4N,MAAxB,CAA+B;CAC9B9O,QAAAA,KAAK,EAAE,KAAKD,UAAL,CAAgBoO,QAAhB,EADuB;CAE9BpO,QAAAA,UAAU,EAAE,KAAKA,UAFa;CAG9BoB,QAAAA,OAAO,EAAE;CAHqB,OAA/B,CADD;CAQA,UAAIlB,MAAM,GAAG,KAAKF,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,eAAnC,EAAoD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAApD,CAAb;;CACA,UAAI9O,MAAJ,EACA;CACC,aAAKF,UAAL,CAAgBoO,QAAhB,GAA2B9M,MAA3B,CAAkC,iBAAlC,EAAqD;CAACpB,UAAAA,MAAM,EAAE;CAC7DqB,YAAAA,MAAM,EAAErB,MAAM,CAACqB,MAD8C;CAE7DI,YAAAA,YAAY,EAAEzB,MAAM,CAACyB,YAAP,IAAuB;CAFwB;CAAT,SAArD;CAIA;;CAED,aAAO,KAAK3B,UAAL,CAAgBiP,SAAhB,CAA0B,IAA1B,EAAgC;CACtC7L,QAAAA,EAAE,EAAE,KAAK6I,QAD6B;CAEtCV,QAAAA,QAAQ;CAF8B,OAAhC,EAINoB,IAJM,CAID,UAAAuC,GAAG,EAAI;CACZ,QAAA,MAAI,CAAC3D,QAAL,GAAgB2D,GAAhB;CACA,eAAO,IAAIlD,OAAJ,CAAY,UAACmB,OAAD,EAAUC,MAAV;CAAA,iBAAqBD,OAAO,EAA5B;CAAA,SAAZ,CAAP;CACA,OAPM,CAAP;CAQA;CArHF;CAAA;CAAA,sCAwHC;CACChC,MAAAA,OAAO,CAACqC,GAAR,CAAY,oBAAZ;CAEA,WAAK2B,kBAAL,GAA0BhK,kBAAK,CAACiK,QAAN,CAAe,KAAKpP,UAAL,CAAgB6C,WAAhB,CAA4BsM,kBAA3C,EAA+D,GAA/D,EAAoE,KAAKnP,UAAL,CAAgB6C,WAApF,CAA1B;CAEA,aAAO,IAAImJ,OAAJ,CAAY,UAACmB,OAAD,EAAUC,MAAV;CAAA,eAAqBD,OAAO,EAA5B;CAAA,OAAZ,CAAP;CACA;CA9HF;CAAA;CAAA,4CAiIC;CAAA;;CACChC,MAAAA,OAAO,CAACqC,GAAR,CAAY,0BAAZ;CAEA/M,MAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoB0O,MAApB,CAA2BC,UAA3B,CAAsC,KAAtC;CACA7O,MAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoB4O,qBAApB,CAA0C,IAA1C;CAEA9M,MAAAA,EAAE,CAAC+M,cAAH,CAAkB,oBAAlB,EAAwC,YAAM;CAC7C,QAAA,MAAI,CAACxP,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,iBAApC,EAAuD;CAAC2N,UAAAA,MAAM,EAAE;CAC/DC,YAAAA,YAAY,EAAE;CADiD;CAAT,SAAvD;CAGA,OAJD;CAKAjN,MAAAA,EAAE,CAAC+M,cAAH,CAAkB,mBAAlB,EAAuC,YAAM;CAC5CrE,QAAAA,OAAO,CAACqC,GAAR,CAAY,UAAZ;;CACA,QAAA,MAAI,CAACxN,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiC,iCAAjC,EAAoE;CAAC8G,UAAAA,QAAQ,EAAE,GAAX;CAAgBC,UAAAA,oBAAoB,EAAE;CAAtC,SAApE;CACA,OAHD;CAIApH,MAAAA,EAAE,CAAC+M,cAAH,CAAkB,oBAAlB,EAAwC,YAAM;CAC7CG,QAAAA,aAAa,CAAC,MAAI,CAACC,uBAAN,CAAb;;CACA,QAAA,MAAI,CAAC5P,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,iBAApC,EAAuD;CAAC2N,UAAAA,MAAM,EAAE;CAC/DC,YAAAA,YAAY,EAAE;CADiD;CAAT,SAAvD;CAGA,OALD;;CAOA,UAAMG,kBAAkB,GAAG,SAArBA,kBAAqB,GAC3B;CACCpP,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBmP,SAApB,CAA8B;CAACC,UAAAA,QAAQ,EAAE,kBAAC1O,IAAD,EACzC;CACC,YAAA,MAAI,CAACoL,aAAL,GAAqBpL,IAAI,CAAC2O,MAAL,KAAgB,SAArC;;CACA,gBAAI,MAAI,CAACvD,aAAT,EACA;CACClJ,cAAAA,UAAG,CAAC2D,KAAJ,CAAU+I,KAAV,CAAgB,+BAAhB;CACA,aAHD,MAKA;CACC1M,cAAAA,UAAG,CAAC2D,KAAJ,CAAU+I,KAAV,CAAgB,8BAAhB;CACA;CACD;CAX6B,SAA9B;CAYA,OAdD;;CAgBAxN,MAAAA,EAAE,CAAC+M,cAAH,CAAkB,aAAlB,EAAiC,YACjC;CACCK,QAAAA,kBAAkB;CAElBpP,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBmP,SAApB,CAA8B;CAACC,UAAAA,QAAQ,EAAE,kBAAC1O,IAAD,EACzC;CACC,gBAAIA,IAAI,CAAC2O,MAAL,KAAgB,SAApB,EACA;CACC,qBAAO,KAAP;CACA;;CAED,YAAA,MAAI,CAACzI,eAAL,GAAuBoF,IAAvB,CAA4B,YAAM;CACjC,cAAA,MAAI,CAACuD,mBAAL;;CACA,cAAA,MAAI,CAAClQ,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiB8C,gBAAlD;CACA,aAHD,EAGGmN,KAHH,CAGS,YAAM;CACd,cAAA,MAAI,CAACD,mBAAL;CACA,aALD;CAMA;CAb6B,SAA9B;CAcA,OAlBD;CAmBAzN,MAAAA,EAAE,CAAC+M,cAAH,CAAkB,aAAlB,EAAiC,YAAM;CACtC,QAAA,MAAI,CAAC/C,aAAL,GAAqB,KAArB;CACAlJ,QAAAA,UAAG,CAAC2D,KAAJ,CAAU+I,KAAV,CAAgB,8BAAhB,EAFsC;CAItC,OAJD;CAMAxN,MAAAA,EAAE,CAAC+M,cAAH,CAAkB,iBAAlB,EAAqCK,kBAArC;CACApN,MAAAA,EAAE,CAAC+M,cAAH,CAAkB,kBAAlB,EAAsC,YAAM;CAC3C,QAAA,MAAI,CAAC/C,aAAL,GAAqB,KAArB;CACAlJ,QAAAA,UAAG,CAAC2D,KAAJ,CAAU+I,KAAV,CAAgB,8BAAhB;CACA,OAHD;CAKAxP,MAAAA,WAAW,CAAC+O,cAAZ,CAA2B,uCAA3B,EAAoE,UAACzP,MAAD,EAAY;CAC/E,YAAIyJ,MAAM,GAAGzJ,MAAM,CAACqQ,MAAP,CAAcC,QAAd,GAAyBC,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAb;;CACA,QAAA,MAAI,CAACC,4BAAL,CAAkC/G,MAAlC,EAA0CzJ,MAA1C;CACA,OAHD;CAIAU,MAAAA,WAAW,CAAC+O,cAAZ,CAA2B,uCAA3B,EAAoE,UAACzP,MAAD,EAAY;CAC/E,YAAIyJ,MAAM,GAAGzJ,MAAM,CAACqQ,MAAP,CAAcC,QAAd,GAAyBC,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAb;;CACA,QAAA,MAAI,CAACE,4BAAL,CAAkChH,MAAlC,EAA0CzJ,MAA1C;CACA,OAHD;CAIAU,MAAAA,WAAW,CAAC+O,cAAZ,CAA2B,uBAA3B,EAAoD,UAACzP,MAAD,EAAY;CAC/D0Q,QAAAA,uBAAI,CAAC3N,IAAL,CAAU;CACT0C,UAAAA,IAAI,EAAEkL,6BAAU,CAACC,gBAAX,CAA4BC,MADzB;CAETC,UAAAA,QAAQ,EAAE,MAAI,CAACC,iBAAL,CAAuBC,WAAvB,EAFD;CAGT1P,UAAAA,IAAI,EAAE;CAACjB,YAAAA,OAAO,EAAE,YAAV;CAAwBL,YAAAA,MAAM,gCAAMA,MAAN;CAAciR,cAAAA,eAAe,EAAE;CAA/B;CAA9B;CAHG,SAAV;CAKA,OAND;CAQAvQ,MAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8BC,SAA9B,CAAwC,KAAKC,iBAAL,EAAxC;CACA,WAAKC,wBAAL;CAEA3O,MAAAA,EAAE,CAAC4O,oBAAH,CAAwBC,WAAxB,CAAoC,KAAKC,oBAAL,CAA0B1C,IAA1B,CAA+B,IAA/B,CAApC;CAEA,WAAK2C,kBAAL,GAA0BrM,kBAAK,CAACsM,QAAN,CAAe,UAAClQ,MAAD,EAASmQ,MAAT,EAAiBC,QAAjB,EAA2BC,IAA3B,EAAoC;CAC5E,QAAA,MAAI,CAAC5R,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDP,UAAAA,MAAM,EAAEA,MAD2C;CAEnDC,UAAAA,EAAE,EAAEkQ,MAF+C;CAGnD3P,UAAAA,MAAM,EAAE;CACP6P,YAAAA,IAAI,EAAEA,IADC;CAEPD,YAAAA,QAAQ,EAAEA;CAFH;CAH2C,SAApD;CAQA,OATyB,EASvB,GATuB,CAA1B;;CAWA,UAAIxM,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAJ,EACA;CACC,YAAI6C,UAAU,GAAG,KAAK7R,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAjB;CACA,YAAItM,IAAI,GAAGqM,UAAU,CAACrM,IAAtB;;CACA,YAAIA,IAAI,KAAKuM,mBAAU,CAACC,IAApB,IAA4BH,UAAU,CAAChQ,YAAX,CAAwBoQ,MAAxD,EACA;CACC/P,UAAAA,GAAG,CAAC4H,IAAJ,CAAS,iBAAT,EAA4B;CAACoI,YAAAA,KAAK,EAAC,CAClC;CACC1M,cAAAA,IAAI,EAAE,WADP;CAECuK,cAAAA,QAAQ,EAAE,oBAAM;CACfoC,gBAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,sBAA/B,EAAuD,EAAvD;;CACA,gBAAA,MAAI,CAACC,iBAAL;CACA;CALF,aADkC;CAAP,WAA5B;CASA;CACD;;CAED,UAAI,CAACnN,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAL,EACA;CACC,aAAKuD,oBAAL,GAA4B,IAA5B;CACAjS,QAAAA,UAAU,CAAC,YAAM;CAChB,UAAA,MAAI,CAACiS,oBAAL,GAA4B,KAA5B;;CACA,UAAA,MAAI,CAAChS,YAAL;CACA,SAHS,EAGP,IAHO,CAAV;CAKAiS,QAAAA,WAAW,CAAC,YAAM;CACjB,UAAA,MAAI,CAACjS,YAAL;CACA,SAFU,EAER,KAFQ,CAAX;CAGA;;CAED,WAAKA,YAAL;CAEA,WAAKkS,WAAL,GAAmB,IAAIC,eAAJ,CAAoB,KAAK1S,UAAL,CAAgB2S,SAAhB,EAApB,EAAiD,KAAK3S,UAAL,CAAgB4S,aAAhB,EAAjD,CAAnB;CAEA,aAAO,IAAI5G,OAAJ,CAAY,UAACmB,OAAD,EAAUC,MAAV;CAAA,eAAqBD,OAAO,EAA5B;CAAA,OAAZ,CAAP;CACA;CA1QF;CAAA;CAAA,qCA6QC;CAAA;;CACChC,MAAAA,OAAO,CAACqC,GAAR,CAAY,mBAAZ;;CAEA,UAAI,KAAKG,YAAL,IAAqB,KAAKA,YAAL,CAAkBzH,MAAlB,GAA2B,CAApD,EACA;CACC5F,QAAAA,UAAU,CAAC,YAAM;CAChB,UAAA,MAAI,CAACqN,YAAL,GAAoB,MAAI,CAACA,YAAL,CAAkBxK,MAAlB,CAAyB,UAAA+D,KAAK,EAAI;CACrDzE,YAAAA,EAAE,CAACoQ,aAAH,CAAiB,uBAAjB,EAA0C,CAAC3L,KAAD,CAA1C;CACA,mBAAO,KAAP;CACA,WAHmB,CAApB;CAIA,SALS,EAKP,EALO,CAAV;CAMA;;CAEDuJ,MAAAA,uBAAI,CAACjC,SAAL,CACC,KAAKsC,iBAAL,GAAyB,IAAIhR,sBAAJ,CAA2B;CACnDG,QAAAA,KAAK,EAAE,KAAKD,UAAL,CAAgBoO,QAAhB,EAD4C;CAEnDpO,QAAAA,UAAU,EAAE,KAAKA,UAFkC;CAGnDE,QAAAA,MAAM,EAAE;CAH2C,OAA3B,CAD1B;CAOAuQ,MAAAA,uBAAI,CAACjC,SAAL,CAAe;CACdhJ,QAAAA,IAAI,EAAE/C,EAAE,CAACiO,UAAH,CAAcC,gBAAd,CAA+BC,MADvB;CAEdC,QAAAA,QAAQ,EAAE,IAFI;CAGdzQ,QAAAA,OAAO,EAAE,eAHK;CAId2P,QAAAA,QAAQ,EAAE,kBAAChQ,MAAD,EACV;CACC,cACCA,MAAM,CAAC6F,MAAP,KAAkB,MAAI,CAAC5F,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAAlB,IACG5S,MAAM,CAAC0B,QAAP,KAAoB,MAAI,CAACzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAFxB,EAIA;CACC9M,YAAAA,GAAG,CAACC,eAAJ;CACA;CACD;CAba,OAAf;CAgBAsO,MAAAA,uBAAI,CAACjC,SAAL,CAAe;CACdhJ,QAAAA,IAAI,EAAEkL,6BAAU,CAACC,gBAAX,CAA4BmC,MADpB;CAEd/C,QAAAA,QAAQ,EAAE,KAAKgD,sBAAL,CAA4BlE,IAA5B,CAAiC,IAAjC;CAFI,OAAf;;CAKA,UAAI,CAAC1J,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAL,EACA;CACCyB,QAAAA,uBAAI,CAACjC,SAAL,CAAe;CACdhJ,UAAAA,IAAI,EAAEkL,6BAAU,CAACC,gBAAX,CAA4BqC,MADpB;CAEdjD,UAAAA,QAAQ,EAAE,KAAKkD,sBAAL,CAA4BpE,IAA5B,CAAiC,IAAjC;CAFI,SAAf;CAIA;;CAED,aAAO,IAAI7C,OAAJ,CAAY,UAACmB,OAAD,EAAUC,MAAV;CAAA,eAAqBD,OAAO,EAA5B;CAAA,OAAZ,CAAP;CACA;CA/TF;CAAA;CAAA,mCAkUC;CACC,WAAKrB,MAAL,GAAc,IAAd;CACA,WAAKC,WAAL,CAAiBoB,OAAjB,CAAyB,IAAzB;CAEA1M,MAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,4BAAnC,EAAiE,CAAC;CACjE1R,QAAAA,QAAQ,EAAE,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B;CADuD,OAAD,EAE9D,IAF8D,CAAjE,EAEU,WAFV;CAIA,aAAO,KAAKoE,WAAL,EAAP;CACA;CA3UF;CAAA;CAAA,4BA8UC;CACC,UAAI,KAAKtH,MAAT,EACA;CACC,YAAIuH,OAAO,GAAG,IAAI5Q,EAAE,CAACuJ,OAAP,EAAd;CACAqH,QAAAA,OAAO,CAAClG,OAAR,CAAgB,IAAhB;CAEA,eAAOkG,OAAP;CACA;;CAED,aAAO,KAAKtH,WAAZ;CACA;CAxVF;CAAA;CAAA,kCA2VC;CAAA;;CACCZ,MAAAA,OAAO,CAACqC,GAAR,CAAY,gBAAZ;;CACA,UAAI,KAAK8F,eAAT,EACA;CACC,eAAO,KAAKA,eAAZ;CACA;;CAED,WAAK/G,KAAL,CAAWgH,KAAX,CAAiB,MAAjB,EAAyB,MAAzB,EAAiC,EAAjC,EAAqC,YAAM;CAC1CpI,QAAAA,OAAO,CAAClD,IAAR,CAAa,4DAAb;CACA/F,QAAAA,GAAG,CAACsR,WAAJ,CAAgB,WAAhB,EAA6B;CAACC,UAAAA,WAAW,EAAE,IAAd;CAAoBC,UAAAA,cAAc,EAAE;CAApC,SAA7B;CACA,OAHD;CAKA,WAAKJ,eAAL,GAAuB,IAAItH,OAAJ,CAAY,UAACmB,OAAD,EAAUC,MAAV,EACnC;CAAA;;CACC,YAAIuG,KAAK,qDACPC,0BAAiB,CAACC,qBADX,EACmC,CAAClJ,mBAAU,CAACkJ,qBAAZ,EAAmC,EAAnC,CADnC,uCAEPD,0BAAiB,CAACE,SAFX,EAEuB,CAACnJ,mBAAU,CAACmJ,SAAZ,EAAuB;CAACpS,UAAAA,SAAS,EAAE,MAAI,CAAC1B,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B;CAAZ,SAAvB,CAFvB,uCAGP4E,0BAAiB,CAACG,uBAHX,EAGqC,CAACpJ,mBAAU,CAACqJ,mBAAZ,EAAiC;CAC7EtS,UAAAA,SAAS,EAAE,MAAI,CAAC1B,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EADkE;CAE7EiF,UAAAA,KAAK,EAAE,MAAI,CAACjU,UAAL,CAAgB6C,WAAhB,CAA4BqR,sBAA5B,EAFsE;CAG7EC,UAAAA,YAAY,EAAE;CAH+D,SAAjC,CAHrC,uCAQPP,0BAAiB,CAACQ,cARX,EAQ4B,CAACzJ,mBAAU,CAACyJ,cAAZ,EAA4B;CAAC1S,UAAAA,SAAS,EAAE,MAAI,CAAC1B,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAZ;CAAuDxF,UAAAA,MAAM,EAAE;CAA/D,SAA5B,CAR5B,UAAT;;CAUA,YAAIrE,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,MAAI,CAACtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAJ,EACA;CACC2E,UAAAA,KAAK,CAACC,0BAAiB,CAACS,SAAnB,CAAL,GAAqC,CAAC1J,mBAAU,CAAC0J,SAAZ,EAAuB,EAAvB,CAArC;CACA,SAHD,MAKA;CACCV,UAAAA,KAAK,CAACC,0BAAiB,CAACU,aAAnB,CAAL,GAAyC,CAAC3J,mBAAU,CAAC2J,aAAZ,EAA2B;CAAC9S,YAAAA,EAAE,EAAE,CAAC,MAAI,CAACxB,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAAD,EAA0C,MAAI,CAAC3S,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAA1C;CAAL,WAA3B,CAAzC;CACA;;CAED,QAAA,MAAI,CAAChP,UAAL,CAAgByK,UAAhB,CAA2B8J,SAA3B,CAAqCZ,KAArC,EAA4C,UAACa,QAAD,EAC5C;CACC,cAAI,CAACA,QAAL,EACA;CACC,YAAA,MAAI,CAAClB,eAAL,GAAuB,IAAvB;;CACA,YAAA,MAAI,CAACmB,QAAL,CAAc,gBAAd,EAAgC,oCAAhC;;CAEAtH,YAAAA,OAAO;CACP,mBAAO,KAAP;CACA;;CAED,cAAIuH,QAAQ,GAAGF,QAAQ,CAACZ,0BAAiB,CAACC,qBAAnB,CAAvB;;CACA,cAAIa,QAAQ,CAAC1S,KAAT,EAAJ,EACA,CADA,MAKA;CACC,YAAA,MAAI,CAAChC,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACC,qBAApD,EAA2Ea,QAA3E;CACA;;CAED,cAAIE,OAAO,GAAGJ,QAAQ,CAACZ,0BAAiB,CAACS,SAAnB,CAAtB;;CACA,cAAIO,OAAO,IAAI,CAACA,OAAO,CAAC5S,KAAR,EAAhB,EACA;CACC,YAAA,MAAI,CAAChC,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACS,SAApD,EAA+DO,OAA/D;CACA;;CAED,cAAIC,WAAW,GAAGL,QAAQ,CAACZ,0BAAiB,CAACU,aAAnB,CAA1B;;CACA,cAAIO,WAAW,IAAI,CAACA,WAAW,CAAC7S,KAAZ,EAApB,EACA;CACC,YAAA,MAAI,CAAChC,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACU,aAApD,EAAmEO,WAAnE;CACA;;CAED,cAAIC,aAAa,GAAGN,QAAQ,CAACZ,0BAAiB,CAACE,SAAnB,CAA5B;;CACA,UAAA,MAAI,CAAC9T,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACE,SAApD,EAA+DgB,aAA/D;;CAEA,cAAIC,uBAAuB,GAAGP,QAAQ,CAACZ,0BAAiB,CAACG,uBAAnB,CAAtC;;CACA,cAAIgB,uBAAuB,CAAC/S,KAAxB,EAAJ,EACA,CADA,MAKA;CACCE,YAAAA,GAAG,CAACsR,WAAJ,CAAgB,WAAhB,EAA6B;CAACC,cAAAA,WAAW,EAAE,KAAd;CAAqBC,cAAAA,cAAc,EAAE;CAArC,aAA7B;;CACA,YAAA,MAAI,CAACnH,KAAL,CAAWyI,IAAX,CAAgB,MAAhB,EAAwB,MAAxB,EAAgC,IAAhC;;CAEA,YAAA,MAAI,CAAChV,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,sBAApC,EAA4D;CAC3DL,cAAAA,QAAQ,EAAE,MAAI,CAACzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EADiD;CAE3DzN,cAAAA,MAAM,EAAE,MAAI,CAACvB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B;CAFmD,aAA5D;;CAKA,gBAAI,MAAI,CAACjV,UAAL,CAAgBkV,eAApB,EACA;CACC,cAAA,MAAI,CAAClV,UAAL,CAAgBkV,eAAhB,CAAgCC,MAAhC,CAAuCC,IAAvC,GAA8C,KAA9C;CACA;;CAED,YAAA,MAAI,CAACpV,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,iBAApC,EAAuD;CAAC5B,cAAAA,MAAM,EAAE;CAC/DmV,gBAAAA,kBAAkB,EAAE;CAD2C;CAAT,aAAvD,EAEI1I,IAFJ,CAES,YAAM;CACd,cAAA,MAAI,CAAC3M,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACG,uBAApD,EAA6EgB,uBAA7E;CACA,aAJD;;CAMA,YAAA,MAAI,CAAC7E,mBAAL;CACA;;CAED,UAAA,MAAI,CAACoD,eAAL,GAAuB,IAAvB;CACAnG,UAAAA,OAAO;CAEP,SApED,EAoEG,KApEH,EAoEU,KApEV,EAoEiBhI,kBAAK,CAACmQ,oBAAN,CAA2B;CAACpU,UAAAA,IAAI,EAAE,kBAAP;CAA2BhB,UAAAA,MAAM,EAAE,MAAI,CAACF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B;CAAnC,SAA3B,CApEjB;CAqEA,OA1FsB,CAAvB;CA4FA,aAAO,KAAKwB,eAAZ;CACA;CApcF;CAAA;CAAA,yCAscsBiC,SAtctB,EAsciCC,SAtcjC,EAsc4CpF,MAtc5C,EAucC;CACC,UAAImF,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBC,oBAAzC,EACA;CACCvK,QAAAA,OAAO,CAACqC,GAAR,CAAY,+BAAZ,EAA6C+H,SAA7C,EAAwDnF,MAAxD,EAAgEoF,SAAhE;CACA;;CAED,UAAID,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBC,oBAAzC,EACA;CACC,YAAIF,SAAS,CAACG,OAAV,GAAoB,EAAxB,EACA;CACCH,UAAAA,SAAS,CAACG,OAAV,GAAoB,EAApB;CACA;;CACD,aAAKnE,kBAAL,CAAwBgE,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsBwB,MAA9C,EAAsDiU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsB6H,IAAtB,CAA2BpG,EAAjF,EAAqFgU,SAAS,CAACG,OAA/F,EAAwGH,SAAS,CAACI,SAAlH;CACA,OAPD,MAQK,IAAIL,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBI,YAAzC,EACL;CACC,YAAIL,SAAS,CAACnS,MAAV,CAAiB2M,MAAjB,KAA4B,OAAhC,EACA;CACC,eAAK8F,SAAL,CAAeN,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsBwB,MAArC,EAA6CiU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsB6H,IAAtB,CAA2BpG,EAAxE,EAA4EgU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsByB,EAAlG;CACA2J,UAAAA,OAAO,CAACnJ,KAAR,CAAc,mBAAd,EAAmCwT,SAAS,CAACnS,MAAV,CAAiB0S,MAAjB,CAAwB,CAAxB,EAA2B/U,OAA9D;CACA,SAJD,MAMA;CACC,eAAKhB,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDP,YAAAA,MAAM,EAAEiU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsBwB,MADqB;CAEnDC,YAAAA,EAAE,EAAEgU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsB6H,IAAtB,CAA2BpG,EAFoB;CAGnDO,YAAAA,MAAM,EAAE;CACPiO,cAAAA,MAAM,EAAEgG,mBAAU,CAACC,IADZ;CAEPtE,cAAAA,QAAQ,EAAE;CAFH;CAH2C,WAApD;CAQA;CACD,OAlBI,MAmBA,IAAI4D,SAAS,KAAK,2BAAlB,EACL;CACCpK,QAAAA,OAAO,CAACnE,IAAR,CAAa,yDAAb,EAAwEwO,SAAxE,EAAmFpF,MAAnF;CAEA,YAAIxI,IAAI,GAAG4N,SAAS,CAACnS,MAAV,CAAiB6S,KAAjB,CAAuB,WAASV,SAAS,CAACnS,MAAV,CAAiB8S,OAAjB,CAAyB,CAAzB,CAAhC,CAAX;CAEA,aAAKnW,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDP,UAAAA,MAAM,EAAEiU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsBwB,MADqB;CAEnDC,UAAAA,EAAE,EAAEgU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsB6H,IAAtB,CAA2BpG,EAFoB;CAGnDO,UAAAA,MAAM,EAAE;CACPiO,YAAAA,MAAM,EAAEgG,mBAAU,CAACI,MADZ;CAEPzE,YAAAA,QAAQ,EAAE,GAFH;CAGPnQ,YAAAA,EAAE,EAAEoG,IAAI,CAACpG,EAHF;CAIPoQ,YAAAA,IAAI,EAAEhK,IAAI,CAACgK,IAJJ;CAKPyE,YAAAA,WAAW,EAAEzO,IAAI,CAACyO,WALX;CAMPC,YAAAA,UAAU,EAAE1O,IAAI,CAAC0O,UANV;CAOPC,YAAAA,OAAO,EAAE3O,IAAI,CAAC2O;CAPP;CAH2C,SAApD;CAaA,OAnBI,MAoBA,IAAIhB,SAAS,KAAK,wBAAlB,EACL;CACCpK,QAAAA,OAAO,CAACnJ,KAAR,CAAc,sDAAd,EAAsEwT,SAAtE,EAAiFpF,MAAjF;CACA,aAAK0F,SAAL,CAAeN,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsBwB,MAArC,EAA6CiU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsB6H,IAAtB,CAA2BpG,EAAxE,EAA4EgU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsByB,EAAlG;CACA,OAJI,MAKA,IACJ+T,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBe,cAArC,IACGjB,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBgB,cAFpC,EAIL;CACC,aAAK9O,gBAAL,CAAsB6N,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsB6H,IAAtB,CAA2BpG,EAAjD;CACA,OANI,MAOA,IACJ+T,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBiB,mBAArC,IACGnB,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBkB,kBADxC,IAEGpB,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBmB,eAFxC,IAGGrB,SAAS,KAAK9S,EAAE,CAACgT,mBAAH,CAAuBoB,mBAJpC,EAML;CACC1L,QAAAA,OAAO,CAACnJ,KAAR,CAAc,+BAAd,EAA+CuT,SAA/C,EAA0DC,SAA1D,EAAqEpF,MAArE;CACA,aAAK0F,SAAL,CAAeN,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsBwB,MAArC,EAA6CiU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsB6H,IAAtB,CAA2BpG,EAAxE,EAA4EgU,SAAS,CAAC5N,IAAV,CAAe7H,MAAf,CAAsByB,EAAlG;CACA;;CAED,aAAO,IAAP;CACA;CAphBF;CAAA;CAAA,oCAshBiBuD,KAthBjB,EAuhBC;CACC,UAAI+R,eAAe,GAAG,SAAlBA,eAAkB,CAAClP,IAAD,EACtB;CACC,YAAIA,IAAI,CAAC0O,UAAL,IAAmB1O,IAAI,CAAC0O,UAAL,CAAgBS,UAAhB,CAA2B,SAA3B,CAAvB,EACA;CACCnP,UAAAA,IAAI,CAAC0O,UAAL,GAAkB,OAAK1O,IAAI,CAAC0O,UAA5B;CACA;;CACD,YAAI1O,IAAI,CAAC2O,OAAL,IAAgB3O,IAAI,CAAC2O,OAAL,CAAaQ,UAAb,CAAwB,SAAxB,CAApB,EACA;CACCnP,UAAAA,IAAI,CAAC2O,OAAL,GAAe,OAAK3O,IAAI,CAAC2O,OAAzB;CACA;;CAED,YAAI3O,IAAI,CAACpC,IAAL,KAAcwR,iBAAQ,CAACC,KAA3B,EACA;CACC,iBAAOrP,IAAP;CACA;;CAED,YAAIA,IAAI,CAAC0O,UAAT,EACA;CACC,cAAI1O,IAAI,CAAC0O,UAAL,CAAgBS,UAAhB,CAA2B,GAA3B,CAAJ,EACA;CACCnP,YAAAA,IAAI,CAAC0O,UAAL,GAAkBY,aAAa,GAACtP,IAAI,CAAC0O,UAArC;CACA;;CAED1O,UAAAA,IAAI,CAAC0O,UAAL,GAAkB1O,IAAI,CAAC0O,UAAL,CAChBa,OADgB,CACR,SADQ,EACG,WADH,EAEhBA,OAFgB,CAER,UAFQ,EAEI,YAFJ,CAAlB;CAGA;;CAED,YAAIvP,IAAI,CAAC2O,OAAT,EACA;CACC,cAAI3O,IAAI,CAAC2O,OAAL,CAAaQ,UAAb,CAAwB,GAAxB,CAAJ,EACA;CACCnP,YAAAA,IAAI,CAAC2O,OAAL,GAAeW,aAAa,GAACtP,IAAI,CAAC2O,OAAlC;CACA;;CAED3O,UAAAA,IAAI,CAAC2O,OAAL,GAAe3O,IAAI,CAAC2O,OAAL,CACbY,OADa,CACL,SADK,EACM,WADN,EAEbA,OAFa,CAEL,UAFK,EAEO,YAFP,CAAf;CAGA;;CAED,eAAOvP,IAAP;CACA,OAzCD;;CA2CA,UAAI7C,KAAK,YAAYqS,KAArB,EACA;CACC,eAAOrS,KAAK,CAACsS,GAAN,CAAU,UAAAzP,IAAI;CAAA,iBAAIkP,eAAe,CAAClP,IAAD,CAAnB;CAAA,SAAd,CAAP;CACA,OAHD,MAKA;CACC,eAAOkP,eAAe,CAAC/R,KAAD,CAAtB;CACA;CACD;CAEF;;CAEA;;CA/kBA;CAAA;CAAA,mCAilBC;CAAA;;CACC,UAAIuS,gBAAJ;;CACA,UAAInS,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAJ,EACA;CACCsI,QAAAA,gBAAgB,GAAG,KAAKC,mBAAL,EAAnB;CAEA,aAAKnG,wBAAL;CACA,OALD,MAOA;CACCkG,QAAAA,gBAAgB,GAAG,KAAKE,mBAAL,EAAnB;CACA,aAAKC,WAAL;CACA;;CAED,UAAI,CAACH,gBAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI,CAAC,KAAKI,gBAAV,EACA;CACC;CACAjX,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiCd,MAAjC,CAAwC2T,cAAxC,GAAyD,IAAzD,CAFD;;CAGCjT,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiC8W,WAAjC,CAA6C;CAAA,iBAAM,MAAI,CAACC,cAAL,EAAN;CAAA,SAA7C;CAEA,aAAKF,gBAAL,GAAwB,IAAxB;CACA;;CAED,UAAIJ,gBAAgB,CAACpW,IAArB,EACA;CACCT,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiCgX,OAAjC,CAAyCP,gBAAgB,CAACpW,IAA1D;CACA;;CACD,UAAIoW,gBAAgB,CAACQ,IAArB,EACA;CACCrX,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiCkX,aAAjC,CAA+CT,gBAAgB,CAACQ,IAAhE;CACA;;CACD,UAAIR,gBAAgB,CAACU,MAArB,EACA;CACCvX,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiCoX,QAAjC,CAA0CX,gBAAgB,CAACU,MAA3D;CACA,OAHD,MAIK,IAAIV,gBAAgB,CAAC7S,KAArB,EACL;CACC;CACAhE,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiCd,MAAjC,CAAwCmY,UAAxC,GAAqDZ,gBAAgB,CAAC7S,KAAtE;CACA;;CAED,UAAIU,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAJ,EACA;CACC,YAAI6C,UAAU,GAAG,KAAK7R,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAjB;;CACA,YAAI,CAACD,UAAU,CAAChQ,YAAX,CAAwBoQ,MAA7B,EACA;CACC/P,UAAAA,GAAG,CAAC4H,IAAJ,CAAS,iBAAT,EAA4B;CAACoI,YAAAA,KAAK,EAAC;CAAP,WAA5B;CACA;CACD;;CAED,aAAO,IAAP;CACA;CAzoBF;CAAA;CAAA,0CA4oBC;CACC,UAAIrN,IAAI,GAAG,KAAK7E,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,WAAnC,EAAgD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAhD,CAAX;;CACA,UAAI,CAACnK,IAAD,IAAS,CAACA,IAAI,CAAC0B,IAAnB,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAIlD,MAAM,GAAG;CACZ,gBAAQ,IADI;CAEZ,gBAAQ,IAFI;CAGZ,kBAAU,IAHE;CAIZ,iBAAS;CAJG,OAAb;;CAOA,UAAIwB,IAAI,CAACmT,MAAT,EACA;CACC3U,QAAAA,MAAM,CAAC2U,MAAP,GAAgBnT,IAAI,CAACmT,MAArB;CACA,OAHD,MAKA;CACC3U,QAAAA,MAAM,CAACoB,KAAP,GAAeI,IAAI,CAACJ,KAApB;CACA;;CAEDpB,MAAAA,MAAM,CAACnC,IAAP,GAAc2D,IAAI,CAAC3D,IAAnB;CAEA,UAAIiX,YAAY,GAAG,KAAnB;;CAEA,UAAI,CAAC,KAAK5F,oBAAN,IAA8B1N,IAAI,CAACuT,gBAAvC,EACA;CACCD,QAAAA,YAAY,GAAGhT,kBAAK,CAACN,IAAN,CAAWwT,eAAX,CAA2BxT,IAA3B,EAAiC,KAAKyT,WAAL,EAAjC,CAAf;CACA;;CAED,UAAIH,YAAJ,EACA;CACC9U,QAAAA,MAAM,CAACyU,IAAP,GAAcK,YAAd;CACA,OAHD,MAKA;CACC,YAAItT,IAAI,CAAC0T,YAAT,EACA;CACClV,UAAAA,MAAM,CAACyU,IAAP,GAAcjT,IAAI,CAAC0T,YAAnB;CACA,SAHD,MAKA;CACClV,UAAAA,MAAM,CAACyU,IAAP,GAAc,KAAKQ,WAAL,CAAiB,mCAAjB,CAAd;CACA;CACD;;CAED,aAAOjV,MAAP;CACA;CA7rBF;CAAA;CAAA,0CAgsBC;CACC,UAAInD,MAAM,GAAG,KAAKF,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,eAAnC,EAAoD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAApD,CAAb;;CACA,UAAI,CAAC9O,MAAD,IAAW,CAACA,MAAM,CAACqG,IAAvB,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAIlD,MAAM,GAAG;CACZ,gBAAQ,IADI;CAEZ,gBAAQ,IAFI;CAGZ,kBAAU,IAHE;CAIZ,iBAAS;CAJG,OAAb;;CAOA,UAAInD,MAAM,CAAC8X,MAAX,EACA;CACC3U,QAAAA,MAAM,CAAC2U,MAAP,GAAgB9X,MAAM,CAAC8X,MAAvB;CACA,OAHD,MAKA;CACC3U,QAAAA,MAAM,CAACoB,KAAP,GAAevE,MAAM,CAACuE,KAAtB;CACA;;CAED,UAAIvE,MAAM,CAACsY,UAAP,KAAsB,SAA1B,EACA;CACCnV,QAAAA,MAAM,CAAC2U,MAAP,GAAgBS,SAAS,CACxB,KAAKzY,UAAL,CAAgB0Y,OAAhB,KAA4B,mFADJ,CAAzB;CAGA;;CAEDrV,MAAAA,MAAM,CAACnC,IAAP,GAAchB,MAAM,CAACgB,IAArB;CAEA,UAAIyX,aAAa,GAAG,KAAKL,WAAL,CAAiB,uCAAjB,CAApB;;CACA,UAAI,KAAKA,WAAL,GAAmB,kCAAgCpY,MAAM,CAACsF,IAAP,CAAYoT,WAAZ,EAAhC,GAA0D,MAA7E,CAAJ,EACA;CACCD,QAAAA,aAAa,GAAG,KAAKL,WAAL,CAAiB,kCAAgCpY,MAAM,CAACsF,IAAP,CAAYoT,WAAZ,EAAhC,GAA0D,MAA3E,CAAhB;CACA;;CACDvV,MAAAA,MAAM,CAACyU,IAAP,GAAca,aAAd;CAEA,aAAOtV,MAAP;CACA;CAxuBF;CAAA;CAAA,+CA2uBC;CACC,UAAInD,MAAM,GAAG,KAAKF,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,eAAnC,EAAoD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAApD,CAAb;;CACA,UAAI,CAAC9O,MAAD,IAAW,CAACA,MAAM,CAACqG,IAAvB,EACA;CACC9F,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8BzG,IAA9B;CACA,eAAO,IAAP;CACA;;CAED,UAAIkF,YAAY,GAAG,IAAnB;;CAEA,UAAIxP,MAAM,CAACsF,IAAP,KAAgB,cAAhB,IAAkC,CAACtF,MAAM,CAACuF,WAAP,CAAmBC,QAAnB,CAA4B,KAAK1F,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAA5B,CAAvC,EACA;CACCjD,QAAAA,YAAY,GAAG,KAAf;CACA;;CAED,UACC,OAAO,KAAKmJ,gBAAZ,KAAiC,WAAjC,KAEC,KAAKA,gBAAL,IAAyBnJ,YAAzB,IACG,CAAC,KAAKmJ,gBAAN,IAA0B,CAACnJ,YAH/B,CADD,EAOA;CACC,eAAO,KAAKmJ,gBAAZ;CACA;;CAED,UAAInJ,YAAJ,EACA;CACCjP,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8BzG,IAA9B;CACA,aAAKqO,gBAAL,GAAwB,IAAxB;CACA,OAJD,MAMA;CACCpY,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8B6H,IAA9B;CACA,aAAKD,gBAAL,GAAwB,KAAxB;CACA;;CAED,aAAO,KAAKA,gBAAZ;CACA;CAjxBF;CAAA;CAAA,kCAoxBC;CAAA;;CACC,UAAI,KAAKE,cAAT,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAIC,QAAQ,GAAG,KAAKhZ,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,WAAnC,EAAgD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAhD,EAA2F,IAA3F,CAAf;;CACA,UAAI,CAACgK,QAAQ,CAACzS,IAAd,EACA;CACC,eAAO,KAAP;CACA;;CAED,UACC,KAAKvG,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,OAA4CsG,QAAQ,CAAC,KAAKjZ,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAD,CAApD,IACGgK,QAAQ,CAACE,GADZ,IAEGF,QAAQ,CAACG,OAHb,EAKA;CACCjX,QAAAA,GAAG,CAAC4H,IAAJ,CAAS,iBAAT,EAA4B;CAACoI,UAAAA,KAAK,EAAE;CAAR,SAA5B;CAEA,aAAK6G,cAAL,GAAsB,IAAtB;CACA,eAAO,IAAP;CACA;;CAED7W,MAAAA,GAAG,CAAC4H,IAAJ,CAAS,iBAAT,EAA4B;CAACoI,QAAAA,KAAK,EAAE,CACnC;CACC1M,UAAAA,IAAI,EAAE,YADP;CAECuK,UAAAA,QAAQ,EAAE,oBAAM;CACf,YAAA,MAAI,CAACqJ,YAAL;CACA;CAJF,SADmC,EAOnC;CACC5T,UAAAA,IAAI,EAAE,YADP;CAEC6T,UAAAA,SAAS,EAAE,YAFZ;CAGCtJ,UAAAA,QAAQ,EAAE,oBAAM;CAEfoC,YAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,wBAA/B,EAAyD,EAAzD;CAEA,gBAAI2G,QAAQ,GAAG,EAAf;CACAA,YAAAA,QAAQ,CAAC,MAAI,CAAChZ,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAD,CAAR,GAAsD,MAAI,CAAChP,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,WAAnC,EAAgD,MAAI,CAAC5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAhD,EAA2F,IAA3F,CAAtD;CAEAvO,YAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,cAAnC,EAAmD;CAClDvN,cAAAA,MAAM,EAAE,MAAI,CAAC5F,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD0C;CAElDsK,cAAAA,KAAK,EAAE,IAF2C;CAGlDN,cAAAA,QAAQ,EAARA;CAHkD,aAAnD,EAIG,OAJH;CAKA;CAfF,SAPmC;CAAR,OAA5B;CA0BA,WAAKD,cAAL,GAAsB,IAAtB;CAEA,aAAO,IAAP;CACA;CAz0BF;CAAA;CAAA,mCA40BC;CAAA,UADahZ,MACb,uEADsB,EACtB;CAAA,0BACuEA,MADvE,CACMkB,KADN;CAAA,UACMA,KADN,8BACc,KADd;CAAA,0BACuElB,MADvE,CACqBc,KADrB;CAAA,UACqBA,KADrB,8BAC6B,EAD7B;CAAA,6BACuEd,MADvE,CACiCwZ,QADjC;CAAA,UACiCA,QADjC,iCAC4C,MAD5C;CAAA,6BACuExZ,MADvE,CACoDyZ,QADpD;CAAA,UACoDA,QADpD,iCAC+D,IAD/D;CAGC,UAAIC,QAAQ,GAAG;CACd5Y,QAAAA,KAAK,EAALA,KADc;CAEd6Y,QAAAA,UAAU,EAAE;CAFE,OAAf;;CAIA,UAAIF,QAAJ,EACA;CACCC,QAAAA,QAAQ,CAACD,QAAT,GAAoB,EAApB;CACA;;CAEDtX,MAAAA,GAAG,CAAC4H,IAAJ,CAAS,eAAT,EAA0B;CACzB5I,QAAAA,IAAI,EAAE,kBADmB;CAEzByY,QAAAA,aAAa,EAAE,gBAFU;CAGzBC,QAAAA,UAAU,EAAE,8CAA4CnX,EAAE,CAAC8K,mBAAH,CAAuBG,GAAvB,CAA2B,2BAA3B,EAAwD,OAAxD,CAH/B;CAIzB3N,QAAAA,MAAM,EAAE;CACP,uBAAa,KAAKC,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EADN;CAEP,6BAAmB,KAAKhP,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,GAA4C+H,OAFxD;CAGP,qBAAW,KAAK7Z,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAHJ;CAIP,uBAAa4G,QAJN;CAKP,mBAAStY,KALF;CAMP,yBAAe;CANR,SAJiB;CAYzB6Y,QAAAA,UAAU,EAAE;CAAC5Y,UAAAA,IAAI,EAAE,MAAP;CAAeuY,UAAAA,QAAQ,EAARA;CAAf;CAZa,OAA1B,EAaG,KAbH;CAcA;CAt2BF;CAAA;CAAA,mCAy2BC;CAAA;;CACCtH,MAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,wBAA/B,EAAyD,EAAzD;CAEA,UAAI2G,QAAQ,GAAG,KAAKhZ,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,WAAnC,EAAgD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAhD,EAA2F,IAA3F,CAAf;;CAEA,UACCgK,QAAQ,CAACe,MAAT,CAAgBC,cAAhB,IACGhB,QAAQ,CAACe,MAAT,CAAgBE,SADnB,IAEGjB,QAAQ,CAACe,MAAT,CAAgBG,aAFnB,IAGGlB,QAAQ,CAACe,MAAT,CAAgBI,UAJpB,EAMA;CACCC,QAAAA,YAAY,CACVrL,MADF,CACS,yBAAuB,KAAK/O,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EADhC,EAEEqL,QAFF,CAEW,CACTC,gBAAgB,CAACvL,MAAjB,CAAwB,OAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,+BAAjB,CADX,CADS,EAITgC,gBAAgB,CAACvL,MAAjB,CAAwB,gBAAxB,EACEwL,QADF,CACWvB,QAAQ,CAACe,MAAT,CAAgBC,cAD3B,EAEEQ,WAFF,CAEc,KAAKlC,WAAL,CAAiB,yBAAjB,CAFd,EAGElD,IAHF,CAGO,CAAC4D,QAAQ,CAACe,MAAT,CAAgBC,cAHxB,CAJS,EASTM,gBAAgB,CAACvL,MAAjB,CAAwB,WAAxB,EACEwL,QADF,CACWvB,QAAQ,CAACe,MAAT,CAAgBE,SAD3B,EAEEO,WAFF,CAEc,KAAKlC,WAAL,CAAiB,uBAAjB,CAFd,EAGElD,IAHF,CAGO,CAAC4D,QAAQ,CAACe,MAAT,CAAgBE,SAHxB,CATS,EAcTK,gBAAgB,CAACvL,MAAjB,CAAwB,eAAxB,EACEwL,QADF,CACWvB,QAAQ,CAACe,MAAT,CAAgBG,aAD3B,EAEEM,WAFF,CAEc,KAAKlC,WAAL,CAAiB,wBAAjB,CAFd,EAGElD,IAHF,CAGO,CAAC4D,QAAQ,CAACe,MAAT,CAAgBG,aAHxB,CAdS,EAmBTI,gBAAgB,CAACvL,MAAjB,CAAwB,YAAxB,EACEwL,QADF,CACWvB,QAAQ,CAACe,MAAT,CAAgBI,UAD3B,EAEEK,WAFF,CAEc,KAAKlC,WAAL,CAAiB,wBAAjB,CAFd,EAGElD,IAHF,CAGO,CAAC4D,QAAQ,CAACe,MAAT,CAAgBI,UAHxB,CAnBS,CAFX,EA2BEM,UA3BF,CA2BahY,EAAE,CAAC8K,mBAAH,CAAuBG,GAAvB,CAA2B,8BAA3B,EAA2D,OAA3D,CA3Bb,EA4BEgN,gBA5BF,CA4BmB,UAACxZ,IAAD,EAAOnB,MAAP,EAAe8E,IAAf,EAAqB2U,QAArB,EAClB;CACC,cAAItY,IAAI,KAAK,UAAb,EACA;CACC,mBAAO,KAAP;CACA;;CAED,cAAInB,MAAM,CAACyB,EAAP,KAAc,OAAlB,EACA;CACCf,YAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,cAAnC,EAAmD;CAClDvN,cAAAA,MAAM,EAAE,OAAI,CAAC5F,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD0C;CAElDsK,cAAAA,KAAK,EAAE,KAF2C;CAGlDN,cAAAA,QAAQ,kCAAInU,IAAI,CAACrD,EAAT,EAAcqD,IAAd;CAH0C,aAAnD,EAIG,OAJH;CAKA,WAPD,MAQK,IAAI9E,MAAM,CAACyB,EAAP,KAAc,YAAlB,EACL;CACCiB,YAAAA,EAAE,CAACkY,WAAH,CAAeC,OAAf,CAAuB/V,IAAI,CAACkV,MAAL,CAAYha,MAAM,CAACyB,EAAnB,CAAvB,EAA+C;CAACkJ,cAAAA,UAAU,EAAE;CAAb,aAA/C;CACA,WAHI,MAKL;CACCjI,YAAAA,EAAE,CAACkY,WAAH,CAAeC,OAAf,CAAuB/V,IAAI,CAACkV,MAAL,CAAYha,MAAM,CAACyB,EAAnB,CAAvB,EAA+C;CAACkJ,cAAAA,UAAU,EAAE;CAAb,aAA/C,EADD;CAIC;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACD,SArFF,EAsFEmQ,eAtFF,CAsFkB7B,QAtFlB,EAuFExO,IAvFF;CAyFA,OAhGD,MAkGA;CACC/J,QAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,cAAnC,EAAmD;CAClDvN,UAAAA,MAAM,EAAE,KAAK5F,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD0C;CAElDsK,UAAAA,KAAK,EAAE,KAF2C;CAGlDN,UAAAA,QAAQ,kCAAI,KAAKhZ,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAJ,EAAgDgK,QAAhD;CAH0C,SAAnD,EAIG,OAJH;CAKA;CACD;CAv9BF;CAAA;CAAA,gCA09BC;CAAA;;CAAA,UADU8B,OACV,uEADoB,KACpB;;CACC,UAAI,CAACA,OAAL,EACA;CACC5Y,QAAAA,GAAG,CAAC4Y,OAAJ,CAAY;CACXja,UAAAA,KAAK,EAAE,KAAKyX,WAAL,CAAiB,kCAAjB,CADI;CAEXxX,UAAAA,IAAI,EAAE,EAFK;CAGXia,UAAAA,OAAO,EAAE,CACR,KAAKzC,WAAL,CAAiB,8BAAjB,CADQ,EAER,KAAKA,WAAL,CAAiB,6BAAjB,CAFQ,CAHE;CAOXvI,UAAAA,QAAQ,EAAE,kBAACiL,MAAD,EACV;CACC,gBAAIA,MAAM,KAAK,CAAf,EACA;CACC,cAAA,OAAI,CAACC,SAAL,CAAe,IAAf;CACA;CACD;CAbU,SAAZ;CAgBA,eAAO,IAAP;CACA;;CAED,UAAIxZ,QAAQ,GAAG,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAf;CAEA,WAAKhP,UAAL,CAAgByK,UAAhB,CAA2BC,UAA3B,CAAsCC,mBAAU,CAACuQ,WAAjD,EAA8D;CAAC7M,QAAAA,SAAS,EAAE5M;CAAZ,OAA9D,EAAqF,IAArF,EAA2F,IAA3F,EAAiG0D,kBAAK,CAACmQ,oBAAN,CAA2B;CAC3HpU,QAAAA,IAAI,EAAEyJ,mBAAU,CAACuQ,WAD0G;CAE3Hhb,QAAAA,MAAM,EAAE,KAAKF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,CAA0CrQ,QAA1C;CAFmH,OAA3B,CAAjG,EAGIkL,IAHJ,CAGS,UAAA6H,QAAQ,EAAI;CACpBtS,QAAAA,GAAG,CAACC,eAAJ;CACA,OALD;CAMA;CAx/BF;CAAA;CAAA,wCA2/BC;CACC,UAAIgZ,SAAS,GAAG,KAAKC,wBAAL,EAAhB;CAEAlZ,MAAAA,GAAG,CAAC4H,IAAJ,CAAS,eAAT,EAA0B;CACzB5I,QAAAA,IAAI,EAAE,kBADmB;CAEzByY,QAAAA,aAAa,EAAE,uBAFU;CAGzBC,QAAAA,UAAU,EAAE,kDAAgDnX,EAAE,CAAC8K,mBAAH,CAAuBG,GAAvB,CAA2B,gCAA3B,EAA6D,OAA7D,CAHnC;CAIzB3N,QAAAA,MAAM,EAAE;CACP,uBAAa,KAAKC,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EADN;CAEP,qBAAW,KAAKhP,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAFJ;CAIP,wBAAcwI,SAJP;CAKP,8BAAoB,EALb;CAMP,uBAAa,EANN;CAQP,6BAAmB1Y,EAAE,CAAC8K,mBAAH,CAAuBG,GAAvB,CAA2B,uBAA3B,EAAoD,CAApD;CARZ,SAJiB;CAczBoM,QAAAA,UAAU,EAAE;CACX5Y,UAAAA,IAAI,EAAE,iBADK;CAEXuY,UAAAA,QAAQ,EAAE;CACTC,YAAAA,UAAU,EAAE,2BADH;CAET7Y,YAAAA,KAAK,EAAE4B,EAAE,CAACzB,OAAH,CAAW,6BAAX,CAFE;CAGTiT,YAAAA,KAAK,EAAE,GAHE;CAIT/B,YAAAA,KAAK,EAAEiJ,SAAS,CAAC9D,GAAV,CAAc,UAAAgE,OAAO;CAAA,qBAAIC,iBAAiB,CAACC,oBAAlB,CAAuCF,OAAvC,CAAJ;CAAA,aAArB,CAJE;CAKTG,YAAAA,MAAM,EAAE,CACP;CAAE3a,cAAAA,KAAK,EAAE4B,EAAE,CAACzB,OAAH,CAAW,oBAAX,CAAT;CAA2CQ,cAAAA,EAAE,EAAE;CAA/C,aADO,EAEP;CAAEX,cAAAA,KAAK,EAAE4B,EAAE,CAACzB,OAAH,CAAW,0BAAX,CAAT;CAAiDQ,cAAAA,EAAE,EAAE;CAArD,aAFO,CALC;CASTgY,YAAAA,QAAQ,EAAE;CAACiC,cAAAA,SAAS,EAAE;CAAZ;CATD;CAFC;CAda,OAA1B,EA4BG,KA5BH;CA6BA;CA3hCF;CAAA;CAAA,+CA8hCC;CACC,UAAIvJ,KAAK,GAAG,EAAZ;CACA,UAAIwJ,UAAU,GAAG,EAAjB;;CAEA,UAAI,KAAKjJ,WAAL,CAAiBkJ,UAAjB,CAA4BzV,MAA5B,GAAqC,CAAzC,EACA;CACC,aAAKuM,WAAL,CAAiBkJ,UAAjB,CAA4BtE,GAA5B,CAAgC,UAAAgE,OAAO,EACvC;CACC,cAAI,CAACA,OAAD,IAAYK,UAAU,CAACL,OAAO,CAAC7Z,EAAT,CAA1B,EACA;CACC,mBAAO,KAAP;CACA;;CACD,cAAI6Z,OAAO,CAAC7V,IAAR,KAAiB,MAArB,EACA;CACC0M,YAAAA,KAAK,CAAC7N,IAAN,CAAWgX,OAAO,CAACxW,IAAnB;CACA6W,YAAAA,UAAU,CAACL,OAAO,CAAC7Z,EAAT,CAAV,GAAyB,IAAzB;CACA;;CAED,iBAAO,IAAP;CACA,SAbD;CAcA;;CAED,WAAKiR,WAAL,CAAiBmJ,cAAjB,CAAgCvE,GAAhC,CAAoC,UAAAgE,OAAO,EAC3C;CACC,YAAI,CAACA,OAAD,IAAYK,UAAU,CAACL,OAAO,CAAC7Z,EAAT,CAA1B,EACA;CACC,iBAAO,KAAP;CACA;;CACD0Q,QAAAA,KAAK,CAAC7N,IAAN,CAAWgX,OAAX;CACAK,QAAAA,UAAU,CAACL,OAAO,CAAC7Z,EAAT,CAAV,GAAyB,IAAzB;CACA,OARD;CAUA,WAAKiR,WAAL,CAAiBoJ,cAAjB,CAAgCxE,GAAhC,CAAoC,UAAAgE,OAAO,EAC3C;CACC,YAAI,CAACA,OAAD,IAAYK,UAAU,CAACL,OAAO,CAAC7Z,EAAT,CAA1B,EACA;CACC,iBAAO,KAAP;CACA;;CAED,YAAI,CAAC6Z,OAAL,EACA;CACC,iBAAO,KAAP;CACA;;CACD,YAAIA,OAAO,CAAC7V,IAAR,KAAiB,MAArB,EACA;CACC0M,UAAAA,KAAK,CAAC7N,IAAN,CAAWgX,OAAO,CAACxW,IAAnB;CACA6W,UAAAA,UAAU,CAACL,OAAO,CAAC7Z,EAAT,CAAV,GAAyB,IAAzB;CACA;;CAED,eAAO,IAAP;CACA,OAlBD;CAoBA;;;;;;;;;CASA,aAAO0Q,KAAP;CACA;CA5lCF;CAAA;;CA8lCA;;CAEA;CAhmCA,0CAkmCuB7Q,IAlmCvB,EAmmCC;CACC,UAAIA,IAAI,CAACmE,IAAL,KAAc,kBAAd,IAAoCnE,IAAI,CAACya,OAAzC,IAAoDza,IAAI,CAACya,OAAL,CAAa/Z,MAArE,EACA;CACE,YACC,OAAOV,IAAI,CAACya,OAAL,CAAa/Z,MAAb,CAAoBga,OAA3B,KAAuC,WAAvC,IACE,OAAO1a,IAAI,CAACya,OAAL,CAAara,QAApB,KAAiC,WAFpC,EAIA;CACChB,UAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,6BAAnC,EAAkE,CAAC;CAClE1R,YAAAA,QAAQ,EAAEJ,IAAI,CAACya,OAAL,CAAara,QAD2C;CAElEsa,YAAAA,OAAO,EAAE1a,IAAI,CAACya,OAAL,CAAa/Z,MAAb,CAAoBga;CAFqC,WAAD,EAGhE,IAHgE,CAAlE,EAGS,WAHT;CAIA;CACF,OAZD,MAaK,IAAI1a,IAAI,CAACmE,IAAL,KAAc,eAAlB,EACL;CACCnE,QAAAA,IAAI,CAACya,OAAL,CAAaE,OAAb,CAAqB,UAAC9b,MAAD,EAAY;CAChCO,UAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,6BAAnC,EAAkE,CAAC;CACjE1R,YAAAA,QAAQ,EAAEvB,MAAM,CAACuB,QADgD;CAEjEsa,YAAAA,OAAO,EAAE7b,MAAM,CAAC6b;CAFiD,WAAD,EAG/D,IAH+D,CAAlE,EAGU,WAHV;CAIA,SALD;CAMA;CACD;CA1nCF;CAAA;CAAA,2CA4nCwB1a,IA5nCxB,EA6nCC;CAAA;;CACC,UAAIA,IAAI,CAAC2O,MAAL,KAAgBU,6BAAU,CAACuL,UAAX,CAAsBjJ,MAA1C,EACA;CACC,YAAI,KAAKkJ,kBAAT,EACA;CACC,eAAKlc,UAAL,CAAgBkV,eAAhB,CAAgCC,MAAhC,CAAuCC,IAAvC,GAA8C,IAA9C;CAEA,eAAK7N,eAAL,GAAuBoF,IAAvB,CAA4B,YAAM;CACjC,YAAA,OAAI,CAAC3M,UAAL,CAAgBkV,eAAhB,CAAgCC,MAAhC,CAAuCC,IAAvC,GAA8C,KAA9C;;CACA,YAAA,OAAI,CAAClF,mBAAL;;CACA,YAAA,OAAI,CAAClQ,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiB8C,gBAAlD;CACA,WAJD,EAIGmN,KAJH,CAIS,YAAM;CACd,YAAA,OAAI,CAACnQ,UAAL,CAAgBkV,eAAhB,CAAgCC,MAAhC,CAAuCC,IAAvC,GAA8C,KAA9C;;CACA,YAAA,OAAI,CAAClF,mBAAL;CACA,WAPD;CASA,eAAKgM,kBAAL,GAA0B,KAA1B;CACA,SAdD,MAgBA;CACC,eAAKvT,WAAL;CACA,eAAKuH,mBAAL;CACA;CACD,OAtBD,MAuBK,IAAI7O,IAAI,CAAC2O,MAAL,KAAgBU,6BAAU,CAACuL,UAAX,CAAsBE,OAA1C,EACL;CACC,aAAKD,kBAAL,GAA0B,IAA1B;CACA;CACD;CAzpCF;CAAA;CAAA,2CA2pCwB7a,IA3pCxB,EA4pCC;CACC,UAAIA,IAAI,CAACjB,OAAL,KAAiB,MAAjB,IAA2BiB,IAAI,CAACjB,OAAL,KAAiB,YAAhD,EACA;CACC,aAAK,IAAIwF,MAAT,IAAmBvE,IAAI,CAACtB,MAAL,CAAYkB,KAA/B,EACA;CACC,cAAI,CAACI,IAAI,CAACtB,MAAL,CAAYkB,KAAZ,CAAkBmb,cAAlB,CAAiCxW,MAAjC,CAAL,EACA;CACC;CACA;;CAED,eAAK5F,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDN,YAAAA,EAAE,EAAEH,IAAI,CAACtB,MAAL,CAAYkB,KAAZ,CAAkB2E,MAAlB,EAA0BpE,EADqB;CAEnDO,YAAAA,MAAM,EAAEV,IAAI,CAACtB,MAAL,CAAYkB,KAAZ,CAAkB2E,MAAlB;CAF2C,WAApD;;CAKA,cAAIA,MAAM,CAACyK,QAAP,OAAsB,KAAKrQ,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAA1B,EACA;CACC,iBAAKzO,YAAL;CACA;CACD;CACD;CACD;CAEF;;CAnrCA;CAAA;CAAA,wCAsrCC;CAAA;;CACC,UAAIsR,UAAU,GAAG,KAAK7R,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAjB;CAEA,UAAIuK,OAAO,GAAG,KAAK/D,WAAL,CAAiB,UAAjB,CAAd;CAEA,aAAO;CACNxX,QAAAA,IAAI,EAAE+Q,UAAU,GAAEA,UAAU,CAACyK,eAAb,GAA8B,EADxC;CAENC,QAAAA,WAAW,EAAE,KAAKjE,WAAL,CAAiB,+BAAjB,CAFP;CAGNkE,QAAAA,WAAW,EAAE,EAHP;CAINC,QAAAA,cAAc,EAAC,IAJT;CAKNC,QAAAA,gBAAgB,EAAE,IALZ;CAMNC,QAAAA,iBAAiB,EACjB;CACCC,UAAAA,UAAU,EAAE,IADb;CAECC,UAAAA,GAAG,EAAER,OAAO,GAAG;CAFhB,SAPM;CAWNS,QAAAA,kBAAkB,EAClB;CACCC,UAAAA,eAAe,EAAE,GADlB;CAECC,UAAAA,gBAAgB,EAAE,GAFnB;CAGCC,UAAAA,MAAM,EACN;CACCC,YAAAA,WAAW,EAAE,CAAC,CADf;CAECC,YAAAA,YAAY,EAAE,CAAC,CAFhB;CAGCC,YAAAA,UAAU,EAAE,CAHb;CAICC,YAAAA,YAAY,EAAE,CAJf;CAKCC,YAAAA,SAAS,EAAE,CALZ;CAMCC,YAAAA,UAAU,EAAE,KANb;CAOCC,YAAAA,gBAAgB,EAAE,IAPnB;CAQCC,YAAAA,cAAc,EAAE,KARjB;CASCC,YAAAA,eAAe,EAAE;CATlB,WAJD;CAeCC,UAAAA,kBAAkB,EAAE,IAfrB;CAgBCC,UAAAA,iBAAiB,EAAE,IAhBpB;CAiBCC,UAAAA,iBAAiB,EAAC,KAjBnB;CAkBCC,UAAAA,qBAAqB,EAAE;CAlBxB,SAZM;CAgCNC,QAAAA,YAAY,EAAE;CAAC7L,UAAAA,KAAK,EACpB,CACC;CACC1Q,YAAAA,EAAE,EAAC,MADJ;CAECN,YAAAA,IAAI,EAAE,KAAKoX,WAAL,CAAiB,+BAAjB,CAFP;CAGC0F,YAAAA,UAAU,EACV;CACCC,cAAAA,QAAQ,EAAC,KADV;CAECpB,cAAAA,GAAG,EAAER,OAAO,GAAG,qEAAV,GAAgF,KAAKrc,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAFtF;CAGCuL,cAAAA,cAAc,EACd;CACCC,gBAAAA,WAAW,EAAE,IADd;CAECC,gBAAAA,SAAS,EAAE,IAFZ;CAGCC,gBAAAA,KAAK,EAAE,IAHR;CAICnd,gBAAAA,IAAI,EAAE,KAAKoX,WAAL,CAAiB,qCAAjB;CAJP;CAJD;CAJD,WADD,EAiBC;CACC9W,YAAAA,EAAE,EAAE,WADL;CAECN,YAAAA,IAAI,EAAE,KAAKoX,WAAL,CAAiB,kCAAjB;CAFP,WAjBD,EAqBC;CACC9W,YAAAA,EAAE,EAAE,QADL;CAECN,YAAAA,IAAI,EAAE,KAAKoX,WAAL,CAAiB,iCAAjB;CAFP,WArBD;CADc,SAhCR;CA2DN9O,QAAAA,MAAM,EAAE,gBAACnI,IAAD,EACR;CACC,cAAI,OAAOA,IAAP,KAAgB,QAApB,EACA;CACCA,YAAAA,IAAI,GAAG;CAACP,cAAAA,IAAI,EAAEO,IAAP;CAAaid,cAAAA,aAAa,EAAE;CAA5B,aAAP;CACA;;CAED,cAAMxd,IAAI,GAAGO,IAAI,CAACP,IAAL,CAAUuP,QAAV,GAAqBkO,IAArB,EAAb;CACA,cAAMD,aAAa,GAAGjd,IAAI,CAACid,aAAL,YAA8BlH,KAA9B,GAAqC/V,IAAI,CAACid,aAA1C,GAAyD,EAA/E;;CAEA,cAAIA,aAAa,CAACpY,MAAd,IAAwB,CAA5B,EACA;CACC,YAAA,OAAI,CAACsY,SAAL;;CACA,YAAA,OAAI,CAACC,UAAL;;CAEA,gBAAIzZ,MAAM,GAAG,OAAI,CAAChF,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,qBAAnC,EAA0D,OAAI,CAAC5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAA1D,CAAb;;CACA,gBAAIhK,MAAJ,EACA;CACC,cAAA,OAAI,CAAC0Z,aAAL,CAAmB1Z,MAAnB,EAA2BlE,IAA3B;CACA,aAHD,MAKA;CACC,cAAA,OAAI,CAACkH,UAAL,CAAgBlH,IAAhB;CACA;CACD,WAdD,MAgBA;CACCwd,YAAAA,aAAa,CAACtC,OAAd,CAAsB,UAAApU,IAAI,EAAI;CAC7B;CACA,kBAAI,OAAOA,IAAI,CAAC+W,cAAZ,KAA+B,WAAnC,EACA;CACCxM,gBAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,iBAA/B,EAAkD,EAAlD;CAEA,uBAAO,OAAI,CAACuM,UAAL,CAAgB;CACtBC,kBAAAA,MAAM,EAAE,MADc;CAEtB3d,kBAAAA,IAAI,EAAE0G,IAAI,CAAC1G,IAFW;CAGtBsE,kBAAAA,IAAI,EAAEoC,IAAI,CAACpC,IAAL,CAAU6K,QAAV,GAAqByO,WAArB,EAHgB;CAItBC,kBAAAA,OAAO,EAAE,CAACnX,IAAI,CAAC+W,cAAL,CAAoBK,GAArB,IAA4B,CAACpX,IAAI,CAAC+W,cAAL,CAAoBK,GAApB,CAAwBC,OAArD,GAA8D,IAA9D,GAAoE;CAC5EpC,oBAAAA,GAAG,EAAEjV,IAAI,CAAC+W,cAAL,CAAoBK,GAApB,CAAwBC,OAD+C;CAE5EC,oBAAAA,KAAK,EAAEtX,IAAI,CAAC+W,cAAL,CAAoBK,GAApB,CAAwBC,OAAxB,CAAgCE,KAAhC,CAAsC,gBAAtC,EAAwD,CAAxD,CAFqE;CAG5EC,oBAAAA,MAAM,EAAExX,IAAI,CAAC+W,cAAL,CAAoBK,GAApB,CAAwBC,OAAxB,CAAgCE,KAAhC,CAAsC,iBAAtC,EAAyD,CAAzD;CAHoE,mBAJvD;CAStBE,kBAAAA,UAAU,EAAEpG,QAAQ,CAACrR,IAAI,CAAC+W,cAAL,CAAoBW,EAArB;CATE,iBAAhB,CAAP;CAWA,eAjB4B;;;CAoB7B,kBAAI1X,IAAI,CAACpC,IAAL,KAAc,WAAlB,EACA;CACC2M,gBAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,kBAA/B,EAAmD,EAAnD;CAEA,uBAAO,OAAI,CAACuM,UAAL,CAAgB;CACtBC,kBAAAA,MAAM,EAAE,OADc;CAEtB3d,kBAAAA,IAAI,EAAE,kBAAiB,IAAIqe,IAAJ,EAAD,CAAWC,MAAX,GAAoBC,KAApB,CAA0B,CAA1B,EAA6B,EAA7B,EAAiCtI,OAAjC,CAAyC,GAAzC,EAA8C,GAA9C,EAAmD7G,KAAnD,CAAyD,GAAzD,EAA8DhM,IAA9D,CAAmE,GAAnE,CAAhB,GAAwF,MAFxE;CAGtBkB,kBAAAA,IAAI,EAAE,KAHgB;CAItBuZ,kBAAAA,OAAO,EAAE,IAJa;CAKtBM,kBAAAA,UAAU,EAAEzX,IAAI,CAACiV;CALK,iBAAhB,CAAP;CAOA;;CAED,kBAAI6C,QAAQ,GAAG9X,IAAI,CAAC1G,IAApB;CACA,kBAAIye,QAAQ,GAAGC,mBAAU,CAACC,OAAX,CAAmBjY,IAAI,CAAC1G,IAAxB,CAAf;;CAEA,kBAAIye,QAAQ,KAAK3I,iBAAQ,CAACsC,KAA1B,EACA;CACCnH,gBAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,kBAA/B,EAAmD,EAAnD;CACA,eAHD,MAIK,IAAIsN,QAAQ,KAAK3I,iBAAQ,CAACC,KAA1B,EACL;CACC9E,gBAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,kBAA/B,EAAmD,EAAnD;CACA,eAHI,MAKL;CACCF,gBAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,kBAA/B,EAAmD,EAAnD;CACA;;CAED,kBACCsN,QAAQ,KAAK3I,iBAAQ,CAACC,KAAtB,IACG0I,QAAQ,KAAK3I,iBAAQ,CAACsC,KAF1B,EAIA;CACC,oBAAIwG,SAAS,GAAGlY,IAAI,CAAC1G,IAAL,CAAUoP,KAAV,CAAgB,GAAhB,EAAqBmP,KAArB,CAA2B,CAAC,CAA5B,EAA+B,CAA/B,EAAkCX,WAAlC,EAAhB;;CACA,oBAAIlX,IAAI,CAACpC,IAAL,KAAc,YAAlB,EACA;CACCsa,kBAAAA,SAAS,GAAG,KAAZ;CACA;;CACDJ,gBAAAA,QAAQ,GAAG,iBAAgB,IAAIH,IAAJ,EAAD,CAAWC,MAAX,GAAoBC,KAApB,CAA0B,CAA1B,EAA6B,EAA7B,EAAiCtI,OAAjC,CAAyC,GAAzC,EAA8C,GAA9C,EAAmD7G,KAAnD,CAAyD,GAAzD,EAA8DhM,IAA9D,CAAmE,GAAnE,CAAf,GAAuF,GAAvF,GAA2Fwb,SAAtG;CACA,eA5D4B;;;CA+D7B,qBAAO,OAAI,CAAClB,UAAL,CAAgB;CACtBC,gBAAAA,MAAM,EAAE,SADc;CAEtB3d,gBAAAA,IAAI,EAAEwe,QAFgB;CAGtBla,gBAAAA,IAAI,EAAEoC,IAAI,CAACpC,IAAL,CAAU6K,QAAV,GAAqByO,WAArB,EAHgB;CAItBC,gBAAAA,OAAO,EAAE,CAACnX,IAAI,CAACmY,UAAN,GAAkB,IAAlB,GAAwB;CAChClD,kBAAAA,GAAG,EAAEjV,IAAI,CAACmY,UADsB;CAEhCb,kBAAAA,KAAK,EAAEtX,IAAI,CAACoY,YAFoB;CAGhCZ,kBAAAA,MAAM,EAAExX,IAAI,CAACqY;CAHmB,iBAJX;CAStBZ,gBAAAA,UAAU,EAAEzX,IAAI,CAACiV;CATK,eAAhB,CAAP;CAWA,aA1ED;CA2EA;CAED,SAnKK;CAoKN9M,QAAAA,QAAQ,EAAE,kBAAC1O,IAAD,EACV;CACC8J,UAAAA,OAAO,CAACqC,GAAR,CAAY,oBAAZ,EAAkCnM,IAAlC;;CACA,cAAI,CAACA,IAAI,CAAC6F,KAAV,EACA;CACC,mBAAO,KAAP;CACA;;CACD,cAAI7F,IAAI,CAAC6F,KAAL,KAAe,YAAnB,EACA;CACC,gBAAIpG,IAAI,GAAGO,IAAI,CAACP,IAAL,CAAUuP,QAAV,EAAX;;CACA,gBAAIvP,IAAI,CAACyd,IAAL,GAAYrY,MAAZ,GAAqB,CAAzB,EACA;CACC,cAAA,OAAI,CAAClG,UAAL,CAAgB6C,WAAhB,CAA4Bqd,YAA5B;CACA;;CAED,gBAAIpf,IAAI,CAACoF,MAAL,KAAgB,CAApB,EACA;CACC,cAAA,OAAI,CAAClG,UAAL,CAAgB6C,WAAhB,CAA4BsM,kBAA5B,CAA+C;CAACnO,gBAAAA,OAAO,EAAE;CAAV,eAA/C;;CACA,cAAA,OAAI,CAAChB,UAAL,CAAgB6C,WAAhB,CAA4Bsd,WAA5B;CACA,aAJD,MAMA;CACC,cAAA,OAAI,CAAChR,kBAAL,CAAwB;CAACnO,gBAAAA,OAAO,EAAEF;CAAV,eAAxB;CACA;CACD,WAjBD,MAkBK,IAAIO,IAAI,CAAC6F,KAAL,KAAe,eAAnB,EACL;CACC,YAAA,OAAI,CAAClH,UAAL,CAAgBogB,UAAhB;CACA,WAHI,MAIA,IAAIC,WAAW,CAACC,WAAZ,OAA8B,SAAlC,EACL;CACC,gBAAIjf,IAAI,CAAC6F,KAAL,KAAe,UAAnB,EACA;CACC,kBAAI/B,kBAAK,CAACob,QAAN,CAAeC,KAAf,MAA0Brb,kBAAK,CAACob,QAAN,CAAeE,aAAf,KAAiC,EAA/D,EACA;CACC,gBAAA,OAAI,CAACzgB,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiByJ,cAAlD,EAAkE;CAACC,kBAAAA,QAAQ,EAAE,GAAX;CAAgBC,kBAAAA,oBAAoB,EAAE;CAAtC,iBAAlE;CACA;CACD,aAND,MAOK,IAAIxI,IAAI,CAAC6F,KAAL,KAAe,aAAnB,EACL;CAGA;CACD;CA/MK,OAAP;CAiNA;CAEF;;CA94CA;CAAA;CAAA,+BAg5CYpG,IAh5CZ,EAi5CC;CAAA;;CAAA,UADiB8G,IACjB,uEADwB,IACxB;;CACC,UAAI,CAAC9G,IAAD,IAAS,CAAC8G,IAAd,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI8Y,OAAO,GAAG,KAAK1gB,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,sBAAnC,EAA2D,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAA3D,CAAd;;CACA,UAAI0R,OAAJ,EACA;CACC,YAAI1X,YAAY,GAAG,KAAKhJ,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,qBAAnC,EAA0D,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAA1D,EAAmGyL,OAAnG,CAAnB;;CACA,YAAI1X,YAAJ,EACA;CACC,cAAInE,IAAI,GAAG,IAAX;;CACA,cAAImE,YAAY,CAAClE,QAAjB,EACA;CACCD,YAAAA,IAAI,GAAG,KAAK7E,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,WAAnC,EAAgDoE,YAAY,CAAClE,QAA7D,CAAP;CACA;;CAED,cAAIC,KAAK,GAAG,KAAK/E,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,eAAnC,EAAoD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAApD,CAAZ;CAEA,cAAIjU,OAAO,GAAG,EAAd;CACAA,UAAAA,OAAO,CAACqD,IAAR,CAAa,IAAIsc,MAAJ,CAAW,EAAX,CAAb;CACA3f,UAAAA,OAAO,CAACqD,IAAR,CAAa,CAACQ,IAAI,IAAIA,IAAI,CAAC3D,IAAb,GAAmB2D,IAAI,CAAC3D,IAAxB,GAA8B,KAAKoX,WAAL,CAAiB,4BAAjB,CAA/B,IAA+E,IAA/E,GAAoFnT,kBAAK,CAACyb,IAAN,CAAWC,MAAX,CAAkB7X,YAAY,CAAC4X,IAA/B,EAAqC,IAArC,EAA2C,KAAKtI,WAAL,EAA3C,CAApF,GAAmJ,GAAhK;CACAtX,UAAAA,OAAO,CAACqD,IAAR,CAAac,kBAAK,CAACrE,IAAN,CAAWggB,KAAX,CAAiB9X,YAAY,CAAClI,IAA9B,EAAoCkI,YAAY,CAACjJ,MAAjD,EAAyDgF,KAAzD,EAAgE,KAAKuT,WAAL,EAAhE,CAAb;CACAtX,UAAAA,OAAO,CAACqD,IAAR,CAAa,IAAIsc,MAAJ,CAAW,EAAX,CAAb;CACA3f,UAAAA,OAAO,CAACqD,IAAR,CAAavD,IAAb;CACAA,UAAAA,IAAI,GAAGE,OAAO,CAACsD,IAAR,CAAa,IAAb,CAAP;CAEA,eAAK2G,iBAAL;CACA;CACD;;CAEDE,MAAAA,OAAO,CAAClD,IAAR,CAAa,YAAb,EAA2BnH,IAA3B,EAAiC8G,IAAjC;;CAEA,UAAI,CAAC,KAAK5H,UAAL,CAAgB6C,WAAhB,CAA4Bke,sBAA5B,EAAL,EACA;CACC,aAAKC,WAAL,CAAiB;CAACxf,UAAAA,EAAE,EAAE,CAAL;CAAQD,UAAAA,MAAM,EAAE,KAAKvB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAAhB;CAAyDxT,UAAAA,QAAQ,EAAE,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAnE;CAA8GlO,UAAAA,IAAI,EAAJA,IAA9G;CAAoH8G,UAAAA,IAAI,EAAJA;CAApH,SAAjB;CACA,aAAKsI,mBAAL;CAEA,eAAO,IAAP;CACA;;CAED,WAAKlQ,UAAL,CAAgBoO,QAAhB,GAA2B9M,MAA3B,CAAkC,sCAAlC;CAEA,UAAIvB,MAAM,GAAG,EAAb;;CACA,UAAI6H,IAAJ,EACA;CACC7H,QAAAA,MAAM,CAACkhB,OAAP,GAAiB,CAACrZ,IAAI,CAACpG,EAAN,CAAjB;CACA;;CAED,WAAKxB,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDP,QAAAA,MAAM,EAAE,KAAKvB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAD2C;CAEnDnQ,QAAAA,QAAQ,EAAE,KAAK9E,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAFyC;CAGnD7R,QAAAA,IAAI,EAAEA,IAH6C;CAInDf,QAAAA,MAAM,EAANA,MAJmD;CAKnDmhB,QAAAA,OAAO,EAAE,CAACtZ;CALyC,OAApD,EAMG+E,IANH,CAMQ,UAAA1J,SAAS,EAAI;CAEpB,QAAA,OAAI,CAACC,aAAL,CAAmBmB,IAAnB,CAAwB;CACvB7C,UAAAA,EAAE,EAAEyB,SADmB;CAEvB1B,UAAAA,MAAM,EAAE,OAAI,CAACvB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAFe;CAGvBxT,UAAAA,QAAQ,EAAE,OAAI,CAACzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAHa;CAIvBlO,UAAAA,IAAI,EAAJA,IAJuB;CAKvB8G,UAAAA,IAAI,EAAJA,IALuB;CAMvBsZ,UAAAA,OAAO,EAAE;CANc,SAAxB;;CASA,YAAI,OAAI,CAAClhB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAAJ,EACA;CACC,UAAA,OAAI,CAAC/E,mBAAL;CACA,SAHD,MAKA;CACC,UAAA,OAAI,CAACkD,WAAL;CACA;CAED,OA1BD;CA4BA,aAAO,IAAP;CACA;CAh+CF;CAAA;CAAA,+BAk+CYxL,IAl+CZ,EAm+CC;CAAA;;CAAA,UADiB9G,IACjB,uEADwB,EACxB;;CACC,UAAI,CAAC8G,IAAL,EACA;CACC,eAAO,KAAP;CACA;;CAEDuD,MAAAA,OAAO,CAAClD,IAAR,CAAa,SAAb,EAAwBL,IAAxB,EAA8B9G,IAA9B;;CAEA,UAAI,CAAC,KAAKd,UAAL,CAAgB6C,WAAhB,CAA4Bke,sBAA5B,EAAL,EACA;CACC,aAAK/Y,UAAL,CAAgBlH,IAAhB,EAAsB;CAACU,UAAAA,EAAE,EAAE,CAAL;CAAQqd,UAAAA,MAAM,EAAEjX;CAAhB,SAAtB;CACA,eAAO,IAAP;CACA;;CAED,WAAK5H,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,WAApC,EAAiD,KAAK9B,UAAL,CAAgB6C,WAAhB,CAA4Bse,sBAA5B,CAAmD;CACnG5f,QAAAA,MAAM,EAAE,KAAKvB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAD2F;CAEnGnQ,QAAAA,QAAQ,EAAE,KAAK9E,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAFyF;CAGnGzR,QAAAA,IAAI,EAAE0G,IAAI,CAAC1G,IAHwF;CAInGsE,QAAAA,IAAI,EAAEoa,mBAAU,CAACC,OAAX,CAAmBjY,IAAI,CAAC1G,IAAxB,CAJ6F;CAKnG4e,QAAAA,SAAS,EAAElY,IAAI,CAAC1G,IAAL,CAAUoP,KAAV,CAAgB,GAAhB,EAAqB8Q,MAArB,CAA4B,CAAC,CAA7B,EAAgC,CAAhC,CALwF;CAMnGxP,QAAAA,IAAI,EAAE,CAN6F;CAOnGqF,QAAAA,KAAK,EAAE,CAACrP,IAAI,CAACmX,OAAN,GAAe,KAAf,GAAsB;CAC5BG,UAAAA,KAAK,EAAEtX,IAAI,CAACmX,OAAL,CAAaG,KADQ;CAE5BE,UAAAA,MAAM,EAAExX,IAAI,CAACmX,OAAL,CAAaK;CAFO,SAPsE;CAWnGpP,QAAAA,MAAM,EAAEpI,IAAI,CAACiX,MAAL,KAAgB,MAAhB,GAAwB7I,mBAAU,CAACC,IAAnC,GAAyCD,mBAAU,CAACI,MAXuC;CAYnGzE,QAAAA,QAAQ,EAAE,CAZyF;CAanG0P,QAAAA,UAAU,EAAE,KAAKrhB,UAAL,CAAgB6C,WAAhB,CAA4Bye,cAA5B,GAA6CpgB,IAb0C;CAcnGoV,QAAAA,UAAU,EAAE,CAAC1O,IAAI,CAACmX,OAAN,GAAe,EAAf,GAAmBnX,IAAI,CAACmX,OAAL,CAAalC;CAduD,OAAnD,CAAjD,EAeIlQ,IAfJ,CAeS,UAAA+E,MAAM;CAAA,eAAI,OAAI,CAAC1J,UAAL,CAAgBlH,IAAhB;CAAuBU,UAAAA,EAAE,EAAEkQ;CAA3B,WAAsC9J,IAAtC,EAAJ;CAAA,OAff;CAiBA,aAAO,IAAP;CACA;CAngDF;CAAA;CAAA,qCAqgDkB8J,MArgDlB,EAsgDC;CAAA;;CACC,UAAI2J,OAAO,GAAG,KAAKnY,aAAL,CAAmBqe,IAAnB,CAAwB,UAAAlG,OAAO;CAAA,eAAIA,OAAO,CAACzT,IAAR,IAAgByT,OAAO,CAACzT,IAAR,CAAapG,EAAb,KAAoBkQ,MAAxC;CAAA,OAA/B,CAAd;;CACA,UAAI2J,OAAJ,EACA;CACC5Y,QAAAA,EAAE,CAAC4O,oBAAH,CAAwBmQ,WAAxB,CAAoC,CAAC,aAAW9P,MAAZ,CAApC;CAEA,aAAK1R,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,iBAApC,EAAuD;CACtDP,UAAAA,MAAM,EAAE8Z,OAAO,CAAC9Z,MADsC;CAEtDC,UAAAA,EAAE,EAAE6Z,OAAO,CAAC7Z;CAF0C,SAAvD,EAGGmL,IAHH,CAGQ,YAAM;CACb,UAAA,OAAI,CAAC3M,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDP,YAAAA,MAAM,EAAE8Z,OAAO,CAAC9Z,MADmC;CAEnDC,YAAAA,EAAE,EAAE6Z,OAAO,CAACzT,IAAR,CAAapG;CAFkC,WAApD;;CAIA,UAAA,OAAI,CAAC0B,aAAL,GAAqB,OAAI,CAACA,aAAL,CAAmBC,MAAnB,CAA0B,UAAAC,EAAE;CAAA,mBAAIA,EAAE,CAAC5B,EAAH,KAAU6Z,OAAO,CAAC7Z,EAAtB;CAAA,WAA5B,CAArB;CACA,SATD;CAUA;CACD;CAvhDF;CAAA;CAAA,oCAyhDiBkQ,MAzhDjB,EA0hDC;CAAA;;CACC,UAAI2J,OAAO,GAAG,KAAKnY,aAAL,CAAmBqe,IAAnB,CAAwB,UAAAlG,OAAO;CAAA,eAAIA,OAAO,CAACzT,IAAR,IAAgByT,OAAO,CAACzT,IAAR,CAAapG,EAAb,KAAoBkQ,MAAxC;CAAA,OAA/B,CAAd;;CACA,UAAI,CAAC2J,OAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,WAAKrb,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,sBAApC,EAA4D;CAC3DP,QAAAA,MAAM,EAAE8Z,OAAO,CAAC9Z,MAD2C;CAE3DC,QAAAA,EAAE,EAAE6Z,OAAO,CAAC7Z;CAF+C,OAA5D,EAGGmL,IAHH,CAGQ,YAAM;CACb,QAAA,OAAI,CAAC3M,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDP,UAAAA,MAAM,EAAE8Z,OAAO,CAAC9Z,MADmC;CAEnDC,UAAAA,EAAE,EAAE6Z,OAAO,CAACzT,IAAR,CAAapG,EAFkC;CAGnDO,UAAAA,MAAM,EAAE;CACPiO,YAAAA,MAAM,EAAEgG,mBAAU,CAACI,MADZ;CAEPzE,YAAAA,QAAQ,EAAE;CAFH;CAH2C,SAApD;CAQA,OAZD;CAcA0J,MAAAA,OAAO,CAAC6F,OAAR,GAAkB,KAAlB;CACA,WAAKhR,mBAAL;CAEA,aAAO,IAAP;CACA;CAnjDF;CAAA;CAAA,0CAsjDC;CAAA;;CACC,WAAKhN,aAAL,CAAmBC,MAAnB,CAA0B,UAAAkY,OAAO;CAAA,eAAI,CAACA,OAAO,CAAC6F,OAAb;CAAA,OAAjC,EAAuDlF,OAAvD,CAA+D,UAAAX,OAAO,EACtE;CACCA,QAAAA,OAAO,CAAC6F,OAAR,GAAkB,IAAlB;;CAEA,YAAI7F,OAAO,CAACzT,IAAZ,EACA;CACC,cAAIyT,OAAO,CAACzT,IAAR,CAAaiX,MAAb,KAAwB,MAA5B,EACA;CACC,YAAA,OAAI,CAAC4C,UAAL,CAAgB;CACflgB,cAAAA,MAAM,EAAE8Z,OAAO,CAAC9Z,MADD;CAEfE,cAAAA,QAAQ,EAAE4Z,OAAO,CAAC5Z,QAFH;CAGfigB,cAAAA,MAAM,EAAErG,OAAO,CAACzT,IAAR,CAAayX,UAHN;CAIfsC,cAAAA,WAAW,EAAEtG,OAAO,CAACva,IAJN;CAKfmC,cAAAA,SAAS,EAAEoY,OAAO,CAAC7Z,EALJ;CAMfkQ,cAAAA,MAAM,EAAE2J,OAAO,CAACzT,IAAR,CAAapG,EANN;CAOfme,cAAAA,QAAQ,EAAEC,mBAAU,CAACC,OAAX,CAAmBxE,OAAO,CAACzT,IAAR,CAAa1G,IAAhC;CAPK,aAAhB,EAQGma,OARH;CASA,WAXD,MAaA;CACC,gBAAI,OAAI,CAACrb,UAAL,CAAgB6C,WAAhB,CAA4B+e,eAA5B,EAAJ,EACA;CACC,cAAA,OAAI,CAACC,mBAAL,CAAyBxG,OAAzB;CACA,aAHD,MAKA;CACCA,cAAAA,OAAO,CAAC6F,OAAR,GAAkB,KAAlB;;CACA,cAAA,OAAI,CAACY,mBAAL;CACA;CACD;CACD,SA1BD,MA4BA;CACCzG,UAAAA,OAAO,CAAC6F,OAAR,GAAkB,IAAlB;;CACA,UAAA,OAAI,CAACF,WAAL,CAAiB3F,OAAjB;CACA;CACD,OApCD;CAsCA,aAAO,IAAP;CACA;CA9lDF;CAAA;CAAA,8CAimDC;CACC,WAAKrb,UAAL,CAAgB6C,WAAhB,CAA4Bkf,kBAA5B,CAA+C,KAAK/hB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAA/C,EAAwF,IAAxF;CACA,aAAO,IAAP;CACA;CApmDF;CAAA;CAAA,gCAsmDajU,OAtmDb,EAumDC;CACCA,MAAAA,OAAO,CAACF,IAAR,GAAeE,OAAO,CAACF,IAAR,CAAaqW,OAAb,CAAqB,gBAArB,EAAuC,IAAIwJ,MAAJ,CAAW,EAAX,IAAe,IAAtD,CAAf;CAEA,WAAK3gB,UAAL,CAAgB6C,WAAhB,CAA4Bsd,WAA5B,CAAwCnf,OAAO,CAACS,QAAhD;CAEAhB,MAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,2BAAnC,EAAgE,CAC/D,iBAAenS,OAAO,CAACQ,EADwC,EAE/D,CAACmJ,mBAAU,CAACqX,YAAZ,EAA0B;CACzB,uBAAehhB,OAAO,CAACQ,EADE;CAEzB,qBAAaR,OAAO,CAACS,QAFI;CAGzB,mBAAWT,OAAO,CAACF;CAHM,OAA1B,CAF+D,EAO/DE,OAP+D,CAAhE,EAQG,YARH;CASA;CArnDF;CAAA;CAAA,wCAunDqBA,OAvnDrB,EAwnDC;CACC,UAAI2e,QAAQ,GAAGC,mBAAU,CAACC,OAAX,CAAmB7e,OAAO,CAAC4G,IAAR,CAAa1G,IAAhC,CAAf;CACA,UAAI+gB,aAAa,GAAGjhB,OAAO,CAAC4G,IAAR,CAAa1G,IAAb,CAAkBmP,QAAlB,GAA6ByO,WAA7B,GAA2CxO,KAA3C,CAAiD,GAAjD,EAAsD8Q,MAAtD,CAA6D,CAAC,CAA9D,EAAiE,CAAjE,CAApB;CACA,UAAIc,iBAAiB,GAAGvC,QAAQ,KAAK3I,iBAAQ,CAACC,KAAtB,IAA+BjW,OAAO,CAAC4G,IAAR,CAAamX,OAApE;CACA,UAAIoD,WAAW,GAAGxC,QAAQ,KAAK3I,iBAAQ,CAACC,KAAtB,IAA+BjW,OAAO,CAAC4G,IAAR,CAAapC,IAAb,KAAsB,WAArD,IAAoEma,QAAQ,KAAK3I,iBAAQ,CAACsC,KAA5G;CAEA7W,MAAAA,EAAE,CAAC4O,oBAAH,CAAwB+Q,QAAxB,CAAiC,CAAC;CACjCvF,QAAAA,GAAG,EAAE7b,OAAO,CAAC4G,IAAR,CAAayX,UADe;CAEjCtf,QAAAA,MAAM,EAAEiB,OAFyB;CAGjCE,QAAAA,IAAI,EAAEF,OAAO,CAAC4G,IAAR,CAAa1G,IAHc;CAIjCsE,QAAAA,IAAI,EAAEyc,aAJ2B;CAKjCI,QAAAA,QAAQ,EAAE1C,QAAQ,KAAK3I,iBAAQ,CAACsL,KAAtB,GAA6B,WAA7B,GAA0C,IALnB;CAMjCrF,QAAAA,MAAM,EAAE,CAACkF,WAAD,GAAc,IAAd,GAAoB;CAC3B,qBAAU,EADiB;CAE3B,mBAAQ,IAFmB;CAG3B,oBAAS;CAHkB,SANK;CAWjCpC,QAAAA,UAAU,EAAEmC,iBAAiB,GAAElhB,OAAO,CAAC4G,IAAR,CAAamX,OAAb,CAAqBlC,GAAvB,GAA4B,EAXxB;CAYjC0F,QAAAA,QAAQ,EAAE,KAAKviB,UAAL,CAAgB6C,WAAhB,CAA4B+e,eAA5B,EAZuB;CAajCxR,QAAAA,MAAM,EAAE,aAAWpP,OAAO,CAAC4G,IAAR,CAAapG,EAbC;CAcjCghB,QAAAA,kBAAkB,EAAE;CAda,OAAD,CAAjC;CAgBA;CA9oDF;CAAA;CAAA,8BAgpDWjhB,MAhpDX,EAgpDmBmQ,MAhpDnB,EAipDC;CAAA,UAD0BzO,SAC1B,uEADsC,CACtC;CACC,WAAKjD,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,cAApC,EAAoD;CACnDP,QAAAA,MAAM,EAAEA,MAD2C;CAEnDC,QAAAA,EAAE,EAAEkQ,MAF+C;CAGnD3P,QAAAA,MAAM,EAAE;CACPiO,UAAAA,MAAM,EAAEgG,mBAAU,CAAChU,KADZ;CAEP2P,UAAAA,QAAQ,EAAE;CAFH;CAH2C,OAApD;;CAQA,UAAI1O,SAAJ,EACA;CACC,aAAKjD,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,sBAApC,EAA4D;CAC3DP,UAAAA,MAAM,EAAEA,MADmD;CAE3DC,UAAAA,EAAE,EAAEyB,SAFuD;CAG3Dwf,UAAAA,KAAK,EAAE;CAHoD,SAA5D;CAKA;CACD;CAlqDF;CAAA;CAAA,+BAoqDY1iB,MApqDZ,EAoqDoBiB,OApqDpB,EAqqDC;CAAA;;CACC,UAAI0hB,WAAW,GAAG;CACjBC,QAAAA,OAAO,EAAE5iB,MAAM,CAACwB,MADC;CAEjBP,QAAAA,OAAO,EAAEjB,MAAM,CAAC4hB,WAFC;CAGjBiB,QAAAA,WAAW,EAAE7iB,MAAM,CAACkD,SAAP,GAAkBlD,MAAM,CAACkD,SAAzB,GAAoC,CAHhC;CAIjB4f,QAAAA,gBAAgB,EAAE9iB,MAAM,CAAC2R,MAAP,GAAe3R,MAAM,CAAC2R,MAAtB,GAA8B;CAJ/B,OAAlB;;CAMA,UAAI3R,MAAM,CAAC+iB,QAAX,EACA;CACCJ,QAAAA,WAAW,CAACK,SAAZ,GAAwBhjB,MAAM,CAAC+iB,QAA/B;CACA,OAHD,MAIK,IAAI/iB,MAAM,CAAC2hB,MAAX,EACL;CACCgB,QAAAA,WAAW,CAACM,OAAZ,GAAsBjjB,MAAM,CAAC2hB,MAA7B;CACA;;CAED,WAAK1hB,UAAL,CAAgByK,UAAhB,CAA2BC,UAA3B,CAAsCC,mBAAU,CAACsY,gBAAjD,EAAmEP,WAAnE,EAAgF,IAAhF,EAAsF,IAAtF,EAA4Fvd,kBAAK,CAACmQ,oBAAN,CAA2B;CACtHpU,QAAAA,IAAI,EAAEyJ,mBAAU,CAACsY,gBADqG;CAEtH5hB,QAAAA,IAAI,EAAE;CAAC6hB,UAAAA,cAAc,EAAEnjB,MAAM,CAAC4f;CAAxB,SAFgH;CAGtHzf,QAAAA,MAAM,EAAE,KAAKF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,CAA0C/R,MAAM,CAAC0B,QAAjD;CAH8G,OAA3B,CAA5F,EAIIkL,IAJJ,CAIS,UAAA6H,QAAQ,EAAI;CACpB,QAAA,OAAI,CAACxU,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACqP,gBAApD,EAAsEzO,QAAtE,EAAgFxT,OAAhF;CACA,OAND,EAMGmP,KANH,CAMS,UAAAnO,KAAK,EAAI;CACjB,QAAA,OAAI,CAAChC,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACqP,gBAApD,EAAsEjhB,KAAtE,EAA6EhB,OAA7E;CACA,OARD;CAUA,aAAO,IAAP;CACA;CAhsDF;CAAA;CAAA,0CAmsDC;CAAA;;CACC,UAAI,KAAKmiB,6BAAL,IAAsC,KAAKnjB,UAAL,CAAgB6C,WAAhB,CAA4B+e,eAA5B,EAA1C,EACA;CACC,eAAO,IAAP;CACA;;CAED,WAAKuB,6BAAL,GAAqC,IAArC;CAEA,WAAKnjB,UAAL,CAAgByK,UAAhB,CAA2BC,UAA3B,CAAsCC,mBAAU,CAACyY,eAAjD,EAAkE;CAACT,QAAAA,OAAO,EAAE,KAAK3iB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B;CAAV,OAAlE,EAAsHtI,IAAtH,CAA2H,UAAA6H,QAAQ,EAAI;CACtI,QAAA,OAAI,CAACxU,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACwP,eAApD,EAAqE5O,QAArE;;CACA,QAAA,OAAI,CAAC2O,6BAAL,GAAqC,KAArC;;CACA,QAAA,OAAI,CAACjT,mBAAL;CACA,OAJD,EAIGC,KAJH,CAIS,UAAAnO,KAAK,EAAI;CACjB,QAAA,OAAI,CAACmhB,6BAAL,GAAqC,KAArC;;CACA,QAAA,OAAI,CAACnjB,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACwP,eAApD,EAAqEphB,KAArE;CACA,OAPD;CASA,aAAO,IAAP;CACA;CArtDF;CAAA;CAAA,qCAutDkBqF,MAvtDlB,EAwtDC;CAAA;;CAAA,UADyB4M,KACzB,uEADiC,KAAKjU,UAAL,CAAgB6C,WAAhB,CAA4BqR,sBAA5B,EACjC;CACC,WAAKlU,UAAL,CAAgByK,UAAhB,CAA2BC,UAA3B,CAAsCC,mBAAU,CAACqJ,mBAAjD,EAAsE;CACrE,mBAAW,KAAKhU,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAD0D;CAErE,mBAAW5N,MAF0D;CAGrE,iBAAS4M,KAH4D;CAIrE,wBAAgB;CAJqD,OAAtE,EAKGtH,IALH,CAKQ,UAAAtJ,MAAM,EAAI;CACjB,QAAA,OAAI,CAACrD,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACI,mBAApD,EAAyE3Q,MAAzE;;CACA,QAAA,OAAI,CAACrD,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiBmjB,oBAAlD,EAAwE;CAACC,UAAAA,KAAK,EAAEjgB,MAAM,CAAChC,IAAP,GAAcuF,QAAd,CAAuBV;CAA/B,SAAxE;CACA,OARD,EAQGiK,KARH,CAQS,UAAA9M,MAAM,EAAI;CAClB,QAAA,OAAI,CAACrD,UAAL,CAAgB8C,IAAhB,CAAqBC,kBAAS,CAAC7C,MAAV,CAAiBmjB,oBAAtC,EAA4D;CAACrhB,UAAAA,KAAK,EAAEqB,MAAM,CAACrB,KAAP,GAAeC;CAAvB,SAA5D;CACA,OAVD;CAWA;CApuDF;CAAA;CAAA,oCAsuDiBoF,MAtuDjB,EAuuDC;CAAA;;CAAA,UADwB4M,KACxB,uEADgC,KAAKjU,UAAL,CAAgB6C,WAAhB,CAA4BqR,sBAA5B,EAChC;;CACC,UAAI,KAAKqP,0BAAT,EACA;CACC,eAAO,KAAKC,sBAAZ;CACA;;CAED,WAAKA,sBAAL,GAA8B,IAAI/gB,EAAE,CAACuJ,OAAP,EAA9B;CACA,WAAKuX,0BAAL,GAAkC,IAAlC;;CAEA,UAAI,CAAClc,MAAL,EACA;CACCA,QAAAA,MAAM,GAAG,KAAKrH,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,oBAAnC,EAAyD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAAzD,CAAT;CACA;;CAED,UAAI,CAAC5N,MAAL,EACA;CACC,aAAKrH,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiBujB,mBAAlD,EAAuE;CAACzhB,UAAAA,KAAK,EAAE;CAACA,YAAAA,KAAK,EAAE,eAAR;CAAyB0hB,YAAAA,iBAAiB,EAAE;CAA5C;CAAR,SAAvE;CAEA,aAAKF,sBAAL,CAA4BpW,MAA5B;CACA,aAAKmW,0BAAL,GAAkC,KAAlC;CAEA,eAAO,KAAKC,sBAAZ;CACA;;CAED,WAAKxjB,UAAL,CAAgB6C,WAAhB,CAA4B8F,WAA5B,CAAwCtB,MAAxC,EAAgD,IAAhD,EAAsD,IAAtD,EAA4DsF,IAA5D,CAAiE,YACjE;CAAA;;CACC,QAAA,OAAI,CAACJ,KAAL,CAAWgH,KAAX,CAAiB,MAAjB,EAAyB,MAAzB,EAAiC,EAAjC,EAAqC,YAAM;CAC1CpI,UAAAA,OAAO,CAAClD,IAAR,CAAa,4DAAb;CACA/F,UAAAA,GAAG,CAACsR,WAAJ,CAAgB,WAAhB,EAA6B;CAACC,YAAAA,WAAW,EAAE,IAAd;CAAoBC,YAAAA,cAAc,EAAE;CAApC,WAA7B;CACA,SAHD;;CAKA,YAAIC,KAAK,uDACPC,0BAAiB,CAAC+P,YADX,EAC0B,CAAChZ,mBAAU,CAACgZ,YAAZ,EAA0B;CAC3DjiB,UAAAA,SAAS,EAAE,OAAI,CAAC1B,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EADgD;CAE3D4U,UAAAA,UAAU,EAAEvc;CAF+C,SAA1B,CAD1B,wCAKPuM,0BAAiB,CAACE,SALX,EAKuB,CAACnJ,mBAAU,CAACmJ,SAAZ,EAAuB;CACrDpS,UAAAA,SAAS,EAAE,OAAI,CAAC1B,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B;CAD0C,SAAvB,CALvB,wCAQP4E,0BAAiB,CAACiQ,yBARX,EAQuC,CAAClZ,mBAAU,CAACqJ,mBAAZ,EAAiC;CAC/E2O,UAAAA,OAAO,EAAE,OAAI,CAAC3iB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EADsE;CAE/E6O,UAAAA,QAAQ,EAAEzc,MAFqE;CAG/E4M,UAAAA,KAAK,EAAEA,KAHwE;CAI/EE,UAAAA,YAAY,EAAE;CAJiE,SAAjC,CARvC,WAAT;;CAgBA,QAAA,OAAI,CAACnU,UAAL,CAAgByK,UAAhB,CAA2B8J,SAA3B,CAAqCZ,KAArC,EAA4C,UAACa,QAAD,EAC5C;CACC,cAAI,CAACA,QAAL,EACA;CACC,YAAA,OAAI,CAACxU,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiBujB,mBAAlD,EAAuE;CAACzhB,cAAAA,KAAK,EAAE;CAACA,gBAAAA,KAAK,EAAE,gBAAR;CAA0B0hB,gBAAAA,iBAAiB,EAAE;CAA7C;CAAR,aAAvE;;CAEA,YAAA,OAAI,CAACF,sBAAL,CAA4BpW,MAA5B;;CACA,YAAA,OAAI,CAACmW,0BAAL,GAAkC,KAAlC;CAEA,mBAAO,KAAP;CACA;;CAED,cAAIzO,aAAa,GAAGN,QAAQ,CAACZ,0BAAiB,CAACE,SAAnB,CAA5B;;CACA,cAAI,CAACgB,aAAa,CAAC9S,KAAd,EAAL,EACA;CACC,YAAA,OAAI,CAAChC,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACE,SAApD,EAA+DgB,aAA/D;CACA;;CAED,cAAIiP,mBAAmB,GAAGvP,QAAQ,CAACZ,0BAAiB,CAACiQ,yBAAnB,CAAlC;;CACA,cAAIE,mBAAmB,CAAC/hB,KAApB,EAAJ,EACA;CACC,YAAA,OAAI,CAAChC,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiBujB,mBAAlD,EAAuE;CAACzhB,cAAAA,KAAK,EAAE+hB,mBAAmB,CAAC/hB,KAApB,GAA4BC;CAApC,aAAvE;CACA,WAHD,MAKA;CACC,YAAA,OAAI,CAACjC,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACiQ,yBAApD,EAA+EE,mBAA/E;;CAEA,YAAA,OAAI,CAAC/jB,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiBujB,mBAAlD,EAAuE;CACtEO,cAAAA,cAAc,EAAED,mBAAmB,CAAC1iB,IAApB,GAA2BuF,QAA3B,CAAoCV,MAApC,GAA6C,CAA7C,GAAgD6d,mBAAmB,CAAC1iB,IAApB,GAA2BuF,QAA3B,CAAoC,CAApC,EAAuCpF,EAAvF,GAA2F,CADrC;CAEtE8hB,cAAAA,KAAK,EAAES,mBAAmB,CAAC1iB,IAApB,GAA2BuF,QAA3B,CAAoCV;CAF2B,aAAvE;;CAKAhE,YAAAA,GAAG,CAACsR,WAAJ,CAAgB,WAAhB,EAA6B;CAACC,cAAAA,WAAW,EAAE,KAAd;CAAqBC,cAAAA,cAAc,EAAE;CAArC,aAA7B;;CACA,YAAA,OAAI,CAACnH,KAAL,CAAWyI,IAAX,CAAgB,MAAhB,EAAwB,MAAxB,EAAgC,IAAhC;CACA;;CAED,UAAA,OAAI,CAACwO,sBAAL,CAA4BS,OAA5B,CAAoCzP,QAApC;;CACA,UAAA,OAAI,CAAC+O,0BAAL,GAAkC,KAAlC;CAEA,SAvCD,EAuCG,KAvCH,EAuCU,KAvCV,EAuCiBpe,kBAAK,CAACmQ,oBAAN,CAA2B;CAACpU,UAAAA,IAAI,EAAE0S,0BAAiB,CAACiQ,yBAAzB;CAAoD3jB,UAAAA,MAAM,EAAE,OAAI,CAACF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B;CAA5D,SAA3B,CAvCjB;CAwCA,OA/DD;CAiEA,aAAO,KAAK0R,sBAAZ;CACA;CAj0DF;CAAA;CAAA,qCAm0DkBxiB,OAn0DlB,EAo0DC;CACC,UAAIqa,OAAO,GAAG,KAAKnY,aAAL,CAAmBqe,IAAnB,CAAwB,UAAAne,EAAE;CAAA,eAAIA,EAAE,CAAC5B,EAAH,KAAUR,OAAO,CAACQ,EAAtB;CAAA,OAA1B,CAAd;;CACA,UAAI6Z,OAAJ,EACA;CACC,YAAIA,OAAO,CAACzT,IAAR,IAAgByT,OAAO,CAACzT,IAAR,CAAapG,EAAjC,EACA;CACC,eAAK0iB,eAAL,CAAqB7I,OAAO,CAACzT,IAAR,CAAapG,EAAlC;CACA;;CAED,eAAO,KAAP;CACA;;CAED,WAAK0B,aAAL,CAAmBmB,IAAnB,CAAwB;CACvB7C,QAAAA,EAAE,EAAER,OAAO,CAACQ,EADW;CAEvBD,QAAAA,MAAM,EAAE,KAAKvB,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAFe;CAGvBxT,QAAAA,QAAQ,EAAE,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAHa;CAIvBlO,QAAAA,IAAI,EAAEE,OAAO,CAACF,IAJS;CAKvBogB,QAAAA,OAAO,EAAE;CALc,OAAxB;CAQA,WAAKlhB,UAAL,CAAgB6C,WAAhB,CAA4BshB,qBAA5B,CAAkDnjB,OAAO,CAACQ,EAA1D;CAEA,WAAK0O,mBAAL;CACA;CA31DF;CAAA;CAAA,gCA61DatK,MA71Db,EA81DC;CACCnF,MAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,mBAAnC,EAAwD,CAACvN,MAAD,EAAS;CAAC4T,QAAAA,QAAQ,EAAE;CAAX,OAAT,CAAxD,EAAoF,eAApF;CACA;CAh2DF;CAAA;CAAA,+BAk2DY/X,QAl2DZ,EAm2DC;CACChB,MAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,cAAnC,EAAmD,CAAC;CAAC1R,QAAAA,QAAQ,EAARA;CAAD,OAAD,EAAa,IAAb,CAAnD,EAAuE,WAAvE;CACA;CAr2DF;CAAA;CAAA,kCAu2De2iB,MAv2Df,EAw2DC;CACC3hB,MAAAA,EAAE,CAACkY,WAAH,CAAeC,OAAf,CAAuBwJ,MAAvB;CACA;CA12DF;CAAA;CAAA,oCA42DiBpjB,OA52DjB,EA62DC;CAAA;;CACC,UAAI,KAAKkC,aAAL,CAAmBqe,IAAnB,CAAwB,UAAAne,EAAE;CAAA,eAAIA,EAAE,CAAC5B,EAAH,KAAUR,OAAO,CAACQ,EAAtB;CAAA,OAA1B,CAAJ,EACA;CACC,eAAO,KAAP;CACA;;CAED,WAAKxB,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,iBAApC,EAAuD;CACtDN,QAAAA,EAAE,EAAER,OAAO,CAACQ,EAD0C;CAEtDD,QAAAA,MAAM,EAAEP,OAAO,CAACO,MAFsC;CAGtDQ,QAAAA,MAAM,EAAE;CACPsiB,UAAAA,KAAK,EAAE;CADA;CAH8C,OAAvD;CAQA,UAAIC,WAAW,GAAG,KAAKtkB,UAAL,CAAgB6C,WAAhB,CAA4Bye,cAA5B,EAAlB;CACA,UAAIphB,MAAM,GAAG,KAAKF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAb;CACA,UAAIyS,WAAW,GAAGvjB,OAAO,CAAC8D,QAAR,GAAmB,CAAnB,GAAsB,KAAK9E,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,WAAnC,EAAgD5D,OAAO,CAAC8D,QAAxD,EAAkE,IAAlE,CAAtB,GAA+F,IAAjH;CAEA,WAAK0f,mBAAL,GAA2BpK,YAAY,CACrCrL,MADyB,CAClB,yBAAuB,KAAK/O,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EADL,EAEzBqL,QAFyB,CAEhB,CACTC,gBAAgB,CAACvL,MAAjB,CAAwB,OAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,2BAAjB,CADX,EAEEmM,OAFF,CAEUC,gBAAgB,CAACC,KAF3B,EAGEvP,IAHF,CAGO,UAACpU,OAAD,EAAa;CAClB,YAAId,MAAM,GAAG,OAAI,CAACF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAb;;CACA,YAAI5R,MAAM,CAACsF,IAAP,KAAgB,cAAhB,IAAkC,CAACtF,MAAM,CAACuF,WAAP,CAAmBC,QAAnB,CAA4B,OAAI,CAAC1F,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAA5B,CAAvC,EACA;CACC,iBAAO,IAAP;CACA;;CAED,eAAO,CAAC3R,OAAO,CAAC8D,QAAT,IAAqB9D,OAAO,CAAC8D,QAAR,KAAqB,OAAI,CAAC9E,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAAjD;CACA,OAXF,CADS,EAeT2H,gBAAgB,CAACvL,MAAjB,CAAwB,MAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,0BAAjB,CADX,EAEEmM,OAFF,CAEUC,gBAAgB,CAACE,IAF3B,EAGExP,IAHF,CAGO,UAACpU,OAAD;CAAA,eAAaA,OAAO,CAACjB,MAAR,CAAe8kB,UAAf,KAA8B,GAA3C;CAAA,OAHP,CAfS,EAqBTvK,gBAAgB,CAACvL,MAAjB,CAAwB,OAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,2BAAjB,CADX,EAEEmM,OAFF,CAEUC,gBAAgB,CAAC5D,KAF3B,EAGE1L,IAHF,CAGO,UAACpU,OAAD,EACN;CACC,YAAId,MAAM,GAAG,OAAI,CAACF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAb;;CACA,YAAI5R,MAAM,CAACsF,IAAP,KAAgB,cAAhB,IAAkC,CAACtF,MAAM,CAACuF,WAAP,CAAmBC,QAAnB,CAA4B,OAAI,CAAC1F,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAA5B,CAAvC,EACA;CACC,iBAAO,IAAP;CACA;;CAED,eAAO3R,OAAO,CAACjB,MAAR,CAAe8kB,UAAf,KAA8B,GAArC;CACA,OAZF,CArBS,EAoCTvK,gBAAgB,CAACvL,MAAjB,CAAwB,QAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,4BAAjB,CADX,EAEEmM,OAFF,CAEUC,gBAAgB,CAACI,MAF3B,EAGE1P,IAHF,CAGO,UAACpU,OAAD;CAAA,eAAaA,OAAO,CAAC8D,QAAR,KAAqB,OAAI,CAAC9E,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAArB,IAAgE3R,OAAO,CAAC8jB,MAArF;CAAA,OAHP,CApCS,EA0CTxK,gBAAgB,CAACvL,MAAjB,CAAwB,MAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,0BAAjB,CADX,EAEEmM,OAFF,CAEUC,gBAAgB,CAACK,OAF3B,EAGE3P,IAHF,CAGO,UAACpU,OAAD;CAAA,eAAa,CAACA,OAAO,CAAC8jB,MAAtB;CAAA,OAHP,CA1CS,EAgDTxK,gBAAgB,CAACvL,MAAjB,CAAwB,MAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,0BAAjB,CADX,EAEEmM,OAFF,CAEUC,gBAAgB,CAACM,IAF3B,EAGE5P,IAHF,CAGO,UAACpU,OAAD;CAAA,eAAaA,OAAO,CAAC8D,QAAR,KAAqB,OAAI,CAAC9E,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAArB,IAAgE3R,OAAO,CAACjB,MAAR,CAAe8kB,UAAf,KAA8B,GAA3G;CAAA,OAHP,CAhDS,EAsDTvK,gBAAgB,CAACvL,MAAjB,CAAwB,OAAxB,EACEkW,OADF,CACUC,oBAAoB,CAACC,IAD/B,EAEEV,OAFF,CAEUC,gBAAgB,CAACU,WAF3B,EAGE7K,QAHF,CAGW,KAAKjC,WAAL,CAAiB,gCAAjB,CAHX,EAIE+M,YAJF,GAKEjQ,IALF,CAKOkP,WAAW,CAACgB,QAAZ,IAAwBplB,MAAM,CAACsF,IAAP,KAAgB,cAL/C,CAtDS,EA8DT8U,gBAAgB,CAACvL,MAAjB,CAAwB,SAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,6BAAjB,CADX,EAEEmM,OAFF,CAEUC,gBAAgB,CAAC7f,IAF3B,EAGEuQ,IAHF,CAGO,UAACpU,OAAD,EAAa;CAElB,YAAIA,OAAO,CAAC8D,QAAR,IAAoB,CAApB,IAAyB,CAACyf,WAA9B,EACC,OAAO,IAAP;CAED,YAAI,CAACpf,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,OAAI,CAACtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAL,EACC,OAAO,IAAP;CAED,YAAIhO,OAAO,CAAC8D,QAAR,KAAqB,OAAI,CAAC9E,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAAzB,EACC,OAAO,IAAP;;CAED,YACC4R,WAAW,CAACgB,cAAZ,KAA+B,aAA/B,IACGhB,WAAW,CAACgB,cAAZ,KAA+B,MAFnC,EAIA;CACC,iBAAO,IAAP;CACA;;CAED,eAAQ,KAAR;CACA,OAvBF,CA9DS,EAwFTjL,gBAAgB,CAACvL,MAAjB,CAAwB,QAAxB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,4BAAjB,CADX,EAEEkN,SAFF,CAEYC,iBAAiB,CAAC1W,MAAlB,GAA2B2W,OAA3B,CAAmCC,kBAAkB,CAAC5W,MAAnB,GAA4B6W,QAA5B,CAAqC,SAArC,CAAnC,CAFZ,EAGEnB,OAHF,CAGUC,gBAAgB,CAACmB,KAH3B,EAIEzQ,IAJF,CAIO,UAACpU,OAAD;CAAA,eAAaA,OAAO,CAAC8D,QAAR,KAAqB,OAAI,CAAC9E,UAAL,CAAgB6C,WAAhB,CAA4B8P,SAA5B,EAArB,IAAgE3R,OAAO,CAACjB,MAAR,CAAe8kB,UAAf,KAA8B,GAA3G;CAAA,OAJP,CAxFS,CAFgB,EAiGzBpK,UAjGyB,CAiGdhY,EAAE,CAAC8K,mBAAH,CAAuBG,GAAvB,CAA2B,8BAA3B,EAA2D,OAA3D,CAjGc,EAkGzBgN,gBAlGyB,CAkGR,UAACxZ,IAAD,EAAOnB,MAAP,EAAeiB,OAAf,EAAwBwY,QAAxB,EAAqC;CACtD,YAAItY,IAAI,KAAK,WAAb,EACA;CACCqC,UAAAA,UAAG,CAAC2D,KAAJ,CAAU+I,KAAV,CAAgB,+BAAhB;CACA;;CAED,YAAI/O,IAAI,KAAK,UAAb,EACA;CACC,iBAAO,KAAP;CACA;;CAED,YAAInB,MAAM,CAACyB,EAAP,KAAc,OAAlB,EACA;CACC,UAAA,OAAI,CAACiG,WAAL,CAAiBzG,OAAO,CAAC8D,QAAzB;CACA,SAHD,MAIK,IAAI/E,MAAM,CAACyB,EAAP,KAAc,MAAlB,EACL;CACC,UAAA,OAAI,CAACskB,WAAL,CAAiB9kB,OAAO,CAACQ,EAAzB;CACA,SAHI,MAIA,IAAIzB,MAAM,CAACyB,EAAP,KAAc,OAAlB,EACL;CACC,UAAA,OAAI,CAACyJ,iBAAL;;CACA,UAAA,OAAI,CAACjC,YAAL,CAAkBhI,OAAO,CAACQ,EAA1B;CACA,SAJI,MAKA,IAAIzB,MAAM,CAACyB,EAAP,KAAc,MAAlB,EACL;CACC,UAAA,OAAI,CAACyJ,iBAAL;;CACA,UAAA,OAAI,CAAC8a,WAAL,CAAiB/kB,OAAO,CAACQ,EAAzB;CACA,SAJI,MAKA,IAAIzB,MAAM,CAACyB,EAAP,KAAc,QAAlB,EACL;CACC,UAAA,OAAI,CAACwkB,aAAL,CAAmBhlB,OAAO,CAACQ,EAA3B;CACA,SAHI,MAIA,IAAIzB,MAAM,CAACyB,EAAP,KAAc,QAAlB,EACL;CACC,UAAA,OAAI,CAACykB,aAAL,CAAmBjlB,OAAO,CAACQ,EAA3B;CACA,SAHI,MAIA,IAAIzB,MAAM,CAACyB,EAAP,KAAc,MAAlB,EACL;CACC,UAAA,OAAI,CAACmH,WAAL,CAAiB3H,OAAO,CAACQ,EAAzB;CACA,SAHI,MAIA,IAAIzB,MAAM,CAACyB,EAAP,KAAc,OAAlB,EACL;CACC,cAAItB,OAAM,GAAG,OAAI,CAACF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAb;;CACA,cAAIoU,OAAO,GAAG9L,YAAY,CACxBrL,MADY,CACL,iCAA+B,OAAI,CAAC/O,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD1B,EAEZqL,QAFY,CAEH,CACTC,gBAAgB,CAACvL,MAAjB,CAAwB,YAAxB,EACE0V,OADF,CACUC,gBAAgB,CAACyB,IAD3B,EAEE5L,QAFF,CAEW,OAAI,CAACjC,WAAL,CAAiB,gCAAjB,CAFX,CADS,EAKTgC,gBAAgB,CAACvL,MAAjB,CAAwB,YAAxB,EACE0V,OADF,CACUC,gBAAgB,CAAC0B,QAD3B,EAEE7L,QAFF,CAEW,OAAI,CAACjC,WAAL,CAAiB,qCAAjB,CAFX,CALS,EASTgC,gBAAgB,CAACvL,MAAjB,CAAwB,YAAxB,EACE0V,OADF,CACUC,gBAAgB,CAAC2B,IAD3B,EAEE9L,QAFF,CAEW,OAAI,CAACjC,WAAL,CAAiB,gCAAjB,CAFX,CATS,CAFG,EAgBZoC,gBAhBY,CAgBK,UAACxZ,IAAD,EAAOnB,MAAP,EAAegG,OAAf,EAAwByT,QAAxB,EAClB;CACC,gBAAItY,IAAI,KAAK,UAAb,EACA;CACC,qBAAO,KAAP;CACA;;CAGD,gBAAInB,MAAM,CAACyB,EAAP,KAAc,YAAlB,EACA;CACC,cAAA,OAAI,CAAC8kB,YAAL,CAAkBtlB,OAAO,CAACQ,EAA1B,EAA8B,MAA9B;CACA,aAHD,MAIK,IAAIzB,MAAM,CAACyB,EAAP,KAAc,YAAlB,EACL;CACC,cAAA,OAAI,CAAC8kB,YAAL,CAAkBtlB,OAAO,CAACQ,EAA1B,EAA8B,MAA9B;CACA,aAHI,MAIA,IAAIzB,MAAM,CAACyB,EAAP,KAAc,YAAlB,EACL;CACC,cAAA,OAAI,CAAC8kB,YAAL,CAAkBtlB,OAAO,CAACQ,EAA1B,EAA8B,MAA9B;CACA;CACD,WApCY,CAAd;CAsCAgY,UAAAA,QAAQ,CAAC+M,WAAT,CAAqBL,OAArB;CACA,SA1CI,MA2CA,IAAInmB,MAAM,CAACyB,EAAP,KAAc,SAAlB,EACL;CACC,UAAA,OAAI,CAAC2G,WAAL,CAAiBnH,OAAO,CAAC8D,QAAzB;CACA,SAHI,MAKL;CACCqG,UAAAA,OAAO,CAAClD,IAAR,CAAa,qCAAb,EAAoDlI,MAApD;CACA;CACD,OA9LyB,CAA3B;CAiMA,WAAKykB,mBAAL,CAAyB3J,eAAzB,CAAyC7Z,OAAzC,EAAkDwJ,IAAlD;CAEA2H,MAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,qBAA/B,EAAsD,EAAtD;CACA;CAnkEF;CAAA;CAAA,qCAskEC;CAAA;;CACCF,MAAAA,MAAM,CAACC,OAAP,CAAeC,eAAf,CAA+B,uBAA/B,EAAwD,EAAxD;;CAEA,UAAI,CAAC,KAAKmU,UAAV,EACA;CACC,aAAKA,UAAL,GAAkBC,UAAU,CAAC1X,MAAX,GAChB2X,wBADgB,GAEhBhM,gBAFgB,CAEC,UAACxZ,IAAD,EAAOnB,MAAP,EAAe4mB,YAAf,EAAgC;CACjD,cAAIzlB,IAAI,KAAK,UAAb,EACA;CACC,mBAAO,KAAP;CACA;;CAED,cAAInB,MAAM,CAACyB,EAAP,KAAc,SAAlB,EACA;CACC,YAAA,OAAI,CAAC2G,WAAL,CAAiB,OAAI,CAACnI,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAjB;CACA,WAHD,MAIK,IAAIjP,MAAM,CAACyB,EAAP,KAAc,WAAlB,EACL;CACC,YAAA,OAAI,CAAColB,YAAL,CAAkB;CAACrN,cAAAA,QAAQ,EAAE,OAAX;CAAoB1Y,cAAAA,KAAK,EAAE,OAAI,CAACyX,WAAL,CAAiB,8BAAjB,CAA3B;CAA6EkB,cAAAA,QAAQ,EAAE;CAAvF,aAAlB;CACA,WAHI,MAIA,IAAIzZ,MAAM,CAACyB,EAAP,KAAc,UAAlB,EACL;CACC,YAAA,OAAI,CAAC8Q,iBAAL;CACA,WAHI,MAIA,IAAIvS,MAAM,CAACyB,EAAP,KAAc,OAAlB,EACL;CACC,YAAA,OAAI,CAACyZ,SAAL;CACA,WAHI,MAIA,IAAIlb,MAAM,CAACyB,EAAP,KAAc,QAAlB,EACL;CACC,YAAA,OAAI,CAACxB,UAAL,CAAgB6C,WAAhB,CAA4BgkB,UAA5B;CACA,WAHI,MAIA,IAAI9mB,MAAM,CAACyB,EAAP,KAAc,gBAAlB,EACL;CACCiB,YAAAA,EAAE,CAACkY,WAAH,CAAeC,OAAf,CAAuB,OAAI,CAAC5a,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,GAA4CgV,QAAnE;CACA,WAHI,MAIA,IAAI/mB,MAAM,CAACyB,EAAP,KAAc,UAAlB,EACL;CACC,gBAAIulB,OAAO,GAAG,OAAI,CAAC/mB,UAAL,CAAgB6C,WAAhB,CAA4BmkB,gBAA5B,EAAd;;CACA,gBAAIC,UAAU,GAAGxkB,EAAE,CAACkY,WAAH,CAAeuM,mBAAf,CAAmC,UAAQH,OAAO,CAACvO,UAAhB,GAA2B,QAA3B,GAAoCuO,OAAO,CAACD,QAA5C,GAAqD,GAAxF,CAAjB;;CACA,gBAAIG,UAAJ,EACA;CACCA,cAAAA,UAAU;CACV;CACD,WARI,MASA,IAAIlnB,MAAM,CAACyB,EAAP,KAAc,QAAlB,EACL;CACE,gBAAIf,WAAW,CAACC,EAAZ,CAAeqJ,eAAnB,CAAmC;CACnC/I,cAAAA,OAAO,EAAE,OAAI,CAACsX,WAAL,CAAiB,gCAAjB,CAD0B;CAEnC7T,cAAAA,KAAK,EAAE,WAF4B;CAGnCuF,cAAAA,SAAS,EAAE,SAHwB;CAInCC,cAAAA,OAAO,EAAE,SAJ0B;CAKnCkd,cAAAA,SAAS,EAAE,IALwB;CAMnCjd,cAAAA,QAAQ,EAAE,CANyB;CAOnCC,cAAAA,KAAK,EAAE,QAP4B;CAQnCI,cAAAA,SAAS,EAAE;CARwB,aAAnC,EASE,MATF,CAAD,CASYC,IATZ;;CAWA,YAAA,OAAI,CAACxK,UAAL,CAAgBonB,eAAhB,GAAkCC,aAAlC;;CAEAC,YAAAA,MAAM;CACN;CACD,SA1DgB,CAAlB;CA4DA;;CAED,UAAIniB,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAJ,EACA;CACC,YAAI6C,UAAU,GAAG,KAAK7R,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,EAAjB;CACA,YAAIyV,gBAAgB,GAAG,CAAC,KAAKvnB,UAAL,CAAgB6C,WAAhB,CAA4B2kB,aAA5B,EAAD,GAA8C,KAAKlP,WAAL,CAAiB,mCAAjB,CAA9C,GAAqG,KAAKA,WAAL,CAAiB,kCAAjB,CAA5H;CACA,YAAImP,gBAAgB,GAAG,CAAC,KAAKznB,UAAL,CAAgB6C,WAAhB,CAA4B2kB,aAA5B,EAAD,GAA8CE,cAAc,CAACC,MAA7D,GAAqED,cAAc,CAACE,UAA3G;CAEA,YAAIC,eAAe,GAAG,EAAtB;;CACA,YACChW,UAAU,CAACrM,IAAX,KAAoBuM,mBAAU,CAACC,IAA/B,IACGH,UAAU,CAACrM,IAAX,KAAoBuM,mBAAU,CAAC+V,GAFnC,EAIA;CACC,cAAIf,OAAO,GAAG,KAAK/mB,UAAL,CAAgB6C,WAAhB,CAA4BmkB,gBAA5B,EAAd;;CACA,cAAID,OAAO,CAAC1kB,OAAZ,EACA;CACC,gBAAI0kB,OAAO,CAACvO,UAAR,KAAuBuP,sBAAa,CAACC,IAAzC,EACA;CACCH,cAAAA,eAAe,GAAG,KAAKvP,WAAL,CAAiB,sBAAjB,CAAlB;CACA,aAHD,MAIK,IAAIyO,OAAO,CAACvO,UAAR,KAAuBuP,sBAAa,CAACE,OAAzC,EACL;CACCJ,cAAAA,eAAe,GAAG,KAAKvP,WAAL,CAAiB,yBAAjB,CAAlB;CACA,aAHI,MAIA,IAAIyO,OAAO,CAACvO,UAAR,KAAuBuP,sBAAa,CAACG,OAAzC,EACL;CACCL,cAAAA,eAAe,GAAG,KAAKvP,WAAL,CAAiB,yBAAjB,CAAlB;CACA,aAHI,MAIA,IAAIyO,OAAO,CAACvO,UAAR,KAAuBuP,sBAAa,CAACI,IAAzC,EACL;CACCN,cAAAA,eAAe,GAAG,KAAKvP,WAAL,CAAiB,sBAAjB,CAAlB;CACA,aAHI,MAKL;CACCuP,cAAAA,eAAe,GAAG,KAAKvP,WAAL,CAAiB,iBAAjB,CAAlB;CACA;CACD;CACD;;CAED,YAAIzG,UAAU,CAACrM,IAAX,KAAoBuM,mBAAU,CAACC,IAAnC,EACA;CACC,eAAKwU,UAAL,CAAgBnM,QAAhB,CAAyB,CACxB+N,cAAc,CAACrZ,MAAf,CAAsB,gBAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,+BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAACW,KAFzB,EAGEjT,IAHF,CAGOvD,UAAU,CAACiV,QAAX,KAAwB,iBAH/B,CADwB,EAMxBsB,cAAc,CAACrZ,MAAf,CAAsB,UAAtB,EACEwL,QADF,CACWsN,eADX,EAEEpD,OAFF,CAEUiD,cAAc,CAACtB,QAFzB,EAGEhR,IAHF,CAGOvD,UAAU,CAACiV,QAAX,KAAwB,iBAAxB,IAA6C,CAACe,eAHrD,CANwB,EAWxBO,cAAc,CAACrZ,MAAf,CAAsB,QAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,2BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAACJ,MAFzB,CAXwB,CAAzB;CAgBA,SAlBD,MAoBA;CACC,cAAIpV,KAAK,GAAG,CACXkW,cAAc,CAACrZ,MAAf,CAAsB,QAAtB,EACEwL,QADF,CACWgN,gBADX,EAEE9C,OAFF,CAEUgD,gBAFV,CADW,EAKXW,cAAc,CAACrZ,MAAf,CAAsB,WAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,8BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAAC7iB,IAFzB,CALW,EASXujB,cAAc,CAACrZ,MAAf,CAAsB,UAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,6BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAACY,SAFzB,EAGElT,IAHF,CAGO,CAACvD,UAAU,CAAChQ,YAAX,CAAwBoQ,MAHhC,CATW,EAcXmW,cAAc,CAACrZ,MAAf,CAAsB,OAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,0BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAACa,KAFzB,EAGEnT,IAHF,CAGO,CAACvD,UAAU,CAAChQ,YAAX,CAAwB2mB,KAHhC,CAdW,EAmBXJ,cAAc,CAACrZ,MAAf,CAAsB,QAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,2BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAACJ,MAFzB,CAnBW,CAAZ;CAyBApV,UAAAA,KAAK,CAAC7N,IAAN,CAAW+jB,cAAc,CAACrZ,MAAf,CAAsB,QAAtB,EACTwL,QADS,CACA,KAAKjC,WAAL,CAAiB,2BAAjB,CADA,EAETmM,OAFS,CAEDiD,cAAc,CAACJ,MAFd,CAAX;;CAIA,cACCzV,UAAU,CAACrM,IAAX,KAAoBuM,mBAAU,CAAC+V,GAA/B,IACGD,eAFJ,EAIA;CACC3V,YAAAA,KAAK,CAACuW,OAAN,CAAcL,cAAc,CAACrZ,MAAf,CAAsB,UAAtB,EACZwL,QADY,CACHsN,eADG,EAEZpD,OAFY,CAEJiD,cAAc,CAACtB,QAFX,CAAd;CAIA;;CAED,eAAKI,UAAL,CAAgBnM,QAAhB,CAAyBnI,KAAzB;CACA;CACD,OArGD,MAuGA;CACC,aAAKsU,UAAL,CAAgBnM,QAAhB,CAAyB,CACxB+N,cAAc,CAACrZ,MAAf,CAAsB,SAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,4BAAjB,CADX,EAEEmM,OAFF,CAEU,MAFV,EAGErP,IAHF,CAGOjQ,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAHP,CADwB,EAMxBoZ,cAAc,CAACrZ,MAAf,CAAsB,UAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,6BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAACY,SAFzB,CANwB,EAUxBF,cAAc,CAACrZ,MAAf,CAAsB,QAAtB,EACEwL,QADF,CACW,KAAKjC,WAAL,CAAiB,2BAAjB,CADX,EAEEmM,OAFF,CAEUiD,cAAc,CAACJ,MAFzB,CAVwB,CAAzB;CAeA;;CAED,WAAKd,UAAL,CAAgBhc,IAAhB,CAAqB,IAArB;CACA;CAnwEF;CAAA;CAAA,iCAqwEcvH,SArwEd,EAqwEyBuC,IArwEzB,EAswEC;CACC,UAAI,CAAC,KAAKxF,UAAL,CAAgB0oB,QAAhB,EAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,aAAO,KAAK1oB,UAAL,CAAgB6C,WAAhB,CAA4ByjB,YAA5B,CAAyCrjB,SAAzC,EAAoDuC,IAApD,CAAP;CACA;CA7wEF;CAAA;CAAA,gCA+wEavC,SA/wEb,EAgxEC;CACC;CACA;CACA;CACA;CAEA,WAAKjD,UAAL,CAAgB6C,WAAhB,CAA4B8F,WAA5B,CAAwC1F,SAAxC,EAAmD,IAAnD,EAAyD,IAAzD,EAA+D0J,IAA/D,CAAoE,UAACtJ,MAAD,EACpE;CACC,YAAIA,MAAM,CAACgE,MAAP,IAAiB,CAArB,EACA;CACC,iBAAO,IAAP;CACA;;CACD5G,QAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,8BAAnC,EAAmE,CAClE,aADkE,EAElE,iBAAe9P,MAAM,CAAC5B,QAF4C,EAGlE4B,MAHkE,EAIlE,KAJkE,EAKlE,GALkE,CAAnE,EAMG,YANH;CAOA,OAbD;CAeA,aAAO,IAAP;CACA;CAtyEF;CAAA;CAAA,kCAwyEeJ,SAxyEf,EAyyEC;CACC,UAAI,CAAC,KAAKjD,UAAL,CAAgB0oB,QAAhB,EAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,aAAO,KAAK1oB,UAAL,CAAgB6C,WAAhB,CAA4BojB,aAA5B,CAA0ChjB,SAA1C,CAAP;CACA;CAhzEF;CAAA;CAAA,mCAkzEgB6F,IAlzEhB,EAmzEC;CACC,UAAI,CAAC3D,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI,CAAClG,IAAD,IAASA,IAAI,CAAC5C,MAAL,IAAe,CAA5B,EACA;CACC,eAAO,KAAP;CACA;;CAED,WAAK0gB,YAAL,CAAkB;CACjB3lB,QAAAA,KAAK,EAAE6H,IAAI,CAACuO,GAAL,CAAS,UAAAgE,OAAO;CAAA,iBAAIA,OAAO,CAACzV,MAAZ;CAAA,SAAhB,CADU;CAEjB/E,QAAAA,KAAK,EAAE,KAAKyX,WAAL,CAAiB,0BAAjB;CAFU,OAAlB;CAIA;CAl0EF;CAAA;CAAA,gCAo0Ea1S,MAp0Eb,EAq0EC;CAAA,UADoBoT,QACpB,uEAD+B,IAC/B;;CACC,UAAI,CAAC,KAAKhZ,UAAL,CAAgB0oB,QAAhB,EAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI,CAAC1P,QAAL,EACA;CACCA,QAAAA,QAAQ,GAAG,KAAKhZ,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,WAAnC,EAAgDgB,MAAhD,CAAX;CACA;;CAED,aAAO,KAAKkC,UAAL,CAAgB;CAAChH,QAAAA,IAAI,kBAAW8E,MAAX,cAAqBoT,QAAQ,CAAC2P,SAA9B;CAAL,OAAhB,CAAP;CACA;CAj1EF;CAAA;CAAA,gCAm1EannB,EAn1Eb,EAo1EC;CACC,UAAIwH,YAAY,GAAG,KAAKhJ,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,qBAAnC,EAA0D,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAA1D,EAAmGzT,EAAnG,CAAnB;CAEA,UAAIV,IAAI,GAAG,EAAX;;CAEA,UAAIkI,YAAY,CAACjJ,MAAb,CAAoBkhB,OAApB,IAA+BjY,YAAY,CAACjJ,MAAb,CAAoBkhB,OAApB,CAA4B/a,MAA/D,EACA;CACCpF,QAAAA,IAAI,GAAGkI,YAAY,CAACjJ,MAAb,CAAoBkhB,OAApB,CAA4B5J,GAA5B,CAAgC,UAAA3F,MAAM;CAAA,iBAAI,WAASA,MAAT,GAAgB,GAApB;CAAA,SAAtC,EAA+DpN,IAA/D,CAAoE,GAApE,CAAP;CACA;;CAED,UAAI0E,YAAY,CAAClI,IAAjB,EACA;CACC,YAAIA,IAAJ,EACA;CACCA,UAAAA,IAAI,IAAI,IAAR;CACA;;CAEDA,QAAAA,IAAI,IAAIkI,YAAY,CAAClI,IAAb,CAAkBqW,OAAlB,CAA0B,gBAA1B,EAA4C,IAAIwJ,MAAJ,CAAW,EAAX,IAAe,IAA3D,CAAR;CACA;;CAEDze,MAAAA,GAAG,CAAC4H,IAAJ,CAAS,iBAAT,EAA4B;CAAChJ,QAAAA,IAAI,EAAJA;CAAD,OAA5B;CAEC,UAAIL,WAAW,CAACC,EAAZ,CAAeqJ,eAAnB,CAAmC;CACnC/I,QAAAA,OAAO,EAAEyB,EAAE,CAACzB,OAAH,CAAW,kCAAX,CAD0B;CAEnCyD,QAAAA,KAAK,EAAE,WAF4B;CAGnCuF,QAAAA,SAAS,EAAE,SAHwB;CAInCC,QAAAA,OAAO,EAAE,WAJ0B;CAKnCC,QAAAA,QAAQ,EAAE,CALyB;CAMnCC,QAAAA,KAAK,EAAE,QAN4B;CAOnCC,QAAAA,QAAQ,EAAE,IAPyB;CAQnCC,QAAAA,cAAc,EAAE,IARmB;CASnCC,QAAAA,eAAe,EAAE,IATkB;CAUnCC,QAAAA,SAAS,EAAE;CAVwB,OAAnC,EAWE,MAXF,CAAD,CAWYC,IAXZ;CAYA;CAt3EF;CAAA;CAAA,iCAw3EchJ,EAx3Ed,EAy3EC;CAAA;;CACC,WAAKxB,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,kBAApC,EAAwD;CACvDL,QAAAA,QAAQ,EAAE,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD6C;CAEvDjN,QAAAA,MAAM,EAAE;CACP2C,UAAAA,OAAO,EAAElD;CADF;CAF+C,OAAxD,EAKGmL,IALH,CAKQ,YAAM;CACb,YAAI,OAAI,CAAC3M,UAAL,CAAgBoO,QAAhB,GAA2BlK,KAA3B,CAAiCrB,WAAjC,CAA6C4M,MAA7C,CAAoDC,YAAxD,EACA;CACCpP,UAAAA,UAAU,CAAC;CAAA,mBAAM,OAAI,CAACN,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiByJ,cAAlD,EAAkE;CAACC,cAAAA,QAAQ,EAAE,GAAX;CAAgBC,cAAAA,oBAAoB,EAAE,IAAtC;CAA4C+e,cAAAA,KAAK,EAAE;CAAnD,aAAlE,CAAN;CAAA,WAAD,EAAoI,GAApI,CAAV;CACA,SAHD,MAKA;CACC,UAAA,OAAI,CAACvd,YAAL;CACA;CACD,OAdD;CAeA;CAz4EF;CAAA;CAAA,iCA24Ec7J,EA34Ed,EA24EkB2H,QA34ElB,EA44EC;CACC1I,MAAAA,WAAW,CAACyS,MAAZ,CAAmBC,eAAnB,CAAmC,8BAAnC,EAAmE,CAClE,cADkE,EAElE,kBAAgB3R,EAFkD,EAGlE;CACCyB,QAAAA,SAAS,EAAEzB,EADZ;CAECgI,QAAAA,MAAM,EAAEL,QAAQ,CAACK,MAAT,KAAoB,MAApB,GAA4B,MAA5B,GAAqCL,QAAQ,CAACK,MAAT,KAAoB,KAApB,GAA2B,MAA3B,GAAmC;CAFjF,OAHkE,EAOlE,KAPkE,EAQlE,IARkE,CAAnE,EASG,YATH;;CAWA,UAAIL,QAAQ,CAACK,MAAT,KAAoB,KAAxB,EACA;CACClJ,QAAAA,UAAU,CAAC;CAAA,iBAAM4B,GAAG,CAAC4H,IAAJ,CAAS,eAAT,CAAN;CAAA,SAAD,EAAkC,GAAlC,CAAV;CACA;CACD;CA55EF;CAAA;CAAA,4CA85EyBtI,EA95EzB,EA85E6BqnB,SA95E7B,EA+5EC;CACC,UAAI,CAAC1jB,kBAAK,CAACjF,MAAN,CAAaoF,QAAb,CAAsB,KAAKtF,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAAtB,CAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI/N,KAAK,GAAG,EAAZ;;CACA,WAAK,IAAIkI,QAAT,IAAqB0f,SAArB,EACA;CACC,YAAI,CAACA,SAAS,CAACzM,cAAV,CAAyBjT,QAAzB,CAAL,EACA;CACC;CACA;;CAEDlI,QAAAA,KAAK,GAAGA,KAAK,CAAC6nB,MAAN,CAAaD,SAAS,CAAC1f,QAAD,CAAtB,CAAR;CACA;;CAED,WAAKyd,YAAL,CAAkB;CACjB3lB,QAAAA,KAAK,EAAEA,KADU;CAEjBJ,QAAAA,KAAK,EAAE,KAAKyX,WAAL,CAAiB,0BAAjB;CAFU,OAAlB;CAIA;CAp7EF;CAAA;CAAA,wCAu7EC;CACC,WAAKT,OAAL,CAAa,EAAb;CAEA,WAAK7X,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,kBAApC,EAAwD;CACvDL,QAAAA,QAAQ,EAAE,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD6C;CAEvDjN,QAAAA,MAAM,EAAE;CACP2C,UAAAA,OAAO,EAAE,CADF;CAEPM,UAAAA,MAAM,EAAE;CAFD;CAF+C,OAAxD;CAOA;CAj8EF;CAAA;CAAA,gCAm8EaxD,EAn8Eb,EAo8EC;CAAA;;CACC,UAAIR,OAAO,GAAG,KAAKhB,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,qBAAnC,EAA0D,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAA1D,EAAmGzT,EAAnG,CAAd;CAEA,WAAKxB,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,kBAApC,EAAwD;CACvDL,QAAAA,QAAQ,EAAE,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD6C;CAEvDjN,QAAAA,MAAM,EAAE;CACP2C,UAAAA,OAAO,EAAElD,EADF;CAEPwD,UAAAA,MAAM,EAAExD;CAFD;CAF+C,OAAxD,EAMGmL,IANH,CAMQ,YAAM;CACbrM,QAAAA,UAAU,CAAC;CAAA,iBAAM,OAAI,CAACN,UAAL,CAAgB6C,WAAhB,CAA4BC,IAA5B,CAAiCC,kBAAS,CAAC7C,MAAV,CAAiByJ,cAAlD,EAAkE;CAACC,YAAAA,QAAQ,EAAE,GAAX;CAAgBC,YAAAA,oBAAoB,EAAE,KAAtC;CAA6C+e,YAAAA,KAAK,EAAE;CAApD,WAAlE,CAAN;CAAA,SAAD,EAAqI,GAArI,CAAV;;CACA,QAAA,OAAI,CAACvd,YAAL;CACA,OATD;CAWA,WAAKwM,OAAL,CAAa7W,OAAO,CAACF,IAArB;CACA;CAn9EF;CAAA;CAAA,kCAq9EeU,EAr9Ef,EAq9EmBV,IAr9EnB,EAs9EC;CACC,WAAKmK,iBAAL;CAEA,WAAKjL,UAAL,CAAgBoO,QAAhB,GAA2BtM,QAA3B,CAAoC,kBAApC,EAAwD;CACvDL,QAAAA,QAAQ,EAAE,KAAKzB,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAD6C;CAEvDjN,QAAAA,MAAM,EAAE;CACPiD,UAAAA,MAAM,EAAE;CADD;CAF+C,OAAxD;CAOA,WAAK+jB,eAAL,CAAqBvnB,EAArB,EAAyBV,IAAzB;CACA;CAj+EF;CAAA;CAAA,oCAm+EiBU,EAn+EjB,EAm+EqBV,IAn+ErB,EAo+EC;CACC,WAAKd,UAAL,CAAgByK,UAAhB,CAA2BC,UAA3B,CAAsCC,mBAAU,CAACqe,eAAjD,EAAkE;CACjE,sBAAcxnB,EADmD;CAEjE,mBAAWV;CAFsD,OAAlE,EAGG,IAHH,EAGS,IAHT,EAGeqE,kBAAK,CAACmQ,oBAAN,CAA2B;CACzCpU,QAAAA,IAAI,EAAEyJ,mBAAU,CAACqe,eADwB;CAEzC3nB,QAAAA,IAAI,EAAE;CAAC6hB,UAAAA,cAAc,EAAE;CAAjB,SAFmC;CAGzChjB,QAAAA,MAAM,EAAE,KAAKF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B;CAHiC,OAA3B,CAHf;CAQA;CA7+EF;CAAA;CAAA,kCA++EetQ,EA/+Ef,EAg/EC;CAAA;;CACC,UAAIR,OAAO,GAAG,KAAKhB,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,qBAAnC,EAA0D,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAA1D,EAAmGzT,EAAnG,CAAd;CACA,UAAIuD,KAAK,GAAG,KAAK/E,UAAL,CAAgBoO,QAAhB,GAA2BxJ,OAA3B,CAAmC,eAAnC,EAAoD,KAAK5E,UAAL,CAAgB6C,WAAhB,CAA4BoS,SAA5B,EAApD,CAAZ;CAEA,UAAI0M,WAAW,GAAGxc,kBAAK,CAACrE,IAAN,CAAWsE,MAAX,CAAkBpE,OAAO,CAACF,IAA1B,EAAgCE,OAAO,CAACjB,MAAxC,EAAgDgF,KAAhD,EAAuD,KAAKuT,WAAL,EAAvD,CAAlB;CACAqJ,MAAAA,WAAW,GAAGA,WAAW,CAACzb,MAAZ,GAAqB,EAArB,GAAyByb,WAAW,CAACsH,MAAZ,CAAmB,CAAnB,EAAsB,EAAtB,IAA4B,KAArD,GAA4DtH,WAA1E;CAEAzf,MAAAA,GAAG,CAAC4Y,OAAJ,CAAY;CACXja,QAAAA,KAAK,EAAE,KAAKyX,WAAL,CAAiB,oCAAjB,CADI;CAEXxX,QAAAA,IAAI,EAAE6gB,WAAW,GAAE,MAAMA,WAAN,GAAoB,GAAtB,GAA2B,EAFjC;CAGX5G,QAAAA,OAAO,EAAE,CACR,KAAKzC,WAAL,CAAiB,gCAAjB,CADQ,EAER,KAAKA,WAAL,CAAiB,+BAAjB,CAFQ,CAHE;CAOXvI,QAAAA,QAAQ,EAAE,kBAACiL,MAAD,EACV;CACC,cAAIA,MAAM,KAAK,CAAf,EACA;CACC,YAAA,OAAI,CAAC/P,iBAAL;;CACA,YAAA,OAAI,CAACie,iBAAL,CAAuB1nB,EAAvB;CACA;CACD;CAdU,OAAZ;CAgBA;CAvgFF;CAAA;CAAA,sCAygFmBA,EAzgFnB,EA0gFC;CACC,WAAKxB,UAAL,CAAgByK,UAAhB,CAA2BC,UAA3B,CAAsCC,mBAAU,CAACwe,eAAjD,EAAkE;CACjE,sBAAc3nB;CADmD,OAAlE,EAEG,IAFH,EAES,IAFT,EAEe2D,kBAAK,CAACmQ,oBAAN,CAA2B;CACzCpU,QAAAA,IAAI,EAAEyJ,mBAAU,CAACwe,eADwB;CAEzC9nB,QAAAA,IAAI,EAAE,EAFmC;CAGzCnB,QAAAA,MAAM,EAAE,KAAKF,UAAL,CAAgB6C,WAAhB,CAA4BiP,aAA5B,CAA0C,KAAK9R,UAAL,CAAgB6C,WAAhB,CAA4BmM,WAA5B,EAA1C;CAHiC,OAA3B,CAFf;CAOA;CAlhFF;CAAA;CAAA,+BAohFYjP,MAphFZ,EAqhFC;CAAA;;CACCU,MAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8BmY,OAA9B,CAAsC,UAACtoB,IAAD,EAAU;CAC/CA,QAAAA,IAAI,GAAGA,IAAI,CAACuP,QAAL,GAAgBkO,IAAhB,EAAP;CAEAzd,QAAAA,IAAI,GAAGA,IAAI,GAAEA,IAAI,GAAC,GAAL,GAASf,MAAM,CAACe,IAAlB,GAAwBf,MAAM,CAACe,IAA1C;;CAEA,QAAA,OAAI,CAAC+W,OAAL,CAAa/W,IAAb;;CACA,QAAA,OAAI,CAACuK,YAAL;CACA,OAPD;CAQA;CA9hFF;CAAA;CAAA,8BAiiFC;CAAA,UADQvK,IACR,uEADe,EACf;CACCA,MAAAA,IAAI,GAAGA,IAAI,CAACuP,QAAL,EAAP;;CAEA,UAAIvP,IAAJ,EACA;CACCL,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8B4G,OAA9B,CAAsC/W,IAAtC;CACA,OAHD,MAKA;CACCL,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8BoY,KAA9B;CACA;;CAED,WAAKla,kBAAL,CAAwB;CAACnO,QAAAA,OAAO,EAAEF;CAAV,OAAxB;CAEAqK,MAAAA,OAAO,CAACqC,GAAR,CAAY,0BAAZ,EAAwC1M,IAAI,GAAEA,IAAF,GAAQ,aAApD;CACA;CAhjFF;CAAA;CAAA,gCAmjFC;CACC,WAAK+W,OAAL;CACA;CArjFF;CAAA;CAAA,mCAwjFC;CACC,UAAI,CAAC,KAAK7X,UAAL,CAAgBoO,QAAhB,GAA2BlK,KAA3B,CAAiCrB,WAAjC,CAA6C4M,MAA7C,CAAoDC,YAAzD,EACA;CACCjP,QAAAA,WAAW,CAACC,EAAZ,CAAeC,IAAf,CAAoBsQ,SAApB,CAA8BqY,KAA9B;CACA;CACD;CA7jFF;CAAA;CAAA,mCAgkFC;CACC,UAAI,QAAOC,kBAAP,qDAAOA,kBAAP,OAA8B,QAAlC,EACA;CACC,eAAO,KAAP;CACA;;CAED,UACC,OAAOA,kBAAkB,CAACC,WAA1B,KAA0C,UAA1C,IACG,CAACD,kBAAkB,CAACC,WAAnB,EAFL,EAIA;CACC,eAAO,IAAP;CACA;;CAED,UAAI,OAAOD,kBAAkB,CAACE,YAA1B,KAA2C,UAA/C,EACA;CACC,eAAOF,kBAAkB,CAACE,YAAnB,EAAP;CACA;;CAED,aAAO,KAAP;CACA;CAplFF;CAAA;CAAA,iCAulFC;CAEC;CAEF;;CAEA;;CA7lFA;CAAA;CAAA,iDA+lF8BjgB,MA/lF9B,EA+lFsCnI,KA/lFtC,EAgmFC;CACC,UAAIqoB,aAAa,GACjB;CACC1nB,QAAAA,KAAK,EAAE;CAAA,iBAAM,KAAN;CAAA,SADR;CAECX,QAAAA,IAAI,EAAE;CAAA,iBAAMA,KAAI,CAACgC,MAAX;CAAA;CAFP,OADA;CAMA8H,MAAAA,OAAO,CAACqC,GAAR,CAAY,qCAAZ,EAAmDhE,MAAnD,EAA2DnI,KAA3D;;CAEA,UAAImI,MAAM,KAAK,aAAf,EACA;CACC,aAAKxJ,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACoO,YAApD,EAAkE0H,aAAlE,EAAiFroB,KAAI,CAAClB,KAAtF;CACA,OAHD,MAIK,IAAIqJ,MAAM,KAAK,aAAf,EACL;CACC,aAAKmgB,uBAAL;CACA;CACD;CAjnFF;CAAA;CAAA,iDAmnF8BngB,MAnnF9B,EAmnFsCnI,IAnnFtC,EAonFC;CACC,UAAIuoB,WAAW,GACf;CACC5nB,QAAAA,KAAK,EAAE,iBAAM;CACZ,iBAAO;CACNA,YAAAA,KAAK,EAAEX,IAAI,CAACwoB,IADN;CAENnG,YAAAA,iBAAiB,EAAEriB,IAAI,CAACP,IAFlB;CAGNmB,YAAAA,EAAE,EAAE;CACH+N,cAAAA,MAAM,EAAE3O,IAAI,CAAC2O;CADV;CAHE,WAAP;CAOA,SATF;CAUC3O,QAAAA,IAAI,EAAE;CAAA,iBAAM,KAAN;CAAA;CAVP,OADA;CAcA8J,MAAAA,OAAO,CAACqC,GAAR,CAAY,qCAAZ,EAAmDhE,MAAnD,EAA2DnI,IAA3D;;CAEA,UAAImI,MAAM,KAAK,aAAf,EACA;CACC,aAAKxJ,UAAL,CAAgB2U,iBAAhB,CAAkCf,0BAAiB,CAACoO,YAApD,EAAkE4H,WAAlE,EAA+EvoB,IAAI,CAAClB,KAApF;CACA;CACD;CAEF;;CAEA;;CA7oFA;CAAA;CAAA,+BAgpFC;CAAA,UADS0pB,IACT,uEADgB,EAChB;CAAA,UADoBrlB,WACpB,uEADkC,EAClC;CACC2G,MAAAA,OAAO,CAACnJ,KAAR,6BAAmC6nB,IAAnC,eAA4CrlB,WAA5C;CAEA,UAAIslB,mBAAmB,GAAG,EAA1B;;CACA,UAAID,IAAI,CAACE,QAAL,CAAc,WAAd,CAAJ,EACA;CACCD,QAAAA,mBAAmB,GAAGtlB,WAAtB;CACA;;CAED,WAAKxE,UAAL,CAAgBoO,QAAhB,GAA2B9M,MAA3B,CAAkC,iBAAlC,EAAqD;CAACU,QAAAA,KAAK,EAAE;CAC5DgoB,UAAAA,MAAM,EAAE,IADoD;CAE5DH,UAAAA,IAAI,EAAJA,IAF4D;CAG5DrlB,UAAAA,WAAW,EAAEslB;CAH+C;CAAR,OAArD;CAKA;CA9pFF;CAAA;CAAA,iCAiqFC;CACC,WAAK9pB,UAAL,CAAgBoO,QAAhB,GAA2B9M,MAA3B,CAAkC,iBAAlC,EAAqD;CAACU,QAAAA,KAAK,EAAE;CAC5DgoB,UAAAA,MAAM,EAAE,KADoD;CAE5DH,UAAAA,IAAI,EAAE,EAFsD;CAG5DrlB,UAAAA,WAAW,EAAE;CAH+C;CAAR,OAArD;CAKA;CAvqFF;CAAA;CAAA,gCAyqFaylB,OAzqFb,EA0qFC;CACC,aAAO,KAAKjqB,UAAL,CAAgBwC,WAAhB,CAA4BynB,OAA5B,CAAP;CACA;CA5qFF;CAAA;CAAA,gCA8qFa/oB,IA9qFb,EA+qFC;CACC,aAAO,KAAKlB,UAAL,CAAgBsY,WAAhB,CAA4BpX,IAA5B,CAAP;CACA;CAEF;;CAnrFA;CAAA;CAAA;;;;;;;;"}