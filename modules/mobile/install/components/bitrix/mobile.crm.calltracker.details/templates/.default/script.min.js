this.BX=this.BX||{};this.BX.Mobile=this.BX.Mobile||{};this.BX.Mobile.Crm=this.BX.Mobile.Crm||{};(function(t,e){"use strict";var n=function(){function t(e){babelHelpers.classCallCheck(this,t);this.title=e.hasOwnProperty("title")?e.title:"";this.subTitle=e.hasOwnProperty("subTitle")?e.subTitle:"";this.photo=e.hasOwnProperty("photo")?e.photo:"";this.init()}babelHelpers.createClass(t,[{key:"init",value:function t(){BXMobileApp.UI.Page.TopBar.title.setText(this.title);if(this.subTitle.length){BXMobileApp.UI.Page.TopBar.title.setDetailText(this.subTitle)}BXMobileApp.UI.Page.TopBar.title.setImage(this.photo);BXMobileApp.UI.Page.TopBar.title.show()}},{key:"setMenu",value:function t(e){app.menuCreate({items:e});window.BXMobileApp.UI.Page.TopBar.updateButtons({menuButton:{type:"more",style:"custom",callback:function t(){app.menuShow()}}})}},{key:"removeMenu",value:function t(){window.BXMobileApp.UI.Page.TopBar.updateButtons({menuButton:{}})}}],[{key:"create",value:function e(n){return new t(n)}}]);return t}();function i(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t<div class="crm-phonetracker-detail-control-container">\n\t\t\t<div class="crm-phonetracker-detail-control-icon crm-phonetracker-detail-control-icon-avatar" ','></div>\n\t\t\t<div class="crm-phonetracker-detail-control-inner">\n\t\t\t\t<div class="crm-phonetracker-detail-control-title">','</div>\n\t\t\t\t<div class="crm-phonetracker-detail-control-field-container">\n\t\t\t\t\t<input\n\t\t\t\t\t\tonchange="BX.onCustomEvent(\'onCrmCallTrackerNeedToSendForm','\')"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t\tname="CONTACTS[','][FULL_NAME]"\n\t\t\t\t\t\tplaceholder="','"\n\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\tclass="crm-phonetracker-detail-control-field">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>']);i=function e(){return t};return t}var a=function(){function t(e,n,i){babelHelpers.classCallCheck(this,t);this.container=e;this.formId=n;this.init(i)}babelHelpers.createClass(t,[{key:"init",value:function n(i){if(i.id>0){this.isNew=false;this.id=parseInt(i.id);t.ids.push(this.id)}else{this.isNew=true;this.id=["n",t.newIdsCounter++].join("")}this.name=e.Type.isString(i.name)?i.name:"";this.avatar=e.Type.isString(i.avatar)?i.avatar:"";this.draw()}},{key:"getNode",value:function t(){var n=this.avatar!==""?"style=\"background-image: url('".concat(e.Text.encode(this.avatar),"')\""):"";var a=this.avatar!==""?"<i style=\"background-image:url('".concat(e.Text.encode(this.avatar),"')\"></i>"):"";var o=this.onclick.bind(this);return e.Tag.render(i(),n,e.Loc.getMessage("CRM_CONTACT"),this.formId,o,this.id,e.Loc.getMessage("CRM_CONTACT_PLACEHOLDER"),e.Text.encode(this.name))}},{key:"draw",value:function t(){var e=this.getNode();this.container.parentNode.replaceChild(e,this.container);this.container=e}},{key:"onclick",value:function n(){if(this.isNew){var i=["onCrmContactSelectForDeal",this.id].join("_");BX.Mobile.Crm.loadPageModal(e.Uri.addParam(t.selectorUrl,{entity:"contact",event:i}));var a=function(t){BX.removeCustomEvent(i,a);if(t&&t.id){this.init(t);BX.onCustomEvent("onCrmCallTrackerNeedToSendForm".concat(this.formId))}}.bind(this);BXMobileApp.addCustomEvent(i,a)}}}],[{key:"bind",value:function e(n,i,a){a.forEach(function(e){var a=e.id,o=e.name,r=e.avatar;new t(n,i,{id:a,name:o,avatar:r})});if(a.length<=0){new t(n,i,{})}}}]);return t}();babelHelpers.defineProperty(a,"selectorUrl","");babelHelpers.defineProperty(a,"newIdsCounter",0);babelHelpers.defineProperty(a,"ids",[]);function o(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t<div class="crm-phonetracker-detail-control-container">\n\t\t\t<div class="crm-phonetracker-detail-control-icon crm-phonetracker-detail-control-icon-avatar" ','></div>\n\t\t\t<div class="crm-phonetracker-detail-control-inner">\n\t\t\t\t<div class="crm-phonetracker-detail-control-title">','</div>\n\t\t\t\t<div class="crm-phonetracker-detail-control-field-container">\n\t\t\t\t\t<input type="hidden" name="COMPANY[ID]" value="','" >\n\t\t\t\t\t<input\n\t\t\t\t\t\tonchange="BX.onCustomEvent(\'onCrmCallTrackerNeedToSendForm','\')"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\tname="COMPANY[TITLE]"\n\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t','\n\t\t\t\t\t\tplaceholder="','"\n\t\t\t\t\t\tclass="crm-phonetracker-detail-control-field">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>']);o=function e(){return t};return t}var r=function(){function t(e,n,i){babelHelpers.classCallCheck(this,t);this.container=e;this.formId=n;this.init(i)}babelHelpers.createClass(t,[{key:"init",value:function t(n){if(n.id>0){this.isNew=false;this.id=parseInt(n.id)}else{this.isNew=true;this.id=null}this.title=e.Type.isString(n.title)?n.title:"";this.logo=e.Type.isString(n.logo)?n.logo:"";this.draw()}},{key:"getNode",value:function t(){var n=this.logo!==""?"style=\"background-image: url('".concat(e.Text.encode(this.logo),"')\""):"";var i=this.logo!==""?"<i style=\"background-image:url('".concat(e.Text.encode(this.logo),"')\"></i>"):"";var a=this.onclick.bind(this);return e.Tag.render(o(),n,e.Loc.getMessage("CRM_COMPANY"),this.id,this.formId,a,e.Text.encode(this.title),this.id<=0?" readonly ":"",e.Loc.getMessage("CRM_COMPANY_PLACEHOLDER"))}},{key:"draw",value:function t(){var e=this.getNode();this.container.parentNode.replaceChild(e,this.container);this.container=e}},{key:"onclick",value:function n(){if(this.isNew){var i=["onCrmCompanySelectForDeal",this.id].join("_");BX.Mobile.Crm.loadPageModal(e.Uri.addParam(t.selectorUrl,{entity:"company",event:i}));var a=function(t){BX.removeCustomEvent(i,a);if(t&&t.id){this.init({id:t.id,title:t.name,logo:t.image});BX.onCustomEvent("onCrmCallTrackerNeedToSendForm".concat(this.formId))}}.bind(this);BXMobileApp.addCustomEvent(i,a)}}}],[{key:"bind",value:function e(n,i,a){new t(n,i,a)}}]);return t}();babelHelpers.defineProperty(r,"selectorUrl","");var l=function(){function t(){babelHelpers.classCallCheck(this,t)}babelHelpers.createClass(t,null,[{key:"addToIgnored",value:function t(e){BXMobileApp.Events.postToComponent("onCrmCallTrackerAddToIgnoredRequest",{ID:e});BXMobileApp.UI.Page.close()}},{key:"postpone",value:function t(e){BXMobileApp.Events.postToComponent("onCrmCallTrackerPostponeRequest",{ID:e});BXMobileApp.UI.Page.close()}}]);return t}();t.Titlebar=n;t.Contact=a;t.Company=r;t.Action=l})(this.BX.Mobile.Crm.Calltracker=this.BX.Mobile.Crm.Calltracker||{},BX);
//# sourceMappingURL=script.map.js