if(typeof BX.CrmContactListView==="undefined"){BX.CrmContactListView=function(){this._isDirty=false;this._pageAfterOpenHandler=BX.delegate(this._onAfterPageOpen,this)};BX.extend(BX.CrmContactListView,BX.CrmEntityListView);BX.CrmContactListView.prototype.doInitialize=function(){BX.addCustomEvent("onOpenPageAfter",this._pageAfterOpenHandler);var t=this.getSetting("permissions",{});if(t["CREATE"]){BX.CrmMobileContext.getCurrent().createButtons({addPostButton:{type:"plus",style:"custom",callback:BX.delegate(this._onCreate,this)}})}this._classifierContainers={};var e=BX.findChild(this.getContainer(),{className:"crm_entity_classifier"},true,true);if(e){for(var i=0;i<e.length;i++){var r=e[i];var n=r.value;this._classifierContainers[n]=BX.findParent(r,{className:"crm_contact_list_separator"})}}};BX.CrmContactListView.prototype.getContainer=function(){return this._container?this._container:BX.findChild(this._wrapper,{className:"crm_contact_list"},true,false)};BX.CrmContactListView.prototype.getItemContainers=function(){return BX.findChild(this.getContainer(),{className:"crm_contact_list_people"},true,true)};BX.CrmContactListView.prototype.getWaiterClassName=function(){return"crm_contact_list_people_wait"};BX.CrmContactListView.prototype.createModel=function(t,e){var i=this.getDispatcher();return i?i.createEntityModel(t,"CONTACT",e):null};BX.CrmContactListView.prototype.createItemView=function(t){return BX.CrmContactListItemView.create(t)};BX.CrmContactListView.prototype.createSearchParams=function(t){return{FULL_NAME:t}};BX.CrmContactListView.prototype.getMessage=function(t,e){var i=BX.CrmContactListView.messages;return i.hasOwnProperty(t)?i[t]:e};BX.CrmContactListView.prototype.addItemView=function(t){var e=t.getContainer();if(!e){return}var i=this.resolveItemViewContainer(t);i.appendChild(e);var r=BX.findParent(i,{className:"crm_contact_list_separator"});if(r&&r.style.display==="none"){r.style.display=""}};BX.CrmContactListView.prototype.removeItemView=function(t){var e=t.getContainer();if(!e){return}var i=this.resolveItemViewContainer(t);i.removeChild(e);var r=i.childNodes?i.childNodes.length:0;if(r==0){var n=BX.findParent(i,{className:"crm_contact_list_separator"});if(n&&n.style.display===""){n.style.display="none"}}};BX.CrmContactListView.prototype.resolveItemViewContainer=function(t){var e=this.getContainer();var i=t.getModel();var r=i?i.getStringParam("CLASSIFIER"):"";if(typeof this._classifierContainers[r]!=="undefined"){return BX.findChild(this._classifierContainers[r],{className:"crm_contact_list_people_list"},true,false)}var n=BX.create("UL",{attrs:{className:"crm_contact_list_people_list"}});var a=BX.create("LI",{attrs:{className:"crm_contact_list_separator"},children:[BX.create("INPUT",{attrs:{type:"hidden",value:r}}),BX.create("SPAN",{text:r}),n]});var s="";var o=Object.keys(this._classifierContainers);for(var c=0;c<o.length;c++){var l=o[c];if(l>r){s=l}}if(s!==""){e.insertBefore(a,this._classifierContainers[s])}else{e.appendChild(a)}this._classifierContainers[r]=a;return n};BX.CrmContactListView.prototype._onCreate=function(){var t=this.getSetting("editUrl","");if(t!==""){BX.CrmMobileContext.getCurrent().open({url:t,cache:false})}};BX.CrmContactListView.prototype._processExternalCreate=function(t){this._isDirty=true};BX.CrmContactListView.prototype._onAfterPageOpen=function(){if(this._isDirty){if(this.reload(this.getSetting("reloadUrl",true))){this._isDirty=false}}};BX.CrmContactListView.create=function(t,e){var i=new BX.CrmContactListView;i.initialize(t,e);return i};if(typeof BX.CrmContactListView.messages==="undefined"){BX.CrmContactListView.messages={}}}if(typeof BX.CrmContactListItemView==="undefined"){BX.CrmContactListItemView=function(){this._list=this._dispatcher=this._model=this._container=null};BX.extend(BX.CrmContactListItemView,BX.CrmEntityView);BX.CrmContactListItemView.prototype.doInitialize=function(){this._list=this.getSetting("list",null);this._dispatcher=this.getSetting("dispatcher",null);this._model=this.getSetting("model",null);this._container=this.getSetting("container",null);if(!this._model&&this._container){var t=BX.findChild(this._container,{className:"crm_entity_info"},true,false);this._model=t?this._dispatcher.getModelById(t.value):null}if(this._model){this._model.addView(this)}};BX.CrmContactListItemView.prototype.layout=function(){if(this._container){BX.cleanNode(this._container)}else{this._container=BX.create("LI",{attrs:{"class":"crm_contact_list_people"},events:{click:BX.delegate(this._onContainerClick,this)}});this._list.addItemView(this)}var t=this._model;if(!t){return}this._container.appendChild(BX.create("DIV",{attrs:{className:"crm_contactlist_info"},children:[BX.create("IMG",{attrs:{src:t.getStringParam("LIST_IMAGE_URL")}}),BX.create("STRONG",{text:t.getStringParam("FORMATTED_NAME")}),BX.create("SPAN",{text:t.getStringParam("LEGEND")})]}))};BX.CrmContactListItemView.prototype.clearLayout=function(){this._list.removeItemView(this);this._container=null};BX.CrmContactListItemView.prototype.scrollInToView=function(){if(this._container){BX.scrollToNode(this._container)}};BX.CrmContactListItemView.prototype.getContainer=function(){return this._container};BX.CrmContactListItemView.prototype.getModel=function(){return this._model};BX.CrmContactListItemView.prototype.getModelKey=function(){return this._model?this._model.getKey():""};BX.CrmContactListItemView.prototype._onContainerClick=function(t){var e=this._model;if(!e){return}var i=e.getDataParam("SHOW_URL","");if(i!==""){BX.CrmMobileContext.redirect({url:i})}};BX.CrmContactListItemView.prototype.handleModelUpdate=function(t){if(this._model!==t){return}this.layout();if(this._list){this._list.handleItemUpdate(this)}};BX.CrmContactListItemView.prototype.handleModelDelete=function(t){if(this._model!==t){return}this.clearLayout();if(this._list){this._list.handleItemDelete(this)}};BX.CrmContactListItemView.create=function(t){var e=new BX.CrmContactListItemView;e.initialize(t);return e}}
//# sourceMappingURL=script.map.js