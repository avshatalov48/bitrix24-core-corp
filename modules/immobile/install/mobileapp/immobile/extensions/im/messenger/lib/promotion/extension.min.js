jn.define("im/messenger/lib/promotion",((e,t,o)=>{const{Loc:i}=jn.require("loc");const{RestManager:r}=jn.require("im/messenger/lib/rest-manager");const{RestMethod:s}=jn.require("im/messenger/const");const{Logger:n}=jn.require("im/messenger/lib/logger");const{MessengerParams:m}=jn.require("im/messenger/lib/params");const{PromotionService:a}=jn.require("im/messenger/service");class c{constructor(){this.promoCollection={"im:video:01042020:mobile":{type:"spotlight",options:{target:"call_video",text:i.getMessage("IM_PROMO_VIDEO_01042020_MOBILE",{"#BR#":"\n"})}}};this.activePromoList=[];r.once(s.imPromotionGet,{DEVICE_TYPE:"mobile"},this.handlePromotionGet.bind(this))}handlePromotionGet(e){const t=e.error();if(t){n.error("Promotion.handlePromotionGet",t);return}n.info("Promotion.handlePromotionGet",e.data());this.activePromoList=e.data()}checkDialog(e){if(!e.startsWith("chat")&&e!==m.getUserId().toString()){this.show("im:video:01042020:mobile")}}showSpotlight(e){const t=dialogs.createSpotlight();t.setTarget(e.target);t.setHint({text:e.text});t.show()}show(e){if(!this.promoCollection[e]||!this.activePromoList.includes(e)){return false}const t=this.promoCollection[e];if(t.type==="spotlight"){this.showSpotlight(t.options)}this.deleteActivePromo(e);this.read(e);n.info("Promotion.show",e);return true}deleteActivePromo(e){this.activePromoList=this.activePromoList.filter((t=>t!==e))}read(e){a.read(e)}}o.exports={Promotion:new c}}));
//# sourceMappingURL=extension.map.js