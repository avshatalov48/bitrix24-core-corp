(function(){let t=function(t){this.data={id:BX.prop.getInteger(t,"id",0),name:BX.prop.getString(t,"name",""),avatar:BX.prop.getString(t,"avatar",""),gender:BX.prop.getString(t,"gender",""),state:BX.prop.getString(t,"state",BX.Call.UserState.Idle),talking:BX.prop.getBoolean(t,"talking",false),cameraState:BX.prop.getBoolean(t,"cameraState",false),videoPaused:BX.prop.getBoolean(t,"videoPaused",false),microphoneState:BX.prop.getBoolean(t,"microphoneState",true),screenState:BX.prop.getBoolean(t,"screenState",false),floorRequestState:BX.prop.getBoolean(t,"floorRequestState",false),localUser:BX.prop.getBoolean(t,"localUser",false),centralUser:BX.prop.getBoolean(t,"centralUser",false),pinned:BX.prop.getBoolean(t,"pinned",false),presenter:BX.prop.getBoolean(t,"presenter",false),order:BX.prop.getInteger(t,"order",false)};for(var e in this.data){if(this.data.hasOwnProperty(e)){Object.defineProperty(this,e,{get:this._getField(e).bind(this),set:this._setField(e).bind(this)})}}this.onUpdate={talking:this._onUpdateTalking.bind(this),state:this._onUpdateState.bind(this)};this.talkingStop=null;this.eventEmitter=new JNEventEmitter};t.Event={Changed:"changed"};t.prototype._getField=function(t){return function(){return this.data[t]}};t.prototype._setField=function(e){return function(n){var r=this.data[e];if(r==n){return}this.data[e]=n;if(this.onUpdate.hasOwnProperty(e)){this.onUpdate[e](n,r)}this.eventEmitter.emit(t.Event.Changed,[{user:this,fieldName:e,oldValue:r,newValue:n}])}};t.prototype._onUpdateTalking=function(t){if(t){this.floorRequestState=false}else{this.talkingStop=(new Date).getTime()}};t.prototype._onUpdateState=function(t){if(t!=BX.Call.UserState.Connected){this.talking=false;this.screenState=false;this.floorRequestState=false}};t.prototype.wasTalkingAgo=function(){if(this.state!=BX.Call.UserState.Connected){return+Infinity}if(this.talking){return 0}if(!this.talkingStop){return+Infinity}return(new Date).getTime()-this.talkingStop};t.prototype.subscribe=function(t,e){this.eventEmitter.on(t,e)};t.prototype.unsubscribe=function(t,e){this.eventEmitter.off(t,e)};var e=function(t){this.users=BX.prop.getArray(t,"users",[]);this.eventEmitter=new JNEventEmitter;this._sort()};e.Event={UserAdded:"userAdded",UserChanged:"userChanged"};e.prototype.subscribe=function(t,e){this.eventEmitter.on(t,e)};e.prototype.get=function(t){for(var e=0;e<this.users.length;e++){if(this.users[e].id==t){return this.users[e]}}return null};e.prototype.push=function(n){if(!(n instanceof t)){throw Error("user should be instance of UserModel")}this.users.push(n);this._sort();n.subscribe(t.Event.Changed,this._onUserChanged.bind(this));this.eventEmitter.emit(e.Event.UserAdded,[{user:n}])};e.prototype._onUserChanged=function(t){this.eventEmitter.emit(e.Event.UserChanged,[t.data])};e.prototype._sort=function(){this.users=this.users.sort((function(t,e){return t.order-e.order}))};window.UserModel=t;window.UserRegistry=e})();
//# sourceMappingURL=extension.map.js