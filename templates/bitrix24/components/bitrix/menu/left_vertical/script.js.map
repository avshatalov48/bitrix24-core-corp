{"version":3,"file":"script.js","sources":["src/options.js","src/controllers/default-controller.js","src/controllers/preset-custom-controller.js","src/utils/admin-panel.js","src/utils.js","src/controllers/preset-default-controller.js","src/controllers/settings-controller.js","src/backend.js","src/items/item.js","src/items/item-user-favorites.js","src/items/item-user-self.js","src/items/item-admin-shared.js","src/items/item-admin-custom.js","src/items/item-system.js","src/items/item-group.js","src/items/item-group-system.js","src/items/index.js","src/items/item-active.js","src/controllers/items-controller.js","src/controllers/item-director.js","src/menu.js"],"sourcesContent":["import {Type} from 'main.core';\n\nexport default class Options {\n\tstatic version = '2021.10';\n\tstatic eventNameSpace = 'BX.Intranet.LeftMenu:';\n\tstatic eventName(name) {\n\t\treturn ['BX.Intranet.LeftMenu:', ...(Type.isStringFilled(name) ? [name] : name)].join(':')\n\t}\n\n\tstatic isExtranet = false;\n\tstatic isAdmin = false;\n\tstatic isCustomPresetRestricted = false;\n}","import {Loc} from 'main.core';\nimport {Menu, MenuItem} from 'main.popup';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport Options from '../options';\n\nexport default class DefaultController\n{\n\tcontainer;\n\t#popup = null;\n\n\tconstructor(\n\t\tcontainer, {\n\t\t\tevents\n\t\t}\n\t)\n\t{\n\t\tthis.container = container;\n\t\tif (events)\n\t\t{\n\t\t\tArray\n\t\t\t\t.from(Object.keys(events))\n\t\t\t\t.forEach((key) => {\n\t\t\t\t\tEventEmitter.subscribe(this, Options.eventName(key), events[key])\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tgetContainer(): ?Element\n\t{\n\t\treturn this.container;\n\t}\n\n\tcreatePopup(): Popup\n\t{\n\n\t}\n\n\tgetPopup()\n\t{\n\t\treturn this.#popup;\n\t}\n\n\tshow()\n\t{\n\t\tif (this.#popup === null)\n\t\t{\n\t\t\tthis.#popup = this.createPopup(...arguments);\n\t\t\tEventEmitter.subscribe(this.#popup, 'onClose', () => {\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onClose'));\n\t\t\t});\n\t\t\tEventEmitter.subscribe(this.#popup, 'onShow', () => {\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onShow'));\n\t\t\t});\n\t\t\tEventEmitter.subscribe(this.#popup, 'onDestroy', () => {\n\t\t\t\tthis.#popup = null;\n\t\t\t});\n\t\t}\n\t\tthis.#popup.show()\n\t}\n\n\thide()\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\tthis.#popup.close();\n\t\t}\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager} from 'main.popup';\nimport DefaultController from './default-controller';\nimport Options from \"../options\";\nimport {CancelButton, SaveButton} from 'ui.buttons';\n\nexport default class PresetCustomController extends DefaultController\n{\n\tisReady: boolean = true;\n\n\tcreatePopup()\n\t{\n\t\tconst form = Tag.render`\n\t\t\t<form id=\"customPresetForm\" style=\"min-width: 350px;\">\n\t\t\t\t<div style=\"margin: 15px 0 15px 9px;\">\n\t\t\t\t\t<input type=\"radio\" name=\"userScope\" id=\"customPresetCurrentUser\" value=\"currentUser\">\n\t\t\t\t\t<label for=\"customPresetCurrentUser\">${Loc.getMessage(\"MENU_CUSTOM_PRESET_CURRENT_USER\")}</label>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"margin: 0 0 38px 9px;\">\n\t\t\t\t\t<input type=\"radio\" name=\"userScope\" id=\"customPresetNewUser\" value=\"newUser\" checked>\n\t\t\t\t\t<label for=\"customPresetNewUser\">${Loc.getMessage(\"MENU_CUSTOM_PRESET_NEW_USER\")}</label>\n\t\t\t\t</div>\n\t\t\t\t<hr style=\"background-color: #edeef0; border: none; color:  #edeef0; height: 1px;\">\n\t\t\t</form>`\n\t\t;\n\n\t\tlet button;\n\t\treturn PopupManager.create(\n\t\t\tthis.constructor.toString(), null, {\n\t\t\toverlay: true,\n\t\t\tcontentColor : \"white\",\n\t\t\tcontentNoPaddings : true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\ttitleBar: Loc.getMessage(\"MENU_CUSTOM_PRESET_POPUP_TITLE\"),\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\t(button = new SaveButton({ onclick: () => {\n\t\t\t\t\tif (this.isReady === false)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\tthis.isReady = false;\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsSet'), form.elements[\"userScope\"].value === 'newUser')\n\t\t\t\t\t\t.forEach((promise) => {\n\t\t\t\t\t\t\tpromise\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t\tPopupManager.create(\"menu-custom-preset-success-popup\", null, {\n\t\t\t\t\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\t\t\t\t\tcontentColor : \"white\",\n\t\t\t\t\t\t\t\t\t\ttitleBar: Loc.getMessage(\"MENU_CUSTOM_PRESET_POPUP_TITLE\"),\n\t\t\t\t\t\t\t\t\t\tcontent: Loc.getMessage(\"MENU_CUSTOM_PRESET_SUCCESS\")\n\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t\t\tconsole.log('Error!!')\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}})),\n\t\t\t\tnew CancelButton({ onclick: () => { this.hide();} }),\n\t\t\t]\n\t\t});\n\t}\n}","import {EventEmitter} from 'main.core.events';\nimport Options from \"../options\";\nexport default class AdminPanel\n{\n\tstatic #instance: AdminPanel = null;\n\tcontainer: Element;\n\n\tconstructor()\n\t{\n\t\tthis.container = BX(\"bx-panel\");\n\t\tif (this.container)\n\t\t{\n\t\t\tthis.bindEvents();\n\t\t}\n\t}\n\n\tbindEvents()\n\t{\n\t\tBX.addCustomEvent(\"onTopPanelCollapse\", function(isCollapsed)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onPanelHasChanged'), this.top);\n\t\t}.bind(this));\n\n\t\tBX.addCustomEvent(\"onTopPanelFix\", function() {\n\t\t\tEventEmitter.emit(this, Options.eventName('onPanelHasChanged'), this.top);\n\t\t}.bind(this));\n\t}\n\n\tget height(): number\n\t{\n\t\treturn this.container ? this.container.offsetHeight : 0;\n\t}\n\n\tget fixedHeight(): number\n\t{\n\t\tconst adminPanelState = BX.getClass(\"BX.admin.panel.state\");\n\t\tif (adminPanelState && adminPanelState.fixed)\n\t\t{\n\t\t\treturn this.height;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget top()\n\t{\n\t\tif (this.container)\n\t\t{\n\t\t\tconst rect = this.container.getBoundingClientRect();\n\n\t\t\tif (rect.bottom > 0)\n\t\t\t{\n\t\t\t\treturn Math.max(rect.bottom, this.fixedHeight);\n\t\t\t}\n\t\t\treturn Math.max(0, this.fixedHeight);\n\t\t}\n\t\treturn 0;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new AdminPanel();\n\t\t}\n\t\treturn this.#instance;\n\t}\n}","import {Loc, Uri} from 'main.core';\nimport AdminPanel from \"./utils/admin-panel\";\n\nexport default class Utils {\n\tstatic #curPage = null;\n\tstatic #curUri = null;\n\n\tstatic getCurPage(): ?String\n\t{\n\t\tif (this.#curPage === null)\n\t\t{\n\t\t\tthis.#curPage = document.location.pathname + document.location.search;\n\t\t}\n\t\treturn this.#curPage === '' ? null : this.#curPage;\n\t}\n\n\tstatic getCurUri(): Uri\n\t{\n\t\tif (this.#curUri === null)\n\t\t{\n\t\t\tthis.#curUri = new Uri(document.location.href);\n\t\t}\n\t\treturn this.#curUri;\n\t}\n\n\tstatic catchError(response) {\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: [Loc.getMessage(\"MENU_ERROR_OCCURRED\"),\n\t\t\t\t(response.errors ? ': ' + response.errors[0].message : '')].join(' '),\n\t\t\tposition: 'bottom-left',\n\t\t\tcategory: 'menu-self-item-popup',\n\t\t\tautoHideDelay: 3000\n\t\t});\n\t}\n\tstatic refineUrl(url)\n\t{\n\t\turl = String(url).trim();\n\t\tif (url !== '')\n\t\t{\n\t\t\tif (!url.match(/^https?:\\/\\//i) && !url.match(/^\\//i))\n\t\t\t{\n\t\t\t\t//for external links like \"google.com\" (without a protocol)\n\t\t\t\turl = \"http://\" + url;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvar link = document.createElement(\"a\");\n\t\t\t\tlink.href = url;\n\n\t\t\t\tif (document.location.host === link.host)\n\t\t\t\t{\n\t\t\t\t\t// http://portal.com/path/ => /path/\n\t\t\t\t\turl = link.pathname + link.search + link.hash;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn url;\n\t}\n\n\tstatic get adminPanel(): AdminPanel\n\t{\n\t\treturn AdminPanel.getInstance();\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager} from 'main.popup';\nimport DefaultController from './default-controller';\nimport Options from \"../options\";\nimport Utils from \"../utils\";\nimport {CancelButton, CreateButton} from 'ui.buttons';\n\nexport default class PresetDefaultController extends DefaultController\n{\n\tisReady: boolean = true;\n\n\tcreatePopup(mode): Popup\n\t{\n\t\tlet button;\n\t\tconst content = document.querySelector('#left-menu-preset-popup').cloneNode(true);\n\t\treturn PopupManager.create(\n\t\t\tthis.constructor.name.toString(), null, {\n\t\t\toverlay: true,\n\t\t\tcontentColor : \"white\",\n\t\t\tcontentNoPaddings : true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: content,\n\t\t\tevents: {\n\t\t\t\tonFirstShow: () => {\n\t\t\t\t\t[...content.querySelectorAll('.js-left-menu-preset-item')]\n\t\t\t\t\t\t.forEach((node) => {\n\t\t\t\t\t\t\tnode.addEventListener('click', () => {\n\t\t\t\t\t\t\t\t[...content.querySelectorAll('.js-left-menu-preset-item')]\n\t\t\t\t\t\t\t\t\t.forEach((otherNode) => {\n\t\t\t\t\t\t\t\t\t\totherNode.classList[otherNode === node ? 'add' : 'remove']('left-menu-popup-selected');\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\t(button = new CreateButton({\n\t\t\t\t\ttext: Loc.getMessage('MENU_CONFIRM_BUTTON'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\tif (button.isWaiting())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbutton.setWaiting(true);\n\n\t\t\t\t\tlet currentPreset = \"\";\n\t\t\t\t\tif (document.forms[\"left-menu-preset-form\"])\n\t\t\t\t\t{\n\t\t\t\t\t\t[...document.forms[\"left-menu-preset-form\"]\n\t\t\t\t\t\t\t.elements[\"presetType\"]]\n\t\t\t\t\t\t\t.forEach((node) => {\n\t\t\t\t\t\t\t\tif (node.checked)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcurrentPreset = node.value;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsSet'),\n\t\t\t\t\t\t{presetId: currentPreset, mode})\n\t\t\t\t\t\t.forEach((promise) => {\n\t\t\t\t\t\t\tpromise\n\t\t\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty(\"url\"))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdocument.location.href = response.data.url;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(Utils.catchError)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}})),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\ttext: Loc.getMessage('MENU_DELAY_BUTTON'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsPostponed'), {mode});\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t} }),\n\t\t\t]\n\t\t});\n\t}\n}","import {Loc} from 'main.core';\nimport {Menu, MenuItem} from 'main.popup';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport Options from '../options';\nimport DefaultController from './default-controller';\n\nexport default class SettingsController extends DefaultController\n{\n\tmenuId = 'leftMenuSettingsPopup';\n\n\tcreatePopup()\n\t{\n\t\tconst menu = new Menu({\n\t\t\tbindElement: this.container,\n\t\t\titems: this.getItems(),\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 50,\n\t\t\t// cacheable: false,\n\t\t});\n\t\treturn menu.getPopupWindow();\n\t}\n\n\tgetItems(): Array\n\t{\n\t\tconst menuItems = [];\n\t\tArray.from(...EventEmitter.emit(this,\n\t\t\tOptions.eventName('onGettingSettingMenuItems'),\n\t\t)).forEach(({text, html, onclick, className}) => {\n\t\t\tif (!text && !html)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmenuItems.push(Object.assign(html ? {\n\t\t\t\thtml: html\n\t\t\t} : {\n\t\t\t\ttext : text}, {\n\t\t\t\tclassName: [\"menu-popup-no-icon\", className ?? ''].join(' '),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tonclick(event, item);\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\t\treturn menuItems;\n\t}\n}","import {ajax, Loc} from 'main.core';\nimport Options from './options';\n\nexport default class Backend {\n\n\tstatic toggleMenu(collapse) {\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction(`intranet.leftmenu.${collapse ? \"collapseMenu\" : \"expandMenu\"}`, {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: { leftmenu: {action: collapse ? \"collapseMenu\" : \"expandMenu\"} }\n\t\t});\n\t}\n\n\tstatic saveSelfItemMenu(itemData) {\n\t\tconst action =  itemData.id > 0 ? \"update\" : \"add\";\n\t\treturn ajax.runAction(`intranet.leftmenu.${action}SelfItem`, {\n\t\t\tdata: {itemData: itemData },\n\t\t\tanalyticsLabel: { leftmenu: {action: 'selfItemAddOrUpdate'} }\n\t\t});\n\t}\n\n\tstatic deleteSelfITem(id) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteSelfItem', {\n\t\t\tdata: {menuItemId: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'selfItemDelete'}}\n\t\t});\n\t}\n\n\tstatic addFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.addStandartItem', {\n\t\t\tdata: { itemData: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemAdd'}}\n\t\t});\n\t}\n\n\tstatic deleteFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteStandartItem', {\n\t\t\tdata: { itemData: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemDelete'}}\n\t\t});\n\t}\n\n\tstatic updateFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.updateStandartItem', {\n\t\t\tdata: {\n\t\t\t\titemText: itemData.text,\n\t\t\t\titemId: itemData.id,\n\t\t\t},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemUpdate'}}\n\t\t})\n\t}\n\tstatic addAdminSharedItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.addItemToAll', {\n\t\t\tdata: { itemInfo: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'adminItemAdd'}}\n\t\t});\n\t}\n\n\tstatic deleteAdminSharedItemMenu(id) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteItemFromAll', {\n\t\t\tdata: { menu_item_id: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'adminItemDelete'}}\n\t\t});\n\t}\n\n\tstatic saveItemsSort(menuItems, firstItemLink, analyticsLabel)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.saveItemsSort', {\n\t\t\tdata: {\n\t\t\t\titems: menuItems,\n\t\t\t\tfirstItemLink: firstItemLink,\n\t\t\t\tversion: Options.version\n\t\t\t},\n\t\t\tanalyticsLabel: {leftmenu: analyticsLabel}\n\t\t});\n\t}\n\n\tstatic setFirstPage(firstPageLink)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setFirstPage', {\n\t\t\tdata: {firstPageUrl: firstPageLink},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'mainPageIsSet'}}\n\t\t})\n\t}\n\n\tstatic setDefaultPreset()\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setDefaultMenu', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'defaultMenuIsSet'}}\n\t\t});\n\t}\n\n\tstatic setCustomPreset(forNewUsersOnly, itemsSort, customItems, firstItemLink)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.saveCustomPreset', {\n\t\t\tdata: {\n\t\t\t\tuserApply: forNewUsersOnly === true ? 'newUser' : 'currentUser',\n\t\t\t\titemsSort: itemsSort,\n\t\t\t\tcustomItems: customItems,\n\t\t\t\tfirstItemLink: firstItemLink,\n\t\t\t\tversion: Options.version\n\t\t\t},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'customPresetIsSet'} }\n\t\t});\n\t}\n\n\tstatic deleteCustomItem(id)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.deleteCustomItemFromAll', {\n\t\t\tdata: {menu_item_id: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'customItemDelete'}}\n\t\t});\n\t}\n\n\tstatic setSystemPreset(mode, presetId)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setPreset', {\n\t\t\tdata: {\n\t\t\t\tpreset: presetId,\n\t\t\t\tmode: mode === 'global' ? 'global' : 'personal'\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tleftmenu: {\n\t\t\t\t\taction: 'systemPresetIsSet',\n\t\t\t\t\tpresetId: presetId,\n\t\t\t\t\tmode: mode,\n\t\t\t\t\tanalyticsFirst: mode === 'global' ? 'y' : 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic postponeSystemPreset(mode)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.delaySetPreset', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {\n\t\t\t\tleftmenu: {\n\t\t\t\t\taction: 'systemPresetIsPostponed',\n\t\t\t\t\tmode: mode,\n\t\t\t\t\tanalyticsFirst: mode === 'global' ? 'y' : 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic clearCache()\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.clearCache', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'clearCache'} }\n\t\t});\n\t}\n\n\tstatic expandGroup(id)\n\t{\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction('intranet.leftmenu.expandMenuGroup', {\n\t\t\tdata: {id},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'expandMenuGroup' }}\n\t\t});\n\t}\n\n\tstatic collapseGroup(id)\n\t{\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction('intranet.leftmenu.collapseMenuGroup', {\n\t\t\tdata: {id},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'collapseMenuGroup' }}\n\t\t});\n\t}\n}","import {Event, Uri, Type, Loc, Text, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager, Menu, MenuItem} from 'main.popup';\nimport Options from \"../options\";\nimport Utils from \"../utils\";\nimport {SaveButton, CancelButton} from 'ui.buttons';\n\nexport default class Item\n{\n\tstatic code = 'abstract';\n\n\tparentContainer: Element;\n\tcontainer: Element;\n\tlinks = [];\n\tisDraggable = true;\n\tstorage: Array = [];\n\n\tconstructor(parentContainer, container)\n\t{\n\t\tthis.parentContainer = parentContainer;\n\t\tthis.container = container;\n\t\tthis.init();\n\n\t\tthis.onDeleteAsFavorites = this.onDeleteAsFavorites.bind(this);\n\t\tsetTimeout(() => {\n\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\t\tEventEmitter.incrementMaxListeners(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'));\n\t\t\tEventEmitter.subscribe(this, Options.eventName('onItemDelete'), this.destroy.bind(this));\n\t\t}, 0);\n\t\tthis.showError = this.showError.bind(this);\n\t\tthis.showMessage = this.showMessage.bind(this);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.container.dataset.id;\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.constructor.code;\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.container.querySelector(\"[data-role='item-text']\").textContent;\n\t}\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tdelete()\n\t{\n\t\t// Just do it.\n\t}\n\n\tinit()\n\t{\n\t\tthis.links = [];\n\t\tif (\n\t\t\tthis.container.hasAttribute('data-link')\n\t\t\t&& Type.isStringFilled(this.container.getAttribute(\"data-link\"))\n\t\t)\n\t\t{\n\t\t\tthis.links.push(\n\t\t\t\tthis.container.getAttribute(\"data-link\")\n\t\t\t);\n\t\t}\n\n\t\tif (this.container\n\t\t\t.hasAttribute(\"data-all-links\"))\n\t\t{\n\t\t\tthis.container\n\t\t\t\t.getAttribute(\"data-all-links\")\n\t\t\t\t.split(\",\")\n\t\t\t\t.forEach((link) => {\n\t\t\t\t\tlink = String(link).trim();\n\t\t\t\t\tif (Type.isStringFilled(link))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.links.push(\n\t\t\t\t\t\t\tlink\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\tthis.makeTextIcons();\n\t\tthis.storage = this.container.dataset.storage.split(',');\n\t}\n\n\tupdate({link, openInNewPage, text})\n\t{\n\t\topenInNewPage = (openInNewPage === 'Y' ? 'Y' : 'N');\n\n\t\tif (this.container.hasAttribute('data-link'))\n\t\t{\n\t\t\tthis.container.setAttribute('data-link', Text.encode(link));\n\t\t\tthis.container.setAttribute('data-new-page', openInNewPage);\n\t\t}\n\n\t\tconst linkNode = this.container.querySelector('a');\n\t\tif (linkNode)\n\t\t{\n\t\t\tlinkNode.setAttribute('href', Text.encode(link));\n\t\t\tlinkNode.setAttribute('target', openInNewPage === 'Y' ? '_blank' : '_self');\n\t\t}\n\t\tthis.container.querySelector(\"[data-role='item-text']\").innerHTML = Text.encode(text);\n\t\tthis.init();\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\tEventEmitter.decrementMaxListeners(EventEmitter.GLOBAL_TARGET, 'onItemDeleteAsFavorites');\n\t}\n\n\tgetSimilarToUrl(currentUri: Uri): Array\n\t{\n\t\tconst result = [];\n\n\t\tthis.links.forEach((link, index) => {\n\t\t\tif (areUrlsEqual(link, currentUri))\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tpriority: index > 0 ? 0 : 1, // main link is in higher priority\n\t\t\t\t\turl: link\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\tmakeTextIcons()\n\t{\n\t\tif (!this.container.classList.contains(\"menu-item-no-icon-state\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst icon = this.container.querySelector(\".menu-item-icon\");\n\t\tconst text = this.container.querySelector(\".menu-item-link-text\");\n\n\t\tif (icon && text)\n\t\t{\n\t\t\ticon.textContent = getShortName(text.textContent);\n\t\t}\n\t}\n\n\tgetCounterValue(): ?number\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn parseInt(node.dataset.counterValue);\n\t}\n\n\tupdateCounter(counterValue)\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst oldValue = parseInt(node.dataset.counterValue) || 0;\n\t\tnode.dataset.counterValue = counterValue;\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('menu-item-with-index');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t\tif (counterValue < 0) // TODO need to know what it means\n\t\t\t{\n\t\t\t\tconst warning = BX('menu-counter-warning-' + this.getId());\n\t\t\t\tif (warning)\n\t\t\t\t{\n\t\t\t\t\twarning.style.display = 'inline-block';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {oldValue, newValue: counterValue};\n\t}\n\n\tmarkAsActive()\n\t{\n\t\tconsole.error('This action is only for the group');\n\t}\n\n\tshowWarning(title, events)\n\t{\n\t\tthis.removeWarning();\n\t\tconst link = this.container.querySelector(\"a.menu-item-link\");\n\t\tif (!link)\n\t\t{\n\t\t\treturn\n\t\t}\n\t\ttitle = title ? Text.encode(title) : '';\n\t\tconst node = Tag.render`<a class=\"menu-post-warn-icon\" title=\"${title}\"></a>`;\n\t\tif (events)\n\t\t{\n\t\t\tObject.keys(events).forEach((key) => {\n\t\t\t\tEvent.bind(node, key, events[key]);\n\t\t\t});\n\t\t}\n\t\tthis.container.classList.add(\"menu-item-warning-state\");\n\t\tlink.appendChild(node);\n\t}\n\n\tremoveWarning()\n\t{\n\t\tif (!this.container.classList.contains('menu-item-warning-state'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.container.classList.remove('menu-item-warning-state');\n\t\tlet node;\n\t\twhile (node = this.container.querySelector(\"a.menu-post-warn-icon\"))\n\t\t{\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t}\n\n\tshowMessagePopup;\n\tshowMessage(message)\n\t{\n\t\tif (this.showMessagePopup)\n\t\t{\n\t\t\tthis.showMessagePopup.close();\n\t\t}\n\t\tthis.showMessagePopup = PopupManager.create(\"left-menu-message\", this.container,\n\t\t\t{\n\t\t\t\tcontent: '<div class=\"left-menu-message-popup\">' + message + '</div>',\n\t\t\t\tdarkMode: true,\n\t\t\t\toffsetTop: 2,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => { this.showMessagePopup = null;}\n\t\t\t\t},\n\t\t\t\tautoHide: true\n\t\t\t});\n\n\t\tthis.showMessagePopup.show();\n\n\t\tsetTimeout(() => { if (this.showMessagePopup) {this.showMessagePopup.close()} }, 3000);\n\t}\n\n\tshowError(response)\n\t{\n\t\tconst errors = [];\n\t\tif (response.errors)\n\t\t{\n\t\t\terrors.push(response.errors[0].message);\n\t\t}\n\t\telse if (response instanceof TypeError)\n\t\t{\n\t\t\terrors.push(response.message);\n\t\t}\n\n\t\tconst message = [Loc.getMessage(\"MENU_ERROR_OCCURRED\"), ...errors].join(' ');\n\t\tthis.showMessage(message);\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\treturn [];\n\t}\n\n\tgetEditFields(): Object\n\t{\n\t\treturn {id: this.getId(), text: this.getName()};\n\t}\n\n\tonDeleteAsFavorites({data})\n\t{\n\t\tif (String(data.id) === String(this.getId()))\n\t\t{\n\t\t\tif (this.getCode() === 'standard'/* instanceof ItemUserFavorites*/)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {\n\t\t\t\t\titem: this,\n\t\t\t\t\tanimate: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.storage = [...this.storage].filter((v) => {return v !== 'standard'});\n\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t}\n\t\t\tEventEmitter.unsubscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\t\tEventEmitter.decrementMaxListeners(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'));\n\t\t\t}\n\t}\n\n\tstatic detect(node)\n\t{\n\t\treturn node.getAttribute(\"data-role\") !== 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n\n\tstatic createNode({id, text, link, openInNewPage, counterId, counterValue, topMenuId})\n\t{\n\t\tid = Text.encode(id);\n\t\ttext = Text.encode(text);\n\t\tlink = Text.encode(link);\n\t\tcounterId = counterId ? Text.encode(counterId) : '';\n\t\tcounterValue = counterValue ? parseInt(counterValue) : 0;\n\t\topenInNewPage = openInNewPage === 'Y' ? 'Y' : 'N';\n\t\treturn Tag.render`<li \n\t\t\tid=\"bx_left_menu_${id}\" \n\t\t\tdata-status=\"show\" \n\t\t\tdata-id=\"${id}\" \n\t\t\tdata-role=\"item\"\n\t\t\tdata-storage=\"\" \n\t\t\tdata-counter-id=\"${counterId}\" \n\t\t\tdata-link=\"${link}\" \n\t\t\tdata-all-links=\"\" \n\t\t\tdata-type=\"${this.code}\" \n\t\t\tdata-delete-perm=\"Y\" \n\t\t\t${topMenuId ? `data-top-menu-id=\"${Text.encode(topMenuId)}\"` : \"\"}\n\t\t\tdata-new-page=\"${openInNewPage}\" \n\t\t\tclass=\"menu-item-block menu-item-no-icon-state\">\n\t\t\t\t<span class=\"menu-favorites-btn menu-favorites-draggable\">\n\t\t\t\t\t<span class=\"menu-fav-draggable-icon\"></span>\n\t\t\t\t</span>\n\t\t\t\t<a class=\"menu-item-link\" data-slider-ignore-autobinding=\"true\" href=\"${link}\" target=\"${openInNewPage === 'Y' ? '_blank' : '_self'}\">\n\t\t\t\t\t<span class=\"menu-item-icon-box\">\n\t\t\t\t\t\t<span class=\"menu-item-icon\">W</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"menu-item-link-text \" data-role=\"item-text\">${text}</span>\n\t\t\t\t\t${counterId ? \n\t\t\t\t\t`<span class=\"menu-item-index-wrap\">\n\t\t\t\t\t\t<span data-role=\"counter\"\n\t\t\t\t\t\t\tdata-counter-value=\"${counterValue}\" class=\"menu-item-index\" id=\"menu-counter-${counterId}\">${counterValue}</span>\n\t\t\t\t\t</span>` : '' }\n\t\t\t\t</a>\n\t\t\t\t<span data-role=\"item-edit-control\" class=\"menu-fav-editable-btn menu-favorites-btn\">\n\t\t\t\t\t<span class=\"menu-favorites-btn-icon\"></span>\n\t\t\t\t</span>\n\t\t\t</li>`;\n\t}\n\n\t//region Edition for siblings\n\tstatic backendSaveItem(itemInfo): Promise\n\t{\n\t\tthrow 'Function backendSaveItem must be replaced';\n\t}\n\tstatic popup: Popup;\n\tstatic showUpdate(item: Item)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.showForm(item.container, item.getEditFields(), resolve, reject);\n\t\t});\n\t}\n\tstatic checkForm(form: HTMLFormElement): boolean\n\t{\n\t\tif (String(form.elements[\"text\"].value).trim().length <= 0)\n\t\t{\n\t\t\tform.elements[\"text\"].classList.add('menu-form-input-error');\n\t\t\tform.elements[\"text\"].focus();\n\t\t\treturn false;\n\t\t}\n\t\tif (form.elements[\"link\"])\n\t\t{\n\t\t\tif (String(form.elements[\"link\"].value).trim().length <= 0 ||\n\t\t\t\tUtils.refineUrl(form.elements[\"link\"].value).length <= 0)\n\t\t\t{\n\t\t\t\tform.elements[\"link\"].classList.add('menu-form-input-error');\n\t\t\t\tform.elements[\"link\"].focus();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tform.elements[\"link\"].value = Utils.refineUrl(form.elements[\"link\"].value);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tstatic showForm(bindElement, itemInfo, resolve, reject)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\n\t\tconst isEditMode = itemInfo.id !== '';\n\t\tconst form = Tag.render`\n<form name=\"menuAddToFavoriteForm\">\n\t<input type=\"hidden\" name=\"id\" value=\"${Text.encode(itemInfo.id || '')}\">\n\t<label for=\"menuPageToFavoriteName\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_ITEM_NAME\")}</label>\n\t<input name=\"text\" type=\"text\" id=\"menuPageToFavoriteName\" class=\"menu-form-input\" value=\"${Text.encode(itemInfo.text || '')}\" >\n\t${itemInfo['link'] !== undefined ? `<br><br>\n\t<label for=\"menuPageToFavoriteLink\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_ITEM_LINK\")}</label>\n\t<input name=\"link\" id=\"menuPageToFavoriteLink\" type=\"text\" class=\"menu-form-input\" value=\"${Text.encode(itemInfo.link)}\" >` : ''}\n\t${itemInfo['openInNewPage'] !== undefined ? `<br><br>\n\t<input name=\"openInNewPage\" id=\"menuOpenInNewPage\" type=\"checkbox\" value=\"Y\" ${itemInfo.openInNewPage === 'Y' ? 'checked' : ''} >\n\t<label for=\"menuOpenInNewPage\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_OPEN_IN_NEW_PAGE\")}</label>` : ''}\n</form>`;\n\t\tObject.keys(itemInfo)\n\t\t\t.forEach((key) => {\n\t\t\t\tif (['id', 'text', 'link', 'openInNewPage'].indexOf(key) < 0)\n\t\t\t\t{\n\t\t\t\t\tconst name = Text.encode(key);\n\t\t\t\t\tconst value = Text.encode(itemInfo[key]);\n\t\t\t\t\tform.appendChild(\n\t\t\t\t\t\tTag.render`<input type=\"hidden\" name=\"${name}\" value=\"${value}\">`\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tthis.popup = PopupManager.create('menu-self-item-popup', bindElement, {\n\t\t\tclassName: 'menu-self-item-popup',\n\t\t\ttitleBar: (itemInfo['link'] === undefined ? Loc.getMessage(\"MENU_RENAME_ITEM\") : (\n\t\t\t\tisEditMode ? Loc.getMessage(\"MENU_EDIT_SELF_PAGE\") : Loc.getMessage(\"MENU_ADD_SELF_PAGE\")\n\t\t\t)),\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew SaveButton({ onclick: () => {\n\t\t\t\t\t\tif (this.checkForm(form))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst itemInfoToSave = {};\n\t\t\t\t\t\t\t[...form.elements].forEach((node) => {\n\t\t\t\t\t\t\t\titemInfoToSave[node.name] = node.value;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (form.elements['openInNewPage'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titemInfoToSave['openInNewPage'] = form.elements[\"openInNewPage\"].checked ? 'Y' : 'N';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t.backendSaveItem(itemInfoToSave)\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tresolve(itemInfoToSave);\n\t\t\t\t\t\t\t\t\tthis.popup.close();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(Utils.catchError);\n\t\t\t\t\t\t}\n\t\t\t\t\t} } ),\n\t\t\t\tnew CancelButton({ onclick: () => { this.popup.close();} }),\n\t\t\t]\n\t\t});\n\t\tthis.popup.show();\n\t}\n\t//endregion\n}\n\nfunction areUrlsEqual(url, currentUri: Uri)\n{\n\tconst checkedUri = new Uri(url);\n\tconst checkedUrlBrief = checkedUri.getPath().replace('/index.php', '').replace('/index.html', '');\n\n\tconst currentUrlBrief = currentUri.getPath().replace('/index.php', '').replace('/index.html', '');\n\n\tif (\n\t\tcheckedUri.getHost() !== ''\n\t\t&&\n\t\tcheckedUri.getHost() !== currentUri.getHost()\n\t)\n\t{\n\t\treturn false;\n\t}\n\tif (currentUrlBrief.indexOf(checkedUrlBrief) !== 0)\n\t{\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nfunction getShortName(name)\n{\n\tif (!Type.isStringFilled(name))\n\t{\n\t\treturn \"...\";\n\t}\n\n\tname = name.replace(/['`\".,:;~|{}*^$#@&+\\-=?!()[\\]<>\\n\\r]+/g, \"\").trim();\n\tif (name.length <= 0)\n\t{\n\t\treturn '...';\n\t}\n\n\tlet shortName;\n\tlet words = name.split(/[\\s,]+/);\n\tif (words.length <= 1)\n\t{\n\t\tshortName = name.substring(0, 1);\n\t}\n\telse if (words.length === 2)\n\t{\n\t\tshortName = words[0].substring(0, 1) + words[1].substring(0, 1);\n\t}\n\telse\n\t{\n\t\tlet firstWord = words[0];\n\t\tlet secondWord = words[1];\n\n\t\tfor (let i = 1; i < words.length; i++)\n\t\t{\n\t\t\tif (words[i].length > 3)\n\t\t\t{\n\t\t\t\tsecondWord = words[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tshortName = firstWord.substring(0, 1) + secondWord.substring(0, 1);\n\t}\n\n\treturn shortName.toUpperCase();\n}\n","import {Loc, Text, Tag} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {PopupManager} from 'main.popup'\nimport Item from './item';\nimport Utils from '../utils';\nimport Backend from '../backend';\nimport Options from \"../options\";\nimport ItemAdminShared from \"./item-admin-shared\";\n\nexport default class ItemUserFavorites extends Item\n{\n\tstatic code = 'standard';\n\tstatic #currentPageInTopMenu = null;\n\n\tcanDelete(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tdelete()\n\t{\n\t\tBackend\n\t\t\t.deleteFavoritesItemMenu({id: this.getId(), storage: this.storage})\n\t\t\t.then(() => {\n\t\t\t\tthis.destroy();\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t\tconst context = this.getSimilarToUrl(\n\t\t\t\t\tUtils.getCurUri()\n\t\t\t\t).length > 0 ? window : {'doesnotmatter': ''};\n\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [{id: this.getId()}, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: false,\n\t\t\t\t\tcontext: context\n\t\t\t\t}]);\n\t\t\t});\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst contextMenuItems = [];\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_RENAME_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError);\n\t\t\t}\n\t\t});\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_REMOVE_STANDARD_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.delete();\n\t\t\t}\n\t\t});\n\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_ITEM_TO_ALL\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tconst itemLinkNode = this.container.querySelector('a');\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.addAdminSharedItemMenu({\n\t\t\t\t\t\t\tid: this.getId(),\n\t\t\t\t\t\t\tlink: this.links[0],\n\t\t\t\t\t\t\ttext: this.getName(),\n\t\t\t\t\t\t\tcounterId: this.container.dataset.counterId,\n\t\t\t\t\t\t\topenInNewPage: itemLinkNode && itemLinkNode.getAttribute(\"target\") === \"_blank\" ? \"Y\" : \"N\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_ADDED_TO_ALL'));\n\t\t\t\t\t\t\tthis.container.dataset.type = ItemAdminShared.code;\n\t\t\t\t\t\t\tthis.storage.push(ItemUserFavorites.code);\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n\n\tstatic backendSaveItem(itemInfoToSave): Promise\n\t{\n\t\treturn Backend.updateFavoritesItemMenu(itemInfoToSave);\n\t}\n\n\tstatic getActiveTopMenuItem()\n\t{\n\t\tif (this.#currentPageInTopMenu)\n\t\t{\n\t\t\treturn this.#currentPageInTopMenu;\n\t\t}\n\n\t\tif (!BX.Main\n\t\t\t|| !BX.Main.interfaceButtonsManager)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst firstTopMenuInstance = Array.from(\n\t\t\tObject.values(\n\t\t\t\tBX.Main.interfaceButtonsManager\n\t\t\t\t\t.getObjects()\n\t\t\t)\n\t\t).shift();\n\n\t\tif (firstTopMenuInstance)\n\t\t{\n\t\t\tconst topMenuItem = firstTopMenuInstance.getActive();\n\n\t\t\tif (topMenuItem && typeof topMenuItem === \"object\")\n\t\t\t{\n\t\t\t\tconst link = document.createElement(\"a\");\n\t\t\t\tlink.href = topMenuItem['URL'];\n\t\t\t\t//IE11 omits slash in the pathname\n\t\t\t\tconst path = link.pathname[0] !== \"/\" ? (\"/\" + link.pathname) : link.pathname;\n\n\t\t\t\tthis.#currentPageInTopMenu = {\n\t\t\t\t\tID: topMenuItem['ID'] || null,\n\t\t\t\t\tNODE: topMenuItem['NODE'] || null,\n\t\t\t\t\tURL: path + link.search,\n\t\t\t\t\tTEXT: topMenuItem['TEXT'],\n\t\t\t\t\tDATA_ID: topMenuItem['DATA_ID'],\n\t\t\t\t\tCOUNTER_ID: topMenuItem['COUNTER_ID'],\n\t\t\t\t\tCOUNTER: topMenuItem['COUNTER'],\n\t\t\t\t\tSUB_LINK: topMenuItem['SUB_LINK'],\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn this.#currentPageInTopMenu;\n\t}\n\n\tstatic isCurrentPageStandard(topMenuPoint): boolean\n\t{\n\t\tif (topMenuPoint && topMenuPoint['URL'])\n\t\t{\n\t\t\tconst currentFullPath = document.location.pathname + document.location.search;\n\t\t\treturn topMenuPoint.URL === currentFullPath && topMenuPoint.URL.indexOf('workgroups') < 0;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic saveCurrentPage({pageTitle, pageLink})\n\t{\n\t\tconst topMenuPoint = this.getActiveTopMenuItem();\n\t\tlet itemInfo, startX, startY;\n\n\t\tif (topMenuPoint\n\t\t\t&& topMenuPoint.NODE\n\t\t\t&& this.isCurrentPageStandard(topMenuPoint)\n\t\t\t&& (pageLink === Utils.getCurPage() || pageLink === topMenuPoint.URL || !pageLink)\n\t\t)\n\t\t{\n\t\t\tconst menuNodeCoord = topMenuPoint.NODE.getBoundingClientRect();\n\t\t\tstartX = menuNodeCoord.left;\n\t\t\tstartY = menuNodeCoord.top;\n\n\t\t\titemInfo = {\n\t\t\t\tid: topMenuPoint.DATA_ID,\n\t\t\t\ttext: pageTitle || topMenuPoint.TEXT,\n\t\t\t\tlink: Utils.getCurPage() || topMenuPoint.URL,\n\t\t\t\tcounterId: topMenuPoint.COUNTER_ID,\n\t\t\t\tcounterValue: topMenuPoint.COUNTER,\n\t\t\t\tisStandardItem: true,\n\t\t\t\tsubLink: topMenuPoint.SUB_LINK\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemInfo = {\n\t\t\t\ttext: pageTitle || document.getElementById('pagetitle').innerText,\n\t\t\t\tlink: pageLink || Utils.getCurPage(),\n\t\t\t\tisStandardItem: pageLink === Utils.getCurPage()\n\t\t\t};\n\t\t\tconst titleCoord = BX(\"pagetitle\").getBoundingClientRect();\n\t\t\tstartX = titleCoord.left;\n\t\t\tstartY = titleCoord.top\n\t\t}\n\n\t\treturn Backend\n\t\t\t.addFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data: {itemId}}) => {\n\t\t\t\titemInfo.id = itemId;\n\t\t\t\titemInfo.topMenuId = itemInfo.id;\n\t\t\t\treturn {node: this.createNode(itemInfo), animateFromPoint: {startX, startY}, itemInfo: itemInfo};\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic deleteCurrentPage({pageLink})\n\t{\n\t\tconst topPoint = this.getActiveTopMenuItem();\n\n\t\tvar itemInfo = {}, startX, startY;\n\n\t\tif (topPoint && this.isCurrentPageStandard(topPoint))\n\t\t{\n\t\t\titemInfo['id'] = topPoint.DATA_ID;\n\n\t\t\tconst menuNodeCoord = topPoint.NODE.getBoundingClientRect();\n\t\t\tstartX = menuNodeCoord.left;\n\t\t\tstartY = menuNodeCoord.top;\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemInfo['link'] = pageLink || Utils.getCurPage();\n\t\t\tconst titleCoord = BX(\"pagetitle\").getBoundingClientRect();\n\t\t\tstartX = titleCoord.left;\n\t\t\tstartY = titleCoord.top\n\t\t}\n\t\treturn Backend\n\t\t\t.deleteFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data}) => {\n\t\t\t\tif (!itemInfo.id && data && data['itemId'])\n\t\t\t\t{\n\t\t\t\t\titemInfo.id = data['itemId'];\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), {id: itemInfo.id});\n\t\t\t\treturn {itemInfo: itemInfo, animateToPoint: {startX, startY}};\n\t\t\t});\n\t}\n\n\tstatic saveStandardPage({DATA_ID, TEXT, SUB_LINK, COUNTER_ID, COUNTER, NODE, URL})\n\t{\n\t\tconst itemInfo = {\n\t\t\tid: DATA_ID,\n\t\t\ttext: TEXT,\n\t\t\tlink: URL,\n\t\t\tsubLink: SUB_LINK,\n\t\t\tcounterId: COUNTER_ID,\n\t\t\tcounterValue: COUNTER\n\t\t};\n\n\t\tconst pos = NODE.getBoundingClientRect();\n\t\tconst startX = pos.left;\n\t\tconst startY = pos.top\n\t\treturn Backend\n\t\t\t.addFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data: {itemId}}) => {\n\t\t\t\titemInfo.id = itemId;\n\t\t\t\titemInfo.topMenuId = itemInfo.id;\n\n\t\t\t\tconst topPoint = this.getActiveTopMenuItem();\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemAdded\", [itemInfo, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: true,\n\t\t\t\t\tcontext: topPoint && topPoint.DATA_ID === DATA_ID ? window : null,\n\t\t\t\t}]);\n\n\t\t\t\treturn {node: this.createNode(itemInfo), animateFromPoint: {startX, startY}};\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic deleteStandardPage({DATA_ID})\n\t{\n\t\tconst itemInfo = {id: DATA_ID};\n\t\treturn Backend\n\t\t\t.deleteFavoritesItemMenu(itemInfo)\n\t\t\t.then(() => {\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), {id: itemInfo.id});\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [itemInfo, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: false,\n\t\t\t\t}]);\n\t\t\t\treturn {itemInfo: itemInfo};\n\t\t\t});\n\t}\n}\n","import {Loc, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport ItemUserFavorites from \"./item-user-favorites\";\nimport ItemAdminShared from \"./item-admin-shared\";\n\nexport default class ItemUserSelf extends Item\n{\n\tstatic code = 'self';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tdelete()\n\t{\n\t\treturn Backend\n\t\t\t.deleteSelfITem(this.getId())\n\t\t\t.then(() => {\n\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t})\n\t\t\t.catch(this.showError)\n\t\t;\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst contextMenuItems = [];\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_EDIT_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError);\n\t\t\t}\n\t\t});\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage('MENU_DELETE_SELF_ITEM'),\n\t\t\tonclick: () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('MENU_DELETE_SELF_ITEM_CONFIRM'),\n\t\t\t\t\tLoc.getMessage('MENU_DELETE_SELF_ITEM'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.delete();\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('MENU_DELETE'),\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_ITEM_TO_ALL\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tconst itemLinkNode = this.container.querySelector('a');\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.addAdminSharedItemMenu({\n\t\t\t\t\t\t\tid: this.getId(),\n\t\t\t\t\t\t\tlink: this.links[0],\n\t\t\t\t\t\t\ttext: this.getName(),\n\t\t\t\t\t\t\tcounterId: this.container.dataset.counterId,\n\t\t\t\t\t\t\topenInNewPage: itemLinkNode && itemLinkNode.getAttribute(\"target\") === \"_blank\" ? \"Y\" : \"N\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_ADDED_TO_ALL'));\n\t\t\t\t\t\t\tthis.container.dataset.type = ItemAdminShared.code;\n\t\t\t\t\t\t\tthis.storage.push(ItemUserSelf.code);\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n\n\tgetEditFields(): Object\n\t{\n\t\treturn {id: this.getId(), text: this.getName(), link: this.links[0],  openInNewPage: this.container.getAttribute('data-new-page')};\n\t}\n\n\tstatic backendSaveItem(itemInfo): Promise\n\t{\n\t\treturn Backend.saveSelfItemMenu(itemInfo)\n\t\t\t.then(({data}) => {\n\t\t\t\tif (data && data['itemId'])\n\t\t\t\t{\n\t\t\t\t\titemInfo.id = data['itemId'];\n\t\t\t\t}\n\t\t\t\treturn itemInfo;\n\t\t\t});\n\t}\n\n\tstatic showAdd(bindElement)\n\t{\n\t\treturn new Promise((resolve1, reject2) => {\n\t\t\tthis.showForm(\n\t\t\t\tbindElement,\n\t\t\t\t{id: 0, name: '', link: '', openInNewPage: 'Y'},\n\t\t\t\tresolve1, reject2\n\t\t\t)\n\t\t})\n\t\t.then((itemInfo) => {\n\t\t\treturn {node: this.createNode(itemInfo)}\n\t\t});\n\t}\n}\n\n","import {Tag, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport ItemUserFavorites from \"./item-user-favorites\";\nimport ItemUserSelf from \"./item-user-self\";\nimport Utils from \"../utils\";\n\nexport default class ItemAdminShared extends Item\n{\n\tstatic code = 'admin';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn this.container.dataset.deletePerm === 'Y';\n\t}\n\n\tdelete()\n\t{\n\t\tBackend\n\t\t\t.deleteAdminSharedItemMenu(this.getId())\n\t\t\t.then(() => {\n\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t}\n\t\t\t\tif (this.storage.indexOf(ItemUserSelf.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteSelfITem(this.getId());\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t})\n\t\t\t.catch(this.showError)\n\t\t;\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tif (!this.canDelete())\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst contextMenuItems = [];\n/*\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_RENAME_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError.bind(this));\n\t\t\t}\n\t\t});\n*/\n\n\t\tif (this.storage.filter((value) => {return value === ItemUserFavorites.code || value === ItemUserSelf.code;}).length > 0)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_REMOVE_STANDARD_ITEM'),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_DELETE_CUSTOM_ITEM_FROM_ALL'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.deleteAdminSharedItemMenu(this.getId())\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_DELETED_FROM_ALL'));\n\t\t\t\t\t\t\tconst codeToConvert = this.storage.indexOf(ItemUserSelf.code) >= 0 ? ItemUserSelf.code : ItemUserFavorites.code;\n\t\t\t\t\t\t\tthis.container.dataset.type = codeToConvert;\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.filter((v) => {return v !== codeToConvert}).join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_CUSTOM_ITEM_FROM_ALL\"),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n}","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport ItemUserFavorites from \"./item-user-favorites\";\n\nexport default class ItemAdminCustom extends Item\n{\n\tstatic code = 'custom';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn this.container.dataset.deletePerm === 'Y';\n\t}\n\n\tdelete()\n\t{\n\t\tif (this.canDelete())\n\t\t{\n\t\t\tBackend\n\t\t\t\t.deleteCustomItem(this.getId())\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t\t}\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t\t})\n\t\t\t\t.catch(this.showError)\n\t\t\t;\n\t\t}\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst actions = [];\n\t\tif (this.canDelete())\n\t\t{\n\t\t\tactions.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_ITEM_FROM_ALL\"),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t}\n\t\treturn actions;\n\t}\n}","import {Uri, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.event';\nimport Item from './item';\n\nexport default class ItemSystem extends Item\n{\n\tstatic code = 'default';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import Item from './item';\nimport Backend from '../backend';\nimport {Dom} from \"main.core\";\n\nexport default class ItemGroup extends Item\n{\n\tstatic code = 'group';\n\tgroupContainer: Element;\n\n\tconstructor()\n\t{\n\t\tsuper(...arguments);\n\t\tthis.container.addEventListener('click', this.toggleAndSave.bind(this), true);\n\t\tthis.container.addEventListener('mouseleave', () => {\n\t\t\tDom.removeClass(this.container, 'menu-item-group-actioned');\n\t\t});\n\t\tthis.groupContainer = this.container.parentNode.querySelector(`[data-group-id=\"${this.getId()}\"]`);\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t{\n\t\t\tthis.groupContainer.style.display = 'none';\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tthis.updateCounter();\n\t\t}, 0);\n\t}\n\n\ttoggleAndSave(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t{\n\t\t\tBackend.expandGroup(this.getId());\n\t\t\tthis\n\t\t\t\t.expand()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.container.setAttribute('data-collapse-mode', 'expanded');\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBackend.collapseGroup(this.getId());\n\t\t\tthis\n\t\t\t\t.collapse()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.container.setAttribute('data-collapse-mode', 'collapsed');\n\t\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\tcheckAndCorrect(): ItemGroup\n\t{\n\t\tconst groupContainer = this.groupContainer;\n\n\t\tif (groupContainer.parentNode === this.container)\n\t\t{\n\t\t\tDom.insertAfter(groupContainer, this.container);\n\t\t}\n\t\t[...groupContainer\n\t\t\t.querySelectorAll(`.menu-item-block`)\n\t\t].forEach((node) => {\n\t\t\tnode.setAttribute('data-status', this.container.getAttribute(\"data-status\"));\n\t\t});\n\t\treturn this;\n\t}\n\n\t#collapsingAnimation;\n\tcollapse(hideGroupContainer): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst groupContainer = this.groupContainer;\n\n\t\t\tif (this.#collapsingAnimation)\n\t\t\t{\n\t\t\t\tthis.#collapsingAnimation.stop();\n\t\t\t}\n\n\t\t\tgroupContainer.style.overflow = 'hidden';\n\t\t\tDom.addClass(this.container, 'menu-item-group-collapsing');\n\t\t\tDom.addClass(this.container, 'menu-item-group-actioned');\n\t\t\tDom.addClass(groupContainer, 'menu-item-group-collapsing');\n\t\t\tconst slideParams = {\n\t\t\t\theight: groupContainer.offsetHeight,\n\t\t\t\tdisplay: groupContainer.style.display\n\t\t\t};\n\n\t\t\tthis.#collapsingAnimation = (new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {height: slideParams.height, opacity: 100},\n\t\t\t\tfinish: {height: 0, opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tgroupContainer.style.height = state.height + 'px';\n\t\t\t\t\tgroupContainer.style.opacity = state.opacity / 100;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tgroupContainer.style.display = 'none';\n\t\t\t\t\tgroupContainer.style.opacity = 'auto';\n\t\t\t\t\tgroupContainer.style.height = 'auto';\n\n\t\t\t\t\tif (this.container.getAttribute('data-contains-active-item') === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(this.container, 'menu-item-active');\n\t\t\t\t\t}\n\t\t\t\t\tDom.removeClass(this.container, 'menu-item-group-collapsing');\n\t\t\t\t\tDom.removeClass(groupContainer, 'menu-item-group-collapsing');\n\t\t\t\t\tthis.#collapsingAnimation = null;\n\t\t\t\t\tif (hideGroupContainer === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.container.appendChild(groupContainer);\n\t\t\t\t\t}\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.#collapsingAnimation.animate();\n\t\t});\n\t}\n\n\texpand(checkAttribute): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst container = this.container;\n\t\t\tconst groupContainer = this.groupContainer;\n\n\t\t\tif (checkAttribute === true\n\t\t\t\t&& container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t\tconst contentHeight = groupContainer.querySelectorAll('li').length * container.offsetHeight;\n\t\t\tDom.addClass(container, 'menu-item-group-expanding');\n\t\t\tDom.addClass(container, 'menu-item-group-actioned');\n\t\t\tDom.addClass(groupContainer, 'menu-item-group-expanding');\n\n\t\t\tif (groupContainer.parentNode === this.container)\n\t\t\t{\n\t\t\t\tDom.insertAfter(groupContainer, this.container);\n\t\t\t}\n\n\t\t\tgroupContainer.style.display = 'block';\n\t\t\tthis.#collapsingAnimation = (new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {height: 0, opacity: 0},\n\t\t\t\tfinish: {height: contentHeight, opacity: 100},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tgroupContainer.style.height = state.height + 'px';\n\t\t\t\t\tgroupContainer.style.opacity = state.opacity / 100;\n\t\t\t\t},\n\t\t\t\tcomplete: function () {\n\t\t\t\t\tDom.removeClass(container, 'menu-item-group-expanding menu-item-active');\n\t\t\t\t\tDom.removeClass(groupContainer, 'menu-item-group-expanding');\n\t\t\t\t\tgroupContainer.style.height = 'auto';\n\t\t\t\t\tgroupContainer.style.opacity = 'auto';\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.#collapsingAnimation.animate();\n\t\t});\n\t}\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tupdateCounter()\n\t{\n\t\tlet counterValue = 0;\n\t\t[...this.container\n\t\t\t.parentNode\n\t\t\t.querySelector(`[data-group-id=\"${this.getId()}\"]`)\n\t\t\t.querySelectorAll('[data-role=\"counter\"]')]\n\t\t\t.forEach((node) => {\n\t\t\t\tcounterValue += parseInt(node.dataset.counterValue);\n\t\t\t});\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('menu-item-with-index');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t}\n\t}\n\n\tmarkAsActive()\n\t{\n\t\tthis.container.setAttribute('data-contains-active-item', 'Y');\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\tDom.addClass(this.container, 'menu-item-active');\n\t}\n\n\tmarkAsInactive()\n\t{\n\t\tthis.container.removeAttribute('data-contains-active-item');\n\t\tDom.removeClass(this.container, 'menu-item-active');\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.container.getAttribute('data-contains-active-item') === 'Y';\n\t}\n\n\tstatic detect(node)\n\t{\n\t\treturn node.getAttribute(\"data-role\") === 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n}\n","import {Uri, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.event';\nimport ItemGroup from './item-group';\n\nexport default class ItemGroupSystem extends ItemGroup\n{\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.container\n\t\t\t.querySelector('[data-role=\"item-edit-control\"]')\n\t\t\t.style.display = 'none';\n\t}\n\tstatic code = 'system_group';\n}\n","import Item from './item';\nimport ItemAdminShared from './item-admin-shared';\nimport ItemAdminCustom from './item-admin-custom';\nimport ItemUserFavorites from './item-user-favorites';\nimport ItemUserSelf from './item-user-self';\nimport ItemSystem from './item-system';\nimport ItemGroup from './item-group';\nimport ItemGroupSystem from './item-group-system';\n\nconst itemMappings = [\n\tItem,\n\tItemAdminShared,\n\tItemUserFavorites,\n\tItemAdminCustom,\n\tItemUserSelf,\n\tItemSystem,\n\tItemGroup,\n\tItemGroupSystem,\n];\n\nexport default function getItem(itemData): Item\n{\n\tlet itemClassName = Item;\n\titemMappings.forEach((itemClass) => {\n\t\tif (itemClass.detect(itemData))\n\t\t{\n\t\t\titemClassName = itemClass;\n\t\t}\n\t});\n\treturn itemClassName;\n}","import {Runtime, Uri} from 'main.core';\nimport Item from './item'\nimport ItemSystem from './item-system'\ntype ActiveLink = {\n\tpriority: number,\n\turl: string,\n\turi: Uri\n};\nexport default class ItemActive\n{\n\titem: ?Item;\n\t#link: ?ActiveLink;\n\t#actualLink: Uri;\n\n\tconstructor()\n\t{\n\t\tthis.highlight = Runtime.debounce(this.highlight, 200, this);\n\t\tthis.#actualLink = new Uri(window.location.href);\n\t}\n\n\tcheckAndSet(item: Item, links: Array): boolean\n\t{\n\t\t/*\n\t\tCustom items have more priority than standard items.\n\t\tExample:\n\t\t\tCalendar (standard item)\n\t\t\t\tdata-link=\"/company/personal/user/1/calendar/\"\n\t\t\t\tdata-all-links=\"/company/personal/user/1/calendar/,/calendar/\n\n\t\t\tCompany Calendar (custom item)\n\t\t\t\t data-link=\"/calendar/\"\n\n\t\tWe've got two items with the identical link /calendar/'.\n\t\t*/\n\t\tif (item === this.item)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet theMostOfTheLinks = this.#link;\n\t\tlinks.forEach((link) => {\n\t\t\tconst linkUri = new Uri(link.url);\n\t\t\tlet changeActiveItem = false;\n\t\t\tif (!theMostOfTheLinks\n\t\t\t\t||\n\t\t\t\ttheMostOfTheLinks.uri.getPath().length < linkUri.getPath().length)\n\t\t\t{\n\t\t\t\tchangeActiveItem = true;\n\t\t\t}\n\t\t\telse if (theMostOfTheLinks.uri.getPath().length === linkUri.getPath().length)\n\t\t\t{\n\t\t\t\tconst actualParams = this.#actualLink.getQueryParams();\n\t\t\t\tconst maxCount = Object.keys(actualParams).length;\n\t\t\t\tconst theMostOfTheLinkServiceData = {\n\t\t\t\t\tparams: theMostOfTheLinks.uri.getQueryParams(),\n\t\t\t\t\tmismatches: maxCount\n\t\t\t\t};\n\t\t\t\tconst comparedLinkParams = {\n\t\t\t\t\tparams: linkUri.getQueryParams(),\n\t\t\t\t\tmismatches: maxCount\n\t\t\t\t};\n\t\t\t\tArray.from(\n\t\t\t\t\tObject.keys(actualParams)\n\t\t\t\t).forEach((key) => {\n\t\t\t\t\tif (String(actualParams[key]) === String(theMostOfTheLinkServiceData.params[key]))\n\t\t\t\t\t{\n\t\t\t\t\t\ttheMostOfTheLinkServiceData.mismatches--;\n\t\t\t\t\t}\n\t\t\t\t\tif (String(actualParams[key]) === String(comparedLinkParams.params[key]))\n\t\t\t\t\t{\n\t\t\t\t\t\tcomparedLinkParams.mismatches--;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (link.priority > 0 && item instanceof ItemSystem)\n\t\t\t\t{\n\t\t\t\t\tlink.priority += 1;\n\t\t\t\t}\n\n\t\t\t\tif (theMostOfTheLinkServiceData.mismatches > comparedLinkParams.mismatches\n\t\t\t\t\t|| theMostOfTheLinks.priority < link.priority)\n\t\t\t\t{\n\t\t\t\t\tchangeActiveItem = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (changeActiveItem)\n\t\t\t{\n\t\t\t\ttheMostOfTheLinks = {\n\t\t\t\t\tpriority: link.priority,\n\t\t\t\t\turl: link.url,\n\t\t\t\t\turi: linkUri,\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tif (theMostOfTheLinks !== this.#link)\n\t\t{\n\t\t\tif (this.item)\n\t\t\t{\n\t\t\t\tthis.unhighlight(this.item);\n\t\t\t}\n\t\t\tthis.#link = theMostOfTheLinks;\n\t\t\tthis.item = item;\n\n\t\t\tthis.highlight();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcheckAndUnset(item: Item)\n\t{\n\t\tif (item instanceof Item && item === this.item)\n\t\t{\n\t\t\tthis.unhighlight(this.item);\n\t\t\tthis.item = null;\n\t\t\tthis.#link = null;\n\t\t}\n\t}\n\n\thighlight()\n\t{\n\t\tif (this.item)\n\t\t{\n\t\t\tthis.item.container.classList.add('menu-item-active');\n\n\t\t\tlet parent = this.item.container.closest('[data-role=\"group-content\"]');\n\t\t\tlet parentContainer;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tparentContainer = parent.parentNode.querySelector(`[data-id=\"${parent.getAttribute('data-group-id')}\"]`);\n\t\t\t\tif (parentContainer)\n\t\t\t\t{\n\t\t\t\t\tparentContainer.setAttribute('data-contains-active-item', 'Y');\n\t\t\t\t\tif (parentContainer.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t\t\t{\n\t\t\t\t\t\tparentContainer.classList.add('menu-item-active');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent = parent.closest('[data-relo=\"group-content\"]');\n\t\t\t}\n\t\t}\n\t}\n\n\tunhighlight(item: ?Item): ?Item\n\t{\n\t\tif (!(item instanceof Item))\n\t\t{\n\t\t\titem = this.item;\n\t\t}\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem.container.classList.remove('menu-item-active');\n\t\t\tlet parent = item.container.closest('[data-role=\"group-content\"]');\n\t\t\tlet parentContainer;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tparentContainer = parent.parentNode.querySelector(`[data-id=\"${parent.getAttribute('data-group-id')}\"]`);\n\t\t\t\tif (parentContainer)\n\t\t\t\t{\n\t\t\t\t\tparentContainer.removeAttribute('data-contains-active-item');\n\t\t\t\t\tparentContainer.classList.remove('menu-item-active');\n\t\t\t\t}\n\t\t\t\tparent = parent.closest('[data-relo=\"group-content\"]');\n\t\t\t}\n\t\t\treturn item;\n\t\t}\n\t\treturn null;\n\t}\n}\n","import {Loc, Type, Dom, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport getItem from '../items/index';\nimport Item from '../items/item';\nimport ItemActive from '../items/item-active';\nimport ItemUserSelf from '../items/item-user-self';\nimport ItemUserFavorites from '../items/item-user-favorites';\nimport Options from \"../options\";\nimport DefaultController from \"./default-controller\";\nimport Utils from \"../utils\";\nimport Backend from \"../backend\";\nimport ItemAdminCustom from \"../items/item-admin-custom\";\nimport {Menu, MenuItem} from 'main.popup';\nimport ItemGroup from \"../items/item-group\";\nimport {Reflection} from 'main.core';\n\nexport default class ItemsController extends DefaultController{\n\tparentContainer: Element;\n\tcontainer: Element;\n\thiddenContainer: Element;\n\titems: Map = new Map();\n\t#activeItem: ItemActive = new ItemActive;\n\t#isEditMode = false;\n\n\tconstructor(container, {events})\n\t{\n\t\tsuper(container, {events});\n\t\tthis.parentContainer = container;\n\t\tthis.container = container.querySelector(\".menu-items\");\n\n\t\tthis.hiddenContainer = container\n\t\t\t.querySelector('#left-menu-hidden-items-block');\n\n\t\tcontainer\n\t\t\t.querySelectorAll('li.menu-item-block')\n\t\t\t.forEach(this.registerItem.bind(this))\n\t\t;\n\t\tcontainer\n\t\t\t.querySelector('#left-menu-hidden-separator')\n\t\t\t.addEventListener('click', this.toggleHiddenContainer.bind(this))\n\t\t;\n\n\t\tif (this.getActiveItem()\n\t\t\t&& this.getActiveItem().container\n\t\t\t\t.getAttribute('data-status') === 'hide'\n\t\t)\n\t\t{\n\t\t\tthis.#showHiddenContainer(true);\n\t\t}\n\t}\n\n\tregisterItem(node): Item\n\t{\n\t\tconst itemClass = getItem(node);\n\t\tconst item = new itemClass(this.container, node);\n\t\tthis.items.set(item.getId(), item);\n\t\tthis.#registerDND(item);\n\n\t\tif (this.#activeItem.checkAndSet(\n\t\t\titem,\n\t\t\titem.getSimilarToUrl(\n\t\t\t\tUtils.getCurUri()\n\t\t\t)\n\t\t) === true)\n\t\t{\n\t\t\tlet parentItem = this.#getParentItemFor(item);\n\t\t\twhile (parentItem)\n\t\t\t{\n\t\t\t\tparentItem.markAsActive();\n\t\t\t\tparentItem = this.#getParentItemFor(parentItem);\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.subscribe(item, Options.eventName('onItemDelete'), ({data}) => {this.deleteItem(item, data)});\n\t\tEventEmitter.subscribe(item, Options.eventName('onItemConvert'), ({data}) => {this.convertItem(item, data)});\n\n\t\t[...item.container.querySelectorAll('a')]\n\t\t\t.forEach((node) => {\n\t\t\t\tnode.addEventListener('click', (event) => {\n\t\t\t\t\tif (this.#isEditMode === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, true)\n\t\t\t})\n\t\t;\n\t\titem.container\n\t\t\t.querySelector('[data-role=\"item-edit-control\"]')\n\t\t\t.addEventListener('click', (event) => {\n\t\t\t\tthis.openItemMenu(item, event.target)\n\t\t\t});\n\t\treturn item;\n\t}\n\n\tunregisterItem(item: Item)\n\t{\n\t\tif (!this.items.has(item.getId()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.items.delete(item.getId());\n\n\t\tthis.#activeItem.checkAndUnset(\n\t\t\titem,\n\t\t\titem.getSimilarToUrl(\n\t\t\t\tUtils.getCurUri()\n\t\t\t)\n\t\t);\n\n\t\tEventEmitter.unsubscribeAll(item, Options.eventName('onItemDelete'));\n\t\tEventEmitter.unsubscribeAll(item, Options.eventName('onItemConvert'));\n\t\titem.container.parentNode.replaceChild(item.container.cloneNode(true), item.container);\n\t}\n\n\tget isEditMode()\n\t{\n\t\treturn this.#isEditMode;\n\t}\n\n\tswitchToEditMode()\n\t{\n\t\tif (this.#isEditMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isEditMode = true;\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('EditMode'),\n\t\t);\n\t}\n\n\tswitchToViewMode()\n\t{\n\t\tif (!this.#isEditMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isEditMode = false;\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('ViewMode'),\n\t\t);\n\t}\n\n\tisHiddenContainerVisible()\n\t{\n\t\treturn this.hiddenContainer.classList.contains('menu-item-favorites-more-open');\n\t}\n\n\ttoggleHiddenContainer(animate)\n\t{\n\t\tif (this.hiddenContainer.classList.contains('menu-item-favorites-more-open'))\n\t\t{\n\t\t\tthis.#hideHiddenContainer(animate);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#showHiddenContainer(animate);\n\t\t}\n\t}\n\n\t#showHiddenContainer(animate)\n\t{\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onHiddenBlockIsVisible')\n\t\t);\n\t\tif (animate === false)\n\t\t{\n\t\t\treturn this.hiddenContainer.classList.add('menu-item-favorites-more-open');\n\t\t}\n\n\t\tthis.hiddenContainer.style.height = \"0px\";\n\t\tthis.hiddenContainer.style.opacity = 0;\n\t\tthis.#animation(true, this.hiddenContainer, this.hiddenContainer.scrollHeight);\n\t}\n\n\t#hideHiddenContainer(animate)\n\t{\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onHiddenBlockIsHidden')\n\t\t);\n\t\tif (animate === false)\n\t\t{\n\t\t\treturn this.hiddenContainer.classList.remove('menu-item-favorites-more-open');\n\t\t}\n\t\tthis.#animation(false, this.hiddenContainer, this.hiddenContainer.offsetHeight);\n\t}\n\n\t#animation(opening, hiddenBlock, maxHeight)\n\t{\n\t\thiddenBlock.style.overflow = \"hidden\";\n\t\t(new BX.easing({\n\t\t\tduration: 200,\n\t\t\tstart: {opacity: opening ? 0 : 100, height: opening ? 0 : maxHeight},\n\t\t\tfinish: {opacity: opening ? 100 : 0, height: opening ? maxHeight : 0},\n\t\t\ttransition: BX.easing.transitions.linear,\n\t\t\tstep: function (state) {\n\t\t\t\thiddenBlock.style.opacity = state.opacity / 100;\n\t\t\t\thiddenBlock.style.height = state.height + \"px\";\n\t\t\t},\n\t\t\tcomplete: function () {\n\t\t\t\tif (opening)\n\t\t\t\t{\n\t\t\t\t\thiddenBlock.classList.add('menu-item-favorites-more-open');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thiddenBlock.classList.remove('menu-item-favorites-more-open');\n\t\t\t\t}\n\t\t\t\thiddenBlock.style.opacity = \"\";\n\t\t\t\thiddenBlock.style.overflow = \"\";\n\t\t\t\thiddenBlock.style.height = \"\";\n\t\t\t}\n\n\t\t})).animate();\n\t}\n\n\tsetItemAsAMainPage(item: Item)\n\t{\n\t\tconst node = item.container;\n\t\tnode.setAttribute(\"data-status\", \"show\");\n\t\tconst startTop = node.offsetTop;\n\t\tconst dragElement = Dom.create(\"div\", {\n\t\t\tattrs: {className: \"menu-draggable-wrap\"},\n\t\t\tstyle: {top: startTop}\n\t\t});\n\n\t\tconst insertBeforeElement = node.nextElementSibling;\n\t\tif (insertBeforeElement)\n\t\t{\n\t\t\tnode.parentNode.insertBefore(dragElement, insertBeforeElement);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.parentNode.appendChild(dragElement);\n\t\t}\n\n\t\tdragElement.appendChild(node);\n\n\t\tDom.addClass(node, \"menu-item-draggable\");\n\n\t\t(new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: startTop},\n\t\t\tfinish: {top: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: function (state) { dragElement.style.top = state.top + \"px\"; },\n\t\t\tcomplete: () => {\n\t\t\t\tthis.container.insertBefore(node, BX(\"left-menu-empty-item\").nextSibling);\n\t\t\t\tDom.removeClass(node, \"menu-item-draggable\");\n\t\t\t\tDom.remove(dragElement);\n\t\t\t\tthis.#saveItemsSort({\n\t\t\t\t\taction: 'mainPageIsSet',\n\t\t\t\t\titemId: item.getId()\n\t\t\t\t});\n\t\t\t}\n\t\t})).animate();\n\t}\n\n\tshowItem(item: Item)\n\t{\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tconst container = this.container;\n\n\t\titem.container.setAttribute('data-status', 'show');\n\t\tif (this.#canChangePaternity(item))\n\t\t{\n\t\t\tcontainer.appendChild(item.container);\n\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t}\n\t\telse if (oldParent)\n\t\t{\n\t\t\tcontainer.appendChild(oldParent.container);\n\t\t\toldParent.container.setAttribute('data-status', 'show');\n\t\t\tcontainer.appendChild(oldParent.groupContainer);\n\t\t}\n\n\t\tif (this.hiddenContainer.querySelector('.menu-item-block') === null)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsEmpty'));\n\t\t\tthis.#hideHiddenContainer(false);\n\t\t}\n\n\t\tthis.#recalculateCounters(item);\n\t\tthis.#saveItemsSort({\n\t\t\taction: 'showItem',\n\t\t\titemId: item.getId()\n\t\t});\n\t}\n\n\thideItem(item: Item)\n\t{\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tconst container = this.hiddenContainer.querySelector('#left-menu-hidden-items-list');\n\t\tconst emitEvent = container.querySelector('.menu-item-block') === null;\n\n\t\titem.container.setAttribute('data-status', 'hide');\n\t\tif (this.#canChangePaternity(item))\n\t\t{\n\t\t\tcontainer.appendChild(item.container);\n\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t}\n\t\telse if (oldParent)\n\t\t{\n\t\t\tcontainer.appendChild(oldParent.container);\n\t\t\toldParent.container.setAttribute('data-status', 'hide');\n\t\t\tcontainer.appendChild(oldParent.groupContainer);\n\t\t}\n\n\t\tif (emitEvent)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsNotEmpty'));\n\t\t}\n\n\t\tthis.#recalculateCounters(item);\n\n\t\tthis.#saveItemsSort({\n\t\t\taction: 'hideItem',\n\t\t\titemId: item.getId()\n\t\t});\n\t}\n\n\t#recalculateCounters(item: Item)\n\t{\n\t\tlet counterValue = 0;\n\t\tif (item.container.querySelector('[data-role=\"counter\"]'))\n\t\t{\n\t\t\tcounterValue = item.container.querySelector('[data-role=\"counter\"]').dataset.counterValue;\n\t\t}\n\t\tif (counterValue <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t[...this.items.entries()]\n\t\t\t.forEach(([id, itemGroup]) => {\n\t\t\t\tif (itemGroup instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titemGroup.updateCounter();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tlet hiddenCounterValue = 0;\n\t\t[...this.parentContainer\n\t\t\t.querySelectorAll(`.menu-item-block[data-status=\"hide\"][data-role='item']`)\n\t\t].forEach((node) => {\n\t\t\t\tconst counterNode = node.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (counterNode)\n\t\t\t\t{\n\t\t\t\t\thiddenCounterValue += parseInt(counterNode.dataset.counterValue);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tconst hiddenCounterNode = this.parentContainer.querySelector('#menu-hidden-counter');\n\t\thiddenCounterNode.dataset.counterValue = Math.max(0, hiddenCounterValue);\n\t\tif (hiddenCounterNode.dataset.counterValue > 0)\n\t\t{\n\t\t\thiddenCounterNode.classList.remove('menu-hidden-counter');\n\t\t\thiddenCounterNode.innerHTML = hiddenCounterNode.dataset.counterValue > 99 ? '99+' : hiddenCounterNode.dataset.counterValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\thiddenCounterNode.classList.add('menu-hidden-counter');\n\t\t\thiddenCounterNode.innerHTML = '';\n\t\t}\n\t}\n\n\t#refreshActivity(item: Item, oldParent:? ItemGroup)\n\t{\n\t\tif (this.getActiveItem() !== item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newParent = this.#getParentItemFor(item);\n\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\tif (oldParent instanceof ItemGroup)\n\t\t\t{\n\t\t\t\toldParent.markAsInactive();\n\t\t\t}\n\t\t\tif (newParent instanceof ItemGroup)\n\t\t\t{\n\t\t\t\tnewParent.markAsActive();\n\t\t\t}\n\t\t}\n\t}\n\n\t#updateCountersLastValue = null\n\tupdateCounters(counters, send)\n\t{\n\t\tconst countersDynamic = {};\n\t\tsend = send !== false;\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\t[...this.#getItemsByCounterId(counterId)]\n\t\t\t\t\t.forEach((item) => {\n\t\t\t\t\t\tconst {oldValue, newValue} = item.updateCounter(counterValue);\n\t\t\t\t\t\tconst state = item.container.getAttribute('data-status');\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(counterId.indexOf('crm_') < 0 || counterId.indexOf('crm_all') >= 0)\n\t\t\t\t\t\t\t&&\n\t\t\t\t\t\t\t(counterId.indexOf('tasks_') < 0 || counterId.indexOf('tasks_total') >= 0)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcountersDynamic[state] = countersDynamic[state] || 0;\n\t\t\t\t\t\t\tcountersDynamic[state] += (newValue - oldValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet parentItem = this.#getParentItemFor(item);\n\t\t\t\t\t\twhile (parentItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.updateCounter();\n\t\t\t\t\t\t\tparentItem = this.#getParentItemFor(parentItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tif (send)\n\t\t\t\t{\n\t\t\t\t\tBX.localStorage.set('lmc-' + counterId, counterValue, 5);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tif (countersDynamic['hide'] !== undefined && countersDynamic['hide'] !== 0)\n\t\t{\n\t\t\tconst hiddenCounterNode = this.parentContainer.querySelector('#menu-hidden-counter');\n\t\t\thiddenCounterNode.dataset.counterValue = Math.max(0, Number(hiddenCounterNode.dataset.counterValue) + Number(countersDynamic['hide']));\n\t\t\tif (hiddenCounterNode.dataset.counterValue > 0)\n\t\t\t{\n\t\t\t\thiddenCounterNode.classList.remove('menu-hidden-counter');\n\t\t\t\thiddenCounterNode.innerHTML = hiddenCounterNode.dataset.counterValue > 99 ? '99+' : hiddenCounterNode.dataset.counterValue;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thiddenCounterNode.classList.add('menu-hidden-counter');\n\t\t\t\thiddenCounterNode.innerHTML = '';\n\t\t\t}\n\t\t}\n\n\t\tif (typeof BXIM !== 'undefined')\n\t\t{\n\t\t\tif (this.#updateCountersLastValue === null)\n\t\t\t{\n\t\t\t\tthis.#updateCountersLastValue = 0;\n\t\t\t\t[...this.items.entries()]\n\t\t\t\t\t.forEach(([id, item]) => {\n\t\t\t\t\t\tif (item instanceof ItemGroup)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst res = item.getCounterValue();\n\n\t\t\t\t\t\tif (res > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet counterId = 'doesNotMatter';\n\t\t\t\t\t\t\tif (id.indexOf('menu_crm') >= 0 || id.indexOf('menu_tasks') >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst counterNode = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\t\t\t\t\tif (counterNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcounterId = counterNode.id;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tcounterId === 'doesNotMatter'\n\t\t\t\t\t\t\t\t|| counterId.indexOf('crm_all') >= 0\n\t\t\t\t\t\t\t\t|| counterId.indexOf('tasks_total') >= 0\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#updateCountersLastValue += res;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#updateCountersLastValue += (countersDynamic['show'] !== undefined ? countersDynamic['show'] : 0);\n\t\t\t\tthis.#updateCountersLastValue += (countersDynamic['hide'] !== undefined ? countersDynamic['hide'] : 0);\n\t\t\t}\n\t\t\tconst visibleValue = (this.#updateCountersLastValue > 99 ? '99+' : (\n\t\t\t\tthis.#updateCountersLastValue < 0 ? '0' : this.#updateCountersLastValue\n\t\t\t));\n\n\t\t\tconst desktop = Reflection.getClass('BXIM.desktop');\n\t\t\tif (desktop)\n\t\t\t{\n\t\t\t\tdesktop.setBrowserIconBadge(visibleValue);\n\t\t\t}\n\t\t}\n\t}\n\n\tdecrementCounter(counters)\n\t{\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\tconst item = this.#getItemsByCounterId(counterId).shift();\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tconst value = item.getCounterValue();\n\t\t\t\t\tcounters[counterId] = value > counterValue ? (value - counterValue) : 0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdelete counters[counterId];\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t\tthis.updateCounters(counters, false);\n\t}\n\n\t#getItemsByCounterId(counterId: string)\n\t{\n\t\tconst result = [];\n\t\t[...this.items.values()]\n\t\t\t.forEach((item: Item) => {\n\t\t\t\tconst node = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (node && node.id.indexOf(counterId) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(item);\n\t\t\t\t}\n\t\t\t});\n\t\treturn result;\n\t}\n\n\t#getItemsToSave()\n\t{\n\t\tconst saveSortItems = {\n\t\t\tshow: [],\n\t\t\thide: [],\n\t\t};\n\t\tconst customItems = [];\n\n\t\tlet firstItemLink = null;\n\t\t['show', 'hide']\n\t\t\t.forEach((state) => {\n\t\t\t\tlet items = saveSortItems[state];\n\t\t\t\tlet currentGroupId = null;\n\t\t\t\tconst chain = [];\n\n\t\t\t\tArray.from(\n\t\t\t\t\tthis.parentContainer\n\t\t\t\t\t\t.querySelectorAll(`.menu-item-block[data-status=\"${state}\"]`)\n\t\t\t\t).forEach((node) =>\n\t\t\t\t{\n\t\t\t\t\tif (node.dataset.role === 'group')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupId = node.parentNode.hasAttribute('data-group-id') ?\n\t\t\t\t\t\t\tnode.parentNode.getAttribute('data-group-id') : null;\n\t\t\t\t\t\titems = saveSortItems[state];\n\t\t\t\t\t\tlet groupItem\n\t\t\t\t\t\twhile (groupItem = chain.pop())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (groupItem['group_id'] === groupId)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tchain.push(groupItem);\n\t\t\t\t\t\t\t\titems = groupItem.items;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst item = {\n\t\t\t\t\t\t\tgroup_id: node.dataset.id,\n\t\t\t\t\t\t\titems: []\n\t\t\t\t\t\t};\n\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\tchain.push(item);\n\t\t\t\t\t\titems = item.items;\n\t\t\t\t\t\tcurrentGroupId = node.dataset.id;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif ([ItemAdminCustom.code, ItemUserSelf.code, ItemUserFavorites.code]\n\t\t\t\t\t\t\t.indexOf(node.getAttribute('data-type')) >= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst item = {\n\t\t\t\t\t\t\t\tID: node.getAttribute('data-id'),\n\t\t\t\t\t\t\t\tLINK: node.getAttribute('data-link'),\n\t\t\t\t\t\t\t\tTEXT: Text.decode(node.querySelector(\"[data-role='item-text']\").innerHTML)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (node.getAttribute(\"data-new-page\") === \"Y\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.NEW_PAGE = \"Y\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcustomItems.push(item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (firstItemLink === null && Type.isStringFilled(node.getAttribute(\"data-link\")))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfirstItemLink = node.getAttribute(\"data-link\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (node.closest(`[data-group-id=\"${currentGroupId}\"][data-role=\"group-content\"]`))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titems.push(node.dataset.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst groupId = node.parentNode.hasAttribute('data-group-id') ?\n\t\t\t\t\t\t\t\tnode.parentNode.getAttribute('data-group-id') : null;\n\t\t\t\t\t\t\titems = saveSortItems[state];\n\t\t\t\t\t\t\tlet groupItem\n\t\t\t\t\t\t\twhile (groupItem = chain.pop())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (groupItem['group_id'] === groupId)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tchain.push(groupItem);\n\t\t\t\t\t\t\t\t\titems = groupItem.items;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titems.push(node.dataset.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t;\n\t\treturn {saveSortItems, firstItemLink, customItems};\n\t}\n\n\t#saveItemsSort(analyticsLabel)\n\t{\n\t\tconst {saveSortItems, firstItemLink} = this.#getItemsToSave();\n\t\tBackend.saveItemsSort(saveSortItems, firstItemLink, analyticsLabel || {action: 'sortItem'});\n\t}\n\n\taddItem({node, animateFromPoint})\n\t{\n\t\tif (!(node instanceof Element))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst styleValue = node.style.display;\n\t\tif (animateFromPoint)\n\t\t{\n\t\t\tnode.dataset.styleDisplay = node.style.display;\n\t\t\tnode.style.display = 'none';\n\t\t}\n\t\tif (this.items.has(node.dataset.id) && node.dataset.type === ItemUserFavorites.code)\n\t\t{\n\t\t\tconst item = this.items.get(node.dataset.id);\n\t\t\titem.storage.push(ItemUserFavorites.code);\n\t\t\titem.container.dataset.storage = item.storage.join(',');\n\t\t\tnode = item.container;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.appendChild(node);\n\t\t\tthis.registerItem(node);\n\t\t\tthis.#saveItemsSort();\n\t\t}\n\n\t\tif (animateFromPoint)\n\t\t{\n\t\t\tthis\n\t\t\t\t.#animateTopItemToLeft(node, animateFromPoint)\n\t\t\t\t.then(() => {\n\t\t\t\t\tnode.style.display = node.dataset.styleDisplay;\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tupdateItem(data)\n\t{\n\t\tlet {id} = data;\n\t\tif (this.items.has(id))\n\t\t{\n\t\t\tthis.items\n\t\t\t\t.get(id)\n\t\t\t\t.update(data)\n\t\t\t;\n\t\t}\n\t}\n\n\tdeleteItem(item: Item, {animate})\n\t{\n\t\tthis.items.delete(item.getId());\n\t\tthis.#activeItem.checkAndUnset(item);\n\n\t\tif (item instanceof ItemUserFavorites || animate)\n\t\t{\n\t\t\tthis\n\t\t\t\t.#animateTopItemFromLeft(item.container)\n\t\t\t\t.then(() => {\n\t\t\t\t\titem.container.parentNode.removeChild(item.container);\n\t\t\t\t\tthis.#saveItemsSort();\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse if (item.container)\n\t\t{\n\t\t\titem.container.parentNode.removeChild(item.container);\n\t\t\tthis.#saveItemsSort();\n\t\t}\n\t}\n\n\tconvertItem(item: Item)\n\t{\n\t\tthis.unregisterItem(item);\n\t\tthis.registerItem(this.parentContainer.querySelector(`li.menu-item-block[data-id=\"${item.getId()}\"]`));\n\t}\n\n\tgetActiveItem(): ?Item\n\t{\n\t\treturn this.#activeItem.item;\n\t}\n\n\t#getParentItemFor(item: Item): ?ItemGroup\n\t{\n\t\tif (!(item instanceof Item))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst parentContainer = item.container.closest('[data-role=\"group-content\"]');\n\t\tif (parentContainer && this.items.has(parentContainer.getAttribute('data-group-id')))\n\t\t{\n\t\t\treturn this.items.get(parentContainer.getAttribute('data-group-id'));\n\t\t}\n\t\treturn null;\n\t}\n\n\t#canChangePaternity(item: Item): boolean\n\t{\n\t\tif (item instanceof ItemGroup)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tif (oldParent instanceof ItemGroup\n\t\t\t&& item.container.parentNode.querySelectorAll('li.menu-item-block').length <= 1\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\texport()\n\t{\n\t\treturn this.#getItemsToSave();\n\t}\n\n\t//region DropdownActions\n\t#openItemMenuPopup;\n\topenItemMenu(item: Item, target)\n\t{\n\t\tif (this.#openItemMenuPopup)\n\t\t{\n\t\t\tthis.#openItemMenuPopup.close();\n\t\t}\n\t\tconst contextMenuItems = [];\n\t\t// region hide/show item\n\t\tif (item.container.getAttribute(\"data-status\") === \"show\")\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"hide_item\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.hideItem(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"show_item\"),\n\t\t\t\tonclick: (target, contextMenuItem) => {\n\t\t\t\t\tthis.showItem(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//endregion\n\n\t\t//region set as main page\n\t\tif (\n\t\t\t!Options.isExtranet\n\t\t\t&& !(item instanceof ItemUserSelf)\n\t\t\t&& !(item instanceof ItemGroup)\n\t\t\t&& this.container.querySelector('li.menu-item-block[data-role=\"item\"]') !== item.container\n\t\t)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_SET_MAIN_PAGE\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.setItemAsAMainPage(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//endregion\n\n\t\titem\n\t\t\t.getDropDownActions()\n\t\t\t.forEach((actionItem) => {\n\t\t\t\tcontextMenuItems.push(actionItem);\n\t\t\t});\n\n\t\tcontextMenuItems.push({\n\t\t\ttext: this.#isEditMode ? Loc.getMessage(\"MENU_EDIT_READY_FULL\") : Loc.getMessage(\"MENU_SETTINGS_MODE\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.#isEditMode ? this.switchToViewMode() : this.switchToEditMode();\n\t\t\t}\n\t\t});\n\n\t\tcontextMenuItems.forEach((item) => {\n\t\t\titem['className'] = [\"menu-popup-no-icon\", item['className'] ?? ''].join(' ');\n\t\t\tconst {onclick} = item;\n\t\t\titem['onclick'] = (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tonclick.call(event, item);\n\t\t\t};\n\t\t});\n\t\tthis.#openItemMenuPopup = new Menu({\n\t\t\tbindElement: target,\n\t\t\titems: contextMenuItems,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 12,\n\t\t\tangle: true,\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onClose'));\n\t\t\t\t\titem.container.classList.remove('menu-item-block-hover');\n\t\t\t\t\tthis.#openItemMenuPopup = null;\n\t\t\t\t},\n\t\t\t\tonShow: () => {\n\t\t\t\t\titem.container.classList.add('menu-item-block-hover');\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onShow'));\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tthis.#openItemMenuPopup.show();\n\t}\n\t//endregion\n\n\t//region Visible sliding\n\t#animateTopItemToLeft(node, animateFromPoint)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tlet {startX, startY} = animateFromPoint;\n\t\t\tconst topMenuNode = document.createElement('DIV');\n\t\t\ttopMenuNode.style = `position: absolute; z-index: 1000; top: ${startY + 25}px;`\n\n\t\t\tconst cloneNode = node.cloneNode(true);\n\t\t\tcloneNode.style.display = node.dataset.styleDisplay;\n\t\t\tdocument.body.appendChild(topMenuNode);\n\t\t\ttopMenuNode.appendChild(cloneNode);\n\n\t\t\tlet finishY = this.hiddenContainer.getBoundingClientRect().top;\n\n\t\t\t(new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {left: startX},\n\t\t\t\tfinish: {left: 30},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\ttopMenuNode.style.left = state.left + \"px\";\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\t(new BX.easing({\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tstart: {top: startY + 25},\n\t\t\t\t\t\tfinish: {top: finishY},\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\t\tstep: function (state) {\n\t\t\t\t\t\t\ttopMenuNode.style.top = state.top + \"px\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tDom.remove(topMenuNode);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t})).animate();\n\t\t\t\t}\n\t\t\t})).animate();\n\t\t});\n\t}\n\t#animateTopItemFromLeft(node)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t(new BX.easing({\n\t\t\t\tduration: 700,\n\t\t\t\tstart: {left: node.offsetLeft, opacity: 1},\n\t\t\t\tfinish: {left: 400, opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tnode.style.paddingLeft = state.left + \"px\";\n\t\t\t\t\tnode.style.opacity = state.opacity;\n\t\t\t\t},\n\t\t\t\tcomplete: function () {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t})).animate();\n\t\t});\n\t}\n\t//endregion\n\n\t/* region D&D */\n\t#registerDND(item)\n\t{\n\t\t//drag&drop\n\t\tjsDD.Enable();\n\t\titem.container.onbxdragstart = this.#menuItemDragStart.bind(this, item);\n\t\titem.container.onbxdrag = (x, y) => { this.#menuItemDragMove(/*item,*/ x, y); };\n\t\titem.container.onbxdraghover = (dest, x, y) => { this.#menuItemDragHover(/*item, */dest, x, y); };\n\t\titem.container.onbxdragstop = this.#menuItemDragStop.bind(this, item);\n\t\tjsDD.registerObject(item.container);\n\t}\n\n\t#menuItemDragStart(item)\n\t{\n\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Bitrix24.LeftMenuClass:onDragStart');\n\n\t\tif (!(item instanceof ItemGroup)\n\t\t\t&& item.container.parentNode.querySelectorAll('li.menu-item-block').length <= 1\n\t\t\t&& this.#getParentItemFor(item) !== null\n\t\t)\n\t\t{\n\t\t\titem = this.#getParentItemFor(item);\n\t\t}\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onDragModeOn')\n\t\t);\n\n\t\tthis.dnd = {\n\t\t\tcontainer: this.container.parentNode,\n\t\t\titemDomBlank: Dom.create('div', {\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t// border: '2px solid navy'\n\t\t\t\t}}),\n\t\t\titemMoveBlank: Dom.create('div', {\n\t\t\t\tstyle: {\n\t\t\t\t\theight: item.container.offsetHeight + 'px',\n\t\t\t\t\t// border: '2px solid red',\n\t\t\t\t}}\n\t\t\t),\n\t\t\tdraggableBlock: Dom.create('div', {             //div to move\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"menu-draggable-wrap\",\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\ttop: [(\n\t\t\t\t\t\titem.container.offsetTop - item.container.offsetHeight\n\t\t\t\t\t), 'px'].join(''),\n\t\t\t\t\t// border: '2px solid black'\n\t\t\t\t}\n\t\t\t}),\n\t\t\titem: item,\n\t\t\toldParent: this.#getParentItemFor(item),\n\t\t\tisHiddenContainerVisible: this.isHiddenContainerVisible()\n\t\t}\n\n\t\tthis.#showHiddenContainer(false);\n\n\t\tconst registerItems = () => {\n\t\t\t[...this.parentContainer\n\t\t\t\t.querySelectorAll('li.menu-item-block')]\n\t\t\t\t.forEach((node) => {\n\t\t\t\t\tif (item instanceof ItemGroup\n\t\t\t\t\t\t&& this.#getParentItemFor(\n\t\t\t\t\t\t\tthis.items.get(node.getAttribute('data-id'))\n\t\t\t\t\t\t) !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tjsDD.registerDest(node, 100);\n\t\t\t\t});\n\n\t\t\tconst firstNode = this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-empty-item\");\n\t\t\tif (item instanceof ItemUserSelf)\n\t\t\t{\n\t\t\t\tjsDD.unregisterDest(firstNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjsDD.registerDest(firstNode, 100);\n\t\t\t}\n\t\t\tjsDD.registerDest(this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-hidden-empty-item\"), 100);\n\t\t\tjsDD.registerDest(this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-hidden-separator\"), 100);\n\t\t};\n\n\t\tif (item instanceof ItemGroup)\n\t\t{\n\t\t\titem\n\t\t\t\t.collapse(true)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (this.dnd)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dnd.pos = BX.pos(this.container.parentNode);\n\t\t\t\t\t\tregisterItems();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tregisterItems();\n\t\t}\n\n\t\tconst dragElement = item.container;\n\t\tDom.addClass(this.dnd.container, \"menu-drag-mode\")\n\t\tDom.addClass(dragElement, \"menu-item-draggable\");\n\t\tdragElement\n\t\t\t.parentNode\n\t\t\t.insertBefore(this.dnd.itemDomBlank, dragElement); //remember original item place\n\t\tdragElement\n\t\t\t.parentNode\n\t\t\t.insertBefore(this.dnd.itemMoveBlank, dragElement); //empty div\n\t\tthis.dnd.draggableBlock.appendChild(item.container);\n\n\t\tthis.dnd.container.style.position = 'relative';\n\t\tthis.dnd.container.appendChild(this.dnd.draggableBlock);\n\t\tthis.dnd.pos = BX.pos(this.container.parentNode);\n\t}\n\n\t#menuItemDragMove(/*item,*/ x, y)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tvar menuItemsBlockHeight = this.dnd.pos.height;\n\t\ty = Math.max(0, y - this.dnd.pos.top);\n\t\tthis.dnd.draggableBlock.style.top = [\n\t\t\tMath.min(menuItemsBlockHeight - item.container.offsetHeight, y) - 5,\n\t\t\t'px'\n\t\t].join('');\n\t}\n\n\t#menuItemDragHover(/*item, */dest, x, y)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tconst dragElement = item.container;\n\n\t\tif (dest === dragElement)\n\t\t{\n\t\t\tthis.dnd.itemDomBlank\n\t\t\t\t.parentNode.insertBefore(this.dnd.itemMoveBlank, this.dnd.itemDomBlank);\n\t\t\treturn;\n\t\t}\n\n\t\tif (dest.id === \"left-menu-empty-item\" &&\n\t\t\t(\n\t\t\t\tdragElement.getAttribute(\"data-type\") === \"self\"\n\t\t\t\t|| dragElement.getAttribute(\"data-disable-first-item\") === \"Y\"\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn; // self-item cannot be moved on the first place\n\t\t}\n\n\t\tif (dest.getAttribute('data-role') === 'group')\n\t\t{\n\t\t\tconst groupHolder = dest.parentNode.querySelector(`[data-group-id=\"${dest.getAttribute('data-id')}\"]`);\n\t\t\tif (dest.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t{\n\t\t\t\tDom.insertAfter(this.dnd.itemMoveBlank, groupHolder);\n\t\t\t}\n\t\t\telse if (item instanceof ItemGroup)\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.dnd.itemMoveBlank, dest);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.prepend(this.dnd.itemMoveBlank, groupHolder.querySelector('ul'));\n\t\t\t}\n\t\t}\n\t\telse if (this.dnd.container.contains(dest))\n\t\t{\n\t\t\tlet itemPlaceHolder = dest;\n\t\t\tif (item instanceof ItemGroup &&\n\t\t\t\tdest.closest('[data-role=\"group-content\"]'))\n\t\t\t{\n\t\t\t\titemPlaceHolder = dest.closest('[data-role=\"group-content\"]');\n\t\t\t}\n\t\t\tDom.insertAfter(this.dnd.itemMoveBlank, itemPlaceHolder);\n\t\t}\n\t}\n\n\t#menuItemDragStop(/*item*/)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tconst oldParent = this.dnd.oldParent;\n\n\t\tconst dragElement = item.container;\n\n\t\tDom.removeClass(this.dnd.container, \"menu-drag-mode\");\n\t\tDom.removeClass(dragElement, \"menu-item-draggable\");\n\t\tthis.dnd.container.style.position = '';\n\n\t\tlet error = null;\n\t\tlet onHiddenBlockIsEmptyEmitted = false;\n\t\tif (this.parentContainer.querySelector('.menu-item-block') === item.container)\n\t\t{\n\t\t\tif (item instanceof ItemUserSelf)\n\t\t\t{\n\t\t\t\terror = Loc.getMessage('MENU_SELF_ITEM_FIRST_ERROR');\n\t\t\t}\n\t\t\telse if (item.container.getAttribute(\"data-disable-first-item\") === \"Y\")\n\t\t\t{\n\t\t\t\terror = Loc.getMessage(\"MENU_FIRST_ITEM_ERROR\");\n\t\t\t}\n\t\t}\n\t\tif (error !== null)\n\t\t{\n\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t\titem.showMessage(error);\n\t\t}\n\t\telse if (!this.dnd.container.contains(this.dnd.itemMoveBlank))\n\t\t{\n\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttry {\n\t\t\t\tthis.dnd.itemMoveBlank.parentNode.replaceChild(dragElement, this.dnd.itemMoveBlank);\n\n\t\t\t\tif (this.hiddenContainer.contains(dragElement))\n\t\t\t\t{\n\t\t\t\t\titem.container.setAttribute(\"data-status\", \"hide\");\n\t\t\t\t\tif (this.dnd.itemDomBlank.closest('#left-menu-hidden-items-block') === null\n\t\t\t\t\t\t&& this.hiddenContainer.querySelectorAll('.menu-item-block').length === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsNotEmpty'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titem.container.setAttribute(\"data-status\", \"show\");\n\t\t\t\t\tif (this.hiddenContainer.querySelectorAll('.menu-item-block').length <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tonHiddenBlockIsEmptyEmitted = true;\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsEmpty'));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (item instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titem\n\t\t\t\t\t\t.checkAndCorrect()\n\t\t\t\t\t\t.expand(true);\n\t\t\t\t}\n\t\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t\t\tthis.#recalculateCounters(item);\n\n\t\t\t\tconst analyticsLabel = {action: 'sortItem'};\n\t\t\t\tif (this.parentContainer.querySelector('.menu-item-block') === item.container\n\t\t\t\t\t&& !this.isExtranet)\n\t\t\t\t{\n\t\t\t\t\titem.showMessage(Loc.getMessage(\"MENU_ITEM_MAIN_PAGE\"));\n\t\t\t\t\tanalyticsLabel.action = 'mainPage';\n\t\t\t\t\tanalyticsLabel.itemId = item.getId();\n\t\t\t\t}\n\t\t\t\tthis.#saveItemsSort(analyticsLabel);\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t\t}\n\t\t}\n\n\t\tDom.remove(this.dnd.draggableBlock);\n\t\tDom.remove(this.dnd.itemDomBlank);\n\t\tDom.remove(this.dnd.itemMoveBlank);\n\n\t\tjsDD.enableDest(dragElement);\n\t\tthis.container.style.position = 'static';\n\t\tif (!this.dnd.isHiddenContainerVisible || onHiddenBlockIsEmptyEmitted === true)\n\t\t{\n\t\t\tthis.#hideHiddenContainer(false);\n\t\t}\n\t\tdelete this.dnd;\n\n\t\t[...this.parentContainer\n\t\t\t.querySelectorAll('li.menu-item-block')]\n\t\t\t.forEach((node) => {\n\t\t\t\tjsDD.registerDest(node);\n\t\t\t});\n\t\tconst firstNode = this.parentContainer\n\t\t\t.querySelector(\"#left-menu-empty-item\");\n\t\tjsDD.unregisterDest(firstNode);\n\t\tjsDD.unregisterDest(this.parentContainer\n\t\t\t.querySelector(\"#left-menu-hidden-empty-item\"));\n\t\tjsDD.unregisterDest(this.parentContainer\n\t\t\t.querySelector(\"#left-menu-hidden-separator\"));\n\t\tjsDD.refreshDestArea();\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onDragModeOff')\n\t\t);\n\t}\n\t/*endregion*/\n}","import {Text, Tag, Loc} from 'main.core';\nimport {PopupManager, Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\nimport Backend from '../backend';\nimport Options from '../options';\nimport DefaultController from './default-controller';\nimport ItemUserSelf from '../items/item-user-self';\nimport ItemUserFavorites from \"../items/item-user-favorites\";\nimport Utils from \"../utils\";\n\nexport default class ItemDirector extends DefaultController\n{\n\n\tconstructor(container, params)\n\t{\n\t\tsuper(container, params);\n\t}\n\n\tsaveCurrentPage(page: ?Object)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.saveCurrentPage(page)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tsaveStandardPage(topItem)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.saveStandardPage(topItem)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tdeleteCurrentPage({pageLink})\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.deleteCurrentPage({pageLink})\n\t\t\t.then((data) => {\n\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenDeleted'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tdeleteStandardPage(topItem)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.deleteStandardPage(topItem)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenDeleted'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tshowAddToSelf(bindElement)\n\t{\n\t\tItemUserSelf\n\t\t\t.showAdd(bindElement)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t}).catch(Utils.catchError);\n\t}\n}\n","import {Cache, Loc, ajax, Type, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager, MenuItem} from 'main.popup';\nimport PresetCustomController from './controllers/preset-custom-controller';\nimport PresetDefaultController from './controllers/preset-default-controller';\nimport SettingsController from './controllers/settings-controller';\nimport Options from './options';\nimport Backend from './backend';\nimport ItemsController from './controllers/items-controller'\nimport ItemDirector from './controllers/item-director'\nimport Item from \"./items/item\";\nimport ItemSystem from \"./items/item-system\";\nimport Utils from './utils';\nimport ItemUserFavorites from \"./items/item-user-favorites\";\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\n\nexport default class Menu\n{\n\t//region containers\n\tmenuContainer;\n\tmenuHeader;\n\tmenuBody;\n\theader;\n\theaderBurger;\n\theaderSettings;\n\tmainTable;\n\tupButton;\n\tmenuMoreButton;\n\t//endregion\n\n\tcache = new Cache.MemoryCache();\n\n\tscrollModeThreshold = 20;//\n\tlastScrollOffset = 0;\n\tslidingModeTimeoutId = 0;\n\n\ttopMenuSelectedNode = null;//\n\ttopItemSelectedObj = null;\n\n\tisMenuMouseEnterBlocked = false;\n\tisMenuMouseLeaveBlocked = [];\n\tisCollapsedMode = false;\n\n\tworkgroupsCounterData = {};\n\n\tconstructor(params)\n\t{\n\t\t//TODO     html\n\t\tthis.menuContainer = document.getElementById(\"menu-items-block\");\n\t\tif (!this.menuContainer)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tparams = typeof params === \"object\" ? params : {};\n\n\t\tOptions.isExtranet = params.isExtranet === 'Y';\n\t\tOptions.isAdmin = params.isAdmin;\n\t\tOptions.isCustomPresetRestricted = params.isCustomPresetAvailable !== 'Y';\n\n\t\tthis.isCollapsedMode = params.isCollapsedMode;\n\n\t\tthis.workgroupsCounterData = params.workgroupsCounterData;\n\n\t\tthis.initAndBindNodes();\n\t\tthis.bindEvents();\n\t\tthis.getItemsController();\n\t\t//Emulate document scroll because init() can be invoked after page load scroll (a hard reload with script at the bottom).\n\t\tthis.handleDocumentScroll();\n\t}\n\n\tinitAndBindNodes()\n\t{\n\t\tthis.menuContainer.addEventListener(\"dblclick\", this.handleMenuDoubleClick.bind(this));\n\t\tthis.menuContainer.addEventListener(\"mouseenter\", this.handleMenuMouseEnter.bind(this));\n\t\tthis.menuContainer.addEventListener(\"mouseleave\", this.handleMenuMouseLeave.bind(this));\n\t\tthis.menuContainer.addEventListener(\"transitionend\", this.handleSlidingTransitionEnd.bind(this));\n\n\t\tthis.menuHeader = this.menuContainer.querySelector(\".menu-items-header\");\n\t\tthis.menuBody = this.menuContainer.querySelector(\".menu-items-body\");\n\t\tthis.menuItemsBlock = this.menuContainer.querySelector(\".menu-items\");\n\n\t\tthis.header = document.querySelector(\"#header\");\n\t\tthis.headerBurger = this.header.querySelector(\".menu-switcher\");\n\n\t\tconst headerLogoBlock = this.header.querySelector(\".header-logo-block\");\n\t\tthis.headerSettings = this.header.querySelector(\".header-logo-block-settings\");\n\t\tif (this.headerSettings)\n\t\t{\n\t\t\theaderLogoBlock.addEventListener(\"mouseenter\", this.handleHeaderLogoMouserEnter.bind(this));\n\t\t\theaderLogoBlock.addEventListener(\"mouseleave\", this.handleHeaderLogoMouserLeave.bind(this));\n\t\t\tthis.menuHeader.addEventListener(\"mouseenter\", this.handleHeaderLogoMouserEnter.bind(this));\n\t\t\tthis.menuHeader.addEventListener(\"mouseleave\", this.handleHeaderLogoMouserLeave.bind(this));\n\t\t}\n\t\tdocument.addEventListener(\"scroll\", this.handleDocumentScroll.bind(this));\n\n\t\tthis.mainTable = document.querySelector(\".bx-layout-table\");\n\t\tthis.menuHeaderBurger = this.menuHeader.querySelector(\".menu-switcher\");\n\t\tthis.menuHeaderBurger\n\t\t\t.addEventListener('click', this.handleBurgerClick.bind(this));\n\t\tthis.menuHeader.querySelector(\".menu-items-header-title\")\n\t\t\t.addEventListener('click', this.handleBurgerClick.bind(this, true));\n\n\t\tthis.upButton = this.menuContainer.querySelector(\".menu-btn-arrow-up\");\n\t\tthis.upButton.addEventListener(\"click\", this.handleUpButtonClick.bind(this));\n\t\tthis.menuMoreButton = this.menuContainer.querySelector(\".menu-favorites-more-btn\");\n\t\tthis.menuMoreButton.addEventListener(\"click\", this.handleShowHiddenClick.bind(this));\n\n\t\tconst helperItem = this.menuContainer.querySelector(\".menu-help-btn\");\n\n\t\tif (helperItem)\n\t\t{\n\t\t\thelperItem.addEventListener('click', this.handleHelperClick.bind(this));\n\t\t}\n\n\t\tconst siteMapItem = this.menuContainer.querySelector(\".menu-sitemap-btn\");\n\t\tif (siteMapItem)\n\t\t{\n\t\t\tsiteMapItem.addEventListener('click', this.handleSiteMapClick.bind(this));\n\t\t}\n\n\t\tconst settingsSaveBtn = this.menuContainer.querySelector(\".menu-settings-save-btn\")\n\t\tif (settingsSaveBtn)\n\t\t{\n\t\t\tsettingsSaveBtn.addEventListener('click', this.handleViewMode.bind(this));\n\t\t}\n\t\tthis.menuContainer.querySelector(\".menu-settings-btn\").addEventListener('click', () => {\n\t\t\tthis.getSettingsController().show();\n\t\t})\n\t}\n\n\t// region Controllers\n\tgetItemsController(): ItemsController\n\t{\n\t\treturn this.cache.remember('itemsController', () => {\n\t\t\treturn new ItemsController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tEditMode: () => {\n\t\t\t\t\t\t\tthis.toggle(true);\n\t\t\t\t\t\t\tthis.menuContainer.classList.add('menu-items-edit-mode');\n\t\t\t\t\t\t\tthis.menuContainer.classList.remove('menu-items-view-mode');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tViewMode: () => {\n\t\t\t\t\t\t\tthis.toggle(true);\n\t\t\t\t\t\t\tthis.menuContainer.classList.add('menu-items-view-mode');\n\t\t\t\t\t\t\tthis.menuContainer.classList.remove('menu-items-edit-mode');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDragModeOn: ({target}) => {\n\t\t\t\t\t\t\tthis.switchToSlidingMode(true);\n\t\t\t\t\t\t\tthis.isMenuMouseLeaveBlocked.push('drag');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDragModeOff: ({target}) => {\n\t\t\t\t\t\t\tthis.isMenuMouseLeaveBlocked.pop();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonHiddenBlockIsVisible: this.onHiddenBlockIsVisible.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsHidden: this.onHiddenBlockIsHidden.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsEmpty: this.onHiddenBlockIsEmpty.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsNotEmpty: this.onHiddenBlockIsNotEmpty.bind(this),\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('items'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetItemDirector(): ItemDirector\n\t{\n\t\treturn this.cache.remember('itemsCreator', () => {\n\t\t\treturn new ItemDirector(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonItemHasBeenAdded: ({data}) => {\n\t\t\t\t\t\t\tthis.getItemsController().addItem(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetSettingsController(): SettingsController\n\t{\n\t\treturn this.cache.remember('presetController', () => {\n\t\t\treturn new SettingsController(\n\t\t\t\tthis.menuContainer.querySelector(\".menu-settings-btn\"),\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonGettingSettingMenuItems: this.onGettingSettingMenuItems.bind(this),\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('settings'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetCustomPresetController(): PresetCustomController\n\t{\n\t\treturn this.cache.remember('customPresetController', () => {\n\t\t\treturn new PresetCustomController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPresetIsSet: ({data}) => {\n\t\t\t\t\t\t\tconst {saveSortItems, firstItemLink, customItems} = this.getItemsController().export();\n\t\t\t\t\t\t\treturn Backend.setCustomPreset(data, saveSortItems, customItems, firstItemLink)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('presets'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetDefaultPresetController(): PresetDefaultController\n\t{\n\t\treturn this.cache.remember('defaultPresetController', () => {\n\t\t\treturn new PresetDefaultController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPresetIsSet: ({data: {mode, presetId}}) => {\n\t\t\t\t\t\t\treturn Backend.setSystemPreset(mode, presetId);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPresetIsPostponed: ({data: {mode}}) => {\n\t\t\t\t\t\t\tconst result =  Backend.postponeSystemPreset(mode);\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsPostponed'));\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n/*\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('presets-default'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n*/\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\t//endregion\n\n\tbindEvents()\n\t{\n\t\t//just to hold opened menu in collapsing mode when groups are shown\n\t\tBX.addCustomEvent(\"BX.Bitrix24.GroupPanel:onOpen\", this.handleGroupPanelOpen.bind(this));\n\t\tBX.addCustomEvent(\"BX.Bitrix24.GroupPanel:onClose\", this.handleGroupPanelClose.bind(this));\n\n\t\t//region Top menu integration\n\t\tBX.addCustomEvent('BX.Main.InterfaceButtons:onFirstItemChange', (firstPageLink, firstNode) => {\n\t\t\tif (!firstPageLink || !Type.isDomNode(firstNode))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst topMenuId = firstNode.getAttribute(\"data-top-menu-id\");\n\t\t\tconst leftMenuNode = this.menuBody.querySelector(`[data-top-menu-id=\"${topMenuId}\"]`);\n\t\t\tif (leftMenuNode)\n\t\t\t{\n\t\t\t\tleftMenuNode.setAttribute(\"data-link\", firstPageLink);\n\t\t\t\tconst leftMenuLink = leftMenuNode.querySelector('a.menu-item-link');\n\t\t\t\tif (leftMenuLink)\n\t\t\t\t{\n\t\t\t\t\tleftMenuLink.setAttribute(\"href\", firstPageLink);\n\t\t\t\t}\n\n\t\t\t\tif (leftMenuNode.previousElementSibling === this.menuContainer.querySelector('#left-menu-empty-item'))\n\t\t\t\t{\n\t\t\t\t\tBackend.setFirstPage(firstPageLink);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBackend.clearCache();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.showMessage(firstNode, Loc.getMessage('MENU_ITEM_MAIN_SECTION_PAGE'));\n\t\t});\n\t\tBX.addCustomEvent(\"BX.Main.InterfaceButtons:onHideLastVisibleItem\", (bindElement) => {\n\t\t\tthis.showMessage(bindElement, Loc.getMessage(\"MENU_TOP_ITEM_LAST_HIDDEN\"));\n\t\t});\n\t\t//when we edit top menu item\n\t\tBX.addCustomEvent(\"BX.Main.InterfaceButtons:onBeforeCreateEditMenu\", (contextMenu, dataItem, topMenu) => {\n\t\t\tlet item = this.#getLeftMenuItemByTopMenuItem(dataItem);\n\t\t\tif (!item && dataItem && Type.isStringFilled(dataItem.URL) && !dataItem.URL.match(/javascript:/))\n\t\t\t{\n\t\t\t\tcontextMenu.addMenuItem({\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_TO_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.saveStandardPage(dataItem)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (item instanceof ItemUserFavorites)\n\t\t\t{\n\t\t\t\tcontextMenu.addMenuItem({\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_FROM_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.deleteStandardPage(dataItem)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t//endregion\n\t\t//service event for UI.Toolbar\n\t\ttop.BX.addCustomEvent('UI.Toolbar:onRequestMenuItemData', ({currentFullPath, context}) => {\n\t\t\tif (Type.isStringFilled(currentFullPath))\n\t\t\t{\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onSendMenuItemData', [{\n\t\t\t\t\tcurrentPageInMenu: this.menuContainer.querySelector(`.menu-item-block[data-link=\"${currentFullPath}\"]`),\n\t\t\t\t\tcontext: context,\n\t\t\t\t}]);\n\t\t\t}\n\t\t});\n\t\t//When clicked on a start Favorites like\n\t\tEventEmitter.subscribe('UI.Toolbar:onStarClick', ({compatData: [params]}) => {\n\t\t\tif (params.isActive)\n\t\t\t{\n\t\t\t\tthis.getItemDirector().deleteCurrentPage({\n\t\t\t\t\tcontext: params.context,\n\t\t\t\t\tpageLink: params.pageLink,\n\t\t\t\t}).then(({itemInfo}) => {\n\t\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [itemInfo, this]);\n\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\t\tisActive: false,\n\t\t\t\t\t\tcontext: params.context,\n\t\t\t\t\t}]);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t.saveCurrentPage({\n\t\t\t\t\tpageTitle: params.pageTitle,\n\t\t\t\t\tpageLink: params.pageLink,\n\t\t\t\t}).then(({itemInfo}) => {\n\t\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemAdded\", [itemInfo, this]);\n\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\t\tisActive: true,\n\t\t\t\t\t\tcontext: params.context,\n\t\t\t\t\t}]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onBeforeResetMenu', ({compatData: [promises]}) => {\n\t\t\tpromises.push(() => {\n\t\t\t\tconst p = new BX.Promise();\n\t\t\t\tBackend\n\t\t\t\t\t.clearCache()\n\t\t\t\t\t.then(\n\t\t\t\t\t\t() => { p.fulfill();},\n\t\t\t\t\t\t(response) => { p.reject(\"Error: \" +  response.errors[0].message);}\n\t\t\t\t\t)\n\t\t\t\t;\n\t\t\t\treturn p;\n\t\t\t});\n\t\t});\n\t}\n\n\tisEditMode()\n\t{\n\t\treturn this.getItemsController().isEditMode;\n\t}\n\n\tisCollapsed()\n\t{\n\t\treturn this.isCollapsedMode;\n\t}\n\n\tshowMessage(bindElement, message, position)\n\t{\n\t\tvar popup = PopupManager.create(\n\t\t\t\"left-menu-message\",\n\t\t\tbindElement,\n\t\t\t{\n\t\t\t\tcontent: '<div class=\"left-menu-message-popup\">' + message + '</div>',\n\t\t\t\tdarkMode: true,\n\t\t\t\toffsetTop: position === \"right\" ? -45 : 2,\n\t\t\t\toffsetLeft: position === \"right\" ? 215 : 0,\n\t\t\t\tangle: position === \"right\" ? {position: \"left\"} : true,\n\t\t\t\tcacheable: false,\n\t\t\t\tautoHide: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: function () {\n\t\t\t\t\t\tpopup = null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t})\n\t\t;\n\n\t\tpopup.show();\n\n\t\tsetTimeout(function ()\n\t\t{\n\t\t\tif (popup)\n\t\t\t{\n\t\t\t\tpopup.close();\n\t\t\t\tpopup = null;\n\t\t\t}\n\t\t}, 3000);\n\t}\n\n\tshowError(bindElement)\n\t{\n\t\tthis.showMessage(bindElement, Loc.getMessage('edit_error'));\n\t}\n\n\tshowGlobalPreset()\n\t{\n\t\tthis.getDefaultPresetController().show('global');\n\t}\n\n\thandleShowHiddenClick()\n\t{\n\t\tthis.getItemsController().toggleHiddenContainer(true);\n\t}\n\n\tonHiddenBlockIsVisible()\n\t{\n\t\tDom.addClass(this.menuMoreButton, 'menu-favorites-more-btn-open');\n\t\tthis.menuMoreButton.querySelector(\"#menu-more-btn-text\").innerHTML = Loc.getMessage(\"more_items_hide\");\n\t}\n\n\tonHiddenBlockIsHidden()\n\t{\n\t\tDom.removeClass(this.menuMoreButton, 'menu-favorites-more-btn-open');\n\t\tthis.menuMoreButton.querySelector(\"#menu-more-btn-text\").innerHTML = Loc.getMessage(\"more_items_show\");\n\t}\n\n\tonHiddenBlockIsEmpty()\n\t{\n\t\tDom.addClass(this.menuMoreButton, 'menu-favorites-more-btn-hidden');\n\t}\n\n\tonHiddenBlockIsNotEmpty()\n\t{\n\t\tDom.removeClass(this.menuMoreButton, 'menu-favorites-more-btn-hidden');\n\t}\n\n\tsetDefaultMenu()\n\t{\n\t\tMessageBox.show({\n\t\t\tmessage: Loc.getMessage('MENU_SET_DEFAULT_CONFIRM'),\n\t\t\tonYes: (messageBox, button) => {\n\t\t\t\tbutton.setWaiting();\n\t\t\t\tBackend\n\t\t\t\t\t.setDefaultPreset()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t},\n\t\t\tbuttons: MessageBoxButtons.YES_CANCEL\n\t\t});\n\t}\n\n\tclearCompositeCache()\n\t{\n\t\tajax.runAction('intranet.leftmenu.clearCache', {data: {}});\n\t}\n\n\t#getLeftMenuItemByTopMenuItem({DATA_ID, NODE}): ?Item\n\t{\n\t\tlet item = this.getItemsController().items.get(DATA_ID);\n\t\tif (!item)\n\t\t{\n\t\t\tconst topMenuId = NODE.getAttribute('data-top-menu-id');\n\t\t\tif (NODE === NODE.parentNode.querySelector('[data-top-menu-id]'))\n\t\t\t{\n\t\t\t\tconst leftMenuNode = this.menuItemsBlock.querySelector(`[data-top-menu-id=\"${topMenuId}\"]`);\n\t\t\t\tif (leftMenuNode)\n\t\t\t\t{\n\t\t\t\t\titem = this.getItemsController().items.get(leftMenuNode.getAttribute('data-id'));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn item ?? null;\n\t}\n\t// region Events servicing functions\n\tonGettingSettingMenuItems()\n\t{\n\t\tconst topPoint = ItemUserFavorites.getActiveTopMenuItem();\n\t\tlet menuItemWithAddingToFavorites = null;\n\t\tif (topPoint)\n\t\t{\n\t\t\tconst node = this.menuContainer.querySelector(`.menu-item-block[data-link=\"${topPoint['URL']}\"]`);\n\t\t\tif (!node)\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_TO_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.saveStandardPage(topPoint)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\telse if (node.getAttribute('data-type') === ItemUserFavorites.code)\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_FROM_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.deleteStandardPage(topPoint)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage('MENU_DELETE_PAGE_FROM_LEFT_MENU'),\n\t\t\t\t\tclassName: 'menu-popup-disable-text',\n\t\t\t\t\tonclick: () => { }\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\n\t\tconst menuItems = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('SORT_ITEMS'),\n\t\t\t\tonclick: () => { this.getItemsController().switchToEditMode();}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: this.isCollapsed() ? Loc.getMessage('MENU_EXPAND') : Loc.getMessage('MENU_COLLAPSE'),\n\t\t\t\tonclick: (event, item: MenuItem) => {\n\t\t\t\t\tthis.toggle();\n\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmenuItemWithAddingToFavorites,\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('MENU_ADD_SELF_PAGE'),\n\t\t\t\tonclick: (event, item: MenuItem) => {\n\t\t\t\t\tthis\n\t\t\t\t\t\t.getItemDirector()\n\t\t\t\t\t\t.showAddToSelf(\n\t\t\t\t\t\t\tthis.getSettingsController().getContainer()\n\t\t\t\t\t\t)\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t},\n\t\t\tOptions.isExtranet ? null : {\n\t\t\t\ttext: Loc.getMessage('MENU_SET_DEFAULT2'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.getDefaultPresetController().show('personal')\n\t\t\t\t}\n\t\t\t},\n\t\t\tOptions.isExtranet ? null : {\n\t\t\t\ttext: Loc.getMessage('MENU_SET_DEFAULT'),\n\t\t\t\tonclick: this.setDefaultMenu.bind(this)\n\t\t\t}\n\t\t];\n\t\t//custom preset\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tlet itemText = Loc.getMessage('MENU_SAVE_CUSTOM_PRESET');\n\n\t\t\tif (Options.isCustomPresetRestricted)\n\t\t\t{\n\t\t\t\titemText+= \"<span class='menu-lock-icon'></span>\";\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\thtml: itemText,\n\t\t\t\tclassName: (Options.isCustomPresetRestricted ? ' menu-popup-disable-text' : ''),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\tif (Options.isCustomPresetRestricted)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.UI.InfoHelper.show('limit_office_menu_to_all');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getCustomPresetController().show();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn menuItems.filter((value) => {return value !== null;})\n\t}\n\n\t// endregion\n\n\thandleSiteMapClick()\n\t{\n\t\tthis.switchToSlidingMode(false);\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\t(Loc.getMessage('SITE_DIR') || '/') + 'sitemap/',\n\t\t\t{\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcustomLeftBoundary: 0\n\t\t\t}\n\t\t);\n\t}\n\n\thandleHelperClick()\n\t{\n\t\tthis.switchToSlidingMode(false);\n\t\tBX.Helper.show();\n\t}\n\n\t// region Sliding functions\n\tblockSliding()\n\t{\n\t\tthis.stopSliding()\n\t\tthis.isMenuMouseEnterBlocked = true;\n\t}\n\n\treleaseSliding()\n\t{\n\t\tthis.isMenuMouseEnterBlocked = false;\n\t}\n\n\tstopSliding()\n\t{\n\t\tclearTimeout(this.slidingModeTimeoutId);\n\t\tthis.slidingModeTimeoutId = 0;\n\t}\n\n\tstartSliding()\n\t{\n\t\tthis.stopSliding();\n\t\tif (this.isMenuMouseEnterBlocked === true)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.slidingModeTimeoutId = setTimeout(function() {\n\t\t\tthis.slidingModeTimeoutId = 0;\n\t\t\tthis.switchToSlidingMode(true);\n\t\t}.bind(this), 400);\n\t}\n\n\thandleBurgerClick(open)\n\t{\n\t\tthis.getItemsController().switchToViewMode();\n\n\t\tthis.menuHeaderBurger.classList.add(\"menu-switcher-hover\");\n\n\t\tthis.toggle(open, function() {\n\n\t\t\tthis.blockSliding();\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tthis.menuHeaderBurger.classList.remove(\"menu-switcher-hover\");\n\n\t\t\t\tthis.releaseSliding();\n\n\t\t\t}.bind(this), 100);\n\n\t\t}.bind(this));\n\t}\n\n\thandleMenuMouseEnter(event)\n\t{\n\t\tif (!this.isCollapsed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.startSliding();\n\t}\n\n\thandleMenuMouseLeave(event)\n\t{\n\t\tthis.stopSliding();\n\t\tif (this.isMenuMouseLeaveBlocked.length <= 0)\n\t\t{\n\t\t\tthis.switchToSlidingMode(false);\n\t\t}\n\t}\n\n\thandleMenuDoubleClick(event)\n\t{\n\t\tif (event.target === this.menuBody)\n\t\t{\n\t\t\tthis.toggle();\n\t\t}\n\t}\n\n\thandleHeaderLogoMouserEnter(event)\n\t{\n\t\tBX.addClass(this.headerSettings, \"header-logo-block-settings-show\");\n\t}\n\n\thandleHeaderLogoMouserLeave(event)\n\t{\n\t\tif (!this.headerSettings.hasAttribute(\"data-rename-portal\"))\n\t\t{\n\t\t\tBX.removeClass(this.headerSettings, \"header-logo-block-settings-show\");\n\t\t}\n\t}\n\n\thandleUpButtonClick()\n\t{\n\t\tthis.blockSliding();\n\n\t\tif (this.isUpButtonReversed())\n\t\t{\n\t\t\twindow.scrollTo(0, this.lastScrollOffset);\n\t\t\tthis.lastScrollOffset = 0;\n\t\t\tthis.unreverseUpButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.lastScrollOffset = window.pageYOffset;\n\t\t\twindow.scrollTo(0, 0);\n\t\t\tthis.reverseUpButton();\n\t\t}\n\n\t\tsetTimeout(this.releaseSliding.bind(this), 100);\n\t}\n\n\thandleUpButtonMouseLeave()\n\t{\n\t\tthis.releaseSliding();\n\t}\n\n\thandleDocumentScroll()\n\t{\n\t\tthis.#adjustAdminPanel();\n\t\tthis.applyScrollMode();\n\n\t\tif (window.pageYOffset > document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.showUpButton();\n\n\t\t\tif (this.isUpButtonReversed())\n\t\t\t{\n\t\t\t\tthis.unreverseUpButton();\n\t\t\t\tthis.lastScrollOffset = 0;\n\t\t\t}\n\t\t}\n\t\telse if (!this.isUpButtonReversed())\n\t\t{\n\t\t\tthis.hideUpButton();\n\t\t}\n\n\t\tif (window.pageXOffset > 0)\n\t\t{\n\t\t\tthis.menuContainer.style.left = -window.pageXOffset + \"px\";\n\t\t\tthis.upButton.style.left = -window.pageXOffset + (this.isCollapsed() ? 0 : 172) + \"px\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.menuContainer.style.removeProperty(\"left\");\n\t\t\tthis.upButton.style.removeProperty(\"left\");\n\t\t}\n\t}\n\n\tswitchToSlidingMode(enable, immediately)\n\t{\n\t\tif (enable === false)\n\t\t{\n\t\t\tthis.stopSliding();\n\n\t\t\tif (BX.hasClass(this.mainTable, \"menu-sliding-mode\"))\n\t\t\t{\n\t\t\t\tif (immediately !== true)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.mainTable, \"menu-sliding-closing-mode\");\n\t\t\t\t}\n\n\t\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-mode menu-sliding-opening-mode\");\n\t\t\t}\n\t\t}\n\t\telse if (this.isCollapsedMode && !BX.hasClass(this.mainTable, \"menu-sliding-mode\"))\n\t\t{\n\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-closing-mode\");\n\n\t\t\tif (immediately !== true)\n\t\t\t{\n\t\t\t\tBX.addClass(this.mainTable, \"menu-sliding-opening-mode\");\n\t\t\t}\n\n\t\t\tBX.addClass(this.mainTable, \"menu-sliding-mode\");\n\t\t}\n\t}\n\n\thandleSlidingTransitionEnd(event)\n\t{\n\t\tif (event.target === this.menuContainer)\n\t\t{\n\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-opening-mode menu-sliding-closing-mode\");\n\t\t}\n\t}\n\n\tswitchToScrollMode(enable)\n\t{\n\t\tif (enable === false)\n\t\t{\n\t\t\tthis.mainTable.classList.remove('menu-scroll-mode');\n\t\t}\n\t\telse if (!this.mainTable.classList.contains('menu-scroll-mode'))\n\t\t{\n\t\t\tthis.mainTable.classList.add('menu-scroll-mode');\n\t\t}\n\t}\n\n\t//region logo\n\t#isLogoMaskNeeded(): boolean\n\t{\n\t\treturn this.cache.remember('isLogoMaskNeeded', () => {\n\t\t\tconst menuHeaderLogo = this.menuHeader.querySelector(\".logo\");\n\t\t\tlet result = false;\n\t\t\tif (menuHeaderLogo && !menuHeaderLogo.querySelector(\".logo-image-container\"))\n\t\t\t{\n\t\t\t\tlet widthMeasure = menuHeaderLogo.offsetWidth === 0 ?\n\t\t\t\t\t(this.header.querySelector(\".logo\") ?\n\t\t\t\t\t\tthis.header.querySelector(\".logo\").offsetWidth : 0)\n\t\t\t\t\t: menuHeaderLogo.offsetWidth\n\t\t\t\t;\n\n\t\t\t\tresult = widthMeasure > 200;\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tswitchToLogoMaskMode(enable)\n\t{\n\t\tif (!this.#isLogoMaskNeeded())\n\t\t{\n\t\t\treturn\n\t\t}\n\t\tif (enable === false)\n\t\t{\n\t\t\tthis.mainTable.classList.remove('menu-logo-mask-mode');\n\t\t}\n\t\telse if (!this.mainTable.classList.contains('menu-logo-mask-mode'))\n\t\t{\n\t\t\tthis.mainTable.classList.add('menu-logo-mask-mode');\n\t\t}\n\t}\n\t//endregion\n\n\ttoggle(flag, fn)\n\t{\n\t\tlet leftColumn = BX(\"layout-left-column\");\n\t\tif (!leftColumn)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isOpen = !this.mainTable.classList.contains('menu-collapsed-mode');\n\n\t\tif (flag === isOpen || this.mainTable.classList.contains('menu-animation-mode'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuToggle\", [flag, this]);\n\n\t\tvar logoImageContainer = this.menuHeader.querySelector(\".logo-image-container\");\n\t\tif (logoImageContainer)\n\t\t{\n\t\t\tvar logoWidth = this.header.querySelector(\".logo-image-container\").offsetWidth;\n\t\t\tif (logoWidth > 0)\n\t\t\t{\n\t\t\t\tlogoImageContainer.style.width = logoWidth + \"px\";\n\t\t\t}\n\t\t}\n\n\t\tthis.blockSliding();\n\t\tthis.switchToSlidingMode(false, true);\n\t\tthis.applyScrollMode();\n\n\t\tleftColumn.style.overflow = \"hidden\";\n\t\tthis.mainTable.classList.add(\"menu-animation-mode\", (isOpen ? \"menu-animation-closing-mode\" : \"menu-animation-opening-mode\"));\n\n\t\tvar menuLinks = [].slice.call(leftColumn.querySelectorAll('.menu-item-link'));\n\t\tvar menuMoreBtn = leftColumn.querySelector('.menu-collapsed-more-btn');\n\t\tvar menuMoreBtnDefault = leftColumn.querySelector('.menu-default-more-btn');\n\n\t\tvar menuSitemapIcon = leftColumn.querySelector('.menu-sitemap-icon-box');\n\t\tvar menuSitemapText = leftColumn.querySelector('.menu-sitemap-btn-text');\n\n\t\tvar menuEmployeesText = leftColumn.querySelector('.menu-invite-employees-text');\n\t\tvar menuEmployeesIcon = leftColumn.querySelector('.menu-invite-icon-box');\n\n\t\tvar licenseContainer = leftColumn.querySelector('.menu-license-all-container');\n\t\tvar licenseBtn = leftColumn.querySelector('.menu-license-all-default');\n\t\tvar licenseHeight = licenseBtn ? licenseBtn.offsetHeight : 0;\n\t\tvar licenseCollapsedBtn = leftColumn.querySelector('.menu-license-all-collapsed');\n\n\t\tconst settingsIconBox = this.menuContainer.querySelector(\".menu-settings-icon-box\");\n\t\tconst settingsBtnText = this.menuContainer.querySelector(\".menu-settings-btn-text\");\n\n\t\tconst helpIconBox = this.menuContainer.querySelector(\".menu-help-icon-box\");\n\t\tconst helpBtnText = this.menuContainer.querySelector(\".menu-help-btn-text\");\n\n\t\tvar menuTextDivider = leftColumn.querySelector('.menu-item-separator');\n\t\tvar menuMoreCounter = leftColumn.querySelector('.menu-item-index-more');\n\n\t\tvar pageHeader = this.mainTable.querySelector(\".page-header\");\n\t\tvar imBar = document.getElementById(\"bx-im-bar\");\n\t\tvar imBarWidth = imBar ? imBar.offsetWidth : 0;\n\n\t\t(new BX.easing({\n\t\t\tduration: 300,\n\t\t\tstart: {\n\t\t\t\ttranslateIcon: isOpen ? -100 : 0,\n\t\t\t\ttranslateText: isOpen ? 0 : -100,\n\t\t\t\ttranslateMoreBtn: isOpen ? 0 : -84,\n\t\t\t\ttranslateLicenseBtn: isOpen ? 0 : -100,\n\t\t\t\theightLicenseBtn: isOpen ? licenseHeight : 40,\n\t\t\t\tburgerMenuWidth: isOpen ? 33 : 66,\n\t\t\t\tsidebarWidth: isOpen ? 240 : 66, /* these values are duplicated in style.css as well */\n\t\t\t\topacity: isOpen ? 100 : 0,\n\t\t\t\topacityRevert: isOpen ? 0 : 100\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\ttranslateIcon: isOpen ? 0 : -100,\n\t\t\t\ttranslateText: isOpen ? -100 : -18,\n\t\t\t\ttranslateMoreBtn: isOpen ? -84 : 0,\n\t\t\t\ttranslateLicenseBtn: isOpen ? -100 : 0,\n\t\t\t\theightLicenseBtn: isOpen ? 40 : licenseHeight,\n\t\t\t\tburgerMenuWidth: isOpen ? 66 : 33,\n\t\t\t\tsidebarWidth: isOpen ? 66 : 240,\n\t\t\t\topacity: isOpen ? 0 : 100,\n\t\t\t\topacityRevert: isOpen ? 100 : 0\n\t\t\t},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: function (state)\n\t\t\t{\n\t\t\t\tleftColumn.style.width = state.sidebarWidth + \"px\";\n\t\t\t\tthis.menuContainer.style.width = state.sidebarWidth + \"px\";\n\t\t\t\tthis.menuHeaderBurger.style.width = state.burgerMenuWidth + \"px\";\n\t\t\t\tthis.headerBurger.style.width = state.burgerMenuWidth + \"px\";\n\n\t\t\t\t//Change this formula in template_style.css as well\n\t\t\t\tif (pageHeader)\n\t\t\t\t{\n\t\t\t\t\tpageHeader.style.maxWidth = \"calc(100vw - \" + state.sidebarWidth + \"px - \" + imBarWidth + \"px)\";\n\t\t\t\t}\n\n\t\t\t\tif (isOpen)\n\t\t\t\t{\n\t\t\t\t\t//Closing Mode\n\t\t\t\t\tif (menuSitemapIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuSitemapIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuSitemapText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuSitemapText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuEmployeesIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuEmployeesText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tsettingsIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tsettingsIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tsettingsBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\tsettingsBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\thelpIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\thelpIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\thelpBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\thelpBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tmenuMoreBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tmenuMoreBtn.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tmenuMoreBtnDefault.style.transform = \"translateX(\" + state.translateMoreBtn + \"px)\";\n\t\t\t\t\tmenuMoreBtnDefault.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tif (menuMoreCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreCounter.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuMoreCounter.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (licenseContainer)\n\t\t\t\t\t{\n\t\t\t\t\t\tlicenseBtn.style.transform = \"translateX(\" + state.translateLicenseBtn + \"px)\";\n\t\t\t\t\t\tlicenseBtn.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tlicenseBtn.style.height = state.heightLicenseBtn + \"px\";\n\n\t\t\t\t\t\tlicenseCollapsedBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tlicenseCollapsedBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\t\tmenuLinkText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuLinkText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\t\tmenuIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuIcon.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuArrow.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t\tmenuArrow.style.opacity = state.opacity / 100;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuCounter.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\t\tmenuCounter.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//Opening Mode\n\t\t\t\t\tmenuTextDivider.style.opacity = 0;\n\n\t\t\t\t\tif (menuSitemapIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuSitemapIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuSitemapText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuSitemapText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuEmployeesIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuEmployeesText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tsettingsIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tsettingsIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tsettingsBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\tsettingsBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\thelpIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\thelpIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\thelpBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\thelpBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tmenuMoreBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tmenuMoreBtn.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tmenuMoreBtnDefault.style.transform = \"translateX(\" + state.translateMoreBtn + \"px)\";\n\t\t\t\t\tmenuMoreBtnDefault.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tif (menuMoreCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreCounter.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (licenseContainer)\n\t\t\t\t\t{\n\t\t\t\t\t\tlicenseBtn.style.transform = \"translateX(\" + state.translateLicenseBtn + \"px)\";\n\t\t\t\t\t\tlicenseBtn.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tlicenseBtn.style.height = state.heightLicenseBtn + \"px\";\n\n\t\t\t\t\t\tlicenseCollapsedBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tlicenseCollapsedBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\t\tmenuLinkText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuLinkText.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tmenuLinkText.style.display = \"inline-block\";\n\n\t\t\t\t\t\tmenuIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuIcon.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuArrow.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t\t// menuArrow.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuCounter.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\t\tevent.initEvent(\"resize\", true, true);\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}.bind(this),\n\t\t\tcomplete: function ()\n\t\t\t{\n\t\t\t\tif (isOpen)\n\t\t\t\t{\n\t\t\t\t\tthis.isCollapsedMode = true;\n\t\t\t\t\tBX.addClass(this.mainTable, \"menu-collapsed-mode\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.isCollapsedMode = false;\n\t\t\t\t\tBX.removeClass(this.mainTable, \"menu-collapsed-mode\");\n\t\t\t\t}\n\n\t\t\t\tBX.removeClass(\n\t\t\t\t\tthis.mainTable,\n\t\t\t\t\t\"menu-animation-mode menu-animation-opening-mode menu-animation-closing-mode\"\n\t\t\t\t);\n\n\t\t\t\tvar containers = [\n\t\t\t\t\tleftColumn,\n\t\t\t\t\tmenuTextDivider,\n\t\t\t\t\tthis.menuHeaderBurger,\n\t\t\t\t\tthis.headerBurger,\n\t\t\t\t\tsettingsIconBox,\n\t\t\t\t\tsettingsBtnText,\n\t\t\t\t\thelpIconBox,\n\t\t\t\t\thelpBtnText,\n\t\t\t\t\tmenuMoreBtnDefault,\n\t\t\t\t\tmenuMoreBtn,\n\t\t\t\t\tlogoImageContainer,\n\t\t\t\t\tmenuSitemapIcon,\n\t\t\t\t\tmenuSitemapText,\n\t\t\t\t\tmenuEmployeesIcon,\n\t\t\t\t\tmenuEmployeesText,\n\t\t\t\t\tmenuMoreCounter,\n\t\t\t\t\tlicenseBtn,\n\t\t\t\t\tlicenseCollapsedBtn,\n\t\t\t\t\tthis.menuContainer,\n\t\t\t\t\tpageHeader\n\t\t\t\t];\n\n\t\t\t\tcontainers.forEach(function(container) {\n\t\t\t\t\tif (container)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontainer.style.cssText = \"\";\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\titem.style.cssText = \"\";\n\t\t\t\t\tmenuLinkText.style.cssText = \"\";\n\t\t\t\t\tmenuIcon.style.cssText = \"\";\n\n\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuArrow.style.cssText = \"\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuCounter.style.cssText = \"\";\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.releaseSliding();\n\t\t\t\tthis.#adjustAdminPanel();\n\n\t\t\t\tif (BX.type.isFunction(fn))\n\t\t\t\t{\n\t\t\t\t\tfn();\n\t\t\t\t}\n\n\t\t\t\tBackend.toggleMenu(isOpen);\n\n\t\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\t\tevent.initEvent(\"resize\", true, true);\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}.bind(this)\n\t\t})).animate();\n\t}\n\t//endregion\n\n\thandleViewMode()\n\t{\n\t\tthis.getItemsController().switchToViewMode();\n\t}\n\n\tapplyScrollMode()\n\t{\n\t\tthis.switchToLogoMaskMode(true);\n\t\tconst threshold = this.scrollModeThreshold + Utils.adminPanel.height;\n\t\tthis.switchToScrollMode(window.pageYOffset > threshold);\n\t}\n\n\thandleGroupPanelOpen()\n\t{\n\t\tthis.isMenuMouseLeaveBlocked.push('group');\n\t}\n\n\thandleGroupPanelClose()\n\t{\n\t\tthis.isMenuMouseLeaveBlocked.pop();\n\t}\n\n\tshowUpButton()\n\t{\n\t\tthis.menuContainer.classList.add(\"menu-up-button-active\");\n\t}\n\n\thideUpButton()\n\t{\n\t\tthis.menuContainer.classList.remove(\"menu-up-button-active\");\n\t}\n\n\treverseUpButton()\n\t{\n\t\tthis.menuContainer.classList.add(\"menu-up-button-reverse\");\n\t}\n\n\tunreverseUpButton()\n\t{\n\t\tthis.menuContainer.classList.remove(\"menu-up-button-reverse\");\n\t}\n\n\tisUpButtonReversed()\n\t{\n\t\treturn this.menuContainer.classList.contains(\"menu-up-button-reverse\");\n\t}\n\n\tisDefaultTheme()\n\t{\n\t\treturn document.body.classList.contains(\"bitrix24-default-theme\");\n\t}\n\n\tgetTopPadding()\n\t{\n\t\treturn this.isDefaultTheme() ? 0 : 9;\n\t}\n\n\t// region Public functions\n\tinitPagetitleStar(): boolean\n\t{\n\t\treturn ItemUserFavorites.isCurrentPageStandard(\n\t\t\tItemUserFavorites.getActiveTopMenuItem()\n\t\t);\n\t}\n\n\tgetStructureForHelper()\n\t{\n\t\tconst items = {menu: {}};\n\t\t[\"show\", \"hide\"].forEach((state) => {\n\t\t\tArray.from(this.menuContainer\n\t\t\t\t.querySelectorAll(`[data-status=\"${state}\"][data-type=\"${ItemSystem.code}\"]`)\n\t\t\t)\n\t\t\t.forEach((node) => {\n\t\t\t\titems[state] = items[state] || [];\n\t\t\t\titems[state].push(node.getAttribute(\"data-id\"))\n\t\t\t});\n\t\t});\n\t\treturn items;\n\t}\n\n\tshowItemWarning({itemId, title, events})\n\t{\n\t\tif (this.getItemsController().items.has(itemId))\n\t\t{\n\t\t\tthis.getItemsController().items.get(itemId).showWarning(title, events);\n\t\t}\n\t}\n\n\tremoveItemWarning(itemId)\n\t{\n\t\tif (this.getItemsController().items.has(itemId))\n\t\t{\n\t\t\tthis.getItemsController().items.get(itemId).removeWarning();\n\t\t}\n\t}\n\n\t#specialLiveFeedDecrement = 0;\n\tdecrementCounter(node, iDecrement)\n\t{\n\t\tif (!node || node.id !== 'menu-counter-live-feed')\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#specialLiveFeedDecrement += parseInt(iDecrement);\n\t\tthis.getItemsController().decrementCounter({\n\t\t\t'live-feed' : parseInt(iDecrement)\n\t\t});\n\t}\n\n\tupdateCounters(counters, send)\n\t{\n\t\tif (!counters)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (counters['**'] !== undefined)\n\t\t{\n\t\t\tcounters['live-feed'] = counters['**'];\n\t\t\tdelete counters['**'];\n\t\t}\n\n\t\tlet workgroupsCounterUpdated = false;\n\t\tif (!Type.isUndefined(counters['**SG0']))\n\t\t{\n\t\t\tthis.workgroupsCounterData['livefeed'] = counters['**SG0'];\n\t\t\tdelete counters['**SG0'];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (!Type.isUndefined(counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')]))\n\t\t{\n\t\t\tthis.workgroupsCounterData[Loc.getMessage('COUNTER_PROJECTS_MAJOR')] = counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')];\n\t\t\tdelete counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (!Type.isUndefined(counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')]))\n\t\t{\n\t\t\tthis.workgroupsCounterData[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')] = counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')];\n\t\t\tdelete counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (workgroupsCounterUpdated)\n\t\t{\n\t\t\tcounters['workgroups'] = Object.entries(this.workgroupsCounterData).reduce((prevValue, [, curValue]) => {\n\t\t\t\treturn prevValue + Number(curValue);\n\t\t\t}, 0);\n\t\t}\n\n\t\tif (counters['live-feed'])\n\t\t{\n\t\t\tif (counters['live-feed'] <= 0)\n\t\t\t{\n\t\t\t\tthis.#specialLiveFeedDecrement = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcounters['live-feed'] -= this.#specialLiveFeedDecrement;\n\t\t\t}\n\t\t}\n\n\t\tthis.getItemsController().updateCounters(counters, send);\n\t}\n\t//endregion\n\n\t#adjustAdminPanel()\n\t{\n\t\tif (!this['menuAdjustAdminPanel'])\n\t\t{\n\t\t\tthis['menuAdjustAdminPanel'] = ({data}) => {\n\t\t\t\tthis.menuContainer.style.top = [data, 'px'].join('');\n\t\t\t}\n\t\t\tEventEmitter.subscribe(Utils.adminPanel,\n\t\t\t\tOptions.eventName('onPanelHasChanged'),\n\t\t\t\tthis['menuAdjustAdminPanel']\n\t\t\t);\n\t\t}\n\t\tthis.menuContainer.style.top = [Utils.adminPanel.top, 'px'].join('');\n\t}\n}\n"],"names":["Options","name","Type","isStringFilled","join","DefaultController","container","events","Array","from","Object","keys","forEach","key","EventEmitter","subscribe","eventName","createPopup","arguments","emit","show","close","PresetCustomController","form","Tag","render","Loc","getMessage","button","PopupManager","create","constructor","toString","overlay","contentColor","contentNoPaddings","lightShadow","draggable","restrict","closeByEsc","titleBar","offsetTop","offsetLeft","cacheable","closeIcon","content","buttons","SaveButton","onclick","isReady","setWaiting","elements","value","promise","then","hide","console","log","CancelButton","AdminPanel","BX","bindEvents","addCustomEvent","isCollapsed","top","bind","offsetHeight","adminPanelState","getClass","fixed","height","rect","getBoundingClientRect","bottom","Math","max","fixedHeight","Utils","_classStaticPrivateFieldSpecGet","_classStaticPrivateFieldSpecSet","document","location","pathname","search","Uri","href","response","UI","Notification","Center","notify","errors","message","position","category","autoHideDelay","url","String","trim","match","link","createElement","host","hash","getInstance","PresetDefaultController","mode","querySelector","cloneNode","onFirstShow","querySelectorAll","node","addEventListener","otherNode","classList","CreateButton","text","isWaiting","currentPreset","forms","checked","presetId","data","hasOwnProperty","reload","catchError","SettingsController","menu","Menu","bindElement","items","getItems","angle","getPopupWindow","menuItems","html","className","push","assign","event","item","getMenuWindow","Backend","collapse","ajax","runAction","analyticsLabel","leftmenu","action","itemData","id","menuItemId","itemText","itemId","itemInfo","menu_item_id","firstItemLink","version","firstPageLink","firstPageUrl","forNewUsersOnly","itemsSort","customItems","userApply","preset","analyticsFirst","Item","parentContainer","init","onDeleteAsFavorites","setTimeout","GLOBAL_TARGET","incrementMaxListeners","destroy","showError","showMessage","dataset","code","textContent","links","hasAttribute","getAttribute","split","makeTextIcons","storage","openInNewPage","setAttribute","Text","encode","linkNode","innerHTML","unsubscribe","decrementMaxListeners","currentUri","result","index","areUrlsEqual","priority","contains","icon","getShortName","parseInt","counterValue","oldValue","add","remove","warning","getId","style","display","newValue","error","title","removeWarning","Event","appendChild","parentNode","removeChild","showMessagePopup","darkMode","onClose","autoHide","TypeError","getName","getCode","animate","filter","v","counterId","topMenuId","Promise","resolve","reject","showForm","getEditFields","length","focus","refineUrl","popup","isEditMode","undefined","indexOf","checkForm","itemInfoToSave","backendSaveItem","checkedUri","checkedUrlBrief","getPath","replace","currentUrlBrief","getHost","shortName","words","substring","firstWord","secondWord","i","toUpperCase","ItemUserFavorites","deleteFavoritesItemMenu","context","getSimilarToUrl","getCurUri","window","onCustomEvent","isActive","contextMenuItems","showUpdate","update","isAdmin","itemLinkNode","addAdminSharedItemMenu","type","ItemAdminShared","updateFavoritesItemMenu","Main","interfaceButtonsManager","firstTopMenuInstance","values","getObjects","shift","topMenuItem","getActive","path","ID","NODE","URL","TEXT","DATA_ID","COUNTER_ID","COUNTER","SUB_LINK","topMenuPoint","currentFullPath","pageTitle","pageLink","getActiveTopMenuItem","startX","startY","isCurrentPageStandard","getCurPage","menuNodeCoord","left","isStandardItem","subLink","getElementById","innerText","titleCoord","addFavoritesItemMenu","createNode","animateFromPoint","topPoint","animateToPoint","pos","ItemUserSelf","deleteSelfITem","MessageBox","confirm","messageBox","saveSelfItemMenu","resolve1","reject2","deletePerm","deleteAdminSharedItemMenu","canDelete","codeToConvert","ItemAdminCustom","deleteCustomItem","actions","ItemSystem","ItemGroup","_classPrivateFieldInitSpec","toggleAndSave","Dom","removeClass","groupContainer","updateCounter","preventDefault","stopPropagation","expandGroup","expand","collapseGroup","insertAfter","hideGroupContainer","stop","overflow","addClass","slideParams","easing","duration","start","opacity","finish","transition","makeEaseOut","transitions","quart","step","state","complete","checkAttribute","contentHeight","removeAttribute","ItemGroupSystem","itemMappings","getItem","itemClassName","itemClass","detect","ItemActive","highlight","Runtime","debounce","theMostOfTheLinks","linkUri","changeActiveItem","uri","actualParams","getQueryParams","maxCount","theMostOfTheLinkServiceData","params","mismatches","comparedLinkParams","unhighlight","parent","closest","ItemsController","Map","hiddenContainer","registerItem","toggleHiddenContainer","getActiveItem","set","checkAndSet","parentItem","markAsActive","deleteItem","convertItem","openItemMenu","target","has","checkAndUnset","unsubscribeAll","replaceChild","startTop","dragElement","attrs","insertBeforeElement","nextElementSibling","insertBefore","nextSibling","oldParent","emitEvent","counters","send","countersDynamic","entries","localStorage","hiddenCounterNode","Number","BXIM","res","getCounterValue","counterNode","visibleValue","desktop","Reflection","setBrowserIconBadge","updateCounters","Element","styleValue","styleDisplay","get","unregisterItem","hideItem","contextMenuItem","showItem","isExtranet","setItemAsAMainPage","getDropDownActions","actionItem","switchToViewMode","switchToEditMode","call","onShow","scrollHeight","opening","hiddenBlock","maxHeight","linear","itemGroup","hiddenCounterValue","newParent","markAsInactive","saveSortItems","currentGroupId","chain","role","groupId","groupItem","pop","group_id","LINK","decode","NEW_PAGE","saveItemsSort","topMenuNode","body","finishY","paddingLeft","jsDD","Enable","onbxdragstart","onbxdrag","x","y","onbxdraghover","dest","onbxdragstop","registerObject","dnd","itemDomBlank","itemMoveBlank","draggableBlock","isHiddenContainerVisible","registerItems","registerDest","firstNode","unregisterDest","menuItemsBlockHeight","min","groupHolder","prepend","itemPlaceHolder","onHiddenBlockIsEmptyEmitted","checkAndCorrect","e","enableDest","refreshDestArea","ItemDirector","page","saveCurrentPage","topItem","saveStandardPage","deleteCurrentPage","deleteStandardPage","showAdd","_classPrivateMethodInitSpec","Cache","MemoryCache","menuContainer","isCustomPresetRestricted","isCustomPresetAvailable","isCollapsedMode","workgroupsCounterData","initAndBindNodes","getItemsController","handleDocumentScroll","handleMenuDoubleClick","handleMenuMouseEnter","handleMenuMouseLeave","handleSlidingTransitionEnd","menuHeader","menuBody","menuItemsBlock","header","headerBurger","headerLogoBlock","headerSettings","handleHeaderLogoMouserEnter","handleHeaderLogoMouserLeave","mainTable","menuHeaderBurger","handleBurgerClick","upButton","handleUpButtonClick","menuMoreButton","handleShowHiddenClick","helperItem","handleHelperClick","siteMapItem","handleSiteMapClick","settingsSaveBtn","handleViewMode","getSettingsController","cache","remember","EditMode","toggle","ViewMode","onDragModeOn","switchToSlidingMode","isMenuMouseLeaveBlocked","onDragModeOff","onHiddenBlockIsVisible","onHiddenBlockIsHidden","onHiddenBlockIsEmpty","onHiddenBlockIsNotEmpty","onItemHasBeenAdded","addItem","onGettingSettingMenuItems","onPresetIsSet","setCustomPreset","setSystemPreset","onPresetIsPostponed","postponeSystemPreset","handleGroupPanelOpen","handleGroupPanelClose","isDomNode","leftMenuNode","leftMenuLink","previousElementSibling","setFirstPage","clearCache","contextMenu","dataItem","topMenu","addMenuItem","getItemDirector","currentPageInMenu","compatData","promises","p","fulfill","onDestroy","getDefaultPresetController","onYes","setDefaultPreset","MessageBoxButtons","YES_CANCEL","menuItemWithAddingToFavorites","showAddToSelf","getContainer","setDefaultMenu","InfoHelper","getCustomPresetController","SidePanel","Instance","open","allowChangeHistory","customLeftBoundary","Helper","stopSliding","isMenuMouseEnterBlocked","clearTimeout","slidingModeTimeoutId","blockSliding","releaseSliding","startSliding","isUpButtonReversed","scrollTo","lastScrollOffset","unreverseUpButton","pageYOffset","reverseUpButton","_classPrivateMethodGet","applyScrollMode","documentElement","clientHeight","showUpButton","hideUpButton","pageXOffset","removeProperty","enable","immediately","hasClass","flag","fn","leftColumn","isOpen","logoImageContainer","logoWidth","offsetWidth","width","menuLinks","slice","menuMoreBtn","menuMoreBtnDefault","menuSitemapIcon","menuSitemapText","menuEmployeesText","menuEmployeesIcon","licenseContainer","licenseBtn","licenseHeight","licenseCollapsedBtn","settingsIconBox","settingsBtnText","helpIconBox","helpBtnText","menuTextDivider","menuMoreCounter","pageHeader","imBar","imBarWidth","translateIcon","translateText","translateMoreBtn","translateLicenseBtn","heightLicenseBtn","burgerMenuWidth","sidebarWidth","opacityRevert","maxWidth","transform","menuIcon","menuLinkText","menuCounter","menuArrow","createEvent","initEvent","dispatchEvent","containers","cssText","isFunction","toggleMenu","switchToLogoMaskMode","threshold","scrollModeThreshold","adminPanel","switchToScrollMode","isDefaultTheme","showWarning","iDecrement","decrementCounter","workgroupsCounterUpdated","isUndefined","reduce","prevValue","curValue","menuHeaderLogo","widthMeasure"],"mappings":"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"}